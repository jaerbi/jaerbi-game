var ZO=Object.defineProperty,XO=Object.defineProperties;var e4=Object.getOwnPropertyDescriptors;var ph=Object.getOwnPropertySymbols;var MS=Object.prototype.hasOwnProperty,RS=Object.prototype.propertyIsEnumerable;var AS=(n,e,t)=>e in n?ZO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||={})MS.call(e,t)&&AS(n,t,e[t]);if(ph)for(var t of ph(e))RS.call(e,t)&&AS(n,t,e[t]);return n},pe=(n,e)=>XO(n,e4(e));var Va=(n,e)=>{var t={};for(var i in n)MS.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&ph)for(var i of ph(n))e.indexOf(i)<0&&RS.call(n,i)&&(t[i]=n[i]);return t};var Fn=null,gh=!1,W0=1,t4=null,Kn=Symbol("SIGNAL");function Ve(n){let e=Fn;return Fn=n,e}function yh(){return Fn}var Mc={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Rc(n){if(gh)throw new Error("");if(Fn===null)return;Fn.consumerOnSignalRead(n);let e=Fn.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Fn.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Fn.producers,t!==void 0&&t.producer===n)){Fn.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Fn&&(!i||i4(r,Fn)))return;let o=Ua(Fn),s={producer:n,consumer:Fn,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Fn.producersTail=s,e!==void 0?e.nextProducer=s:Fn.producers=s,o&&OS(n,s)}function PS(){W0++}function q0(n){if(!(Ua(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===W0)){if(!n.producerMustRecompute(n)&&!_h(n)){z0(n);return}n.producerRecomputeValue(n),z0(n)}}function K0(n){if(n.consumers===void 0)return;let e=gh;gh=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||n4(i)}}finally{gh=e}}function Y0(){return Fn?.consumerAllowSignalWrites!==!1}function n4(n){n.dirty=!0,K0(n),n.consumerMarkedDirty?.(n)}function z0(n){n.dirty=!1,n.lastCleanEpoch=W0}function Pc(n){return n&&NS(n),Ve(n)}function NS(n){n.producersTail=void 0,n.recomputing=!0}function vh(n,e){Ve(e),n&&kS(n)}function kS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Ua(n))do t=Q0(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function _h(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(q0(t),i!==t.version))return!0}return!1}function Nc(n){if(Ua(n)){let e=n.producers;for(;e!==void 0;)e=Q0(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function OS(n,e){let t=n.consumersTail,i=Ua(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)OS(r.producer,r)}function Q0(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Ua(e)){let o=e.producers;for(;o!==void 0;)o=Q0(o)}return t}function Ua(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function J0(n){t4?.(n)}function i4(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function Z0(n,e){return Object.is(n,e)}function Eh(n,e){let t=Object.create(r4);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(q0(t),Rc(t),t.value===mh)throw t.error;return t.value};return i[Kn]=t,J0(t),i}var $0=Symbol("UNSET"),G0=Symbol("COMPUTING"),mh=Symbol("ERRORED"),r4=pe(F({},Mc),{value:$0,dirty:!0,error:null,equal:Z0,kind:"computed",producerMustRecompute(n){return n.value===$0||n.value===G0},producerRecomputeValue(n){if(n.value===G0)throw new Error("");let e=n.value;n.value=G0;let t=Pc(n),i,r=!1;try{i=n.computation(),Ve(null),r=e!==$0&&e!==mh&&i!==mh&&n.equal(e,i)}catch(o){i=mh,n.error=o}finally{vh(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function o4(){throw new Error}var FS=o4;function LS(n){FS(n)}function X0(n){FS=n}var s4=null;function ey(n,e){let t=Object.create(bh);t.value=n,e!==void 0&&(t.equal=e);let i=()=>VS(t);return i[Kn]=t,J0(t),[i,s=>kc(t,s),s=>US(t,s)]}function VS(n){return Rc(n),n.value}function kc(n,e){Y0()||LS(n),n.equal(n.value,e)||(n.value=e,a4(n))}function US(n,e){Y0()||LS(n),kc(n,e(n.value))}var bh=pe(F({},Mc),{equal:Z0,value:void 0,kind:"signal"});function a4(n){n.version++,PS(),K0(n),s4?.(n)}function ty(n){let e=Ve(null);try{return n()}finally{Ve(e)}}function Ke(n){return typeof n=="function"}function Ba(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var wh=Ba(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Cs(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var yn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ke(i))try{i()}catch(o){e=o instanceof wh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{BS(o)}catch(s){e=e??[],s instanceof wh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new wh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)BS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Cs(t,e)}remove(e){let{_finalizers:t}=this;t&&Cs(t,e),e instanceof n&&e._removeParent(this)}};yn.EMPTY=(()=>{let n=new yn;return n.closed=!0,n})();var ny=yn.EMPTY;function xh(n){return n instanceof yn||n&&"closed"in n&&Ke(n.remove)&&Ke(n.add)&&Ke(n.unsubscribe)}function BS(n){Ke(n)?n():n.unsubscribe()}var Li={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ja={setTimeout(n,e,...t){let{delegate:i}=ja;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=ja;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Sh(n){ja.setTimeout(()=>{let{onUnhandledError:e}=Li;if(e)e(n);else throw n})}function Oc(){}var jS=iy("C",void 0,void 0);function HS(n){return iy("E",void 0,n)}function $S(n){return iy("N",n,void 0)}function iy(n,e,t){return{kind:n,value:e,error:t}}var Ds=null;function Ha(n){if(Li.useDeprecatedSynchronousErrorHandling){let e=!Ds;if(e&&(Ds={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Ds;if(Ds=null,t)throw i}}else n()}function GS(n){Li.useDeprecatedSynchronousErrorHandling&&Ds&&(Ds.errorThrown=!0,Ds.error=n)}var As=class extends yn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,xh(e)&&e.add(this)):this.destination=u4}static create(e,t,i){return new $a(e,t,i)}next(e){this.isStopped?oy($S(e),this):this._next(e)}error(e){this.isStopped?oy(HS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?oy(jS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},l4=Function.prototype.bind;function ry(n,e){return l4.call(n,e)}var sy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Ih(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Ih(i)}else Ih(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ih(t)}}},$a=class extends As{constructor(e,t,i){super();let r;if(Ke(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&Li.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&ry(e.next,o),error:e.error&&ry(e.error,o),complete:e.complete&&ry(e.complete,o)}):r=e}this.destination=new sy(r)}};function Ih(n){Li.useDeprecatedSynchronousErrorHandling?GS(n):Sh(n)}function c4(n){throw n}function oy(n,e){let{onStoppedNotification:t}=Li;t&&ja.setTimeout(()=>t(n,e))}var u4={closed:!0,next:Oc,error:c4,complete:Oc};var Ga=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Vi(n){return n}function ay(...n){return ly(n)}function ly(n){return n.length===0?Vi:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var ot=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=h4(t)?t:new $a(t,i,r);return Ha(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=zS(i),new i((r,o)=>{let s=new $a({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Ga](){return this}pipe(...t){return ly(t)(this)}toPromise(t){return t=zS(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function zS(n){var e;return(e=n??Li.Promise)!==null&&e!==void 0?e:Promise}function d4(n){return n&&Ke(n.next)&&Ke(n.error)&&Ke(n.complete)}function h4(n){return n&&n instanceof As||d4(n)&&xh(n)}function f4(n){return Ke(n?.lift)}function ht(n){return e=>{if(f4(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ft(n,e,t,i,r){return new cy(n,e,t,i,r)}var cy=class extends As{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var WS=Ba(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var zt=(()=>{class n extends ot{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new Th(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new WS}next(t){Ha(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Ha(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ha(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?ny:(this.currentObservers=null,o.push(t),new yn(()=>{this.currentObservers=null,Cs(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new ot;return t.source=this,t}}return n.create=(e,t)=>new Th(e,t),n})(),Th=class extends zt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:ny}};var Mn=class extends zt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var uy={now(){return(uy.delegate||Date).now()},delegate:void 0};var Ch=class extends yn{constructor(e,t){super()}schedule(e,t=0){return this}};var Fc={setInterval(n,e,...t){let{delegate:i}=Fc;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Fc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Dh=class extends Ch{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return Fc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Fc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Cs(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var za=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};za.now=uy.now;var Ah=class extends za{constructor(e,t=za.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var qS=new Ah(Dh);var Rn=new ot(n=>n.complete());function KS(n){return n&&Ke(n.schedule)}function YS(n){return n[n.length-1]}function Mh(n){return Ke(YS(n))?n.pop():void 0}function Oo(n){return KS(YS(n))?n.pop():void 0}function JS(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{u(i.next(d))}catch(h){s(h)}}function l(d){try{u(i.throw(d))}catch(h){s(h)}}function u(d){d.done?o(d.value):r(d.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function QS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ms(n){return this instanceof Ms?(this.v=n,this):new Ms(n)}function ZS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(g){return function(x){return Promise.resolve(x).then(g,h)}}function a(g,x){i[g]&&(r[g]=function(S){return new Promise(function(N,U){o.push([g,S,N,U])>1||l(g,S)})},x&&(r[g]=x(r[g])))}function l(g,x){try{u(i[g](x))}catch(S){p(o[0][3],S)}}function u(g){g.value instanceof Ms?Promise.resolve(g.value.v).then(d,h):p(o[0][2],g)}function d(g){l("next",g)}function h(g){l("throw",g)}function p(g,x){g(x),o.shift(),o.length&&l(o[0][0],o[0][1])}}function XS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof QS=="function"?QS(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}}var Rh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Ph(n){return Ke(n?.then)}function Nh(n){return Ke(n[Ga])}function kh(n){return Symbol.asyncIterator&&Ke(n?.[Symbol.asyncIterator])}function Oh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function p4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Fh=p4();function Lh(n){return Ke(n?.[Fh])}function Vh(n){return ZS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Ms(t.read());if(r)return yield Ms(void 0);yield yield Ms(i)}}finally{t.releaseLock()}})}function Uh(n){return Ke(n?.getReader)}function ln(n){if(n instanceof ot)return n;if(n!=null){if(Nh(n))return g4(n);if(Rh(n))return m4(n);if(Ph(n))return y4(n);if(kh(n))return eI(n);if(Lh(n))return v4(n);if(Uh(n))return _4(n)}throw Oh(n)}function g4(n){return new ot(e=>{let t=n[Ga]();if(Ke(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function m4(n){return new ot(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function y4(n){return new ot(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Sh)})}function v4(n){return new ot(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function eI(n){return new ot(e=>{E4(n,e).catch(t=>e.error(t))})}function _4(n){return eI(Vh(n))}function E4(n,e){var t,i,r,o;return JS(this,void 0,void 0,function*(){try{for(t=XS(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function Yn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Bh(n,e=0){return ht((t,i)=>{t.subscribe(ft(i,r=>Yn(i,n,()=>i.next(r),e),()=>Yn(i,n,()=>i.complete(),e),r=>Yn(i,n,()=>i.error(r),e)))})}function jh(n,e=0){return ht((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function tI(n,e){return ln(n).pipe(jh(e),Bh(e))}function nI(n,e){return ln(n).pipe(jh(e),Bh(e))}function iI(n,e){return new ot(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function rI(n,e){return new ot(t=>{let i;return Yn(t,e,()=>{i=n[Fh](),Yn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Ke(i?.return)&&i.return()})}function Hh(n,e){if(!n)throw new Error("Iterable cannot be null");return new ot(t=>{Yn(t,e,()=>{let i=n[Symbol.asyncIterator]();Yn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function oI(n,e){return Hh(Vh(n),e)}function sI(n,e){if(n!=null){if(Nh(n))return tI(n,e);if(Rh(n))return iI(n,e);if(Ph(n))return nI(n,e);if(kh(n))return Hh(n,e);if(Lh(n))return rI(n,e);if(Uh(n))return oI(n,e)}throw Oh(n)}function cn(n,e){return e?sI(n,e):ln(n)}function it(...n){let e=Oo(n);return cn(n,e)}function dy(n,e){let t=Ke(n)?n:()=>n,i=r=>r.error(t());return new ot(e?r=>e.schedule(i,0,r):i)}function $h(n){return!!n&&(n instanceof ot||Ke(n.lift)&&Ke(n.subscribe))}var Rs=Ba(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function yt(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:b4}=Array;function w4(n,e){return b4(e)?n(...e):n(e)}function Gh(n){return yt(e=>w4(n,e))}var{isArray:x4}=Array,{getPrototypeOf:S4,prototype:I4,keys:T4}=Object;function zh(n){if(n.length===1){let e=n[0];if(x4(e))return{args:e,keys:null};if(C4(e)){let t=T4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function C4(n){return n&&typeof n=="object"&&S4(n)===I4}function Wh(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Lc(...n){let e=Oo(n),t=Mh(n),{args:i,keys:r}=zh(n);if(i.length===0)return cn([],e);let o=new ot(D4(i,e,r?s=>Wh(r,s):Vi));return t?o.pipe(Gh(t)):o}function D4(n,e,t=Vi){return i=>{aI(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let l=0;l<r;l++)aI(e,()=>{let u=cn(n[l],e),d=!1;u.subscribe(ft(i,h=>{o[l]=h,d||(d=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function aI(n,e,t){n?Yn(t,n,e):e()}function lI(n,e,t,i,r,o,s,a){let l=[],u=0,d=0,h=!1,p=()=>{h&&!l.length&&!u&&e.complete()},g=S=>u<i?x(S):l.push(S),x=S=>{o&&e.next(S),u++;let N=!1;ln(t(S,d++)).subscribe(ft(e,U=>{r?.(U),o?g(U):e.next(U)},()=>{N=!0},void 0,()=>{if(N)try{for(u--;l.length&&u<i;){let U=l.shift();s?Yn(e,s,()=>x(U)):x(U)}p()}catch(U){e.error(U)}}))};return n.subscribe(ft(e,g,()=>{h=!0,p()})),()=>{a?.()}}function Hn(n,e,t=1/0){return Ke(e)?Hn((i,r)=>yt((o,s)=>e(i,o,r,s))(ln(n(i,r))),t):(typeof e=="number"&&(t=e),ht((i,r)=>lI(i,r,n,t)))}function cI(n=1/0){return Hn(Vi,n)}function uI(){return cI(1)}function Fo(...n){return uI()(cn(n,Oo(n)))}function Vc(n){return new ot(e=>{ln(n()).subscribe(e)})}function hy(...n){let e=Mh(n),{args:t,keys:i}=zh(n),r=new ot(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,u=s;for(let d=0;d<s;d++){let h=!1;ln(t[d]).subscribe(ft(o,p=>{h||(h=!0,u--),a[d]=p},()=>l--,void 0,()=>{(!l||!h)&&(u||o.next(i?Wh(i,a):a),o.complete())}))}});return e?r.pipe(Gh(e)):r}function Ui(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>n.call(e,o,r++)&&i.next(o)))})}function Uc(n){return ht((e,t)=>{let i=null,r=!1,o;i=e.subscribe(ft(t,void 0,void 0,s=>{o=ln(n(s,Uc(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function qh(n,e){return Ke(e)?Hn(n,e,1):Hn(n,1)}function fy(n,e=qS){return ht((t,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let u=o;o=null,i.next(u)}};function l(){let u=s+n,d=e.now();if(d<u){r=this.schedule(void 0,u-d),i.add(r);return}a()}t.subscribe(ft(i,u=>{o=u,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function dI(n){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Bi(n){return n<=0?()=>Rn:ht((e,t)=>{let i=0;e.subscribe(ft(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function hI(n=A4){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function A4(){return new Rs}function py(n){return ht((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function zr(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Ui((r,o)=>n(r,o,i)):Vi,Bi(1),t?dI(e):hI(()=>new Rs))}function Kh(n){return n<=0?()=>Rn:ht((e,t)=>{let i=[];e.subscribe(ft(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function gy(n){return Ui((e,t)=>n<=t)}function Bc(...n){let e=Oo(n);return ht((t,i)=>{(e?Fo(n,t,e):Fo(n,t)).subscribe(i)})}function Wr(n,e){return ht((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(ft(i,l=>{r?.unsubscribe();let u=0,d=o++;ln(n(l,d)).subscribe(r=ft(i,h=>i.next(e?e(l,h,d,u++):h),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Ps(n){return ht((e,t)=>{ln(n).subscribe(ft(t,()=>t.complete(),Oc)),!t.closed&&e.subscribe(t)})}function cr(n,e,t){let i=Ke(n)||e||t?{next:n,error:e,complete:t}:n;return i?ht((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(ft(o,l=>{var u;(u=i.next)===null||u===void 0||u.call(i,l),o.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),o.complete()},l=>{var u;a=!1,(u=i.error)===null||u===void 0||u.call(i,l),o.error(l)},()=>{var l,u;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(u=i.finalize)===null||u===void 0||u.call(i)}))}):Vi}var my;function Yh(){return my}function ur(n){let e=my;return my=n,e}var fI=Symbol("NotFound");function Wa(n){return n===fI||n?.name==="\u0275NotFound"}var ef="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",he=class extends Error{code;constructor(e,t){super(Yr(e,t)),this.code=e}};function P4(n){return`NG0${Math.abs(n)}`}function Yr(n,e){return`${P4(n)}${e?": "+e:""}`}var hr=globalThis;function vt(n){for(let e in n)if(n[e]===vt)return e;throw Error("")}function vI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Kr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Kr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function tf(n,e){return n?e?`${n} ${e}`:n:e||""}var N4=vt({__forward_ref__:vt});function Bo(n){return n.__forward_ref__=Bo,n.toString=function(){return Kr(this())},n}function Pn(n){return Ry(n)?n():n}function Ry(n){return typeof n=="function"&&n.hasOwnProperty(N4)&&n.__forward_ref__===Bo}function ae(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function fr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Wc(n){return k4(n,nf)}function Py(n){return Wc(n)!==null}function k4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function O4(n){let e=n?.[nf]??null;return e||null}function vy(n){return n&&n.hasOwnProperty(Jh)?n[Jh]:null}var nf=vt({\u0275prov:vt}),Jh=vt({\u0275inj:vt}),_e=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ae({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Ny(n){return n&&!!n.\u0275providers}var ky=vt({\u0275cmp:vt}),Oy=vt({\u0275dir:vt}),Fy=vt({\u0275pipe:vt}),Ly=vt({\u0275mod:vt}),Hc=vt({\u0275fac:vt}),Ls=vt({__NG_ELEMENT_ID__:vt}),pI=vt({__NG_ENV_ID__:vt});function Vy(n){return of(n,"@NgModule"),n[Ly]||null}function Qr(n){return of(n,"@Component"),n[ky]||null}function rf(n){return of(n,"@Directive"),n[Oy]||null}function Uy(n){return of(n,"@Pipe"),n[Fy]||null}function of(n,e){if(n==null)throw new he(-919,!1)}function ji(n){return typeof n=="string"?n:n==null?"":String(n)}function _I(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():ji(n)}var EI=vt({ngErrorCode:vt}),F4=vt({ngErrorMessage:vt}),L4=vt({ngTokenPath:vt});function By(n,e){return bI("",-200,e)}function sf(n,e){throw new he(-201,!1)}function bI(n,e,t){let i=new he(e,n);return i[EI]=e,i[F4]=n,t&&(i[L4]=t),i}function V4(n){return n[EI]}var _y;function wI(){return _y}function $n(n){let e=_y;return _y=n,e}function jy(n,e,t){let i=Wc(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;sf(n,"")}var U4={},Ns=U4,B4="__NG_DI_FLAG__",Ey=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=ks(t)||0;try{return this.injector.get(e,i&8?null:Ns,i)}catch(r){if(Wa(r))return r;throw r}}};function j4(n,e=0){let t=Yh();if(t===void 0)throw new he(-203,!1);if(t===null)return jy(n,void 0,e);{let i=H4(e),r=t.retrieve(n,i);if(Wa(r)){if(i.optional)return null;throw r}return r}}function Me(n,e=0){return(wI()||j4)(Pn(n),e)}function z(n,e){return Me(n,ks(e))}function ks(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function H4(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function by(n){let e=[];for(let t=0;t<n.length;t++){let i=Pn(n[t]);if(Array.isArray(i)){if(i.length===0)throw new he(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],l=$4(a);typeof l=="number"?l===-1?r=a.token:o|=l:r=a}e.push(Me(r,o))}else e.push(Me(i))}return e}function $4(n){return n[B4]}function Lo(n,e){let t=n.hasOwnProperty(Hc);return t?n[Hc]:null}function xI(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function SI(n){return n.flat(Number.POSITIVE_INFINITY)}function af(n,e){n.forEach(t=>Array.isArray(t)?af(t,e):e(t))}function Hy(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function qc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function II(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function lf(n,e,t){let i=Ka(n,e);return i>=0?n[i|1]=t:(i=~i,II(n,i,e,t)),i}function cf(n,e){let t=Ka(n,e);if(t>=0)return n[t|1]}function Ka(n,e){return G4(n,e,1)}function G4(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var jo={},Gn=[],pr=new _e(""),$y=new _e("",-1),Gy=new _e(""),$c=class{get(e,t=Ns){if(t===Ns){let r=bI("",-201);throw r.name="\u0275NotFound",r}return t}};function gr(n){return{\u0275providers:n}}function TI(n){return gr([{provide:pr,multi:!0,useValue:n}])}function CI(...n){return{\u0275providers:uf(!0,n),\u0275fromNgModule:!0}}function uf(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return af(e,s=>{let a=s;Zh(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&DI(r,o),t}function DI(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];zy(r,o=>{e(o,i)})}}function Zh(n,e,t,i){if(n=Pn(n),!n)return!1;let r=null,o=vy(n),s=!o&&Qr(n);if(!o&&!s){let l=n.ngModule;if(o=vy(l),o)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let u of l)Zh(u,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let u;af(o.imports,d=>{Zh(d,e,t,i)&&(u||=[],u.push(d))}),u!==void 0&&DI(u,e)}if(!a){let u=Lo(r)||(()=>new r);e({provide:r,useFactory:u,deps:Gn},r),e({provide:Gy,useValue:r,multi:!0},r),e({provide:pr,useValue:()=>Me(r),multi:!0},r)}let l=o.providers;if(l!=null&&!a){let u=n;zy(l,d=>{e(d,u)})}}else return!1;return r!==n&&n.providers!==void 0}function zy(n,e){for(let t of n)Ny(t)&&(t=t.\u0275providers),Array.isArray(t)?zy(t,e):e(t)}var z4=vt({provide:String,useValue:vt});function AI(n){return n!==null&&typeof n=="object"&&z4 in n}function W4(n){return!!(n&&n.useExisting)}function q4(n){return!!(n&&n.useFactory)}function Os(n){return typeof n=="function"}function MI(n){return!!n.useClass}var Kc=new _e(""),Qh={},gI={},yy;function Yc(){return yy===void 0&&(yy=new $c),yy}var Wt=class{},Fs=class extends Wt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,xy(e,s=>this.processProvider(s)),this.records.set($y,qa(void 0,this)),r.has("environment")&&this.records.set(Wt,qa(void 0,this));let o=this.records.get(Kc);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Gy,Gn,{self:!0}))}retrieve(e,t){let i=ks(t)||0;try{return this.get(e,Ns,i)}catch(r){if(Wa(r))return r;throw r}}destroy(){jc(this),this._destroyed=!0;let e=Ve(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ve(e)}}onDestroy(e){return jc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){jc(this);let t=ur(this),i=$n(void 0),r;try{return e()}finally{ur(t),$n(i)}}get(e,t=Ns,i){if(jc(this),e.hasOwnProperty(pI))return e[pI](this);let r=ks(i),o,s=ur(this),a=$n(void 0);try{if(!(r&4)){let u=this.records.get(e);if(u===void 0){let d=Z4(e)&&Wc(e);d&&this.injectableDefInScope(d)?u=qa(wy(e),Qh):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u,r)}let l=r&2?Yc():this.parent;return t=r&8&&t===Ns?null:t,l.get(e,t)}catch(l){let u=V4(l);throw u===-200||u===-201?new he(u,null):l}finally{$n(a),ur(s)}}resolveInjectorInitializers(){let e=Ve(null),t=ur(this),i=$n(void 0),r;try{let o=this.get(pr,Gn,{self:!0});for(let s of o)s()}finally{ur(t),$n(i),Ve(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Kr(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Pn(e);let t=Os(e)?e:Pn(e&&e.provide),i=Y4(e);if(!Os(e)&&e.multi===!0){let r=this.records.get(t);r||(r=qa(void 0,Qh,!0),r.factory=()=>by(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Ve(null);try{if(t.value===gI)throw By(Kr(e));return t.value===Qh&&(t.value=gI,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&J4(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ve(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Pn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function wy(n){let e=Wc(n),t=e!==null?e.factory:Lo(n);if(t!==null)return t;if(n instanceof _e)throw new he(204,!1);if(n instanceof Function)return K4(n);throw new he(204,!1)}function K4(n){if(n.length>0)throw new he(204,!1);let t=O4(n);return t!==null?()=>t.factory(n):()=>new n}function Y4(n){if(AI(n))return qa(void 0,n.useValue);{let e=Wy(n);return qa(e,Qh)}}function Wy(n,e,t){let i;if(Os(n)){let r=Pn(n);return Lo(r)||wy(r)}else if(AI(n))i=()=>Pn(n.useValue);else if(q4(n))i=()=>n.useFactory(...by(n.deps||[]));else if(W4(n))i=(r,o)=>Me(Pn(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Pn(n&&(n.useClass||n.provide));if(Q4(n))i=()=>new r(...by(n.deps));else return Lo(r)||wy(r)}return i}function jc(n){if(n.destroyed)throw new he(205,!1)}function qa(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Q4(n){return!!n.deps}function J4(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Z4(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function xy(n,e){for(let t of n)Array.isArray(t)?xy(t,e):t&&Ny(t)?xy(t.\u0275providers,e):e(t)}function Nn(n,e){let t;n instanceof Fs?(jc(n),t=n):t=new Ey(n);let i,r=ur(t),o=$n(void 0);try{return e()}finally{ur(r),$n(o)}}function RI(){return wI()!==void 0||Yh()!=null}var Wn=0,Ce=1,$e=2,Xt=3,bi=4,wi=5,Qn=6,Ya=7,en=8,si=9,mr=10,xt=11,Qa=12,qy=13,Vs=14,qn=15,Ho=16,Us=17,yr=18,Jr=19,Ky=20,qr=21,df=22,Qc=23,ai=24,Bs=25,js=26,ut=27,PI=1,Hi=6,vr=7,Jc=8,Hs=9,jt=10;function li(n){return Array.isArray(n)&&typeof n[PI]=="object"}function ci(n){return Array.isArray(n)&&n[PI]===!0}function Yy(n){return(n.flags&4)!==0}function Zr(n){return n.componentOffset>-1}function Zc(n){return(n.flags&1)===1}function _r(n){return!!n.template}function $s(n){return(n[$e]&512)!==0}function $o(n){return(n[$e]&256)===256}var Qy="svg",NI="math";function ui(n){for(;Array.isArray(n);)n=n[Wn];return n}function Jy(n,e){return ui(e[n])}function xi(n,e){return ui(e[n.index])}function Gs(n,e){return n.data[e]}function Xc(n,e){return n[e]}function eu(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Si(n,e){let t=e[n];return li(t)?t:t[Wn]}function kI(n){return(n[$e]&4)===4}function hf(n){return(n[$e]&128)===128}function OI(n){return ci(n[Xt])}function Ii(n,e){return e==null?null:n[e]}function Zy(n){n[Us]=0}function Xy(n){n[$e]&1024||(n[$e]|=1024,hf(n)&&Ja(n))}function FI(n,e){for(;n>0;)e=e[Vs],n--;return e}function tu(n){return!!(n[$e]&9216||n[ai]?.dirty)}function ff(n){n[mr].changeDetectionScheduler?.notify(8),n[$e]&64&&(n[$e]|=1024),tu(n)&&Ja(n)}function Ja(n){n[mr].changeDetectionScheduler?.notify(0);let e=Vo(n);for(;e!==null&&!(e[$e]&8192||(e[$e]|=8192,!hf(e)));)e=Vo(e)}function ev(n,e){if($o(n))throw new he(911,!1);n[qr]===null&&(n[qr]=[]),n[qr].push(e)}function LI(n,e){if(n[qr]===null)return;let t=n[qr].indexOf(e);t!==-1&&n[qr].splice(t,1)}function Vo(n){let e=n[Xt];return ci(e)?e[Xt]:e}function tv(n){return n[Ya]??=[]}function nv(n){return n.cleanup??=[]}function VI(n,e,t,i){let r=tv(e);r.push(t),n.firstCreatePass&&nv(n).push(i,r.length-1)}var Ye={lFrame:QI(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Sy=!1;function UI(){return Ye.lFrame.elementDepthCount}function BI(){Ye.lFrame.elementDepthCount++}function iv(){Ye.lFrame.elementDepthCount--}function rv(){return Ye.bindingsEnabled}function ov(){return Ye.skipHydrationRootTNode!==null}function sv(n){return Ye.skipHydrationRootTNode===n}function jI(n){Ye.skipHydrationRootTNode=n}function av(){Ye.skipHydrationRootTNode=null}function Be(){return Ye.lFrame.lView}function tn(){return Ye.lFrame.tView}function le(n){return Ye.lFrame.contextLView=n,n[en]}function ce(n){return Ye.lFrame.contextLView=null,n}function Ln(){let n=lv();for(;n!==null&&n.type===64;)n=n.parent;return n}function lv(){return Ye.lFrame.currentTNode}function HI(){let n=Ye.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function zs(n,e){let t=Ye.lFrame;t.currentTNode=n,t.isParent=e}function cv(){return Ye.lFrame.isParent}function $I(){Ye.lFrame.isParent=!1}function uv(){return Ye.lFrame.contextLView}function dv(){return Sy}function hv(n){let e=Sy;return Sy=n,e}function nu(){let n=Ye.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function fv(){return Ye.lFrame.bindingIndex}function GI(n){return Ye.lFrame.bindingIndex=n}function Ws(){return Ye.lFrame.bindingIndex++}function iu(n){let e=Ye.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function zI(){return Ye.lFrame.inI18n}function WI(n,e){let t=Ye.lFrame;t.bindingIndex=t.bindingRootIndex=n,pf(e)}function qI(){return Ye.lFrame.currentDirectiveIndex}function pf(n){Ye.lFrame.currentDirectiveIndex=n}function KI(n){let e=Ye.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function pv(){return Ye.lFrame.currentQueryIndex}function gf(n){Ye.lFrame.currentQueryIndex=n}function X4(n){let e=n[Ce];return e.type===2?e.declTNode:e.type===1?n[wi]:null}function gv(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=X4(o),r===null||(o=o[Vs],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Ye.lFrame=YI();return i.currentTNode=e,i.lView=n,!0}function mf(n){let e=YI(),t=n[Ce];Ye.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function YI(){let n=Ye.lFrame,e=n===null?null:n.child;return e===null?QI(n):e}function QI(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function JI(){let n=Ye.lFrame;return Ye.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var mv=JI;function yf(){let n=JI();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ZI(n){return(Ye.lFrame.contextLView=FI(n,Ye.lFrame.contextLView))[en]}function Ti(){return Ye.lFrame.selectedIndex}function Go(n){Ye.lFrame.selectedIndex=n}function yv(){let n=Ye.lFrame;return Gs(n.tView,n.selectedIndex)}function X(){Ye.lFrame.currentNamespace=Qy}function Re(){eF()}function eF(){Ye.lFrame.currentNamespace=null}function vv(){return Ye.lFrame.currentNamespace}var XI=!0;function vf(){return XI}function Xr(n){XI=n}function Iy(n,e=null,t=null,i){let r=_v(n,e,t,i);return r.resolveInjectorInitializers(),r}function _v(n,e=null,t=null,i,r=new Set){let o=[t||Gn,CI(n)];return i=i||(typeof n=="object"?void 0:Kr(n)),new Fs(o,e||Yc(),i||null,r)}var zn=class n{static THROW_IF_NOT_FOUND=Ns;static NULL=new $c;static create(e,t){if(Array.isArray(e))return Iy({name:""},t,e,"");{let i=e.name??"";return Iy({name:i},e.parent,e.providers,i)}}static \u0275prov=ae({token:n,providedIn:"any",factory:()=>Me($y)});static __NG_ELEMENT_ID__=-1},qt=new _e(""),Jn=(()=>{class n{static __NG_ELEMENT_ID__=tF;static __NG_ENV_ID__=t=>t}return n})(),Ty=class extends Jn{_lView;constructor(e){super(),this._lView=e}get destroyed(){return $o(this._lView)}onDestroy(e){let t=this._lView;return ev(t,e),()=>LI(t,e)}};function tF(){return new Ty(Be())}var eT=!1,tT=new _e(""),Er=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Mn(!1);debugTaskTracker=z(tT,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new ot(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=ae({token:n,providedIn:"root",factory:()=>new n})}return n})(),Cy=class extends zt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,RI()&&(this.destroyRef=z(Jn,{optional:!0})??void 0,this.pendingTasks=z(Er,{optional:!0})??void 0)}emit(e){let t=Ve(null);try{super.next(e)}finally{Ve(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof yn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},un=Cy;function Xh(...n){}function Ev(n){let e,t;function i(){n=Xh;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function nT(n){return queueMicrotask(()=>n()),()=>{n=Xh}}var bv="isAngularZone",Gc=bv+"_ID",nF=0,vn=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new un(!1);onMicrotaskEmpty=new un(!1);onStable=new un(!1);onError=new un(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=eT}=e;if(typeof Zone>"u")throw new he(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,oF(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(bv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new he(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new he(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,iF,Xh,Xh);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},iF={};function wv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function rF(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){Ev(()=>{n.callbackScheduled=!1,Dy(n),n.isCheckStableRunning=!0,wv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Dy(n)}function oF(n){let e=()=>{rF(n)},t=nF++;n._inner=n._inner.fork({name:"angular",properties:{[bv]:!0,[Gc]:t,[Gc+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(sF(l))return i.invokeTask(o,s,a,l);try{return mI(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),yI(n)}},onInvoke:(i,r,o,s,a,l,u)=>{try{return mI(n),i.invoke(o,s,a,l,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!aF(l)&&e(),yI(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Dy(n),wv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Dy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function mI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function yI(n){n._nesting--,wv(n)}var zc=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new un;onMicrotaskEmpty=new un;onStable=new un;onError=new un;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function sF(n){return iT(n,"__ignore_ng_zone__")}function aF(n){return iT(n,"__scheduler_tick__")}function iT(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var dr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},di=new _e("",{factory:()=>{let n=z(vn),e=z(Wt),t;return i=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw i}):(t??=e.get(dr),t.handleError(i))})}}}),rT={provide:pr,useValue:()=>{let n=z(dr,{optional:!0})},multi:!0},lF=new _e("",{factory:()=>{let n=z(qt).defaultView;if(!n)return;let e=z(di),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),z(Jn).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function xv(){return gr([TI(()=>{z(lF)})])}function $(n,e){let[t,i,r]=ey(n,e?.equal),o=t,s=o[Kn];return o.set=i,o.update=r,o.asReadonly=oT.bind(o),o}function oT(){let n=this[Kn];if(n.readonlyFn===void 0){let e=()=>this();e[Kn]=n,n.readonlyFn=e}return n.readonlyFn}var _f=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=cF}return n})();function cF(){return new _f(Be(),Ln())}var Uo=class{},ru=new _e("",{factory:()=>!0});var Sv=new _e(""),ou=(()=>{class n{internalPendingTasks=z(Er);scheduler=z(Uo);errorHandler=z(di);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=ae({token:n,providedIn:"root",factory:()=>new n})}return n})(),Iv=(()=>{class n{static \u0275prov=ae({token:n,providedIn:"root",factory:()=>new Ay})}return n})(),Ay=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}},My=class{[Kn];constructor(e){this[Kn]=e}destroy(){this[Kn].destroy()}};function dn(n){return ty(n)}var Ef={JSACTION:"jsaction"};function gu(n){return{toString:n}.toString()}function gF(n){return typeof n=="function"}function GT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Mf=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}},eo=(()=>{let n=()=>zT;return n.ngInherit=!0,n})();function zT(n){return n.type.prototype.ngOnChanges&&(n.setInput=yF),mF}function mF(){let n=qT(this),e=n?.current;if(e){let t=n.previous;if(t===jo)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function yF(n,e,t,i,r){let o=this.declaredInputs[i],s=qT(n)||vF(n,{previous:jo,current:null}),a=s.current||(s.current={}),l=s.previous,u=l[o];a[o]=new Mf(u&&u.currentValue,t,l===jo),GT(n,e,r,t)}var WT="__ngSimpleChanges__";function qT(n){return n[WT]||null}function vF(n,e){return n[WT]=e}var sT=[];var pt=function(n,e=null,t){for(let i=0;i<sT.length;i++){let r=sT[i];r(n,e,t)}},st=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(st||{});function _F(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=zT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function KT(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function xf(n,e,t){YT(n,e,3,t)}function Sf(n,e,t,i){(n[$e]&3)===t&&YT(n,e,t,i)}function Tv(n,e){let t=n[$e];(t&3)===e&&(t&=16383,t+=1,n[$e]=t)}function YT(n,e,t,i){let r=i!==void 0?n[Us]&65535:0,o=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(n[Us]+=65536),(a<o||o==-1)&&(EF(n,t,e,l),n[Us]=(n[Us]&4294901760)+l+2),l++}function aT(n,e){pt(st.LifecycleHookStart,n,e);let t=Ve(null);try{e.call(n)}finally{Ve(t),pt(st.LifecycleHookEnd,n,e)}}function EF(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[$e]>>14<n[Us]>>16&&(n[$e]&3)===e&&(n[$e]+=16384,aT(a,o)):aT(a,o)}var Xa=-1,Ys=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function bF(n){return(n.flags&8)!==0}function wF(n){return(n.flags&16)!==0}function xF(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];SF(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function QT(n){return n===3||n===4||n===6}function SF(n){return n.charCodeAt(0)===64}function nl(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?lT(n,t,r,null,e[++i]):lT(n,t,r,null,null))}}return n}function lT(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function JT(n){return n!==Xa}function Rf(n){return n&32767}function IF(n){return n>>16}function Pf(n,e){let t=IF(n),i=e;for(;t>0;)i=i[Vs],t--;return i}var Bv=!0;function Nf(n){let e=Bv;return Bv=n,e}var TF=256,ZT=TF-1,XT=5,CF=0,br={};function DF(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ls)&&(i=t[Ls]),i==null&&(i=t[Ls]=CF++);let r=i&ZT,o=1<<r;e.data[n+(r>>XT)]|=o}function kf(n,e){let t=eC(n,e);if(t!==-1)return t;let i=e[Ce];i.firstCreatePass&&(n.injectorIndex=e.length,Cv(i.data,n),Cv(e,null),Cv(i.blueprint,null));let r=g_(n,e),o=n.injectorIndex;if(JT(r)){let s=Rf(r),a=Pf(r,e),l=a[Ce].data;for(let u=0;u<8;u++)e[o+u]=a[s+u]|l[s+u]}return e[o+8]=r,o}function Cv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function eC(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function g_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=oC(r),i===null)return Xa;if(t++,r=r[Vs],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Xa}function jv(n,e,t){DF(n,e,t)}function AF(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(QT(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function tC(n,e,t){if(t&8||n!==void 0)return n;sf(e,"NodeInjector")}function nC(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[si],o=$n(void 0);try{return r?r.get(e,i,t&8):jy(e,i,t&8)}finally{$n(o)}}return tC(i,e,t)}function iC(n,e,t,i=0,r){if(n!==null){if(e[$e]&2048&&!(i&2)){let s=NF(n,e,t,i,br);if(s!==br)return s}let o=rC(n,e,t,i,br);if(o!==br)return o}return nC(e,t,i,r)}function rC(n,e,t,i,r){let o=RF(t);if(typeof o=="function"){if(!gv(e,n,i))return i&1?tC(r,t,i):nC(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))sf(t);else return s}finally{mv()}}else if(typeof o=="number"){let s=null,a=eC(n,e),l=Xa,u=i&1?e[qn][wi]:null;for((a===-1||i&4)&&(l=a===-1?g_(n,e):e[a+8],l===Xa||!uT(i,!1)?a=-1:(s=e[Ce],a=Rf(l),e=Pf(l,e)));a!==-1;){let d=e[Ce];if(cT(o,a,d.data)){let h=MF(a,e,t,s,i,u);if(h!==br)return h}l=e[a+8],l!==Xa&&uT(i,e[Ce].data[a+8]===u)&&cT(o,a,e)?(s=d,a=Rf(l),e=Pf(l,e)):a=-1}}return r}function MF(n,e,t,i,r,o){let s=e[Ce],a=s.data[n+8],l=i==null?Zr(a)&&Bv:i!=s&&(a.type&3)!==0,u=r&1&&o===a,d=If(a,s,t,l,u);return d!==null?cu(e,s,d,a,r):br}function If(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,u=n.directiveEnd,d=o>>20,h=i?a:a+d,p=r?a+d:u;for(let g=h;g<p;g++){let x=s[g];if(g<l&&t===x||g>=l&&x.type===t)return g}if(r){let g=s[l];if(g&&_r(g)&&g.type===t)return l}return null}function cu(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof Ys){let a=o;if(a.resolving){let g=_I(s[t]);throw By(g)}let l=Nf(a.canSeeViewProviders);a.resolving=!0;let u=s[t].type||s[t],d,h=a.injectImpl?$n(a.injectImpl):null,p=gv(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&_F(t,s[t],e)}finally{h!==null&&$n(h),Nf(l),a.resolving=!1,mv()}}return o}function RF(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Ls)?n[Ls]:void 0;return typeof e=="number"?e>=0?e&ZT:PF:e}function cT(n,e,t){let i=1<<n;return!!(t[e+(n>>XT)]&i)}function uT(n,e){return!(n&2)&&!(n&1&&e)}var Ks=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return iC(this._tNode,this._lView,e,ks(i),t)}};function PF(){return new Ks(Ln(),Be())}function ea(n){return gu(()=>{let e=n.prototype.constructor,t=e[Hc]||Hv(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[Hc]||Hv(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Hv(n){return Ry(n)?()=>{let e=Hv(Pn(n));return e&&e()}:Lo(n)}function NF(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[$e]&2048&&!$s(s);){let a=rC(o,s,t,i|2,br);if(a!==br)return a;let l=o.parent;if(!l){let u=s[Ky];if(u){let d=u.get(t,br,i);if(d!==br)return d}l=oC(s),s=s[Vs]}o=l}return r}function oC(n){let e=n[Ce],t=e.type;return t===2?e.declTNode:t===1?n[wi]:null}function mu(n){return AF(Ln(),n)}function kF(){return al(Ln(),Be())}function al(n,e){return new Di(xi(n,e))}var Di=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=kF}return n})();function OF(n){return n instanceof Di?n.nativeElement:n}function FF(){return this._results[Symbol.iterator]()}var Of=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new zt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=SI(e);(this._changesDetected=!xI(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=FF},sC="ngSkipHydration",LF="ngskiphydration";function aC(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let i=e[t];if(typeof i=="number")return!1;if(typeof i=="string"&&i.toLowerCase()===LF)return!0}return!1}function lC(n){return n.hasAttribute(sC)}function Ff(n){return(n.flags&128)===128}function cC(n){if(Ff(n))return!0;let e=n.parent;for(;e;){if(Ff(n)||aC(e))return!0;e=e.parent}return!1}var m_=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(m_||{}),uC=new Map,VF=0;function UF(){return VF++}function BF(n){uC.set(n[Jr],n)}function $v(n){uC.delete(n[Jr])}var dT="__ngContext__";function il(n,e){li(e)?(n[dT]=e[Jr],BF(e)):n[dT]=e}function dC(n){return fC(n[Qa])}function hC(n){return fC(n[bi])}function fC(n){for(;n!==null&&!ci(n);)n=n[bi];return n}var Gv;function y_(n){Gv=n}function pC(){if(Gv!==void 0)return Gv;if(typeof document<"u")return document;throw new he(210,!1)}var wr=new _e("",{factory:()=>jF}),jF="ng";var Zf=new _e(""),qi=new _e("",{providedIn:"platform",factory:()=>"unknown"});var ll=new _e("",{factory:()=>z(qt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var cl=(()=>{class n{static \u0275prov=ae({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=HF(z(qt),z(wr)),t}});store={};onSerializeCallbacks={};get(t,i){return this.store[t]!==void 0?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function HF(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}var gC="h",mC="b",$F="f",GF="n",yC="e",vC="t",Xf="c",v_="x",uu="r",_C="i",EC="n",__="d";var bC="di",wC="s",xC="p";var yu=new _e(""),SC=!1,E_=new _e("",{factory:()=>SC});var b_=new _e(""),IC=!1,TC=new _e("",{factory:()=>[]}),CC=new _e(""),w_=new _e("",{factory:()=>new Map});var vu="ngb";var DC=(n,e,t)=>{let i=n,r=i.__jsaction_fns??new Map,o=r.get(e)??[];o.push(t),r.set(e,o),i.__jsaction_fns=r},AC=(n,e)=>{let t=n,i=t.getAttribute(vu)??"",r=e.get(i)??new Set;r.has(t)||r.add(t),e.set(i,r)};var MC=n=>{n.removeAttribute(Ef.JSACTION),n.removeAttribute(vu),n.__jsaction_fns=void 0},RC=new _e("",{factory:()=>({})});function x_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let i of t)i(n)}var zv=new Map;function PC(n,e){return zv.set(n,e),()=>zv.delete(n)}var hT=!1,NC=(n,e,t,i)=>{};function zF(n,e,t,i){NC(n,e,t,i)}function kC(){hT||(NC=(n,e,t,i)=>{let r=n[si].get(wr);zv.get(r)?.(e,t,i)},hT=!0)}var ep=new _e("");function tp(n){return(n.flags&32)===32}var WF="__nghData__",S_=WF,qF="__nghDeferData__",OC=qF;var Tf="ngh",FC="nghm",LC=()=>null;function KF(n,e,t=!1){let i=n.getAttribute(Tf);if(i==null)return null;let[r,o]=i.split("|");if(i=t?o:r,!i)return null;let s=o?`|${o}`:"",a=t?r:s,l={};if(i!==""){let d=e.get(cl,null,{optional:!0});d!==null&&(l=d.get(S_,[])[Number(i)])}let u={data:l,firstChild:n.firstChild??null};return t&&(u.firstChild=n,np(u,0,n.nextSibling)),a?n.setAttribute(Tf,a):n.removeAttribute(Tf),u}function VC(){LC=KF}function UC(n,e,t=!1){return LC(n,e,t)}function BC(n){let e=n._lView;return e[Ce].type===2?null:($s(e)&&(e=e[ut]),e)}function YF(n){return n.textContent?.replace(/\s/gm,"")}function QF(n){let e=pC(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=YF(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),i,r=[];for(;i=t.nextNode();)r.push(i);for(let o of r)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function np(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function Wv(n,e){return n.segmentHeads?.[e]??null}function jC(n){return n.get(CC,!1,{optional:!0})}function JF(n,e){let t=n.data,i=t[yC]?.[e]??null;return i===null&&t[Xf]?.[e]&&(i=I_(n,e)),i}function HC(n,e){return n.data[Xf]?.[e]??null}function I_(n,e){let t=HC(n,e)??[],i=0;for(let r of t)i+=r[uu]*(r[v_]??1);return i}function ZF(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[__];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function $C(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[__];n.disconnectedNodes=t?new Set(t):null}return!!ZF(n)?.has(e)}function ip(n,e){let t=n[Qn];return t!==null&&!ov()&&!tp(e)&&!$C(t,e.index-ut)}function XF(n,e){let t=e.get(ep),r=e.get(cl).get(OC,{}),o=!1,s=n,a=null,l=[];for(;!o&&s;){o=t.has(s);let u=t.hydrating.get(s);if(a===null&&u!=null){a=u.promise;break}l.unshift(s),s=r[s][xC]}return{parentBlockPromise:a,hydrationQueue:l}}function Dv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===FC}function fT(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function GC(n){for(let i of n.body.childNodes)if(Dv(i))return;let e=fT(n.body.previousSibling);if(Dv(e))return;let t=fT(n.head.lastChild);if(!Dv(t))throw new he(-507,!1)}function zC(n,e){let t=n.contentQueries;if(t!==null){let i=Ve(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];gf(o),a.contentQueries(2,e[s],s)}}}finally{Ve(i)}}}function qv(n,e,t){gf(0);let i=Ve(null);try{e(n,t)}finally{Ve(i)}}function WC(n,e,t){if(Yy(e)){let i=Ve(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ve(i)}}}var zi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(zi||{});var bf;function e3(){if(bf===void 0&&(bf=null,hr.trustedTypes))try{bf=hr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return bf}function pT(n){return e3()?.createScriptURL(n)||n}var Lf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ef})`}};function ul(n){return n instanceof Lf?n.changingThisBreaksApplicationSecurity:n}function rp(n,e){let t=qC(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${ef})`)}return t===e}function qC(n){return n instanceof Lf&&n.getTypeName()||null}var t3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function T_(n){return n=String(n),n.match(t3)?n:"unsafe:"+n}var n3=/^>|^->|<!--|-->|--!>|<!-$/g,i3=/(<|>)/g,r3="\u200B$1\u200B";function o3(n){return n.replace(n3,e=>e.replace(i3,r3))}function KC(n,e){return n.createText(e)}function s3(n,e,t){n.setValue(e,t)}function YC(n,e){return n.createComment(o3(e))}function C_(n,e,t){return n.createElement(e,t)}function Vf(n,e,t,i,r){n.insertBefore(e,t,i,r)}function QC(n,e,t){n.appendChild(e,t)}function gT(n,e,t,i,r){i!==null?Vf(n,e,t,i,r):QC(n,e,t)}function D_(n,e,t,i){n.removeChild(null,e,t,i)}function JC(n){n.textContent=""}function a3(n,e,t){n.setAttribute(e,"style",t)}function l3(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function ZC(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&xF(n,e,i),r!==null&&l3(n,e,r),o!==null&&a3(n,e,o)}var _u=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(_u||{});function Ki(n){let e=eD();return e?e.sanitize(_u.URL,n)||"":rp(n,"URL")?ul(n):T_(ji(n))}function XC(n){let e=eD();if(e)return pT(e.sanitize(_u.RESOURCE_URL,n)||"");if(rp(n,"ResourceURL"))return pT(ul(n));throw new he(904,!1)}var c3=new Set(["embed","frame","iframe","media","script"]),u3=new Set(["base","link","script"]);function d3(n,e){return e==="src"&&c3.has(n)||e==="href"&&u3.has(n)||e==="xlink:href"&&n==="script"?XC:Ki}function A_(n,e,t){return d3(e,t)(n)}function eD(){let n=Be();return n&&n[mr].sanitizer}function ta(n){return n.ownerDocument.defaultView}function tD(n){return n.ownerDocument.body}function nD(n){return n instanceof Function?n():n}function h3(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var iD="ng-template";function f3(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&h3(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(M_(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function M_(n){return n.type===4&&n.value!==iD}function p3(n,e,t){let i=n.type===4&&!t?iD:n.value;return e===i}function g3(n,e,t){let i=4,r=n.attrs,o=r!==null?v3(r):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!$i(i)&&!$i(l))return!1;if(s&&$i(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!p3(n,l,t)||l===""&&e.length===1){if($i(i))return!1;s=!0}}else if(i&8){if(r===null||!f3(n,r,l,t)){if($i(i))return!1;s=!0}}else{let u=e[++a],d=m3(l,r,M_(n),t);if(d===-1){if($i(i))return!1;s=!0;continue}if(u!==""){let h;if(d>o?h="":h=r[d+1].toLowerCase(),i&2&&u!==h){if($i(i))return!1;s=!0}}}}return $i(i)||s}function $i(n){return(n&1)===0}function m3(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return _3(e,n)}function y3(n,e,t=!1){for(let i=0;i<e.length;i++)if(g3(n,e[i],t))return!0;return!1}function v3(n){for(let e=0;e<n.length;e++){let t=n[e];if(QT(t))return e}return n.length}function _3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function mT(n,e){return n?":not("+e.trim()+")":e}function E3(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!$i(s)&&(e+=mT(o,r),r=""),i=s,o=o||!$i(i);t++}return r!==""&&(e+=mT(o,r)),e}function b3(n){return n.map(E3).join(",")}function w3(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!$i(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var xn={};function R_(n,e,t,i,r,o,s,a,l,u,d){let h=ut+i,p=h+r,g=x3(h,p),x=typeof u=="function"?u():u;return g[Ce]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:x,incompleteFirstPass:!1,ssrId:d}}function x3(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:xn);return t}function S3(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=R_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function P_(n,e,t,i,r,o,s,a,l,u,d){let h=e.blueprint.slice();return h[Wn]=r,h[$e]=i|4|128|8|64|1024,(u!==null||n&&n[$e]&2048)&&(h[$e]|=2048),Zy(h),h[Xt]=h[Vs]=n,h[en]=t,h[mr]=s||n&&n[mr],h[xt]=a||n&&n[xt],h[si]=l||n&&n[si]||null,h[wi]=o,h[Jr]=UF(),h[Qn]=d,h[Ky]=u,h[qn]=e.type==2?n[qn]:h,h}function I3(n,e,t){let i=xi(e,n),r=S3(t),o=n[mr].rendererFactory,s=N_(n,P_(n,r,null,rD(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function rD(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function oD(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function N_(n,e){return n[Qa]?n[qy][bi]=e:n[Qa]=e,n[qy]=e,e}function y(n=1){sD(tn(),Be(),Ti()+n,!1)}function sD(n,e,t,i){if(!i)if((e[$e]&3)===3){let o=n.preOrderCheckHooks;o!==null&&xf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Sf(e,o,0,t)}Go(t)}var op=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(op||{});function Kv(n,e,t,i){let r=Ve(null);try{let[o,s,a]=n.inputs[t],l=null;(s&op.SignalBased)!==0&&(l=e[o][Kn]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,l,i,t,o):GT(e,l,o,i)}finally{Ve(r)}}var Wi=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Wi||{}),T3;function k_(n,e){return T3(n,e)}var Qs=new Set,sp=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(sp||{}),qo=new _e(""),yT=new Set;function fi(n){yT.has(n)||(yT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var O_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=ae({token:n,providedIn:"root",factory:()=>new n})}return n})(),aD=[0,1,2,3],lD=(()=>{class n{ngZone=z(vn);scheduler=z(Uo);errorHandler=z(dr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){z(qo,{optional:!0})}execute(){let t=this.sequences.size>0;t&&pt(st.AfterRenderHooksStart),this.executing=!0;for(let i of aD)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&pt(st.AfterRenderHooksEnd)}register(t){let{view:i}=t;i!==void 0?((i[Bs]??=[]).push(t),Ja(i),i[$e]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(sp.AFTER_NEXT_RENDER,t):t()}static \u0275prov=ae({token:n,providedIn:"root",factory:()=>new n})}return n})(),Uf=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Bs];e&&(this.view[Bs]=e.filter(t=>t!==this))}};function Eu(n,e){let t=e?.injector??z(zn);return fi("NgAfterNextRender"),D3(n,t,e,!0)}function C3(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function D3(n,e,t,i){let r=e.get(O_);r.impl??=e.get(lD);let o=e.get(qo,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Jn):null,a=e.get(_f,null,{optional:!0}),l=new Uf(r.impl,C3(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(l),l}var cD=new _e("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:z(Wt)})});function uD(n,e,t){let i=n.get(cD);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function A3(n,e){let t=n.get(cD);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function M3(n,e){for(let[t,i]of e)uD(n,i.animateFns)}function vT(n,e,t,i){let r=n?.[js]?.enter;e!==null&&r&&r.has(t.index)&&M3(i,r)}function Za(n,e,t,i,r,o,s,a){if(r!=null){let l,u=!1;ci(r)?l=r:li(r)&&(u=!0,r=r[Wn]);let d=ui(r);n===0&&i!==null?(vT(a,i,o,t),s==null?QC(e,i,d):Vf(e,i,d,s||null,!0)):n===1&&i!==null?(vT(a,i,o,t),Vf(e,i,d,s||null,!0)):n===2?_T(a,o,t,h=>{D_(e,d,u,h)}):n===3&&_T(a,o,t,()=>{e.destroyNode(d)}),l!=null&&$3(e,n,t,l,o,i,s)}}function R3(n,e){dD(n,e),e[Wn]=null,e[wi]=null}function P3(n,e,t,i,r,o){i[Wn]=r,i[wi]=e,lp(n,i,t,1,r,o)}function dD(n,e){e[mr].changeDetectionScheduler?.notify(9),lp(n,e,e[xt],2,null,null)}function N3(n){let e=n[Qa];if(!e)return Av(n[Ce],n);for(;e;){let t=null;if(li(e))t=e[Qa];else{let i=e[jt];i&&(t=i)}if(!t){for(;e&&!e[bi]&&e!==n;)li(e)&&Av(e[Ce],e),e=e[Xt];e===null&&(e=n),li(e)&&Av(e[Ce],e),t=e&&e[bi]}e=t}}function F_(n,e){let t=n[Hs],i=t.indexOf(e);t.splice(i,1)}function ap(n,e){if($o(e))return;let t=e[xt];t.destroyNode&&lp(n,e,t,3,null,null),N3(e)}function Av(n,e){if($o(e))return;let t=Ve(null);try{e[$e]&=-129,e[$e]|=256,e[ai]&&Nc(e[ai]),F3(n,e),O3(n,e),e[Ce].type===1&&e[xt].destroy();let i=e[Ho];if(i!==null&&ci(e[Xt])){i!==e[Xt]&&F_(i,e);let r=e[yr];r!==null&&r.detachView(n)}$v(e)}finally{Ve(t)}}function _T(n,e,t,i){let r=n?.[js];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&Qs.add(n[Jr]),uD(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let u=s.animateFns[l],{promise:d}=u();a.push(d)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),k3(n,i)}else n&&Qs.delete(n[Jr]),i(!1)},r)}function k3(n,e){let t=n[js]?.running;if(t){t.then(()=>{n[js].running=void 0,Qs.delete(n[Jr]),e(!0)});return}e(!1)}function O3(n,e){let t=n.cleanup,i=e[Ya];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[Ya]=null);let r=e[qr];if(r!==null){e[qr]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[Qc];if(o!==null){e[Qc]=null;for(let s of o)s.destroy()}}function F3(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Ys)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],l=o[s+1];pt(st.LifecycleHookStart,a,l);try{l.call(a)}finally{pt(st.LifecycleHookEnd,a,l)}}else{pt(st.LifecycleHookStart,r,o);try{o.call(r)}finally{pt(st.LifecycleHookEnd,r,o)}}}}}function L3(n,e,t){return V3(n,e.parent,t)}function V3(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Wn];if(Zr(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===zi.None||r===zi.Emulated)return null}return xi(i,t)}function U3(n,e,t){return j3(n,e,t)}function B3(n,e,t){return n.type&40?xi(n,t):null}var j3=B3,ET;function L_(n,e,t,i){let r=L3(n,i,e),o=e[xt],s=i.parent||e[wi],a=U3(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)gT(o,r,t[l],a,!1);else gT(o,r,t,a,!1);ET!==void 0&&ET(o,i,e,t,r)}function au(n,e){if(e!==null){let t=e.type;if(t&3)return xi(e,n);if(t&4)return Yv(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return au(n,i);{let r=n[e.index];return ci(r)?Yv(-1,r):ui(r)}}else{if(t&128)return au(n,e.next);if(t&32)return k_(e,n)()||ui(n[e.index]);{let i=hD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=Vo(n[qn]);return au(r,i)}else return au(n,e.next)}}}return null}function hD(n,e){if(e!==null){let i=n[qn][wi],r=e.projection;return i.projection[r]}return null}function Yv(n,e){let t=jt+n+1;if(t<e.length){let i=e[t],r=i[Ce].firstChild;if(r!==null)return au(i,r)}return e[vr]}function V_(n,e,t,i,r,o,s){for(;t!=null;){let a=i[si];if(t.type===128){t=t.next;continue}let l=i[t.index],u=t.type;if(s&&e===0&&(l&&il(ui(l),i),t.flags|=2),!tp(t))if(u&8)V_(n,e,t.child,i,r,o,!1),Za(e,n,a,r,l,t,o,i);else if(u&32){let d=k_(t,i),h;for(;h=d();)Za(e,n,a,r,h,t,o,i);Za(e,n,a,r,l,t,o,i)}else u&16?H3(n,e,i,t,r,o):Za(e,n,a,r,l,t,o,i);t=s?t.projectionNext:t.next}}function lp(n,e,t,i,r,o){V_(t,i,n.firstChild,e,r,o,!1)}function H3(n,e,t,i,r,o){let s=t[qn],l=s[wi].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++){let d=l[u];Za(e,n,t[si],r,d,i,o,t)}else{let u=l,d=s[Xt];Ff(i)&&(u.flags|=128),V_(n,e,u,d,r,o,!0)}}function $3(n,e,t,i,r,o,s){let a=i[vr],l=ui(i);a!==l&&Za(e,n,t,o,a,r,s);for(let u=jt;u<i.length;u++){let d=i[u];lp(d[Ce],d,n,e,o,a)}}function G3(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:Wi.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Wi.Important),n.setStyle(t,i,r,o))}}function fD(n,e,t,i,r){let o=Ti(),s=i&2;try{Go(-1),s&&e.length>ut&&sD(n,e,ut,!1);let a=s?st.TemplateUpdateStart:st.TemplateCreateStart;pt(a,r,t),t(i,r)}finally{Go(o);let a=s?st.TemplateUpdateEnd:st.TemplateCreateEnd;pt(a,r,t)}}function U_(n,e,t){Z3(n,e,t),(t.flags&64)===64&&X3(n,e,t)}function cp(n,e,t=xi){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function z3(n,e,t,i){let o=i.get(E_,SC)||t===zi.ShadowDom||t===zi.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return W3(s),s}function W3(n){pD(n)}var pD=()=>null;function q3(n){lC(n)?JC(n):QF(n)}function gD(){pD=q3}function K3(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function Y3(n,e,t,i,r,o){let s=e[Ce];if(j_(n,s,e,t,i)){Zr(n)&&J3(e,n.index);return}n.type&3&&(t=K3(t)),Q3(n,e,t,i,r,o)}function Q3(n,e,t,i,r,o){if(n.type&3){let s=xi(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function J3(n,e){let t=Si(e,n);t[$e]&16||(t[$e]|=64)}function Z3(n,e,t){let i=t.directiveStart,r=t.directiveEnd;Zr(t)&&I3(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||kf(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],l=cu(e,n,s,t);if(il(l,e),o!==null&&iL(e,s-i,l,a,t,o),_r(a)){let u=Si(t.index,e);u[en]=cu(e,n,s,t)}}}function X3(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=qI();try{Go(o);for(let a=i;a<r;a++){let l=n.data[a],u=e[a];pf(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&eL(l,u)}}finally{Go(-1),pf(s)}}function eL(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function mD(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];y3(e,o.selectors,!1)&&(i??=[],_r(o)?i.unshift(o):i.push(o))}return i}function tL(n,e,t,i,r,o){let s=xi(n,e);nL(e[xt],s,o,n.value,t,i,r)}function nL(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?ji(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function iL(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],u=s[a+1];Kv(i,t,l,u)}}function yD(n,e,t,i,r){let o=ut+t,s=e[Ce],a=r(s,e,n,i,t);e[o]=a,zs(n,!0);let l=n.type===2;return l?(ZC(e[xt],a,n),(UI()===0||Zc(n))&&il(a,e),BI()):il(a,e),vf()&&(!l||!tp(n))&&L_(s,e,a,n),n}function vD(n){let e=n;return cv()?$I():(e=e.parent,zs(e,!1)),e}function B_(n,e){let t=n[si];if(!t)return;let i;try{i=t.get(di,null)}catch{i=null}i?.(e)}function j_(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let u=s[l],d=s[l+1],h=e.data[u];Kv(h,t[u],d,r),a=!0}if(o)for(let l of o){let u=t[l],d=e.data[l];Kv(d,u,i,r),a=!0}return a}function rL(n,e){let t=Si(e,n),i=t[Ce];oL(i,t);let r=t[Wn];r!==null&&t[Qn]===null&&(t[Qn]=UC(r,t[si])),pt(st.ComponentStart);try{H_(i,t,t[en])}finally{pt(st.ComponentEnd,t[en])}}function oL(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function H_(n,e,t){mf(e);try{let i=n.viewQuery;i!==null&&qv(1,i,t);let r=n.template;r!==null&&fD(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[yr]?.finishViewCreation(n),n.staticContentQueries&&zC(n,e),n.staticViewQueries&&qv(2,n.viewQuery,t);let o=n.components;o!==null&&sL(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[$e]&=-5,yf()}}function sL(n,e){for(let t=0;t<e.length;t++)rL(n,e[t])}function bu(n,e,t,i){let r=Ve(null);try{let o=e.tView,a=n[$e]&4096?4096:16,l=P_(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),u=n[e.index];l[Ho]=u;let d=n[yr];return d!==null&&(l[yr]=d.createEmbeddedView(o)),H_(o,l,t),l}finally{Ve(r)}}function rl(n,e){return!e||e.firstChild===null||Ff(n)}function du(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(ui(o)),ci(o)&&_D(o,i);let s=t.type;if(s&8)du(n,e,t.child,i);else if(s&32){let a=k_(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=hD(e,t);if(Array.isArray(a))i.push(...a);else{let l=Vo(e[qn]);du(l[Ce],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function _D(n,e){for(let t=jt;t<n.length;t++){let i=n[t],r=i[Ce].firstChild;r!==null&&du(i[Ce],i,r,e)}n[vr]!==n[Wn]&&e.push(n[vr])}function ED(n){if(n[Bs]!==null){for(let e of n[Bs])e.impl.addSequence(e);n[Bs].length=0}}var bD=[];function aL(n){return n[ai]??lL(n)}function lL(n){let e=bD.pop()??Object.create(uL);return e.lView=n,e}function cL(n){n.lView[ai]!==n&&(n.lView=null,bD.push(n))}var uL=pe(F({},Mc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Ja(n.lView)},consumerOnSignalRead(){this.lView[ai]=this}});function dL(n){let e=n[ai]??Object.create(hL);return e.lView=n,e}var hL=pe(F({},Mc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Vo(n.lView);for(;e&&!wD(e[Ce]);)e=Vo(e);e&&Xy(e)},consumerOnSignalRead(){this.lView[ai]=this}});function wD(n){return n.type!==2}function xD(n){if(n[Qc]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[Qc])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[$e]&8192)}}var fL=100;function SD(n,e=0){let i=n[mr].rendererFactory,r=!1;r||i.begin?.();try{pL(n,e)}finally{r||i.end?.()}}function pL(n,e){let t=dv();try{hv(!0),Qv(n,e);let i=0;for(;tu(n);){if(i===fL)throw new he(103,!1);i++,Qv(n,1)}}finally{hv(t)}}function gL(n,e,t,i){if($o(e))return;let r=e[$e],o=!1,s=!1;mf(e);let a=!0,l=null,u=null;o||(wD(n)?(u=aL(e),l=Pc(u)):yh()===null?(a=!1,u=dL(e),l=Pc(u)):e[ai]&&(Nc(e[ai]),e[ai]=null));try{Zy(e),GI(n.bindingStartIndex),t!==null&&fD(n,e,t,2,i);let d=(r&3)===3;if(!o)if(d){let g=n.preOrderCheckHooks;g!==null&&xf(e,g,null)}else{let g=n.preOrderHooks;g!==null&&Sf(e,g,0,null),Tv(e,0)}if(s||mL(e),xD(e),ID(e,0),n.contentQueries!==null&&zC(n,e),!o)if(d){let g=n.contentCheckHooks;g!==null&&xf(e,g)}else{let g=n.contentHooks;g!==null&&Sf(e,g,1),Tv(e,1)}vL(n,e);let h=n.components;h!==null&&CD(e,h,0);let p=n.viewQuery;if(p!==null&&qv(2,p,i),!o)if(d){let g=n.viewCheckHooks;g!==null&&xf(e,g)}else{let g=n.viewHooks;g!==null&&Sf(e,g,2),Tv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[df]){for(let g of e[df])g();e[df]=null}o||(ED(e),e[$e]&=-73)}catch(d){throw o||Ja(e),d}finally{u!==null&&(vh(u,l),a&&cL(u)),yf()}}function ID(n,e){for(let t=dC(n);t!==null;t=hC(t))for(let i=jt;i<t.length;i++){let r=t[i];TD(r,e)}}function mL(n){for(let e=dC(n);e!==null;e=hC(e)){if(!(e[$e]&2))continue;let t=e[Hs];for(let i=0;i<t.length;i++){let r=t[i];Xy(r)}}}function yL(n,e,t){pt(st.ComponentStart);let i=Si(e,n);try{TD(i,t)}finally{pt(st.ComponentEnd,i[en])}}function TD(n,e){hf(n)&&Qv(n,e)}function Qv(n,e){let i=n[Ce],r=n[$e],o=n[ai],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&_h(o)),s||=!1,o&&(o.dirty=!1),n[$e]&=-9217,s)gL(i,n,i.template,n[en]);else if(r&8192){let a=Ve(null);try{xD(n),ID(n,1);let l=i.components;l!==null&&CD(n,l,1),ED(n)}finally{Ve(a)}}}function CD(n,e,t){for(let i=0;i<e.length;i++)yL(n,e[i],t)}function vL(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)Go(~r);else{let o=r,s=t[++i],a=t[++i];WI(s,o);let l=e[o];pt(st.HostBindingsUpdateStart,l);try{a(2,l)}finally{pt(st.HostBindingsUpdateEnd,l)}}}}finally{Go(-1)}}function up(n,e){let t=dv()?64:1088;for(n[mr].changeDetectionScheduler?.notify(e);n;){n[$e]|=t;let i=Vo(n);if($s(n)&&!i)return n;n=i}return null}function DD(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function AD(n,e){let t=jt+e;if(t<n.length)return n[t]}function wu(n,e,t,i=!0){let r=e[Ce];if(_L(r,e,n,t),i){let s=Yv(t,n),a=e[xt],l=a.parentNode(n[vr]);l!==null&&P3(r,n[wi],a,e,l,s)}let o=e[Qn];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function $_(n,e){let t=hu(n,e);return t!==void 0&&ap(t[Ce],t),t}function hu(n,e){if(n.length<=jt)return;let t=jt+e,i=n[t];if(i){let r=i[Ho];r!==null&&r!==n&&F_(r,i),e>0&&(n[t-1][bi]=i[bi]);let o=qc(n,jt+e);R3(i[Ce],i);let s=o[yr];s!==null&&s.detachView(o[Ce]),i[Xt]=null,i[bi]=null,i[$e]&=-129}return i}function _L(n,e,t,i){let r=jt+i,o=t.length;i>0&&(t[r-1][bi]=e),i<o-jt?(e[bi]=t[r],Hy(t,jt+i,e)):(t.push(e),e[bi]=null),e[Xt]=t;let s=e[Ho];s!==null&&t!==s&&MD(s,e);let a=e[yr];a!==null&&a.insertView(n),ff(e),e[$e]|=128}function MD(n,e){let t=n[Hs],i=e[Xt];if(li(i))n[$e]|=2;else{let r=i[Xt][qn];e[qn]!==r&&(n[$e]|=2)}t===null?n[Hs]=[e]:t.push(e)}var zo=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Ce];return du(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[en]}set context(e){this._lView[en]=e}get destroyed(){return $o(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Xt];if(ci(e)){let t=e[Jc],i=t?t.indexOf(this):-1;i>-1&&(hu(e,i),qc(t,i))}this._attachedToViewContainer=!1}ap(this._lView[Ce],this._lView)}onDestroy(e){ev(this._lView,e)}markForCheck(){up(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[$e]&=-129}reattach(){ff(this._lView),this._lView[$e]|=128}detectChanges(){this._lView[$e]|=1024,SD(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new he(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=$s(this._lView),t=this._lView[Ho];t!==null&&!e&&F_(t,this._lView),dD(this._lView[Ce],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new he(902,!1);this._appRef=e;let t=$s(this._lView),i=this._lView[Ho];i!==null&&!t&&MD(i,this._lView),ff(this._lView)}};var Wo=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=EL;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=bu(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new zo(o)}}return n})();function EL(){return dp(Ln(),Be())}function dp(n,e){return n.type&4?new Wo(e,n,al(n,e)):null}function dl(n,e,t,i,r){let o=n.data[e];if(o===null)o=bL(n,e,t,i,r),zI()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=HI();o.injectorIndex=s===null?-1:s.injectorIndex}return zs(o,!0),o}function bL(n,e,t,i,r){let o=lv(),s=cv(),a=s?o:o&&o.parent,l=n.data[e]=xL(n,a,t,e,i,r);return wL(n,l,o,s),l}function wL(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function xL(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return ov()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var SL=new RegExp(`^(\\d+)*(${mC}|${gC})*(.*)`);function IL(n){let e=n.match(SL),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(let[l,u,d]of o.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(u,h)}return[s,...a]}function TL(n){return!n.prev&&n.parent?.type===8}function Mv(n){return n.index-ut}function CL(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function hp(n,e,t,i){let r=Mv(i),o=CL(n,r);if(o===void 0){let s=n.data[EC];if(s?.[r])o=AL(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{let a=i.prev===null,l=i.prev??i.parent;if(TL(i)){let u=Mv(i.parent);o=Wv(n,u)}else{let u=xi(l,t);if(a)o=u.firstChild;else{let d=Mv(l),h=Wv(n,d);if(l.type===2&&h){let g=I_(n,d)+1;o=fp(g,h)}else o=u.nextSibling}}}}return o}function fp(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}function DL(n,e){let t=n;for(let i=0;i<e.length;i+=2){let r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case $F:t=t.firstChild;break;case GF:t=t.nextSibling;break}}return t}function AL(n,e){let[t,...i]=IL(n),r;if(t===gC)r=e[qn][Wn];else if(t===mC)r=tD(e[qn][Wn]);else{let o=Number(t);r=ui(e[o+ut])}return DL(r,i)}var ML=!1;function RD(n){ML=n}function RL(n){let e=n[Qn];if(e){let{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){let r=n[xt];for(let o of i.values())PL(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function PL(n,e,t){for(let i of t.node.cases[t.case]){let r=e.get(i.index-ut);r&&D_(n,r,!1)}}function pp(n){let e=n[Hi]??[],i=n[Xt][xt],r=[];for(let o of e)o.data[bC]!==void 0?r.push(o):PD(o,i);n[Hi]=r}function NL(n){let{lContainer:e}=n,t=e[Hi];if(t===null)return;let r=e[Xt][xt];for(let o of t)PD(o,r)}function PD(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[uu];for(;t<r;){let o=i.nextSibling;D_(e,i,!1),i=o,t++}}}function gp(n){pp(n);let e=n[Wn];li(e)&&Bf(e);for(let t=jt;t<n.length;t++)Bf(n[t])}function Bf(n){RL(n);let e=n[Ce];for(let t=ut;t<e.bindingStartIndex;t++)if(ci(n[t])){let i=n[t];gp(i)}else li(n[t])&&Bf(n[t])}function G_(n){let e=n._views;for(let t of e){let i=BC(t);i!==null&&i[Wn]!==null&&(li(i)?Bf(i):gp(i))}}function kL(n,e,t,i){n!==null&&(t.cleanup(e),gp(n.lContainer),G_(i))}function OL(n,e){let t=[];for(let i of e)for(let r=0;r<(i[v_]??1);r++){let o={data:i,firstChild:null};i[uu]>0&&(o.firstChild=n,n=fp(i[uu],n)),t.push(o)}return[n,t]}var ND=()=>null,kD=()=>null;function OD(){ND=FL,kD=LL}function FL(n,e){return LD(n,e)?n[Hi].shift():(pp(n),null)}function jf(n,e){return ND(n,e)}function LL(n,e,t){if(e.tView.ssrId===null)return null;let i=jf(n,e.tView.ssrId);return t[Ce].firstUpdatePass&&i===null&&VL(t,e),i}function FD(n,e,t){return kD(n,e,t)}function VL(n,e){let t=e;for(;t;){if(bT(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(bT(n,t))return;t=t.next}}function LD(n,e){let t=n[Hi];return!e||t===null||t.length===0?!1:t[0].data[_C]===e}function bT(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let i=n[e.index];return ci(i)&&LD(i,t)?(pp(i),!0):!1}var VD=class{},mp=class{},Jv=class{resolveComponentFactory(e){throw new he(917,!1)}},xu=class{static NULL=new Jv},Js=class{},Ko=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>UL()}return n})();function UL(){let n=Be(),e=Ln(),t=Si(e.index,n);return(li(t)?t:n)[xt]}var UD=(()=>{class n{static \u0275prov=ae({token:n,providedIn:"root",factory:()=>null})}return n})();var Cf={},el=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,Cf,i);return r!==Cf||t===Cf?r:this.parentInjector.get(e,t,i)}};function Hf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=tf(r,a);else if(o==2){let l=a,u=e[++s];i=tf(i,l+": "+u+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function ye(n,e=0){let t=Be();if(t===null)return Me(n,e);let i=Ln();return iC(i,t,Pn(n),e)}function BD(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,l=null,u=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,l,u]=d.resolveHostDirectives(s);break}HL(n,e,t,a,o,l,u)}o!==null&&i!==null&&BL(t,i,o)}function BL(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new he(-301,!1);i.push(e[r],o)}}function jL(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function HL(n,e,t,i,r,o,s){let a=i.length,l=null;for(let p=0;p<a;p++){let g=i[p];l===null&&_r(g)&&(l=g,jL(n,t,p)),jv(kf(t,e),n,g.type)}KL(t,n.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let p=0;p<a;p++){let g=i[p];g.providersResolver&&g.providersResolver(g)}let u=!1,d=!1,h=oD(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let p=0;p<a;p++){let g=i[p];if(t.mergedAttrs=nl(t.mergedAttrs,g.hostAttrs),GL(n,t,e,h,g),qL(h,g,r),s!==null&&s.has(g)){let[S,N]=s.get(g);t.directiveToIndex.set(g.type,[h,S+t.directiveStart,N+t.directiveStart])}else(o===null||!o.has(g))&&t.directiveToIndex.set(g.type,h);g.contentQueries!==null&&(t.flags|=4),(g.hostBindings!==null||g.hostAttrs!==null||g.hostVars!==0)&&(t.flags|=64);let x=g.type.prototype;!u&&(x.ngOnChanges||x.ngOnInit||x.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),u=!0),!d&&(x.ngOnChanges||x.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}$L(n,t,o)}function $L(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))wT(0,e,r,i),wT(1,e,r,i),ST(e,i,!1);else{let o=t.get(r);xT(0,e,o,i),xT(1,e,o,i),ST(e,i,!0)}}}function wT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),jD(e,o)}}function xT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),jD(e,s)}}function jD(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function ST(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||M_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&r.hasOwnProperty(l)){let u=r[l];for(let d of u)if(d===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let u=o[l];for(let d=0;d<u.length;d+=2)if(u[d]===e){s??=[],s.push(u[d+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function GL(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Lo(r.type,!0)),s=new Ys(o,_r(r),ye,null);n.blueprint[i]=s,t[i]=s,zL(n,e,i,oD(n,t,r.hostVars,xn),r)}function zL(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;WL(s)!=a&&s.push(a),s.push(t,i,o)}}function WL(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function qL(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;_r(e)&&(t[""]=n)}}function KL(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function HD(n,e,t,i,r,o,s,a){let l=e[Ce],u=l.consts,d=Ii(u,s),h=dl(l,n,t,i,d);return o&&BD(l,e,h,Ii(u,a),r),h.mergedAttrs=nl(h.mergedAttrs,h.attrs),h.attrs!==null&&Hf(h,h.attrs,!1),h.mergedAttrs!==null&&Hf(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function $D(n,e){KT(n,e),Yy(e)&&n.queries.elementEnd(e)}function YL(n,e,t,i,r,o){let s=e.consts,a=Ii(s,r),l=dl(e,n,t,i,a);if(l.mergedAttrs=nl(l.mergedAttrs,l.attrs),o!=null){let u=Ii(s,o);l.localNames=[];for(let d=0;d<u.length;d+=2)l.localNames.push(u[d],-1)}return l.attrs!==null&&Hf(l,l.attrs,!1),l.mergedAttrs!==null&&Hf(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function z_(n){return yp(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function GD(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function yp(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function W_(n,e,t){return n[e]=t}function QL(n,e){return n[e]}function Ci(n,e,t){if(t===xn)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function q_(n,e,t,i){let r=Ci(n,e,t);return Ci(n,e+1,i)||r}function JL(n,e,t,i,r){let o=q_(n,e,t,i);return Ci(n,e+2,r)||o}function Df(n,e,t){return function i(r){let o=Zr(n)?Si(n.index,e):e;up(o,5);let s=e[en],a=IT(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=IT(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function IT(n,e,t,i){let r=Ve(null);try{return pt(st.OutputStart,e,t),t(i)!==!1}catch(o){return B_(n,o),!1}finally{pt(st.OutputEnd,e,t),Ve(r)}}function zD(n,e,t,i,r,o,s,a){let l=Zc(n),u=!1,d=null;if(!i&&l&&(d=XL(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,u=!0}else{let h=xi(n,t),p=i?i(h):h;zF(t,p,o,a);let g=r.listen(p,o,a);if(!ZL(o)){let x=i?S=>i(ui(S[n.index])):n.index;WD(x,e,t,o,a,g,!1)}}return u}function ZL(n){return n.startsWith("animation")||n.startsWith("transition")}function XL(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[Ya],l=r[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function WD(n,e,t,i,r,o,s){let a=e.firstCreatePass?nv(e):null,l=tv(t),u=l.length;l.push(r,o),a&&a.push(i,n,u,(u+1)*(s?-1:1))}function TT(n,e,t,i,r,o){let s=e[t],a=e[Ce],u=a.data[t].outputs[i],h=s[u].subscribe(o);WD(n.index,a,e,r,o,h,!0)}var Zv=Symbol("BINDING");var $f=class extends xu{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Qr(e);return new ol(t,this.ngModule)}};function eV(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&op.SignalBased)!==0};return r&&(o.transform=r),o})}function tV(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function nV(n,e,t){let i=e instanceof Wt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new el(t,i):t}function iV(n){let e=n.get(Js,null);if(e===null)throw new he(407,!1);let t=n.get(UD,null),i=n.get(Uo,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function rV(n,e){let t=qD(n);return C_(e,t,t==="svg"?Qy:t==="math"?NI:null)}function qD(n){return(n.selectors[0][0]||"div").toLowerCase()}var ol=class extends mp{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=eV(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=tV(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=b3(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){pt(st.DynamicComponentStart);let a=Ve(null);try{let l=this.componentDef,u=oV(i,l,s,o),d=nV(l,r||this.ngModule,e),h=iV(d),p=h.rendererFactory.createRenderer(null,l),g=i?z3(p,i,l.encapsulation,d):rV(l,p),x=s?.some(CT)||o?.some(U=>typeof U!="function"&&U.bindings.some(CT)),S=P_(null,u,null,512|rD(l),null,null,h,p,d,null,UC(g,d,!0));S[ut]=g,mf(S);let N=null;try{let U=HD(ut,S,2,"#host",()=>u.directiveRegistry,!0,0);ZC(p,g,U),il(g,S),U_(u,S,U),WC(u,U,S),$D(u,U),t!==void 0&&aV(U,this.ngContentSelectors,t),N=Si(U.index,S),S[en]=N[en],H_(u,S,null)}catch(U){throw N!==null&&$v(N),$v(S),U}finally{pt(st.DynamicComponentEnd),yf()}return new Gf(this.componentType,S,!!x)}finally{Ve(a)}}};function oV(n,e,t,i){let r=n?["ng-version","21.1.1"]:w3(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[Zv].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(i)for(let d=0;d<i.length;d++){let h=i[d];if(typeof h!="function")for(let p of h.bindings){a+=p[Zv].requiredVars;let g=d+1;p.create&&(p.targetIdx=g,(o??=[]).push(p)),p.update&&(p.targetIdx=g,(s??=[]).push(p))}}let l=[e];if(i)for(let d of i){let h=typeof d=="function"?d:d.type,p=rf(h);l.push(p)}return R_(0,null,sV(o,s),1,a,l,null,null,null,[r],null)}function sV(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function CT(n){let e=n[Zv].kind;return e==="input"||e==="twoWay"}var Gf=class extends VD{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Gs(t[Ce],ut),this.location=al(this._tNode,t),this.instance=Si(this._tNode.index,t)[en],this.hostView=this.changeDetectorRef=new zo(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=j_(i,r[Ce],r,e,t);this.previousInputValues.set(e,t);let s=Si(i.index,r);up(s,1)}get injector(){return new Ks(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function aV(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var to=(()=>{class n{static __NG_ELEMENT_ID__=lV}return n})();function lV(){let n=Ln();return YD(n,Be())}var cV=to,KD=class extends cV{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return al(this._hostTNode,this._hostLView)}get injector(){return new Ks(this._hostTNode,this._hostLView)}get parentInjector(){let e=g_(this._hostTNode,this._hostLView);if(JT(e)){let t=Pf(e,this._hostLView),i=Rf(e),r=t[Ce].data[i+8];return new Ks(r,t)}else return new Ks(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=DT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-jt}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=jf(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,rl(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let l=e&&!gF(e),u;if(l)u=t;else{let N=t||{};u=N.index,i=N.injector,r=N.projectableNodes,o=N.environmentInjector||N.ngModuleRef,s=N.directives,a=N.bindings}let d=l?e:new ol(Qr(e)),h=i||this.parentInjector;if(!o&&d.ngModule==null){let U=(l?h:this.parentInjector).get(Wt,null);U&&(o=U)}let p=Qr(d.componentType??{}),g=jf(this._lContainer,p?.id??null),x=g?.firstChild??null,S=d.create(h,r,x,o,s,a);return this.insertImpl(S.hostView,u,rl(this._hostTNode,g)),S}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(OI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Xt],u=new KD(l,l[wi],l[Xt]);u.detach(u.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return wu(s,r,o,i),e.attachToViewContainerRef(),Hy(Rv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=DT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=hu(this._lContainer,t);i&&(qc(Rv(this._lContainer),t),ap(i[Ce],i))}detach(e){let t=this._adjustIndex(e,-1),i=hu(this._lContainer,t);return i&&qc(Rv(this._lContainer),t)!=null?new zo(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function DT(n){return n[Jc]}function Rv(n){return n[Jc]||(n[Jc]=[])}function YD(n,e){let t,i=e[n.index];return ci(i)?t=i:(t=DD(i,e,null,n),e[n.index]=t,N_(e,t)),QD(t,e,n,i),new KD(t,n,e)}function uV(n,e){let t=n[xt],i=t.createComment(""),r=xi(e,n),o=t.parentNode(r);return Vf(t,o,i,t.nextSibling(r),!1),i}var QD=JD,K_=()=>!1;function dV(n,e,t){return K_(n,e,t)}function JD(n,e,t,i){if(n[vr])return;let r;t.type&8?r=ui(i):r=uV(e,t),n[vr]=r}function hV(n,e,t){if(n[vr]&&n[Hi])return!0;let i=t[Qn],r=e.index-ut;if(!i||cC(e)||$C(i,r))return!1;let s=Wv(i,r),a=i.data[Xf]?.[r],[l,u]=OL(s,a);return n[vr]=l,n[Hi]=u,!0}function fV(n,e,t,i){K_(n,t,e)||JD(n,e,t,i)}function ZD(){QD=fV,K_=hV}var Xv=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},e_=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)Y_(e,t).matches!==null&&this.queries[t].setDirty()}},t_=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=bV(e):this.predicate=e}},n_=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},i_=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,pV(t,o)),this.matchTNodeWithReadOption(e,t,If(t,e,o,!1,!1))}else i===Wo?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,If(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Di||r===to||r===Wo&&t.type&4)this.addMatch(t.index,-2);else{let o=If(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function pV(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function gV(n,e){return n.type&11?al(n,e):n.type&4?dp(n,e):null}function mV(n,e,t,i){return t===-1?gV(e,n):t===-2?yV(n,e,i):cu(n,n[Ce],t,e)}function yV(n,e,t){if(t===Di)return al(e,n);if(t===Wo)return dp(e,n);if(t===to)return YD(e,n)}function XD(n,e,t,i){let r=e[yr].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let u=s[l];if(u<0)a.push(null);else{let d=o[u];a.push(mV(e,d,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function r_(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=XD(n,e,r,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)i.push(s[a/2]);else{let u=o[a+1],d=e[-l];for(let h=jt;h<d.length;h++){let p=d[h];p[Ho]===p[Xt]&&r_(p[Ce],p,u,i)}if(d[Hs]!==null){let h=d[Hs];for(let p=0;p<h.length;p++){let g=h[p];r_(g[Ce],g,u,i)}}}}}return i}function vV(n,e){return n[yr].queries[e].queryList}function _V(n,e,t){let i=new Of((t&4)===4);return VI(n,e,i,i.destroy),(e[yr]??=new e_).queries.push(new Xv(i))-1}function EV(n,e,t){let i=tn();return i.firstCreatePass&&(wV(i,new t_(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),_V(i,Be(),e)}function bV(n){return n.split(",").map(e=>e.trim())}function wV(n,e,t){n.queries===null&&(n.queries=new n_),n.queries.track(new i_(e,t))}function Y_(n,e){return n.queries.getByIndex(e)}function xV(n,e){let t=n[Ce],i=Y_(t,e);return i.crossesNgTemplate?r_(t,n,e,[]):XD(t,n,i,e)}var Zs=class{},vp=class{};var zf=class extends Zs{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new $f(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=Vy(e);this._bootstrapComponents=nD(o.bootstrap),this._r3Injector=_v(e,t,[{provide:Zs,useValue:this},{provide:xu,useValue:this.componentFactoryResolver},...i],Kr(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Wf=class extends vp{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new zf(this.moduleType,e,[])}};var fu=class extends Zs{injector;componentFactoryResolver=new $f(this);instance=null;constructor(e){super();let t=new Fs([...e.providers,{provide:Zs,useValue:this},{provide:xu,useValue:this.componentFactoryResolver}],e.parent||Yc(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function hl(n,e,t=null){return new fu({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var SV=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=uf(!1,t.type),r=i.length>0?hl([i],this._injector,""):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ae({token:n,providedIn:"environment",factory:()=>new n(Me(Wt))})}return n})();function kt(n){return gu(()=>{let e=eA(n),t=pe(F({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===m_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(SV).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||zi.Emulated,styles:n.styles||Gn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&fi("NgStandalone"),tA(t);let i=n.dependencies;return t.directiveDefs=AT(i,IV),t.pipeDefs=AT(i,Uy),t.id=DV(t),t})}function IV(n){return Qr(n)||rf(n)}function no(n){return gu(()=>({type:n.type,bootstrap:n.bootstrap||Gn,declarations:n.declarations||Gn,imports:n.imports||Gn,exports:n.exports||Gn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function TV(n,e){if(n==null)return jo;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=op.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function CV(n){if(n==null)return jo;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function _n(n){return gu(()=>{let e=eA(n);return tA(e),e})}function _p(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function eA(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||jo,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Gn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:TV(n.inputs,e),outputs:CV(n.outputs),debugInfo:null}}function tA(n){n.features?.forEach(e=>e(n))}function AT(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function DV(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function AV(n){return Object.getPrototypeOf(n.prototype).constructor}function xr(n){let e=AV(n.type),t=!0,i=[n];for(;e;){let r;if(_r(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new he(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=Pv(n.inputs),s.declaredInputs=Pv(n.declaredInputs),s.outputs=Pv(n.outputs);let a=r.hostBindings;a&&kV(n,a);let l=r.viewQuery,u=r.contentQueries;if(l&&PV(n,l),u&&NV(n,u),MV(n,r),vI(n.outputs,r.outputs),_r(r)&&r.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===xr&&(t=!1)}}e=Object.getPrototypeOf(e)}RV(i)}function MV(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function RV(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=nl(r.hostAttrs,t=nl(t,r.hostAttrs))}}function Pv(n){return n===jo?{}:n===Gn?[]:n}function PV(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function NV(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function kV(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function nA(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=nl(n.mergedAttrs,n.attrs);let d=n.tView=R_(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),zs(n,!1);let l=iA(t,e,n,i);vf()&&L_(t,e,l,n),il(l,e);let u=DD(l,e,l,n);e[i+ut]=u,N_(e,u),dV(u,n,e)}function OV(n,e,t,i,r,o,s,a,l,u,d){let h=t+ut,p;return e.firstCreatePass?(p=dl(e,h,4,s||null,a||null),rv()&&BD(e,n,p,Ii(e.consts,u),mD),KT(e,p)):p=e.data[h],nA(p,n,e,t,i,r,o,l),Zc(p)&&U_(e,n,p),u!=null&&cp(n,p,d),p}function qf(n,e,t,i,r,o,s,a,l,u,d){let h=t+ut,p;if(e.firstCreatePass){if(p=dl(e,h,4,s||null,a||null),u!=null){let g=Ii(e.consts,u);p.localNames=[];for(let x=0;x<g.length;x+=2)p.localNames.push(g[x],-1)}}else p=e.data[h];return nA(p,n,e,t,i,r,o,l),u!=null&&cp(n,p,d),p}function Sr(n,e,t,i,r,o,s,a){let l=Be(),u=tn(),d=Ii(u.consts,o);return OV(l,u,n,e,t,i,r,d,void 0,s,a),Sr}var iA=rA;function rA(n,e,t,i){return Xr(!0),e[xt].createComment("")}function FV(n,e,t,i){let r=!ip(e,t);Xr(r);let o=e[Qn]?.data[vC]?.[i]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),r)return rA(n,e);let s=e[Qn],a=hp(s,n,e,t);np(s,i,a);let l=I_(s,i);return fp(l,a)}function oA(){iA=FV}var hi=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(hi||{}),MT=0,LV=1,hn=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(hn||{});var VV=0,Su=1;var UV=4,BV=5;var jV=7,tl=8,HV=9,Q_=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(Q_||{});function Af(n,e){let t=GV(n),i=e[t];if(i!==null){for(let r of i)r();e[t]=null}}function $V(n){Af(1,n),Af(0,n),Af(2,n)}function GV(n){let e=UV;return n===1?e=BV:n===2&&(e=HV),e}function sA(n){return n+1}function fl(n,e){let t=n[Ce],i=sA(e.index);return n[i]}function Iu(n,e){let t=sA(e.index);return n.data[t]}function zV(n,e,t){let i=e[Ce],r=Iu(i,t);switch(n){case hn.Complete:return r.primaryTmplIndex;case hn.Loading:return r.loadingTmplIndex;case hn.Error:return r.errorTmplIndex;case hn.Placeholder:return r.placeholderTmplIndex;default:return null}}function RT(n,e){return e===hn.Placeholder?n.placeholderBlockConfig?.[MT]??null:e===hn.Loading?n.loadingBlockConfig?.[MT]??null:null}function WV(n){return n.loadingBlockConfig?.[LV]??null}function PT(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let i of e)t.add(i);return n.length===t.size?n:Array.from(t)}function qV(n,e){let t=e.primaryTmplIndex+ut;return Gs(n,t)}var KV=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,i,r,o){if(!this.cachedInjectors.has(t)){let s=r.length>0?hl(r,i,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ae({token:n,providedIn:"environment",factory:()=>new n})}return n})();var aA=new _e("");function Nv(n,e,t){return n.get(KV).getOrCreateInjector(e,n,t,"")}function YV(n,e,t){if(n instanceof el){let r=n.injector,o=n.parentInjector,s=Nv(o,e,t);return new el(r,s)}let i=n.get(Wt);if(i!==n){let r=Nv(i,e,t);return new el(n,r)}return Nv(n,e,t)}function qs(n,e,t,i=!1){let r=t[Xt],o=r[Ce];if($o(r))return;let s=fl(r,e),a=s[Su],l=s[jV];if(!(l!==null&&n<l)&&NT(a,n)&&NT(s[VV]??-1,n)){let u=Iu(o,e),h=!i&&!0&&(WV(u)!==null||RT(u,hn.Loading)!==null||RT(u,hn.Placeholder))?ZV:JV;try{h(n,s,t,e,r)}catch(p){B_(r,p)}}}function QV(n,e){let t=n[Hi]?.findIndex(r=>r.data[wC]===e[Su])??-1;return{dehydratedView:t>-1?n[Hi][t]:null,dehydratedViewIx:t}}function JV(n,e,t,i,r){pt(st.DeferBlockStateStart);let o=zV(n,r,i);if(o!==null){e[Su]=n;let s=r[Ce],a=o+ut,l=Gs(s,a),u=0;$_(t,u);let d;if(n===hn.Complete){let x=Iu(s,i),S=x.providers;S&&S.length>0&&(d=YV(r[si],x,S))}let{dehydratedView:h,dehydratedViewIx:p}=QV(t,e),g=bu(r,l,null,{injector:d,dehydratedView:h});if(wu(t,g,u,rl(l,h)),up(g,2),p>-1&&t[Hi]?.splice(p,1),(n===hn.Complete||n===hn.Error)&&Array.isArray(e[tl])){for(let x of e[tl])x();e[tl]=null}}pt(st.DeferBlockStateEnd)}function NT(n,e){return n<e}function kT(n,e,t){n.loadingPromise.then(()=>{n.loadingState===hi.COMPLETE?qs(hn.Complete,e,t):n.loadingState===hi.FAILED&&qs(hn.Error,e,t)})}var ZV=null;var Ep=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var J_=new _e("");function Yo(n){return!!n&&typeof n.then=="function"}function Z_(n){return!!n&&typeof n.subscribe=="function"}var lA=new _e("");var X_=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=z(lA,{optional:!0})??[];injector=z(zn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Nn(this.injector,r);if(Yo(o))t.push(o);else if(Z_(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qo=new _e("");function cA(){X0(()=>{let n="";throw new he(600,n)})}function uA(n){return n.isBoundToModule}var XV=10;var Zn=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=z(di);afterRenderManager=z(O_);zonelessEnabled=z(ru);rootEffectScheduler=z(Iv);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new zt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=z(Er);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(yt(t=>!t))}constructor(){z(qo,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=z(Wt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=zn.NULL){return this._injector.get(vn).run(()=>{pt(st.BootstrapComponentStart);let s=t instanceof mp;if(!this._injector.get(X_).done){let x="";throw new he(405,x)}let l;s?l=t:l=this._injector.get(xu).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let u=uA(l)?void 0:this._injector.get(Zs),d=i||l.selector,h=l.create(r,[],d,u),p=h.location.nativeElement,g=h.injector.get(J_,null);return g?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),lu(this.components,h),g?.unregisterApplication(p)}),this._loadComponent(h),pt(st.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){pt(st.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(sp.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw pt(st.ChangeDetectionEnd),new he(101,!1);let t=Ve(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Ve(t),this.afterTick.next(),pt(st.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Js,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<XV;){pt(st.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{pt(st.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!tu(r))continue;let o=i&&!this.zonelessEnabled?0:1;SD(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>tu(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;lu(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(Qo,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>lu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new he(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lu(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function eE(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}function dA(n,e,t){let i=e[si],r=e[Ce];if(n.loadingState!==hi.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=fl(e,t),s=qV(r,n);n.loadingState=hi.IN_PROGRESS,Af(1,o);let a=n.dependencyResolverFn,l=i.get(ou).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(u=>{let d=!1,h=[],p=[];for(let g of u)if(g.status==="fulfilled"){let x=g.value,S=Qr(x)||rf(x);if(S)h.push(S);else{let N=Uy(x);N&&p.push(N)}}else{d=!0;break}if(d){if(n.loadingState=hi.FAILED,n.errorTmplIndex===null){let x=new he(-750,!1);B_(e,x)}}else{n.loadingState=hi.COMPLETE;let g=s.tView;if(h.length>0){g.directiveRegistry=PT(g.directiveRegistry,h);let x=h.map(N=>N.type),S=uf(!1,...x);n.providers=S}p.length>0&&(g.pipeRegistry=PT(g.pipeRegistry,p))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,l()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=hi.COMPLETE,l()}),n.loadingPromise)}function e5(n,e){return e[si].get(aA,null,{optional:!0})?.behavior!==Q_.Manual}function t5(n,e,t){let i=e[Ce],r=e[t.index];if(!e5(n,e))return;let o=fl(e,t),s=Iu(i,t);switch($V(o),s.loadingState){case hi.NOT_STARTED:qs(hn.Loading,t,r),dA(s,e,t),s.loadingState===hi.IN_PROGRESS&&kT(s,t,r);break;case hi.IN_PROGRESS:qs(hn.Loading,t,r),kT(s,t,r);break;case hi.COMPLETE:qs(hn.Complete,t,r);break;case hi.FAILED:qs(hn.Error,t,r);break;default:}}async function hA(n,e,t){let i=n.get(ep);if(i.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=XF(e,n);if(s.length===0)return;o!==null&&s.shift(),r5(i,s),o!==null&&await o;let a=s[0];i.has(a)?await OT(n,s,t):i.awaitParentBlock(a,async()=>await OT(n,s,t))}async function OT(n,e,t){let i=n.get(ep),r=i.hydrating,o=n.get(Er),s=o.add();for(let l=0;l<e.length;l++){let u=e[l],d=i.get(u);if(d!=null){if(await s5(d),await o5(n),n5(d)){NL(d),FT(e.slice(l),i);break}r.get(u).resolve()}else{i5(l,e,i),FT(e.slice(l),i);break}}let a=e[e.length-1];await r.get(a)?.promise,o.remove(s),t&&t(e),kL(i.get(a),e,i,n.get(Zn))}function n5(n){return fl(n.lView,n.tNode)[Su]===hn.Error}function i5(n,e,t){let i=n-1,r=i>-1?t.get(e[i]):null;r&&gp(r.lContainer)}function FT(n,e){let t=e.hydrating;for(let i in n)t.get(i)?.reject();e.cleanup(n)}function r5(n,e){for(let t of e)n.hydrating.set(t,eE())}function o5(n){return new Promise(e=>Eu(e,{injector:n}))}async function s5(n){let{tNode:e,lView:t}=n,i=fl(t,e);return new Promise(r=>{a5(i,r),t5(2,t,e)})}function a5(n,e){Array.isArray(n[tl])||(n[tl]=[]),n[tl].push(e)}function Ot(n,e,t,i){let r=Be(),o=Ws();if(Ci(r,o,e)){let s=tn(),a=yv();tL(a,r,n,e,t,i)}return Ot}var gte=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var o_=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function kv(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function l5(n,e,t,i){let r,o,s=0,a=n.length-1,l=void 0;if(Array.isArray(e)){Ve(i);let u=e.length-1;for(Ve(null);s<=a&&s<=u;){let d=n.at(s),h=e[s],p=kv(s,d,s,h,t);if(p!==0){p<0&&n.updateValue(s,h),s++;continue}let g=n.at(a),x=e[u],S=kv(a,g,u,x,t);if(S!==0){S<0&&n.updateValue(a,x),a--,u--;continue}let N=t(s,d),U=t(a,g),ie=t(s,h);if(Object.is(ie,U)){let Se=t(u,x);Object.is(Se,N)?(n.swap(s,a),n.updateValue(a,x),u--,a--):n.move(a,s),n.updateValue(s,h),s++;continue}if(r??=new Kf,o??=VT(n,s,a,t),s_(n,r,s,ie))n.updateValue(s,h),s++,a++;else if(o.has(ie))r.set(N,n.detach(s)),a--;else{let Se=n.create(s,e[s]);n.attach(s,Se),s++,a++}}for(;s<=u;)LT(n,r,t,s,e[s]),s++}else if(e!=null){Ve(i);let u=e[Symbol.iterator]();Ve(null);let d=u.next();for(;!d.done&&s<=a;){let h=n.at(s),p=d.value,g=kv(s,h,s,p,t);if(g!==0)g<0&&n.updateValue(s,p),s++,d=u.next();else{r??=new Kf,o??=VT(n,s,a,t);let x=t(s,p);if(s_(n,r,s,x))n.updateValue(s,p),s++,a++,d=u.next();else if(!o.has(x))n.attach(s,n.create(s,p)),s++,a++,d=u.next();else{let S=t(s,h);r.set(S,n.detach(s)),a--}}}for(;!d.done;)LT(n,r,t,n.length,d.value),d=u.next()}for(;s<=a;)n.destroy(n.detach(a--));r?.forEach(u=>{n.destroy(u)})}function s_(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function LT(n,e,t,i,r){if(s_(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function VT(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var Kf=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function Q(n,e,t,i,r,o,s,a){fi("NgControlFlow");let l=Be(),u=tn(),d=Ii(u.consts,o);return qf(l,u,n,e,t,i,r,d,256,s,a),tE}function tE(n,e,t,i,r,o,s,a){fi("NgControlFlow");let l=Be(),u=tn(),d=Ii(u.consts,o);return qf(l,u,n,e,t,i,r,d,512,s,a),tE}function J(n,e){fi("NgControlFlow");let t=Be(),i=Ws(),r=t[i]!==xn?t[i]:-1,o=r!==-1?Yf(t,ut+r):void 0,s=0;if(Ci(t,i,n)){let a=Ve(null);try{if(o!==void 0&&$_(o,s),n!==-1){let l=ut+n,u=Yf(t,l),d=u_(t[Ce],l),h=FD(u,d,t),p=bu(t,d,e,{dehydratedView:h});wu(u,p,s,rl(d,h))}}finally{Ve(a)}}else if(o!==void 0){let a=AD(o,s);a!==void 0&&(a[en]=e)}}var a_=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-jt}};function na(n){return n}function Ir(n,e){return e}var l_=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function Kt(n,e,t,i,r,o,s,a,l,u,d,h,p){fi("NgControlFlow");let g=Be(),x=tn(),S=l!==void 0,N=Be(),U=a?s.bind(N[qn][en]):s,ie=new l_(S,U);N[ut+n]=ie,qf(g,x,n+1,e,t,i,r,Ii(x.consts,o),256),S&&qf(g,x,n+2,l,u,d,h,Ii(x.consts,p),512)}var c_=class extends o_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-jt}at(e){return this.getLView(e)[en].$implicit}attach(e,t){let i=t[Qn];this.needsIndexUpdate||=e!==this.length,wu(this.lContainer,t,e,rl(this.templateTNode,i)),c5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,u5(this.lContainer,e),d5(this.lContainer,e)}create(e,t){let i=jf(this.lContainer,this.templateTNode.tView.ssrId);return bu(this.hostLView,this.templateTNode,new a_(this.lContainer,t,e),{dehydratedView:i})}destroy(e){ap(e[Ce],e)}updateValue(e,t){this.getLView(e)[en].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[en].$index=e}getLView(e){return h5(this.lContainer,e)}};function Yt(n){let e=Ve(null),t=Ti();try{let i=Be(),r=i[Ce],o=i[t],s=t+1,a=Yf(i,s);if(o.liveCollection===void 0){let u=u_(r,s);o.liveCollection=new c_(a,i,u)}else o.liveCollection.reset();let l=o.liveCollection;if(l5(l,n,o.trackByFn,e),l.updateIndexes(),o.hasEmptyBlock){let u=Ws(),d=l.length===0;if(Ci(i,u,d)){let h=t+2,p=Yf(i,h);if(d){let g=u_(r,h),x=FD(p,g,i),S=bu(i,g,void 0,{dehydratedView:x});wu(p,S,0,rl(g,x))}else r.firstUpdatePass&&pp(p),$_(p,0)}}}finally{Ve(e)}}function Yf(n,e){return n[e]}function c5(n,e){if(n.length<=jt)return;let t=jt+e,i=n[t],r=i?i[js]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[si];A3(o,r),Qs.delete(i[Jr]),r.detachedLeaveAnimationFns=void 0}}function u5(n,e){if(n.length<=jt)return;let t=jt+e,i=n[t],r=i?i[js]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function d5(n,e){return hu(n,e)}function h5(n,e){return AD(n,e)}function u_(n,e){return Gs(n,e)}function Ue(n,e,t){let i=Be(),r=Ws();if(Ci(i,r,e)){let o=tn(),s=yv();Y3(s,i,n,e,i[xt],t)}return Ue}function d_(n,e,t,i,r){j_(e,n,t,r?"class":"style",i)}function E(n,e,t,i){let r=Be(),o=r[Ce],s=n+ut,a=o.firstCreatePass?HD(s,r,2,e,mD,rv(),t,i):o.data[s];if(yD(a,r,n,e,nE),Zc(a)){let l=r[Ce];U_(l,r,a),WC(l,a,r)}return i!=null&&cp(r,a),E}function b(){let n=tn(),e=Ln(),t=vD(e);return n.firstCreatePass&&$D(n,t),sv(t)&&av(),iv(),t.classesWithoutHost!=null&&bF(t)&&d_(n,t,Be(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&wF(t)&&d_(n,t,Be(),t.stylesWithoutHost,!1),b}function G(n,e,t,i){return E(n,e,t,i),b(),G}function C(n,e,t,i){let r=Be(),o=r[Ce],s=n+ut,a=o.firstCreatePass?YL(s,o,2,e,t,i):o.data[s];return yD(a,r,n,e,nE),i!=null&&cp(r,a),C}function A(){let n=Ln(),e=vD(n);return sv(e)&&av(),iv(),A}function j(n,e,t,i){return C(n,e,t,i),A(),j}var nE=(n,e,t,i,r)=>(Xr(!0),C_(e[xt],i,vv()));function f5(n,e,t,i,r){let o=!ip(e,t);if(Xr(o),o)return C_(e[xt],i,vv());let s=e[Qn],a=hp(s,n,e,t);return HC(s,r)&&np(s,r,a.nextSibling),s&&(aC(t)||lC(a))&&Zr(t)&&(jI(t),JC(a)),a}function fA(){nE=f5}var p5=(n,e,t,i,r)=>(Xr(!0),YC(e[xt],""));function g5(n,e,t,i,r){let o,s=!ip(e,t);if(Xr(s),s)return YC(e[xt],"");let a=e[Qn],l=hp(a,n,e,t),u=JF(a,r);return np(a,r,l),o=fp(u,l),o}function pA(){p5=g5}function Ze(){return Be()}var su=void 0;function m5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var y5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],su,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],su,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",su,su,su],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",m5],Ov={};function pi(n){let e=v5(n),t=UT(e);if(t)return t;let i=e.split("-")[0];if(t=UT(i),t)return t;if(i==="en")return y5;throw new he(701,!1)}function UT(n){return n in Ov||(Ov[n]=hr.ng&&hr.ng.common&&hr.ng.common.locales&&hr.ng.common.locales[n]),Ov[n]}var nn=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(nn||{});function v5(n){return n.toLowerCase().replace(/_/g,"-")}var Tu="en-US";var _5=Tu;function gA(n){typeof n=="string"&&(_5=n.toLowerCase().replace(/_/g,"-"))}function re(n,e,t){let i=Be(),r=tn(),o=Ln();return E5(r,i,i[xt],o,n,e,t),re}function Vt(n,e,t){let i=Be(),r=tn(),o=Ln();return(o.type&3||t)&&zD(o,r,i,t,i[xt],n,e,Df(o,i,e)),Vt}function E5(n,e,t,i,r,o,s){let a=!0,l=null;if((i.type&3||s)&&(l??=Df(i,e,o),zD(i,n,e,s,t,r,o,l)&&(a=!1)),a){let u=i.outputs?.[r],d=i.hostDirectiveOutputs?.[r];if(d&&d.length)for(let h=0;h<d.length;h+=2){let p=d[h],g=d[h+1];l??=Df(i,e,o),TT(i,e,p,g,r,l)}if(u&&u.length)for(let h of u)l??=Df(i,e,o),TT(i,e,h,r,r,l)}}function O(n=1){return ZI(n)}function bp(n,e,t){return EV(n,e,t),bp}function wp(n){let e=Be(),t=tn(),i=pv();gf(i+1);let r=Y_(t,i);if(n.dirty&&kI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=xV(e,i);n.reset(o,OF),n.notifyOnChanges()}return!0}return!1}function xp(){return vV(Be(),pv())}function Cu(n){let e=uv();return Xc(e,ut+n)}function wf(n,e){return n<<17|e<<2}function Xs(n){return n>>17&32767}function b5(n){return(n&2)==2}function w5(n,e){return n&131071|e<<17}function h_(n){return n|2}function sl(n){return(n&131068)>>2}function Fv(n,e){return n&-131069|e<<2}function x5(n){return(n&1)===1}function f_(n){return n|1}function S5(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=Xs(s),l=sl(s);n[i]=t;let u=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||Ka(h,d)>0)&&(u=!0)}else d=t;if(r)if(l!==0){let p=Xs(n[a+1]);n[i+1]=wf(p,a),p!==0&&(n[p+1]=Fv(n[p+1],i)),n[a+1]=w5(n[a+1],i)}else n[i+1]=wf(a,0),a!==0&&(n[a+1]=Fv(n[a+1],i)),a=i;else n[i+1]=wf(l,0),a===0?a=i:n[l+1]=Fv(n[l+1],i),l=i;u&&(n[i+1]=h_(n[i+1])),BT(n,d,i,!0),BT(n,d,i,!1),I5(e,d,n,i,o),s=wf(a,l),o?e.classBindings=s:e.styleBindings=s}function I5(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Ka(o,e)>=0&&(t[i+1]=f_(t[i+1]))}function BT(n,e,t,i){let r=n[t+1],o=e===null,s=i?Xs(r):sl(r),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],u=n[s+1];T5(l,e)&&(a=!0,n[s+1]=i?f_(u):h_(u)),s=i?Xs(u):sl(u)}a&&(n[t+1]=i?h_(r):f_(r))}function T5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Ka(n,e)>=0:!1}var Gi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function C5(n){return n.substring(Gi.key,Gi.keyEnd)}function D5(n){return A5(n),mA(n,yA(n,0,Gi.textEnd))}function mA(n,e){let t=Gi.textEnd;return t===e?-1:(e=Gi.keyEnd=M5(n,Gi.key=e,t),yA(n,e,t))}function A5(n){Gi.key=0,Gi.keyEnd=0,Gi.value=0,Gi.valueEnd=0,Gi.textEnd=n.length}function yA(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function M5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function et(n,e,t){return vA(n,e,t,!1),et}function Fe(n,e){return vA(n,e,null,!0),Fe}function iE(n){P5(V5,R5,n,!0)}function R5(n,e){for(let t=D5(e);t>=0;t=mA(e,t))lf(n,C5(e),!0)}function vA(n,e,t,i){let r=Be(),o=tn(),s=iu(2);if(o.firstUpdatePass&&EA(o,n,s,i),e!==xn&&Ci(r,s,e)){let a=o.data[Ti()];bA(o,a,r,r[xt],n,r[s+1]=B5(e,t),i,s)}}function P5(n,e,t,i){let r=tn(),o=iu(2);r.firstUpdatePass&&EA(r,null,o,i);let s=Be();if(t!==xn&&Ci(s,o,t)){let a=r.data[Ti()];if(wA(a,i)&&!_A(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=tf(l,t||"")),d_(r,a,s,t,i)}else U5(r,a,s,s[xt],s[o+1],s[o+1]=L5(n,e,t),i,o)}}function _A(n,e){return e>=n.expandoStartIndex}function EA(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Ti()],s=_A(n,t);wA(o,i)&&e===null&&!s&&(e=!1),e=N5(r,o,e,i),S5(r,o,e,t,s,i)}}function N5(n,e,t,i){let r=KI(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Lv(null,n,e,t,i),t=pu(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Lv(r,n,e,t,i),o===null){let l=k5(n,e,i);l!==void 0&&Array.isArray(l)&&(l=Lv(null,n,e,l[1],i),l=pu(l,e.attrs,i),O5(n,e,i,l))}else o=F5(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function k5(n,e,t){let i=t?e.classBindings:e.styleBindings;if(sl(i)!==0)return n[Xs(i)]}function O5(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[Xs(r)]=i}function F5(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=pu(i,s,t)}return pu(i,e.attrs,t)}function Lv(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=pu(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function pu(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),lf(n,s,t?!0:e[++o]))}return n===void 0?null:n}function L5(n,e,t){if(t==null||t==="")return Gn;let i=[],r=ul(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(r instanceof Set)for(let o of r)n(i,o,!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function V5(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&lf(n,i,t)}function U5(n,e,t,i,r,o,s,a){r===xn&&(r=Gn);let l=0,u=0,d=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;d!==null||h!==null;){let p=l<r.length?r[l+1]:void 0,g=u<o.length?o[u+1]:void 0,x=null,S;d===h?(l+=2,u+=2,p!==g&&(x=h,S=g)):h===null||d!==null&&d<h?(l+=2,x=d):(u+=2,x=h,S=g),x!==null&&bA(n,e,t,i,x,S,s,a),d=l<r.length?r[l]:null,h=u<o.length?o[u]:null}}function bA(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let l=n.data,u=l[a+1],d=x5(u)?jT(l,e,t,r,sl(u),s):void 0;if(!Qf(d)){Qf(o)||b5(u)&&(o=jT(l,null,t,r,a,s));let h=Jy(Ti(),t);G3(i,s,h,r,o)}}function jT(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let l=n[r],u=Array.isArray(l),d=u?l[1]:l,h=d===null,p=t[r+1];p===xn&&(p=h?Gn:void 0);let g=h?cf(p,i):d===i?p:void 0;if(u&&!Qf(g)&&(g=cf(l,i)),Qf(g)&&(a=g,s))return a;let x=n[r+1];r=s?Xs(x):sl(x)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=cf(l,i))}return a}function Qf(n){return n!==void 0}function B5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Kr(ul(n)))),n}function wA(n,e){return(n.flags&(e?8:16))!==0}function _(n,e=""){let t=Be(),i=tn(),r=n+ut,o=i.firstCreatePass?dl(i,r,1,e,null):i.data[r],s=xA(i,t,o,e,n);t[r]=s,vf()&&L_(i,t,s,o),zs(o,!1)}var xA=(n,e,t,i,r)=>(Xr(!0),KC(e[xt],i));function j5(n,e,t,i,r){let o=!ip(e,t);if(Xr(o),o)return KC(e[xt],i);let s=e[Qn];return hp(s,n,e,t)}function SA(){xA=j5}function H5(n,e,t,i=""){return Ci(n,Ws(),t)?e+ji(t)+i:xn}function $5(n,e,t,i,r,o=""){let s=fv(),a=q_(n,s,t,r);return iu(2),a?e+ji(t)+i+ji(r)+o:xn}function G5(n,e,t,i,r,o,s,a=""){let l=fv(),u=JL(n,l,t,r,s);return iu(3),u?e+ji(t)+i+ji(r)+o+ji(s)+a:xn}function W(n){return K("",n),W}function K(n,e,t){let i=Be(),r=H5(i,n,e,t);return r!==xn&&rE(i,Ti(),r),K}function rn(n,e,t,i,r){let o=Be(),s=$5(o,n,e,t,i,r);return s!==xn&&rE(o,Ti(),s),rn}function Jo(n,e,t,i,r,o,s){let a=Be(),l=G5(a,n,e,t,i,r,o,s);return l!==xn&&rE(a,Ti(),l),Jo}function rE(n,e,t){let i=Jy(e,n);s3(n[xt],i,t)}var IA={};function pl(n){fi("NgLet");let e=tn(),t=Be(),i=n+ut,r=dl(e,i,128,null,null);return zs(r,!1),eu(e,t,i,IA),pl}function Du(n){let e=tn(),t=Be(),i=Ti();return eu(e,t,i,n),n}function Tr(n){let e=uv(),t=Xc(e,ut+n);if(t===IA)throw new he(314,!1);return t}function oE(n){return Ci(Be(),Ws(),n)?ji(n):xn}function HT(n,e,t){let i=tn();i.firstCreatePass&&TA(e,i.data,i.blueprint,_r(n),t)}function TA(n,e,t,i,r){if(n=Pn(n),Array.isArray(n))for(let o=0;o<n.length;o++)TA(n[o],e,t,i,r);else{let o=tn(),s=Be(),a=Ln(),l=Os(n)?n:Pn(n.provide),u=Wy(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(Os(n)||!n.multi){let g=new Ys(u,r,ye,null),x=Uv(l,e,r?d:d+p,h);x===-1?(jv(kf(a,s),o,l),Vv(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)):(t[x]=g,s[x]=g)}else{let g=Uv(l,e,d+p,h),x=Uv(l,e,d,d+p),S=g>=0&&t[g],N=x>=0&&t[x];if(r&&!N||!r&&!S){jv(kf(a,s),o,l);let U=q5(r?W5:z5,t.length,r,i,u,n);!r&&N&&(t[x].providerFactory=U),Vv(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(U),s.push(U)}else{let U=CA(t[r?x:g],u,!r&&i);Vv(o,n,g>-1?g:x,U)}!r&&i&&N&&t[x].componentProviders++}}}function Vv(n,e,t,i){let r=Os(e),o=MI(e);if(r||o){let l=(o?Pn(e.useClass):e).prototype.ngOnDestroy;if(l){let u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let d=u.indexOf(t);d===-1?u.push(t,[i,l]):u[d+1].push(i,l)}else u.push(t,l)}}}function CA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Uv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function z5(n,e,t,i,r){return p_(this.multi,[])}function W5(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=cu(i,i[Ce],this.providerFactory.index,r);s=l.slice(0,a),p_(o,s);for(let u=a;u<l.length;u++)s.push(l[u])}else s=[],p_(o,s);return s}function p_(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function q5(n,e,t,i,r,o){let s=new Ys(n,t,ye,null);return s.multi=[],s.index=e,s.componentProviders=0,CA(s,r,i&&!t),s}function Au(n,e){return t=>{t.providersResolver=(i,r)=>HT(i,r?r(n):n,!1),e&&(t.viewProvidersResolver=(i,r)=>HT(i,r?r(e):e,!0))}}function ia(n,e){let t=nu()+n,i=Be();return i[t]===xn?W_(i,t,e()):QL(i,t)}function _t(n,e,t,i){return AA(Be(),nu(),n,e,t,i)}function DA(n,e){let t=n[e];return t===xn?void 0:t}function K5(n,e,t,i,r,o){let s=e+t;return Ci(n,s,r)?W_(n,s+1,o?i.call(o,r):i(r)):DA(n,s+1)}function AA(n,e,t,i,r,o,s){let a=e+t;return q_(n,a,r,o)?W_(n,a+2,s?i.call(s,r,o):i(r,o)):DA(n,a+2)}function ra(n,e){let t=tn(),i,r=n+ut;t.firstCreatePass?(i=Y5(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Lo(i.type,!0)),s,a=$n(ye);try{let l=Nf(!1),u=o();return Nf(l),eu(t,Be(),r,u),u}finally{$n(a)}}function Y5(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function sE(n,e,t){let i=n+ut,r=Be(),o=Xc(r,i);return MA(r,i)?K5(r,nu(),e,o.transform,t,o):o.transform(t)}function gl(n,e,t,i){let r=n+ut,o=Be(),s=Xc(o,r);return MA(o,r)?AA(o,nu(),e,s.transform,t,i,s):s.transform(t,i)}function MA(n,e){return n[Ce].data[e].pure}function aE(n,e){return dp(n,e)}var Jf=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},lE=(()=>{class n{compileModuleSync(t){return new Wf(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=Vy(t),o=nD(r.declarations).reduce((s,a)=>{let l=Qr(a);return l&&s.push(new ol(l)),s},[]);return new Jf(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var RA=(()=>{class n{applicationErrorHandler=z(di);appRef=z(Zn);taskService=z(Er);ngZone=z(vn);zonelessEnabled=z(ru);tracing=z(qo,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new yn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Gc):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(z(Sv,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?nT:Ev;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Gc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.applicationErrorHandler(i)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function PA(){return[{provide:Uo,useExisting:RA},{provide:vn,useClass:zc},{provide:ru,useValue:!0}]}function Q5(){return typeof $localize<"u"&&$localize.locale||Tu}var Mu=new _e("",{factory:()=>z(Mu,{optional:!0,skipSelf:!0})||Q5()});function Xn(n,e){return Eh(n,e?.equal)}var fE={JSACTION:"__jsaction",OWNER:"__owner"},FA={};function J5(n){return n[fE.JSACTION]}function NA(n,e){n[fE.JSACTION]=e}function Z5(n){return FA[n]}function X5(n,e){FA[n]=e}var Ne={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},eU=[Ne.MOUSEENTER,Ne.MOUSELEAVE,"pointerenter","pointerleave"],bte=[Ne.CLICK,Ne.DBLCLICK,Ne.FOCUSIN,Ne.FOCUSOUT,Ne.KEYDOWN,Ne.KEYUP,Ne.KEYPRESS,Ne.MOUSEOVER,Ne.MOUSEOUT,Ne.SUBMIT,Ne.TOUCHSTART,Ne.TOUCHEND,Ne.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],tU=[Ne.FOCUS,Ne.BLUR,Ne.ERROR,Ne.LOAD,Ne.TOGGLE],pE=n=>tU.indexOf(n)>=0;function nU(n){return n===Ne.MOUSEENTER?Ne.MOUSEOVER:n===Ne.MOUSELEAVE?Ne.MOUSEOUT:n===Ne.POINTERENTER?Ne.POINTEROVER:n===Ne.POINTERLEAVE?Ne.POINTEROUT:n}function iU(n,e,t,i){let r=!1;pE(e)&&(r=!0);let o=typeof i=="boolean"?{capture:r,passive:i}:r;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:r,passive:i}}function rU(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function oU(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var kA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function sU(n){return n.which===2||n.which==null&&n.button===4}function aU(n){return kA&&n.metaKey||!kA&&n.ctrlKey||sU(n)||n.shiftKey}function lU(n,e,t){let i=n.relatedTarget;return(n.type===Ne.MOUSEOVER&&e===Ne.MOUSEENTER||n.type===Ne.MOUSEOUT&&e===Ne.MOUSELEAVE||n.type===Ne.POINTEROVER&&e===Ne.POINTERENTER||n.type===Ne.POINTEROUT&&e===Ne.POINTERLEAVE)&&(!i||i!==t&&!t.contains(i))}function cU(n,e){let t={};for(let i in n){if(i==="srcElement"||i==="target")continue;let r=i,o=n[r];typeof o!="function"&&(t[r]=o)}return n.type===Ne.MOUSEOVER?t.type=Ne.MOUSEENTER:n.type===Ne.MOUSEOUT?t.type=Ne.MOUSELEAVE:n.type===Ne.POINTEROVER?t.type=Ne.POINTERENTER:t.type=Ne.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var uU=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),Cp=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,i){uU&&(this.element.style.cursor="pointer"),this.handlerInfos.push(iU(this.element,e,t(this.element),i))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)rU(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},dU={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function Zo(n){return n.eventType}function gE(n,e){n.eventType=e}function Ip(n){return n.event}function LA(n,e){n.event=e}function VA(n){return n.targetElement}function UA(n,e){n.targetElement=e}function BA(n){return n.eic}function hU(n,e){n.eic=e}function fU(n){return n.timeStamp}function pU(n,e){n.timeStamp=e}function Tp(n){return n.eia}function jA(n,e,t){n.eia=[e,t]}function cE(n){n.eia=void 0}function Sp(n){return n[1]}function gU(n){return n.eirp}function HA(n,e){n.eirp=e}function $A(n){return n.eir}function GA(n,e){n.eir=e}function zA(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function mU(n,e,t,i,r,o,s,a){return{eventType:n,event:e,targetElement:t,eic:i,timeStamp:r,eia:o,eirp:s,eiack:a}}var uE=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return Zo(this.eventInfo)}setEventType(e){gE(this.eventInfo,e)}getEvent(){return Ip(this.eventInfo)}setEvent(e){LA(this.eventInfo,e)}getTargetElement(){return VA(this.eventInfo)}setTargetElement(e){UA(this.eventInfo,e)}getContainer(){return BA(this.eventInfo)}setContainer(e){hU(this.eventInfo,e)}getTimestamp(){return fU(this.eventInfo)}setTimestamp(e){pU(this.eventInfo,e)}getAction(){let e=Tp(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){cE(this.eventInfo);return}jA(this.eventInfo,e.name,e.element)}getIsReplay(){return gU(this.eventInfo)}setIsReplay(e){HA(this.eventInfo,e)}getResolved(){return $A(this.eventInfo)}setResolved(e){GA(this.eventInfo,e)}clone(){return new n(zA(this.eventInfo))}},yU={},vU=/\s*;\s*/,_U=Ne.CLICK,dE=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&Zo(e)===Ne.CLICK&&aU(Ip(e))?gE(e,Ne.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){$A(e)||(this.populateAction(e,VA(e)),GA(e,!0))}resolveParentAction(e){let t=Tp(e),i=t&&Sp(t);cE(e);let r=i&&this.getParentNode(i);r&&this.populateAction(e,r)}populateAction(e,t){let i=t;for(;i&&i!==BA(e)&&(i.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(i,e),!Tp(e));)i=this.getParentNode(i);let r=Tp(e);if(r&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(Zo(e)===Ne.MOUSEENTER||Zo(e)===Ne.MOUSELEAVE||Zo(e)===Ne.POINTERENTER||Zo(e)===Ne.POINTERLEAVE)))if(lU(Ip(e),Zo(e),Sp(r))){let o=cU(Ip(e),Sp(r));LA(e,o),UA(e,Sp(r))}else cE(e)}getParentNode(e){let t=e[fE.OWNER];if(t)return t;let i=e.parentNode;return i?.nodeName==="#document-fragment"?i?.host??null:i}populateActionOnElement(e,t){let i=this.parseActions(e),r=i[Zo(t)];r!==void 0&&jA(t,r,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,i)}parseActions(e){let t=J5(e);if(!t){let i=e.getAttribute(Ef.JSACTION);if(!i)t=yU,NA(e,t);else{if(t=Z5(i),!t){t={};let r=i.split(vU);for(let o=0;o<r.length;o++){let s=r[o];if(!s)continue;let a=s.indexOf(dU.EVENT_ACTION_SEPARATOR),l=a!==-1,u=l?s.substr(0,a).trim():_U,d=l?s.substr(a+1).trim():s;t[u]=d}X5(i,t)}NA(e,t)}}return t}addA11yClickSupport(e,t,i){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=i}},WA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(WA||{}),hE=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:i}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=i}dispatch(e){let t=new uE(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let i=t.getAction();if(i&&EU(i.element,t)&&oU(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function EU(n,e){return n.tagName==="A"&&(e.getEventType()===Ne.CLICK||e.getEventType()===Ne.CLICKMOD)}var qA=Symbol.for("propagationStopped"),mE={REPLAY:101};var bU="`preventDefault` called during event replay.";var wU="`composedPath` called during event replay.",Dp=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new dE({clickModSupport:t}),this.dispatcher=new hE(i=>{this.dispatchToDelegate(i)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&IU(e),xU(e);e.getAction();){if(TU(e),pE(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),SU(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function xU(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),i=()=>{e[qA]=!0,t()};oa(e,"stopPropagation",i),oa(e,"stopImmediatePropagation",i)}function SU(n){return!!n.getEvent()[qA]}function IU(n){let e=n.getEvent(),t=n.getTargetElement(),i=e.preventDefault.bind(e);oa(e,"target",t),oa(e,"eventPhase",mE.REPLAY),oa(e,"preventDefault",()=>{throw i(),new Error(bU+"")}),oa(e,"composedPath",()=>{throw new Error(wU+"")})}function TU(n){let e=n.getEvent(),t=n.getAction()?.element;t&&oa(e,"currentTarget",t,{configurable:!0})}function oa(n,e,t,{configurable:i=!1}={}){Object.defineProperty(n,e,{value:t,configurable:i})}function KA(n,e){n.ecrd(t=>{e.dispatch(t)},WA.I_AM_THE_JSACTION_FRAMEWORK)}function CU(n){return n?.q??[]}function DU(n){n&&(OA(n.c,n.et,n.h),OA(n.c,n.etc,n.h,!0))}function OA(n,e,t,i){for(let r=0;r<e.length;r++)n.removeEventListener(e[r],t,i)}var AU=!1,YA=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=AU;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,i,r){let o=mU(t,i,i.target,r,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){HA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,i,r){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&eU.indexOf(t)>=0)return;let o=(a,l,u)=>{this.handleEvent(a,l,u)};this.eventHandlers[t]=o;let s=nU(i||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>l=>{o(t,l,a)},r)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),DU(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let i=0;i<t.length;i++){let r=t[i],o=this.getEventTypesForBrowserEventType(r.eventType);for(let s=0;s<o.length;s++){let a=zA(r);gE(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let i=[];return this.eventHandlers[t]&&i.push(t),this.browserEventTypeToExtraEventTypes[t]&&i.push(...this.browserEventTypeToExtraEventTypes[t]),i}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,i){this.ecrd(t,i)}ecrd(t,i){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let r=0;r<this.queuedEventInfos.length;r++)this.handleEventInfo(this.queuedEventInfos[r]);this.queuedEventInfos=null}}}return n})();function QA(n,e=window){return CU(e._ejsas?.[n])}function yE(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var aM=Symbol("InputSignalNode#UNSET"),i6=pe(F({},bh),{transformFn:void 0,applyValueToInputSignal(n,e){kc(n,e)}});function lM(n,e){let t=Object.create(i6);t.value=n,t.transformFn=e?.transform;function i(){if(Rc(t),t.value===aM){let r=null;throw new he(-950,r)}return t.value}return i[Kn]=t,i}var Rp=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>mu(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function JA(n,e){return lM(n,e)}function r6(n){return lM(aM,n)}var cM=(JA.required=r6,JA);var vE=new _e(""),o6=new _e("");function Ru(n){return!n.moduleRef}function s6(n){let e=Ru(n)?n.r3Injector:n.moduleRef.injector,t=e.get(vn);return t.run(()=>{Ru(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(di),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Ru(n)){let o=()=>e.destroy(),s=n.platformInjector.get(vE);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(vE);s.add(o),n.moduleRef.onDestroy(()=>{lu(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return l6(i,t,()=>{let o=e.get(Er),s=o.add(),a=e.get(X_);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(Mu,Tu);if(gA(l||Tu),!e.get(o6,!0))return Ru(n)?e.get(Zn):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Ru(n)){let d=e.get(Zn);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return a6?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var a6;function l6(n,e,t){try{let i=t();return Yo(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Mp=null;function c6(n=[],e){return zn.create({name:e,providers:[{provide:Kc,useValue:"platform"},{provide:vE,useValue:new Set([()=>Mp=null])},...n]})}function u6(n=[]){if(Mp)return Mp;let e=c6(n);return Mp=e,cA(),d6(e),e}function d6(n){let e=n.get(Zf,null);Nn(n,()=>{e?.forEach(t=>t())})}function uM(){return!1}var Ap=new WeakSet,ZA="";function XA(n){return n.get(b_,IC)}function dM(){let n=[{provide:b_,useFactory:()=>{let e=!0;{let t=z(wr);e=!!window._ejsas?.[t]}return e&&fi("NgEventReplay"),e}}];return n.push({provide:pr,useValue:()=>{let e=z(Zn),{injector:t}=e;if(!Ap.has(e)){let i=z(w_);if(XA(t)){kC();let r=t.get(wr),o=PC(r,(s,a,l)=>{s.nodeType===Node.ELEMENT_NODE&&(DC(s,a,l),AC(s,i))});e.onDestroy(o)}}},multi:!0},{provide:Qo,useFactory:()=>{let e=z(Zn),{injector:t}=e;return()=>{if(!XA(t)||Ap.has(e))return;Ap.add(e);let i=t.get(wr);e.onDestroy(()=>{Ap.delete(e),yE(i)}),e.whenStable().then(()=>{if(e.destroyed)return;let r=t.get(RC);h6(r,t);let o=t.get(w_);o.get(ZA)?.forEach(MC),o.delete(ZA);let s=r.instance;jC(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var h6=(n,e)=>{let t=e.get(wr),i=window._ejsas[t],r=n.instance=new YA(new Cp(i.c));for(let a of i.et)r.addEvent(a);for(let a of i.etc)r.addEvent(a);let o=QA(t);r.replayEarlyEventInfos(o),yE(t);let s=new Dp(a=>{f6(e,a,a.currentTarget)});KA(r,s)};function f6(n,e,t){let i=(t&&t.getAttribute(vu))??"";/d\d+/.test(i)?p6(i,n,e,t):e.eventPhase===mE.REPLAY&&x_(e,t)}function p6(n,e,t,i){let r=e.get(TC);r.push({event:t,currentTarget:i}),hA(e,n,g6(r))}function g6(n){return e=>{let t=new Set(e),i=[];for(let{event:r,currentTarget:o}of n){let s=o.getAttribute(vu);t.has(s)?x_(r,o):i.push({event:r,currentTarget:o})}n.length=0,n.push(...i)}}var eM=!1;var m6=1e4;function y6(){eM||(eM=!0,VC(),fA(),SA(),pA(),oA(),ZD(),OD(),gD())}function v6(n){return n.whenStable()}function hM(){let n=[{provide:yu,useFactory:()=>{let e=!0;return e=!!z(cl,{optional:!0})?.get(S_,null),e&&fi("NgHydration"),e}},{provide:pr,useValue:()=>{RD(!1);let e=z(qt);z(yu)&&(GC(e),y6())},multi:!0}];return n.push({provide:E_,useFactory:()=>z(yu)},{provide:Qo,useFactory:()=>{if(z(yu)){let e=z(Zn);return()=>{v6(e).then(()=>{e.destroyed||G_(e)})}}return()=>{}},multi:!0}),gr(n)}var ose=m6-1e3;var Pu=(()=>{class n{static __NG_ELEMENT_ID__=_6}return n})();function _6(n){return E6(Ln(),Be(),(n&16)===16)}function E6(n,e,t){if(Zr(n)&&!t){let i=Si(n.index,e);return new zo(i,i)}else if(n.type&175){let i=e[qn];return new zo(i,e)}return null}var _E=class{constructor(){}supports(e){return z_(e)}create(e){return new EE(e)}},b6=(n,e)=>e,EE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||b6}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<tM(i,r,o)?t:i,a=tM(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let u=a-r,d=l-r;if(u!=d){for(let p=0;p<u;p++){let g=p<o.length?o[p]:o[p]=0,x=g+p;d<=x&&x<u&&(o[p]=g+1)}let h=s.previousIndex;o[h]=d-u}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!z_(e))throw new he(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,GD(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new bE(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Pp),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Pp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},bE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},wE=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},Pp=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new wE,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function tM(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}var xE=class{constructor(){}supports(e){return e instanceof Map||yp(e)}create(){return new SE}},SE=class{_records=new Map;_mapHead=null;_appendAfter=null;_previousMapHead=null;_changesHead=null;_changesTail=null;_additionsHead=null;_additionsTail=null;_removalsHead=null;_removalsTail=null;get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let t;for(t=this._mapHead;t!==null;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;t!==null;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;t!==null;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||yp(e)))throw new he(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{let o=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;i!==null;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){let i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){let r=this._records.get(e);this._maybeAddToChanges(r,t);let o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}let i=new IE(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}},IE=class{key;previousValue=null;currentValue=null;_nextPrevious=null;_next=null;_prev=null;_nextAdded=null;_nextRemoved=null;_nextChanged=null;constructor(e){this.key=e}};function nM(){return new TE([new _E])}var TE=(()=>{class n{factories;static \u0275prov=ae({token:n,providedIn:"root",factory:nM});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=z(n,{optional:!0,skipSelf:!0});return n.create(t,i||nM())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new he(901,!1)}}return n})();function iM(){return new CE([new xE])}var CE=(()=>{class n{static \u0275prov=ae({token:n,providedIn:"root",factory:iM});factories;constructor(t){this.factories=t}static create(t,i){if(i){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=z(n,{optional:!0,skipSelf:!0});return n.create(t,i||iM())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i)return i;throw new he(901,!1)}}return n})();function fM(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;pt(st.BootstrapApplicationStart);try{let o=r?.injector??u6(i),s=[PA(),rT,...t||[]],a=new fu({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return s6({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{pt(st.BootstrapApplicationEnd)}}function Nu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var pM=null;function Ai(){return pM}function DE(n){pM??=n}var ku=class{},Np=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>z(gM),providedIn:"platform"})}return n})();var gM=(()=>{class n extends Np{_location;_history;_doc=z(qt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ai().getBaseHref(this._doc)}onPopState(t){let i=Ai().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Ai().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function vM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function mM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Xo(n){return n&&n[0]!=="?"?`?${n}`:n}var ml=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>z(x6),providedIn:"root"})}return n})(),w6=new _e(""),x6=(()=>{class n extends ml{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??z(qt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return vM(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+Xo(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+Xo(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+Xo(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Me(Np),Me(w6,8))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yl=(()=>{class n{_subject=new zt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=T6(mM(yM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Xo(i))}normalize(t){return n.stripTrailingSlash(I6(this._basePath,yM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Xo(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Xo(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=Xo;static joinWithSlash=vM;static stripTrailingSlash=mM;static \u0275fac=function(i){return new(i||n)(Me(ml))};static \u0275prov=ae({token:n,factory:()=>S6(),providedIn:"root"})}return n})();function S6(){return new yl(Me(ml))}function I6(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function yM(n){return n.replace(/\/index.html$/,"")}function T6(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Vn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Vn||{}),St=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(St||{}),ei=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(ei||{}),ro={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function wM(n){return pi(n)[nn.LocaleId]}function xM(n,e,t){let i=pi(n),r=[i[nn.DayPeriodsFormat],i[nn.DayPeriodsStandalone]],o=Mi(r,e);return Mi(o,t)}function SM(n,e,t){let i=pi(n),r=[i[nn.DaysFormat],i[nn.DaysStandalone]],o=Mi(r,e);return Mi(o,t)}function IM(n,e,t){let i=pi(n),r=[i[nn.MonthsFormat],i[nn.MonthsStandalone]],o=Mi(r,e);return Mi(o,t)}function TM(n,e){let i=pi(n)[nn.Eras];return Mi(i,e)}function Ou(n,e){let t=pi(n);return Mi(t[nn.DateFormat],e)}function Fu(n,e){let t=pi(n);return Mi(t[nn.TimeFormat],e)}function Lu(n,e){let i=pi(n)[nn.DateTimeFormat];return Mi(i,e)}function Vu(n,e){let t=pi(n),i=t[nn.NumberSymbols][e];if(typeof i>"u"){if(e===ro.CurrencyDecimal)return t[nn.NumberSymbols][ro.Decimal];if(e===ro.CurrencyGroup)return t[nn.NumberSymbols][ro.Group]}return i}function CM(n){if(!n[nn.ExtraData])throw new he(2303,!1)}function DM(n){let e=pi(n);return CM(e),(e[nn.ExtraData][2]||[]).map(i=>typeof i=="string"?AE(i):[AE(i[0]),AE(i[1])])}function AM(n,e,t){let i=pi(n);CM(i);let r=[i[nn.ExtraData][0],i[nn.ExtraData][1]],o=Mi(r,e)||[];return Mi(o,t)||[]}function Mi(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new he(2304,!1)}function AE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var C6=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,kp={},D6=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function MM(n,e,t,i){let r=L6(n);e=io(t,e)||e;let s=[],a;for(;e;)if(a=D6.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let l=r.getTimezoneOffset();i&&(l=PM(i,l),r=F6(r,i));let u="";return s.forEach(d=>{let h=k6(d);u+=h?h(r,t,l):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function Up(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function io(n,e){let t=wM(n);if(kp[t]??={},kp[t][e])return kp[t][e];let i="";switch(e){case"shortDate":i=Ou(n,ei.Short);break;case"mediumDate":i=Ou(n,ei.Medium);break;case"longDate":i=Ou(n,ei.Long);break;case"fullDate":i=Ou(n,ei.Full);break;case"shortTime":i=Fu(n,ei.Short);break;case"mediumTime":i=Fu(n,ei.Medium);break;case"longTime":i=Fu(n,ei.Long);break;case"fullTime":i=Fu(n,ei.Full);break;case"short":let r=io(n,"shortTime"),o=io(n,"shortDate");i=Op(Lu(n,ei.Short),[r,o]);break;case"medium":let s=io(n,"mediumTime"),a=io(n,"mediumDate");i=Op(Lu(n,ei.Medium),[s,a]);break;case"long":let l=io(n,"longTime"),u=io(n,"longDate");i=Op(Lu(n,ei.Long),[l,u]);break;case"full":let d=io(n,"fullTime"),h=io(n,"fullDate");i=Op(Lu(n,ei.Full),[d,h]);break}return i&&(kp[t][e]=i),i}function Op(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function Qi(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function A6(n,e){return Qi(n,3).substring(0,e)}function fn(n,e,t=0,i=!1,r=!1){return function(o,s){let a=M6(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return A6(a,e);let l=Vu(s,ro.MinusSign);return Qi(a,e,l,i,r)}}function M6(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new he(2301,!1)}}function Dt(n,e,t=Vn.Format,i=!1){return function(r,o){return R6(r,o,n,e,t,i)}}function R6(n,e,t,i,r,o){switch(t){case 2:return IM(e,r,i)[n.getMonth()];case 1:return SM(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let u=DM(e),d=AM(e,r,i),h=u.findIndex(p=>{if(Array.isArray(p)){let[g,x]=p,S=s>=g.hours&&a>=g.minutes,N=s<x.hours||s===x.hours&&a<x.minutes;if(g.hours<x.hours){if(S&&N)return!0}else if(S||N)return!0}else if(p.hours===s&&p.minutes===a)return!0;return!1});if(h!==-1)return d[h]}return xM(e,r,i)[s<12?0:1];case 3:return TM(e,i)[n.getFullYear()<=0?0:1];default:let l=t;throw new he(2302,!1)}}function Fp(n){return function(e,t,i){let r=-1*i,o=Vu(t,ro.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Qi(s,2,o)+Qi(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+Qi(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+Qi(s,2,o)+":"+Qi(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+Qi(s,2,o)+":"+Qi(Math.abs(r%60),2,o);default:throw new he(2310,!1)}}}var P6=0,Vp=4;function N6(n){let e=Up(n,P6,1).getDay();return Up(n,0,1+(e<=Vp?Vp:Vp+7)-e)}function RM(n){let e=n.getDay(),t=e===0?-3:Vp-e;return Up(n.getFullYear(),n.getMonth(),n.getDate()+t)}function ME(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=RM(t),s=N6(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Qi(r,n,Vu(i,ro.MinusSign))}}function Lp(n,e=!1){return function(t,i){let o=RM(t).getFullYear();return Qi(o,n,Vu(i,ro.MinusSign),e)}}var RE={};function k6(n){if(RE[n])return RE[n];let e;switch(n){case"G":case"GG":case"GGG":e=Dt(3,St.Abbreviated);break;case"GGGG":e=Dt(3,St.Wide);break;case"GGGGG":e=Dt(3,St.Narrow);break;case"y":e=fn(0,1,0,!1,!0);break;case"yy":e=fn(0,2,0,!0,!0);break;case"yyy":e=fn(0,3,0,!1,!0);break;case"yyyy":e=fn(0,4,0,!1,!0);break;case"Y":e=Lp(1);break;case"YY":e=Lp(2,!0);break;case"YYY":e=Lp(3);break;case"YYYY":e=Lp(4);break;case"M":case"L":e=fn(1,1,1);break;case"MM":case"LL":e=fn(1,2,1);break;case"MMM":e=Dt(2,St.Abbreviated);break;case"MMMM":e=Dt(2,St.Wide);break;case"MMMMM":e=Dt(2,St.Narrow);break;case"LLL":e=Dt(2,St.Abbreviated,Vn.Standalone);break;case"LLLL":e=Dt(2,St.Wide,Vn.Standalone);break;case"LLLLL":e=Dt(2,St.Narrow,Vn.Standalone);break;case"w":e=ME(1);break;case"ww":e=ME(2);break;case"W":e=ME(1,!0);break;case"d":e=fn(2,1);break;case"dd":e=fn(2,2);break;case"c":case"cc":e=fn(7,1);break;case"ccc":e=Dt(1,St.Abbreviated,Vn.Standalone);break;case"cccc":e=Dt(1,St.Wide,Vn.Standalone);break;case"ccccc":e=Dt(1,St.Narrow,Vn.Standalone);break;case"cccccc":e=Dt(1,St.Short,Vn.Standalone);break;case"E":case"EE":case"EEE":e=Dt(1,St.Abbreviated);break;case"EEEE":e=Dt(1,St.Wide);break;case"EEEEE":e=Dt(1,St.Narrow);break;case"EEEEEE":e=Dt(1,St.Short);break;case"a":case"aa":case"aaa":e=Dt(0,St.Abbreviated);break;case"aaaa":e=Dt(0,St.Wide);break;case"aaaaa":e=Dt(0,St.Narrow);break;case"b":case"bb":case"bbb":e=Dt(0,St.Abbreviated,Vn.Standalone,!0);break;case"bbbb":e=Dt(0,St.Wide,Vn.Standalone,!0);break;case"bbbbb":e=Dt(0,St.Narrow,Vn.Standalone,!0);break;case"B":case"BB":case"BBB":e=Dt(0,St.Abbreviated,Vn.Format,!0);break;case"BBBB":e=Dt(0,St.Wide,Vn.Format,!0);break;case"BBBBB":e=Dt(0,St.Narrow,Vn.Format,!0);break;case"h":e=fn(3,1,-12);break;case"hh":e=fn(3,2,-12);break;case"H":e=fn(3,1);break;case"HH":e=fn(3,2);break;case"m":e=fn(4,1);break;case"mm":e=fn(4,2);break;case"s":e=fn(5,1);break;case"ss":e=fn(5,2);break;case"S":e=fn(6,1);break;case"SS":e=fn(6,2);break;case"SSS":e=fn(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Fp(0);break;case"ZZZZZ":e=Fp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Fp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Fp(2);break;default:return null}return RE[n]=e,e}function PM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function O6(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function F6(n,e,t){let r=n.getTimezoneOffset(),o=PM(e,r);return O6(n,-1*(o-r))}function L6(n){if(_M(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return Up(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(C6))return V6(i)}let e=new Date(n);if(!_M(e))throw new he(2311,!1);return e}function V6(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,u),e}function _M(n){return n instanceof Date&&!isNaN(n.valueOf())}var Bp=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Hp=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Bp(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),EM(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);EM(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(ye(to),ye(Wo),ye(TE))};static \u0275dir=_n({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function EM(n,e){n.context.$implicit=e.item}var PE=(()=>{class n{_viewContainer;_context=new jp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){bM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){bM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(ye(to),ye(Wo))};static \u0275dir=_n({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),jp=class{$implicit=null;ngIf=null};function bM(n,e){if(n&&!n.createEmbeddedView)throw new he(2020,!1)}var NE=(()=>{class n{_ngEl;_differs;_renderer;_ngStyle=null;_differ=null;constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){let t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){let[r,o]=t.split("."),s=r.indexOf("-")===-1?void 0:Wi.DashCase;i!=null?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static \u0275fac=function(i){return new(i||n)(ye(Di),ye(CE),ye(Ko))};static \u0275dir=_n({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}})}return n})();function NM(n,e){return new he(2100,!1)}var U6=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,kE=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw NM(n,t);return t.replace(U6,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=_p({name:"titlecase",type:n,pure:!0})}return n})();var B6="mediumDate",kM=new _e(""),OM=new _e(""),Uu=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??B6,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return MM(t,s,o||this.locale,a)}catch(s){throw NM(n,s.message)}}static \u0275fac=function(i){return new(i||n)(ye(Mu,16),ye(kM,24),ye(OM,24))};static \u0275pipe=_p({name:"date",type:n,pure:!0})}return n})();var Qt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=no({type:n});static \u0275inj=fr({})}return n})();function OE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Bu=class{};var FE="browser";function es(n){return n===FE}var ju=class{_doc;constructor(e){this._doc=e}manager},Gp=(()=>{class n extends ju{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(Me(qt))};static \u0275prov=ae({token:n,factory:n.\u0275fac})}return n})(),qp=new _e(""),BE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof Gp));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof Gp);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new he(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Me(qp),Me(vn))};static \u0275prov=ae({token:n,factory:n.\u0275fac})}return n})(),LE="ng-app-id";function FM(n){for(let e of n)e.remove()}function LM(n,e){let t=e.createElement("style");return t.textContent=n,t}function j6(n,e,t,i){let r=n.head?.querySelectorAll(`style[${LE}="${e}"],link[${LE}="${e}"]`);if(r)for(let o of r)o.removeAttribute(LE),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function UE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var jE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,j6(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,LM);i?.forEach(r=>this.addUsage(r,this.external,UE))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(FM(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])FM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,LM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,UE(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Me(qt),Me(wr),Me(ll,8),Me(qi))};static \u0275prov=ae({token:n,factory:n.\u0275fac})}return n})(),VE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},HE=/%COMP%/g;var UM="%COMP%",H6=`_nghost-${UM}`,$6=`_ngcontent-${UM}`,G6=!0,z6=new _e("",{factory:()=>G6});function W6(n){return $6.replace(HE,n)}function q6(n){return H6.replace(HE,n)}function BM(n,e){return e.map(t=>t.replace(HE,n))}var $E=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,r,o,s,a,l=null,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=u,this.defaultRenderer=new Hu(t,s,a,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof Wp?r.applyToHost(t):r instanceof $u&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.tracingService;switch(i.encapsulation){case zi.Emulated:o=new Wp(l,u,i,this.appId,d,s,a,h);break;case zi.ShadowDom:return new zp(l,t,i,s,a,this.nonce,h,u);case zi.ExperimentalIsolatedShadowDom:return new zp(l,t,i,s,a,this.nonce,h);default:o=new $u(l,u,i,d,s,a,h);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Me(BE),Me(jE),Me(wr),Me(z6),Me(qt),Me(vn),Me(ll),Me(qo,8))};static \u0275prov=ae({token:n,factory:n.\u0275fac})}return n})(),Hu=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(VE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(VM(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(VM(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new he(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=VE[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=VE[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Wi.DashCase|Wi.Important)?e.style.setProperty(t,i,r&Wi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Wi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Ai().getGlobalEventTarget(this.doc,e),!e))throw new he(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function VM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var zp=class extends Hu{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let u=i.styles;u=BM(i.id,u);for(let h of u){let p=document.createElement("style");s&&p.setAttribute("nonce",s),p.textContent=h,this.shadowRoot.appendChild(p)}let d=i.getExternalStyles?.();if(d)for(let h of d){let p=UE(h,r);s&&p.setAttribute("nonce",s),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},$u=class extends Hu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let u=i.styles;this.styles=l?BM(l,u):u,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Qs.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Wp=class extends $u{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l){let u=r+"-"+i.id;super(e,t,i,o,s,a,l,u),this.contentAttr=W6(u),this.hostAttr=q6(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var Kp=class n extends ku{supportsDOMEvents=!0;static makeCurrent(){DE(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=K6();return t==null?null:Y6(t)}resetBaseElement(){Gu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return OE(document.cookie,e)}},Gu=null;function K6(){return Gu=Gu||document.head.querySelector("base"),Gu?Gu.getAttribute("href"):null}function Y6(n){return new URL(n,document.baseURI).pathname}var Q6=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac})}return n})(),jM=["alt","control","meta","shift"],J6={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Z6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},HM=(()=>{class n extends ju{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ai().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),jM.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),s+=u+".")}),s+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=J6[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),jM.forEach(s=>{if(s!==r){let a=Z6[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(Me(qt))};static \u0275prov=ae({token:n,factory:n.\u0275fac})}return n})();async function GE(n,e,t){let i=F({rootComponent:n},X6(e,t));return fM(i)}function X6(n,e){return{platformRef:e?.platformRef,appProviders:[...rB,...n?.providers??[]],platformProviders:iB}}function eB(){Kp.makeCurrent()}function tB(){return new dr}function nB(){return y_(document),document}var iB=[{provide:qi,useValue:FE},{provide:Zf,useValue:eB,multi:!0},{provide:qt,useFactory:nB}];var rB=[{provide:Kc,useValue:"root"},{provide:dr,useFactory:tB},{provide:qp,useClass:Gp,multi:!0},{provide:qp,useClass:HM,multi:!0},$E,jE,BE,{provide:Js,useExisting:$E},{provide:Bu,useClass:Q6},[]];var zu=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var oB="text/plain",sB="application/json",Kae=`${sB}, ${oB}, */*`;var WE=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(WE||{}),zE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new zu,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var Yp=class n extends zE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=WE.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var $M=new _e("");var aB=new _e(""),lB="b",cB="h",uB="s",dB="st",hB="u",fB="rt",qE=new _e(""),pB=["GET","HEAD"];function gB(n,e){let g=z(qE),{isCacheActive:t}=g,i=Va(g,["isCacheActive"]),{transferCache:r,method:o}=n;if(!t||r===!1||o==="POST"&&!i.includePostRequests&&!r||o!=="POST"&&!pB.includes(o)||!i.includeRequestsWithAuthHeaders&&mB(n)||i.filter?.(n)===!1)return e(n);let s=z(cl);if(z(aB,{optional:!0}))throw new he(2803,!1);let l=n.url,u=yB(n,l),d=s.get(u,null),h=i.includeHeaders;if(typeof r=="object"&&r.includeHeaders&&(h=r.includeHeaders),d){let{[lB]:x,[fB]:S,[cB]:N,[uB]:U,[dB]:ie,[hB]:Se}=d,xe=x;switch(S){case"arraybuffer":xe=new TextEncoder().encode(x).buffer;break;case"blob":xe=new Blob([x]);break}let De=new zu(N);return it(new Yp({body:xe,headers:De,status:U,statusText:ie,url:Se}))}return e(n)}function mB(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function GM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function yB(n,e){let{params:t,method:i,responseType:r}=n,o=GM(t),s=n.serializeBody();s instanceof URLSearchParams?s=GM(s):typeof s!="string"&&(s="");let a=[i,r,e,s,o].join("|"),l=vB(a);return l}function vB(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function zM(n){return[{provide:qE,useFactory:()=>(fi("NgHttpTransferCache"),F({isCacheActive:!0},n))},{provide:$M,useValue:gB,multi:!0},{provide:Qo,multi:!0,useFactory:()=>{let e=z(Zn),t=z(qE);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var WM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Me(qt))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Qp=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(Qp||{});function _B(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function qM(){return _B(Qp.EventReplay,dM())}function KM(...n){let e=[],t=new Set;for(let{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);let i=t.has(Qp.HttpTransferCacheOptions);return gr([[],[],hM(),t.has(Qp.NoHttpTransferCache)||i?[]:zM({}),e])}var Ge="primary",id=Symbol("RouteTitle"),ZE=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function la(n){return new ZE(n)}function KE(n,e,t){for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function rR(n,e,t){let i=t.path.split("/"),r=i.indexOf("**");if(r===-1){if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let l={},u=n.slice(0,i.length);return KE(i,u,l)?{consumed:u,posParams:l}:null}if(r!==i.lastIndexOf("**"))return null;let o=i.slice(0,r),s=i.slice(r+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!KE(o,n.slice(0,o.length),a)||!KE(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function ng(n){return new Promise((e,t)=>{n.pipe(zr()).subscribe({next:i=>e(i),error:i=>t(i)})})}function bB(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Cr(n[t],e[t]))return!1;return!0}function Cr(n,e){let t=n?XE(n):void 0,i=e?XE(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!oR(n[r],e[r]))return!1;return!0}function XE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function oR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function wB(n){return n.length>0?n[n.length-1]:null}function da(n){return $h(n)?n:Yo(n)?cn(Promise.resolve(n)):it(n)}function sR(n){return $h(n)?ng(n):Promise.resolve(n)}var xB={exact:lR,subset:cR},aR={exact:SB,subset:IB,ignored:()=>!0};function YM(n,e,t){return xB[t.paths](n.root,e.root,t.matrixParams)&&aR[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function SB(n,e){return Cr(n,e)}function lR(n,e,t){if(!sa(n.segments,e.segments)||!Xp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!lR(n.children[i],e.children[i],t))return!1;return!0}function IB(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>oR(n[t],e[t]))}function cR(n,e,t){return uR(n,e,e.segments,t)}function uR(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!sa(r,t)||e.hasChildren()||!Xp(r,t,i))}else if(n.segments.length===t.length){if(!sa(n.segments,t)||!Xp(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!cR(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!sa(n.segments,r)||!Xp(n.segments,r,i)||!n.children[Ge]?!1:uR(n.children[Ge],e,o,i)}}function Xp(n,e,t){return e.every((i,r)=>aR[t](n[r].parameters,i.parameters))}var Zi=class{root;queryParams;fragment;_queryParamMap;constructor(e=new gt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=la(this.queryParams),this._queryParamMap}toString(){return DB.serialize(this)}},gt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return eg(this)}},ts=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=la(this.parameters),this._parameterMap}toString(){return hR(this)}};function TB(n,e){return sa(n,e)&&n.every((t,i)=>Cr(t.parameters,e[i].parameters))}function sa(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function CB(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ge&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ge&&(t=t.concat(e(r,i)))}),t}var rd=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>new ns,providedIn:"root"})}return n})(),ns=class{parse(e){let t=new tb(e);return new Zi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Wu(e.root,!0)}`,i=RB(e.queryParams),r=typeof e.fragment=="string"?`#${AB(e.fragment)}`:"";return`${t}${i}${r}`}},DB=new ns;function eg(n){return n.segments.map(e=>hR(e)).join("/")}function Wu(n,e){if(!n.hasChildren())return eg(n);if(e){let t=n.children[Ge]?Wu(n.children[Ge],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==Ge&&i.push(`${r}:${Wu(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=CB(n,(i,r)=>r===Ge?[Wu(n.children[Ge],!1)]:[`${r}:${Wu(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ge]!=null?`${eg(n)}/${t[0]}`:`${eg(n)}/(${t.join("//")})`}}function dR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Jp(n){return dR(n).replace(/%3B/gi,";")}function AB(n){return encodeURI(n)}function eb(n){return dR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function tg(n){return decodeURIComponent(n)}function QM(n){return tg(n.replace(/\+/g,"%20"))}function hR(n){return`${eb(n.path)}${MB(n.parameters)}`}function MB(n){return Object.entries(n).map(([e,t])=>`;${eb(e)}=${eb(t)}`).join("")}function RB(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Jp(t)}=${Jp(r)}`).join("&"):`${Jp(t)}=${Jp(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var PB=/^[^\/()?;#]+/;function YE(n){let e=n.match(PB);return e?e[0]:""}var NB=/^[^\/()?;=#]+/;function kB(n){let e=n.match(NB);return e?e[0]:""}var OB=/^[^=?&#]+/;function FB(n){let e=n.match(OB);return e?e[0]:""}var LB=/^[^&#]+/;function VB(n){let e=n.match(LB);return e?e[0]:""}var tb=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new gt([],{}):new gt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ge]=new gt(e,t)),i}parseSegment(){let e=YE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new he(4009,!1);return this.capture(e),new ts(tg(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=kB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=YE(this.remaining);r&&(i=r,this.capture(i))}e[tg(t)]=tg(i)}parseQueryParam(e){let t=FB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=VB(this.remaining);s&&(i=s,this.capture(i))}let r=QM(t),o=QM(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=YE(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new he(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Ge);let s=this.parseChildren();t[o??Ge]=Object.keys(s).length===1&&s[Ge]?s[Ge]:new gt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new he(4011,!1)}};function fR(n){return n.segments.length>0?new gt([],{[Ge]:n}):n}function pR(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=pR(r);if(i===Ge&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new gt(n.segments,e);return UB(t)}function UB(n){if(n.numberOfChildren===1&&n.children[Ge]){let e=n.children[Ge];return new gt(n.segments.concat(e.segments),e.children)}return n}function is(n){return n instanceof Zi}function gR(n,e,t=null,i=null,r=new ns){let o=mR(n);return yR(o,e,t,i,r)}function mR(n){let e;function t(o){let s={};for(let l of o.children){let u=t(l);s[l.outlet]=u}let a=new gt(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=fR(i);return e??r}function yR(n,e,t,i,r){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return QE(o,o,o,t,i,r);let s=BB(e);if(s.toRoot())return QE(o,o,new gt([],{}),t,i,r);let a=jB(s,o,n),l=a.processChildren?Ku(a.segmentGroup,a.index,s.commands):_R(a.segmentGroup,a.index,s.commands);return QE(o,a.segmentGroup,l,t,i,r)}function ig(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Ju(n){return typeof n=="object"&&n!=null&&n.outlets}function JM(n,e,t){n||="\u0275";let i=new Zi;return i.queryParams={[n]:e},t.parse(t.serialize(i)).queryParams[n]}function QE(n,e,t,i,r,o){let s={};for(let[u,d]of Object.entries(i??{}))s[u]=Array.isArray(d)?d.map(h=>JM(u,h,o)):JM(u,d,o);let a;n===e?a=t:a=vR(n,e,t);let l=fR(pR(a));return new Zi(l,s,r)}function vR(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=vR(o,e,t)}),new gt(n.segments,i)}var rg=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&ig(i[0]))throw new he(4003,!1);let r=i.find(Ju);if(r&&r!==wB(i))throw new he(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function BB(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new rg(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,u])=>{a[l]=typeof u=="string"?u.split("/"):u}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new rg(t,e,i)}var _l=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function jB(n,e,t){if(n.isAbsolute)return new _l(e,!0,0);if(!t)return new _l(e,!1,NaN);if(t.parent===null)return new _l(t,!0,0);let i=ig(n.commands[0])?0:1,r=t.segments.length-1+i;return HB(t,r,n.numberOfDoubleDots)}function HB(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new he(4005,!1);r=i.segments.length}return new _l(i,!1,r-o)}function $B(n){return Ju(n[0])?n[0].outlets:{[Ge]:n}}function _R(n,e,t){if(n??=new gt([],{}),n.segments.length===0&&n.hasChildren())return Ku(n,e,t);let i=GB(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new gt(n.segments.slice(0,i.pathIndex),{});return o.children[Ge]=new gt(n.segments.slice(i.pathIndex),n.children),Ku(o,0,r)}else return i.match&&r.length===0?new gt(n.segments,{}):i.match&&!n.hasChildren()?nb(n,e,t):i.match?Ku(n,0,r):nb(n,e,t)}function Ku(n,e,t){if(t.length===0)return new gt(n.segments,{});{let i=$B(t),r={};if(Object.keys(i).some(o=>o!==Ge)&&n.children[Ge]&&n.numberOfChildren===1&&n.children[Ge].segments.length===0){let o=Ku(n.children[Ge],e,t);return new gt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=_R(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new gt(n.segments,r)}}function GB(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(Ju(a))break;let l=`${a}`,u=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!XM(l,u,s))return o;i+=2}else{if(!XM(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function nb(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(Ju(o)){let l=zB(o.outlets);return new gt(i,l)}if(r===0&&ig(t[0])){let l=n.segments[e];i.push(new ts(l.path,ZM(t[0]))),r++;continue}let s=Ju(o)?o.outlets[Ge]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&ig(a)?(i.push(new ts(s,ZM(a))),r+=2):(i.push(new ts(s,{})),r++)}return new gt(i,{})}function zB(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=nb(new gt([],{}),0,i))}),e}function ZM(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function XM(n,e,t){return n==t.path&&Cr(e,t.parameters)}var Yu="imperative",Sn=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Sn||{}),mi=class{id;url;constructor(e,t){this.id=e,this.url=t}},ca=class extends mi{type=Sn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Dr=class extends mi{urlAfterRedirects;type=Sn.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Un=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Un||{}),Zu=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Zu||{}),Ri=class extends mi{reason;code;type=Sn.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function ER(n){return n instanceof Ri&&(n.code===Un.Redirect||n.code===Un.SupersededByNewNavigation)}var so=class extends mi{reason;code;type=Sn.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},ua=class extends mi{error;target;type=Sn.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},bl=class extends mi{urlAfterRedirects;state;type=Sn.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},og=class extends mi{urlAfterRedirects;state;type=Sn.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},sg=class extends mi{urlAfterRedirects;state;shouldActivate;type=Sn.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},ag=class extends mi{urlAfterRedirects;state;type=Sn.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lg=class extends mi{urlAfterRedirects;state;type=Sn.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cg=class{route;type=Sn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ug=class{route;type=Sn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},dg=class{snapshot;type=Sn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hg=class{snapshot;type=Sn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},fg=class{snapshot;type=Sn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pg=class{snapshot;type=Sn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var wl=class{},xl=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function WB(n){return!(n instanceof wl)&&!(n instanceof xl)}var gg=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Tl(this.rootInjector)}},Tl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new gg(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Me(Wt))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),mg=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=ib(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=ib(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=rb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return rb(e,this._root).map(t=>t.value)}};function ib(n,e){if(n===e.value)return e;for(let t of e.children){let i=ib(n,t);if(i)return i}return null}function rb(n,e){if(n===e.value)return[e];for(let t of e.children){let i=rb(n,t);if(i.length)return i.unshift(e),i}return[]}var gi=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function vl(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Xu=class extends mg{snapshot;constructor(e,t){super(e),this.snapshot=t,hb(this,e)}toString(){return this.snapshot.toString()}};function bR(n,e){let t=qB(n,e),i=new Mn([new ts("",{})]),r=new Mn({}),o=new Mn({}),s=new Mn({}),a=new Mn(""),l=new ao(i,r,s,a,o,Ge,n,t.root);return l.snapshot=t.root,new Xu(new gi(l,[]),t)}function qB(n,e){let t={},i={},r={},s=new aa([],t,r,"",i,Ge,n,null,{},e);return new ed("",new gi(s,[]))}var ao=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(yt(u=>u[id]))??it(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(yt(e=>la(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(yt(e=>la(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function yg(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),r?.data),n._resolvedData)}:i={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},r&&xR(r)&&(i.resolve[id]=r.title),i}var aa=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[id]}constructor(e,t,i,r,o,s,a,l,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=u,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=la(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=la(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ed=class extends mg{url;constructor(e,t){super(t),this.url=e,hb(this,t)}toString(){return wR(this._root)}};function hb(n,e){e.value._routerState=n,e.children.forEach(t=>hb(n,t))}function wR(n){let e=n.children.length>0?` { ${n.children.map(wR).join(", ")} } `:"";return`${n.value}${e}`}function JE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Cr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Cr(e.params,t.params)||n.paramsSubject.next(t.params),bB(e.url,t.url)||n.urlSubject.next(t.url),Cr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ob(n,e){let t=Cr(n.params,e.params)&&TB(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||ob(n.parent,e.parent))}function xR(n){return typeof n.title=="string"||n.title===null}var SR=new _e(""),od=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ge;activateEvents=new un;deactivateEvents=new un;attachEvents=new un;detachEvents=new un;routerOutletData=cM();parentContexts=z(Tl);location=z(to);changeDetector=z(Pu);inputBinder=z(bg,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new he(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new he(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new he(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new he(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new sb(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=_n({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[eo]})}return n})(),sb=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===ao?this.route:e===Tl?this.childContexts:e===SR?this.outletData:this.parent.get(e,t)}},bg=new _e("");var fb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=kt({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&G(0,"router-outlet")},dependencies:[od],encapsulation:2})}return n})();function pb(n){let e=n.children&&n.children.map(pb),t=e?pe(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ge&&(t.component=fb),t}function KB(n,e,t){let i=td(n,e._root,t?t._root:void 0);return new Xu(i,e)}function td(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=YB(n,e,t);return new gi(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>td(n,a)),s}}let i=QB(e.value),r=e.children.map(o=>td(n,o));return new gi(i,r)}}function YB(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return td(n,i,r);return td(n,i)})}function QB(n){return new ao(new Mn(n.url),new Mn(n.params),new Mn(n.queryParams),new Mn(n.fragment),new Mn(n.data),n.outlet,n.component,n)}var Sl=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},IR="ngNavigationCancelingError";function vg(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=is(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=TR(!1,Un.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function TR(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[IR]=!0,t.cancellationCode=e,t}function JB(n){return CR(n)&&is(n.url)}function CR(n){return!!n&&n[IR]}var ab=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),JE(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=vl(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=vl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=vl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=vl(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new pg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new hg(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(JE(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),JE(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},_g=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},El=class{component;route;constructor(e,t){this.component=e,this.route=t}};function ZB(n,e,t){let i=n._root,r=e?e._root:null;return qu(i,r,t,[i.value])}function XB(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Cl(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!Py(n)?n:e.get(n):i}function qu(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=vl(e);return n.children.forEach(s=>{e8(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Qu(a,t.getContext(s),r)),r}function e8(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=t8(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new _g(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?qu(n,e,a?a.children:null,i,r):qu(n,e,t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new El(a.outlet.component,s))}else s&&Qu(e,a,r),r.canActivateChecks.push(new _g(i)),o.component?qu(n,null,a?a.children:null,i,r):qu(n,null,t,i,r);return r}function t8(n,e,t){if(typeof t=="function")return Nn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!sa(n.url,e.url);case"pathParamsOrQueryParamsChange":return!sa(n.url,e.url)||!Cr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ob(n,e)||!Cr(n.queryParams,e.queryParams);default:return!ob(n,e)}}function Qu(n,e,t){let i=vl(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?Qu(s,e.children.getContext(o),t):Qu(s,null,t):Qu(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new El(e.outlet.component,r)):t.canDeactivateChecks.push(new El(null,r)):t.canDeactivateChecks.push(new El(null,r))}function sd(n){return typeof n=="function"}function n8(n){return typeof n=="boolean"}function i8(n){return n&&sd(n.canLoad)}function r8(n){return n&&sd(n.canActivate)}function o8(n){return n&&sd(n.canActivateChild)}function s8(n){return n&&sd(n.canDeactivate)}function a8(n){return n&&sd(n.canMatch)}function DR(n){return n instanceof Rs||n?.name==="EmptyError"}var Zp=Symbol("INITIAL_VALUE");function Il(){return Wr(n=>Lc(n.map(e=>e.pipe(Bi(1),Bc(Zp)))).pipe(yt(e=>{for(let t of e)if(t!==!0){if(t===Zp)return Zp;if(t===!1||l8(t))return t}return!0}),Ui(e=>e!==Zp),Bi(1)))}function l8(n){return is(n)||n instanceof Sl}function AR(n){return n.aborted?it(void 0).pipe(Bi(1)):new ot(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function MR(n){return Ps(AR(n))}function c8(n){return Hn(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?it(pe(F({},e),{guardsResult:!0})):u8(o,t,i).pipe(Hn(s=>s&&n8(s)?d8(t,r,n):it(s)),yt(s=>pe(F({},e),{guardsResult:s})))})}function u8(n,e,t){return cn(n).pipe(Hn(i=>m8(i.component,i.route,t,e)),zr(i=>i!==!0,!0))}function d8(n,e,t){return cn(e).pipe(qh(i=>Fo(f8(i.route.parent,t),h8(i.route,t),g8(n,i.path),p8(n,i.route))),zr(i=>i!==!0,!0))}function h8(n,e){return n!==null&&e&&e(new fg(n)),it(!0)}function f8(n,e){return n!==null&&e&&e(new dg(n)),it(!0)}function p8(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return it(!0);let i=t.map(r=>Vc(()=>{let o=e._environmentInjector,s=Cl(r,o),a=r8(s)?s.canActivate(e,n):Nn(o,()=>s(e,n));return da(a).pipe(zr())}));return it(i).pipe(Il())}function g8(n,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>XB(o)).filter(o=>o!==null).map(o=>Vc(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,u=Cl(a,l),d=o8(u)?u.canActivateChild(t,n):Nn(l,()=>u(t,n));return da(d).pipe(zr())});return it(s).pipe(Il())}));return it(r).pipe(Il())}function m8(n,e,t,i){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return it(!0);let o=r.map(s=>{let a=e._environmentInjector,l=Cl(s,a),u=s8(l)?l.canDeactivate(n,e,t,i):Nn(a,()=>l(n,e,t,i));return da(u).pipe(zr())});return it(o).pipe(Il())}function y8(n,e,t,i,r){let o=e.canLoad;if(o===void 0||o.length===0)return it(!0);let s=o.map(a=>{let l=Cl(a,n),u=i8(l)?l.canLoad(e,t):Nn(n,()=>l(e,t)),d=da(u);return r?d.pipe(MR(r)):d});return it(s).pipe(Il(),RR(i))}function RR(n){return ay(cr(e=>{if(typeof e!="boolean")throw vg(n,e)}),yt(e=>e===!0))}function v8(n,e,t,i,r){let o=e.canMatch;if(!o||o.length===0)return it(!0);let s=o.map(a=>{let l=Cl(a,n),u=a8(l)?l.canMatch(e,t):Nn(n,()=>l(e,t));return da(u).pipe(MR(r))});return it(s).pipe(Il(),RR(i))}var oo=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},nd=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function _8(n){throw new he(4e3,!1)}function E8(n){throw TR(!1,Un.GuardRejected)}var lb=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return i;if(r.numberOfChildren>1||!r.children[Ge])throw _8(`${e.redirectTo}`);r=r.children[Ge]}}async applyRedirectCommands(e,t,i,r,o){let s=await b8(t,r,o);if(s instanceof Zi)throw new nd(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new nd(a);return a}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new Zi(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new gt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new he(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function b8(n,e,t){if(typeof n=="string")return Promise.resolve(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:u,data:d,title:h,paramMap:p,queryParamMap:g}=e;return ng(da(Nn(t,()=>i({params:u,data:d,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:p,queryParamMap:g}))))}function w8(n,e){return n.providers&&!n._injector&&(n._injector=hl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Ji(n){return n.outlet||Ge}function x8(n,e){let t=n.filter(i=>Ji(i)===e);return t.push(...n.filter(i=>Ji(i)!==e)),t}var cb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function S8(n,e,t,i,r,o){let s=PR(n,e,t);return s.matched?(i=w8(e,i),v8(i,e,t,r,o).pipe(yt(a=>a===!0?s:F({},cb)))):it(s)}function PR(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},cb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||rR)(t,n,e);if(!r)return F({},cb);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?F(F({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function eR(n,e,t,i){return t.length>0&&C8(n,t,i)?{segmentGroup:new gt(e,T8(i,new gt(t,n.children))),slicedSegments:[]}:t.length===0&&D8(n,t,i)?{segmentGroup:new gt(n.segments,I8(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new gt(n.segments,n.children),slicedSegments:t}}function I8(n,e,t,i){let r={};for(let o of t)if(wg(n,e,o)&&!i[Ji(o)]){let s=new gt([],{});r[Ji(o)]=s}return F(F({},i),r)}function T8(n,e){let t={};t[Ge]=e;for(let i of n)if(i.path===""&&Ji(i)!==Ge){let r=new gt([],{});t[Ji(i)]=r}return t}function C8(n,e,t){return t.some(i=>wg(n,e,i)&&Ji(i)!==Ge)}function D8(n,e,t){return t.some(i=>wg(n,e,i))}function wg(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function A8(n,e,t){return e.length===0&&!n.children[t]}var ub=class{};async function M8(n,e,t,i,r,o,s="emptyOnly",a){return new db(n,e,t,i,r,s,o,a).recognize()}var R8=31,db=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new lb(this.urlSerializer,this.urlTree)}noMatchError(e){return new he(4002,`'${e.segmentGroup}'`)}async recognize(){let e=eR(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),r=new gi(i,t),o=new ed("",r),s=gR(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new aa([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ge,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,Ge,t),rootSnapshot:t}}catch(i){if(i instanceof nd)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof oo?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,r,o){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,o);let s=await this.processSegment(e,t,i,i.segments,r,!0,o);return s instanceof gi?[s]:[]}async processChildren(e,t,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let u=i.children[l],d=x8(t,l),h=await this.processSegmentGroup(e,d,u,l,r);s.push(...h)}let a=NR(s);return P8(a),a}async processSegment(e,t,i,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a)}catch(u){if(u instanceof oo||DR(u))continue;throw u}if(A8(i,r,o))return new ub;throw new oo(i)}async processSegmentAgainstRoute(e,t,i,r,o,s,a,l){if(Ji(i)!==s&&(s===Ge||!wg(r,o,i)))throw new oo(r);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,i,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l);throw new oo(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:l,parameters:u,consumedSegments:d,positionalParamSegments:h,remainingSegments:p}=PR(t,r,o);if(!l)throw new oo(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>R8&&(this.allowRedirects=!1));let g=new aa(o,u,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,tR(r),Ji(r),r.component??r._loadedComponent??null,r,nR(r),e),x=yg(g,a,this.paramsInheritanceStrategy);if(g.params=Object.freeze(x.params),g.data=Object.freeze(x.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let S=await this.applyRedirects.applyRedirectCommands(d,r.redirectTo,h,g,e),N=await this.applyRedirects.lineralizeSegments(r,S);return this.processSegment(e,i,t,N.concat(p),s,!1,a)}async matchSegmentAgainstRoute(e,t,i,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await ng(S8(t,i,r,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!a?.matched)throw new oo(t);e=i._injector??e;let{routes:l}=await this.getChildConfig(e,i,r),u=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:p}=a,g=new aa(h,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,tR(i),Ji(i),i.component??i._loadedComponent??null,i,nR(i),e),x=yg(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(x.params),g.data=Object.freeze(x.data);let{segmentGroup:S,slicedSegments:N}=eR(t,h,p,l);if(N.length===0&&S.hasChildren()){let Se=await this.processChildren(u,l,S,g);return new gi(g,Se)}if(l.length===0&&N.length===0)return new gi(g,[]);let U=Ji(i)===o,ie=await this.processSegment(u,l,S,N,U?Ge:o,!0,g);return new gi(g,ie instanceof gi?[ie]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await ng(y8(e,t,i,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw E8(t)}return{routes:[],injector:e}}};function P8(n){n.sort((e,t)=>e.value.outlet===Ge?-1:t.value.outlet===Ge?1:e.value.outlet.localeCompare(t.value.outlet))}function N8(n){let e=n.value.routeConfig;return e&&e.path===""}function NR(n){let e=[],t=new Set;for(let i of n){if(!N8(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=NR(i.children);e.push(new gi(i.value,r))}return e.filter(i=>!t.has(i))}function tR(n){return n.data||{}}function nR(n){return n.resolve||{}}function k8(n,e,t,i,r,o,s){return Hn(async a=>{let{state:l,tree:u}=await M8(n,e,t,i,a.extractedUrl,r,o,s);return pe(F({},a),{targetSnapshot:l,urlAfterRedirects:u})})}function O8(n){return Hn(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return it(e);let r=new Set(i.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of kR(a))o.add(l);let s=0;return cn(o).pipe(qh(a=>r.has(a)?F8(a,t,n):(a.data=yg(a,a.parent,n).resolve,it(void 0))),cr(()=>s++),Kh(1),Hn(a=>s===o.size?it(e):Rn))})}function kR(n){let e=n.children.map(t=>kR(t)).flat();return[n,...e]}function F8(n,e,t){let i=n.routeConfig,r=n._resolve;return i?.title!==void 0&&!xR(i)&&(r[id]=i.title),Vc(()=>(n.data=yg(n,n.parent,t).resolve,L8(r,n,e).pipe(yt(o=>(n._resolvedData=o,n.data=F(F({},n.data),o),null)))))}function L8(n,e,t){let i=XE(n);if(i.length===0)return it({});let r={};return cn(i).pipe(Hn(o=>V8(n[o],e,t).pipe(zr(),cr(s=>{if(s instanceof Sl)throw vg(new ns,s);r[o]=s}))),Kh(1),yt(()=>r),Uc(o=>DR(o)?Rn:dy(o)))}function V8(n,e,t){let i=e._environmentInjector,r=Cl(n,i),o=r.resolve?r.resolve(e,t):Nn(i,()=>r(e,t));return da(o)}function iR(n){return Wr(e=>{let t=n(e);return t?cn(t).pipe(yt(()=>e)):it(e)})}var gb=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===Ge);return i}getResolvedTitleForRoute(t){return t.data[id]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>z(OR),providedIn:"root"})}return n})(),OR=(()=>{class n extends gb{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Me(WM))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Dl=new _e("",{factory:()=>({})}),ad=new _e(""),FR=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=z(lE);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await sR(Nn(t,()=>i.loadComponent())),s=await UR(VR(o));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s,s}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await LR(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=o.routes,i._loadedInjector=o.injector,i._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function LR(n,e,t,i){let r=await sR(Nn(t,()=>n.loadChildren())),o=await UR(VR(r)),s;o instanceof vp||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),i&&i(n);let a,l,u=!1,d;return Array.isArray(s)?(l=s,u=!0):(a=s.create(t).injector,d=s,l=a.get(ad,[],{optional:!0,self:!0}).flat()),{routes:l.map(pb),injector:a,factory:d}}function U8(n){return n&&typeof n=="object"&&"default"in n}function VR(n){return U8(n)?n.default:n}async function UR(n){return n}var xg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>z(B8),providedIn:"root"})}return n})(),B8=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),BR=new _e("");var j8=()=>{},jR=new _e(""),HR=(()=>{class n{currentNavigation=$(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=$(null);events=new zt;transitionAbortWithErrorSubject=new zt;configLoader=z(FR);environmentInjector=z(Wt);destroyRef=z(Jn);urlSerializer=z(rd);rootContexts=z(Tl);location=z(yl);inputBindingEnabled=z(bg,{optional:!0})!==null;titleStrategy=z(gb);options=z(Dl,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=z(xg);createViewTransition=z(BR,{optional:!0});navigationErrorHandler=z(jR,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>it(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new cg(r)),i=r=>this.events.next(new ug(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;dn(()=>{this.transitions?.next(pe(F({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new Mn(null),this.transitions.pipe(Ui(i=>i!==null),Wr(i=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===i.id;return it(i).pipe(Wr(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),Rn;this.currentTransition=i;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?pe(F({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&d!=="reload")return this.events.next(new so(a.id,this.urlSerializer.serialize(a.rawUrl),"",Zu.IgnoredSameUrlNavigation)),a.resolve(!1),Rn;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return it(a).pipe(Wr(h=>(this.events.next(new ca(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?Rn:Promise.resolve(h))),k8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),cr(h=>{i.targetSnapshot=h.targetSnapshot,i.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=h.urlAfterRedirects,g));let p=new bl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:p,source:g,restoredState:x,extras:S}=a,N=new ca(h,this.urlSerializer.serialize(p),g,x);this.events.next(N);let U=bR(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=pe(F({},a),{targetSnapshot:U,urlAfterRedirects:p,extras:pe(F({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(ie=>(ie.finalUrl=p,ie)),it(i)}else return this.events.next(new so(a.id,this.urlSerializer.serialize(a.extractedUrl),"",Zu.IgnoredByUrlHandlingStrategy)),a.resolve(!1),Rn}),yt(a=>{let l=new og(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=i=pe(F({},a),{guards:ZB(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i}),c8(a=>this.events.next(a)),Wr(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw vg(this.urlSerializer,a.guardsResult);let l=new sg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return Rn;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",Un.GuardRejected),Rn;if(a.guards.canActivateChecks.length===0)return it(a);let u=new ag(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(u),!s())return Rn;let d=!1;return it(a).pipe(O8(this.paramsInheritanceStrategy),cr({next:()=>{d=!0;let h=new lg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{d||this.cancelNavigationTransition(a,"",Un.NoDataFromResolver)}}))}),iR(a=>{let l=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let p=d._environmentInjector;h.push(this.configLoader.loadComponent(p,d.routeConfig).then(g=>{d.component=g}))}for(let p of d.children)h.push(...l(p));return h},u=l(a.targetSnapshot.root);return u.length===0?it(a):cn(Promise.all(u).then(()=>a))}),iR(()=>this.afterPreactivation()),Wr(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,u=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return u?cn(u).pipe(yt(()=>i)):it(i)}),Bi(1),yt(a=>{let l=KB(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=i=a=pe(F({},a),{targetRouterState:l}),this.currentNavigation.update(u=>(u.targetRouterState=l,u)),this.events.next(new wl),s()&&(new ab(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,u=>this.events.next(u),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(u=>(u.abort=j8,u)),this.lastSuccessfulNavigation.set(dn(this.currentNavigation)),this.events.next(new Dr(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Ps(AR(o.signal).pipe(Ui(()=>!r&&!i.targetRouterState),cr(()=>{this.cancelNavigationTransition(i,o.signal.reason+"",Un.Aborted)}))),cr({complete:()=>{r=!0}}),Ps(this.transitionAbortWithErrorSubject.pipe(cr(a=>{throw a}))),py(()=>{o.abort(),r||this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Uc(a=>{if(r=!0,this.destroyed)return i.resolve(!1),Rn;if(CR(a))this.events.next(new Ri(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),JB(a)?this.events.next(new xl(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new ua(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let u=Nn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(u instanceof Sl){let{message:d,cancellationCode:h}=vg(this.urlSerializer,u);this.events.next(new Ri(i.id,this.urlSerializer.serialize(i.extractedUrl),d,h)),this.events.next(new xl(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(u){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(u)}}return Rn}))}))}cancelNavigationTransition(t,i,r){let o=new Ri(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=dn(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function H8(n){return n!==Yu}var $R=new _e("");var GR=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>z($8),providedIn:"root"})}return n})(),Eg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},$8=(()=>{class n extends Eg{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ea(n)))(r||n)}})();static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),mb=(()=>{class n{urlSerializer=z(rd);options=z(Dl,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=z(yl);urlHandlingStrategy=z(xg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Zi;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof Zi?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=bR(null,z(Wt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:()=>z(G8),providedIn:"root"})}return n})(),G8=(()=>{class n extends mb{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof ca?this.updateStateMemento():t instanceof so?this.commitTransition(i):t instanceof bl?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof wl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Ri&&!ER(t)?this.restoreHistory(i):t instanceof ua?this.restoreHistory(i,!0):t instanceof Dr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=F(F({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=F(F({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ea(n)))(r||n)}})();static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yb(n,e){n.events.pipe(Ui(t=>t instanceof Dr||t instanceof Ri||t instanceof ua||t instanceof so),yt(t=>t instanceof Dr||t instanceof so?0:(t instanceof Ri?t.code===Un.Redirect||t.code===Un.SupersededByNewNavigation:!1)?2:1),Ui(t=>t!==2),Bi(1)).subscribe(()=>{e()})}var zR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},WR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},yi=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=z(Ep);stateManager=z(mb);options=z(Dl,{optional:!0})||{};pendingTasks=z(Er);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=z(HR);urlSerializer=z(rd);location=z(yl);urlHandlingStrategy=z(xg);injector=z(Wt);_events=new zt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=z(GR);injectorCleanup=z($R,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=z(ad,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!z(bg,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new yn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=dn(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ri&&i.code!==Un.Redirect&&i.code!==Un.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Dr)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof xl){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=F({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||H8(r.source)},s);this.scheduleNavigation(a,Yu,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}WB(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Yu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=F({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(di)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return dn(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(pb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let p=r?r.snapshot:this.routerState.snapshot.root;h=mR(p)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return yR(h,t,d,u??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let r=is(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,Yu,null,i)}navigate(t,i={skipLocationChange:!1}){return z8(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Yr(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=F({},zR):i===!1?r=F({},WR):r=i,is(t))return YM(this.currentUrlTree,t,r);let o=this.parseUrl(t);return YM(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,u;s?(a=s.resolve,l=s.reject,u=s.promise):u=new Promise((h,p)=>{a=h,l=p});let d=this.pendingTasks.add();return yb(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function z8(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new he(4008,!1)}var Al=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=$(null);get href(){return dn(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new zt;applicationErrorHandler=z(di);options=z(Dl,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(z(new Rp("href"),{optional:!0}));let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area"||!!(typeof customElements=="object"&&customElements.get(l)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Dr&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(is(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l)?.catch(u=>{this.applicationErrorHandler(u)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:is(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(ye(yi),ye(ao),mu("tabindex"),ye(Ko),ye(Di),ye(ml))};static \u0275dir=_n({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&re("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&Ot("href",r.reactiveHref(),A_)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Nu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Nu],replaceUrl:[2,"replaceUrl","replaceUrl",Nu],routerLink:"routerLink"},features:[eo]})}return n})();var K8=new _e("");function vb(n,...e){return gr([{provide:ad,multi:!0,useValue:n},[],{provide:ao,useFactory:Y8},{provide:Qo,multi:!0,useFactory:Q8},e.map(t=>t.\u0275providers)])}function Y8(){return z(yi).routerState.root}function Q8(){let n=z(zn);return e=>{let t=n.get(Zn);if(e!==t.components[0])return;let i=n.get(yi),r=n.get(J8);n.get(Z8)===1&&i.initialNavigation(),n.get(X8,null,{optional:!0})?.setUpPreloading(),n.get(K8,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var J8=new _e("",{factory:()=>new zt}),Z8=new _e("",{factory:()=>1});var X8=new _e("");function qR(n,e){let i=!e?.manualCleanup?e?.injector?.get(Jn)??z(Jn):null,r=ej(e?.equal),o;e?.requireSync?o=$({kind:0},{equal:r}):o=$({kind:1,value:e?.initialValue},{equal:r});let s,a=n.subscribe({next:l=>o.set({kind:1,value:l}),error:l=>{o.set({kind:2,error:l}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&o().kind===0)throw new he(601,!1);return s=i?.onDestroy(a.unsubscribe.bind(a)),Xn(()=>{let l=o();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:throw new he(601,!1)}},{equal:e?.equal})}function ej(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var _b;try{_b=typeof Intl<"u"&&Intl.v8BreakIterator}catch{_b=!1}var KR=(()=>{class n{_platformId=z(qi);isBrowser=this._platformId?es(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||_b)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Eb(n){return Array.isArray(n)?n:[n]}var YR=new Set,ha,JR=(()=>{class n{_platform=z(KR);_nonce=z(ll,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):nj}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&tj(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tj(n,e){if(!YR.has(n))try{ha||(ha=document.createElement("style"),e&&ha.setAttribute("nonce",e),ha.setAttribute("type","text/css"),document.head.appendChild(ha)),ha.sheet&&(ha.sheet.insertRule(`@media ${n} {body{ }}`,0),YR.add(n))}catch(t){console.error(t)}}function nj(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var bb=(()=>{class n{_mediaMatcher=z(JR);_zone=z(vn);_queries=new Map;_destroySubject=new zt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return QR(Eb(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=QR(Eb(t)).map(s=>this._registerQuery(s).observable),o=Lc(r);return o=Fo(o.pipe(Bi(1)),o.pipe(gy(1),fy(0))),o.pipe(yt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:u})=>{a.matches=a.matches||l,a.breakpoints[u]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),o={observable:new ot(s=>{let a=l=>this._zone.run(()=>s.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Bc(i),yt(({matches:s})=>({query:t,matches:s})),Ps(this._destroySubject)),mql:i};return this._queries.set(t,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function QR(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var Ml=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let r={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return r?r[t-1]:1}getDefenseBonus(e,t){let i=0,r=[];(e.turnsStationary??0)>=3&&(i+=1,r.push("Shield +1"));let o=t.filter(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1);return o.length&&(i+=o.length,r.push(`Support +${o.length}`)),{bonus:i,tags:r}}getAttackLuckModifier(e){let t=Math.random(),r={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:r,tag:`CRIT! +${r}`,isCrit:!0}:t>.8?{delta:-r,tag:`MISS! -${r}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}getWallHitAmount(e){return e===1?34:e===2?51:101}applyDamage(e,t){let i=e.armorHp??0,r=Math.max(0,i-t),o=Math.max(0,t-i),s=Math.max(0,e.points-o),{tier:a,level:l}=this.calculateTierAndLevel(s);return pe(F({},e),{armorHp:r,points:s,tier:a,level:l})}calculateHitChance(e,t){let i=t.tier-e.tier,r=e.level??1,o=0;i<=0?o=100:i===1?o=Math.min(100,50+r*15):i===2?o=Math.min(100,25+r*5):o=Math.min(100,1+r*1);let s=e.hasWeapon&&t.tier>e.tier?10:0,a=t.hasArmor?10:0;return Math.max(1,Math.min(100,o+s-a))}isDiagonalBlocked(e,t,i){let r=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(r===0||o===0)return!1;let s=i(e.x,e.y,e.x+r,e.y),a=i(e.x,e.y,e.x,e.y+o),l=i(t.x-r,t.y,t.x,t.y),u=i(t.x,t.y-o,t.x,t.y);return!!(s||a||l||u)}checkWallAlongPath(e,t,i,r){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),l=Math.sign(s),u=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=u;d++){let h={x:e.x+a*(d-1),y:e.y+l*(d-1)},p={x:e.x+a*d,y:e.y+l*d},g=r(h.x,h.y,p.x,p.y);if(g)return g.owner===i?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:h}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ig=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,i){let r=[t,i];for(let o of r){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,i,r){return e.some(o=>o.owner===t&&(o.position.x===i.x&&o.position.y===i.y||o.position.x===r.x&&o.position.y===r.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var Tg=class n{entriesSignal=$([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(i=>[...i,{text:e,color:t,type:"other"}])}addCombat(e,t,i){let r=i?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:r,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var oj={TRY_AGAIN:{en:"TRY AGAIN",uk:"\u0421\u041F\u0420\u041E\u0411\u0423\u0419\u0422\u0415 \u0417\u041D\u041E\u0412\u0423"},WAVES:{en:"waves",uk:"\u0445\u0432\u0438\u043B\u044C"},YOU_SURVIVED:{en:"You survived",uk:"\u0422\u0438 \u0432\u0438\u0436\u0438\u0432"},GAME_OVER:{en:"GAME OVER",uk:"\u0413\u0420\u0410 \u0417\u0410\u041A\u0406\u041D\u0427\u0415\u041D\u0410"},TO_PLACE_DEFENDER:{en:"to place a defender",uk:"\u0449\u043E\u0431 \u0440\u043E\u0437\u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},SELECT_BUILD_TILE:{en:"Select a buildable tile",uk:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u0431\u0443\u0434\u0456\u0432\u043D\u0438\u0446\u0442\u0432\u0430,"},SELL:{en:"SELL",uk:"\u041F\u0420\u041E\u0414\u0410\u0422\u0418"},MAX_LEVEL:{en:"MAX LEVEL",uk:"\u041C\u0410\u041A\u0421 \u0420\u0406\u0412\u0415\u041D\u042C"},UPGRADE:{en:"UPGRADE",uk:"\u041E\u041D\u041E\u0412\u041B\u0415\u041D\u041D\u042F"},RANGE:{en:"Range",uk:"\u0414\u0430\u043B\u044C\u043D\u0456\u0441\u0442\u044C"},DAMAGE:{en:"Damage",uk:"\u041F\u043E\u0448\u043A\u043E\u0434\u0436\u0435\u043D\u043D\u044F"},TIER:{en:"Tier",uk:"\u0420\u0430\u043D\u0433"},LEVEL:{en:"Level",uk:"\u0420\u0456\u0432\u0435\u043D\u044C"},DEFENDER_INFO:{en:"Defender Info",uk:"\u0406\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044F \u043F\u0440\u043E \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},BUY_DEFENDER:{en:"Buy Defender",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},START_WAVE:{en:"START WAVE",uk:"\u041F\u041E\u0427\u0410\u0422\u041E\u041A \u0425\u0412\u0418\u041B\u0406"},WAVE_IN_PROGRESS:{en:"WAVE IN PROGRESS",uk:"\u0425\u0412\u0418\u041B\u042F \u0412 \u041F\u0420\u041E\u0426\u0415\u0421\u0406"},RESTART_GAME:{en:"RESTART GAME",uk:"\u041F\u0415\u0420\u0415\u0417\u0410\u041F\u0423\u0421\u041A \u0413\u0420\u0418"},WAVE:{en:"WAVE",uk:"\u0425\u0412\u0418\u041B\u042F"},LIVES:{en:"LIVES",uk:"\u0416\u0418\u0422\u0422\u042F"},MONEY:{en:"MONEY",uk:"\u0413\u0420\u041E\u0428\u0406"},EXIT_GAME:{en:"EXIT GAME",uk:"\u0412\u0418\u0425\u0406\u0414 \u0417 \u0413\u0420\u0418"},TOWER_DEFFENCE_DESCRIPTION:{en:"A new game is already in development. Stay tuned for a completely different strategy experience. Coming soon to Game Center.",uk:"\u041D\u043E\u0432\u0430 \u0433\u0440\u0430 \u0432\u0436\u0435 \u0440\u043E\u0437\u0440\u043E\u0431\u043B\u044F\u0454\u0442\u044C\u0441\u044F. \u0421\u043B\u0456\u0434\u043A\u0443\u0439\u0442\u0435 \u0437\u0430 \u043E\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044F\u043C\u0438, \u0449\u043E\u0431 \u0434\u0456\u0437\u043D\u0430\u0442\u0438\u0441\u044F \u043F\u0440\u043E \u0437\u043E\u0432\u0441\u0456\u043C \u0456\u043D\u0448\u0438\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u0434\u043E\u0441\u0432\u0456\u0434. \u0421\u043A\u043E\u0440\u043E \u0432 \u0456\u0433\u0440\u043E\u0432\u043E\u043C\u0443 \u0446\u0435\u043D\u0442\u0440\u0456."},SHAPE_TACTIC_DESCRIPTION:{en:"Strategic turn-based combat with AI and merging mechanics. Build your base, manage resources, and conquer the battlefield.",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u043F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0438\u0439 \u0431\u0456\u0439 \u0437\u0456 \u0448\u0442\u0443\u0447\u043D\u0438\u043C \u0456\u043D\u0442\u0435\u043B\u0435\u043A\u0442\u043E\u043C \u0442\u0430 \u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0438\u043C\u0438 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0430\u043C\u0438. \u041F\u043E\u0431\u0443\u0434\u0443\u0439\u0442\u0435 \u0441\u0432\u043E\u044E \u0431\u0430\u0437\u0443, \u043A\u0435\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043C\u0438 \u0442\u0430 \u0437\u0430\u0432\u043E\u0439\u043E\u0432\u0443\u0439\u0442\u0435 \u043F\u043E\u043B\u0435 \u0431\u043E\u044E."},IRON_CYCLE:{en:"Iron Cycle",uk:"\u0426\u0438\u043A\u043B \u0417\u0430\u043B\u0456\u0437\u0430"},NEW_DESIGN_UNIT:{en:"New Evolution",uk:"\u041D\u043E\u0432\u0430 \u0435\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},NEW_UNIT_EVOLUTION:{en:"New Unit Evolution",uk:"\u041D\u043E\u0432\u0430 \u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},T4_4_TILES:{en:"T4: 4 tiles",uk:"T4: 4 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},TURN_3:{en:"Turn 3",uk:"\u0425\u0456\u0434 3"},TURN_4:{en:"Turn 4",uk:"\u0425\u0456\u0434 4"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0414\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},PLUS_2_IRON_PER_TURN:{en:"+2 Iron/turn",uk:"+2 \u0417\u0430\u043B\u0456\u0437\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function XR(n,e){let t=oj[n];return t?t[e]??t.en:n}var Ut=class n{difficultySignal=$("normal");mapSizeSignal=$(10);langSignal=$("uk");customModeSignal=$(!1);version="v.2.0.3";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),i=e%2===0;return t==="baby"?i?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return XR(e,this.langSignal())}customMode(){return this.customModeSignal()}setCustomMode(e){this.customModeSignal.set(e),this.persistSettings()}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let i=["baby","normal","hard","nightmare"],r=[10,20,30],o=["en","uk"],s=t.difficulty&&i.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&r.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),l=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(l),this.customModeSignal.set(!!t.customMode)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal(),customMode:this.customModeSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var Cg=class n{generateForests(e,t,i){let r=e*e,o=Math.max(1,Math.floor(r*.1)),s=[],a=(l,u)=>{let d=Math.max(Math.abs(l-t.x),Math.abs(u-t.y)),h=Math.max(Math.abs(l-i.x),Math.abs(u-i.y));return d<=3||h<=3};for(;s.length<o;){let l=Math.floor(Math.random()*e),u=Math.floor(Math.random()*e);a(l,u)||s.some(d=>d.x===l&&d.y===u)||s.push({x:l,y:u})}return s}generateMines(e,t,i,r){let o=new Set(r.map(u=>`${u.x},${u.y}`)),s=e===10?4:Math.max(1,Math.floor(e*e*.04)),a=[],l=(u,d)=>{let h=Math.max(Math.abs(u-t.x),Math.abs(d-t.y)),p=Math.max(Math.abs(u-i.x),Math.abs(d-i.y));return h<=3||p<=3};for(;a.length<s;){let u=Math.floor(Math.random()*e),d=Math.floor(Math.random()*e);if(l(u,d))continue;let h=`${u},${d}`;o.has(h)||a.some(p=>p.x===u&&p.y===d)||a.push({x:u,y:d})}return a}computeVisibility(e,t,i,r,o){let s={player:new Set,ai:new Set},a=(d,h)=>d>=0&&d<e&&h>=0&&h<e,l=(d,h,p)=>{a(h,p)&&d.add(`${h},${p}`)},u=(d,h,p)=>{for(let g=-p;g<=p;g++)for(let x=-p;x<=p;x++){let S=h.x+g,N=h.y+x;Math.max(Math.abs(g),Math.abs(x))<=p&&l(d,S,N)}};if(o){for(let d=0;d<e;d++)for(let h=0;h<e;h++)s.player.add(`${d},${h}`),s.ai.add(`${d},${h}`);return s}u(s.player,i,3),u(s.ai,r,3);for(let d of t){let h=d.owner==="player"?s.player:s.ai;u(h,d.position,2)}return s}mergeExplored(e,t){let i=new Set(e);return t.forEach(r=>i.add(r)),i}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var Dg=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let i of t)if(e>=i)return i;return 0}computeWoodGain(e,t){let i=e.filter(r=>r.owner===t).filter(r=>r.position&&r.position.x!==void 0&&r.position.y!==void 0).length;return i>0?i*2:0}applyMonopolyTick(e,t,i){let r=t.length;if(r===0)return{next:{player:0,ai:0}};let o=u=>i.filter(d=>d.owner===u&&t.some(h=>h.x===d.position.x&&h.y===d.position.y)).length,s=o("player"),a=o("ai"),l={player:e.player,ai:e.ai};if(s===r){if(l.player=e.player+1,l.ai=0,l.player>=10)return{next:l,winner:"player"}}else if(a===r){if(l.ai=e.ai+1,l.player=0,l.ai>=10)return{next:l,winner:"ai"}}else l.player=0,l.ai=0;return{next:l}}computeAiReserveDump(e,t,i,r){let o=i,s=[];for(let l=-2;l<=2;l++)for(let u=-2;u<=2;u++){if(l===0&&u===0)continue;let d=t.x+l,h=t.y+u;d<0||d>=e||h<0||h>=e||Math.max(Math.abs(l),Math.abs(u))>2||r(d,h)||s.push({x:d,y:h})}let a=[];for(;o>0&&s.length>0;){let l=this.getHighestAffordableCost(o);if(l<=0)break;let u=this.calculateTierAndLevel(l),d=s.shift();a.push({id:crypto.randomUUID(),position:F({},d),level:u.level,tier:u.tier,points:l,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=l}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ag=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(v=>v.owner==="ai"&&!v.hasActed);t=t.filter(v=>!(v.tier<=2&&e.isForest(v.position.x,v.position.y)&&e.isAnchoredGatherer(v.id)));let i=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;i&&(t=t.filter(v=>v.id===i));let r=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:r==="rage"?5e4:r==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),l=e.forestsSignal(),d=l.filter(v=>!e.getUnitAt(v.x,v.y)).filter(v=>e.isVisibleToAi(v.x,v.y)),h=l.filter(v=>!e.isVisibleToAi(v.x,v.y)),p=e.unitsSignal().filter(v=>v.owner==="ai"&&e.isForest(v.position.x,v.position.y)).length,g=e.unitsSignal().filter(v=>v.owner==="ai").length,x=[1,2,3].some(v=>e.unitsSignal().filter(se=>se.owner==="ai"&&se.tier===v&&!e.isForest(se.position.x,se.position.y)).length>=5),S=e.unitsSignal().filter(v=>v.owner==="player"),N=S.some(v=>Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y))<=3),U=S.filter(v=>Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y))<=4),ie=U.length>0,xe=U.filter(v=>Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y))<=2).length>0,De=S.some(v=>Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y))<=5),Ie=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,k=e.unitsSignal().filter(v=>v.owner==="ai"),I=k.filter(v=>v.tier===3&&!e.isForest(v.position.x,v.position.y)).length,P=k.filter(v=>v.tier===4&&!e.isForest(v.position.x,v.position.y)).length,D=I+P>=5,w=D?"full_rush":ie?"defense":Ie?"expansion":"none";if(w!==this.lastPhase){try{console.log(w==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":w==="defense"?"AI Phase: Base Defense Activated":w==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=w}D&&t.sort((v,se)=>{let We=Math.abs(v.position.x-a.x)+Math.abs(v.position.y-a.y),qe=Math.abs(se.position.x-a.x)+Math.abs(se.position.y-a.y);return We-qe});let R=typeof e.aggressionMode=="function"?!!e.aggressionMode():S.filter(v=>e.isForest(v.position.x,v.position.y)).length*2>=t.filter(v=>e.isForest(v.position.x,v.position.y)).length*2,M=l.length>0?l.every(v=>{let se=e.getUnitAt(v.x,v.y);return!!se&&se.owner==="ai"}):!0,ge=l.length>0?l.every(v=>!!e.getUnitAt(v.x,v.y)):!1,Oe=l.filter(v=>{let se=e.getUnitAt(v.x,v.y);return!!se&&se.owner==="player"}),fe=null,Ft=t.filter(v=>Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y))<=3).length,Zt={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Ae=U.length>0?U.reduce((v,se)=>{let We=Math.max(Math.abs(se.position.x-s.x),Math.abs(se.position.y-s.y)),qe=Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y));return We<qe?se:v},U[0]):null,Ht=t.length>0?t.reduce((v,se)=>this.combat.calculateTotalPoints(se)>this.combat.calculateTotalPoints(v)?se:v,t[0]):null,at=[];if(Ae){let v=Ae.position.x,se=Ae.position.y,We=Math.sign(s.x-v),qe=Math.sign(s.y-se),oe=0,bt=Math.max(10,e.gridSize*2);for(;v!==s.x||se!==s.y;){if(oe++,oe>bt){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(v+=We,se+=qe,!e.inBounds(v,se)||v===s.x&&se===s.y)break;at.push({x:v,y:se})}}ie&&Ht&&Ae&&(this.goals.set(Ht.id,{x:Ae.position.x,y:Ae.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(Ht.id,e.turnSignal()+3));let te=new Map(e.aiUnitTimeNearBase()),ne=new Map(e.unitStutterBanSignal?.()??new Map),Ee=new Map;for(let[v,se]of this.goals.entries())if(se&&e.isForest(se.x,se.y)){let We=`${se.x},${se.y}`;Ee.set(We,(Ee.get(We)||0)+1)}for(let v of t){let se=e.calculateValidMoves(v),We=Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y))<=3,qe=te.get(v.id)||0,oe=this.goals.get(v.id)||null,bt=oe!==null,Ei=bt?(()=>{let H=e.getUnitAt(oe.x,oe.y);return!!(H&&H.owner==="ai"&&this.combat.calculateTotalPoints(H)>=this.combat.calculateTotalPoints(v))})():!1,ii=(!bt||Ei)&&(!e.isForest(v.position.x,v.position.y)||De||v.tier>=3),Es=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(ii){if(Es)oe={x:a.x,y:a.y};else if(e.isForest(v.position.x,v.position.y)){let H=S.filter(L=>e.isForest(L.position.x,L.position.y));if(R&&H.length>0){let L=H.reduce((Y,Z)=>{let Te=Math.abs(v.position.x-Z.position.x)+Math.abs(v.position.y-Z.position.y),Le=Math.abs(v.position.x-Y.position.x)+Math.abs(v.position.y-Y.position.y);return Te<Le?Z:Y},H[0]);oe={x:L.position.x,y:L.position.y}}else{let L=S.length===0?null:[...S].sort((Z,Te)=>{let Le=Math.abs(v.position.x-Z.position.x)+Math.abs(v.position.y-Z.position.y),Xe=Math.abs(v.position.x-Te.position.x)+Math.abs(v.position.y-Te.position.y);return Le-Xe})[0];L?oe={x:L.position.x,y:L.position.y}:d.length>0?oe=d.reduce((Y,Z)=>Math.abs(v.position.x-Z.x)+Math.abs(v.position.y-Z.y)<Math.abs(v.position.x-Y.x)+Math.abs(v.position.y-Y.y)?Z:Y,d[0]):h.length>0?oe=h.reduce((Y,Z)=>Math.abs(v.position.x-Z.x)+Math.abs(v.position.y-Z.y)<Math.abs(v.position.x-Y.x)+Math.abs(v.position.y-Y.y)?Z:Y,h[0]):oe={x:0,y:0}}}else{let H=S.filter(L=>e.isForest(L.position.x,L.position.y)).map(L=>({x:L.position.x,y:L.position.y}));if(H.length>0)oe=H.reduce((Y,Z)=>{let Te=Math.abs(v.position.x-Z.x)+Math.abs(v.position.y-Z.y),Le=Math.abs(v.position.x-Y.x)+Math.abs(v.position.y-Y.y);return Te<Le?Z:Y},H[0]);else if(d.length>0){let L=Math.min(...d.map(Z=>Ee.get(`${Z.x},${Z.y}`)||0)),Y=d.filter(Z=>(Ee.get(`${Z.x},${Z.y}`)||0)===L);oe=Y.reduce((Z,Te)=>Math.abs(v.position.x-Te.x)+Math.abs(v.position.y-Te.y)<Math.abs(v.position.x-Z.x)+Math.abs(v.position.y-Z.y)?Te:Z,Y[0])}else if(h.length>0){let L=Math.min(...h.map(Z=>Ee.get(`${Z.x},${Z.y}`)||0)),Y=h.filter(Z=>(Ee.get(`${Z.x},${Z.y}`)||0)===L);oe=Y.reduce((Z,Te)=>Math.abs(v.position.x-Te.x)+Math.abs(v.position.y-Te.y)<Math.abs(v.position.x-Z.x)+Math.abs(v.position.y-Z.y)?Te:Z,Y[0])}else{let L=S.length===0?null:[...S].sort((Z,Te)=>{let Le=Math.abs(v.position.x-Z.position.x)+Math.abs(v.position.y-Z.position.y),Xe=Math.abs(v.position.x-Te.position.x)+Math.abs(v.position.y-Te.position.y);return Le-Xe})[0];oe=L?{x:L.position.x,y:L.position.y}:{x:0,y:0}}}this.goals.set(v.id,oe)}Ft>3&&qe>=5&&(oe=Zt);let jn=e.isForest(v.position.x,v.position.y),yc=jn&&(v.forestOccupationTurns??0)>0&&!(v.productionActive??!1),vc=e.unitsSignal().some(H=>H.owner==="ai"&&H.id!==v.id&&H.tier<=2&&Math.max(Math.abs(H.position.x-v.position.x),Math.abs(H.position.y-v.position.y))<=2);if(yc&&!De&&v.tier<3){this.goals.set(v.id,{x:v.position.x,y:v.position.y});continue}if(v.tier>=3){let H=l,L=H.length?H.reduce((Z,Te)=>{let Le=Math.abs(v.position.x-Te.x)+Math.abs(v.position.y-Te.y),Xe=Math.abs(v.position.x-Z.x)+Math.abs(v.position.y-Z.y);return Le<Xe?Te:Z},H[0]):null;if((v.forestOccupationTurns??0)===0&&!jn&&L&&(oe={x:L.x,y:L.y},this.goals.set(v.id,oe)),jn&&vc){this.goals.set(v.id,{x:a.x,y:a.y});let Z=[{x:v.position.x+1,y:v.position.y},{x:v.position.x-1,y:v.position.y},{x:v.position.x,y:v.position.y+1},{x:v.position.x,y:v.position.y-1}].filter(Le=>e.inBounds(Le.x,Le.y));if(Z.filter(Le=>!!e.getWallBetween(v.position.x,v.position.y,Le.x,Le.y)).length===Z.length){let Le=Z.reduce((Xe,dt)=>{let wt=Math.abs(dt.x-a.x)+Math.abs(dt.y-a.y),mt=Math.abs(Xe.x-a.x)+Math.abs(Xe.y-a.y);return wt<mt?dt:Xe});fe={unit:v,target:{x:v.position.x,y:v.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:F({},v.position),to:Le}};continue}}}if(se.some(H=>H.x===a.x&&H.y===a.y)){let H=v.tier===3&&v.level>=2||v.tier>=4?3e5:0,L=5e7+o+H;(fe===null||L>fe.score)&&(fe={unit:v,target:{x:a.x,y:a.y},score:L,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let H=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(L=>e.inBounds(L.x,L.y));for(let L of H){let Y=e.getWallBetween(a.x,a.y,L.x,L.y);if(Y&&Y.owner==="neutral"){if(v.position.x===L.x&&v.position.y===L.y||v.position.x===a.x&&v.position.y===a.y){let Te=v.tier===3&&v.level>=2||v.tier>=4?3e5:0,Le=2e6+o+Te;(fe===null||Le>fe.score)&&(fe={unit:v,target:F({},v.position),score:Le,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:L.x,y:L.y}}})}else if(se.some(Le=>Le.x===L.x&&Le.y===L.y||Le.x===a.x&&Le.y===a.y)){let Le=se.find(mt=>mt.x===L.x&&mt.y===L.y||mt.x===a.x&&mt.y===a.y),Xe=v.tier===3&&v.level>=2||v.tier>=4?3e5:0,dt=18e5+o+Xe;(fe===null||dt>fe.score)&&(fe={unit:v,target:{x:Le.x,y:Le.y},score:dt,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(oe){let H=e.getUnitAt(oe.x,oe.y);if(H&&H.owner==="player"&&e.isForest(oe.x,oe.y)){let L=oe.x,Y=oe.y;if(se.some(Te=>Te.x===L&&Te.y===Y)){(fe===null||3e5>fe.score)&&(fe={unit:v,target:{x:L,y:Y},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let Te=d.length>0?d:h;if(Te.length>0)oe=Te.reduce((Xe,dt)=>{let wt=Math.abs(v.position.x-dt.x)+Math.abs(v.position.y-dt.y),mt=Math.abs(v.position.x-Xe.x)+Math.abs(v.position.y-Xe.y);return wt<mt?dt:Xe},Te[0]),this.goals.set(v.id,oe);else continue}}}let Mt=null;if(oe&&e.isForest(oe.x,oe.y)&&!e.getUnitAt(oe.x,oe.y)){let L=[{x:oe.x+1,y:oe.y},{x:oe.x-1,y:oe.y},{x:oe.x,y:oe.y+1},{x:oe.x,y:oe.y-1}].filter(Y=>e.inBounds(Y.x,Y.y)).filter(Y=>{let Z=e.getWallBetween(Y.x,Y.y,oe.x,oe.y);return!!(Z&&Z.owner==="neutral")});L.length>0&&(Mt=L.reduce((Y,Z)=>{let Te=Math.abs(v.position.x-Y.x)+Math.abs(v.position.y-Y.y);return Math.abs(v.position.x-Z.x)+Math.abs(v.position.y-Z.y)+3<Te?Z:Y},L[0]))}let jr=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let H of jr){let L={x:v.position.x+H.x,y:v.position.y+H.y};if(!e.inBounds(L.x,L.y)||!e.isForest(L.x,L.y)||e.getUnitAt(L.x,L.y))continue;let Z=e.getWallBetween(v.position.x,v.position.y,L.x,L.y);if(Z&&(Z.owner==="neutral"||Z.owner==="ai")){let Te=(v.tier>=3?7e6:9e5)+o,Le=Z.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(fe===null||Te>fe.score)&&(fe={unit:v,target:{x:v.position.x,y:v.position.y},score:Te,type:"wall_attack",reason:Le,edge:{from:F({},v.position),to:L}})}else if(Z&&Z.owner==="player"){let Le=[{x:L.x+1,y:L.y},{x:L.x-1,y:L.y},{x:L.x,y:L.y+1},{x:L.x,y:L.y-1}].filter(wt=>e.inBounds(wt.x,wt.y)).filter(wt=>e.getUnitAt(wt.x,wt.y)?!1:!e.getWallBetween(wt.x,wt.y,L.x,L.y)),Xe=Math.abs(v.position.x-L.x)+Math.abs(v.position.y-L.y);if((Le.length>0?Le.reduce((wt,mt)=>{let En=Math.abs(v.position.x-mt.x)+Math.abs(v.position.y-mt.y)+1;return Math.min(wt,En)},1/0):1/0)-Xe>4){let wt=(v.tier>=3?8e6:v.tier===3&&v.level===1?105e4:85e4)+o;(fe===null||wt>fe.score)&&(fe={unit:v,target:{x:v.position.x,y:v.position.y},score:wt,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:F({},v.position),to:L}})}}}for(let H of jr){let L={x:v.position.x+H.x,y:v.position.y+H.y};if(L.x===a.x&&L.y===a.y){let Y=e.getWallBetween(v.position.x,v.position.y,L.x,L.y);if(Y&&(Y.owner==="neutral"||Y.owner==="player")&&v.tier>=3){let Z=8e6+o;(fe===null||Z>fe.score)&&(fe={unit:v,target:{x:v.position.x,y:v.position.y},score:Z,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:F({},v.position),to:L}})}}}if(oe){let H=Math.sign(oe.x-v.position.x),L=Math.sign(oe.y-v.position.y),Y=v.position.x+(H!==0?H:0),Z=v.position.y+(L!==0?L:0);if(e.inBounds(Y,Z)){let Te=e.getUnitAt(Y,Z);if(Te&&Te.owner==="ai")for(let Le of jr){let Xe={x:v.position.x+Le.x,y:v.position.y+Le.y};if(!e.inBounds(Xe.x,Xe.y))continue;let dt=e.getWallBetween(v.position.x,v.position.y,Xe.x,Xe.y);if(dt&&(dt.owner==="player"||dt.owner==="neutral")){let mt=(dt.owner==="player"?65e4:6e5)+o;(fe===null||mt>fe.score)&&(fe={unit:v,target:{x:v.position.x,y:v.position.y},score:mt,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:F({},v.position),to:Xe}})}}}}if(oe){let H=oe.x-v.position.x,L=oe.y-v.position.y;if(H!==0&&L===0||H===0&&L!==0){let Y=Math.sign(H),Z=Math.sign(L),Te={x:v.position.x+Y,y:v.position.y+Z};if(e.inBounds(Te.x,Te.y)&&e.getWallBetween(v.position.x,v.position.y,Te.x,Te.y)){let Xe=(v.tier>=3?8e6:15e5)+o;(fe===null||Xe>fe.score)&&(fe={unit:v,target:{x:v.position.x,y:v.position.y},score:Xe,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:F({},v.position),to:Te}})}}if(Math.abs(H)>=1&&Math.abs(L)>=1){let Y=Math.sign(H),Z=Math.sign(L),Te={x:v.position.x+Y,y:v.position.y+Z};if(e.inBounds(Te.x,Te.y)&&this.combat.isDiagonalBlocked(v.position,Te,(Xe,dt,wt,mt)=>e.getWallBetween(Xe,dt,wt,mt))){let Xe={x:v.position.x+Y,y:v.position.y},dt={x:v.position.x,y:v.position.y+Z},wt=e.getWallBetween(v.position.x,v.position.y,Xe.x,Xe.y),mt=e.getWallBetween(v.position.x,v.position.y,dt.x,dt.y),En=null;if(wt?En={from:F({},v.position),to:Xe}:mt&&(En={from:F({},v.position),to:dt}),En){let Ao=(v.tier>=3?8e6:15e5)+o;(fe===null||Ao>fe.score)&&(fe={unit:v,target:{x:v.position.x,y:v.position.y},score:Ao,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:En})}}}}let C0=d.length===0&&h.length===0&&!Mt;if(qe>=2&&(C0||S.length>0))for(let H of jr){let L={x:v.position.x+H.x,y:v.position.y+H.y};if(!e.inBounds(L.x,L.y))continue;let Y=e.getWallBetween(v.position.x,v.position.y,L.x,L.y);if(Y&&(Y.owner==="neutral"||Y.owner==="player")){let Z=v.tier>=3?8e6:12e5;(fe===null||Z>fe.score)&&(fe={unit:v,target:{x:v.position.x,y:v.position.y},score:Z,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:F({},v.position),to:L}})}}let sr=S.filter(H=>Math.max(Math.abs(H.position.x-v.position.x),Math.abs(H.position.y-v.position.y))===1),Do=sr.length>0?sr.reduce((H,L)=>this.combat.calculateTotalPoints(L)>this.combat.calculateTotalPoints(H)?L:H,sr[0]):null,bs=at.length>0&&se.some(H=>at.some(L=>L.x===H.x&&L.y===H.y));for(let H of se){let L=0,Y="Action",Z=e.getUnitAt(H.x,H.y),Te=be=>[{x:be.x+1,y:be.y},{x:be.x-1,y:be.y},{x:be.x,y:be.y+1},{x:be.x,y:be.y-1}].filter(Ct=>e.inBounds(Ct.x,Ct.y)).filter(Ct=>!e.getUnitAt(Ct.x,Ct.y)).length,Le=Math.max(Math.abs(v.position.x-s.x),Math.abs(v.position.y-s.y)),Xe=Math.max(Math.abs(H.x-s.x),Math.abs(H.y-s.y)),dt=l.length?Math.min(...l.map(be=>Math.abs(v.position.x-be.x)+Math.abs(v.position.y-be.y))):1/0,wt=l.length?Math.min(...l.map(be=>Math.abs(H.x-be.x)+Math.abs(H.y-be.y))):1/0,mt=l.filter(be=>{let He=e.getUnitAt(be.x,be.y);return!!He&&He.owner==="player"}),En=mt.length?Math.min(...mt.map(be=>Math.abs(v.position.x-be.x)+Math.abs(v.position.y-be.y))):1/0,Ao=mt.length?Math.min(...mt.map(be=>Math.abs(H.x-be.x)+Math.abs(H.y-be.y))):1/0,_c=new Map(e.unitMoveHistorySignal()).get(v.id),ri=Array.isArray(_c)?_c:[],Hr=ri.length>=2?ri[ri.length-2]:null,$t=ri.length>=3?ri[ri.length-3]:null,ih=Hr&&H.x===Hr.x&&H.y===Hr.y,$r=jn&&!e.isForest(H.x,H.y);if(D){let be=Math.abs(v.position.x-a.x)+Math.abs(v.position.y-a.y),He=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);He<be?(L+=5e7,Y="FULL RUSH: Charge Base"):He===be?L+=1e5:L-=5e6,Z&&Z.owner==="player"&&Math.abs(Z.position.x-a.x)+Math.abs(Z.position.y-a.y)<be&&(L+=2e7,Y="FULL RUSH: Clear Path to Base"),jn&&H.x===v.position.x&&H.y===v.position.y&&p>=3&&(L=-5e6,Y="FULL RUSH: Abandon Forest for Assault")}else if(v.tier>=3&&$r){let be=Math.abs(H.x-a.x)+Math.abs(H.y-a.y)<=2,He=S.some(Lt=>Math.abs(H.x-Lt.position.x)+Math.abs(H.y-Lt.position.y)<=2),Ct=e.unitsSignal().some(Lt=>Lt.owner==="ai"&&Lt.id!==v.id&&Math.max(Math.abs(Lt.position.x-v.position.x),Math.abs(Lt.position.y-v.position.y))<=1);!M&&!(be||He)&&!Ct&&(L-=2e6,Y="Penalty: Leaving forest without replacement")}let Gr=ne.get(v.id),D0=Gr&&Gr.until>e.turnSignal()&&Gr.tiles.has(`${H.x},${H.y}`);if(v.tier===1&&(Hr&&H.x===Hr.x&&H.y===Hr.y||$t&&H.x===$t.x&&H.y===$t.y)&&(L-=25e3,Y="Anti-Loop Penalty"),v.tier<=2&&!Z&&$t&&H.x===$t.x&&H.y===$t.y&&(L=-1e6,Y="Anti-Loop: Stay or different path"),D0&&(L-=3e4,Y="Stutter Ban Penalty"),jn&&sr.length===0&&!Z&&$r&&!ie&&(L=-1e3),jn&&v.tier<=2&&$r&&sr.length>0&&sr.some(He=>this.combat.calculateTotalPoints(He)>this.combat.calculateTotalPoints(v))&&(L=-1e6,Y="Hold Forest"),D)jn&&H.x===v.position.x&&H.y===v.position.y&&p>=3&&(L=-5e6,Y="FULL RUSH: Abandon Forest for Assault");else if(!Z&&jn&&H.x===v.position.x&&H.y===v.position.y){let be=sr.some(Ct=>this.combat.calculateTotalPoints(Ct)>this.combat.calculateTotalPoints(v)),He=M&&v.tier>=3;!be&&!He&&(L=Math.max(L,1e7),Y="Hold: Stay on forest")}if(!Z&&!D){if(e.isForest(H.x,H.y)&&!e.getUnitAt(H.x,H.y)&&(Es?(L=-1e3,Y="Ignore Forest (Total War)"):v.tier>=3?(L=5e6*(Ie&&!ie?3:1),Y="Priority: T3 capture empty forest"):(L=1e6*(Ie&&!ie?3:1),Y=p<3?`Priority 0: Capture Forest ${H.x},${H.y}`:`Priority 1: Capture Forest ${H.x},${H.y}`,Ie&&!ie&&Math.abs(v.position.x-H.x)+Math.abs(v.position.y-H.y)===1&&(L=Math.max(L,12e6),Y=`Early Capture: Forest ${H.x},${H.y}`))),oe){let be=Math.abs(v.position.x-oe.x)+Math.abs(v.position.y-oe.y),He=Math.abs(H.x-oe.x)+Math.abs(H.y-oe.y);if(He<be&&(L+=5e4*(be-He),Y=d.length>0?`Priority 1: Toward Forest ${oe.x},${oe.y}`:h.length>0?`Priority 7: Toward Fog Forest ${oe.x},${oe.y}`:`Toward Goal ${oe.x},${oe.y}`),g>10||x){let Lt=Math.abs(v.position.x-a.x)+Math.abs(v.position.y-a.y),Rt=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);Rt<Lt&&(L+=15e4*(Lt-Rt),Y="Aggress: Toward Player Base"),Ao<En&&(L+=12e4*(En-Ao),Y="Aggress: Toward Player Forest");let bn=Te(H)-Te(v.position);bn>0&&(L+=5e4*bn,Y="Unblock: Clear path")}if((()=>{let Lt=Math.sign(oe.x-v.position.x),Rt=Math.sign(oe.y-v.position.y),bn=v.position.x+(Lt!==0?Lt:0),Pt=v.position.y+(Rt!==0?Rt:0);return e.inBounds(bn,Pt)?!!e.getWallBetween(v.position.x,v.position.y,bn,Pt):!1})()&&H.x===v.position.x&&H.y===v.position.y){let Rt=e.getWallBetween(v.position.x,v.position.y,v.position.x+Math.sign(oe.x-v.position.x),v.position.y+Math.sign(oe.y-v.position.y))?.owner;v.tier>=3?(L=Math.max(L,8e6+o),Y="Breach: Wall blocks high-priority path"):(L+=(Rt==="ai"?7e5:8e5)+o,Y=Rt==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(Mt){let be=Math.abs(v.position.x-Mt.x)+Math.abs(v.position.y-Mt.y),He=Math.abs(H.x-Mt.x)+Math.abs(H.y-Mt.y);He<be&&(L+=2e5*(be-He),Y="Approach Neutral Wall to Forest"),H.x===Mt.x&&H.y===Mt.y&&(L+=5e5,Y="Position for Wall Breach")}if(H.x===a.x&&H.y===a.y&&(L+=1e4,Y="Attack Base (Override)"),Ae){let be=at.some(Pt=>Pt.x===H.x&&Pt.y===H.y),He=Math.abs(v.position.x-Ae.position.x)+Math.abs(v.position.y-Ae.position.y),Ct=Math.abs(H.x-Ae.position.x)+Math.abs(H.y-Ae.position.y),Rt=Math.max(Math.abs(Ae.position.x-s.x),Math.abs(Ae.position.y-s.y))<=2,bn=H.x===v.position.x&&H.y===v.position.y;if(v.tier>=3&&Ae.tier>=3&&Ct===1)L=4e7,Y="DEFENSE: T3 Move to Intercept Threat";else if(be){let Pt=Rt?25e5:15e5;L<Pt&&(L=Pt),L+=Rt?2e4:5e3,Y=Rt?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(Ct<He){let Pt=v.id===(Ht?.id??"")?1e6:5e3;L+=Pt*(He-Ct),v.tier>=3&&(L+=4e3),Y=v.id===(Ht?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}bn&&bs&&(L-=Rt?5e4:1e4,xe?Y="Penalty: Standing Still With Imminent Base Threat":ie&&(Y="Penalty: Standing Still With Base Threat"))}if(v.tier>=3){let be=Math.abs(v.position.x-a.x)+Math.abs(v.position.y-a.y),He=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);He<be&&(L+=2e3*(be-He),Y="Hunter: Toward Base",M&&(L=Math.max(L,4e6),Y="Hunt: Approach Base"))}if(We&&wt<dt&&(L*=10),Xe>Le&&wt<dt&&(L+=500),Do&&this.combat.calculateTotalPoints(Do)>this.combat.calculateTotalPoints(v)){let be=Math.abs(v.position.x-Do.position.x)+Math.abs(v.position.y-Do.position.y),He=Math.abs(H.x-Do.position.x)+Math.abs(H.y-Do.position.y);He>be&&(L+=75e3*(He-be),Y="Retreat")}}else if(Z.owner==="player"){let be=Math.max(Math.abs(Z.position.x-s.x),Math.abs(Z.position.y-s.y)),He=be<=3,Ct=be<=2,Lt=this.combat.calculateTotalPoints(v),Rt=this.combat.calculateTotalPoints(Z),bn=Lt>Rt,Pt=Z.tier>=3,ws=v.tier>=3;v.tier>=3&&e.isForest(Z.position.x,Z.position.y)&&(L=1e7,Y="Aggression: Liberate forest"),!jn&&ge&&mt.length>0&&e.isForest(Z.position.x,Z.position.y)&&(L=12e6,Y="LIBERATE: Attack player forest"),be<=4&&(v.tier>=3||bn)&&(L=15e6,Y="INTERCEPT: Base Siege"),He?ws&&Pt?(L=5e7,Y="CRITICAL DEFENSE: T3 Intercepts Threat"):bn?(L=2e7,Y="CRITICAL DEFENSE: Eliminate Base Threat",Ct&&(L+=5e6)):Pt&&v.tier<=2?(L=0,Y="Ignore: T1 Suicide vs T3 useless"):(L=1e3,Y="DEFENSE: Desperation Attack"):bn?(Pt?(L=8e6,Y="COMBAT: Kill High Value Target (T3+)"):(L=4e6,Y="COMBAT: Kill Enemy"),v.tier<Z.tier&&(L+=2e6,Y+=" (Efficient Trade)")):v.tier<=2?(L=0,Y="Ignore: No guaranteed kill"):(L=1e5,Y="COMBAT: Chip Damage"),R&&(L+=5e5),N&&(L+=1e6)}else if(Z.tier===v.tier&&Xe>Le){let be=this.combat.calculateTotalPoints(v)+this.combat.calculateTotalPoints(Z),{tier:He}=this.combat.calculateTierAndLevel(be);He>v.tier&&!We&&!jn&&(L=1e3,Y="Merge Up")}let Fi="move";Z&&Z.owner==="player"&&(Fi="attack"),Z&&Z.owner==="ai"&&Z.tier===v.tier&&(Fi="merge"),(g>10||x)&&Fi==="merge"&&(L+=5e6,Y="Anti-Stall: Merge first");let A0=this.interceptUntil.get(v.id)||0;if(v.id===(Ht?.id??"")&&A0>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Ae){let be=Math.abs(v.position.x-Ae.position.x)+Math.abs(v.position.y-Ae.position.y),He=Math.abs(H.x-Ae.position.x)+Math.abs(H.y-Ae.position.y);He<be&&(L+=5e5*(be-He),Y="DEFENSE: Intercept Lock")}ih&&(L=Math.floor(L*.1),L-=3e5,Y="Penalty: Inertia");let M0=(()=>{let be=ri.slice(-6),He=new Set(be.map(Ct=>`${Ct.x},${Ct.y}`));return be.length>=6&&He.size<=3})();if(v.tier===1&&M0){let be=d.length>0?d:h;if(be.length>0){let He=be.reduce((Rt,bn)=>{let Pt=Math.abs(v.position.x-bn.x)+Math.abs(v.position.y-bn.y),ws=Math.abs(v.position.x-Rt.x)+Math.abs(v.position.y-Rt.y);return Pt<ws?bn:Rt},be[0]),Ct=Math.abs(v.position.x-He.x)+Math.abs(v.position.y-He.y),Lt=Math.abs(H.x-He.x)+Math.abs(H.y-He.y);Lt<Ct&&(L+=1e5*(Ct-Lt),Y="Breakout: Toward Forest")}}(v.forestOccupationTurns??0)>0&&(H.x!==v.position.x||H.y!==v.position.y)&&(L-=2e3),(fe===null||L>fe.score)&&(fe={unit:v,target:H,score:L,type:Fi,reason:Y})}}if(!fe)return null;let ve=this.goals.get(fe.unit.id),me=ve?`Goal: Forest at ${ve.x},${ve.y}`:"Goal: None";return{type:fe.type,unit:fe.unit,target:fe.target,reason:fe.reason,edge:fe.edge}}getWallBuildActions(e){let t=[],i=e.unitsSignal().filter(d=>d.owner==="ai"),r=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,h)=>o.some(p=>p.tile1.x===d.x&&p.tile1.y===d.y&&p.tile2.x===h.x&&p.tile2.y===h.y||p.tile1.x===h.x&&p.tile1.y===h.y&&p.tile2.x===d.x&&p.tile2.y===d.y),l=(d,h)=>Math.abs(d.x-h.x)+Math.abs(d.y-h.y),u=(d,h)=>Math.max(Math.abs(d.x-h.x),Math.abs(d.y-h.y));for(let d of i){if(d.tier>=3)continue;let h=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(S=>e.inBounds(S.x,S.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let S of h)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});continue}let p=r.filter(S=>u(d.position,S.position)<=2);if(p.length===0)continue;let g=p.sort((S,N)=>l(d.position,S.position)-l(d.position,N.position))[0],x=h.sort((S,N)=>l(S,g.position)-l(N,g.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let S of x)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});else if(d.tier===2){let S=0;for(let N of x){if(S>=2)break;!a(d.position,N)&&e.canBuildWallBetween(d.position,N)&&(t.push({from:d.position,to:N}),S++)}}}return t}static \u0275fac=function(t){return new(t||n)(Me(Ml),Me(Ut))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var e2=()=>{};var i2=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},cj=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=n[t++],s=n[t++],a=n[t++],l=((r&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63)}}return e.join("")},r2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,a=s?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,d=o>>2,h=(o&3)<<4|a>>4,p=(a&15)<<2|u>>6,g=u&63;l||(g=64,s||(p=64)),i.push(t[d],t[h],t[p],t[g])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(i2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cj(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let u=r<n.length?t[n.charAt(r)]:64;++r;let h=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||a==null||u==null||h==null)throw new xb;let p=o<<2|a>>4;if(i.push(p),u!==64){let g=a<<4&240|u>>2;if(i.push(g),h!==64){let x=u<<6&192|h;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},xb=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},uj=function(n){let e=i2(n);return r2.encodeByteArray(e,!0)},cd=function(n){return uj(n).replace(/\./g,"")},Rg=function(n){try{return r2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function o2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var dj=()=>o2().__FIREBASE_DEFAULTS__,hj=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},fj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Rg(n[1]);return e&&JSON.parse(e)},Pg=()=>{try{return e2()||dj()||hj()||fj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ib=n=>Pg()?.emulatorHosts?.[n],s2=n=>{let e=Ib(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Tb=()=>Pg()?.config,Cb=n=>Pg()?.[`_${n}`];var Mg=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function rs(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ng(n){return(await fetch(n,{credentials:"include"})).ok}function a2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=F({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[cd(JSON.stringify(t)),cd(JSON.stringify(s)),""].join(".")}var ld={};function pj(){let n={prod:[],emulator:[]};for(let e of Object.keys(ld))ld[e]?n.emulator.push(e):n.prod.push(e);return n}function gj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var t2=!1;function kg(n,e){if(typeof window>"u"||typeof document>"u"||!rs(window.location.host)||ld[n]===e||ld[n]||t2)return;ld[n]=e;function t(p){return`__firebase__banner__${p}`}let i="__firebase__banner",o=pj().prod.length>0;function s(){let p=document.getElementById(i);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){let p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{t2=!0,s()},p}function d(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function h(){let p=gj(i),g=t("text"),x=document.getElementById(g)||document.createElement("span"),S=t("learnmore"),N=document.getElementById(S)||document.createElement("a"),U=t("preprendIcon"),ie=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){let Se=p.element;a(Se),d(N,S);let xe=u();l(ie,U),Se.append(ie,x,N,xe),document.body.appendChild(Se)}o?(x.innerText="Preview backend disconnected.",ie.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ie.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function l2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function mj(){let n=Pg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function c2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function u2(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function d2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function h2(){let n=In();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function f2(){return!mj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Db(){try{return typeof indexedDB=="object"}catch{return!1}}function p2(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var yj="FirebaseError",vi=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=yj,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lo.prototype.create)}},lo=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?vj(o,i):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new vi(r,a,i)}};function vj(n,e){return n.replace(_j,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var _j=/\{\$([^}]+)}/g;function g2(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function er(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(n2(o)&&n2(s)){if(!er(o,s))return!1}else if(o!==s)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function n2(n){return n!==null&&typeof n=="object"}function Rl(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function m2(n,e){let t=new Sb(n,e);return t.subscribe.bind(t)}var Sb=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Ej(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=wb),r.error===void 0&&(r.error=wb),r.complete===void 0&&(r.complete=wb);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Ej(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wb(){}var aue=14400*1e3;function Tn(n){return n&&n._delegate?n._delegate:n}var Pi=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var fa="[DEFAULT]";var Ab=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Mg;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wj(e))try{this.getOrInitializeService({instanceIdentifier:fa})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=fa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fa){return this.instances.has(e)}getOptions(e=fa){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&s.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:bj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=fa){return this.component?this.component.multipleInstances?e:fa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function bj(n){return n===fa?void 0:n}function wj(n){return n.instantiationMode==="EAGER"}var Og=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ab(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var xj=[],tt=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(tt||{}),Sj={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},Ij=tt.INFO,Tj={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},Cj=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=Tj[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},os=class{constructor(e){this.name=e,this._logLevel=Ij,this._logHandler=Cj,this._userLogHandler=null,xj.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Sj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}};var Dj=(n,e)=>e.some(t=>n instanceof t),y2,v2;function Aj(){return y2||(y2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mj(){return v2||(v2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var _2=new WeakMap,Rb=new WeakMap,E2=new WeakMap,Mb=new WeakMap,Nb=new WeakMap;function Rj(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Ar(n.result)),r()},s=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&_2.set(t,n)}).catch(()=>{}),Nb.set(e,n),e}function Pj(n){if(Rb.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Rb.set(n,e)}var Pb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Rb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||E2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ar(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function b2(n){Pb=n(Pb)}function Nj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(Fg(this),e,...t);return E2.set(i,e.sort?e.sort():[e]),Ar(i)}:Mj().includes(n)?function(...e){return n.apply(Fg(this),e),Ar(_2.get(this))}:function(...e){return Ar(n.apply(Fg(this),e))}}function kj(n){return typeof n=="function"?Nj(n):(n instanceof IDBTransaction&&Pj(n),Dj(n,Aj())?new Proxy(n,Pb):n)}function Ar(n){if(n instanceof IDBRequest)return Rj(n);if(Mb.has(n))return Mb.get(n);let e=kj(n);return e!==n&&(Mb.set(n,e),Nb.set(e,n)),e}var Fg=n=>Nb.get(n);function x2(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),a=Ar(s);return i&&s.addEventListener("upgradeneeded",l=>{i(Ar(s.result),l.oldVersion,l.newVersion,Ar(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var Oj=["get","getKey","getAll","getAllKeys","count"],Fj=["put","add","delete","clear"],kb=new Map;function w2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(kb.get(e))return kb.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Fj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Oj.includes(t)))return;let o=async function(s,...a){let l=this.transaction(s,r?"readwrite":"readonly"),u=l.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),r&&l.done]))[0]};return kb.set(e,o),o}b2(n=>pe(F({},n),{get:(e,t,i)=>w2(e,t)||n.get(e,t,i),has:(e,t)=>!!w2(e,t)||n.has(e,t)}));var Fb=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Lj(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function Lj(n){return n.getComponent()?.type==="VERSION"}var Lb="@firebase/app",S2="0.14.7";var co=new os("@firebase/app"),Vj="@firebase/app-compat",Uj="@firebase/analytics-compat",Bj="@firebase/analytics",jj="@firebase/app-check-compat",Hj="@firebase/app-check",$j="@firebase/auth",Gj="@firebase/auth-compat",zj="@firebase/database",Wj="@firebase/data-connect",qj="@firebase/database-compat",Kj="@firebase/functions",Yj="@firebase/functions-compat",Qj="@firebase/installations",Jj="@firebase/installations-compat",Zj="@firebase/messaging",Xj="@firebase/messaging-compat",e9="@firebase/performance",t9="@firebase/performance-compat",n9="@firebase/remote-config",i9="@firebase/remote-config-compat",r9="@firebase/storage",o9="@firebase/storage-compat",s9="@firebase/firestore",a9="@firebase/ai",l9="@firebase/firestore-compat",c9="firebase",u9="12.8.0";var Vb="[DEFAULT]",d9={[Lb]:"fire-core",[Vj]:"fire-core-compat",[Bj]:"fire-analytics",[Uj]:"fire-analytics-compat",[Hj]:"fire-app-check",[jj]:"fire-app-check-compat",[$j]:"fire-auth",[Gj]:"fire-auth-compat",[zj]:"fire-rtdb",[Wj]:"fire-data-connect",[qj]:"fire-rtdb-compat",[Kj]:"fire-fn",[Yj]:"fire-fn-compat",[Qj]:"fire-iid",[Jj]:"fire-iid-compat",[Zj]:"fire-fcm",[Xj]:"fire-fcm-compat",[e9]:"fire-perf",[t9]:"fire-perf-compat",[n9]:"fire-rc",[i9]:"fire-rc-compat",[r9]:"fire-gcs",[o9]:"fire-gcs-compat",[s9]:"fire-fst",[l9]:"fire-fst-compat",[a9]:"fire-vertex","fire-js":"fire-js",[c9]:"fire-js-all"};var Lg=new Map,h9=new Map,Ub=new Map;function I2(n,e){try{n.container.addComponent(e)}catch(t){co.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function as(n){let e=n.name;if(Ub.has(e))return co.debug(`There were multiple attempts to register component ${e}.`),!1;Ub.set(e,n);for(let t of Lg.values())I2(t,n);for(let t of h9.values())I2(t,n);return!0}function dd(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function _i(n){return n==null?!1:n.settings!==void 0}var f9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ss=new lo("app","Firebase",f9);var Bb=class{constructor(e,t,i){this._isDeleted=!1,this._options=F({},e),this._config=F({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ss.create("app-deleted",{appName:this._name})}};var ls=u9;function hd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=F({name:Vb,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw ss.create("bad-app-name",{appName:String(r)});if(t||(t=Tb()),!t)throw ss.create("no-options");let o=Lg.get(r);if(o){if(er(t,o.options)&&er(i,o.config))return o;throw ss.create("duplicate-app",{appName:r})}let s=new Og(r);for(let l of Ub.values())s.addComponent(l);let a=new Bb(t,i,s);return Lg.set(r,a),a}function Vg(n=Vb){let e=Lg.get(n);if(!e&&n===Vb&&Tb())return hd();if(!e)throw ss.create("no-app",{appName:n});return e}function tr(n,e,t){let i=d9[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let s=[`Unable to register library "${i}" with version "${e}":`];r&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),co.warn(s.join(" "));return}as(new Pi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var p9="firebase-heartbeat-database",g9=1,ud="firebase-heartbeat-store",Ob=null;function A2(){return Ob||(Ob=x2(p9,g9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ud)}catch(t){console.warn(t)}}}}).catch(n=>{throw ss.create("idb-open",{originalErrorMessage:n.message})})),Ob}async function m9(n){try{let t=(await A2()).transaction(ud),i=await t.objectStore(ud).get(M2(n));return await t.done,i}catch(e){if(e instanceof vi)co.warn(e.message);else{let t=ss.create("idb-get",{originalErrorMessage:e?.message});co.warn(t.message)}}}async function T2(n,e){try{let i=(await A2()).transaction(ud,"readwrite");await i.objectStore(ud).put(e,M2(n)),await i.done}catch(t){if(t instanceof vi)co.warn(t.message);else{let i=ss.create("idb-set",{originalErrorMessage:t?.message});co.warn(i.message)}}}function M2(n){return`${n.name}!${n.options.appId}`}var y9=1024,v9=30,jb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Hb(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=C2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>v9){let r=E9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){co.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=C2(),{heartbeatsToSend:t,unsentEntries:i}=_9(this._heartbeatsCache.heartbeats),r=cd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return co.warn(e),""}}};function C2(){return new Date().toISOString().substring(0,10)}function _9(n,e=y9){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),D2(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),D2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Hb=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Db()?p2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await m9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return T2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return T2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function D2(n){return cd(JSON.stringify({version:2,heartbeats:n})).length}function E9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function b9(n){as(new Pi("platform-logger",e=>new Fb(e),"PRIVATE")),as(new Pi("heartbeat",e=>new jb(e),"PRIVATE")),tr(Lb,S2,n),tr(Lb,S2,"esm2020"),tr("fire-js","")}b9("");var w9="firebase",x9="12.8.0";tr(w9,x9,"app");var R2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P2={};var uo,$b;(function(){var n;function e(k,I){function P(){}P.prototype=I.prototype,k.F=I.prototype,k.prototype=new P,k.prototype.constructor=k,k.D=function(D,w,R){for(var M=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)M[ge-2]=arguments[ge];return I.prototype[w].apply(D,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,I,P){P||(P=0);let D=Array(16);if(typeof I=="string")for(var w=0;w<16;++w)D[w]=I.charCodeAt(P++)|I.charCodeAt(P++)<<8|I.charCodeAt(P++)<<16|I.charCodeAt(P++)<<24;else for(w=0;w<16;++w)D[w]=I[P++]|I[P++]<<8|I[P++]<<16|I[P++]<<24;I=k.g[0],P=k.g[1],w=k.g[2];let R=k.g[3],M;M=I+(R^P&(w^R))+D[0]+3614090360&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[1]+3905402710&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[2]+606105819&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[3]+3250441966&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(R^P&(w^R))+D[4]+4118548399&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[5]+1200080426&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[6]+2821735955&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[7]+4249261313&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(R^P&(w^R))+D[8]+1770035416&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[9]+2336552879&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[10]+4294925233&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[11]+2304563134&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(R^P&(w^R))+D[12]+1804603682&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[13]+4254626195&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[14]+2792965006&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[15]+1236535329&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(w^R&(P^w))+D[1]+4129170786&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[6]+3225465664&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[11]+643717713&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[0]+3921069994&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(w^R&(P^w))+D[5]+3593408605&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[10]+38016083&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[15]+3634488961&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[4]+3889429448&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(w^R&(P^w))+D[9]+568446438&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[14]+3275163606&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[3]+4107603335&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[8]+1163531501&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(w^R&(P^w))+D[13]+2850285829&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[2]+4243563512&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[7]+1735328473&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[12]+2368359562&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(P^w^R)+D[5]+4294588738&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[8]+2272392833&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[11]+1839030562&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[14]+4259657740&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(P^w^R)+D[1]+2763975236&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[4]+1272893353&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[7]+4139469664&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[10]+3200236656&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(P^w^R)+D[13]+681279174&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[0]+3936430074&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[3]+3572445317&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[6]+76029189&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(P^w^R)+D[9]+3654602809&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[12]+3873151461&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[15]+530742520&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[2]+3299628645&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(w^(P|~R))+D[0]+4096336452&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[7]+1126891415&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[14]+2878612391&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[5]+4237533241&4294967295,P=w+(M<<21&4294967295|M>>>11),M=I+(w^(P|~R))+D[12]+1700485571&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[3]+2399980690&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[10]+4293915773&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[1]+2240044497&4294967295,P=w+(M<<21&4294967295|M>>>11),M=I+(w^(P|~R))+D[8]+1873313359&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[15]+4264355552&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[6]+2734768916&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[13]+1309151649&4294967295,P=w+(M<<21&4294967295|M>>>11),M=I+(w^(P|~R))+D[4]+4149444226&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[11]+3174756917&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[2]+718787259&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(w+(M<<21&4294967295|M>>>11))&4294967295,k.g[2]=k.g[2]+w&4294967295,k.g[3]=k.g[3]+R&4294967295}i.prototype.v=function(k,I){I===void 0&&(I=k.length);let P=I-this.blockSize,D=this.C,w=this.h,R=0;for(;R<I;){if(w==0)for(;R<=P;)r(this,k,R),R+=this.blockSize;if(typeof k=="string"){for(;R<I;)if(D[w++]=k.charCodeAt(R++),w==this.blockSize){r(this,D),w=0;break}}else for(;R<I;)if(D[w++]=k[R++],w==this.blockSize){r(this,D),w=0;break}}this.h=w,this.o+=I},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;I=this.o*8;for(var P=k.length-8;P<k.length;++P)k[P]=I&255,I/=256;for(this.v(k),k=Array(16),I=0,P=0;P<4;++P)for(let D=0;D<32;D+=8)k[I++]=this.g[P]>>>D&255;return k};function o(k,I){var P=a;return Object.prototype.hasOwnProperty.call(P,k)?P[k]:P[k]=I(k)}function s(k,I){this.h=I;let P=[],D=!0;for(let w=k.length-1;w>=0;w--){let R=k[w]|0;D&&R==I||(P[w]=R,D=!1)}this.g=P}var a={};function l(k){return-128<=k&&k<128?o(k,function(I){return new s([I|0],I<0?-1:0)}):new s([k|0],k<0?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return h;if(k<0)return N(u(-k));let I=[],P=1;for(let D=0;k>=P;D++)I[D]=k/P|0,P*=4294967296;return new s(I,0)}function d(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return N(d(k.substring(1),I));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');let P=u(Math.pow(I,8)),D=h;for(let R=0;R<k.length;R+=8){var w=Math.min(8,k.length-R);let M=parseInt(k.substring(R,R+w),I);w<8?(w=u(Math.pow(I,w)),D=D.j(w).add(u(M))):(D=D.j(P),D=D.add(u(M)))}return D}var h=l(0),p=l(1),g=l(16777216);n=s.prototype,n.m=function(){if(S(this))return-N(this).m();let k=0,I=1;for(let P=0;P<this.g.length;P++){let D=this.i(P);k+=(D>=0?D:4294967296+D)*I,I*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(x(this))return"0";if(S(this))return"-"+N(this).toString(k);let I=u(Math.pow(k,6));var P=this;let D="";for(;;){let w=xe(P,I).g;P=U(P,w.j(I));let R=((P.g.length>0?P.g[0]:P.h)>>>0).toString(k);if(P=w,x(P))return R+D;for(;R.length<6;)R="0"+R;D=R+D}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function x(k){if(k.h!=0)return!1;for(let I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function S(k){return k.h==-1}n.l=function(k){return k=U(this,k),S(k)?-1:x(k)?0:1};function N(k){let I=k.g.length,P=[];for(let D=0;D<I;D++)P[D]=~k.g[D];return new s(P,~k.h).add(p)}n.abs=function(){return S(this)?N(this):this},n.add=function(k){let I=Math.max(this.g.length,k.g.length),P=[],D=0;for(let w=0;w<=I;w++){let R=D+(this.i(w)&65535)+(k.i(w)&65535),M=(R>>>16)+(this.i(w)>>>16)+(k.i(w)>>>16);D=M>>>16,R&=65535,M&=65535,P[w]=M<<16|R}return new s(P,P[P.length-1]&-2147483648?-1:0)};function U(k,I){return k.add(N(I))}n.j=function(k){if(x(this)||x(k))return h;if(S(this))return S(k)?N(this).j(N(k)):N(N(this).j(k));if(S(k))return N(this.j(N(k)));if(this.l(g)<0&&k.l(g)<0)return u(this.m()*k.m());let I=this.g.length+k.g.length,P=[];for(var D=0;D<2*I;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(let w=0;w<k.g.length;w++){let R=this.i(D)>>>16,M=this.i(D)&65535,ge=k.i(w)>>>16,Oe=k.i(w)&65535;P[2*D+2*w]+=M*Oe,ie(P,2*D+2*w),P[2*D+2*w+1]+=R*Oe,ie(P,2*D+2*w+1),P[2*D+2*w+1]+=M*ge,ie(P,2*D+2*w+1),P[2*D+2*w+2]+=R*ge,ie(P,2*D+2*w+2)}for(k=0;k<I;k++)P[k]=P[2*k+1]<<16|P[2*k];for(k=I;k<2*I;k++)P[k]=0;return new s(P,0)};function ie(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function Se(k,I){this.g=k,this.h=I}function xe(k,I){if(x(I))throw Error("division by zero");if(x(k))return new Se(h,h);if(S(k))return I=xe(N(k),I),new Se(N(I.g),N(I.h));if(S(I))return I=xe(k,N(I)),new Se(N(I.g),I.h);if(k.g.length>30){if(S(k)||S(I))throw Error("slowDivide_ only works with positive integers.");for(var P=p,D=I;D.l(k)<=0;)P=De(P),D=De(D);var w=Ie(P,1),R=Ie(D,1);for(D=Ie(D,2),P=Ie(P,2);!x(D);){var M=R.add(D);M.l(k)<=0&&(w=w.add(P),R=M),D=Ie(D,1),P=Ie(P,1)}return I=U(k,w.j(I)),new Se(w,I)}for(w=h;k.l(I)>=0;){for(P=Math.max(1,Math.floor(k.m()/I.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),R=u(P),M=R.j(I);S(M)||M.l(k)>0;)P-=D,R=u(P),M=R.j(I);x(R)&&(R=p),w=w.add(R),k=U(k,M)}return new Se(w,k)}n.B=function(k){return xe(this,k).h},n.and=function(k){let I=Math.max(this.g.length,k.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)&k.i(D);return new s(P,this.h&k.h)},n.or=function(k){let I=Math.max(this.g.length,k.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)|k.i(D);return new s(P,this.h|k.h)},n.xor=function(k){let I=Math.max(this.g.length,k.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)^k.i(D);return new s(P,this.h^k.h)};function De(k){let I=k.g.length+1,P=[];for(let D=0;D<I;D++)P[D]=k.i(D)<<1|k.i(D-1)>>>31;return new s(P,k.h)}function Ie(k,I){let P=I>>5;I%=32;let D=k.g.length-P,w=[];for(let R=0;R<D;R++)w[R]=I>0?k.i(R+P)>>>I|k.i(R+P+1)<<32-I:k.i(R+P);return new s(w,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,$b=P2.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=d,uo=P2.Integer=s}).apply(typeof R2<"u"?R2:typeof self<"u"?self:typeof window<"u"?window:{});var Ug=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ho={};var Gb,S9,Pl,zb,fd,Bg,Wb,qb,Kb;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ug=="object"&&Ug];for(var f=0;f<c.length;++f){var m=c[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var i=t(this);function r(c,f){if(f)e:{var m=i;c=c.split(".");for(var T=0;T<c.length-1;T++){var V=c[T];if(!(V in m))break e;m=m[V]}c=c[c.length-1],T=m[c],f=f(T),f!=T&&f!=null&&e(m,c,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(f){var m=[],T;for(T in f)Object.prototype.hasOwnProperty.call(f,T)&&m.push([T,f[T]]);return m}});var o=o||{},s=this||self;function a(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function l(c,f,m){return c.call.apply(c.bind,arguments)}function u(c,f,m){return u=l,u.apply(null,arguments)}function d(c,f){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),c.apply(this,T)}}function h(c,f){function m(){}m.prototype=f.prototype,c.Z=f.prototype,c.prototype=new m,c.prototype.constructor=c,c.Ob=function(T,V,B){for(var de=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)de[Je-2]=arguments[Je];return f.prototype[V].apply(T,de)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){let f=c.length;if(f>0){let m=Array(f);for(let T=0;T<f;T++)m[T]=c[T];return m}return[]}function x(c,f){for(let T=1;T<arguments.length;T++){let V=arguments[T];var m=typeof V;if(m=m!="object"?m:V?Array.isArray(V)?"array":m:"null",m=="array"||m=="object"&&typeof V.length=="number"){m=c.length||0;let B=V.length||0;c.length=m+B;for(let de=0;de<B;de++)c[m+de]=V[de]}else c.push(V)}}class S{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function N(c){s.setTimeout(()=>{throw c},0)}function U(){var c=k;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class ie{constructor(){this.h=this.g=null}add(f,m){let T=Se.get();T.set(f,m),this.h?this.h.next=T:this.g=T,this.h=T}}var Se=new S(()=>new xe,c=>c.reset());class xe{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let De,Ie=!1,k=new ie,I=()=>{let c=Promise.resolve(void 0);De=()=>{c.then(P)}};function P(){for(var c;c=U();){try{c.h.call(c.g)}catch(m){N(m)}var f=Se;f.j(c),f.h<100&&(f.h++,c.next=f.g,f.g=c)}Ie=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let m=()=>{};s.addEventListener("test",m,f),s.removeEventListener("test",m,f)}catch{}return c})();function M(c){return/^[\s\xa0]*$/.test(c)}function ge(c,f){w.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,f)}h(ge,w),ge.prototype.init=function(c,f){let m=this.type=c.type,T=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget,f||(m=="mouseover"?f=c.fromElement:m=="mouseout"&&(f=c.toElement)),this.relatedTarget=f,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&ge.Z.h.call(this)},ge.prototype.h=function(){ge.Z.h.call(this);let c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Oe="closure_listenable_"+(Math.random()*1e6|0),fe=0;function Ft(c,f,m,T,V){this.listener=c,this.proxy=null,this.src=f,this.type=m,this.capture=!!T,this.ha=V,this.key=++fe,this.da=this.fa=!1}function Zt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Ae(c,f,m){for(let T in c)f.call(m,c[T],T,c)}function Ht(c,f){for(let m in c)f.call(void 0,c[m],m,c)}function at(c){let f={};for(let m in c)f[m]=c[m];return f}let te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(c,f){let m,T;for(let V=1;V<arguments.length;V++){T=arguments[V];for(m in T)c[m]=T[m];for(let B=0;B<te.length;B++)m=te[B],Object.prototype.hasOwnProperty.call(T,m)&&(c[m]=T[m])}}function Ee(c){this.src=c,this.g={},this.h=0}Ee.prototype.add=function(c,f,m,T,V){let B=c.toString();c=this.g[B],c||(c=this.g[B]=[],this.h++);let de=me(c,f,T,V);return de>-1?(f=c[de],m||(f.fa=!1)):(f=new Ft(f,this.src,B,!!T,V),f.fa=m,c.push(f)),f};function ve(c,f){let m=f.type;if(m in c.g){var T=c.g[m],V=Array.prototype.indexOf.call(T,f,void 0),B;(B=V>=0)&&Array.prototype.splice.call(T,V,1),B&&(Zt(f),c.g[m].length==0&&(delete c.g[m],c.h--))}}function me(c,f,m,T){for(let V=0;V<c.length;++V){let B=c[V];if(!B.da&&B.listener==f&&B.capture==!!m&&B.ha==T)return V}return-1}var v="closure_lm_"+(Math.random()*1e6|0),se={};function We(c,f,m,T,V){if(T&&T.once)return bt(c,f,m,T,V);if(Array.isArray(f)){for(let B=0;B<f.length;B++)We(c,f[B],m,T,V);return null}return m=vc(m),c&&c[Oe]?c.J(f,m,a(T)?!!T.capture:!!T,V):qe(c,f,m,!1,T,V)}function qe(c,f,m,T,V,B){if(!f)throw Error("Invalid event type");let de=a(V)?!!V.capture:!!V,Je=jn(c);if(Je||(c[v]=Je=new Ee(c)),m=Je.add(f,m,T,de,B),m.proxy)return m;if(T=oe(),m.proxy=T,T.src=c,T.listener=m,c.addEventListener)R||(V=de),V===void 0&&(V=!1),c.addEventListener(f.toString(),T,V);else if(c.attachEvent)c.attachEvent(Es(f.toString()),T);else if(c.addListener&&c.removeListener)c.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function oe(){function c(m){return f.call(c.src,c.listener,m)}let f=nh;return c}function bt(c,f,m,T,V){if(Array.isArray(f)){for(let B=0;B<f.length;B++)bt(c,f[B],m,T,V);return null}return m=vc(m),c&&c[Oe]?c.K(f,m,a(T)?!!T.capture:!!T,V):qe(c,f,m,!0,T,V)}function Ei(c,f,m,T,V){if(Array.isArray(f))for(var B=0;B<f.length;B++)Ei(c,f[B],m,T,V);else T=a(T)?!!T.capture:!!T,m=vc(m),c&&c[Oe]?(c=c.i,B=String(f).toString(),B in c.g&&(f=c.g[B],m=me(f,m,T,V),m>-1&&(Zt(f[m]),Array.prototype.splice.call(f,m,1),f.length==0&&(delete c.g[B],c.h--)))):c&&(c=jn(c))&&(f=c.g[f.toString()],c=-1,f&&(c=me(f,m,T,V)),(m=c>-1?f[c]:null)&&ii(m))}function ii(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[Oe])ve(f.i,c);else{var m=c.type,T=c.proxy;f.removeEventListener?f.removeEventListener(m,T,c.capture):f.detachEvent?f.detachEvent(Es(m),T):f.addListener&&f.removeListener&&f.removeListener(T),(m=jn(f))?(ve(m,c),m.h==0&&(m.src=null,f[v]=null)):Zt(c)}}}function Es(c){return c in se?se[c]:se[c]="on"+c}function nh(c,f){if(c.da)c=!0;else{f=new ge(f,this);let m=c.listener,T=c.ha||c.src;c.fa&&ii(c),c=m.call(T,f)}return c}function jn(c){return c=c[v],c instanceof Ee?c:null}var yc="__closure_events_fn_"+(Math.random()*1e9>>>0);function vc(c){return typeof c=="function"?c:(c[yc]||(c[yc]=function(f){return c.handleEvent(f)}),c[yc])}function An(){D.call(this),this.i=new Ee(this),this.M=this,this.G=null}h(An,D),An.prototype[Oe]=!0,An.prototype.removeEventListener=function(c,f,m,T){Ei(this,c,f,m,T)};function Mt(c,f){var m,T=c.G;if(T)for(m=[];T;T=T.G)m.push(T);if(c=c.M,T=f.type||f,typeof f=="string")f=new w(f,c);else if(f instanceof w)f.target=f.target||c;else{var V=f;f=new w(T,c),ne(f,V)}V=!0;let B,de;if(m)for(de=m.length-1;de>=0;de--)B=f.g=m[de],V=jr(B,T,!0,f)&&V;if(B=f.g=c,V=jr(B,T,!0,f)&&V,V=jr(B,T,!1,f)&&V,m)for(de=0;de<m.length;de++)B=f.g=m[de],V=jr(B,T,!1,f)&&V}An.prototype.N=function(){if(An.Z.N.call(this),this.i){var c=this.i;for(let f in c.g){let m=c.g[f];for(let T=0;T<m.length;T++)Zt(m[T]);delete c.g[f],c.h--}}this.G=null},An.prototype.J=function(c,f,m,T){return this.i.add(String(c),f,!1,m,T)},An.prototype.K=function(c,f,m,T){return this.i.add(String(c),f,!0,m,T)};function jr(c,f,m,T){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();let V=!0;for(let B=0;B<f.length;++B){let de=f[B];if(de&&!de.da&&de.capture==m){let Je=de.listener,mn=de.ha||de.src;de.fa&&ve(c.i,de),V=Je.call(mn,T)!==!1&&V}}return V&&!T.defaultPrevented}function C0(c,f){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:s.setTimeout(c,f||0)}function sr(c){c.g=C0(()=>{c.g=null,c.i&&(c.i=!1,sr(c))},c.l);let f=c.h;c.h=null,c.m.apply(null,f)}class Do extends D{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:sr(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bs(c){D.call(this),this.h=c,this.g={}}h(bs,D);var H=[];function L(c){Ae(c.g,function(f,m){this.g.hasOwnProperty(m)&&ii(f)},c),c.g={}}bs.prototype.N=function(){bs.Z.N.call(this),L(this)},bs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Y=s.JSON.stringify,Z=s.JSON.parse,Te=class{stringify(c){return s.JSON.stringify(c,void 0)}parse(c){return s.JSON.parse(c,void 0)}};function Le(){}function Xe(){}var dt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wt(){w.call(this,"d")}h(wt,w);function mt(){w.call(this,"c")}h(mt,w);var En={},Ao=null;function Oa(){return Ao=Ao||new An}En.Ia="serverreachability";function _c(c){w.call(this,En.Ia,c)}h(_c,w);function ri(c){let f=Oa();Mt(f,new _c(f))}En.STAT_EVENT="statevent";function Hr(c,f){w.call(this,En.STAT_EVENT,c),this.stat=f}h(Hr,w);function $t(c){let f=Oa();Mt(f,new Hr(f,c))}En.Ja="timingevent";function ih(c,f){w.call(this,En.Ja,c),this.size=f}h(ih,w);function $r(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){c()},f)}function Gr(){this.g=!0}Gr.prototype.ua=function(){this.g=!1};function D0(c,f,m,T,V,B){c.info(function(){if(c.g)if(B){var de="",Je=B.split("&");for(let Tt=0;Tt<Je.length;Tt++){var mn=Je[Tt].split("=");if(mn.length>1){let wn=mn[0];mn=mn[1];let lr=wn.split("_");de=lr.length>=2&&lr[1]=="type"?de+(wn+"="+mn+"&"):de+(wn+"=redacted&")}}}else de=null;else de=B;return"XMLHTTP REQ ("+T+") [attempt "+V+"]: "+f+`
`+m+`
`+de})}function W1(c,f,m,T,V,B,de){c.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+V+"]: "+f+`
`+m+`
`+B+" "+de})}function Fi(c,f,m,T){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+M0(c,m)+(T?" "+T:"")})}function A0(c,f){c.info(function(){return"TIMEOUT: "+f})}Gr.prototype.info=function(){};function M0(c,f){if(!c.g)return f;if(!f)return null;try{let B=JSON.parse(f);if(B){for(c=0;c<B.length;c++)if(Array.isArray(B[c])){var m=B[c];if(!(m.length<2)){var T=m[1];if(Array.isArray(T)&&!(T.length<1)){var V=T[0];if(V!="noop"&&V!="stop"&&V!="close")for(let de=1;de<T.length;de++)T[de]=""}}}}return Y(B)}catch{return f}}var be={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},He={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ct;function Lt(){}h(Lt,Le),Lt.prototype.g=function(){return new XMLHttpRequest},Ct=new Lt;function Rt(c){return encodeURIComponent(String(c))}function bn(c){var f=1;c=c.split(":");let m=[];for(;f>0&&c.length;)m.push(c.shift()),f--;return c.length&&m.push(c.join(":")),m}function Pt(c,f,m,T){this.j=c,this.i=f,this.l=m,this.S=T||1,this.V=new bs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ws}function ws(){this.i=null,this.g="",this.h=!1}var q1={},R0={};function P0(c,f,m){c.M=1,c.A=oh(ar(f)),c.u=m,c.R=!0,K1(c,null)}function K1(c,f){c.F=Date.now(),rh(c),c.B=ar(c.A);var m=c.B,T=c.S;Array.isArray(T)||(T=[String(T)]),aS(m.i,"t",T),c.C=0,m=c.j.L,c.h=new ws,c.g=IS(c.j,m?f:null,!c.u),c.P>0&&(c.O=new Do(u(c.Y,c,c.g),c.P)),f=c.V,m=c.g,T=c.ba;var V="readystatechange";Array.isArray(V)||(V&&(H[0]=V.toString()),V=H);for(let B=0;B<V.length;B++){let de=We(m,V[B],T||f.handleEvent,!1,f.h||f);if(!de)break;f.g[de.key]=de}f=c.J?at(c.J):{},c.u?(c.v||(c.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,f)):(c.v="GET",c.g.ea(c.B,c.v,null,f)),ri(),D0(c.i,c.v,c.B,c.l,c.S,c.u)}Pt.prototype.ba=function(c){c=c.target;let f=this.O;f&&Po(c)==3?f.j():this.Y(c)},Pt.prototype.Y=function(c){try{if(c==this.g)e:{let Je=Po(this.g),mn=this.g.ya(),Tt=this.g.ca();if(!(Je<3)&&(Je!=3||this.g&&(this.h.h||this.g.la()||pS(this.g)))){this.K||Je!=4||mn==7||(mn==8||Tt<=0?ri(3):ri(2)),N0(this);var f=this.g.ca();this.X=f;var m=OO(this);if(this.o=f==200,W1(this.i,this.v,this.B,this.l,this.S,Je,f),this.o){if(this.U&&!this.L){t:{if(this.g){var T,V=this.g;if((T=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(T)){var B=T;break t}}B=null}if(c=B)Fi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,k0(this,c);else{this.o=!1,this.m=3,$t(12),xs(this),Ec(this);break e}}if(this.R){c=!0;let wn;for(;!this.K&&this.C<m.length;)if(wn=FO(this,m),wn==R0){Je==4&&(this.m=4,$t(14),c=!1),Fi(this.i,this.l,null,"[Incomplete Response]");break}else if(wn==q1){this.m=4,$t(15),Fi(this.i,this.l,m,"[Invalid Chunk]"),c=!1;break}else Fi(this.i,this.l,wn,null),k0(this,wn);if(Y1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Je!=4||m.length!=0||this.h.h||(this.m=1,$t(16),c=!1),this.o=this.o&&c,!c)Fi(this.i,this.l,m,"[Invalid Chunked Response]"),xs(this),Ec(this);else if(m.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+m.length),j0(de),de.P=!0,$t(11))}}else Fi(this.i,this.l,m,null),k0(this,m);Je==4&&xs(this),this.o&&!this.K&&(Je==4?bS(this.j,this):(this.o=!1,rh(this)))}else QO(this.g),f==400&&m.indexOf("Unknown SID")>0?(this.m=3,$t(12)):(this.m=0,$t(13)),xs(this),Ec(this)}}}catch{}};function OO(c){if(!Y1(c))return c.g.la();let f=pS(c.g);if(f==="")return"";let m="",T=f.length,V=Po(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return xs(c),Ec(c),"";c.h.i=new s.TextDecoder}for(let B=0;B<T;B++)c.h.h=!0,m+=c.h.i.decode(f[B],{stream:!(V&&B==T-1)});return f.length=0,c.h.g+=m,c.C=0,c.h.g}function Y1(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function FO(c,f){var m=c.C,T=f.indexOf(`
`,m);return T==-1?R0:(m=Number(f.substring(m,T)),isNaN(m)?q1:(T+=1,T+m>f.length?R0:(f=f.slice(T,T+m),c.C=T+m,f)))}Pt.prototype.cancel=function(){this.K=!0,xs(this)};function rh(c){c.T=Date.now()+c.H,Q1(c,c.H)}function Q1(c,f){if(c.D!=null)throw Error("WatchDog timer not null");c.D=$r(u(c.aa,c),f)}function N0(c){c.D&&(s.clearTimeout(c.D),c.D=null)}Pt.prototype.aa=function(){this.D=null;let c=Date.now();c-this.T>=0?(A0(this.i,this.B),this.M!=2&&(ri(),$t(17)),xs(this),this.m=2,Ec(this)):Q1(this,this.T-c)};function Ec(c){c.j.I==0||c.K||bS(c.j,c)}function xs(c){N0(c);var f=c.O;f&&typeof f.dispose=="function"&&f.dispose(),c.O=null,L(c.V),c.g&&(f=c.g,c.g=null,f.abort(),f.dispose())}function k0(c,f){try{var m=c.j;if(m.I!=0&&(m.g==c||O0(m.h,c))){if(!c.L&&O0(m.h,c)&&m.I==3){try{var T=m.Ba.g.parse(f)}catch{T=null}if(Array.isArray(T)&&T.length==3){var V=T;if(V[0]==0){e:if(!m.v){if(m.g)if(m.g.F+3e3<c.F)dh(m),ch(m);else break e;B0(m),$t(18)}}else m.xa=V[1],0<m.xa-m.K&&V[2]<37500&&m.F&&m.A==0&&!m.C&&(m.C=$r(u(m.Va,m),6e3));X1(m.h)<=1&&m.ta&&(m.ta=void 0)}else Is(m,11)}else if((c.L||m.g==c)&&dh(m),!M(f))for(V=m.Ba.g.parse(f),f=0;f<V.length;f++){let Tt=V[f],wn=Tt[0];if(!(wn<=m.K))if(m.K=wn,Tt=Tt[1],m.I==2)if(Tt[0]=="c"){m.M=Tt[1],m.ba=Tt[2];let lr=Tt[3];lr!=null&&(m.ka=lr,m.j.info("VER="+m.ka));let Ts=Tt[4];Ts!=null&&(m.za=Ts,m.j.info("SVER="+m.za));let No=Tt[5];No!=null&&typeof No=="number"&&No>0&&(T=1.5*No,m.O=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;let ko=c.g;if(ko){let fh=ko.g?ko.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fh){var B=T.h;B.g||fh.indexOf("spdy")==-1&&fh.indexOf("quic")==-1&&fh.indexOf("h2")==-1||(B.j=B.l,B.g=new Set,B.h&&(F0(B,B.h),B.h=null))}if(T.G){let H0=ko.g?ko.g.getResponseHeader("X-HTTP-Session-Id"):null;H0&&(T.wa=H0,Nt(T.J,T.G,H0))}}m.I=3,m.l&&m.l.ra(),m.aa&&(m.T=Date.now()-c.F,m.j.info("Handshake RTT: "+m.T+"ms")),T=m;var de=c;if(T.na=SS(T,T.L?T.ba:null,T.W),de.L){eS(T.h,de);var Je=de,mn=T.O;mn&&(Je.H=mn),Je.D&&(N0(Je),rh(Je)),T.g=de}else _S(T);m.i.length>0&&uh(m)}else Tt[0]!="stop"&&Tt[0]!="close"||Is(m,7);else m.I==3&&(Tt[0]=="stop"||Tt[0]=="close"?Tt[0]=="stop"?Is(m,7):U0(m):Tt[0]!="noop"&&m.l&&m.l.qa(Tt),m.A=0)}}ri(4)}catch{}}var LO=class{constructor(c,f){this.g=c,this.map=f}};function J1(c){this.l=c||10,s.PerformanceNavigationTiming?(c=s.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Z1(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function X1(c){return c.h?1:c.g?c.g.size:0}function O0(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function F0(c,f){c.g?c.g.add(f):c.h=f}function eS(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}J1.prototype.cancel=function(){if(this.i=tS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function tS(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let f=c.i;for(let m of c.g.values())f=f.concat(m.G);return f}return g(c.i)}var nS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function VO(c,f){if(c){c=c.split("&");for(let m=0;m<c.length;m++){let T=c[m].indexOf("="),V,B=null;T>=0?(V=c[m].substring(0,T),B=c[m].substring(T+1)):V=c[m],f(V,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function Mo(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;c instanceof Mo?(this.l=c.l,bc(this,c.j),this.o=c.o,this.g=c.g,wc(this,c.u),this.h=c.h,L0(this,lS(c.i)),this.m=c.m):c&&(f=String(c).match(nS))?(this.l=!1,bc(this,f[1]||"",!0),this.o=xc(f[2]||""),this.g=xc(f[3]||"",!0),wc(this,f[4]),this.h=xc(f[5]||"",!0),L0(this,f[6]||"",!0),this.m=xc(f[7]||"")):(this.l=!1,this.i=new Ic(null,this.l))}Mo.prototype.toString=function(){let c=[];var f=this.j;f&&c.push(Sc(f,iS,!0),":");var m=this.g;return(m||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Sc(f,iS,!0),"@"),c.push(Rt(m).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.u,m!=null&&c.push(":",String(m))),(m=this.h)&&(this.g&&m.charAt(0)!="/"&&c.push("/"),c.push(Sc(m,m.charAt(0)=="/"?jO:BO,!0))),(m=this.i.toString())&&c.push("?",m),(m=this.m)&&c.push("#",Sc(m,$O)),c.join("")},Mo.prototype.resolve=function(c){let f=ar(this),m=!!c.j;m?bc(f,c.j):m=!!c.o,m?f.o=c.o:m=!!c.g,m?f.g=c.g:m=c.u!=null;var T=c.h;if(m)wc(f,c.u);else if(m=!!c.h){if(T.charAt(0)!="/")if(this.g&&!this.h)T="/"+T;else{var V=f.h.lastIndexOf("/");V!=-1&&(T=f.h.slice(0,V+1)+T)}if(V=T,V==".."||V==".")T="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){T=V.lastIndexOf("/",0)==0,V=V.split("/");let B=[];for(let de=0;de<V.length;){let Je=V[de++];Je=="."?T&&de==V.length&&B.push(""):Je==".."?((B.length>1||B.length==1&&B[0]!="")&&B.pop(),T&&de==V.length&&B.push("")):(B.push(Je),T=!0)}T=B.join("/")}else T=V}return m?f.h=T:m=c.i.toString()!=="",m?L0(f,lS(c.i)):m=!!c.m,m&&(f.m=c.m),f};function ar(c){return new Mo(c)}function bc(c,f,m){c.j=m?xc(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function wc(c,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);c.u=f}else c.u=null}function L0(c,f,m){f instanceof Ic?(c.i=f,GO(c.i,c.l)):(m||(f=Sc(f,HO)),c.i=new Ic(f,c.l))}function Nt(c,f,m){c.i.set(f,m)}function oh(c){return Nt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function xc(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Sc(c,f,m){return typeof c=="string"?(c=encodeURI(c).replace(f,UO),m&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function UO(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var iS=/[#\/\?@]/g,BO=/[#\?:]/g,jO=/[#\?]/g,HO=/[#\?@]/g,$O=/#/g;function Ic(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Ss(c){c.g||(c.g=new Map,c.h=0,c.i&&VO(c.i,function(f,m){c.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Ic.prototype,n.add=function(c,f){Ss(this),this.i=null,c=Fa(this,c);let m=this.g.get(c);return m||this.g.set(c,m=[]),m.push(f),this.h+=1,this};function rS(c,f){Ss(c),f=Fa(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function oS(c,f){return Ss(c),f=Fa(c,f),c.g.has(f)}n.forEach=function(c,f){Ss(this),this.g.forEach(function(m,T){m.forEach(function(V){c.call(f,V,T,this)},this)},this)};function sS(c,f){Ss(c);let m=[];if(typeof f=="string")oS(c,f)&&(m=m.concat(c.g.get(Fa(c,f))));else for(c=Array.from(c.g.values()),f=0;f<c.length;f++)m=m.concat(c[f]);return m}n.set=function(c,f){return Ss(this),this.i=null,c=Fa(this,c),oS(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},n.get=function(c,f){return c?(c=sS(this,c),c.length>0?String(c[0]):f):f};function aS(c,f,m){rS(c,f),m.length>0&&(c.i=null,c.g.set(Fa(c,f),g(m)),c.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],f=Array.from(this.g.keys());for(let T=0;T<f.length;T++){var m=f[T];let V=Rt(m);m=sS(this,m);for(let B=0;B<m.length;B++){let de=V;m[B]!==""&&(de+="="+Rt(m[B])),c.push(de)}}return this.i=c.join("&")};function lS(c){let f=new Ic;return f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),f}function Fa(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function GO(c,f){f&&!c.j&&(Ss(c),c.i=null,c.g.forEach(function(m,T){let V=T.toLowerCase();T!=V&&(rS(this,T),aS(this,V,m))},c)),c.j=f}function zO(c,f){let m=new Gr;if(s.Image){let T=new Image;T.onload=d(Ro,m,"TestLoadImage: loaded",!0,f,T),T.onerror=d(Ro,m,"TestLoadImage: error",!1,f,T),T.onabort=d(Ro,m,"TestLoadImage: abort",!1,f,T),T.ontimeout=d(Ro,m,"TestLoadImage: timeout",!1,f,T),s.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=c}else f(!1)}function WO(c,f){let m=new Gr,T=new AbortController,V=setTimeout(()=>{T.abort(),Ro(m,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:T.signal}).then(B=>{clearTimeout(V),B.ok?Ro(m,"TestPingServer: ok",!0,f):Ro(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),Ro(m,"TestPingServer: error",!1,f)})}function Ro(c,f,m,T,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),T(m)}catch{}}function qO(){this.g=new Te}function sh(c){this.i=c.Sb||null,this.h=c.ab||!1}h(sh,Le),sh.prototype.g=function(){return new ah(this.i,this.h)};function ah(c,f){An.call(this),this.H=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(ah,An),n=ah.prototype,n.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=f,this.readyState=1,Cc(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(f.body=c),(this.H||s).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Tc(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Cc(this)),this.g&&(this.readyState=3,Cc(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;cS(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function cS(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?Tc(this):Cc(this),this.readyState==3&&cS(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,Tc(this))},n.Na=function(c){this.g&&(this.response=c,Tc(this))},n.ga=function(){this.g&&Tc(this)};function Tc(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Cc(c)}n.setRequestHeader=function(c,f){this.A.append(c,f)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,c.push(m[0]+": "+m[1]),m=f.next();return c.join(`\r
`)};function Cc(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ah.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function uS(c){let f="";return Ae(c,function(m,T){f+=T,f+=":",f+=m,f+=`\r
`}),f}function V0(c,f,m){e:{for(T in m){var T=!1;break e}T=!0}T||(m=uS(m),typeof c=="string"?m!=null&&Rt(m):Nt(c,f,m))}function Gt(c){An.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Gt,An);var KO=/^https?$/i,YO=["POST","PUT"];n=Gt.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,f,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ct.g(),this.g.onreadystatechange=p(u(this.Ca,this));try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(B){dS(this,B);return}if(c=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var V in T)m.set(V,T[V]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(let B of T.keys())m.set(B,T.get(B));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(B=>B.toLowerCase()=="content-type"),V=s.FormData&&c instanceof s.FormData,!(Array.prototype.indexOf.call(YO,f,void 0)>=0)||T||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[B,de]of m)this.g.setRequestHeader(B,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(B){dS(this,B)}};function dS(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.o=5,hS(c),lh(c)}function hS(c){c.A||(c.A=!0,Mt(c,"complete"),Mt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,Mt(this,"complete"),Mt(this,"abort"),lh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),lh(this,!0)),Gt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?fS(this):this.Xa())},n.Xa=function(){fS(this)};function fS(c){if(c.h&&typeof o<"u"){if(c.v&&Po(c)==4)setTimeout(c.Ca.bind(c),0);else if(Mt(c,"readystatechange"),Po(c)==4){c.h=!1;try{let B=c.ca();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var T;if(T=B===0){let de=String(c.D).match(nS)[1]||null;!de&&s.self&&s.self.location&&(de=s.self.location.protocol.slice(0,-1)),T=!KO.test(de?de.toLowerCase():"")}m=T}if(m)Mt(c,"complete"),Mt(c,"success");else{c.o=6;try{var V=Po(c)>2?c.g.statusText:""}catch{V=""}c.l=V+" ["+c.ca()+"]",hS(c)}}finally{lh(c)}}}}function lh(c,f){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);let m=c.g;c.g=null,f||Mt(c,"ready");try{m.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Po(c){return c.g?c.g.readyState:0}n.ca=function(){try{return Po(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),Z(f)}};function pS(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function QO(c){let f={};c=(c.g&&Po(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<c.length;T++){if(M(c[T]))continue;var m=bn(c[T]);let V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let B=f[V]||[];f[V]=B,B.push(m)}Ht(f,function(T){return T.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Dc(c,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[c]||f}function gS(c){this.za=0,this.i=[],this.j=new Gr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Dc("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Dc("baseRetryDelayMs",5e3,c),this.Za=Dc("retryDelaySeedMs",1e4,c),this.Ta=Dc("forwardChannelMaxRetries",2,c),this.va=Dc("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new J1(c&&c.concurrentRequestLimit),this.Ba=new qO,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=gS.prototype,n.ka=8,n.I=1,n.connect=function(c,f,m,T){$t(0),this.W=c,this.H=f||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.J=SS(this,null,this.W),uh(this)};function U0(c){if(mS(c),c.I==3){var f=c.V++,m=ar(c.J);if(Nt(m,"SID",c.M),Nt(m,"RID",f),Nt(m,"TYPE","terminate"),Ac(c,m),f=new Pt(c,c.j,f),f.M=2,f.A=oh(ar(m)),m=!1,s.navigator&&s.navigator.sendBeacon)try{m=s.navigator.sendBeacon(f.A.toString(),"")}catch{}!m&&s.Image&&(new Image().src=f.A,m=!0),m||(f.g=IS(f.j,null),f.g.ea(f.A)),f.F=Date.now(),rh(f)}xS(c)}function ch(c){c.g&&(j0(c),c.g.cancel(),c.g=null)}function mS(c){ch(c),c.v&&(s.clearTimeout(c.v),c.v=null),dh(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&s.clearTimeout(c.m),c.m=null)}function uh(c){if(!Z1(c.h)&&!c.m){c.m=!0;var f=c.Ea;De||I(),Ie||(De(),Ie=!0),k.add(f,c),c.D=0}}function JO(c,f){return X1(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=f.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=$r(u(c.Ea,c,f),wS(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;let V=new Pt(this,this.j,c),B=this.o;if(this.U&&(B?(B=at(B),ne(B,this.U)):B=this.U),this.u!==null||this.R||(V.J=B,B=null),this.S)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(f+=T,f>4096){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=vS(this,V,f),m=ar(this.J),Nt(m,"RID",c),Nt(m,"CVER",22),this.G&&Nt(m,"X-HTTP-Session-Id",this.G),Ac(this,m),B&&(this.R?f="headers="+Rt(uS(B))+"&"+f:this.u&&V0(m,this.u,B)),F0(this.h,V),this.Ra&&Nt(m,"TYPE","init"),this.S?(Nt(m,"$req",f),Nt(m,"SID","null"),V.U=!0,P0(V,m,null)):P0(V,m,f),this.I=2}}else this.I==3&&(c?yS(this,c):this.i.length==0||Z1(this.h)||yS(this))};function yS(c,f){var m;f?m=f.l:m=c.V++;let T=ar(c.J);Nt(T,"SID",c.M),Nt(T,"RID",m),Nt(T,"AID",c.K),Ac(c,T),c.u&&c.o&&V0(T,c.u,c.o),m=new Pt(c,c.j,m,c.D+1),c.u===null&&(m.J=c.o),f&&(c.i=f.G.concat(c.i)),f=vS(c,m,1e3),m.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),F0(c.h,m),P0(m,T,f)}function Ac(c,f){c.H&&Ae(c.H,function(m,T){Nt(f,T,m)}),c.l&&Ae({},function(m,T){Nt(f,T,m)})}function vS(c,f,m){m=Math.min(c.i.length,m);let T=c.l?u(c.l.Ka,c.l,c):null;e:{var V=c.i;let Je=-1;for(;;){let mn=["count="+m];Je==-1?m>0?(Je=V[0].g,mn.push("ofs="+Je)):Je=0:mn.push("ofs="+Je);let Tt=!0;for(let wn=0;wn<m;wn++){var B=V[wn].g;let lr=V[wn].map;if(B-=Je,B<0)Je=Math.max(0,V[wn].g-100),Tt=!1;else try{B="req"+B+"_"||"";try{var de=lr instanceof Map?lr:Object.entries(lr);for(let[Ts,No]of de){let ko=No;a(No)&&(ko=Y(No)),mn.push(B+Ts+"="+encodeURIComponent(ko))}}catch(Ts){throw mn.push(B+"type="+encodeURIComponent("_badmap")),Ts}}catch{T&&T(lr)}}if(Tt){de=mn.join("&");break e}}de=void 0}return c=c.i.splice(0,m),f.G=c,de}function _S(c){if(!c.g&&!c.v){c.Y=1;var f=c.Da;De||I(),Ie||(De(),Ie=!0),k.add(f,c),c.A=0}}function B0(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=$r(u(c.Da,c),wS(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,ES(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=$r(u(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,$t(10),ch(this),ES(this))};function j0(c){c.B!=null&&(s.clearTimeout(c.B),c.B=null)}function ES(c){c.g=new Pt(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var f=ar(c.na);Nt(f,"RID","rpc"),Nt(f,"SID",c.M),Nt(f,"AID",c.K),Nt(f,"CI",c.F?"0":"1"),!c.F&&c.ia&&Nt(f,"TO",c.ia),Nt(f,"TYPE","xmlhttp"),Ac(c,f),c.u&&c.o&&V0(f,c.u,c.o),c.O&&(c.g.H=c.O);var m=c.g;c=c.ba,m.M=1,m.A=oh(ar(f)),m.u=null,m.R=!0,K1(m,c)}n.Va=function(){this.C!=null&&(this.C=null,ch(this),B0(this),$t(19))};function dh(c){c.C!=null&&(s.clearTimeout(c.C),c.C=null)}function bS(c,f){var m=null;if(c.g==f){dh(c),j0(c),c.g=null;var T=2}else if(O0(c.h,f))m=f.G,eS(c.h,f),T=1;else return;if(c.I!=0){if(f.o)if(T==1){m=f.u?f.u.length:0,f=Date.now()-f.F;var V=c.D;T=Oa(),Mt(T,new ih(T,m)),uh(c)}else _S(c);else if(V=f.m,V==3||V==0&&f.X>0||!(T==1&&JO(c,f)||T==2&&B0(c)))switch(m&&m.length>0&&(f=c.h,f.i=f.i.concat(m)),V){case 1:Is(c,5);break;case 4:Is(c,10);break;case 3:Is(c,6);break;default:Is(c,2)}}}function wS(c,f){let m=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(m*=2),m*f}function Is(c,f){if(c.j.info("Error code "+f),f==2){var m=u(c.bb,c),T=c.Ua;let V=!T;T=new Mo(T||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||bc(T,"https"),oh(T),V?zO(T.toString(),m):WO(T.toString(),m)}else $t(2);c.I=0,c.l&&c.l.pa(f),xS(c),mS(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),$t(2)):(this.j.info("Failed to ping google.com"),$t(1))};function xS(c){if(c.I=0,c.ja=[],c.l){let f=tS(c.h);(f.length!=0||c.i.length!=0)&&(x(c.ja,f),x(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function SS(c,f,m){var T=m instanceof Mo?ar(m):new Mo(m);if(T.g!="")f&&(T.g=f+"."+T.g),wc(T,T.u);else{var V=s.location;T=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;let B=new Mo(null);T&&bc(B,T),f&&(B.g=f),V&&wc(B,V),m&&(B.h=m),T=B}return m=c.G,f=c.wa,m&&f&&Nt(T,m,f),Nt(T,"VER",c.ka),Ac(c,T),T}function IS(c,f,m){if(f&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Aa&&!c.ma?new Gt(new sh({ab:m})):new Gt(c.ma),f.Fa(c.L),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function TS(){}n=TS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function hh(){}hh.prototype.g=function(c,f){return new oi(c,f)};function oi(c,f){An.call(this),this.g=new gS(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(c?c["X-WebChannel-Client-Profile"]=f.sa:c={"X-WebChannel-Client-Profile":f.sa}),this.g.U=c,(c=f&&f.Qb)&&!M(c)&&(this.g.u=c),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!M(f)&&(this.g.G=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new La(this)}h(oi,An),oi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},oi.prototype.close=function(){U0(this.g)},oi.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var m={};m.__data__=c,c=m}else this.v&&(m={},m.__data__=Y(c),c=m);f.i.push(new LO(f.Ya++,c)),f.I==3&&uh(f)},oi.prototype.N=function(){this.g.l=null,delete this.j,U0(this.g),delete this.g,oi.Z.N.call(this)};function CS(c){wt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(let m in f){c=m;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}h(CS,wt);function DS(){mt.call(this),this.status=1}h(DS,mt);function La(c){this.g=c}h(La,TS),La.prototype.ra=function(){Mt(this.g,"a")},La.prototype.qa=function(c){Mt(this.g,new CS(c))},La.prototype.pa=function(c){Mt(this.g,new DS)},La.prototype.oa=function(){Mt(this.g,"b")},hh.prototype.createWebChannel=hh.prototype.g,oi.prototype.send=oi.prototype.o,oi.prototype.open=oi.prototype.m,oi.prototype.close=oi.prototype.close,Kb=ho.createWebChannelTransport=function(){return new hh},qb=ho.getStatEventTarget=function(){return Oa()},Wb=ho.Event=En,Bg=ho.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,fd=ho.ErrorCode=be,He.COMPLETE="complete",zb=ho.EventType=He,Xe.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",An.prototype.listen=An.prototype.J,Pl=ho.WebChannel=Xe,S9=ho.FetchXmlHttpFactory=sh,Gt.prototype.listenOnce=Gt.prototype.K,Gt.prototype.getLastError=Gt.prototype.Ha,Gt.prototype.getLastErrorCode=Gt.prototype.ya,Gt.prototype.getStatus=Gt.prototype.ca,Gt.prototype.getResponseJson=Gt.prototype.La,Gt.prototype.getResponseText=Gt.prototype.la,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Fa,Gb=ho.XhrIo=Gt}).apply(typeof Ug<"u"?Ug:typeof self<"u"?self:typeof window<"u"?window:{});var Cn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Cn.UNAUTHENTICATED=new Cn(null),Cn.GOOGLE_CREDENTIALS=new Cn("google-credentials-uid"),Cn.FIRST_PARTY=new Cn("first-party-uid"),Cn.MOCK_USER=new Cn("mock-user");var Yl="12.8.0";function vP(n){Yl=n}var ya=new os("@firebase/firestore");function Nl(){return ya.logLevel}function we(n,...e){if(ya.logLevel<=tt.DEBUG){let t=e.map(Dx);ya.debug(`Firestore (${Yl}): ${n}`,...t)}}function go(n,...e){if(ya.logLevel<=tt.ERROR){let t=e.map(Dx);ya.error(`Firestore (${Yl}): ${n}`,...t)}}function us(n,...e){if(ya.logLevel<=tt.WARN){let t=e.map(Dx);ya.warn(`Firestore (${Yl}): ${n}`,...t)}}function Dx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ke(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,_P(n,i,t)}function _P(n,e,t){let i=`FIRESTORE (${Yl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw go(i),new Error(i)}function Et(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||_P(e,r,i)}function ze(n,e){return n}var q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ue=class extends vi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Rr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var qg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Kg=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Cn.UNAUTHENTICATED))}shutdown(){}},ew=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Yg=class{constructor(e){this.t=e,this.currentUser=Cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Et(this.o===void 0,42304);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),o=new Rr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Rr,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Rr)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Et(typeof i.accessToken=="string",31837,{l:i}),new qg(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new Cn(e)}},tw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Cn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},nw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new tw(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Qg=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Jg=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_i(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Et(this.o===void 0,3512);let i=o=>{o.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,we("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Qg(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Et(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Qg(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function I9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var va=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=I9(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}};function rt(n,e){return n<e?-1:n>e?1:0}function iw(n,e){let t=Math.min(n.length,e.length);for(let i=0;i<t;i++){let r=n.charAt(i),o=e.charAt(i);if(r!==o)return Yb(r)===Yb(o)?rt(r,o):Yb(r)?1:-1}return rt(n.length,e.length)}var T9=55296,C9=57343;function Yb(n){let e=n.charCodeAt(0);return e>=T9&&e<=C9}function Ul(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var N2="__name__",Zg=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&ke(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ke(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return rt(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):iw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return uo.fromString(e.substring(4,e.length-2))}},At=class n extends Zg{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new ue(q.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},D9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ti=class n extends Zg{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return D9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===N2}static keyField(){return new n([N2])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new ue(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new ue(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ue(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(s=!s,r++):a!=="."||s?(i+=a,r++):(o(),r++)}if(o(),s)throw new ue(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Pe=class n{constructor(e){this.path=e}static fromPath(e){return new n(At.fromString(e))}static fromName(e){return new n(At.fromString(e).popFirst(5))}static empty(){return new n(At.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&At.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return At.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new At(e.slice()))}};function EP(n,e,t){if(!t)throw new ue(q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function bP(n,e,t,i){if(e===!0&&i===!0)throw new ue(q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function k2(n){if(!Pe.isDocumentKey(n))throw new ue(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function O2(n){if(Pe.isDocumentKey(n))throw new ue(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function wP(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Pd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ke(12329,{type:typeof n})}function Ql(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Pd(n);throw new ue(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function xP(n,e){if(e<=0)throw new ue(q.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function sn(n,e){let t={typeString:n};return e&&(t.value=e),t}function Jl(n,e){if(!wP(n))throw new ue(q.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let s=n[i];if(r&&typeof s!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new ue(q.INVALID_ARGUMENT,t);return!0}var F2=-62135596800,L2=1e6,an=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*L2);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<F2)throw new ue(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/L2}_compareTo(e){return this.seconds===e.seconds?rt(this.nanoseconds,e.nanoseconds):rt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Jl(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-F2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};an._jsonSchemaVersion="firestore/timestamp/1.0",an._jsonSchema={type:sn("string",an._jsonSchemaVersion),seconds:sn("number"),nanoseconds:sn("number")};var Qe=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new an(0,0))}static max(){return new n(new an(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var _d=-1,Xg=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};Xg.UNKNOWN_ID=-1;function A9(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new an(t+1,0):new an(t,i));return new _a(r,Pe.empty(),e)}function M9(n){return new _a(n.readTime,n.key,_d)}var _a=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Qe.min(),Pe.empty(),_d)}static max(){return new n(Qe.max(),Pe.empty(),_d)}};function R9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Pe.comparator(n.documentKey,e.documentKey),t!==0?t:rt(n.largestBatchId,e.largestBatchId))}var P9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",rw=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Zl(n){if(n.code!==q.FAILED_PRECONDITION||n.message!==P9)throw n;we("LocalStore","Unexpectedly lost primary lease")}var ee=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(a=>{++r,a.next(()=>{++o,s&&o===r&&t()},l=>i(l))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let u=l;t(e[u]).next(d=>{s[u]=d,++a,a===o&&i(s)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};function N9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Xl(n){return n.name==="IndexedDbTransactionError"}var Ax=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Mx=-1;function Tm(n){return n==null}function Ed(n){return n===0&&1/n==-1/0}function k9(n){return typeof n=="number"&&Number.isInteger(n)&&!Ed(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var SP="";function O9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=V2(e)),e=F9(n.get(t),e);return V2(e)}function F9(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case SP:t+="";break;default:t+=o}}return t}function V2(n){return n+SP+""}var L9="remoteDocuments",IP="owner";var TP="mutationQueues";var CP="mutations";var DP="documentMutations",V9="remoteDocumentsV14";var AP="remoteDocumentGlobal";var MP="targets";var RP="targetDocuments";var PP="targetGlobal",NP="collectionParents";var kP="clientMetadata";var OP="bundles";var FP="namedQueries";var U9="indexConfiguration";var B9="indexState";var j9="indexEntries";var LP="documentOverlays";var H9="globals";var $9=[TP,CP,DP,L9,MP,IP,PP,RP,kP,AP,NP,OP,FP],$ue=[...$9,LP],G9=[TP,CP,DP,V9,MP,IP,PP,RP,kP,AP,NP,OP,FP,LP],z9=G9,W9=[...z9,U9,B9,j9];var Gue=[...W9,H9];function U2(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ca(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function VP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Jt=class n{constructor(e,t){this.comparator=e,this.root=t||Pr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Pr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ll(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ll(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ll(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ll(this.root,e,this.comparator,!0)}},Ll=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Pr=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ke(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw ke(27949);return e+(this.isRed()?0:1)}};Pr.EMPTY=null,Pr.RED=!0,Pr.BLACK=!1;Pr.EMPTY=new class{constructor(){this.size=0}get key(){throw ke(57766)}get value(){throw ke(16141)}get color(){throw ke(16727)}get left(){throw ke(29726)}get right(){throw ke(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Pr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Dn=class n{constructor(e){this.comparator=e,this.data=new Jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new em(this.data.getIterator())}getIteratorFrom(e){return new em(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},em=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Mr=class n{constructor(e){this.fields=e,e.sort(ti.comparator)}static empty(){return new n([])}unionWith(e){let t=new Dn(ti.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ul(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var tm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var On=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new tm("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};On.EMPTY_BYTE_STRING=new On("");var q9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mo(n){if(Et(!!n,39018),typeof n=="string"){let e=0,t=q9.exec(n);if(Et(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Bt(n.seconds),nanos:Bt(n.nanos)}}function Bt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function yo(n){return typeof n=="string"?On.fromBase64String(n):On.fromUint8Array(n)}var UP="server_timestamp",BP="__type__",jP="__previous_value__",HP="__local_write_time__";function Nd(n){return(n?.mapValue?.fields||{})[BP]?.stringValue===UP}function Cm(n){let e=n.mapValue.fields[jP];return Nd(e)?Cm(e):e}function bd(n){let e=mo(n.mapValue.fields[HP].timestampValue);return new an(e.seconds,e.nanos)}var ow=class{constructor(e,t,i,r,o,s,a,l,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=d,this.apiKey=h}},nm="(default)",wd=class n{constructor(e,t){this.projectId=e,this.database=t||nm}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===nm}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function $P(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ue(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wd(n.options.projectId,e)}var Rx="__type__",GP="__max__",jg={mapValue:{fields:{__type__:{stringValue:GP}}}},Px="__vector__",Bl="value";function ds(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Nd(n)?4:WP(n)?9007199254740991:zP(n)?10:11:ke(28295,{value:n})}function Lr(n,e){if(n===e)return!0;let t=ds(n);if(t!==ds(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return bd(n).isEqual(bd(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=mo(r.timestampValue),a=mo(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return yo(r.bytesValue).isEqual(yo(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return Bt(r.geoPointValue.latitude)===Bt(o.geoPointValue.latitude)&&Bt(r.geoPointValue.longitude)===Bt(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return Bt(r.integerValue)===Bt(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=Bt(r.doubleValue),a=Bt(o.doubleValue);return s===a?Ed(s)===Ed(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Ul(n.arrayValue.values||[],e.arrayValue.values||[],Lr);case 10:case 11:return(function(r,o){let s=r.mapValue.fields||{},a=o.mapValue.fields||{};if(U2(s)!==U2(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Lr(s[l],a[l])))return!1;return!0})(n,e);default:return ke(52216,{left:n})}}function xd(n,e){return(n.values||[]).find(t=>Lr(t,e))!==void 0}function jl(n,e){if(n===e)return 0;let t=ds(n),i=ds(e);if(t!==i)return rt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return rt(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=Bt(o.integerValue||o.doubleValue),l=Bt(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return B2(n.timestampValue,e.timestampValue);case 4:return B2(bd(n),bd(e));case 5:return iw(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=yo(o),l=yo(s);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),l=s.split("/");for(let u=0;u<a.length&&u<l.length;u++){let d=rt(a[u],l[u]);if(d!==0)return d}return rt(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=rt(Bt(o.latitude),Bt(s.latitude));return a!==0?a:rt(Bt(o.longitude),Bt(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return j2(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},l=s.fields||{},u=a[Bl]?.arrayValue,d=l[Bl]?.arrayValue,h=rt(u?.values?.length||0,d?.values?.length||0);return h!==0?h:j2(u,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===jg.mapValue&&s===jg.mapValue)return 0;if(o===jg.mapValue)return 1;if(s===jg.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),u=s.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let p=iw(l[h],d[h]);if(p!==0)return p;let g=jl(a[l[h]],u[d[h]]);if(g!==0)return g}return rt(l.length,d.length)})(n.mapValue,e.mapValue);default:throw ke(23264,{he:t})}}function B2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return rt(n,e);let t=mo(n),i=mo(e),r=rt(t.seconds,i.seconds);return r!==0?r:rt(t.nanos,i.nanos)}function j2(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=jl(t[r],i[r]);if(o)return o}return rt(t.length,i.length)}function Hl(n){return sw(n)}function sw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=mo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return yo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=sw(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${sw(t.fields[s])}`;return r+"}"})(n.mapValue):ke(61005,{value:n})}function Gg(n){switch(ds(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Cm(n);return e?16+Gg(e):16;case 5:return 2*n.stringValue.length;case 6:return yo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,o)=>r+Gg(o),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ca(i.fields,(o,s)=>{r+=o.length+Gg(s)}),r})(n.mapValue);default:throw ke(13486,{value:n})}}function kd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function aw(n){return!!n&&"integerValue"in n}function Nx(n){return!!n&&"arrayValue"in n}function H2(n){return!!n&&"nullValue"in n}function $2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function zg(n){return!!n&&"mapValue"in n}function zP(n){return(n?.mapValue?.fields||{})[Rx]?.stringValue===Px}function md(n){if(n.geoPointValue)return{geoPointValue:F({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:F({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ca(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=md(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=md(n.arrayValue.values[t]);return e}return F({},n)}function WP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===GP}var Wue={mapValue:{fields:{[Rx]:{stringValue:Px},[Bl]:{arrayValue:{}}}}};var ki=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!zg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=md(t)}setAll(e){let t=ti.emptyPath(),i={},r=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}s?i[a.lastSegment()]=md(s):r.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());zg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Lr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];zg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ca(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(md(this.value))}};function qP(n){let e=[];return Ca(n.fields,(t,i)=>{let r=new ti([t]);if(zg(i)){let o=qP(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new Mr(e)}var nr=class n{constructor(e,t,i,r,o,s,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Qe.min(),Qe.min(),Qe.min(),ki.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Qe.min(),Qe.min(),ki.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Qe.min(),Qe.min(),ki.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ki.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ki.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var vo=class{constructor(e,t){this.position=e,this.inclusive=t}};function G2(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=Pe.comparator(Pe.fromName(s.referenceValue),t.key):i=jl(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function z2(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Lr(n.position[t],e.position[t]))return!1;return!0}var hs=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function K9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var im=class{},on=class n extends im{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new cw(e,t,i):t==="array-contains"?new hw(e,i):t==="in"?new fw(e,i):t==="not-in"?new pw(e,i):t==="array-contains-any"?new gw(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new uw(e,i):new dw(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(jl(t,this.value)):t!==null&&ds(this.value)===ds(t)&&this.matchesComparison(jl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Oi=class n extends im{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return KP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function KP(n){return n.op==="and"}function YP(n){return Y9(n)&&KP(n)}function Y9(n){for(let e of n.filters)if(e instanceof Oi)return!1;return!0}function lw(n){if(n instanceof on)return n.field.canonicalString()+n.op.toString()+Hl(n.value);if(YP(n))return n.filters.map(e=>lw(e)).join(",");{let e=n.filters.map(t=>lw(t)).join(",");return`${n.op}(${e})`}}function QP(n,e){return n instanceof on?(function(i,r){return r instanceof on&&i.op===r.op&&i.field.isEqual(r.field)&&Lr(i.value,r.value)})(n,e):n instanceof Oi?(function(i,r){return r instanceof Oi&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,a)=>o&&QP(s,r.filters[a]),!0):!1})(n,e):void ke(19439)}function JP(n){return n instanceof on?(function(t){return`${t.field.canonicalString()} ${t.op} ${Hl(t.value)}`})(n):n instanceof Oi?(function(t){return t.op.toString()+" {"+t.getFilters().map(JP).join(" ,")+"}"})(n):"Filter"}var cw=class extends on{constructor(e,t,i){super(e,t,i),this.key=Pe.fromName(i.referenceValue)}matches(e){let t=Pe.comparator(e.key,this.key);return this.matchesComparison(t)}},uw=class extends on{constructor(e,t){super(e,"in",t),this.keys=ZP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},dw=class extends on{constructor(e,t){super(e,"not-in",t),this.keys=ZP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function ZP(n,e){return(e.arrayValue?.values||[]).map(t=>Pe.fromName(t.referenceValue))}var hw=class extends on{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Nx(t)&&xd(t.arrayValue,this.value)}},fw=class extends on{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&xd(this.value.arrayValue,t)}},pw=class extends on{constructor(e,t){super(e,"not-in",t)}matches(e){if(xd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!xd(this.value.arrayValue,t)}},gw=class extends on{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Nx(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>xd(this.value.arrayValue,i))}};var mw=class{constructor(e,t=null,i=[],r=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function W2(n,e=null,t=[],i=[],r=null,o=null,s=null){return new mw(n,e,t,i,r,o,s)}function kx(n){let e=ze(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>lw(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(o){return o.field.canonicalString()+o.dir})(i)).join(","),Tm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Hl(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Hl(i)).join(",")),e.Te=t}return e.Te}function Ox(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!K9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!QP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!z2(n.startAt,e.startAt)&&z2(n.endAt,e.endAt)}function yw(n){return Pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var _o=class{constructor(e,t=null,i=[],r=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function Q9(n,e,t,i,r,o,s,a){return new _o(n,e,t,i,r,o,s,a)}function Fx(n){return new _o(n)}function q2(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function J9(n){return Pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Dm(n){return n.collectionGroup!==null}function ma(n){let e=ze(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Dn(ti.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new hs(o,i))}),t.has(ti.keyField().canonicalString())||e.Ie.push(new hs(ti.keyField(),i))}return e.Ie}function Nr(n){let e=ze(n);return e.Ee||(e.Ee=Z9(e,ma(n))),e.Ee}function Z9(n,e){if(n.limitType==="F")return W2(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new hs(r.field,o)});let t=n.endAt?new vo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new vo(n.startAt.position,n.startAt.inclusive):null;return W2(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Am(n,e){let t=n.filters.concat([e]);return new _o(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function XP(n,e){let t=n.explicitOrderBy.concat([e]);return new _o(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Sd(n,e,t){return new _o(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function eN(n,e){return new _o(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Mm(n,e){return Ox(Nr(n),Nr(e))&&n.limitType===e.limitType}function tN(n){return`${kx(Nr(n))}|lt:${n.limitType}`}function kl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>JP(r)).join(", ")}]`),Tm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Hl(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Hl(r)).join(",")),`Target(${i})`})(Nr(n))}; limitType=${n.limitType})`}function Rm(n,e){return e.isFoundDocument()&&(function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Pe.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(let o of ma(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(s,a,l){let u=G2(s,a,l);return s.inclusive?u<=0:u<0})(i.startAt,ma(i),r)||i.endAt&&!(function(s,a,l){let u=G2(s,a,l);return s.inclusive?u>=0:u>0})(i.endAt,ma(i),r))})(n,e)}function X9(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function nN(n){return(e,t)=>{let i=!1;for(let r of ma(n)){let o=eH(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function eH(n,e,t){let i=n.field.isKeyField()?Pe.comparator(e.key,t.key):(function(o,s,a){let l=s.data.field(o),u=a.data.field(o);return l!==null&&u!==null?jl(l,u):ke(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ke(19790,{direction:n.dir})}}var Eo=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ca(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return VP(this.inner)}size(){return this.innerSize}};var tH=new Jt(Pe.comparator);function bo(){return tH}var iN=new Jt(Pe.comparator);function gd(...n){let e=iN;for(let t of n)e=e.insert(t.key,t);return e}function rN(n){let e=iN;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function pa(){return yd()}function oN(){return yd()}function yd(){return new Eo(n=>n.toString(),(n,e)=>n.isEqual(e))}var nH=new Jt(Pe.comparator),iH=new Dn(Pe.comparator);function nt(...n){let e=iH;for(let t of n)e=e.add(t);return e}var rH=new Dn(rt);function oH(){return rH}function Lx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ed(e)?"-0":e}}function sN(n){return{integerValue:""+n}}function sH(n,e){return k9(e)?sN(e):Lx(n,e)}var $l=class{constructor(){this._=void 0}};function aH(n,e,t){return n instanceof Ea?(function(r,o){let s={fields:{[BP]:{stringValue:UP},[HP]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Nd(o)&&(o=Cm(o)),o&&(s.fields[jP]=o),{mapValue:s}})(t,e):n instanceof ba?lN(n,e):n instanceof wa?cN(n,e):(function(r,o){let s=aN(r,o),a=K2(s)+K2(r.Ae);return aw(s)&&aw(r.Ae)?sN(a):Lx(r.serializer,a)})(n,e)}function lH(n,e,t){return n instanceof ba?lN(n,e):n instanceof wa?cN(n,e):t}function aN(n,e){return n instanceof Gl?(function(i){return aw(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}var Ea=class extends $l{},ba=class extends $l{constructor(e){super(),this.elements=e}};function lN(n,e){let t=uN(e);for(let i of n.elements)t.some(r=>Lr(r,i))||t.push(i);return{arrayValue:{values:t}}}var wa=class extends $l{constructor(e){super(),this.elements=e}};function cN(n,e){let t=uN(e);for(let i of n.elements)t=t.filter(r=>!Lr(r,i));return{arrayValue:{values:t}}}var Gl=class extends $l{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function K2(n){return Bt(n.integerValue||n.doubleValue)}function uN(n){return Nx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var vw=class{constructor(e,t){this.field=e,this.transform=t}};function cH(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof ba&&r instanceof ba||i instanceof wa&&r instanceof wa?Ul(i.elements,r.elements,Lr):i instanceof Gl&&r instanceof Gl?Lr(i.Ae,r.Ae):i instanceof Ea&&r instanceof Ea})(n.transform,e.transform)}var _w=class{constructor(e,t){this.version=e,this.transformResults=t}},cs=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Wg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var zl=class{};function dN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Id(n.key,cs.none()):new xa(n.key,n.data,cs.none());{let t=n.data,i=ki.empty(),r=new Dn(ti.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new wo(n.key,i,new Mr(r.toArray()),cs.none())}}function uH(n,e,t){n instanceof xa?(function(r,o,s){let a=r.value.clone(),l=Q2(r.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof wo?(function(r,o,s){if(!Wg(r.precondition,o))return void o.convertToUnknownDocument(s.version);let a=Q2(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(hN(r)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):(function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function vd(n,e,t,i){return n instanceof xa?(function(o,s,a,l){if(!Wg(o.precondition,s))return a;let u=o.value.clone(),d=J2(o.fieldTransforms,l,s);return u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null})(n,e,t,i):n instanceof wo?(function(o,s,a,l){if(!Wg(o.precondition,s))return a;let u=J2(o.fieldTransforms,l,s),d=s.data;return d.setAll(hN(o)),d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,i):(function(o,s,a){return Wg(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function dH(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=aN(i.transform,r||null);o!=null&&(t===null&&(t=ki.empty()),t.set(i.field,o))}return t||null}function Y2(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Ul(i,r,(o,s)=>cH(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var xa=class extends zl{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},wo=class extends zl{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function hN(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function Q2(n,e,t){let i=new Map;Et(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,lH(s,a,t[r]))}return i}function J2(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,aH(o,s,e))}return i}var Id=class extends zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ew=class extends zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var bw=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&uH(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=vd(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=vd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=oN();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(r.key)?null:a;let l=dN(s,a);l!==null&&i.set(r.key,l),s.isValidDocument()||s.convertToNoDocument(Qe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nt())}isEqual(e){return this.batchId===e.batchId&&Ul(this.mutations,e.mutations,(t,i)=>Y2(t,i))&&Ul(this.baseMutations,e.baseMutations,(t,i)=>Y2(t,i))}},ww=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Et(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return nH})(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var xw=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Sw=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var pn,ct;function hH(n){switch(n){case q.OK:return ke(64938);case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0;default:return ke(15467,{code:n})}}function fN(n){if(n===void 0)return go("GRPC error has no .code"),q.UNKNOWN;switch(n){case pn.OK:return q.OK;case pn.CANCELLED:return q.CANCELLED;case pn.UNKNOWN:return q.UNKNOWN;case pn.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case pn.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case pn.INTERNAL:return q.INTERNAL;case pn.UNAVAILABLE:return q.UNAVAILABLE;case pn.UNAUTHENTICATED:return q.UNAUTHENTICATED;case pn.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case pn.NOT_FOUND:return q.NOT_FOUND;case pn.ALREADY_EXISTS:return q.ALREADY_EXISTS;case pn.PERMISSION_DENIED:return q.PERMISSION_DENIED;case pn.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case pn.ABORTED:return q.ABORTED;case pn.OUT_OF_RANGE:return q.OUT_OF_RANGE;case pn.UNIMPLEMENTED:return q.UNIMPLEMENTED;case pn.DATA_LOSS:return q.DATA_LOSS;default:return ke(39323,{code:n})}}(ct=pn||(pn={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";var fH=null;function pH(){return new TextEncoder}var gH=new uo([4294967295,4294967295],0);function Z2(n){let e=pH().encode(n),t=new $b;return t.update(e),new Uint8Array(t.digest())}function X2(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new uo([t,i],0),new uo([r,o],0)]}var Iw=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ga(`Invalid padding: ${t}`);if(i<0)throw new ga(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ga(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ga(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=uo.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(uo.fromNumber(i)));return r.compare(gH)===1&&(r=new uo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=Z2(e),[i,r]=X2(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);if(!this.we(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=Z2(e),[i,r]=X2(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);this.be(s)}}be(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},ga=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var rm=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Td.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Qe.min(),r,new Jt(rt),bo(),nt())}},Td=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,nt(),nt(),nt())}};var Vl=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}},om=class{constructor(e,t){this.targetId=e,this.Ce=t}},sm=class{constructor(e,t,i=On.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},am=class{constructor(){this.ve=0,this.Fe=eP(),this.Me=On.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),t=nt(),i=nt();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:ke(38017,{changeType:o})}}),new Td(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=eP()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},Tw=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=bo(),this.He=Hg(),this.Je=Hg(),this.Ze=new Jt(rt)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ke(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){let o=r.target;if(yw(o))if(i===0){let s=new Pe(o.path);this.et(t,s,nr.newNoDocument(s,Qe.min()))}else Et(i===1,20013,{expectedCount:i});else{let s=this._t(t);if(s!==i){let a=this.ut(e),l=a?this.ct(a,e,s):1;if(l!==0){this.it(t);let u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,u)}fH?.lt((function(d,h,p,g,x){let S={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},N=h.unchangedNames;return N&&(S.bloomFilter={applied:x===0,hashCount:N?.hashCount??0,bitmapLength:N?.bits?.bitmap?.length??0,padding:N?.bits?.padding??0,mightContain:U=>g?.mightContain(U)??!1}),S})(s,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,a;try{s=yo(i).toUint8Array()}catch(l){if(l instanceof tm)return us("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Iw(s,r,o)}catch(l){return us(l instanceof ga?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){let i=this.Ge.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),r++)}),r}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&yw(a.target)){let l=new Pe(a.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,nr.newNoDocument(l,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let i=nt();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let r=new rm(e,t,this.Ze,this.je,i);return this.je=bo(),this.He=Hg(),this.Je=Hg(),this.Ze=new Jt(rt),r}Ye(e,t){if(!this.rt(e))return;let i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new am,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Dn(rt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Dn(rt),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||we("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new am),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Hg(){return new Jt(Pe.comparator)}function eP(){return new Jt(Pe.comparator)}var mH={asc:"ASCENDING",desc:"DESCENDING"},yH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vH={and:"AND",or:"OR"},Cw=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Dw(n,e){return n.useProto3Json||Tm(e)?e:{value:e}}function lm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _H(n,e){return lm(n,e.toTimestamp())}function kr(n){return Et(!!n,49232),Qe.fromTimestamp((function(t){let i=mo(t);return new an(i.seconds,i.nanos)})(n))}function Vx(n,e){return Aw(n,e).canonicalString()}function Aw(n,e){let t=(function(r){return new At(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function gN(n){let e=At.fromString(n);return Et(EN(e),10190,{key:e.toString()}),e}function Mw(n,e){return Vx(n.databaseId,e.path)}function Qb(n,e){let t=gN(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Pe(yN(t))}function mN(n,e){return Vx(n.databaseId,e)}function EH(n){let e=gN(n);return e.length===4?At.emptyPath():yN(e)}function Rw(n){return new At(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yN(n){return Et(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function tP(n,e,t){return{name:Mw(n,e),fields:t.value.mapValue.fields}}function bH(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ke(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(u,d){return u.useProto3Json?(Et(d===void 0||typeof d=="string",58123),On.fromBase64String(d||"")):(Et(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),On.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(u){let d=u.code===void 0?q.UNKNOWN:fN(u.code);return new ue(d,u.message||"")})(s);t=new sm(i,r,o,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Qb(n,i.document.name),o=kr(i.document.updateTime),s=i.document.createTime?kr(i.document.createTime):Qe.min(),a=new ki({mapValue:{fields:i.document.fields}}),l=nr.newFoundDocument(r,o,s,a),u=i.targetIds||[],d=i.removedTargetIds||[];t=new Vl(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Qb(n,i.document),o=i.readTime?kr(i.readTime):Qe.min(),s=nr.newNoDocument(r,o),a=i.removedTargetIds||[];t=new Vl([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Qb(n,i.document),o=i.removedTargetIds||[];t=new Vl([],o,r,null)}else{if(!("filter"in e))return ke(11601,{Vt:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new Sw(r,o),a=i.targetId;t=new om(a,s)}}return t}function wH(n,e){let t;if(e instanceof xa)t={update:tP(n,e.key,e.value)};else if(e instanceof Id)t={delete:Mw(n,e.key)};else if(e instanceof wo)t={update:tP(n,e.key,e.data),updateMask:RH(e.fieldMask)};else{if(!(e instanceof Ew))return ke(16599,{dt:e.type});t={verify:Mw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(o,s){let a=s.transform;if(a instanceof Ea)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ba)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof wa)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Gl)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw ke(20930,{transform:s.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:_H(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ke(27497)})(n,e.precondition)),t}function xH(n,e){return n&&n.length>0?(Et(e!==void 0,14353),n.map(t=>(function(r,o){let s=r.updateTime?kr(r.updateTime):kr(o);return s.isEqual(Qe.min())&&(s=kr(o)),new _w(s,r.transformResults||[])})(t,e))):[]}function SH(n,e){return{documents:[mN(n,e.path)]}}function IH(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=mN(n,r);let o=(function(u){if(u.length!==0)return _N(Oi.create(u,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(u){if(u.length!==0)return u.map(d=>(function(p){return{field:Ol(p.field),direction:DH(p.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Dw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:r}}function TH(n){let e=EH(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){Et(i===1,65062);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let p=vN(h);return p instanceof Oi&&YP(p)?p.getFilters():[p]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(p=>(function(x){return new hs(Fl(x.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(p))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let p;return p=typeof h=="object"?h.value:h,Tm(p)?null:p})(t.limit));let l=null;t.startAt&&(l=(function(h){let p=!!h.before,g=h.values||[];return new vo(g,p)})(t.startAt));let u=null;return t.endAt&&(u=(function(h){let p=!h.before,g=h.values||[];return new vo(g,p)})(t.endAt)),Q9(e,r,s,o,a,"F",l,u)}function CH(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ke(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function vN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Fl(t.unaryFilter.field);return on.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Fl(t.unaryFilter.field);return on.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Fl(t.unaryFilter.field);return on.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Fl(t.unaryFilter.field);return on.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ke(61313);default:return ke(60726)}})(n):n.fieldFilter!==void 0?(function(t){return on.create(Fl(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ke(58110);default:return ke(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Oi.create(t.compositeFilter.filters.map(i=>vN(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ke(1026)}})(t.compositeFilter.op))})(n):ke(30097,{filter:n})}function DH(n){return mH[n]}function AH(n){return yH[n]}function MH(n){return vH[n]}function Ol(n){return{fieldPath:n.canonicalString()}}function Fl(n){return ti.fromServerFormat(n.fieldPath)}function _N(n){return n instanceof on?(function(t){if(t.op==="=="){if($2(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NAN"}};if(H2(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if($2(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NOT_NAN"}};if(H2(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ol(t.field),op:AH(t.op),value:t.value}}})(n):n instanceof Oi?(function(t){let i=t.getFilters().map(r=>_N(r));return i.length===1?i[0]:{compositeFilter:{op:MH(t.op),filters:i}}})(n):ke(54877,{filter:n})}function RH(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function EN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function bN(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var Cd=class n{constructor(e,t,i,r,o=Qe.min(),s=Qe.min(),a=On.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Pw=class{constructor(e){this.yt=e}};function wN(n){let e=TH({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sd(e,e.limit,"L"):e}var cm=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Bt(e.integerValue));else if("doubleValue"in e){let i=Bt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Ed(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=mo(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(yo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?WP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):zP(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ke(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let i=e.fields||{};this.Ft(t,55);for(let r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){let i=e.fields||{};this.Ft(t,53);let r=Bl,o=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Bt(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){let i=e.values||[];this.Ft(t,50);for(let r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Pe.fromName(e).path.forEach(i=>{this.Ft(t,60),this.$t(i,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};cm.Wt=new cm;var Nw=class{constructor(){this.Sn=new kw}addToCollectionParentIndex(e,t){return this.Sn.add(t),ee.resolve()}getCollectionParents(e,t){return ee.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ee.resolve()}deleteFieldIndex(e,t){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,t){return ee.resolve()}getDocumentsMatchingTarget(e,t){return ee.resolve(null)}getIndexType(e,t){return ee.resolve(0)}getFieldIndexes(e,t){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,t){return ee.resolve(_a.min())}getMinOffsetFromCollectionGroup(e,t){return ee.resolve(_a.min())}updateCollectionGroup(e,t,i){return ee.resolve()}updateIndexEntries(e,t){return ee.resolve()}},kw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Dn(At.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Dn(At.comparator)).toArray()}};var que=new Uint8Array(0);var nP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xN=41943040,Ni=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};Ni.DEFAULT_COLLECTION_PERCENTILE=10,Ni.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ni.DEFAULT=new Ni(xN,Ni.DEFAULT_COLLECTION_PERCENTILE,Ni.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ni.DISABLED=new Ni(-1,0,0);var Dd=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var iP="LruGarbageCollector",PH=1048576;function rP([n,e],[t,i]){let r=rt(n,t);return r===0?rt(e,i):r}var Ow=class{constructor(e){this.Pr=e,this.buffer=new Dn(rP),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();rP(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Fw=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){we(iP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xl(t)?we(iP,"Ignoring IndexedDB error during garbage collection: ",t):await Zl(t)}await this.Ar(3e5)})}},Lw=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return ee.resolve(Ax.ce);let i=new Ow(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(we("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(nP)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(we("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nP):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,s,a,l,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(we("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,s=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(u=Date.now(),Nl()<=tt.DEBUG&&we("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${r} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:h})))}};function NH(n,e){return new Lw(n,e)}var Vw=class{constructor(){this.changes=new Eo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,nr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?ee.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Uw=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Bw=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&vd(i.mutation,r,Mr.empty(),an.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,nt()).next(()=>i))}getLocalViewOfDocuments(e,t,i=nt()){let r=pa();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=gd();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=pa();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,nt()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,i,r){let o=bo(),s=yd(),a=(function(){return yd()})();return t.forEach((l,u)=>{let d=i.get(u.key);r.has(u.key)&&(d===void 0||d.mutation instanceof wo)?o=o.insert(u.key,u):d!==void 0?(s.set(u.key,d.mutation.getFieldMask()),vd(d.mutation,u,d.mutation.getFieldMask(),an.now())):s.set(u.key,Mr.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((u,d)=>s.set(u,d)),t.forEach((u,d)=>a.set(u,new Uw(d,s.get(u)??null))),a))}recalculateAndSaveOverlays(e,t){let i=yd(),r=new Jt((s,a)=>s-a),o=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let u=t.get(l);if(u===null)return;let d=i.get(l)||Mr.empty();d=a.applyToLocalView(u,d),i.set(l,d);let h=(r.get(a.batchId)||nt()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),u=l.key,d=l.value,h=oN();d.forEach(p=>{if(!o.has(p)){let g=dN(t.get(p),i.get(p));g!==null&&h.set(p,g),o=o.add(p)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ee.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return J9(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Dm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):ee.resolve(pa()),a=_d,l=o;return s.next(u=>ee.forEach(u,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?ee.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,l,u,nt())).next(d=>({batchId:a,changes:rN(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Pe(t)).next(i=>{let r=gd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=gd();return this.indexManager.getCollectionParents(e,o).next(a=>ee.forEach(a,l=>{let u=(function(h,p){return new _o(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,i,r).next(d=>{d.forEach((h,p)=>{s=s.insert(h,p)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((l,u)=>{let d=u.getKey();s.get(d)===null&&(s=s.insert(d,nr.newInvalidDocument(d)))});let a=gd();return s.forEach((l,u)=>{let d=o.get(l);d!==void 0&&vd(d.mutation,u,Mr.empty(),an.now()),Rm(t,u)&&(a=a.insert(l,u))}),a})}};var jw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ee.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:kr(r.createTime)}})(t)),ee.resolve()}getNamedQuery(e,t){return ee.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:wN(r.bundledQuery),readTime:kr(r.readTime)}})(t)),ee.resolve()}};var Hw=class{constructor(){this.overlays=new Jt(Pe.comparator),this.Lr=new Map}getOverlay(e,t){return ee.resolve(this.overlays.get(t))}getOverlays(e,t){let i=pa();return ee.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.bt(e,t,o)}),ee.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Lr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(i)),ee.resolve()}getOverlaysForCollection(e,t,i){let r=pa(),o=t.length+1,s=new Pe(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===o&&l.largestBatchId>i&&r.set(l.getKey(),l)}return ee.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Jt((u,d)=>u-d),s=this.overlays.getIterator();for(;s.hasNext();){let u=s.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let d=o.get(u.largestBatchId);d===null&&(d=pa(),o=o.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=pa(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=r)););return ee.resolve(a)}bt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new xw(t,i));let o=this.Lr.get(t);o===void 0&&(o=nt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}};var $w=class{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ee.resolve()}};var Ad=class{constructor(){this.kr=new Dn(gn.Kr),this.qr=new Dn(gn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let i=new gn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new gn(e,t))}Qr(e,t){e.forEach(i=>this.removeReference(i,t))}Gr(e){let t=new Pe(new At([])),i=new gn(t,e),r=new gn(t,e+1),o=[];return this.qr.forEachInRange([i,r],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new Pe(new At([])),i=new gn(t,e),r=new gn(t,e+1),o=nt();return this.qr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new gn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},gn=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Pe.comparator(e.key,t.key)||rt(e.Hr,t.Hr)}static Ur(e,t){return rt(e.Hr,t.Hr)||Pe.comparator(e.key,t.key)}};var Gw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Dn(gn.Kr)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new bw(o,t,i,r);this.mutationQueue.push(s);for(let a of r)this.Jr=this.Jr.add(new gn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ee.resolve(s)}lookupMutationBatch(e,t){return ee.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),o=r<0?0:r;return ee.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?Mx:this.Yn-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new gn(t,0),r=new gn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],s=>{let a=this.Zr(s.Hr);o.push(a)}),ee.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Dn(rt);return t.forEach(r=>{let o=new gn(r,0),s=new gn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{i=i.add(a.Hr)})}),ee.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;Pe.isDocumentKey(o)||(o=o.child(""));let s=new gn(new Pe(o),0),a=new Dn(rt);return this.Jr.forEachWhile(l=>{let u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(a=a.add(l.Hr)),!0)},s),ee.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Et(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ee.forEach(t.mutations,r=>{let o=new gn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Jr=i})}nr(e){}containsKey(e,t){let i=new gn(t,0),r=this.Jr.firstAfterOrEqual(i);return ee.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var zw=class{constructor(e){this.ti=e,this.docs=(function(){return new Jt(Pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return ee.resolve(i?i.document.mutableCopy():nr.newInvalidDocument(t))}getEntries(e,t){let i=bo();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():nr.newInvalidDocument(r))}),ee.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=bo(),s=t.path,a=new Pe(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:u,value:{document:d}}=l.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||R9(M9(d),i)<=0||(r.has(d.key)||Rm(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return ee.resolve(o)}getAllFromCollectionGroup(e,t,i,r){ke(9500)}ni(e,t){return ee.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Ww(this)}getSize(e){return ee.resolve(this.size)}},Ww=class extends Vw{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)}),ee.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var qw=class{constructor(e){this.persistence=e,this.ri=new Eo(t=>kx(t),Ox),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.ii=0,this.si=new Ad,this.targetCount=0,this.oi=Dd._r()}forEachTarget(e,t){return this.ri.forEach((i,r)=>t(r)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ee.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new Dd(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ee.resolve()}updateTargetData(e,t){return this.lr(t),ee.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),ee.waitFor(o).next(()=>r)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,t){let i=this.ri.get(t)||null;return ee.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ee.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),ee.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ee.resolve()}getMatchingKeysForTargetId(e,t){let i=this.si.jr(t);return ee.resolve(i)}containsKey(e,t){return ee.resolve(this.si.containsKey(t))}};var um=class{constructor(e,t){this._i={},this.overlays={},this.ai=new Ax(0),this.ui=!1,this.ui=!0,this.ci=new $w,this.referenceDelegate=e(this),this.li=new qw(this),this.indexManager=new Nw,this.remoteDocumentCache=(function(r){return new zw(r)})(i=>this.referenceDelegate.hi(i)),this.serializer=new Pw(t),this.Pi=new jw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Hw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new Gw(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){we("MemoryPersistence","Starting transaction:",e);let r=new Kw(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(o=>this.referenceDelegate.Ii(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ei(e,t){return ee.or(Object.values(this._i).map(i=>()=>i.containsKey(e,t)))}},Kw=class extends rw{constructor(e){super(),this.currentSequenceNumber=e}},Yw=class n{constructor(e){this.persistence=e,this.Ri=new Ad,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw ke(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ee.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ee.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ee.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(r=>this.di.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.di,i=>{let r=Pe.fromPath(i);return this.mi(e,r).next(o=>{o||t.removeEntry(r,Qe.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return ee.or([()=>ee.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},dm=class n{constructor(e,t){this.persistence=e,this.fi=new Eo(i=>O9(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=NH(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return ee.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}pr(e){let t=0;return this.mr(e,i=>{t++}).next(()=>t)}mr(e,t){return ee.forEach(this.fi,(i,r)=>this.wr(e,i,r).next(o=>o?ee.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,s=>this.wr(e,s,t).next(a=>{a||(i++,o.removeEntry(s,Qe.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Gg(e.data.value)),t}wr(e,t,i){return ee.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.fi.get(t);return ee.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Qw=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=nt(),r=nt();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var Jw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Zw=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return f2()?8:N9(In())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new Jw;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,i,r){return i.documentReadCount<this.Vs?(Nl()<=tt.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",kl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ee.resolve()):(Nl()<=tt.DEBUG&&we("QueryEngine","Query:",kl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Nl()<=tt.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",kl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nr(t))):ee.resolve())}gs(e,t){if(q2(t))return ee.resolve(null);let i=Nr(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Sd(t,null,"F"),i=Nr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=nt(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{let u=this.bs(t,a);return this.Ss(t,u,s,l.readTime)?this.gs(e,Sd(t,null,"F")):this.Ds(e,u,t,l)}))})))}ps(e,t,i,r){return q2(t)||r.isEqual(Qe.min())?ee.resolve(null):this.fs.getDocuments(e,i).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,i,r)?ee.resolve(null):(Nl()<=tt.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kl(t)),this.Ds(e,s,t,A9(r,_d)).next(a=>a))})}bs(e,t){let i=new Dn(nN(e));return t.forEach((r,o)=>{Rm(e,o)&&(i=i.add(o))}),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return Nl()<=tt.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",kl(t)),this.fs.getDocumentsMatchingQuery(e,t,_a.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Ux="LocalStore",kH=3e8,Xw=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Jt(rt),this.Fs=new Eo(o=>kx(o),Ox),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Bw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function OH(n,e,t,i){return new Xw(n,e,t,i)}async function SN(n,e){let t=ze(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],a=[],l=nt();for(let u of r){s.push(u.batchId);for(let d of u.mutations)l=l.add(d.key)}for(let u of o){a.push(u.batchId);for(let d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(u=>({Ns:u,removedBatchIds:s,addedBatchIds:a}))})})}function FH(n,e){let t=ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,l,u,d){let h=u.batch,p=h.keys(),g=ee.resolve();return p.forEach(x=>{g=g.next(()=>d.getEntry(l,x)).next(S=>{let N=u.docVersions.get(x);Et(N!==null,48541),S.version.compareTo(N)<0&&(h.applyToRemoteDocument(S,u),S.isValidDocument()&&(S.setReadTime(u.commitVersion),d.addEntry(S)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))})(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=nt();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function IN(n){let e=ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function LH(n,e){let t=ze(n),i=e.snapshotVersion,r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;let a=[];e.targetChanges.forEach((d,h)=>{let p=r.get(h);if(!p)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,h)));let g=p.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(On.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,i)),r=r.insert(h,g),(function(S,N,U){return S.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=kH?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0})(p,g,d)&&a.push(t.li.updateTargetData(o,g))});let l=bo(),u=nt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(VH(o,s,e.documentUpdates).next(d=>{l=d.Bs,u=d.Ls})),!i.isEqual(Qe.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(h=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i));a.push(d)}return ee.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,u)).next(()=>l)}).then(o=>(t.vs=r,o))}function VH(n,e,t){let i=nt(),r=nt();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=bo();return t.forEach((a,l)=>{let u=o.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Qe.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):we(Ux,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Bs:s,Ls:r}})}function UH(n,e){let t=ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Mx),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function BH(n,e){let t=ze(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.li.getTargetData(i,e).next(o=>o?(r=o,ee.resolve(r)):t.li.allocateTargetId(i).next(s=>(r=new Cd(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i})}async function ex(n,e,t){let i=ze(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r))}catch(s){if(!Xl(s))throw s;we(Ux,`Failed to update sequence numbers for target ${e}: ${s}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function oP(n,e,t){let i=ze(n),r=Qe.min(),o=nt();return i.persistence.runTransaction("Execute query","readwrite",s=>(function(l,u,d){let h=ze(l),p=h.Fs.get(d);return p!==void 0?ee.resolve(h.vs.get(p)):h.li.getTargetData(u,d)})(i,s,Nr(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(s,e,t?r:Qe.min(),t?o:nt())).next(a=>(jH(i,X9(e),a),{documents:a,ks:o})))}function jH(n,e,t){let i=n.Ms.get(e)||Qe.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ms.set(e,i)}var hm=class{constructor(){this.activeTargetIds=oH()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var tx=class{constructor(){this.vo=new hm,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new hm,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var nx=class{Mo(e){}shutdown(){}};var sP="ConnectivityMonitor",fm=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){we(sP,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){we(sP,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var $g=null;function ix(){return $g===null?$g=(function(){return 268435456+Math.round(2147483648*Math.random())})():$g++,"0x"+$g.toString(16)}var Jb="RestConnection",HH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},rx=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===nm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){let s=ix(),a=this.Qo(e,t.toUriEncodedString());we(Jb,`Sending RPC '${e}' ${s}:`,a,i);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,r,o);let{host:u}=new URL(a),d=rs(u);return this.zo(e,a,l,i,d).then(h=>(we(Jb,`Received RPC '${e}' ${s}: `,h),h),h=>{throw us(Jb,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",i),h})}jo(e,t,i,r,o,s){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Yl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),i&&i.headers.forEach((r,o)=>e[o]=r)}Qo(e,t){let i=HH[e],r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}};var ox=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Bn="WebChannelConnection",pd=(n,e,t)=>{n.listen(e,i=>{try{t(i)}catch(r){setTimeout(()=>{throw r},0)}})},pm=class n extends rx{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=qb();pd(e,Wb.STAT_EVENT,t=>{t.stat===Bg.PROXY?we(Bn,"STAT_EVENT: detected buffering proxy"):t.stat===Bg.NOPROXY&&we(Bn,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,i,r,o){let s=ix();return new Promise((a,l)=>{let u=new Gb;u.setWithCredentials(!0),u.listenOnce(zb.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case fd.NO_ERROR:let h=u.getResponseJson();we(Bn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case fd.TIMEOUT:we(Bn,`RPC '${e}' ${s} timed out`),l(new ue(q.DEADLINE_EXCEEDED,"Request time out"));break;case fd.HTTP_ERROR:let p=u.getStatus();if(we(Bn,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);let x=g?.error;if(x&&x.status&&x.message){let S=(function(U){let ie=U.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(ie)>=0?ie:q.UNKNOWN})(x.status);l(new ue(S,x.message))}else l(new ue(q.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new ue(q.UNAVAILABLE,"Connection failed."));break;default:ke(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{we(Bn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);we(Bn,`RPC '${e}' ${s} sending request:`,r),u.send(t,"POST",d,i,15)})}T_(e,t,i){let r=ix(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;let u=o.join("");we(Bn,`Creating RPC '${e}' stream ${r}: ${u}`,a);let d=s.createWebChannel(u,a);this.I_(d);let h=!1,p=!1,g=new ox({Ho:x=>{p?we(Bn,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(h||(we(Bn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),we(Bn,`RPC '${e}' stream ${r} sending:`,x),d.send(x))},Jo:()=>d.close()});return pd(d,Pl.EventType.OPEN,()=>{p||(we(Bn,`RPC '${e}' stream ${r} transport opened.`),g.i_())}),pd(d,Pl.EventType.CLOSE,()=>{p||(p=!0,we(Bn,`RPC '${e}' stream ${r} transport closed`),g.o_(),this.E_(d))}),pd(d,Pl.EventType.ERROR,x=>{p||(p=!0,us(Bn,`RPC '${e}' stream ${r} transport errored. Name:`,x.name,"Message:",x.message),g.o_(new ue(q.UNAVAILABLE,"The operation could not be completed")))}),pd(d,Pl.EventType.MESSAGE,x=>{if(!p){let S=x.data[0];Et(!!S,16349);let N=S,U=N?.error||N[0]?.error;if(U){we(Bn,`RPC '${e}' stream ${r} received error:`,U);let ie=U.status,Se=(function(Ie){let k=pn[Ie];if(k!==void 0)return fN(k)})(ie),xe=U.message;Se===void 0&&(Se=q.INTERNAL,xe="Unknown error status: "+ie+" with message "+U.message),p=!0,g.o_(new ue(Se,xe)),d.close()}else we(Bn,`RPC '${e}' stream ${r} received:`,S),g.__(S)}}),n.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Kb()}};function $H(n){return new pm(n)}function Zb(){return typeof document<"u"?document:null}function Od(n){return new Cw(n,!0)}pm.c_=!1;var gm=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&we("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var aP="PersistentStream",mm=class{constructor(e,t,i,r,o,s,a,l){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new gm(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===q.RESOURCE_EXHAUSTED?(go(t.toString()),go("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{let r=new ue(q.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){let i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return we(aP,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(we(aP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},sx=class extends mm{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=bH(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Qe.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Qe.min():s.readTime?kr(s.readTime):Qe.min()})(e);return this.listener.J_(t,i)}Z_(e){let t={};t.database=Rw(this.serializer),t.addTarget=(function(o,s){let a,l=s.target;if(a=yw(l)?{documents:SH(o,l)}:{query:IH(o,l).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=pN(o,s.resumeToken);let u=Dw(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(Qe.min())>0){a.readTime=lm(o,s.snapshotVersion.toTimestamp());let u=Dw(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a})(this.serializer,e);let i=CH(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){let t={};t.database=Rw(this.serializer),t.removeTarget=e,this.K_(t)}},ax=class extends mm{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=xH(e.writeResults,e.commitTime),i=kr(e.commitTime);return this.listener.na(i,t)}ra(){let e={};e.database=Rw(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>wH(this.serializer,i))};this.K_(t)}};var lx=class{},cx=class extends lx{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ue(q.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,Aw(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(q.UNKNOWN,o.toString())})}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,Aw(t,i),r,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ue(q.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function GH(n,e,t,i){return new cx(n,e,t,i)}var ux=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(go(t),this.aa=!1):we("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Sa="RemoteStore",dx=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{i.enqueueAndForget(async()=>{Da(this)&&(we(Sa,"Restarting streams for network reachability change."),await(async function(l){let u=ze(l);u.Ea.add(4),await Fd(u),u.Va.set("Unknown"),u.Ea.delete(4),await Pm(u)})(this))})}),this.Va=new ux(i,r)}};async function Pm(n){if(Da(n))for(let e of n.Ra)await e(!0)}async function Fd(n){for(let e of n.Ra)await e(!1)}function TN(n,e){let t=ze(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),$x(t)?Hx(t):ec(t).O_()&&jx(t,e))}function Bx(n,e){let t=ze(n),i=ec(t);t.Ia.delete(e),i.O_()&&CN(t,e),t.Ia.size===0&&(i.O_()?i.L_():Da(t)&&t.Va.set("Unknown"))}function jx(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ec(n).Z_(e)}function CN(n,e){n.da.$e(e),ec(n).X_(e)}function Hx(n){n.da=new Tw({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ec(n).start(),n.Va.ua()}function $x(n){return Da(n)&&!ec(n).x_()&&n.Ia.size>0}function Da(n){return ze(n).Ea.size===0}function DN(n){n.da=void 0}async function zH(n){n.Va.set("Online")}async function WH(n){n.Ia.forEach((e,t)=>{jx(n,e)})}async function qH(n,e){DN(n),$x(n)?(n.Va.ha(e),Hx(n)):n.Va.set("Unknown")}async function KH(n,e,t){if(n.Va.set("Online"),e instanceof sm&&e.state===2&&e.cause)try{await(async function(r,o){let s=o.cause;for(let a of o.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.da.removeTarget(a))})(n,e)}catch(i){we(Sa,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await ym(n,i)}else if(e instanceof Vl?n.da.Xe(e):e instanceof om?n.da.st(e):n.da.tt(e),!t.isEqual(Qe.min()))try{let i=await IN(n.localStore);t.compareTo(i)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.Ia.get(u);d&&o.Ia.set(u,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,u)=>{let d=o.Ia.get(l);if(!d)return;o.Ia.set(l,d.withResumeToken(On.EMPTY_BYTE_STRING,d.snapshotVersion)),CN(o,l);let h=new Cd(d.target,l,u,d.sequenceNumber);jx(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){we(Sa,"Failed to raise snapshot:",i),await ym(n,i)}}async function ym(n,e,t){if(!Xl(e))throw e;n.Ea.add(1),await Fd(n),n.Va.set("Offline"),t||(t=()=>IN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{we(Sa,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Pm(n)})}function AN(n,e){return e().catch(t=>ym(n,t,e))}async function Nm(n){let e=ze(n),t=fs(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Mx;for(;YH(e);)try{let r=await UH(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,QH(e,r)}catch(r){await ym(e,r)}MN(e)&&RN(e)}function YH(n){return Da(n)&&n.Ta.length<10}function QH(n,e){n.Ta.push(e);let t=fs(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function MN(n){return Da(n)&&!fs(n).x_()&&n.Ta.length>0}function RN(n){fs(n).start()}async function JH(n){fs(n).ra()}async function ZH(n){let e=fs(n);for(let t of n.Ta)e.ea(t.mutations)}async function XH(n,e,t){let i=n.Ta.shift(),r=ww.from(i,e,t);await AN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Nm(n)}async function e7(n,e){e&&fs(n).Y_&&await(async function(i,r){if((function(s){return hH(s)&&s!==q.ABORTED})(r.code)){let o=i.Ta.shift();fs(i).B_(),await AN(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Nm(i)}})(n,e),MN(n)&&RN(n)}async function lP(n,e){let t=ze(n);t.asyncQueue.verifyOperationInProgress(),we(Sa,"RemoteStore received new credentials");let i=Da(t);t.Ea.add(3),await Fd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Pm(t)}async function t7(n,e){let t=ze(n);e?(t.Ea.delete(2),await Pm(t)):e||(t.Ea.add(2),await Fd(t),t.Va.set("Unknown"))}function ec(n){return n.ma||(n.ma=(function(t,i,r){let o=ze(t);return o.sa(),new sx(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:zH.bind(null,n),Yo:WH.bind(null,n),t_:qH.bind(null,n),J_:KH.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),$x(n)?Hx(n):n.Va.set("Unknown")):(await n.ma.stop(),DN(n))})),n.ma}function fs(n){return n.fa||(n.fa=(function(t,i,r){let o=ze(t);return o.sa(),new ax(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:JH.bind(null,n),t_:e7.bind(null,n),ta:ZH.bind(null,n),na:XH.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Nm(n)):(await n.fa.stop(),n.Ta.length>0&&(we(Sa,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var hx=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new Rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,a=new n(e,t,s,r,o);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Gx(n,e){if(go("AsyncQueue",`${e}: ${n}`),Xl(n))return new ue(q.UNAVAILABLE,`${e}: ${n}`);throw n}var Md=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Pe.comparator(t.key,i.key):(t,i)=>Pe.comparator(t.key,i.key),this.keyedMap=gd(),this.sortedSet=new Jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var vm=class{constructor(){this.ga=new Jt(Pe.comparator)}track(e){let t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ke(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}},Ia=class n{constructor(e,t,i,r,o,s,a,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Md.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var fx=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},px=class{constructor(){this.queries=cP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){let r=ze(t),o=r.queries;r.queries=cP(),o.forEach((s,a)=>{for(let l of a.ba)l.onError(i)})})(this,new ue(q.ABORTED,"Firestore shutting down"))}};function cP(){return new Eo(n=>tN(n),Mm)}async function n7(n,e){let t=ze(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new fx,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(s){let a=Gx(s,`Initialization of query '${kl(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&zx(t)}async function i7(n,e){let t=ze(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function r7(n,e){let t=ze(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(r)&&(i=!0);s.wa=r}}i&&zx(t)}function o7(n,e,t){let i=ze(n),r=i.queries.get(e);if(r)for(let o of r.ba)o.onError(t);i.queries.delete(e)}function zx(n){n.Ca.forEach(e=>{e.next()})}var gx,uP;(uP=gx||(gx={})).Ma="default",uP.Cache="cache";var mx=class{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ia(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gx.Cache}};var _m=class{constructor(e){this.key=e}},Em=class{constructor(e){this.key=e}},yx=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=nt(),this.mutatedKeys=nt(),this.eu=nN(e),this.tu=new Md(this.eu)}get nu(){return this.Za}ru(e,t){let i=t?t.iu:new vm,r=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{let p=r.get(d),g=Rm(this.query,h)?h:null,x=!!p&&this.mutatedKeys.has(p.key),S=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),N=!1;p&&g?p.data.isEqual(g.data)?x!==S&&(i.track({type:3,doc:g}),N=!0):this.su(p,g)||(i.track({type:2,doc:g}),N=!0,(l&&this.eu(g,l)>0||u&&this.eu(g,u)<0)&&(a=!0)):!p&&g?(i.track({type:0,doc:g}),N=!0):p&&!g&&(i.track({type:1,doc:p}),N=!0,(l||u)&&(a=!0)),N&&(g?(s=s.add(g),o=S?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),i.track({type:1,doc:d})}return{tu:s,iu:i,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,h)=>(function(g,x){let S=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ke(20277,{Vt:N})}};return S(g)-S(x)})(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(i),r=r??!1;let a=t&&!r?this._u():[],l=this.Ya.size===0&&this.current&&!r?1:0,u=l!==this.Xa;return this.Xa=l,s.length!==0||u?{snapshot:new Ia(this.query,e.tu,o,s,e.mutatedKeys,l===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vm,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=nt(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});let t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new Em(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new _m(i))}),t}cu(e){this.Za=e.ks,this.Ya=nt();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ia.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},Wx="SyncEngine",vx=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},_x=class{constructor(e){this.key=e,this.hu=!1}},Ex=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Eo(a=>tN(a),Mm),this.Iu=new Map,this.Eu=new Set,this.Ru=new Jt(Pe.comparator),this.Au=new Map,this.Vu=new Ad,this.du={},this.mu=new Map,this.fu=Dd.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function s7(n,e,t=!0){let i=LN(n),r,o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await PN(i,e,t,!0),r}async function a7(n,e){let t=LN(n);await PN(t,e,!0,!1)}async function PN(n,e,t,i){let r=await BH(n.localStore,Nr(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return i&&(a=await l7(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&TN(n.remoteStore,r),a}async function l7(n,e,t,i,r){n.pu=(h,p,g)=>(async function(S,N,U,ie){let Se=N.view.ru(U);Se.Ss&&(Se=await oP(S.localStore,N.query,!1).then(({documents:k})=>N.view.ru(k,Se)));let xe=ie&&ie.targetChanges.get(N.targetId),De=ie&&ie.targetMismatches.get(N.targetId)!=null,Ie=N.view.applyChanges(Se,S.isPrimaryClient,xe,De);return hP(S,N.targetId,Ie.au),Ie.snapshot})(n,h,p,g);let o=await oP(n.localStore,e,!0),s=new yx(e,o.ks),a=s.ru(o.documents),l=Td.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),u=s.applyChanges(a,n.isPrimaryClient,l);hP(n,t,u.au);let d=new vx(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function c7(n,e,t){let i=ze(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter(s=>!Mm(s,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await ex(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Bx(i.remoteStore,r.targetId),bx(i,r.targetId)}).catch(Zl)):(bx(i,r.targetId),await ex(i.localStore,r.targetId,!0))}async function u7(n,e){let t=ze(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Bx(t.remoteStore,i.targetId))}async function d7(n,e,t){let i=v7(n);try{let r=await(function(s,a){let l=ze(s),u=an.now(),d=a.reduce((g,x)=>g.add(x.key),nt()),h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=bo(),S=nt();return l.xs.getEntries(g,d).next(N=>{x=N,x.forEach((U,ie)=>{ie.isValidDocument()||(S=S.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,x)).next(N=>{h=N;let U=[];for(let ie of a){let Se=dH(ie,h.get(ie.key).overlayedDocument);Se!=null&&U.push(new wo(ie.key,Se,qP(Se.value.mapValue),cs.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,U,a)}).next(N=>{p=N;let U=N.applyToLocalDocumentSet(h,S);return l.documentOverlayCache.saveOverlays(g,N.batchId,U)})}).then(()=>({batchId:p.batchId,changes:rN(h)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(s,a,l){let u=s.du[s.currentUser.toKey()];u||(u=new Jt(rt)),u=u.insert(a,l),s.du[s.currentUser.toKey()]=u})(i,r.batchId,t),await Ld(i,r.changes),await Nm(i.remoteStore)}catch(r){let o=Gx(r,"Failed to persist write");t.reject(o)}}async function NN(n,e){let t=ze(n);try{let i=await LH(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Au.get(o);s&&(Et(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?s.hu=!0:r.modifiedDocuments.size>0?Et(s.hu,14607):r.removedDocuments.size>0&&(Et(s.hu,42227),s.hu=!1))}),await Ld(t,i,e)}catch(i){await Zl(i)}}function dP(n,e,t){let i=ze(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(s,a){let l=ze(s);l.onlineState=a;let u=!1;l.queries.forEach((d,h)=>{for(let p of h.ba)p.va(a)&&(u=!0)}),u&&zx(l)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function h7(n,e,t){let i=ze(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Au.get(e),o=r&&r.key;if(o){let s=new Jt(Pe.comparator);s=s.insert(o,nr.newNoDocument(o,Qe.min()));let a=nt().add(o),l=new rm(Qe.min(),new Map,new Jt(rt),s,a);await NN(i,l),i.Ru=i.Ru.remove(o),i.Au.delete(e),qx(i)}else await ex(i.localStore,e,!1).then(()=>bx(i,e,t)).catch(Zl)}async function f7(n,e){let t=ze(n),i=e.batch.batchId;try{let r=await FH(t.localStore,e);ON(t,i,null),kN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ld(t,r)}catch(r){await Zl(r)}}async function p7(n,e,t){let i=ze(n);try{let r=await(function(s,a){let l=ze(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(h=>(Et(h!==null,37113),d=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})})(i.localStore,e);ON(i,e,t),kN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ld(i,r)}catch(r){await Zl(r)}}function kN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function ON(n,e,t){let i=ze(n),r=i.du[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function bx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(i=>{n.Vu.containsKey(i)||FN(n,i)})}function FN(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(Bx(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),qx(n))}function hP(n,e,t){for(let i of t)i instanceof _m?(n.Vu.addReference(i.key,e),g7(n,i)):i instanceof Em?(we(Wx,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||FN(n,i.key)):ke(19791,{wu:i})}function g7(n,e){let t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(we(Wx,"New document in limbo: "+t),n.Eu.add(i),qx(n))}function qx(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new Pe(At.fromString(e)),i=n.fu.next();n.Au.set(i,new _x(t)),n.Ru=n.Ru.insert(t,i),TN(n.remoteStore,new Cd(Nr(Fx(t.path)),i,"TargetPurposeLimboResolution",Ax.ce))}}async function Ld(n,e,t){let i=ze(n),r=[],o=[],s=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{s.push(i.pu(l,e,t).then(u=>{if((u||t)&&i.isPrimaryClient){let d=u?!u.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){r.push(u);let d=Qw.Es(l.targetId,u);o.push(d)}}))}),await Promise.all(s),i.Pu.J_(r),await(async function(l,u){let d=ze(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ee.forEach(u,p=>ee.forEach(p.Ts,g=>d.persistence.referenceDelegate.addReference(h,p.targetId,g)).next(()=>ee.forEach(p.Is,g=>d.persistence.referenceDelegate.removeReference(h,p.targetId,g)))))}catch(h){if(!Xl(h))throw h;we(Ux,"Failed to update sequence numbers: "+h)}for(let h of u){let p=h.targetId;if(!h.fromCache){let g=d.vs.get(p),x=g.snapshotVersion,S=g.withLastLimboFreeSnapshotVersion(x);d.vs=d.vs.insert(p,S)}}})(i.localStore,o))}async function m7(n,e){let t=ze(n);if(!t.currentUser.isEqual(e)){we(Wx,"User change. New user:",e.toKey());let i=await SN(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(l=>{l.reject(new ue(q.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ld(t,i.Ns)}}function y7(n,e){let t=ze(n),i=t.Au.get(e);if(i&&i.hu)return nt().add(i.key);{let r=nt(),o=t.Iu.get(e);if(!o)return r;for(let s of o){let a=t.Tu.get(s);r=r.unionWith(a.view.nu)}return r}}function LN(n){let e=ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=NN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=y7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=h7.bind(null,e),e.Pu.J_=r7.bind(null,e.eventManager),e.Pu.yu=o7.bind(null,e.eventManager),e}function v7(n){let e=ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=f7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=p7.bind(null,e),e}var Kx=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Od(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return OH(this.persistence,new Zw,t.initialUser,this.serializer)}Cu(t){return new um(Yw.Vi,this.serializer)}Du(t){return new tx}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),bm=class extends Kx{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Et(this.persistence.referenceDelegate instanceof dm,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new Fw(i,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Ni.withCacheSize(this.cacheSizeBytes):Ni.DEFAULT;return new um(i=>dm.Vi(i,t),this.serializer)}};var VN=(()=>{class n{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dP(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=m7.bind(null,this.syncEngine),await t7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new px})()}createDatastore(t){let i=Od(t.databaseInfo.databaseId),r=$H(t.databaseInfo);return GH(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,s,a,l){return new dx(r,o,s,a,l)})(this.localStore,this.datastore,t.asyncQueue,i=>dP(this.syncEngine,i,0),(function(){return fm.v()?new fm:new nx})())}createSyncEngine(t,i){return(function(o,s,a,l,u,d,h){let p=new Ex(o,s,a,l,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){let r=ze(i);we(Sa,"RemoteStore shutting down."),r.Ea.add(5),await Fd(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var wx=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):go("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var ps="FirestoreClient",xx=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=Cn.UNAUTHENTICATED,this.clientId=va.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async s=>{we(ps,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(we(ps,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Gx(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}};async function Xb(n,e){n.asyncQueue.verifyOperationInProgress(),we(ps,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await SN(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function fP(n,e){n.asyncQueue.verifyOperationInProgress();let t=await _7(n);we(ps,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>lP(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>lP(e.remoteStore,r)),n._onlineComponents=e}async function _7(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){we(ps,"Using user provided OfflineComponentProvider");try{await Xb(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===q.FAILED_PRECONDITION||r.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;us("Error using user provided cache. Falling back to memory cache: "+t),await Xb(n,new Kx)}}else we(ps,"Using default OfflineComponentProvider"),await Xb(n,new bm(void 0));return n._offlineComponents}async function UN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(we(ps,"Using user provided OnlineComponentProvider"),await fP(n,n._uninitializedComponentsProvider._online)):(we(ps,"Using default OnlineComponentProvider"),await fP(n,new VN))),n._onlineComponents}function E7(n){return UN(n).then(e=>e.syncEngine)}async function b7(n){let e=await UN(n),t=e.eventManager;return t.onListen=s7.bind(null,e.syncEngine),t.onUnlisten=c7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=a7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=u7.bind(null,e.syncEngine),t}function BN(n,e,t={}){let i=new Rr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,u){let d=new wx({next:p=>{d.Nu(),s.enqueueAndForget(()=>i7(o,h)),p.fromCache&&l.source==="server"?u.reject(new ue(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new mx(a,d,{includeMetadataChanges:!0,Ka:!0});return n7(o,h)})(await b7(n),n.asyncQueue,e,t,i)),i.promise}function jN(n,e){let t=new Rr;return n.asyncQueue.enqueueAndForget(async()=>d7(await E7(n),e,t)),t.promise}function HN(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var w7="ComponentProvider",pP=new Map;function x7(n,e,t,i,r){return new ow(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,HN(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}var $N="firestore.googleapis.com",gP=!0,wm=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ue(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$N,this.ssl=gP}else this.host=e.host,this.ssl=e.ssl??gP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PH)throw new ue(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Wl=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wm(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Kg;switch(i.type){case"firstParty":return new nw(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ue(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=pP.get(t);i&&(we(w7,"Removing Datastore"),pP.delete(t),i.terminate())})(this),Promise.resolve()}};function GN(n,e,t,i={}){n=Ql(n,Wl);let r=rs(e),o=n._getSettings(),s=pe(F({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;r&&(Ng(`https://${a}`),kg("Firestore",!0)),o.host!==$N&&o.host!==a&&us("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=pe(F({},o),{host:a,ssl:r,emulatorOptions:i});if(!er(l,s)&&(n._setSettings(l),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=Cn.MOCK_USER;else{u=a2(i.mockUserToken,n._app?.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new ue(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Cn(h)}n._authCredentials=new ew(new qg(u,d))}}var ir=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},kn=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Jl(t,n._jsonSchema))return new n(e,i||null,new Pe(At.fromString(t.referencePath)))}};kn._jsonSchemaVersion="firestore/documentReference/1.0",kn._jsonSchema={type:sn("string",kn._jsonSchemaVersion),referencePath:sn("string")};var fo=class n extends ir{constructor(e,t,i){super(e,t,Fx(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new Pe(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function rr(n,e,...t){if(n=Tn(n),EP("collection","path",e),n instanceof Wl){let i=At.fromString(e,...t);return O2(i),new fo(n,null,i)}{if(!(n instanceof kn||n instanceof fo))throw new ue(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(At.fromString(e,...t));return O2(i),new fo(n.firestore,null,i)}}function Yx(n,e,...t){if(n=Tn(n),arguments.length===1&&(e=va.newId()),EP("doc","path",e),n instanceof Wl){let i=At.fromString(e,...t);return k2(i),new kn(n,null,new Pe(i))}{if(!(n instanceof kn||n instanceof fo))throw new ue(q.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(At.fromString(e,...t));return k2(i),new kn(n.firestore,n instanceof fo?n.converter:null,new Pe(i))}}var mP="AsyncQueue",xm=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new gm(this,"async_queue_retry"),this._c=()=>{let i=Zb();i&&we(mP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;let t=Zb();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Zb();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Rr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Xl(e))throw e;we(mP,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,go("INTERNAL UNHANDLED ERROR: ",yP(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=hx.createAndSchedule(this,e,t,i,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&ke(47125,{Pc:yP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function yP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Ta=class extends Wl{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new xm,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xm(e),this._firestoreClient=void 0,await e}}};function Vd(n,e){let t=typeof n=="object"?n:Vg(),i=typeof n=="string"?n:e||nm,r=dd(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let o=s2("firestore");o&&GN(r,...o)}return r}function km(n){if(n._terminated)throw new ue(q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||S7(n),n._firestoreClient}function S7(n){let e=n._freezeSettings(),t=x7(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new xx(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}var Or=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(On.fromBase64String(e))}catch(t){throw new ue(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Jl(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Or._jsonSchemaVersion="firestore/bytes/1.0",Or._jsonSchema={type:sn("string",Or._jsonSchemaVersion),bytes:sn("string")};var ql=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ti(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Kl=class{constructor(e){this._methodName=e}};var po=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return rt(this._lat,e._lat)||rt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Jl(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};po._jsonSchemaVersion="firestore/geoPoint/1.0",po._jsonSchema={type:sn("string",po._jsonSchemaVersion),latitude:sn("number"),longitude:sn("number")};var Fr=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Jl(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new ue(q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Fr._jsonSchemaVersion="firestore/vectorValue/1.0",Fr._jsonSchema={type:sn("string",Fr._jsonSchemaVersion),vectorValues:sn("object")};var I7=/^__.*__$/,Sx=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new wo(e,this.data,this.fieldMask,t,this.fieldTransforms):new xa(e,this.data,t,this.fieldTransforms)}};function zN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ke(40011,{dataSource:n})}}var Ix=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(F(F({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Sm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(zN(this.dataSource)&&I7.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},Tx=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Od(e)}createContext(e,t,i,r=!1){return new Ix({dataSource:e,methodName:t,targetDoc:i,path:ti.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Om(n){let e=n._freezeSettings(),t=Od(n._databaseId);return new Tx(n._databaseId,!!e.ignoreUndefinedProperties,t)}function WN(n,e,t,i,r,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);YN("Data must be an object, but it was:",s,i);let a=qN(i,s),l,u;if(o.merge)l=new Mr(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let p=tc(e,h,t);if(!s.contains(p))throw new ue(q.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);C7(d,p)||d.push(p)}l=new Mr(d),u=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=s.fieldTransforms;return new Sx(new ki(a),l,u)}var Cx=class n extends Kl{_toFieldTransform(e){return new vw(e.path,new Ea)}isEqual(e){return e instanceof n}};function Qx(n,e,t,i=!1){return Jx(t,n.createContext(i?4:3,e))}function Jx(n,e){if(KN(n=Tn(n)))return YN("Unsupported field value:",e,n),qN(n,e);if(n instanceof Kl)return(function(i,r){if(!zN(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){let o=[],s=0;for(let a of i){let l=Jx(a,r.childContextForArray(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Tn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return sH(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=an.fromDate(i);return{timestampValue:lm(r.serializer,o)}}if(i instanceof an){let o=new an(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:lm(r.serializer,o)}}if(i instanceof po)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Or)return{bytesValue:pN(r.serializer,i._byteString)};if(i instanceof kn){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Vx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Fr)return(function(s,a){let l=s instanceof Fr?s.toArray():s;return{mapValue:{fields:{[Rx]:{stringValue:Px},[Bl]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return Lx(a.serializer,d)})}}}}}})(i,r);if(bN(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Pd(i)}`)})(n,e)}function qN(n,e){let t={};return VP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ca(n,(i,r)=>{let o=Jx(r,e.childContextForField(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function KN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof an||n instanceof po||n instanceof Or||n instanceof kn||n instanceof Kl||n instanceof Fr||bN(n))}function YN(n,e,t){if(!KN(t)||!wP(t)){let i=Pd(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function tc(n,e,t){if((e=Tn(e))instanceof ql)return e._internalPath;if(typeof e=="string")return QN(n,e);throw Sm("Field path arguments must be of type string or ",n,!1,void 0,t)}var T7=new RegExp("[~\\*/\\[\\]]");function QN(n,e,t){if(e.search(T7)>=0)throw Sm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ql(...e.split("."))._internalPath}catch{throw Sm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Sm(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new ue(q.INVALID_ARGUMENT,a+n+l)}function C7(n,e){return n.some(t=>t.isEqual(e))}var Rd=class{convertValue(e,t="none"){switch(ds(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ke(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Ca(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){let t=e.fields?.[Bl].arrayValue?.values?.map(i=>Bt(i.doubleValue));return new Fr(t)}convertGeoPoint(e){return new po(Bt(e.latitude),Bt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Cm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(bd(e));default:return null}}convertTimestamp(e){let t=mo(e);return new an(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=At.fromString(e);Et(EN(i),9688,{name:e});let r=new wd(i.get(1),i.get(3)),o=new Pe(i.popFirst(5));return r.isEqual(t)||go(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var Im=class extends Rd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,t)}};function Zx(){return new Cx("serverTimestamp")}var JN="@firebase/firestore",ZN="4.10.0";var Ud=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Xx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(tc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Xx=class extends Ud{data(){return super.data()}};function R7(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Bd=class{},sc=class extends Bd{};function gs(n,e,...t){let i=[];e instanceof Bd&&i.push(e),i=i.concat(t),(function(o){let s=o.filter(l=>l instanceof e1).length,a=o.filter(l=>l instanceof Fm).length;if(s>1||s>0&&a>0)throw new ue(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var Fm=class n extends sc{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return nk(e._query,t),new ir(e.firestore,e.converter,Am(e._query,t))}_parse(e){let t=Om(e.firestore);return(function(o,s,a,l,u,d,h){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ue(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ek(h,d);let x=[];for(let S of h)x.push(XN(l,o,S));p={arrayValue:{values:x}}}else p=XN(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ek(h,d),p=Qx(a,s,h,d==="in"||d==="not-in");return on.create(u,d,p)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function ms(n,e,t){let i=e,r=tc("where",n);return Fm._create(r,i,t)}var e1=class n extends Bd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Oi.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let s=r,a=o.getFlattenedFilters();for(let l of a)nk(s,l),s=Am(s,l)})(e._query,t),new ir(e.firestore,e.converter,Am(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var t1=class n extends sc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(r,o,s){if(r.startAt!==null)throw new ue(q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ue(q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new hs(o,s)})(e._query,this._field,this._direction);return new ir(e.firestore,e.converter,XP(e._query,t))}};function xo(n,e="asc"){let t=e,i=tc("orderBy",n);return t1._create(i,t)}var n1=class n extends sc{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new ir(e.firestore,e.converter,Sd(e._query,this._limit,this._limitType))}};function Aa(n){return xP("limit",n),n1._create("limit",n,"F")}var i1=class n extends sc{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=P7(e,this.type,this._docOrFields,this._inclusive);return new ir(e.firestore,e.converter,eN(e._query,t))}};function tk(...n){return i1._create("startAfter",n,!1)}function P7(n,e,t,i){if(t[0]=Tn(t[0]),t[0]instanceof Ud)return(function(o,s,a,l,u){if(!l)throw new ue(q.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of ma(o))if(h.field.isKeyField())d.push(kd(s,l.key));else{let p=l.data.field(h.field);if(Nd(p))throw new ue(q.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let g=h.field.canonicalString();throw new ue(q.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(p)}return new vo(d,u)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Om(n.firestore);return(function(s,a,l,u,d,h){let p=s.explicitOrderBy;if(d.length>p.length)throw new ue(q.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let x=0;x<d.length;x++){let S=d[x];if(p[x].field.isKeyField()){if(typeof S!="string")throw new ue(q.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof S}`);if(!Dm(s)&&S.indexOf("/")!==-1)throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${S}' contains a slash.`);let N=s.path.child(At.fromString(S));if(!Pe.isDocumentKey(N))throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let U=new Pe(N);g.push(kd(a,U))}else{let N=Qx(l,u,S);g.push(N)}}return new vo(g,h)})(n._query,n.firestore._databaseId,r,e,t,i)}}function XN(n,e,t){if(typeof(t=Tn(t))=="string"){if(t==="")throw new ue(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dm(e)&&t.indexOf("/")!==-1)throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(At.fromString(t));if(!Pe.isDocumentKey(i))throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return kd(n,new Pe(i))}if(t instanceof kn)return kd(n,t._key);throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Pd(t)}.`)}function ek(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nk(n,e){let t=(function(r,o){for(let s of r)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ue(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function N7(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var nc=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ic=class n extends Ud{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new rc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(tc("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};ic._jsonSchemaVersion="firestore/documentSnapshot/1.0",ic._jsonSchema={type:sn("string",ic._jsonSchemaVersion),bundleSource:sn("string","DocumentSnapshot"),bundleName:sn("string"),bundle:sn("string")};var rc=class extends ic{data(e={}){return super.data(e)}},oc=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new nc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new rc(this._firestore,this._userDataWriter,i.key,i,new nc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{let l=new rc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new nc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new rc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new nc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),u=-1,d=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:k7(a.type),doc:l,oldIndex:u,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=va.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function k7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke(61501,{type:n})}}oc._jsonSchemaVersion="firestore/querySnapshot/1.0",oc._jsonSchema={type:sn("string",oc._jsonSchemaVersion),bundleSource:sn("string","QuerySnapshot"),bundleName:sn("string"),bundle:sn("string")};function Ma(n){n=Ql(n,ir);let e=Ql(n.firestore,Ta),t=km(e),i=new Im(e);return R7(n._query),BN(t,n._query).then(r=>new oc(e,i,n,r))}function Lm(n,e){let t=Ql(n.firestore,Ta),i=Yx(n),r=N7(n.converter,e),o=Om(n.firestore);return O7(t,[WN(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,cs.exists(!1))]).then(()=>i)}function O7(n,e){let t=km(n);return jN(t,e)}(function(e,t=!0){vP(ls),as(new Pi("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),a=new Ta(new Yg(i.getProvider("auth-internal")),new Jg(s,i.getProvider("app-check-internal")),$P(s,r),s);return o=F({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),tr(JN,ZN,e),tr(JN,ZN,"esm2020")})();function yk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var vk=yk,_k=new lo("auth","Firebase",yk());var $m=new os("@firebase/auth");function F7(n,...e){$m.logLevel<=tt.WARN&&$m.warn(`Auth (${ls}): ${n}`,...e)}function Um(n,...e){$m.logLevel<=tt.ERROR&&$m.error(`Auth (${ls}): ${n}`,...e)}function Ur(n,...e){throw b1(n,...e)}function or(n,...e){return b1(n,...e)}function E1(n,e,t){let i=pe(F({},vk()),{[e]:t});return new lo("auth","Firebase",i).create(e,{appName:n.name})}function Ra(n){return E1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function L7(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Ur(n,"argument-error"),E1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function b1(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return _k.create(n,...e)}function je(n,e,...t){if(!n)throw b1(e,...t)}function So(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Um(e),new Error(e)}function To(n,e){n||So(e)}function s1(){return typeof self<"u"&&self.location?.href||""}function V7(){return ik()==="http:"||ik()==="https:"}function ik(){return typeof self<"u"&&self.location?.protocol||null}function U7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(V7()||u2()||"connection"in navigator)?navigator.onLine:!0}function B7(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Pa=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,To(t>e,"Short delay should be less than long delay!"),this.isMobile=l2()||d2()}get(){return U7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function w1(n,e){To(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Gm=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;So("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;So("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;So("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var j7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var H7=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$7=new Pa(3e4,6e4);function x1(n,e){return n.tenantId&&!e.tenantId?pe(F({},e),{tenantId:n.tenantId}):e}async function lc(n,e,t,i,r={}){return Ek(n,r,async()=>{let o={},s={};i&&(e==="GET"?s=i:o={body:JSON.stringify(i)});let a=Rl(F({key:n.config.apiKey},s)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let u=F({method:e,headers:l},o);return c2()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&rs(n.emulatorConfig.host)&&(u.credentials="include"),Gm.fetch()(await bk(n,n.config.apiHost,t,a),u)})}async function Ek(n,e,t){n._canInitEmulator=!1;let i=F(F({},j7),e);try{let r=new a1(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw Vm(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vm(n,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw Vm(n,"email-already-in-use",s);if(l==="USER_DISABLED")throw Vm(n,"user-disabled",s);let d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw E1(n,d,u);Ur(n,d)}}catch(r){if(r instanceof vi)throw r;Ur(n,"network-request-failed",{message:String(r)})}}async function G7(n,e,t,i,r={}){let o=await lc(n,e,t,i,r);return"mfaPendingCredential"in o&&Ur(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function bk(n,e,t,i){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?w1(n.config,r):`${n.config.apiScheme}://${r}`;return H7.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var a1=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(or(this.auth,"network-request-failed")),$7.get())})}};function Vm(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=or(n,e,i);return r.customData._tokenResponse=t,r}async function z7(n,e){return lc(n,"POST","/v1/accounts:delete",e)}async function zm(n,e){return lc(n,"POST","/v1/accounts:lookup",e)}function jd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wk(n,e=!1){let t=Tn(n),i=await t.getIdToken(e),r=S1(i);je(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:jd(r1(r.auth_time)),issuedAtTime:jd(r1(r.iat)),expirationTime:jd(r1(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function r1(n){return Number(n)*1e3}function S1(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Um("JWT malformed, contained fewer than 3 sections"),null;try{let r=Rg(t);return r?JSON.parse(r):(Um("Failed to decode base64 JWT payload"),null)}catch(r){return Um("Caught error parsing JWT payload as JSON",r?.toString()),null}}function rk(n){let e=S1(n);return je(e,"internal-error"),je(typeof e.exp<"u","internal-error"),je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function $d(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof vi&&W7(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function W7({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var l1=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Gd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jd(this.lastLoginAt),this.creationTime=jd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Wm(n){let e=n.auth,t=await n.getIdToken(),i=await $d(n,zm(e,{idToken:t}));je(i?.users.length,e,"internal-error");let r=i.users[0];n._notifyReloadListener(r);let o=r.providerUserInfo?.length?Sk(r.providerUserInfo):[],s=q7(n.providerData,o),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!s?.length,u=a?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Gd(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function xk(n){let e=Tn(n);await Wm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function q7(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Sk(n){return n.map(i=>{var r=i,{providerId:e}=r,t=Va(r,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function K7(n,e){let t=await Ek(n,{},async()=>{let i=Rl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=await bk(n,r,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return n.emulatorConfig&&rs(n.emulatorConfig.host)&&(l.credentials="include"),Gm.fetch()(s,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Y7(n,e){return lc(n,"POST","/v2/accounts:revokeToken",x1(n,e))}var Hd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){je(e.idToken,"internal-error"),je(typeof e.idToken<"u","internal-error"),je(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){je(e.length!==0,"internal-error");let t=rk(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:r,expiresIn:o}=await K7(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n;return i&&(je(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(je(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(je(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return So("not implemented")}};function ys(n,e){je(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var vs=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:i}=s,r=Va(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new l1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Gd(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await $d(this,this.stsTokenManager.getToken(this.auth,e));return je(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return wk(this,e)}reload(){return xk(this)}_assign(e){this!==e&&(je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>F({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(pe(F({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Wm(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_i(this.auth.app))return Promise.reject(Ra(this.auth));let e=await this.getIdToken();return await $d(this,z7(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return pe(F({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>F({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:h,emailVerified:p,isAnonymous:g,providerData:x,stsTokenManager:S}=t;je(h&&S,e,"internal-error");let N=Hd.fromJSON(this.name,S);je(typeof h=="string",e,"internal-error"),ys(i,e.name),ys(r,e.name),je(typeof p=="boolean",e,"internal-error"),je(typeof g=="boolean",e,"internal-error"),ys(o,e.name),ys(s,e.name),ys(a,e.name),ys(l,e.name),ys(u,e.name),ys(d,e.name);let U=new n({uid:h,auth:e,email:r,emailVerified:p,displayName:i,isAnonymous:g,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:N,createdAt:u,lastLoginAt:d});return x&&Array.isArray(x)&&(U.providerData=x.map(ie=>F({},ie))),l&&(U._redirectEventId=l),U}static async _fromIdTokenResponse(e,t,i=!1){let r=new Hd;r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Wm(o),o}static async _fromGetAccountInfoResponse(e,t,i){let r=t.users[0];je(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?Sk(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,a=new Hd;a.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Gd(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(l,u),l}};var ok=new Map;function Io(n){To(n instanceof Function,"Expected a class definition");let e=ok.get(n);return e?(To(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ok.set(n,e),e)}var Q7=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,i){this.storage[t]=i}async _get(t){let i=this.storage[t];return i===void 0?null:i}async _remove(t){delete this.storage[t]}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),c1=Q7;function Bm(n,e,t){return`firebase:${n}:${e}:${t}`}var qm=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=Bm(this.userKey,r.apiKey,o),this.fullPersistenceKey=Bm("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await zm(this.auth,{idToken:e}).catch(()=>{});return t?vs._fromGetAccountInfoResponse(this.auth,t,e):null}return vs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new n(Io(c1),e,i);let r=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u),o=r[0]||Io(c1),s=Bm(i,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=await u._get(s);if(d){let h;if(typeof d=="string"){let p=await zm(e,{idToken:d}).catch(()=>{});if(!p)break;h=await vs._fromGetAccountInfoResponse(e,p,d)}else h=vs._fromJSON(e,d);u!==o&&(a=h),o=u;break}}catch{}let l=r.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,i):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new n(o,e,i))}};function sk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Dk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ik(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Mk(e))return"Blackberry";if(Rk(e))return"Webos";if(Tk(e))return"Safari";if((e.includes("chrome/")||Ck(e))&&!e.includes("edge/"))return"Chrome";if(Ak(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Ik(n=In()){return/firefox\//i.test(n)}function Tk(n=In()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ck(n=In()){return/crios\//i.test(n)}function Dk(n=In()){return/iemobile/i.test(n)}function Ak(n=In()){return/android/i.test(n)}function Mk(n=In()){return/blackberry/i.test(n)}function Rk(n=In()){return/webos/i.test(n)}function I1(n=In()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function J7(n=In()){return I1(n)&&!!window.navigator?.standalone}function Z7(){return h2()&&document.documentMode===10}function Pk(n=In()){return I1(n)||Ak(n)||Rk(n)||Mk(n)||/windows phone/i.test(n)||Dk(n)}function Nk(n,e=[]){let t;switch(n){case"Browser":t=sk(In());break;case"Worker":t=`${sk(In())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ls}/${i}`}var u1=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=o=>new Promise((s,a)=>{try{let l=e(o);s(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}};async function X7(n,e={}){return lc(n,"GET","/v2/passwordPolicy",x1(n,e))}var e$=6,d1=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??e$,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var h1=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Km(this),this.idTokenSubscription=new Km(this),this.beforeStateQueue=new u1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_k,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Io(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await qm.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await zm(this,{idToken:e}),i=await vs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(_i(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Wm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=B7()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_i(this.app))return Promise.reject(Ra(this));let t=e?Tn(e):null;return t&&je(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _i(this.app)?Promise.reject(Ra(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _i(this.app)?Promise.reject(Ra(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Io(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await X7(this),t=new d1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Y7(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Io(e)||this._popupRedirectResolver;je(t,this,"argument-error"),this.redirectPersistenceManager=await qm.create(this,[Io(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(je(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{s=!0,l()}}else{let l=e.addObserver(t);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(_i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&F7(`Error while retrieving App Check token: ${e.error}`),e?.token}};function n0(n){return Tn(n)}var Km=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=m2(t=>this.observer=t)}get next(){return je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var T1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function t$(n){T1=n}function n$(n){return T1.loadJS(n)}function i$(){return T1.gapiScript}function kk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Ok(n,e){let t=dd(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(er(o,e??{}))return r;Ur(r,"already-initialized")}return t.initialize({options:e})}function r$(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Io);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Fk(n,e,t){let i=n0(n);je(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=Lk(e),{host:s,port:a}=o$(e),l=a===null?"":`:${a}`,u={url:`${o}//${s}${l}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){je(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),je(er(u,i.config.emulator)&&er(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=u,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,rs(s)?(Ng(`${o}//${s}${l}`),kg("Auth",!0)):r||s$()}function Lk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function o$(n){let e=Lk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:ak(i.substr(o.length+1))}}else{let[o,s]=i.split(":");return{host:o,port:ak(s)}}}function ak(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function s$(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var zd=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return So("not implemented")}_getIdTokenResponse(e){return So("not implemented")}_linkToIdToken(e,t){return So("not implemented")}_getReauthenticationResolver(e){return So("not implemented")}};async function ac(n,e){return G7(n,"POST","/v1/accounts:signInWithIdp",x1(n,e))}var a$="http://localhost",Ym=class n extends zd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ur("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=a,o=Va(a,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return ac(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,ac(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ac(e,t)}buildRequest(){let e={requestUri:a$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Rl(t)}return e}};var Wd=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Qm=class extends Wd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var C1=(()=>{class n extends Qm{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return Ym._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var qd=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){let o=await vs._fromIdTokenResponse(e,i,r),s=lk(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);let r=lk(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})}};function lk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var f1=class n extends vi{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function Vk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?f1._fromErrorAndOperation(n,o,e,i):o})}async function l$(n,e,t=!1){let i=await $d(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return qd._forOperation(n,"link",i)}async function c$(n,e,t=!1){let{auth:i}=n;if(_i(i.app))return Promise.reject(Ra(i));let r="reauthenticate";try{let o=await $d(n,Vk(i,r,e,n),t);je(o.idToken,i,"internal-error");let s=S1(o.idToken);je(s,i,"internal-error");let{sub:a}=s;return je(n.uid===a,i,"user-mismatch"),qd._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ur(i,"user-mismatch"),o}}async function u$(n,e,t=!1){if(_i(n.app))return Promise.reject(Ra(n));let i="signIn",r=await Vk(n,i,e),o=await qd._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}function Uk(n,e,t,i){return Tn(n).onIdTokenChanged(e,t,i)}function Bk(n,e,t){return Tn(n).beforeAuthStateChanged(e,t)}function D1(n,e,t,i){return Tn(n).onAuthStateChanged(e,t,i)}function A1(n){return Tn(n).signOut()}var Jm="__sak";var Zm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jm,"1"),this.storage.removeItem(Jm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var d$=1e3,h$=10,f$=(()=>{class n extends Zm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Pk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);Z7()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,h$):o()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},d$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,i){await super._set(t,i),this.localCache[t]=JSON.stringify(i)}async _get(t){let i=await super._get(t);return this.localCache[t]=JSON.stringify(i),i}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),jk=f$;var p$=(()=>{class n extends Zm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),M1=p$;function g$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var m$=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let i=t,{eventId:r,eventType:o,data:s}=i.data,a=this.handlersMap[o];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let l=Array.from(a).map(async d=>d(i.origin,s)),u=await g$(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:u})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function R1(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var p1=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{let u=R1("",20);r.port1.start();let d=setTimeout(()=>{l(new Error("unsupported_event"))},i);s={messageChannel:r,onMessage(h){let p=h;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(p.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function Vr(){return window}function y$(n){Vr().location.href=n}function Hk(){return typeof Vr().WorkerGlobalScope<"u"&&typeof Vr().importScripts=="function"}async function v$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _$(){return navigator?.serviceWorker?.controller||null}function E$(){return Hk()?self:null}var $k="firebaseLocalStorageDb",b$=1,Xm="firebaseLocalStorage",Gk="fbase_key",Na=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function i0(n,e){return n.transaction([Xm],e?"readwrite":"readonly").objectStore(Xm)}function w$(){let n=indexedDB.deleteDatabase($k);return new Na(n).toPromise()}function g1(){let n=indexedDB.open($k,b$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(Xm,{keyPath:Gk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{let i=n.result;i.objectStoreNames.contains(Xm)?e(i):(i.close(),await w$(),e(await g1()))})})}async function ck(n,e,t){let i=i0(n,!0).put({[Gk]:e,value:t});return new Na(i).toPromise()}async function x$(n,e){let t=i0(n,!1).get(e),i=await new Na(t).toPromise();return i===void 0?null:i.value}function uk(n,e){let t=i0(n,!0).delete(e);return new Na(t).toPromise()}var S$=800,I$=3,T$=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await g1(),this.db)}async _withRetries(t){let i=0;for(;;)try{let r=await this._openDb();return await t(r)}catch(r){if(i++>I$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=m$._getInstance(E$()),this.receiver._subscribe("keyChanged",async(t,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(t,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await v$(),!this.activeServiceWorker)return;this.sender=new p1(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||_$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await g1();return await ck(t,Jm,"1"),await uk(t,Jm),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,i){return this._withPendingWrite(async()=>(await this._withRetries(r=>ck(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)))}async _get(t){let i=await this._withRetries(r=>x$(r,t));return this.localCache[t]=i,i}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(i=>uk(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=i0(o,!1).getAll();return new Na(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),S$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),zk=T$;var ahe=kk("rcb"),lhe=new Pa(3e4,6e4);function Wk(n,e){return e?Io(e):(je(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Kd=class extends zd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ac(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ac(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ac(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function C$(n){return u$(n.auth,new Kd(n),n.bypassAuthState)}function D$(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),c$(t,new Kd(n),n.bypassAuthState)}async function A$(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),l$(t,new Kd(n),n.bypassAuthState)}var e0=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return C$;case"linkViaPopup":case"linkViaRedirect":return A$;case"reauthViaPopup":case"reauthViaRedirect":return D$;default:Ur(this.auth,"internal-error")}}resolve(e){To(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){To(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var M$=new Pa(2e3,1e4);async function P1(n,e,t){if(_i(n.app))return Promise.reject(or(n,"operation-not-supported-in-this-environment"));let i=n0(n);L7(n,e,Wd);let r=Wk(i,t);return new R$(i,"signInViaPopup",e,r).executeNotNull()}var R$=(()=>{class n extends e0{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return je(t,this.auth,"internal-error"),t}async onExecution(){To(this.filter.length===1,"Popup operations only handle one event");let t=R1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(or(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(or(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(or(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,M$.get())};t()}}n.currentPopupAction=null;return n})(),P$="pendingRedirect",jm=new Map,m1=class extends e0{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=jm.get(this.auth._key());if(!e){try{let i=await N$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}jm.set(this.auth._key(),e)}return this.bypassAuthState||jm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function N$(n,e){let t=F$(e),i=O$(n);if(!await i._isAvailable())return!1;let r=await i._get(t)==="true";return await i._remove(t),r}function k$(n,e){jm.set(n._key(),e)}function O$(n){return Io(n._redirectPersistence)}function F$(n){return Bm(P$,n.config.apiKey,n.name)}async function L$(n,e,t=!1){if(_i(n.app))return Promise.reject(Ra(n));let i=n0(n),r=Wk(i,e),s=await new m1(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}var V$=600*1e3,y1=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!U$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!qk(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(or(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=V$&&this.cachedEventUids.clear(),this.cachedEventUids.has(dk(e))}saveEventToCache(e){this.cachedEventUids.add(dk(e)),this.lastProcessedEventTime=Date.now()}};function dk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function U$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qk(n);default:return!1}}async function B$(n,e={}){return lc(n,"GET","/v1/projects",e)}var j$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,H$=/^https?/;async function $$(n){if(n.config.emulator)return;let{authorizedDomains:e}=await B$(n);for(let t of e)try{if(G$(t))return}catch{}Ur(n,"unauthorized-domain")}function G$(n){let e=s1(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i}if(!H$.test(t))return!1;if(j$.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var z$=new Pa(3e4,6e4);function hk(){let n=Vr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function W$(n){return new Promise((e,t)=>{function i(){hk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hk(),t(or(n,"network-request-failed"))},timeout:z$.get()})}if(Vr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Vr().gapi?.load)i();else{let r=kk("iframefcb");return Vr()[r]=()=>{gapi.load?i():t(or(n,"network-request-failed"))},n$(`${i$()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw Hm=null,e})}var Hm=null;function q$(n){return Hm=Hm||W$(n),Hm}var K$=new Pa(5e3,15e3),Y$="__/auth/iframe",Q$="emulator/auth/iframe",J$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Z$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function X$(n){let e=n.config;je(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?w1(e,Q$):`https://${n.config.authDomain}/${Y$}`,i={apiKey:e.apiKey,appName:n.name,v:ls},r=Z$.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Rl(i).slice(1)}`}async function eG(n){let e=await q$(n),t=Vr().gapi;return je(t,n,"internal-error"),e.open({where:document.body,url:X$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:J$,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});let s=or(n,"network-request-failed"),a=Vr().setTimeout(()=>{o(s)},K$.get());function l(){Vr().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{o(s)})}))}var tG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nG=500,iG=600,rG="_blank",oG="http://localhost",t0=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function sG(n,e,t,i=nG,r=iG){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=pe(F({},tG),{width:i.toString(),height:r.toString(),top:o,left:s}),u=In().toLowerCase();t&&(a=Ck(u)?rG:t),Ik(u)&&(e=e||oG,l.scrollbars="yes");let d=Object.entries(l).reduce((p,[g,x])=>`${p}${g}=${x},`,"");if(J7(u)&&a!=="_self")return aG(e||"",a),new t0(null);let h=window.open(e||"",a,d);je(h,n,"popup-blocked");try{h.focus()}catch{}return new t0(h)}function aG(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var lG="__/auth/handler",cG="emulator/auth/handler",uG=encodeURIComponent("fac");async function fk(n,e,t,i,r,o){je(n.config.authDomain,n,"auth-domain-config-required"),je(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ls,eventId:r};if(e instanceof Wd){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",g2(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(o||{}))s[d]=h}if(e instanceof Qm){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let l=await n._getAppCheckToken(),u=l?`#${uG}=${encodeURIComponent(l)}`:"";return`${dG(n)}?${Rl(a).slice(1)}${u}`}function dG({config:n}){return n.emulator?w1(n,cG):`https://${n.authDomain}/${lG}`}var o1="webStorageSupport",v1=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=M1,this._completeRedirectFn=L$,this._overrideRedirectResult=k$}async _openPopup(e,t,i,r){To(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await fk(e,t,i,s1(),r);return sG(e,o,R1())}async _openRedirect(e,t,i,r){await this._originValidation(e);let o=await fk(e,t,i,s1(),r);return y$(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(To(o,"If manager is not set, promise should be"),o)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await eG(e),i=new y1(e);return t.register("authEvent",r=>(je(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(o1,{type:o1},r=>{let o=r?.[0]?.[o1];o!==void 0&&t(!!o),Ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Pk()||Tk()||I1()}},Kk=v1;var pk="@firebase/auth",gk="1.12.0";var _1=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function hG(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fG(n){as(new Pi("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=i.options;je(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nk(n)},u=new h1(i,r,o,l);return r$(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),as(new Pi("auth-internal",e=>{let t=n0(e.getProvider("auth").getImmediate());return(i=>new _1(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),tr(pk,gk,hG(n)),tr(pk,gk,"esm2020")}var pG=300,gG=Cb("authIdTokenMaxAge")||pG,mk=null,mG=n=>async e=>{let t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>gG)return;let r=t?.token;mk!==r&&(mk=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Yd(n=Vg()){let e=dd(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Ok(n,{popupRedirectResolver:Kk,persistence:[zk,jk,M1]}),i=Cb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=mG(o.toString());Bk(t,s,()=>s(t.currentUser)),Uk(t,a=>s(a))}}let r=Ib("auth");return r&&Fk(t,`http://${r}`),t}function yG(){return document.getElementsByTagName("head")?.[0]??document}t$({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=or("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",yG().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fG("Browser");var r0={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var Br=class n{constructor(e){this.platformId=e;let t=hd(r0);try{this.db=Vd(t)}catch(i){console.warn("Firestore init failed (likely SSR)",i)}if(es(this.platformId))try{this.auth=Yd(t),D1(this.auth,i=>{this.user$.set(i)})}catch(i){console.warn("Auth init failed",i)}}db=null;auth=null;user$=$(null);async loginWithGoogle(){if(!(!this.auth||!es(this.platformId)))try{let e=new C1;await P1(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await A1(this.auth)}async saveHighScore(e){if(this.db)try{await Lm(rr(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,i){if(!this.db)return[];try{let r=gs(rr(this.db,"highscores"),ms("difficulty","==",t),ms("mapSize","==",i),xo("victory","desc"),xo("turnsPlayed","asc"),Aa(e));return(await Ma(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching scores: ",r),[]}}async getUserScores(e){if(!this.db)return[];try{let t=gs(rr(this.db,"highscores"),ms("userId","==",e),ms("victory","==",!0),xo("turnsPlayed","asc"));return(await Ma(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}static \u0275fac=function(t){return new(t||n)(Me(qi))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var cc=class n{platformId=z(qi);nameSignal=$("Player");constructor(){if(es(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),es(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let i=(e??"").toString().trim().slice(0,24);return i.length>0?i:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var ni=class n{constructor(e,t,i,r,o,s,a,l,u){this.combat=e;this.build=t;this.log=i;this.settings=r;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=l;this.playerName=u;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}breakpointObserver=z(bb);screenState=qR(this.breakpointObserver.observe("(max-width: 1024px)").pipe(yt(e=>e.matches)),{initialValue:!1});unitsSignal=$([]);turnSignal=$(1);selectedUnitIdSignal=$(null);gameStatusSignal=$("playing");lastMergedUnitIdSignal=$(null);lastRemainderUnitIdSignal=$(null);resourcesSignal=$({wood:0,iron:0});forestsSignal=$([]);minesSignal=$([]);forgeSitesSignal=$([]);forgesSignal=$([]);aiForgesSignal=$([]);baseHealthSignal=$({player:100,ai:100});reservePointsSignal=$({player:0,ai:0});deployTargetsSignal=$([]);baseDeployActiveSignal=$(!1);wallsSignal=$([]);playerVisibilitySignal=$(new Set);aiVisibilitySignal=$(new Set);playerExploredSignal=$(new Set);aiExploredSignal=$(new Set);unitMoveHistorySignal=$(new Map);unitStutterBanSignal=$(new Map);lastAiMovedUnitIdSignal=$(null);aiConsecMovesSignal=$(0);buildModeSignal=$(!1);fogDebugDisabledSignal=$(!1);wallBuiltThisTurnSignal=$(!1);rulesOpenSignal=$(!1);movedThisTurnSignal=$(new Set);hoveredFormationIdSignal=$(null);aiWoodSignal=$(0);aiIronSignal=$(0);logsOpenSignal=$(!1);settingsOpenSignal=$(!1);activeSideSignal=$("ai");lastArrivedUnitIdSignal=$(null);attackerNudgeSignal=$(null);shakenUnitIdSignal=$(null);shakenWallIdSignal=$(null);pulseUnitIdSignal=$(null);screenShakeSignal=$(!1);endOverlaySignal=$(!1);endReasonSignal=$(null);combatOnlySignal=$(!0);forestMonopolySignal=$({player:0,ai:0});hoveredUnitIdSignal=$(null);autoDeployEnabledSignal=$(!1);highScoresOpenSignal=$(!1);leaderboardOpenSignal=$(!1);namePromptOpenSignal=$(!1);pendingScoreSignal=$(null);supportOpenSignal=$(!1);highScoresSignal=$({});playerConvertedThisTurnSignal=$(!1);unitQuadrantBiasSignal=$(new Map);aiUnitTimeNearBaseSignal=$(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=$(!1);wallCooldownSignal=$(new Map);aiQueuedUnitIdSignal=$(null);aiMoodSignal=$("none");rageCaptureCounterSignal=$(0);anchoredGatherersSignal=$(new Set);totalWarModeSignal=$(!1);aiInvalidActionCountSignal=$(0);aiLastRejectedActionKeySignal=$(null);sandboxSpawnPendingSignal=$(null);unitMoveOffsetSignal=$(new Map);movingUnitsSignal=$(new Set);attackingUnitsSignal=$(new Set);reclamationGoalsSignal=$(new Map);mergeIntentSignal=$(new Map);ignoreForgeUntilTurnSignal=$(new Map);playerClaimedTargetsSignal=$(new Set);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();mines=this.minesSignal.asReadonly();forges=this.forgesSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();isMobile=Xn(()=>this.screenState());sandboxSpawnPending(){return this.sandboxSpawnPendingSignal()}getMoveOffsetFor(e){return this.unitMoveOffsetSignal().get(e)??null}isUnitMoving(e){return this.movingUnitsSignal().has(e)}isUnitAttacking(e){return this.attackingUnitsSignal().has(e)}getCombinedTransform(e){let t=this.attackerNudgeSignal(),i=this.getMoveOffsetFor(e),r=(t&&t.id===e?t.dx:0)+(i?i.dx:0),o=(t&&t.id===e?t.dy:0)+(i?i.dy:0);return`translate(${r}px, ${o}px)`}aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=Xn(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=Xn(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?this.isMobile()?4:6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?12:16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(r=>r.owner==="player"&&this.isForest(r.position.x,r.position.y)).length,i=this.unitsSignal().filter(r=>r.owner==="ai"&&this.isForest(r.position.x,r.position.y)).length;return{total:e,player:t,ai:i}}resetGame(){let e=this.settings.difficulty();this.stopAiLoops(),this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0,iron:0}),this.baseHealthSignal.set(this.settings.customMode()?{player:1e3,ai:1e3}:{player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:5,ai:5}):e==="normal"?this.reservePointsSignal.set({player:1,ai:1}):e==="hard"?this.reservePointsSignal.set({player:1,ai:3}):this.reservePointsSignal.set({player:1,ai:5}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"))),this.minesSignal.set(this.map.generateMines(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"),this.forestsSignal())),this.forgeSitesSignal.set([]),this.forgesSignal.set([]),this.aiForgesSignal.set([]);let t=new Set(this.forestsSignal().map(i=>`${i.x},${i.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(i=>i.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(r=>r.x===e.x&&r.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let i=!1,r=!1,o=null;this.unitsSignal.update(p=>{let g=[...p],x=g.findIndex(I=>I.id===e.id);if(x===-1)return p;let S=F({},g[x]),N={x:S.position.x,y:S.position.y},U=t.x-N.x,ie=t.y-N.y,Se=Math.sign(U),xe=Math.sign(ie),De=this.combat.checkWallAlongPath(N,t,S.owner,(I,P,D,w)=>this.getWallBetween(I,P,D,w));if(De.hitOwn)return g;if(De.hitEnemy){let I=De.lastFrom,P=this.getWallBetween(I.x,I.y,t.x,t.y);{let w=P.maxHealth??100,R=this.combat.getWallHitAmount(S.tier),M=Math.max(0,P.health-R);this.wallsSignal.update(Oe=>Oe.map(fe=>fe.id===P.id?pe(F({},fe),{health:M}):fe).filter(fe=>(fe.health??fe.hitsRemaining??0)>0)),M<=0&&this.registerWallDestroyedEdge(I,t);let ge=P.owner==="neutral"?"Neutral":P.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${S.tier} Unit attacked ${ge} Wall. Damage: ${R}. Wall HP: ${M}/${w}.`)}this.updateWallFormations(),this.shakenWallIdSignal.set(P.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let D=g.findIndex(w=>w.id===S.id);return D!==-1&&(g[D]=pe(F({},g[D]),{hasActed:!0})),g}let Ie=this.getBasePosition(S.owner==="player"?"ai":"player");if(t.x===Ie.x&&t.y===Ie.y)return this.baseHealthSignal.update(I=>{let P=S.owner==="player"?"ai":"player",D=F({},I);return D[P]=Math.max(0,D[P]-this.calculatePower(S)),D}),g.splice(x,1),g;let k=g.findIndex(I=>I.position.x===t.x&&I.position.y===t.y&&I.id!==S.id);if(k!==-1){let I=g[k],P={x:t.x-Se,y:t.y-xe};if(this.inBounds(P.x,P.y)){if(Se!==0&&xe!==0){if(this.combat.isDiagonalBlocked(P,t,(D,w,R,M)=>this.getWallBetween(D,w,R,M)))return i=!1,g}else if(this.getWallBetween(P.x,P.y,t.x,t.y))return i=!1,g}if(I.owner===S.owner)if(this.shakenUnitIdSignal.set(S.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),I.tier===S.tier){let D=I.tier,w=this.calculateTotalPoints(S)+this.calculateTotalPoints(I),R={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},M=R[D][3];if(w<=M){I.points=w;let Oe=this.calculateTierAndLevel(I.points);I.tier=Oe.tier,I.level=Oe.level;let fe=!!(I.hasWeapon||S.hasWeapon),Ft=!!(I.hasArmor||S.hasArmor),Zt=Ft?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=fe,I.hasArmor=Ft,I.armorHp=Zt,g.splice(x,1)}else{let Oe=Math.min(4,D+1),fe=R[Oe][0];I.points=fe;let Ft=this.calculateTierAndLevel(I.points);I.tier=Ft.tier,I.level=Ft.level;let Zt=!!(I.hasWeapon||S.hasWeapon),Ae=!!(I.hasArmor||S.hasArmor),Ht=Ae?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=Zt,I.hasArmor=Ae,I.armorHp=Ht;let at=w-fe;if(at>0){S.points=at;let te=this.calculateTierAndLevel(S.points);S.tier=te.tier,S.level=te.level,S.hasWeapon=!1,S.hasArmor=!1,S.armorHp=0,g[x]=S,o=S.id}else g.splice(x,1)}r=!0;let ge=new Map(this.mergeIntentSignal());ge.delete(S.id),ge.delete(I.id),this.mergeIntentSignal.set(ge)}else return g;else{{let te=t.x-N.x,ne=t.y-N.y,Ee=Math.abs(te)>=Math.abs(ne),ve=Math.sign(Ee?te:ne),me=this.wallThicknessPx+2,v=this.tileSizePx+me,se=Math.round(v*.35),We=Ee?ve*se:0,qe=Ee?0:ve*se,oe=new Set(this.attackingUnitsSignal());oe.add(S.id),this.attackingUnitsSignal.set(oe),this.attackerNudgeSignal.set({id:S.id,dx:We,dy:qe}),setTimeout(()=>{this.attackerNudgeSignal.set({id:S.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let bt=new Set(this.attackingUnitsSignal());bt.delete(S.id),this.attackingUnitsSignal.set(bt)},200)}this.shakenUnitIdSignal.set(I.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let D=this.combat.calculateHitChance(S,I);if(Math.floor(Math.random()*100)+1>D)return this.queueCombatText("DEFLECTED!",t),this.log.addCombat(S.owner,`[Combat] DEFLECTED! T${S.tier} failed to penetrate T${I.tier}. Attacker destroyed.`,!1),g.splice(x,1),g;this.log.addCombat(S.owner,`[Combat] HIT! T${S.tier} breached T${I.tier} armor.`,!1);let R=this.calculateTotalPoints(S)+(S.hasWeapon?20:0),M=this.getAttackLuckModifier(S),ge=this.calculateTotalPoints(I),Oe=this.combat.getDefenseBonus(I,g),fe=Math.max(0,R+M.delta),Ft=ge+Oe.bonus,Zt=S.hasWeapon?"Weapon +20":"",Ae=[...Oe.tags,M.tag??"",Zt].filter(Boolean).join(", ")||"None",Ht=fe-Ft,at=`[Turn ${this.turnSignal()}] ${S.owner==="player"?"Player":"AI"} T${S.tier}(L${S.level}) attacked ${I.owner==="player"?"Player":"AI"} T${I.tier}(L${I.level}). Power: ${R} vs ${ge}. Modifiers: ${Ae}. Final: (${R}${M.delta!==0?M.delta>0?`+${M.delta}`:`${M.delta}`:""}${Oe.bonus>0?` - ${Oe.bonus}`:""}) - ${ge} = ${Ht}.`;if(this.log.addCombat(S.owner,at,!!M.isCrit),fe<Ft&&this.queueCombatText("WEAK!",t),fe>Ft){let te=this.combat.calculateHitChance(I,S),Ee=Math.floor(Math.random()*100)+1<=te,ve=Ee?ge:0;if(ve>0){let me=this.combat.applyDamage(S,ve);S.points=me.points,S.tier=me.tier,S.level=me.level,S.armorHp=me.armorHp}Ee||this.log.addCombat(S.owner,`[Combat] T${S.tier} armor deflected the counter-attack from T${I.tier}. Final HP: ${S.points}`,!1),g.splice(k,1),M.tag&&this.queueCombatText(M.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(fe<Ft){let te=fe,ne=this.combat.applyDamage(I,te),Ee=F({},ne);return g[k]=Ee,g.splice(x,1),g}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),g.filter(ne=>ne.id!==S.id&&ne.id!==I.id);{let ne=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),ne){let Ee=this.getPointsForTierLevel(S.tier,1);S.points=Ee;let ve=this.calculateTierAndLevel(Ee);S.tier=ve.tier,S.level=ve.level,g.splice(k,1),this.pulseUnitIdSignal.set(S.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let Ee=this.getPointsForTierLevel(I.tier,1),ve=pe(F({},I),{points:Ee}),me=this.calculateTierAndLevel(Ee);return ve.tier=me.tier,ve.level=me.level,g[k]=ve,g.splice(x,1),this.pulseUnitIdSignal.set(ve.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),g}}}}}if(g.find(I=>I.id===S.id)&&o!==S.id){S.position=t,S.turnsStationary=0,S.hasActed=!0;let I=g.findIndex(Oe=>Oe.id===S.id);I!==-1&&(g[I]=S),S.owner==="ai"&&S.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(S.id,{x:t.x,y:t.y}),S.tier<=2&&this.anchorGatherer(S.id));let P=new Set(this.movedThisTurnSignal());P.add(S.id),this.movedThisTurnSignal.set(P),this.lastArrivedUnitIdSignal.set(S.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let D=new Map(this.unitMoveHistorySignal()),w=D.get(S.id)??[],R={x:N.x,y:N.y},M={x:t.x,y:t.y},ge=[...w,R,M].slice(-4);D.set(S.id,ge),this.unitMoveHistorySignal.set(D)}return g});let s=t.x-e.position.x,a=t.y-e.position.y,l=this.wallThicknessPx+2,u=this.tileSizePx+l,d={dx:-s*u,dy:-a*u};if(s!==0||a!==0){let p=new Map(this.unitMoveOffsetSignal());p.set(e.id,d),this.unitMoveOffsetSignal.set(p);let g=new Set(this.movingUnitsSignal());g.add(e.id),this.movingUnitsSignal.set(g),setTimeout(()=>{let x=new Map(this.unitMoveOffsetSignal());x.set(e.id,{dx:0,dy:0}),this.unitMoveOffsetSignal.set(x),setTimeout(()=>{let S=new Map(this.unitMoveOffsetSignal());S.delete(e.id),this.unitMoveOffsetSignal.set(S);let N=new Set(this.movingUnitsSignal());N.delete(e.id),this.movingUnitsSignal.set(N)},180)},0)}if(r){let p=this.getUnitAt(t.x,t.y);p&&(this.lastMergedUnitIdSignal.set(p.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(N=>N+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let x=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(x.length>=4&&x[0].x===x[2].x&&x[0].y===x[2].y&&x[1].x===x[3].x&&x[1].y===x[3].y&&(x[0].x!==x[1].x||x[0].y!==x[1].y)){let N=new Map(this.unitStutterBanSignal()),U=new Set([`${x[0].x},${x[0].y}`,`${x[1].x},${x[1].y}`]);N.set(e.id,{tiles:U,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(N);let ie={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},xe=(this.getQuadrant(e.position,ie)+2)%4,De=new Map(this.unitQuadrantBiasSignal());De.set(e.id,{quadrant:xe,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(De)}}let h=this.selectedUnitIdSignal();h&&!this.unitsSignal().some(p=>p.id===h)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility(),e.owner==="player"&&this.selectNextAvailableUnit()}selectNextAvailableUnit(){let t=this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((i,r)=>{let o=this.isForest(i.position.x,i.position.y)||this.isMine(i.position.x,i.position.y)?1:0,s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0;return o!==s?o-s:0}),this.selectUnit(t[0].id)}selectNextAvailableUnitTab(){let t=this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((r,o)=>{let s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0,a=this.isForest(o.position.x,o.position.y)||this.isMine(o.position.x,o.position.y)?1:0;return s!==a?s-a:r.id.localeCompare(o.id)});let i=this.selectedUnitId();if(!i)this.selectUnit(t[0].id);else{let r=t.findIndex(o=>o.id===i);if(r===-1)this.selectUnit(t[0].id);else{let o=(r+1)%t.length;this.selectUnit(t[o].id)}}}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}effectiveAttack(e){return this.calculateTotalPoints(e)+(e.hasWeapon?20:0)}effectiveDefense(e){return(e.points??0)+(e.armorHp??0)}computeSideEffectivePower(e){let t=this.unitsSignal().filter(r=>r.owner===e),i=0;for(let r of t)i+=this.effectiveAttack(r);return i}getWood(e){return e==="ai"?this.aiWoodSignal():this.resourcesSignal().wood}getIron(e){return e==="ai"?this.aiIronSignal():this.resourcesSignal().iron}getForges(e){return e==="ai"?this.aiForgesSignal():this.forgesSignal()}buyArmorGeneric(e,t){e==="ai"?this.aiBuyArmor(t):this.buyArmor(t)}buyWeaponGeneric(e,t){e==="ai"?this.aiBuyWeapon(t):this.buyWeapon(t)}isUnitInDanger(e){let t=this.getNeighbors(e.position);for(let i of t){let r=this.getUnitAt(i.x,i.y);if(r&&r.owner!==e.owner){let o=this.effectiveAttack(r),s=this.effectiveDefense(e),a=e.hasWeapon?e.tier>=3?20:10:0;if(o>s+a)return!0}}return!1}findSafeMove(e,t){let i=this.getBasePosition("ai");return t.length===0?null:t.reduce((r,o)=>{let s=Math.abs(o.x-i.x)+Math.abs(o.y-i.y),a=Math.abs(r.x-i.x)+Math.abs(r.y-i.y);return s<a?o:r},t[0])}findResourceTarget(e,t){let i=this.forestsSignal(),r=this.minesSignal(),o=this.turnSignal()<=20,s=i.filter(x=>{let S=`${x.x},${x.y}`;if(t.claimedTargets.has(S))return!1;let N=this.getUnitAt(x.x,x.y);return!(N&&N.owner==="ai")}),a=r.filter(x=>{let S=`${x.x},${x.y}`;if(t.claimedTargets.has(S))return!1;let N=this.getUnitAt(x.x,x.y);return!(N&&N.owner==="ai")}),l=s.filter(x=>!this.getUnitAt(x.x,x.y)),u=a.filter(x=>!this.getUnitAt(x.x,x.y));if(o){if(l.length>0)return l.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),l[0];if(u.length>0)return u.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),u[0]}else{let x=[...l,...u];if(x.length>0)return x.sort((S,N)=>{let U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),ie=Math.abs(N.x-e.position.x)+Math.abs(N.y-e.position.y);return U-ie}),x[0]}let d=s.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&S.owner==="player"}),p=a.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&S.owner==="player"}).filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&e.tier>=S.tier}),g=d.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&e.tier>=S.tier});if(o){if(g.length>0)return g.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),g[0];if(p.length>0)return p.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),p[0]}else{let x=[...g,...p];if(x.length>0)return x.sort((S,N)=>{let U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),ie=Math.abs(N.x-e.position.x)+Math.abs(N.y-e.position.y);return U-ie}),x[0]}return d.length>0?(d.sort((x,S)=>{let N=this.getUnitAt(x.x,x.y),U=this.getUnitAt(S.x,S.y),ie=N?N.tier:99,Se=U?U.tier:99;if(ie!==Se)return ie-Se;let xe=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),De=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return xe-De}),d[0]):null}findDefensiveWallTarget(e){let t=this.getNeighbors(e.position),r=this.unitsSignal().filter(u=>u.owner==="player").filter(u=>Math.abs(u.position.x-e.position.x)+Math.abs(u.position.y-e.position.y)<=5);if(r.length===0)return null;let o=0,s=0;r.forEach(u=>{o+=u.position.x,s+=u.position.y}),o/=r.length,s/=r.length;let a=null,l=-1/0;for(let u of t){if(this.getWallBetween(e.position.x,e.position.y,u.x,u.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(u)||this.isEdgeOnCooldown(e.position,u))continue;let d=u.x-e.position.x,h=u.y-e.position.y,p=o-e.position.x,g=s-e.position.y,x=d*p+h*g;x>l&&(l=x,a=u)}return l>0?a:null}findBlockingWall(e,t){let i=this.bfsPath(e,t,{respectWalls:!1});if(!i||i.length<2)return null;for(let r=0;r<i.length-1;r++){let o=i[r],s=i[r+1],a=this.getWallBetween(o.x,o.y,s.x,s.y);if(a)return{pos:s,wall:a}}return null}findDefensiveWallTargetForOwner(e,t){let i=this.getNeighbors(e.position),r=t==="player"?"ai":"player",s=this.unitsSignal().filter(h=>h.owner===r).filter(h=>Math.abs(h.position.x-e.position.x)+Math.abs(h.position.y-e.position.y)<=5);if(s.length===0)return null;let a=0,l=0;s.forEach(h=>{a+=h.position.x,l+=h.position.y}),a/=s.length,l/=s.length;let u=null,d=-1/0;for(let h of i){if(this.getWallBetween(e.position.x,e.position.y,h.x,h.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(h)||this.isEdgeOnCooldown(e.position,h))continue;let p=h.x-e.position.x,g=h.y-e.position.y,x=a-e.position.x,S=l-e.position.y,N=p*x+g*S;N>d&&(d=N,u=h)}return d>0?u:null}getNextStepTowards(e,t,i,r){if(i.length===0)return null;let o=l=>{let u=Math.abs(l.x-t.x)+Math.abs(l.y-t.y);if(r?.noCohesion&&!r?.antiClump&&!r?.fogBonus)return u*10;let h=this.getNeighbors(l).filter(g=>{let x=this.getUnitAt(g.x,g.y);return x&&x.owner===e.owner}).length,p=u*10;return r?.antiClump?p+=h*3:r?.noCohesion||(p-=h*2),r?.fogBonus&&!this.isVisibleToPlayer(l.x,l.y)&&e.owner==="player"&&(p-=3),p},s=null,a=1/0;for(let l of i){let u=o(l);u<a&&(a=u,s=l)}return s}findPlayerResourceTarget(e){let t=this.turnSignal(),i=this.forestsSignal(),r=this.minesSignal(),o=this.playerClaimedTargetsSignal(),s=g=>`${g.x},${g.y}`,a=g=>!this.getUnitAt(g.x,g.y),l=g=>{let x=this.getUnitAt(g.x,g.y);return!!(x&&x.owner==="player")},u=i.filter(g=>!o.has(s(g))),d=r.filter(g=>!o.has(s(g))),h=(g,x)=>{let S=Math.abs(g.x-e.position.x)+Math.abs(g.y-e.position.y),N=l(g)?100:0,U=t<=15&&x==="forest"?-5:0;return S*10+N+(a(g)?0:20)+U},p=[...u.map(g=>({p:g,t:"forest",s:h(g,"forest")})),...d.map(g=>({p:g,t:"mine",s:h(g,"mine")}))];return p.length===0?null:(p.sort((g,x)=>g.s-x.s),p[0].p)}findCombatTarget(e,t,i){let r=t.priorityTargets.find(u=>Math.max(Math.abs(u.position.x-e.position.x),Math.abs(u.position.y-e.position.y))<=5);if(r&&!this.bfsPath(e.position,r.position,{respectWalls:!0})){let d=this.findBlockingWall(e.position,r.position);if(d)return this.appendLog(`[Obstacle Smash] T${e.tier} targeting wall at (${d.pos.x},${d.pos.y}) blocking path to high-value target`),d.pos}let o=t.priorityTargets.filter(u=>i.some(d=>d.x===u.position.x&&d.y===u.position.y));if(o.length>0){let u=o.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d));return u.length>0?(u.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),u[0].position):(o.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),o[0].position)}let s=this.getNeighbors(e.position),a=[];for(let u of s){let d=this.getWallBetween(e.position.x,e.position.y,u.x,u.y);if(!d||d.owner===e.owner)continue;let h=d.maxHealth??100,p=100-(h-100);h>200&&!e.hasWeapon&&(p-=150),e.hasWeapon&&(p+=40),(d.formationSize??1)<=2&&(p+=30),a.push({pos:u,score:p})}if(a.length>0)return a.sort((u,d)=>d.score-u.score),a[0].pos;let l=i.map(u=>{let d=this.getUnitAt(u.x,u.y);return!d||d.owner===e.owner?null:{pos:u,enemy:d}}).filter(Boolean);if(l.length>0){let u=l.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d.enemy));return u.length>0?(u.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),u[0].pos):(l.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),l[0].pos)}return null}findFallbackMove(e,t,i){if(t.length===0)return null;let r=Math.abs(e.position.x-i.x)+Math.abs(e.position.y-i.y),o=null,s=1/0;for(let a of t){let l=Math.abs(a.x-i.x)+Math.abs(a.y-i.y);l<s&&(s=l,o=a)}if(!o)return null;if(s>r){let a=this.isUnitInDanger(e),l=!1;if(a&&(l=this.getNeighbors(e.position).some(d=>{let h=this.getUnitAt(d.x,d.y);return!h||h.owner===e.owner?!1:this.effectiveAttack(h)>this.effectiveDefense(e)})),!l)return null}return o}isTileThreatenedByEnemy(e,t){let i=this.getNeighbors(t);for(let r of i){let o=this.getUnitAt(r.x,r.y);if(o&&o.owner!==e.owner&&this.effectiveAttack(o)>=this.effectiveDefense(e))return!0}return!1}getMergePartnerForUnit(e,t){let r=this.reclamationGoalsSignal().get(e.id);if(r&&r.type==="merge"){let u=this.getUnitAt(r.target.x,r.target.y);if(u&&u.owner===e.owner&&u.tier===e.tier)return u}let s=this.mergeIntentSignal().get(e.id);if(s){let u=this.unitsSignal().find(d=>d.id===s);if(u&&u.owner===e.owner&&u.tier===e.tier)return u}let a=this.unitsSignal().find(u=>u.owner===e.owner&&u.tier===e.tier&&(u.position.x!==e.position.x||u.position.y!==e.position.y)&&t.some(d=>d.x===u.position.x&&d.y===u.position.y));if(a)return a;let l=this.unitsSignal().filter(u=>u.owner===e.owner&&u.tier===e.tier&&(u.position.x!==e.position.x||u.position.y!==e.position.y));for(let u of l){let d=this.getNextStepTowards(e,u.position,t);if(!d)continue;let h=this.calculateValidMoves(u),p=this.getNextStepTowards(u,e.position,h);if(!p)continue;let g=Math.abs(e.position.x-u.position.x)+Math.abs(e.position.y-u.position.y);if(Math.abs(d.x-p.x)+Math.abs(d.y-p.y)<g)return u}return null}computeHighestTierNeedingUpgrade(){let e=this.unitsSignal().filter(t=>t.owner==="ai"&&t.tier>=2&&(!t.hasArmor||!t.hasWeapon));return e.length===0?0:e.reduce((t,i)=>Math.max(t,i.tier),0)}getNeighbors(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}].filter(t=>this.inBounds(t.x,t.y))}bfsPath(e,t,i){let r=[{pos:e,path:[e]}],o=new Set;o.add(`${e.x},${e.y}`);let s=0;for(;r.length>0&&s<500;){s++;let a=r.shift();if(a.pos.x===t.x&&a.pos.y===t.y)return a.path;let l=this.getNeighbors(a.pos);for(let u of l){let d=`${u.x},${u.y}`;if(!o.has(d)){if(i?.avoidFriendlyUnits){let h=this.getUnitAt(u.x,u.y);if(h&&h.owner==="ai")continue}if(i?.respectWalls&&this.getWallBetween(a.pos.x,a.pos.y,u.x,u.y))continue;o.add(d),r.push({pos:u,path:[...a.path,u]})}}}return null}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=$([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){if(this.settings.customMode()&&this.endReasonSignal()!=="Debug Victory")return;this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let i=this.firebase.user$(),r=pe(F({},t),{playerName:this.playerName.name(),userId:i?.uid,userPhoto:i?.photoURL??void 0});this.firebase.saveHighScore(r),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}aiIron(){return this.aiIronSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;return r?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let i=this.calculateTotalPoints(t),r=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,i-r),atkMax:i+r+(t.hasWeapon?20:0),hp:t.points,support:o}}isUnitHovered(e){return this.hoveredUnitIdSignal()===e}getHitChanceInfo(e){let t=this.selectedUnit();if(!t)return null;let i=this.unitsSignal().find(l=>l.id===e);if(!i||t.owner!=="player"||i.owner===t.owner||!this.isVisibleToPlayer(i.position.x,i.position.y)||!this.validMoves().some(l=>l.x===i.position.x&&l.y===i.position.y))return null;let o=this.combat.calculateHitChance(t,i),s="bg-green-600";o<50?s="bg-red-600":o<100&&(s="bg-amber-600");let a=o<10;return{chance:o,bg:s,icon:a?"\u2620\uFE0F":"\u2694\uFE0F",skull:a}}shouldRenderWall(e,t,i){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return r?(i??r.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}hoverFormationById(e){this.hoveredFormationIdSignal.set(e??null)}isFormationHovered(e){return e?this.hoveredFormationIdSignal()===e:!1}getFormationInfo(e){let t=e??null;if(!t)return null;let i=this.wallsSignal().find(r=>r.formationId===t);return i?{size:i.formationSize??1,bonus:i.bonusHp??0}:null}updateWallFormations(){let e=this.wallsSignal();if(e.length===0)return;let t=new Map,i=new Map;for(let l of e){t.set(l.id,l);let u=`${l.tile1.x},${l.tile1.y}`,d=`${l.tile2.x},${l.tile2.y}`,h=i.get(u)??[];h.push(l.id),i.set(u,h);let p=i.get(d)??[];p.push(l.id),i.set(d,p)}let r=new Set,o=[];for(let l of e){if(r.has(l.id))continue;if(l.owner==="neutral"){o.push([l.id]),r.add(l.id);continue}let u=[l.id];r.add(l.id);let d=[],h=l.owner;for(;u.length>0;){let p=u.shift();d.push(p);let g=t.get(p),x=[`${g.tile1.x},${g.tile1.y}`,`${g.tile2.x},${g.tile2.y}`];for(let S of x){let N=i.get(S)??[];for(let U of N)r.has(U)||t.get(U).owner===h&&(r.add(U),u.push(U))}}o.push(d)}let s=e.map(l=>F({},l)),a=new Map;for(let l=0;l<s.length;l++)a.set(s[l].id,l);for(let l of o){let d=t.get(l[0]).owner==="neutral",h=d?1:l.length,p=d?0:Math.max(0,h*20),g=100+p,x=d?null:l[0];for(let S of l){let N=a.get(S),U=s[N],ie=U.maxHealth??100,Se=g-ie,xe=U.health;Se>0?xe=U.health+Se:Se<0&&(xe=Math.min(U.health,g)),xe=Math.max(0,Math.min(g,xe)),s[N]=pe(F({},U),{formationId:x??void 0,formationSize:h,maxHealth:g,bonusHp:p,health:xe})}}this.wallsSignal.set(s)}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(i=>i.position.x===e&&i.position.y===t).map(i=>({id:i.id,text:i.text,opacity:i.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let i=this.unitsSignal().find(d=>d.id===e);if(!i)return"";let r=this.combat.getPointsForTierLevel(i.tier,4),o=t.support>0?`+${t.support}`:"+0",s=i.hasWeapon?" | Weapon:+20":"",a=i.armorHp??0,l=i.hasArmor?` | Armor:${a}`:"",u=a>0?`${t.hp} + ${a}`:`${t.hp}`;return`Unit T${i.tier} | HP: ${u}/${r} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}${s}${l}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.endReasonSignal.set("Debug Victory"),this.endOverlaySignal.set(!0);let t=this.getForestControl().player,r={playerName:this.playerName.name(),turnsPlayed:this.turnSignal(),forestsCaptured:t,victoryType:"Annihilation",timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:!0};this.pendingScoreSignal.set(r),this.namePromptOpenSignal.set(!0)}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],i=e.indexOf(this.settings.difficulty()),r=t.indexOf(this.settings.mapSize());i++,i>=e.length&&(i=0,r++,r>=t.length&&(r=0)),this.settings.setDifficulty(e[i]),this.settings.setMapSize(t[r]),this.resetGame()}recordHighScore(e,t){if(this.settings.customMode()){this.endReasonSignal.set("Match Finished (Custom Mode)");return}let i=`${this.settings.difficulty()}|${this.settings.mapSize()}`,r=F({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=r[i]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((h,p)=>h.turns-p.turns).slice(0,3):s.losses=[...s.losses,o].sort((h,p)=>h.turns-p.turns).slice(0,3),r[i]=s,this.highScoresSignal.set(r),this.persistHighScores();let a=this.getForestControl(),l=e==="player wins"?a.player:a.ai,u=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:l,victoryType:u,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"?(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0)):this.firebase.saveHighScore(d)}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let i=crypto.randomUUID(),r={id:i,text:e,position:F({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),r]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===i?pe(F({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==i))},2e3)}calculateValidMoves(e){let t=[],i=e.position,r=u=>u.x>=0&&u.x<this.gridSize&&u.y>=0&&u.y<this.gridSize,o=(u,d)=>{if(!r(d))return"blocked";if(u.x===d.x||u.y===d.y){if(this.getWallBetween(u.x,u.y,d.x,d.y))return"blocked"}else if(this.isDiagonalBlocked(u,d))return"blocked";let h=this.getUnitAt(d.x,d.y);return h?h.owner===e.owner?"ally":"enemy":"empty"},s=(u,d)=>{(d==="empty"||d==="enemy"||this.getUnitAt(u.x,u.y)?.tier===e.tier)&&t.push(u)},a=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],l=[{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}];if(e.tier===1){for(let u of a){let d={x:i.x+u.x,y:i.y+u.y},h=o(i,d);h!=="blocked"&&s(d,h)}return t}for(let u of a){let d={x:i.x+u.x,y:i.y+u.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===3&&h==="empty"){let p={x:i.x+u.x*2,y:i.y+u.y*2},g=o(d,p);g!=="blocked"&&s(p,g)}}for(let u of l){let d={x:i.x+u.x,y:i.y+u.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===4&&h==="empty"){let p={x:i.x+u.x*2,y:i.y+u.y*2},g=o(d,p);if(g!=="blocked"&&(s(p,g),g==="empty")){let x={x:i.x+u.x*3,y:i.y+u.y*3},S=o(p,x);S!=="blocked"&&s(x,S)}}}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),l=this.isForest(s.position.x,s.position.y),u=this.isMine(s.position.x,s.position.y),d=l?a?1:(s.forestOccupationTurns??0)+1:0,h=u?a?1:(s.mineOccupationTurns??0)+1:0,p=l?d>=3:!1;return pe(F({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:d,mineOccupationTurns:h,productionActive:p})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let i=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(a=>a.owner===e&&this.isForest(a.position.x,a.position.y)&&(a.productionActive??!1)).length,s=this.unitsSignal().filter(a=>a.owner===e&&this.isMine(a.position.x,a.position.y)&&(a.mineOccupationTurns??0)>=5).length;if(o>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood+o*i(this.settings.difficulty()),iron:a.iron})):this.aiWoodSignal.update(a=>a+o*i(this.settings.difficulty()))),s>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood,iron:a.iron+s*2})):this.aiIronSignal.update(a=>a+s*2)),e==="player"){let a=this.forgeSitesSignal().map(h=>F({},h));for(let h of a)h.turnsLeft=Math.max(0,h.turnsLeft-1);let l=a.filter(h=>h.turnsLeft===0),u=l.map(h=>h.position),d=a.filter(h=>h.turnsLeft>0);if(u.length>0){this.forgesSignal.update(p=>[...p,...u]);let h=l.filter(p=>p.owner==="ai").map(p=>p.position);if(h.length>0){this.aiForgesSignal.update(p=>[...p,...h]);for(let p of h)this.appendLog(`[AI] Forge completed at (${p.x},${p.y}).`)}}this.forgeSitesSignal.set(d)}}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let r=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(r),this.startSideTurn(r),r==="ai"&&this.gameStatus()==="playing"&&(this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10))}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}pauseGame(){this.stopAiLoops()}aiTurnTimeout=null;stopAiLoops(){this.aiTurnTimeout&&(clearTimeout(this.aiTurnTimeout),this.aiTurnTimeout=null),this.isAiThinking=!1}startSideTurn(e){this.unitsSignal.update(t=>t.map(i=>i.owner===e?pe(F({},i),{hasActed:!1}):i)),e==="player"&&(this.selectNextAvailableUnit(),this.playerClaimedTargetsSignal.set(new Set))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;if(r){let s=F({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=F({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai"),t=this.forestsSignal().length+this.minesSignal().length,i=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y))),r=t>0?i.length/t:0;if(r>.5){let D=new Map,w=this.unitsSignal().filter(ge=>ge.owner==="ai"&&!ge.hasActed),R=new Set,M=i.slice().sort((ge,Oe)=>Oe.tier-ge.tier);for(let ge of M){let Oe=Math.min(4,ge.tier+1),fe=w.filter(Ae=>Ae.tier===Oe&&!R.has(Ae.id)).sort((Ae,Ht)=>{let at=Math.max(Math.abs(Ae.position.x-ge.position.x),Math.abs(Ae.position.y-ge.position.y)),te=Math.max(Math.abs(Ht.position.x-ge.position.x),Math.abs(Ht.position.y-ge.position.y));return at-te});if(fe.length>0){let Ae=fe[0];D.set(Ae.id,{target:F({},ge.position),type:"hunt"}),R.add(Ae.id);continue}let Ft=w.filter(Ae=>Ae.tier===ge.tier&&!R.has(Ae.id)),Zt=!1;for(let Ae of Ft){let Ht=this.calculateValidMoves(Ae),at=this.unitsSignal().find(te=>te.owner==="ai"&&te.tier===Ae.tier&&(te.position.x!==Ae.position.x||te.position.y!==Ae.position.y)&&Ht.some(ne=>ne.x===te.position.x&&ne.y===te.position.y));if(at){D.set(Ae.id,{target:F({},at.position),type:"merge"}),R.add(Ae.id),Zt=!0;break}}Zt||this.aiSpawnTier(Oe,1,new Set)}this.reclamationGoalsSignal.set(D),this.appendLog(`[AI Mode] Reclamation active. Player controls ${(r*100).toFixed(0)}% of resources.`)}else this.reclamationGoalsSignal.set(new Map);let a=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)).length>3;{let D=0,w=50,M=this.baseHealthSignal().ai<50?20:70;for(;this.aiWoodSignal()>M;){if(D++,D>w){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let D=this.forestsSignal().length,w=this.unitsSignal().filter(at=>at.owner==="ai"&&this.isForest(at.position.x,at.position.y)).length,R=this.unitsSignal().filter(at=>at.owner==="player"&&this.isForest(at.position.x,at.position.y)).length,M=this.settings.difficulty(),ge=D>0?R/D:0,Oe="none";R<=w?Oe="none":ge>=.9||R>=9?Oe="rage":R>=w+(M==="baby"?4:M==="normal"?3:M==="hard"?2:1)?Oe="angry":Oe="none",this.aiMoodSignal.set(Oe);let fe=this.turnSignal()%2===0,Ft=this.turnSignal()%5===0,Zt=D>0?w/D:0,Ae=this.totalWarModeSignal(),Ht=Zt>=.65;if(!Ae&&Ht)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(Ht),Oe==="rage"){let at=M==="baby"?fe?1:2:M==="normal"?fe?3:2:M==="hard"?fe?4:3:4;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+at}))}else if(Oe==="angry"){if(M==="baby")Ft&&this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+1}));else if(fe){let at=M==="normal"?fe?1:0:M==="hard"?Ft?2:1:2;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+at}))}}}catch{}if(this.manageInfrastructure(),this.turnSignal()<=10){let D=0,w=this.getPointsForTierLevel(1,1);for(;this.reservePointsSignal().ai>=w&&D<2&&this.aiSpawnTier(1,1,new Set)!==0;)D++,await new Promise(M=>setTimeout(M,60))}await new Promise(D=>setTimeout(D,100));let l=this.unitsSignal().filter(D=>D.owner==="ai"),u=new Map(this.aiUnitTimeNearBaseSignal()),d=new Set(l.map(D=>D.id));for(let D of u.keys())d.has(D)||u.delete(D);for(let D of l)Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3?u.set(D.id,(u.get(D.id)||0)+1):u.set(D.id,0);this.aiUnitTimeNearBaseSignal.set(u);for(let D of l){let w=this.isForest(D.position.x,D.position.y);D.owner==="ai"&&w&&D.tier<=2&&this.anchorGatherer(D.id)}let h=this.unitsSignal().filter(D=>D.owner==="player"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,p=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,g=h>=p;this.aggressionModeSignal.set(g);let N=this.forestsSignal().filter(D=>!this.getUnitAt(D.x,D.y)).filter(D=>this.isVisibleToAi(D.x,D.y)),U=this.unitsSignal().filter(D=>D.owner==="ai");if(this.turnSignal()<=15){let D=this.aiQueuedUnitIdSignal(),w=D?U.find(M=>M.id===D):null;if(!(w&&!this.isForest(w.position.x,w.position.y)&&N.length>0)){let M=U.filter(Oe=>Oe.tier<=2&&!this.isForest(Oe.position.x,Oe.position.y)),ge=M.length>0&&N.length>0?M.reduce((Oe,fe)=>{let Ft=Math.min(...N.map(Ae=>Math.abs(fe.position.x-Ae.x)+Math.abs(fe.position.y-Ae.y))),Zt=Math.min(...N.map(Ae=>Math.abs(Oe.position.x-Ae.x)+Math.abs(Oe.position.y-Ae.y)));return Ft<Zt?fe:Oe},M[0]):null;this.aiQueuedUnitIdSignal.set(ge?ge.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let D=this.getPointsForTierLevel(3,1),w=this.forestsSignal().length,R=this.unitsSignal().filter(Oe=>Oe.owner==="ai"&&this.isForest(Oe.position.x,Oe.position.y)).length,M=w>0?R/w:0;this.reservePointsSignal().ai>=D&&M<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let ie=this.unitsSignal().filter(D=>D.owner==="player"&&Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3&&D.tier>=2);if(ie.length>0){let D=ie.reduce((w,R)=>this.calculateTotalPoints(R)>this.calculateTotalPoints(w)?R:w,ie[0]);this.aiDefenseSpawn(D)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let D=this.aiStrategy.getWallBuildActions(this);for(let w of D){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(w.from,w.to)}}else this.tryDefensiveWallsNearForests();let Se=0,xe=10;for(;Se<xe&&this.executeOneFreeAction();)Se++,await new Promise(w=>setTimeout(w,100));this.aiQueuedUnitIdSignal.set(null);let De=this.getBasePosition("player"),Ie=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y)||this.isForge(D.position.x,D.position.y)||Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=4)),k={claimedTargets:new Set,priorityTargets:Ie},P=this.unitsSignal().filter(D=>D.owner==="ai"&&!D.hasActed).sort((D,w)=>w.tier-D.tier);for(let D of P){let w=this.unitsSignal().find(te=>te.id===D.id);if(!w||w.hasActed)continue;let R=null,ge=this.calculateValidMoves(w).filter(te=>!k.claimedTargets.has(`${te.x},${te.y}`)),Oe=Math.max(Math.abs(w.position.x-e.x),Math.abs(w.position.y-e.y)),fe=this.unitsSignal().filter(te=>te.owner==="player"&&Math.max(Math.abs(te.position.x-e.x),Math.abs(te.position.y-e.y))<=3);if(fe.length>0&&!this.isForest(w.position.x,w.position.y)&&Oe<=6){let te=fe.reduce((Ee,ve)=>{let me=Math.max(Math.abs(Ee.position.x-e.x),Math.abs(Ee.position.y-e.y));return Math.max(Math.abs(ve.position.x-e.x),Math.abs(ve.position.y-e.y))<me?ve:Ee});if(ge.some(Ee=>Ee.x===te.position.x&&Ee.y===te.position.y))R={type:"attack",target:te.position,reason:"Base Defense: Eliminate Threat"};else{let Ee=this.getNextStepTowards(w,te.position,ge);Ee&&(R={type:"move",target:Ee,reason:"Base Defense: Intercept"})}}if(!R){let te=this.reclamationGoalsSignal().get(w.id);if(te){let ne=te.target,Ee=this.getUnitAt(ne.x,ne.y);if(Ee&&Ee.owner!==w.owner)if(ge.some(me=>me.x===ne.x&&me.y===ne.y))R={type:"attack",target:ne,reason:"Reclaim: Attack Occupier"};else{let me=this.bfsPath(w.position,ne,{respectWalls:!0,avoidFriendlyUnits:!0});if(me||(me=this.bfsPath(w.position,ne,{avoidFriendlyUnits:!0})),me&&me.length>1){let v=me[1],se=this.getWallBetween(w.position.x,w.position.y,v.x,v.y),We=this.getUnitAt(v.x,v.y);if(We&&We.owner!==w.owner){let qe=this.effectiveAttack(We)>this.effectiveDefense(w),oe=ge.some(bt=>bt.x===v.x&&bt.y===v.y);if(qe&&oe)R={type:"attack",target:v,reason:"Reclaim: Engage Blocker"};else if(se)R={type:"wall_attack",target:v,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,v)){let bt=ge.filter(ii=>{let Es=Math.abs(ii.x-ne.x)+Math.abs(ii.y-ne.y),nh=Math.abs(v.x-ne.x)+Math.abs(v.y-ne.y);return Es<=nh&&!this.isTileThreatenedByEnemy(w,ii)}),Ei=bt.length>0?this.getNextStepTowards(w,ne,bt):null;R=Ei?{type:"move",target:Ei,reason:"Reclaim: Bypass Threat"}:{type:"move",target:v,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:v,reason:"Reclaim: Pursue Resource"}}else if(se)R={type:"wall_attack",target:v,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,v)){let qe=ge.filter(bt=>{let Ei=Math.abs(bt.x-ne.x)+Math.abs(bt.y-ne.y),ii=Math.abs(v.x-ne.x)+Math.abs(v.y-ne.y);return Ei<=ii&&!this.isTileThreatenedByEnemy(w,bt)}),oe=qe.length>0?this.getNextStepTowards(w,ne,qe):null;R=oe?{type:"move",target:oe,reason:"Reclaim: Bypass Threat"}:{type:"move",target:v,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:v,reason:"Reclaim: Pursue Resource"}}}else if(te.type==="merge")if(ge.some(me=>me.x===ne.x&&me.y===ne.y))R={type:"move",target:ne,reason:"Reclaim: Merge to Counter"};else{let me=this.getNextStepTowards(w,ne,ge);me&&(R=this.getWallBetween(w.position.x,w.position.y,me.x,me.y)?{type:"wall_attack",target:me,reason:"Reclaim: Breach to Merge"}:{type:"move",target:me,reason:"Reclaim: Approach Ally"})}else{let ve=this.getNextStepTowards(w,ne,ge);if(ve){let me=this.getWallBetween(w.position.x,w.position.y,ve.x,ve.y),v=this.getUnitAt(ve.x,ve.y);if(v&&v.owner!==w.owner){let se=this.effectiveAttack(v)>this.effectiveDefense(w),We=ge.some(qe=>qe.x===ve.x&&qe.y===ve.y);if(se&&We)R={type:"attack",target:ve,reason:"Reclaim: Engage Blocker"};else if(me)R={type:"wall_attack",target:ve,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,ve)){let qe=ge.filter(bt=>{let Ei=Math.abs(bt.x-ne.x)+Math.abs(bt.y-ne.y),ii=Math.abs(ve.x-ne.x)+Math.abs(ve.y-ne.y);return Ei<=ii&&!this.isTileThreatenedByEnemy(w,bt)}),oe=qe.length>0?this.getNextStepTowards(w,ne,qe):null;R=oe?{type:"move",target:oe,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ve,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ve,reason:"Reclaim: Close Distance"}}else if(me)R={type:"wall_attack",target:ve,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,ve)){let se=ge.filter(qe=>{let oe=Math.abs(qe.x-ne.x)+Math.abs(qe.y-ne.y),bt=Math.abs(ve.x-ne.x)+Math.abs(ve.y-ne.y);return oe<=bt&&!this.isTileThreatenedByEnemy(w,qe)}),We=se.length>0?this.getNextStepTowards(w,ne,se):null;R=We?{type:"move",target:We,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ve,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ve,reason:"Reclaim: Close Distance"}}}}}if(this.isForest(w.position.x,w.position.y)){let te=this.calculateValidMoves(w),ne=this.findCombatTarget(w,k,te);if(ne)R={type:"attack",target:ne,reason:"Defense: Defend Forest"};else{if(this.aiWoodSignal()>=50){let Ee=this.findDefensiveWallTarget(w);Ee&&(R={type:"build_wall",target:Ee,reason:"Defense: Fortify Position"})}if(!R&&!this.isUnitInDanger(w)){this.unitsSignal.update(ve=>ve.map(me=>me.id===w.id?pe(F({},me),{hasActed:!0}):me));continue}}}if(!R&&this.isMine(w.position.x,w.position.y)){let te=this.calculateValidMoves(w),ne=this.findCombatTarget(w,k,te);if(ne)R={type:"attack",target:ne,reason:"Defense: Defend Mine"};else if(!this.isUnitInDanger(w)){this.unitsSignal.update(ve=>ve.map(me=>me.id===w.id?pe(F({},me),{hasActed:!0}):me));continue}}let Ft=this.forestsSignal().length,Zt=this.unitsSignal().filter(te=>te.owner==="ai"&&this.isForest(te.position.x,te.position.y)).length,Ae=Ft>0?Zt/Ft:0,Ht=w.tier>=3||Ae>=.7,at=Math.max(Math.abs(w.position.x-De.x),Math.abs(w.position.y-De.y));if(!R&&at<4){if(Ht&&at<=3){let te=[];ge.some(se=>se.x===De.x&&se.y===De.y)&&te.push({type:"attack",target:De,weight:1,reason:"Siege: Strike Base"});let Ee=this.getNeighbors(w.position),ve=at,me=!1;for(let se of Ee)this.getWallBetween(w.position.x,w.position.y,se.x,se.y)&&Math.max(Math.abs(se.x-De.x),Math.abs(se.y-De.y))<ve&&(te.push({type:"wall_attack",target:se,weight:.9,reason:"Siege: Breach (Path to Base)"}),me=!0);let v=this.getNextStepTowards(w,De,ge,{noCohesion:!0});if(v){let se=Math.max(Math.abs(v.x-De.x),Math.abs(v.y-De.y));(!me||se<ve)&&te.push({type:"move",target:v,weight:.5,reason:"Siege: Advance on Base"})}if(te.length>0){te.sort((We,qe)=>qe.weight-We.weight);let se=te[0];R={type:se.type,target:se.target,reason:se.reason},se.type==="move"&&me&&this.appendLog(`[AI Debug] Unit at (${w.position.x},${w.position.y}) chose Move over Wall Attack. Weights: wall=0.9, move=${se.weight}`)}}if(!R)if(ge.some(ne=>ne.x===De.x&&ne.y===De.y))R={type:"attack",target:De,reason:"Siege: Strike Base"};else{let ne=this.getNextStepTowards(w,De,ge,{noCohesion:!0});if(ne)this.getWallBetween(w.position.x,w.position.y,ne.x,ne.y)?R={type:"wall_attack",target:ne,reason:"Siege: Breach"}:R={type:"move",target:ne,reason:"Siege: Advance on Base"};else{let Ee=this.bfsPath(w.position,De);if(Ee&&Ee.length>1){let ve=Ee[1];this.getWallBetween(w.position.x,w.position.y,ve.x,ve.y)&&(R={type:"wall_attack",target:ve,reason:"Siege: Breaching"})}}}}if(!R){let te=this.aiForgesSignal(),ne=this.unitsSignal().filter(ve=>ve.owner==="player"),Ee=[];for(let ve of te)for(let me of ne)Math.max(Math.abs(me.position.x-ve.x),Math.abs(me.position.y-ve.y))<=3&&Ee.push(me);if(Ee.length>0){let ve=Ee.reduce((v,se)=>{let We=Math.abs(v.position.x-w.position.x)+Math.abs(v.position.y-w.position.y);return Math.abs(se.position.x-w.position.x)+Math.abs(se.position.y-w.position.y)<We?se:v});if(ge.some(v=>v.x===ve.position.x&&v.y===ve.position.y))R={type:"attack",target:ve.position,reason:"Defense: Guard Forge"};else{let v=this.getNextStepTowards(w,ve.position,ge);v&&(R=this.getWallBetween(w.position.x,w.position.y,v.x,v.y)?{type:"wall_attack",target:v,reason:"Defense: Breach to Forge"}:{type:"move",target:v,reason:"Defense: Approach Forge Threat"})}}}if(!R&&w.tier>=2&&(!w.hasArmor||!w.hasWeapon)){let te=this.seekUpgrades(w,ge);te.type==="move"&&te.target&&(R={type:"move",target:te.target,reason:"Upgrade: Move to Forge"})}if(!R){let te=this.isUnitInDanger(w),ne=this.reclamationGoalsSignal().has(w.id);if(!ne&&te){let Ee=this.findSafeMove(w,ge);Ee&&(R={type:"move",target:Ee,reason:"Survival: Evade Threat"})}else if(ne&&te&&this.getNeighbors(w.position).some(me=>{let v=this.getUnitAt(me.x,me.y);return!v||v.owner===w.owner?!1:this.effectiveAttack(v)>this.effectiveDefense(w)+(w.tier>=3?10:0)})){let me=this.findSafeMove(w,ge);me&&(R={type:"move",target:me,reason:"Survival: Lethal Evade"})}}if(!R&&w.tier===4){let te=this.unitsSignal().filter(ne=>ne.owner==="player");if(te.length>0){let ne=this.getBasePosition("player"),Ee=te.map(me=>({u:me,baseDist:Math.max(Math.abs(me.position.x-ne.x),Math.abs(me.position.y-ne.y))})).sort((me,v)=>me.u.tier!==v.u.tier?me.u.tier-v.u.tier:me.baseDist-v.baseDist)[0].u,ve=this.getNextStepTowards(w,Ee.position,ge);ve&&(R={type:"move",target:ve,reason:"T4 Raid: Flank Backline"})}}if(!R){let te=this.computeSideEffectivePower("ai"),ne=this.computeSideEffectivePower("player");if(ne>0&&te>ne*1.2&&!this.isForest(w.position.x,w.position.y)&&parseInt(w.id.slice(-1),16)%2===0){let me=this.unitsSignal().filter(We=>We.owner==="player"),v=De;if(me.length>0&&(v=me.reduce((qe,oe)=>{let bt=Math.max(Math.abs(qe.position.x-w.position.x),Math.abs(qe.position.y-w.position.y));return Math.max(Math.abs(oe.position.x-w.position.x),Math.abs(oe.position.y-w.position.y))<bt?oe:qe}).position),Math.max(Math.abs(v.x-w.position.x),Math.abs(v.y-w.position.y))<=1){let We=this.findCombatTarget(w,k,ge);We&&(R={type:"attack",target:We,reason:"Siege: Engage Enemy"})}else{let We=this.getNextStepTowards(w,v,ge,{noCohesion:!0});if(We)R={type:"move",target:We,reason:"Siege: Advance"};else{let qe=this.bfsPath(w.position,v);if(qe&&qe.length>1){let oe=qe[1];this.getWallBetween(w.position.x,w.position.y,oe.x,oe.y)&&(R={type:"wall_attack",target:oe,reason:"Siege: Breaching"})}}}}if(!R){let me=this.findResourceTarget(w,k);if(me){let v=this.bfsPath(w.position,me,{respectWalls:!0,avoidFriendlyUnits:!0});if(v||(v=this.bfsPath(w.position,me,{avoidFriendlyUnits:!0})),v&&v.length>1){let se=v[1],We=this.getWallBetween(w.position.x,w.position.y,se.x,se.y);We?We.owner==="ai"&&this.isBaseProtectionEdge(w.position,se)||(R={type:"wall_attack",target:se,reason:"Objective: Breaching Wall"}):ge.some(qe=>qe.x===se.x&&qe.y===se.y)&&(R={type:"move",target:se,reason:"Objective: Capture Resource"})}}}}if(!R){let te=this.findCombatTarget(w,k,ge);te&&(R={type:"attack",target:te,reason:"Combat: Engage Enemy"})}if(!R&&this.aiWoodSignal()>=10&&this.getNeighbors(w.position).some(Ee=>this.isForest(Ee.x,Ee.y)&&this.getUnitAt(Ee.x,Ee.y)?.owner==="ai")){let Ee=this.findDefensiveWallTarget(w);Ee&&(R={type:"build_wall",target:Ee,reason:"Defense: Fortify Perimeter"})}if(!R){let te=De,ne=this.findFallbackMove(w,ge,te);ne&&(R={type:"move",target:ne,reason:"Fallback: Advance on Enemy"})}if(R){if(this.appendLog(`[AI Unit ${w.id.substring(0,4)}] Action: ${R.reason} -> Target: (${R.target.x},${R.target.y})`),R.type==="build_wall")this.aiBuildWallBetween(w.position,R.target);else{if(R.type==="move"){let te=this.getUnitAt(R.target.x,R.target.y);if(te&&te.owner==="ai"&&te.tier===w.tier){let ne=new Map(this.mergeIntentSignal());ne.set(w.id,te.id),ne.set(te.id,w.id),this.mergeIntentSignal.set(ne)}}this.executeMove(w,R.target)}k.claimedTargets.add(`${R.target.x},${R.target.y}`)}else this.appendLog(`[AI Unit ${w.id.substring(0,4)}] No valid moves. Passing.`),this.unitsSignal.update(te=>te.map(ne=>ne.id===w.id?pe(F({},ne),{hasActed:!0}):ne));await new Promise(te=>setTimeout(te,60))}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(s=>s.owner==="player"&&Math.max(Math.abs(s.position.x-e.x),Math.abs(s.position.y-e.y))<=3&&s.tier>=2);if(t.length>0){let s=t.reduce((l,u)=>this.calculateTotalPoints(u)>this.calculateTotalPoints(l)?u:l,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(s))return!0}let i=this.unitsSignal().filter(s=>s.owner==="ai").length;if(i<6){let s=this.reservePointsSignal().ai,a=this.getPointsForTierLevel(2,1);if(s>=a&&this.aiSpawnTier(2,1,new Set)>0)return!0}let o=this.baseHealthSignal().ai<50?20:70;if(this.aiWoodSignal()>=o)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;{let s=this.reservePointsSignal().ai,a=this.unitsSignal().filter(l=>l.owner==="ai"&&this.isForest(l.position.x,l.position.y)).length;if(s>25&&a>5&&this.aiSpawnTier(3,1,new Set,!0)>0)return!0}if(t.length===0)try{let s=this.getPointsForTierLevel(3,1),a=this.forestsSignal().length,l=this.unitsSignal().filter(h=>h.owner==="ai"&&this.isForest(h.position.x,h.position.y)).length,u=a>0?l/a:0,d=this.reservePointsSignal().ai;if(i>=6&&d>=s&&u<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),i=[],r=e.position.x,o=e.position.y,s=Math.sign(t.x-r),a=Math.sign(t.y-o);{let p=0,g=Math.max(10,this.gridSize*2);for(;r!==t.x||o!==t.y;){if(p++,p>g){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(r+=s,o+=a,!this.inBounds(r,o)||r===t.x&&o===t.y)break;i.push({x:r,y:o})}}let l=i.reverse().find(p=>!this.getUnitAt(p.x,p.y))||(()=>{for(let p=-1;p<=1;p++)for(let g=-1;g<=1;g++){if(p===0&&g===0)continue;let x=t.x+p,S=t.y+g;if(this.inBounds(x,S)&&!this.getUnitAt(x,S))return{x,y:S}}return null})();if(!l)return!1;{let p=0,g=50;for(;this.aiWoodSignal()>=20;){if(p++,p>g){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let u=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(u);if(d<=0)return!1;let h=this.calculateTierAndLevel(d);return this.unitsSignal().filter(g=>g.owner==="ai"&&g.tier===h.tier&&!this.isForest(g.position.x,g.position.y)).length>=5?!1:(this.unitsSignal.update(p=>[...p,{id:crypto.randomUUID(),position:F({},l),level:h.level,tier:h.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1}]),this.reservePointsSignal.update(p=>({player:p.player,ai:p.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,i,r=!1){let o=this.getBasePosition("ai"),s=[],a=2;for(let N=-a;N<=a;N++)for(let U=-a;U<=a;U++){if(N===0&&U===0)continue;let ie=o.x+N,Se=o.y+U;if(!this.inBounds(ie,Se)||Math.max(Math.abs(N),Math.abs(U))>a)continue;let xe=`${ie},${Se}`;i.has(xe)||this.getUnitAt(ie,Se)||s.push({x:ie,y:Se})}let l=this.aiForgesSignal(),u=this.aiIronSignal()<40;u&&l.length>0&&s.sort((N,U)=>{let ie=l.reduce((xe,De)=>Math.min(xe,Math.max(Math.abs(N.x-De.x),Math.abs(N.y-De.y))),1/0);return l.reduce((xe,De)=>Math.min(xe,Math.max(Math.abs(U.x-De.x),Math.abs(U.y-De.y))),1/0)-ie});let d=this.reservePointsSignal().ai,h=this.getPointsForTierLevel(e,1),p=0,g=[],x=N=>this.unitsSignal().filter(U=>U.owner==="ai"&&U.tier===N&&!this.isForest(U.position.x,U.position.y)).length;if(x(e)>=5&&!(r&&e===3))return 0;for(let N of s){if(p>=t||d<h||x(e)>=5)break;let U=this.calculateTierAndLevel(h);g.push({id:crypto.randomUUID(),position:F({},N),level:U.level,tier:U.tier,points:h,owner:"ai",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}),d-=h,p++}if(g.length>0){this.unitsSignal.update(ie=>[...ie,...g]),this.reservePointsSignal.update(ie=>({player:ie.player,ai:d})),this.recomputeVisibility();let N=new Map(this.ignoreForgeUntilTurnSignal()),U=this.turnSignal()+(u?2:1);for(let ie of g)N.set(ie.id,U);this.ignoreForgeUntilTurnSignal.set(N)}return p}aiConvertWoodToReserve(){let e=this.aiWoodSignal(),i=this.baseHealthSignal().ai<50?20:70;e<i||(this.aiWoodSignal.update(r=>r-20),this.reservePointsSignal.update(r=>({player:r.player,ai:r.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(i=>{if(i.some(s=>s.position.x===t.x&&s.position.y===t.y))return i;let o={id:crypto.randomUUID(),position:F({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};return[...i,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),i=2,r=[];for(let u=-i;u<=i;u++)for(let d=-i;d<=i;d++){let h=t.x+u,p=t.y+d;this.inBounds(h,p)&&(u===0&&d===0||Math.max(Math.abs(u),Math.abs(d))>i||r.push({x:h,y:p}))}let o=this.settings.difficulty(),s;o==="baby"?s=[{tier:4,level:1},{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}]:s=[{tier:1,level:1},{tier:1,level:1}];let a=[],l=(u,d)=>this.unitsSignal().some(h=>h.position.x===u&&h.position.y===d)||a.some(h=>h.position.x===u&&h.position.y===d);for(let u of s){let d=r.filter(x=>!l(x.x,x.y));if(d.length===0)break;let h=Math.floor(Math.random()*d.length),p=d[h],g=this.getPointsForTierLevel(u.tier,u.level);a.push({id:crypto.randomUUID(),position:F({},p),level:u.level,tier:u.tier,points:g,owner:e,turnsStationary:0,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0})}a.length>0&&this.unitsSignal.update(u=>[...u,...a])}getUnitAt(e,t){return this.unitsSignal().find(i=>i.position.x===e&&i.position.y===t)}getWallBetween(e,t,i,r){let o={x:e,y:t},s={x:i,y:r};if(!this.areAdjacent(o,s))return;let[a,l]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(u=>u.tile1.x===a.x&&u.tile1.y===a.y&&u.tile2.x===l.x&&u.tile2.y===l.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(i,r,o,s)=>this.getWallBetween(i,r,o,s))}isValidMove(e,t){return this.validMoves().some(i=>i.x===e&&i.y===t)}isForest(e,t){return this.forestsSignal().some(i=>i.x===e&&i.y===t)}isMine(e,t){return this.minesSignal().some(i=>i.x===e&&i.y===t)}isForgeSite(e,t){return this.forgeSitesSignal().some(i=>i.position.x===e&&i.position.y===t)}isForge(e,t){return this.forgesSignal().some(i=>i.x===e&&i.y===t)}getForgeProgress(e,t){let i=this.forgeSitesSignal().find(o=>o.position.x===e&&o.position.y===t);if(!i)return 0;let r=5;return Math.round((r-i.turnsLeft)/r*100)}canBuildForgeAt(e,t){let i=this.getBasePosition("player");if(Math.max(Math.abs(e-i.x),Math.abs(t-i.y))>2||!this.inBounds(e,t)||e===i.x&&t===i.y||this.getUnitAt(e,t)||this.isForest(e,t)||this.isMine(e,t)||this.isForgeSite(e,t)||this.isForge(e,t))return!1;let o=this.resourcesSignal();return o.wood>=40&&o.iron>=20&&this.isPlayerTurn()}buildForgeAt(e){this.canBuildForgeAt(e.x,e.y)&&(this.resourcesSignal.update(t=>({wood:t.wood-40,iron:t.iron-20})),this.forgeSitesSignal.update(t=>[...t,{position:F({},e),owner:"player",turnsLeft:5}]))}buyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy weapon without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?pe(F({},s),{hasWeapon:!0}):s)))}buyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy armor without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?pe(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[Forge] Player unit equipped Armor (+20 Shield HP)."))}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}aiBuyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy armor without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?pe(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[AI] AI unit equipped Heavy Armor (+20 Shield HP)."))}aiBuyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy weapon without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?pe(F({},s),{hasWeapon:!0}):s)),this.appendLog("[AI] AI unit forged a Weapon (+20 ATK, +10 hit vs higher tier)."))}manageInfrastructure(){let e=this.aiForgesSignal().length+this.forgeSitesSignal().filter(u=>u.owner==="ai").length;if(e>=2)return;let t=this.aiWoodSignal(),i=this.aiIronSignal(),r=this.aiIronSignal();if(e===0){if(t<40||i<20)return}else if(e<2&&(r<=50||t<40||i<20))return;let o=this.getBasePosition("ai"),s=[];for(let u=-2;u<=2;u++)for(let d=-2;d<=2;d++){let h=o.x+u,p=o.y+d;this.inBounds(h,p)&&(h===o.x&&p===o.y||Math.max(Math.abs(u),Math.abs(d))>2||this.getUnitAt(h,p)||this.isForest(h,p)||this.isMine(h,p)||this.isForgeSite(h,p)||this.isForge(h,p)||s.push({x:h,y:p}))}if(s.length===0)return;let a=Math.floor(Math.random()*s.length),l=s[a];this.aiWoodSignal.update(u=>u-40),this.aiIronSignal.update(u=>u-20),this.forgeSitesSignal.update(u=>[...u,{position:F({},l),owner:"ai",turnsLeft:5}]),this.appendLog(`[AI] Constructing a Forge at (${l.x},${l.y}).`)}seekUpgrades(e,t){if(e.owner!=="ai")return{type:"none"};if(e.tier<2)return{type:"none"};if(e.hasArmor&&e.hasWeapon||this.aiIronSignal()<20)return{type:"none"};let i=this.aiForgesSignal();if(i.length===0)return{type:"none"};let r=this.getMergePartnerForUnit(e,t),o=this.aiIronSignal(),s=o>=100;if(s)this.appendLog(`[AI Wealth Override] T${e.tier} at (${e.position.x},${e.position.y}) bypassing normal checks (iron: ${o})`);else if(o<40){let h=this.computeHighestTierNeedingUpgrade();if(h>0&&e.tier<h)return{type:"none"}}if(!s&&r){let h=!e.hasWeapon&&r.hasWeapon,p=!e.hasArmor&&r.hasArmor;if(h||p){let g=h&&p?"Weapon & Armor":h?"Weapon":"Armor";return this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored ${g} purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) already has it).`),{type:"none"}}}let a=i.reduce((h,p)=>{let g=Math.max(Math.abs(p.x-e.position.x),Math.abs(p.y-e.position.y)),x=Math.max(Math.abs(h.x-e.position.x),Math.abs(h.y-e.position.y));return g<x?p:h},i[0]),u=this.ignoreForgeUntilTurnSignal().get(e.id)??0;if(this.turnSignal()<=u)return{type:"none"};if(e.position.x===a.x&&e.position.y===a.y){let h=this.aiIronSignal();if(r){let p=!1;return!r.hasArmor&&!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal(),p=!0),!r.hasWeapon&&!e.hasWeapon&&h>=20&&(this.aiBuyWeapon(e.id),p=!0),!p&&r.hasArmor&&r.hasWeapon&&this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) fully equipped).`),{type:"none"}}else return!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal()),!e.hasWeapon&&h>=20&&this.aiBuyWeapon(e.id),{type:"none"}}let d=this.getNextStepTowards(e,a,t);return d?{type:"move",target:d}:{type:"none"}}seekUpgradesFor(e,t,i){if(t.owner!==e)return{type:"none"};if(t.tier<2)return{type:"none"};let r=this.getIron(e);if(t.hasArmor&&t.hasWeapon||r<20)return{type:"none"};let o=this.getForges(e);if(o.length===0)return{type:"none"};let s=e==="ai"?this.getMergePartnerForUnit(t,i):this.getMergePartnerForUnit(t,i),a=this.getIron(e),l=e==="ai"&&a>=100;if(l)this.appendLog(`[AI Wealth Override] T${t.tier} at (${t.position.x},${t.position.y}) bypassing normal checks (iron: ${a})`);else if(a<40){let g=this.computeHighestTierNeedingUpgrade();if(g>0&&t.tier<g)return{type:"none"}}if(!l&&s){let g=!t.hasWeapon&&s.hasWeapon,x=!t.hasArmor&&s.hasArmor;if(g||x)return this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored ${g&&x?"Weapon & Armor":g?"Weapon":"Armor"} purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) already has it).`),{type:"none"}}let u=o.reduce((g,x)=>{let S=Math.max(Math.abs(x.x-t.position.x),Math.abs(x.y-t.position.y)),N=Math.max(Math.abs(g.x-t.position.x),Math.abs(g.y-t.position.y));return S<N?x:g},o[0]),h=this.ignoreForgeUntilTurnSignal().get(t.id)??0;if(this.turnSignal()<=h)return{type:"none"};if(t.position.x===u.x&&t.position.y===u.y){let g=this.getIron(e);if(s){let x=!1;return!s.hasArmor&&!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e),x=!0),!s.hasWeapon&&!t.hasWeapon&&g>=20&&(this.buyWeaponGeneric(e,t.id),x=!0),!x&&s.hasArmor&&s.hasWeapon&&this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) fully equipped).`),{type:"none"}}else return!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e)),!t.hasWeapon&&g>=20&&this.buyWeaponGeneric(e,t.id),{type:"none"}}let p=this.getNextStepTowards(t,u,i,void 0);return p?{type:"move",target:p}:{type:"none"}}async executeBotTurn(e){if(this.activeSideSignal()!==e||this.gameStatus()!=="playing")return;let t=e==="ai"?"player":"ai",i=this.getBasePosition(t),r=this.getBasePosition("player"),o=this.getBasePosition("ai"),s=this.forestsSignal().length+this.minesSignal().length,a=this.unitsSignal().filter(p=>p.owner===t&&(this.isForest(p.position.x,p.position.y)||this.isMine(p.position.x,p.position.y)));if((s>0?a.length/s:0)>.5){let p=new Map,g=this.unitsSignal().filter(N=>N.owner===e&&!N.hasActed),x=new Set,S=a.slice().sort((N,U)=>U.tier-N.tier);for(let N of S){let U=Math.min(4,N.tier+1),ie=g.filter(xe=>xe.tier===U&&!x.has(xe.id)).sort((xe,De)=>{let Ie=Math.max(Math.abs(xe.position.x-N.position.x),Math.abs(xe.position.y-N.position.y)),k=Math.max(Math.abs(De.position.x-N.position.x),Math.abs(De.position.y-N.position.y));return Ie-k});if(ie.length>0){let xe=ie[0];p.set(xe.id,{target:F({},N.position),type:"hunt"}),x.add(xe.id);continue}let Se=g.filter(xe=>xe.tier===N.tier&&!x.has(xe.id));for(let xe of Se){let De=this.calculateValidMoves(xe),Ie=this.unitsSignal().find(k=>k.owner===e&&k.tier===xe.tier&&(k.position.x!==xe.position.x||k.position.y!==xe.position.y)&&De.some(I=>I.x===k.position.x&&I.y===k.position.y));if(Ie){p.set(xe.id,{target:F({},Ie.position),type:"merge"}),x.add(xe.id);break}}}e==="ai"?this.reclamationGoalsSignal.set(p):this.reclamationGoalsSignal.set(p)}else this.reclamationGoalsSignal.set(new Map);let d=this.unitsSignal().filter(p=>p.owner===e&&!p.hasActed),h={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(p=>p.owner===t&&p.tier>=3)};for(let p of d){let g=null,x=this.calculateValidMoves(p),S=this.getForges(e),N=this.unitsSignal().filter(Ie=>Ie.owner===t),U=[];for(let Ie of S)for(let k of N)Math.max(Math.abs(k.position.x-Ie.x),Math.abs(k.position.y-Ie.y))<=3&&U.push(k);if(U.length>0){let Ie=U.reduce((I,P)=>{let D=Math.abs(I.position.x-p.position.x)+Math.abs(I.position.y-p.position.y);return Math.abs(P.position.x-p.position.x)+Math.abs(P.position.y-p.position.y)<D?P:I});if(x.some(I=>I.x===Ie.position.x&&I.y===Ie.position.y))g={type:"attack",target:Ie.position,reason:"Defense: Guard Forge"};else{let I=this.getNextStepTowards(p,Ie.position,x);I&&(g=this.getWallBetween(p.position.x,p.position.y,I.x,I.y)?{type:"wall_attack",target:I,reason:"Defense: Breach to Forge"}:{type:"move",target:I,reason:"Defense: Approach Forge Threat"})}}if(!g&&p.tier>=2&&(!p.hasArmor||!p.hasWeapon)){let Ie=this.seekUpgradesFor(e,p,x);Ie.type==="move"&&Ie.target&&(g={type:"move",target:Ie.target,reason:"Upgrade: Move to Forge"})}let ie=this.computeSideEffectivePower(e),Se=this.computeSideEffectivePower(t),De=Se>0&&ie>Se*1.2&&!this.isForest(p.position.x,p.position.y)&&parseInt(p.id.slice(-1),16)%2===0;if(!g&&De){let Ie=this.getBasePosition(t);if(Math.max(Math.abs(Ie.x-p.position.x),Math.abs(Ie.y-p.position.y))<=1){let I=this.findCombatTarget(p,h,x);I&&(g={type:"attack",target:I,reason:"Siege: Engage Enemy"})}else{let I=this.getNextStepTowards(p,Ie,x,{noCohesion:!0});I&&(g={type:"move",target:I,reason:"Siege: Advance"})}}if(!g){let Ie=this.findCombatTarget(p,h,x);Ie&&(g={type:"attack",target:Ie,reason:"Combat: Engage Enemy"})}if(!g&&this.getWood(e)>=10&&this.getNeighbors(p.position).some(I=>this.isForest(I.x,I.y)&&this.getUnitAt(I.x,I.y)?.owner===e)){let I=this.findDefensiveWallTarget(p);I&&(g={type:"build_wall",target:I,reason:"Defense: Fortify Perimeter"})}if(!g){let Ie=t==="ai"?o:r,k=this.findFallbackMove(p,x,Ie);k&&(g={type:"move",target:k,reason:"Fallback: Advance on Enemy"})}g?g.type==="build_wall"?e==="ai"?this.aiBuildWallBetween(p.position,g.target):this.buildWallBetween(p.position,g.target):this.executeMove(p,g.target):this.unitsSignal.update(Ie=>Ie.map(k=>k.id===p.id?pe(F({},k),{hasActed:!0}):k)),await new Promise(Ie=>setTimeout(Ie,60))}e==="player"?this.endTurn():this.endTurn()}playerAutoStep(){if(!this.isPlayerTurn()||this.gameStatus()!=="playing")return!1;let e="player",t="ai",i=this.unitsSignal().find(a=>a.owner===e&&!a.hasActed);if(!i)return!1;let r=this.calculateValidMoves(i),o=this.seekUpgradesFor(e,i,r),s=null;if(o.type==="move"&&o.target&&(s={type:"move",target:o.target,reason:"Upgrade: Move to Forge"}),!s){let a=this.isForest(i.position.x,i.position.y),l=this.isMine(i.position.x,i.position.y),u=this.totalWarMode();if((a||l)&&!u&&!this.getNeighbors(i.position).some(p=>{let g=this.getUnitAt(p.x,p.y);return g&&g.owner===t}))return this.unitsSignal.update(p=>p.map(g=>g.id===i.id?pe(F({},g),{hasActed:!0}):g)),!0}if(!s){let a=this.findPlayerResourceTarget(i);if(a){let l=`${a.x},${a.y}`,u=new Set(this.playerClaimedTargetsSignal());u.add(l),this.playerClaimedTargetsSignal.set(u);let d=this.bfsPath(i.position,a,{respectWalls:!0,avoidFriendlyUnits:!0});if(d||(d=this.bfsPath(i.position,a,{avoidFriendlyUnits:!0})),d&&d.length>1){let h=d[1];this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?s={type:"wall_attack",target:h,reason:"Resource: Breach to Capture"}:r.some(g=>g.x===h.x&&g.y===h.y)&&(s={type:"move",target:h,reason:"Resource: Move to Capture"})}else{let h=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});h&&(s=this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?{type:"wall_attack",target:h,reason:"Resource: Breach"}:{type:"move",target:h,reason:"Resource: Advance"})}}}if(!s){let a={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(u=>u.owner===t&&u.tier>=3)},l=this.findCombatTarget(i,a,r);l&&(s={type:"attack",target:l,reason:"Combat: Engage Enemy"})}if(!s){let a=this.getBasePosition(t),l=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});l&&(s={type:"move",target:l,reason:"Advance"})}return s?(s.type==="build_wall"?this.buildWallBetween(i.position,s.target):s.type==="wall_attack"?this.attackOrDestroyWallBetween(i.position,s.target):this.executeMove(i,s.target),!0):(this.unitsSignal.update(a=>a.map(l=>l.id===i.id?pe(F({},l),{hasActed:!0}):l)),!1)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10)return;if(!this.canBuildWallBetween(e,t)){if(this.isEdgeOnCooldown(e,t)){let a=this.edgeCooldownRemaining(e,t);this.appendLog(`[Build] This area is too unstable to rebuild yet (CD: ${a} turns).`)}return}let r=this.getBestAdjacentPlayerUnit(e,t);if(!r||r.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.updateWallFormations(),this.resourcesSignal.update(a=>({wood:a.wood-10,iron:a.iron})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(l=>l.id===r.id?pe(F({},l),{hasActed:!0}):l))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20,iron:t.iron})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(i=>({wood:i.wood-t*20,iron:i.iron})),this.reservePointsSignal.update(i=>({player:i.player+t,ai:i.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let i=[];for(let r=-2;r<=2;r++)for(let o=-2;o<=2;o++){if(r===0&&o===0)continue;let s=t.x+r,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(r),Math.abs(o))>2)continue;this.getUnitAt(s,a)||i.push({x:s,y:a})}this.deployTargetsSignal.set(i),this.baseDeployActiveSignal.set(!0)}startSandboxSpawn(e,t){this.settings.customMode()&&this.sandboxSpawnPendingSignal.set({owner:e,tier:t})}cancelSandboxSpawn(){this.sandboxSpawnPendingSignal.set(null)}spawnSandboxAt(e){let t=this.sandboxSpawnPendingSignal();if(!t||!this.settings.customMode()||this.getUnitAt(e.x,e.y))return;let i=this.getPointsForTierLevel(t.tier,1),r={id:crypto.randomUUID(),position:F({},e),level:1,tier:t.tier,points:i,owner:t.owner,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};this.unitsSignal.update(o=>[...o,r]),this.sandboxSpawnPendingSignal.set(null),this.recomputeVisibility()}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,l=e.y+s;this.inBounds(a,l)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,l)||t.push({x:a,y:l}))}let i=this.reservePointsSignal().player,r=[];for(let o of t){if(i<=0)break;let s=this.economy.getHighestAffordableCost(i);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(l=>[...l,{id:crypto.randomUUID(),position:F({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}]),i-=s,r.push(o)}r.length>0&&(this.reservePointsSignal.update(o=>({player:i,ai:o.ai})),this.recomputeVisibility())}botEconomyPhase(e){if(this.gameStatus()!=="playing"||e!=="player"||!this.isPlayerTurn())return!1;let t=!1;{let r=this.baseHealthSignal().player<50?20:50,o=0;for(;this.resourcesSignal().wood>=r+20;)this.convertWoodToReserve(),o+=20;o>0&&(this.appendLog(`[Auto-Engage] Player converted ${o} wood to reserves.`),t=!0)}try{let i=this.forgesSignal().length,r=this.forgeSitesSignal().length,o=i+r,s=this.resourcesSignal();if(o<2&&s.iron>=20&&s.wood>=40){let a=this.getBasePosition("player"),l=2,u=!1;for(let d=-l;d<=l&&!u;d++)for(let h=-l;h<=l&&!u;h++){if(d===0&&h===0)continue;let p=a.x+d,g=a.y+h;this.inBounds(p,g)&&(Math.max(Math.abs(d),Math.abs(h))>l||this.canBuildForgeAt(p,g)&&(this.appendLog(`[Auto-Engage] Player building Forge at (${p},${g}).`),this.buildForgeAt({x:p,y:g}),t=!0,u=!0))}}}catch{}if(!this.wallBuiltThisTurnSignal()&&this.resourcesSignal().wood>=10){let r=this.unitsSignal().filter(o=>o.owner==="player"&&this.isForest(o.position.x,o.position.y));for(let o of r){let s=this.findDefensiveWallTargetForOwner(o,"player");if(s){this.buildWallBetween(o.position,s),t=!0;break}}}{let i=this.unitsSignal().length;this.autoDeployFromReserves(),this.unitsSignal().length>i&&(t=!0)}return t}isDeployTarget(e,t){return this.deployTargetsSignal().some(i=>i.x===e&&i.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let i=this.economy.getHighestAffordableCost(t);if(i<=0)return;let r=this.calculateTierAndLevel(i);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:F({},e),level:r.level,tier:r.tier,points:i,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-i,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${r.tier}(L${r.level}) at (${e.x},${e.y}) costing ${i} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[i,r]=this.sortEdgeEndpoints(e,t);return`${i.x},${i.y}|${r.x},${r.y}`}registerWallDestroyedEdge(e,t){let i=this.edgeKey(e,t),r=new Map(this.wallCooldownSignal());r.set(i,this.turnSignal()),this.wallCooldownSignal.set(r)}isEdgeOnCooldown(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);return r===void 0?!1:5-(this.turnSignal()-r)>0}edgeCooldownRemaining(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);if(r===void 0)return 0;let o=5-(this.turnSignal()-r);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,i=!1){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(r.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(r.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(r.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;{let x=t.x-e.x,S=t.y-e.y,N=Math.abs(x)>=Math.abs(S),U=Math.sign(N?x:S),ie=this.wallThicknessPx+2,Se=this.tileSizePx+ie,xe=Math.round(Se*.35),De=N?U*xe:0,Ie=N?0:U*xe,k=new Set(this.attackingUnitsSignal());k.add(s.id),this.attackingUnitsSignal.set(k),this.attackerNudgeSignal.set({id:s.id,dx:De,dy:Ie}),setTimeout(()=>{this.attackerNudgeSignal.set({id:s.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let I=new Set(this.attackingUnitsSignal());I.delete(s.id),this.attackingUnitsSignal.set(I)},200)}let a=this.combat.getWallHitAmount(s.tier),[l,u]=this.sortEdgeEndpoints(e,t),d=r.maxHealth??100,h=Math.max(0,r.health-a);this.wallsSignal.update(x=>x.map(S=>S.id===r.id?pe(F({},S),{health:Math.max(0,S.health-a)}):S).filter(S=>S.health>0)),h<=0?(this.registerWallDestroyedEdge(l,u),this.updateWallFormations()):this.updateWallFormations(),this.shakenWallIdSignal.set(r.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let p=o==="player"?"Player":"AI",g=r.owner==="neutral"?"Neutral":r.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${s.tier} Unit attacked ${g} Wall. Damage: ${a}. Wall HP: ${h}/${d}.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(x=>x.map(S=>S.id===s.id?pe(F({},S),{hasActed:!0}):S)),o==="player"&&this.selectNextAvailableUnit()}destroyOwnWallBetween(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i||i.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==i.id));let[r,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(r,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`),this.updateWallFormations()}canDestroyOwnWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||i.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!i||i.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||!this.canActThisTurn()?!1:i.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(i=>i.owner==="player"&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let i=this.getAdjacentPlayerUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="ai"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentAiUnit(e,t){let i=this.getAdjacentAiUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<50)return;let i=this.getBestAdjacentAiUnit(e,t);if(!i||i.hasActed||!this.unitsSignal().filter(l=>l.owner==="player").some(l=>{let u=Math.max(Math.abs(l.position.x-e.x),Math.abs(l.position.y-e.y)),d=Math.max(Math.abs(l.position.x-t.x),Math.abs(l.position.y-t.y));return u<=2||d<=2?l.tier>=i.tier:!1})||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let[s,a]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(l=>[...l,{id:crypto.randomUUID(),tile1:{x:s.x,y:s.y},tile2:{x:a.x,y:a.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(l=>l-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(l=>l.map(u=>u.id===i.id?pe(F({},u),{hasActed:!0}):u)),this.updateWallFormations()}isBaseProtectionEdge(e,t){let i=this.getBasePosition("ai"),r=o=>Math.max(Math.abs(o.x-i.x),Math.abs(o.y-i.y))<=1||o.x===i.x&&o.y===i.y;return r(e)||r(t)}wouldCageElite(e,t){let i=(s,a,l,u)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:l,y:u}),h=this.sortEdgeEndpoints(e,t);return d[0].x===h[0].x&&d[0].y===h[0].y&&d[1].x===h[1].x&&d[1].y===h[1].y},r=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||i(s.x,s.y,a.x,a.y));{let l=Math.sign(a.x-s.x),u=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+l,s.y),h=this.getWallBetween(s.x,s.y,s.x,s.y+u),p=this.getWallBetween(a.x-l,a.y,a.x,a.y),g=this.getWallBetween(a.x,a.y-u,a.x,a.y);return!!(d||h||p||g||i(s.x,s.y,s.x+l,s.y)||i(s.x,s.y,s.x,s.y+u)||i(a.x-l,a.y,a.x,a.y)||i(a.x,a.y-u,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(l=>{let u={x:s.position.x+l.x,y:s.position.y+l.y};return this.inBounds(u.x,u.y)?!r(s.position,u):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(r=>r.owner==="ai"),t=this.unitsSignal().filter(r=>r.owner==="player"),i=this.getBasePosition("ai");for(let r of e){if(!this.isForest(r.position.x,r.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y))<=2);for(let s of o){let a=r.level??this.calculateTierAndLevel(r.points).level,l=s.level??this.calculateTierAndLevel(s.points).level,u=Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y)),d=Math.sign(s.position.x-r.position.x),h=Math.sign(s.position.y-r.position.y);if(Math.abs(d)+Math.abs(h)===2)continue;let p=u===1?{x:r.position.x+d,y:r.position.y+h}:{x:r.position.x+Math.sign(s.position.x-r.position.x),y:r.position.y+Math.sign(s.position.y-r.position.y)};if(!this.inBounds(p.x,p.y))continue;let g=Math.sign(i.x-r.position.x),x=Math.sign(i.y-r.position.y);if((p.x-r.position.x)*g+(p.y-r.position.y)*x>0)continue;let N=r.position,U=p;if(!this.getWallBetween(N.x,N.y,U.x,U.y)&&(l>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(N,U),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${N.x},${N.y})-(${U.x},${U.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let i=e.x<=t.x,r=e.y<=t.y;return i&&r?0:!i&&r?1:i&&!r?2:3}placeNeutralWalls(){let e=(i,r)=>{if(!this.areAdjacent(i,r)||!this.inBounds(i.x,i.y)||!this.inBounds(r.x,r.y)||this.getWallBetween(i.x,i.y,r.x,r.y))return;let[o,s]=this.sortEdgeEndpoints(i,r);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}]),this.updateWallFormations()},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let i of t){let r=[{x:i.x+1,y:i.y},{x:i.x-1,y:i.y},{x:i.x,y:i.y+1},{x:i.x,y:i.y-1}];for(let o of r)this.inBounds(o.x,o.y)&&e(i,o)}for(let i of this.forestsSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}for(let i of this.minesSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}}static \u0275fac=function(t){return new(t||n)(Me(Ml),Me(Ig),Me(Tg),Me(Ut),Me(Cg),Me(Dg),Me(Ag),Me(Br),Me(cc))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};function vG(n,e){n&1&&(X(),j(0,"polygon",127))}function _G(n,e){n&1&&(X(),j(0,"polygon",127))}function EG(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",213),A())}function bG(n,e){n&1&&(X(),j(0,"polygon",127))}function wG(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",213),A())}function xG(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",214)(2,"polygon",215)(3,"polygon",216),A())}var s0=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(ye(ni),ye(Ut))};static \u0275cmp=kt({type:n,selectors:[["app-game-rules"]],decls:694,vars:76,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","flex-col","justify-between"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"bg-gray-800/60","border","border-blue-500/30","rounded-lg","p-4","shadow-[0_0_15px_rgba(59,130,246,0.1)]"],[1,"text-lg","font-semibold","mb-3","flex","items-center","gap-2"],[1,"text-blue-400"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[45px]","text-center"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[60px]","text-center"],[1,"text-xs","text-gray-400","text-right","italic"],[1,"flex","flex-col","items-center","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","text-white"],[1,"flex","items-center","justify-between","gap-4","border-t","border-white/5","pt-3"],[1,"px-4","py-1","bg-blue-600","border-b-4","border-blue-800","rounded","text-xs","font-mono","text-white","font-bold"],[1,"text-xs","text-blue-300","font-semibold","uppercase","tracking-wider"],[1,"mt-4","p-2","bg-blue-500/10","border","border-blue-500/20","rounded","text-[10px]","text-blue-200/70","leading-tight"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"bg-gray-800/60","border","border-gray-700","rounded-xl","p-6","md:col-span-2","shadow-2xl","backdrop-blur-sm"],[1,"text-xs","uppercase","tracking-widest","text-gray-500","font-bold","mb-6","flex","items-center","gap-2"],[1,"w-8","h-[1px]","bg-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8","items-start"],[1,"space-y-6"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-gray-300","text-sm"],[1,"text-orange-400","font-bold"],[1,"text-blue-400","font-bold"],[1,"p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-xs","text-gray-400","leading-relaxed"],[1,"text-white","font-semibold"],[1,"lg:col-span-2","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-blue-500/50","transition-all","duration-300","flex","items-center","gap-4"],[1,"w-20","h-20","shrink-0"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],["cx","50","cy","50","r","32"],["cx","50","cy","50","r","31","fill","none","stroke","rgba(255,255,255,0.2)","stroke-width","2"],["x","50","y","62","text-anchor","middle","font-size","32","font-weight","800","fill","white"],["transform","translate(18, 5) scale(0.8)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","#60a5fa"],[1,"flex","flex-col"],[1,"text-blue-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"text-gray-300","text-sm","leading-tight"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-red-500/50","transition-all","duration-300","flex","items-center","gap-4"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],["transform","rotate(-45 50 50) translate(40, 10) scale(1.2)"],["x","5","y","0","width","2","height","10","fill","#f87171"],["x","3","y","10","width","6","height","2","fill","#991b1b"],[1,"text-red-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"p-4","bg-gray-800/40","rounded-lg","border","border-gray-700/30"],[1,"text-[10px]","uppercase","tracking-wider","text-gray-500","font-bold","mb-3"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"flex","justify-between","border-b","border-gray-700/50","pb-1"],[1,"text-gray-500"],[1,"text-white"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","#60a5fa","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],[1,"text-lg","font-semibold","mb-1"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","3"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","4"],[1,"mover","triangle","t1-path"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"flex","items-center","gap-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","theme-test-player"],[1,"flex","flex-col","flex-center"],[1,"flex","flex-center","gap-2"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-80"],["points","50,16 86,78 14,78","fill","var(--u-fill)"],["x","49","y","66","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2"],["viewBox","0 0 100 100"],["id","base-circle"],["id","eye"],["id","scan-lvl2"],["id","radar-lvl3"],["id","field-lvl4"],["cx","50","cy","50","r","14","fill","#94a3b8"],["cx","50","cy","50","r","4","fill","#e5e7eb"],["cx","50","cy","50","r","20","fill","none","stroke","#cbd5f5","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","#e5e7eb","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","#f8fafc"],["cx","50","cy","50","r","30","fill","none","stroke","#f1f5f9","stroke-width","1","opacity","0.4"],[1,"unit-svg-wrapper","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-70"],["cx","50","cy","55","r","6","fill","var(--u-core)"],["points","50,5 55,15 45,15","fill","var(--u-stroke)"],["points","92,82 82,78 86,70","fill","var(--u-stroke)"],["points","8,82 18,78 14,70","fill","var(--u-stroke)"],["points","50,2 95,85 5,85","fill","none","stroke","var(--u-core)","stroke-width","2"],["points","50,48 56,52 56,60 50,64 44,60 44,52","fill","var(--u-light)"],["points","50,-2 102,88 -2,88","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","opacity","0.6"],["points","50,-5 54,8 46,8","fill","var(--u-light)"],["points","92,82 88,70 80,78","fill","var(--u-light)"],["points","8,82 20,78 12,70","fill","var(--u-light)"],["id","base-shape"],["id","core"],["id","armor-lvl2"],["id","armor-lvl3"],["id","fortress-lvl4"],["id","fx"],["x","20","y","20","width","60","height","60","rx","6","fill","#2563eb"],["x","46","y","46","width","8","height","8","fill","#93c5fd"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","#60a5fa","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","#93c5fd","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","#bfdbfe"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","#60a5fa","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","#bfdbfe"],["x","78","y","12","width","10","height","10","fill","#bfdbfe"],["x","12","y","78","width","10","height","10","fill","#bfdbfe"],["x","78","y","78","width","10","height","10","fill","#bfdbfe"],["id","base-hex"],["id","links-lvl2"],["id","network-lvl3"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","#10b981"],["cx","50","cy","50","r","4","fill","#6ee7b7"],["x1","50","y1","20","x2","50","y2","40","stroke","#6ee7b7","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","#6ee7b7","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","#6ee7b7","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","#a7f3d0","stroke-width","2"],["cx","50","cy","20","r","3","fill","#34d399"],["cx","80","cy","50","r","3","fill","#34d399"],["cx","50","cy","80","r","3","fill","#34d399"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","#6ee7b7","stroke-width","1.5","stroke-dasharray","4 4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","unit-svg-wrapper-game_rules"],[1,"flex","items-center","gap-6","theme-test-player"],["viewBox","0 0 100 100",1,"w-full","h-full"],["cx","50","cy","50","r","20","fill","var(--u-fill)"],["cx","50","cy","50","r","4","fill","var(--u-light)"],["cx","50","cy","50","r","26","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","var(--u-light)","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","var(--u-light)"],["cx","50","cy","50","r","34","fill","none","stroke","var(--u-light)","stroke-width","1","opacity","0.4"],[1,"flex","items-center","gap-6","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-75"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-110"],["x","20","y","20","width","60","height","60","rx","6","fill","var(--u-dark)"],["x","46","y","46","width","8","height","8","fill","var(--u-core)"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","var(--u-light)"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","var(--u-light)"],["x","78","y","12","width","10","height","10","fill","var(--u-light)"],["x","12","y","78","width","10","height","10","fill","var(--u-light)"],["x","78","y","78","width","10","height","10","fill","var(--u-light)"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","var(--u-emerald)"],["cx","50","cy","50","r","4","fill","var(--u-emerald-stroke)"],["x1","50","y1","20","x2","50","y2","40","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","var(--u-emerald-stroke)","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","2"],["cx","50","cy","20","r","3","fill","var(--u-emerald-stroke)"],["cx","80","cy","50","r","3","fill","var(--u-emerald-stroke)"],["cx","50","cy","80","r","3","fill","var(--u-emerald-stroke)"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 56,10 44,10","fill","var(--u-light)"],["points","99,87 92,74 84,87","fill","var(--u-light)"],["points","1,87 15,87 8,74","fill","var(--u-light)"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),_(5),A(),C(6,"h3",5),_(7),A()(),C(8,"button",6),Vt("click",function(){return i.engine.closeRules()}),_(9," \u2716 "),A()(),C(10,"div",7)(11,"div",8)(12,"div",9),_(13),A(),C(14,"div",10)(15,"div",11)(16,"div",12),_(17,"\u{1F333}"),A(),C(18,"div")(19,"div",13),_(20),A(),C(21,"div",14),_(22),A()()(),C(23,"div",11)(24,"div",12),_(25,"\u{1F3F0}"),A(),C(26,"div")(27,"div",13),_(28),A(),C(29,"div",14),_(30),A()()()()(),C(31,"div",15)(32,"div",16)(33,"div",9),_(34),A(),C(35,"div",17)(36,"div",18)(37,"div",19),_(38," 1 "),A(),C(39,"div",20),_(40,"1\u20134"),A()(),C(41,"div",18)(42,"div",21),_(43," 5 "),A(),C(44,"div",20),_(45,"5\u201320"),A()(),C(46,"div",18)(47,"div",21),_(48,"25"),A(),C(49,"div",20),_(50,"25\u2013100"),A()(),C(51,"div",18)(52,"div",22)(53,"span",23),_(54,"125"),A()(),C(55,"div",20),_(56,"125\u2013500"),A()()()(),C(57,"div",16)(58,"div",24),_(59),A(),C(60,"div",25)(61,"div",26)(62,"div",27),_(63,"2"),A(),C(64,"div",28),_(65,"2"),A(),C(66,"div",29),_(67,"1"),A()()()()(),C(68,"div",30)(69,"div",31)(70,"span",32),_(71,"\u2328\uFE0F"),A(),_(72),A(),C(73,"div",33)(74,"div",34)(75,"div",35)(76,"kbd",36),_(77," Tab "),A(),C(78,"kbd",37),_(79," Space "),A()(),C(80,"div",38),_(81),A()(),C(82,"div",34)(83,"div",39)(84,"kbd",40),_(85,"\u2191"),A(),C(86,"div",35)(87,"kbd",40),_(88,"\u2190"),A(),C(89,"kbd",40),_(90,"\u2193"),A(),C(91,"kbd",40),_(92,"\u2192"),A()()(),C(93,"div",38),_(94),A()(),C(95,"div",41)(96,"kbd",42),_(97," Enter "),A(),C(98,"div",43),_(99),A()()(),C(100,"div",44)(101,"strong"),_(102,"TIP:"),A(),_(103),A()(),C(104,"div",8)(105,"div",9),_(106),A(),C(107,"div",45)(108,"div")(109,"div",46),_(110),A(),C(111,"div",47)(112,"div",48),_(113,"1"),A(),C(114,"div",49),_(115,"1"),A()(),C(116,"div",50),_(117),A()(),C(118,"div")(119,"div",46),_(120),A(),C(121,"div",47)(122,"div",48),_(123,"4"),A(),C(124,"div",51),_(125,"1"),A(),C(126,"span",52),_(127,"CRIT!"),A()(),C(128,"div",50),_(129),A()(),C(130,"div")(131,"div",46),_(132),A(),C(133,"div",47)(134,"div",48),_(135,"1"),A(),C(136,"div",53),_(137,"4"),A(),C(138,"span",54),_(139,"MISS!"),A()(),C(140,"div",50),_(141),A()()()(),C(142,"div",55)(143,"div",56),j(144,"span",57),_(145),A(),C(146,"div",58)(147,"div",59)(148,"div",60)(149,"div",61)(150,"span",62),_(151),A(),C(152,"span",63),_(153,"20%"),A()(),C(154,"div",61)(155,"span",62),_(156),A(),C(157,"span",64),_(158,"20%"),A()(),C(159,"div",65)(160,"p",66)(161,"span",67),_(162,"50%"),A(),_(163),A()()()(),C(164,"div",68)(165,"div",69)(166,"div",70),X(),C(167,"svg",71),j(168,"circle",72)(169,"circle",73),C(170,"text",74),_(171,"1"),A(),C(172,"g",75),j(173,"path",76),A()()(),Re(),C(174,"div",77)(175,"span",78),_(176,"+20 HP Bonus"),A(),C(177,"p",79),_(178),A()()(),C(179,"div",80)(180,"div",70),X(),C(181,"svg",81),j(182,"circle",72)(183,"circle",73),C(184,"text",74),_(185,"1"),A(),C(186,"g",82),j(187,"rect",83)(188,"rect",84),A()()(),Re(),C(189,"div",77)(190,"span",85),_(191,"+20 DMG Bonus"),A(),C(192,"p",79),_(193),A()()()(),C(194,"div",68)(195,"div",86)(196,"p",87),_(197),A(),C(198,"div",88)(199,"div",89)(200,"span",90),_(201,"T1"),A(),C(202,"span",91),_(203,"1"),A()(),C(204,"div",89)(205,"span",90),_(206,"T2"),A(),C(207,"span",91),_(208,"2"),A()(),C(209,"div",89)(210,"span",90),_(211,"T3"),A(),C(212,"span",91),_(213,"4"),A()(),C(214,"div",89)(215,"span",90),_(216,"T4"),A(),C(217,"span",91),_(218,"8"),A()()()(),C(219,"div",80)(220,"div",70),X(),C(221,"svg",81),j(222,"circle",72)(223,"circle",73),C(224,"text",74),_(225,"1"),A(),C(226,"g"),j(227,"path",92)(228,"path",93),A()()(),Re(),C(229,"div",77)(230,"p",79),_(231),A()()()()()(),C(232,"div",16)(233,"div",94),_(234),A(),C(235,"div",95)(236,"div")(237,"div",96),_(238),A(),C(239,"div",97),j(240,"div",98)(241,"div",98)(242,"div",98)(243,"div",98)(244,"div",98)(245,"div",98)(246,"div",99)(247,"div",99)(248,"div",98)(249,"div",98)(250,"div",98)(251,"div",98)(252,"div",98)(253,"div",98)(254,"div",98)(255,"div",98)(256,"div",98)(257,"div",98)(258,"div",98)(259,"div",98)(260,"div",98)(261,"div",98)(262,"div",98)(263,"div",98)(264,"div",98),C(265,"div",100),_(266,"2"),A(),j(267,"div",101),C(268,"div",102),_(269,"\u{1F3F0}"),A()()(),C(270,"div")(271,"div",96),_(272),A(),C(273,"div",103),j(274,"div",98)(275,"div",98)(276,"div",98)(277,"div",98)(278,"div",98)(279,"div",98)(280,"div",99)(281,"div",99)(282,"div",99)(283,"div",98)(284,"div",98)(285,"div",98)(286,"div",98)(287,"div",98)(288,"div",98)(289,"div",98)(290,"div",98)(291,"div",98)(292,"div",98)(293,"div",98)(294,"div",98)(295,"div",98)(296,"div",98)(297,"div",98)(298,"div",98),C(299,"div",104),_(300,"3"),A(),j(301,"div",101),C(302,"div",105),_(303,"\u{1F3F0}"),A()()(),C(304,"div")(305,"div",96),_(306),A(),C(307,"div",106),j(308,"div",98)(309,"div",98)(310,"div",98)(311,"div",98)(312,"div",98)(313,"div",98)(314,"div",99)(315,"div",99)(316,"div",99)(317,"div",99)(318,"div",98)(319,"div",98)(320,"div",98)(321,"div",98)(322,"div",98)(323,"div",98)(324,"div",98)(325,"div",98)(326,"div",98)(327,"div",98)(328,"div",98)(329,"div",98)(330,"div",98)(331,"div",98)(332,"div",98),C(333,"div",107),_(334,"4"),A(),j(335,"div",101),C(336,"div",102),_(337,"\u{1F3F0}"),A()()()()(),C(338,"div",15)(339,"div",16)(340,"div",9),_(341),A(),C(342,"div",17)(343,"div",108)(344,"div",109),_(345,"\u{1F331}"),A(),C(346,"div",110),_(347),A()(),C(348,"div",111),_(349,"\u2192"),A(),C(350,"div",108)(351,"div",109),_(352,"\u{1F33F}"),A(),C(353,"div",110),_(354),A()(),C(355,"div",111),_(356,"\u2192"),A(),C(357,"div",108)(358,"div",109),_(359,"\u{1F333}"),A(),C(360,"div",112),_(361),A()()()(),C(362,"div",16)(363,"div",9),_(364),A(),C(365,"div",113)(366,"div",108)(367,"div",109),_(368,"\u26F0\uFE0F"),A(),C(369,"div",114),_(370),A()(),C(371,"div",111),_(372,"\u2192"),A(),C(373,"div",108)(374,"div",109),_(375,"\u26CF\uFE0F"),A(),C(376,"div",114),_(377),A()(),C(378,"div",111),_(379,"\u2192"),A(),C(380,"div",108)(381,"div",109),_(382,"\u26CF"),A(),C(383,"div",114),_(384),A()(),C(385,"div",111),_(386,"\u2192"),A(),C(387,"div",108)(388,"div",109),_(389,"\u2692"),A(),C(390,"div",114),_(391),A()(),C(392,"div",111),_(393,"\u2192"),A(),C(394,"div",108)(395,"div",109),_(396,"\u{1F9F1}"),A(),C(397,"div",115),_(398),A()()()(),C(399,"div",16)(400,"div",116),_(401),A(),C(402,"div",117)(403,"div",3),j(404,"div",118),C(405,"div",20),_(406),A()(),C(407,"div",3),j(408,"div",119),C(409,"div",20),_(410),A()(),C(411,"div",3),j(412,"div",120),C(413,"div",20),_(414,"Neutral"),A()()()()(),C(415,"div",121)(416,"div",122)(417,"div",9),_(418),A(),C(419,"div",123),X(),C(420,"svg",124)(421,"g"),j(422,"polygon",125),A(),C(423,"text",126),_(424),A()(),C(425,"svg",124)(426,"g"),j(427,"polygon",125),A(),C(428,"text",126),_(429),A(),Q(430,vG,1,0,":svg:polygon",127),A(),C(431,"svg",124)(432,"g"),j(433,"polygon",125),A(),C(434,"text",126),_(435),A(),Q(436,_G,1,0,":svg:polygon",127),Q(437,EG,2,0,":svg:g"),A(),C(438,"svg",124)(439,"g"),j(440,"polygon",125),A(),C(441,"text",126),_(442),A(),Q(443,bG,1,0,":svg:polygon",127),Q(444,wG,2,0,":svg:g"),Q(445,xG,4,0,":svg:g"),A()()()(),Re(),C(446,"div",16)(447,"div",9),_(448),A(),C(449,"div",17),X(),C(450,"svg",128),j(451,"g",129)(452,"g",130)(453,"g",131)(454,"g",132)(455,"g",133),C(456,"g",129),j(457,"circle",134),A(),C(458,"g",130),j(459,"circle",135),A(),C(460,"g",131),j(461,"circle",136),A(),C(462,"g",132),j(463,"line",137)(464,"circle",138),A(),C(465,"g",133),j(466,"circle",139),A()(),Re(),C(467,"div",140),X(),C(468,"svg",141)(469,"g"),j(470,"polygon",125),A(),C(471,"g"),j(472,"circle",142),A(),C(473,"g"),j(474,"polygon",143)(475,"polygon",144)(476,"polygon",145),A(),C(477,"g"),j(478,"polygon",146)(479,"polygon",147),A(),C(480,"g"),j(481,"polygon",148)(482,"polygon",149)(483,"polygon",150)(484,"polygon",151),A()()(),C(485,"svg",128),j(486,"g",152)(487,"g",153)(488,"g",154)(489,"g",155)(490,"g",156)(491,"g",157),C(492,"g",152),j(493,"rect",158),A(),C(494,"g",153),j(495,"rect",159),A(),C(496,"g",154),j(497,"rect",160),A(),C(498,"g",155),j(499,"rect",161)(500,"rect",162),A(),C(501,"g",156),j(502,"rect",163)(503,"rect",164)(504,"rect",165)(505,"rect",166)(506,"rect",167),A()(),C(507,"svg",128),j(508,"g",168)(509,"g",153)(510,"g",169)(511,"g",170)(512,"g",133),C(513,"g",168),j(514,"polygon",171),A(),C(515,"g",153),j(516,"circle",172),A(),C(517,"g",169),j(518,"line",173)(519,"line",174)(520,"line",175),A(),C(521,"g",170),j(522,"polygon",176)(523,"circle",177)(524,"circle",178)(525,"circle",179),A(),C(526,"g",133),j(527,"polygon",180),A()()()(),Re(),C(528,"div",181)(529,"div",9),_(530),A(),C(531,"div",182),X(),C(532,"svg",183)(533,"g"),j(534,"circle",184),A(),C(535,"g"),j(536,"circle",185),A()(),C(537,"svg",183)(538,"g"),j(539,"circle",184),A(),C(540,"g"),j(541,"circle",185),A(),C(542,"g"),j(543,"circle",186),A()(),C(544,"svg",183)(545,"g"),j(546,"circle",184),A(),C(547,"g"),j(548,"circle",185),A(),C(549,"g"),j(550,"circle",186),A(),C(551,"g"),j(552,"line",187)(553,"circle",188),A()(),C(554,"svg",183)(555,"g"),j(556,"circle",184),A(),C(557,"g"),j(558,"circle",185),A(),C(559,"g"),j(560,"circle",186),A(),C(561,"g"),j(562,"line",187)(563,"circle",188),A(),C(564,"g"),j(565,"circle",189),A()()(),Re(),C(566,"div",190),X(),C(567,"svg",191)(568,"g"),j(569,"polygon",125),A(),C(570,"g"),j(571,"circle",142),A()(),C(572,"svg",191)(573,"g"),j(574,"polygon",125),A(),C(575,"g"),j(576,"circle",142),A(),C(577,"g"),j(578,"polygon",143)(579,"polygon",144)(580,"polygon",145),A()(),C(581,"svg",191)(582,"g"),j(583,"polygon",125),A(),C(584,"g"),j(585,"circle",142),A(),C(586,"g"),j(587,"polygon",143)(588,"polygon",144)(589,"polygon",145),A(),C(590,"g"),j(591,"polygon",146)(592,"polygon",147),A()(),C(593,"svg",141)(594,"g"),j(595,"polygon",125),A(),C(596,"g"),j(597,"circle",142),A(),C(598,"g"),j(599,"polygon",143)(600,"polygon",144)(601,"polygon",145),A(),C(602,"g"),j(603,"polygon",146)(604,"polygon",147),A(),C(605,"g"),j(606,"polygon",148)(607,"polygon",149)(608,"polygon",150)(609,"polygon",151),A()()(),Re(),C(610,"div",182),X(),C(611,"svg",192)(612,"g"),j(613,"rect",193),A(),C(614,"g"),j(615,"rect",194),A()(),C(616,"svg",192)(617,"g"),j(618,"rect",193),A(),C(619,"g"),j(620,"rect",194),A(),C(621,"g"),j(622,"rect",195),A()(),C(623,"svg",192)(624,"g"),j(625,"rect",193),A(),C(626,"g"),j(627,"rect",194),A(),C(628,"g"),j(629,"rect",195),A(),C(630,"g"),j(631,"rect",196)(632,"rect",197),A()(),C(633,"svg",192)(634,"g"),j(635,"rect",193),A(),C(636,"g"),j(637,"rect",194),A(),C(638,"g"),j(639,"rect",195),A(),C(640,"g"),j(641,"rect",196)(642,"rect",197),A(),C(643,"g"),j(644,"rect",198)(645,"rect",199)(646,"rect",200)(647,"rect",201)(648,"rect",202),A()()(),Re(),C(649,"div",190),X(),C(650,"svg",183)(651,"g"),j(652,"polygon",203),A(),C(653,"g"),j(654,"circle",204),A()(),C(655,"svg",183)(656,"g"),j(657,"polygon",203),A(),C(658,"g"),j(659,"circle",204),A(),C(660,"g"),j(661,"line",205)(662,"line",206)(663,"line",207),A()(),C(664,"svg",183)(665,"g"),j(666,"polygon",203),A(),C(667,"g"),j(668,"circle",204),A(),C(669,"g"),j(670,"line",205)(671,"line",206)(672,"line",207),A(),C(673,"g"),j(674,"polygon",208)(675,"circle",209)(676,"circle",210)(677,"circle",211),A()(),C(678,"svg",183)(679,"g"),j(680,"polygon",203),A(),C(681,"g"),j(682,"circle",204),A(),C(683,"g"),j(684,"line",205)(685,"line",206)(686,"line",207),A(),C(687,"g"),j(688,"polygon",208)(689,"circle",209)(690,"circle",210)(691,"circle",211),A(),C(692,"g"),j(693,"polygon",212),A()()()()()()()),t&2&&(y(5),W(i.settings.t("GAME_GUIDE")),y(2),W(i.settings.t("TURN_BASED_STRATEGY")),y(6),W(i.settings.t("VICTORY_CONDITIONS")),y(7),W(i.settings.t("MONOPOLY_LABEL")),y(2),W(i.settings.t("MONOPOLY_DESC")),y(6),W(i.settings.t("ANNIHILATION")),y(2),W(i.settings.t("ANNIHILATION_DESC")),y(4),W(i.settings.t("UNIT_EVOLUTION")),y(8),et("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),y(17),W(i.settings.t("EVOLUTION_DESC")),y(13),K(" ",i.settings.currentLang()==="uk"?"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0435 \u0443\u043F\u0440\u0430\u0432\u043B\u0456\u043D\u043D\u044F":"Tactical Controls"," "),y(9),K(" ",i.settings.currentLang()==="uk"?"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0438\u0439 \u0432\u0456\u043B\u044C\u043D\u0438\u0439 \u044E\u043D\u0456\u0442":"Cycle through available units"," "),y(13),K(" ",i.settings.currentLang()==="uk"?"\u0420\u0443\u0445 \u0430\u0431\u043E \u0430\u0442\u0430\u043A\u0430 \u0432\u0438\u0431\u0440\u0430\u043D\u0438\u043C \u044E\u043D\u0456\u0442\u043E\u043C":"Move or attack with selected unit"," "),y(5),K(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0445\u0456\u0434":"End player turn"," "),y(4),K(" ",i.settings.currentLang()==="uk"?"\u041D\u0430 \u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043A\u043E\u0436\u043D\u043E\u0433\u043E \u0445\u043E\u0434\u0443 \u0433\u0440\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u0444\u043E\u043A\u0443\u0441\u0443\u0454\u0442\u044C\u0441\u044F \u043D\u0430 \u043C\u043E\u0431\u0456\u043B\u044C\u043D\u043E\u043C\u0443 \u044E\u043D\u0456\u0442\u0456.":"At turn start, the game auto-focuses on your most mobile unit."," "),y(3),W(i.settings.t("COMBAT_DEEP_DIVE")),y(4),W(i.settings.t("SUCCESSFUL_ATTACK")),y(7),W(i.settings.t("SUCCESSFUL_ATTACK_DESC")),y(3),W(i.settings.t("CRITICAL_HIT")),y(9),W(i.settings.t("CRITICAL_HIT_DESC")),y(3),W(i.settings.t("MISS")),y(9),W(i.settings.t("MISS_DESC")),y(4),K(" ",i.settings.currentLang()==="uk"?"\u0414\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0438":"Extra Mechanics"," "),y(6),K(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043A\u0440\u0438\u0442\u0443":"Crit Chance"," "),y(5),K(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u0443":"Miss Chance"," "),y(7),K(" ",i.settings.currentLang()==="uk"?"\u043F\u0440\u0438 \u0440\u0456\u0432\u043D\u0438\u0445 \u0441\u0438\u043B\u0430\u0445: \u0417\u0430\u0445\u0438\u0441\u0442/\u041D\u0456\u0447\u0438\u044F":"at equal force: Defense/Draw"," "),y(5),Ot("fill","url(#vol-fill-player)"),y(10),K(" ",i.settings.currentLang()==="uk"?"-10% \u0443 \u0432\u043E\u0440\u043E\u0433\u0430 \u0448\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u043D\u0443\u0442\u0438\u0441\u044C":"-10% enemy chance to miss"," "),y(4),Ot("fill","url(#vol-fill-player)"),y(11),K(" ",i.settings.currentLang()==="uk"?"10% \u0448\u0430\u043D\u0441 \u043F\u043E\u043F\u0430\u0441\u0442\u0438 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0443":"10% chance to hit the enemy"," "),y(4),K(" ",i.settings.currentLang()==="uk"?"\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F Tier-\u0440\u0456\u0432\u043D\u0456\u0432":"Tier Values"," "),y(25),Ot("fill","url(#vol-fill-player)"),y(9),K(" ",i.settings.currentLang()==="uk"?"+1 \u0434\u043E \u0430\u0442\u0430\u043A\u0438 \u0432\u0456\u0434 \u0441\u0443\u0441\u0456\u0434\u0441\u0442\u0432\u0430":"+1 to an attack from the neighborhood"," "),y(3),W(i.settings.t("MOVEMENT")),y(4),W(i.settings.t("T1_1_TILE")),y(30),et("left",6,"px")("top",6,"px"),y(4),W(i.settings.t("T3_3_TILES")),y(30),et("right",6,"px")("bottom",6,"px"),y(4),W(i.settings.t("T4_4_TILES")),y(30),et("left",6,"px")("top",6,"px"),y(5),W(i.settings.t("FOREST_CYCLE")),y(6),W(i.settings.t("TURN_1")),y(7),W(i.settings.t("TURN_2")),y(7),W(i.settings.t("PLUS_8_WOOD_PER_TURN")),y(3),W(i.settings.t("IRON_CYCLE")),y(6),W(i.settings.t("TURN_1")),y(7),W(i.settings.t("TURN_2")),y(7),W(i.settings.t("TURN_3")),y(7),W(i.settings.t("TURN_4")),y(7),W(i.settings.t("PLUS_2_IRON_PER_TURN")),y(3),W(i.settings.t("WALL_LEGEND")),y(5),W(i.settings.t("PLAYER")),y(4),W(i.settings.t("AI_FACTION")),y(8),K(" ",i.settings.currentLang()==="uk"?"\u0422\u0440\u0435\u0442\u044F \u0456\u0442\u0435\u0440\u0430\u0446\u0456\u044F \u043E\u0434\u0438\u043D\u0438\u0446\u044C":"Third iteration the units"," "),y(6),K(" ",1," "),y(5),K(" ",2," "),y(),J(430),y(5),K(" ",3," "),y(),J(436),y(),J(437),y(5),K(" ",4," "),y(),J(443),y(),J(444),y(),J(445),y(3),W(i.settings.t("NEW_DESIGN_UNIT")),y(82),W(i.settings.t("NEW_UNIT_EVOLUTION")))},dependencies:[Qt],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:60px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:10px;font-size:12px;font-weight:800;color:#fde047;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:10px;font-size:12px;font-weight:800;color:#93c5fd;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}.unit-svg-wrapper-game_rules:hover{transform:scale(1)}
`],encapsulation:2})};var a0=class n{constructor(e){this.gameEngine=e}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(ye(ni))};static \u0275cmp=kt({type:n,selectors:[["app-support-community"]],decls:51,vars:0,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),_(4,"Support & Community"),A(),C(5,"button",4),Vt("click",function(){return i.gameEngine.closeSupport()}),_(6," \u2716 "),A()(),C(7,"div",5)(8,"div",6)(9,"div",7),_(10,"Donate"),A(),C(11,"div",8),_(12,"Monobank Jar"),A(),C(13,"div",9)(14,"div",10),j(15,"img",11),A(),C(16,"div",12)(17,"div",13),_(18,"send.monobank.ua/jar/2fqGoPhV7G"),A(),C(19,"div",14)(20,"button",15),Vt("click",function(){return i.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),_(21," Open Link \u{1F4DC} "),A(),C(22,"button",16),Vt("click",function(){return i.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),_(23," Copy Link \u{1F4CB} "),A()()()(),C(24,"div",17)(25,"div",8),_(26,"Donatello"),A(),C(27,"button",18),Vt("click",function(){return i.openExternalLink("https://donatello.to/jaerbi")}),_(28," Go to Donatello.to \u{1F48E} "),A()(),C(29,"div",19),_(30,"Thank you for supporting the project!"),A()(),C(31,"div",6)(32,"div",7),_(33,"Social & Feedback"),A(),C(34,"div",20)(35,"button",21),Vt("click",function(){return i.openExternalLink("https://discord.gg/c9tCWFtFaG")}),C(36,"span",22),_(37,"\u{1F5E8}\uFE0F"),A(),C(38,"div",23)(39,"div",24),_(40,"Discord Server"),A(),C(41,"div",25),_(42,"Share ideas & feedback"),A()()(),C(43,"button",26),Vt("click",function(){return i.openExternalLink("https://www.youtube.com/@jaerb1")}),C(44,"span",22),_(45,"\u25B6\uFE0F"),A(),C(46,"div",23)(47,"div",24),_(48,"YouTube"),A(),C(49,"div",25),_(50,"Dev logs & gameplay"),A()()()()()()()())},dependencies:[Qt],encapsulation:2})};function SG(n,e){if(n&1){let t=Ze();E(0,"button",7),re("click",function(){le(t);let r=O();return ce(r.switchToMyStats())}),_(1," My Statistics "),b()}if(n&2){let t=O();Fe("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function IG(n,e){n&1&&(E(0,"div",15)(1,"span",16),G(2,"span",17),E(3,"span"),_(4,"Loading..."),b()()())}function TG(n,e){if(n&1&&G(0,"img",27),n&2){let t=O().$implicit;Ue("src",t.userPhoto,Ki)}}function CG(n,e){n&1&&(E(0,"div",28),_(1,"\u{1F464}"),b())}function DG(n,e){if(n&1&&(E(0,"tr",22)(1,"td",23),_(2),b(),E(3,"td",24),Sr(4,TG,1,1,"img",25)(5,CG,2,0,"ng-template",null,0,aE),_(7),b(),E(8,"td",23),_(9),b(),E(10,"td",26),_(11),b()()),n&2){let t=e.$implicit,i=e.index,r=Cu(6),o=O(3);Fe("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),y(2),W(i+1),y(2),Ue("ngIf",t.userPhoto)("ngIfElse",r),y(3),K(" ",t.playerName," "),y(2),W(t.victoryType),y(2),W(t.turnsPlayed)}}function AG(n,e){if(n&1&&(E(0,"tr")(1,"td",29),_(2),G(3,"br"),E(4,"span",30),_(5,"Be the first to claim victory!"),b()()()),n&2){let t=O(3);y(2),rn(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function MG(n,e){if(n&1&&(E(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),_(5,"Rank"),b(),E(6,"th",20),_(7,"Name"),b(),E(8,"th",20),_(9,"Victory Type"),b(),E(10,"th",20),_(11,"Turns"),b()()(),E(12,"tbody"),Sr(13,DG,12,12,"tr",21)(14,AG,6,2,"tr",9),b()()()),n&2){let t=O(2);y(13),Ue("ngForOf",t.scores()),y(),Ue("ngIf",t.scores().length===0)}}function RG(n,e){if(n&1&&(E(0,"div")(1,"div",11)(2,"span"),_(3,"Top 10 scores for:"),b(),E(4,"span",12),_(5),b(),E(6,"span",13),_(7),b()(),Sr(8,IG,5,0,"div",14)(9,MG,15,2,"div",9),b()),n&2){let t=O();y(5),K(" ",t.settings.difficultyLabel()," "),y(2),K(" ",t.settings.mapSizeLabel()," "),y(),Ue("ngIf",t.loading()),y(),Ue("ngIf",!t.loading())}}function PG(n,e){n&1&&(E(0,"div",15)(1,"span",16),G(2,"span",17),E(3,"span"),_(4,"Loading your stats..."),b()()())}function NG(n,e){n&1&&(E(0,"div",35),_(1," No victories recorded yet. keep playing! "),b())}function kG(n,e){if(n&1&&(E(0,"div",36)(1,"div",37)(2,"span",38),_(3),b(),E(4,"span",39),_(5),b()(),E(6,"div",40)(7,"span",41),_(8,"Best Performance"),b(),E(9,"span",42),_(10),b()(),E(11,"div",43),_(12),ra(13,"date"),b()()),n&2){let t=e.$implicit;y(3),K(" ",t.difficulty," "),y(2),K(" ",t.mapSize," "),y(5),K("",t.turnsPlayed," Turns"),y(2),rn(" ",t.victoryType," \u2022 ",gl(13,5,t.timestamp,"mediumDate")," ")}}function OG(n,e){if(n&1&&(E(0,"div",32),Sr(1,NG,2,0,"div",33)(2,kG,14,8,"div",34),b()),n&2){let t=O(2);y(),Ue("ngIf",t.myBestScores().length===0),y(),Ue("ngForOf",t.myBestScores())}}function FG(n,e){if(n&1&&(E(0,"div",22),Sr(1,PG,5,0,"div",14)(2,OG,3,2,"div",31),b()),n&2){let t=O();y(),Ue("ngIf",t.loading()),y(),Ue("ngIf",!t.loading())}}var l0=class n{constructor(e,t,i,r){this.firebase=e;this.gameEngine=t;this.playerName=i;this.settings=r;this.fetch()}loading=$(!0);scores=$([]);activeTab=$("top10");myBestScores=$([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),i=await this.firebase.getTopScores(10,e,t);this.scores.set(i??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),i=new Map;t.forEach(r=>{let o=`${r.difficulty}-${r.mapSize}`;(!i.has(o)||r.turnsPlayed<i.get(o).turnsPlayed)&&i.set(o,r)}),this.myBestScores.set(Array.from(i.values()).sort((r,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[r.difficulty];return a!==0?a:r.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(ye(Br),ye(ni),ye(cc),ye(Ut))};static \u0275cmp=kt({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,i){t&1&&(E(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),_(4,"Leaderboard"),b(),E(5,"button",5),re("click",function(){return i.gameEngine.closeLeaderboard()}),_(6," \u2716 "),b()(),E(7,"div",6)(8,"button",7),re("click",function(){return i.activeTab.set("top10")}),_(9," Top 10 "),b(),Sr(10,SG,2,6,"button",8),b(),Sr(11,RG,10,4,"div",9)(12,FG,3,2,"div",10),b()()),t&2&&(y(8),Fe("text-white",i.activeTab()==="top10")("border-b-2",i.activeTab()==="top10")("border-indigo-500",i.activeTab()==="top10"),y(2),Ue("ngIf",i.firebase.user$()),y(),Ue("ngIf",i.activeTab()==="top10"),y(),Ue("ngIf",i.activeTab()==="mystats"))},dependencies:[Qt,Hp,PE,Uu],encapsulation:2})};function LG(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function VG(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function UG(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function BG(n,e){n&1&&(X(),j(0,"circle",7))}function jG(n,e){n&1&&(X(),j(0,"circle",8))}function HG(n,e){n&1&&(X(),j(0,"circle",9))}function $G(n,e){if(n&1&&(X(),C(0,"svg",0),j(1,"circle",2)(2,"circle",3),C(3,"text",4),_(4),A(),Q(5,LG,3,0,":svg:g"),Q(6,VG,4,0,":svg:g",5),Q(7,UG,3,0,":svg:g",6),Q(8,BG,1,0,":svg:circle",7),Q(9,jG,1,0,":svg:circle",8),Q(10,HG,1,0,":svg:circle",9),A()),n&2){let t=O();y(),Ot("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),K(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),y(),J(t.unit.hasWeapon?6:-1),y(),J(t.unit.hasArmor?7:-1),y(),J(t.unit.level>=2?8:-1),y(),J(t.unit.level>=3?9:-1),y(),J(t.unit.level>=4?10:-1)}}function GG(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function zG(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function WG(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function qG(n,e){n&1&&(X(),j(0,"polygon",21))}function KG(n,e){n&1&&(X(),j(0,"polygon",22))}function YG(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",23)(2,"polygon",24)(3,"polygon",25),A())}function QG(n,e){if(n&1&&(X(),C(0,"svg",1)(1,"g",17),j(2,"polygon",18)(3,"polygon",19),C(4,"text",20),_(5),A(),Q(6,GG,3,0,":svg:g"),Q(7,zG,4,0,":svg:g",5),Q(8,WG,3,0,":svg:g",6),Q(9,qG,1,0,":svg:polygon",21),Q(10,KG,1,0,":svg:polygon",22),Q(11,YG,4,0,":svg:g"),A()()),n&2){let t=O();y(2),Ot("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),K(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)?6:-1),y(),J(t.unit.hasWeapon?7:-1),y(),J(t.unit.hasArmor?8:-1),y(),J(t.unit.level>=2?9:-1),y(),J(t.unit.level>=3?10:-1),y(),J(t.unit.level>=4?11:-1)}}function JG(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function ZG(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function XG(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function ez(n,e){n&1&&(X(),j(0,"rect",29))}function tz(n,e){n&1&&(X(),j(0,"rect",30))}function nz(n,e){n&1&&(X(),j(0,"rect",31)(1,"rect",32)(2,"rect",33)(3,"rect",34))}function iz(n,e){if(n&1&&(X(),C(0,"svg",0),j(1,"rect",26)(2,"rect",27),C(3,"text",28),_(4),A(),Q(5,JG,3,0,":svg:g"),Q(6,ZG,4,0,":svg:g",5),Q(7,XG,3,0,":svg:g",6),Q(8,ez,1,0,":svg:rect",29),Q(9,tz,1,0,":svg:rect",30),Q(10,nz,4,0),A()),n&2){let t=O();y(),Ot("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),K(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),y(),J(t.unit.hasWeapon?6:-1),y(),J(t.unit.hasArmor?7:-1),y(),J(t.unit.level>=2?8:-1),y(),J(t.unit.level>=3?9:-1),y(),J(t.unit.level>=4?10:-1)}}function rz(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function oz(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function sz(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function az(n,e){n&1&&(X(),j(0,"polygon",38))}function lz(n,e){n&1&&(X(),j(0,"polygon",39))}function cz(n,e){n&1&&(X(),j(0,"circle",40)(1,"circle",41)(2,"circle",42)(3,"circle",43)(4,"circle",44)(5,"circle",45))}function uz(n,e){if(n&1&&(X(),C(0,"svg",0),j(1,"polygon",35)(2,"polygon",36),C(3,"text",37),_(4),A(),Q(5,rz,3,0,":svg:g"),Q(6,oz,4,0,":svg:g",5),Q(7,sz,3,0,":svg:g",6),Q(8,az,1,0,":svg:polygon",38),Q(9,lz,1,0,":svg:polygon",39),Q(10,cz,6,0),A()),n&2){let t=O();y(),Ot("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),K(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),y(),J(t.unit.hasWeapon?6:-1),y(),J(t.unit.hasArmor?7:-1),y(),J(t.unit.level>=2?8:-1),y(),J(t.unit.level>=3?9:-1),y(),J(t.unit.level>=4?10:-1)}}var dc=class n{constructor(e,t){this.gameEngine=e;this.settings=t}unit;static \u0275fac=function(t){return new(t||n)(ye(ni),ye(Ut))};static \u0275cmp=kt({type:n,selectors:[["app-units"]],inputs:{unit:"unit"},decls:4,vars:1,consts:[["viewBox","0 0 100 100",1,"w-full","h-full"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-95"],["cx","50","cy","50","r","32","filter","url(#soft-shadow)"],["cx","50","cy","50","r","31","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","61","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["transform","rotate(-45 30 14)"],["transform","translate(16, 2)"],["cx","50","cy","50","r","35","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["cx","50","cy","50","r","40","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["cx","50","cy","50","r","28","fill","none","stroke","var(--u-light)","stroke-width","2"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","var(--u-light)","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],["x","5","y","0","width","2","height","10","fill","var(--u-light)"],["points","6,-2 8,2 4,2","fill","var(--u-light)"],["x","3","y","10","width","6","height","2","fill","var(--u-fill)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","var(--u-light)"],["d","M5 3V8M3 5H9","stroke","var(--u-fill)","stroke-width","1.2","stroke-linecap","round","opacity","0.7"],["transform","translate(0, 4)"],["points","50,16 86,78 14,78","filter","url(#soft-shadow)"],["points","50,18 82,74 18,74","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","50","y","68","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2","stroke-linejoin","round"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["points","50,0 56,10 44,10","fill","var(--u-light)","stroke-linejoin","round"],["points","99,87 92,74 84,87","fill","var(--u-light)","stroke-linejoin","round"],["points","1,87 15,87 8,74","fill","var(--u-light)","stroke-linejoin","round"],["x","21","y","21","width","56","height","56","rx","6","filter","url(#soft-shadow)"],["x","23","y","23","width","52","height","52","rx","5","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","60","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["x","18","y","18","width","62","height","62","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","14","y","14","width","70","height","70","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["x","12","y","12","width","8","height","8","fill","var(--u-light)"],["x","78","y","12","width","8","height","8","fill","var(--u-light)"],["x","12","y","78","width","8","height","8","fill","var(--u-light)"],["x","78","y","78","width","8","height","8","fill","var(--u-light)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","filter","url(#soft-shadow)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","fill","none","stroke","var(--u-light)","stroke-width","2","opacity","0.4"],["x","49","y","62","text-anchor","middle","font-size","28","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,17 81,35 81,65 50,83 19,65 19,35","fill","none","stroke","var(--u-core)","stroke-width","1.5","stroke-linejoin","round"],["points","50,12 86,32 86,68 50,88 14,68 14,32","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["cx","50","cy","12","r","3","fill","var(--u-light)"],["cx","86","cy","32","r","3","fill","var(--u-light)"],["cx","86","cy","68","r","3","fill","var(--u-light)"],["cx","50","cy","88","r","3","fill","var(--u-light)"],["cx","14","cy","68","r","3","fill","var(--u-light)"],["cx","14","cy","32","r","3","fill","var(--u-light)"]],template:function(t,i){if(t&1&&Q(0,$G,11,8,":svg:svg",0)(1,QG,12,8,":svg:svg",1)(2,iz,11,8,":svg:svg",0)(3,uz,11,8,":svg:svg",0),t&2){let r;J((r=i.unit.tier)===1?0:r===2?1:r===3?2:r===4?3:-1)}},dependencies:[Qt],encapsulation:2})};function dz(n,e){if(n&1){let t=Ze();C(0,"div",7)(1,"div",8),_(2),A(),C(3,"button",9),Vt("click",function(){le(t);let r=O();return ce(r.gameEngine.cancelSandboxSpawn())}),_(4),A()()}if(n&2){let t=O();y(2),K(" ",t.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u0438":"Click an empty tile to spawn"," "),y(2),K(" ",t.settings.currentLang()==="uk"?"\u0412\u0456\u0434\u043C\u0456\u043D\u0430":"Cancel"," ")}}var c0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(ye(ni),ye(Ut))};static \u0275cmp=kt({type:n,selectors:[["app-sandbox"]],decls:24,vars:3,consts:[[1,"absolute","-top-7","left-[-10px]","ml-2","px-3","py-1","rounded-full","bg-pink-600/20","border","border-pink-500/30","text-pink-200","text-[10px]","font-black","uppercase","tracking-widest"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-28","right-[-254px]","min-w-[238px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"mt-2","flex","flex-col","gap-2","w-full","px-2","py-2","rounded-lg","border","border-white/5","bg-white/5"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-pink-200"],[1,"grid","grid-cols-4","gap-2"],[1,"px-2","py-1","rounded","bg-blue-600/20","border","border-blue-500/30","text-blue-100","text-[10px]","cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","bg-red-600/20","border","border-red-500/30","text-red-100","text-[10px]","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-[10px]","text-gray-300"],[1,"px-2","py-1","rounded","bg-gray-700","hover:bg-gray-600","border","border-gray-600","text-white","text-[10px]","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0),_(1),A(),C(2,"div",1)(3,"div",2)(4,"div",3),_(5),A(),C(6,"div",4)(7,"button",5),Vt("click",function(){return i.gameEngine.startSandboxSpawn("player",1)}),_(8," T1 "),A(),C(9,"button",5),Vt("click",function(){return i.gameEngine.startSandboxSpawn("player",2)}),_(10," T2 "),A(),C(11,"button",5),Vt("click",function(){return i.gameEngine.startSandboxSpawn("player",3)}),_(12," T3 "),A(),C(13,"button",5),Vt("click",function(){return i.gameEngine.startSandboxSpawn("player",4)}),_(14," T4 "),A(),C(15,"button",6),Vt("click",function(){return i.gameEngine.startSandboxSpawn("ai",1)}),_(16," T1 "),A(),C(17,"button",6),Vt("click",function(){return i.gameEngine.startSandboxSpawn("ai",2)}),_(18," T2 "),A(),C(19,"button",6),Vt("click",function(){return i.gameEngine.startSandboxSpawn("ai",3)}),_(20," T3 "),A(),C(21,"button",6),Vt("click",function(){return i.gameEngine.startSandboxSpawn("ai",4)}),_(22," T4 "),A()(),Q(23,dz,5,2,"div",7),A()()),t&2&&(y(),K(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox",`
`),y(4),K(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox"," "),y(18),J(i.gameEngine.sandboxSpawnPending()?23:-1))},dependencies:[Qt],encapsulation:2})};var hz=["boardContainer"],It=(n,e)=>({x:n,y:e}),fz=()=>[10,20,30],pz=(n,e)=>e.id,Qk=(n,e)=>e.date;function gz(n,e){if(n&1){let t=Ze();E(0,"div",82)(1,"div",233)(2,"span",234),_(3),b(),E(4,"button",235),re("click",function(){le(t);let r=O();return ce(r.firebase.logout())}),_(5),b()(),E(6,"div",236),G(7,"img",237)(8,"div",238),b()()}if(n&2){let t=O();y(3),K(" ",t.settings.t("VERIFIED")," "),y(2),K(" ",t.settings.t("LOGOUT")," "),y(2),Ue("src",e.photoURL,Ki)}}function mz(n,e){if(n&1){let t=Ze();E(0,"button",239),re("click",function(){le(t);let r=O();return ce(r.firebase.loginWithGoogle())}),G(1,"div",240),E(2,"span",241),_(3),b()()}if(n&2){let t=O();y(3),K(" ",t.settings.t("CONNECT")," ")}}function yz(n,e){if(n&1){let t=Ze();E(0,"div",82)(1,"div",233)(2,"span",234),_(3),b(),E(4,"button",235),re("click",function(){le(t);let r=O(2);return ce(r.firebase.logout())}),_(5),b()(),E(6,"div",236),G(7,"img",237)(8,"div",238),b()(),E(9,"button",197),re("click",function(){le(t);let r=O(2);return ce(r.toggleAutoBattle())}),E(10,"div",198)(11,"span",199),_(12),b(),E(13,"span",200),_(14),b()(),E(15,"div",198),G(16,"span",201),b(),G(17,"div",202),b()}if(n&2){let t=O(2);y(3),K(" ",t.settings.t("VERIFIED")," "),y(2),K(" ",t.settings.t("LOGOUT")," "),y(2),Ue("src",e.photoURL,Ki),y(2),Fe("ring-2",t.isAutoBattleActive())("ring-green-400",t.isAutoBattleActive()),Ue("disabled",t.gameEngine.gameStatus()!=="playing"),y(3),W(t.settings.t("AUTO")),y(2),W(t.settings.t("ENGAGE")),y(2),Fe("bg-green-400",t.isAutoBattleActive())("bg-gray-500",!t.isAutoBattleActive())}}function vz(n,e){if(n&1){let t=Ze();E(0,"button",239),re("click",function(){le(t);let r=O(2);return ce(r.firebase.loginWithGoogle())}),G(1,"div",240),E(2,"span",241),_(3),b()()}if(n&2){let t=O(2);y(3),K(" ",t.settings.t("CONNECT")," ")}}function _z(n,e){if(n&1){let t=Ze();E(0,"div",119)(1,"div",242)(2,"button",243),re("click",function(){le(t);let r=O();return ce(r.closeMobileMenu())}),X(),E(3,"svg",103),G(4,"path",244),b()(),Re(),E(5,"button",245),re("click",function(){le(t);let r=O();return ce(r.gameEngine.resetGame())}),_(6),b(),E(7,"button",245),re("click",function(){le(t);let r=O();return ce(r.gameEngine.toggleRules())}),_(8),b(),E(9,"button",245),re("click",function(){le(t);let r=O();return ce(r.gameEngine.toggleLeaderboard())}),_(10),b(),E(11,"button",245),re("click",function(){le(t);let r=O();return ce(r.gameEngine.toggleLog())}),_(12),b(),E(13,"button",245),re("click",function(){le(t);let r=O();return ce(r.navigateToFeedback())}),_(14),b(),E(15,"button",245),re("click",function(){le(t);let r=O();return ce(r.navigateToRoadmap())}),_(16),b(),E(17,"button",245),re("click",function(){le(t);let r=O();return ce(r.gameEngine.toggleSettings())}),_(18),b(),E(19,"button",245),re("click",function(){le(t);let r=O();return ce(r.navigateToRoadmap())}),_(20),b(),Q(21,yz,18,14)(22,vz,4,1,"button",83),b()()}if(n&2){let t,i=O();y(6),W(i.settings.t("RELOAD")),y(2),W(i.settings.t("INFO")),y(2),W(i.settings.t("RANKING")),y(2),W(i.settings.t("SYSTEM_LOG")),y(2),W(i.settings.t("FEEDBACK_MODULE")),y(2),W(i.settings.t("STRATEGIC_PLAN")),y(2),W(i.settings.t("SETTINGS")),y(2),W(i.settings.t("STRATEGIC_PLAN")),y(),J((t=i.firebase.user$())?21:22,t)}}function Ez(n,e){if(n&1&&(E(0,"div",161),_(1),b()),n&2){let t=O();y(),Jo(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function bz(n,e){if(n&1&&(E(0,"div",248),_(1),b()),n&2){let t=O(2);y(),W(t.gameEngine.endReason())}}function wz(n,e){if(n&1){let t=Ze();E(0,"div",249)(1,"div",252),_(2),b(),G(3,"input",253,1),E(5,"button",254),re("click",function(){le(t);let r=Cu(4),o=O(2);return ce(o.gameEngine.confirmAndSaveScore(r.value))}),_(6),b()()}if(n&2){let t=O(2);y(2),W(t.settings.t("CONFIRM_NAME")),y(),Ue("value",t.gameEngine.getPlayerName()),y(3),K(" ",t.settings.t("SAVE_SCORE")," ")}}function xz(n,e){if(n&1){let t=Ze();E(0,"div",169)(1,"div",246)(2,"h2",247),_(3),ra(4,"titlecase"),b(),Q(5,bz,2,1,"div",248),Q(6,wz,7,3,"div",249),E(7,"button",250),re("click",function(){le(t);let r=O();return ce(r.gameEngine.resetGame())}),_(8),b()(),E(9,"button",251),re("click",function(){le(t);let r=O();return ce(r.gameEngine.toggleLeaderboard())}),_(10),b()()}if(n&2){let t=O();y(2),Fe("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),y(),K(" ",sE(4,9,t.gameEngine.gameStatus()),"! "),y(2),J(t.gameEngine.endReason()?5:-1),y(),J(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),y(2),K(" ",t.settings.t("PLAY_AGAIN")," "),y(2),K(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function Sz(n,e){n&1&&G(0,"app-support-community")}function Iz(n,e){n&1&&G(0,"app-leaderboard-modal")}function Tz(n,e){n&1&&G(0,"app-sandbox")}function Cz(n,e){if(n&1&&(E(0,"div",184)(1,"span",255),_(2),b()()),n&2){let t=O();y(2),K(" ",t.gameEngine.baseHealth().ai," ")}}function Dz(n,e){n&1&&(E(0,"span",267),_(1," \u{1F92C} "),b()),n&2&&et("z-index",100)}function Az(n,e){n&1&&(E(0,"span",267),_(1," \u{1F620} "),b()),n&2&&et("z-index",100)}function Mz(n,e){if(n&1&&Q(0,Dz,2,2,"span",266)(1,Az,2,2,"span",266),n&2){let t=O(3);J(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function Rz(n,e){n&1&&G(0,"div",259)}function Pz(n,e){if(n&1){let t=Ze();E(0,"button",268),re("click",function(){le(t);let r=O().$implicit,o=O().$implicit,s=O();return ce(s.gameEngine.buildForgeAt({x:r,y:o}))}),_(1," Build Forge "),b()}n&2&&et("z-index",60)}function Nz(n,e){if(n&1&&(E(0,"span",269),_(1),b()),n&2){let t=O().$implicit,i=O().$implicit,r=O();et("z-index",55),y(),K(" ",r.gameEngine.getForgeProgress(t,i),"% ")}}function kz(n,e){n&1&&(E(0,"span",273),X(),E(1,"svg",274)(2,"g",275),G(3,"rect",276)(4,"rect",277)(5,"path",278)(6,"rect",279)(7,"rect",280),b()()()),n&2&&et("z-index",50)}function Oz(n,e){if(n&1){let t=Ze();E(0,"button",284),re("click",function(){le(t),O(3);let r=Tr(5),o=O(2);return ce(o.gameEngine.buyWeapon(r.id))}),_(1," Weapon "),b()}}function Fz(n,e){if(n&1){let t=Ze();E(0,"button",285),re("click",function(){le(t),O(3);let r=Tr(5),o=O(2);return ce(o.gameEngine.buyArmor(r.id))}),_(1," Armor "),b()}}function Lz(n,e){if(n&1&&(E(0,"div",281),Q(1,Oz,2,0,"button",282),Q(2,Fz,2,0,"button",283),b()),n&2){O(2);let t=Tr(5),i=O(2);et("z-index",60),y(),J(!t.hasWeapon&&i.gameEngine.resources().iron>=20?1:-1),y(),J(!t.hasArmor&&i.gameEngine.resources().iron>=20?2:-1)}}function Vz(n,e){if(n&1&&(E(0,"span",270),_(1," Forge "),b(),Q(2,kz,8,2,"span",271),Q(3,Lz,3,4,"div",272)),n&2){let t=O().$implicit,i=Tr(5),r=O().$implicit,o=O();et("z-index",55),Fe("scale-60",i&&i.owner==="player")("scale-50",i&&i.owner==="player")("top-1",!(i&&i.owner==="player"))("left-1",!(i&&i.owner==="player"))("top-0",i&&i.owner==="player")("-right-1",i&&i.owner==="player"),y(2),J(o.gameEngine.isVisibleToPlayer(t,r)?2:-1),y(),J(i&&i.owner==="player"?3:-1)}}function Uz(n,e){n&1&&(X(),E(0,"g",291),G(1,"polygon",294)(2,"polygon",295),b())}function Bz(n,e){n&1&&(X(),E(0,"g",296),G(1,"rect",297),b(),E(2,"g",298),G(3,"rect",299)(4,"path",300),b())}function jz(n,e){if(n&1&&(E(0,"span",286),X(),E(1,"svg",287)(2,"defs")(3,"linearGradient",288),G(4,"stop",289)(5,"stop",290),b()(),Q(6,Uz,3,0,":svg:g",291),E(7,"g"),G(8,"polygon",292)(9,"rect",293),b(),Q(10,Bz,5,0),b()()),n&2){O();let t=Tr(5);Fe("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),y(6),J(t?-1:6),y(),Fe("scale-90",t),y(3),J(t?-1:10)}}function Hz(n,e){n&1&&(X(),E(0,"g",304),G(1,"rect",305)(2,"path",306),b())}function $z(n,e){if(n&1&&(E(0,"span",286),X(),E(1,"svg",287)(2,"g"),G(3,"ellipse",301)(4,"path",302)(5,"circle",303),b(),Q(6,Hz,3,0,":svg:g",304),b()()),n&2){O();let t=Tr(5);Fe("scale-50",t)("opacity-40",t)("-translate-x-4",t)("translate-y-4",t),y(6),J(t?-1:6)}}function Gz(n,e){n&1&&G(0,"div",307),n&2&&et("height",2,"px")}function zz(n,e){if(n&1&&(E(0,"span",308),_(1),b(),E(2,"span",309),_(3),b()),n&2){let t=O(3);y(),K(" ",t.gameEngine.baseHealth().player," "),y(2),K(" ",t.gameEngine.reservePoints().player," ")}}function Wz(n,e){if(n&1&&(E(0,"span",310),_(1),b(),E(2,"span",311),_(3),b()),n&2){let t=O(4);y(),K(" ",t.gameEngine.baseHealth().ai," "),y(2),K(" ",t.gameEngine.reservePoints().ai," ")}}function qz(n,e){if(n&1&&Q(0,Wz,4,2),n&2){let t=O().$implicit,i=O().$implicit,r=O();J(r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function Kz(n,e){n&1&&(X(),E(0,"svg",317),G(1,"path",318),b())}function Yz(n,e){n&1&&(X(),E(0,"svg",317),G(1,"path",319),b())}function Qz(n,e){if(n&1){let t=Ze();E(0,"button",316),re("click",function(r){le(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return ce(o.owner==="player"?l.onDestroyIconClick(r,s,a,s+1,a):l.onAttackIconClick(r,s,a,s+1,a))}),Q(1,Kz,2,0,":svg:svg",317)(2,Yz,2,0,":svg:svg",317),b()}if(n&2){let t=O(2),i=O(4);et("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Fe("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),y(),J(t.owner==="player"?1:2)}}function Jz(n,e){if(n&1){let t=Ze();E(0,"div",314),re("mouseenter",function(){le(t);let r=O(),o=O(4);return ce(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){le(t);let r=O(5);return ce(r.gameEngine.hoverFormationById(null))}),Q(1,Qz,3,13,"button",315),b()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();et("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","height 0.25s ease-out"),Fe("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ot("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),y(),J(o.gameEngine.canShowAttackIcon(_t(26,It,i,r),_t(29,It,i+1,r))?1:-1)}}function Zz(n,e){if(n&1&&Q(0,Jz,2,32,"div",313),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();J(r.gameEngine.shouldRenderWall(_t(1,It,t,i),_t(4,It,t+1,i),e.owner)?0:-1)}}function Xz(n,e){if(n&1){let t=Ze();E(0,"button",323),re("click",function(r){le(t);let o=O(3).$implicit,s=O().$implicit,a=O();return ce(a.onBuildIconClick(r,o,s,o+1,s))}),_(1," \u2714 "),b()}if(n&2){let t=O(5);et("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function eW(n,e){if(n&1&&(E(0,"span",322),_(1),b()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();y(),rn(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,It,t,i),_t(5,It,t+1,i))," ")}}function tW(n,e){if(n&1&&(E(0,"div",320),Q(1,Xz,2,8,"button",321),Q(2,eW,2,8,"span",322),b()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();et("right",-r.gameEngine.wallThicknessPx-2,"px")("width",r.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Fe("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,It,t,i),_t(19,It,t+1,i)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,It,t,i),_t(25,It,t+1,i))),y(),J(r.gameEngine.canShowBuildIcon(_t(28,It,t,i),_t(31,It,t+1,i))?1:-1),y(),J(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t+1,i))&&r.gameEngine.edgeCooldownRemaining(_t(34,It,t,i),_t(37,It,t+1,i))>0?2:-1)}}function nW(n,e){if(n&1&&Q(0,Zz,1,7)(1,tW,3,40,"div",312),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();J((t=o.gameEngine.getWallBetween(i,r,i+1,r))?0:1,t)}}function iW(n,e){n&1&&(X(),E(0,"svg",317),G(1,"path",318),b())}function rW(n,e){n&1&&(X(),E(0,"svg",317),G(1,"path",319),b())}function oW(n,e){if(n&1){let t=Ze();E(0,"button",316),re("click",function(r){le(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return ce(o.owner==="player"?l.onDestroyIconClick(r,s,a,s,a+1):l.onAttackIconClick(r,s,a,s,a+1))}),Q(1,iW,2,0,":svg:svg",317)(2,rW,2,0,":svg:svg",317),b()}if(n&2){let t=O(2),i=O(4);et("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Fe("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),y(),J(t.owner==="player"?1:2)}}function sW(n,e){if(n&1){let t=Ze();E(0,"div",326),re("mouseenter",function(){le(t);let r=O(),o=O(4);return ce(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){le(t);let r=O(5);return ce(r.gameEngine.hoverFormationById(null))}),Q(1,oW,3,13,"button",315),b()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();et("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","width 0.25s ease-out"),Fe("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ot("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),y(),J(o.gameEngine.canShowAttackIcon(_t(26,It,i,r),_t(29,It,i,r+1))?1:-1)}}function aW(n,e){if(n&1&&Q(0,sW,2,32,"div",325),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();J(r.gameEngine.shouldRenderWall(_t(1,It,t,i),_t(4,It,t,i+1),e.owner)?0:-1)}}function lW(n,e){if(n&1){let t=Ze();E(0,"button",330),re("click",function(r){le(t);let o=O(3).$implicit,s=O().$implicit,a=O();return ce(a.onBuildIconClick(r,o,s,o,s+1))}),_(1," \u2714 "),b()}if(n&2){let t=O(5);et("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function cW(n,e){if(n&1&&(E(0,"span",329),_(1),b()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();y(),rn(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,It,t,i),_t(5,It,t,i+1))," ")}}function uW(n,e){if(n&1&&(E(0,"div",327),Q(1,lW,2,8,"button",328),Q(2,cW,2,8,"span",329),b()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();et("bottom",-r.gameEngine.wallThicknessPx-2,"px")("height",r.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Fe("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,It,t,i),_t(19,It,t,i+1)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,It,t,i),_t(25,It,t,i+1))),y(),J(r.gameEngine.canShowBuildIcon(_t(28,It,t,i),_t(31,It,t,i+1))?1:-1),y(),J(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t,i+1))&&r.gameEngine.edgeCooldownRemaining(_t(34,It,t,i),_t(37,It,t,i+1))>0?2:-1)}}function dW(n,e){if(n&1&&Q(0,aW,1,7)(1,uW,3,40,"div",324),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();J((t=o.gameEngine.getWallBetween(i,r,i,r+1))?0:1,t)}}function hW(n,e){if(n&1&&G(0,"app-units",334),n&2){let t=O(3);Ue("unit",t)}}function fW(n,e){if(n&1&&(E(0,"span",338),_(1),b()),n&2){let t=e;et("z-index",200),Fe("bg-green-600",t.bg==="bg-green-600")("bg-amber-600",t.bg==="bg-amber-600")("bg-red-600",t.bg==="bg-red-600"),y(),K(" ",t.chance,"% ")}}function pW(n,e){n&1&&(E(0,"span",339),_(1," \u{1F333} "),b()),n&2&&et("z-index",100)}function gW(n,e){n&1&&(E(0,"span",340),_(1," \u{1F331} "),b()),n&2&&et("z-index",100)}function mW(n,e){n&1&&(E(0,"span",340),_(1," \u{1F33F} "),b()),n&2&&et("z-index",100)}function yW(n,e){n&1&&(E(0,"span",343),_(1," \u{1F9F1} "),b()),n&2&&et("z-index",100)}function vW(n,e){n&1&&(E(0,"span",342),_(1,"\u26F0\uFE0F"),b())}function _W(n,e){n&1&&(E(0,"span",342),_(1,"\u26CF\uFE0F"),b())}function EW(n,e){n&1&&(E(0,"span",342),_(1,"\u26CF"),b())}function bW(n,e){n&1&&(E(0,"span",342),_(1,"\u2692"),b())}function wW(n,e){if(n&1&&Q(0,yW,2,2,"span",341)(1,vW,2,0,"span",342)(2,_W,2,0,"span",342)(3,EW,2,0,"span",342)(4,bW,2,0,"span",342),n&2){let t=O(3);J((t.mineOccupationTurns??0)>=5?0:(t.mineOccupationTurns??0)===1?1:(t.mineOccupationTurns??0)===2?2:(t.mineOccupationTurns??0)===3?3:(t.mineOccupationTurns??0)>3?4:-1)}}function xW(n,e){if(n&1&&(E(0,"div",332)(1,"div",333),Q(2,hW,1,1,"app-units",334),b(),Q(3,fW,2,9,"span",335),Q(4,pW,2,2,"span",336)(5,gW,2,2,"span",337)(6,mW,2,2,"span",337),Q(7,wW,5,1),b()),n&2){let t,i=O(2),r=O(3);et("transform",r.gameEngine.getCombinedTransform(i.id))("z-index",r.gameEngine.isUnitMoving(i.id)||r.gameEngine.isUnitAttacking(i.id)?200:null),Fe("shake",r.gameEngine.isUnitShaking(i.id)),y(),et("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px"),Fe("theme-player",i.owner==="player")("theme-ai",i.owner==="ai")("fatigued",i.hasActed)("merge-anim",r.gameEngine.lastMergedUnitId()===i.id)("ring",r.gameEngine.selectedUnitId()===i.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===i.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===i.id)("scale-115",r.gameEngine.selectedUnitId()===i.id&&!r.gameEngine.buildMode())("scale-120",r.gameEngine.lastMergedUnitId()===i.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===i.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===i.id)("pulse-glow",r.gameEngine.pulseUnitId()===i.id),Ot("title",r.gameEngine.formatHoverInfo(i.id)),y(),J(i?2:-1),y(),J((t=r.gameEngine.isUnitHovered(i.id)&&r.gameEngine.getHitChanceInfo(i.id))?3:-1,t),y(),J(i.productionActive?4:(i.forestOccupationTurns??0)===1?5:(i.forestOccupationTurns??0)>1?6:-1),y(3),J(r.gameEngine.isMine(i.position.x,i.position.y)?7:-1)}}function SW(n,e){if(n&1&&Q(0,xW,8,41,"div",331),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();J(!(t===0&&i===0)&&!(t===r.gameEngine.gridSize-1&&i===r.gameEngine.gridSize-1)?0:-1)}}function IW(n,e){if(n&1&&Q(0,SW,1,1),n&2){let t=O().$implicit,i=O().$implicit,r=O();J(e.owner==="player"||r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function TW(n,e){if(n&1&&(E(0,"div",344)(1,"span",345),_(2),b()()),n&2){let t=e.$implicit,i=O(3);et("z-index",100)("opacity",t.opacity),y(),Fe("text-xs",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-base",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text))("text-yellow-300",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-yellow-400",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text)),y(),K(" ",t.text," ")}}function CW(n,e){if(n&1){let t=Ze();E(0,"div",257),re("click",function(){let r=le(t).$implicit,o=O().$implicit,s=O();return ce(s.onTileClick(r,o))})("mouseenter",function(){let r=le(t).$implicit,o=O().$implicit,s=O();return ce(s.gameEngine.setHoveredUnit(s.gameEngine.getUnitAt(r,o)&&(s.gameEngine.getUnitAt(r,o).owner==="player"||s.gameEngine.isVisibleToPlayer(r,o))?s.gameEngine.getUnitAt(r,o).id:null))})("mouseleave",function(){le(t);let r=O(2);return ce(r.gameEngine.setHoveredUnit(null))}),E(1,"span",258),_(2),b(),Q(3,Mz,2,1),Q(4,Rz,1,0,"div",259),pl(5),Q(6,Pz,2,2,"button",260),Q(7,Nz,2,3,"span",261),Q(8,Vz,4,16),Q(9,jz,11,12,"span",262),Q(10,$z,7,9,"span",263),Q(11,Gz,1,2,"div",264),Q(12,zz,4,2),Q(13,qz,1,1),Q(14,nW,2,1),Q(15,dW,2,1),Q(16,IW,1,1),Kt(17,TW,3,13,"div",265,pz),b()}if(n&2){let t,i=e.$implicit,r=O().$implicit,o=O();et("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Fe("cursor-pointer",o.gameEngine.isValidMove(i,r))("bg-gray-700",!o.gameEngine.isValidMove(i,r))("border-gray-600",!o.gameEngine.isValidMove(i,r))("bg-blue-900",i===0&&r===0)("bg-red-900",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-4",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-blue-400",i===0&&r===0)("border-red-400",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-2",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-blue-300",i===0&&r===0&&o.gameEngine.baseDeployActive())("ring-red-300",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&i<=2&&r<=2&&(i!==0||r!==0))("forest-area",o.gameEngine.isForest(i,r))("mine-area",o.gameEngine.isMine(i,r))("forge-area",o.gameEngine.isForge(i,r))("bg-amber-900",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(i,r))("border-gray-800",!o.gameEngine.isVisibleToPlayer(i,r))("bg-green-900",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("border-green-500",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("bg-cyan-900",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("border-cyan-500",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("animate-pulse",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("hover:bg-gray-600",!o.gameEngine.isValidMove(i,r))("hover:bg-green-800",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("hover:bg-cyan-800",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r)),Ot("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0456\u0437\u043D\u0430 \u0448\u0430\u0445\u0442\u0430: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +2 \u0437\u0430\u043B\u0456\u0437\u0430 \u0437\u0430 \u0445\u0456\u0434.":"Iron Mine: Requires 5 consecutive turns of occupation to activate. Once active, yields +2 Iron per turn.":null)("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u041B\u0456\u0441\u043E\u043F\u0438\u043B\u044C\u043D\u044F: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 2 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +8 \u0434\u0435\u0440\u0435\u0432\u0438\u043D\u0438 \u0437\u0430 \u0445\u0456\u0434.":"Sawmill: Requires 2 consecutive occupation turns to activate. Once activated, it gives +8 wood per turn.":null),y(2),rn(" ",i,",",r," "),y(),J(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(i,r)?3:-1),y(),J(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(i,r)?4:-1),y(),Du(o.gameEngine.getUnitAt(i,r)),y(),J(o.gameEngine.buildMode()&&o.gameEngine.canBuildForgeAt(i,r)?6:-1),y(),J(o.gameEngine.isForgeSite(i,r)?7:-1),y(),J(o.gameEngine.isForge(i,r)?8:-1),y(),J(o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?9:-1),y(),J(o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?10:-1),y(),J(o.gameEngine.isForest(i,r)&&o.gameEngine.getUnitAt(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?11:-1),y(),J(i===0&&r===0?12:-1),y(),J(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1?13:-1),y(),J(i<o.gameEngine.gridSize-1?14:-1),y(),J(r<o.gameEngine.gridSize-1?15:-1),y(),J((t=o.gameEngine.getUnitAt(i,r))?16:-1,t),y(),Yt(o.gameEngine.getCombatTextEntriesAt(i,r))}}function DW(n,e){if(n&1&&Kt(0,CW,19,80,"div",256,Ir),n&2){let t=O();Yt(t.gameEngine.gridCols)}}function AW(n,e){n&1&&G(0,"app-game-rules")}function MW(n,e){if(n&1&&(E(0,"div",361),_(1),b()),n&2){let t=O(2);y(),W(t.settings.t("NOT_LOGS_DATA"))}}function RW(n,e){if(n&1&&(E(0,"div",363)(1,"span",364),_(2),b()()),n&2){let t=e.$implicit;et("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Fe("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),y(),iE(t.color),y(),W(t.text)}}function PW(n,e){if(n&1){let t=Ze();E(0,"div",229)(1,"button",346),re("click",function(){le(t);let r=O();return ce(r.gameEngine.toggleLog())}),E(2,"span",347),_(3,"\u2715"),b()(),E(4,"div",348)(5,"div",349)(6,"h3",350),_(7),b(),E(8,"button",351),re("click",function(){le(t);let r=O();return ce(r.gameEngine.clearLogs())}),X(),E(9,"svg",352),G(10,"path",353),b(),_(11),b()(),Re(),E(12,"label",354)(13,"div",109)(14,"input",355),re("change",function(){le(t);let r=O();return ce(r.gameEngine.toggleCombatOnly())}),b(),G(15,"div",356),X(),E(16,"svg",357),G(17,"path",358),b()(),Re(),E(18,"span",359),_(19),b()()(),E(20,"div",360),Q(21,MW,2,1,"div",361),Kt(22,RW,3,7,"div",362,na),b()()}if(n&2){let t=O();y(7),K(" ",t.settings.t("Action_LOG")," "),y(4),K(" ",t.settings.t("CLEAR")," "),y(3),Ue("checked",t.gameEngine.combatOnly()),y(5),K(" ",t.settings.t("COMBAT_ONLY")," "),y(2),J(t.gameEngine.logsFiltered().length===0?21:-1),y(),Yt(t.gameEngine.logsFiltered().reverse())}}function NW(n,e){if(n&1){let t=Ze();E(0,"button",381),re("click",function(){let r=le(t).$implicit,o=O(2);return ce(o.onDifficultyChange(r))}),E(1,"span",382),_(2),b(),_(3),b()}if(n&2){let t=e.$implicit,i=O(2);Fe("bg-blue-500/20",i.settings.difficulty()===t)("border-blue-400/40",i.settings.difficulty()===t)("text-blue-200",i.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",i.settings.difficulty()===t)("bg-white/5",i.settings.difficulty()!==t)("border-white/5",i.settings.difficulty()!==t)("text-stone-500",i.settings.difficulty()!==t)("hover:bg-white/10",i.settings.difficulty()!==t),y(),Fe("opacity-100",i.settings.difficulty()===t),y(),K(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),y(),K(" ",i.settings.t(i.settings.getDifficultyLabel(t))," ")}}function kW(n,e){if(n&1){let t=Ze();E(0,"button",383),re("click",function(){let r=le(t).$implicit,o=O(2);return ce(o.onMapSizeChange(r))}),_(1),b()}if(n&2){let t=e.$implicit,i=O(2);Fe("bg-gradient-to-br",i.settings.mapSize()===t)("from-indigo-600",i.settings.mapSize()===t)("to-indigo-800",i.settings.mapSize()===t)("text-white",i.settings.mapSize()===t)("shadow-lg",i.settings.mapSize()===t)("text-stone-500",i.settings.mapSize()!==t)("hover:text-stone-300",i.settings.mapSize()!==t),y(),rn(" ",t,"x",t," ")}}function OW(n,e){if(n&1){let t=Ze();E(0,"div",230)(1,"div",365),G(2,"div",366),E(3,"h3",367),_(4),b(),E(5,"button",368),re("click",function(){le(t);let r=O();return ce(r.gameEngine.toggleSettings())}),_(6," \u2716 "),b()(),E(7,"div",369)(8,"div",190)(9,"label",370),_(10),b(),E(11,"span",371),_(12),b()(),E(13,"div",372),Kt(14,NW,4,20,"button",373,Ir),b()(),E(16,"div",369)(17,"label",374),_(18),b(),E(19,"div",375),Kt(20,kW,2,16,"button",376,Ir),b()(),E(22,"div",377)(23,"button",378),re("click",function(){le(t);let r=O();return ce(r.settings.setLang("uk"))}),_(24," UA "),b(),E(25,"button",378),re("click",function(){le(t);let r=O();return ce(r.settings.setLang("en"))}),_(26," EN "),b()(),E(27,"label",379)(28,"div",109)(29,"input",110),re("change",function(r){le(t);let o=O();return ce(o.setCustomMode(r.target.checked))}),b(),E(30,"div",380),G(31,"div",112),b()(),E(32,"span",113),_(33,"Custom Mode"),b()()()}if(n&2){let t=O();y(4),W(t.settings.t("SYSTEM_SETTINGS")),y(6),K(" ",t.settings.t("TACTICAL_DIFF")," "),y(2),K(" ",t.settings.t("LEVEL_SELECTION")," "),y(2),Yt(t.settings.diffArr),y(4),K(" ",t.settings.t("SECTOR_DIMENSIONS")," "),y(2),Yt(ia(13,fz)),y(3),Fe("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),y(2),Fe("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en"),y(4),Ue("checked",t.settings.customMode())}}function FW(n,e){if(n&1&&(E(0,"div",392)(1,"span"),_(2),ra(3,"date"),b(),E(4,"span",396),_(5),b(),E(6,"span",397),_(7),b()()),n&2){let t=e.$implicit,i=O(2);y(2),W(gl(3,4,t.date,"yyyy-MM-dd HH:mm")),y(3),W(t.condition),y(2),rn("",t.turns," ",i.settings.t("TURNS"))}}function LW(n,e){if(n&1&&(E(0,"div",393),_(1),b()),n&2){let t=O(2);y(),W(t.settings.t("NO_RECORDS_YET"))}}function VW(n,e){if(n&1&&(E(0,"div",392)(1,"span"),_(2),ra(3,"date"),b(),E(4,"span",396),_(5),b(),E(6,"span",397),_(7),b()()),n&2){let t=e.$implicit,i=O(2);y(2),W(gl(3,4,t.date,"yyyy-MM-dd HH:mm")),y(3),W(t.condition),y(2),rn("",t.turns," ",i.settings.t("TURNS"))}}function UW(n,e){if(n&1&&(E(0,"div",393),_(1),b()),n&2){let t=O(2);y(),W(t.settings.t("NO_RECORDS_YET"))}}function BW(n,e){if(n&1){let t=Ze();E(0,"div",231)(1,"div",384)(2,"div",385)(3,"h2",386),_(4),b(),E(5,"button",387),re("click",function(){le(t);let r=O();return ce(r.gameEngine.closeHighScores())}),_(6," \u2716 "),b()(),E(7,"div",388),_(8),b(),E(9,"div",389)(10,"div",390)(11,"h3",391),_(12),b(),Kt(13,FW,8,7,"div",392,Qk,!1,LW,2,1,"div",393),b(),E(16,"div",390)(17,"h3",394),_(18),b(),Kt(19,VW,8,7,"div",392,Qk,!1,UW,2,1,"div",393),b()(),E(22,"div",395),_(23),b()()()}if(n&2){let t=O();y(4),W(t.settings.t("HIGH_SCORES")),y(4),Jo(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),y(4),W(t.settings.t("TOP_3_PLAYER")),y(),Yt(t.gameEngine.getHighScoresForCurrentCombo().wins),y(5),W(t.settings.t("TOP_3_LOSES_PLAYER")),y(),Yt(t.gameEngine.getHighScoresForCurrentCombo().losses),y(4),W(t.settings.t("CHANGE_RECORDS_INFO"))}}function jW(n,e){if(n&1){let t=Ze();E(0,"div",232)(1,"div",398),_(2," Debug Mode "),b(),E(3,"button",399),re("click",function(){le(t);let r=O();return ce(r.gameEngine.debugInstantWin())}),_(4," \u26A1 Instant Win "),b(),E(5,"button",400),re("click",function(){le(t);let r=O();return ce(r.gameEngine.debugCycleSettings())}),_(6," \u{1F504} Cycle Settings "),b(),E(7,"div",401),_(8),b()()}if(n&2){let t=O();y(8),rn(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var u0=class n{constructor(e,t,i,r){this.gameEngine=e;this.settings=t;this.firebase=i;this.router=r}boardContainer;isAutoBattleActive=$(!1);isMobileMenuOpen=$(!1);lastEconomyProcessedTurn=-1;ngOnInit(){this.gameEngine.resetGame()}ngOnDestroy(){this.isAutoBattleActive.set(!1),this.gameEngine.pauseGame()}goToHub(){this.isAutoBattleActive.set(!1),this.router.navigate(["/"])}get isProduction(){return!uM()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}centerOnSelectedUnit(){let e=this.boardContainer?.nativeElement;if(!e)return;let t=this.gameEngine.selectedUnit();if(!t)return;let i=this.gameEngine.tileSizePx,r=this.gameEngine.wallThicknessPx+2,o=i+r,s=t.position.x*o+i/2,a=t.position.y*o+i/2,l=Math.max(0,Math.min(s-e.clientWidth/2,e.scrollWidth-e.clientWidth)),u=Math.max(0,Math.min(a-e.clientHeight/2,e.scrollHeight-e.clientHeight));e.scrollTo({left:l,top:u,behavior:"smooth"})}activeKeys=new Set;onKeyDown(e){if(this.gameEngine.gameStatus()!=="playing")return;let t=e.key;if(t==="Tab"||t===" "||e.code==="Space"){e.preventDefault(),this.gameEngine.isPlayerTurn()&&this.gameEngine.selectNextAvailableUnitTab();return}if(t==="Enter"){e.preventDefault(),this.gameEngine.endPlayerTurn();return}let i=this.gameEngine.selectedUnit();if(!i||i.hasActed)return;this.activeKeys.add(t);let r=0,o=0;if((this.activeKeys.has("ArrowUp")||this.activeKeys.has("w")||this.activeKeys.has("W"))&&(o-=1),(this.activeKeys.has("ArrowDown")||this.activeKeys.has("s")||this.activeKeys.has("S"))&&(o+=1),(this.activeKeys.has("ArrowLeft")||this.activeKeys.has("a")||this.activeKeys.has("A"))&&(r-=1),(this.activeKeys.has("ArrowRight")||this.activeKeys.has("d")||this.activeKeys.has("D"))&&(r+=1),r===0&&o===0)return;e.preventDefault();let s=this.gameEngine.validMoves(),l=r!==0&&o!==0?i.tier===4?3:1:i.tier>=3||i.tier===2?2:1,u=null;for(let d=1;d<=l;d++){let h=i.position.x+r*d,p=i.position.y+o*d,g={x:h,y:p};if(s.some(x=>x.x===h&&x.y===p))u=g;else break}if(!u){let d={x:i.position.x,y:i.position.y},h={x:i.position.x+r,y:i.position.y+o};if(this.gameEngine.getWallBetween(d.x,d.y,h.x,h.y)){this.gameEngine.attackOrDestroyWallBetween(d,h);return}let g=this.gameEngine.getUnitAt(h.x,h.y);if(g&&g.owner!==i.owner){this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.isValidMove(h.x,h.y)&&this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.moveSelectedUnit(u)}onKeyUp(e){this.activeKeys.delete(e.key)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.settings.customMode()&&this.gameEngine.sandboxSpawnPending()){this.gameEngine.getUnitAt(e,t)||this.gameEngine.spawnSandboxAt({x:e,y:t});return}if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let i=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}let r=this.gameEngine.selectedUnit();if(r){let o=e-r.position.x,s=t-r.position.y;if(Math.abs(o)+Math.abs(s)===1&&this.gameEngine.getWallBetween(r.position.x,r.position.y,e,t)){this.gameEngine.attackOrDestroyWallBetween(r.position,{x:e,y:t});return}}if(i&&i.owner==="player"){this.gameEngine.selectUnit(i.id);return}this.gameEngine.selectUnit(null)}setCustomMode(e){this.settings.setCustomMode(e),this.gameEngine.resetGame()}onEdgeClick(e,t,i,r,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,i,r,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onDestroyIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:i},{x:r,y:o})}onBuildIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onAttackIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(r=>setTimeout(r,250)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.turn();this.lastEconomyProcessedTurn!==e&&(this.gameEngine.botEconomyPhase("player"),this.lastEconomyProcessedTurn=e),this.gameEngine.playerAutoStep()||this.gameEngine.selectUnit(null),this.gameEngine.remainingActions()===0&&(await new Promise(r=>setTimeout(r,1e3)),this.isAutoBattleActive()&&this.gameEngine.isPlayerTurn()&&this.gameEngine.endPlayerTurn())}static \u0275fac=function(t){return new(t||n)(ye(ni),ye(Ut),ye(Br),ye(yi))};static \u0275cmp=kt({type:n,selectors:[["app-game"]],viewQuery:function(t,i){if(t&1&&bp(hz,5),t&2){let r;wp(r=xp())&&(i.boardContainer=r.first)}},hostBindings:function(t,i){t&1&&re("keydown",function(o){return i.onKeyDown(o)},ta)("keyup",function(o){return i.onKeyUp(o)},ta)},decls:377,vars:124,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],["title","Return to Gaming Hub",1,"cursor-pointer","p-2","bg-slate-800/50","hover:bg-slate-700","border","border-slate-700/50","rounded-lg","transition-all","group/btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-slate-400","group-hover/btn:text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["d","M6 18 L10 12 L14 18 Z","fill","#9ca3af"],["cx","12","cy","10","r","3","fill","#6b7280"],[1,"hud-value","font-mono","text-sm","font-bold","text-slate-300"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-6xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],["width","24","height","24","viewBox","0 0 24 24"],[1,"font-mono","text-lg","font-bold","text-slate-300"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","roadmap","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto","no-select"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"flex","items-center","justify-between","w-full","gap-2","z-10","text-amber-200"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","mine-area","forge-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click","mouseenter","mouseleave"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"z-index"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","-translate-x-4","translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"click"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none"],[1,"absolute","text-[10px]","font-bold","px-1","rounded","bg-yellow-300/80","text-black","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90",3,"z-index"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90"],["viewBox","0 0 128 128",1,"w-full","h-full"],["transform","translate(0,10) scale(1)"],["x","20","y","80","width","88","height","18","rx","4","fill","#6b7280"],["x","30","y","70","width","68","height","12","rx","3","fill","#9ca3af"],["d","M32 40 H96 L86 56 H42 Z","fill","#4b5563"],["x","56","y","30","width","16","height","12","rx","2","fill","#6b7280"],["x","60","y","20","width","8","height","12","rx","2","fill","#9ca3af"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer",3,"click"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer",3,"click"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],["cx","64","cy","96","rx","40","ry","10","fill","#374151"],["d","M32 96 L56 48 L72 80 L96 96 Z","fill","#6b7280","stroke","#4b5563","stroke-width","4"],["cx","58","cy","60","r","6","fill","#9ca3af"],["transform","translate(82, 30) rotate(-20) scale(1.3)"],["width","4","height","30","rx","2","fill","#6b7280"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#f59e0b","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none","move-anim",3,"shake","transform","z-index"],[1,"pointer-events-none","move-anim"],[1,"unit-svg-wrapper"],[3,"unit"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow",3,"bg-green-600","bg-amber-600","bg-red-600","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-left-1","opacity-70","[style.z-index]='100'"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"mt-3","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-pink-500","peer-checked:border-pink-500","transition-all"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,i){if(t&1){let r=Ze();E(0,"div",2)(1,"div",3),G(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),b(),X(),E(7,"svg",9)(8,"defs")(9,"radialGradient",10),G(10,"stop",11)(11,"stop",12)(12,"stop",13),b(),E(13,"radialGradient",14),G(14,"stop",15)(15,"stop",16)(16,"stop",17),b(),E(17,"radialGradient",18),G(18,"stop",19)(19,"stop",20)(20,"stop",21),b(),E(21,"linearGradient",22),G(22,"stop",23)(23,"stop",24),b(),E(24,"filter",25),G(25,"feDropShadow",26),b()()(),E(26,"svg",27)(27,"defs")(28,"clipPath",28),G(29,"path",29),b(),E(30,"symbol",30),G(31,"path",31),b()()(),Re(),E(32,"div",32)(33,"button",33),re("click",function(){return le(r),ce(i.goToHub())}),X(),E(34,"svg",34),G(35,"path",35),b()(),Re(),E(36,"div",36),G(37,"div",37)(38,"div",38),X(),E(39,"svg",39),G(40,"path",40)(41,"rect",41),b(),Re(),G(42,"div",42)(43,"div",43),b(),E(44,"div",44)(45,"div",45)(46,"h1",46)(47,"span",47),_(48,"Shape"),b(),E(49,"span",48),_(50," Tactics "),b()(),E(51,"div",49),G(52,"div",50)(53,"div",51),b()(),E(54,"div",52)(55,"span",53),_(56),b()()(),G(57,"div",54),b(),E(58,"div",55)(59,"div",56)(60,"button",57),re("click",function(){return le(r),ce(i.gameEngine.resetGame())}),X(),E(61,"svg",58),G(62,"path",59),b(),Re(),E(63,"span",60),_(64),b()(),G(65,"div",61),E(66,"button",62),re("click",function(){return le(r),ce(i.gameEngine.toggleRules())}),X(),E(67,"svg",63),G(68,"path",64),b(),Re(),E(69,"span",65),_(70),b()()(),E(71,"div",66)(72,"button",67),re("click",function(){return le(r),ce(i.gameEngine.toggleHighScores())}),X(),E(73,"svg",68),G(74,"path",69),b(),Re(),E(75,"span",70),_(76),b()(),E(77,"button",71),re("click",function(){return le(r),ce(i.gameEngine.toggleLeaderboard())}),X(),E(78,"svg",68),G(79,"path",72),b(),Re(),E(80,"span",70),_(81),b()(),E(82,"button",73),re("click",function(){return le(r),ce(i.gameEngine.toggleLog())}),X(),E(83,"svg",68),G(84,"path",74),b(),Re(),E(85,"span",70),_(86),b()(),E(87,"button",75),re("click",function(){return le(r),ce(i.navigateToFeedback())}),X(),E(88,"svg",68),G(89,"path",76),b(),Re(),E(90,"span",70),_(91),b()()(),E(92,"div",77)(93,"button",78),re("click",function(){return le(r),ce(i.gameEngine.toggleSettings())}),X(),E(94,"svg",79),G(95,"path",80)(96,"path",81),b()(),Q(97,gz,9,3,"div",82)(98,mz,4,1,"button",83),b()(),Re(),E(99,"div",84)(100,"div",85),X(),E(101,"svg",86),G(102,"rect",87)(103,"circle",88),b(),Re(),E(104,"span",89),_(105),b()(),E(106,"div",85),X(),E(107,"svg",86),G(108,"path",90)(109,"circle",91),b(),Re(),E(110,"span",92),_(111),b()(),E(112,"div",85),X(),E(113,"svg",86),G(114,"polygon",93),b(),Re(),E(115,"span",94),_(116),b()(),E(117,"div",85),X(),E(118,"svg",86),G(119,"circle",95)(120,"path",96),b(),Re(),E(121,"span",97),_(122),b()(),E(123,"div",85),X(),E(124,"svg",86),G(125,"path",98)(126,"rect",99)(127,"rect",100),b(),Re(),E(128,"span",101),_(129),b()(),E(130,"button",102),re("click",function(){return le(r),ce(i.toggleMobileMenu())}),X(),E(131,"svg",103),G(132,"path",104),b()()(),Re(),E(133,"div",105)(134,"button",106),re("click",function(){return le(r),ce(i.gameEngine.toggleBuildMode())}),X(),E(135,"svg",86),G(136,"path",107),b()(),Re(),E(137,"button",106),re("click",function(){return le(r),ce(i.gameEngine.convertWoodToReserve())}),_(138," +1 "),b(),E(139,"button",106),re("click",function(){return le(r),ce(i.gameEngine.maxConvertWoodToReserve())}),_(140),b(),E(141,"label",108)(142,"div",109)(143,"input",110),re("change",function(){return le(r),ce(i.gameEngine.toggleFogDebug())}),b(),E(144,"div",111),G(145,"div",112),b()(),E(146,"span",113),_(147),b()(),E(148,"div",114),_(149),b(),E(150,"button",115),re("click",function(){return le(r),ce(i.gameEngine.endPlayerTurn())}),X(),E(151,"svg",116),G(152,"path",117)(153,"path",118),b()()(),Q(154,_z,23,9,"div",119),Re(),E(155,"div",120),G(156,"div",121),E(157,"div",122)(158,"div",123)(159,"span",124),_(160),b(),E(161,"span",125),_(162),b()(),G(163,"div",126),E(164,"div",127)(165,"div",128)(166,"span",129),X(),E(167,"svg",130),G(168,"rect",87)(169,"circle",131)(170,"circle",132)(171,"rect",133)(172,"circle",134)(173,"circle",135),b()(),Re(),E(174,"span",136),_(175),b()(),E(176,"div",128)(177,"span",129),X(),E(178,"svg",137),G(179,"path",90)(180,"circle",91),b()(),Re(),E(181,"span",138),_(182),b()(),E(183,"div",139)(184,"span",129)(185,"div",140),X(),E(186,"svg",141),G(187,"polygon",142)(188,"rect",143)(189,"polygon",144)(190,"rect",145)(191,"polygon",146)(192,"rect",147),E(193,"g",148),G(194,"rect",149)(195,"polygon",150),b(),E(196,"g",151),G(197,"rect",152)(198,"circle",153)(199,"circle",154),b()()()(),Re(),E(200,"span",155),_(201),E(202,"span",156),_(203,"/"),b(),_(204),b()()()(),E(205,"div",157),G(206,"div",158),E(207,"span",159),_(208),b(),E(209,"div",45)(210,"span",160),_(211),b()(),Q(212,Ez,2,3,"div",161),b(),E(213,"div",122)(214,"div",127)(215,"div",128)(216,"span",162),_(217),b(),E(218,"span",129),X(),E(219,"svg",130),G(220,"rect",87)(221,"circle",131)(222,"circle",132)(223,"rect",133)(224,"circle",134)(225,"circle",135),b()()(),Re(),E(226,"div",128)(227,"span",129),X(),E(228,"svg",137),G(229,"path",90)(230,"circle",91),b()(),Re(),E(231,"span",138),_(232),b()(),E(233,"div",163)(234,"span",164),_(235),E(236,"span",156),_(237,"/"),b(),_(238),b(),E(239,"span",129)(240,"div",140),X(),E(241,"svg",141),G(242,"polygon",142)(243,"rect",143)(244,"polygon",144)(245,"rect",145)(246,"polygon",146)(247,"rect",147),E(248,"g",148),G(249,"rect",149)(250,"polygon",165),b(),E(251,"g",151),G(252,"rect",152)(253,"circle",153)(254,"circle",154),b()()()()()(),Re(),G(255,"div",126),E(256,"div",166)(257,"span",167),_(258),b(),E(259,"span",168),_(260,"jaerbi"),b()()()(),Q(261,xz,11,11,"div",169),E(262,"button",170),re("click",function(){return le(r),ce(i.navigateToRoadmap())}),E(263,"div",171),G(264,"div",172),E(265,"span",173),_(266),b()(),E(267,"div",174),X(),E(268,"svg",175),G(269,"path",176),b()()(),Re(),E(270,"button",177),re("click",function(){return le(r),ce(i.gameEngine.toggleSupport())}),E(271,"span",129),_(272,"\u2764\uFE0F"),b(),E(273,"span",178),_(274),b()(),Q(275,Sz,1,0,"app-support-community"),Q(276,Iz,1,0,"app-leaderboard-modal"),E(277,"div",179),Q(278,Tz,1,0,"app-sandbox"),E(279,"div",180,0)(281,"div",181)(282,"div",182)(283,"span",183),_(284),b()(),Q(285,Cz,3,1,"div",184),Kt(286,DW,2,0,null,null,Ir),b()(),E(288,"div",185)(289,"div",186),G(290,"div",187),E(291,"div",188)(292,"span",189),_(293),b(),E(294,"div",190)(295,"span",191),_(296),b(),E(297,"div",192)(298,"span",129),_(299),b()()(),E(300,"div",193),G(301,"div",194),b()()()(),E(302,"div",195)(303,"div",196)(304,"button",197),re("click",function(){return le(r),ce(i.toggleAutoBattle())}),E(305,"div",198)(306,"span",199),_(307),b(),E(308,"span",200),_(309),b()(),E(310,"div",198),G(311,"span",201),b(),G(312,"div",202),b(),E(313,"button",203),re("click",function(){return le(r),ce(i.gameEngine.toggleBuildMode())}),E(314,"div",204)(315,"span",205),_(316,"+1"),b(),E(317,"div",206),X(),E(318,"svg",207),G(319,"path",208)(320,"path",209)(321,"path",210)(322,"rect",211),b()()(),Re(),E(323,"div",212)(324,"span"),_(325,"-10"),b(),E(326,"div",213),X(),E(327,"svg",214),G(328,"rect",215)(329,"circle",216)(330,"circle",217),b()()(),Re(),G(331,"div",202),b(),E(332,"button",218),re("click",function(){return le(r),ce(i.gameEngine.convertWoodToReserve())}),E(333,"div",219)(334,"span",220)(335,"span"),_(336,"20"),b(),E(337,"div",213),X(),E(338,"svg",214),G(339,"rect",215)(340,"circle",216)(341,"circle",217),b()()(),Re(),E(342,"span",129),_(343,"\u2794"),b(),E(344,"span",221),_(345,"1 \u{1F464}"),b()()(),E(346,"button",222),re("click",function(){return le(r),ce(i.gameEngine.maxConvertWoodToReserve())}),E(347,"div",223)(348,"span",224),_(349),b(),E(350,"span",129),_(351,"\u2794"),b(),E(352,"span",129),_(353,"\u{1F465}++"),b()()()(),E(354,"label",225)(355,"div",109)(356,"input",110),re("change",function(){return le(r),ce(i.gameEngine.toggleFogDebug())}),b(),E(357,"div",111),G(358,"div",112),b()(),E(359,"span",113),_(360),b()(),E(361,"button",226),re("click",function(){return le(r),ce(i.gameEngine.endPlayerTurn())}),E(362,"div",227)(363,"span",224),_(364),b(),X(),E(365,"svg",116),G(366,"path",117)(367,"path",118),b()()(),Re(),E(368,"div",114),_(369),b()()(),E(370,"div",228),_(371),b(),Q(372,AW,1,0,"app-game-rules"),Q(373,PW,24,5,"div",229),Q(374,OW,34,14,"div",230),Q(375,BW,24,9,"div",231),Q(376,jW,9,2,"div",232),b()}if(t&2){let r;y(56),W(i.settings.version),y(8),K(" ",i.settings.t("RELOAD")," "),y(6),K(" ",i.settings.t("INFO")," "),y(6),W(i.settings.t("RECORDS")),y(5),W(i.settings.t("RANKING")),y(5),W(i.settings.t("SYSTEM_LOG")),y(5),W(i.settings.t("FEEDBACK_MODULE")),y(6),J((r=i.firebase.user$())?97:98,r),y(8),W(i.gameEngine.resources().wood),y(6),W(i.gameEngine.resources().iron),y(5),rn(" ",i.gameEngine.getForestControl().player,"/",i.gameEngine.getForestControl().total," "),y(6),W(i.gameEngine.turn()),y(7),rn(" ",i.gameEngine.getForestControl().player," : ",i.gameEngine.getForestControl().ai," "),y(5),Ue("disabled",!i.gameEngine.canBuildThisTurn()),y(3),Ue("disabled",!i.gameEngine.canAddReserveTurn()),y(2),Ue("disabled",!i.gameEngine.canAddReserveTurn()),y(),K(" ",i.settings.t("ALL")," "),y(3),Ue("checked",i.gameEngine.fogDebugDisabled()),y(4),W(i.settings.t("MAP_HACK")),y(2),rn(" ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),y(5),J(i.isMobileMenuOpen()?154:-1),y(6),K(" ",i.settings.t("COMMANDER")," "),y(2),K(" ",i.settings.t("PLAYER")," "),y(3),Ot("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),y(10),W(i.gameEngine.resources().wood),y(),Ot("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),y(6),W(i.gameEngine.resources().iron),y(),Ot("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),y(18),K(" ",i.gameEngine.getForestControl().player," "),y(3),K(" ",i.gameEngine.getForestControl().total," "),y(4),K(" ",i.settings.t("TURN_CYCLE")," "),y(3),K(" ",i.gameEngine.turn()," "),y(),J(i.gameEngine.monopolyTurnsLeft()>0?212:-1),y(3),Ot("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),y(2),W(i.gameEngine.aiWood()),y(9),Ot("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),y(6),W(i.gameEngine.aiIron()),y(),Ot("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),y(2),K(" ",i.gameEngine.getForestControl().ai," "),y(3),K(" ",i.gameEngine.getForestControl().total," "),y(20),K(" ",i.settings.t("HOSTILE")," "),y(3),J(i.gameEngine.shouldShowEndOverlay()?261:-1),y(5),K(" ",i.settings.t("STRATEGIC_PLAN")," "),y(8),W(i.settings.t("SUPPORT")),y(),J(i.gameEngine.supportOpen()?275:-1),y(),J(i.gameEngine.leaderboardOpen()?276:-1),y(2),J(i.settings.customMode()?278:-1),y(),Fe("shake",i.gameEngine.screenShake())("mood-none",i.gameEngine.currentMood()==="none")("mood-angry",i.gameEngine.currentMood()==="angry")("mood-rage",i.gameEngine.currentMood()==="rage"),y(2),et("grid-template-columns","repeat("+i.gameEngine.gridSize+", minmax("+i.gameEngine.tileMinSizePx+"px, "+i.gameEngine.tileSizePx+"px))")("gap",i.gameEngine.wallThicknessPx+2,"px"),y(3),K(" ",i.gameEngine.baseHealth().player," "),y(),J(i.gameEngine.isVisibleToPlayer(i.gameEngine.gridSize-1,i.gameEngine.gridSize-1)?285:-1),y(),Yt(i.gameEngine.gridRows),y(4),Fe("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),y(3),W(i.settings.t("RISK")),y(2),Fe("text-lime-300",i.settings.difficulty()==="baby")("text-emerald-300",i.settings.difficulty()==="normal")("text-orange-400",i.settings.difficulty()==="hard")("text-red-500",i.settings.difficulty()==="nightmare"),y(),K(" ",i.settings.t(i.settings.getDifficultyLabel(i.settings.difficulty()))," "),y(3),K(" ",i.settings.difficulty()==="baby"?"\u{1F476}":i.settings.difficulty()==="normal"?"\u{1F920}":i.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),y(2),et("width",i.settings.difficulty()==="baby"?25:i.settings.difficulty()==="normal"?50:i.settings.difficulty()==="hard"?75:100,"%"),Fe("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),y(3),Fe("ring-2",i.isAutoBattleActive())("ring-green-400",i.isAutoBattleActive()),Ue("disabled",i.gameEngine.gameStatus()!=="playing"),y(3),W(i.settings.t("AUTO")),y(2),W(i.settings.t("ENGAGE")),y(2),Fe("bg-green-400",i.isAutoBattleActive())("bg-gray-500",!i.isAutoBattleActive()),y(2),Fe("ring-2",i.gameEngine.buildMode())("ring-blue-400",i.gameEngine.buildMode()),Ue("disabled",i.gameEngine.wallBuiltThisTurn()||!i.gameEngine.canBuildThisTurn()),y(19),Ue("disabled",!i.gameEngine.canAddReserveTurn()),y(14),Ue("disabled",!i.gameEngine.canAddReserveTurn()),y(3),W(i.settings.t("ALL")),y(7),Ue("checked",i.gameEngine.fogDebugDisabled()),y(4),W(i.settings.t("MAP_HACK")),y(4),W(i.settings.t("NEXT_TURN")),y(5),Jo(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),y(2),K(" ",i.settings.version," | \xA9\uFE0E Created by jaerbi and just "),y(),J(i.gameEngine.rulesOpen()?372:-1),y(),J(i.gameEngine.logOpen()?373:-1),y(),J(i.gameEngine.settingsOpen()?374:-1),y(),J(i.gameEngine.highScoresOpen()?375:-1),y(),J(i.isProduction?-1:376)}},dependencies:[Qt,s0,a0,l0,dc,c0,kE,Uu],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}.move-anim[_ngcontent-%COMP%]{transition:transform .15s cubic-bezier(.4,0,.2,1);will-change:transform}"]})};var oO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(ye(Ko),ye(Di))};static \u0275dir=_n({type:n})}return n})(),HW=(()=>{class n extends oO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ea(n)))(r||n)}})();static \u0275dir=_n({type:n,features:[xr]})}return n})(),sO=new _e("");var $W={provide:sO,useExisting:Bo(()=>v0),multi:!0};function GW(){let n=Ai()?Ai().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var zW=new _e(""),v0=(()=>{class n extends oO{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!GW())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(ye(Ko),ye(Di),ye(zW,8))};static \u0275dir=_n({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&re("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Au([$W]),xr]})}return n})();function L1(n){return n==null||V1(n)===0}function V1(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var aO=new _e(""),lO=new _e(""),WW=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Co=class{static min(e){return qW(e)}static max(e){return KW(e)}static required(e){return YW(e)}static requiredTrue(e){return QW(e)}static email(e){return JW(e)}static minLength(e){return ZW(e)}static maxLength(e){return XW(e)}static pattern(e){return eq(e)}static nullValidator(e){return cO()}static compose(e){return gO(e)}static composeAsync(e){return yO(e)}};function qW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function KW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function YW(n){return L1(n.value)?{required:!0}:null}function QW(n){return n.value===!0?null:{required:!0}}function JW(n){return L1(n.value)||WW.test(n.value)?null:{email:!0}}function ZW(n){return e=>{let t=e.value?.length??V1(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function XW(n){return e=>{let t=e.value?.length??V1(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function eq(n){if(!n)return cO;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(L1(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function cO(n){return null}function uO(n){return n!=null}function dO(n){return Yo(n)?cn(n):n}function hO(n){let e={};return n.forEach(t=>{e=t!=null?F(F({},e),t):e}),Object.keys(e).length===0?null:e}function fO(n,e){return e.map(t=>t(n))}function tq(n){return!n.validate}function pO(n){return n.map(e=>tq(e)?e:t=>e.validate(t))}function gO(n){if(!n)return null;let e=n.filter(uO);return e.length==0?null:function(t){return hO(fO(t,e))}}function mO(n){return n!=null?gO(pO(n)):null}function yO(n){if(!n)return null;let e=n.filter(uO);return e.length==0?null:function(t){let i=fO(t,e).map(dO);return hy(i).pipe(yt(hO))}}function vO(n){return n!=null?yO(pO(n)):null}function Jk(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function _O(n){return n._rawValidators}function EO(n){return n._rawAsyncValidators}function N1(n){return n?Array.isArray(n)?n:[n]:[]}function h0(n,e){return Array.isArray(n)?n.includes(e):n===e}function Zk(n,e){let t=N1(e);return N1(n).forEach(r=>{h0(t,r)||t.push(r)}),t}function Xk(n,e){return N1(e).filter(t=>!h0(n,t))}var f0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=mO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=vO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},pc=class extends f0{name;get formDirective(){return null}get path(){return null}},eh=class extends f0{_parent=null;name=null;valueAccessor=null},p0=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var bO=(()=>{class n extends p0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(ye(eh,2))};static \u0275dir=_n({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Fe("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[xr]})}return n})(),wO=(()=>{class n extends p0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(ye(pc,10))};static \u0275dir=_n({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Fe("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[xr]})}return n})();var Qd="VALID",d0="INVALID",hc="PENDING",Jd="DISABLED",_s=class{},g0=class extends _s{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Zd=class extends _s{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Xd=class extends _s{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},fc=class extends _s{status;source;constructor(e,t){super(),this.status=e,this.source=t}},k1=class extends _s{source;constructor(e){super(),this.source=e}},th=class extends _s{source;constructor(e){super(),this.source=e}};function U1(n){return(_0(n)?n.validators:n)||null}function nq(n){return Array.isArray(n)?mO(n):n||null}function B1(n,e){return(_0(e)?e.asyncValidators:n)||null}function iq(n){return Array.isArray(n)?vO(n):n||null}function _0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function xO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new he(1e3,"");if(!i[t])throw new he(1001,"")}function SO(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new he(1002,"")})}var gc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return dn(this.statusReactive)}set status(e){dn(()=>this.statusReactive.set(e))}_status=Xn(()=>this.statusReactive());statusReactive=$(void 0);get valid(){return this.status===Qd}get invalid(){return this.status===d0}get pending(){return this.status==hc}get disabled(){return this.status===Jd}get enabled(){return this.status!==Jd}errors;get pristine(){return dn(this.pristineReactive)}set pristine(e){dn(()=>this.pristineReactive.set(e))}_pristine=Xn(()=>this.pristineReactive());pristineReactive=$(!0);get dirty(){return!this.pristine}get touched(){return dn(this.touchedReactive)}set touched(e){dn(()=>this.touchedReactive.set(e))}_touched=Xn(()=>this.touchedReactive());touchedReactive=$(!1);get untouched(){return!this.touched}_events=new zt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Zk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Zk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Xk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Xk(e,this._rawAsyncValidators))}hasValidator(e){return h0(this._rawValidators,e)}hasAsyncValidator(e){return h0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(pe(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Xd(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Xd(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(pe(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Zd(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new Zd(!0,i))}markAsPending(e={}){this.status=hc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new fc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(pe(F({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Jd,this.errors=null,this._forEachChild(r=>{r.disable(pe(F({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new g0(this.value,i)),this._events.next(new fc(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(pe(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Qd,this._forEachChild(i=>{i.enable(pe(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(pe(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Qd||this.status===hc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new g0(this.value,t)),this._events.next(new fc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(pe(F({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jd:Qd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=hc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=dO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new fc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new un,this.statusChanges=new un}_calculateStatus(){return this._allControlsDisabled()?Jd:this.errors?d0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(hc)?hc:this._anyControlsHaveStatus(d0)?d0:Qd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new Zd(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Xd(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){_0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=nq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=iq(this._rawAsyncValidators)}},mc=class extends gc{constructor(e,t,i){super(U1(t),B1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){SO(this,!0,e),Object.keys(e).forEach(i=>{xO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,pe(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new th(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var O1=class extends mc{};var IO=new _e("",{factory:()=>j1}),j1="always";function rq(n,e){return[...e.path,n]}function eO(n,e,t=j1){H1(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),sq(n,e),lq(n,e),aq(n,e),oq(n,e)}function tO(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),y0(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function m0(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function oq(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function H1(n,e){let t=_O(n);e.validator!==null?n.setValidators(Jk(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=EO(n);e.asyncValidator!==null?n.setAsyncValidators(Jk(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();m0(e._rawValidators,r),m0(e._rawAsyncValidators,r)}function y0(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=_O(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=EO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return m0(e._rawValidators,i),m0(e._rawAsyncValidators,i),t}function sq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&TO(n,e)})}function aq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&TO(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function TO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function lq(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function cq(n,e){n==null,H1(n,e)}function uq(n,e){return y0(n,e)}function dq(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function hq(n){return Object.getPrototypeOf(n.constructor)===HW}function fq(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function pq(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===v0?t=o:hq(o)?i=o:r=o}),r||i||t||null}function gq(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function nO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function iO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var ka=class extends gc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(U1(t),B1(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),_0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(iO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new th(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){nO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){nO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){iO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var mq=n=>n instanceof ka;var CO=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=_n({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var F1=class extends gc{constructor(e,t,i){super(U1(t),B1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){SO(this,!1,e),e.forEach((i,r)=>{xO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],pe(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new th(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var yq=(()=>{class n extends pc{callSetDisabledState;get submitted(){return dn(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=Xn(()=>this._submittedReactive());_submittedReactive=$(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(y0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let i=this.form.get(t.path);return eO(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){tO(t.control||null,t,!1),gq(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,i){this.form.get(t.path).setValue(i)}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,fq(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new k1(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(tO(i||null,t),mq(r)&&(eO(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);cq(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&uq(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){H1(this.form,this),this._oldForm&&y0(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(i){return new(i||n)(ye(aO,10),ye(lO,10),ye(IO,8))};static \u0275dir=_n({type:n,features:[xr,eo]})}return n})();var DO=new _e("");var vq={provide:eh,useExisting:Bo(()=>$1)},$1=(()=>{class n extends eh{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new un;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=pq(this,o)}ngOnChanges(t){this._added||this._setUpControl(),dq(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return rq(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(ye(pc,13),ye(aO,10),ye(lO,10),ye(sO,10),ye(DO,8))};static \u0275dir=_n({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Au([vq]),xr,eo]})}return n})();var _q={provide:pc,useExisting:Bo(()=>G1)},G1=(()=>{class n extends yq{form=null;ngSubmit=new un;get control(){return this.form}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ea(n)))(r||n)}})();static \u0275dir=_n({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&re("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Au([_q]),xr]})}return n})();var Eq=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=no({type:n});static \u0275inj=fr({})}return n})();function rO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var AO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return rO(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new mc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new O1(r,i)}control(t,i,r){let o={};return this.useNonNullable?(rO(i)?o=i:(o.validators=i,o.asyncValidators=r),new ka(t,pe(F({},o),{nonNullable:!0}))):new ka(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new F1(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof ka)return t;if(t instanceof gc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var MO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:DO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:IO,useValue:t.callSetDisabledState??j1}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=no({type:n});static \u0275inj=fr({imports:[Eq]})}return n})();var E0=class n{db;auth;constructor(){let e=hd(r0);this.db=Vd(e),this.auth=Yd(e)}async addFeedback(e){let t=pe(F({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:Zx()});await Lm(rr(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=gs(rr(this.db,"feedbacks"),xo("timestamp","desc"),Aa(e));return(await Ma(t)).docs.map(r=>r.data())}async getFeedbackPage(e,t){let i=[xo("timestamp","desc"),Aa(e)],r=t?gs(rr(this.db,"feedbacks"),xo("timestamp","desc"),tk(t),Aa(e)):gs(rr(this.db,"feedbacks"),xo("timestamp","desc"),Aa(e)),o=await Ma(r),s=o.docs.map(l=>l.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),i=gs(rr(this.db,"feedbacks"),ms("userId","==",e),ms("timestamp",">=",t)),o=(await Ma(i)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var z1=()=>[1,2,3,4,5],RO=(n,e)=>e.timestamp;function xq(n,e){if(n&1){let t=Ze();E(0,"button",39),re("click",function(){let r=le(t).$implicit,o=O(2);return ce(o.setRating(r))}),_(1," \u2605 "),b()}if(n&2){let t=e.$implicit,i=O(2);Fe("active",i.form.value.rating>=t)}}function Sq(n,e){if(n&1&&(E(0,"div",36),_(1),b()),n&2){let t=O(2);y(),W(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function Iq(n,e){n&1&&(E(0,"div",37),_(1),b()),n&2&&(y(),W(e))}function Tq(n,e){if(n&1){let t=Ze();E(0,"div",25)(1,"div",26),G(2,"img",27),b(),E(3,"div",28)(4,"div",29),_(5),b(),E(6,"div",30),_(7),b()()(),E(8,"form",31),re("ngSubmit",function(){le(t);let r=O();return ce(r.submit())}),E(9,"div")(10,"div",32),_(11),b(),E(12,"div",33),Kt(13,xq,2,2,"button",34,Ir),b()(),E(15,"div")(16,"div",32),_(17),b(),G(18,"textarea",35),Q(19,Sq,2,1,"div",36),Q(20,Iq,2,1,"div",37),b(),E(21,"button",38),_(22),b()()}if(n&2){let t,i=e,r=O();y(2),Ue("src",i.photoURL,Ki),y(3),W(i.displayName),y(2),W(r.settings.t("OPERATOR_ONLINE")),y(),Ue("formGroup",r.form),y(3),W(r.settings.t("EFFICIENCY_RATING")),y(2),Yt(ia(16,z1)),y(4),W(r.settings.t("TACTICAL_NOTE")),y(),Ue("placeholder",oE(r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),y(),J(r.form.controls.text.errors?19:-1),y(),J((t=r.message())?20:-1,t),y(),Fe("cursor-pointer",r.canSubmit)("cursor-not-allowed",!r.canSubmit),Ue("disabled",!r.canSubmit),y(),K(" ",r.settings.t("TRANSMIT_REPORT")," ")}}function Cq(n,e){if(n&1&&(E(0,"div",21),_(1),b()),n&2){let t=O();y(),W(t.settings.t("SYSTEM_LOG"))}}function Dq(n,e){if(n&1&&(E(0,"div",22),_(1),b()),n&2){let t=O();y(),W(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function Aq(n,e){if(n&1&&(E(0,"span"),_(1,"\u2605"),b()),n&2){let t=e.$implicit,i=O().$implicit;Fe("active",i.rating>=t)}}function Mq(n,e){if(n&1&&(E(0,"tr",44)(1,"td",47),G(2,"img",48),E(3,"span"),_(4),b()(),E(5,"td",49)(6,"div",50),Kt(7,Aq,2,2,"span",51,Ir),b()(),E(9,"td",49)(10,"span",52),_(11),b()(),E(12,"td",49)(13,"span",53),_(14),b()()()),n&2){let t=e.$implicit,i=O(2);y(2),Ue("src",t.userPhoto,Ki),y(2),W(t.userName),y(3),Yt(ia(4,z1)),y(4),W(t.text),y(3),W(i.formatDate(t.timestamp))}}function Rq(n,e){if(n&1&&(E(0,"tr")(1,"td",54),_(2),b()()),n&2){let t=O(2);y(2),W(t.settings.t("NO_SIGNALS"))}}function Pq(n,e){if(n&1){let t=Ze();E(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),_(5),b(),E(6,"th",43),_(7),b(),E(8,"th",43),_(9),b(),E(10,"th",43),_(11),b()()(),E(12,"tbody"),Kt(13,Mq,15,5,"tr",44,RO,!1,Rq,3,1,"tr"),b()()(),E(16,"div",45)(17,"button",46),re("click",function(){le(t);let r=O();return ce(r.prevPage())}),_(18),b(),E(19,"button",46),re("click",function(){le(t);let r=O();return ce(r.nextPage())}),_(20),b()()}if(n&2){let t=O();y(5),W(t.settings.t("TABLE_OPERATOR")),y(2),W(t.settings.t("TABLE_RATING")),y(2),W(t.settings.t("TABLE_MESSAGE")),y(2),W(t.settings.t("TABLE_DATE")),y(2),Yt(t.pageItems()),y(5),K(" ",t.settings.t("PREVIOUS")," "),y(2),K(" ",t.settings.t("NEXT")," ")}}function Nq(n,e){if(n&1&&(E(0,"span"),_(1,"\u2605"),b()),n&2){let t=e.$implicit,i=O().$implicit;Fe("active",i.rating>=t)}}function kq(n,e){if(n&1&&(E(0,"div",55)(1,"div",56)(2,"div",57),G(3,"img",58),E(4,"div",59),_(5),b()(),E(6,"div",50),Kt(7,Nq,2,2,"span",51,Ir),b()(),E(9,"div",60),_(10),b()()),n&2){let t=e.$implicit;y(3),Ue("src",t.userPhoto,Ki),y(2),W(t.userName),y(2),Yt(ia(3,z1)),y(3),W(t.text)}}function Oq(n,e){if(n&1&&Kt(0,kq,11,4,"div",55,RO),n&2){let t=O();Yt(t.recent())}}var b0=class n{constructor(e,t,i,r,o){this.fb=e;this.router=t;this.feedback=i;this.firebase=r;this.settings=o;this.form=new mc({text:new ka("",{nonNullable:!0,validators:[Co.required,Co.minLength(10),Co.maxLength(500)]}),rating:new ka(5,{nonNullable:!0,validators:[Co.required,Co.min(1),Co.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,l=Number(localStorage.getItem(a)||0);this.disabledUntil.set(l)}this.loadPage(0)}recent=$([]);pageItems=$([]);pageStack=[null];pageIndex=$(0);lastDoc=null;disabledUntil=$(0);message=$(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);if(this.pageItems.set(r.items),this.lastDoc=r.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);this.pageItems.set(r.items),this.lastDoc=r.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:i}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let r=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:r.text||"",rating:Number(r.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(ye(AO),ye(yi),ye(E0),ye(Br),ye(Ut))};static \u0275cmp=kt({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,i){if(t&1&&(E(0,"div",0)(1,"div",1),G(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),b(),X(),E(7,"svg",7)(8,"defs")(9,"clipPath",8),G(10,"path",9),b()()(),Re(),E(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),_(15),b(),E(16,"span",14),_(17),b()(),E(18,"a",15),_(19),b()(),E(20,"div",16)(21,"div",17)(22,"div",18),_(23),b(),Q(24,Tq,23,17),b(),E(25,"div",19)(26,"div",20),Q(27,Cq,2,1,"div",21),Q(28,Dq,2,1,"div",22),E(29,"button",23),re("click",function(){return i.isAllShow=!i.isAllShow}),_(30),b()(),E(31,"div",24),Q(32,Pq,21,7),Q(33,Oq,2,0),b()()()()()),t&2){let r;y(15),W(i.settings.t("FEEDBACK_MODULE")),y(2),W(i.settings.t("COMMUNITY_SIGNALS")),y(2),W(i.settings.t("RETURN_TO_MAP")),y(4),W(i.settings.t("DEPLOY_REPORT")),y(),J((r=i.firebase.user$())?24:-1,r),y(3),J(i.isAllShow?-1:27),y(),J(i.isAllShow?28:-1),y(2),K(" ",i.isAllShow?i.settings.t("TOGGLE_BACK"):i.settings.t("VIEW_FULL_ARCHIVE")," "),y(2),J(i.isAllShow?32:-1),y(),J(i.isAllShow?-1:33)}},dependencies:[Qt,MO,CO,v0,bO,wO,G1,$1,Al],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var w0=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(ye(Ut))};static \u0275cmp=kt({type:n,selectors:[["app-roadmap"]],decls:93,vars:13,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"absolute","top-0","right-0","w-16","h-16","bg-emerald-500/10","blur-2xl","-mr-8","-mt-8"],[1,"card-header","relative","z-10"],[1,"text-[11px]","font-mono","text-emerald-200/50","italic"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","uppercase","tracking-wider","bg-emerald-500/20","text-emerald-400","border","border-emerald-500/40"],[1,"flex","items-start","gap-4","mt-4","relative","z-10"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/60","rotate-45","flex","items-center","justify-center","group-hover:rotate-180","transition-all","duration-700","shadow-[0_0_15px_rgba(16,185,129,0.2)]"],[1,"-rotate-45","group-hover:-rotate-180","transition-all","duration-700","text-xl"],[1,"text-lg","font-bold","text-emerald-50","leading-tight","mb-2","opacity-80","decoration-emerald-500/30","line-through","decoration-2"],[1,"text-sm","text-emerald-100/40","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-emerald-500/10","flex","justify-between","items-center","relative","z-10"],[1,"text-[9px]","uppercase","tracking-widest","text-emerald-500/40","font-bold"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-emerald-500","shadow-[0_0_5px_#10b981]"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,i){t&1&&(E(0,"div",0)(1,"div",1),G(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),b(),X(),E(7,"svg",7)(8,"defs")(9,"clipPath",8),G(10,"path",9),b()()(),Re(),G(11,"div",10)(12,"div",11),E(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),G(17,"div",16),E(18,"h1",17),_(19),b()(),E(20,"p",18),_(21,"Future_Ops // Deployment_Schedule"),b()(),E(22,"a",19)(23,"span",20),_(24,"\xAB"),b(),_(25),b()(),E(26,"div",21)(27,"div",22),G(28,"div",23),E(29,"div",24)(30,"span",25),_(31,"REF: PROJECT_VOLUMETRIC"),b(),E(32,"span",26),_(33),b()(),E(34,"div",27)(35,"div",28)(36,"div",29),_(37),b()(),E(38,"div")(39,"h3",30),_(40),b(),E(41,"p",31),_(42),b()()(),E(43,"div",32)(44,"span",33),_(45,"System_Verified"),b(),E(46,"div",34),G(47,"div",35)(48,"div",35)(49,"div",35),b()()(),E(50,"div",22)(51,"div",36)(52,"span",37),_(53,"REF: RESOURCE_IRON"),b(),E(54,"span",26),_(55),b()(),E(56,"div",38)(57,"div",39)(58,"span"),_(59,"\u26D3\uFE0F"),b()(),E(60,"div")(61,"h3",40),_(62),b(),E(63,"p",41),_(64),b()()(),E(65,"div",42)(66,"span",43),_(67,"Priority_Beta"),b(),E(68,"div",34),G(69,"div",44)(70,"div",45)(71,"div",45),b()()(),E(72,"div",46)(73,"div",36)(74,"span",37),_(75,"REF: INFRA_SMITHY"),b(),E(76,"span",26),_(77),b()(),E(78,"div",47)(79,"div",48),G(80,"div",49),E(81,"span",50),_(82,"\u2692\uFE0F"),b()(),E(83,"div")(84,"h3",51),_(85),b(),E(86,"p",52),_(87),b()()()()(),E(88,"div",53)(89,"div",54),_(90,"Community_Intel"),b(),E(91,"p",55),_(92),b()()()()),t&2&&(y(19),K(" ",i.settings.t("STRATEGIC_PLAN")," "),y(6),K(" ",i.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),y(8),K(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(4),K(" ",i.settings.currentLang()==="uk"?"\u2714\uFE0F":"\u2705"," "),y(3),K(" ",i.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"," "),y(2),K(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),y(13),K(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(7),W(i.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),y(2),K(" ",i.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),y(13),K(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(8),W(i.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),y(2),K(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),y(5),K(" ",i.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[Qt,Al],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var x0=class n{constructor(e,t){this.router=e;this.settings=t}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||n)(ye(yi),ye(Ut))};static \u0275cmp=kt({type:n,selectors:[["app-landing-page"]],decls:41,vars:7,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden","relative"],[1,"absolute","top-1/4","-left-1/4","w-96","h-96","bg-emerald-500/20","rounded-full","blur-3xl","animate-pulse"],[1,"absolute","bottom-1/4","-right-1/4","w-96","h-96","bg-purple-500/20","rounded-full","blur-3xl","animate-pulse",2,"animation-delay","1ms"],[1,"z-10","text-center","mb-12"],[1,"text-6xl","font-black","tracking-tighter","mb-4","bg-gradient-to-r","from-emerald-400","to-cyan-400","bg-clip-text","text-transparent","drop-shadow-sm"],[1,"text-slate-400","text-lg","max-w-md","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","w-full","max-w-5xl","z-10"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-emerald-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-emerald-400","hover:shadow-[0_0_40px_-10px_rgba(52,211,153,0.3)]","text-left",3,"click"],[1,"absolute","top-0","right-0","p-4","opacity-10","group-hover:opacity-20","transition-opacity"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24"],["d","M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.8L19.5 8 12 11.2 4.5 8 12 4.8zM4 15.5v-5.2l7 3.1v5.2l-7-3.1zm9 3.1v-5.2l7-3.1v5.2l-7 3.1z"],[1,"relative","z-20"],[1,"inline-block","px-3","py-1","bg-emerald-500/10","text-emerald-400","text-xs","font-bold","rounded-full","mb-4","border","border-emerald-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-emerald-50"],[1,"text-slate-400","leading-relaxed","mb-6"],[1,"flex","items-center","text-emerald-400","font-bold","group-hover:translate-x-2","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-purple-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-purple-400","hover:shadow-[0_0_40px_-10px_rgba(168,85,247,0.3)]","text-left",3,"click"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"inline-block","px-3","py-1","bg-purple-500/10","text-purple-400","text-xs","font-bold","rounded-full","mb-4","border","border-purple-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-purple-50"],[1,"flex","items-center","text-purple-400","font-bold","group-hover:translate-x-2","transition-transform"],[1,"absolute","bottom-6","text-slate-500","text-sm","font-medium","uppercase","tracking-widest"]],template:function(t,i){t&1&&(C(0,"div",0),j(1,"div",1)(2,"div",2),C(3,"div",3)(4,"h1",4),_(5),A(),C(6,"p",5),_(7),A()(),C(8,"div",6)(9,"button",7),Vt("click",function(){return i.navigateTo("shape-tactics")}),C(10,"div",8),X(),C(11,"svg",9),j(12,"path",10),A()(),Re(),C(13,"div",11)(14,"span",12),_(15),A(),C(16,"h2",13),_(17,"Shape Tactics"),A(),C(18,"p",14),_(19),A(),C(20,"div",15),_(21," ENTER PORTAL "),X(),C(22,"svg",16),j(23,"path",17),A()()()(),Re(),C(24,"button",18),Vt("click",function(){return i.navigateTo("tower-defense")}),C(25,"div",8),X(),C(26,"svg",9),j(27,"path",19),A()(),Re(),C(28,"div",11)(29,"span",20),_(30),A(),C(31,"h2",21),_(32,"Shape Defense"),A(),C(33,"p",14),_(34),A(),C(35,"div",22),_(36," DEFEND BASE "),X(),C(37,"svg",16),j(38,"path",17),A()()()()(),Re(),C(39,"footer",23),_(40),A()()),t&2&&(y(5),K(" ",i.settings.currentLang()==="uk"?"\u0406\u0413\u0420\u041E\u0412\u0418\u0419 \u0426\u0415\u041D\u0422\u0420":"GAMING HUB"," "),y(2),K(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043E\u0440\u0442\u0430\u043B, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0441\u0432\u043E\u044E \u043F\u043E\u0434\u043E\u0440\u043E\u0436.":"Select a portal to begin your journey."," "),y(8),K(" ","Live Now"," "),y(4),K(" ",i.settings.t("SHAPE_TACTIC_DESCRIPTION")," "),y(11),K(" ",i.settings.currentLang()==="uk"?"\u0413\u0420\u0410\u0422\u0418 \u0417\u0410\u0420\u0410\u0417":"PLAY NOW"," "),y(4),K(" ",i.settings.t("TOWER_DEFFENCE_DESCRIPTION")," "),y(6),K(" \xA9 2026 Shape Tactics Labs // ",i.settings.version," "))},dependencies:[Qt],styles:["[_nghost-%COMP%]{display:block}"]})};var S0=class n{constructor(e){this.ngZone=e;this.initGame()}money=$(100);lives=$(20);wave=$(0);isWaveInProgress=$(!1);gameOver=$(!1);gridSize=10;grid=$([]);path=$([]);enemies=$([]);projectiles=$([]);enemiesInternal=[];projectilesInternal=[];animationFrameId=null;lastUpdateTime=0;enemiesToSpawn=0;currentWaveEnemyCount=0;spawnTimer=0;spawnInterval=1e3;towerCosts=[15,50,250,1500];tierStats=[{damage:5,range:2,fireInterval:500},{damage:20,range:3,fireInterval:1e3},{damage:80,range:4,fireInterval:2e3},{damage:300,range:5,fireInterval:3e3}];stopGameLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}dispose(){this.stopGameLoop(),this.enemiesInternal=[],this.projectilesInternal=[],this.enemiesToSpawn=0,this.currentWaveEnemyCount=0,this.spawnTimer=0,this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!1),this.money.set(100),this.lives.set(100),this.wave.set(0);let e=this.grid();if(e&&e.length){let t=e.map(i=>i.map(r=>r.tower?pe(F({},r),{tower:null}):r));this.grid.set(t)}}initGame(){this.dispose(),this.generateMap()}resetGame(){this.initGame()}generateMap(){let e=this.generateRandomPath();this.path.set(e);let t=[],i=new Set(e.map(r=>`${r.x},${r.y}`));for(let r=0;r<this.gridSize;r++){let o=[];for(let s=0;s<this.gridSize;s++){let a="void";i.has(`${s},${r}`)?a="path":[{x:s-1,y:r},{x:s+1,y:r},{x:s,y:r-1},{x:s,y:r+1}].some(u=>i.has(`${u.x},${u.y}`))&&(a="buildable"),o.push({x:s,y:r,type:a,tower:null})}t.push(o)}this.grid.set(t)}generateRandomPath(){let e=[{x:0,y:0}],t={x:0,y:0},i={x:9,y:9};for(;t.x!==i.x||t.y!==i.y;){let r=[];t.x<i.x&&r.push({x:t.x+1,y:t.y}),t.y<i.y&&r.push({x:t.x,y:t.y+1});let o;if(r.length>1){let s=e.length>1?e[e.length-2]:null,a=s?t.x-s.x:1,l=s?t.y-s.y:0,u=r.find(d=>d.x-t.x===a&&d.y-t.y===l);u&&Math.random()<.8?o=u:o=r[Math.floor(Math.random()*r.length)]}else o=r[0];e.push(o),t=o}return e}startWave(){if(this.isWaveInProgress()||this.gameOver())return;this.wave.update(t=>t+1),this.isWaveInProgress.set(!0);let e=5+this.wave()*2;this.enemiesToSpawn=e,this.currentWaveEnemyCount=e,this.spawnTimer=0,this.startGameLoop()}startGameLoop(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.stopGameLoop(),this.lastUpdateTime=performance.now(),this.ngZone.runOutsideAngular(()=>{let e=t=>{let i=(t-this.lastUpdateTime)/1e3;this.lastUpdateTime=t,this.updateGame(i),this.ngZone.run(()=>{this.enemies.set([...this.enemiesInternal]),this.projectiles.set([...this.projectilesInternal])}),this.isWaveInProgress()||this.enemiesInternal.length>0?this.animationFrameId=requestAnimationFrame(e):(this.ngZone.run(()=>this.isWaveInProgress.set(!1)),this.animationFrameId=null)};this.animationFrameId=requestAnimationFrame(e)})}updateGame(e){if(this.handleSpawning(e),this.updateEnemies(e),this.updateTowers(e),this.updateProjectiles(e),this.lives()<=0&&!this.gameOver()){this.enemiesInternal=[],this.projectilesInternal=[],this.enemiesToSpawn=0,this.stopGameLoop(),this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!0)});return}this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&this.isWaveInProgress()&&this.ngZone.run(()=>this.isWaveInProgress.set(!1))}handleSpawning(e){this.enemiesToSpawn<=0||(this.spawnTimer+=e*1e3,this.spawnTimer>=this.spawnInterval&&(this.spawnTimer=0,this.spawnEnemy(),this.enemiesToSpawn--))}spawnEnemy(){let e=50*Math.pow(1.2,this.wave()),t=.5+this.wave()*.05,i=this.currentWaveEnemyCount||5+this.wave()*2,r=i-this.enemiesToSpawn,o=this.wave()%5===0,s=r===i-1,a=o&&s,l=this.wave()*40%360,u=a?e*3:e,d=a?t*.5:t,h={id:crypto.randomUUID(),position:F({},this.path()[0]),pathIndex:0,hp:u,maxHp:u,speed:d,progress:0,isBoss:a,hue:l};this.enemiesInternal.push(h)}updateEnemies(e){for(let t=this.enemiesInternal.length-1;t>=0;t--){let i=this.enemiesInternal[t];if(i.progress+=i.speed*e,i.progress>=1){if(i.pathIndex++,i.progress=0,i.pathIndex>=this.path().length-1){this.enemiesInternal.splice(t,1),this.ngZone.run(()=>this.lives.update(r=>Math.max(0,r-1)));continue}i.position=F({},this.path()[i.pathIndex])}i.hp<=0&&(this.enemiesInternal.splice(t,1),this.ngZone.run(()=>this.money.update(r=>r+5+this.wave())))}}updateTowers(e){let t=Date.now();if(this.enemiesInternal.length===0)return;let i=this.grid();for(let r of i)for(let o of r)if(o.tower){let s=o.tower;if(t-s.lastFired>s.fireInterval){let a=this.findNearestEnemy(s,this.enemiesInternal);a&&(this.fireAt(s,a),s.lastFired=t)}}}findNearestEnemy(e,t){let i=null,r=e.range;for(let o of t){let s=e.position.x-(o.position.x+(this.path()[o.pathIndex+1]?.x-o.position.x)*o.progress),a=e.position.y-(o.position.y+(this.path()[o.pathIndex+1]?.y-o.position.y)*o.progress),l=Math.sqrt(s*s+a*a);l<r&&(r=l,i=o)}return i}fireAt(e,t){let i={id:crypto.randomUUID(),from:F({},e.position),to:F({},t.position),progress:0};this.projectilesInternal.push(i),t.hp-=e.damage}updateProjectiles(e){for(let t=this.projectilesInternal.length-1;t>=0;t--){let i=this.projectilesInternal[t];i.progress+=5*e,i.progress>=1&&this.projectilesInternal.splice(t,1)}}buyTower(e,t,i){let r=this.towerCosts[i-1];this.money()<r||this.grid.update(o=>{let s=o[t][e];if(s.type==="buildable"&&!s.tower){let a=this.tierStats[i-1];s.tower={id:crypto.randomUUID(),type:i,level:1,position:{x:e,y:t},baseCost:r,invested:r,damage:a.damage,range:a.range,fireInterval:a.fireInterval,lastFired:0},this.money.update(l=>l-r)}return[...o]})}upgradeTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level<4){let o=this.getUpgradeCost(r.tower);this.money()>=o&&(r.tower.level++,r.tower.damage=Math.floor(r.tower.damage*1.3),r.tower.range+=.5,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i]})}getUpgradeCost(e){let t=.5;switch(e.level){case 1:t=.5;break;case 2:t=.6;break;case 3:t=.7;break}return Math.floor(e.baseCost*t)}sellTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower){let o=r.tower.invested??r.tower.baseCost,s=Math.floor(o*.5);r.tower=null,this.money.update(a=>a+s)}return[...i]})}static \u0275fac=function(t){return new(t||n)(Me(vn))};static \u0275prov=ae({token:n,factory:n.\u0275fac,providedIn:"root"})};var PO=(n,e)=>e.id;function Lq(n,e){if(n&1&&G(0,"app-units",41),n&2){let t=O().$implicit,i=O(2);Ue("unit",i.asUnit(t.tower))}}function Vq(n,e){if(n&1){let t=Ze();E(0,"div",40),re("click",function(){let r=le(t).$implicit,o=O(2);return ce(o.onTileClick(r))}),Q(1,Lq,1,1,"app-units",41),b()}if(n&2){let t=e.$implicit,i=O(2);Fe("tile-path",t.type==="path")("tile-buildable",t.type==="buildable")("tile-void",t.type==="void")("ring-2",i.selectedTile()===t)("ring-white",i.selectedTile()===t),y(),J(t.tower?1:-1)}}function Uq(n,e){if(n&1&&Kt(0,Vq,2,11,"div",39,na),n&2){let t=e.$implicit;Yt(t)}}function Bq(n,e){if(n&1&&(E(0,"div",33)(1,"div",42),G(2,"div",43),b()()),n&2){let t=e.$implicit,i=O();Ue("ngStyle",i.getEnemyStyle(t)),y(2),et("width",t.hp/t.maxHp*100,"%")}}function jq(n,e){if(n&1&&G(0,"div",34),n&2){let t=e.$implicit,i=O();Ue("ngStyle",i.getProjectileStyle(t))}}function Hq(n,e){if(n&1){let t=Ze();pl(0),E(1,"button",47),re("click",function(){le(t);let r=Tr(0),o=O(3);return ce(o.buyTower(r))}),E(2,"div",48)(3,"span",49),_(4),b(),E(5,"span"),_(6),b()(),E(7,"span",50),_(8),b()()}if(n&2){let t=e.$implicit,i=e.$index,r=O(3),o=Du(i+1);y(),Fe("bg-slate-700",r.tdEngine.money()>=t)("hover:bg-slate-600",r.tdEngine.money()>=t)("bg-slate-900",r.tdEngine.money()<t),Ue("disabled",r.tdEngine.money()<t),y(3),K("T",o),y(2),rn("",r.settings.t("TIER")," ",o),y(2),K("$",t)}}function $q(n,e){if(n&1&&(E(0,"h3",44),_(1),b(),E(2,"div",45),Kt(3,Hq,9,12,"button",46,na),b()),n&2){let t=O(2);y(),W(t.settings.t("BUY_DEFENDER")),y(2),Yt(t.tdEngine.towerCosts)}}function Gq(n,e){if(n&1){let t=Ze();E(0,"button",63),re("click",function(){le(t);let r=O(3);return ce(r.upgradeTower())}),E(1,"span"),_(2),b(),E(3,"span",64),_(4),b()()}if(n&2){let t=O(2),i=O();Ue("disabled",i.tdEngine.money()<i.tdEngine.getUpgradeCost(t.tower)),y(2),W(i.settings.t("UPGRADE")),y(2),K("$",i.tdEngine.getUpgradeCost(t.tower))}}function zq(n,e){if(n&1&&(E(0,"div",61),_(1),b()),n&2){let t=O(3);y(),K(" ",t.settings.t("MAX_LEVEL")," ")}}function Wq(n,e){if(n&1){let t=Ze();E(0,"h3",51),_(1),b(),E(2,"div",52)(3,"div",53)(4,"span",54),_(5),b(),E(6,"span",55),_(7),b()(),E(8,"div",53)(9,"span",54),_(10),b(),E(11,"span",55),_(12),b()(),E(13,"div",53)(14,"span",54),_(15),b(),E(16,"span",56),_(17),b()(),E(18,"div",57)(19,"span",54),_(20),b(),E(21,"span",58),_(22),b()()(),E(23,"div",59),Q(24,Gq,5,3,"button",60)(25,zq,2,1,"div",61),E(26,"button",62),re("click",function(){le(t);let r=O(2);return ce(r.sellTower())}),_(27),b()()}if(n&2){let t=O(),i=O();y(),W(i.settings.t("DEFENDER_INFO")),y(4),W(i.settings.t("TIER")),y(2),W(t.tower.type),y(3),W(i.settings.t("LEVEL")),y(2),K("",t.tower.level," / 4"),y(3),W(i.settings.t("DAMAGE")),y(2),W(t.tower.damage),y(3),W(i.settings.t("RANGE")),y(2),W(t.tower.range),y(2),J(t.tower.level<4?24:25),y(3),K(" ",i.settings.t("SELL")," (50% REFUND) ")}}function qq(n,e){n&1&&Q(0,$q,5,1)(1,Wq,28,11),n&2&&J(e.tower?1:0)}function Kq(n,e){if(n&1&&(E(0,"div",37),X(),E(1,"svg",65),G(2,"path",66),b(),Re(),E(3,"p",67),_(4),G(5,"br"),_(6),b()()),n&2){let t=O();y(4),K(" ",t.settings.t("SELECT_BUILD_TILE")," "),y(2),K(" ",t.settings.t("TO_PLACE_DEFENDER")," ")}}function Yq(n,e){if(n&1){let t=Ze();E(0,"div",38)(1,"div",68)(2,"h2",69),_(3),b(),E(4,"p",70),_(5),b(),E(6,"button",71),re("click",function(){le(t);let r=O();return ce(r.onRestart())}),_(7),b()()()}if(n&2){let t=O();y(3),W(t.settings.t("GAME_OVER")),y(2),Jo("",t.settings.t("YOU_SURVIVED")," ",t.tdEngine.wave()," ",t.settings.t("WAVES")),y(2),K(" ",t.settings.t("TRY_AGAIN")," ")}}var I0=class n{constructor(e,t,i){this.tdEngine=e;this.settings=t;this.router=i}selectedTile=$(null);onKeyDown(e){if(this.tdEngine.isWaveInProgress())return;if(e.key==="Enter"){e.preventDefault(),this.tdEngine.startWave();return}}onKeyUp(e){}ngOnInit(){this.tdEngine.initGame()}ngOnDestroy(){this.tdEngine.dispose()}goBack(){this.tdEngine.dispose(),this.router.navigate(["/"])}onRestart(){this.tdEngine.resetGame(),this.selectedTile.set(null)}onTileClick(e){e.type==="buildable"||e.tower?this.selectedTile.set(e):this.selectedTile.set(null)}buyTower(e){let t=this.selectedTile();t&&(this.tdEngine.buyTower(t.x,t.y,e),this.selectedTile.set(null))}upgradeTower(){let e=this.selectedTile();e&&e.tower&&this.tdEngine.upgradeTower(e.x,e.y)}asUnit(e){return pe(F({},e),{owner:"player",points:0,turnsStationary:0,tier:e.type})}getEnemyStyle(e){let t=this.tdEngine.path(),i=t[e.pathIndex],r=t[e.pathIndex+1]||i,o=i.x+(r.x-i.x)*e.progress,s=i.y+(r.y-i.y)*e.progress,a=e.hue??this.tdEngine.wave()*40%360,l=e.isBoss?1.5:1;return{left:`${o*62+10}px`,top:`${s*62+10}px`,transform:`scale(${l})`,background:`hsl(${a}, 70%, 50%)`}}getProjectileStyle(e){let t=e.from.x+(e.to.x-e.from.x)*e.progress,i=e.from.y+(e.to.y-e.from.y)*e.progress;return{left:`${t*62+28}px`,top:`${i*62+28}px`}}getRangeStyle(){let e=this.selectedTile();if(!e||!e.tower)return{display:"none"};let t=e.tower,i=t.range*2*62;return{left:`${t.position.x*62+30}px`,top:`${t.position.y*62+30}px`,width:`${i}px`,height:`${i}px`,display:"block"}}sellTower(){let e=this.selectedTile();e&&e.tower&&(this.tdEngine.sellTower(e.x,e.y),this.selectedTile.set(null))}static \u0275fac=function(t){return new(t||n)(ye(S0),ye(Ut),ye(yi))};static \u0275cmp=kt({type:n,selectors:[["app-tower-defense"]],hostBindings:function(t,i){t&1&&re("keydown",function(o){return i.onKeyDown(o)},ta)("keyup",function(o){return i.onKeyUp(o)},ta)},decls:51,vars:21,consts:[[1,"flex","flex-col","h-full","p-4","overflow-hidden"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],[1,"flex","items-center","justify-between","mb-4","bg-slate-800","p-3","rounded-lg","border","border-slate-700"],[1,"flex","items-center"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors",3,"click"],[1,"flex","items-baseline","gap-6","font-black","tracking-wide"],[1,"text-emerald-400","text-lg","font-mono"],[1,"text-rose-400","text-lg","font-mono"],[1,"text-sky-400","text-lg","font-mono"],[1,"flex","items-center","gap-3"],[1,"bg-rose-600","hover:bg-rose-500","text-white","text-xs","font-bold","px-3","py-2","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-4","py-2","rounded","text-sm","font-black","transition-all",3,"click","disabled"],[1,"flex","gap-4","flex-1","min-h-0"],[1,"flex-1","relative","bg-slate-900","rounded-lg","overflow-hidden","border","border-slate-700","flex","items-center","justify-center","p-4"],[1,"td-grid","relative"],[1,"range-indicator",3,"ngStyle"],[1,"enemy",3,"ngStyle"],[1,"projectile",3,"ngStyle"],[1,"w-64","flex","flex-col","gap-4"],[1,"flex-1","bg-slate-800","rounded-lg","border","border-slate-700","p-4","overflow-y-auto"],[1,"h-full","flex","flex-col","items-center","justify-center","text-center","text-slate-500"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-slate-950/70","backdrop-blur-sm","z-[200]"],[1,"td-tile","unit-svg-wrapper","theme-player",3,"tile-path","tile-buildable","tile-void","ring-2","ring-white"],[1,"td-tile","unit-svg-wrapper","theme-player",3,"click"],[1,"w-full","h-full","p-1",3,"unit"],[1,"absolute","-top-2","left-0","w-full","h-1","bg-slate-800","rounded-full","overflow-hidden",2,"z-index","100"],[1,"h-full","bg-emerald-500"],[1,"text-sm","font-bold","text-slate-400","mb-4","uppercase","tracking-wider"],[1,"flex","flex-col","gap-3"],[1,"shop-btn","flex","justify-between","items-center",3,"disabled","bg-slate-700","hover:bg-slate-600","bg-slate-900"],[1,"shop-btn","flex","justify-between","items-center",3,"click","disabled"],[1,"flex","items-center","gap-2"],[1,"text-xs","bg-slate-600","px-1.5","rounded"],[1,"text-emerald-400","font-mono"],[1,"text-sm","font-bold","text-slate-400","mb-2","uppercase","tracking-wider"],[1,"bg-slate-900","rounded","p-3","mb-4"],[1,"flex","justify-between","mb-1"],[1,"text-xs","text-slate-500"],[1,"text-xs","font-bold"],[1,"text-xs","font-bold","text-rose-400"],[1,"flex","justify-between"],[1,"text-xs","font-bold","text-sky-400"],[1,"flex","flex-col","gap-2"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"disabled"],[1,"w-full","py-3","bg-slate-900","text-slate-500","rounded","text-center","font-bold","border","border-slate-700"],[1,"w-full","py-3","bg-rose-700","hover:bg-rose-600","rounded","font-bold","transition-all","flex","justify-center","items-center","text-sm",3,"click"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"font-mono"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mb-2","opacity-20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"],[1,"text-sm"],[1,"bg-slate-900","border","border-slate-700","rounded-lg","px-8","py-6","text-center","shadow-xl"],[1,"text-2xl","font-black","text-rose-400","mb-2"],[1,"text-slate-300","mb-4"],[1,"bg-emerald-600","hover:bg-emerald-500","text-white","font-bold","px-6","py-2","rounded",3,"click"]],template:function(t,i){if(t&1&&(E(0,"div",0),X(),E(1,"svg",1)(2,"defs")(3,"radialGradient",2),G(4,"stop",3)(5,"stop",4)(6,"stop",5),b(),E(7,"radialGradient",6),G(8,"stop",7)(9,"stop",8)(10,"stop",9),b(),E(11,"radialGradient",10),G(12,"stop",11)(13,"stop",12)(14,"stop",13),b(),E(15,"linearGradient",14),G(16,"stop",15)(17,"stop",16),b(),E(18,"filter",17),G(19,"feDropShadow",18),b()()(),Re(),E(20,"div",19)(21,"div",20)(22,"button",21),re("click",function(){return i.goBack()}),_(23),b()(),E(24,"div",22)(25,"div",23),_(26),b(),E(27,"div",24),_(28),b(),E(29,"div",25),_(30),b()(),E(31,"div",26)(32,"button",27),re("click",function(){return i.onRestart()}),_(33),b(),E(34,"button",28),re("click",function(){return i.tdEngine.startWave()}),_(35),b()()(),E(36,"div",29)(37,"div",30)(38,"div",31),G(39,"div",32),Kt(40,Uq,2,0,null,null,na),Kt(42,Bq,3,3,"div",33,PO),Kt(44,jq,1,1,"div",34,PO),b()(),E(46,"div",35)(47,"div",36),Q(48,qq,2,1)(49,Kq,7,2,"div",37),b()()(),Q(50,Yq,8,5,"div",38),b()),t&2){let r;y(23),K(" ",i.settings.t("EXIT_GAME")," "),y(3),rn("",i.settings.t("MONEY"),": $",i.tdEngine.money()),y(2),rn("",i.settings.t("LIVES"),": ",i.tdEngine.lives()),y(2),rn("",i.settings.t("WAVE"),": ",i.tdEngine.wave()),y(3),K(" ",i.settings.t("RESTART_GAME")," "),y(),Fe("bg-sky-600",!i.tdEngine.isWaveInProgress())("hover:bg-sky-500",!i.tdEngine.isWaveInProgress())("bg-slate-700",i.tdEngine.isWaveInProgress())("text-slate-500",i.tdEngine.isWaveInProgress()),Ue("disabled",i.tdEngine.isWaveInProgress()),y(),K(" ",i.tdEngine.isWaveInProgress()?i.settings.t("WAVE_IN_PROGRESS"):i.settings.t("START_WAVE")," "),y(4),Ue("ngStyle",i.getRangeStyle()),y(),Yt(i.tdEngine.grid()),y(2),Yt(i.tdEngine.enemies()),y(2),Yt(i.tdEngine.projectiles()),y(4),J((r=i.selectedTile())?48:49,r),y(2),J(i.tdEngine.gameOver()?50:-1)}},dependencies:[Qt,NE,dc],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"[_nghost-%COMP%]{display:block;height:100vh;background:#0f172a;color:#fff}.td-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,60px);grid-template-rows:repeat(10,60px);gap:2px;background:#1e293b;border:4px solid #334155;border-radius:8px;position:relative}.td-tile[_ngcontent-%COMP%]{position:relative;width:60px;height:60px;transition:all .2s;overflow:hidden}.tile-path[_ngcontent-%COMP%]{background:#475569}.tile-buildable[_ngcontent-%COMP%]{background:#1e293b;cursor:pointer}.tile-buildable[_ngcontent-%COMP%]:hover{background:#334155}.tile-void[_ngcontent-%COMP%]{opacity:.1}.range-indicator[_ngcontent-%COMP%]{position:absolute;background:#38bdf826;border:2px solid rgba(56,189,248,.5);border-radius:50%;pointer-events:none;z-index:5;transform:translate(-50%,-50%);transition:all .2s ease-out}.enemy[_ngcontent-%COMP%]{position:absolute;width:40px;height:40px;background:#ef4444;border-radius:50%;z-index:10;box-shadow:0 0 10px #ef4444;display:flex;align-items:center;justify-content:center}.projectile[_ngcontent-%COMP%]{position:absolute;width:6px;height:6px;background:#fbbf24;border-radius:50%;z-index:20;box-shadow:0 0 5px #fbbf24}.shop-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.25rem;font-weight:700;transition:all .2s}.shop-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"]})};var NO=[{path:"",component:x0},{path:"shape-tactics",component:u0},{path:"tower-defense",component:I0},{path:"feedback",component:b0},{path:"roadmap",component:w0}];var kO={providers:[xv(),vb(NO),KM(qM())]};var T0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=kt({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,i){t&1&&(E(0,"h1",0),_(1,"Turn-Based Strategy"),b(),G(2,"router-outlet"))},dependencies:[od],encapsulation:2})};GE(T0,kO).catch(n=>console.error(n));
