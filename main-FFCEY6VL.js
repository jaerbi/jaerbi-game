var GO=Object.defineProperty,zO=Object.defineProperties;var WO=Object.getOwnPropertyDescriptors;var ch=Object.getOwnPropertySymbols;var x1=Object.prototype.hasOwnProperty,S1=Object.prototype.propertyIsEnumerable;var w1=(n,e,t)=>e in n?GO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,L=(n,e)=>{for(var t in e||={})x1.call(e,t)&&w1(n,t,e[t]);if(ch)for(var t of ch(e))S1.call(e,t)&&w1(n,t,e[t]);return n},me=(n,e)=>zO(n,WO(e));var Oa=(n,e)=>{var t={};for(var i in n)x1.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&ch)for(var i of ch(n))e.indexOf(i)<0&&S1.call(n,i)&&(t[i]=n[i]);return t};var Pn=null,uh=!1,j0=1,qO=null,Kn=Symbol("SIGNAL");function Le(n){let e=Pn;return Pn=n,e}function hh(){return Pn}var Tc={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Cc(n){if(uh)throw new Error("");if(Pn===null)return;Pn.consumerOnSignalRead(n);let e=Pn.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Pn.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Pn.producers,t!==void 0&&t.producer===n)){Pn.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Pn&&(!i||QO(r,Pn)))return;let o=Fa(Pn),s={producer:n,consumer:Pn,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Pn.producersTail=s,e!==void 0?e.nextProducer=s:Pn.producers=s,o&&D1(n,s)}function I1(){j0++}function H0(n){if(!(Fa(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===j0)){if(!n.producerMustRecompute(n)&&!ph(n)){B0(n);return}n.producerRecomputeValue(n),B0(n)}}function $0(n){if(n.consumers===void 0)return;let e=uh;uh=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||KO(i)}}finally{uh=e}}function G0(){return Pn?.consumerAllowSignalWrites!==!1}function KO(n){n.dirty=!0,$0(n),n.consumerMarkedDirty?.(n)}function B0(n){n.dirty=!1,n.lastCleanEpoch=j0}function Dc(n){return n&&T1(n),Le(n)}function T1(n){n.producersTail=void 0,n.recomputing=!0}function fh(n,e){Le(e),n&&C1(n)}function C1(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Fa(n))do t=z0(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function ph(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(H0(t),i!==t.version))return!0}return!1}function Ac(n){if(Fa(n)){let e=n.producers;for(;e!==void 0;)e=z0(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function D1(n,e){let t=n.consumersTail,i=Fa(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)D1(r.producer,r)}function z0(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Fa(e)){let o=e.producers;for(;o!==void 0;)o=z0(o)}return t}function Fa(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function W0(n){qO?.(n)}function QO(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function q0(n,e){return Object.is(n,e)}function gh(n,e){let t=Object.create(YO);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(H0(t),Cc(t),t.value===dh)throw t.error;return t.value};return i[Kn]=t,W0(t),i}var V0=Symbol("UNSET"),U0=Symbol("COMPUTING"),dh=Symbol("ERRORED"),YO=me(L({},Tc),{value:V0,dirty:!0,error:null,equal:q0,kind:"computed",producerMustRecompute(n){return n.value===V0||n.value===U0},producerRecomputeValue(n){if(n.value===U0)throw new Error("");let e=n.value;n.value=U0;let t=Dc(n),i,r=!1;try{i=n.computation(),Le(null),r=e!==V0&&e!==dh&&i!==dh&&n.equal(e,i)}catch(o){i=dh,n.error=o}finally{fh(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function JO(){throw new Error}var A1=JO;function M1(n){A1(n)}function K0(n){A1=n}var ZO=null;function Q0(n,e){let t=Object.create(mh);t.value=n,e!==void 0&&(t.equal=e);let i=()=>R1(t);return i[Kn]=t,W0(t),[i,s=>Mc(t,s),s=>N1(t,s)]}function R1(n){return Cc(n),n.value}function Mc(n,e){G0()||M1(n),n.equal(n.value,e)||(n.value=e,XO(n))}function N1(n,e){G0()||M1(n),Mc(n,e(n.value))}var mh=me(L({},Tc),{equal:q0,value:void 0,kind:"signal"});function XO(n){n.version++,I1(),$0(n),ZO?.(n)}function Y0(n){let e=Le(null);try{return n()}finally{Le(e)}}function qe(n){return typeof n=="function"}function La(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var yh=La(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Is(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var pn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(qe(i))try{i()}catch(o){e=o instanceof yh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{P1(o)}catch(s){e=e??[],s instanceof yh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new yh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)P1(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Is(t,e)}remove(e){let{_finalizers:t}=this;t&&Is(t,e),e instanceof n&&e._removeParent(this)}};pn.EMPTY=(()=>{let n=new pn;return n.closed=!0,n})();var J0=pn.EMPTY;function vh(n){return n instanceof pn||n&&"closed"in n&&qe(n.remove)&&qe(n.add)&&qe(n.unsubscribe)}function P1(n){qe(n)?n():n.unsubscribe()}var Fi={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Va={setTimeout(n,e,...t){let{delegate:i}=Va;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Va;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function _h(n){Va.setTimeout(()=>{let{onUnhandledError:e}=Fi;if(e)e(n);else throw n})}function Rc(){}var k1=Z0("C",void 0,void 0);function O1(n){return Z0("E",void 0,n)}function F1(n){return Z0("N",n,void 0)}function Z0(n,e,t){return{kind:n,value:e,error:t}}var Ts=null;function Ua(n){if(Fi.useDeprecatedSynchronousErrorHandling){let e=!Ts;if(e&&(Ts={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Ts;if(Ts=null,t)throw i}}else n()}function L1(n){Fi.useDeprecatedSynchronousErrorHandling&&Ts&&(Ts.errorThrown=!0,Ts.error=n)}var Cs=class extends pn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,vh(e)&&e.add(this)):this.destination=n4}static create(e,t,i){return new Ba(e,t,i)}next(e){this.isStopped?ey(F1(e),this):this._next(e)}error(e){this.isStopped?ey(O1(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ey(k1,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},e4=Function.prototype.bind;function X0(n,e){return e4.call(n,e)}var ty=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Eh(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Eh(i)}else Eh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Eh(t)}}},Ba=class extends Cs{constructor(e,t,i){super();let r;if(qe(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&Fi.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&X0(e.next,o),error:e.error&&X0(e.error,o),complete:e.complete&&X0(e.complete,o)}):r=e}this.destination=new ty(r)}};function Eh(n){Fi.useDeprecatedSynchronousErrorHandling?L1(n):_h(n)}function t4(n){throw n}function ey(n,e){let{onStoppedNotification:t}=Fi;t&&Va.setTimeout(()=>t(n,e))}var n4={closed:!0,next:Rc,error:t4,complete:Rc};var ja=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Li(n){return n}function ny(...n){return iy(n)}function iy(n){return n.length===0?Li:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var rt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=r4(t)?t:new Ba(t,i,r);return Ua(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=V1(i),new i((r,o)=>{let s=new Ba({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[ja](){return this}pipe(...t){return iy(t)(this)}toPromise(t){return t=V1(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function V1(n){var e;return(e=n??Fi.Promise)!==null&&e!==void 0?e:Promise}function i4(n){return n&&qe(n.next)&&qe(n.error)&&qe(n.complete)}function r4(n){return n&&n instanceof Cs||i4(n)&&vh(n)}function o4(n){return qe(n?.lift)}function ht(n){return e=>{if(o4(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ft(n,e,t,i,r){return new ry(n,e,t,i,r)}var ry=class extends Cs{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var U1=La(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Gt=(()=>{class n extends rt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new bh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new U1}next(t){Ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?J0:(this.currentObservers=null,o.push(t),new pn(()=>{this.currentObservers=null,Is(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new rt;return t.source=this,t}}return n.create=(e,t)=>new bh(e,t),n})(),bh=class extends Gt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:J0}};var Tn=class extends Gt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var oy={now(){return(oy.delegate||Date).now()},delegate:void 0};var wh=class extends pn{constructor(e,t){super()}schedule(e,t=0){return this}};var Nc={setInterval(n,e,...t){let{delegate:i}=Nc;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Nc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var xh=class extends wh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return Nc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Nc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Is(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Ha=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};Ha.now=oy.now;var Sh=class extends Ha{constructor(e,t=Ha.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var B1=new Sh(xh);var Cn=new rt(n=>n.complete());function j1(n){return n&&qe(n.schedule)}function H1(n){return n[n.length-1]}function Ih(n){return qe(H1(n))?n.pop():void 0}function ko(n){return j1(H1(n))?n.pop():void 0}function G1(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{u(i.next(d))}catch(h){s(h)}}function l(d){try{u(i.throw(d))}catch(h){s(h)}}function u(d){d.done?o(d.value):r(d.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function $1(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ds(n){return this instanceof Ds?(this.v=n,this):new Ds(n)}function z1(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(g){return function(w){return Promise.resolve(w).then(g,h)}}function a(g,w){i[g]&&(r[g]=function(S){return new Promise(function(P,U){o.push([g,S,P,U])>1||l(g,S)})},w&&(r[g]=w(r[g])))}function l(g,w){try{u(i[g](w))}catch(S){p(o[0][3],S)}}function u(g){g.value instanceof Ds?Promise.resolve(g.value.v).then(d,h):p(o[0][2],g)}function d(g){l("next",g)}function h(g){l("throw",g)}function p(g,w){g(w),o.shift(),o.length&&l(o[0][0],o[0][1])}}function W1(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof $1=="function"?$1(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}}var Th=n=>n&&typeof n.length=="number"&&typeof n!="function";function Ch(n){return qe(n?.then)}function Dh(n){return qe(n[ja])}function Ah(n){return Symbol.asyncIterator&&qe(n?.[Symbol.asyncIterator])}function Mh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function s4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Rh=s4();function Nh(n){return qe(n?.[Rh])}function Ph(n){return z1(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Ds(t.read());if(r)return yield Ds(void 0);yield yield Ds(i)}}finally{t.releaseLock()}})}function kh(n){return qe(n?.getReader)}function on(n){if(n instanceof rt)return n;if(n!=null){if(Dh(n))return a4(n);if(Th(n))return l4(n);if(Ch(n))return c4(n);if(Ah(n))return q1(n);if(Nh(n))return u4(n);if(kh(n))return d4(n)}throw Mh(n)}function a4(n){return new rt(e=>{let t=n[ja]();if(qe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function l4(n){return new rt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function c4(n){return new rt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,_h)})}function u4(n){return new rt(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function q1(n){return new rt(e=>{h4(n,e).catch(t=>e.error(t))})}function d4(n){return q1(Ph(n))}function h4(n,e){var t,i,r,o;return G1(this,void 0,void 0,function*(){try{for(t=W1(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function Qn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Oh(n,e=0){return ht((t,i)=>{t.subscribe(ft(i,r=>Qn(i,n,()=>i.next(r),e),()=>Qn(i,n,()=>i.complete(),e),r=>Qn(i,n,()=>i.error(r),e)))})}function Fh(n,e=0){return ht((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function K1(n,e){return on(n).pipe(Fh(e),Oh(e))}function Q1(n,e){return on(n).pipe(Fh(e),Oh(e))}function Y1(n,e){return new rt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function J1(n,e){return new rt(t=>{let i;return Qn(t,e,()=>{i=n[Rh](),Qn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>qe(i?.return)&&i.return()})}function Lh(n,e){if(!n)throw new Error("Iterable cannot be null");return new rt(t=>{Qn(t,e,()=>{let i=n[Symbol.asyncIterator]();Qn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Z1(n,e){return Lh(Ph(n),e)}function X1(n,e){if(n!=null){if(Dh(n))return K1(n,e);if(Th(n))return Y1(n,e);if(Ch(n))return Q1(n,e);if(Ah(n))return Lh(n,e);if(Nh(n))return J1(n,e);if(kh(n))return Z1(n,e)}throw Mh(n)}function sn(n,e){return e?X1(n,e):on(n)}function tt(...n){let e=ko(n);return sn(n,e)}function sy(n,e){let t=qe(n)?n:()=>n,i=r=>r.error(t());return new rt(e?r=>e.schedule(i,0,r):i)}function Vh(n){return!!n&&(n instanceof rt||qe(n.lift)&&qe(n.subscribe))}var As=La(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function yt(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:f4}=Array;function p4(n,e){return f4(e)?n(...e):n(e)}function Uh(n){return yt(e=>p4(n,e))}var{isArray:g4}=Array,{getPrototypeOf:m4,prototype:y4,keys:v4}=Object;function Bh(n){if(n.length===1){let e=n[0];if(g4(e))return{args:e,keys:null};if(_4(e)){let t=v4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function _4(n){return n&&typeof n=="object"&&m4(n)===y4}function jh(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Pc(...n){let e=ko(n),t=Ih(n),{args:i,keys:r}=Bh(n);if(i.length===0)return sn([],e);let o=new rt(E4(i,e,r?s=>jh(r,s):Li));return t?o.pipe(Uh(t)):o}function E4(n,e,t=Li){return i=>{eI(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let l=0;l<r;l++)eI(e,()=>{let u=sn(n[l],e),d=!1;u.subscribe(ft(i,h=>{o[l]=h,d||(d=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function eI(n,e,t){n?Qn(t,n,e):e()}function tI(n,e,t,i,r,o,s,a){let l=[],u=0,d=0,h=!1,p=()=>{h&&!l.length&&!u&&e.complete()},g=S=>u<i?w(S):l.push(S),w=S=>{o&&e.next(S),u++;let P=!1;on(t(S,d++)).subscribe(ft(e,U=>{r?.(U),o?g(U):e.next(U)},()=>{P=!0},void 0,()=>{if(P)try{for(u--;l.length&&u<i;){let U=l.shift();s?Qn(e,s,()=>w(U)):w(U)}p()}catch(U){e.error(U)}}))};return n.subscribe(ft(e,g,()=>{h=!0,p()})),()=>{a?.()}}function Hn(n,e,t=1/0){return qe(e)?Hn((i,r)=>yt((o,s)=>e(i,o,r,s))(on(n(i,r))),t):(typeof e=="number"&&(t=e),ht((i,r)=>tI(i,r,n,t)))}function nI(n=1/0){return Hn(Li,n)}function iI(){return nI(1)}function Oo(...n){return iI()(sn(n,ko(n)))}function kc(n){return new rt(e=>{on(n()).subscribe(e)})}function ay(...n){let e=Ih(n),{args:t,keys:i}=Bh(n),r=new rt(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,u=s;for(let d=0;d<s;d++){let h=!1;on(t[d]).subscribe(ft(o,p=>{h||(h=!0,u--),a[d]=p},()=>l--,void 0,()=>{(!l||!h)&&(u||o.next(i?jh(i,a):a),o.complete())}))}});return e?r.pipe(Uh(e)):r}function Vi(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>n.call(e,o,r++)&&i.next(o)))})}function Oc(n){return ht((e,t)=>{let i=null,r=!1,o;i=e.subscribe(ft(t,void 0,void 0,s=>{o=on(n(s,Oc(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function Hh(n,e){return qe(e)?Hn(n,e,1):Hn(n,1)}function ly(n,e=B1){return ht((t,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let u=o;o=null,i.next(u)}};function l(){let u=s+n,d=e.now();if(d<u){r=this.schedule(void 0,u-d),i.add(r);return}a()}t.subscribe(ft(i,u=>{o=u,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function rI(n){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Ui(n){return n<=0?()=>Cn:ht((e,t)=>{let i=0;e.subscribe(ft(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function oI(n=b4){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function b4(){return new As}function cy(n){return ht((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Gr(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Vi((r,o)=>n(r,o,i)):Li,Ui(1),t?rI(e):oI(()=>new As))}function $h(n){return n<=0?()=>Cn:ht((e,t)=>{let i=[];e.subscribe(ft(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function uy(n){return Vi((e,t)=>n<=t)}function Fc(...n){let e=ko(n);return ht((t,i)=>{(e?Oo(n,t,e):Oo(n,t)).subscribe(i)})}function zr(n,e){return ht((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(ft(i,l=>{r?.unsubscribe();let u=0,d=o++;on(n(l,d)).subscribe(r=ft(i,h=>i.next(e?e(l,h,d,u++):h),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Ms(n){return ht((e,t)=>{on(n).subscribe(ft(t,()=>t.complete(),Rc)),!t.closed&&e.subscribe(t)})}function ar(n,e,t){let i=qe(n)||e||t?{next:n,error:e,complete:t}:n;return i?ht((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(ft(o,l=>{var u;(u=i.next)===null||u===void 0||u.call(i,l),o.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),o.complete()},l=>{var u;a=!1,(u=i.error)===null||u===void 0||u.call(i,l),o.error(l)},()=>{var l,u;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(u=i.finalize)===null||u===void 0||u.call(i)}))}):Li}var dy;function Gh(){return dy}function lr(n){let e=dy;return dy=n,e}var sI=Symbol("NotFound");function $a(n){return n===sI||n?.name==="\u0275NotFound"}var Qh="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",de=class extends Error{code;constructor(e,t){super(Kr(e,t)),this.code=e}};function S4(n){return`NG0${Math.abs(n)}`}function Kr(n,e){return`${S4(n)}${e?": "+e:""}`}var ur=globalThis;function vt(n){for(let e in n)if(n[e]===vt)return e;throw Error("")}function dI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function qr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(qr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function Yh(n,e){return n?e?`${n} ${e}`:n:e||""}var I4=vt({__forward_ref__:vt});function Uo(n){return n.__forward_ref__=Uo,n.toString=function(){return qr(this())},n}function Dn(n){return Ty(n)?n():n}function Ty(n){return typeof n=="function"&&n.hasOwnProperty(I4)&&n.__forward_ref__===Uo}function le(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function dr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Hc(n){return T4(n,Jh)}function Cy(n){return Hc(n)!==null}function T4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function C4(n){let e=n?.[Jh]??null;return e||null}function fy(n){return n&&n.hasOwnProperty(Wh)?n[Wh]:null}var Jh=vt({\u0275prov:vt}),Wh=vt({\u0275inj:vt}),ve=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=le({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Dy(n){return n&&!!n.\u0275providers}var Ay=vt({\u0275cmp:vt}),My=vt({\u0275dir:vt}),Ry=vt({\u0275pipe:vt}),Ny=vt({\u0275mod:vt}),Vc=vt({\u0275fac:vt}),Os=vt({__NG_ELEMENT_ID__:vt}),aI=vt({__NG_ENV_ID__:vt});function Py(n){return Xh(n,"@NgModule"),n[Ny]||null}function Qr(n){return Xh(n,"@Component"),n[Ay]||null}function Zh(n){return Xh(n,"@Directive"),n[My]||null}function ky(n){return Xh(n,"@Pipe"),n[Ry]||null}function Xh(n,e){if(n==null)throw new de(-919,!1)}function Bi(n){return typeof n=="string"?n:n==null?"":String(n)}function hI(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Bi(n)}var fI=vt({ngErrorCode:vt}),D4=vt({ngErrorMessage:vt}),A4=vt({ngTokenPath:vt});function Oy(n,e){return pI("",-200,e)}function ef(n,e){throw new de(-201,!1)}function pI(n,e,t){let i=new de(e,n);return i[fI]=e,i[D4]=n,t&&(i[A4]=t),i}function M4(n){return n[fI]}var py;function gI(){return py}function $n(n){let e=py;return py=n,e}function Fy(n,e,t){let i=Hc(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;ef(n,"")}var R4={},Rs=R4,N4="__NG_DI_FLAG__",gy=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Ns(t)||0;try{return this.injector.get(e,i&8?null:Rs,i)}catch(r){if($a(r))return r;throw r}}};function P4(n,e=0){let t=Gh();if(t===void 0)throw new de(-203,!1);if(t===null)return Fy(n,void 0,e);{let i=k4(e),r=t.retrieve(n,i);if($a(r)){if(i.optional)return null;throw r}return r}}function Re(n,e=0){return(gI()||P4)(Dn(n),e)}function $(n,e){return Re(n,Ns(e))}function Ns(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function k4(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function my(n){let e=[];for(let t=0;t<n.length;t++){let i=Dn(n[t]);if(Array.isArray(i)){if(i.length===0)throw new de(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],l=O4(a);typeof l=="number"?l===-1?r=a.token:o|=l:r=a}e.push(Re(r,o))}else e.push(Re(i))}return e}function O4(n){return n[N4]}function Fo(n,e){let t=n.hasOwnProperty(Vc);return t?n[Vc]:null}function mI(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function yI(n){return n.flat(Number.POSITIVE_INFINITY)}function tf(n,e){n.forEach(t=>Array.isArray(t)?tf(t,e):e(t))}function Ly(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function $c(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function vI(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function nf(n,e,t){let i=za(n,e);return i>=0?n[i|1]=t:(i=~i,vI(n,i,e,t)),i}function rf(n,e){let t=za(n,e);if(t>=0)return n[t|1]}function za(n,e){return F4(n,e,1)}function F4(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var Bo={},Gn=[],hr=new ve(""),Vy=new ve("",-1),Uy=new ve(""),Uc=class{get(e,t=Rs){if(t===Rs){let r=pI("",-201);throw r.name="\u0275NotFound",r}return t}};function fr(n){return{\u0275providers:n}}function _I(n){return fr([{provide:hr,multi:!0,useValue:n}])}function EI(...n){return{\u0275providers:of(!0,n),\u0275fromNgModule:!0}}function of(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return tf(e,s=>{let a=s;qh(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&bI(r,o),t}function bI(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];By(r,o=>{e(o,i)})}}function qh(n,e,t,i){if(n=Dn(n),!n)return!1;let r=null,o=fy(n),s=!o&&Qr(n);if(!o&&!s){let l=n.ngModule;if(o=fy(l),o)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let u of l)qh(u,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let u;tf(o.imports,d=>{qh(d,e,t,i)&&(u||=[],u.push(d))}),u!==void 0&&bI(u,e)}if(!a){let u=Fo(r)||(()=>new r);e({provide:r,useFactory:u,deps:Gn},r),e({provide:Uy,useValue:r,multi:!0},r),e({provide:hr,useValue:()=>Re(r),multi:!0},r)}let l=o.providers;if(l!=null&&!a){let u=n;By(l,d=>{e(d,u)})}}else return!1;return r!==n&&n.providers!==void 0}function By(n,e){for(let t of n)Dy(t)&&(t=t.\u0275providers),Array.isArray(t)?By(t,e):e(t)}var L4=vt({provide:String,useValue:vt});function wI(n){return n!==null&&typeof n=="object"&&L4 in n}function V4(n){return!!(n&&n.useExisting)}function U4(n){return!!(n&&n.useFactory)}function Ps(n){return typeof n=="function"}function xI(n){return!!n.useClass}var Gc=new ve(""),zh={},lI={},hy;function zc(){return hy===void 0&&(hy=new Uc),hy}var zt=class{},ks=class extends zt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,vy(e,s=>this.processProvider(s)),this.records.set(Vy,Ga(void 0,this)),r.has("environment")&&this.records.set(zt,Ga(void 0,this));let o=this.records.get(Gc);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Uy,Gn,{self:!0}))}retrieve(e,t){let i=Ns(t)||0;try{return this.get(e,Rs,i)}catch(r){if($a(r))return r;throw r}}destroy(){Lc(this),this._destroyed=!0;let e=Le(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Le(e)}}onDestroy(e){return Lc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Lc(this);let t=lr(this),i=$n(void 0),r;try{return e()}finally{lr(t),$n(i)}}get(e,t=Rs,i){if(Lc(this),e.hasOwnProperty(aI))return e[aI](this);let r=Ns(i),o,s=lr(this),a=$n(void 0);try{if(!(r&4)){let u=this.records.get(e);if(u===void 0){let d=G4(e)&&Hc(e);d&&this.injectableDefInScope(d)?u=Ga(yy(e),zh):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u,r)}let l=r&2?zc():this.parent;return t=r&8&&t===Rs?null:t,l.get(e,t)}catch(l){let u=M4(l);throw u===-200||u===-201?new de(u,null):l}finally{$n(a),lr(s)}}resolveInjectorInitializers(){let e=Le(null),t=lr(this),i=$n(void 0),r;try{let o=this.get(hr,Gn,{self:!0});for(let s of o)s()}finally{lr(t),$n(i),Le(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(qr(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Dn(e);let t=Ps(e)?e:Dn(e&&e.provide),i=j4(e);if(!Ps(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Ga(void 0,zh,!0),r.factory=()=>my(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Le(null);try{if(t.value===lI)throw Oy(qr(e));return t.value===zh&&(t.value=lI,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&$4(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Le(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Dn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function yy(n){let e=Hc(n),t=e!==null?e.factory:Fo(n);if(t!==null)return t;if(n instanceof ve)throw new de(204,!1);if(n instanceof Function)return B4(n);throw new de(204,!1)}function B4(n){if(n.length>0)throw new de(204,!1);let t=C4(n);return t!==null?()=>t.factory(n):()=>new n}function j4(n){if(wI(n))return Ga(void 0,n.useValue);{let e=jy(n);return Ga(e,zh)}}function jy(n,e,t){let i;if(Ps(n)){let r=Dn(n);return Fo(r)||yy(r)}else if(wI(n))i=()=>Dn(n.useValue);else if(U4(n))i=()=>n.useFactory(...my(n.deps||[]));else if(V4(n))i=(r,o)=>Re(Dn(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Dn(n&&(n.useClass||n.provide));if(H4(n))i=()=>new r(...my(n.deps));else return Fo(r)||yy(r)}return i}function Lc(n){if(n.destroyed)throw new de(205,!1)}function Ga(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function H4(n){return!!n.deps}function $4(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function G4(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function vy(n,e){for(let t of n)Array.isArray(t)?vy(t,e):t&&Dy(t)?vy(t.\u0275providers,e):e(t)}function Mn(n,e){let t;n instanceof ks?(Lc(n),t=n):t=new gy(n);let i,r=lr(t),o=$n(void 0);try{return e()}finally{lr(r),$n(o)}}function SI(){return gI()!==void 0||Gh()!=null}var Wn=0,Ce=1,He=2,Jt=3,bi=4,wi=5,Yn=6,Wa=7,Zt=8,si=9,pr=10,xt=11,qa=12,Hy=13,Fs=14,qn=15,jo=16,Ls=17,gr=18,Yr=19,$y=20,Wr=21,sf=22,Wc=23,ai=24,Vs=25,Us=26,ct=27,II=1,ji=6,mr=7,qc=8,Bs=9,Bt=10;function li(n){return Array.isArray(n)&&typeof n[II]=="object"}function ci(n){return Array.isArray(n)&&n[II]===!0}function Gy(n){return(n.flags&4)!==0}function Jr(n){return n.componentOffset>-1}function Kc(n){return(n.flags&1)===1}function yr(n){return!!n.template}function js(n){return(n[He]&512)!==0}function Ho(n){return(n[He]&256)===256}var zy="svg",TI="math";function ui(n){for(;Array.isArray(n);)n=n[Wn];return n}function Wy(n,e){return ui(e[n])}function xi(n,e){return ui(e[n.index])}function Hs(n,e){return n.data[e]}function Qc(n,e){return n[e]}function Yc(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Si(n,e){let t=e[n];return li(t)?t:t[Wn]}function CI(n){return(n[He]&4)===4}function af(n){return(n[He]&128)===128}function DI(n){return ci(n[Jt])}function Ii(n,e){return e==null?null:n[e]}function qy(n){n[Ls]=0}function Ky(n){n[He]&1024||(n[He]|=1024,af(n)&&Ka(n))}function AI(n,e){for(;n>0;)e=e[Fs],n--;return e}function Jc(n){return!!(n[He]&9216||n[ai]?.dirty)}function lf(n){n[pr].changeDetectionScheduler?.notify(8),n[He]&64&&(n[He]|=1024),Jc(n)&&Ka(n)}function Ka(n){n[pr].changeDetectionScheduler?.notify(0);let e=Lo(n);for(;e!==null&&!(e[He]&8192||(e[He]|=8192,!af(e)));)e=Lo(e)}function Qy(n,e){if(Ho(n))throw new de(911,!1);n[Wr]===null&&(n[Wr]=[]),n[Wr].push(e)}function MI(n,e){if(n[Wr]===null)return;let t=n[Wr].indexOf(e);t!==-1&&n[Wr].splice(t,1)}function Lo(n){let e=n[Jt];return ci(e)?e[Jt]:e}function Yy(n){return n[Wa]??=[]}function Jy(n){return n.cleanup??=[]}function RI(n,e,t,i){let r=Yy(e);r.push(t),n.firstCreatePass&&Jy(n).push(i,r.length-1)}var Ke={lFrame:$I(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var _y=!1;function NI(){return Ke.lFrame.elementDepthCount}function PI(){Ke.lFrame.elementDepthCount++}function Zy(){Ke.lFrame.elementDepthCount--}function Xy(){return Ke.bindingsEnabled}function ev(){return Ke.skipHydrationRootTNode!==null}function tv(n){return Ke.skipHydrationRootTNode===n}function kI(n){Ke.skipHydrationRootTNode=n}function nv(){Ke.skipHydrationRootTNode=null}function Ve(){return Ke.lFrame.lView}function Xt(){return Ke.lFrame.tView}function he(n){return Ke.lFrame.contextLView=n,n[Zt]}function fe(n){return Ke.lFrame.contextLView=null,n}function kn(){let n=iv();for(;n!==null&&n.type===64;)n=n.parent;return n}function iv(){return Ke.lFrame.currentTNode}function OI(){let n=Ke.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function $s(n,e){let t=Ke.lFrame;t.currentTNode=n,t.isParent=e}function rv(){return Ke.lFrame.isParent}function FI(){Ke.lFrame.isParent=!1}function ov(){return Ke.lFrame.contextLView}function sv(){return _y}function av(n){let e=_y;return _y=n,e}function Zc(){let n=Ke.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function lv(){return Ke.lFrame.bindingIndex}function LI(n){return Ke.lFrame.bindingIndex=n}function Gs(){return Ke.lFrame.bindingIndex++}function Xc(n){let e=Ke.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function VI(){return Ke.lFrame.inI18n}function UI(n,e){let t=Ke.lFrame;t.bindingIndex=t.bindingRootIndex=n,cf(e)}function BI(){return Ke.lFrame.currentDirectiveIndex}function cf(n){Ke.lFrame.currentDirectiveIndex=n}function jI(n){let e=Ke.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function cv(){return Ke.lFrame.currentQueryIndex}function uf(n){Ke.lFrame.currentQueryIndex=n}function z4(n){let e=n[Ce];return e.type===2?e.declTNode:e.type===1?n[wi]:null}function uv(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=z4(o),r===null||(o=o[Fs],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Ke.lFrame=HI();return i.currentTNode=e,i.lView=n,!0}function df(n){let e=HI(),t=n[Ce];Ke.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function HI(){let n=Ke.lFrame,e=n===null?null:n.child;return e===null?$I(n):e}function $I(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function GI(){let n=Ke.lFrame;return Ke.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var dv=GI;function hf(){let n=GI();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function zI(n){return(Ke.lFrame.contextLView=AI(n,Ke.lFrame.contextLView))[Zt]}function Ti(){return Ke.lFrame.selectedIndex}function $o(n){Ke.lFrame.selectedIndex=n}function hv(){let n=Ke.lFrame;return Hs(n.tView,n.selectedIndex)}function Y(){Ke.lFrame.currentNamespace=zy}function Ne(){W4()}function W4(){Ke.lFrame.currentNamespace=null}function fv(){return Ke.lFrame.currentNamespace}var WI=!0;function ff(){return WI}function Zr(n){WI=n}function Ey(n,e=null,t=null,i){let r=pv(n,e,t,i);return r.resolveInjectorInitializers(),r}function pv(n,e=null,t=null,i,r=new Set){let o=[t||Gn,EI(n)];return i=i||(typeof n=="object"?void 0:qr(n)),new ks(o,e||zc(),i||null,r)}var zn=class n{static THROW_IF_NOT_FOUND=Rs;static NULL=new Uc;static create(e,t){if(Array.isArray(e))return Ey({name:""},t,e,"");{let i=e.name??"";return Ey({name:i},e.parent,e.providers,i)}}static \u0275prov=le({token:n,providedIn:"any",factory:()=>Re(Vy)});static __NG_ELEMENT_ID__=-1},Wt=new ve(""),Jn=(()=>{class n{static __NG_ELEMENT_ID__=q4;static __NG_ENV_ID__=t=>t}return n})(),by=class extends Jn{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Ho(this._lView)}onDestroy(e){let t=this._lView;return Qy(t,e),()=>MI(t,e)}};function q4(){return new by(Ve())}var qI=!1,KI=new ve(""),vr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Tn(!1);debugTaskTracker=$(KI,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new rt(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),wy=class extends Gt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,SI()&&(this.destroyRef=$(Jn,{optional:!0})??void 0,this.pendingTasks=$(vr,{optional:!0})??void 0)}emit(e){let t=Le(null);try{super.next(e)}finally{Le(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof pn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},an=wy;function Kh(...n){}function gv(n){let e,t;function i(){n=Kh;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function QI(n){return queueMicrotask(()=>n()),()=>{n=Kh}}var mv="isAngularZone",Bc=mv+"_ID",K4=0,An=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new an(!1);onMicrotaskEmpty=new an(!1);onStable=new an(!1);onError=new an(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=qI}=e;if(typeof Zone>"u")throw new de(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,J4(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(mv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new de(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new de(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,Q4,Kh,Kh);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},Q4={};function yv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Y4(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){gv(()=>{n.callbackScheduled=!1,xy(n),n.isCheckStableRunning=!0,yv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),xy(n)}function J4(n){let e=()=>{Y4(n)},t=K4++;n._inner=n._inner.fork({name:"angular",properties:{[mv]:!0,[Bc]:t,[Bc+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(Z4(l))return i.invokeTask(o,s,a,l);try{return cI(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),uI(n)}},onInvoke:(i,r,o,s,a,l,u)=>{try{return cI(n),i.invoke(o,s,a,l,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!X4(l)&&e(),uI(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,xy(n),yv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function xy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function cI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function uI(n){n._nesting--,yv(n)}var jc=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new an;onMicrotaskEmpty=new an;onStable=new an;onError=new an;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function Z4(n){return YI(n,"__ignore_ng_zone__")}function X4(n){return YI(n,"__scheduler_tick__")}function YI(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var cr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},di=new ve("",{factory:()=>{let n=$(An),e=$(zt),t;return i=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw i}):(t??=e.get(cr),t.handleError(i))})}}}),JI={provide:hr,useValue:()=>{let n=$(cr,{optional:!0})},multi:!0},eF=new ve("",{factory:()=>{let n=$(Wt).defaultView;if(!n)return;let e=$(di),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),$(Jn).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function vv(){return fr([_I(()=>{$(eF)})])}function z(n,e){let[t,i,r]=Q0(n,e?.equal),o=t,s=o[Kn];return o.set=i,o.update=r,o.asReadonly=ZI.bind(o),o}function ZI(){let n=this[Kn];if(n.readonlyFn===void 0){let e=()=>this();e[Kn]=n,n.readonlyFn=e}return n.readonlyFn}var pf=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=tF}return n})();function tF(){return new pf(Ve(),kn())}var Vo=class{},eu=new ve("",{factory:()=>!0});var _v=new ve(""),tu=(()=>{class n{internalPendingTasks=$(vr);scheduler=$(Vo);errorHandler=$(di);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),Ev=(()=>{class n{static \u0275prov=le({token:n,providedIn:"root",factory:()=>new Sy})}return n})(),Sy=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}},Iy=class{[Kn];constructor(e){this[Kn]=e}destroy(){this[Kn].destroy()}};function ln(n){return Y0(n)}var gf={JSACTION:"jsaction"};function du(n){return{toString:n}.toString()}function aF(n){return typeof n=="function"}function LT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var If=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}},Xr=(()=>{let n=()=>VT;return n.ngInherit=!0,n})();function VT(n){return n.type.prototype.ngOnChanges&&(n.setInput=cF),lF}function lF(){let n=BT(this),e=n?.current;if(e){let t=n.previous;if(t===Bo)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function cF(n,e,t,i,r){let o=this.declaredInputs[i],s=BT(n)||uF(n,{previous:Bo,current:null}),a=s.current||(s.current={}),l=s.previous,u=l[o];a[o]=new If(u&&u.currentValue,t,l===Bo),LT(n,e,r,t)}var UT="__ngSimpleChanges__";function BT(n){return n[UT]||null}function uF(n,e){return n[UT]=e}var XI=[];var pt=function(n,e=null,t){for(let i=0;i<XI.length;i++){let r=XI[i];r(n,e,t)}},ot=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(ot||{});function dF(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=VT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function jT(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function vf(n,e,t){HT(n,e,3,t)}function _f(n,e,t,i){(n[He]&3)===t&&HT(n,e,t,i)}function bv(n,e){let t=n[He];(t&3)===e&&(t&=16383,t+=1,n[He]=t)}function HT(n,e,t,i){let r=i!==void 0?n[Ls]&65535:0,o=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(n[Ls]+=65536),(a<o||o==-1)&&(hF(n,t,e,l),n[Ls]=(n[Ls]&4294901760)+l+2),l++}function eT(n,e){pt(ot.LifecycleHookStart,n,e);let t=Le(null);try{e.call(n)}finally{Le(t),pt(ot.LifecycleHookEnd,n,e)}}function hF(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[He]>>14<n[Ls]>>16&&(n[He]&3)===e&&(n[He]+=16384,eT(a,o)):eT(a,o)}var Ya=-1,qs=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function fF(n){return(n.flags&8)!==0}function pF(n){return(n.flags&16)!==0}function gF(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];mF(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function $T(n){return n===3||n===4||n===6}function mF(n){return n.charCodeAt(0)===64}function Xa(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?tT(n,t,r,null,e[++i]):tT(n,t,r,null,null))}}return n}function tT(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function GT(n){return n!==Ya}function Tf(n){return n&32767}function yF(n){return n>>16}function Cf(n,e){let t=yF(n),i=e;for(;t>0;)i=i[Fs],t--;return i}var Ov=!0;function Df(n){let e=Ov;return Ov=n,e}var vF=256,zT=vF-1,WT=5,_F=0,_r={};function EF(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Os)&&(i=t[Os]),i==null&&(i=t[Os]=_F++);let r=i&zT,o=1<<r;e.data[n+(r>>WT)]|=o}function Af(n,e){let t=qT(n,e);if(t!==-1)return t;let i=e[Ce];i.firstCreatePass&&(n.injectorIndex=e.length,wv(i.data,n),wv(e,null),wv(i.blueprint,null));let r=u_(n,e),o=n.injectorIndex;if(GT(r)){let s=Tf(r),a=Cf(r,e),l=a[Ce].data;for(let u=0;u<8;u++)e[o+u]=a[s+u]|l[s+u]}return e[o+8]=r,o}function wv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function qT(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function u_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=ZT(r),i===null)return Ya;if(t++,r=r[Fs],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Ya}function Fv(n,e,t){EF(n,e,t)}function bF(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if($T(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function KT(n,e,t){if(t&8||n!==void 0)return n;ef(e,"NodeInjector")}function QT(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[si],o=$n(void 0);try{return r?r.get(e,i,t&8):Fy(e,i,t&8)}finally{$n(o)}}return KT(i,e,t)}function YT(n,e,t,i=0,r){if(n!==null){if(e[He]&2048&&!(i&2)){let s=IF(n,e,t,i,_r);if(s!==_r)return s}let o=JT(n,e,t,i,_r);if(o!==_r)return o}return QT(e,t,i,r)}function JT(n,e,t,i,r){let o=xF(t);if(typeof o=="function"){if(!uv(e,n,i))return i&1?KT(r,t,i):QT(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))ef(t);else return s}finally{dv()}}else if(typeof o=="number"){let s=null,a=qT(n,e),l=Ya,u=i&1?e[qn][wi]:null;for((a===-1||i&4)&&(l=a===-1?u_(n,e):e[a+8],l===Ya||!iT(i,!1)?a=-1:(s=e[Ce],a=Tf(l),e=Cf(l,e)));a!==-1;){let d=e[Ce];if(nT(o,a,d.data)){let h=wF(a,e,t,s,i,u);if(h!==_r)return h}l=e[a+8],l!==Ya&&iT(i,e[Ce].data[a+8]===u)&&nT(o,a,e)?(s=d,a=Tf(l),e=Cf(l,e)):a=-1}}return r}function wF(n,e,t,i,r,o){let s=e[Ce],a=s.data[n+8],l=i==null?Jr(a)&&Ov:i!=s&&(a.type&3)!==0,u=r&1&&o===a,d=Ef(a,s,t,l,u);return d!==null?ou(e,s,d,a,r):_r}function Ef(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,u=n.directiveEnd,d=o>>20,h=i?a:a+d,p=r?a+d:u;for(let g=h;g<p;g++){let w=s[g];if(g<l&&t===w||g>=l&&w.type===t)return g}if(r){let g=s[l];if(g&&yr(g)&&g.type===t)return l}return null}function ou(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof qs){let a=o;if(a.resolving){let g=hI(s[t]);throw Oy(g)}let l=Df(a.canSeeViewProviders);a.resolving=!0;let u=s[t].type||s[t],d,h=a.injectImpl?$n(a.injectImpl):null,p=uv(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&dF(t,s[t],e)}finally{h!==null&&$n(h),Df(l),a.resolving=!1,dv()}}return o}function xF(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Os)?n[Os]:void 0;return typeof e=="number"?e>=0?e&zT:SF:e}function nT(n,e,t){let i=1<<n;return!!(t[e+(n>>WT)]&i)}function iT(n,e){return!(n&2)&&!(n&1&&e)}var Ws=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return YT(this._tNode,this._lView,e,Ns(i),t)}};function SF(){return new Ws(kn(),Ve())}function Zs(n){return du(()=>{let e=n.prototype.constructor,t=e[Vc]||Lv(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[Vc]||Lv(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Lv(n){return Ty(n)?()=>{let e=Lv(Dn(n));return e&&e()}:Fo(n)}function IF(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[He]&2048&&!js(s);){let a=JT(o,s,t,i|2,_r);if(a!==_r)return a;let l=o.parent;if(!l){let u=s[$y];if(u){let d=u.get(t,_r,i);if(d!==_r)return d}l=ZT(s),s=s[Fs]}o=l}return r}function ZT(n){let e=n[Ce],t=e.type;return t===2?e.declTNode:t===1?n[wi]:null}function hu(n){return bF(kn(),n)}function TF(){return rl(kn(),Ve())}function rl(n,e){return new zi(xi(n,e))}var zi=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=TF}return n})();function CF(n){return n instanceof zi?n.nativeElement:n}function DF(){return this._results[Symbol.iterator]()}var Mf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Gt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=yI(e);(this._changesDetected=!mI(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=DF},XT="ngSkipHydration",AF="ngskiphydration";function eC(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let i=e[t];if(typeof i=="number")return!1;if(typeof i=="string"&&i.toLowerCase()===AF)return!0}return!1}function tC(n){return n.hasAttribute(XT)}function Rf(n){return(n.flags&128)===128}function nC(n){if(Rf(n))return!0;let e=n.parent;for(;e;){if(Rf(n)||eC(e))return!0;e=e.parent}return!1}var d_=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(d_||{}),iC=new Map,MF=0;function RF(){return MF++}function NF(n){iC.set(n[Yr],n)}function Vv(n){iC.delete(n[Yr])}var rT="__ngContext__";function el(n,e){li(e)?(n[rT]=e[Yr],NF(e)):n[rT]=e}function rC(n){return sC(n[qa])}function oC(n){return sC(n[bi])}function sC(n){for(;n!==null&&!ci(n);)n=n[bi];return n}var Uv;function h_(n){Uv=n}function aC(){if(Uv!==void 0)return Uv;if(typeof document<"u")return document;throw new de(210,!1)}var br=new ve("",{factory:()=>PF}),PF="ng";var qf=new ve(""),Wi=new ve("",{providedIn:"platform",factory:()=>"unknown"});var ol=new ve("",{factory:()=>$(Wt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var sl=(()=>{class n{static \u0275prov=le({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=kF($(Wt),$(br)),t}});store={};onSerializeCallbacks={};get(t,i){return this.store[t]!==void 0?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function kF(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}var lC="h",cC="b",OF="f",FF="n",uC="e",dC="t",Kf="c",f_="x",su="r",hC="i",fC="n",p_="d";var pC="di",gC="s",mC="p";var fu=new ve(""),yC=!1,g_=new ve("",{factory:()=>yC});var m_=new ve(""),vC=!1,_C=new ve("",{factory:()=>[]}),EC=new ve(""),y_=new ve("",{factory:()=>new Map});var pu="ngb";var bC=(n,e,t)=>{let i=n,r=i.__jsaction_fns??new Map,o=r.get(e)??[];o.push(t),r.set(e,o),i.__jsaction_fns=r},wC=(n,e)=>{let t=n,i=t.getAttribute(pu)??"",r=e.get(i)??new Set;r.has(t)||r.add(t),e.set(i,r)};var xC=n=>{n.removeAttribute(gf.JSACTION),n.removeAttribute(pu),n.__jsaction_fns=void 0},SC=new ve("",{factory:()=>({})});function v_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let i of t)i(n)}var Bv=new Map;function IC(n,e){return Bv.set(n,e),()=>Bv.delete(n)}var oT=!1,TC=(n,e,t,i)=>{};function LF(n,e,t,i){TC(n,e,t,i)}function CC(){oT||(TC=(n,e,t,i)=>{let r=n[si].get(br);Bv.get(r)?.(e,t,i)},oT=!0)}var Qf=new ve("");function Yf(n){return(n.flags&32)===32}var VF="__nghData__",__=VF,UF="__nghDeferData__",DC=UF;var bf="ngh",AC="nghm",MC=()=>null;function BF(n,e,t=!1){let i=n.getAttribute(bf);if(i==null)return null;let[r,o]=i.split("|");if(i=t?o:r,!i)return null;let s=o?`|${o}`:"",a=t?r:s,l={};if(i!==""){let d=e.get(sl,null,{optional:!0});d!==null&&(l=d.get(__,[])[Number(i)])}let u={data:l,firstChild:n.firstChild??null};return t&&(u.firstChild=n,Jf(u,0,n.nextSibling)),a?n.setAttribute(bf,a):n.removeAttribute(bf),u}function RC(){MC=BF}function NC(n,e,t=!1){return MC(n,e,t)}function PC(n){let e=n._lView;return e[Ce].type===2?null:(js(e)&&(e=e[ct]),e)}function jF(n){return n.textContent?.replace(/\s/gm,"")}function HF(n){let e=aC(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=jF(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),i,r=[];for(;i=t.nextNode();)r.push(i);for(let o of r)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function Jf(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function jv(n,e){return n.segmentHeads?.[e]??null}function kC(n){return n.get(EC,!1,{optional:!0})}function $F(n,e){let t=n.data,i=t[uC]?.[e]??null;return i===null&&t[Kf]?.[e]&&(i=E_(n,e)),i}function OC(n,e){return n.data[Kf]?.[e]??null}function E_(n,e){let t=OC(n,e)??[],i=0;for(let r of t)i+=r[su]*(r[f_]??1);return i}function GF(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[p_];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function FC(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[p_];n.disconnectedNodes=t?new Set(t):null}return!!GF(n)?.has(e)}function Zf(n,e){let t=n[Yn];return t!==null&&!ev()&&!Yf(e)&&!FC(t,e.index-ct)}function zF(n,e){let t=e.get(Qf),r=e.get(sl).get(DC,{}),o=!1,s=n,a=null,l=[];for(;!o&&s;){o=t.has(s);let u=t.hydrating.get(s);if(a===null&&u!=null){a=u.promise;break}l.unshift(s),s=r[s][mC]}return{parentBlockPromise:a,hydrationQueue:l}}function xv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===AC}function sT(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function LC(n){for(let i of n.body.childNodes)if(xv(i))return;let e=sT(n.body.previousSibling);if(xv(e))return;let t=sT(n.head.lastChild);if(!xv(t))throw new de(-507,!1)}function VC(n,e){let t=n.contentQueries;if(t!==null){let i=Le(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];uf(o),a.contentQueries(2,e[s],s)}}}finally{Le(i)}}}function Hv(n,e,t){uf(0);let i=Le(null);try{e(n,t)}finally{Le(i)}}function UC(n,e,t){if(Gy(e)){let i=Le(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Le(i)}}}var Gi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Gi||{});var mf;function WF(){if(mf===void 0&&(mf=null,ur.trustedTypes))try{mf=ur.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return mf}function aT(n){return WF()?.createScriptURL(n)||n}var Nf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Qh})`}};function al(n){return n instanceof Nf?n.changingThisBreaksApplicationSecurity:n}function Xf(n,e){let t=BC(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Qh})`)}return t===e}function BC(n){return n instanceof Nf&&n.getTypeName()||null}var qF=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function b_(n){return n=String(n),n.match(qF)?n:"unsafe:"+n}var KF=/^>|^->|<!--|-->|--!>|<!-$/g,QF=/(<|>)/g,YF="\u200B$1\u200B";function JF(n){return n.replace(KF,e=>e.replace(QF,YF))}function jC(n,e){return n.createText(e)}function ZF(n,e,t){n.setValue(e,t)}function HC(n,e){return n.createComment(JF(e))}function w_(n,e,t){return n.createElement(e,t)}function Pf(n,e,t,i,r){n.insertBefore(e,t,i,r)}function $C(n,e,t){n.appendChild(e,t)}function lT(n,e,t,i,r){i!==null?Pf(n,e,t,i,r):$C(n,e,t)}function x_(n,e,t,i){n.removeChild(null,e,t,i)}function GC(n){n.textContent=""}function XF(n,e,t){n.setAttribute(e,"style",t)}function eL(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function zC(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&gF(n,e,i),r!==null&&eL(n,e,r),o!==null&&XF(n,e,o)}var gu=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(gu||{});function qi(n){let e=qC();return e?e.sanitize(gu.URL,n)||"":Xf(n,"URL")?al(n):b_(Bi(n))}function WC(n){let e=qC();if(e)return aT(e.sanitize(gu.RESOURCE_URL,n)||"");if(Xf(n,"ResourceURL"))return aT(al(n));throw new de(904,!1)}var tL=new Set(["embed","frame","iframe","media","script"]),nL=new Set(["base","link","script"]);function iL(n,e){return e==="src"&&tL.has(n)||e==="href"&&nL.has(n)||e==="xlink:href"&&n==="script"?WC:qi}function S_(n,e,t){return iL(e,t)(n)}function qC(){let n=Ve();return n&&n[pr].sanitizer}function ep(n){return n.ownerDocument.defaultView}function KC(n){return n.ownerDocument.body}function QC(n){return n instanceof Function?n():n}function rL(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var YC="ng-template";function oL(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&rL(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(I_(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function I_(n){return n.type===4&&n.value!==YC}function sL(n,e,t){let i=n.type===4&&!t?YC:n.value;return e===i}function aL(n,e,t){let i=4,r=n.attrs,o=r!==null?uL(r):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Hi(i)&&!Hi(l))return!1;if(s&&Hi(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!sL(n,l,t)||l===""&&e.length===1){if(Hi(i))return!1;s=!0}}else if(i&8){if(r===null||!oL(n,r,l,t)){if(Hi(i))return!1;s=!0}}else{let u=e[++a],d=lL(l,r,I_(n),t);if(d===-1){if(Hi(i))return!1;s=!0;continue}if(u!==""){let h;if(d>o?h="":h=r[d+1].toLowerCase(),i&2&&u!==h){if(Hi(i))return!1;s=!0}}}}return Hi(i)||s}function Hi(n){return(n&1)===0}function lL(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return dL(e,n)}function cL(n,e,t=!1){for(let i=0;i<e.length;i++)if(aL(n,e[i],t))return!0;return!1}function uL(n){for(let e=0;e<n.length;e++){let t=n[e];if($T(t))return e}return n.length}function dL(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function cT(n,e){return n?":not("+e.trim()+")":e}function hL(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!Hi(s)&&(e+=cT(o,r),r=""),i=s,o=o||!Hi(i);t++}return r!==""&&(e+=cT(o,r)),e}function fL(n){return n.map(hL).join(",")}function pL(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!Hi(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var vn={};function T_(n,e,t,i,r,o,s,a,l,u,d){let h=ct+i,p=h+r,g=gL(h,p),w=typeof u=="function"?u():u;return g[Ce]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:w,incompleteFirstPass:!1,ssrId:d}}function gL(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:vn);return t}function mL(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=T_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function C_(n,e,t,i,r,o,s,a,l,u,d){let h=e.blueprint.slice();return h[Wn]=r,h[He]=i|4|128|8|64|1024,(u!==null||n&&n[He]&2048)&&(h[He]|=2048),qy(h),h[Jt]=h[Fs]=n,h[Zt]=t,h[pr]=s||n&&n[pr],h[xt]=a||n&&n[xt],h[si]=l||n&&n[si]||null,h[wi]=o,h[Yr]=RF(),h[Yn]=d,h[$y]=u,h[qn]=e.type==2?n[qn]:h,h}function yL(n,e,t){let i=xi(e,n),r=mL(t),o=n[pr].rendererFactory,s=D_(n,C_(n,r,null,JC(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function JC(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function ZC(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function D_(n,e){return n[qa]?n[Hy][bi]=e:n[qa]=e,n[Hy]=e,e}function _(n=1){XC(Xt(),Ve(),Ti()+n,!1)}function XC(n,e,t,i){if(!i)if((e[He]&3)===3){let o=n.preOrderCheckHooks;o!==null&&vf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&_f(e,o,0,t)}$o(t)}var tp=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(tp||{});function $v(n,e,t,i){let r=Le(null);try{let[o,s,a]=n.inputs[t],l=null;(s&tp.SignalBased)!==0&&(l=e[o][Kn]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,l,i,t,o):LT(e,l,o,i)}finally{Le(r)}}var Er=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Er||{}),vL;function A_(n,e){return vL(n,e)}var Ks=new Set,np=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(np||{}),Wo=new ve(""),uT=new Set;function fi(n){uT.has(n)||(uT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var M_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),eD=[0,1,2,3],tD=(()=>{class n{ngZone=$(An);scheduler=$(Vo);errorHandler=$(cr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){$(Wo,{optional:!0})}execute(){let t=this.sequences.size>0;t&&pt(ot.AfterRenderHooksStart),this.executing=!0;for(let i of eD)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&pt(ot.AfterRenderHooksEnd)}register(t){let{view:i}=t;i!==void 0?((i[Vs]??=[]).push(t),Ka(i),i[He]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(np.AFTER_NEXT_RENDER,t):t()}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),kf=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Vs];e&&(this.view[Vs]=e.filter(t=>t!==this))}};function mu(n,e){let t=e?.injector??$(zn);return fi("NgAfterNextRender"),EL(n,t,e,!0)}function _L(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function EL(n,e,t,i){let r=e.get(M_);r.impl??=e.get(tD);let o=e.get(Wo,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Jn):null,a=e.get(pf,null,{optional:!0}),l=new kf(r.impl,_L(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(l),l}var nD=new ve("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:$(zt)})});function iD(n,e,t){let i=n.get(nD);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function bL(n,e){let t=n.get(nD);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function wL(n,e){for(let[t,i]of e)iD(n,i.animateFns)}function dT(n,e,t,i){let r=n?.[Us]?.enter;e!==null&&r&&r.has(t.index)&&wL(i,r)}function Qa(n,e,t,i,r,o,s,a){if(r!=null){let l,u=!1;ci(r)?l=r:li(r)&&(u=!0,r=r[Wn]);let d=ui(r);n===0&&i!==null?(dT(a,i,o,t),s==null?$C(e,i,d):Pf(e,i,d,s||null,!0)):n===1&&i!==null?(dT(a,i,o,t),Pf(e,i,d,s||null,!0)):n===2?hT(a,o,t,h=>{x_(e,d,u,h)}):n===3&&hT(a,o,t,()=>{e.destroyNode(d)}),l!=null&&OL(e,n,t,l,o,i,s)}}function xL(n,e){rD(n,e),e[Wn]=null,e[wi]=null}function SL(n,e,t,i,r,o){i[Wn]=r,i[wi]=e,rp(n,i,t,1,r,o)}function rD(n,e){e[pr].changeDetectionScheduler?.notify(9),rp(n,e,e[xt],2,null,null)}function IL(n){let e=n[qa];if(!e)return Sv(n[Ce],n);for(;e;){let t=null;if(li(e))t=e[qa];else{let i=e[Bt];i&&(t=i)}if(!t){for(;e&&!e[bi]&&e!==n;)li(e)&&Sv(e[Ce],e),e=e[Jt];e===null&&(e=n),li(e)&&Sv(e[Ce],e),t=e&&e[bi]}e=t}}function R_(n,e){let t=n[Bs],i=t.indexOf(e);t.splice(i,1)}function ip(n,e){if(Ho(e))return;let t=e[xt];t.destroyNode&&rp(n,e,t,3,null,null),IL(e)}function Sv(n,e){if(Ho(e))return;let t=Le(null);try{e[He]&=-129,e[He]|=256,e[ai]&&Ac(e[ai]),DL(n,e),CL(n,e),e[Ce].type===1&&e[xt].destroy();let i=e[jo];if(i!==null&&ci(e[Jt])){i!==e[Jt]&&R_(i,e);let r=e[gr];r!==null&&r.detachView(n)}Vv(e)}finally{Le(t)}}function hT(n,e,t,i){let r=n?.[Us];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&Ks.add(n[Yr]),iD(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let u=s.animateFns[l],{promise:d}=u();a.push(d)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),TL(n,i)}else n&&Ks.delete(n[Yr]),i(!1)},r)}function TL(n,e){let t=n[Us]?.running;if(t){t.then(()=>{n[Us].running=void 0,Ks.delete(n[Yr]),e(!0)});return}e(!1)}function CL(n,e){let t=n.cleanup,i=e[Wa];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[Wa]=null);let r=e[Wr];if(r!==null){e[Wr]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[Wc];if(o!==null){e[Wc]=null;for(let s of o)s.destroy()}}function DL(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof qs)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],l=o[s+1];pt(ot.LifecycleHookStart,a,l);try{l.call(a)}finally{pt(ot.LifecycleHookEnd,a,l)}}else{pt(ot.LifecycleHookStart,r,o);try{o.call(r)}finally{pt(ot.LifecycleHookEnd,r,o)}}}}}function AL(n,e,t){return ML(n,e.parent,t)}function ML(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Wn];if(Jr(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Gi.None||r===Gi.Emulated)return null}return xi(i,t)}function RL(n,e,t){return PL(n,e,t)}function NL(n,e,t){return n.type&40?xi(n,t):null}var PL=NL,fT;function N_(n,e,t,i){let r=AL(n,i,e),o=e[xt],s=i.parent||e[wi],a=RL(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)lT(o,r,t[l],a,!1);else lT(o,r,t,a,!1);fT!==void 0&&fT(o,i,e,t,r)}function iu(n,e){if(e!==null){let t=e.type;if(t&3)return xi(e,n);if(t&4)return Gv(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return iu(n,i);{let r=n[e.index];return ci(r)?Gv(-1,r):ui(r)}}else{if(t&128)return iu(n,e.next);if(t&32)return A_(e,n)()||ui(n[e.index]);{let i=oD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=Lo(n[qn]);return iu(r,i)}else return iu(n,e.next)}}}return null}function oD(n,e){if(e!==null){let i=n[qn][wi],r=e.projection;return i.projection[r]}return null}function Gv(n,e){let t=Bt+n+1;if(t<e.length){let i=e[t],r=i[Ce].firstChild;if(r!==null)return iu(i,r)}return e[mr]}function P_(n,e,t,i,r,o,s){for(;t!=null;){let a=i[si];if(t.type===128){t=t.next;continue}let l=i[t.index],u=t.type;if(s&&e===0&&(l&&el(ui(l),i),t.flags|=2),!Yf(t))if(u&8)P_(n,e,t.child,i,r,o,!1),Qa(e,n,a,r,l,t,o,i);else if(u&32){let d=A_(t,i),h;for(;h=d();)Qa(e,n,a,r,h,t,o,i);Qa(e,n,a,r,l,t,o,i)}else u&16?kL(n,e,i,t,r,o):Qa(e,n,a,r,l,t,o,i);t=s?t.projectionNext:t.next}}function rp(n,e,t,i,r,o){P_(t,i,n.firstChild,e,r,o,!1)}function kL(n,e,t,i,r,o){let s=t[qn],l=s[wi].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++){let d=l[u];Qa(e,n,t[si],r,d,i,o,t)}else{let u=l,d=s[Jt];Rf(i)&&(u.flags|=128),P_(n,e,u,d,r,o,!0)}}function OL(n,e,t,i,r,o,s){let a=i[mr],l=ui(i);a!==l&&Qa(e,n,t,o,a,r,s);for(let u=Bt;u<i.length;u++){let d=i[u];rp(d[Ce],d,n,e,o,a)}}function FL(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:Er.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Er.Important),n.setStyle(t,i,r,o))}}function sD(n,e,t,i,r){let o=Ti(),s=i&2;try{$o(-1),s&&e.length>ct&&XC(n,e,ct,!1);let a=s?ot.TemplateUpdateStart:ot.TemplateCreateStart;pt(a,r,t),t(i,r)}finally{$o(o);let a=s?ot.TemplateUpdateEnd:ot.TemplateCreateEnd;pt(a,r,t)}}function k_(n,e,t){GL(n,e,t),(t.flags&64)===64&&zL(n,e,t)}function op(n,e,t=xi){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function LL(n,e,t,i){let o=i.get(g_,yC)||t===Gi.ShadowDom||t===Gi.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return VL(s),s}function VL(n){aD(n)}var aD=()=>null;function UL(n){tC(n)?GC(n):HF(n)}function lD(){aD=UL}function BL(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function jL(n,e,t,i,r,o){let s=e[Ce];if(F_(n,s,e,t,i)){Jr(n)&&$L(e,n.index);return}n.type&3&&(t=BL(t)),HL(n,e,t,i,r,o)}function HL(n,e,t,i,r,o){if(n.type&3){let s=xi(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function $L(n,e){let t=Si(e,n);t[He]&16||(t[He]|=64)}function GL(n,e,t){let i=t.directiveStart,r=t.directiveEnd;Jr(t)&&yL(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Af(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],l=ou(e,n,s,t);if(el(l,e),o!==null&&QL(e,s-i,l,a,t,o),yr(a)){let u=Si(t.index,e);u[Zt]=ou(e,n,s,t)}}}function zL(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=BI();try{$o(o);for(let a=i;a<r;a++){let l=n.data[a],u=e[a];cf(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&WL(l,u)}}finally{$o(-1),cf(s)}}function WL(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function cD(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];cL(e,o.selectors,!1)&&(i??=[],yr(o)?i.unshift(o):i.push(o))}return i}function qL(n,e,t,i,r,o){let s=xi(n,e);KL(e[xt],s,o,n.value,t,i,r)}function KL(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?Bi(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function QL(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],u=s[a+1];$v(i,t,l,u)}}function uD(n,e,t,i,r){let o=ct+t,s=e[Ce],a=r(s,e,n,i,t);e[o]=a,$s(n,!0);let l=n.type===2;return l?(zC(e[xt],a,n),(NI()===0||Kc(n))&&el(a,e),PI()):el(a,e),ff()&&(!l||!Yf(n))&&N_(s,e,a,n),n}function dD(n){let e=n;return rv()?FI():(e=e.parent,$s(e,!1)),e}function O_(n,e){let t=n[si];if(!t)return;let i;try{i=t.get(di,null)}catch{i=null}i?.(e)}function F_(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let u=s[l],d=s[l+1],h=e.data[u];$v(h,t[u],d,r),a=!0}if(o)for(let l of o){let u=t[l],d=e.data[l];$v(d,u,i,r),a=!0}return a}function YL(n,e){let t=Si(e,n),i=t[Ce];JL(i,t);let r=t[Wn];r!==null&&t[Yn]===null&&(t[Yn]=NC(r,t[si])),pt(ot.ComponentStart);try{L_(i,t,t[Zt])}finally{pt(ot.ComponentEnd,t[Zt])}}function JL(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function L_(n,e,t){df(e);try{let i=n.viewQuery;i!==null&&Hv(1,i,t);let r=n.template;r!==null&&sD(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[gr]?.finishViewCreation(n),n.staticContentQueries&&VC(n,e),n.staticViewQueries&&Hv(2,n.viewQuery,t);let o=n.components;o!==null&&ZL(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[He]&=-5,hf()}}function ZL(n,e){for(let t=0;t<e.length;t++)YL(n,e[t])}function yu(n,e,t,i){let r=Le(null);try{let o=e.tView,a=n[He]&4096?4096:16,l=C_(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),u=n[e.index];l[jo]=u;let d=n[gr];return d!==null&&(l[gr]=d.createEmbeddedView(o)),L_(o,l,t),l}finally{Le(r)}}function tl(n,e){return!e||e.firstChild===null||Rf(n)}function au(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(ui(o)),ci(o)&&hD(o,i);let s=t.type;if(s&8)au(n,e,t.child,i);else if(s&32){let a=A_(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=oD(e,t);if(Array.isArray(a))i.push(...a);else{let l=Lo(e[qn]);au(l[Ce],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function hD(n,e){for(let t=Bt;t<n.length;t++){let i=n[t],r=i[Ce].firstChild;r!==null&&au(i[Ce],i,r,e)}n[mr]!==n[Wn]&&e.push(n[mr])}function fD(n){if(n[Vs]!==null){for(let e of n[Vs])e.impl.addSequence(e);n[Vs].length=0}}var pD=[];function XL(n){return n[ai]??e3(n)}function e3(n){let e=pD.pop()??Object.create(n3);return e.lView=n,e}function t3(n){n.lView[ai]!==n&&(n.lView=null,pD.push(n))}var n3=me(L({},Tc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Ka(n.lView)},consumerOnSignalRead(){this.lView[ai]=this}});function i3(n){let e=n[ai]??Object.create(r3);return e.lView=n,e}var r3=me(L({},Tc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Lo(n.lView);for(;e&&!gD(e[Ce]);)e=Lo(e);e&&Ky(e)},consumerOnSignalRead(){this.lView[ai]=this}});function gD(n){return n.type!==2}function mD(n){if(n[Wc]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[Wc])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[He]&8192)}}var o3=100;function yD(n,e=0){let i=n[pr].rendererFactory,r=!1;r||i.begin?.();try{s3(n,e)}finally{r||i.end?.()}}function s3(n,e){let t=sv();try{av(!0),zv(n,e);let i=0;for(;Jc(n);){if(i===o3)throw new de(103,!1);i++,zv(n,1)}}finally{av(t)}}function a3(n,e,t,i){if(Ho(e))return;let r=e[He],o=!1,s=!1;df(e);let a=!0,l=null,u=null;o||(gD(n)?(u=XL(e),l=Dc(u)):hh()===null?(a=!1,u=i3(e),l=Dc(u)):e[ai]&&(Ac(e[ai]),e[ai]=null));try{qy(e),LI(n.bindingStartIndex),t!==null&&sD(n,e,t,2,i);let d=(r&3)===3;if(!o)if(d){let g=n.preOrderCheckHooks;g!==null&&vf(e,g,null)}else{let g=n.preOrderHooks;g!==null&&_f(e,g,0,null),bv(e,0)}if(s||l3(e),mD(e),vD(e,0),n.contentQueries!==null&&VC(n,e),!o)if(d){let g=n.contentCheckHooks;g!==null&&vf(e,g)}else{let g=n.contentHooks;g!==null&&_f(e,g,1),bv(e,1)}u3(n,e);let h=n.components;h!==null&&ED(e,h,0);let p=n.viewQuery;if(p!==null&&Hv(2,p,i),!o)if(d){let g=n.viewCheckHooks;g!==null&&vf(e,g)}else{let g=n.viewHooks;g!==null&&_f(e,g,2),bv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[sf]){for(let g of e[sf])g();e[sf]=null}o||(fD(e),e[He]&=-73)}catch(d){throw o||Ka(e),d}finally{u!==null&&(fh(u,l),a&&t3(u)),hf()}}function vD(n,e){for(let t=rC(n);t!==null;t=oC(t))for(let i=Bt;i<t.length;i++){let r=t[i];_D(r,e)}}function l3(n){for(let e=rC(n);e!==null;e=oC(e)){if(!(e[He]&2))continue;let t=e[Bs];for(let i=0;i<t.length;i++){let r=t[i];Ky(r)}}}function c3(n,e,t){pt(ot.ComponentStart);let i=Si(e,n);try{_D(i,t)}finally{pt(ot.ComponentEnd,i[Zt])}}function _D(n,e){af(n)&&zv(n,e)}function zv(n,e){let i=n[Ce],r=n[He],o=n[ai],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&ph(o)),s||=!1,o&&(o.dirty=!1),n[He]&=-9217,s)a3(i,n,i.template,n[Zt]);else if(r&8192){let a=Le(null);try{mD(n),vD(n,1);let l=i.components;l!==null&&ED(n,l,1),fD(n)}finally{Le(a)}}}function ED(n,e,t){for(let i=0;i<e.length;i++)c3(n,e[i],t)}function u3(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)$o(~r);else{let o=r,s=t[++i],a=t[++i];UI(s,o);let l=e[o];pt(ot.HostBindingsUpdateStart,l);try{a(2,l)}finally{pt(ot.HostBindingsUpdateEnd,l)}}}}finally{$o(-1)}}function sp(n,e){let t=sv()?64:1088;for(n[pr].changeDetectionScheduler?.notify(e);n;){n[He]|=t;let i=Lo(n);if(js(n)&&!i)return n;n=i}return null}function bD(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function wD(n,e){let t=Bt+e;if(t<n.length)return n[t]}function vu(n,e,t,i=!0){let r=e[Ce];if(d3(r,e,n,t),i){let s=Gv(t,n),a=e[xt],l=a.parentNode(n[mr]);l!==null&&SL(r,n[wi],a,e,l,s)}let o=e[Yn];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function V_(n,e){let t=lu(n,e);return t!==void 0&&ip(t[Ce],t),t}function lu(n,e){if(n.length<=Bt)return;let t=Bt+e,i=n[t];if(i){let r=i[jo];r!==null&&r!==n&&R_(r,i),e>0&&(n[t-1][bi]=i[bi]);let o=$c(n,Bt+e);xL(i[Ce],i);let s=o[gr];s!==null&&s.detachView(o[Ce]),i[Jt]=null,i[bi]=null,i[He]&=-129}return i}function d3(n,e,t,i){let r=Bt+i,o=t.length;i>0&&(t[r-1][bi]=e),i<o-Bt?(e[bi]=t[r],Ly(t,Bt+i,e)):(t.push(e),e[bi]=null),e[Jt]=t;let s=e[jo];s!==null&&t!==s&&xD(s,e);let a=e[gr];a!==null&&a.insertView(n),lf(e),e[He]|=128}function xD(n,e){let t=n[Bs],i=e[Jt];if(li(i))n[He]|=2;else{let r=i[Jt][qn];e[qn]!==r&&(n[He]|=2)}t===null?n[Bs]=[e]:t.push(e)}var Go=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Ce];return au(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Zt]}set context(e){this._lView[Zt]=e}get destroyed(){return Ho(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Jt];if(ci(e)){let t=e[qc],i=t?t.indexOf(this):-1;i>-1&&(lu(e,i),$c(t,i))}this._attachedToViewContainer=!1}ip(this._lView[Ce],this._lView)}onDestroy(e){Qy(this._lView,e)}markForCheck(){sp(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[He]&=-129}reattach(){lf(this._lView),this._lView[He]|=128}detectChanges(){this._lView[He]|=1024,yD(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new de(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=js(this._lView),t=this._lView[jo];t!==null&&!e&&R_(t,this._lView),rD(this._lView[Ce],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new de(902,!1);this._appRef=e;let t=js(this._lView),i=this._lView[jo];i!==null&&!t&&xD(i,this._lView),lf(this._lView)}};var zo=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=h3;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=yu(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new Go(o)}}return n})();function h3(){return ap(kn(),Ve())}function ap(n,e){return n.type&4?new zo(e,n,rl(n,e)):null}function ll(n,e,t,i,r){let o=n.data[e];if(o===null)o=f3(n,e,t,i,r),VI()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=OI();o.injectorIndex=s===null?-1:s.injectorIndex}return $s(o,!0),o}function f3(n,e,t,i,r){let o=iv(),s=rv(),a=s?o:o&&o.parent,l=n.data[e]=g3(n,a,t,e,i,r);return p3(n,l,o,s),l}function p3(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function g3(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return ev()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var m3=new RegExp(`^(\\d+)*(${cC}|${lC})*(.*)`);function y3(n){let e=n.match(m3),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(let[l,u,d]of o.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(u,h)}return[s,...a]}function v3(n){return!n.prev&&n.parent?.type===8}function Iv(n){return n.index-ct}function _3(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function lp(n,e,t,i){let r=Iv(i),o=_3(n,r);if(o===void 0){let s=n.data[fC];if(s?.[r])o=b3(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{let a=i.prev===null,l=i.prev??i.parent;if(v3(i)){let u=Iv(i.parent);o=jv(n,u)}else{let u=xi(l,t);if(a)o=u.firstChild;else{let d=Iv(l),h=jv(n,d);if(l.type===2&&h){let g=E_(n,d)+1;o=cp(g,h)}else o=u.nextSibling}}}}return o}function cp(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}function E3(n,e){let t=n;for(let i=0;i<e.length;i+=2){let r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case OF:t=t.firstChild;break;case FF:t=t.nextSibling;break}}return t}function b3(n,e){let[t,...i]=y3(n),r;if(t===lC)r=e[qn][Wn];else if(t===cC)r=KC(e[qn][Wn]);else{let o=Number(t);r=ui(e[o+ct])}return E3(r,i)}var w3=!1;function SD(n){w3=n}function x3(n){let e=n[Yn];if(e){let{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){let r=n[xt];for(let o of i.values())S3(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function S3(n,e,t){for(let i of t.node.cases[t.case]){let r=e.get(i.index-ct);r&&x_(n,r,!1)}}function up(n){let e=n[ji]??[],i=n[Jt][xt],r=[];for(let o of e)o.data[pC]!==void 0?r.push(o):ID(o,i);n[ji]=r}function I3(n){let{lContainer:e}=n,t=e[ji];if(t===null)return;let r=e[Jt][xt];for(let o of t)ID(o,r)}function ID(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[su];for(;t<r;){let o=i.nextSibling;x_(e,i,!1),i=o,t++}}}function dp(n){up(n);let e=n[Wn];li(e)&&Of(e);for(let t=Bt;t<n.length;t++)Of(n[t])}function Of(n){x3(n);let e=n[Ce];for(let t=ct;t<e.bindingStartIndex;t++)if(ci(n[t])){let i=n[t];dp(i)}else li(n[t])&&Of(n[t])}function U_(n){let e=n._views;for(let t of e){let i=PC(t);i!==null&&i[Wn]!==null&&(li(i)?Of(i):dp(i))}}function T3(n,e,t,i){n!==null&&(t.cleanup(e),dp(n.lContainer),U_(i))}function C3(n,e){let t=[];for(let i of e)for(let r=0;r<(i[f_]??1);r++){let o={data:i,firstChild:null};i[su]>0&&(o.firstChild=n,n=cp(i[su],n)),t.push(o)}return[n,t]}var TD=()=>null,CD=()=>null;function DD(){TD=D3,CD=A3}function D3(n,e){return MD(n,e)?n[ji].shift():(up(n),null)}function Ff(n,e){return TD(n,e)}function A3(n,e,t){if(e.tView.ssrId===null)return null;let i=Ff(n,e.tView.ssrId);return t[Ce].firstUpdatePass&&i===null&&M3(t,e),i}function AD(n,e,t){return CD(n,e,t)}function M3(n,e){let t=e;for(;t;){if(pT(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(pT(n,t))return;t=t.next}}function MD(n,e){let t=n[ji];return!e||t===null||t.length===0?!1:t[0].data[hC]===e}function pT(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let i=n[e.index];return ci(i)&&MD(i,t)?(up(i),!0):!1}var RD=class{},hp=class{},Wv=class{resolveComponentFactory(e){throw new de(917,!1)}},_u=class{static NULL=new Wv},Qs=class{},Xs=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>R3()}return n})();function R3(){let n=Ve(),e=kn(),t=Si(e.index,n);return(li(t)?t:n)[xt]}var ND=(()=>{class n{static \u0275prov=le({token:n,providedIn:"root",factory:()=>null})}return n})();var wf={},Ja=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,wf,i);return r!==wf||t===wf?r:this.parentInjector.get(e,t,i)}};function Lf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=Yh(r,a);else if(o==2){let l=a,u=e[++s];i=Yh(i,l+": "+u+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Ee(n,e=0){let t=Ve();if(t===null)return Re(n,e);let i=kn();return YT(i,t,Dn(n),e)}function PD(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,l=null,u=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,l,u]=d.resolveHostDirectives(s);break}k3(n,e,t,a,o,l,u)}o!==null&&i!==null&&N3(t,i,o)}function N3(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new de(-301,!1);i.push(e[r],o)}}function P3(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function k3(n,e,t,i,r,o,s){let a=i.length,l=null;for(let p=0;p<a;p++){let g=i[p];l===null&&yr(g)&&(l=g,P3(n,t,p)),Fv(Af(t,e),n,g.type)}B3(t,n.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let p=0;p<a;p++){let g=i[p];g.providersResolver&&g.providersResolver(g)}let u=!1,d=!1,h=ZC(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let p=0;p<a;p++){let g=i[p];if(t.mergedAttrs=Xa(t.mergedAttrs,g.hostAttrs),F3(n,t,e,h,g),U3(h,g,r),s!==null&&s.has(g)){let[S,P]=s.get(g);t.directiveToIndex.set(g.type,[h,S+t.directiveStart,P+t.directiveStart])}else(o===null||!o.has(g))&&t.directiveToIndex.set(g.type,h);g.contentQueries!==null&&(t.flags|=4),(g.hostBindings!==null||g.hostAttrs!==null||g.hostVars!==0)&&(t.flags|=64);let w=g.type.prototype;!u&&(w.ngOnChanges||w.ngOnInit||w.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),u=!0),!d&&(w.ngOnChanges||w.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}O3(n,t,o)}function O3(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))gT(0,e,r,i),gT(1,e,r,i),yT(e,i,!1);else{let o=t.get(r);mT(0,e,o,i),mT(1,e,o,i),yT(e,i,!0)}}}function gT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),kD(e,o)}}function mT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),kD(e,s)}}function kD(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function yT(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||I_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&r.hasOwnProperty(l)){let u=r[l];for(let d of u)if(d===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let u=o[l];for(let d=0;d<u.length;d+=2)if(u[d]===e){s??=[],s.push(u[d+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function F3(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Fo(r.type,!0)),s=new qs(o,yr(r),Ee,null);n.blueprint[i]=s,t[i]=s,L3(n,e,i,ZC(n,t,r.hostVars,vn),r)}function L3(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;V3(s)!=a&&s.push(a),s.push(t,i,o)}}function V3(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function U3(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;yr(e)&&(t[""]=n)}}function B3(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function OD(n,e,t,i,r,o,s,a){let l=e[Ce],u=l.consts,d=Ii(u,s),h=ll(l,n,t,i,d);return o&&PD(l,e,h,Ii(u,a),r),h.mergedAttrs=Xa(h.mergedAttrs,h.attrs),h.attrs!==null&&Lf(h,h.attrs,!1),h.mergedAttrs!==null&&Lf(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function FD(n,e){jT(n,e),Gy(e)&&n.queries.elementEnd(e)}function j3(n,e,t,i,r,o){let s=e.consts,a=Ii(s,r),l=ll(e,n,t,i,a);if(l.mergedAttrs=Xa(l.mergedAttrs,l.attrs),o!=null){let u=Ii(s,o);l.localNames=[];for(let d=0;d<u.length;d+=2)l.localNames.push(u[d],-1)}return l.attrs!==null&&Lf(l,l.attrs,!1),l.mergedAttrs!==null&&Lf(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function B_(n){return VD(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function LD(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function VD(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function j_(n,e,t){return n[e]=t}function H3(n,e){return n[e]}function Ci(n,e,t){if(t===vn)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function H_(n,e,t,i){let r=Ci(n,e,t);return Ci(n,e+1,i)||r}function $3(n,e,t,i,r){let o=H_(n,e,t,i);return Ci(n,e+2,r)||o}function xf(n,e,t){return function i(r){let o=Jr(n)?Si(n.index,e):e;sp(o,5);let s=e[Zt],a=vT(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=vT(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function vT(n,e,t,i){let r=Le(null);try{return pt(ot.OutputStart,e,t),t(i)!==!1}catch(o){return O_(n,o),!1}finally{pt(ot.OutputEnd,e,t),Le(r)}}function UD(n,e,t,i,r,o,s,a){let l=Kc(n),u=!1,d=null;if(!i&&l&&(d=z3(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,u=!0}else{let h=xi(n,t),p=i?i(h):h;LF(t,p,o,a);let g=r.listen(p,o,a);if(!G3(o)){let w=i?S=>i(ui(S[n.index])):n.index;BD(w,e,t,o,a,g,!1)}}return u}function G3(n){return n.startsWith("animation")||n.startsWith("transition")}function z3(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[Wa],l=r[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function BD(n,e,t,i,r,o,s){let a=e.firstCreatePass?Jy(e):null,l=Yy(t),u=l.length;l.push(r,o),a&&a.push(i,n,u,(u+1)*(s?-1:1))}function _T(n,e,t,i,r,o){let s=e[t],a=e[Ce],u=a.data[t].outputs[i],h=s[u].subscribe(o);BD(n.index,a,e,r,o,h,!0)}var qv=Symbol("BINDING");var Vf=class extends _u{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Qr(e);return new nl(t,this.ngModule)}};function W3(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&tp.SignalBased)!==0};return r&&(o.transform=r),o})}function q3(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function K3(n,e,t){let i=e instanceof zt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new Ja(t,i):t}function Q3(n){let e=n.get(Qs,null);if(e===null)throw new de(407,!1);let t=n.get(ND,null),i=n.get(Vo,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function Y3(n,e){let t=jD(n);return w_(e,t,t==="svg"?zy:t==="math"?TI:null)}function jD(n){return(n.selectors[0][0]||"div").toLowerCase()}var nl=class extends hp{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=W3(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=q3(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=fL(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){pt(ot.DynamicComponentStart);let a=Le(null);try{let l=this.componentDef,u=J3(i,l,s,o),d=K3(l,r||this.ngModule,e),h=Q3(d),p=h.rendererFactory.createRenderer(null,l),g=i?LL(p,i,l.encapsulation,d):Y3(l,p),w=s?.some(ET)||o?.some(U=>typeof U!="function"&&U.bindings.some(ET)),S=C_(null,u,null,512|JC(l),null,null,h,p,d,null,NC(g,d,!0));S[ct]=g,df(S);let P=null;try{let U=OD(ct,S,2,"#host",()=>u.directiveRegistry,!0,0);zC(p,g,U),el(g,S),k_(u,S,U),UC(u,U,S),FD(u,U),t!==void 0&&X3(U,this.ngContentSelectors,t),P=Si(U.index,S),S[Zt]=P[Zt],L_(u,S,null)}catch(U){throw P!==null&&Vv(P),Vv(S),U}finally{pt(ot.DynamicComponentEnd),hf()}return new Uf(this.componentType,S,!!w)}finally{Le(a)}}};function J3(n,e,t,i){let r=n?["ng-version","21.1.1"]:pL(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[qv].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(i)for(let d=0;d<i.length;d++){let h=i[d];if(typeof h!="function")for(let p of h.bindings){a+=p[qv].requiredVars;let g=d+1;p.create&&(p.targetIdx=g,(o??=[]).push(p)),p.update&&(p.targetIdx=g,(s??=[]).push(p))}}let l=[e];if(i)for(let d of i){let h=typeof d=="function"?d:d.type,p=Zh(h);l.push(p)}return T_(0,null,Z3(o,s),1,a,l,null,null,null,[r],null)}function Z3(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function ET(n){let e=n[qv].kind;return e==="input"||e==="twoWay"}var Uf=class extends RD{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Hs(t[Ce],ct),this.location=rl(this._tNode,t),this.instance=Si(this._tNode.index,t)[Zt],this.hostView=this.changeDetectorRef=new Go(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=F_(i,r[Ce],r,e,t);this.previousInputValues.set(e,t);let s=Si(i.index,r);sp(s,1)}get injector(){return new Ws(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function X3(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var eo=(()=>{class n{static __NG_ELEMENT_ID__=eV}return n})();function eV(){let n=kn();return $D(n,Ve())}var tV=eo,HD=class extends tV{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return rl(this._hostTNode,this._hostLView)}get injector(){return new Ws(this._hostTNode,this._hostLView)}get parentInjector(){let e=u_(this._hostTNode,this._hostLView);if(GT(e)){let t=Cf(e,this._hostLView),i=Tf(e),r=t[Ce].data[i+8];return new Ws(r,t)}else return new Ws(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=bT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Bt}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=Ff(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,tl(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let l=e&&!aF(e),u;if(l)u=t;else{let P=t||{};u=P.index,i=P.injector,r=P.projectableNodes,o=P.environmentInjector||P.ngModuleRef,s=P.directives,a=P.bindings}let d=l?e:new nl(Qr(e)),h=i||this.parentInjector;if(!o&&d.ngModule==null){let U=(l?h:this.parentInjector).get(zt,null);U&&(o=U)}let p=Qr(d.componentType??{}),g=Ff(this._lContainer,p?.id??null),w=g?.firstChild??null,S=d.create(h,r,w,o,s,a);return this.insertImpl(S.hostView,u,tl(this._hostTNode,g)),S}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(DI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Jt],u=new HD(l,l[wi],l[Jt]);u.detach(u.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return vu(s,r,o,i),e.attachToViewContainerRef(),Ly(Tv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=bT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=lu(this._lContainer,t);i&&($c(Tv(this._lContainer),t),ip(i[Ce],i))}detach(e){let t=this._adjustIndex(e,-1),i=lu(this._lContainer,t);return i&&$c(Tv(this._lContainer),t)!=null?new Go(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function bT(n){return n[qc]}function Tv(n){return n[qc]||(n[qc]=[])}function $D(n,e){let t,i=e[n.index];return ci(i)?t=i:(t=bD(i,e,null,n),e[n.index]=t,D_(e,t)),GD(t,e,n,i),new HD(t,n,e)}function nV(n,e){let t=n[xt],i=t.createComment(""),r=xi(e,n),o=t.parentNode(r);return Pf(t,o,i,t.nextSibling(r),!1),i}var GD=zD,$_=()=>!1;function iV(n,e,t){return $_(n,e,t)}function zD(n,e,t,i){if(n[mr])return;let r;t.type&8?r=ui(i):r=nV(e,t),n[mr]=r}function rV(n,e,t){if(n[mr]&&n[ji])return!0;let i=t[Yn],r=e.index-ct;if(!i||nC(e)||FC(i,r))return!1;let s=jv(i,r),a=i.data[Kf]?.[r],[l,u]=C3(s,a);return n[mr]=l,n[ji]=u,!0}function oV(n,e,t,i){$_(n,t,e)||zD(n,e,t,i)}function WD(){GD=oV,$_=rV}var Kv=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Qv=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)G_(e,t).matches!==null&&this.queries[t].setDirty()}},Yv=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=fV(e):this.predicate=e}},Jv=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Zv=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,sV(t,o)),this.matchTNodeWithReadOption(e,t,Ef(t,e,o,!1,!1))}else i===zo?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Ef(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===zi||r===eo||r===zo&&t.type&4)this.addMatch(t.index,-2);else{let o=Ef(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function sV(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function aV(n,e){return n.type&11?rl(n,e):n.type&4?ap(n,e):null}function lV(n,e,t,i){return t===-1?aV(e,n):t===-2?cV(n,e,i):ou(n,n[Ce],t,e)}function cV(n,e,t){if(t===zi)return rl(e,n);if(t===zo)return ap(e,n);if(t===eo)return $D(e,n)}function qD(n,e,t,i){let r=e[gr].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let u=s[l];if(u<0)a.push(null);else{let d=o[u];a.push(lV(e,d,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function Xv(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=qD(n,e,r,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)i.push(s[a/2]);else{let u=o[a+1],d=e[-l];for(let h=Bt;h<d.length;h++){let p=d[h];p[jo]===p[Jt]&&Xv(p[Ce],p,u,i)}if(d[Bs]!==null){let h=d[Bs];for(let p=0;p<h.length;p++){let g=h[p];Xv(g[Ce],g,u,i)}}}}}return i}function uV(n,e){return n[gr].queries[e].queryList}function dV(n,e,t){let i=new Mf((t&4)===4);return RI(n,e,i,i.destroy),(e[gr]??=new Qv).queries.push(new Kv(i))-1}function hV(n,e,t){let i=Xt();return i.firstCreatePass&&(pV(i,new Yv(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),dV(i,Ve(),e)}function fV(n){return n.split(",").map(e=>e.trim())}function pV(n,e,t){n.queries===null&&(n.queries=new Jv),n.queries.track(new Zv(e,t))}function G_(n,e){return n.queries.getByIndex(e)}function gV(n,e){let t=n[Ce],i=G_(t,e);return i.crossesNgTemplate?Xv(t,n,e,[]):qD(t,n,i,e)}var Ys=class{},fp=class{};var Bf=class extends Ys{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Vf(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=Py(e);this._bootstrapComponents=QC(o.bootstrap),this._r3Injector=pv(e,t,[{provide:Ys,useValue:this},{provide:_u,useValue:this.componentFactoryResolver},...i],qr(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},jf=class extends fp{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Bf(this.moduleType,e,[])}};var cu=class extends Ys{injector;componentFactoryResolver=new Vf(this);instance=null;constructor(e){super();let t=new ks([...e.providers,{provide:Ys,useValue:this},{provide:_u,useValue:this.componentFactoryResolver}],e.parent||zc(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function cl(n,e,t=null){return new cu({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var mV=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=of(!1,t.type),r=i.length>0?cl([i],this._injector,""):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=le({token:n,providedIn:"environment",factory:()=>new n(Re(zt))})}return n})();function Ot(n){return du(()=>{let e=KD(n),t=me(L({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===d_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(mV).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Gi.Emulated,styles:n.styles||Gn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&fi("NgStandalone"),QD(t);let i=n.dependencies;return t.directiveDefs=wT(i,yV),t.pipeDefs=wT(i,ky),t.id=EV(t),t})}function yV(n){return Qr(n)||Zh(n)}function to(n){return du(()=>({type:n.type,bootstrap:n.bootstrap||Gn,declarations:n.declarations||Gn,imports:n.imports||Gn,exports:n.exports||Gn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function vV(n,e){if(n==null)return Bo;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=tp.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function _V(n){if(n==null)return Bo;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function _n(n){return du(()=>{let e=KD(n);return QD(e),e})}function pp(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function KD(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Bo,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Gn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:vV(n.inputs,e),outputs:_V(n.outputs),debugInfo:null}}function QD(n){n.features?.forEach(e=>e(n))}function wT(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function EV(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function bV(n){return Object.getPrototypeOf(n.prototype).constructor}function wr(n){let e=bV(n.type),t=!0,i=[n];for(;e;){let r;if(yr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new de(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=Cv(n.inputs),s.declaredInputs=Cv(n.declaredInputs),s.outputs=Cv(n.outputs);let a=r.hostBindings;a&&TV(n,a);let l=r.viewQuery,u=r.contentQueries;if(l&&SV(n,l),u&&IV(n,u),wV(n,r),dI(n.outputs,r.outputs),yr(r)&&r.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===wr&&(t=!1)}}e=Object.getPrototypeOf(e)}xV(i)}function wV(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function xV(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Xa(r.hostAttrs,t=Xa(t,r.hostAttrs))}}function Cv(n){return n===Bo?{}:n===Gn?[]:n}function SV(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function IV(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function TV(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function YD(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=Xa(n.mergedAttrs,n.attrs);let d=n.tView=T_(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),$s(n,!1);let l=JD(t,e,n,i);ff()&&N_(t,e,l,n),el(l,e);let u=bD(l,e,l,n);e[i+ct]=u,D_(e,u),iV(u,n,e)}function CV(n,e,t,i,r,o,s,a,l,u,d){let h=t+ct,p;return e.firstCreatePass?(p=ll(e,h,4,s||null,a||null),Xy()&&PD(e,n,p,Ii(e.consts,u),cD),jT(e,p)):p=e.data[h],YD(p,n,e,t,i,r,o,l),Kc(p)&&k_(e,n,p),u!=null&&op(n,p,d),p}function Hf(n,e,t,i,r,o,s,a,l,u,d){let h=t+ct,p;if(e.firstCreatePass){if(p=ll(e,h,4,s||null,a||null),u!=null){let g=Ii(e.consts,u);p.localNames=[];for(let w=0;w<g.length;w+=2)p.localNames.push(g[w],-1)}}else p=e.data[h];return YD(p,n,e,t,i,r,o,l),u!=null&&op(n,p,d),p}function xr(n,e,t,i,r,o,s,a){let l=Ve(),u=Xt(),d=Ii(u.consts,o);return CV(l,u,n,e,t,i,r,d,void 0,s,a),xr}var JD=ZD;function ZD(n,e,t,i){return Zr(!0),e[xt].createComment("")}function DV(n,e,t,i){let r=!Zf(e,t);Zr(r);let o=e[Yn]?.data[dC]?.[i]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),r)return ZD(n,e);let s=e[Yn],a=lp(s,n,e,t);Jf(s,i,a);let l=E_(s,i);return cp(l,a)}function XD(){JD=DV}var hi=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(hi||{}),xT=0,AV=1,cn=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(cn||{});var MV=0,Eu=1;var RV=4,NV=5;var PV=7,Za=8,kV=9,z_=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(z_||{});function Sf(n,e){let t=FV(n),i=e[t];if(i!==null){for(let r of i)r();e[t]=null}}function OV(n){Sf(1,n),Sf(0,n),Sf(2,n)}function FV(n){let e=RV;return n===1?e=NV:n===2&&(e=kV),e}function eA(n){return n+1}function ul(n,e){let t=n[Ce],i=eA(e.index);return n[i]}function bu(n,e){let t=eA(e.index);return n.data[t]}function LV(n,e,t){let i=e[Ce],r=bu(i,t);switch(n){case cn.Complete:return r.primaryTmplIndex;case cn.Loading:return r.loadingTmplIndex;case cn.Error:return r.errorTmplIndex;case cn.Placeholder:return r.placeholderTmplIndex;default:return null}}function ST(n,e){return e===cn.Placeholder?n.placeholderBlockConfig?.[xT]??null:e===cn.Loading?n.loadingBlockConfig?.[xT]??null:null}function VV(n){return n.loadingBlockConfig?.[AV]??null}function IT(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let i of e)t.add(i);return n.length===t.size?n:Array.from(t)}function UV(n,e){let t=e.primaryTmplIndex+ct;return Hs(n,t)}var BV=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,i,r,o){if(!this.cachedInjectors.has(t)){let s=r.length>0?cl(r,i,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=le({token:n,providedIn:"environment",factory:()=>new n})}return n})();var tA=new ve("");function Dv(n,e,t){return n.get(BV).getOrCreateInjector(e,n,t,"")}function jV(n,e,t){if(n instanceof Ja){let r=n.injector,o=n.parentInjector,s=Dv(o,e,t);return new Ja(r,s)}let i=n.get(zt);if(i!==n){let r=Dv(i,e,t);return new Ja(n,r)}return Dv(n,e,t)}function zs(n,e,t,i=!1){let r=t[Jt],o=r[Ce];if(Ho(r))return;let s=ul(r,e),a=s[Eu],l=s[PV];if(!(l!==null&&n<l)&&TT(a,n)&&TT(s[MV]??-1,n)){let u=bu(o,e),h=!i&&!0&&(VV(u)!==null||ST(u,cn.Loading)!==null||ST(u,cn.Placeholder))?GV:$V;try{h(n,s,t,e,r)}catch(p){O_(r,p)}}}function HV(n,e){let t=n[ji]?.findIndex(r=>r.data[gC]===e[Eu])??-1;return{dehydratedView:t>-1?n[ji][t]:null,dehydratedViewIx:t}}function $V(n,e,t,i,r){pt(ot.DeferBlockStateStart);let o=LV(n,r,i);if(o!==null){e[Eu]=n;let s=r[Ce],a=o+ct,l=Hs(s,a),u=0;V_(t,u);let d;if(n===cn.Complete){let w=bu(s,i),S=w.providers;S&&S.length>0&&(d=jV(r[si],w,S))}let{dehydratedView:h,dehydratedViewIx:p}=HV(t,e),g=yu(r,l,null,{injector:d,dehydratedView:h});if(vu(t,g,u,tl(l,h)),sp(g,2),p>-1&&t[ji]?.splice(p,1),(n===cn.Complete||n===cn.Error)&&Array.isArray(e[Za])){for(let w of e[Za])w();e[Za]=null}}pt(ot.DeferBlockStateEnd)}function TT(n,e){return n<e}function CT(n,e,t){n.loadingPromise.then(()=>{n.loadingState===hi.COMPLETE?zs(cn.Complete,e,t):n.loadingState===hi.FAILED&&zs(cn.Error,e,t)})}var GV=null;var gp=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var W_=new ve("");function qo(n){return!!n&&typeof n.then=="function"}function q_(n){return!!n&&typeof n.subscribe=="function"}var nA=new ve("");var K_=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=$(nA,{optional:!0})??[];injector=$(zn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Mn(this.injector,r);if(qo(o))t.push(o);else if(q_(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ko=new ve("");function iA(){K0(()=>{let n="";throw new de(600,n)})}function rA(n){return n.isBoundToModule}var zV=10;var Zn=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=$(di);afterRenderManager=$(M_);zonelessEnabled=$(eu);rootEffectScheduler=$(Ev);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Gt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=$(vr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(yt(t=>!t))}constructor(){$(Wo,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=$(zt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=zn.NULL){return this._injector.get(An).run(()=>{pt(ot.BootstrapComponentStart);let s=t instanceof hp;if(!this._injector.get(K_).done){let w="";throw new de(405,w)}let l;s?l=t:l=this._injector.get(_u).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let u=rA(l)?void 0:this._injector.get(Ys),d=i||l.selector,h=l.create(r,[],d,u),p=h.location.nativeElement,g=h.injector.get(W_,null);return g?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),ru(this.components,h),g?.unregisterApplication(p)}),this._loadComponent(h),pt(ot.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){pt(ot.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(np.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw pt(ot.ChangeDetectionEnd),new de(101,!1);let t=Le(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Le(t),this.afterTick.next(),pt(ot.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Qs,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<zV;){pt(ot.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{pt(ot.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!Jc(r))continue;let o=i&&!this.zonelessEnabled?0:1;yD(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Jc(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;ru(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(Ko,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>ru(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new de(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ru(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Q_(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}function oA(n,e,t){let i=e[si],r=e[Ce];if(n.loadingState!==hi.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=ul(e,t),s=UV(r,n);n.loadingState=hi.IN_PROGRESS,Sf(1,o);let a=n.dependencyResolverFn,l=i.get(tu).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(u=>{let d=!1,h=[],p=[];for(let g of u)if(g.status==="fulfilled"){let w=g.value,S=Qr(w)||Zh(w);if(S)h.push(S);else{let P=ky(w);P&&p.push(P)}}else{d=!0;break}if(d){if(n.loadingState=hi.FAILED,n.errorTmplIndex===null){let w=new de(-750,!1);O_(e,w)}}else{n.loadingState=hi.COMPLETE;let g=s.tView;if(h.length>0){g.directiveRegistry=IT(g.directiveRegistry,h);let w=h.map(P=>P.type),S=of(!1,...w);n.providers=S}p.length>0&&(g.pipeRegistry=IT(g.pipeRegistry,p))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,l()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=hi.COMPLETE,l()}),n.loadingPromise)}function WV(n,e){return e[si].get(tA,null,{optional:!0})?.behavior!==z_.Manual}function qV(n,e,t){let i=e[Ce],r=e[t.index];if(!WV(n,e))return;let o=ul(e,t),s=bu(i,t);switch(OV(o),s.loadingState){case hi.NOT_STARTED:zs(cn.Loading,t,r),oA(s,e,t),s.loadingState===hi.IN_PROGRESS&&CT(s,t,r);break;case hi.IN_PROGRESS:zs(cn.Loading,t,r),CT(s,t,r);break;case hi.COMPLETE:zs(cn.Complete,t,r);break;case hi.FAILED:zs(cn.Error,t,r);break;default:}}async function sA(n,e,t){let i=n.get(Qf);if(i.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=zF(e,n);if(s.length===0)return;o!==null&&s.shift(),YV(i,s),o!==null&&await o;let a=s[0];i.has(a)?await DT(n,s,t):i.awaitParentBlock(a,async()=>await DT(n,s,t))}async function DT(n,e,t){let i=n.get(Qf),r=i.hydrating,o=n.get(vr),s=o.add();for(let l=0;l<e.length;l++){let u=e[l],d=i.get(u);if(d!=null){if(await ZV(d),await JV(n),KV(d)){I3(d),AT(e.slice(l),i);break}r.get(u).resolve()}else{QV(l,e,i),AT(e.slice(l),i);break}}let a=e[e.length-1];await r.get(a)?.promise,o.remove(s),t&&t(e),T3(i.get(a),e,i,n.get(Zn))}function KV(n){return ul(n.lView,n.tNode)[Eu]===cn.Error}function QV(n,e,t){let i=n-1,r=i>-1?t.get(e[i]):null;r&&dp(r.lContainer)}function AT(n,e){let t=e.hydrating;for(let i in n)t.get(i)?.reject();e.cleanup(n)}function YV(n,e){for(let t of e)n.hydrating.set(t,Q_())}function JV(n){return new Promise(e=>mu(e,{injector:n}))}async function ZV(n){let{tNode:e,lView:t}=n,i=ul(t,e);return new Promise(r=>{XV(i,r),qV(2,t,e)})}function XV(n,e){Array.isArray(n[Za])||(n[Za]=[]),n[Za].push(e)}function Ft(n,e,t,i){let r=Ve(),o=Gs();if(Ci(r,o,e)){let s=Xt(),a=hv();qL(a,r,n,e,t,i)}return Ft}var qee=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var e_=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function Av(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function e5(n,e,t,i){let r,o,s=0,a=n.length-1,l=void 0;if(Array.isArray(e)){Le(i);let u=e.length-1;for(Le(null);s<=a&&s<=u;){let d=n.at(s),h=e[s],p=Av(s,d,s,h,t);if(p!==0){p<0&&n.updateValue(s,h),s++;continue}let g=n.at(a),w=e[u],S=Av(a,g,u,w,t);if(S!==0){S<0&&n.updateValue(a,w),a--,u--;continue}let P=t(s,d),U=t(a,g),ie=t(s,h);if(Object.is(ie,U)){let Se=t(u,w);Object.is(Se,P)?(n.swap(s,a),n.updateValue(a,w),u--,a--):n.move(a,s),n.updateValue(s,h),s++;continue}if(r??=new $f,o??=RT(n,s,a,t),t_(n,r,s,ie))n.updateValue(s,h),s++,a++;else if(o.has(ie))r.set(P,n.detach(s)),a--;else{let Se=n.create(s,e[s]);n.attach(s,Se),s++,a++}}for(;s<=u;)MT(n,r,t,s,e[s]),s++}else if(e!=null){Le(i);let u=e[Symbol.iterator]();Le(null);let d=u.next();for(;!d.done&&s<=a;){let h=n.at(s),p=d.value,g=Av(s,h,s,p,t);if(g!==0)g<0&&n.updateValue(s,p),s++,d=u.next();else{r??=new $f,o??=RT(n,s,a,t);let w=t(s,p);if(t_(n,r,s,w))n.updateValue(s,p),s++,a++,d=u.next();else if(!o.has(w))n.attach(s,n.create(s,p)),s++,a++,d=u.next();else{let S=t(s,h);r.set(S,n.detach(s)),a--}}}for(;!d.done;)MT(n,r,t,n.length,d.value),d=u.next()}for(;s<=a;)n.destroy(n.detach(a--));r?.forEach(u=>{n.destroy(u)})}function t_(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function MT(n,e,t,i,r){if(t_(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function RT(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var $f=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function J(n,e,t,i,r,o,s,a){fi("NgControlFlow");let l=Ve(),u=Xt(),d=Ii(u.consts,o);return Hf(l,u,n,e,t,i,r,d,256,s,a),Y_}function Y_(n,e,t,i,r,o,s,a){fi("NgControlFlow");let l=Ve(),u=Xt(),d=Ii(u.consts,o);return Hf(l,u,n,e,t,i,r,d,512,s,a),Y_}function Z(n,e){fi("NgControlFlow");let t=Ve(),i=Gs(),r=t[i]!==vn?t[i]:-1,o=r!==-1?Gf(t,ct+r):void 0,s=0;if(Ci(t,i,n)){let a=Le(null);try{if(o!==void 0&&V_(o,s),n!==-1){let l=ct+n,u=Gf(t,l),d=o_(t[Ce],l),h=AD(u,d,t),p=yu(t,d,e,{dehydratedView:h});vu(u,p,s,tl(d,h))}}finally{Le(a)}}else if(o!==void 0){let a=wD(o,s);a!==void 0&&(a[Zt]=e)}}var n_=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-Bt}};function J_(n){return n}function Sr(n,e){return e}var i_=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function On(n,e,t,i,r,o,s,a,l,u,d,h,p){fi("NgControlFlow");let g=Ve(),w=Xt(),S=l!==void 0,P=Ve(),U=a?s.bind(P[qn][Zt]):s,ie=new i_(S,U);P[ct+n]=ie,Hf(g,w,n+1,e,t,i,r,Ii(w.consts,o),256),S&&Hf(g,w,n+2,l,u,d,h,Ii(w.consts,p),512)}var r_=class extends e_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-Bt}at(e){return this.getLView(e)[Zt].$implicit}attach(e,t){let i=t[Yn];this.needsIndexUpdate||=e!==this.length,vu(this.lContainer,t,e,tl(this.templateTNode,i)),t5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,n5(this.lContainer,e),i5(this.lContainer,e)}create(e,t){let i=Ff(this.lContainer,this.templateTNode.tView.ssrId);return yu(this.hostLView,this.templateTNode,new n_(this.lContainer,t,e),{dehydratedView:i})}destroy(e){ip(e[Ce],e)}updateValue(e,t){this.getLView(e)[Zt].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Zt].$index=e}getLView(e){return r5(this.lContainer,e)}};function Fn(n){let e=Le(null),t=Ti();try{let i=Ve(),r=i[Ce],o=i[t],s=t+1,a=Gf(i,s);if(o.liveCollection===void 0){let u=o_(r,s);o.liveCollection=new r_(a,i,u)}else o.liveCollection.reset();let l=o.liveCollection;if(e5(l,n,o.trackByFn,e),l.updateIndexes(),o.hasEmptyBlock){let u=Gs(),d=l.length===0;if(Ci(i,u,d)){let h=t+2,p=Gf(i,h);if(d){let g=o_(r,h),w=AD(p,g,i),S=yu(i,g,void 0,{dehydratedView:w});vu(p,S,0,tl(g,w))}else r.firstUpdatePass&&up(p),V_(p,0)}}}finally{Le(e)}}function Gf(n,e){return n[e]}function t5(n,e){if(n.length<=Bt)return;let t=Bt+e,i=n[t],r=i?i[Us]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[si];bL(o,r),Ks.delete(i[Yr]),r.detachedLeaveAnimationFns=void 0}}function n5(n,e){if(n.length<=Bt)return;let t=Bt+e,i=n[t],r=i?i[Us]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function i5(n,e){return lu(n,e)}function r5(n,e){return wD(n,e)}function o_(n,e){return Hs(n,e)}function Je(n,e,t){let i=Ve(),r=Gs();if(Ci(i,r,e)){let o=Xt(),s=hv();jL(s,i,n,e,i[xt],t)}return Je}function s_(n,e,t,i,r){F_(e,n,t,r?"class":"style",i)}function E(n,e,t,i){let r=Ve(),o=r[Ce],s=n+ct,a=o.firstCreatePass?OD(s,r,2,e,cD,Xy(),t,i):o.data[s];if(uD(a,r,n,e,Z_),Kc(a)){let l=r[Ce];k_(l,r,a),UC(l,a,r)}return i!=null&&op(r,a),E}function x(){let n=Xt(),e=kn(),t=dD(e);return n.firstCreatePass&&FD(n,t),tv(t)&&nv(),Zy(),t.classesWithoutHost!=null&&fF(t)&&s_(n,t,Ve(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&pF(t)&&s_(n,t,Ve(),t.stylesWithoutHost,!1),x}function W(n,e,t,i){return E(n,e,t,i),x(),W}function C(n,e,t,i){let r=Ve(),o=r[Ce],s=n+ct,a=o.firstCreatePass?j3(s,o,2,e,t,i):o.data[s];return uD(a,r,n,e,Z_),i!=null&&op(r,a),C}function A(){let n=kn(),e=dD(n);return tv(e)&&nv(),Zy(),A}function B(n,e,t,i){return C(n,e,t,i),A(),B}var Z_=(n,e,t,i,r)=>(Zr(!0),w_(e[xt],i,fv()));function o5(n,e,t,i,r){let o=!Zf(e,t);if(Zr(o),o)return w_(e[xt],i,fv());let s=e[Yn],a=lp(s,n,e,t);return OC(s,r)&&Jf(s,r,a.nextSibling),s&&(eC(t)||tC(a))&&Jr(t)&&(kI(t),GC(a)),a}function aA(){Z_=o5}var s5=(n,e,t,i,r)=>(Zr(!0),HC(e[xt],""));function a5(n,e,t,i,r){let o,s=!Zf(e,t);if(Zr(s),s)return HC(e[xt],"");let a=e[Yn],l=lp(a,n,e,t),u=$F(a,r);return Jf(a,r,l),o=cp(u,l),o}function lA(){s5=a5}function at(){return Ve()}var nu=void 0;function l5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var c5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],nu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],nu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",nu,nu,nu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",l5],Mv={};function pi(n){let e=u5(n),t=NT(e);if(t)return t;let i=e.split("-")[0];if(t=NT(i),t)return t;if(i==="en")return c5;throw new de(701,!1)}function NT(n){return n in Mv||(Mv[n]=ur.ng&&ur.ng.common&&ur.ng.common.locales&&ur.ng.common.locales[n]),Mv[n]}var en=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(en||{});function u5(n){return n.toLowerCase().replace(/_/g,"-")}var wu="en-US";var d5=wu;function cA(n){typeof n=="string"&&(d5=n.toLowerCase().replace(/_/g,"-"))}function ue(n,e,t){let i=Ve(),r=Xt(),o=kn();return h5(r,i,i[xt],o,n,e,t),ue}function Dt(n,e,t){let i=Ve(),r=Xt(),o=kn();return(o.type&3||t)&&UD(o,r,i,t,i[xt],n,e,xf(o,i,e)),Dt}function h5(n,e,t,i,r,o,s){let a=!0,l=null;if((i.type&3||s)&&(l??=xf(i,e,o),UD(i,n,e,s,t,r,o,l)&&(a=!1)),a){let u=i.outputs?.[r],d=i.hostDirectiveOutputs?.[r];if(d&&d.length)for(let h=0;h<d.length;h+=2){let p=d[h],g=d[h+1];l??=xf(i,e,o),_T(i,e,p,g,r,l)}if(u&&u.length)for(let h of u)l??=xf(i,e,o),_T(i,e,h,r,r,l)}}function O(n=1){return zI(n)}function mp(n,e,t){return hV(n,e,t),mp}function yp(n){let e=Ve(),t=Xt(),i=cv();uf(i+1);let r=G_(t,i);if(n.dirty&&CI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=gV(e,i);n.reset(o,CF),n.notifyOnChanges()}return!0}return!1}function vp(){return uV(Ve(),cv())}function xu(n){let e=ov();return Qc(e,ct+n)}function yf(n,e){return n<<17|e<<2}function Js(n){return n>>17&32767}function f5(n){return(n&2)==2}function p5(n,e){return n&131071|e<<17}function a_(n){return n|2}function il(n){return(n&131068)>>2}function Rv(n,e){return n&-131069|e<<2}function g5(n){return(n&1)===1}function l_(n){return n|1}function m5(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=Js(s),l=il(s);n[i]=t;let u=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||za(h,d)>0)&&(u=!0)}else d=t;if(r)if(l!==0){let p=Js(n[a+1]);n[i+1]=yf(p,a),p!==0&&(n[p+1]=Rv(n[p+1],i)),n[a+1]=p5(n[a+1],i)}else n[i+1]=yf(a,0),a!==0&&(n[a+1]=Rv(n[a+1],i)),a=i;else n[i+1]=yf(l,0),a===0?a=i:n[l+1]=Rv(n[l+1],i),l=i;u&&(n[i+1]=a_(n[i+1])),PT(n,d,i,!0),PT(n,d,i,!1),y5(e,d,n,i,o),s=yf(a,l),o?e.classBindings=s:e.styleBindings=s}function y5(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&za(o,e)>=0&&(t[i+1]=l_(t[i+1]))}function PT(n,e,t,i){let r=n[t+1],o=e===null,s=i?Js(r):il(r),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],u=n[s+1];v5(l,e)&&(a=!0,n[s+1]=i?l_(u):a_(u)),s=i?Js(u):il(u)}a&&(n[t+1]=i?a_(r):l_(r))}function v5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?za(n,e)>=0:!1}var $i={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function _5(n){return n.substring($i.key,$i.keyEnd)}function E5(n){return b5(n),uA(n,dA(n,0,$i.textEnd))}function uA(n,e){let t=$i.textEnd;return t===e?-1:(e=$i.keyEnd=w5(n,$i.key=e,t),dA(n,e,t))}function b5(n){$i.key=0,$i.keyEnd=0,$i.value=0,$i.valueEnd=0,$i.textEnd=n.length}function dA(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function w5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function nt(n,e,t){return hA(n,e,t,!1),nt}function Be(n,e){return hA(n,e,null,!0),Be}function X_(n){S5(M5,x5,n,!0)}function x5(n,e){for(let t=E5(e);t>=0;t=uA(e,t))nf(n,_5(e),!0)}function hA(n,e,t,i){let r=Ve(),o=Xt(),s=Xc(2);if(o.firstUpdatePass&&pA(o,n,s,i),e!==vn&&Ci(r,s,e)){let a=o.data[Ti()];gA(o,a,r,r[xt],n,r[s+1]=N5(e,t),i,s)}}function S5(n,e,t,i){let r=Xt(),o=Xc(2);r.firstUpdatePass&&pA(r,null,o,i);let s=Ve();if(t!==vn&&Ci(s,o,t)){let a=r.data[Ti()];if(mA(a,i)&&!fA(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=Yh(l,t||"")),s_(r,a,s,t,i)}else R5(r,a,s,s[xt],s[o+1],s[o+1]=A5(n,e,t),i,o)}}function fA(n,e){return e>=n.expandoStartIndex}function pA(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Ti()],s=fA(n,t);mA(o,i)&&e===null&&!s&&(e=!1),e=I5(r,o,e,i),m5(r,o,e,t,s,i)}}function I5(n,e,t,i){let r=jI(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Nv(null,n,e,t,i),t=uu(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Nv(r,n,e,t,i),o===null){let l=T5(n,e,i);l!==void 0&&Array.isArray(l)&&(l=Nv(null,n,e,l[1],i),l=uu(l,e.attrs,i),C5(n,e,i,l))}else o=D5(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function T5(n,e,t){let i=t?e.classBindings:e.styleBindings;if(il(i)!==0)return n[Js(i)]}function C5(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[Js(r)]=i}function D5(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=uu(i,s,t)}return uu(i,e.attrs,t)}function Nv(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=uu(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function uu(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),nf(n,s,t?!0:e[++o]))}return n===void 0?null:n}function A5(n,e,t){if(t==null||t==="")return Gn;let i=[],r=al(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(r instanceof Set)for(let o of r)n(i,o,!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function M5(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&nf(n,i,t)}function R5(n,e,t,i,r,o,s,a){r===vn&&(r=Gn);let l=0,u=0,d=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;d!==null||h!==null;){let p=l<r.length?r[l+1]:void 0,g=u<o.length?o[u+1]:void 0,w=null,S;d===h?(l+=2,u+=2,p!==g&&(w=h,S=g)):h===null||d!==null&&d<h?(l+=2,w=d):(u+=2,w=h,S=g),w!==null&&gA(n,e,t,i,w,S,s,a),d=l<r.length?r[l]:null,h=u<o.length?o[u]:null}}function gA(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let l=n.data,u=l[a+1],d=g5(u)?kT(l,e,t,r,il(u),s):void 0;if(!zf(d)){zf(o)||f5(u)&&(o=kT(l,null,t,r,a,s));let h=Wy(Ti(),t);FL(i,s,h,r,o)}}function kT(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let l=n[r],u=Array.isArray(l),d=u?l[1]:l,h=d===null,p=t[r+1];p===vn&&(p=h?Gn:void 0);let g=h?rf(p,i):d===i?p:void 0;if(u&&!zf(g)&&(g=rf(l,i)),zf(g)&&(a=g,s))return a;let w=n[r+1];r=s?Js(w):il(w)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=rf(l,i))}return a}function zf(n){return n!==void 0}function N5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=qr(al(n)))),n}function mA(n,e){return(n.flags&(e?8:16))!==0}function v(n,e=""){let t=Ve(),i=Xt(),r=n+ct,o=i.firstCreatePass?ll(i,r,1,e,null):i.data[r],s=yA(i,t,o,e,n);t[r]=s,ff()&&N_(i,t,s,o),$s(o,!1)}var yA=(n,e,t,i,r)=>(Zr(!0),jC(e[xt],i));function P5(n,e,t,i,r){let o=!Zf(e,t);if(Zr(o),o)return jC(e[xt],i);let s=e[Yn];return lp(s,n,e,t)}function vA(){yA=P5}function k5(n,e,t,i=""){return Ci(n,Gs(),t)?e+Bi(t)+i:vn}function O5(n,e,t,i,r,o=""){let s=lv(),a=H_(n,s,t,r);return Xc(2),a?e+Bi(t)+i+Bi(r)+o:vn}function F5(n,e,t,i,r,o,s,a=""){let l=lv(),u=$3(n,l,t,r,s);return Xc(3),u?e+Bi(t)+i+Bi(r)+o+Bi(s)+a:vn}function q(n){return X("",n),q}function X(n,e,t){let i=Ve(),r=k5(i,n,e,t);return r!==vn&&eE(i,Ti(),r),X}function Ln(n,e,t,i,r){let o=Ve(),s=O5(o,n,e,t,i,r);return s!==vn&&eE(o,Ti(),s),Ln}function dl(n,e,t,i,r,o,s){let a=Ve(),l=F5(a,n,e,t,i,r,o,s);return l!==vn&&eE(a,Ti(),l),dl}function eE(n,e,t){let i=Wy(e,n);ZF(n[xt],i,t)}var _A={};function _p(n){fi("NgLet");let e=Xt(),t=Ve(),i=n+ct,r=ll(e,i,128,null,null);return $s(r,!1),Yc(e,t,i,_A),_p}function tE(n){let e=Xt(),t=Ve(),i=Ti();return Yc(e,t,i,n),n}function Qo(n){let e=ov(),t=Qc(e,ct+n);if(t===_A)throw new de(314,!1);return t}function nE(n){return Ci(Ve(),Gs(),n)?Bi(n):vn}function OT(n,e,t){let i=Xt();i.firstCreatePass&&EA(e,i.data,i.blueprint,yr(n),t)}function EA(n,e,t,i,r){if(n=Dn(n),Array.isArray(n))for(let o=0;o<n.length;o++)EA(n[o],e,t,i,r);else{let o=Xt(),s=Ve(),a=kn(),l=Ps(n)?n:Dn(n.provide),u=jy(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(Ps(n)||!n.multi){let g=new qs(u,r,Ee,null),w=kv(l,e,r?d:d+p,h);w===-1?(Fv(Af(a,s),o,l),Pv(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)):(t[w]=g,s[w]=g)}else{let g=kv(l,e,d+p,h),w=kv(l,e,d,d+p),S=g>=0&&t[g],P=w>=0&&t[w];if(r&&!P||!r&&!S){Fv(Af(a,s),o,l);let U=U5(r?V5:L5,t.length,r,i,u,n);!r&&P&&(t[w].providerFactory=U),Pv(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(U),s.push(U)}else{let U=bA(t[r?w:g],u,!r&&i);Pv(o,n,g>-1?g:w,U)}!r&&i&&P&&t[w].componentProviders++}}}function Pv(n,e,t,i){let r=Ps(e),o=xI(e);if(r||o){let l=(o?Dn(e.useClass):e).prototype.ngOnDestroy;if(l){let u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let d=u.indexOf(t);d===-1?u.push(t,[i,l]):u[d+1].push(i,l)}else u.push(t,l)}}}function bA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function kv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function L5(n,e,t,i,r){return c_(this.multi,[])}function V5(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=ou(i,i[Ce],this.providerFactory.index,r);s=l.slice(0,a),c_(o,s);for(let u=a;u<l.length;u++)s.push(l[u])}else s=[],c_(o,s);return s}function c_(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function U5(n,e,t,i,r,o){let s=new qs(n,t,Ee,null);return s.multi=[],s.index=e,s.componentProviders=0,bA(s,r,i&&!t),s}function Su(n,e){return t=>{t.providersResolver=(i,r)=>OT(i,r?r(n):n,!1),e&&(t.viewProvidersResolver=(i,r)=>OT(i,r?r(e):e,!0))}}function ea(n,e){let t=Zc()+n,i=Ve();return i[t]===vn?j_(i,t,e()):H3(i,t)}function _t(n,e,t,i){return xA(Ve(),Zc(),n,e,t,i)}function wA(n,e){let t=n[e];return t===vn?void 0:t}function B5(n,e,t,i,r,o){let s=e+t;return Ci(n,s,r)?j_(n,s+1,o?i.call(o,r):i(r)):wA(n,s+1)}function xA(n,e,t,i,r,o,s){let a=e+t;return H_(n,a,r,o)?j_(n,a+2,s?i.call(s,r,o):i(r,o)):wA(n,a+2)}function ta(n,e){let t=Xt(),i,r=n+ct;t.firstCreatePass?(i=j5(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Fo(i.type,!0)),s,a=$n(Ee);try{let l=Df(!1),u=o();return Df(l),Yc(t,Ve(),r,u),u}finally{$n(a)}}function j5(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function iE(n,e,t){let i=n+ct,r=Ve(),o=Qc(r,i);return SA(r,i)?B5(r,Zc(),e,o.transform,t,o):o.transform(t)}function hl(n,e,t,i){let r=n+ct,o=Ve(),s=Qc(o,r);return SA(o,r)?xA(o,Zc(),e,s.transform,t,i,s):s.transform(t,i)}function SA(n,e){return n[Ce].data[e].pure}function rE(n,e){return ap(n,e)}var Wf=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},oE=(()=>{class n{compileModuleSync(t){return new jf(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=Py(t),o=QC(r.declarations).reduce((s,a)=>{let l=Qr(a);return l&&s.push(new nl(l)),s},[]);return new Wf(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var IA=(()=>{class n{applicationErrorHandler=$(di);appRef=$(Zn);taskService=$(vr);ngZone=$(An);zonelessEnabled=$(eu);tracing=$(Wo,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new pn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Bc):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&($(_v,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?QI:gv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Bc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.applicationErrorHandler(i)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function TA(){return[{provide:Vo,useExisting:IA},{provide:An,useClass:jc},{provide:eu,useValue:!0}]}function H5(){return typeof $localize<"u"&&$localize.locale||wu}var Iu=new ve("",{factory:()=>$(Iu,{optional:!0,skipSelf:!0})||H5()});function Xn(n,e){return gh(n,e?.equal)}var uE={JSACTION:"__jsaction",OWNER:"__owner"},MA={};function $5(n){return n[uE.JSACTION]}function CA(n,e){n[uE.JSACTION]=e}function G5(n){return MA[n]}function z5(n,e){MA[n]=e}var Pe={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},W5=[Pe.MOUSEENTER,Pe.MOUSELEAVE,"pointerenter","pointerleave"],Xee=[Pe.CLICK,Pe.DBLCLICK,Pe.FOCUSIN,Pe.FOCUSOUT,Pe.KEYDOWN,Pe.KEYUP,Pe.KEYPRESS,Pe.MOUSEOVER,Pe.MOUSEOUT,Pe.SUBMIT,Pe.TOUCHSTART,Pe.TOUCHEND,Pe.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],q5=[Pe.FOCUS,Pe.BLUR,Pe.ERROR,Pe.LOAD,Pe.TOGGLE],dE=n=>q5.indexOf(n)>=0;function K5(n){return n===Pe.MOUSEENTER?Pe.MOUSEOVER:n===Pe.MOUSELEAVE?Pe.MOUSEOUT:n===Pe.POINTERENTER?Pe.POINTEROVER:n===Pe.POINTERLEAVE?Pe.POINTEROUT:n}function Q5(n,e,t,i){let r=!1;dE(e)&&(r=!0);let o=typeof i=="boolean"?{capture:r,passive:i}:r;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:r,passive:i}}function Y5(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function J5(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var DA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function Z5(n){return n.which===2||n.which==null&&n.button===4}function X5(n){return DA&&n.metaKey||!DA&&n.ctrlKey||Z5(n)||n.shiftKey}function eU(n,e,t){let i=n.relatedTarget;return(n.type===Pe.MOUSEOVER&&e===Pe.MOUSEENTER||n.type===Pe.MOUSEOUT&&e===Pe.MOUSELEAVE||n.type===Pe.POINTEROVER&&e===Pe.POINTERENTER||n.type===Pe.POINTEROUT&&e===Pe.POINTERLEAVE)&&(!i||i!==t&&!t.contains(i))}function tU(n,e){let t={};for(let i in n){if(i==="srcElement"||i==="target")continue;let r=i,o=n[r];typeof o!="function"&&(t[r]=o)}return n.type===Pe.MOUSEOVER?t.type=Pe.MOUSEENTER:n.type===Pe.MOUSEOUT?t.type=Pe.MOUSELEAVE:n.type===Pe.POINTEROVER?t.type=Pe.POINTERENTER:t.type=Pe.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var nU=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),xp=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,i){nU&&(this.element.style.cursor="pointer"),this.handlerInfos.push(Q5(this.element,e,t(this.element),i))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)Y5(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},iU={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function Yo(n){return n.eventType}function hE(n,e){n.eventType=e}function bp(n){return n.event}function RA(n,e){n.event=e}function NA(n){return n.targetElement}function PA(n,e){n.targetElement=e}function kA(n){return n.eic}function rU(n,e){n.eic=e}function oU(n){return n.timeStamp}function sU(n,e){n.timeStamp=e}function wp(n){return n.eia}function OA(n,e,t){n.eia=[e,t]}function sE(n){n.eia=void 0}function Ep(n){return n[1]}function aU(n){return n.eirp}function FA(n,e){n.eirp=e}function LA(n){return n.eir}function VA(n,e){n.eir=e}function UA(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function lU(n,e,t,i,r,o,s,a){return{eventType:n,event:e,targetElement:t,eic:i,timeStamp:r,eia:o,eirp:s,eiack:a}}var aE=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return Yo(this.eventInfo)}setEventType(e){hE(this.eventInfo,e)}getEvent(){return bp(this.eventInfo)}setEvent(e){RA(this.eventInfo,e)}getTargetElement(){return NA(this.eventInfo)}setTargetElement(e){PA(this.eventInfo,e)}getContainer(){return kA(this.eventInfo)}setContainer(e){rU(this.eventInfo,e)}getTimestamp(){return oU(this.eventInfo)}setTimestamp(e){sU(this.eventInfo,e)}getAction(){let e=wp(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){sE(this.eventInfo);return}OA(this.eventInfo,e.name,e.element)}getIsReplay(){return aU(this.eventInfo)}setIsReplay(e){FA(this.eventInfo,e)}getResolved(){return LA(this.eventInfo)}setResolved(e){VA(this.eventInfo,e)}clone(){return new n(UA(this.eventInfo))}},cU={},uU=/\s*;\s*/,dU=Pe.CLICK,lE=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&Yo(e)===Pe.CLICK&&X5(bp(e))?hE(e,Pe.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){LA(e)||(this.populateAction(e,NA(e)),VA(e,!0))}resolveParentAction(e){let t=wp(e),i=t&&Ep(t);sE(e);let r=i&&this.getParentNode(i);r&&this.populateAction(e,r)}populateAction(e,t){let i=t;for(;i&&i!==kA(e)&&(i.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(i,e),!wp(e));)i=this.getParentNode(i);let r=wp(e);if(r&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(Yo(e)===Pe.MOUSEENTER||Yo(e)===Pe.MOUSELEAVE||Yo(e)===Pe.POINTERENTER||Yo(e)===Pe.POINTERLEAVE)))if(eU(bp(e),Yo(e),Ep(r))){let o=tU(bp(e),Ep(r));RA(e,o),PA(e,Ep(r))}else sE(e)}getParentNode(e){let t=e[uE.OWNER];if(t)return t;let i=e.parentNode;return i?.nodeName==="#document-fragment"?i?.host??null:i}populateActionOnElement(e,t){let i=this.parseActions(e),r=i[Yo(t)];r!==void 0&&OA(t,r,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,i)}parseActions(e){let t=$5(e);if(!t){let i=e.getAttribute(gf.JSACTION);if(!i)t=cU,CA(e,t);else{if(t=G5(i),!t){t={};let r=i.split(uU);for(let o=0;o<r.length;o++){let s=r[o];if(!s)continue;let a=s.indexOf(iU.EVENT_ACTION_SEPARATOR),l=a!==-1,u=l?s.substr(0,a).trim():dU,d=l?s.substr(a+1).trim():s;t[u]=d}z5(i,t)}CA(e,t)}}return t}addA11yClickSupport(e,t,i){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=i}},BA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(BA||{}),cE=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:i}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=i}dispatch(e){let t=new aE(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let i=t.getAction();if(i&&hU(i.element,t)&&J5(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function hU(n,e){return n.tagName==="A"&&(e.getEventType()===Pe.CLICK||e.getEventType()===Pe.CLICKMOD)}var jA=Symbol.for("propagationStopped"),fE={REPLAY:101};var fU="`preventDefault` called during event replay.";var pU="`composedPath` called during event replay.",Sp=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new lE({clickModSupport:t}),this.dispatcher=new cE(i=>{this.dispatchToDelegate(i)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&yU(e),gU(e);e.getAction();){if(vU(e),dE(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),mU(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function gU(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),i=()=>{e[jA]=!0,t()};na(e,"stopPropagation",i),na(e,"stopImmediatePropagation",i)}function mU(n){return!!n.getEvent()[jA]}function yU(n){let e=n.getEvent(),t=n.getTargetElement(),i=e.preventDefault.bind(e);na(e,"target",t),na(e,"eventPhase",fE.REPLAY),na(e,"preventDefault",()=>{throw i(),new Error(fU+"")}),na(e,"composedPath",()=>{throw new Error(pU+"")})}function vU(n){let e=n.getEvent(),t=n.getAction()?.element;t&&na(e,"currentTarget",t,{configurable:!0})}function na(n,e,t,{configurable:i=!1}={}){Object.defineProperty(n,e,{value:t,configurable:i})}function HA(n,e){n.ecrd(t=>{e.dispatch(t)},BA.I_AM_THE_JSACTION_FRAMEWORK)}function _U(n){return n?.q??[]}function EU(n){n&&(AA(n.c,n.et,n.h),AA(n.c,n.etc,n.h,!0))}function AA(n,e,t,i){for(let r=0;r<e.length;r++)n.removeEventListener(e[r],t,i)}var bU=!1,$A=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=bU;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,i,r){let o=lU(t,i,i.target,r,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){FA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,i,r){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&W5.indexOf(t)>=0)return;let o=(a,l,u)=>{this.handleEvent(a,l,u)};this.eventHandlers[t]=o;let s=K5(i||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>l=>{o(t,l,a)},r)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),EU(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let i=0;i<t.length;i++){let r=t[i],o=this.getEventTypesForBrowserEventType(r.eventType);for(let s=0;s<o.length;s++){let a=UA(r);hE(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let i=[];return this.eventHandlers[t]&&i.push(t),this.browserEventTypeToExtraEventTypes[t]&&i.push(...this.browserEventTypeToExtraEventTypes[t]),i}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,i){this.ecrd(t,i)}ecrd(t,i){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let r=0;r<this.queuedEventInfos.length;r++)this.handleEventInfo(this.queuedEventInfos[r]);this.queuedEventInfos=null}}}return n})();function GA(n,e=window){return _U(e._ejsas?.[n])}function pE(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var eM=Symbol("InputSignalNode#UNSET"),QU=me(L({},mh),{transformFn:void 0,applyValueToInputSignal(n,e){Mc(n,e)}});function tM(n,e){let t=Object.create(QU);t.value=n,t.transformFn=e?.transform;function i(){if(Cc(t),t.value===eM){let r=null;throw new de(-950,r)}return t.value}return i[Kn]=t,i}var Cp=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>hu(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function zA(n,e){return tM(n,e)}function YU(n){return tM(eM,n)}var nM=(zA.required=YU,zA);var gE=new ve(""),JU=new ve("");function Tu(n){return!n.moduleRef}function ZU(n){let e=Tu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(An);return t.run(()=>{Tu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(di),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Tu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(gE);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(gE);s.add(o),n.moduleRef.onDestroy(()=>{ru(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return eB(i,t,()=>{let o=e.get(vr),s=o.add(),a=e.get(K_);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(Iu,wu);if(cA(l||wu),!e.get(JU,!0))return Tu(n)?e.get(Zn):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Tu(n)){let d=e.get(Zn);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return XU?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var XU;function eB(n,e,t){try{let i=t();return qo(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Tp=null;function tB(n=[],e){return zn.create({name:e,providers:[{provide:Gc,useValue:"platform"},{provide:gE,useValue:new Set([()=>Tp=null])},...n]})}function nB(n=[]){if(Tp)return Tp;let e=tB(n);return Tp=e,iA(),iB(e),e}function iB(n){let e=n.get(qf,null);Mn(n,()=>{e?.forEach(t=>t())})}function iM(){return!1}var Ip=new WeakSet,WA="";function qA(n){return n.get(m_,vC)}function rM(){let n=[{provide:m_,useFactory:()=>{let e=!0;{let t=$(br);e=!!window._ejsas?.[t]}return e&&fi("NgEventReplay"),e}}];return n.push({provide:hr,useValue:()=>{let e=$(Zn),{injector:t}=e;if(!Ip.has(e)){let i=$(y_);if(qA(t)){CC();let r=t.get(br),o=IC(r,(s,a,l)=>{s.nodeType===Node.ELEMENT_NODE&&(bC(s,a,l),wC(s,i))});e.onDestroy(o)}}},multi:!0},{provide:Ko,useFactory:()=>{let e=$(Zn),{injector:t}=e;return()=>{if(!qA(t)||Ip.has(e))return;Ip.add(e);let i=t.get(br);e.onDestroy(()=>{Ip.delete(e),pE(i)}),e.whenStable().then(()=>{if(e.destroyed)return;let r=t.get(SC);rB(r,t);let o=t.get(y_);o.get(WA)?.forEach(xC),o.delete(WA);let s=r.instance;kC(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var rB=(n,e)=>{let t=e.get(br),i=window._ejsas[t],r=n.instance=new $A(new xp(i.c));for(let a of i.et)r.addEvent(a);for(let a of i.etc)r.addEvent(a);let o=GA(t);r.replayEarlyEventInfos(o),pE(t);let s=new Sp(a=>{oB(e,a,a.currentTarget)});HA(r,s)};function oB(n,e,t){let i=(t&&t.getAttribute(pu))??"";/d\d+/.test(i)?sB(i,n,e,t):e.eventPhase===fE.REPLAY&&v_(e,t)}function sB(n,e,t,i){let r=e.get(_C);r.push({event:t,currentTarget:i}),sA(e,n,aB(r))}function aB(n){return e=>{let t=new Set(e),i=[];for(let{event:r,currentTarget:o}of n){let s=o.getAttribute(pu);t.has(s)?v_(r,o):i.push({event:r,currentTarget:o})}n.length=0,n.push(...i)}}var KA=!1;var lB=1e4;function cB(){KA||(KA=!0,RC(),aA(),vA(),lA(),XD(),WD(),DD(),lD())}function uB(n){return n.whenStable()}function oM(){let n=[{provide:fu,useFactory:()=>{let e=!0;return e=!!$(sl,{optional:!0})?.get(__,null),e&&fi("NgHydration"),e}},{provide:hr,useValue:()=>{SD(!1);let e=$(Wt);$(fu)&&(LC(e),cB())},multi:!0}];return n.push({provide:g_,useFactory:()=>$(fu)},{provide:Ko,useFactory:()=>{if($(fu)){let e=$(Zn);return()=>{uB(e).then(()=>{e.destroyed||U_(e)})}}return()=>{}},multi:!0}),fr(n)}var Loe=lB-1e3;var Cu=(()=>{class n{static __NG_ELEMENT_ID__=dB}return n})();function dB(n){return hB(kn(),Ve(),(n&16)===16)}function hB(n,e,t){if(Jr(n)&&!t){let i=Si(n.index,e);return new Go(i,i)}else if(n.type&175){let i=e[qn];return new Go(i,e)}return null}var mE=class{constructor(){}supports(e){return B_(e)}create(e){return new yE(e)}},fB=(n,e)=>e,yE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||fB}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<QA(i,r,o)?t:i,a=QA(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let u=a-r,d=l-r;if(u!=d){for(let p=0;p<u;p++){let g=p<o.length?o[p]:o[p]=0,w=g+p;d<=w&&w<u&&(o[p]=g+1)}let h=s.previousIndex;o[h]=d-u}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!B_(e))throw new de(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,LD(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new vE(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Dp),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Dp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},vE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},_E=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},Dp=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new _E,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function QA(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function YA(){return new EE([new mE])}var EE=(()=>{class n{factories;static \u0275prov=le({token:n,providedIn:"root",factory:YA});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=$(n,{optional:!0,skipSelf:!0});return n.create(t,i||YA())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new de(901,!1)}}return n})();function sM(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;pt(ot.BootstrapApplicationStart);try{let o=r?.injector??nB(i),s=[TA(),JI,...t||[]],a=new cu({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return ZU({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{pt(ot.BootstrapApplicationEnd)}}function Du(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var aM=null;function Di(){return aM}function bE(n){aM??=n}var Au=class{},Ap=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>$(lM),providedIn:"platform"})}return n})();var lM=(()=>{class n extends Ap{_location;_history;_doc=$(Wt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Di().getBaseHref(this._doc)}onPopState(t){let i=Di().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Di().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function dM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function cM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Jo(n){return n&&n[0]!=="?"?`?${n}`:n}var fl=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>$(gB),providedIn:"root"})}return n})(),pB=new ve(""),gB=(()=>{class n extends fl{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??$(Wt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return dM(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+Jo(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+Jo(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+Jo(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Re(Ap),Re(pB,8))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pl=(()=>{class n{_subject=new Gt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=vB(cM(uM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Jo(i))}normalize(t){return n.stripTrailingSlash(yB(this._basePath,uM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Jo(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Jo(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=Jo;static joinWithSlash=dM;static stripTrailingSlash=cM;static \u0275fac=function(i){return new(i||n)(Re(fl))};static \u0275prov=le({token:n,factory:()=>mB(),providedIn:"root"})}return n})();function mB(){return new pl(Re(fl))}function yB(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function uM(n){return n.replace(/\/index.html$/,"")}function vB(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Vn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Vn||{}),St=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(St||{}),ei=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(ei||{}),io={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function gM(n){return pi(n)[en.LocaleId]}function mM(n,e,t){let i=pi(n),r=[i[en.DayPeriodsFormat],i[en.DayPeriodsStandalone]],o=Ai(r,e);return Ai(o,t)}function yM(n,e,t){let i=pi(n),r=[i[en.DaysFormat],i[en.DaysStandalone]],o=Ai(r,e);return Ai(o,t)}function vM(n,e,t){let i=pi(n),r=[i[en.MonthsFormat],i[en.MonthsStandalone]],o=Ai(r,e);return Ai(o,t)}function _M(n,e){let i=pi(n)[en.Eras];return Ai(i,e)}function Mu(n,e){let t=pi(n);return Ai(t[en.DateFormat],e)}function Ru(n,e){let t=pi(n);return Ai(t[en.TimeFormat],e)}function Nu(n,e){let i=pi(n)[en.DateTimeFormat];return Ai(i,e)}function Pu(n,e){let t=pi(n),i=t[en.NumberSymbols][e];if(typeof i>"u"){if(e===io.CurrencyDecimal)return t[en.NumberSymbols][io.Decimal];if(e===io.CurrencyGroup)return t[en.NumberSymbols][io.Group]}return i}function EM(n){if(!n[en.ExtraData])throw new de(2303,!1)}function bM(n){let e=pi(n);return EM(e),(e[en.ExtraData][2]||[]).map(i=>typeof i=="string"?wE(i):[wE(i[0]),wE(i[1])])}function wM(n,e,t){let i=pi(n);EM(i);let r=[i[en.ExtraData][0],i[en.ExtraData][1]],o=Ai(r,e)||[];return Ai(o,t)||[]}function Ai(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new de(2304,!1)}function wE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var _B=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Mp={},EB=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function xM(n,e,t,i){let r=AB(n);e=no(t,e)||e;let s=[],a;for(;e;)if(a=EB.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let l=r.getTimezoneOffset();i&&(l=IM(i,l),r=DB(r,i));let u="";return s.forEach(d=>{let h=TB(d);u+=h?h(r,t,l):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function Op(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function no(n,e){let t=gM(n);if(Mp[t]??={},Mp[t][e])return Mp[t][e];let i="";switch(e){case"shortDate":i=Mu(n,ei.Short);break;case"mediumDate":i=Mu(n,ei.Medium);break;case"longDate":i=Mu(n,ei.Long);break;case"fullDate":i=Mu(n,ei.Full);break;case"shortTime":i=Ru(n,ei.Short);break;case"mediumTime":i=Ru(n,ei.Medium);break;case"longTime":i=Ru(n,ei.Long);break;case"fullTime":i=Ru(n,ei.Full);break;case"short":let r=no(n,"shortTime"),o=no(n,"shortDate");i=Rp(Nu(n,ei.Short),[r,o]);break;case"medium":let s=no(n,"mediumTime"),a=no(n,"mediumDate");i=Rp(Nu(n,ei.Medium),[s,a]);break;case"long":let l=no(n,"longTime"),u=no(n,"longDate");i=Rp(Nu(n,ei.Long),[l,u]);break;case"full":let d=no(n,"fullTime"),h=no(n,"fullDate");i=Rp(Nu(n,ei.Full),[d,h]);break}return i&&(Mp[t][e]=i),i}function Rp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function Qi(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function bB(n,e){return Qi(n,3).substring(0,e)}function un(n,e,t=0,i=!1,r=!1){return function(o,s){let a=wB(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return bB(a,e);let l=Pu(s,io.MinusSign);return Qi(a,e,l,i,r)}}function wB(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new de(2301,!1)}}function At(n,e,t=Vn.Format,i=!1){return function(r,o){return xB(r,o,n,e,t,i)}}function xB(n,e,t,i,r,o){switch(t){case 2:return vM(e,r,i)[n.getMonth()];case 1:return yM(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let u=bM(e),d=wM(e,r,i),h=u.findIndex(p=>{if(Array.isArray(p)){let[g,w]=p,S=s>=g.hours&&a>=g.minutes,P=s<w.hours||s===w.hours&&a<w.minutes;if(g.hours<w.hours){if(S&&P)return!0}else if(S||P)return!0}else if(p.hours===s&&p.minutes===a)return!0;return!1});if(h!==-1)return d[h]}return mM(e,r,i)[s<12?0:1];case 3:return _M(e,i)[n.getFullYear()<=0?0:1];default:let l=t;throw new de(2302,!1)}}function Np(n){return function(e,t,i){let r=-1*i,o=Pu(t,io.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Qi(s,2,o)+Qi(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+Qi(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+Qi(s,2,o)+":"+Qi(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+Qi(s,2,o)+":"+Qi(Math.abs(r%60),2,o);default:throw new de(2310,!1)}}}var SB=0,kp=4;function IB(n){let e=Op(n,SB,1).getDay();return Op(n,0,1+(e<=kp?kp:kp+7)-e)}function SM(n){let e=n.getDay(),t=e===0?-3:kp-e;return Op(n.getFullYear(),n.getMonth(),n.getDate()+t)}function xE(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=SM(t),s=IB(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Qi(r,n,Pu(i,io.MinusSign))}}function Pp(n,e=!1){return function(t,i){let o=SM(t).getFullYear();return Qi(o,n,Pu(i,io.MinusSign),e)}}var SE={};function TB(n){if(SE[n])return SE[n];let e;switch(n){case"G":case"GG":case"GGG":e=At(3,St.Abbreviated);break;case"GGGG":e=At(3,St.Wide);break;case"GGGGG":e=At(3,St.Narrow);break;case"y":e=un(0,1,0,!1,!0);break;case"yy":e=un(0,2,0,!0,!0);break;case"yyy":e=un(0,3,0,!1,!0);break;case"yyyy":e=un(0,4,0,!1,!0);break;case"Y":e=Pp(1);break;case"YY":e=Pp(2,!0);break;case"YYY":e=Pp(3);break;case"YYYY":e=Pp(4);break;case"M":case"L":e=un(1,1,1);break;case"MM":case"LL":e=un(1,2,1);break;case"MMM":e=At(2,St.Abbreviated);break;case"MMMM":e=At(2,St.Wide);break;case"MMMMM":e=At(2,St.Narrow);break;case"LLL":e=At(2,St.Abbreviated,Vn.Standalone);break;case"LLLL":e=At(2,St.Wide,Vn.Standalone);break;case"LLLLL":e=At(2,St.Narrow,Vn.Standalone);break;case"w":e=xE(1);break;case"ww":e=xE(2);break;case"W":e=xE(1,!0);break;case"d":e=un(2,1);break;case"dd":e=un(2,2);break;case"c":case"cc":e=un(7,1);break;case"ccc":e=At(1,St.Abbreviated,Vn.Standalone);break;case"cccc":e=At(1,St.Wide,Vn.Standalone);break;case"ccccc":e=At(1,St.Narrow,Vn.Standalone);break;case"cccccc":e=At(1,St.Short,Vn.Standalone);break;case"E":case"EE":case"EEE":e=At(1,St.Abbreviated);break;case"EEEE":e=At(1,St.Wide);break;case"EEEEE":e=At(1,St.Narrow);break;case"EEEEEE":e=At(1,St.Short);break;case"a":case"aa":case"aaa":e=At(0,St.Abbreviated);break;case"aaaa":e=At(0,St.Wide);break;case"aaaaa":e=At(0,St.Narrow);break;case"b":case"bb":case"bbb":e=At(0,St.Abbreviated,Vn.Standalone,!0);break;case"bbbb":e=At(0,St.Wide,Vn.Standalone,!0);break;case"bbbbb":e=At(0,St.Narrow,Vn.Standalone,!0);break;case"B":case"BB":case"BBB":e=At(0,St.Abbreviated,Vn.Format,!0);break;case"BBBB":e=At(0,St.Wide,Vn.Format,!0);break;case"BBBBB":e=At(0,St.Narrow,Vn.Format,!0);break;case"h":e=un(3,1,-12);break;case"hh":e=un(3,2,-12);break;case"H":e=un(3,1);break;case"HH":e=un(3,2);break;case"m":e=un(4,1);break;case"mm":e=un(4,2);break;case"s":e=un(5,1);break;case"ss":e=un(5,2);break;case"S":e=un(6,1);break;case"SS":e=un(6,2);break;case"SSS":e=un(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Np(0);break;case"ZZZZZ":e=Np(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Np(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Np(2);break;default:return null}return SE[n]=e,e}function IM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function CB(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function DB(n,e,t){let r=n.getTimezoneOffset(),o=IM(e,r);return CB(n,-1*(o-r))}function AB(n){if(hM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return Op(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(_B))return MB(i)}let e=new Date(n);if(!hM(e))throw new de(2311,!1);return e}function MB(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,u),e}function hM(n){return n instanceof Date&&!isNaN(n.valueOf())}var Fp=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Vp=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Fp(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),fM(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);fM(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(Ee(eo),Ee(zo),Ee(EE))};static \u0275dir=_n({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function fM(n,e){n.context.$implicit=e.item}var IE=(()=>{class n{_viewContainer;_context=new Lp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){pM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){pM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(Ee(eo),Ee(zo))};static \u0275dir=_n({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Lp=class{$implicit=null;ngIf=null};function pM(n,e){if(n&&!n.createEmbeddedView)throw new de(2020,!1)}function TM(n,e){return new de(2100,!1)}var RB=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,TE=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw TM(n,t);return t.replace(RB,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=pp({name:"titlecase",type:n,pure:!0})}return n})();var NB="mediumDate",CM=new ve(""),DM=new ve(""),ku=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??NB,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return xM(t,s,o||this.locale,a)}catch(s){throw TM(n,s.message)}}static \u0275fac=function(i){return new(i||n)(Ee(Iu,16),Ee(CM,24),Ee(DM,24))};static \u0275pipe=pp({name:"date",type:n,pure:!0})}return n})();var qt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=to({type:n});static \u0275inj=dr({})}return n})();function CE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Ou=class{};var DE="browser";function Zo(n){return n===DE}var Fu=class{_doc;constructor(e){this._doc=e}manager},Up=(()=>{class n extends Fu{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(Re(Wt))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),Hp=new ve(""),PE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof Up));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof Up);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new de(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Re(Hp),Re(An))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),ME="ng-app-id";function AM(n){for(let e of n)e.remove()}function MM(n,e){let t=e.createElement("style");return t.textContent=n,t}function PB(n,e,t,i){let r=n.head?.querySelectorAll(`style[${ME}="${e}"],link[${ME}="${e}"]`);if(r)for(let o of r)o.removeAttribute(ME),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function NE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var kE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,PB(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,MM);i?.forEach(r=>this.addUsage(r,this.external,NE))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(AM(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])AM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,MM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,NE(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Re(Wt),Re(br),Re(ol,8),Re(Wi))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),RE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},OE=/%COMP%/g;var NM="%COMP%",kB=`_nghost-${NM}`,OB=`_ngcontent-${NM}`,FB=!0,LB=new ve("",{factory:()=>FB});function VB(n){return OB.replace(OE,n)}function UB(n){return kB.replace(OE,n)}function PM(n,e){return e.map(t=>t.replace(OE,n))}var FE=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,r,o,s,a,l=null,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=u,this.defaultRenderer=new Lu(t,s,a,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof jp?r.applyToHost(t):r instanceof Vu&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.tracingService;switch(i.encapsulation){case Gi.Emulated:o=new jp(l,u,i,this.appId,d,s,a,h);break;case Gi.ShadowDom:return new Bp(l,t,i,s,a,this.nonce,h,u);case Gi.ExperimentalIsolatedShadowDom:return new Bp(l,t,i,s,a,this.nonce,h);default:o=new Vu(l,u,i,d,s,a,h);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Re(PE),Re(kE),Re(br),Re(LB),Re(Wt),Re(An),Re(ol),Re(Wo,8))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),Lu=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(RE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(RM(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(RM(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new de(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=RE[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=RE[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Er.DashCase|Er.Important)?e.style.setProperty(t,i,r&Er.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Er.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Di().getGlobalEventTarget(this.doc,e),!e))throw new de(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function RM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Bp=class extends Lu{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let u=i.styles;u=PM(i.id,u);for(let h of u){let p=document.createElement("style");s&&p.setAttribute("nonce",s),p.textContent=h,this.shadowRoot.appendChild(p)}let d=i.getExternalStyles?.();if(d)for(let h of d){let p=NE(h,r);s&&p.setAttribute("nonce",s),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Vu=class extends Lu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let u=i.styles;this.styles=l?PM(l,u):u,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Ks.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},jp=class extends Vu{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l){let u=r+"-"+i.id;super(e,t,i,o,s,a,l,u),this.contentAttr=VB(u),this.hostAttr=UB(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var $p=class n extends Au{supportsDOMEvents=!0;static makeCurrent(){bE(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=BB();return t==null?null:jB(t)}resetBaseElement(){Uu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return CE(document.cookie,e)}},Uu=null;function BB(){return Uu=Uu||document.head.querySelector("base"),Uu?Uu.getAttribute("href"):null}function jB(n){return new URL(n,document.baseURI).pathname}var HB=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),kM=["alt","control","meta","shift"],$B={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},GB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},OM=(()=>{class n extends Fu{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Di().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),kM.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),s+=u+".")}),s+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=$B[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),kM.forEach(s=>{if(s!==r){let a=GB[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(Re(Wt))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})();async function LE(n,e,t){let i=L({rootComponent:n},zB(e,t));return sM(i)}function zB(n,e){return{platformRef:e?.platformRef,appProviders:[...YB,...n?.providers??[]],platformProviders:QB}}function WB(){$p.makeCurrent()}function qB(){return new cr}function KB(){return h_(document),document}var QB=[{provide:Wi,useValue:DE},{provide:qf,useValue:WB,multi:!0},{provide:Wt,useFactory:KB}];var YB=[{provide:Gc,useValue:"root"},{provide:cr,useFactory:qB},{provide:Hp,useClass:Up,multi:!0},{provide:Hp,useClass:OM,multi:!0},FE,kE,PE,{provide:Qs,useExisting:FE},{provide:Ou,useClass:HB},[]];var Bu=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var JB="text/plain",ZB="application/json",Dae=`${ZB}, ${JB}, */*`;var UE=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(UE||{}),VE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new Bu,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var Gp=class n extends VE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=UE.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var FM=new ve("");var XB=new ve(""),e6="b",t6="h",n6="s",i6="st",r6="u",o6="rt",BE=new ve(""),s6=["GET","HEAD"];function a6(n,e){let g=$(BE),{isCacheActive:t}=g,i=Oa(g,["isCacheActive"]),{transferCache:r,method:o}=n;if(!t||r===!1||o==="POST"&&!i.includePostRequests&&!r||o!=="POST"&&!s6.includes(o)||!i.includeRequestsWithAuthHeaders&&l6(n)||i.filter?.(n)===!1)return e(n);let s=$(sl);if($(XB,{optional:!0}))throw new de(2803,!1);let l=n.url,u=c6(n,l),d=s.get(u,null),h=i.includeHeaders;if(typeof r=="object"&&r.includeHeaders&&(h=r.includeHeaders),d){let{[e6]:w,[o6]:S,[t6]:P,[n6]:U,[i6]:ie,[r6]:Se}=d,xe=w;switch(S){case"arraybuffer":xe=new TextEncoder().encode(w).buffer;break;case"blob":xe=new Blob([w]);break}let De=new Bu(P);return tt(new Gp({body:xe,headers:De,status:U,statusText:ie,url:Se}))}return e(n)}function l6(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function LM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function c6(n,e){let{params:t,method:i,responseType:r}=n,o=LM(t),s=n.serializeBody();s instanceof URLSearchParams?s=LM(s):typeof s!="string"&&(s="");let a=[i,r,e,s,o].join("|"),l=u6(a);return l}function u6(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function VM(n){return[{provide:BE,useFactory:()=>(fi("NgHttpTransferCache"),L({isCacheActive:!0},n))},{provide:FM,useValue:a6,multi:!0},{provide:Ko,multi:!0,useFactory:()=>{let e=$(Zn),t=$(BE);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var UM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Re(Wt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var zp=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(zp||{});function d6(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function BM(){return d6(zp.EventReplay,rM())}function jM(...n){let e=[],t=new Set;for(let{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);let i=t.has(zp.HttpTransferCacheOptions);return fr([[],[],oM(),t.has(zp.NoHttpTransferCache)||i?[]:VM({}),e])}var $e="primary",Zu=Symbol("RouteTitle"),zE=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function oa(n){return new zE(n)}function jE(n,e,t){for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function JM(n,e,t){let i=t.path.split("/"),r=i.indexOf("**");if(r===-1){if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let l={},u=n.slice(0,i.length);return jE(i,u,l)?{consumed:u,posParams:l}:null}if(r!==i.lastIndexOf("**"))return null;let o=i.slice(0,r),s=i.slice(r+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!jE(o,n.slice(0,o.length),a)||!jE(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function Jp(n){return new Promise((e,t)=>{n.pipe(Gr()).subscribe({next:i=>e(i),error:i=>t(i)})})}function f6(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ir(n[t],e[t]))return!1;return!0}function Ir(n,e){let t=n?WE(n):void 0,i=e?WE(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!ZM(n[r],e[r]))return!1;return!0}function WE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function ZM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function p6(n){return n.length>0?n[n.length-1]:null}function la(n){return Vh(n)?n:qo(n)?sn(Promise.resolve(n)):tt(n)}function XM(n){return Vh(n)?Jp(n):Promise.resolve(n)}var g6={exact:tR,subset:nR},eR={exact:m6,subset:y6,ignored:()=>!0};function HM(n,e,t){return g6[t.paths](n.root,e.root,t.matrixParams)&&eR[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function m6(n,e){return Ir(n,e)}function tR(n,e,t){if(!ia(n.segments,e.segments)||!Kp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!tR(n.children[i],e.children[i],t))return!1;return!0}function y6(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>ZM(n[t],e[t]))}function nR(n,e,t){return iR(n,e,e.segments,t)}function iR(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!ia(r,t)||e.hasChildren()||!Kp(r,t,i))}else if(n.segments.length===t.length){if(!ia(n.segments,t)||!Kp(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!nR(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!ia(n.segments,r)||!Kp(n.segments,r,i)||!n.children[$e]?!1:iR(n.children[$e],e,o,i)}}function Kp(n,e,t){return e.every((i,r)=>eR[t](n[r].parameters,i.parameters))}var Ji=class{root;queryParams;fragment;_queryParamMap;constructor(e=new gt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=oa(this.queryParams),this._queryParamMap}toString(){return E6.serialize(this)}},gt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Qp(this)}},Xo=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=oa(this.parameters),this._parameterMap}toString(){return oR(this)}};function v6(n,e){return ia(n,e)&&n.every((t,i)=>Ir(t.parameters,e[i].parameters))}function ia(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function _6(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===$e&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==$e&&(t=t.concat(e(r,i)))}),t}var Xu=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>new es,providedIn:"root"})}return n})(),es=class{parse(e){let t=new KE(e);return new Ji(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ju(e.root,!0)}`,i=x6(e.queryParams),r=typeof e.fragment=="string"?`#${b6(e.fragment)}`:"";return`${t}${i}${r}`}},E6=new es;function Qp(n){return n.segments.map(e=>oR(e)).join("/")}function ju(n,e){if(!n.hasChildren())return Qp(n);if(e){let t=n.children[$e]?ju(n.children[$e],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==$e&&i.push(`${r}:${ju(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=_6(n,(i,r)=>r===$e?[ju(n.children[$e],!1)]:[`${r}:${ju(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[$e]!=null?`${Qp(n)}/${t[0]}`:`${Qp(n)}/(${t.join("//")})`}}function rR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Wp(n){return rR(n).replace(/%3B/gi,";")}function b6(n){return encodeURI(n)}function qE(n){return rR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Yp(n){return decodeURIComponent(n)}function $M(n){return Yp(n.replace(/\+/g,"%20"))}function oR(n){return`${qE(n.path)}${w6(n.parameters)}`}function w6(n){return Object.entries(n).map(([e,t])=>`;${qE(e)}=${qE(t)}`).join("")}function x6(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Wp(t)}=${Wp(r)}`).join("&"):`${Wp(t)}=${Wp(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var S6=/^[^\/()?;#]+/;function HE(n){let e=n.match(S6);return e?e[0]:""}var I6=/^[^\/()?;=#]+/;function T6(n){let e=n.match(I6);return e?e[0]:""}var C6=/^[^=?&#]+/;function D6(n){let e=n.match(C6);return e?e[0]:""}var A6=/^[^&#]+/;function M6(n){let e=n.match(A6);return e?e[0]:""}var KE=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new gt([],{}):new gt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[$e]=new gt(e,t)),i}parseSegment(){let e=HE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new de(4009,!1);return this.capture(e),new Xo(Yp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=T6(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=HE(this.remaining);r&&(i=r,this.capture(i))}e[Yp(t)]=Yp(i)}parseQueryParam(e){let t=D6(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=M6(this.remaining);s&&(i=s,this.capture(i))}let r=$M(t),o=$M(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=HE(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new de(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=$e);let s=this.parseChildren();t[o??$e]=Object.keys(s).length===1&&s[$e]?s[$e]:new gt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new de(4011,!1)}};function sR(n){return n.segments.length>0?new gt([],{[$e]:n}):n}function aR(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=aR(r);if(i===$e&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new gt(n.segments,e);return R6(t)}function R6(n){if(n.numberOfChildren===1&&n.children[$e]){let e=n.children[$e];return new gt(n.segments.concat(e.segments),e.children)}return n}function ts(n){return n instanceof Ji}function lR(n,e,t=null,i=null,r=new es){let o=cR(n);return uR(o,e,t,i,r)}function cR(n){let e;function t(o){let s={};for(let l of o.children){let u=t(l);s[l.outlet]=u}let a=new gt(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=sR(i);return e??r}function uR(n,e,t,i,r){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return $E(o,o,o,t,i,r);let s=N6(e);if(s.toRoot())return $E(o,o,new gt([],{}),t,i,r);let a=P6(s,o,n),l=a.processChildren?$u(a.segmentGroup,a.index,s.commands):hR(a.segmentGroup,a.index,s.commands);return $E(o,a.segmentGroup,l,t,i,r)}function Zp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Wu(n){return typeof n=="object"&&n!=null&&n.outlets}function GM(n,e,t){n||="\u0275";let i=new Ji;return i.queryParams={[n]:e},t.parse(t.serialize(i)).queryParams[n]}function $E(n,e,t,i,r,o){let s={};for(let[u,d]of Object.entries(i??{}))s[u]=Array.isArray(d)?d.map(h=>GM(u,h,o)):GM(u,d,o);let a;n===e?a=t:a=dR(n,e,t);let l=sR(aR(a));return new Ji(l,s,r)}function dR(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=dR(o,e,t)}),new gt(n.segments,i)}var Xp=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Zp(i[0]))throw new de(4003,!1);let r=i.find(Wu);if(r&&r!==p6(i))throw new de(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function N6(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Xp(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,u])=>{a[l]=typeof u=="string"?u.split("/"):u}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new Xp(t,e,i)}var ml=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function P6(n,e,t){if(n.isAbsolute)return new ml(e,!0,0);if(!t)return new ml(e,!1,NaN);if(t.parent===null)return new ml(t,!0,0);let i=Zp(n.commands[0])?0:1,r=t.segments.length-1+i;return k6(t,r,n.numberOfDoubleDots)}function k6(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new de(4005,!1);r=i.segments.length}return new ml(i,!1,r-o)}function O6(n){return Wu(n[0])?n[0].outlets:{[$e]:n}}function hR(n,e,t){if(n??=new gt([],{}),n.segments.length===0&&n.hasChildren())return $u(n,e,t);let i=F6(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new gt(n.segments.slice(0,i.pathIndex),{});return o.children[$e]=new gt(n.segments.slice(i.pathIndex),n.children),$u(o,0,r)}else return i.match&&r.length===0?new gt(n.segments,{}):i.match&&!n.hasChildren()?QE(n,e,t):i.match?$u(n,0,r):QE(n,e,t)}function $u(n,e,t){if(t.length===0)return new gt(n.segments,{});{let i=O6(t),r={};if(Object.keys(i).some(o=>o!==$e)&&n.children[$e]&&n.numberOfChildren===1&&n.children[$e].segments.length===0){let o=$u(n.children[$e],e,t);return new gt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=hR(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new gt(n.segments,r)}}function F6(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(Wu(a))break;let l=`${a}`,u=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!WM(l,u,s))return o;i+=2}else{if(!WM(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function QE(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(Wu(o)){let l=L6(o.outlets);return new gt(i,l)}if(r===0&&Zp(t[0])){let l=n.segments[e];i.push(new Xo(l.path,zM(t[0]))),r++;continue}let s=Wu(o)?o.outlets[$e]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&Zp(a)?(i.push(new Xo(s,zM(a))),r+=2):(i.push(new Xo(s,{})),r++)}return new gt(i,{})}function L6(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=QE(new gt([],{}),0,i))}),e}function zM(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function WM(n,e,t){return n==t.path&&Ir(e,t.parameters)}var Gu="imperative",En=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(En||{}),mi=class{id;url;constructor(e,t){this.id=e,this.url=t}},sa=class extends mi{type=En.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Tr=class extends mi{urlAfterRedirects;type=En.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Un=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Un||{}),qu=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(qu||{}),Mi=class extends mi{reason;code;type=En.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function fR(n){return n instanceof Mi&&(n.code===Un.Redirect||n.code===Un.SupersededByNewNavigation)}var oo=class extends mi{reason;code;type=En.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},aa=class extends mi{error;target;type=En.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},vl=class extends mi{urlAfterRedirects;state;type=En.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},eg=class extends mi{urlAfterRedirects;state;type=En.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},tg=class extends mi{urlAfterRedirects;state;shouldActivate;type=En.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},ng=class extends mi{urlAfterRedirects;state;type=En.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ig=class extends mi{urlAfterRedirects;state;type=En.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rg=class{route;type=En.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},og=class{route;type=En.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},sg=class{snapshot;type=En.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ag=class{snapshot;type=En.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lg=class{snapshot;type=En.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},cg=class{snapshot;type=En.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var _l=class{},El=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function V6(n){return!(n instanceof _l)&&!(n instanceof El)}var ug=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new xl(this.rootInjector)}},xl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new ug(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Re(zt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),dg=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=YE(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=YE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=JE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return JE(e,this._root).map(t=>t.value)}};function YE(n,e){if(n===e.value)return e;for(let t of e.children){let i=YE(n,t);if(i)return i}return null}function JE(n,e){if(n===e.value)return[e];for(let t of e.children){let i=JE(n,t);if(i.length)return i.unshift(e),i}return[]}var gi=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function gl(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ku=class extends dg{snapshot;constructor(e,t){super(e),this.snapshot=t,ob(this,e)}toString(){return this.snapshot.toString()}};function pR(n,e){let t=U6(n,e),i=new Tn([new Xo("",{})]),r=new Tn({}),o=new Tn({}),s=new Tn({}),a=new Tn(""),l=new so(i,r,s,a,o,$e,n,t.root);return l.snapshot=t.root,new Ku(new gi(l,[]),t)}function U6(n,e){let t={},i={},r={},s=new ra([],t,r,"",i,$e,n,null,{},e);return new Qu("",new gi(s,[]))}var so=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(yt(u=>u[Zu]))??tt(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(yt(e=>oa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(yt(e=>oa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function hg(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:L(L({},e.params),n.params),data:L(L({},e.data),n.data),resolve:L(L(L(L({},n.data),e.data),r?.data),n._resolvedData)}:i={params:L({},n.params),data:L({},n.data),resolve:L(L({},n.data),n._resolvedData??{})},r&&mR(r)&&(i.resolve[Zu]=r.title),i}var ra=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[Zu]}constructor(e,t,i,r,o,s,a,l,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=u,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=oa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=oa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Qu=class extends dg{url;constructor(e,t){super(t),this.url=e,ob(this,t)}toString(){return gR(this._root)}};function ob(n,e){e.value._routerState=n,e.children.forEach(t=>ob(n,t))}function gR(n){let e=n.children.length>0?` { ${n.children.map(gR).join(", ")} } `:"";return`${n.value}${e}`}function GE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ir(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ir(e.params,t.params)||n.paramsSubject.next(t.params),f6(e.url,t.url)||n.urlSubject.next(t.url),Ir(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ZE(n,e){let t=Ir(n.params,e.params)&&v6(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||ZE(n.parent,e.parent))}function mR(n){return typeof n.title=="string"||n.title===null}var yR=new ve(""),ed=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=$e;activateEvents=new an;deactivateEvents=new an;attachEvents=new an;detachEvents=new an;routerOutletData=nM();parentContexts=$(xl);location=$(eo);changeDetector=$(Cu);inputBinder=$(mg,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new de(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new de(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new de(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new de(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new XE(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=_n({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Xr]})}return n})(),XE=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===so?this.route:e===xl?this.childContexts:e===yR?this.outletData:this.parent.get(e,t)}},mg=new ve("");var sb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Ot({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&W(0,"router-outlet")},dependencies:[ed],encapsulation:2})}return n})();function ab(n){let e=n.children&&n.children.map(ab),t=e?me(L({},n),{children:e}):L({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==$e&&(t.component=sb),t}function B6(n,e,t){let i=Yu(n,e._root,t?t._root:void 0);return new Ku(i,e)}function Yu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=j6(n,e,t);return new gi(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Yu(n,a)),s}}let i=H6(e.value),r=e.children.map(o=>Yu(n,o));return new gi(i,r)}}function j6(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Yu(n,i,r);return Yu(n,i)})}function H6(n){return new so(new Tn(n.url),new Tn(n.params),new Tn(n.queryParams),new Tn(n.fragment),new Tn(n.data),n.outlet,n.component,n)}var bl=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},vR="ngNavigationCancelingError";function fg(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=ts(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=_R(!1,Un.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function _R(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[vR]=!0,t.cancellationCode=e,t}function $6(n){return ER(n)&&ts(n.url)}function ER(n){return!!n&&n[vR]}var eb=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),GE(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=gl(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=gl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=gl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=gl(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new cg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new ag(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(GE(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),GE(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},pg=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},yl=class{component;route;constructor(e,t){this.component=e,this.route=t}};function G6(n,e,t){let i=n._root,r=e?e._root:null;return Hu(i,r,t,[i.value])}function z6(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Sl(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!Cy(n)?n:e.get(n):i}function Hu(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=gl(e);return n.children.forEach(s=>{W6(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>zu(a,t.getContext(s),r)),r}function W6(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=q6(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new pg(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Hu(n,e,a?a.children:null,i,r):Hu(n,e,t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new yl(a.outlet.component,s))}else s&&zu(e,a,r),r.canActivateChecks.push(new pg(i)),o.component?Hu(n,null,a?a.children:null,i,r):Hu(n,null,t,i,r);return r}function q6(n,e,t){if(typeof t=="function")return Mn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!ia(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ia(n.url,e.url)||!Ir(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ZE(n,e)||!Ir(n.queryParams,e.queryParams);default:return!ZE(n,e)}}function zu(n,e,t){let i=gl(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?zu(s,e.children.getContext(o),t):zu(s,null,t):zu(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new yl(e.outlet.component,r)):t.canDeactivateChecks.push(new yl(null,r)):t.canDeactivateChecks.push(new yl(null,r))}function td(n){return typeof n=="function"}function K6(n){return typeof n=="boolean"}function Q6(n){return n&&td(n.canLoad)}function Y6(n){return n&&td(n.canActivate)}function J6(n){return n&&td(n.canActivateChild)}function Z6(n){return n&&td(n.canDeactivate)}function X6(n){return n&&td(n.canMatch)}function bR(n){return n instanceof As||n?.name==="EmptyError"}var qp=Symbol("INITIAL_VALUE");function wl(){return zr(n=>Pc(n.map(e=>e.pipe(Ui(1),Fc(qp)))).pipe(yt(e=>{for(let t of e)if(t!==!0){if(t===qp)return qp;if(t===!1||e8(t))return t}return!0}),Vi(e=>e!==qp),Ui(1)))}function e8(n){return ts(n)||n instanceof bl}function wR(n){return n.aborted?tt(void 0).pipe(Ui(1)):new rt(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function xR(n){return Ms(wR(n))}function t8(n){return Hn(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?tt(me(L({},e),{guardsResult:!0})):n8(o,t,i).pipe(Hn(s=>s&&K6(s)?i8(t,r,n):tt(s)),yt(s=>me(L({},e),{guardsResult:s})))})}function n8(n,e,t){return sn(n).pipe(Hn(i=>l8(i.component,i.route,t,e)),Gr(i=>i!==!0,!0))}function i8(n,e,t){return sn(e).pipe(Hh(i=>Oo(o8(i.route.parent,t),r8(i.route,t),a8(n,i.path),s8(n,i.route))),Gr(i=>i!==!0,!0))}function r8(n,e){return n!==null&&e&&e(new lg(n)),tt(!0)}function o8(n,e){return n!==null&&e&&e(new sg(n)),tt(!0)}function s8(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return tt(!0);let i=t.map(r=>kc(()=>{let o=e._environmentInjector,s=Sl(r,o),a=Y6(s)?s.canActivate(e,n):Mn(o,()=>s(e,n));return la(a).pipe(Gr())}));return tt(i).pipe(wl())}function a8(n,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>z6(o)).filter(o=>o!==null).map(o=>kc(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,u=Sl(a,l),d=J6(u)?u.canActivateChild(t,n):Mn(l,()=>u(t,n));return la(d).pipe(Gr())});return tt(s).pipe(wl())}));return tt(r).pipe(wl())}function l8(n,e,t,i){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return tt(!0);let o=r.map(s=>{let a=e._environmentInjector,l=Sl(s,a),u=Z6(l)?l.canDeactivate(n,e,t,i):Mn(a,()=>l(n,e,t,i));return la(u).pipe(Gr())});return tt(o).pipe(wl())}function c8(n,e,t,i,r){let o=e.canLoad;if(o===void 0||o.length===0)return tt(!0);let s=o.map(a=>{let l=Sl(a,n),u=Q6(l)?l.canLoad(e,t):Mn(n,()=>l(e,t)),d=la(u);return r?d.pipe(xR(r)):d});return tt(s).pipe(wl(),SR(i))}function SR(n){return ny(ar(e=>{if(typeof e!="boolean")throw fg(n,e)}),yt(e=>e===!0))}function u8(n,e,t,i,r){let o=e.canMatch;if(!o||o.length===0)return tt(!0);let s=o.map(a=>{let l=Sl(a,n),u=X6(l)?l.canMatch(e,t):Mn(n,()=>l(e,t));return la(u).pipe(xR(r))});return tt(s).pipe(wl(),SR(i))}var ro=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},Ju=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function d8(n){throw new de(4e3,!1)}function h8(n){throw _R(!1,Un.GuardRejected)}var tb=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return i;if(r.numberOfChildren>1||!r.children[$e])throw d8(`${e.redirectTo}`);r=r.children[$e]}}async applyRedirectCommands(e,t,i,r,o){let s=await f8(t,r,o);if(s instanceof Ji)throw new Ju(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new Ju(a);return a}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new Ji(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new gt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new de(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function f8(n,e,t){if(typeof n=="string")return Promise.resolve(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:u,data:d,title:h,paramMap:p,queryParamMap:g}=e;return Jp(la(Mn(t,()=>i({params:u,data:d,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:p,queryParamMap:g}))))}function p8(n,e){return n.providers&&!n._injector&&(n._injector=cl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Yi(n){return n.outlet||$e}function g8(n,e){let t=n.filter(i=>Yi(i)===e);return t.push(...n.filter(i=>Yi(i)!==e)),t}var nb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function m8(n,e,t,i,r,o){let s=IR(n,e,t);return s.matched?(i=p8(e,i),u8(i,e,t,r,o).pipe(yt(a=>a===!0?s:L({},nb)))):tt(s)}function IR(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?L({},nb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||JM)(t,n,e);if(!r)return L({},nb);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?L(L({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function qM(n,e,t,i){return t.length>0&&_8(n,t,i)?{segmentGroup:new gt(e,v8(i,new gt(t,n.children))),slicedSegments:[]}:t.length===0&&E8(n,t,i)?{segmentGroup:new gt(n.segments,y8(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new gt(n.segments,n.children),slicedSegments:t}}function y8(n,e,t,i){let r={};for(let o of t)if(yg(n,e,o)&&!i[Yi(o)]){let s=new gt([],{});r[Yi(o)]=s}return L(L({},i),r)}function v8(n,e){let t={};t[$e]=e;for(let i of n)if(i.path===""&&Yi(i)!==$e){let r=new gt([],{});t[Yi(i)]=r}return t}function _8(n,e,t){return t.some(i=>yg(n,e,i)&&Yi(i)!==$e)}function E8(n,e,t){return t.some(i=>yg(n,e,i))}function yg(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function b8(n,e,t){return e.length===0&&!n.children[t]}var ib=class{};async function w8(n,e,t,i,r,o,s="emptyOnly",a){return new rb(n,e,t,i,r,s,o,a).recognize()}var x8=31,rb=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new tb(this.urlSerializer,this.urlTree)}noMatchError(e){return new de(4002,`'${e.segmentGroup}'`)}async recognize(){let e=qM(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),r=new gi(i,t),o=new Qu("",r),s=lR(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new ra([],Object.freeze({}),Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),$e,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,$e,t),rootSnapshot:t}}catch(i){if(i instanceof Ju)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof ro?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,r,o){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,o);let s=await this.processSegment(e,t,i,i.segments,r,!0,o);return s instanceof gi?[s]:[]}async processChildren(e,t,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let u=i.children[l],d=g8(t,l),h=await this.processSegmentGroup(e,d,u,l,r);s.push(...h)}let a=TR(s);return S8(a),a}async processSegment(e,t,i,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a)}catch(u){if(u instanceof ro||bR(u))continue;throw u}if(b8(i,r,o))return new ib;throw new ro(i)}async processSegmentAgainstRoute(e,t,i,r,o,s,a,l){if(Yi(i)!==s&&(s===$e||!yg(r,o,i)))throw new ro(r);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,i,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l);throw new ro(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:l,parameters:u,consumedSegments:d,positionalParamSegments:h,remainingSegments:p}=IR(t,r,o);if(!l)throw new ro(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>x8&&(this.allowRedirects=!1));let g=new ra(o,u,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,KM(r),Yi(r),r.component??r._loadedComponent??null,r,QM(r),e),w=hg(g,a,this.paramsInheritanceStrategy);if(g.params=Object.freeze(w.params),g.data=Object.freeze(w.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let S=await this.applyRedirects.applyRedirectCommands(d,r.redirectTo,h,g,e),P=await this.applyRedirects.lineralizeSegments(r,S);return this.processSegment(e,i,t,P.concat(p),s,!1,a)}async matchSegmentAgainstRoute(e,t,i,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await Jp(m8(t,i,r,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!a?.matched)throw new ro(t);e=i._injector??e;let{routes:l}=await this.getChildConfig(e,i,r),u=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:p}=a,g=new ra(h,d,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,KM(i),Yi(i),i.component??i._loadedComponent??null,i,QM(i),e),w=hg(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(w.params),g.data=Object.freeze(w.data);let{segmentGroup:S,slicedSegments:P}=qM(t,h,p,l);if(P.length===0&&S.hasChildren()){let Se=await this.processChildren(u,l,S,g);return new gi(g,Se)}if(l.length===0&&P.length===0)return new gi(g,[]);let U=Yi(i)===o,ie=await this.processSegment(u,l,S,P,U?$e:o,!0,g);return new gi(g,ie instanceof gi?[ie]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await Jp(c8(e,t,i,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw h8(t)}return{routes:[],injector:e}}};function S8(n){n.sort((e,t)=>e.value.outlet===$e?-1:t.value.outlet===$e?1:e.value.outlet.localeCompare(t.value.outlet))}function I8(n){let e=n.value.routeConfig;return e&&e.path===""}function TR(n){let e=[],t=new Set;for(let i of n){if(!I8(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=TR(i.children);e.push(new gi(i.value,r))}return e.filter(i=>!t.has(i))}function KM(n){return n.data||{}}function QM(n){return n.resolve||{}}function T8(n,e,t,i,r,o,s){return Hn(async a=>{let{state:l,tree:u}=await w8(n,e,t,i,a.extractedUrl,r,o,s);return me(L({},a),{targetSnapshot:l,urlAfterRedirects:u})})}function C8(n){return Hn(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return tt(e);let r=new Set(i.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of CR(a))o.add(l);let s=0;return sn(o).pipe(Hh(a=>r.has(a)?D8(a,t,n):(a.data=hg(a,a.parent,n).resolve,tt(void 0))),ar(()=>s++),$h(1),Hn(a=>s===o.size?tt(e):Cn))})}function CR(n){let e=n.children.map(t=>CR(t)).flat();return[n,...e]}function D8(n,e,t){let i=n.routeConfig,r=n._resolve;return i?.title!==void 0&&!mR(i)&&(r[Zu]=i.title),kc(()=>(n.data=hg(n,n.parent,t).resolve,A8(r,n,e).pipe(yt(o=>(n._resolvedData=o,n.data=L(L({},n.data),o),null)))))}function A8(n,e,t){let i=WE(n);if(i.length===0)return tt({});let r={};return sn(i).pipe(Hn(o=>M8(n[o],e,t).pipe(Gr(),ar(s=>{if(s instanceof bl)throw fg(new es,s);r[o]=s}))),$h(1),yt(()=>r),Oc(o=>bR(o)?Cn:sy(o)))}function M8(n,e,t){let i=e._environmentInjector,r=Sl(n,i),o=r.resolve?r.resolve(e,t):Mn(i,()=>r(e,t));return la(o)}function YM(n){return zr(e=>{let t=n(e);return t?sn(t).pipe(yt(()=>e)):tt(e)})}var lb=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===$e);return i}getResolvedTitleForRoute(t){return t.data[Zu]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>$(DR),providedIn:"root"})}return n})(),DR=(()=>{class n extends lb{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Re(UM))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Il=new ve("",{factory:()=>({})}),nd=new ve(""),AR=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=$(oE);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await XM(Mn(t,()=>i.loadComponent())),s=await NR(RR(o));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s,s}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await MR(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=o.routes,i._loadedInjector=o.injector,i._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function MR(n,e,t,i){let r=await XM(Mn(t,()=>n.loadChildren())),o=await NR(RR(r)),s;o instanceof fp||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),i&&i(n);let a,l,u=!1,d;return Array.isArray(s)?(l=s,u=!0):(a=s.create(t).injector,d=s,l=a.get(nd,[],{optional:!0,self:!0}).flat()),{routes:l.map(ab),injector:a,factory:d}}function R8(n){return n&&typeof n=="object"&&"default"in n}function RR(n){return R8(n)?n.default:n}async function NR(n){return n}var vg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>$(N8),providedIn:"root"})}return n})(),N8=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),PR=new ve("");var P8=()=>{},kR=new ve(""),OR=(()=>{class n{currentNavigation=z(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=z(null);events=new Gt;transitionAbortWithErrorSubject=new Gt;configLoader=$(AR);environmentInjector=$(zt);destroyRef=$(Jn);urlSerializer=$(Xu);rootContexts=$(xl);location=$(pl);inputBindingEnabled=$(mg,{optional:!0})!==null;titleStrategy=$(lb);options=$(Il,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=$(vg);createViewTransition=$(PR,{optional:!0});navigationErrorHandler=$(kR,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>tt(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new rg(r)),i=r=>this.events.next(new og(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;ln(()=>{this.transitions?.next(me(L({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new Tn(null),this.transitions.pipe(Vi(i=>i!==null),zr(i=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===i.id;return tt(i).pipe(zr(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),Cn;this.currentTransition=i;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?me(L({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&d!=="reload")return this.events.next(new oo(a.id,this.urlSerializer.serialize(a.rawUrl),"",qu.IgnoredSameUrlNavigation)),a.resolve(!1),Cn;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return tt(a).pipe(zr(h=>(this.events.next(new sa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?Cn:Promise.resolve(h))),T8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),ar(h=>{i.targetSnapshot=h.targetSnapshot,i.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=h.urlAfterRedirects,g));let p=new vl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:p,source:g,restoredState:w,extras:S}=a,P=new sa(h,this.urlSerializer.serialize(p),g,w);this.events.next(P);let U=pR(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=me(L({},a),{targetSnapshot:U,urlAfterRedirects:p,extras:me(L({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(ie=>(ie.finalUrl=p,ie)),tt(i)}else return this.events.next(new oo(a.id,this.urlSerializer.serialize(a.extractedUrl),"",qu.IgnoredByUrlHandlingStrategy)),a.resolve(!1),Cn}),yt(a=>{let l=new eg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=i=me(L({},a),{guards:G6(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i}),t8(a=>this.events.next(a)),zr(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw fg(this.urlSerializer,a.guardsResult);let l=new tg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return Cn;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",Un.GuardRejected),Cn;if(a.guards.canActivateChecks.length===0)return tt(a);let u=new ng(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(u),!s())return Cn;let d=!1;return tt(a).pipe(C8(this.paramsInheritanceStrategy),ar({next:()=>{d=!0;let h=new ig(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{d||this.cancelNavigationTransition(a,"",Un.NoDataFromResolver)}}))}),YM(a=>{let l=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let p=d._environmentInjector;h.push(this.configLoader.loadComponent(p,d.routeConfig).then(g=>{d.component=g}))}for(let p of d.children)h.push(...l(p));return h},u=l(a.targetSnapshot.root);return u.length===0?tt(a):sn(Promise.all(u).then(()=>a))}),YM(()=>this.afterPreactivation()),zr(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,u=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return u?sn(u).pipe(yt(()=>i)):tt(i)}),Ui(1),yt(a=>{let l=B6(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=i=a=me(L({},a),{targetRouterState:l}),this.currentNavigation.update(u=>(u.targetRouterState=l,u)),this.events.next(new _l),s()&&(new eb(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,u=>this.events.next(u),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(u=>(u.abort=P8,u)),this.lastSuccessfulNavigation.set(ln(this.currentNavigation)),this.events.next(new Tr(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Ms(wR(o.signal).pipe(Vi(()=>!r&&!i.targetRouterState),ar(()=>{this.cancelNavigationTransition(i,o.signal.reason+"",Un.Aborted)}))),ar({complete:()=>{r=!0}}),Ms(this.transitionAbortWithErrorSubject.pipe(ar(a=>{throw a}))),cy(()=>{o.abort(),r||this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Oc(a=>{if(r=!0,this.destroyed)return i.resolve(!1),Cn;if(ER(a))this.events.next(new Mi(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),$6(a)?this.events.next(new El(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new aa(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let u=Mn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(u instanceof bl){let{message:d,cancellationCode:h}=fg(this.urlSerializer,u);this.events.next(new Mi(i.id,this.urlSerializer.serialize(i.extractedUrl),d,h)),this.events.next(new El(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(u){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(u)}}return Cn}))}))}cancelNavigationTransition(t,i,r){let o=new Mi(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=ln(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function k8(n){return n!==Gu}var FR=new ve("");var LR=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>$(O8),providedIn:"root"})}return n})(),gg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},O8=(()=>{class n extends gg{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Zs(n)))(r||n)}})();static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),cb=(()=>{class n{urlSerializer=$(Xu);options=$(Il,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=$(pl);urlHandlingStrategy=$(vg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Ji;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof Ji?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=pR(null,$(zt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>$(F8),providedIn:"root"})}return n})(),F8=(()=>{class n extends cb{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof sa?this.updateStateMemento():t instanceof oo?this.commitTransition(i):t instanceof vl?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof _l?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Mi&&!fR(t)?this.restoreHistory(i):t instanceof aa?this.restoreHistory(i,!0):t instanceof Tr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=L(L({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=L(L({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Zs(n)))(r||n)}})();static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ub(n,e){n.events.pipe(Vi(t=>t instanceof Tr||t instanceof Mi||t instanceof aa||t instanceof oo),yt(t=>t instanceof Tr||t instanceof oo?0:(t instanceof Mi?t.code===Un.Redirect||t.code===Un.SupersededByNewNavigation:!1)?2:1),Vi(t=>t!==2),Ui(1)).subscribe(()=>{e()})}var VR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},UR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},yi=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=$(gp);stateManager=$(cb);options=$(Il,{optional:!0})||{};pendingTasks=$(vr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=$(OR);urlSerializer=$(Xu);location=$(pl);urlHandlingStrategy=$(vg);injector=$(zt);_events=new Gt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=$(LR);injectorCleanup=$(FR,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=$(nd,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!$(mg,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new pn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=ln(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Mi&&i.code!==Un.Redirect&&i.code!==Un.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Tr)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof El){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=L({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||k8(r.source)},s);this.scheduleNavigation(a,Gu,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}V6(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Gu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=L({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(di)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return ln(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(ab),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=L(L({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let p=r?r.snapshot:this.routerState.snapshot.root;h=cR(p)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return uR(h,t,d,u??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let r=ts(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,Gu,null,i)}navigate(t,i={skipLocationChange:!1}){return L8(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Kr(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=L({},VR):i===!1?r=L({},UR):r=i,ts(t))return HM(this.currentUrlTree,t,r);let o=this.parseUrl(t);return HM(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,u;s?(a=s.resolve,l=s.reject,u=s.promise):u=new Promise((h,p)=>{a=h,l=p});let d=this.pendingTasks.add();return ub(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function L8(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new de(4008,!1)}var Tl=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=z(null);get href(){return ln(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Gt;applicationErrorHandler=$(di);options=$(Il,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set($(new Cp("href"),{optional:!0}));let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area"||!!(typeof customElements=="object"&&customElements.get(l)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Tr&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(ts(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l)?.catch(u=>{this.applicationErrorHandler(u)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:ts(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(Ee(yi),Ee(so),hu("tabindex"),Ee(Xs),Ee(zi),Ee(fl))};static \u0275dir=_n({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&ue("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&Ft("href",r.reactiveHref(),S_)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Du],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Du],replaceUrl:[2,"replaceUrl","replaceUrl",Du],routerLink:"routerLink"},features:[Xr]})}return n})();var B8=new ve("");function db(n,...e){return fr([{provide:nd,multi:!0,useValue:n},[],{provide:so,useFactory:j8},{provide:Ko,multi:!0,useFactory:H8},e.map(t=>t.\u0275providers)])}function j8(){return $(yi).routerState.root}function H8(){let n=$(zn);return e=>{let t=n.get(Zn);if(e!==t.components[0])return;let i=n.get(yi),r=n.get($8);n.get(G8)===1&&i.initialNavigation(),n.get(z8,null,{optional:!0})?.setUpPreloading(),n.get(B8,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var $8=new ve("",{factory:()=>new Gt}),G8=new ve("",{factory:()=>1});var z8=new ve("");function BR(n,e){let i=!e?.manualCleanup?e?.injector?.get(Jn)??$(Jn):null,r=W8(e?.equal),o;e?.requireSync?o=z({kind:0},{equal:r}):o=z({kind:1,value:e?.initialValue},{equal:r});let s,a=n.subscribe({next:l=>o.set({kind:1,value:l}),error:l=>{o.set({kind:2,error:l}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&o().kind===0)throw new de(601,!1);return s=i?.onDestroy(a.unsubscribe.bind(a)),Xn(()=>{let l=o();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:throw new de(601,!1)}},{equal:e?.equal})}function W8(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var hb;try{hb=typeof Intl<"u"&&Intl.v8BreakIterator}catch{hb=!1}var jR=(()=>{class n{_platformId=$(Wi);isBrowser=this._platformId?Zo(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||hb)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function fb(n){return Array.isArray(n)?n:[n]}var HR=new Set,ca,GR=(()=>{class n{_platform=$(jR);_nonce=$(ol,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):K8}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&q8(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function q8(n,e){if(!HR.has(n))try{ca||(ca=document.createElement("style"),e&&ca.setAttribute("nonce",e),ca.setAttribute("type","text/css"),document.head.appendChild(ca)),ca.sheet&&(ca.sheet.insertRule(`@media ${n} {body{ }}`,0),HR.add(n))}catch(t){console.error(t)}}function K8(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var pb=(()=>{class n{_mediaMatcher=$(GR);_zone=$(An);_queries=new Map;_destroySubject=new Gt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return $R(fb(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=$R(fb(t)).map(s=>this._registerQuery(s).observable),o=Pc(r);return o=Oo(o.pipe(Ui(1)),o.pipe(uy(1),ly(0))),o.pipe(yt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:u})=>{a.matches=a.matches||l,a.breakpoints[u]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),o={observable:new rt(s=>{let a=l=>this._zone.run(()=>s.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Fc(i),yt(({matches:s})=>({query:t,matches:s})),Ms(this._destroySubject)),mql:i};return this._queries.set(t,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function $R(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var Cl=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let r={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return r?r[t-1]:1}getDefenseBonus(e,t){let i=0,r=[];(e.turnsStationary??0)>=3&&(i+=1,r.push("Shield +1"));let o=t.filter(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1);return o.length&&(i+=o.length,r.push(`Support +${o.length}`)),{bonus:i,tags:r}}getAttackLuckModifier(e){let t=Math.random(),r={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:r,tag:`CRIT! +${r}`,isCrit:!0}:t>.8?{delta:-r,tag:`MISS! -${r}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}getWallHitAmount(e){return e===1?34:e===2?51:101}applyDamage(e,t){let i=e.armorHp??0,r=Math.max(0,i-t),o=Math.max(0,t-i),s=Math.max(0,e.points-o),{tier:a,level:l}=this.calculateTierAndLevel(s);return me(L({},e),{armorHp:r,points:s,tier:a,level:l})}calculateHitChance(e,t){let i=t.tier-e.tier,r=e.level??1,o=0;i<=0?o=100:i===1?o=Math.min(100,50+r*15):i===2?o=Math.min(100,25+r*5):o=Math.min(100,1+r*1);let s=e.hasWeapon&&t.tier>e.tier?10:0,a=t.hasArmor?10:0;return Math.max(1,Math.min(100,o+s-a))}isDiagonalBlocked(e,t,i){let r=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(r===0||o===0)return!1;let s=i(e.x,e.y,e.x+r,e.y),a=i(e.x,e.y,e.x,e.y+o),l=i(t.x-r,t.y,t.x,t.y),u=i(t.x,t.y-o,t.x,t.y);return!!(s||a||l||u)}checkWallAlongPath(e,t,i,r){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),l=Math.sign(s),u=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=u;d++){let h={x:e.x+a*(d-1),y:e.y+l*(d-1)},p={x:e.x+a*d,y:e.y+l*d},g=r(h.x,h.y,p.x,p.y);if(g)return g.owner===i?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:h}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Eg=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,i){let r=[t,i];for(let o of r){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,i,r){return e.some(o=>o.owner===t&&(o.position.x===i.x&&o.position.y===i.y||o.position.x===r.x&&o.position.y===r.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var bg=class n{entriesSignal=z([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(i=>[...i,{text:e,color:t,type:"other"}])}addCombat(e,t,i){let r=i?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:r,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var J8={IRON_CYCLE:{en:"Iron Cycle",uk:"\u0426\u0438\u043A\u043B \u0417\u0430\u043B\u0456\u0437\u0430"},NEW_DESIGN_UNIT:{en:"New Evolution",uk:"\u041D\u043E\u0432\u0430 \u0435\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},NEW_UNIT_EVOLUTION:{en:"New Unit Evolution",uk:"\u041D\u043E\u0432\u0430 \u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},T4_4_TILES:{en:"T4: 4 tiles",uk:"T4: 4 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},TURN_3:{en:"Turn 3",uk:"\u0425\u0456\u0434 3"},TURN_4:{en:"Turn 4",uk:"\u0425\u0456\u0434 4"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0414\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},PLUS_2_IRON_PER_TURN:{en:"+2 Iron/turn",uk:"+2 \u0417\u0430\u043B\u0456\u0437\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function WR(n,e){let t=J8[n];return t?t[e]??t.en:n}var Kt=class n{difficultySignal=z("normal");mapSizeSignal=z(10);langSignal=z("uk");customModeSignal=z(!1);version="v.1.0.3";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),i=e%2===0;return t==="baby"?i?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return WR(e,this.langSignal())}customMode(){return this.customModeSignal()}setCustomMode(e){this.customModeSignal.set(e),this.persistSettings()}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let i=["baby","normal","hard","nightmare"],r=[10,20,30],o=["en","uk"],s=t.difficulty&&i.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&r.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),l=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(l),this.customModeSignal.set(!!t.customMode)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal(),customMode:this.customModeSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var wg=class n{generateForests(e,t,i){let r=e*e,o=Math.max(1,Math.floor(r*.1)),s=[],a=(l,u)=>{let d=Math.max(Math.abs(l-t.x),Math.abs(u-t.y)),h=Math.max(Math.abs(l-i.x),Math.abs(u-i.y));return d<=3||h<=3};for(;s.length<o;){let l=Math.floor(Math.random()*e),u=Math.floor(Math.random()*e);a(l,u)||s.some(d=>d.x===l&&d.y===u)||s.push({x:l,y:u})}return s}generateMines(e,t,i,r){let o=new Set(r.map(u=>`${u.x},${u.y}`)),s=e===10?4:Math.max(1,Math.floor(e*e*.04)),a=[],l=(u,d)=>{let h=Math.max(Math.abs(u-t.x),Math.abs(d-t.y)),p=Math.max(Math.abs(u-i.x),Math.abs(d-i.y));return h<=3||p<=3};for(;a.length<s;){let u=Math.floor(Math.random()*e),d=Math.floor(Math.random()*e);if(l(u,d))continue;let h=`${u},${d}`;o.has(h)||a.some(p=>p.x===u&&p.y===d)||a.push({x:u,y:d})}return a}computeVisibility(e,t,i,r,o){let s={player:new Set,ai:new Set},a=(d,h)=>d>=0&&d<e&&h>=0&&h<e,l=(d,h,p)=>{a(h,p)&&d.add(`${h},${p}`)},u=(d,h,p)=>{for(let g=-p;g<=p;g++)for(let w=-p;w<=p;w++){let S=h.x+g,P=h.y+w;Math.max(Math.abs(g),Math.abs(w))<=p&&l(d,S,P)}};if(o){for(let d=0;d<e;d++)for(let h=0;h<e;h++)s.player.add(`${d},${h}`),s.ai.add(`${d},${h}`);return s}u(s.player,i,3),u(s.ai,r,3);for(let d of t){let h=d.owner==="player"?s.player:s.ai;u(h,d.position,2)}return s}mergeExplored(e,t){let i=new Set(e);return t.forEach(r=>i.add(r)),i}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var xg=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let i of t)if(e>=i)return i;return 0}computeWoodGain(e,t){let i=e.filter(r=>r.owner===t).filter(r=>r.position&&r.position.x!==void 0&&r.position.y!==void 0).length;return i>0?i*2:0}applyMonopolyTick(e,t,i){let r=t.length;if(r===0)return{next:{player:0,ai:0}};let o=u=>i.filter(d=>d.owner===u&&t.some(h=>h.x===d.position.x&&h.y===d.position.y)).length,s=o("player"),a=o("ai"),l={player:e.player,ai:e.ai};if(s===r){if(l.player=e.player+1,l.ai=0,l.player>=10)return{next:l,winner:"player"}}else if(a===r){if(l.ai=e.ai+1,l.player=0,l.ai>=10)return{next:l,winner:"ai"}}else l.player=0,l.ai=0;return{next:l}}computeAiReserveDump(e,t,i,r){let o=i,s=[];for(let l=-2;l<=2;l++)for(let u=-2;u<=2;u++){if(l===0&&u===0)continue;let d=t.x+l,h=t.y+u;d<0||d>=e||h<0||h>=e||Math.max(Math.abs(l),Math.abs(u))>2||r(d,h)||s.push({x:d,y:h})}let a=[];for(;o>0&&s.length>0;){let l=this.getHighestAffordableCost(o);if(l<=0)break;let u=this.calculateTierAndLevel(l),d=s.shift();a.push({id:crypto.randomUUID(),position:L({},d),level:u.level,tier:u.tier,points:l,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=l}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Sg=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(y=>y.owner==="ai"&&!y.hasActed);t=t.filter(y=>!(y.tier<=2&&e.isForest(y.position.x,y.position.y)&&e.isAnchoredGatherer(y.id)));let i=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;i&&(t=t.filter(y=>y.id===i));let r=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:r==="rage"?5e4:r==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),l=e.forestsSignal(),d=l.filter(y=>!e.getUnitAt(y.x,y.y)).filter(y=>e.isVisibleToAi(y.x,y.y)),h=l.filter(y=>!e.isVisibleToAi(y.x,y.y)),p=e.unitsSignal().filter(y=>y.owner==="ai"&&e.isForest(y.position.x,y.position.y)).length,g=e.unitsSignal().filter(y=>y.owner==="ai").length,w=[1,2,3].some(y=>e.unitsSignal().filter(oe=>oe.owner==="ai"&&oe.tier===y&&!e.isForest(oe.position.x,oe.position.y)).length>=5),S=e.unitsSignal().filter(y=>y.owner==="player"),P=S.some(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=3),U=S.filter(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=4),ie=U.length>0,xe=U.filter(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=2).length>0,De=S.some(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=5),Ie=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,k=e.unitsSignal().filter(y=>y.owner==="ai"),I=k.filter(y=>y.tier===3&&!e.isForest(y.position.x,y.position.y)).length,N=k.filter(y=>y.tier===4&&!e.isForest(y.position.x,y.position.y)).length,D=I+N>=5,b=D?"full_rush":ie?"defense":Ie?"expansion":"none";if(b!==this.lastPhase){try{console.log(b==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":b==="defense"?"AI Phase: Base Defense Activated":b==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=b}D&&t.sort((y,oe)=>{let ze=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),We=Math.abs(oe.position.x-a.x)+Math.abs(oe.position.y-a.y);return ze-We});let R=typeof e.aggressionMode=="function"?!!e.aggressionMode():S.filter(y=>e.isForest(y.position.x,y.position.y)).length*2>=t.filter(y=>e.isForest(y.position.x,y.position.y)).length*2,M=l.length>0?l.every(y=>{let oe=e.getUnitAt(y.x,y.y);return!!oe&&oe.owner==="ai"}):!0,pe=l.length>0?l.every(y=>!!e.getUnitAt(y.x,y.y)):!1,Oe=l.filter(y=>{let oe=e.getUnitAt(y.x,y.y);return!!oe&&oe.owner==="player"}),ce=null,Lt=t.filter(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=3).length,Yt={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Ae=U.length>0?U.reduce((y,oe)=>{let ze=Math.max(Math.abs(oe.position.x-s.x),Math.abs(oe.position.y-s.y)),We=Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y));return ze<We?oe:y},U[0]):null,jt=t.length>0?t.reduce((y,oe)=>this.combat.calculateTotalPoints(oe)>this.combat.calculateTotalPoints(y)?oe:y,t[0]):null,st=[];if(Ae){let y=Ae.position.x,oe=Ae.position.y,ze=Math.sign(s.x-y),We=Math.sign(s.y-oe),re=0,bt=Math.max(10,e.gridSize*2);for(;y!==s.x||oe!==s.y;){if(re++,re>bt){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(y+=ze,oe+=We,!e.inBounds(y,oe)||y===s.x&&oe===s.y)break;st.push({x:y,y:oe})}}ie&&jt&&Ae&&(this.goals.set(jt.id,{x:Ae.position.x,y:Ae.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(jt.id,e.turnSignal()+3));let te=new Map(e.aiUnitTimeNearBase()),ne=new Map(e.unitStutterBanSignal?.()??new Map),_e=new Map;for(let[y,oe]of this.goals.entries())if(oe&&e.isForest(oe.x,oe.y)){let ze=`${oe.x},${oe.y}`;_e.set(ze,(_e.get(ze)||0)+1)}for(let y of t){let oe=e.calculateValidMoves(y),ze=Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=3,We=te.get(y.id)||0,re=this.goals.get(y.id)||null,bt=re!==null,Ei=bt?(()=>{let H=e.getUnitAt(re.x,re.y);return!!(H&&H.owner==="ai"&&this.combat.calculateTotalPoints(H)>=this.combat.calculateTotalPoints(y))})():!1,ii=(!bt||Ei)&&(!e.isForest(y.position.x,y.position.y)||De||y.tier>=3),vs=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(ii){if(vs)re={x:a.x,y:a.y};else if(e.isForest(y.position.x,y.position.y)){let H=S.filter(F=>e.isForest(F.position.x,F.position.y));if(R&&H.length>0){let F=H.reduce((K,Q)=>{let Te=Math.abs(y.position.x-Q.position.x)+Math.abs(y.position.y-Q.position.y),Fe=Math.abs(y.position.x-K.position.x)+Math.abs(y.position.y-K.position.y);return Te<Fe?Q:K},H[0]);re={x:F.position.x,y:F.position.y}}else{let F=S.length===0?null:[...S].sort((Q,Te)=>{let Fe=Math.abs(y.position.x-Q.position.x)+Math.abs(y.position.y-Q.position.y),Ze=Math.abs(y.position.x-Te.position.x)+Math.abs(y.position.y-Te.position.y);return Fe-Ze})[0];F?re={x:F.position.x,y:F.position.y}:d.length>0?re=d.reduce((K,Q)=>Math.abs(y.position.x-Q.x)+Math.abs(y.position.y-Q.y)<Math.abs(y.position.x-K.x)+Math.abs(y.position.y-K.y)?Q:K,d[0]):h.length>0?re=h.reduce((K,Q)=>Math.abs(y.position.x-Q.x)+Math.abs(y.position.y-Q.y)<Math.abs(y.position.x-K.x)+Math.abs(y.position.y-K.y)?Q:K,h[0]):re={x:0,y:0}}}else{let H=S.filter(F=>e.isForest(F.position.x,F.position.y)).map(F=>({x:F.position.x,y:F.position.y}));if(H.length>0)re=H.reduce((K,Q)=>{let Te=Math.abs(y.position.x-Q.x)+Math.abs(y.position.y-Q.y),Fe=Math.abs(y.position.x-K.x)+Math.abs(y.position.y-K.y);return Te<Fe?Q:K},H[0]);else if(d.length>0){let F=Math.min(...d.map(Q=>_e.get(`${Q.x},${Q.y}`)||0)),K=d.filter(Q=>(_e.get(`${Q.x},${Q.y}`)||0)===F);re=K.reduce((Q,Te)=>Math.abs(y.position.x-Te.x)+Math.abs(y.position.y-Te.y)<Math.abs(y.position.x-Q.x)+Math.abs(y.position.y-Q.y)?Te:Q,K[0])}else if(h.length>0){let F=Math.min(...h.map(Q=>_e.get(`${Q.x},${Q.y}`)||0)),K=h.filter(Q=>(_e.get(`${Q.x},${Q.y}`)||0)===F);re=K.reduce((Q,Te)=>Math.abs(y.position.x-Te.x)+Math.abs(y.position.y-Te.y)<Math.abs(y.position.x-Q.x)+Math.abs(y.position.y-Q.y)?Te:Q,K[0])}else{let F=S.length===0?null:[...S].sort((Q,Te)=>{let Fe=Math.abs(y.position.x-Q.position.x)+Math.abs(y.position.y-Q.position.y),Ze=Math.abs(y.position.x-Te.position.x)+Math.abs(y.position.y-Te.position.y);return Fe-Ze})[0];re=F?{x:F.position.x,y:F.position.y}:{x:0,y:0}}}this.goals.set(y.id,re)}Lt>3&&We>=5&&(re=Yt);let jn=e.isForest(y.position.x,y.position.y),fc=jn&&(y.forestOccupationTurns??0)>0&&!(y.productionActive??!1),pc=e.unitsSignal().some(H=>H.owner==="ai"&&H.id!==y.id&&H.tier<=2&&Math.max(Math.abs(H.position.x-y.position.x),Math.abs(H.position.y-y.position.y))<=2);if(fc&&!De&&y.tier<3){this.goals.set(y.id,{x:y.position.x,y:y.position.y});continue}if(y.tier>=3){let H=l,F=H.length?H.reduce((Q,Te)=>{let Fe=Math.abs(y.position.x-Te.x)+Math.abs(y.position.y-Te.y),Ze=Math.abs(y.position.x-Q.x)+Math.abs(y.position.y-Q.y);return Fe<Ze?Te:Q},H[0]):null;if((y.forestOccupationTurns??0)===0&&!jn&&F&&(re={x:F.x,y:F.y},this.goals.set(y.id,re)),jn&&pc){this.goals.set(y.id,{x:a.x,y:a.y});let Q=[{x:y.position.x+1,y:y.position.y},{x:y.position.x-1,y:y.position.y},{x:y.position.x,y:y.position.y+1},{x:y.position.x,y:y.position.y-1}].filter(Fe=>e.inBounds(Fe.x,Fe.y));if(Q.filter(Fe=>!!e.getWallBetween(y.position.x,y.position.y,Fe.x,Fe.y)).length===Q.length){let Fe=Q.reduce((Ze,dt)=>{let wt=Math.abs(dt.x-a.x)+Math.abs(dt.y-a.y),mt=Math.abs(Ze.x-a.x)+Math.abs(Ze.y-a.y);return wt<mt?dt:Ze});ce={unit:y,target:{x:y.position.x,y:y.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:L({},y.position),to:Fe}};continue}}}if(oe.some(H=>H.x===a.x&&H.y===a.y)){let H=y.tier===3&&y.level>=2||y.tier>=4?3e5:0,F=5e7+o+H;(ce===null||F>ce.score)&&(ce={unit:y,target:{x:a.x,y:a.y},score:F,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let H=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(F=>e.inBounds(F.x,F.y));for(let F of H){let K=e.getWallBetween(a.x,a.y,F.x,F.y);if(K&&K.owner==="neutral"){if(y.position.x===F.x&&y.position.y===F.y||y.position.x===a.x&&y.position.y===a.y){let Te=y.tier===3&&y.level>=2||y.tier>=4?3e5:0,Fe=2e6+o+Te;(ce===null||Fe>ce.score)&&(ce={unit:y,target:L({},y.position),score:Fe,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:F.x,y:F.y}}})}else if(oe.some(Fe=>Fe.x===F.x&&Fe.y===F.y||Fe.x===a.x&&Fe.y===a.y)){let Fe=oe.find(mt=>mt.x===F.x&&mt.y===F.y||mt.x===a.x&&mt.y===a.y),Ze=y.tier===3&&y.level>=2||y.tier>=4?3e5:0,dt=18e5+o+Ze;(ce===null||dt>ce.score)&&(ce={unit:y,target:{x:Fe.x,y:Fe.y},score:dt,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(re){let H=e.getUnitAt(re.x,re.y);if(H&&H.owner==="player"&&e.isForest(re.x,re.y)){let F=re.x,K=re.y;if(oe.some(Te=>Te.x===F&&Te.y===K)){(ce===null||3e5>ce.score)&&(ce={unit:y,target:{x:F,y:K},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let Te=d.length>0?d:h;if(Te.length>0)re=Te.reduce((Ze,dt)=>{let wt=Math.abs(y.position.x-dt.x)+Math.abs(y.position.y-dt.y),mt=Math.abs(y.position.x-Ze.x)+Math.abs(y.position.y-Ze.y);return wt<mt?dt:Ze},Te[0]),this.goals.set(y.id,re);else continue}}}let Rt=null;if(re&&e.isForest(re.x,re.y)&&!e.getUnitAt(re.x,re.y)){let F=[{x:re.x+1,y:re.y},{x:re.x-1,y:re.y},{x:re.x,y:re.y+1},{x:re.x,y:re.y-1}].filter(K=>e.inBounds(K.x,K.y)).filter(K=>{let Q=e.getWallBetween(K.x,K.y,re.x,re.y);return!!(Q&&Q.owner==="neutral")});F.length>0&&(Rt=F.reduce((K,Q)=>{let Te=Math.abs(y.position.x-K.x)+Math.abs(y.position.y-K.y);return Math.abs(y.position.x-Q.x)+Math.abs(y.position.y-Q.y)+3<Te?Q:K},F[0]))}let Br=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let H of Br){let F={x:y.position.x+H.x,y:y.position.y+H.y};if(!e.inBounds(F.x,F.y)||!e.isForest(F.x,F.y)||e.getUnitAt(F.x,F.y))continue;let Q=e.getWallBetween(y.position.x,y.position.y,F.x,F.y);if(Q&&(Q.owner==="neutral"||Q.owner==="ai")){let Te=(y.tier>=3?7e6:9e5)+o,Fe=Q.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(ce===null||Te>ce.score)&&(ce={unit:y,target:{x:y.position.x,y:y.position.y},score:Te,type:"wall_attack",reason:Fe,edge:{from:L({},y.position),to:F}})}else if(Q&&Q.owner==="player"){let Fe=[{x:F.x+1,y:F.y},{x:F.x-1,y:F.y},{x:F.x,y:F.y+1},{x:F.x,y:F.y-1}].filter(wt=>e.inBounds(wt.x,wt.y)).filter(wt=>e.getUnitAt(wt.x,wt.y)?!1:!e.getWallBetween(wt.x,wt.y,F.x,F.y)),Ze=Math.abs(y.position.x-F.x)+Math.abs(y.position.y-F.y);if((Fe.length>0?Fe.reduce((wt,mt)=>{let gn=Math.abs(y.position.x-mt.x)+Math.abs(y.position.y-mt.y)+1;return Math.min(wt,gn)},1/0):1/0)-Ze>4){let wt=(y.tier>=3?8e6:y.tier===3&&y.level===1?105e4:85e4)+o;(ce===null||wt>ce.score)&&(ce={unit:y,target:{x:y.position.x,y:y.position.y},score:wt,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:L({},y.position),to:F}})}}}for(let H of Br){let F={x:y.position.x+H.x,y:y.position.y+H.y};if(F.x===a.x&&F.y===a.y){let K=e.getWallBetween(y.position.x,y.position.y,F.x,F.y);if(K&&(K.owner==="neutral"||K.owner==="player")&&y.tier>=3){let Q=8e6+o;(ce===null||Q>ce.score)&&(ce={unit:y,target:{x:y.position.x,y:y.position.y},score:Q,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:L({},y.position),to:F}})}}}if(re){let H=Math.sign(re.x-y.position.x),F=Math.sign(re.y-y.position.y),K=y.position.x+(H!==0?H:0),Q=y.position.y+(F!==0?F:0);if(e.inBounds(K,Q)){let Te=e.getUnitAt(K,Q);if(Te&&Te.owner==="ai")for(let Fe of Br){let Ze={x:y.position.x+Fe.x,y:y.position.y+Fe.y};if(!e.inBounds(Ze.x,Ze.y))continue;let dt=e.getWallBetween(y.position.x,y.position.y,Ze.x,Ze.y);if(dt&&(dt.owner==="player"||dt.owner==="neutral")){let mt=(dt.owner==="player"?65e4:6e5)+o;(ce===null||mt>ce.score)&&(ce={unit:y,target:{x:y.position.x,y:y.position.y},score:mt,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:L({},y.position),to:Ze}})}}}}if(re){let H=re.x-y.position.x,F=re.y-y.position.y;if(H!==0&&F===0||H===0&&F!==0){let K=Math.sign(H),Q=Math.sign(F),Te={x:y.position.x+K,y:y.position.y+Q};if(e.inBounds(Te.x,Te.y)&&e.getWallBetween(y.position.x,y.position.y,Te.x,Te.y)){let Ze=(y.tier>=3?8e6:15e5)+o;(ce===null||Ze>ce.score)&&(ce={unit:y,target:{x:y.position.x,y:y.position.y},score:Ze,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:L({},y.position),to:Te}})}}if(Math.abs(H)>=1&&Math.abs(F)>=1){let K=Math.sign(H),Q=Math.sign(F),Te={x:y.position.x+K,y:y.position.y+Q};if(e.inBounds(Te.x,Te.y)&&this.combat.isDiagonalBlocked(y.position,Te,(Ze,dt,wt,mt)=>e.getWallBetween(Ze,dt,wt,mt))){let Ze={x:y.position.x+K,y:y.position.y},dt={x:y.position.x,y:y.position.y+Q},wt=e.getWallBetween(y.position.x,y.position.y,Ze.x,Ze.y),mt=e.getWallBetween(y.position.x,y.position.y,dt.x,dt.y),gn=null;if(wt?gn={from:L({},y.position),to:Ze}:mt&&(gn={from:L({},y.position),to:dt}),gn){let Do=(y.tier>=3?8e6:15e5)+o;(ce===null||Do>ce.score)&&(ce={unit:y,target:{x:y.position.x,y:y.position.y},score:Do,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:gn})}}}}let w0=d.length===0&&h.length===0&&!Rt;if(We>=2&&(w0||S.length>0))for(let H of Br){let F={x:y.position.x+H.x,y:y.position.y+H.y};if(!e.inBounds(F.x,F.y))continue;let K=e.getWallBetween(y.position.x,y.position.y,F.x,F.y);if(K&&(K.owner==="neutral"||K.owner==="player")){let Q=y.tier>=3?8e6:12e5;(ce===null||Q>ce.score)&&(ce={unit:y,target:{x:y.position.x,y:y.position.y},score:Q,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:L({},y.position),to:F}})}}let rr=S.filter(H=>Math.max(Math.abs(H.position.x-y.position.x),Math.abs(H.position.y-y.position.y))===1),Co=rr.length>0?rr.reduce((H,F)=>this.combat.calculateTotalPoints(F)>this.combat.calculateTotalPoints(H)?F:H,rr[0]):null,_s=st.length>0&&oe.some(H=>st.some(F=>F.x===H.x&&F.y===H.y));for(let H of oe){let F=0,K="Action",Q=e.getUnitAt(H.x,H.y),Te=be=>[{x:be.x+1,y:be.y},{x:be.x-1,y:be.y},{x:be.x,y:be.y+1},{x:be.x,y:be.y-1}].filter(Ct=>e.inBounds(Ct.x,Ct.y)).filter(Ct=>!e.getUnitAt(Ct.x,Ct.y)).length,Fe=Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y)),Ze=Math.max(Math.abs(H.x-s.x),Math.abs(H.y-s.y)),dt=l.length?Math.min(...l.map(be=>Math.abs(y.position.x-be.x)+Math.abs(y.position.y-be.y))):1/0,wt=l.length?Math.min(...l.map(be=>Math.abs(H.x-be.x)+Math.abs(H.y-be.y))):1/0,mt=l.filter(be=>{let je=e.getUnitAt(be.x,be.y);return!!je&&je.owner==="player"}),gn=mt.length?Math.min(...mt.map(be=>Math.abs(y.position.x-be.x)+Math.abs(y.position.y-be.y))):1/0,Do=mt.length?Math.min(...mt.map(be=>Math.abs(H.x-be.x)+Math.abs(H.y-be.y))):1/0,gc=new Map(e.unitMoveHistorySignal()).get(y.id),ri=Array.isArray(gc)?gc:[],jr=ri.length>=2?ri[ri.length-2]:null,Ht=ri.length>=3?ri[ri.length-3]:null,Zd=jr&&H.x===jr.x&&H.y===jr.y,Hr=jn&&!e.isForest(H.x,H.y);if(D){let be=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),je=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);je<be?(F+=5e7,K="FULL RUSH: Charge Base"):je===be?F+=1e5:F-=5e6,Q&&Q.owner==="player"&&Math.abs(Q.position.x-a.x)+Math.abs(Q.position.y-a.y)<be&&(F+=2e7,K="FULL RUSH: Clear Path to Base"),jn&&H.x===y.position.x&&H.y===y.position.y&&p>=3&&(F=-5e6,K="FULL RUSH: Abandon Forest for Assault")}else if(y.tier>=3&&Hr){let be=Math.abs(H.x-a.x)+Math.abs(H.y-a.y)<=2,je=S.some(Vt=>Math.abs(H.x-Vt.position.x)+Math.abs(H.y-Vt.position.y)<=2),Ct=e.unitsSignal().some(Vt=>Vt.owner==="ai"&&Vt.id!==y.id&&Math.max(Math.abs(Vt.position.x-y.position.x),Math.abs(Vt.position.y-y.position.y))<=1);!M&&!(be||je)&&!Ct&&(F-=2e6,K="Penalty: Leaving forest without replacement")}let $r=ne.get(y.id),x0=$r&&$r.until>e.turnSignal()&&$r.tiles.has(`${H.x},${H.y}`);if(y.tier===1&&(jr&&H.x===jr.x&&H.y===jr.y||Ht&&H.x===Ht.x&&H.y===Ht.y)&&(F-=25e3,K="Anti-Loop Penalty"),y.tier<=2&&!Q&&Ht&&H.x===Ht.x&&H.y===Ht.y&&(F=-1e6,K="Anti-Loop: Stay or different path"),x0&&(F-=3e4,K="Stutter Ban Penalty"),jn&&rr.length===0&&!Q&&Hr&&!ie&&(F=-1e3),jn&&y.tier<=2&&Hr&&rr.length>0&&rr.some(je=>this.combat.calculateTotalPoints(je)>this.combat.calculateTotalPoints(y))&&(F=-1e6,K="Hold Forest"),D)jn&&H.x===y.position.x&&H.y===y.position.y&&p>=3&&(F=-5e6,K="FULL RUSH: Abandon Forest for Assault");else if(!Q&&jn&&H.x===y.position.x&&H.y===y.position.y){let be=rr.some(Ct=>this.combat.calculateTotalPoints(Ct)>this.combat.calculateTotalPoints(y)),je=M&&y.tier>=3;!be&&!je&&(F=Math.max(F,1e7),K="Hold: Stay on forest")}if(!Q&&!D){if(e.isForest(H.x,H.y)&&!e.getUnitAt(H.x,H.y)&&(vs?(F=-1e3,K="Ignore Forest (Total War)"):y.tier>=3?(F=5e6*(Ie&&!ie?3:1),K="Priority: T3 capture empty forest"):(F=1e6*(Ie&&!ie?3:1),K=p<3?`Priority 0: Capture Forest ${H.x},${H.y}`:`Priority 1: Capture Forest ${H.x},${H.y}`,Ie&&!ie&&Math.abs(y.position.x-H.x)+Math.abs(y.position.y-H.y)===1&&(F=Math.max(F,12e6),K=`Early Capture: Forest ${H.x},${H.y}`))),re){let be=Math.abs(y.position.x-re.x)+Math.abs(y.position.y-re.y),je=Math.abs(H.x-re.x)+Math.abs(H.y-re.y);if(je<be&&(F+=5e4*(be-je),K=d.length>0?`Priority 1: Toward Forest ${re.x},${re.y}`:h.length>0?`Priority 7: Toward Fog Forest ${re.x},${re.y}`:`Toward Goal ${re.x},${re.y}`),g>10||w){let Vt=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),Nt=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);Nt<Vt&&(F+=15e4*(Vt-Nt),K="Aggress: Toward Player Base"),Do<gn&&(F+=12e4*(gn-Do),K="Aggress: Toward Player Forest");let mn=Te(H)-Te(y.position);mn>0&&(F+=5e4*mn,K="Unblock: Clear path")}if((()=>{let Vt=Math.sign(re.x-y.position.x),Nt=Math.sign(re.y-y.position.y),mn=y.position.x+(Vt!==0?Vt:0),Pt=y.position.y+(Nt!==0?Nt:0);return e.inBounds(mn,Pt)?!!e.getWallBetween(y.position.x,y.position.y,mn,Pt):!1})()&&H.x===y.position.x&&H.y===y.position.y){let Nt=e.getWallBetween(y.position.x,y.position.y,y.position.x+Math.sign(re.x-y.position.x),y.position.y+Math.sign(re.y-y.position.y))?.owner;y.tier>=3?(F=Math.max(F,8e6+o),K="Breach: Wall blocks high-priority path"):(F+=(Nt==="ai"?7e5:8e5)+o,K=Nt==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(Rt){let be=Math.abs(y.position.x-Rt.x)+Math.abs(y.position.y-Rt.y),je=Math.abs(H.x-Rt.x)+Math.abs(H.y-Rt.y);je<be&&(F+=2e5*(be-je),K="Approach Neutral Wall to Forest"),H.x===Rt.x&&H.y===Rt.y&&(F+=5e5,K="Position for Wall Breach")}if(H.x===a.x&&H.y===a.y&&(F+=1e4,K="Attack Base (Override)"),Ae){let be=st.some(Pt=>Pt.x===H.x&&Pt.y===H.y),je=Math.abs(y.position.x-Ae.position.x)+Math.abs(y.position.y-Ae.position.y),Ct=Math.abs(H.x-Ae.position.x)+Math.abs(H.y-Ae.position.y),Nt=Math.max(Math.abs(Ae.position.x-s.x),Math.abs(Ae.position.y-s.y))<=2,mn=H.x===y.position.x&&H.y===y.position.y;if(y.tier>=3&&Ae.tier>=3&&Ct===1)F=4e7,K="DEFENSE: T3 Move to Intercept Threat";else if(be){let Pt=Nt?25e5:15e5;F<Pt&&(F=Pt),F+=Nt?2e4:5e3,K=Nt?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(Ct<je){let Pt=y.id===(jt?.id??"")?1e6:5e3;F+=Pt*(je-Ct),y.tier>=3&&(F+=4e3),K=y.id===(jt?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}mn&&_s&&(F-=Nt?5e4:1e4,xe?K="Penalty: Standing Still With Imminent Base Threat":ie&&(K="Penalty: Standing Still With Base Threat"))}if(y.tier>=3){let be=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),je=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);je<be&&(F+=2e3*(be-je),K="Hunter: Toward Base",M&&(F=Math.max(F,4e6),K="Hunt: Approach Base"))}if(ze&&wt<dt&&(F*=10),Ze>Fe&&wt<dt&&(F+=500),Co&&this.combat.calculateTotalPoints(Co)>this.combat.calculateTotalPoints(y)){let be=Math.abs(y.position.x-Co.position.x)+Math.abs(y.position.y-Co.position.y),je=Math.abs(H.x-Co.position.x)+Math.abs(H.y-Co.position.y);je>be&&(F+=75e3*(je-be),K="Retreat")}}else if(Q.owner==="player"){let be=Math.max(Math.abs(Q.position.x-s.x),Math.abs(Q.position.y-s.y)),je=be<=3,Ct=be<=2,Vt=this.combat.calculateTotalPoints(y),Nt=this.combat.calculateTotalPoints(Q),mn=Vt>Nt,Pt=Q.tier>=3,Es=y.tier>=3;y.tier>=3&&e.isForest(Q.position.x,Q.position.y)&&(F=1e7,K="Aggression: Liberate forest"),!jn&&pe&&mt.length>0&&e.isForest(Q.position.x,Q.position.y)&&(F=12e6,K="LIBERATE: Attack player forest"),be<=4&&(y.tier>=3||mn)&&(F=15e6,K="INTERCEPT: Base Siege"),je?Es&&Pt?(F=5e7,K="CRITICAL DEFENSE: T3 Intercepts Threat"):mn?(F=2e7,K="CRITICAL DEFENSE: Eliminate Base Threat",Ct&&(F+=5e6)):Pt&&y.tier<=2?(F=0,K="Ignore: T1 Suicide vs T3 useless"):(F=1e3,K="DEFENSE: Desperation Attack"):mn?(Pt?(F=8e6,K="COMBAT: Kill High Value Target (T3+)"):(F=4e6,K="COMBAT: Kill Enemy"),y.tier<Q.tier&&(F+=2e6,K+=" (Efficient Trade)")):y.tier<=2?(F=0,K="Ignore: No guaranteed kill"):(F=1e5,K="COMBAT: Chip Damage"),R&&(F+=5e5),P&&(F+=1e6)}else if(Q.tier===y.tier&&Ze>Fe){let be=this.combat.calculateTotalPoints(y)+this.combat.calculateTotalPoints(Q),{tier:je}=this.combat.calculateTierAndLevel(be);je>y.tier&&!ze&&!jn&&(F=1e3,K="Merge Up")}let Oi="move";Q&&Q.owner==="player"&&(Oi="attack"),Q&&Q.owner==="ai"&&Q.tier===y.tier&&(Oi="merge"),(g>10||w)&&Oi==="merge"&&(F+=5e6,K="Anti-Stall: Merge first");let S0=this.interceptUntil.get(y.id)||0;if(y.id===(jt?.id??"")&&S0>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Ae){let be=Math.abs(y.position.x-Ae.position.x)+Math.abs(y.position.y-Ae.position.y),je=Math.abs(H.x-Ae.position.x)+Math.abs(H.y-Ae.position.y);je<be&&(F+=5e5*(be-je),K="DEFENSE: Intercept Lock")}Zd&&(F=Math.floor(F*.1),F-=3e5,K="Penalty: Inertia");let I0=(()=>{let be=ri.slice(-6),je=new Set(be.map(Ct=>`${Ct.x},${Ct.y}`));return be.length>=6&&je.size<=3})();if(y.tier===1&&I0){let be=d.length>0?d:h;if(be.length>0){let je=be.reduce((Nt,mn)=>{let Pt=Math.abs(y.position.x-mn.x)+Math.abs(y.position.y-mn.y),Es=Math.abs(y.position.x-Nt.x)+Math.abs(y.position.y-Nt.y);return Pt<Es?mn:Nt},be[0]),Ct=Math.abs(y.position.x-je.x)+Math.abs(y.position.y-je.y),Vt=Math.abs(H.x-je.x)+Math.abs(H.y-je.y);Vt<Ct&&(F+=1e5*(Ct-Vt),K="Breakout: Toward Forest")}}(y.forestOccupationTurns??0)>0&&(H.x!==y.position.x||H.y!==y.position.y)&&(F-=2e3),(ce===null||F>ce.score)&&(ce={unit:y,target:H,score:F,type:Oi,reason:K})}}if(!ce)return null;let ye=this.goals.get(ce.unit.id),ge=ye?`Goal: Forest at ${ye.x},${ye.y}`:"Goal: None";return{type:ce.type,unit:ce.unit,target:ce.target,reason:ce.reason,edge:ce.edge}}getWallBuildActions(e){let t=[],i=e.unitsSignal().filter(d=>d.owner==="ai"),r=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,h)=>o.some(p=>p.tile1.x===d.x&&p.tile1.y===d.y&&p.tile2.x===h.x&&p.tile2.y===h.y||p.tile1.x===h.x&&p.tile1.y===h.y&&p.tile2.x===d.x&&p.tile2.y===d.y),l=(d,h)=>Math.abs(d.x-h.x)+Math.abs(d.y-h.y),u=(d,h)=>Math.max(Math.abs(d.x-h.x),Math.abs(d.y-h.y));for(let d of i){if(d.tier>=3)continue;let h=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(S=>e.inBounds(S.x,S.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let S of h)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});continue}let p=r.filter(S=>u(d.position,S.position)<=2);if(p.length===0)continue;let g=p.sort((S,P)=>l(d.position,S.position)-l(d.position,P.position))[0],w=h.sort((S,P)=>l(S,g.position)-l(P,g.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let S of w)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});else if(d.tier===2){let S=0;for(let P of w){if(S>=2)break;!a(d.position,P)&&e.canBuildWallBetween(d.position,P)&&(t.push({from:d.position,to:P}),S++)}}}return t}static \u0275fac=function(t){return new(t||n)(Re(Cl),Re(Kt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var qR=()=>{};var YR=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},tj=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=n[t++],s=n[t++],a=n[t++],l=((r&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63)}}return e.join("")},JR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,a=s?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,d=o>>2,h=(o&3)<<4|a>>4,p=(a&15)<<2|u>>6,g=u&63;l||(g=64,s||(p=64)),i.push(t[d],t[h],t[p],t[g])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(YR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):tj(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let u=r<n.length?t[n.charAt(r)]:64;++r;let h=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||a==null||u==null||h==null)throw new mb;let p=o<<2|a>>4;if(i.push(p),u!==64){let g=a<<4&240|u>>2;if(i.push(g),h!==64){let w=u<<6&192|h;i.push(w)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},mb=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},nj=function(n){let e=YR(n);return JR.encodeByteArray(e,!0)},rd=function(n){return nj(n).replace(/\./g,"")},Tg=function(n){try{return JR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ZR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var ij=()=>ZR().__FIREBASE_DEFAULTS__,rj=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},oj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Tg(n[1]);return e&&JSON.parse(e)},Cg=()=>{try{return qR()||ij()||rj()||oj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},vb=n=>Cg()?.emulatorHosts?.[n],XR=n=>{let e=vb(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},_b=()=>Cg()?.config,Eb=n=>Cg()?.[`_${n}`];var Ig=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function ns(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Dg(n){return(await fetch(n,{credentials:"include"})).ok}function eN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=L({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[rd(JSON.stringify(t)),rd(JSON.stringify(s)),""].join(".")}var id={};function sj(){let n={prod:[],emulator:[]};for(let e of Object.keys(id))id[e]?n.emulator.push(e):n.prod.push(e);return n}function aj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var KR=!1;function Ag(n,e){if(typeof window>"u"||typeof document>"u"||!ns(window.location.host)||id[n]===e||id[n]||KR)return;id[n]=e;function t(p){return`__firebase__banner__${p}`}let i="__firebase__banner",o=sj().prod.length>0;function s(){let p=document.getElementById(i);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){let p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{KR=!0,s()},p}function d(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function h(){let p=aj(i),g=t("text"),w=document.getElementById(g)||document.createElement("span"),S=t("learnmore"),P=document.getElementById(S)||document.createElement("a"),U=t("preprendIcon"),ie=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){let Se=p.element;a(Se),d(P,S);let xe=u();l(ie,U),Se.append(ie,w,P,xe),document.body.appendChild(Se)}o?(w.innerText="Preview backend disconnected.",ie.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ie.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function bn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bn())}function lj(){let n=Cg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iN(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function rN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oN(){let n=bn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function sN(){return!lj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bb(){try{return typeof indexedDB=="object"}catch{return!1}}function aN(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var cj="FirebaseError",vi=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=cj,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ao.prototype.create)}},ao=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?uj(o,i):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new vi(r,a,i)}};function uj(n,e){return n.replace(dj,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var dj=/\{\$([^}]+)}/g;function lN(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zi(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(QR(o)&&QR(s)){if(!Zi(o,s))return!1}else if(o!==s)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function QR(n){return n!==null&&typeof n=="object"}function Dl(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function cN(n,e){let t=new yb(n,e);return t.subscribe.bind(t)}var yb=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");hj(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=gb),r.error===void 0&&(r.error=gb),r.complete===void 0&&(r.complete=gb);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function hj(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function gb(){}var jce=14400*1e3;function wn(n){return n&&n._delegate?n._delegate:n}var Ri=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var ua="[DEFAULT]";var wb=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Ig;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pj(e))try{this.getOrInitializeService({instanceIdentifier:ua})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=ua){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ua){return this.instances.has(e)}getOptions(e=ua){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&s.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:fj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ua){return this.component?this.component.multipleInstances?e:ua:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function fj(n){return n===ua?void 0:n}function pj(n){return n.instantiationMode==="EAGER"}var Mg=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new wb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var gj=[],Xe=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Xe||{}),mj={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},yj=Xe.INFO,vj={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},_j=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=vj[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},is=class{constructor(e){this.name=e,this._logLevel=yj,this._logHandler=_j,this._userLogHandler=null,gj.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}};var Ej=(n,e)=>e.some(t=>n instanceof t),uN,dN;function bj(){return uN||(uN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wj(){return dN||(dN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var hN=new WeakMap,Sb=new WeakMap,fN=new WeakMap,xb=new WeakMap,Tb=new WeakMap;function xj(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Dr(n.result)),r()},s=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&hN.set(t,n)}).catch(()=>{}),Tb.set(e,n),e}function Sj(n){if(Sb.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Sb.set(n,e)}var Ib={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Sb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Dr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function pN(n){Ib=n(Ib)}function Ij(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(Rg(this),e,...t);return fN.set(i,e.sort?e.sort():[e]),Dr(i)}:wj().includes(n)?function(...e){return n.apply(Rg(this),e),Dr(hN.get(this))}:function(...e){return Dr(n.apply(Rg(this),e))}}function Tj(n){return typeof n=="function"?Ij(n):(n instanceof IDBTransaction&&Sj(n),Ej(n,bj())?new Proxy(n,Ib):n)}function Dr(n){if(n instanceof IDBRequest)return xj(n);if(xb.has(n))return xb.get(n);let e=Tj(n);return e!==n&&(xb.set(n,e),Tb.set(e,n)),e}var Rg=n=>Tb.get(n);function mN(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),a=Dr(s);return i&&s.addEventListener("upgradeneeded",l=>{i(Dr(s.result),l.oldVersion,l.newVersion,Dr(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var Cj=["get","getKey","getAll","getAllKeys","count"],Dj=["put","add","delete","clear"],Cb=new Map;function gN(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Cb.get(e))return Cb.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Dj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Cj.includes(t)))return;let o=async function(s,...a){let l=this.transaction(s,r?"readwrite":"readonly"),u=l.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),r&&l.done]))[0]};return Cb.set(e,o),o}pN(n=>me(L({},n),{get:(e,t,i)=>gN(e,t)||n.get(e,t,i),has:(e,t)=>!!gN(e,t)||n.has(e,t)}));var Ab=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Aj(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function Aj(n){return n.getComponent()?.type==="VERSION"}var Mb="@firebase/app",yN="0.14.7";var lo=new is("@firebase/app"),Mj="@firebase/app-compat",Rj="@firebase/analytics-compat",Nj="@firebase/analytics",Pj="@firebase/app-check-compat",kj="@firebase/app-check",Oj="@firebase/auth",Fj="@firebase/auth-compat",Lj="@firebase/database",Vj="@firebase/data-connect",Uj="@firebase/database-compat",Bj="@firebase/functions",jj="@firebase/functions-compat",Hj="@firebase/installations",$j="@firebase/installations-compat",Gj="@firebase/messaging",zj="@firebase/messaging-compat",Wj="@firebase/performance",qj="@firebase/performance-compat",Kj="@firebase/remote-config",Qj="@firebase/remote-config-compat",Yj="@firebase/storage",Jj="@firebase/storage-compat",Zj="@firebase/firestore",Xj="@firebase/ai",e9="@firebase/firestore-compat",t9="firebase",n9="12.8.0";var Rb="[DEFAULT]",i9={[Mb]:"fire-core",[Mj]:"fire-core-compat",[Nj]:"fire-analytics",[Rj]:"fire-analytics-compat",[kj]:"fire-app-check",[Pj]:"fire-app-check-compat",[Oj]:"fire-auth",[Fj]:"fire-auth-compat",[Lj]:"fire-rtdb",[Vj]:"fire-data-connect",[Uj]:"fire-rtdb-compat",[Bj]:"fire-fn",[jj]:"fire-fn-compat",[Hj]:"fire-iid",[$j]:"fire-iid-compat",[Gj]:"fire-fcm",[zj]:"fire-fcm-compat",[Wj]:"fire-perf",[qj]:"fire-perf-compat",[Kj]:"fire-rc",[Qj]:"fire-rc-compat",[Yj]:"fire-gcs",[Jj]:"fire-gcs-compat",[Zj]:"fire-fst",[e9]:"fire-fst-compat",[Xj]:"fire-vertex","fire-js":"fire-js",[t9]:"fire-js-all"};var Ng=new Map,r9=new Map,Nb=new Map;function vN(n,e){try{n.container.addComponent(e)}catch(t){lo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function os(n){let e=n.name;if(Nb.has(e))return lo.debug(`There were multiple attempts to register component ${e}.`),!1;Nb.set(e,n);for(let t of Ng.values())vN(t,n);for(let t of r9.values())vN(t,n);return!0}function sd(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function _i(n){return n==null?!1:n.settings!==void 0}var o9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},rs=new ao("app","Firebase",o9);var Pb=class{constructor(e,t,i){this._isDeleted=!1,this._options=L({},e),this._config=L({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw rs.create("app-deleted",{appName:this._name})}};var ss=n9;function ad(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=L({name:Rb,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw rs.create("bad-app-name",{appName:String(r)});if(t||(t=_b()),!t)throw rs.create("no-options");let o=Ng.get(r);if(o){if(Zi(t,o.options)&&Zi(i,o.config))return o;throw rs.create("duplicate-app",{appName:r})}let s=new Mg(r);for(let l of Nb.values())s.addComponent(l);let a=new Pb(t,i,s);return Ng.set(r,a),a}function Pg(n=Rb){let e=Ng.get(n);if(!e&&n===Rb&&_b())return ad();if(!e)throw rs.create("no-app",{appName:n});return e}function Xi(n,e,t){let i=i9[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let s=[`Unable to register library "${i}" with version "${e}":`];r&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),lo.warn(s.join(" "));return}os(new Ri(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var s9="firebase-heartbeat-database",a9=1,od="firebase-heartbeat-store",Db=null;function wN(){return Db||(Db=mN(s9,a9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(od)}catch(t){console.warn(t)}}}}).catch(n=>{throw rs.create("idb-open",{originalErrorMessage:n.message})})),Db}async function l9(n){try{let t=(await wN()).transaction(od),i=await t.objectStore(od).get(xN(n));return await t.done,i}catch(e){if(e instanceof vi)lo.warn(e.message);else{let t=rs.create("idb-get",{originalErrorMessage:e?.message});lo.warn(t.message)}}}async function _N(n,e){try{let i=(await wN()).transaction(od,"readwrite");await i.objectStore(od).put(e,xN(n)),await i.done}catch(t){if(t instanceof vi)lo.warn(t.message);else{let i=rs.create("idb-set",{originalErrorMessage:t?.message});lo.warn(i.message)}}}function xN(n){return`${n.name}!${n.options.appId}`}var c9=1024,u9=30,kb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Ob(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=EN();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>u9){let r=h9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){lo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=EN(),{heartbeatsToSend:t,unsentEntries:i}=d9(this._heartbeatsCache.heartbeats),r=rd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return lo.warn(e),""}}};function EN(){return new Date().toISOString().substring(0,10)}function d9(n,e=c9){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),bN(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),bN(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Ob=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bb()?aN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await l9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return _N(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return _N(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function bN(n){return rd(JSON.stringify({version:2,heartbeats:n})).length}function h9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function f9(n){os(new Ri("platform-logger",e=>new Ab(e),"PRIVATE")),os(new Ri("heartbeat",e=>new kb(e),"PRIVATE")),Xi(Mb,yN,n),Xi(Mb,yN,"esm2020"),Xi("fire-js","")}f9("");var p9="firebase",g9="12.8.0";Xi(p9,g9,"app");var SN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},IN={};var co,Fb;(function(){var n;function e(k,I){function N(){}N.prototype=I.prototype,k.F=I.prototype,k.prototype=new N,k.prototype.constructor=k,k.D=function(D,b,R){for(var M=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)M[pe-2]=arguments[pe];return I.prototype[b].apply(D,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,I,N){N||(N=0);let D=Array(16);if(typeof I=="string")for(var b=0;b<16;++b)D[b]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(b=0;b<16;++b)D[b]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=k.g[0],N=k.g[1],b=k.g[2];let R=k.g[3],M;M=I+(R^N&(b^R))+D[0]+3614090360&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(b^I&(N^b))+D[1]+3905402710&4294967295,R=I+(M<<12&4294967295|M>>>20),M=b+(N^R&(I^N))+D[2]+606105819&4294967295,b=R+(M<<17&4294967295|M>>>15),M=N+(I^b&(R^I))+D[3]+3250441966&4294967295,N=b+(M<<22&4294967295|M>>>10),M=I+(R^N&(b^R))+D[4]+4118548399&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(b^I&(N^b))+D[5]+1200080426&4294967295,R=I+(M<<12&4294967295|M>>>20),M=b+(N^R&(I^N))+D[6]+2821735955&4294967295,b=R+(M<<17&4294967295|M>>>15),M=N+(I^b&(R^I))+D[7]+4249261313&4294967295,N=b+(M<<22&4294967295|M>>>10),M=I+(R^N&(b^R))+D[8]+1770035416&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(b^I&(N^b))+D[9]+2336552879&4294967295,R=I+(M<<12&4294967295|M>>>20),M=b+(N^R&(I^N))+D[10]+4294925233&4294967295,b=R+(M<<17&4294967295|M>>>15),M=N+(I^b&(R^I))+D[11]+2304563134&4294967295,N=b+(M<<22&4294967295|M>>>10),M=I+(R^N&(b^R))+D[12]+1804603682&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(b^I&(N^b))+D[13]+4254626195&4294967295,R=I+(M<<12&4294967295|M>>>20),M=b+(N^R&(I^N))+D[14]+2792965006&4294967295,b=R+(M<<17&4294967295|M>>>15),M=N+(I^b&(R^I))+D[15]+1236535329&4294967295,N=b+(M<<22&4294967295|M>>>10),M=I+(b^R&(N^b))+D[1]+4129170786&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^b&(I^N))+D[6]+3225465664&4294967295,R=I+(M<<9&4294967295|M>>>23),M=b+(I^N&(R^I))+D[11]+643717713&4294967295,b=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(b^R))+D[0]+3921069994&4294967295,N=b+(M<<20&4294967295|M>>>12),M=I+(b^R&(N^b))+D[5]+3593408605&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^b&(I^N))+D[10]+38016083&4294967295,R=I+(M<<9&4294967295|M>>>23),M=b+(I^N&(R^I))+D[15]+3634488961&4294967295,b=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(b^R))+D[4]+3889429448&4294967295,N=b+(M<<20&4294967295|M>>>12),M=I+(b^R&(N^b))+D[9]+568446438&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^b&(I^N))+D[14]+3275163606&4294967295,R=I+(M<<9&4294967295|M>>>23),M=b+(I^N&(R^I))+D[3]+4107603335&4294967295,b=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(b^R))+D[8]+1163531501&4294967295,N=b+(M<<20&4294967295|M>>>12),M=I+(b^R&(N^b))+D[13]+2850285829&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^b&(I^N))+D[2]+4243563512&4294967295,R=I+(M<<9&4294967295|M>>>23),M=b+(I^N&(R^I))+D[7]+1735328473&4294967295,b=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(b^R))+D[12]+2368359562&4294967295,N=b+(M<<20&4294967295|M>>>12),M=I+(N^b^R)+D[5]+4294588738&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^b)+D[8]+2272392833&4294967295,R=I+(M<<11&4294967295|M>>>21),M=b+(R^I^N)+D[11]+1839030562&4294967295,b=R+(M<<16&4294967295|M>>>16),M=N+(b^R^I)+D[14]+4259657740&4294967295,N=b+(M<<23&4294967295|M>>>9),M=I+(N^b^R)+D[1]+2763975236&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^b)+D[4]+1272893353&4294967295,R=I+(M<<11&4294967295|M>>>21),M=b+(R^I^N)+D[7]+4139469664&4294967295,b=R+(M<<16&4294967295|M>>>16),M=N+(b^R^I)+D[10]+3200236656&4294967295,N=b+(M<<23&4294967295|M>>>9),M=I+(N^b^R)+D[13]+681279174&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^b)+D[0]+3936430074&4294967295,R=I+(M<<11&4294967295|M>>>21),M=b+(R^I^N)+D[3]+3572445317&4294967295,b=R+(M<<16&4294967295|M>>>16),M=N+(b^R^I)+D[6]+76029189&4294967295,N=b+(M<<23&4294967295|M>>>9),M=I+(N^b^R)+D[9]+3654602809&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^b)+D[12]+3873151461&4294967295,R=I+(M<<11&4294967295|M>>>21),M=b+(R^I^N)+D[15]+530742520&4294967295,b=R+(M<<16&4294967295|M>>>16),M=N+(b^R^I)+D[2]+3299628645&4294967295,N=b+(M<<23&4294967295|M>>>9),M=I+(b^(N|~R))+D[0]+4096336452&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~b))+D[7]+1126891415&4294967295,R=I+(M<<10&4294967295|M>>>22),M=b+(I^(R|~N))+D[14]+2878612391&4294967295,b=R+(M<<15&4294967295|M>>>17),M=N+(R^(b|~I))+D[5]+4237533241&4294967295,N=b+(M<<21&4294967295|M>>>11),M=I+(b^(N|~R))+D[12]+1700485571&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~b))+D[3]+2399980690&4294967295,R=I+(M<<10&4294967295|M>>>22),M=b+(I^(R|~N))+D[10]+4293915773&4294967295,b=R+(M<<15&4294967295|M>>>17),M=N+(R^(b|~I))+D[1]+2240044497&4294967295,N=b+(M<<21&4294967295|M>>>11),M=I+(b^(N|~R))+D[8]+1873313359&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~b))+D[15]+4264355552&4294967295,R=I+(M<<10&4294967295|M>>>22),M=b+(I^(R|~N))+D[6]+2734768916&4294967295,b=R+(M<<15&4294967295|M>>>17),M=N+(R^(b|~I))+D[13]+1309151649&4294967295,N=b+(M<<21&4294967295|M>>>11),M=I+(b^(N|~R))+D[4]+4149444226&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~b))+D[11]+3174756917&4294967295,R=I+(M<<10&4294967295|M>>>22),M=b+(I^(R|~N))+D[2]+718787259&4294967295,b=R+(M<<15&4294967295|M>>>17),M=N+(R^(b|~I))+D[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(b+(M<<21&4294967295|M>>>11))&4294967295,k.g[2]=k.g[2]+b&4294967295,k.g[3]=k.g[3]+R&4294967295}i.prototype.v=function(k,I){I===void 0&&(I=k.length);let N=I-this.blockSize,D=this.C,b=this.h,R=0;for(;R<I;){if(b==0)for(;R<=N;)r(this,k,R),R+=this.blockSize;if(typeof k=="string"){for(;R<I;)if(D[b++]=k.charCodeAt(R++),b==this.blockSize){r(this,D),b=0;break}}else for(;R<I;)if(D[b++]=k[R++],b==this.blockSize){r(this,D),b=0;break}}this.h=b,this.o+=I},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;I=this.o*8;for(var N=k.length-8;N<k.length;++N)k[N]=I&255,I/=256;for(this.v(k),k=Array(16),I=0,N=0;N<4;++N)for(let D=0;D<32;D+=8)k[I++]=this.g[N]>>>D&255;return k};function o(k,I){var N=a;return Object.prototype.hasOwnProperty.call(N,k)?N[k]:N[k]=I(k)}function s(k,I){this.h=I;let N=[],D=!0;for(let b=k.length-1;b>=0;b--){let R=k[b]|0;D&&R==I||(N[b]=R,D=!1)}this.g=N}var a={};function l(k){return-128<=k&&k<128?o(k,function(I){return new s([I|0],I<0?-1:0)}):new s([k|0],k<0?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return h;if(k<0)return P(u(-k));let I=[],N=1;for(let D=0;k>=N;D++)I[D]=k/N|0,N*=4294967296;return new s(I,0)}function d(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return P(d(k.substring(1),I));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');let N=u(Math.pow(I,8)),D=h;for(let R=0;R<k.length;R+=8){var b=Math.min(8,k.length-R);let M=parseInt(k.substring(R,R+b),I);b<8?(b=u(Math.pow(I,b)),D=D.j(b).add(u(M))):(D=D.j(N),D=D.add(u(M)))}return D}var h=l(0),p=l(1),g=l(16777216);n=s.prototype,n.m=function(){if(S(this))return-P(this).m();let k=0,I=1;for(let N=0;N<this.g.length;N++){let D=this.i(N);k+=(D>=0?D:4294967296+D)*I,I*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(w(this))return"0";if(S(this))return"-"+P(this).toString(k);let I=u(Math.pow(k,6));var N=this;let D="";for(;;){let b=xe(N,I).g;N=U(N,b.j(I));let R=((N.g.length>0?N.g[0]:N.h)>>>0).toString(k);if(N=b,w(N))return R+D;for(;R.length<6;)R="0"+R;D=R+D}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function w(k){if(k.h!=0)return!1;for(let I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function S(k){return k.h==-1}n.l=function(k){return k=U(this,k),S(k)?-1:w(k)?0:1};function P(k){let I=k.g.length,N=[];for(let D=0;D<I;D++)N[D]=~k.g[D];return new s(N,~k.h).add(p)}n.abs=function(){return S(this)?P(this):this},n.add=function(k){let I=Math.max(this.g.length,k.g.length),N=[],D=0;for(let b=0;b<=I;b++){let R=D+(this.i(b)&65535)+(k.i(b)&65535),M=(R>>>16)+(this.i(b)>>>16)+(k.i(b)>>>16);D=M>>>16,R&=65535,M&=65535,N[b]=M<<16|R}return new s(N,N[N.length-1]&-2147483648?-1:0)};function U(k,I){return k.add(P(I))}n.j=function(k){if(w(this)||w(k))return h;if(S(this))return S(k)?P(this).j(P(k)):P(P(this).j(k));if(S(k))return P(this.j(P(k)));if(this.l(g)<0&&k.l(g)<0)return u(this.m()*k.m());let I=this.g.length+k.g.length,N=[];for(var D=0;D<2*I;D++)N[D]=0;for(D=0;D<this.g.length;D++)for(let b=0;b<k.g.length;b++){let R=this.i(D)>>>16,M=this.i(D)&65535,pe=k.i(b)>>>16,Oe=k.i(b)&65535;N[2*D+2*b]+=M*Oe,ie(N,2*D+2*b),N[2*D+2*b+1]+=R*Oe,ie(N,2*D+2*b+1),N[2*D+2*b+1]+=M*pe,ie(N,2*D+2*b+1),N[2*D+2*b+2]+=R*pe,ie(N,2*D+2*b+2)}for(k=0;k<I;k++)N[k]=N[2*k+1]<<16|N[2*k];for(k=I;k<2*I;k++)N[k]=0;return new s(N,0)};function ie(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function Se(k,I){this.g=k,this.h=I}function xe(k,I){if(w(I))throw Error("division by zero");if(w(k))return new Se(h,h);if(S(k))return I=xe(P(k),I),new Se(P(I.g),P(I.h));if(S(I))return I=xe(k,P(I)),new Se(P(I.g),I.h);if(k.g.length>30){if(S(k)||S(I))throw Error("slowDivide_ only works with positive integers.");for(var N=p,D=I;D.l(k)<=0;)N=De(N),D=De(D);var b=Ie(N,1),R=Ie(D,1);for(D=Ie(D,2),N=Ie(N,2);!w(D);){var M=R.add(D);M.l(k)<=0&&(b=b.add(N),R=M),D=Ie(D,1),N=Ie(N,1)}return I=U(k,b.j(I)),new Se(b,I)}for(b=h;k.l(I)>=0;){for(N=Math.max(1,Math.floor(k.m()/I.m())),D=Math.ceil(Math.log(N)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),R=u(N),M=R.j(I);S(M)||M.l(k)>0;)N-=D,R=u(N),M=R.j(I);w(R)&&(R=p),b=b.add(R),k=U(k,M)}return new Se(b,k)}n.B=function(k){return xe(this,k).h},n.and=function(k){let I=Math.max(this.g.length,k.g.length),N=[];for(let D=0;D<I;D++)N[D]=this.i(D)&k.i(D);return new s(N,this.h&k.h)},n.or=function(k){let I=Math.max(this.g.length,k.g.length),N=[];for(let D=0;D<I;D++)N[D]=this.i(D)|k.i(D);return new s(N,this.h|k.h)},n.xor=function(k){let I=Math.max(this.g.length,k.g.length),N=[];for(let D=0;D<I;D++)N[D]=this.i(D)^k.i(D);return new s(N,this.h^k.h)};function De(k){let I=k.g.length+1,N=[];for(let D=0;D<I;D++)N[D]=k.i(D)<<1|k.i(D-1)>>>31;return new s(N,k.h)}function Ie(k,I){let N=I>>5;I%=32;let D=k.g.length-N,b=[];for(let R=0;R<D;R++)b[R]=I>0?k.i(R+N)>>>I|k.i(R+N+1)<<32-I:k.i(R+N);return new s(b,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Fb=IN.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=d,co=IN.Integer=s}).apply(typeof SN<"u"?SN:typeof self<"u"?self:typeof window<"u"?window:{});var kg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uo={};var Lb,m9,Al,Vb,ld,Og,Ub,Bb,jb;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof kg=="object"&&kg];for(var f=0;f<c.length;++f){var m=c[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var i=t(this);function r(c,f){if(f)e:{var m=i;c=c.split(".");for(var T=0;T<c.length-1;T++){var V=c[T];if(!(V in m))break e;m=m[V]}c=c[c.length-1],T=m[c],f=f(T),f!=T&&f!=null&&e(m,c,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(f){var m=[],T;for(T in f)Object.prototype.hasOwnProperty.call(f,T)&&m.push([T,f[T]]);return m}});var o=o||{},s=this||self;function a(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function l(c,f,m){return c.call.apply(c.bind,arguments)}function u(c,f,m){return u=l,u.apply(null,arguments)}function d(c,f){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),c.apply(this,T)}}function h(c,f){function m(){}m.prototype=f.prototype,c.Z=f.prototype,c.prototype=new m,c.prototype.constructor=c,c.Ob=function(T,V,j){for(var ae=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)ae[Ye-2]=arguments[Ye];return f.prototype[V].apply(T,ae)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){let f=c.length;if(f>0){let m=Array(f);for(let T=0;T<f;T++)m[T]=c[T];return m}return[]}function w(c,f){for(let T=1;T<arguments.length;T++){let V=arguments[T];var m=typeof V;if(m=m!="object"?m:V?Array.isArray(V)?"array":m:"null",m=="array"||m=="object"&&typeof V.length=="number"){m=c.length||0;let j=V.length||0;c.length=m+j;for(let ae=0;ae<j;ae++)c[m+ae]=V[ae]}else c.push(V)}}class S{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function P(c){s.setTimeout(()=>{throw c},0)}function U(){var c=k;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class ie{constructor(){this.h=this.g=null}add(f,m){let T=Se.get();T.set(f,m),this.h?this.h.next=T:this.g=T,this.h=T}}var Se=new S(()=>new xe,c=>c.reset());class xe{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let De,Ie=!1,k=new ie,I=()=>{let c=Promise.resolve(void 0);De=()=>{c.then(N)}};function N(){for(var c;c=U();){try{c.h.call(c.g)}catch(m){P(m)}var f=Se;f.j(c),f.h<100&&(f.h++,c.next=f.g,f.g=c)}Ie=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let m=()=>{};s.addEventListener("test",m,f),s.removeEventListener("test",m,f)}catch{}return c})();function M(c){return/^[\s\xa0]*$/.test(c)}function pe(c,f){b.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,f)}h(pe,b),pe.prototype.init=function(c,f){let m=this.type=c.type,T=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget,f||(m=="mouseover"?f=c.fromElement:m=="mouseout"&&(f=c.toElement)),this.relatedTarget=f,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&pe.Z.h.call(this)},pe.prototype.h=function(){pe.Z.h.call(this);let c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Oe="closure_listenable_"+(Math.random()*1e6|0),ce=0;function Lt(c,f,m,T,V){this.listener=c,this.proxy=null,this.src=f,this.type=m,this.capture=!!T,this.ha=V,this.key=++ce,this.da=this.fa=!1}function Yt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Ae(c,f,m){for(let T in c)f.call(m,c[T],T,c)}function jt(c,f){for(let m in c)f.call(void 0,c[m],m,c)}function st(c){let f={};for(let m in c)f[m]=c[m];return f}let te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(c,f){let m,T;for(let V=1;V<arguments.length;V++){T=arguments[V];for(m in T)c[m]=T[m];for(let j=0;j<te.length;j++)m=te[j],Object.prototype.hasOwnProperty.call(T,m)&&(c[m]=T[m])}}function _e(c){this.src=c,this.g={},this.h=0}_e.prototype.add=function(c,f,m,T,V){let j=c.toString();c=this.g[j],c||(c=this.g[j]=[],this.h++);let ae=ge(c,f,T,V);return ae>-1?(f=c[ae],m||(f.fa=!1)):(f=new Lt(f,this.src,j,!!T,V),f.fa=m,c.push(f)),f};function ye(c,f){let m=f.type;if(m in c.g){var T=c.g[m],V=Array.prototype.indexOf.call(T,f,void 0),j;(j=V>=0)&&Array.prototype.splice.call(T,V,1),j&&(Yt(f),c.g[m].length==0&&(delete c.g[m],c.h--))}}function ge(c,f,m,T){for(let V=0;V<c.length;++V){let j=c[V];if(!j.da&&j.listener==f&&j.capture==!!m&&j.ha==T)return V}return-1}var y="closure_lm_"+(Math.random()*1e6|0),oe={};function ze(c,f,m,T,V){if(T&&T.once)return bt(c,f,m,T,V);if(Array.isArray(f)){for(let j=0;j<f.length;j++)ze(c,f[j],m,T,V);return null}return m=pc(m),c&&c[Oe]?c.J(f,m,a(T)?!!T.capture:!!T,V):We(c,f,m,!1,T,V)}function We(c,f,m,T,V,j){if(!f)throw Error("Invalid event type");let ae=a(V)?!!V.capture:!!V,Ye=jn(c);if(Ye||(c[y]=Ye=new _e(c)),m=Ye.add(f,m,T,ae,j),m.proxy)return m;if(T=re(),m.proxy=T,T.src=c,T.listener=m,c.addEventListener)R||(V=ae),V===void 0&&(V=!1),c.addEventListener(f.toString(),T,V);else if(c.attachEvent)c.attachEvent(vs(f.toString()),T);else if(c.addListener&&c.removeListener)c.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function re(){function c(m){return f.call(c.src,c.listener,m)}let f=Jd;return c}function bt(c,f,m,T,V){if(Array.isArray(f)){for(let j=0;j<f.length;j++)bt(c,f[j],m,T,V);return null}return m=pc(m),c&&c[Oe]?c.K(f,m,a(T)?!!T.capture:!!T,V):We(c,f,m,!0,T,V)}function Ei(c,f,m,T,V){if(Array.isArray(f))for(var j=0;j<f.length;j++)Ei(c,f[j],m,T,V);else T=a(T)?!!T.capture:!!T,m=pc(m),c&&c[Oe]?(c=c.i,j=String(f).toString(),j in c.g&&(f=c.g[j],m=ge(f,m,T,V),m>-1&&(Yt(f[m]),Array.prototype.splice.call(f,m,1),f.length==0&&(delete c.g[j],c.h--)))):c&&(c=jn(c))&&(f=c.g[f.toString()],c=-1,f&&(c=ge(f,m,T,V)),(m=c>-1?f[c]:null)&&ii(m))}function ii(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[Oe])ye(f.i,c);else{var m=c.type,T=c.proxy;f.removeEventListener?f.removeEventListener(m,T,c.capture):f.detachEvent?f.detachEvent(vs(m),T):f.addListener&&f.removeListener&&f.removeListener(T),(m=jn(f))?(ye(m,c),m.h==0&&(m.src=null,f[y]=null)):Yt(c)}}}function vs(c){return c in oe?oe[c]:oe[c]="on"+c}function Jd(c,f){if(c.da)c=!0;else{f=new pe(f,this);let m=c.listener,T=c.ha||c.src;c.fa&&ii(c),c=m.call(T,f)}return c}function jn(c){return c=c[y],c instanceof _e?c:null}var fc="__closure_events_fn_"+(Math.random()*1e9>>>0);function pc(c){return typeof c=="function"?c:(c[fc]||(c[fc]=function(f){return c.handleEvent(f)}),c[fc])}function In(){D.call(this),this.i=new _e(this),this.M=this,this.G=null}h(In,D),In.prototype[Oe]=!0,In.prototype.removeEventListener=function(c,f,m,T){Ei(this,c,f,m,T)};function Rt(c,f){var m,T=c.G;if(T)for(m=[];T;T=T.G)m.push(T);if(c=c.M,T=f.type||f,typeof f=="string")f=new b(f,c);else if(f instanceof b)f.target=f.target||c;else{var V=f;f=new b(T,c),ne(f,V)}V=!0;let j,ae;if(m)for(ae=m.length-1;ae>=0;ae--)j=f.g=m[ae],V=Br(j,T,!0,f)&&V;if(j=f.g=c,V=Br(j,T,!0,f)&&V,V=Br(j,T,!1,f)&&V,m)for(ae=0;ae<m.length;ae++)j=f.g=m[ae],V=Br(j,T,!1,f)&&V}In.prototype.N=function(){if(In.Z.N.call(this),this.i){var c=this.i;for(let f in c.g){let m=c.g[f];for(let T=0;T<m.length;T++)Yt(m[T]);delete c.g[f],c.h--}}this.G=null},In.prototype.J=function(c,f,m,T){return this.i.add(String(c),f,!1,m,T)},In.prototype.K=function(c,f,m,T){return this.i.add(String(c),f,!0,m,T)};function Br(c,f,m,T){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();let V=!0;for(let j=0;j<f.length;++j){let ae=f[j];if(ae&&!ae.da&&ae.capture==m){let Ye=ae.listener,fn=ae.ha||ae.src;ae.fa&&ye(c.i,ae),V=Ye.call(fn,T)!==!1&&V}}return V&&!T.defaultPrevented}function w0(c,f){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:s.setTimeout(c,f||0)}function rr(c){c.g=w0(()=>{c.g=null,c.i&&(c.i=!1,rr(c))},c.l);let f=c.h;c.h=null,c.m.apply(null,f)}class Co extends D{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:rr(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _s(c){D.call(this),this.h=c,this.g={}}h(_s,D);var H=[];function F(c){Ae(c.g,function(f,m){this.g.hasOwnProperty(m)&&ii(f)},c),c.g={}}_s.prototype.N=function(){_s.Z.N.call(this),F(this)},_s.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var K=s.JSON.stringify,Q=s.JSON.parse,Te=class{stringify(c){return s.JSON.stringify(c,void 0)}parse(c){return s.JSON.parse(c,void 0)}};function Fe(){}function Ze(){}var dt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wt(){b.call(this,"d")}h(wt,b);function mt(){b.call(this,"c")}h(mt,b);var gn={},Do=null;function Na(){return Do=Do||new In}gn.Ia="serverreachability";function gc(c){b.call(this,gn.Ia,c)}h(gc,b);function ri(c){let f=Na();Rt(f,new gc(f))}gn.STAT_EVENT="statevent";function jr(c,f){b.call(this,gn.STAT_EVENT,c),this.stat=f}h(jr,b);function Ht(c){let f=Na();Rt(f,new jr(f,c))}gn.Ja="timingevent";function Zd(c,f){b.call(this,gn.Ja,c),this.size=f}h(Zd,b);function Hr(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){c()},f)}function $r(){this.g=!0}$r.prototype.ua=function(){this.g=!1};function x0(c,f,m,T,V,j){c.info(function(){if(c.g)if(j){var ae="",Ye=j.split("&");for(let Tt=0;Tt<Ye.length;Tt++){var fn=Ye[Tt].split("=");if(fn.length>1){let yn=fn[0];fn=fn[1];let sr=yn.split("_");ae=sr.length>=2&&sr[1]=="type"?ae+(yn+"="+fn+"&"):ae+(yn+"=redacted&")}}}else ae=null;else ae=j;return"XMLHTTP REQ ("+T+") [attempt "+V+"]: "+f+`
`+m+`
`+ae})}function US(c,f,m,T,V,j,ae){c.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+V+"]: "+f+`
`+m+`
`+j+" "+ae})}function Oi(c,f,m,T){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+I0(c,m)+(T?" "+T:"")})}function S0(c,f){c.info(function(){return"TIMEOUT: "+f})}$r.prototype.info=function(){};function I0(c,f){if(!c.g)return f;if(!f)return null;try{let j=JSON.parse(f);if(j){for(c=0;c<j.length;c++)if(Array.isArray(j[c])){var m=j[c];if(!(m.length<2)){var T=m[1];if(Array.isArray(T)&&!(T.length<1)){var V=T[0];if(V!="noop"&&V!="stop"&&V!="close")for(let ae=1;ae<T.length;ae++)T[ae]=""}}}}return K(j)}catch{return f}}var be={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},je={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ct;function Vt(){}h(Vt,Fe),Vt.prototype.g=function(){return new XMLHttpRequest},Ct=new Vt;function Nt(c){return encodeURIComponent(String(c))}function mn(c){var f=1;c=c.split(":");let m=[];for(;f>0&&c.length;)m.push(c.shift()),f--;return c.length&&m.push(c.join(":")),m}function Pt(c,f,m,T){this.j=c,this.i=f,this.l=m,this.S=T||1,this.V=new _s(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Es}function Es(){this.i=null,this.g="",this.h=!1}var BS={},T0={};function C0(c,f,m){c.M=1,c.A=eh(or(f)),c.u=m,c.R=!0,jS(c,null)}function jS(c,f){c.F=Date.now(),Xd(c),c.B=or(c.A);var m=c.B,T=c.S;Array.isArray(T)||(T=[String(T)]),e1(m.i,"t",T),c.C=0,m=c.j.L,c.h=new Es,c.g=v1(c.j,m?f:null,!c.u),c.P>0&&(c.O=new Co(u(c.Y,c,c.g),c.P)),f=c.V,m=c.g,T=c.ba;var V="readystatechange";Array.isArray(V)||(V&&(H[0]=V.toString()),V=H);for(let j=0;j<V.length;j++){let ae=ze(m,V[j],T||f.handleEvent,!1,f.h||f);if(!ae)break;f.g[ae.key]=ae}f=c.J?st(c.J):{},c.u?(c.v||(c.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,f)):(c.v="GET",c.g.ea(c.B,c.v,null,f)),ri(),x0(c.i,c.v,c.B,c.l,c.S,c.u)}Pt.prototype.ba=function(c){c=c.target;let f=this.O;f&&Ro(c)==3?f.j():this.Y(c)},Pt.prototype.Y=function(c){try{if(c==this.g)e:{let Ye=Ro(this.g),fn=this.g.ya(),Tt=this.g.ca();if(!(Ye<3)&&(Ye!=3||this.g&&(this.h.h||this.g.la()||a1(this.g)))){this.K||Ye!=4||fn==7||(fn==8||Tt<=0?ri(3):ri(2)),D0(this);var f=this.g.ca();this.X=f;var m=CO(this);if(this.o=f==200,US(this.i,this.v,this.B,this.l,this.S,Ye,f),this.o){if(this.U&&!this.L){t:{if(this.g){var T,V=this.g;if((T=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(T)){var j=T;break t}}j=null}if(c=j)Oi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,A0(this,c);else{this.o=!1,this.m=3,Ht(12),bs(this),mc(this);break e}}if(this.R){c=!0;let yn;for(;!this.K&&this.C<m.length;)if(yn=DO(this,m),yn==T0){Ye==4&&(this.m=4,Ht(14),c=!1),Oi(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==BS){this.m=4,Ht(15),Oi(this.i,this.l,m,"[Invalid Chunk]"),c=!1;break}else Oi(this.i,this.l,yn,null),A0(this,yn);if(HS(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ye!=4||m.length!=0||this.h.h||(this.m=1,Ht(16),c=!1),this.o=this.o&&c,!c)Oi(this.i,this.l,m,"[Invalid Chunked Response]"),bs(this),mc(this);else if(m.length>0&&!this.W){this.W=!0;var ae=this.j;ae.g==this&&ae.aa&&!ae.P&&(ae.j.info("Great, no buffering proxy detected. Bytes received: "+m.length),F0(ae),ae.P=!0,Ht(11))}}else Oi(this.i,this.l,m,null),A0(this,m);Ye==4&&bs(this),this.o&&!this.K&&(Ye==4?p1(this.j,this):(this.o=!1,Xd(this)))}else HO(this.g),f==400&&m.indexOf("Unknown SID")>0?(this.m=3,Ht(12)):(this.m=0,Ht(13)),bs(this),mc(this)}}}catch{}};function CO(c){if(!HS(c))return c.g.la();let f=a1(c.g);if(f==="")return"";let m="",T=f.length,V=Ro(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return bs(c),mc(c),"";c.h.i=new s.TextDecoder}for(let j=0;j<T;j++)c.h.h=!0,m+=c.h.i.decode(f[j],{stream:!(V&&j==T-1)});return f.length=0,c.h.g+=m,c.C=0,c.h.g}function HS(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function DO(c,f){var m=c.C,T=f.indexOf(`
`,m);return T==-1?T0:(m=Number(f.substring(m,T)),isNaN(m)?BS:(T+=1,T+m>f.length?T0:(f=f.slice(T,T+m),c.C=T+m,f)))}Pt.prototype.cancel=function(){this.K=!0,bs(this)};function Xd(c){c.T=Date.now()+c.H,$S(c,c.H)}function $S(c,f){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Hr(u(c.aa,c),f)}function D0(c){c.D&&(s.clearTimeout(c.D),c.D=null)}Pt.prototype.aa=function(){this.D=null;let c=Date.now();c-this.T>=0?(S0(this.i,this.B),this.M!=2&&(ri(),Ht(17)),bs(this),this.m=2,mc(this)):$S(this,this.T-c)};function mc(c){c.j.I==0||c.K||p1(c.j,c)}function bs(c){D0(c);var f=c.O;f&&typeof f.dispose=="function"&&f.dispose(),c.O=null,F(c.V),c.g&&(f=c.g,c.g=null,f.abort(),f.dispose())}function A0(c,f){try{var m=c.j;if(m.I!=0&&(m.g==c||M0(m.h,c))){if(!c.L&&M0(m.h,c)&&m.I==3){try{var T=m.Ba.g.parse(f)}catch{T=null}if(Array.isArray(T)&&T.length==3){var V=T;if(V[0]==0){e:if(!m.v){if(m.g)if(m.g.F+3e3<c.F)sh(m),rh(m);else break e;O0(m),Ht(18)}}else m.xa=V[1],0<m.xa-m.K&&V[2]<37500&&m.F&&m.A==0&&!m.C&&(m.C=Hr(u(m.Va,m),6e3));WS(m.h)<=1&&m.ta&&(m.ta=void 0)}else xs(m,11)}else if((c.L||m.g==c)&&sh(m),!M(f))for(V=m.Ba.g.parse(f),f=0;f<V.length;f++){let Tt=V[f],yn=Tt[0];if(!(yn<=m.K))if(m.K=yn,Tt=Tt[1],m.I==2)if(Tt[0]=="c"){m.M=Tt[1],m.ba=Tt[2];let sr=Tt[3];sr!=null&&(m.ka=sr,m.j.info("VER="+m.ka));let Ss=Tt[4];Ss!=null&&(m.za=Ss,m.j.info("SVER="+m.za));let No=Tt[5];No!=null&&typeof No=="number"&&No>0&&(T=1.5*No,m.O=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;let Po=c.g;if(Po){let lh=Po.g?Po.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(lh){var j=T.h;j.g||lh.indexOf("spdy")==-1&&lh.indexOf("quic")==-1&&lh.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(R0(j,j.h),j.h=null))}if(T.G){let L0=Po.g?Po.g.getResponseHeader("X-HTTP-Session-Id"):null;L0&&(T.wa=L0,kt(T.J,T.G,L0))}}m.I=3,m.l&&m.l.ra(),m.aa&&(m.T=Date.now()-c.F,m.j.info("Handshake RTT: "+m.T+"ms")),T=m;var ae=c;if(T.na=y1(T,T.L?T.ba:null,T.W),ae.L){qS(T.h,ae);var Ye=ae,fn=T.O;fn&&(Ye.H=fn),Ye.D&&(D0(Ye),Xd(Ye)),T.g=ae}else h1(T);m.i.length>0&&oh(m)}else Tt[0]!="stop"&&Tt[0]!="close"||xs(m,7);else m.I==3&&(Tt[0]=="stop"||Tt[0]=="close"?Tt[0]=="stop"?xs(m,7):k0(m):Tt[0]!="noop"&&m.l&&m.l.qa(Tt),m.A=0)}}ri(4)}catch{}}var AO=class{constructor(c,f){this.g=c,this.map=f}};function GS(c){this.l=c||10,s.PerformanceNavigationTiming?(c=s.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zS(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function WS(c){return c.h?1:c.g?c.g.size:0}function M0(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function R0(c,f){c.g?c.g.add(f):c.h=f}function qS(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}GS.prototype.cancel=function(){if(this.i=KS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function KS(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let f=c.i;for(let m of c.g.values())f=f.concat(m.G);return f}return g(c.i)}var QS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function MO(c,f){if(c){c=c.split("&");for(let m=0;m<c.length;m++){let T=c[m].indexOf("="),V,j=null;T>=0?(V=c[m].substring(0,T),j=c[m].substring(T+1)):V=c[m],f(V,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Ao(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;c instanceof Ao?(this.l=c.l,yc(this,c.j),this.o=c.o,this.g=c.g,vc(this,c.u),this.h=c.h,N0(this,t1(c.i)),this.m=c.m):c&&(f=String(c).match(QS))?(this.l=!1,yc(this,f[1]||"",!0),this.o=_c(f[2]||""),this.g=_c(f[3]||"",!0),vc(this,f[4]),this.h=_c(f[5]||"",!0),N0(this,f[6]||"",!0),this.m=_c(f[7]||"")):(this.l=!1,this.i=new bc(null,this.l))}Ao.prototype.toString=function(){let c=[];var f=this.j;f&&c.push(Ec(f,YS,!0),":");var m=this.g;return(m||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Ec(f,YS,!0),"@"),c.push(Nt(m).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.u,m!=null&&c.push(":",String(m))),(m=this.h)&&(this.g&&m.charAt(0)!="/"&&c.push("/"),c.push(Ec(m,m.charAt(0)=="/"?PO:NO,!0))),(m=this.i.toString())&&c.push("?",m),(m=this.m)&&c.push("#",Ec(m,OO)),c.join("")},Ao.prototype.resolve=function(c){let f=or(this),m=!!c.j;m?yc(f,c.j):m=!!c.o,m?f.o=c.o:m=!!c.g,m?f.g=c.g:m=c.u!=null;var T=c.h;if(m)vc(f,c.u);else if(m=!!c.h){if(T.charAt(0)!="/")if(this.g&&!this.h)T="/"+T;else{var V=f.h.lastIndexOf("/");V!=-1&&(T=f.h.slice(0,V+1)+T)}if(V=T,V==".."||V==".")T="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){T=V.lastIndexOf("/",0)==0,V=V.split("/");let j=[];for(let ae=0;ae<V.length;){let Ye=V[ae++];Ye=="."?T&&ae==V.length&&j.push(""):Ye==".."?((j.length>1||j.length==1&&j[0]!="")&&j.pop(),T&&ae==V.length&&j.push("")):(j.push(Ye),T=!0)}T=j.join("/")}else T=V}return m?f.h=T:m=c.i.toString()!=="",m?N0(f,t1(c.i)):m=!!c.m,m&&(f.m=c.m),f};function or(c){return new Ao(c)}function yc(c,f,m){c.j=m?_c(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function vc(c,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);c.u=f}else c.u=null}function N0(c,f,m){f instanceof bc?(c.i=f,FO(c.i,c.l)):(m||(f=Ec(f,kO)),c.i=new bc(f,c.l))}function kt(c,f,m){c.i.set(f,m)}function eh(c){return kt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function _c(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ec(c,f,m){return typeof c=="string"?(c=encodeURI(c).replace(f,RO),m&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function RO(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var YS=/[#\/\?@]/g,NO=/[#\?:]/g,PO=/[#\?]/g,kO=/[#\?@]/g,OO=/#/g;function bc(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function ws(c){c.g||(c.g=new Map,c.h=0,c.i&&MO(c.i,function(f,m){c.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=bc.prototype,n.add=function(c,f){ws(this),this.i=null,c=Pa(this,c);let m=this.g.get(c);return m||this.g.set(c,m=[]),m.push(f),this.h+=1,this};function JS(c,f){ws(c),f=Pa(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function ZS(c,f){return ws(c),f=Pa(c,f),c.g.has(f)}n.forEach=function(c,f){ws(this),this.g.forEach(function(m,T){m.forEach(function(V){c.call(f,V,T,this)},this)},this)};function XS(c,f){ws(c);let m=[];if(typeof f=="string")ZS(c,f)&&(m=m.concat(c.g.get(Pa(c,f))));else for(c=Array.from(c.g.values()),f=0;f<c.length;f++)m=m.concat(c[f]);return m}n.set=function(c,f){return ws(this),this.i=null,c=Pa(this,c),ZS(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},n.get=function(c,f){return c?(c=XS(this,c),c.length>0?String(c[0]):f):f};function e1(c,f,m){JS(c,f),m.length>0&&(c.i=null,c.g.set(Pa(c,f),g(m)),c.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],f=Array.from(this.g.keys());for(let T=0;T<f.length;T++){var m=f[T];let V=Nt(m);m=XS(this,m);for(let j=0;j<m.length;j++){let ae=V;m[j]!==""&&(ae+="="+Nt(m[j])),c.push(ae)}}return this.i=c.join("&")};function t1(c){let f=new bc;return f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),f}function Pa(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function FO(c,f){f&&!c.j&&(ws(c),c.i=null,c.g.forEach(function(m,T){let V=T.toLowerCase();T!=V&&(JS(this,T),e1(this,V,m))},c)),c.j=f}function LO(c,f){let m=new $r;if(s.Image){let T=new Image;T.onload=d(Mo,m,"TestLoadImage: loaded",!0,f,T),T.onerror=d(Mo,m,"TestLoadImage: error",!1,f,T),T.onabort=d(Mo,m,"TestLoadImage: abort",!1,f,T),T.ontimeout=d(Mo,m,"TestLoadImage: timeout",!1,f,T),s.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=c}else f(!1)}function VO(c,f){let m=new $r,T=new AbortController,V=setTimeout(()=>{T.abort(),Mo(m,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:T.signal}).then(j=>{clearTimeout(V),j.ok?Mo(m,"TestPingServer: ok",!0,f):Mo(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),Mo(m,"TestPingServer: error",!1,f)})}function Mo(c,f,m,T,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),T(m)}catch{}}function UO(){this.g=new Te}function th(c){this.i=c.Sb||null,this.h=c.ab||!1}h(th,Fe),th.prototype.g=function(){return new nh(this.i,this.h)};function nh(c,f){In.call(this),this.H=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(nh,In),n=nh.prototype,n.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=f,this.readyState=1,xc(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(f.body=c),(this.H||s).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,wc(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,xc(this)),this.g&&(this.readyState=3,xc(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;n1(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function n1(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?wc(this):xc(this),this.readyState==3&&n1(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,wc(this))},n.Na=function(c){this.g&&(this.response=c,wc(this))},n.ga=function(){this.g&&wc(this)};function wc(c){c.readyState=4,c.l=null,c.j=null,c.B=null,xc(c)}n.setRequestHeader=function(c,f){this.A.append(c,f)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,c.push(m[0]+": "+m[1]),m=f.next();return c.join(`\r
`)};function xc(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(nh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function i1(c){let f="";return Ae(c,function(m,T){f+=T,f+=":",f+=m,f+=`\r
`}),f}function P0(c,f,m){e:{for(T in m){var T=!1;break e}T=!0}T||(m=i1(m),typeof c=="string"?m!=null&&Nt(m):kt(c,f,m))}function $t(c){In.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h($t,In);var BO=/^https?$/i,jO=["POST","PUT"];n=$t.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,f,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ct.g(),this.g.onreadystatechange=p(u(this.Ca,this));try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(j){r1(this,j);return}if(c=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var V in T)m.set(V,T[V]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(let j of T.keys())m.set(j,T.get(j));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(j=>j.toLowerCase()=="content-type"),V=s.FormData&&c instanceof s.FormData,!(Array.prototype.indexOf.call(jO,f,void 0)>=0)||T||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[j,ae]of m)this.g.setRequestHeader(j,ae);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(j){r1(this,j)}};function r1(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.o=5,o1(c),ih(c)}function o1(c){c.A||(c.A=!0,Rt(c,"complete"),Rt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,Rt(this,"complete"),Rt(this,"abort"),ih(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ih(this,!0)),$t.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?s1(this):this.Xa())},n.Xa=function(){s1(this)};function s1(c){if(c.h&&typeof o<"u"){if(c.v&&Ro(c)==4)setTimeout(c.Ca.bind(c),0);else if(Rt(c,"readystatechange"),Ro(c)==4){c.h=!1;try{let j=c.ca();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var T;if(T=j===0){let ae=String(c.D).match(QS)[1]||null;!ae&&s.self&&s.self.location&&(ae=s.self.location.protocol.slice(0,-1)),T=!BO.test(ae?ae.toLowerCase():"")}m=T}if(m)Rt(c,"complete"),Rt(c,"success");else{c.o=6;try{var V=Ro(c)>2?c.g.statusText:""}catch{V=""}c.l=V+" ["+c.ca()+"]",o1(c)}}finally{ih(c)}}}}function ih(c,f){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);let m=c.g;c.g=null,f||Rt(c,"ready");try{m.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ro(c){return c.g?c.g.readyState:0}n.ca=function(){try{return Ro(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),Q(f)}};function a1(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function HO(c){let f={};c=(c.g&&Ro(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<c.length;T++){if(M(c[T]))continue;var m=mn(c[T]);let V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let j=f[V]||[];f[V]=j,j.push(m)}jt(f,function(T){return T.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Sc(c,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[c]||f}function l1(c){this.za=0,this.i=[],this.j=new $r,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Sc("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Sc("baseRetryDelayMs",5e3,c),this.Za=Sc("retryDelaySeedMs",1e4,c),this.Ta=Sc("forwardChannelMaxRetries",2,c),this.va=Sc("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new GS(c&&c.concurrentRequestLimit),this.Ba=new UO,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=l1.prototype,n.ka=8,n.I=1,n.connect=function(c,f,m,T){Ht(0),this.W=c,this.H=f||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.J=y1(this,null,this.W),oh(this)};function k0(c){if(c1(c),c.I==3){var f=c.V++,m=or(c.J);if(kt(m,"SID",c.M),kt(m,"RID",f),kt(m,"TYPE","terminate"),Ic(c,m),f=new Pt(c,c.j,f),f.M=2,f.A=eh(or(m)),m=!1,s.navigator&&s.navigator.sendBeacon)try{m=s.navigator.sendBeacon(f.A.toString(),"")}catch{}!m&&s.Image&&(new Image().src=f.A,m=!0),m||(f.g=v1(f.j,null),f.g.ea(f.A)),f.F=Date.now(),Xd(f)}m1(c)}function rh(c){c.g&&(F0(c),c.g.cancel(),c.g=null)}function c1(c){rh(c),c.v&&(s.clearTimeout(c.v),c.v=null),sh(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&s.clearTimeout(c.m),c.m=null)}function oh(c){if(!zS(c.h)&&!c.m){c.m=!0;var f=c.Ea;De||I(),Ie||(De(),Ie=!0),k.add(f,c),c.D=0}}function $O(c,f){return WS(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=f.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Hr(u(c.Ea,c,f),g1(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;let V=new Pt(this,this.j,c),j=this.o;if(this.U&&(j?(j=st(j),ne(j,this.U)):j=this.U),this.u!==null||this.R||(V.J=j,j=null),this.S)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(f+=T,f>4096){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=d1(this,V,f),m=or(this.J),kt(m,"RID",c),kt(m,"CVER",22),this.G&&kt(m,"X-HTTP-Session-Id",this.G),Ic(this,m),j&&(this.R?f="headers="+Nt(i1(j))+"&"+f:this.u&&P0(m,this.u,j)),R0(this.h,V),this.Ra&&kt(m,"TYPE","init"),this.S?(kt(m,"$req",f),kt(m,"SID","null"),V.U=!0,C0(V,m,null)):C0(V,m,f),this.I=2}}else this.I==3&&(c?u1(this,c):this.i.length==0||zS(this.h)||u1(this))};function u1(c,f){var m;f?m=f.l:m=c.V++;let T=or(c.J);kt(T,"SID",c.M),kt(T,"RID",m),kt(T,"AID",c.K),Ic(c,T),c.u&&c.o&&P0(T,c.u,c.o),m=new Pt(c,c.j,m,c.D+1),c.u===null&&(m.J=c.o),f&&(c.i=f.G.concat(c.i)),f=d1(c,m,1e3),m.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),R0(c.h,m),C0(m,T,f)}function Ic(c,f){c.H&&Ae(c.H,function(m,T){kt(f,T,m)}),c.l&&Ae({},function(m,T){kt(f,T,m)})}function d1(c,f,m){m=Math.min(c.i.length,m);let T=c.l?u(c.l.Ka,c.l,c):null;e:{var V=c.i;let Ye=-1;for(;;){let fn=["count="+m];Ye==-1?m>0?(Ye=V[0].g,fn.push("ofs="+Ye)):Ye=0:fn.push("ofs="+Ye);let Tt=!0;for(let yn=0;yn<m;yn++){var j=V[yn].g;let sr=V[yn].map;if(j-=Ye,j<0)Ye=Math.max(0,V[yn].g-100),Tt=!1;else try{j="req"+j+"_"||"";try{var ae=sr instanceof Map?sr:Object.entries(sr);for(let[Ss,No]of ae){let Po=No;a(No)&&(Po=K(No)),fn.push(j+Ss+"="+encodeURIComponent(Po))}}catch(Ss){throw fn.push(j+"type="+encodeURIComponent("_badmap")),Ss}}catch{T&&T(sr)}}if(Tt){ae=fn.join("&");break e}}ae=void 0}return c=c.i.splice(0,m),f.G=c,ae}function h1(c){if(!c.g&&!c.v){c.Y=1;var f=c.Da;De||I(),Ie||(De(),Ie=!0),k.add(f,c),c.A=0}}function O0(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Hr(u(c.Da,c),g1(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,f1(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Hr(u(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ht(10),rh(this),f1(this))};function F0(c){c.B!=null&&(s.clearTimeout(c.B),c.B=null)}function f1(c){c.g=new Pt(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var f=or(c.na);kt(f,"RID","rpc"),kt(f,"SID",c.M),kt(f,"AID",c.K),kt(f,"CI",c.F?"0":"1"),!c.F&&c.ia&&kt(f,"TO",c.ia),kt(f,"TYPE","xmlhttp"),Ic(c,f),c.u&&c.o&&P0(f,c.u,c.o),c.O&&(c.g.H=c.O);var m=c.g;c=c.ba,m.M=1,m.A=eh(or(f)),m.u=null,m.R=!0,jS(m,c)}n.Va=function(){this.C!=null&&(this.C=null,rh(this),O0(this),Ht(19))};function sh(c){c.C!=null&&(s.clearTimeout(c.C),c.C=null)}function p1(c,f){var m=null;if(c.g==f){sh(c),F0(c),c.g=null;var T=2}else if(M0(c.h,f))m=f.G,qS(c.h,f),T=1;else return;if(c.I!=0){if(f.o)if(T==1){m=f.u?f.u.length:0,f=Date.now()-f.F;var V=c.D;T=Na(),Rt(T,new Zd(T,m)),oh(c)}else h1(c);else if(V=f.m,V==3||V==0&&f.X>0||!(T==1&&$O(c,f)||T==2&&O0(c)))switch(m&&m.length>0&&(f=c.h,f.i=f.i.concat(m)),V){case 1:xs(c,5);break;case 4:xs(c,10);break;case 3:xs(c,6);break;default:xs(c,2)}}}function g1(c,f){let m=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(m*=2),m*f}function xs(c,f){if(c.j.info("Error code "+f),f==2){var m=u(c.bb,c),T=c.Ua;let V=!T;T=new Ao(T||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||yc(T,"https"),eh(T),V?LO(T.toString(),m):VO(T.toString(),m)}else Ht(2);c.I=0,c.l&&c.l.pa(f),m1(c),c1(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function m1(c){if(c.I=0,c.ja=[],c.l){let f=KS(c.h);(f.length!=0||c.i.length!=0)&&(w(c.ja,f),w(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function y1(c,f,m){var T=m instanceof Ao?or(m):new Ao(m);if(T.g!="")f&&(T.g=f+"."+T.g),vc(T,T.u);else{var V=s.location;T=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;let j=new Ao(null);T&&yc(j,T),f&&(j.g=f),V&&vc(j,V),m&&(j.h=m),T=j}return m=c.G,f=c.wa,m&&f&&kt(T,m,f),kt(T,"VER",c.ka),Ic(c,T),T}function v1(c,f,m){if(f&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Aa&&!c.ma?new $t(new th({ab:m})):new $t(c.ma),f.Fa(c.L),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function _1(){}n=_1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ah(){}ah.prototype.g=function(c,f){return new oi(c,f)};function oi(c,f){In.call(this),this.g=new l1(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(c?c["X-WebChannel-Client-Profile"]=f.sa:c={"X-WebChannel-Client-Profile":f.sa}),this.g.U=c,(c=f&&f.Qb)&&!M(c)&&(this.g.u=c),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!M(f)&&(this.g.G=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new ka(this)}h(oi,In),oi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},oi.prototype.close=function(){k0(this.g)},oi.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var m={};m.__data__=c,c=m}else this.v&&(m={},m.__data__=K(c),c=m);f.i.push(new AO(f.Ya++,c)),f.I==3&&oh(f)},oi.prototype.N=function(){this.g.l=null,delete this.j,k0(this.g),delete this.g,oi.Z.N.call(this)};function E1(c){wt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(let m in f){c=m;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}h(E1,wt);function b1(){mt.call(this),this.status=1}h(b1,mt);function ka(c){this.g=c}h(ka,_1),ka.prototype.ra=function(){Rt(this.g,"a")},ka.prototype.qa=function(c){Rt(this.g,new E1(c))},ka.prototype.pa=function(c){Rt(this.g,new b1)},ka.prototype.oa=function(){Rt(this.g,"b")},ah.prototype.createWebChannel=ah.prototype.g,oi.prototype.send=oi.prototype.o,oi.prototype.open=oi.prototype.m,oi.prototype.close=oi.prototype.close,jb=uo.createWebChannelTransport=function(){return new ah},Bb=uo.getStatEventTarget=function(){return Na()},Ub=uo.Event=gn,Og=uo.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,ld=uo.ErrorCode=be,je.COMPLETE="complete",Vb=uo.EventType=je,Ze.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",In.prototype.listen=In.prototype.J,Al=uo.WebChannel=Ze,m9=uo.FetchXmlHttpFactory=th,$t.prototype.listenOnce=$t.prototype.K,$t.prototype.getLastError=$t.prototype.Ha,$t.prototype.getLastErrorCode=$t.prototype.ya,$t.prototype.getStatus=$t.prototype.ca,$t.prototype.getResponseJson=$t.prototype.La,$t.prototype.getResponseText=$t.prototype.la,$t.prototype.send=$t.prototype.ea,$t.prototype.setWithCredentials=$t.prototype.Fa,Lb=uo.XhrIo=$t}).apply(typeof kg<"u"?kg:typeof self<"u"?self:typeof window<"u"?window:{});var xn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};xn.UNAUTHENTICATED=new xn(null),xn.GOOGLE_CREDENTIALS=new xn("google-credentials-uid"),xn.FIRST_PARTY=new xn("first-party-uid"),xn.MOCK_USER=new xn("mock-user");var Wl="12.8.0";function dP(n){Wl=n}var pa=new is("@firebase/firestore");function Ml(){return pa.logLevel}function we(n,...e){if(pa.logLevel<=Xe.DEBUG){let t=e.map(bx);pa.debug(`Firestore (${Wl}): ${n}`,...t)}}function po(n,...e){if(pa.logLevel<=Xe.ERROR){let t=e.map(bx);pa.error(`Firestore (${Wl}): ${n}`,...t)}}function ls(n,...e){if(pa.logLevel<=Xe.WARN){let t=e.map(bx);pa.warn(`Firestore (${Wl}): ${n}`,...t)}}function bx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ke(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,hP(n,i,t)}function hP(n,e,t){let i=`FIRESTORE (${Wl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw po(i),new Error(i)}function Et(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||hP(e,r,i)}function Ge(n,e){return n}var G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},se=class extends vi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Mr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Hg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},$g=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(xn.UNAUTHENTICATED))}shutdown(){}},qb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Gg=class{constructor(e){this.t=e,this.currentUser=xn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Et(this.o===void 0,42304);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),o=new Mr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Mr,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Mr)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Et(typeof i.accessToken=="string",31837,{l:i}),new Hg(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new xn(e)}},Kb=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=xn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},Qb=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Kb(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(xn.FIRST_PARTY))}shutdown(){}invalidateToken(){}},zg=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Wg=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_i(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Et(this.o===void 0,3512);let i=o=>{o.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,we("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new zg(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Et(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new zg(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function y9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var ga=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=y9(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}};function it(n,e){return n<e?-1:n>e?1:0}function Yb(n,e){let t=Math.min(n.length,e.length);for(let i=0;i<t;i++){let r=n.charAt(i),o=e.charAt(i);if(r!==o)return Hb(r)===Hb(o)?it(r,o):Hb(r)?1:-1}return it(n.length,e.length)}var v9=55296,_9=57343;function Hb(n){let e=n.charCodeAt(0);return e>=v9&&e<=_9}function Fl(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var TN="__name__",qg=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&ke(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ke(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return it(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):Yb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return co.fromString(e.substring(4,e.length-2))}},Mt=class n extends qg{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new se(G.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},E9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ti=class n extends qg{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return E9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===TN}static keyField(){return new n([TN])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new se(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new se(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new se(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(s=!s,r++):a!=="."||s?(i+=a,r++):(o(),r++)}if(o(),s)throw new se(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Me=class n{constructor(e){this.path=e}static fromPath(e){return new n(Mt.fromString(e))}static fromName(e){return new n(Mt.fromString(e).popFirst(5))}static empty(){return new n(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Mt(e.slice()))}};function fP(n,e,t){if(!t)throw new se(G.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function pP(n,e,t,i){if(e===!0&&i===!0)throw new se(G.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function CN(n){if(!Me.isDocumentKey(n))throw new se(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function DN(n){if(Me.isDocumentKey(n))throw new se(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function gP(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Cd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ke(12329,{type:typeof n})}function ql(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new se(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Cd(n);throw new se(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function mP(n,e){if(e<=0)throw new se(G.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function nn(n,e){let t={typeString:n};return e&&(t.value=e),t}function Kl(n,e){if(!gP(n))throw new se(G.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let s=n[i];if(r&&typeof s!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new se(G.INVALID_ARGUMENT,t);return!0}var AN=-62135596800,MN=1e6,rn=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*MN);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new se(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new se(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<AN)throw new se(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/MN}_compareTo(e){return this.seconds===e.seconds?it(this.nanoseconds,e.nanoseconds):it(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kl(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-AN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};rn._jsonSchemaVersion="firestore/timestamp/1.0",rn._jsonSchema={type:nn("string",rn._jsonSchemaVersion),seconds:nn("number"),nanoseconds:nn("number")};var Qe=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new rn(0,0))}static max(){return new n(new rn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var pd=-1,Kg=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};Kg.UNKNOWN_ID=-1;function b9(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new rn(t+1,0):new rn(t,i));return new ma(r,Me.empty(),e)}function w9(n){return new ma(n.readTime,n.key,pd)}var ma=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Qe.min(),Me.empty(),pd)}static max(){return new n(Qe.max(),Me.empty(),pd)}};function x9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Me.comparator(n.documentKey,e.documentKey),t!==0?t:it(n.largestBatchId,e.largestBatchId))}var S9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Jb=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Ql(n){if(n.code!==G.FAILED_PRECONDITION||n.message!==S9)throw n;we("LocalStore","Unexpectedly lost primary lease")}var ee=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(a=>{++r,a.next(()=>{++o,s&&o===r&&t()},l=>i(l))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let u=l;t(e[u]).next(d=>{s[u]=d,++a,a===o&&i(s)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};function I9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Yl(n){return n.name==="IndexedDbTransactionError"}var wx=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),xx=-1;function bm(n){return n==null}function gd(n){return n===0&&1/n==-1/0}function T9(n){return typeof n=="number"&&Number.isInteger(n)&&!gd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var yP="";function C9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=RN(e)),e=D9(n.get(t),e);return RN(e)}function D9(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case yP:t+="";break;default:t+=o}}return t}function RN(n){return n+yP+""}var A9="remoteDocuments",vP="owner";var _P="mutationQueues";var EP="mutations";var bP="documentMutations",M9="remoteDocumentsV14";var wP="remoteDocumentGlobal";var xP="targets";var SP="targetDocuments";var IP="targetGlobal",TP="collectionParents";var CP="clientMetadata";var DP="bundles";var AP="namedQueries";var R9="indexConfiguration";var N9="indexState";var P9="indexEntries";var MP="documentOverlays";var k9="globals";var O9=[_P,EP,bP,A9,xP,vP,IP,SP,CP,wP,TP,DP,AP],xue=[...O9,MP],F9=[_P,EP,bP,M9,xP,vP,IP,SP,CP,wP,TP,DP,AP,MP],L9=F9,V9=[...L9,R9,N9,P9];var Sue=[...V9,k9];function NN(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Sa(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function RP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Qt=class n{constructor(e,t){this.comparator=e,this.root=t||Rr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kl(this.root,e,this.comparator,!1)}getReverseIterator(){return new kl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kl(this.root,e,this.comparator,!0)}},kl=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Rr=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ke(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw ke(27949);return e+(this.isRed()?0:1)}};Rr.EMPTY=null,Rr.RED=!0,Rr.BLACK=!1;Rr.EMPTY=new class{constructor(){this.size=0}get key(){throw ke(57766)}get value(){throw ke(16141)}get color(){throw ke(16727)}get left(){throw ke(29726)}get right(){throw ke(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Rr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Sn=class n{constructor(e){this.comparator=e,this.data=new Qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Qg(this.data.getIterator())}getIteratorFrom(e){return new Qg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Qg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ar=class n{constructor(e){this.fields=e,e.sort(ti.comparator)}static empty(){return new n([])}unionWith(e){let t=new Sn(ti.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fl(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var Yg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Nn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Yg("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return it(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Nn.EMPTY_BYTE_STRING=new Nn("");var U9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(n){if(Et(!!n,39018),typeof n=="string"){let e=0,t=U9.exec(n);if(Et(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ut(n.seconds),nanos:Ut(n.nanos)}}function Ut(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function mo(n){return typeof n=="string"?Nn.fromBase64String(n):Nn.fromUint8Array(n)}var NP="server_timestamp",PP="__type__",kP="__previous_value__",OP="__local_write_time__";function Dd(n){return(n?.mapValue?.fields||{})[PP]?.stringValue===NP}function wm(n){let e=n.mapValue.fields[kP];return Dd(e)?wm(e):e}function md(n){let e=go(n.mapValue.fields[OP].timestampValue);return new rn(e.seconds,e.nanos)}var Zb=class{constructor(e,t,i,r,o,s,a,l,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=d,this.apiKey=h}},Jg="(default)",yd=class n{constructor(e,t){this.projectId=e,this.database=t||Jg}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Jg}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function FP(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new se(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yd(n.options.projectId,e)}var Sx="__type__",LP="__max__",Fg={mapValue:{fields:{__type__:{stringValue:LP}}}},Ix="__vector__",Ll="value";function cs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Dd(n)?4:UP(n)?9007199254740991:VP(n)?10:11:ke(28295,{value:n})}function Fr(n,e){if(n===e)return!0;let t=cs(n);if(t!==cs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return md(n).isEqual(md(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=go(r.timestampValue),a=go(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return mo(r.bytesValue).isEqual(mo(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return Ut(r.geoPointValue.latitude)===Ut(o.geoPointValue.latitude)&&Ut(r.geoPointValue.longitude)===Ut(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return Ut(r.integerValue)===Ut(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=Ut(r.doubleValue),a=Ut(o.doubleValue);return s===a?gd(s)===gd(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Fl(n.arrayValue.values||[],e.arrayValue.values||[],Fr);case 10:case 11:return(function(r,o){let s=r.mapValue.fields||{},a=o.mapValue.fields||{};if(NN(s)!==NN(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Fr(s[l],a[l])))return!1;return!0})(n,e);default:return ke(52216,{left:n})}}function vd(n,e){return(n.values||[]).find(t=>Fr(t,e))!==void 0}function Vl(n,e){if(n===e)return 0;let t=cs(n),i=cs(e);if(t!==i)return it(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return it(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=Ut(o.integerValue||o.doubleValue),l=Ut(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return PN(n.timestampValue,e.timestampValue);case 4:return PN(md(n),md(e));case 5:return Yb(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=mo(o),l=mo(s);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),l=s.split("/");for(let u=0;u<a.length&&u<l.length;u++){let d=it(a[u],l[u]);if(d!==0)return d}return it(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=it(Ut(o.latitude),Ut(s.latitude));return a!==0?a:it(Ut(o.longitude),Ut(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return kN(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},l=s.fields||{},u=a[Ll]?.arrayValue,d=l[Ll]?.arrayValue,h=it(u?.values?.length||0,d?.values?.length||0);return h!==0?h:kN(u,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===Fg.mapValue&&s===Fg.mapValue)return 0;if(o===Fg.mapValue)return 1;if(s===Fg.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),u=s.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let p=Yb(l[h],d[h]);if(p!==0)return p;let g=Vl(a[l[h]],u[d[h]]);if(g!==0)return g}return it(l.length,d.length)})(n.mapValue,e.mapValue);default:throw ke(23264,{he:t})}}function PN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return it(n,e);let t=go(n),i=go(e),r=it(t.seconds,i.seconds);return r!==0?r:it(t.nanos,i.nanos)}function kN(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=Vl(t[r],i[r]);if(o)return o}return it(t.length,i.length)}function Ul(n){return Xb(n)}function Xb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=go(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return mo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Me.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=Xb(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${Xb(t.fields[s])}`;return r+"}"})(n.mapValue):ke(61005,{value:n})}function Ug(n){switch(cs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=wm(n);return e?16+Ug(e):16;case 5:return 2*n.stringValue.length;case 6:return mo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,o)=>r+Ug(o),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Sa(i.fields,(o,s)=>{r+=o.length+Ug(s)}),r})(n.mapValue);default:throw ke(13486,{value:n})}}function Ad(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ew(n){return!!n&&"integerValue"in n}function Tx(n){return!!n&&"arrayValue"in n}function ON(n){return!!n&&"nullValue"in n}function FN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Bg(n){return!!n&&"mapValue"in n}function VP(n){return(n?.mapValue?.fields||{})[Sx]?.stringValue===Ix}function dd(n){if(n.geoPointValue)return{geoPointValue:L({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:L({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Sa(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=dd(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=dd(n.arrayValue.values[t]);return e}return L({},n)}function UP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===LP}var Tue={mapValue:{fields:{[Sx]:{stringValue:Ix},[Ll]:{arrayValue:{}}}}};var Pi=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Bg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=dd(t)}setAll(e){let t=ti.emptyPath(),i={},r=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}s?i[a.lastSegment()]=dd(s):r.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());Bg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Bg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Sa(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(dd(this.value))}};function BP(n){let e=[];return Sa(n.fields,(t,i)=>{let r=new ti([t]);if(Bg(i)){let o=BP(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new Ar(e)}var er=class n{constructor(e,t,i,r,o,s,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Qe.min(),Qe.min(),Qe.min(),Pi.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Qe.min(),Qe.min(),Pi.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Qe.min(),Qe.min(),Pi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var yo=class{constructor(e,t){this.position=e,this.inclusive=t}};function LN(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=Me.comparator(Me.fromName(s.referenceValue),t.key):i=Vl(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function VN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Fr(n.position[t],e.position[t]))return!1;return!0}var us=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function B9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Zg=class{},tn=class n extends Zg{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new nw(e,t,i):t==="array-contains"?new ow(e,i):t==="in"?new sw(e,i):t==="not-in"?new aw(e,i):t==="array-contains-any"?new lw(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new iw(e,i):new rw(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vl(t,this.value)):t!==null&&cs(this.value)===cs(t)&&this.matchesComparison(Vl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ki=class n extends Zg{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return jP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function jP(n){return n.op==="and"}function HP(n){return j9(n)&&jP(n)}function j9(n){for(let e of n.filters)if(e instanceof ki)return!1;return!0}function tw(n){if(n instanceof tn)return n.field.canonicalString()+n.op.toString()+Ul(n.value);if(HP(n))return n.filters.map(e=>tw(e)).join(",");{let e=n.filters.map(t=>tw(t)).join(",");return`${n.op}(${e})`}}function $P(n,e){return n instanceof tn?(function(i,r){return r instanceof tn&&i.op===r.op&&i.field.isEqual(r.field)&&Fr(i.value,r.value)})(n,e):n instanceof ki?(function(i,r){return r instanceof ki&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,a)=>o&&$P(s,r.filters[a]),!0):!1})(n,e):void ke(19439)}function GP(n){return n instanceof tn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ul(t.value)}`})(n):n instanceof ki?(function(t){return t.op.toString()+" {"+t.getFilters().map(GP).join(" ,")+"}"})(n):"Filter"}var nw=class extends tn{constructor(e,t,i){super(e,t,i),this.key=Me.fromName(i.referenceValue)}matches(e){let t=Me.comparator(e.key,this.key);return this.matchesComparison(t)}},iw=class extends tn{constructor(e,t){super(e,"in",t),this.keys=zP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},rw=class extends tn{constructor(e,t){super(e,"not-in",t),this.keys=zP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function zP(n,e){return(e.arrayValue?.values||[]).map(t=>Me.fromName(t.referenceValue))}var ow=class extends tn{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Tx(t)&&vd(t.arrayValue,this.value)}},sw=class extends tn{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&vd(this.value.arrayValue,t)}},aw=class extends tn{constructor(e,t){super(e,"not-in",t)}matches(e){if(vd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!vd(this.value.arrayValue,t)}},lw=class extends tn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Tx(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>vd(this.value.arrayValue,i))}};var cw=class{constructor(e,t=null,i=[],r=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function UN(n,e=null,t=[],i=[],r=null,o=null,s=null){return new cw(n,e,t,i,r,o,s)}function Cx(n){let e=Ge(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>tw(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(o){return o.field.canonicalString()+o.dir})(i)).join(","),bm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Ul(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Ul(i)).join(",")),e.Te=t}return e.Te}function Dx(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!B9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!$P(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!VN(n.startAt,e.startAt)&&VN(n.endAt,e.endAt)}function uw(n){return Me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var vo=class{constructor(e,t=null,i=[],r=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function H9(n,e,t,i,r,o,s,a){return new vo(n,e,t,i,r,o,s,a)}function Ax(n){return new vo(n)}function BN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function $9(n){return Me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function xm(n){return n.collectionGroup!==null}function fa(n){let e=Ge(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Sn(ti.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new us(o,i))}),t.has(ti.keyField().canonicalString())||e.Ie.push(new us(ti.keyField(),i))}return e.Ie}function Nr(n){let e=Ge(n);return e.Ee||(e.Ee=G9(e,fa(n))),e.Ee}function G9(n,e){if(n.limitType==="F")return UN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new us(r.field,o)});let t=n.endAt?new yo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new yo(n.startAt.position,n.startAt.inclusive):null;return UN(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Sm(n,e){let t=n.filters.concat([e]);return new vo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function WP(n,e){let t=n.explicitOrderBy.concat([e]);return new vo(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function _d(n,e,t){return new vo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function qP(n,e){return new vo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Im(n,e){return Dx(Nr(n),Nr(e))&&n.limitType===e.limitType}function KP(n){return`${Cx(Nr(n))}|lt:${n.limitType}`}function Rl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>GP(r)).join(", ")}]`),bm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Ul(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Ul(r)).join(",")),`Target(${i})`})(Nr(n))}; limitType=${n.limitType})`}function Tm(n,e){return e.isFoundDocument()&&(function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Me.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(let o of fa(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(s,a,l){let u=LN(s,a,l);return s.inclusive?u<=0:u<0})(i.startAt,fa(i),r)||i.endAt&&!(function(s,a,l){let u=LN(s,a,l);return s.inclusive?u>=0:u>0})(i.endAt,fa(i),r))})(n,e)}function z9(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function QP(n){return(e,t)=>{let i=!1;for(let r of fa(n)){let o=W9(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function W9(n,e,t){let i=n.field.isKeyField()?Me.comparator(e.key,t.key):(function(o,s,a){let l=s.data.field(o),u=a.data.field(o);return l!==null&&u!==null?Vl(l,u):ke(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ke(19790,{direction:n.dir})}}var _o=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Sa(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return RP(this.inner)}size(){return this.innerSize}};var q9=new Qt(Me.comparator);function Eo(){return q9}var YP=new Qt(Me.comparator);function ud(...n){let e=YP;for(let t of n)e=e.insert(t.key,t);return e}function JP(n){let e=YP;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function da(){return hd()}function ZP(){return hd()}function hd(){return new _o(n=>n.toString(),(n,e)=>n.isEqual(e))}var K9=new Qt(Me.comparator),Q9=new Sn(Me.comparator);function et(...n){let e=Q9;for(let t of n)e=e.add(t);return e}var Y9=new Sn(it);function J9(){return Y9}function Mx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gd(e)?"-0":e}}function XP(n){return{integerValue:""+n}}function Z9(n,e){return T9(e)?XP(e):Mx(n,e)}var Bl=class{constructor(){this._=void 0}};function X9(n,e,t){return n instanceof ya?(function(r,o){let s={fields:{[PP]:{stringValue:NP},[OP]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Dd(o)&&(o=wm(o)),o&&(s.fields[kP]=o),{mapValue:s}})(t,e):n instanceof va?tk(n,e):n instanceof _a?nk(n,e):(function(r,o){let s=ek(r,o),a=jN(s)+jN(r.Ae);return ew(s)&&ew(r.Ae)?XP(a):Mx(r.serializer,a)})(n,e)}function eH(n,e,t){return n instanceof va?tk(n,e):n instanceof _a?nk(n,e):t}function ek(n,e){return n instanceof jl?(function(i){return ew(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}var ya=class extends Bl{},va=class extends Bl{constructor(e){super(),this.elements=e}};function tk(n,e){let t=ik(e);for(let i of n.elements)t.some(r=>Fr(r,i))||t.push(i);return{arrayValue:{values:t}}}var _a=class extends Bl{constructor(e){super(),this.elements=e}};function nk(n,e){let t=ik(e);for(let i of n.elements)t=t.filter(r=>!Fr(r,i));return{arrayValue:{values:t}}}var jl=class extends Bl{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function jN(n){return Ut(n.integerValue||n.doubleValue)}function ik(n){return Tx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var dw=class{constructor(e,t){this.field=e,this.transform=t}};function tH(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof va&&r instanceof va||i instanceof _a&&r instanceof _a?Fl(i.elements,r.elements,Fr):i instanceof jl&&r instanceof jl?Fr(i.Ae,r.Ae):i instanceof ya&&r instanceof ya})(n.transform,e.transform)}var hw=class{constructor(e,t){this.version=e,this.transformResults=t}},as=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function jg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Hl=class{};function rk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ed(n.key,as.none()):new Ea(n.key,n.data,as.none());{let t=n.data,i=Pi.empty(),r=new Sn(ti.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new bo(n.key,i,new Ar(r.toArray()),as.none())}}function nH(n,e,t){n instanceof Ea?(function(r,o,s){let a=r.value.clone(),l=$N(r.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof bo?(function(r,o,s){if(!jg(r.precondition,o))return void o.convertToUnknownDocument(s.version);let a=$N(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(ok(r)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):(function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function fd(n,e,t,i){return n instanceof Ea?(function(o,s,a,l){if(!jg(o.precondition,s))return a;let u=o.value.clone(),d=GN(o.fieldTransforms,l,s);return u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null})(n,e,t,i):n instanceof bo?(function(o,s,a,l){if(!jg(o.precondition,s))return a;let u=GN(o.fieldTransforms,l,s),d=s.data;return d.setAll(ok(o)),d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,i):(function(o,s,a){return jg(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function iH(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=ek(i.transform,r||null);o!=null&&(t===null&&(t=Pi.empty()),t.set(i.field,o))}return t||null}function HN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Fl(i,r,(o,s)=>tH(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ea=class extends Hl{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},bo=class extends Hl{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function ok(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function $N(n,e,t){let i=new Map;Et(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,eH(s,a,t[r]))}return i}function GN(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,X9(o,s,e))}return i}var Ed=class extends Hl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},fw=class extends Hl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var pw=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&nH(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=fd(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=fd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=ZP();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(r.key)?null:a;let l=rk(s,a);l!==null&&i.set(r.key,l),s.isValidDocument()||s.convertToNoDocument(Qe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),et())}isEqual(e){return this.batchId===e.batchId&&Fl(this.mutations,e.mutations,(t,i)=>HN(t,i))&&Fl(this.baseMutations,e.baseMutations,(t,i)=>HN(t,i))}},gw=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Et(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return K9})(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var mw=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var yw=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var dn,lt;function rH(n){switch(n){case G.OK:return ke(64938);case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0;default:return ke(15467,{code:n})}}function sk(n){if(n===void 0)return po("GRPC error has no .code"),G.UNKNOWN;switch(n){case dn.OK:return G.OK;case dn.CANCELLED:return G.CANCELLED;case dn.UNKNOWN:return G.UNKNOWN;case dn.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case dn.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case dn.INTERNAL:return G.INTERNAL;case dn.UNAVAILABLE:return G.UNAVAILABLE;case dn.UNAUTHENTICATED:return G.UNAUTHENTICATED;case dn.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case dn.NOT_FOUND:return G.NOT_FOUND;case dn.ALREADY_EXISTS:return G.ALREADY_EXISTS;case dn.PERMISSION_DENIED:return G.PERMISSION_DENIED;case dn.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case dn.ABORTED:return G.ABORTED;case dn.OUT_OF_RANGE:return G.OUT_OF_RANGE;case dn.UNIMPLEMENTED:return G.UNIMPLEMENTED;case dn.DATA_LOSS:return G.DATA_LOSS;default:return ke(39323,{code:n})}}(lt=dn||(dn={}))[lt.OK=0]="OK",lt[lt.CANCELLED=1]="CANCELLED",lt[lt.UNKNOWN=2]="UNKNOWN",lt[lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lt[lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lt[lt.NOT_FOUND=5]="NOT_FOUND",lt[lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",lt[lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",lt[lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",lt[lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lt[lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lt[lt.ABORTED=10]="ABORTED",lt[lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",lt[lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",lt[lt.INTERNAL=13]="INTERNAL",lt[lt.UNAVAILABLE=14]="UNAVAILABLE",lt[lt.DATA_LOSS=15]="DATA_LOSS";var oH=null;function sH(){return new TextEncoder}var aH=new co([4294967295,4294967295],0);function zN(n){let e=sH().encode(n),t=new Fb;return t.update(e),new Uint8Array(t.digest())}function WN(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new co([t,i],0),new co([r,o],0)]}var vw=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ha(`Invalid padding: ${t}`);if(i<0)throw new ha(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ha(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ha(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=co.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(co.fromNumber(i)));return r.compare(aH)===1&&(r=new co([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=zN(e),[i,r]=WN(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);if(!this.we(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=zN(e),[i,r]=WN(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);this.be(s)}}be(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},ha=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Xg=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,bd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Qe.min(),r,new Qt(it),Eo(),et())}},bd=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,et(),et(),et())}};var Ol=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}},em=class{constructor(e,t){this.targetId=e,this.Ce=t}},tm=class{constructor(e,t,i=Nn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},nm=class{constructor(){this.ve=0,this.Fe=qN(),this.Me=Nn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=et(),t=et(),i=et();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:ke(38017,{changeType:o})}}),new bd(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=qN()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},_w=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Eo(),this.He=Lg(),this.Je=Lg(),this.Ze=new Qt(it)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ke(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){let o=r.target;if(uw(o))if(i===0){let s=new Me(o.path);this.et(t,s,er.newNoDocument(s,Qe.min()))}else Et(i===1,20013,{expectedCount:i});else{let s=this._t(t);if(s!==i){let a=this.ut(e),l=a?this.ct(a,e,s):1;if(l!==0){this.it(t);let u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,u)}oH?.lt((function(d,h,p,g,w){let S={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},P=h.unchangedNames;return P&&(S.bloomFilter={applied:w===0,hashCount:P?.hashCount??0,bitmapLength:P?.bits?.bitmap?.length??0,padding:P?.bits?.padding??0,mightContain:U=>g?.mightContain(U)??!1}),S})(s,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,a;try{s=mo(i).toUint8Array()}catch(l){if(l instanceof Yg)return ls("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new vw(s,r,o)}catch(l){return ls(l instanceof ha?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){let i=this.Ge.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),r++)}),r}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&uw(a.target)){let l=new Me(a.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,er.newNoDocument(l,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let i=et();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let r=new Xg(e,t,this.Ze,this.je,i);return this.je=Eo(),this.He=Lg(),this.Je=Lg(),this.Ze=new Qt(it),r}Ye(e,t){if(!this.rt(e))return;let i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new nm,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Sn(it),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Sn(it),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||we("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new nm),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Lg(){return new Qt(Me.comparator)}function qN(){return new Qt(Me.comparator)}var lH={asc:"ASCENDING",desc:"DESCENDING"},cH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uH={and:"AND",or:"OR"},Ew=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function bw(n,e){return n.useProto3Json||bm(e)?e:{value:e}}function im(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ak(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dH(n,e){return im(n,e.toTimestamp())}function Pr(n){return Et(!!n,49232),Qe.fromTimestamp((function(t){let i=go(t);return new rn(i.seconds,i.nanos)})(n))}function Rx(n,e){return ww(n,e).canonicalString()}function ww(n,e){let t=(function(r){return new Mt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function lk(n){let e=Mt.fromString(n);return Et(fk(e),10190,{key:e.toString()}),e}function xw(n,e){return Rx(n.databaseId,e.path)}function $b(n,e){let t=lk(e);if(t.get(1)!==n.databaseId.projectId)throw new se(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new se(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Me(uk(t))}function ck(n,e){return Rx(n.databaseId,e)}function hH(n){let e=lk(n);return e.length===4?Mt.emptyPath():uk(e)}function Sw(n){return new Mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function uk(n){return Et(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function KN(n,e,t){return{name:xw(n,e),fields:t.value.mapValue.fields}}function fH(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ke(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(u,d){return u.useProto3Json?(Et(d===void 0||typeof d=="string",58123),Nn.fromBase64String(d||"")):(Et(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Nn.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(u){let d=u.code===void 0?G.UNKNOWN:sk(u.code);return new se(d,u.message||"")})(s);t=new tm(i,r,o,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=$b(n,i.document.name),o=Pr(i.document.updateTime),s=i.document.createTime?Pr(i.document.createTime):Qe.min(),a=new Pi({mapValue:{fields:i.document.fields}}),l=er.newFoundDocument(r,o,s,a),u=i.targetIds||[],d=i.removedTargetIds||[];t=new Ol(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=$b(n,i.document),o=i.readTime?Pr(i.readTime):Qe.min(),s=er.newNoDocument(r,o),a=i.removedTargetIds||[];t=new Ol([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=$b(n,i.document),o=i.removedTargetIds||[];t=new Ol([],o,r,null)}else{if(!("filter"in e))return ke(11601,{Vt:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new yw(r,o),a=i.targetId;t=new em(a,s)}}return t}function pH(n,e){let t;if(e instanceof Ea)t={update:KN(n,e.key,e.value)};else if(e instanceof Ed)t={delete:xw(n,e.key)};else if(e instanceof bo)t={update:KN(n,e.key,e.data),updateMask:xH(e.fieldMask)};else{if(!(e instanceof fw))return ke(16599,{dt:e.type});t={verify:xw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(o,s){let a=s.transform;if(a instanceof ya)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof va)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof _a)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof jl)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw ke(20930,{transform:s.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:dH(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ke(27497)})(n,e.precondition)),t}function gH(n,e){return n&&n.length>0?(Et(e!==void 0,14353),n.map(t=>(function(r,o){let s=r.updateTime?Pr(r.updateTime):Pr(o);return s.isEqual(Qe.min())&&(s=Pr(o)),new hw(s,r.transformResults||[])})(t,e))):[]}function mH(n,e){return{documents:[ck(n,e.path)]}}function yH(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=ck(n,r);let o=(function(u){if(u.length!==0)return hk(ki.create(u,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(u){if(u.length!==0)return u.map(d=>(function(p){return{field:Nl(p.field),direction:EH(p.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=bw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:r}}function vH(n){let e=hH(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){Et(i===1,65062);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let p=dk(h);return p instanceof ki&&HP(p)?p.getFilters():[p]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(p=>(function(w){return new us(Pl(w.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(p))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let p;return p=typeof h=="object"?h.value:h,bm(p)?null:p})(t.limit));let l=null;t.startAt&&(l=(function(h){let p=!!h.before,g=h.values||[];return new yo(g,p)})(t.startAt));let u=null;return t.endAt&&(u=(function(h){let p=!h.before,g=h.values||[];return new yo(g,p)})(t.endAt)),H9(e,r,s,o,a,"F",l,u)}function _H(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ke(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function dk(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Pl(t.unaryFilter.field);return tn.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Pl(t.unaryFilter.field);return tn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Pl(t.unaryFilter.field);return tn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Pl(t.unaryFilter.field);return tn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ke(61313);default:return ke(60726)}})(n):n.fieldFilter!==void 0?(function(t){return tn.create(Pl(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ke(58110);default:return ke(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ki.create(t.compositeFilter.filters.map(i=>dk(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ke(1026)}})(t.compositeFilter.op))})(n):ke(30097,{filter:n})}function EH(n){return lH[n]}function bH(n){return cH[n]}function wH(n){return uH[n]}function Nl(n){return{fieldPath:n.canonicalString()}}function Pl(n){return ti.fromServerFormat(n.fieldPath)}function hk(n){return n instanceof tn?(function(t){if(t.op==="=="){if(FN(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NAN"}};if(ON(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(FN(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NOT_NAN"}};if(ON(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nl(t.field),op:bH(t.op),value:t.value}}})(n):n instanceof ki?(function(t){let i=t.getFilters().map(r=>hk(r));return i.length===1?i[0]:{compositeFilter:{op:wH(t.op),filters:i}}})(n):ke(54877,{filter:n})}function xH(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function fk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function pk(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var wd=class n{constructor(e,t,i,r,o=Qe.min(),s=Qe.min(),a=Nn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Iw=class{constructor(e){this.yt=e}};function gk(n){let e=vH({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?_d(e,e.limit,"L"):e}var rm=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ut(e.integerValue));else if("doubleValue"in e){let i=Ut(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),gd(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=go(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(mo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?UP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):VP(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ke(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let i=e.fields||{};this.Ft(t,55);for(let r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){let i=e.fields||{};this.Ft(t,53);let r=Ll,o=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ut(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){let i=e.values||[];this.Ft(t,50);for(let r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Me.fromName(e).path.forEach(i=>{this.Ft(t,60),this.$t(i,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};rm.Wt=new rm;var Tw=class{constructor(){this.Sn=new Cw}addToCollectionParentIndex(e,t){return this.Sn.add(t),ee.resolve()}getCollectionParents(e,t){return ee.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ee.resolve()}deleteFieldIndex(e,t){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,t){return ee.resolve()}getDocumentsMatchingTarget(e,t){return ee.resolve(null)}getIndexType(e,t){return ee.resolve(0)}getFieldIndexes(e,t){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,t){return ee.resolve(ma.min())}getMinOffsetFromCollectionGroup(e,t){return ee.resolve(ma.min())}updateCollectionGroup(e,t,i){return ee.resolve()}updateIndexEntries(e,t){return ee.resolve()}},Cw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Sn(Mt.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Sn(Mt.comparator)).toArray()}};var Cue=new Uint8Array(0);var QN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mk=41943040,Ni=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};Ni.DEFAULT_COLLECTION_PERCENTILE=10,Ni.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ni.DEFAULT=new Ni(mk,Ni.DEFAULT_COLLECTION_PERCENTILE,Ni.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ni.DISABLED=new Ni(-1,0,0);var xd=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var YN="LruGarbageCollector",SH=1048576;function JN([n,e],[t,i]){let r=it(n,t);return r===0?it(e,i):r}var Dw=class{constructor(e){this.Pr=e,this.buffer=new Sn(JN),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();JN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Aw=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){we(YN,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Yl(t)?we(YN,"Ignoring IndexedDB error during garbage collection: ",t):await Ql(t)}await this.Ar(3e5)})}},Mw=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return ee.resolve(wx.ce);let i=new Dw(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(we("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(QN)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(we("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),QN):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,s,a,l,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(we("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,s=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(u=Date.now(),Ml()<=Xe.DEBUG&&we("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${r} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:h})))}};function IH(n,e){return new Mw(n,e)}var Rw=class{constructor(){this.changes=new _o(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,er.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?ee.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Nw=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Pw=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&fd(i.mutation,r,Ar.empty(),rn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,et()).next(()=>i))}getLocalViewOfDocuments(e,t,i=et()){let r=da();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=ud();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=da();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,et()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,i,r){let o=Eo(),s=hd(),a=(function(){return hd()})();return t.forEach((l,u)=>{let d=i.get(u.key);r.has(u.key)&&(d===void 0||d.mutation instanceof bo)?o=o.insert(u.key,u):d!==void 0?(s.set(u.key,d.mutation.getFieldMask()),fd(d.mutation,u,d.mutation.getFieldMask(),rn.now())):s.set(u.key,Ar.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((u,d)=>s.set(u,d)),t.forEach((u,d)=>a.set(u,new Nw(d,s.get(u)??null))),a))}recalculateAndSaveOverlays(e,t){let i=hd(),r=new Qt((s,a)=>s-a),o=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let u=t.get(l);if(u===null)return;let d=i.get(l)||Ar.empty();d=a.applyToLocalView(u,d),i.set(l,d);let h=(r.get(a.batchId)||et()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),u=l.key,d=l.value,h=ZP();d.forEach(p=>{if(!o.has(p)){let g=rk(t.get(p),i.get(p));g!==null&&h.set(p,g),o=o.add(p)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ee.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return $9(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):xm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):ee.resolve(da()),a=pd,l=o;return s.next(u=>ee.forEach(u,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?ee.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,l,u,et())).next(d=>({batchId:a,changes:JP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Me(t)).next(i=>{let r=ud();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=ud();return this.indexManager.getCollectionParents(e,o).next(a=>ee.forEach(a,l=>{let u=(function(h,p){return new vo(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,i,r).next(d=>{d.forEach((h,p)=>{s=s.insert(h,p)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((l,u)=>{let d=u.getKey();s.get(d)===null&&(s=s.insert(d,er.newInvalidDocument(d)))});let a=ud();return s.forEach((l,u)=>{let d=o.get(l);d!==void 0&&fd(d.mutation,u,Ar.empty(),rn.now()),Tm(t,u)&&(a=a.insert(l,u))}),a})}};var kw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ee.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Pr(r.createTime)}})(t)),ee.resolve()}getNamedQuery(e,t){return ee.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:gk(r.bundledQuery),readTime:Pr(r.readTime)}})(t)),ee.resolve()}};var Ow=class{constructor(){this.overlays=new Qt(Me.comparator),this.Lr=new Map}getOverlay(e,t){return ee.resolve(this.overlays.get(t))}getOverlays(e,t){let i=da();return ee.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.bt(e,t,o)}),ee.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Lr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(i)),ee.resolve()}getOverlaysForCollection(e,t,i){let r=da(),o=t.length+1,s=new Me(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===o&&l.largestBatchId>i&&r.set(l.getKey(),l)}return ee.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Qt((u,d)=>u-d),s=this.overlays.getIterator();for(;s.hasNext();){let u=s.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let d=o.get(u.largestBatchId);d===null&&(d=da(),o=o.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=da(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=r)););return ee.resolve(a)}bt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new mw(t,i));let o=this.Lr.get(t);o===void 0&&(o=et(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}};var Fw=class{constructor(){this.sessionToken=Nn.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ee.resolve()}};var Sd=class{constructor(){this.kr=new Sn(hn.Kr),this.qr=new Sn(hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let i=new hn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new hn(e,t))}Qr(e,t){e.forEach(i=>this.removeReference(i,t))}Gr(e){let t=new Me(new Mt([])),i=new hn(t,e),r=new hn(t,e+1),o=[];return this.qr.forEachInRange([i,r],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new Me(new Mt([])),i=new hn(t,e),r=new hn(t,e+1),o=et();return this.qr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new hn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},hn=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Me.comparator(e.key,t.key)||it(e.Hr,t.Hr)}static Ur(e,t){return it(e.Hr,t.Hr)||Me.comparator(e.key,t.key)}};var Lw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Sn(hn.Kr)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new pw(o,t,i,r);this.mutationQueue.push(s);for(let a of r)this.Jr=this.Jr.add(new hn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ee.resolve(s)}lookupMutationBatch(e,t){return ee.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),o=r<0?0:r;return ee.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?xx:this.Yn-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new hn(t,0),r=new hn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],s=>{let a=this.Zr(s.Hr);o.push(a)}),ee.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Sn(it);return t.forEach(r=>{let o=new hn(r,0),s=new hn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{i=i.add(a.Hr)})}),ee.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;Me.isDocumentKey(o)||(o=o.child(""));let s=new hn(new Me(o),0),a=new Sn(it);return this.Jr.forEachWhile(l=>{let u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(a=a.add(l.Hr)),!0)},s),ee.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Et(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ee.forEach(t.mutations,r=>{let o=new hn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Jr=i})}nr(e){}containsKey(e,t){let i=new hn(t,0),r=this.Jr.firstAfterOrEqual(i);return ee.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Vw=class{constructor(e){this.ti=e,this.docs=(function(){return new Qt(Me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return ee.resolve(i?i.document.mutableCopy():er.newInvalidDocument(t))}getEntries(e,t){let i=Eo();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():er.newInvalidDocument(r))}),ee.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=Eo(),s=t.path,a=new Me(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:u,value:{document:d}}=l.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||x9(w9(d),i)<=0||(r.has(d.key)||Tm(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return ee.resolve(o)}getAllFromCollectionGroup(e,t,i,r){ke(9500)}ni(e,t){return ee.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Uw(this)}getSize(e){return ee.resolve(this.size)}},Uw=class extends Rw{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)}),ee.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var Bw=class{constructor(e){this.persistence=e,this.ri=new _o(t=>Cx(t),Dx),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.ii=0,this.si=new Sd,this.targetCount=0,this.oi=xd._r()}forEachTarget(e,t){return this.ri.forEach((i,r)=>t(r)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ee.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new xd(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ee.resolve()}updateTargetData(e,t){return this.lr(t),ee.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),ee.waitFor(o).next(()=>r)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,t){let i=this.ri.get(t)||null;return ee.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ee.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),ee.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ee.resolve()}getMatchingKeysForTargetId(e,t){let i=this.si.jr(t);return ee.resolve(i)}containsKey(e,t){return ee.resolve(this.si.containsKey(t))}};var om=class{constructor(e,t){this._i={},this.overlays={},this.ai=new wx(0),this.ui=!1,this.ui=!0,this.ci=new Fw,this.referenceDelegate=e(this),this.li=new Bw(this),this.indexManager=new Tw,this.remoteDocumentCache=(function(r){return new Vw(r)})(i=>this.referenceDelegate.hi(i)),this.serializer=new Iw(t),this.Pi=new kw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ow,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new Lw(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){we("MemoryPersistence","Starting transaction:",e);let r=new jw(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(o=>this.referenceDelegate.Ii(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ei(e,t){return ee.or(Object.values(this._i).map(i=>()=>i.containsKey(e,t)))}},jw=class extends Jb{constructor(e){super(),this.currentSequenceNumber=e}},Hw=class n{constructor(e){this.persistence=e,this.Ri=new Sd,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw ke(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ee.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ee.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ee.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(r=>this.di.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.di,i=>{let r=Me.fromPath(i);return this.mi(e,r).next(o=>{o||t.removeEntry(r,Qe.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return ee.or([()=>ee.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},sm=class n{constructor(e,t){this.persistence=e,this.fi=new _o(i=>C9(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=IH(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return ee.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}pr(e){let t=0;return this.mr(e,i=>{t++}).next(()=>t)}mr(e,t){return ee.forEach(this.fi,(i,r)=>this.wr(e,i,r).next(o=>o?ee.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,s=>this.wr(e,s,t).next(a=>{a||(i++,o.removeEntry(s,Qe.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ug(e.data.value)),t}wr(e,t,i){return ee.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.fi.get(t);return ee.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var $w=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=et(),r=et();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var Gw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var zw=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return sN()?8:I9(bn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new Gw;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,i,r){return i.documentReadCount<this.Vs?(Ml()<=Xe.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",Rl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ee.resolve()):(Ml()<=Xe.DEBUG&&we("QueryEngine","Query:",Rl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Ml()<=Xe.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",Rl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nr(t))):ee.resolve())}gs(e,t){if(BN(t))return ee.resolve(null);let i=Nr(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=_d(t,null,"F"),i=Nr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=et(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{let u=this.bs(t,a);return this.Ss(t,u,s,l.readTime)?this.gs(e,_d(t,null,"F")):this.Ds(e,u,t,l)}))})))}ps(e,t,i,r){return BN(t)||r.isEqual(Qe.min())?ee.resolve(null):this.fs.getDocuments(e,i).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,i,r)?ee.resolve(null):(Ml()<=Xe.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Rl(t)),this.Ds(e,s,t,b9(r,pd)).next(a=>a))})}bs(e,t){let i=new Sn(QP(e));return t.forEach((r,o)=>{Tm(e,o)&&(i=i.add(o))}),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return Ml()<=Xe.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",Rl(t)),this.fs.getDocumentsMatchingQuery(e,t,ma.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Nx="LocalStore",TH=3e8,Ww=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Qt(it),this.Fs=new _o(o=>Cx(o),Dx),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Pw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function CH(n,e,t,i){return new Ww(n,e,t,i)}async function yk(n,e){let t=Ge(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],a=[],l=et();for(let u of r){s.push(u.batchId);for(let d of u.mutations)l=l.add(d.key)}for(let u of o){a.push(u.batchId);for(let d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(u=>({Ns:u,removedBatchIds:s,addedBatchIds:a}))})})}function DH(n,e){let t=Ge(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,l,u,d){let h=u.batch,p=h.keys(),g=ee.resolve();return p.forEach(w=>{g=g.next(()=>d.getEntry(l,w)).next(S=>{let P=u.docVersions.get(w);Et(P!==null,48541),S.version.compareTo(P)<0&&(h.applyToRemoteDocument(S,u),S.isValidDocument()&&(S.setReadTime(u.commitVersion),d.addEntry(S)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))})(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=et();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function vk(n){let e=Ge(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function AH(n,e){let t=Ge(n),i=e.snapshotVersion,r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;let a=[];e.targetChanges.forEach((d,h)=>{let p=r.get(h);if(!p)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,h)));let g=p.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Nn.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,i)),r=r.insert(h,g),(function(S,P,U){return S.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=TH?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0})(p,g,d)&&a.push(t.li.updateTargetData(o,g))});let l=Eo(),u=et();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(MH(o,s,e.documentUpdates).next(d=>{l=d.Bs,u=d.Ls})),!i.isEqual(Qe.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(h=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i));a.push(d)}return ee.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,u)).next(()=>l)}).then(o=>(t.vs=r,o))}function MH(n,e,t){let i=et(),r=et();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=Eo();return t.forEach((a,l)=>{let u=o.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Qe.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):we(Nx,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Bs:s,Ls:r}})}function RH(n,e){let t=Ge(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=xx),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function NH(n,e){let t=Ge(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.li.getTargetData(i,e).next(o=>o?(r=o,ee.resolve(r)):t.li.allocateTargetId(i).next(s=>(r=new wd(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i})}async function qw(n,e,t){let i=Ge(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r))}catch(s){if(!Yl(s))throw s;we(Nx,`Failed to update sequence numbers for target ${e}: ${s}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function ZN(n,e,t){let i=Ge(n),r=Qe.min(),o=et();return i.persistence.runTransaction("Execute query","readwrite",s=>(function(l,u,d){let h=Ge(l),p=h.Fs.get(d);return p!==void 0?ee.resolve(h.vs.get(p)):h.li.getTargetData(u,d)})(i,s,Nr(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(s,e,t?r:Qe.min(),t?o:et())).next(a=>(PH(i,z9(e),a),{documents:a,ks:o})))}function PH(n,e,t){let i=n.Ms.get(e)||Qe.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ms.set(e,i)}var am=class{constructor(){this.activeTargetIds=J9()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Kw=class{constructor(){this.vo=new am,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new am,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Qw=class{Mo(e){}shutdown(){}};var XN="ConnectivityMonitor",lm=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){we(XN,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){we(XN,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Vg=null;function Yw(){return Vg===null?Vg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Vg++,"0x"+Vg.toString(16)}var Gb="RestConnection",kH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},Jw=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===Jg?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){let s=Yw(),a=this.Qo(e,t.toUriEncodedString());we(Gb,`Sending RPC '${e}' ${s}:`,a,i);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,r,o);let{host:u}=new URL(a),d=ns(u);return this.zo(e,a,l,i,d).then(h=>(we(Gb,`Received RPC '${e}' ${s}: `,h),h),h=>{throw ls(Gb,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",i),h})}jo(e,t,i,r,o,s){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),i&&i.headers.forEach((r,o)=>e[o]=r)}Qo(e,t){let i=kH[e],r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}};var Zw=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Bn="WebChannelConnection",cd=(n,e,t)=>{n.listen(e,i=>{try{t(i)}catch(r){setTimeout(()=>{throw r},0)}})},cm=class n extends Jw{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=Bb();cd(e,Ub.STAT_EVENT,t=>{t.stat===Og.PROXY?we(Bn,"STAT_EVENT: detected buffering proxy"):t.stat===Og.NOPROXY&&we(Bn,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,i,r,o){let s=Yw();return new Promise((a,l)=>{let u=new Lb;u.setWithCredentials(!0),u.listenOnce(Vb.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case ld.NO_ERROR:let h=u.getResponseJson();we(Bn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case ld.TIMEOUT:we(Bn,`RPC '${e}' ${s} timed out`),l(new se(G.DEADLINE_EXCEEDED,"Request time out"));break;case ld.HTTP_ERROR:let p=u.getStatus();if(we(Bn,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);let w=g?.error;if(w&&w.status&&w.message){let S=(function(U){let ie=U.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(ie)>=0?ie:G.UNKNOWN})(w.status);l(new se(S,w.message))}else l(new se(G.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new se(G.UNAVAILABLE,"Connection failed."));break;default:ke(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{we(Bn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);we(Bn,`RPC '${e}' ${s} sending request:`,r),u.send(t,"POST",d,i,15)})}T_(e,t,i){let r=Yw(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;let u=o.join("");we(Bn,`Creating RPC '${e}' stream ${r}: ${u}`,a);let d=s.createWebChannel(u,a);this.I_(d);let h=!1,p=!1,g=new Zw({Ho:w=>{p?we(Bn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(h||(we(Bn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),we(Bn,`RPC '${e}' stream ${r} sending:`,w),d.send(w))},Jo:()=>d.close()});return cd(d,Al.EventType.OPEN,()=>{p||(we(Bn,`RPC '${e}' stream ${r} transport opened.`),g.i_())}),cd(d,Al.EventType.CLOSE,()=>{p||(p=!0,we(Bn,`RPC '${e}' stream ${r} transport closed`),g.o_(),this.E_(d))}),cd(d,Al.EventType.ERROR,w=>{p||(p=!0,ls(Bn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),g.o_(new se(G.UNAVAILABLE,"The operation could not be completed")))}),cd(d,Al.EventType.MESSAGE,w=>{if(!p){let S=w.data[0];Et(!!S,16349);let P=S,U=P?.error||P[0]?.error;if(U){we(Bn,`RPC '${e}' stream ${r} received error:`,U);let ie=U.status,Se=(function(Ie){let k=dn[Ie];if(k!==void 0)return sk(k)})(ie),xe=U.message;Se===void 0&&(Se=G.INTERNAL,xe="Unknown error status: "+ie+" with message "+U.message),p=!0,g.o_(new se(Se,xe)),d.close()}else we(Bn,`RPC '${e}' stream ${r} received:`,S),g.__(S)}}),n.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return jb()}};function OH(n){return new cm(n)}function zb(){return typeof document<"u"?document:null}function Md(n){return new Ew(n,!0)}cm.c_=!1;var um=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&we("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var eP="PersistentStream",dm=class{constructor(e,t,i,r,o,s,a,l){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new um(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===G.RESOURCE_EXHAUSTED?(po(t.toString()),po("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{let r=new se(G.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){let i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return we(eP,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(we(eP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Xw=class extends dm{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=fH(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Qe.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Qe.min():s.readTime?Pr(s.readTime):Qe.min()})(e);return this.listener.J_(t,i)}Z_(e){let t={};t.database=Sw(this.serializer),t.addTarget=(function(o,s){let a,l=s.target;if(a=uw(l)?{documents:mH(o,l)}:{query:yH(o,l).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=ak(o,s.resumeToken);let u=bw(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(Qe.min())>0){a.readTime=im(o,s.snapshotVersion.toTimestamp());let u=bw(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a})(this.serializer,e);let i=_H(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){let t={};t.database=Sw(this.serializer),t.removeTarget=e,this.K_(t)}},ex=class extends dm{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=gH(e.writeResults,e.commitTime),i=Pr(e.commitTime);return this.listener.na(i,t)}ra(){let e={};e.database=Sw(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>pH(this.serializer,i))};this.K_(t)}};var tx=class{},nx=class extends tx{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new se(G.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,ww(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new se(G.UNKNOWN,o.toString())})}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,ww(t,i),r,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new se(G.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function FH(n,e,t,i){return new nx(n,e,t,i)}var ix=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(po(t),this.aa=!1):we("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var ba="RemoteStore",rx=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{i.enqueueAndForget(async()=>{Ia(this)&&(we(ba,"Restarting streams for network reachability change."),await(async function(l){let u=Ge(l);u.Ea.add(4),await Rd(u),u.Va.set("Unknown"),u.Ea.delete(4),await Cm(u)})(this))})}),this.Va=new ix(i,r)}};async function Cm(n){if(Ia(n))for(let e of n.Ra)await e(!0)}async function Rd(n){for(let e of n.Ra)await e(!1)}function _k(n,e){let t=Ge(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Fx(t)?Ox(t):Jl(t).O_()&&kx(t,e))}function Px(n,e){let t=Ge(n),i=Jl(t);t.Ia.delete(e),i.O_()&&Ek(t,e),t.Ia.size===0&&(i.O_()?i.L_():Ia(t)&&t.Va.set("Unknown"))}function kx(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Jl(n).Z_(e)}function Ek(n,e){n.da.$e(e),Jl(n).X_(e)}function Ox(n){n.da=new _w({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Jl(n).start(),n.Va.ua()}function Fx(n){return Ia(n)&&!Jl(n).x_()&&n.Ia.size>0}function Ia(n){return Ge(n).Ea.size===0}function bk(n){n.da=void 0}async function LH(n){n.Va.set("Online")}async function VH(n){n.Ia.forEach((e,t)=>{kx(n,e)})}async function UH(n,e){bk(n),Fx(n)?(n.Va.ha(e),Ox(n)):n.Va.set("Unknown")}async function BH(n,e,t){if(n.Va.set("Online"),e instanceof tm&&e.state===2&&e.cause)try{await(async function(r,o){let s=o.cause;for(let a of o.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.da.removeTarget(a))})(n,e)}catch(i){we(ba,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await hm(n,i)}else if(e instanceof Ol?n.da.Xe(e):e instanceof em?n.da.st(e):n.da.tt(e),!t.isEqual(Qe.min()))try{let i=await vk(n.localStore);t.compareTo(i)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.Ia.get(u);d&&o.Ia.set(u,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,u)=>{let d=o.Ia.get(l);if(!d)return;o.Ia.set(l,d.withResumeToken(Nn.EMPTY_BYTE_STRING,d.snapshotVersion)),Ek(o,l);let h=new wd(d.target,l,u,d.sequenceNumber);kx(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){we(ba,"Failed to raise snapshot:",i),await hm(n,i)}}async function hm(n,e,t){if(!Yl(e))throw e;n.Ea.add(1),await Rd(n),n.Va.set("Offline"),t||(t=()=>vk(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{we(ba,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Cm(n)})}function wk(n,e){return e().catch(t=>hm(n,t,e))}async function Dm(n){let e=Ge(n),t=ds(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:xx;for(;jH(e);)try{let r=await RH(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,HH(e,r)}catch(r){await hm(e,r)}xk(e)&&Sk(e)}function jH(n){return Ia(n)&&n.Ta.length<10}function HH(n,e){n.Ta.push(e);let t=ds(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function xk(n){return Ia(n)&&!ds(n).x_()&&n.Ta.length>0}function Sk(n){ds(n).start()}async function $H(n){ds(n).ra()}async function GH(n){let e=ds(n);for(let t of n.Ta)e.ea(t.mutations)}async function zH(n,e,t){let i=n.Ta.shift(),r=gw.from(i,e,t);await wk(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Dm(n)}async function WH(n,e){e&&ds(n).Y_&&await(async function(i,r){if((function(s){return rH(s)&&s!==G.ABORTED})(r.code)){let o=i.Ta.shift();ds(i).B_(),await wk(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Dm(i)}})(n,e),xk(n)&&Sk(n)}async function tP(n,e){let t=Ge(n);t.asyncQueue.verifyOperationInProgress(),we(ba,"RemoteStore received new credentials");let i=Ia(t);t.Ea.add(3),await Rd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Cm(t)}async function qH(n,e){let t=Ge(n);e?(t.Ea.delete(2),await Cm(t)):e||(t.Ea.add(2),await Rd(t),t.Va.set("Unknown"))}function Jl(n){return n.ma||(n.ma=(function(t,i,r){let o=Ge(t);return o.sa(),new Xw(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:LH.bind(null,n),Yo:VH.bind(null,n),t_:UH.bind(null,n),J_:BH.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),Fx(n)?Ox(n):n.Va.set("Unknown")):(await n.ma.stop(),bk(n))})),n.ma}function ds(n){return n.fa||(n.fa=(function(t,i,r){let o=Ge(t);return o.sa(),new ex(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:$H.bind(null,n),t_:WH.bind(null,n),ta:GH.bind(null,n),na:zH.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Dm(n)):(await n.fa.stop(),n.Ta.length>0&&(we(ba,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var ox=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new Mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,a=new n(e,t,s,r,o);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Lx(n,e){if(po("AsyncQueue",`${e}: ${n}`),Yl(n))return new se(G.UNAVAILABLE,`${e}: ${n}`);throw n}var Id=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Me.comparator(t.key,i.key):(t,i)=>Me.comparator(t.key,i.key),this.keyedMap=ud(),this.sortedSet=new Qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var fm=class{constructor(){this.ga=new Qt(Me.comparator)}track(e){let t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ke(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}},wa=class n{constructor(e,t,i,r,o,s,a,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Id.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Im(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var sx=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},ax=class{constructor(){this.queries=nP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){let r=Ge(t),o=r.queries;r.queries=nP(),o.forEach((s,a)=>{for(let l of a.ba)l.onError(i)})})(this,new se(G.ABORTED,"Firestore shutting down"))}};function nP(){return new _o(n=>KP(n),Im)}async function KH(n,e){let t=Ge(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new sx,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(s){let a=Lx(s,`Initialization of query '${Rl(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Vx(t)}async function QH(n,e){let t=Ge(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function YH(n,e){let t=Ge(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(r)&&(i=!0);s.wa=r}}i&&Vx(t)}function JH(n,e,t){let i=Ge(n),r=i.queries.get(e);if(r)for(let o of r.ba)o.onError(t);i.queries.delete(e)}function Vx(n){n.Ca.forEach(e=>{e.next()})}var lx,iP;(iP=lx||(lx={})).Ma="default",iP.Cache="cache";var cx=class{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new wa(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=wa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==lx.Cache}};var pm=class{constructor(e){this.key=e}},gm=class{constructor(e){this.key=e}},ux=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=et(),this.mutatedKeys=et(),this.eu=QP(e),this.tu=new Id(this.eu)}get nu(){return this.Za}ru(e,t){let i=t?t.iu:new fm,r=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{let p=r.get(d),g=Tm(this.query,h)?h:null,w=!!p&&this.mutatedKeys.has(p.key),S=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),P=!1;p&&g?p.data.isEqual(g.data)?w!==S&&(i.track({type:3,doc:g}),P=!0):this.su(p,g)||(i.track({type:2,doc:g}),P=!0,(l&&this.eu(g,l)>0||u&&this.eu(g,u)<0)&&(a=!0)):!p&&g?(i.track({type:0,doc:g}),P=!0):p&&!g&&(i.track({type:1,doc:p}),P=!0,(l||u)&&(a=!0)),P&&(g?(s=s.add(g),o=S?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),i.track({type:1,doc:d})}return{tu:s,iu:i,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,h)=>(function(g,w){let S=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ke(20277,{Vt:P})}};return S(g)-S(w)})(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(i),r=r??!1;let a=t&&!r?this._u():[],l=this.Ya.size===0&&this.current&&!r?1:0,u=l!==this.Xa;return this.Xa=l,s.length!==0||u?{snapshot:new wa(this.query,e.tu,o,s,e.mutatedKeys,l===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new fm,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=et(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});let t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new gm(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new pm(i))}),t}cu(e){this.Za=e.ks,this.Ya=et();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return wa.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},Ux="SyncEngine",dx=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},hx=class{constructor(e){this.key=e,this.hu=!1}},fx=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new _o(a=>KP(a),Im),this.Iu=new Map,this.Eu=new Set,this.Ru=new Qt(Me.comparator),this.Au=new Map,this.Vu=new Sd,this.du={},this.mu=new Map,this.fu=xd.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function ZH(n,e,t=!0){let i=Mk(n),r,o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await Ik(i,e,t,!0),r}async function XH(n,e){let t=Mk(n);await Ik(t,e,!0,!1)}async function Ik(n,e,t,i){let r=await NH(n.localStore,Nr(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return i&&(a=await e$(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&_k(n.remoteStore,r),a}async function e$(n,e,t,i,r){n.pu=(h,p,g)=>(async function(S,P,U,ie){let Se=P.view.ru(U);Se.Ss&&(Se=await ZN(S.localStore,P.query,!1).then(({documents:k})=>P.view.ru(k,Se)));let xe=ie&&ie.targetChanges.get(P.targetId),De=ie&&ie.targetMismatches.get(P.targetId)!=null,Ie=P.view.applyChanges(Se,S.isPrimaryClient,xe,De);return oP(S,P.targetId,Ie.au),Ie.snapshot})(n,h,p,g);let o=await ZN(n.localStore,e,!0),s=new ux(e,o.ks),a=s.ru(o.documents),l=bd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),u=s.applyChanges(a,n.isPrimaryClient,l);oP(n,t,u.au);let d=new dx(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function t$(n,e,t){let i=Ge(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter(s=>!Im(s,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await qw(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Px(i.remoteStore,r.targetId),px(i,r.targetId)}).catch(Ql)):(px(i,r.targetId),await qw(i.localStore,r.targetId,!0))}async function n$(n,e){let t=Ge(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Px(t.remoteStore,i.targetId))}async function i$(n,e,t){let i=u$(n);try{let r=await(function(s,a){let l=Ge(s),u=rn.now(),d=a.reduce((g,w)=>g.add(w.key),et()),h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let w=Eo(),S=et();return l.xs.getEntries(g,d).next(P=>{w=P,w.forEach((U,ie)=>{ie.isValidDocument()||(S=S.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,w)).next(P=>{h=P;let U=[];for(let ie of a){let Se=iH(ie,h.get(ie.key).overlayedDocument);Se!=null&&U.push(new bo(ie.key,Se,BP(Se.value.mapValue),as.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,U,a)}).next(P=>{p=P;let U=P.applyToLocalDocumentSet(h,S);return l.documentOverlayCache.saveOverlays(g,P.batchId,U)})}).then(()=>({batchId:p.batchId,changes:JP(h)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(s,a,l){let u=s.du[s.currentUser.toKey()];u||(u=new Qt(it)),u=u.insert(a,l),s.du[s.currentUser.toKey()]=u})(i,r.batchId,t),await Nd(i,r.changes),await Dm(i.remoteStore)}catch(r){let o=Lx(r,"Failed to persist write");t.reject(o)}}async function Tk(n,e){let t=Ge(n);try{let i=await AH(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Au.get(o);s&&(Et(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?s.hu=!0:r.modifiedDocuments.size>0?Et(s.hu,14607):r.removedDocuments.size>0&&(Et(s.hu,42227),s.hu=!1))}),await Nd(t,i,e)}catch(i){await Ql(i)}}function rP(n,e,t){let i=Ge(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(s,a){let l=Ge(s);l.onlineState=a;let u=!1;l.queries.forEach((d,h)=>{for(let p of h.ba)p.va(a)&&(u=!0)}),u&&Vx(l)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function r$(n,e,t){let i=Ge(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Au.get(e),o=r&&r.key;if(o){let s=new Qt(Me.comparator);s=s.insert(o,er.newNoDocument(o,Qe.min()));let a=et().add(o),l=new Xg(Qe.min(),new Map,new Qt(it),s,a);await Tk(i,l),i.Ru=i.Ru.remove(o),i.Au.delete(e),Bx(i)}else await qw(i.localStore,e,!1).then(()=>px(i,e,t)).catch(Ql)}async function o$(n,e){let t=Ge(n),i=e.batch.batchId;try{let r=await DH(t.localStore,e);Dk(t,i,null),Ck(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Nd(t,r)}catch(r){await Ql(r)}}async function s$(n,e,t){let i=Ge(n);try{let r=await(function(s,a){let l=Ge(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(h=>(Et(h!==null,37113),d=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})})(i.localStore,e);Dk(i,e,t),Ck(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Nd(i,r)}catch(r){await Ql(r)}}function Ck(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function Dk(n,e,t){let i=Ge(n),r=i.du[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function px(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(i=>{n.Vu.containsKey(i)||Ak(n,i)})}function Ak(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(Px(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Bx(n))}function oP(n,e,t){for(let i of t)i instanceof pm?(n.Vu.addReference(i.key,e),a$(n,i)):i instanceof gm?(we(Ux,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||Ak(n,i.key)):ke(19791,{wu:i})}function a$(n,e){let t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(we(Ux,"New document in limbo: "+t),n.Eu.add(i),Bx(n))}function Bx(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new Me(Mt.fromString(e)),i=n.fu.next();n.Au.set(i,new hx(t)),n.Ru=n.Ru.insert(t,i),_k(n.remoteStore,new wd(Nr(Ax(t.path)),i,"TargetPurposeLimboResolution",wx.ce))}}async function Nd(n,e,t){let i=Ge(n),r=[],o=[],s=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{s.push(i.pu(l,e,t).then(u=>{if((u||t)&&i.isPrimaryClient){let d=u?!u.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){r.push(u);let d=$w.Es(l.targetId,u);o.push(d)}}))}),await Promise.all(s),i.Pu.J_(r),await(async function(l,u){let d=Ge(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ee.forEach(u,p=>ee.forEach(p.Ts,g=>d.persistence.referenceDelegate.addReference(h,p.targetId,g)).next(()=>ee.forEach(p.Is,g=>d.persistence.referenceDelegate.removeReference(h,p.targetId,g)))))}catch(h){if(!Yl(h))throw h;we(Nx,"Failed to update sequence numbers: "+h)}for(let h of u){let p=h.targetId;if(!h.fromCache){let g=d.vs.get(p),w=g.snapshotVersion,S=g.withLastLimboFreeSnapshotVersion(w);d.vs=d.vs.insert(p,S)}}})(i.localStore,o))}async function l$(n,e){let t=Ge(n);if(!t.currentUser.isEqual(e)){we(Ux,"User change. New user:",e.toKey());let i=await yk(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(l=>{l.reject(new se(G.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Nd(t,i.Ns)}}function c$(n,e){let t=Ge(n),i=t.Au.get(e);if(i&&i.hu)return et().add(i.key);{let r=et(),o=t.Iu.get(e);if(!o)return r;for(let s of o){let a=t.Tu.get(s);r=r.unionWith(a.view.nu)}return r}}function Mk(n){let e=Ge(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Tk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r$.bind(null,e),e.Pu.J_=YH.bind(null,e.eventManager),e.Pu.yu=JH.bind(null,e.eventManager),e}function u$(n){let e=Ge(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=o$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s$.bind(null,e),e}var jx=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Md(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return CH(this.persistence,new zw,t.initialUser,this.serializer)}Cu(t){return new om(Hw.Vi,this.serializer)}Du(t){return new Kw}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),mm=class extends jx{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Et(this.persistence.referenceDelegate instanceof sm,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new Aw(i,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Ni.withCacheSize(this.cacheSizeBytes):Ni.DEFAULT;return new om(i=>sm.Vi(i,t),this.serializer)}};var Rk=(()=>{class n{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>rP(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=l$.bind(null,this.syncEngine),await qH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new ax})()}createDatastore(t){let i=Md(t.databaseInfo.databaseId),r=OH(t.databaseInfo);return FH(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,s,a,l){return new rx(r,o,s,a,l)})(this.localStore,this.datastore,t.asyncQueue,i=>rP(this.syncEngine,i,0),(function(){return lm.v()?new lm:new Qw})())}createSyncEngine(t,i){return(function(o,s,a,l,u,d,h){let p=new fx(o,s,a,l,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){let r=Ge(i);we(ba,"RemoteStore shutting down."),r.Ea.add(5),await Rd(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var gx=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):po("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var hs="FirestoreClient",mx=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=xn.UNAUTHENTICATED,this.clientId=ga.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async s=>{we(hs,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(we(hs,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Lx(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}};async function Wb(n,e){n.asyncQueue.verifyOperationInProgress(),we(hs,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await yk(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function sP(n,e){n.asyncQueue.verifyOperationInProgress();let t=await d$(n);we(hs,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>tP(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>tP(e.remoteStore,r)),n._onlineComponents=e}async function d$(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){we(hs,"Using user provided OfflineComponentProvider");try{await Wb(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===G.FAILED_PRECONDITION||r.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;ls("Error using user provided cache. Falling back to memory cache: "+t),await Wb(n,new jx)}}else we(hs,"Using default OfflineComponentProvider"),await Wb(n,new mm(void 0));return n._offlineComponents}async function Nk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(we(hs,"Using user provided OnlineComponentProvider"),await sP(n,n._uninitializedComponentsProvider._online)):(we(hs,"Using default OnlineComponentProvider"),await sP(n,new Rk))),n._onlineComponents}function h$(n){return Nk(n).then(e=>e.syncEngine)}async function f$(n){let e=await Nk(n),t=e.eventManager;return t.onListen=ZH.bind(null,e.syncEngine),t.onUnlisten=t$.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=XH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=n$.bind(null,e.syncEngine),t}function Pk(n,e,t={}){let i=new Mr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,u){let d=new gx({next:p=>{d.Nu(),s.enqueueAndForget(()=>QH(o,h)),p.fromCache&&l.source==="server"?u.reject(new se(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new cx(a,d,{includeMetadataChanges:!0,Ka:!0});return KH(o,h)})(await f$(n),n.asyncQueue,e,t,i)),i.promise}function kk(n,e){let t=new Mr;return n.asyncQueue.enqueueAndForget(async()=>i$(await h$(n),e,t)),t.promise}function Ok(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var p$="ComponentProvider",aP=new Map;function g$(n,e,t,i,r){return new Zb(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ok(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}var Fk="firestore.googleapis.com",lP=!0,ym=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new se(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Fk,this.ssl=lP}else this.host=e.host,this.ssl=e.ssl??lP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=mk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SH)throw new se(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ok(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new se(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new se(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new se(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},$l=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ym({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ym(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new $g;switch(i.type){case"firstParty":return new Qb(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new se(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=aP.get(t);i&&(we(p$,"Removing Datastore"),aP.delete(t),i.terminate())})(this),Promise.resolve()}};function Lk(n,e,t,i={}){n=ql(n,$l);let r=ns(e),o=n._getSettings(),s=me(L({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;r&&(Dg(`https://${a}`),Ag("Firestore",!0)),o.host!==Fk&&o.host!==a&&ls("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=me(L({},o),{host:a,ssl:r,emulatorOptions:i});if(!Zi(l,s)&&(n._setSettings(l),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=xn.MOCK_USER;else{u=eN(i.mockUserToken,n._app?.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new se(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new xn(h)}n._authCredentials=new qb(new Hg(u,d))}}var tr=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Rn=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ho(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Kl(t,n._jsonSchema))return new n(e,i||null,new Me(Mt.fromString(t.referencePath)))}};Rn._jsonSchemaVersion="firestore/documentReference/1.0",Rn._jsonSchema={type:nn("string",Rn._jsonSchemaVersion),referencePath:nn("string")};var ho=class n extends tr{constructor(e,t,i){super(e,t,Ax(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Rn(this.firestore,null,new Me(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function nr(n,e,...t){if(n=wn(n),fP("collection","path",e),n instanceof $l){let i=Mt.fromString(e,...t);return DN(i),new ho(n,null,i)}{if(!(n instanceof Rn||n instanceof ho))throw new se(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Mt.fromString(e,...t));return DN(i),new ho(n.firestore,null,i)}}function Hx(n,e,...t){if(n=wn(n),arguments.length===1&&(e=ga.newId()),fP("doc","path",e),n instanceof $l){let i=Mt.fromString(e,...t);return CN(i),new Rn(n,null,new Me(i))}{if(!(n instanceof Rn||n instanceof ho))throw new se(G.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Mt.fromString(e,...t));return CN(i),new Rn(n.firestore,n instanceof ho?n.converter:null,new Me(i))}}var cP="AsyncQueue",vm=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new um(this,"async_queue_retry"),this._c=()=>{let i=zb();i&&we(cP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;let t=zb();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=zb();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Mr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Yl(e))throw e;we(cP,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,po("INTERNAL UNHANDLED ERROR: ",uP(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=ox.createAndSchedule(this,e,t,i,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&ke(47125,{Pc:uP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function uP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var xa=class extends $l{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new vm,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new vm(e),this._firestoreClient=void 0,await e}}};function Pd(n,e){let t=typeof n=="object"?n:Pg(),i=typeof n=="string"?n:e||Jg,r=sd(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let o=XR("firestore");o&&Lk(r,...o)}return r}function Am(n){if(n._terminated)throw new se(G.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||m$(n),n._firestoreClient}function m$(n){let e=n._freezeSettings(),t=g$(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new mx(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}var kr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Nn.fromBase64String(e))}catch(t){throw new se(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Nn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kl(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};kr._jsonSchemaVersion="firestore/bytes/1.0",kr._jsonSchema={type:nn("string",kr._jsonSchemaVersion),bytes:nn("string")};var Gl=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new se(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ti(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var zl=class{constructor(e){this._methodName=e}};var fo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new se(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new se(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return it(this._lat,e._lat)||it(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Kl(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};fo._jsonSchemaVersion="firestore/geoPoint/1.0",fo._jsonSchema={type:nn("string",fo._jsonSchemaVersion),latitude:nn("number"),longitude:nn("number")};var Or=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kl(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new se(G.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Or._jsonSchemaVersion="firestore/vectorValue/1.0",Or._jsonSchema={type:nn("string",Or._jsonSchemaVersion),vectorValues:nn("object")};var y$=/^__.*__$/,yx=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new bo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ea(e,this.data,t,this.fieldTransforms)}};function Vk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ke(40011,{dataSource:n})}}var vx=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(L(L({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return _m(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Vk(this.dataSource)&&y$.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},_x=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Md(e)}createContext(e,t,i,r=!1){return new vx({dataSource:e,methodName:t,targetDoc:i,path:ti.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Mm(n){let e=n._freezeSettings(),t=Md(n._databaseId);return new _x(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Uk(n,e,t,i,r,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);Hk("Data must be an object, but it was:",s,i);let a=Bk(i,s),l,u;if(o.merge)l=new Ar(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let p=Zl(e,h,t);if(!s.contains(p))throw new se(G.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);_$(d,p)||d.push(p)}l=new Ar(d),u=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=s.fieldTransforms;return new yx(new Pi(a),l,u)}var Ex=class n extends zl{_toFieldTransform(e){return new dw(e.path,new ya)}isEqual(e){return e instanceof n}};function $x(n,e,t,i=!1){return Gx(t,n.createContext(i?4:3,e))}function Gx(n,e){if(jk(n=wn(n)))return Hk("Unsupported field value:",e,n),Bk(n,e);if(n instanceof zl)return(function(i,r){if(!Vk(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){let o=[],s=0;for(let a of i){let l=Gx(a,r.childContextForArray(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=wn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Z9(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=rn.fromDate(i);return{timestampValue:im(r.serializer,o)}}if(i instanceof rn){let o=new rn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:im(r.serializer,o)}}if(i instanceof fo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof kr)return{bytesValue:ak(r.serializer,i._byteString)};if(i instanceof Rn){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Rx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Or)return(function(s,a){let l=s instanceof Or?s.toArray():s;return{mapValue:{fields:{[Sx]:{stringValue:Ix},[Ll]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return Mx(a.serializer,d)})}}}}}})(i,r);if(pk(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Cd(i)}`)})(n,e)}function Bk(n,e){let t={};return RP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sa(n,(i,r)=>{let o=Gx(r,e.childContextForField(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function jk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof rn||n instanceof fo||n instanceof kr||n instanceof Rn||n instanceof zl||n instanceof Or||pk(n))}function Hk(n,e,t){if(!jk(t)||!gP(t)){let i=Cd(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Zl(n,e,t){if((e=wn(e))instanceof Gl)return e._internalPath;if(typeof e=="string")return $k(n,e);throw _m("Field path arguments must be of type string or ",n,!1,void 0,t)}var v$=new RegExp("[~\\*/\\[\\]]");function $k(n,e,t){if(e.search(v$)>=0)throw _m(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gl(...e.split("."))._internalPath}catch{throw _m(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function _m(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new se(G.INVALID_ARGUMENT,a+n+l)}function _$(n,e){return n.some(t=>t.isEqual(e))}var Td=class{convertValue(e,t="none"){switch(cs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ke(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Sa(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){let t=e.fields?.[Ll].arrayValue?.values?.map(i=>Ut(i.doubleValue));return new Or(t)}convertGeoPoint(e){return new fo(Ut(e.latitude),Ut(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=wm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(md(e));default:return null}}convertTimestamp(e){let t=go(e);return new rn(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Mt.fromString(e);Et(fk(i),9688,{name:e});let r=new yd(i.get(1),i.get(3)),o=new Me(i.popFirst(5));return r.isEqual(t)||po(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var Em=class extends Td{constructor(e){super(),this.firestore=e}convertBytes(e){return new kr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Rn(this.firestore,null,t)}};function zx(){return new Ex("serverTimestamp")}var Gk="@firebase/firestore",zk="4.10.0";var kd=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Wx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(Zl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Wx=class extends kd{data(){return super.data()}};function x$(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new se(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Od=class{},ic=class extends Od{};function fs(n,e,...t){let i=[];e instanceof Od&&i.push(e),i=i.concat(t),(function(o){let s=o.filter(l=>l instanceof qx).length,a=o.filter(l=>l instanceof Rm).length;if(s>1||s>0&&a>0)throw new se(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var Rm=class n extends ic{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return Qk(e._query,t),new tr(e.firestore,e.converter,Sm(e._query,t))}_parse(e){let t=Mm(e.firestore);return(function(o,s,a,l,u,d,h){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new se(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){qk(h,d);let w=[];for(let S of h)w.push(Wk(l,o,S));p={arrayValue:{values:w}}}else p=Wk(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||qk(h,d),p=$x(a,s,h,d==="in"||d==="not-in");return tn.create(u,d,p)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function ps(n,e,t){let i=e,r=Zl("where",n);return Rm._create(r,i,t)}var qx=class n extends Od{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:ki.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let s=r,a=o.getFlattenedFilters();for(let l of a)Qk(s,l),s=Sm(s,l)})(e._query,t),new tr(e.firestore,e.converter,Sm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Kx=class n extends ic{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(r,o,s){if(r.startAt!==null)throw new se(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new se(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new us(o,s)})(e._query,this._field,this._direction);return new tr(e.firestore,e.converter,WP(e._query,t))}};function wo(n,e="asc"){let t=e,i=Zl("orderBy",n);return Kx._create(i,t)}var Qx=class n extends ic{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new tr(e.firestore,e.converter,_d(e._query,this._limit,this._limitType))}};function Ta(n){return mP("limit",n),Qx._create("limit",n,"F")}var Yx=class n extends ic{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=S$(e,this.type,this._docOrFields,this._inclusive);return new tr(e.firestore,e.converter,qP(e._query,t))}};function Kk(...n){return Yx._create("startAfter",n,!1)}function S$(n,e,t,i){if(t[0]=wn(t[0]),t[0]instanceof kd)return(function(o,s,a,l,u){if(!l)throw new se(G.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of fa(o))if(h.field.isKeyField())d.push(Ad(s,l.key));else{let p=l.data.field(h.field);if(Dd(p))throw new se(G.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let g=h.field.canonicalString();throw new se(G.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(p)}return new yo(d,u)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Mm(n.firestore);return(function(s,a,l,u,d,h){let p=s.explicitOrderBy;if(d.length>p.length)throw new se(G.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let w=0;w<d.length;w++){let S=d[w];if(p[w].field.isKeyField()){if(typeof S!="string")throw new se(G.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof S}`);if(!xm(s)&&S.indexOf("/")!==-1)throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${S}' contains a slash.`);let P=s.path.child(Mt.fromString(S));if(!Me.isDocumentKey(P))throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);let U=new Me(P);g.push(Ad(a,U))}else{let P=$x(l,u,S);g.push(P)}}return new yo(g,h)})(n._query,n.firestore._databaseId,r,e,t,i)}}function Wk(n,e,t){if(typeof(t=wn(t))=="string"){if(t==="")throw new se(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!xm(e)&&t.indexOf("/")!==-1)throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Mt.fromString(t));if(!Me.isDocumentKey(i))throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ad(n,new Me(i))}if(t instanceof Rn)return Ad(n,t._key);throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Cd(t)}.`)}function qk(n,e){if(!Array.isArray(n)||n.length===0)throw new se(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Qk(n,e){let t=(function(r,o){for(let s of r)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new se(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function I$(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var Xl=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ec=class n extends kd{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new tc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(Zl("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new se(G.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};ec._jsonSchemaVersion="firestore/documentSnapshot/1.0",ec._jsonSchema={type:nn("string",ec._jsonSchemaVersion),bundleSource:nn("string","DocumentSnapshot"),bundleName:nn("string"),bundle:nn("string")};var tc=class extends ec{data(e={}){return super.data(e)}},nc=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Xl(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new tc(this._firestore,this._userDataWriter,i.key,i,new Xl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new se(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{let l=new tc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Xl(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new tc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Xl(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),u=-1,d=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:T$(a.type),doc:l,oldIndex:u,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new se(G.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ga.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function T$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke(61501,{type:n})}}nc._jsonSchemaVersion="firestore/querySnapshot/1.0",nc._jsonSchema={type:nn("string",nc._jsonSchemaVersion),bundleSource:nn("string","QuerySnapshot"),bundleName:nn("string"),bundle:nn("string")};function Ca(n){n=ql(n,tr);let e=ql(n.firestore,xa),t=Am(e),i=new Em(e);return x$(n._query),Pk(t,n._query).then(r=>new nc(e,i,n,r))}function Nm(n,e){let t=ql(n.firestore,xa),i=Hx(n),r=I$(n.converter,e),o=Mm(n.firestore);return C$(t,[Uk(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,as.exists(!1))]).then(()=>i)}function C$(n,e){let t=Am(n);return kk(t,e)}(function(e,t=!0){dP(ss),os(new Ri("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),a=new xa(new Gg(i.getProvider("auth-internal")),new Wg(s,i.getProvider("app-check-internal")),FP(s,r),s);return o=L({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Xi(Gk,zk,e),Xi(Gk,zk,"esm2020")})();function u2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var d2=u2,h2=new ao("auth","Firebase",u2());var Vm=new is("@firebase/auth");function D$(n,...e){Vm.logLevel<=Xe.WARN&&Vm.warn(`Auth (${ss}): ${n}`,...e)}function km(n,...e){Vm.logLevel<=Xe.ERROR&&Vm.error(`Auth (${ss}): ${n}`,...e)}function Vr(n,...e){throw pS(n,...e)}function ir(n,...e){return pS(n,...e)}function fS(n,e,t){let i=me(L({},d2()),{[e]:t});return new ao("auth","Firebase",i).create(e,{appName:n.name})}function Da(n){return fS(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function A$(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Vr(n,"argument-error"),fS(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pS(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return h2.create(n,...e)}function Ue(n,e,...t){if(!n)throw pS(e,...t)}function xo(n){let e="INTERNAL ASSERTION FAILED: "+n;throw km(e),new Error(e)}function Io(n,e){n||xo(e)}function Xx(){return typeof self<"u"&&self.location?.href||""}function M$(){return Yk()==="http:"||Yk()==="https:"}function Yk(){return typeof self<"u"&&self.location?.protocol||null}function R$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(M$()||iN()||"connection"in navigator)?navigator.onLine:!0}function N$(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Aa=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Io(t>e,"Short delay should be less than long delay!"),this.isMobile=tN()||rN()}get(){return R$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function gS(n,e){Io(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Um=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var P$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var k$=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],O$=new Aa(3e4,6e4);function mS(n,e){return n.tenantId&&!e.tenantId?me(L({},e),{tenantId:n.tenantId}):e}async function oc(n,e,t,i,r={}){return f2(n,r,async()=>{let o={},s={};i&&(e==="GET"?s=i:o={body:JSON.stringify(i)});let a=Dl(L({key:n.config.apiKey},s)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let u=L({method:e,headers:l},o);return nN()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&ns(n.emulatorConfig.host)&&(u.credentials="include"),Um.fetch()(await p2(n,n.config.apiHost,t,a),u)})}async function f2(n,e,t){n._canInitEmulator=!1;let i=L(L({},P$),e);try{let r=new eS(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw Pm(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pm(n,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw Pm(n,"email-already-in-use",s);if(l==="USER_DISABLED")throw Pm(n,"user-disabled",s);let d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw fS(n,d,u);Vr(n,d)}}catch(r){if(r instanceof vi)throw r;Vr(n,"network-request-failed",{message:String(r)})}}async function F$(n,e,t,i,r={}){let o=await oc(n,e,t,i,r);return"mfaPendingCredential"in o&&Vr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function p2(n,e,t,i){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?gS(n.config,r):`${n.config.apiScheme}://${r}`;return k$.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var eS=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ir(this.auth,"network-request-failed")),O$.get())})}};function Pm(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=ir(n,e,i);return r.customData._tokenResponse=t,r}async function L$(n,e){return oc(n,"POST","/v1/accounts:delete",e)}async function Bm(n,e){return oc(n,"POST","/v1/accounts:lookup",e)}function Fd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function g2(n,e=!1){let t=wn(n),i=await t.getIdToken(e),r=yS(i);Ue(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:Fd(Jx(r.auth_time)),issuedAtTime:Fd(Jx(r.iat)),expirationTime:Fd(Jx(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Jx(n){return Number(n)*1e3}function yS(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return km("JWT malformed, contained fewer than 3 sections"),null;try{let r=Tg(t);return r?JSON.parse(r):(km("Failed to decode base64 JWT payload"),null)}catch(r){return km("Caught error parsing JWT payload as JSON",r?.toString()),null}}function Jk(n){let e=yS(n);return Ue(e,"internal-error"),Ue(typeof e.exp<"u","internal-error"),Ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof vi&&V$(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function V$({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var tS=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Ud=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fd(this.lastLoginAt),this.creationTime=Fd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function jm(n){let e=n.auth,t=await n.getIdToken(),i=await Vd(n,Bm(e,{idToken:t}));Ue(i?.users.length,e,"internal-error");let r=i.users[0];n._notifyReloadListener(r);let o=r.providerUserInfo?.length?y2(r.providerUserInfo):[],s=U$(n.providerData,o),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!s?.length,u=a?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Ud(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function m2(n){let e=wn(n);await jm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function U$(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function y2(n){return n.map(i=>{var r=i,{providerId:e}=r,t=Oa(r,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function B$(n,e){let t=await f2(n,{},async()=>{let i=Dl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=await p2(n,r,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return n.emulatorConfig&&ns(n.emulatorConfig.host)&&(l.credentials="include"),Um.fetch()(s,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function j$(n,e){return oc(n,"POST","/v2/accounts:revokeToken",mS(n,e))}var Ld=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ue(e.idToken,"internal-error"),Ue(typeof e.idToken<"u","internal-error"),Ue(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ue(e.length!==0,"internal-error");let t=Jk(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:r,expiresIn:o}=await B$(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n;return i&&(Ue(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(Ue(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(Ue(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return xo("not implemented")}};function gs(n,e){Ue(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ms=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:i}=s,r=Oa(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Ud(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await Vd(this,this.stsTokenManager.getToken(this.auth,e));return Ue(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return g2(this,e)}reload(){return m2(this)}_assign(e){this!==e&&(Ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>L({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(me(L({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await jm(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_i(this.auth.app))return Promise.reject(Da(this.auth));let e=await this.getIdToken();return await Vd(this,L$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return me(L({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>L({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:h,emailVerified:p,isAnonymous:g,providerData:w,stsTokenManager:S}=t;Ue(h&&S,e,"internal-error");let P=Ld.fromJSON(this.name,S);Ue(typeof h=="string",e,"internal-error"),gs(i,e.name),gs(r,e.name),Ue(typeof p=="boolean",e,"internal-error"),Ue(typeof g=="boolean",e,"internal-error"),gs(o,e.name),gs(s,e.name),gs(a,e.name),gs(l,e.name),gs(u,e.name),gs(d,e.name);let U=new n({uid:h,auth:e,email:r,emailVerified:p,displayName:i,isAnonymous:g,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:P,createdAt:u,lastLoginAt:d});return w&&Array.isArray(w)&&(U.providerData=w.map(ie=>L({},ie))),l&&(U._redirectEventId=l),U}static async _fromIdTokenResponse(e,t,i=!1){let r=new Ld;r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await jm(o),o}static async _fromGetAccountInfoResponse(e,t,i){let r=t.users[0];Ue(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?y2(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,a=new Ld;a.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Ud(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(l,u),l}};var Zk=new Map;function So(n){Io(n instanceof Function,"Expected a class definition");let e=Zk.get(n);return e?(Io(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Zk.set(n,e),e)}var H$=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,i){this.storage[t]=i}async _get(t){let i=this.storage[t];return i===void 0?null:i}async _remove(t){delete this.storage[t]}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),nS=H$;function Om(n,e,t){return`firebase:${n}:${e}:${t}`}var Hm=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=Om(this.userKey,r.apiKey,o),this.fullPersistenceKey=Om("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Bm(this.auth,{idToken:e}).catch(()=>{});return t?ms._fromGetAccountInfoResponse(this.auth,t,e):null}return ms._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new n(So(nS),e,i);let r=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u),o=r[0]||So(nS),s=Om(i,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=await u._get(s);if(d){let h;if(typeof d=="string"){let p=await Bm(e,{idToken:d}).catch(()=>{});if(!p)break;h=await ms._fromGetAccountInfoResponse(e,p,d)}else h=ms._fromJSON(e,d);u!==o&&(a=h),o=u;break}}catch{}let l=r.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,i):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new n(o,e,i))}};function Xk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(b2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(v2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(x2(e))return"Blackberry";if(S2(e))return"Webos";if(_2(e))return"Safari";if((e.includes("chrome/")||E2(e))&&!e.includes("edge/"))return"Chrome";if(w2(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function v2(n=bn()){return/firefox\//i.test(n)}function _2(n=bn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function E2(n=bn()){return/crios\//i.test(n)}function b2(n=bn()){return/iemobile/i.test(n)}function w2(n=bn()){return/android/i.test(n)}function x2(n=bn()){return/blackberry/i.test(n)}function S2(n=bn()){return/webos/i.test(n)}function vS(n=bn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function $$(n=bn()){return vS(n)&&!!window.navigator?.standalone}function G$(){return oN()&&document.documentMode===10}function I2(n=bn()){return vS(n)||w2(n)||S2(n)||x2(n)||/windows phone/i.test(n)||b2(n)}function T2(n,e=[]){let t;switch(n){case"Browser":t=Xk(bn());break;case"Worker":t=`${Xk(bn())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ss}/${i}`}var iS=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=o=>new Promise((s,a)=>{try{let l=e(o);s(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}};async function z$(n,e={}){return oc(n,"GET","/v2/passwordPolicy",mS(n,e))}var W$=6,rS=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??W$,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var oS=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $m(this),this.idTokenSubscription=new $m(this),this.beforeStateQueue=new iS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=h2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=So(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Hm.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Bm(this,{idToken:e}),i=await ms._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(_i(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await jm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=N$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_i(this.app))return Promise.reject(Da(this));let t=e?wn(e):null;return t&&Ue(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _i(this.app)?Promise.reject(Da(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _i(this.app)?Promise.reject(Da(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(So(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await z$(this),t=new rS(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ao("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await j$(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&So(e)||this._popupRedirectResolver;Ue(t,this,"argument-error"),this.redirectPersistenceManager=await Hm.create(this,[So(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ue(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{s=!0,l()}}else{let l=e.addObserver(t);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=T2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(_i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&D$(`Error while retrieving App Check token: ${e.error}`),e?.token}};function Jm(n){return wn(n)}var $m=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=cN(t=>this.observer=t)}get next(){return Ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var _S={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function q$(n){_S=n}function K$(n){return _S.loadJS(n)}function Q$(){return _S.gapiScript}function C2(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function D2(n,e){let t=sd(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(Zi(o,e??{}))return r;Vr(r,"already-initialized")}return t.initialize({options:e})}function Y$(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(So);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function A2(n,e,t){let i=Jm(n);Ue(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=M2(e),{host:s,port:a}=J$(e),l=a===null?"":`:${a}`,u={url:`${o}//${s}${l}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Ue(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ue(Zi(u,i.config.emulator)&&Zi(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=u,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,ns(s)?(Dg(`${o}//${s}${l}`),Ag("Auth",!0)):r||Z$()}function M2(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function J$(n){let e=M2(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:e2(i.substr(o.length+1))}}else{let[o,s]=i.split(":");return{host:o,port:e2(s)}}}function e2(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Z$(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Bd=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return xo("not implemented")}_getIdTokenResponse(e){return xo("not implemented")}_linkToIdToken(e,t){return xo("not implemented")}_getReauthenticationResolver(e){return xo("not implemented")}};async function rc(n,e){return F$(n,"POST","/v1/accounts:signInWithIdp",mS(n,e))}var X$="http://localhost",Gm=class n extends Bd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Vr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=a,o=Oa(a,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return rc(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,rc(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,rc(e,t)}buildRequest(){let e={requestUri:X$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Dl(t)}return e}};var jd=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var zm=class extends jd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var ES=(()=>{class n extends zm{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return Gm._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var Hd=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){let o=await ms._fromIdTokenResponse(e,i,r),s=t2(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);let r=t2(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})}};function t2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var sS=class n extends vi{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function R2(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?sS._fromErrorAndOperation(n,o,e,i):o})}async function e7(n,e,t=!1){let i=await Vd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Hd._forOperation(n,"link",i)}async function t7(n,e,t=!1){let{auth:i}=n;if(_i(i.app))return Promise.reject(Da(i));let r="reauthenticate";try{let o=await Vd(n,R2(i,r,e,n),t);Ue(o.idToken,i,"internal-error");let s=yS(o.idToken);Ue(s,i,"internal-error");let{sub:a}=s;return Ue(n.uid===a,i,"user-mismatch"),Hd._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&Vr(i,"user-mismatch"),o}}async function n7(n,e,t=!1){if(_i(n.app))return Promise.reject(Da(n));let i="signIn",r=await R2(n,i,e),o=await Hd._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}function N2(n,e,t,i){return wn(n).onIdTokenChanged(e,t,i)}function P2(n,e,t){return wn(n).beforeAuthStateChanged(e,t)}function bS(n,e,t,i){return wn(n).onAuthStateChanged(e,t,i)}function wS(n){return wn(n).signOut()}var Wm="__sak";var qm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Wm,"1"),this.storage.removeItem(Wm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var i7=1e3,r7=10,o7=(()=>{class n extends qm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=I2(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);G$()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,r7):o()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},i7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,i){await super._set(t,i),this.localCache[t]=JSON.stringify(i)}async _get(t){let i=await super._get(t);return this.localCache[t]=JSON.stringify(i),i}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),k2=o7;var s7=(()=>{class n extends qm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),xS=s7;function a7(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var l7=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let i=t,{eventId:r,eventType:o,data:s}=i.data,a=this.handlersMap[o];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let l=Array.from(a).map(async d=>d(i.origin,s)),u=await a7(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:u})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function SS(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var aS=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{let u=SS("",20);r.port1.start();let d=setTimeout(()=>{l(new Error("unsupported_event"))},i);s={messageChannel:r,onMessage(h){let p=h;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(p.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function Lr(){return window}function c7(n){Lr().location.href=n}function O2(){return typeof Lr().WorkerGlobalScope<"u"&&typeof Lr().importScripts=="function"}async function u7(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function d7(){return navigator?.serviceWorker?.controller||null}function h7(){return O2()?self:null}var F2="firebaseLocalStorageDb",f7=1,Km="firebaseLocalStorage",L2="fbase_key",Ma=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Zm(n,e){return n.transaction([Km],e?"readwrite":"readonly").objectStore(Km)}function p7(){let n=indexedDB.deleteDatabase(F2);return new Ma(n).toPromise()}function lS(){let n=indexedDB.open(F2,f7);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(Km,{keyPath:L2})}catch(r){t(r)}}),n.addEventListener("success",async()=>{let i=n.result;i.objectStoreNames.contains(Km)?e(i):(i.close(),await p7(),e(await lS()))})})}async function n2(n,e,t){let i=Zm(n,!0).put({[L2]:e,value:t});return new Ma(i).toPromise()}async function g7(n,e){let t=Zm(n,!1).get(e),i=await new Ma(t).toPromise();return i===void 0?null:i.value}function i2(n,e){let t=Zm(n,!0).delete(e);return new Ma(t).toPromise()}var m7=800,y7=3,v7=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lS(),this.db)}async _withRetries(t){let i=0;for(;;)try{let r=await this._openDb();return await t(r)}catch(r){if(i++>y7)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return O2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=l7._getInstance(h7()),this.receiver._subscribe("keyChanged",async(t,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(t,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await u7(),!this.activeServiceWorker)return;this.sender=new aS(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||d7()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await lS();return await n2(t,Wm,"1"),await i2(t,Wm),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,i){return this._withPendingWrite(async()=>(await this._withRetries(r=>n2(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)))}async _get(t){let i=await this._withRetries(r=>g7(r,t));return this.localCache[t]=i,i}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(i=>i2(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=Zm(o,!1).getAll();return new Ma(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),m7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),V2=v7;var jde=C2("rcb"),Hde=new Aa(3e4,6e4);function U2(n,e){return e?So(e):(Ue(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var $d=class extends Bd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function _7(n){return n7(n.auth,new $d(n),n.bypassAuthState)}function E7(n){let{auth:e,user:t}=n;return Ue(t,e,"internal-error"),t7(t,new $d(n),n.bypassAuthState)}async function b7(n){let{auth:e,user:t}=n;return Ue(t,e,"internal-error"),e7(t,new $d(n),n.bypassAuthState)}var Qm=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _7;case"linkViaPopup":case"linkViaRedirect":return b7;case"reauthViaPopup":case"reauthViaRedirect":return E7;default:Vr(this.auth,"internal-error")}}resolve(e){Io(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Io(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var w7=new Aa(2e3,1e4);async function IS(n,e,t){if(_i(n.app))return Promise.reject(ir(n,"operation-not-supported-in-this-environment"));let i=Jm(n);A$(n,e,jd);let r=U2(i,t);return new x7(i,"signInViaPopup",e,r).executeNotNull()}var x7=(()=>{class n extends Qm{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return Ue(t,this.auth,"internal-error"),t}async onExecution(){Io(this.filter.length===1,"Popup operations only handle one event");let t=SS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(ir(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ir(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ir(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,w7.get())};t()}}n.currentPopupAction=null;return n})(),S7="pendingRedirect",Fm=new Map,cS=class extends Qm{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Fm.get(this.auth._key());if(!e){try{let i=await I7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Fm.set(this.auth._key(),e)}return this.bypassAuthState||Fm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function I7(n,e){let t=D7(e),i=C7(n);if(!await i._isAvailable())return!1;let r=await i._get(t)==="true";return await i._remove(t),r}function T7(n,e){Fm.set(n._key(),e)}function C7(n){return So(n._redirectPersistence)}function D7(n){return Om(S7,n.config.apiKey,n.name)}async function A7(n,e,t=!1){if(_i(n.app))return Promise.reject(Da(n));let i=Jm(n),r=U2(i,e),s=await new cS(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}var M7=600*1e3,uS=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!R7(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!B2(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ir(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=M7&&this.cachedEventUids.clear(),this.cachedEventUids.has(r2(e))}saveEventToCache(e){this.cachedEventUids.add(r2(e)),this.lastProcessedEventTime=Date.now()}};function r2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function B2({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function R7(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return B2(n);default:return!1}}async function N7(n,e={}){return oc(n,"GET","/v1/projects",e)}var P7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,k7=/^https?/;async function O7(n){if(n.config.emulator)return;let{authorizedDomains:e}=await N7(n);for(let t of e)try{if(F7(t))return}catch{}Vr(n,"unauthorized-domain")}function F7(n){let e=Xx(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i}if(!k7.test(t))return!1;if(P7.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var L7=new Aa(3e4,6e4);function o2(){let n=Lr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function V7(n){return new Promise((e,t)=>{function i(){o2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{o2(),t(ir(n,"network-request-failed"))},timeout:L7.get()})}if(Lr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Lr().gapi?.load)i();else{let r=C2("iframefcb");return Lr()[r]=()=>{gapi.load?i():t(ir(n,"network-request-failed"))},K$(`${Q$()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw Lm=null,e})}var Lm=null;function U7(n){return Lm=Lm||V7(n),Lm}var B7=new Aa(5e3,15e3),j7="__/auth/iframe",H7="emulator/auth/iframe",$7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},G7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function z7(n){let e=n.config;Ue(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?gS(e,H7):`https://${n.config.authDomain}/${j7}`,i={apiKey:e.apiKey,appName:n.name,v:ss},r=G7.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Dl(i).slice(1)}`}async function W7(n){let e=await U7(n),t=Lr().gapi;return Ue(t,n,"internal-error"),e.open({where:document.body,url:z7(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$7,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});let s=ir(n,"network-request-failed"),a=Lr().setTimeout(()=>{o(s)},B7.get());function l(){Lr().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{o(s)})}))}var q7={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},K7=500,Q7=600,Y7="_blank",J7="http://localhost",Ym=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Z7(n,e,t,i=K7,r=Q7){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=me(L({},q7),{width:i.toString(),height:r.toString(),top:o,left:s}),u=bn().toLowerCase();t&&(a=E2(u)?Y7:t),v2(u)&&(e=e||J7,l.scrollbars="yes");let d=Object.entries(l).reduce((p,[g,w])=>`${p}${g}=${w},`,"");if($$(u)&&a!=="_self")return X7(e||"",a),new Ym(null);let h=window.open(e||"",a,d);Ue(h,n,"popup-blocked");try{h.focus()}catch{}return new Ym(h)}function X7(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var eG="__/auth/handler",tG="emulator/auth/handler",nG=encodeURIComponent("fac");async function s2(n,e,t,i,r,o){Ue(n.config.authDomain,n,"auth-domain-config-required"),Ue(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ss,eventId:r};if(e instanceof jd){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",lN(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(o||{}))s[d]=h}if(e instanceof zm){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let l=await n._getAppCheckToken(),u=l?`#${nG}=${encodeURIComponent(l)}`:"";return`${iG(n)}?${Dl(a).slice(1)}${u}`}function iG({config:n}){return n.emulator?gS(n,tG):`https://${n.authDomain}/${eG}`}var Zx="webStorageSupport",dS=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xS,this._completeRedirectFn=A7,this._overrideRedirectResult=T7}async _openPopup(e,t,i,r){Io(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await s2(e,t,i,Xx(),r);return Z7(e,o,SS())}async _openRedirect(e,t,i,r){await this._originValidation(e);let o=await s2(e,t,i,Xx(),r);return c7(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Io(o,"If manager is not set, promise should be"),o)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await W7(e),i=new uS(e);return t.register("authEvent",r=>(Ue(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zx,{type:Zx},r=>{let o=r?.[0]?.[Zx];o!==void 0&&t(!!o),Vr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=O7(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return I2()||_2()||vS()}},j2=dS;var a2="@firebase/auth",l2="1.12.0";var hS=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function rG(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oG(n){os(new Ri("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=i.options;Ue(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:T2(n)},u=new oS(i,r,o,l);return Y$(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),os(new Ri("auth-internal",e=>{let t=Jm(e.getProvider("auth").getImmediate());return(i=>new hS(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xi(a2,l2,rG(n)),Xi(a2,l2,"esm2020")}var sG=300,aG=Eb("authIdTokenMaxAge")||sG,c2=null,lG=n=>async e=>{let t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>aG)return;let r=t?.token;c2!==r&&(c2=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Gd(n=Pg()){let e=sd(n,"auth");if(e.isInitialized())return e.getImmediate();let t=D2(n,{popupRedirectResolver:j2,persistence:[V2,k2,xS]}),i=Eb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=lG(o.toString());P2(t,s,()=>s(t.currentUser)),N2(t,a=>s(a))}}let r=vb("auth");return r&&A2(t,`http://${r}`),t}function cG(){return document.getElementsByTagName("head")?.[0]??document}q$({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=ir("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",cG().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oG("Browser");var Xm={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var Ur=class n{constructor(e){this.platformId=e;let t=ad(Xm);try{this.db=Pd(t)}catch(i){console.warn("Firestore init failed (likely SSR)",i)}if(Zo(this.platformId))try{this.auth=Gd(t),bS(this.auth,i=>{this.user$.set(i)})}catch(i){console.warn("Auth init failed",i)}}db=null;auth=null;user$=z(null);async loginWithGoogle(){if(!(!this.auth||!Zo(this.platformId)))try{let e=new ES;await IS(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await wS(this.auth)}async saveHighScore(e){if(this.db)try{await Nm(nr(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,i){if(!this.db)return[];try{let r=fs(nr(this.db,"highscores"),ps("difficulty","==",t),ps("mapSize","==",i),wo("victory","desc"),wo("turnsPlayed","asc"),Ta(e));return(await Ca(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching scores: ",r),[]}}async getUserScores(e){if(!this.db)return[];try{let t=fs(nr(this.db,"highscores"),ps("userId","==",e),ps("victory","==",!0),wo("turnsPlayed","asc"));return(await Ca(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}static \u0275fac=function(t){return new(t||n)(Re(Wi))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var sc=class n{platformId=$(Wi);nameSignal=z("Player");constructor(){if(Zo(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),Zo(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let i=(e??"").toString().trim().slice(0,24);return i.length>0?i:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var ni=class n{constructor(e,t,i,r,o,s,a,l,u){this.combat=e;this.build=t;this.log=i;this.settings=r;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=l;this.playerName=u;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}breakpointObserver=$(pb);screenState=BR(this.breakpointObserver.observe("(max-width: 1024px)").pipe(yt(e=>e.matches)),{initialValue:!1});unitsSignal=z([]);turnSignal=z(1);selectedUnitIdSignal=z(null);gameStatusSignal=z("playing");lastMergedUnitIdSignal=z(null);lastRemainderUnitIdSignal=z(null);resourcesSignal=z({wood:0,iron:0});forestsSignal=z([]);minesSignal=z([]);forgeSitesSignal=z([]);forgesSignal=z([]);aiForgesSignal=z([]);baseHealthSignal=z({player:100,ai:100});reservePointsSignal=z({player:0,ai:0});deployTargetsSignal=z([]);baseDeployActiveSignal=z(!1);wallsSignal=z([]);playerVisibilitySignal=z(new Set);aiVisibilitySignal=z(new Set);playerExploredSignal=z(new Set);aiExploredSignal=z(new Set);unitMoveHistorySignal=z(new Map);unitStutterBanSignal=z(new Map);lastAiMovedUnitIdSignal=z(null);aiConsecMovesSignal=z(0);buildModeSignal=z(!1);fogDebugDisabledSignal=z(!1);wallBuiltThisTurnSignal=z(!1);rulesOpenSignal=z(!1);movedThisTurnSignal=z(new Set);hoveredFormationIdSignal=z(null);aiWoodSignal=z(0);aiIronSignal=z(0);logsOpenSignal=z(!1);settingsOpenSignal=z(!1);activeSideSignal=z("ai");lastArrivedUnitIdSignal=z(null);attackerNudgeSignal=z(null);shakenUnitIdSignal=z(null);shakenWallIdSignal=z(null);pulseUnitIdSignal=z(null);screenShakeSignal=z(!1);endOverlaySignal=z(!1);endReasonSignal=z(null);combatOnlySignal=z(!0);forestMonopolySignal=z({player:0,ai:0});hoveredUnitIdSignal=z(null);autoDeployEnabledSignal=z(!1);highScoresOpenSignal=z(!1);leaderboardOpenSignal=z(!1);namePromptOpenSignal=z(!1);pendingScoreSignal=z(null);supportOpenSignal=z(!1);highScoresSignal=z({});playerConvertedThisTurnSignal=z(!1);unitQuadrantBiasSignal=z(new Map);aiUnitTimeNearBaseSignal=z(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=z(!1);wallCooldownSignal=z(new Map);aiQueuedUnitIdSignal=z(null);aiMoodSignal=z("none");rageCaptureCounterSignal=z(0);anchoredGatherersSignal=z(new Set);totalWarModeSignal=z(!1);aiInvalidActionCountSignal=z(0);aiLastRejectedActionKeySignal=z(null);sandboxSpawnPendingSignal=z(null);unitMoveOffsetSignal=z(new Map);movingUnitsSignal=z(new Set);attackingUnitsSignal=z(new Set);reclamationGoalsSignal=z(new Map);mergeIntentSignal=z(new Map);ignoreForgeUntilTurnSignal=z(new Map);playerClaimedTargetsSignal=z(new Set);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();mines=this.minesSignal.asReadonly();forges=this.forgesSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();isMobile=Xn(()=>this.screenState());sandboxSpawnPending(){return this.sandboxSpawnPendingSignal()}getMoveOffsetFor(e){return this.unitMoveOffsetSignal().get(e)??null}isUnitMoving(e){return this.movingUnitsSignal().has(e)}isUnitAttacking(e){return this.attackingUnitsSignal().has(e)}getCombinedTransform(e){let t=this.attackerNudgeSignal(),i=this.getMoveOffsetFor(e),r=(t&&t.id===e?t.dx:0)+(i?i.dx:0),o=(t&&t.id===e?t.dy:0)+(i?i.dy:0);return`translate(${r}px, ${o}px)`}aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=Xn(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=Xn(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?this.isMobile()?4:6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?12:16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(r=>r.owner==="player"&&this.isForest(r.position.x,r.position.y)).length,i=this.unitsSignal().filter(r=>r.owner==="ai"&&this.isForest(r.position.x,r.position.y)).length;return{total:e,player:t,ai:i}}resetGame(){let e=this.settings.difficulty();this.stopAiLoops(),this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0,iron:0}),this.baseHealthSignal.set(this.settings.customMode()?{player:1e3,ai:1e3}:{player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:5,ai:5}):e==="normal"?this.reservePointsSignal.set({player:1,ai:1}):e==="hard"?this.reservePointsSignal.set({player:1,ai:3}):this.reservePointsSignal.set({player:1,ai:5}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"))),this.minesSignal.set(this.map.generateMines(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"),this.forestsSignal())),this.forgeSitesSignal.set([]),this.forgesSignal.set([]),this.aiForgesSignal.set([]);let t=new Set(this.forestsSignal().map(i=>`${i.x},${i.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(i=>i.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(r=>r.x===e.x&&r.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let i=!1,r=!1,o=null;this.unitsSignal.update(p=>{let g=[...p],w=g.findIndex(I=>I.id===e.id);if(w===-1)return p;let S=L({},g[w]),P={x:S.position.x,y:S.position.y},U=t.x-P.x,ie=t.y-P.y,Se=Math.sign(U),xe=Math.sign(ie),De=this.combat.checkWallAlongPath(P,t,S.owner,(I,N,D,b)=>this.getWallBetween(I,N,D,b));if(De.hitOwn)return g;if(De.hitEnemy){let I=De.lastFrom,N=this.getWallBetween(I.x,I.y,t.x,t.y);{let b=N.maxHealth??100,R=this.combat.getWallHitAmount(S.tier),M=Math.max(0,N.health-R);this.wallsSignal.update(Oe=>Oe.map(ce=>ce.id===N.id?me(L({},ce),{health:M}):ce).filter(ce=>(ce.health??ce.hitsRemaining??0)>0)),M<=0&&this.registerWallDestroyedEdge(I,t);let pe=N.owner==="neutral"?"Neutral":N.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${S.tier} Unit attacked ${pe} Wall. Damage: ${R}. Wall HP: ${M}/${b}.`)}this.updateWallFormations(),this.shakenWallIdSignal.set(N.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let D=g.findIndex(b=>b.id===S.id);return D!==-1&&(g[D]=me(L({},g[D]),{hasActed:!0})),g}let Ie=this.getBasePosition(S.owner==="player"?"ai":"player");if(t.x===Ie.x&&t.y===Ie.y)return this.baseHealthSignal.update(I=>{let N=S.owner==="player"?"ai":"player",D=L({},I);return D[N]=Math.max(0,D[N]-this.calculatePower(S)),D}),g.splice(w,1),g;let k=g.findIndex(I=>I.position.x===t.x&&I.position.y===t.y&&I.id!==S.id);if(k!==-1){let I=g[k],N={x:t.x-Se,y:t.y-xe};if(this.inBounds(N.x,N.y)){if(Se!==0&&xe!==0){if(this.combat.isDiagonalBlocked(N,t,(D,b,R,M)=>this.getWallBetween(D,b,R,M)))return i=!1,g}else if(this.getWallBetween(N.x,N.y,t.x,t.y))return i=!1,g}if(I.owner===S.owner)if(this.shakenUnitIdSignal.set(S.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),I.tier===S.tier){let D=I.tier,b=this.calculateTotalPoints(S)+this.calculateTotalPoints(I),R={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},M=R[D][3];if(b<=M){I.points=b;let Oe=this.calculateTierAndLevel(I.points);I.tier=Oe.tier,I.level=Oe.level;let ce=!!(I.hasWeapon||S.hasWeapon),Lt=!!(I.hasArmor||S.hasArmor),Yt=Lt?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=ce,I.hasArmor=Lt,I.armorHp=Yt,g.splice(w,1)}else{let Oe=Math.min(4,D+1),ce=R[Oe][0];I.points=ce;let Lt=this.calculateTierAndLevel(I.points);I.tier=Lt.tier,I.level=Lt.level;let Yt=!!(I.hasWeapon||S.hasWeapon),Ae=!!(I.hasArmor||S.hasArmor),jt=Ae?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=Yt,I.hasArmor=Ae,I.armorHp=jt;let st=b-ce;if(st>0){S.points=st;let te=this.calculateTierAndLevel(S.points);S.tier=te.tier,S.level=te.level,S.hasWeapon=!1,S.hasArmor=!1,S.armorHp=0,g[w]=S,o=S.id}else g.splice(w,1)}r=!0;let pe=new Map(this.mergeIntentSignal());pe.delete(S.id),pe.delete(I.id),this.mergeIntentSignal.set(pe)}else return g;else{{let te=t.x-P.x,ne=t.y-P.y,_e=Math.abs(te)>=Math.abs(ne),ye=Math.sign(_e?te:ne),ge=this.wallThicknessPx+2,y=this.tileSizePx+ge,oe=Math.round(y*.35),ze=_e?ye*oe:0,We=_e?0:ye*oe,re=new Set(this.attackingUnitsSignal());re.add(S.id),this.attackingUnitsSignal.set(re),this.attackerNudgeSignal.set({id:S.id,dx:ze,dy:We}),setTimeout(()=>{this.attackerNudgeSignal.set({id:S.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let bt=new Set(this.attackingUnitsSignal());bt.delete(S.id),this.attackingUnitsSignal.set(bt)},200)}this.shakenUnitIdSignal.set(I.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let D=this.combat.calculateHitChance(S,I);if(Math.floor(Math.random()*100)+1>D)return this.queueCombatText("DEFLECTED!",t),this.log.addCombat(S.owner,`[Combat] DEFLECTED! T${S.tier} failed to penetrate T${I.tier}. Attacker destroyed.`,!1),g.splice(w,1),g;this.log.addCombat(S.owner,`[Combat] HIT! T${S.tier} breached T${I.tier} armor.`,!1);let R=this.calculateTotalPoints(S)+(S.hasWeapon?20:0),M=this.getAttackLuckModifier(S),pe=this.calculateTotalPoints(I),Oe=this.combat.getDefenseBonus(I,g),ce=Math.max(0,R+M.delta),Lt=pe+Oe.bonus,Yt=S.hasWeapon?"Weapon +20":"",Ae=[...Oe.tags,M.tag??"",Yt].filter(Boolean).join(", ")||"None",jt=ce-Lt,st=`[Turn ${this.turnSignal()}] ${S.owner==="player"?"Player":"AI"} T${S.tier}(L${S.level}) attacked ${I.owner==="player"?"Player":"AI"} T${I.tier}(L${I.level}). Power: ${R} vs ${pe}. Modifiers: ${Ae}. Final: (${R}${M.delta!==0?M.delta>0?`+${M.delta}`:`${M.delta}`:""}${Oe.bonus>0?` - ${Oe.bonus}`:""}) - ${pe} = ${jt}.`;if(this.log.addCombat(S.owner,st,!!M.isCrit),ce<Lt&&this.queueCombatText("WEAK!",t),ce>Lt){let te=this.combat.calculateHitChance(I,S),_e=Math.floor(Math.random()*100)+1<=te,ye=_e?pe:0;if(ye>0){let ge=this.combat.applyDamage(S,ye);S.points=ge.points,S.tier=ge.tier,S.level=ge.level,S.armorHp=ge.armorHp}_e||this.log.addCombat(S.owner,`[Combat] T${S.tier} armor deflected the counter-attack from T${I.tier}. Final HP: ${S.points}`,!1),g.splice(k,1),M.tag&&this.queueCombatText(M.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(ce<Lt){let te=ce,ne=this.combat.applyDamage(I,te),_e=L({},ne);return g[k]=_e,g.splice(w,1),g}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),g.filter(ne=>ne.id!==S.id&&ne.id!==I.id);{let ne=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),ne){let _e=this.getPointsForTierLevel(S.tier,1);S.points=_e;let ye=this.calculateTierAndLevel(_e);S.tier=ye.tier,S.level=ye.level,g.splice(k,1),this.pulseUnitIdSignal.set(S.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let _e=this.getPointsForTierLevel(I.tier,1),ye=me(L({},I),{points:_e}),ge=this.calculateTierAndLevel(_e);return ye.tier=ge.tier,ye.level=ge.level,g[k]=ye,g.splice(w,1),this.pulseUnitIdSignal.set(ye.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),g}}}}}if(g.find(I=>I.id===S.id)&&o!==S.id){S.position=t,S.turnsStationary=0,S.hasActed=!0;let I=g.findIndex(Oe=>Oe.id===S.id);I!==-1&&(g[I]=S),S.owner==="ai"&&S.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(S.id,{x:t.x,y:t.y}),S.tier<=2&&this.anchorGatherer(S.id));let N=new Set(this.movedThisTurnSignal());N.add(S.id),this.movedThisTurnSignal.set(N),this.lastArrivedUnitIdSignal.set(S.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let D=new Map(this.unitMoveHistorySignal()),b=D.get(S.id)??[],R={x:P.x,y:P.y},M={x:t.x,y:t.y},pe=[...b,R,M].slice(-4);D.set(S.id,pe),this.unitMoveHistorySignal.set(D)}return g});let s=t.x-e.position.x,a=t.y-e.position.y,l=this.wallThicknessPx+2,u=this.tileSizePx+l,d={dx:-s*u,dy:-a*u};if(s!==0||a!==0){let p=new Map(this.unitMoveOffsetSignal());p.set(e.id,d),this.unitMoveOffsetSignal.set(p);let g=new Set(this.movingUnitsSignal());g.add(e.id),this.movingUnitsSignal.set(g),setTimeout(()=>{let w=new Map(this.unitMoveOffsetSignal());w.set(e.id,{dx:0,dy:0}),this.unitMoveOffsetSignal.set(w),setTimeout(()=>{let S=new Map(this.unitMoveOffsetSignal());S.delete(e.id),this.unitMoveOffsetSignal.set(S);let P=new Set(this.movingUnitsSignal());P.delete(e.id),this.movingUnitsSignal.set(P)},180)},0)}if(r){let p=this.getUnitAt(t.x,t.y);p&&(this.lastMergedUnitIdSignal.set(p.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(P=>P+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let w=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(w.length>=4&&w[0].x===w[2].x&&w[0].y===w[2].y&&w[1].x===w[3].x&&w[1].y===w[3].y&&(w[0].x!==w[1].x||w[0].y!==w[1].y)){let P=new Map(this.unitStutterBanSignal()),U=new Set([`${w[0].x},${w[0].y}`,`${w[1].x},${w[1].y}`]);P.set(e.id,{tiles:U,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(P);let ie={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},xe=(this.getQuadrant(e.position,ie)+2)%4,De=new Map(this.unitQuadrantBiasSignal());De.set(e.id,{quadrant:xe,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(De)}}let h=this.selectedUnitIdSignal();h&&!this.unitsSignal().some(p=>p.id===h)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility(),e.owner==="player"&&this.selectNextAvailableUnit()}selectNextAvailableUnit(){let t=this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((i,r)=>{let o=this.isForest(i.position.x,i.position.y)||this.isMine(i.position.x,i.position.y)?1:0,s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0;return o!==s?o-s:0}),this.selectUnit(t[0].id)}selectNextAvailableUnitTab(){let t=this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((r,o)=>{let s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0,a=this.isForest(o.position.x,o.position.y)||this.isMine(o.position.x,o.position.y)?1:0;return s!==a?s-a:r.id.localeCompare(o.id)});let i=this.selectedUnitId();if(!i)this.selectUnit(t[0].id);else{let r=t.findIndex(o=>o.id===i);if(r===-1)this.selectUnit(t[0].id);else{let o=(r+1)%t.length;this.selectUnit(t[o].id)}}}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}effectiveAttack(e){return this.calculateTotalPoints(e)+(e.hasWeapon?20:0)}effectiveDefense(e){return(e.points??0)+(e.armorHp??0)}computeSideEffectivePower(e){let t=this.unitsSignal().filter(r=>r.owner===e),i=0;for(let r of t)i+=this.effectiveAttack(r);return i}getWood(e){return e==="ai"?this.aiWoodSignal():this.resourcesSignal().wood}getIron(e){return e==="ai"?this.aiIronSignal():this.resourcesSignal().iron}getForges(e){return e==="ai"?this.aiForgesSignal():this.forgesSignal()}buyArmorGeneric(e,t){e==="ai"?this.aiBuyArmor(t):this.buyArmor(t)}buyWeaponGeneric(e,t){e==="ai"?this.aiBuyWeapon(t):this.buyWeapon(t)}isUnitInDanger(e){let t=this.getNeighbors(e.position);for(let i of t){let r=this.getUnitAt(i.x,i.y);if(r&&r.owner!==e.owner){let o=this.effectiveAttack(r),s=this.effectiveDefense(e),a=e.hasWeapon?e.tier>=3?20:10:0;if(o>s+a)return!0}}return!1}findSafeMove(e,t){let i=this.getBasePosition("ai");return t.length===0?null:t.reduce((r,o)=>{let s=Math.abs(o.x-i.x)+Math.abs(o.y-i.y),a=Math.abs(r.x-i.x)+Math.abs(r.y-i.y);return s<a?o:r},t[0])}findResourceTarget(e,t){let i=this.forestsSignal(),r=this.minesSignal(),o=this.turnSignal()<=20,s=i.filter(w=>{let S=`${w.x},${w.y}`;if(t.claimedTargets.has(S))return!1;let P=this.getUnitAt(w.x,w.y);return!(P&&P.owner==="ai")}),a=r.filter(w=>{let S=`${w.x},${w.y}`;if(t.claimedTargets.has(S))return!1;let P=this.getUnitAt(w.x,w.y);return!(P&&P.owner==="ai")}),l=s.filter(w=>!this.getUnitAt(w.x,w.y)),u=a.filter(w=>!this.getUnitAt(w.x,w.y));if(o){if(l.length>0)return l.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-U}),l[0];if(u.length>0)return u.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-U}),u[0]}else{let w=[...l,...u];if(w.length>0)return w.sort((S,P)=>{let U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),ie=Math.abs(P.x-e.position.x)+Math.abs(P.y-e.position.y);return U-ie}),w[0]}let d=s.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&S.owner==="player"}),p=a.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&S.owner==="player"}).filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&e.tier>=S.tier}),g=d.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&e.tier>=S.tier});if(o){if(g.length>0)return g.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-U}),g[0];if(p.length>0)return p.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-U}),p[0]}else{let w=[...g,...p];if(w.length>0)return w.sort((S,P)=>{let U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),ie=Math.abs(P.x-e.position.x)+Math.abs(P.y-e.position.y);return U-ie}),w[0]}return d.length>0?(d.sort((w,S)=>{let P=this.getUnitAt(w.x,w.y),U=this.getUnitAt(S.x,S.y),ie=P?P.tier:99,Se=U?U.tier:99;if(ie!==Se)return ie-Se;let xe=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),De=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return xe-De}),d[0]):null}findDefensiveWallTarget(e){let t=this.getNeighbors(e.position),r=this.unitsSignal().filter(u=>u.owner==="player").filter(u=>Math.abs(u.position.x-e.position.x)+Math.abs(u.position.y-e.position.y)<=5);if(r.length===0)return null;let o=0,s=0;r.forEach(u=>{o+=u.position.x,s+=u.position.y}),o/=r.length,s/=r.length;let a=null,l=-1/0;for(let u of t){if(this.getWallBetween(e.position.x,e.position.y,u.x,u.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(u)||this.isEdgeOnCooldown(e.position,u))continue;let d=u.x-e.position.x,h=u.y-e.position.y,p=o-e.position.x,g=s-e.position.y,w=d*p+h*g;w>l&&(l=w,a=u)}return l>0?a:null}findBlockingWall(e,t){let i=this.bfsPath(e,t,{respectWalls:!1});if(!i||i.length<2)return null;for(let r=0;r<i.length-1;r++){let o=i[r],s=i[r+1],a=this.getWallBetween(o.x,o.y,s.x,s.y);if(a)return{pos:s,wall:a}}return null}findDefensiveWallTargetForOwner(e,t){let i=this.getNeighbors(e.position),r=t==="player"?"ai":"player",s=this.unitsSignal().filter(h=>h.owner===r).filter(h=>Math.abs(h.position.x-e.position.x)+Math.abs(h.position.y-e.position.y)<=5);if(s.length===0)return null;let a=0,l=0;s.forEach(h=>{a+=h.position.x,l+=h.position.y}),a/=s.length,l/=s.length;let u=null,d=-1/0;for(let h of i){if(this.getWallBetween(e.position.x,e.position.y,h.x,h.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(h)||this.isEdgeOnCooldown(e.position,h))continue;let p=h.x-e.position.x,g=h.y-e.position.y,w=a-e.position.x,S=l-e.position.y,P=p*w+g*S;P>d&&(d=P,u=h)}return d>0?u:null}getNextStepTowards(e,t,i,r){if(i.length===0)return null;let o=l=>{let u=Math.abs(l.x-t.x)+Math.abs(l.y-t.y);if(r?.noCohesion&&!r?.antiClump&&!r?.fogBonus)return u*10;let h=this.getNeighbors(l).filter(g=>{let w=this.getUnitAt(g.x,g.y);return w&&w.owner===e.owner}).length,p=u*10;return r?.antiClump?p+=h*3:r?.noCohesion||(p-=h*2),r?.fogBonus&&!this.isVisibleToPlayer(l.x,l.y)&&e.owner==="player"&&(p-=3),p},s=null,a=1/0;for(let l of i){let u=o(l);u<a&&(a=u,s=l)}return s}findPlayerResourceTarget(e){let t=this.turnSignal(),i=this.forestsSignal(),r=this.minesSignal(),o=this.playerClaimedTargetsSignal(),s=g=>`${g.x},${g.y}`,a=g=>!this.getUnitAt(g.x,g.y),l=g=>{let w=this.getUnitAt(g.x,g.y);return!!(w&&w.owner==="player")},u=i.filter(g=>!o.has(s(g))),d=r.filter(g=>!o.has(s(g))),h=(g,w)=>{let S=Math.abs(g.x-e.position.x)+Math.abs(g.y-e.position.y),P=l(g)?100:0,U=t<=15&&w==="forest"?-5:0;return S*10+P+(a(g)?0:20)+U},p=[...u.map(g=>({p:g,t:"forest",s:h(g,"forest")})),...d.map(g=>({p:g,t:"mine",s:h(g,"mine")}))];return p.length===0?null:(p.sort((g,w)=>g.s-w.s),p[0].p)}findCombatTarget(e,t,i){let r=t.priorityTargets.find(u=>Math.max(Math.abs(u.position.x-e.position.x),Math.abs(u.position.y-e.position.y))<=5);if(r&&!this.bfsPath(e.position,r.position,{respectWalls:!0})){let d=this.findBlockingWall(e.position,r.position);if(d)return this.appendLog(`[Obstacle Smash] T${e.tier} targeting wall at (${d.pos.x},${d.pos.y}) blocking path to high-value target`),d.pos}let o=t.priorityTargets.filter(u=>i.some(d=>d.x===u.position.x&&d.y===u.position.y));if(o.length>0){let u=o.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d));return u.length>0?(u.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),u[0].position):(o.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),o[0].position)}let s=this.getNeighbors(e.position),a=[];for(let u of s){let d=this.getWallBetween(e.position.x,e.position.y,u.x,u.y);if(!d||d.owner===e.owner)continue;let h=d.maxHealth??100,p=100-(h-100);h>200&&!e.hasWeapon&&(p-=150),e.hasWeapon&&(p+=40),(d.formationSize??1)<=2&&(p+=30),a.push({pos:u,score:p})}if(a.length>0)return a.sort((u,d)=>d.score-u.score),a[0].pos;let l=i.map(u=>{let d=this.getUnitAt(u.x,u.y);return!d||d.owner===e.owner?null:{pos:u,enemy:d}}).filter(Boolean);if(l.length>0){let u=l.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d.enemy));return u.length>0?(u.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),u[0].pos):(l.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),l[0].pos)}return null}findFallbackMove(e,t,i){if(t.length===0)return null;let r=Math.abs(e.position.x-i.x)+Math.abs(e.position.y-i.y),o=null,s=1/0;for(let a of t){let l=Math.abs(a.x-i.x)+Math.abs(a.y-i.y);l<s&&(s=l,o=a)}if(!o)return null;if(s>r){let a=this.isUnitInDanger(e),l=!1;if(a&&(l=this.getNeighbors(e.position).some(d=>{let h=this.getUnitAt(d.x,d.y);return!h||h.owner===e.owner?!1:this.effectiveAttack(h)>this.effectiveDefense(e)})),!l)return null}return o}isTileThreatenedByEnemy(e,t){let i=this.getNeighbors(t);for(let r of i){let o=this.getUnitAt(r.x,r.y);if(o&&o.owner!==e.owner&&this.effectiveAttack(o)>=this.effectiveDefense(e))return!0}return!1}getMergePartnerForUnit(e,t){let r=this.reclamationGoalsSignal().get(e.id);if(r&&r.type==="merge"){let u=this.getUnitAt(r.target.x,r.target.y);if(u&&u.owner===e.owner&&u.tier===e.tier)return u}let s=this.mergeIntentSignal().get(e.id);if(s){let u=this.unitsSignal().find(d=>d.id===s);if(u&&u.owner===e.owner&&u.tier===e.tier)return u}let a=this.unitsSignal().find(u=>u.owner===e.owner&&u.tier===e.tier&&(u.position.x!==e.position.x||u.position.y!==e.position.y)&&t.some(d=>d.x===u.position.x&&d.y===u.position.y));if(a)return a;let l=this.unitsSignal().filter(u=>u.owner===e.owner&&u.tier===e.tier&&(u.position.x!==e.position.x||u.position.y!==e.position.y));for(let u of l){let d=this.getNextStepTowards(e,u.position,t);if(!d)continue;let h=this.calculateValidMoves(u),p=this.getNextStepTowards(u,e.position,h);if(!p)continue;let g=Math.abs(e.position.x-u.position.x)+Math.abs(e.position.y-u.position.y);if(Math.abs(d.x-p.x)+Math.abs(d.y-p.y)<g)return u}return null}computeHighestTierNeedingUpgrade(){let e=this.unitsSignal().filter(t=>t.owner==="ai"&&t.tier>=2&&(!t.hasArmor||!t.hasWeapon));return e.length===0?0:e.reduce((t,i)=>Math.max(t,i.tier),0)}getNeighbors(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}].filter(t=>this.inBounds(t.x,t.y))}bfsPath(e,t,i){let r=[{pos:e,path:[e]}],o=new Set;o.add(`${e.x},${e.y}`);let s=0;for(;r.length>0&&s<500;){s++;let a=r.shift();if(a.pos.x===t.x&&a.pos.y===t.y)return a.path;let l=this.getNeighbors(a.pos);for(let u of l){let d=`${u.x},${u.y}`;if(!o.has(d)){if(i?.avoidFriendlyUnits){let h=this.getUnitAt(u.x,u.y);if(h&&h.owner==="ai")continue}if(i?.respectWalls&&this.getWallBetween(a.pos.x,a.pos.y,u.x,u.y))continue;o.add(d),r.push({pos:u,path:[...a.path,u]})}}}return null}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=z([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){if(this.settings.customMode()&&this.endReasonSignal()!=="Debug Victory")return;this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let i=this.firebase.user$(),r=me(L({},t),{playerName:this.playerName.name(),userId:i?.uid,userPhoto:i?.photoURL??void 0});this.firebase.saveHighScore(r),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}aiIron(){return this.aiIronSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;return r?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let i=this.calculateTotalPoints(t),r=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,i-r),atkMax:i+r+(t.hasWeapon?20:0),hp:t.points,support:o}}isUnitHovered(e){return this.hoveredUnitIdSignal()===e}getHitChanceInfo(e){let t=this.selectedUnit();if(!t)return null;let i=this.unitsSignal().find(l=>l.id===e);if(!i||t.owner!=="player"||i.owner===t.owner||!this.isVisibleToPlayer(i.position.x,i.position.y)||!this.validMoves().some(l=>l.x===i.position.x&&l.y===i.position.y))return null;let o=this.combat.calculateHitChance(t,i),s="bg-green-600";o<50?s="bg-red-600":o<100&&(s="bg-amber-600");let a=o<10;return{chance:o,bg:s,icon:a?"\u2620\uFE0F":"\u2694\uFE0F",skull:a}}shouldRenderWall(e,t,i){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return r?(i??r.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}hoverFormationById(e){this.hoveredFormationIdSignal.set(e??null)}isFormationHovered(e){return e?this.hoveredFormationIdSignal()===e:!1}getFormationInfo(e){let t=e??null;if(!t)return null;let i=this.wallsSignal().find(r=>r.formationId===t);return i?{size:i.formationSize??1,bonus:i.bonusHp??0}:null}updateWallFormations(){let e=this.wallsSignal();if(e.length===0)return;let t=new Map,i=new Map;for(let l of e){t.set(l.id,l);let u=`${l.tile1.x},${l.tile1.y}`,d=`${l.tile2.x},${l.tile2.y}`,h=i.get(u)??[];h.push(l.id),i.set(u,h);let p=i.get(d)??[];p.push(l.id),i.set(d,p)}let r=new Set,o=[];for(let l of e){if(r.has(l.id))continue;if(l.owner==="neutral"){o.push([l.id]),r.add(l.id);continue}let u=[l.id];r.add(l.id);let d=[],h=l.owner;for(;u.length>0;){let p=u.shift();d.push(p);let g=t.get(p),w=[`${g.tile1.x},${g.tile1.y}`,`${g.tile2.x},${g.tile2.y}`];for(let S of w){let P=i.get(S)??[];for(let U of P)r.has(U)||t.get(U).owner===h&&(r.add(U),u.push(U))}}o.push(d)}let s=e.map(l=>L({},l)),a=new Map;for(let l=0;l<s.length;l++)a.set(s[l].id,l);for(let l of o){let d=t.get(l[0]).owner==="neutral",h=d?1:l.length,p=d?0:Math.max(0,h*20),g=100+p,w=d?null:l[0];for(let S of l){let P=a.get(S),U=s[P],ie=U.maxHealth??100,Se=g-ie,xe=U.health;Se>0?xe=U.health+Se:Se<0&&(xe=Math.min(U.health,g)),xe=Math.max(0,Math.min(g,xe)),s[P]=me(L({},U),{formationId:w??void 0,formationSize:h,maxHealth:g,bonusHp:p,health:xe})}}this.wallsSignal.set(s)}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(i=>i.position.x===e&&i.position.y===t).map(i=>({id:i.id,text:i.text,opacity:i.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let i=this.unitsSignal().find(d=>d.id===e);if(!i)return"";let r=this.combat.getPointsForTierLevel(i.tier,4),o=t.support>0?`+${t.support}`:"+0",s=i.hasWeapon?" | Weapon:+20":"",a=i.armorHp??0,l=i.hasArmor?` | Armor:${a}`:"",u=a>0?`${t.hp} + ${a}`:`${t.hp}`;return`Unit T${i.tier} | HP: ${u}/${r} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}${s}${l}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.endReasonSignal.set("Debug Victory"),this.endOverlaySignal.set(!0);let t=this.getForestControl().player,r={playerName:this.playerName.name(),turnsPlayed:this.turnSignal(),forestsCaptured:t,victoryType:"Annihilation",timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:!0};this.pendingScoreSignal.set(r),this.namePromptOpenSignal.set(!0)}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],i=e.indexOf(this.settings.difficulty()),r=t.indexOf(this.settings.mapSize());i++,i>=e.length&&(i=0,r++,r>=t.length&&(r=0)),this.settings.setDifficulty(e[i]),this.settings.setMapSize(t[r]),this.resetGame()}recordHighScore(e,t){if(this.settings.customMode()){this.endReasonSignal.set("Match Finished (Custom Mode)");return}let i=`${this.settings.difficulty()}|${this.settings.mapSize()}`,r=L({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=r[i]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((h,p)=>h.turns-p.turns).slice(0,3):s.losses=[...s.losses,o].sort((h,p)=>h.turns-p.turns).slice(0,3),r[i]=s,this.highScoresSignal.set(r),this.persistHighScores();let a=this.getForestControl(),l=e==="player wins"?a.player:a.ai,u=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:l,victoryType:u,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"?(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0)):this.firebase.saveHighScore(d)}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let i=crypto.randomUUID(),r={id:i,text:e,position:L({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),r]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===i?me(L({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==i))},2e3)}calculateValidMoves(e){let t=[],i=e.position,r=u=>u.x>=0&&u.x<this.gridSize&&u.y>=0&&u.y<this.gridSize,o=(u,d)=>{if(!r(d))return"blocked";if(u.x===d.x||u.y===d.y){if(this.getWallBetween(u.x,u.y,d.x,d.y))return"blocked"}else if(this.isDiagonalBlocked(u,d))return"blocked";let h=this.getUnitAt(d.x,d.y);return h?h.owner===e.owner?"ally":"enemy":"empty"},s=(u,d)=>{(d==="empty"||d==="enemy"||this.getUnitAt(u.x,u.y)?.tier===e.tier)&&t.push(u)},a=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],l=[{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}];if(e.tier===1){for(let u of a){let d={x:i.x+u.x,y:i.y+u.y},h=o(i,d);h!=="blocked"&&s(d,h)}return t}for(let u of a){let d={x:i.x+u.x,y:i.y+u.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===3&&h==="empty"){let p={x:i.x+u.x*2,y:i.y+u.y*2},g=o(d,p);g!=="blocked"&&s(p,g)}}for(let u of l){let d={x:i.x+u.x,y:i.y+u.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===4&&h==="empty"){let p={x:i.x+u.x*2,y:i.y+u.y*2},g=o(d,p);if(g!=="blocked"&&(s(p,g),g==="empty")){let w={x:i.x+u.x*3,y:i.y+u.y*3},S=o(p,w);S!=="blocked"&&s(w,S)}}}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),l=this.isForest(s.position.x,s.position.y),u=this.isMine(s.position.x,s.position.y),d=l?a?1:(s.forestOccupationTurns??0)+1:0,h=u?a?1:(s.mineOccupationTurns??0)+1:0,p=l?d>=3:!1;return me(L({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:d,mineOccupationTurns:h,productionActive:p})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let i=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(a=>a.owner===e&&this.isForest(a.position.x,a.position.y)&&(a.productionActive??!1)).length,s=this.unitsSignal().filter(a=>a.owner===e&&this.isMine(a.position.x,a.position.y)&&(a.mineOccupationTurns??0)>=5).length;if(o>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood+o*i(this.settings.difficulty()),iron:a.iron})):this.aiWoodSignal.update(a=>a+o*i(this.settings.difficulty()))),s>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood,iron:a.iron+s*2})):this.aiIronSignal.update(a=>a+s*2)),e==="player"){let a=this.forgeSitesSignal().map(h=>L({},h));for(let h of a)h.turnsLeft=Math.max(0,h.turnsLeft-1);let l=a.filter(h=>h.turnsLeft===0),u=l.map(h=>h.position),d=a.filter(h=>h.turnsLeft>0);if(u.length>0){this.forgesSignal.update(p=>[...p,...u]);let h=l.filter(p=>p.owner==="ai").map(p=>p.position);if(h.length>0){this.aiForgesSignal.update(p=>[...p,...h]);for(let p of h)this.appendLog(`[AI] Forge completed at (${p.x},${p.y}).`)}}this.forgeSitesSignal.set(d)}}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let r=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(r),this.startSideTurn(r),r==="ai"&&this.gameStatus()==="playing"&&(this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10))}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}pauseGame(){this.stopAiLoops()}aiTurnTimeout=null;stopAiLoops(){this.aiTurnTimeout&&(clearTimeout(this.aiTurnTimeout),this.aiTurnTimeout=null),this.isAiThinking=!1}startSideTurn(e){this.unitsSignal.update(t=>t.map(i=>i.owner===e?me(L({},i),{hasActed:!1}):i)),e==="player"&&(this.selectNextAvailableUnit(),this.playerClaimedTargetsSignal.set(new Set))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;if(r){let s=L({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=L({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai"),t=this.forestsSignal().length+this.minesSignal().length,i=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y))),r=t>0?i.length/t:0;if(r>.5){let D=new Map,b=this.unitsSignal().filter(pe=>pe.owner==="ai"&&!pe.hasActed),R=new Set,M=i.slice().sort((pe,Oe)=>Oe.tier-pe.tier);for(let pe of M){let Oe=Math.min(4,pe.tier+1),ce=b.filter(Ae=>Ae.tier===Oe&&!R.has(Ae.id)).sort((Ae,jt)=>{let st=Math.max(Math.abs(Ae.position.x-pe.position.x),Math.abs(Ae.position.y-pe.position.y)),te=Math.max(Math.abs(jt.position.x-pe.position.x),Math.abs(jt.position.y-pe.position.y));return st-te});if(ce.length>0){let Ae=ce[0];D.set(Ae.id,{target:L({},pe.position),type:"hunt"}),R.add(Ae.id);continue}let Lt=b.filter(Ae=>Ae.tier===pe.tier&&!R.has(Ae.id)),Yt=!1;for(let Ae of Lt){let jt=this.calculateValidMoves(Ae),st=this.unitsSignal().find(te=>te.owner==="ai"&&te.tier===Ae.tier&&(te.position.x!==Ae.position.x||te.position.y!==Ae.position.y)&&jt.some(ne=>ne.x===te.position.x&&ne.y===te.position.y));if(st){D.set(Ae.id,{target:L({},st.position),type:"merge"}),R.add(Ae.id),Yt=!0;break}}Yt||this.aiSpawnTier(Oe,1,new Set)}this.reclamationGoalsSignal.set(D),this.appendLog(`[AI Mode] Reclamation active. Player controls ${(r*100).toFixed(0)}% of resources.`)}else this.reclamationGoalsSignal.set(new Map);let a=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)).length>3;{let D=0,b=50,M=this.baseHealthSignal().ai<50?20:70;for(;this.aiWoodSignal()>M;){if(D++,D>b){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let D=this.forestsSignal().length,b=this.unitsSignal().filter(st=>st.owner==="ai"&&this.isForest(st.position.x,st.position.y)).length,R=this.unitsSignal().filter(st=>st.owner==="player"&&this.isForest(st.position.x,st.position.y)).length,M=this.settings.difficulty(),pe=D>0?R/D:0,Oe="none";R<=b?Oe="none":pe>=.9||R>=9?Oe="rage":R>=b+(M==="baby"?4:M==="normal"?3:M==="hard"?2:1)?Oe="angry":Oe="none",this.aiMoodSignal.set(Oe);let ce=this.turnSignal()%2===0,Lt=this.turnSignal()%5===0,Yt=D>0?b/D:0,Ae=this.totalWarModeSignal(),jt=Yt>=.65;if(!Ae&&jt)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(jt),Oe==="rage"){let st=M==="baby"?ce?1:2:M==="normal"?ce?3:2:M==="hard"?ce?4:3:4;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+st}))}else if(Oe==="angry"){if(M==="baby")Lt&&this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+1}));else if(ce){let st=M==="normal"?ce?1:0:M==="hard"?Lt?2:1:2;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+st}))}}}catch{}if(this.manageInfrastructure(),this.turnSignal()<=10){let D=0,b=this.getPointsForTierLevel(1,1);for(;this.reservePointsSignal().ai>=b&&D<2&&this.aiSpawnTier(1,1,new Set)!==0;)D++,await new Promise(M=>setTimeout(M,60))}await new Promise(D=>setTimeout(D,100));let l=this.unitsSignal().filter(D=>D.owner==="ai"),u=new Map(this.aiUnitTimeNearBaseSignal()),d=new Set(l.map(D=>D.id));for(let D of u.keys())d.has(D)||u.delete(D);for(let D of l)Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3?u.set(D.id,(u.get(D.id)||0)+1):u.set(D.id,0);this.aiUnitTimeNearBaseSignal.set(u);for(let D of l){let b=this.isForest(D.position.x,D.position.y);D.owner==="ai"&&b&&D.tier<=2&&this.anchorGatherer(D.id)}let h=this.unitsSignal().filter(D=>D.owner==="player"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,p=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,g=h>=p;this.aggressionModeSignal.set(g);let P=this.forestsSignal().filter(D=>!this.getUnitAt(D.x,D.y)).filter(D=>this.isVisibleToAi(D.x,D.y)),U=this.unitsSignal().filter(D=>D.owner==="ai");if(this.turnSignal()<=15){let D=this.aiQueuedUnitIdSignal(),b=D?U.find(M=>M.id===D):null;if(!(b&&!this.isForest(b.position.x,b.position.y)&&P.length>0)){let M=U.filter(Oe=>Oe.tier<=2&&!this.isForest(Oe.position.x,Oe.position.y)),pe=M.length>0&&P.length>0?M.reduce((Oe,ce)=>{let Lt=Math.min(...P.map(Ae=>Math.abs(ce.position.x-Ae.x)+Math.abs(ce.position.y-Ae.y))),Yt=Math.min(...P.map(Ae=>Math.abs(Oe.position.x-Ae.x)+Math.abs(Oe.position.y-Ae.y)));return Lt<Yt?ce:Oe},M[0]):null;this.aiQueuedUnitIdSignal.set(pe?pe.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let D=this.getPointsForTierLevel(3,1),b=this.forestsSignal().length,R=this.unitsSignal().filter(Oe=>Oe.owner==="ai"&&this.isForest(Oe.position.x,Oe.position.y)).length,M=b>0?R/b:0;this.reservePointsSignal().ai>=D&&M<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let ie=this.unitsSignal().filter(D=>D.owner==="player"&&Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3&&D.tier>=2);if(ie.length>0){let D=ie.reduce((b,R)=>this.calculateTotalPoints(R)>this.calculateTotalPoints(b)?R:b,ie[0]);this.aiDefenseSpawn(D)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let D=this.aiStrategy.getWallBuildActions(this);for(let b of D){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(b.from,b.to)}}else this.tryDefensiveWallsNearForests();let Se=0,xe=10;for(;Se<xe&&this.executeOneFreeAction();)Se++,await new Promise(b=>setTimeout(b,100));this.aiQueuedUnitIdSignal.set(null);let De=this.getBasePosition("player"),Ie=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y)||this.isForge(D.position.x,D.position.y)||Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=4)),k={claimedTargets:new Set,priorityTargets:Ie},N=this.unitsSignal().filter(D=>D.owner==="ai"&&!D.hasActed).sort((D,b)=>b.tier-D.tier);for(let D of N){let b=this.unitsSignal().find(te=>te.id===D.id);if(!b||b.hasActed)continue;let R=null,pe=this.calculateValidMoves(b).filter(te=>!k.claimedTargets.has(`${te.x},${te.y}`)),Oe=Math.max(Math.abs(b.position.x-e.x),Math.abs(b.position.y-e.y)),ce=this.unitsSignal().filter(te=>te.owner==="player"&&Math.max(Math.abs(te.position.x-e.x),Math.abs(te.position.y-e.y))<=3);if(ce.length>0&&!this.isForest(b.position.x,b.position.y)&&Oe<=6){let te=ce.reduce((_e,ye)=>{let ge=Math.max(Math.abs(_e.position.x-e.x),Math.abs(_e.position.y-e.y));return Math.max(Math.abs(ye.position.x-e.x),Math.abs(ye.position.y-e.y))<ge?ye:_e});if(pe.some(_e=>_e.x===te.position.x&&_e.y===te.position.y))R={type:"attack",target:te.position,reason:"Base Defense: Eliminate Threat"};else{let _e=this.getNextStepTowards(b,te.position,pe);_e&&(R={type:"move",target:_e,reason:"Base Defense: Intercept"})}}if(!R){let te=this.reclamationGoalsSignal().get(b.id);if(te){let ne=te.target,_e=this.getUnitAt(ne.x,ne.y);if(_e&&_e.owner!==b.owner)if(pe.some(ge=>ge.x===ne.x&&ge.y===ne.y))R={type:"attack",target:ne,reason:"Reclaim: Attack Occupier"};else{let ge=this.bfsPath(b.position,ne,{respectWalls:!0,avoidFriendlyUnits:!0});if(ge||(ge=this.bfsPath(b.position,ne,{avoidFriendlyUnits:!0})),ge&&ge.length>1){let y=ge[1],oe=this.getWallBetween(b.position.x,b.position.y,y.x,y.y),ze=this.getUnitAt(y.x,y.y);if(ze&&ze.owner!==b.owner){let We=this.effectiveAttack(ze)>this.effectiveDefense(b),re=pe.some(bt=>bt.x===y.x&&bt.y===y.y);if(We&&re)R={type:"attack",target:y,reason:"Reclaim: Engage Blocker"};else if(oe)R={type:"wall_attack",target:y,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(b,y)){let bt=pe.filter(ii=>{let vs=Math.abs(ii.x-ne.x)+Math.abs(ii.y-ne.y),Jd=Math.abs(y.x-ne.x)+Math.abs(y.y-ne.y);return vs<=Jd&&!this.isTileThreatenedByEnemy(b,ii)}),Ei=bt.length>0?this.getNextStepTowards(b,ne,bt):null;R=Ei?{type:"move",target:Ei,reason:"Reclaim: Bypass Threat"}:{type:"move",target:y,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:y,reason:"Reclaim: Pursue Resource"}}else if(oe)R={type:"wall_attack",target:y,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(b,y)){let We=pe.filter(bt=>{let Ei=Math.abs(bt.x-ne.x)+Math.abs(bt.y-ne.y),ii=Math.abs(y.x-ne.x)+Math.abs(y.y-ne.y);return Ei<=ii&&!this.isTileThreatenedByEnemy(b,bt)}),re=We.length>0?this.getNextStepTowards(b,ne,We):null;R=re?{type:"move",target:re,reason:"Reclaim: Bypass Threat"}:{type:"move",target:y,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:y,reason:"Reclaim: Pursue Resource"}}}else if(te.type==="merge")if(pe.some(ge=>ge.x===ne.x&&ge.y===ne.y))R={type:"move",target:ne,reason:"Reclaim: Merge to Counter"};else{let ge=this.getNextStepTowards(b,ne,pe);ge&&(R=this.getWallBetween(b.position.x,b.position.y,ge.x,ge.y)?{type:"wall_attack",target:ge,reason:"Reclaim: Breach to Merge"}:{type:"move",target:ge,reason:"Reclaim: Approach Ally"})}else{let ye=this.getNextStepTowards(b,ne,pe);if(ye){let ge=this.getWallBetween(b.position.x,b.position.y,ye.x,ye.y),y=this.getUnitAt(ye.x,ye.y);if(y&&y.owner!==b.owner){let oe=this.effectiveAttack(y)>this.effectiveDefense(b),ze=pe.some(We=>We.x===ye.x&&We.y===ye.y);if(oe&&ze)R={type:"attack",target:ye,reason:"Reclaim: Engage Blocker"};else if(ge)R={type:"wall_attack",target:ye,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(b,ye)){let We=pe.filter(bt=>{let Ei=Math.abs(bt.x-ne.x)+Math.abs(bt.y-ne.y),ii=Math.abs(ye.x-ne.x)+Math.abs(ye.y-ne.y);return Ei<=ii&&!this.isTileThreatenedByEnemy(b,bt)}),re=We.length>0?this.getNextStepTowards(b,ne,We):null;R=re?{type:"move",target:re,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ye,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ye,reason:"Reclaim: Close Distance"}}else if(ge)R={type:"wall_attack",target:ye,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(b,ye)){let oe=pe.filter(We=>{let re=Math.abs(We.x-ne.x)+Math.abs(We.y-ne.y),bt=Math.abs(ye.x-ne.x)+Math.abs(ye.y-ne.y);return re<=bt&&!this.isTileThreatenedByEnemy(b,We)}),ze=oe.length>0?this.getNextStepTowards(b,ne,oe):null;R=ze?{type:"move",target:ze,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ye,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ye,reason:"Reclaim: Close Distance"}}}}}if(this.isForest(b.position.x,b.position.y)){let te=this.calculateValidMoves(b),ne=this.findCombatTarget(b,k,te);if(ne)R={type:"attack",target:ne,reason:"Defense: Defend Forest"};else{if(this.aiWoodSignal()>=50){let _e=this.findDefensiveWallTarget(b);_e&&(R={type:"build_wall",target:_e,reason:"Defense: Fortify Position"})}if(!R&&!this.isUnitInDanger(b)){this.unitsSignal.update(ye=>ye.map(ge=>ge.id===b.id?me(L({},ge),{hasActed:!0}):ge));continue}}}if(!R&&this.isMine(b.position.x,b.position.y)){let te=this.calculateValidMoves(b),ne=this.findCombatTarget(b,k,te);if(ne)R={type:"attack",target:ne,reason:"Defense: Defend Mine"};else if(!this.isUnitInDanger(b)){this.unitsSignal.update(ye=>ye.map(ge=>ge.id===b.id?me(L({},ge),{hasActed:!0}):ge));continue}}let Lt=this.forestsSignal().length,Yt=this.unitsSignal().filter(te=>te.owner==="ai"&&this.isForest(te.position.x,te.position.y)).length,Ae=Lt>0?Yt/Lt:0,jt=b.tier>=3||Ae>=.7,st=Math.max(Math.abs(b.position.x-De.x),Math.abs(b.position.y-De.y));if(!R&&st<4){if(jt&&st<=3){let te=[];pe.some(oe=>oe.x===De.x&&oe.y===De.y)&&te.push({type:"attack",target:De,weight:1,reason:"Siege: Strike Base"});let _e=this.getNeighbors(b.position),ye=st,ge=!1;for(let oe of _e)this.getWallBetween(b.position.x,b.position.y,oe.x,oe.y)&&Math.max(Math.abs(oe.x-De.x),Math.abs(oe.y-De.y))<ye&&(te.push({type:"wall_attack",target:oe,weight:.9,reason:"Siege: Breach (Path to Base)"}),ge=!0);let y=this.getNextStepTowards(b,De,pe,{noCohesion:!0});if(y){let oe=Math.max(Math.abs(y.x-De.x),Math.abs(y.y-De.y));(!ge||oe<ye)&&te.push({type:"move",target:y,weight:.5,reason:"Siege: Advance on Base"})}if(te.length>0){te.sort((ze,We)=>We.weight-ze.weight);let oe=te[0];R={type:oe.type,target:oe.target,reason:oe.reason},oe.type==="move"&&ge&&this.appendLog(`[AI Debug] Unit at (${b.position.x},${b.position.y}) chose Move over Wall Attack. Weights: wall=0.9, move=${oe.weight}`)}}if(!R)if(pe.some(ne=>ne.x===De.x&&ne.y===De.y))R={type:"attack",target:De,reason:"Siege: Strike Base"};else{let ne=this.getNextStepTowards(b,De,pe,{noCohesion:!0});if(ne)this.getWallBetween(b.position.x,b.position.y,ne.x,ne.y)?R={type:"wall_attack",target:ne,reason:"Siege: Breach"}:R={type:"move",target:ne,reason:"Siege: Advance on Base"};else{let _e=this.bfsPath(b.position,De);if(_e&&_e.length>1){let ye=_e[1];this.getWallBetween(b.position.x,b.position.y,ye.x,ye.y)&&(R={type:"wall_attack",target:ye,reason:"Siege: Breaching"})}}}}if(!R){let te=this.aiForgesSignal(),ne=this.unitsSignal().filter(ye=>ye.owner==="player"),_e=[];for(let ye of te)for(let ge of ne)Math.max(Math.abs(ge.position.x-ye.x),Math.abs(ge.position.y-ye.y))<=3&&_e.push(ge);if(_e.length>0){let ye=_e.reduce((y,oe)=>{let ze=Math.abs(y.position.x-b.position.x)+Math.abs(y.position.y-b.position.y);return Math.abs(oe.position.x-b.position.x)+Math.abs(oe.position.y-b.position.y)<ze?oe:y});if(pe.some(y=>y.x===ye.position.x&&y.y===ye.position.y))R={type:"attack",target:ye.position,reason:"Defense: Guard Forge"};else{let y=this.getNextStepTowards(b,ye.position,pe);y&&(R=this.getWallBetween(b.position.x,b.position.y,y.x,y.y)?{type:"wall_attack",target:y,reason:"Defense: Breach to Forge"}:{type:"move",target:y,reason:"Defense: Approach Forge Threat"})}}}if(!R&&b.tier>=2&&(!b.hasArmor||!b.hasWeapon)){let te=this.seekUpgrades(b,pe);te.type==="move"&&te.target&&(R={type:"move",target:te.target,reason:"Upgrade: Move to Forge"})}if(!R){let te=this.isUnitInDanger(b),ne=this.reclamationGoalsSignal().has(b.id);if(!ne&&te){let _e=this.findSafeMove(b,pe);_e&&(R={type:"move",target:_e,reason:"Survival: Evade Threat"})}else if(ne&&te&&this.getNeighbors(b.position).some(ge=>{let y=this.getUnitAt(ge.x,ge.y);return!y||y.owner===b.owner?!1:this.effectiveAttack(y)>this.effectiveDefense(b)+(b.tier>=3?10:0)})){let ge=this.findSafeMove(b,pe);ge&&(R={type:"move",target:ge,reason:"Survival: Lethal Evade"})}}if(!R&&b.tier===4){let te=this.unitsSignal().filter(ne=>ne.owner==="player");if(te.length>0){let ne=this.getBasePosition("player"),_e=te.map(ge=>({u:ge,baseDist:Math.max(Math.abs(ge.position.x-ne.x),Math.abs(ge.position.y-ne.y))})).sort((ge,y)=>ge.u.tier!==y.u.tier?ge.u.tier-y.u.tier:ge.baseDist-y.baseDist)[0].u,ye=this.getNextStepTowards(b,_e.position,pe);ye&&(R={type:"move",target:ye,reason:"T4 Raid: Flank Backline"})}}if(!R){let te=this.computeSideEffectivePower("ai"),ne=this.computeSideEffectivePower("player");if(ne>0&&te>ne*1.2&&!this.isForest(b.position.x,b.position.y)&&parseInt(b.id.slice(-1),16)%2===0){let ge=this.unitsSignal().filter(ze=>ze.owner==="player"),y=De;if(ge.length>0&&(y=ge.reduce((We,re)=>{let bt=Math.max(Math.abs(We.position.x-b.position.x),Math.abs(We.position.y-b.position.y));return Math.max(Math.abs(re.position.x-b.position.x),Math.abs(re.position.y-b.position.y))<bt?re:We}).position),Math.max(Math.abs(y.x-b.position.x),Math.abs(y.y-b.position.y))<=1){let ze=this.findCombatTarget(b,k,pe);ze&&(R={type:"attack",target:ze,reason:"Siege: Engage Enemy"})}else{let ze=this.getNextStepTowards(b,y,pe,{noCohesion:!0});if(ze)R={type:"move",target:ze,reason:"Siege: Advance"};else{let We=this.bfsPath(b.position,y);if(We&&We.length>1){let re=We[1];this.getWallBetween(b.position.x,b.position.y,re.x,re.y)&&(R={type:"wall_attack",target:re,reason:"Siege: Breaching"})}}}}if(!R){let ge=this.findResourceTarget(b,k);if(ge){let y=this.bfsPath(b.position,ge,{respectWalls:!0,avoidFriendlyUnits:!0});if(y||(y=this.bfsPath(b.position,ge,{avoidFriendlyUnits:!0})),y&&y.length>1){let oe=y[1],ze=this.getWallBetween(b.position.x,b.position.y,oe.x,oe.y);ze?ze.owner==="ai"&&this.isBaseProtectionEdge(b.position,oe)||(R={type:"wall_attack",target:oe,reason:"Objective: Breaching Wall"}):pe.some(We=>We.x===oe.x&&We.y===oe.y)&&(R={type:"move",target:oe,reason:"Objective: Capture Resource"})}}}}if(!R){let te=this.findCombatTarget(b,k,pe);te&&(R={type:"attack",target:te,reason:"Combat: Engage Enemy"})}if(!R&&this.aiWoodSignal()>=10&&this.getNeighbors(b.position).some(_e=>this.isForest(_e.x,_e.y)&&this.getUnitAt(_e.x,_e.y)?.owner==="ai")){let _e=this.findDefensiveWallTarget(b);_e&&(R={type:"build_wall",target:_e,reason:"Defense: Fortify Perimeter"})}if(!R){let te=De,ne=this.findFallbackMove(b,pe,te);ne&&(R={type:"move",target:ne,reason:"Fallback: Advance on Enemy"})}if(R){if(this.appendLog(`[AI Unit ${b.id.substring(0,4)}] Action: ${R.reason} -> Target: (${R.target.x},${R.target.y})`),R.type==="build_wall")this.aiBuildWallBetween(b.position,R.target);else{if(R.type==="move"){let te=this.getUnitAt(R.target.x,R.target.y);if(te&&te.owner==="ai"&&te.tier===b.tier){let ne=new Map(this.mergeIntentSignal());ne.set(b.id,te.id),ne.set(te.id,b.id),this.mergeIntentSignal.set(ne)}}this.executeMove(b,R.target)}k.claimedTargets.add(`${R.target.x},${R.target.y}`)}else this.appendLog(`[AI Unit ${b.id.substring(0,4)}] No valid moves. Passing.`),this.unitsSignal.update(te=>te.map(ne=>ne.id===b.id?me(L({},ne),{hasActed:!0}):ne));await new Promise(te=>setTimeout(te,60))}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(s=>s.owner==="player"&&Math.max(Math.abs(s.position.x-e.x),Math.abs(s.position.y-e.y))<=3&&s.tier>=2);if(t.length>0){let s=t.reduce((l,u)=>this.calculateTotalPoints(u)>this.calculateTotalPoints(l)?u:l,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(s))return!0}let i=this.unitsSignal().filter(s=>s.owner==="ai").length;if(i<6){let s=this.reservePointsSignal().ai,a=this.getPointsForTierLevel(2,1);if(s>=a&&this.aiSpawnTier(2,1,new Set)>0)return!0}let o=this.baseHealthSignal().ai<50?20:70;if(this.aiWoodSignal()>=o)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;{let s=this.reservePointsSignal().ai,a=this.unitsSignal().filter(l=>l.owner==="ai"&&this.isForest(l.position.x,l.position.y)).length;if(s>25&&a>5&&this.aiSpawnTier(3,1,new Set,!0)>0)return!0}if(t.length===0)try{let s=this.getPointsForTierLevel(3,1),a=this.forestsSignal().length,l=this.unitsSignal().filter(h=>h.owner==="ai"&&this.isForest(h.position.x,h.position.y)).length,u=a>0?l/a:0,d=this.reservePointsSignal().ai;if(i>=6&&d>=s&&u<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),i=[],r=e.position.x,o=e.position.y,s=Math.sign(t.x-r),a=Math.sign(t.y-o);{let p=0,g=Math.max(10,this.gridSize*2);for(;r!==t.x||o!==t.y;){if(p++,p>g){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(r+=s,o+=a,!this.inBounds(r,o)||r===t.x&&o===t.y)break;i.push({x:r,y:o})}}let l=i.reverse().find(p=>!this.getUnitAt(p.x,p.y))||(()=>{for(let p=-1;p<=1;p++)for(let g=-1;g<=1;g++){if(p===0&&g===0)continue;let w=t.x+p,S=t.y+g;if(this.inBounds(w,S)&&!this.getUnitAt(w,S))return{x:w,y:S}}return null})();if(!l)return!1;{let p=0,g=50;for(;this.aiWoodSignal()>=20;){if(p++,p>g){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let u=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(u);if(d<=0)return!1;let h=this.calculateTierAndLevel(d);return this.unitsSignal().filter(g=>g.owner==="ai"&&g.tier===h.tier&&!this.isForest(g.position.x,g.position.y)).length>=5?!1:(this.unitsSignal.update(p=>[...p,{id:crypto.randomUUID(),position:L({},l),level:h.level,tier:h.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1}]),this.reservePointsSignal.update(p=>({player:p.player,ai:p.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,i,r=!1){let o=this.getBasePosition("ai"),s=[],a=2;for(let P=-a;P<=a;P++)for(let U=-a;U<=a;U++){if(P===0&&U===0)continue;let ie=o.x+P,Se=o.y+U;if(!this.inBounds(ie,Se)||Math.max(Math.abs(P),Math.abs(U))>a)continue;let xe=`${ie},${Se}`;i.has(xe)||this.getUnitAt(ie,Se)||s.push({x:ie,y:Se})}let l=this.aiForgesSignal(),u=this.aiIronSignal()<40;u&&l.length>0&&s.sort((P,U)=>{let ie=l.reduce((xe,De)=>Math.min(xe,Math.max(Math.abs(P.x-De.x),Math.abs(P.y-De.y))),1/0);return l.reduce((xe,De)=>Math.min(xe,Math.max(Math.abs(U.x-De.x),Math.abs(U.y-De.y))),1/0)-ie});let d=this.reservePointsSignal().ai,h=this.getPointsForTierLevel(e,1),p=0,g=[],w=P=>this.unitsSignal().filter(U=>U.owner==="ai"&&U.tier===P&&!this.isForest(U.position.x,U.position.y)).length;if(w(e)>=5&&!(r&&e===3))return 0;for(let P of s){if(p>=t||d<h||w(e)>=5)break;let U=this.calculateTierAndLevel(h);g.push({id:crypto.randomUUID(),position:L({},P),level:U.level,tier:U.tier,points:h,owner:"ai",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}),d-=h,p++}if(g.length>0){this.unitsSignal.update(ie=>[...ie,...g]),this.reservePointsSignal.update(ie=>({player:ie.player,ai:d})),this.recomputeVisibility();let P=new Map(this.ignoreForgeUntilTurnSignal()),U=this.turnSignal()+(u?2:1);for(let ie of g)P.set(ie.id,U);this.ignoreForgeUntilTurnSignal.set(P)}return p}aiConvertWoodToReserve(){let e=this.aiWoodSignal(),i=this.baseHealthSignal().ai<50?20:70;e<i||(this.aiWoodSignal.update(r=>r-20),this.reservePointsSignal.update(r=>({player:r.player,ai:r.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(i=>{if(i.some(s=>s.position.x===t.x&&s.position.y===t.y))return i;let o={id:crypto.randomUUID(),position:L({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};return[...i,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),i=2,r=[];for(let u=-i;u<=i;u++)for(let d=-i;d<=i;d++){let h=t.x+u,p=t.y+d;this.inBounds(h,p)&&(u===0&&d===0||Math.max(Math.abs(u),Math.abs(d))>i||r.push({x:h,y:p}))}let o=this.settings.difficulty(),s;o==="baby"?s=[{tier:4,level:1},{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}]:s=[{tier:1,level:1},{tier:1,level:1}];let a=[],l=(u,d)=>this.unitsSignal().some(h=>h.position.x===u&&h.position.y===d)||a.some(h=>h.position.x===u&&h.position.y===d);for(let u of s){let d=r.filter(w=>!l(w.x,w.y));if(d.length===0)break;let h=Math.floor(Math.random()*d.length),p=d[h],g=this.getPointsForTierLevel(u.tier,u.level);a.push({id:crypto.randomUUID(),position:L({},p),level:u.level,tier:u.tier,points:g,owner:e,turnsStationary:0,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0})}a.length>0&&this.unitsSignal.update(u=>[...u,...a])}getUnitAt(e,t){return this.unitsSignal().find(i=>i.position.x===e&&i.position.y===t)}getWallBetween(e,t,i,r){let o={x:e,y:t},s={x:i,y:r};if(!this.areAdjacent(o,s))return;let[a,l]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(u=>u.tile1.x===a.x&&u.tile1.y===a.y&&u.tile2.x===l.x&&u.tile2.y===l.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(i,r,o,s)=>this.getWallBetween(i,r,o,s))}isValidMove(e,t){return this.validMoves().some(i=>i.x===e&&i.y===t)}isForest(e,t){return this.forestsSignal().some(i=>i.x===e&&i.y===t)}isMine(e,t){return this.minesSignal().some(i=>i.x===e&&i.y===t)}isForgeSite(e,t){return this.forgeSitesSignal().some(i=>i.position.x===e&&i.position.y===t)}isForge(e,t){return this.forgesSignal().some(i=>i.x===e&&i.y===t)}getForgeProgress(e,t){let i=this.forgeSitesSignal().find(o=>o.position.x===e&&o.position.y===t);if(!i)return 0;let r=5;return Math.round((r-i.turnsLeft)/r*100)}canBuildForgeAt(e,t){let i=this.getBasePosition("player");if(Math.max(Math.abs(e-i.x),Math.abs(t-i.y))>2||!this.inBounds(e,t)||e===i.x&&t===i.y||this.getUnitAt(e,t)||this.isForest(e,t)||this.isMine(e,t)||this.isForgeSite(e,t)||this.isForge(e,t))return!1;let o=this.resourcesSignal();return o.wood>=40&&o.iron>=20&&this.isPlayerTurn()}buildForgeAt(e){this.canBuildForgeAt(e.x,e.y)&&(this.resourcesSignal.update(t=>({wood:t.wood-40,iron:t.iron-20})),this.forgeSitesSignal.update(t=>[...t,{position:L({},e),owner:"player",turnsLeft:5}]))}buyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy weapon without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?me(L({},s),{hasWeapon:!0}):s)))}buyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy armor without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?me(L({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[Forge] Player unit equipped Armor (+20 Shield HP)."))}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}aiBuyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy armor without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?me(L({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[AI] AI unit equipped Heavy Armor (+20 Shield HP)."))}aiBuyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy weapon without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?me(L({},s),{hasWeapon:!0}):s)),this.appendLog("[AI] AI unit forged a Weapon (+20 ATK, +10 hit vs higher tier)."))}manageInfrastructure(){let e=this.aiForgesSignal().length+this.forgeSitesSignal().filter(u=>u.owner==="ai").length;if(e>=2)return;let t=this.aiWoodSignal(),i=this.aiIronSignal(),r=this.aiIronSignal();if(e===0){if(t<40||i<20)return}else if(e<2&&(r<=50||t<40||i<20))return;let o=this.getBasePosition("ai"),s=[];for(let u=-2;u<=2;u++)for(let d=-2;d<=2;d++){let h=o.x+u,p=o.y+d;this.inBounds(h,p)&&(h===o.x&&p===o.y||Math.max(Math.abs(u),Math.abs(d))>2||this.getUnitAt(h,p)||this.isForest(h,p)||this.isMine(h,p)||this.isForgeSite(h,p)||this.isForge(h,p)||s.push({x:h,y:p}))}if(s.length===0)return;let a=Math.floor(Math.random()*s.length),l=s[a];this.aiWoodSignal.update(u=>u-40),this.aiIronSignal.update(u=>u-20),this.forgeSitesSignal.update(u=>[...u,{position:L({},l),owner:"ai",turnsLeft:5}]),this.appendLog(`[AI] Constructing a Forge at (${l.x},${l.y}).`)}seekUpgrades(e,t){if(e.owner!=="ai")return{type:"none"};if(e.tier<2)return{type:"none"};if(e.hasArmor&&e.hasWeapon||this.aiIronSignal()<20)return{type:"none"};let i=this.aiForgesSignal();if(i.length===0)return{type:"none"};let r=this.getMergePartnerForUnit(e,t),o=this.aiIronSignal(),s=o>=100;if(s)this.appendLog(`[AI Wealth Override] T${e.tier} at (${e.position.x},${e.position.y}) bypassing normal checks (iron: ${o})`);else if(o<40){let h=this.computeHighestTierNeedingUpgrade();if(h>0&&e.tier<h)return{type:"none"}}if(!s&&r){let h=!e.hasWeapon&&r.hasWeapon,p=!e.hasArmor&&r.hasArmor;if(h||p){let g=h&&p?"Weapon & Armor":h?"Weapon":"Armor";return this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored ${g} purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) already has it).`),{type:"none"}}}let a=i.reduce((h,p)=>{let g=Math.max(Math.abs(p.x-e.position.x),Math.abs(p.y-e.position.y)),w=Math.max(Math.abs(h.x-e.position.x),Math.abs(h.y-e.position.y));return g<w?p:h},i[0]),u=this.ignoreForgeUntilTurnSignal().get(e.id)??0;if(this.turnSignal()<=u)return{type:"none"};if(e.position.x===a.x&&e.position.y===a.y){let h=this.aiIronSignal();if(r){let p=!1;return!r.hasArmor&&!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal(),p=!0),!r.hasWeapon&&!e.hasWeapon&&h>=20&&(this.aiBuyWeapon(e.id),p=!0),!p&&r.hasArmor&&r.hasWeapon&&this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) fully equipped).`),{type:"none"}}else return!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal()),!e.hasWeapon&&h>=20&&this.aiBuyWeapon(e.id),{type:"none"}}let d=this.getNextStepTowards(e,a,t);return d?{type:"move",target:d}:{type:"none"}}seekUpgradesFor(e,t,i){if(t.owner!==e)return{type:"none"};if(t.tier<2)return{type:"none"};let r=this.getIron(e);if(t.hasArmor&&t.hasWeapon||r<20)return{type:"none"};let o=this.getForges(e);if(o.length===0)return{type:"none"};let s=e==="ai"?this.getMergePartnerForUnit(t,i):this.getMergePartnerForUnit(t,i),a=this.getIron(e),l=e==="ai"&&a>=100;if(l)this.appendLog(`[AI Wealth Override] T${t.tier} at (${t.position.x},${t.position.y}) bypassing normal checks (iron: ${a})`);else if(a<40){let g=this.computeHighestTierNeedingUpgrade();if(g>0&&t.tier<g)return{type:"none"}}if(!l&&s){let g=!t.hasWeapon&&s.hasWeapon,w=!t.hasArmor&&s.hasArmor;if(g||w)return this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored ${g&&w?"Weapon & Armor":g?"Weapon":"Armor"} purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) already has it).`),{type:"none"}}let u=o.reduce((g,w)=>{let S=Math.max(Math.abs(w.x-t.position.x),Math.abs(w.y-t.position.y)),P=Math.max(Math.abs(g.x-t.position.x),Math.abs(g.y-t.position.y));return S<P?w:g},o[0]),h=this.ignoreForgeUntilTurnSignal().get(t.id)??0;if(this.turnSignal()<=h)return{type:"none"};if(t.position.x===u.x&&t.position.y===u.y){let g=this.getIron(e);if(s){let w=!1;return!s.hasArmor&&!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e),w=!0),!s.hasWeapon&&!t.hasWeapon&&g>=20&&(this.buyWeaponGeneric(e,t.id),w=!0),!w&&s.hasArmor&&s.hasWeapon&&this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) fully equipped).`),{type:"none"}}else return!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e)),!t.hasWeapon&&g>=20&&this.buyWeaponGeneric(e,t.id),{type:"none"}}let p=this.getNextStepTowards(t,u,i,void 0);return p?{type:"move",target:p}:{type:"none"}}async executeBotTurn(e){if(this.activeSideSignal()!==e||this.gameStatus()!=="playing")return;let t=e==="ai"?"player":"ai",i=this.getBasePosition(t),r=this.getBasePosition("player"),o=this.getBasePosition("ai"),s=this.forestsSignal().length+this.minesSignal().length,a=this.unitsSignal().filter(p=>p.owner===t&&(this.isForest(p.position.x,p.position.y)||this.isMine(p.position.x,p.position.y)));if((s>0?a.length/s:0)>.5){let p=new Map,g=this.unitsSignal().filter(P=>P.owner===e&&!P.hasActed),w=new Set,S=a.slice().sort((P,U)=>U.tier-P.tier);for(let P of S){let U=Math.min(4,P.tier+1),ie=g.filter(xe=>xe.tier===U&&!w.has(xe.id)).sort((xe,De)=>{let Ie=Math.max(Math.abs(xe.position.x-P.position.x),Math.abs(xe.position.y-P.position.y)),k=Math.max(Math.abs(De.position.x-P.position.x),Math.abs(De.position.y-P.position.y));return Ie-k});if(ie.length>0){let xe=ie[0];p.set(xe.id,{target:L({},P.position),type:"hunt"}),w.add(xe.id);continue}let Se=g.filter(xe=>xe.tier===P.tier&&!w.has(xe.id));for(let xe of Se){let De=this.calculateValidMoves(xe),Ie=this.unitsSignal().find(k=>k.owner===e&&k.tier===xe.tier&&(k.position.x!==xe.position.x||k.position.y!==xe.position.y)&&De.some(I=>I.x===k.position.x&&I.y===k.position.y));if(Ie){p.set(xe.id,{target:L({},Ie.position),type:"merge"}),w.add(xe.id);break}}}e==="ai"?this.reclamationGoalsSignal.set(p):this.reclamationGoalsSignal.set(p)}else this.reclamationGoalsSignal.set(new Map);let d=this.unitsSignal().filter(p=>p.owner===e&&!p.hasActed),h={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(p=>p.owner===t&&p.tier>=3)};for(let p of d){let g=null,w=this.calculateValidMoves(p),S=this.getForges(e),P=this.unitsSignal().filter(Ie=>Ie.owner===t),U=[];for(let Ie of S)for(let k of P)Math.max(Math.abs(k.position.x-Ie.x),Math.abs(k.position.y-Ie.y))<=3&&U.push(k);if(U.length>0){let Ie=U.reduce((I,N)=>{let D=Math.abs(I.position.x-p.position.x)+Math.abs(I.position.y-p.position.y);return Math.abs(N.position.x-p.position.x)+Math.abs(N.position.y-p.position.y)<D?N:I});if(w.some(I=>I.x===Ie.position.x&&I.y===Ie.position.y))g={type:"attack",target:Ie.position,reason:"Defense: Guard Forge"};else{let I=this.getNextStepTowards(p,Ie.position,w);I&&(g=this.getWallBetween(p.position.x,p.position.y,I.x,I.y)?{type:"wall_attack",target:I,reason:"Defense: Breach to Forge"}:{type:"move",target:I,reason:"Defense: Approach Forge Threat"})}}if(!g&&p.tier>=2&&(!p.hasArmor||!p.hasWeapon)){let Ie=this.seekUpgradesFor(e,p,w);Ie.type==="move"&&Ie.target&&(g={type:"move",target:Ie.target,reason:"Upgrade: Move to Forge"})}let ie=this.computeSideEffectivePower(e),Se=this.computeSideEffectivePower(t),De=Se>0&&ie>Se*1.2&&!this.isForest(p.position.x,p.position.y)&&parseInt(p.id.slice(-1),16)%2===0;if(!g&&De){let Ie=this.getBasePosition(t);if(Math.max(Math.abs(Ie.x-p.position.x),Math.abs(Ie.y-p.position.y))<=1){let I=this.findCombatTarget(p,h,w);I&&(g={type:"attack",target:I,reason:"Siege: Engage Enemy"})}else{let I=this.getNextStepTowards(p,Ie,w,{noCohesion:!0});I&&(g={type:"move",target:I,reason:"Siege: Advance"})}}if(!g){let Ie=this.findCombatTarget(p,h,w);Ie&&(g={type:"attack",target:Ie,reason:"Combat: Engage Enemy"})}if(!g&&this.getWood(e)>=10&&this.getNeighbors(p.position).some(I=>this.isForest(I.x,I.y)&&this.getUnitAt(I.x,I.y)?.owner===e)){let I=this.findDefensiveWallTarget(p);I&&(g={type:"build_wall",target:I,reason:"Defense: Fortify Perimeter"})}if(!g){let Ie=t==="ai"?o:r,k=this.findFallbackMove(p,w,Ie);k&&(g={type:"move",target:k,reason:"Fallback: Advance on Enemy"})}g?g.type==="build_wall"?e==="ai"?this.aiBuildWallBetween(p.position,g.target):this.buildWallBetween(p.position,g.target):this.executeMove(p,g.target):this.unitsSignal.update(Ie=>Ie.map(k=>k.id===p.id?me(L({},k),{hasActed:!0}):k)),await new Promise(Ie=>setTimeout(Ie,60))}e==="player"?this.endTurn():this.endTurn()}playerAutoStep(){if(!this.isPlayerTurn()||this.gameStatus()!=="playing")return!1;let e="player",t="ai",i=this.unitsSignal().find(a=>a.owner===e&&!a.hasActed);if(!i)return!1;let r=this.calculateValidMoves(i),o=this.seekUpgradesFor(e,i,r),s=null;if(o.type==="move"&&o.target&&(s={type:"move",target:o.target,reason:"Upgrade: Move to Forge"}),!s){let a=this.isForest(i.position.x,i.position.y),l=this.isMine(i.position.x,i.position.y),u=this.totalWarMode();if((a||l)&&!u&&!this.getNeighbors(i.position).some(p=>{let g=this.getUnitAt(p.x,p.y);return g&&g.owner===t}))return this.unitsSignal.update(p=>p.map(g=>g.id===i.id?me(L({},g),{hasActed:!0}):g)),!0}if(!s){let a=this.findPlayerResourceTarget(i);if(a){let l=`${a.x},${a.y}`,u=new Set(this.playerClaimedTargetsSignal());u.add(l),this.playerClaimedTargetsSignal.set(u);let d=this.bfsPath(i.position,a,{respectWalls:!0,avoidFriendlyUnits:!0});if(d||(d=this.bfsPath(i.position,a,{avoidFriendlyUnits:!0})),d&&d.length>1){let h=d[1];this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?s={type:"wall_attack",target:h,reason:"Resource: Breach to Capture"}:r.some(g=>g.x===h.x&&g.y===h.y)&&(s={type:"move",target:h,reason:"Resource: Move to Capture"})}else{let h=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});h&&(s=this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?{type:"wall_attack",target:h,reason:"Resource: Breach"}:{type:"move",target:h,reason:"Resource: Advance"})}}}if(!s){let a={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(u=>u.owner===t&&u.tier>=3)},l=this.findCombatTarget(i,a,r);l&&(s={type:"attack",target:l,reason:"Combat: Engage Enemy"})}if(!s){let a=this.getBasePosition(t),l=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});l&&(s={type:"move",target:l,reason:"Advance"})}return s?(s.type==="build_wall"?this.buildWallBetween(i.position,s.target):s.type==="wall_attack"?this.attackOrDestroyWallBetween(i.position,s.target):this.executeMove(i,s.target),!0):(this.unitsSignal.update(a=>a.map(l=>l.id===i.id?me(L({},l),{hasActed:!0}):l)),!1)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10)return;if(!this.canBuildWallBetween(e,t)){if(this.isEdgeOnCooldown(e,t)){let a=this.edgeCooldownRemaining(e,t);this.appendLog(`[Build] This area is too unstable to rebuild yet (CD: ${a} turns).`)}return}let r=this.getBestAdjacentPlayerUnit(e,t);if(!r||r.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.updateWallFormations(),this.resourcesSignal.update(a=>({wood:a.wood-10,iron:a.iron})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(l=>l.id===r.id?me(L({},l),{hasActed:!0}):l))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20,iron:t.iron})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(i=>({wood:i.wood-t*20,iron:i.iron})),this.reservePointsSignal.update(i=>({player:i.player+t,ai:i.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let i=[];for(let r=-2;r<=2;r++)for(let o=-2;o<=2;o++){if(r===0&&o===0)continue;let s=t.x+r,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(r),Math.abs(o))>2)continue;this.getUnitAt(s,a)||i.push({x:s,y:a})}this.deployTargetsSignal.set(i),this.baseDeployActiveSignal.set(!0)}startSandboxSpawn(e,t){this.settings.customMode()&&this.sandboxSpawnPendingSignal.set({owner:e,tier:t})}cancelSandboxSpawn(){this.sandboxSpawnPendingSignal.set(null)}spawnSandboxAt(e){let t=this.sandboxSpawnPendingSignal();if(!t||!this.settings.customMode()||this.getUnitAt(e.x,e.y))return;let i=this.getPointsForTierLevel(t.tier,1),r={id:crypto.randomUUID(),position:L({},e),level:1,tier:t.tier,points:i,owner:t.owner,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};this.unitsSignal.update(o=>[...o,r]),this.sandboxSpawnPendingSignal.set(null),this.recomputeVisibility()}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,l=e.y+s;this.inBounds(a,l)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,l)||t.push({x:a,y:l}))}let i=this.reservePointsSignal().player,r=[];for(let o of t){if(i<=0)break;let s=this.economy.getHighestAffordableCost(i);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(l=>[...l,{id:crypto.randomUUID(),position:L({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}]),i-=s,r.push(o)}r.length>0&&(this.reservePointsSignal.update(o=>({player:i,ai:o.ai})),this.recomputeVisibility())}botEconomyPhase(e){if(this.gameStatus()!=="playing"||e!=="player"||!this.isPlayerTurn())return!1;let t=!1;{let r=this.baseHealthSignal().player<50?20:50,o=0;for(;this.resourcesSignal().wood>=r+20;)this.convertWoodToReserve(),o+=20;o>0&&(this.appendLog(`[Auto-Engage] Player converted ${o} wood to reserves.`),t=!0)}try{let i=this.forgesSignal().length,r=this.forgeSitesSignal().length,o=i+r,s=this.resourcesSignal();if(o<2&&s.iron>=20&&s.wood>=40){let a=this.getBasePosition("player"),l=2,u=!1;for(let d=-l;d<=l&&!u;d++)for(let h=-l;h<=l&&!u;h++){if(d===0&&h===0)continue;let p=a.x+d,g=a.y+h;this.inBounds(p,g)&&(Math.max(Math.abs(d),Math.abs(h))>l||this.canBuildForgeAt(p,g)&&(this.appendLog(`[Auto-Engage] Player building Forge at (${p},${g}).`),this.buildForgeAt({x:p,y:g}),t=!0,u=!0))}}}catch{}if(!this.wallBuiltThisTurnSignal()&&this.resourcesSignal().wood>=10){let r=this.unitsSignal().filter(o=>o.owner==="player"&&this.isForest(o.position.x,o.position.y));for(let o of r){let s=this.findDefensiveWallTargetForOwner(o,"player");if(s){this.buildWallBetween(o.position,s),t=!0;break}}}{let i=this.unitsSignal().length;this.autoDeployFromReserves(),this.unitsSignal().length>i&&(t=!0)}return t}isDeployTarget(e,t){return this.deployTargetsSignal().some(i=>i.x===e&&i.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let i=this.economy.getHighestAffordableCost(t);if(i<=0)return;let r=this.calculateTierAndLevel(i);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:L({},e),level:r.level,tier:r.tier,points:i,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-i,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${r.tier}(L${r.level}) at (${e.x},${e.y}) costing ${i} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[i,r]=this.sortEdgeEndpoints(e,t);return`${i.x},${i.y}|${r.x},${r.y}`}registerWallDestroyedEdge(e,t){let i=this.edgeKey(e,t),r=new Map(this.wallCooldownSignal());r.set(i,this.turnSignal()),this.wallCooldownSignal.set(r)}isEdgeOnCooldown(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);return r===void 0?!1:5-(this.turnSignal()-r)>0}edgeCooldownRemaining(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);if(r===void 0)return 0;let o=5-(this.turnSignal()-r);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,i=!1){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(r.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(r.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(r.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;{let w=t.x-e.x,S=t.y-e.y,P=Math.abs(w)>=Math.abs(S),U=Math.sign(P?w:S),ie=this.wallThicknessPx+2,Se=this.tileSizePx+ie,xe=Math.round(Se*.35),De=P?U*xe:0,Ie=P?0:U*xe,k=new Set(this.attackingUnitsSignal());k.add(s.id),this.attackingUnitsSignal.set(k),this.attackerNudgeSignal.set({id:s.id,dx:De,dy:Ie}),setTimeout(()=>{this.attackerNudgeSignal.set({id:s.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let I=new Set(this.attackingUnitsSignal());I.delete(s.id),this.attackingUnitsSignal.set(I)},200)}let a=this.combat.getWallHitAmount(s.tier),[l,u]=this.sortEdgeEndpoints(e,t),d=r.maxHealth??100,h=Math.max(0,r.health-a);this.wallsSignal.update(w=>w.map(S=>S.id===r.id?me(L({},S),{health:Math.max(0,S.health-a)}):S).filter(S=>S.health>0)),h<=0?(this.registerWallDestroyedEdge(l,u),this.updateWallFormations()):this.updateWallFormations(),this.shakenWallIdSignal.set(r.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let p=o==="player"?"Player":"AI",g=r.owner==="neutral"?"Neutral":r.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${s.tier} Unit attacked ${g} Wall. Damage: ${a}. Wall HP: ${h}/${d}.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(w=>w.map(S=>S.id===s.id?me(L({},S),{hasActed:!0}):S)),o==="player"&&this.selectNextAvailableUnit()}destroyOwnWallBetween(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i||i.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==i.id));let[r,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(r,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`),this.updateWallFormations()}canDestroyOwnWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||i.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!i||i.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||!this.canActThisTurn()?!1:i.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(i=>i.owner==="player"&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let i=this.getAdjacentPlayerUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="ai"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentAiUnit(e,t){let i=this.getAdjacentAiUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<50)return;let i=this.getBestAdjacentAiUnit(e,t);if(!i||i.hasActed||!this.unitsSignal().filter(l=>l.owner==="player").some(l=>{let u=Math.max(Math.abs(l.position.x-e.x),Math.abs(l.position.y-e.y)),d=Math.max(Math.abs(l.position.x-t.x),Math.abs(l.position.y-t.y));return u<=2||d<=2?l.tier>=i.tier:!1})||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let[s,a]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(l=>[...l,{id:crypto.randomUUID(),tile1:{x:s.x,y:s.y},tile2:{x:a.x,y:a.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(l=>l-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(l=>l.map(u=>u.id===i.id?me(L({},u),{hasActed:!0}):u)),this.updateWallFormations()}isBaseProtectionEdge(e,t){let i=this.getBasePosition("ai"),r=o=>Math.max(Math.abs(o.x-i.x),Math.abs(o.y-i.y))<=1||o.x===i.x&&o.y===i.y;return r(e)||r(t)}wouldCageElite(e,t){let i=(s,a,l,u)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:l,y:u}),h=this.sortEdgeEndpoints(e,t);return d[0].x===h[0].x&&d[0].y===h[0].y&&d[1].x===h[1].x&&d[1].y===h[1].y},r=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||i(s.x,s.y,a.x,a.y));{let l=Math.sign(a.x-s.x),u=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+l,s.y),h=this.getWallBetween(s.x,s.y,s.x,s.y+u),p=this.getWallBetween(a.x-l,a.y,a.x,a.y),g=this.getWallBetween(a.x,a.y-u,a.x,a.y);return!!(d||h||p||g||i(s.x,s.y,s.x+l,s.y)||i(s.x,s.y,s.x,s.y+u)||i(a.x-l,a.y,a.x,a.y)||i(a.x,a.y-u,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(l=>{let u={x:s.position.x+l.x,y:s.position.y+l.y};return this.inBounds(u.x,u.y)?!r(s.position,u):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(r=>r.owner==="ai"),t=this.unitsSignal().filter(r=>r.owner==="player"),i=this.getBasePosition("ai");for(let r of e){if(!this.isForest(r.position.x,r.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y))<=2);for(let s of o){let a=r.level??this.calculateTierAndLevel(r.points).level,l=s.level??this.calculateTierAndLevel(s.points).level,u=Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y)),d=Math.sign(s.position.x-r.position.x),h=Math.sign(s.position.y-r.position.y);if(Math.abs(d)+Math.abs(h)===2)continue;let p=u===1?{x:r.position.x+d,y:r.position.y+h}:{x:r.position.x+Math.sign(s.position.x-r.position.x),y:r.position.y+Math.sign(s.position.y-r.position.y)};if(!this.inBounds(p.x,p.y))continue;let g=Math.sign(i.x-r.position.x),w=Math.sign(i.y-r.position.y);if((p.x-r.position.x)*g+(p.y-r.position.y)*w>0)continue;let P=r.position,U=p;if(!this.getWallBetween(P.x,P.y,U.x,U.y)&&(l>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(P,U),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${P.x},${P.y})-(${U.x},${U.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let i=e.x<=t.x,r=e.y<=t.y;return i&&r?0:!i&&r?1:i&&!r?2:3}placeNeutralWalls(){let e=(i,r)=>{if(!this.areAdjacent(i,r)||!this.inBounds(i.x,i.y)||!this.inBounds(r.x,r.y)||this.getWallBetween(i.x,i.y,r.x,r.y))return;let[o,s]=this.sortEdgeEndpoints(i,r);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}]),this.updateWallFormations()},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let i of t){let r=[{x:i.x+1,y:i.y},{x:i.x-1,y:i.y},{x:i.x,y:i.y+1},{x:i.x,y:i.y-1}];for(let o of r)this.inBounds(o.x,o.y)&&e(i,o)}for(let i of this.forestsSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}for(let i of this.minesSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}}static \u0275fac=function(t){return new(t||n)(Re(Cl),Re(Eg),Re(bg),Re(Kt),Re(wg),Re(xg),Re(Sg),Re(Ur),Re(sc))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};function uG(n,e){n&1&&(Y(),B(0,"polygon",127))}function dG(n,e){n&1&&(Y(),B(0,"polygon",127))}function hG(n,e){n&1&&(Y(),C(0,"g"),B(1,"polygon",213),A())}function fG(n,e){n&1&&(Y(),B(0,"polygon",127))}function pG(n,e){n&1&&(Y(),C(0,"g"),B(1,"polygon",213),A())}function gG(n,e){n&1&&(Y(),C(0,"g"),B(1,"polygon",214)(2,"polygon",215)(3,"polygon",216),A())}var t0=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(Ee(ni),Ee(Kt))};static \u0275cmp=Ot({type:n,selectors:[["app-game-rules"]],decls:694,vars:76,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","flex-col","justify-between"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"bg-gray-800/60","border","border-blue-500/30","rounded-lg","p-4","shadow-[0_0_15px_rgba(59,130,246,0.1)]"],[1,"text-lg","font-semibold","mb-3","flex","items-center","gap-2"],[1,"text-blue-400"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[45px]","text-center"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[60px]","text-center"],[1,"text-xs","text-gray-400","text-right","italic"],[1,"flex","flex-col","items-center","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","text-white"],[1,"flex","items-center","justify-between","gap-4","border-t","border-white/5","pt-3"],[1,"px-4","py-1","bg-blue-600","border-b-4","border-blue-800","rounded","text-xs","font-mono","text-white","font-bold"],[1,"text-xs","text-blue-300","font-semibold","uppercase","tracking-wider"],[1,"mt-4","p-2","bg-blue-500/10","border","border-blue-500/20","rounded","text-[10px]","text-blue-200/70","leading-tight"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"bg-gray-800/60","border","border-gray-700","rounded-xl","p-6","md:col-span-2","shadow-2xl","backdrop-blur-sm"],[1,"text-xs","uppercase","tracking-widest","text-gray-500","font-bold","mb-6","flex","items-center","gap-2"],[1,"w-8","h-[1px]","bg-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8","items-start"],[1,"space-y-6"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-gray-300","text-sm"],[1,"text-orange-400","font-bold"],[1,"text-blue-400","font-bold"],[1,"p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-xs","text-gray-400","leading-relaxed"],[1,"text-white","font-semibold"],[1,"lg:col-span-2","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-blue-500/50","transition-all","duration-300","flex","items-center","gap-4"],[1,"w-20","h-20","shrink-0"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],["cx","50","cy","50","r","32"],["cx","50","cy","50","r","31","fill","none","stroke","rgba(255,255,255,0.2)","stroke-width","2"],["x","50","y","62","text-anchor","middle","font-size","32","font-weight","800","fill","white"],["transform","translate(18, 5) scale(0.8)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","#60a5fa"],[1,"flex","flex-col"],[1,"text-blue-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"text-gray-300","text-sm","leading-tight"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-red-500/50","transition-all","duration-300","flex","items-center","gap-4"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],["transform","rotate(-45 50 50) translate(40, 10) scale(1.2)"],["x","5","y","0","width","2","height","10","fill","#f87171"],["x","3","y","10","width","6","height","2","fill","#991b1b"],[1,"text-red-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"p-4","bg-gray-800/40","rounded-lg","border","border-gray-700/30"],[1,"text-[10px]","uppercase","tracking-wider","text-gray-500","font-bold","mb-3"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"flex","justify-between","border-b","border-gray-700/50","pb-1"],[1,"text-gray-500"],[1,"text-white"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","#60a5fa","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],[1,"text-lg","font-semibold","mb-1"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","3"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","4"],[1,"mover","triangle","t1-path"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"flex","items-center","gap-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","theme-test-player"],[1,"flex","flex-col","flex-center"],[1,"flex","flex-center","gap-2"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-80"],["points","50,16 86,78 14,78","fill","var(--u-fill)"],["x","49","y","66","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2"],["viewBox","0 0 100 100"],["id","base-circle"],["id","eye"],["id","scan-lvl2"],["id","radar-lvl3"],["id","field-lvl4"],["cx","50","cy","50","r","14","fill","#94a3b8"],["cx","50","cy","50","r","4","fill","#e5e7eb"],["cx","50","cy","50","r","20","fill","none","stroke","#cbd5f5","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","#e5e7eb","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","#f8fafc"],["cx","50","cy","50","r","30","fill","none","stroke","#f1f5f9","stroke-width","1","opacity","0.4"],[1,"unit-svg-wrapper","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-70"],["cx","50","cy","55","r","6","fill","var(--u-core)"],["points","50,5 55,15 45,15","fill","var(--u-stroke)"],["points","92,82 82,78 86,70","fill","var(--u-stroke)"],["points","8,82 18,78 14,70","fill","var(--u-stroke)"],["points","50,2 95,85 5,85","fill","none","stroke","var(--u-core)","stroke-width","2"],["points","50,48 56,52 56,60 50,64 44,60 44,52","fill","var(--u-light)"],["points","50,-2 102,88 -2,88","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","opacity","0.6"],["points","50,-5 54,8 46,8","fill","var(--u-light)"],["points","92,82 88,70 80,78","fill","var(--u-light)"],["points","8,82 20,78 12,70","fill","var(--u-light)"],["id","base-shape"],["id","core"],["id","armor-lvl2"],["id","armor-lvl3"],["id","fortress-lvl4"],["id","fx"],["x","20","y","20","width","60","height","60","rx","6","fill","#2563eb"],["x","46","y","46","width","8","height","8","fill","#93c5fd"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","#60a5fa","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","#93c5fd","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","#bfdbfe"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","#60a5fa","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","#bfdbfe"],["x","78","y","12","width","10","height","10","fill","#bfdbfe"],["x","12","y","78","width","10","height","10","fill","#bfdbfe"],["x","78","y","78","width","10","height","10","fill","#bfdbfe"],["id","base-hex"],["id","links-lvl2"],["id","network-lvl3"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","#10b981"],["cx","50","cy","50","r","4","fill","#6ee7b7"],["x1","50","y1","20","x2","50","y2","40","stroke","#6ee7b7","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","#6ee7b7","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","#6ee7b7","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","#a7f3d0","stroke-width","2"],["cx","50","cy","20","r","3","fill","#34d399"],["cx","80","cy","50","r","3","fill","#34d399"],["cx","50","cy","80","r","3","fill","#34d399"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","#6ee7b7","stroke-width","1.5","stroke-dasharray","4 4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","unit-svg-wrapper-game_rules"],[1,"flex","items-center","gap-6","theme-test-player"],["viewBox","0 0 100 100",1,"w-full","h-full"],["cx","50","cy","50","r","20","fill","var(--u-fill)"],["cx","50","cy","50","r","4","fill","var(--u-light)"],["cx","50","cy","50","r","26","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","var(--u-light)","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","var(--u-light)"],["cx","50","cy","50","r","34","fill","none","stroke","var(--u-light)","stroke-width","1","opacity","0.4"],[1,"flex","items-center","gap-6","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-75"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-110"],["x","20","y","20","width","60","height","60","rx","6","fill","var(--u-dark)"],["x","46","y","46","width","8","height","8","fill","var(--u-core)"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","var(--u-light)"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","var(--u-light)"],["x","78","y","12","width","10","height","10","fill","var(--u-light)"],["x","12","y","78","width","10","height","10","fill","var(--u-light)"],["x","78","y","78","width","10","height","10","fill","var(--u-light)"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","var(--u-emerald)"],["cx","50","cy","50","r","4","fill","var(--u-emerald-stroke)"],["x1","50","y1","20","x2","50","y2","40","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","var(--u-emerald-stroke)","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","2"],["cx","50","cy","20","r","3","fill","var(--u-emerald-stroke)"],["cx","80","cy","50","r","3","fill","var(--u-emerald-stroke)"],["cx","50","cy","80","r","3","fill","var(--u-emerald-stroke)"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 56,10 44,10","fill","var(--u-light)"],["points","99,87 92,74 84,87","fill","var(--u-light)"],["points","1,87 15,87 8,74","fill","var(--u-light)"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),v(5),A(),C(6,"h3",5),v(7),A()(),C(8,"button",6),Dt("click",function(){return i.engine.closeRules()}),v(9," \u2716 "),A()(),C(10,"div",7)(11,"div",8)(12,"div",9),v(13),A(),C(14,"div",10)(15,"div",11)(16,"div",12),v(17,"\u{1F333}"),A(),C(18,"div")(19,"div",13),v(20),A(),C(21,"div",14),v(22),A()()(),C(23,"div",11)(24,"div",12),v(25,"\u{1F3F0}"),A(),C(26,"div")(27,"div",13),v(28),A(),C(29,"div",14),v(30),A()()()()(),C(31,"div",15)(32,"div",16)(33,"div",9),v(34),A(),C(35,"div",17)(36,"div",18)(37,"div",19),v(38," 1 "),A(),C(39,"div",20),v(40,"1\u20134"),A()(),C(41,"div",18)(42,"div",21),v(43," 5 "),A(),C(44,"div",20),v(45,"5\u201320"),A()(),C(46,"div",18)(47,"div",21),v(48,"25"),A(),C(49,"div",20),v(50,"25\u2013100"),A()(),C(51,"div",18)(52,"div",22)(53,"span",23),v(54,"125"),A()(),C(55,"div",20),v(56,"125\u2013500"),A()()()(),C(57,"div",16)(58,"div",24),v(59),A(),C(60,"div",25)(61,"div",26)(62,"div",27),v(63,"2"),A(),C(64,"div",28),v(65,"2"),A(),C(66,"div",29),v(67,"1"),A()()()()(),C(68,"div",30)(69,"div",31)(70,"span",32),v(71,"\u2328\uFE0F"),A(),v(72),A(),C(73,"div",33)(74,"div",34)(75,"div",35)(76,"kbd",36),v(77," Tab "),A(),C(78,"kbd",37),v(79," Space "),A()(),C(80,"div",38),v(81),A()(),C(82,"div",34)(83,"div",39)(84,"kbd",40),v(85,"\u2191"),A(),C(86,"div",35)(87,"kbd",40),v(88,"\u2190"),A(),C(89,"kbd",40),v(90,"\u2193"),A(),C(91,"kbd",40),v(92,"\u2192"),A()()(),C(93,"div",38),v(94),A()(),C(95,"div",41)(96,"kbd",42),v(97," Enter "),A(),C(98,"div",43),v(99),A()()(),C(100,"div",44)(101,"strong"),v(102,"TIP:"),A(),v(103),A()(),C(104,"div",8)(105,"div",9),v(106),A(),C(107,"div",45)(108,"div")(109,"div",46),v(110),A(),C(111,"div",47)(112,"div",48),v(113,"1"),A(),C(114,"div",49),v(115,"1"),A()(),C(116,"div",50),v(117),A()(),C(118,"div")(119,"div",46),v(120),A(),C(121,"div",47)(122,"div",48),v(123,"4"),A(),C(124,"div",51),v(125,"1"),A(),C(126,"span",52),v(127,"CRIT!"),A()(),C(128,"div",50),v(129),A()(),C(130,"div")(131,"div",46),v(132),A(),C(133,"div",47)(134,"div",48),v(135,"1"),A(),C(136,"div",53),v(137,"4"),A(),C(138,"span",54),v(139,"MISS!"),A()(),C(140,"div",50),v(141),A()()()(),C(142,"div",55)(143,"div",56),B(144,"span",57),v(145),A(),C(146,"div",58)(147,"div",59)(148,"div",60)(149,"div",61)(150,"span",62),v(151),A(),C(152,"span",63),v(153,"20%"),A()(),C(154,"div",61)(155,"span",62),v(156),A(),C(157,"span",64),v(158,"20%"),A()(),C(159,"div",65)(160,"p",66)(161,"span",67),v(162,"50%"),A(),v(163),A()()()(),C(164,"div",68)(165,"div",69)(166,"div",70),Y(),C(167,"svg",71),B(168,"circle",72)(169,"circle",73),C(170,"text",74),v(171,"1"),A(),C(172,"g",75),B(173,"path",76),A()()(),Ne(),C(174,"div",77)(175,"span",78),v(176,"+20 HP Bonus"),A(),C(177,"p",79),v(178),A()()(),C(179,"div",80)(180,"div",70),Y(),C(181,"svg",81),B(182,"circle",72)(183,"circle",73),C(184,"text",74),v(185,"1"),A(),C(186,"g",82),B(187,"rect",83)(188,"rect",84),A()()(),Ne(),C(189,"div",77)(190,"span",85),v(191,"+20 DMG Bonus"),A(),C(192,"p",79),v(193),A()()()(),C(194,"div",68)(195,"div",86)(196,"p",87),v(197),A(),C(198,"div",88)(199,"div",89)(200,"span",90),v(201,"T1"),A(),C(202,"span",91),v(203,"1"),A()(),C(204,"div",89)(205,"span",90),v(206,"T2"),A(),C(207,"span",91),v(208,"2"),A()(),C(209,"div",89)(210,"span",90),v(211,"T3"),A(),C(212,"span",91),v(213,"4"),A()(),C(214,"div",89)(215,"span",90),v(216,"T4"),A(),C(217,"span",91),v(218,"8"),A()()()(),C(219,"div",80)(220,"div",70),Y(),C(221,"svg",81),B(222,"circle",72)(223,"circle",73),C(224,"text",74),v(225,"1"),A(),C(226,"g"),B(227,"path",92)(228,"path",93),A()()(),Ne(),C(229,"div",77)(230,"p",79),v(231),A()()()()()(),C(232,"div",16)(233,"div",94),v(234),A(),C(235,"div",95)(236,"div")(237,"div",96),v(238),A(),C(239,"div",97),B(240,"div",98)(241,"div",98)(242,"div",98)(243,"div",98)(244,"div",98)(245,"div",98)(246,"div",99)(247,"div",99)(248,"div",98)(249,"div",98)(250,"div",98)(251,"div",98)(252,"div",98)(253,"div",98)(254,"div",98)(255,"div",98)(256,"div",98)(257,"div",98)(258,"div",98)(259,"div",98)(260,"div",98)(261,"div",98)(262,"div",98)(263,"div",98)(264,"div",98),C(265,"div",100),v(266,"2"),A(),B(267,"div",101),C(268,"div",102),v(269,"\u{1F3F0}"),A()()(),C(270,"div")(271,"div",96),v(272),A(),C(273,"div",103),B(274,"div",98)(275,"div",98)(276,"div",98)(277,"div",98)(278,"div",98)(279,"div",98)(280,"div",99)(281,"div",99)(282,"div",99)(283,"div",98)(284,"div",98)(285,"div",98)(286,"div",98)(287,"div",98)(288,"div",98)(289,"div",98)(290,"div",98)(291,"div",98)(292,"div",98)(293,"div",98)(294,"div",98)(295,"div",98)(296,"div",98)(297,"div",98)(298,"div",98),C(299,"div",104),v(300,"3"),A(),B(301,"div",101),C(302,"div",105),v(303,"\u{1F3F0}"),A()()(),C(304,"div")(305,"div",96),v(306),A(),C(307,"div",106),B(308,"div",98)(309,"div",98)(310,"div",98)(311,"div",98)(312,"div",98)(313,"div",98)(314,"div",99)(315,"div",99)(316,"div",99)(317,"div",99)(318,"div",98)(319,"div",98)(320,"div",98)(321,"div",98)(322,"div",98)(323,"div",98)(324,"div",98)(325,"div",98)(326,"div",98)(327,"div",98)(328,"div",98)(329,"div",98)(330,"div",98)(331,"div",98)(332,"div",98),C(333,"div",107),v(334,"4"),A(),B(335,"div",101),C(336,"div",102),v(337,"\u{1F3F0}"),A()()()()(),C(338,"div",15)(339,"div",16)(340,"div",9),v(341),A(),C(342,"div",17)(343,"div",108)(344,"div",109),v(345,"\u{1F331}"),A(),C(346,"div",110),v(347),A()(),C(348,"div",111),v(349,"\u2192"),A(),C(350,"div",108)(351,"div",109),v(352,"\u{1F33F}"),A(),C(353,"div",110),v(354),A()(),C(355,"div",111),v(356,"\u2192"),A(),C(357,"div",108)(358,"div",109),v(359,"\u{1F333}"),A(),C(360,"div",112),v(361),A()()()(),C(362,"div",16)(363,"div",9),v(364),A(),C(365,"div",113)(366,"div",108)(367,"div",109),v(368,"\u26F0\uFE0F"),A(),C(369,"div",114),v(370),A()(),C(371,"div",111),v(372,"\u2192"),A(),C(373,"div",108)(374,"div",109),v(375,"\u26CF\uFE0F"),A(),C(376,"div",114),v(377),A()(),C(378,"div",111),v(379,"\u2192"),A(),C(380,"div",108)(381,"div",109),v(382,"\u26CF"),A(),C(383,"div",114),v(384),A()(),C(385,"div",111),v(386,"\u2192"),A(),C(387,"div",108)(388,"div",109),v(389,"\u2692"),A(),C(390,"div",114),v(391),A()(),C(392,"div",111),v(393,"\u2192"),A(),C(394,"div",108)(395,"div",109),v(396,"\u{1F9F1}"),A(),C(397,"div",115),v(398),A()()()(),C(399,"div",16)(400,"div",116),v(401),A(),C(402,"div",117)(403,"div",3),B(404,"div",118),C(405,"div",20),v(406),A()(),C(407,"div",3),B(408,"div",119),C(409,"div",20),v(410),A()(),C(411,"div",3),B(412,"div",120),C(413,"div",20),v(414,"Neutral"),A()()()()(),C(415,"div",121)(416,"div",122)(417,"div",9),v(418),A(),C(419,"div",123),Y(),C(420,"svg",124)(421,"g"),B(422,"polygon",125),A(),C(423,"text",126),v(424),A()(),C(425,"svg",124)(426,"g"),B(427,"polygon",125),A(),C(428,"text",126),v(429),A(),J(430,uG,1,0,":svg:polygon",127),A(),C(431,"svg",124)(432,"g"),B(433,"polygon",125),A(),C(434,"text",126),v(435),A(),J(436,dG,1,0,":svg:polygon",127),J(437,hG,2,0,":svg:g"),A(),C(438,"svg",124)(439,"g"),B(440,"polygon",125),A(),C(441,"text",126),v(442),A(),J(443,fG,1,0,":svg:polygon",127),J(444,pG,2,0,":svg:g"),J(445,gG,4,0,":svg:g"),A()()()(),Ne(),C(446,"div",16)(447,"div",9),v(448),A(),C(449,"div",17),Y(),C(450,"svg",128),B(451,"g",129)(452,"g",130)(453,"g",131)(454,"g",132)(455,"g",133),C(456,"g",129),B(457,"circle",134),A(),C(458,"g",130),B(459,"circle",135),A(),C(460,"g",131),B(461,"circle",136),A(),C(462,"g",132),B(463,"line",137)(464,"circle",138),A(),C(465,"g",133),B(466,"circle",139),A()(),Ne(),C(467,"div",140),Y(),C(468,"svg",141)(469,"g"),B(470,"polygon",125),A(),C(471,"g"),B(472,"circle",142),A(),C(473,"g"),B(474,"polygon",143)(475,"polygon",144)(476,"polygon",145),A(),C(477,"g"),B(478,"polygon",146)(479,"polygon",147),A(),C(480,"g"),B(481,"polygon",148)(482,"polygon",149)(483,"polygon",150)(484,"polygon",151),A()()(),C(485,"svg",128),B(486,"g",152)(487,"g",153)(488,"g",154)(489,"g",155)(490,"g",156)(491,"g",157),C(492,"g",152),B(493,"rect",158),A(),C(494,"g",153),B(495,"rect",159),A(),C(496,"g",154),B(497,"rect",160),A(),C(498,"g",155),B(499,"rect",161)(500,"rect",162),A(),C(501,"g",156),B(502,"rect",163)(503,"rect",164)(504,"rect",165)(505,"rect",166)(506,"rect",167),A()(),C(507,"svg",128),B(508,"g",168)(509,"g",153)(510,"g",169)(511,"g",170)(512,"g",133),C(513,"g",168),B(514,"polygon",171),A(),C(515,"g",153),B(516,"circle",172),A(),C(517,"g",169),B(518,"line",173)(519,"line",174)(520,"line",175),A(),C(521,"g",170),B(522,"polygon",176)(523,"circle",177)(524,"circle",178)(525,"circle",179),A(),C(526,"g",133),B(527,"polygon",180),A()()()(),Ne(),C(528,"div",181)(529,"div",9),v(530),A(),C(531,"div",182),Y(),C(532,"svg",183)(533,"g"),B(534,"circle",184),A(),C(535,"g"),B(536,"circle",185),A()(),C(537,"svg",183)(538,"g"),B(539,"circle",184),A(),C(540,"g"),B(541,"circle",185),A(),C(542,"g"),B(543,"circle",186),A()(),C(544,"svg",183)(545,"g"),B(546,"circle",184),A(),C(547,"g"),B(548,"circle",185),A(),C(549,"g"),B(550,"circle",186),A(),C(551,"g"),B(552,"line",187)(553,"circle",188),A()(),C(554,"svg",183)(555,"g"),B(556,"circle",184),A(),C(557,"g"),B(558,"circle",185),A(),C(559,"g"),B(560,"circle",186),A(),C(561,"g"),B(562,"line",187)(563,"circle",188),A(),C(564,"g"),B(565,"circle",189),A()()(),Ne(),C(566,"div",190),Y(),C(567,"svg",191)(568,"g"),B(569,"polygon",125),A(),C(570,"g"),B(571,"circle",142),A()(),C(572,"svg",191)(573,"g"),B(574,"polygon",125),A(),C(575,"g"),B(576,"circle",142),A(),C(577,"g"),B(578,"polygon",143)(579,"polygon",144)(580,"polygon",145),A()(),C(581,"svg",191)(582,"g"),B(583,"polygon",125),A(),C(584,"g"),B(585,"circle",142),A(),C(586,"g"),B(587,"polygon",143)(588,"polygon",144)(589,"polygon",145),A(),C(590,"g"),B(591,"polygon",146)(592,"polygon",147),A()(),C(593,"svg",141)(594,"g"),B(595,"polygon",125),A(),C(596,"g"),B(597,"circle",142),A(),C(598,"g"),B(599,"polygon",143)(600,"polygon",144)(601,"polygon",145),A(),C(602,"g"),B(603,"polygon",146)(604,"polygon",147),A(),C(605,"g"),B(606,"polygon",148)(607,"polygon",149)(608,"polygon",150)(609,"polygon",151),A()()(),Ne(),C(610,"div",182),Y(),C(611,"svg",192)(612,"g"),B(613,"rect",193),A(),C(614,"g"),B(615,"rect",194),A()(),C(616,"svg",192)(617,"g"),B(618,"rect",193),A(),C(619,"g"),B(620,"rect",194),A(),C(621,"g"),B(622,"rect",195),A()(),C(623,"svg",192)(624,"g"),B(625,"rect",193),A(),C(626,"g"),B(627,"rect",194),A(),C(628,"g"),B(629,"rect",195),A(),C(630,"g"),B(631,"rect",196)(632,"rect",197),A()(),C(633,"svg",192)(634,"g"),B(635,"rect",193),A(),C(636,"g"),B(637,"rect",194),A(),C(638,"g"),B(639,"rect",195),A(),C(640,"g"),B(641,"rect",196)(642,"rect",197),A(),C(643,"g"),B(644,"rect",198)(645,"rect",199)(646,"rect",200)(647,"rect",201)(648,"rect",202),A()()(),Ne(),C(649,"div",190),Y(),C(650,"svg",183)(651,"g"),B(652,"polygon",203),A(),C(653,"g"),B(654,"circle",204),A()(),C(655,"svg",183)(656,"g"),B(657,"polygon",203),A(),C(658,"g"),B(659,"circle",204),A(),C(660,"g"),B(661,"line",205)(662,"line",206)(663,"line",207),A()(),C(664,"svg",183)(665,"g"),B(666,"polygon",203),A(),C(667,"g"),B(668,"circle",204),A(),C(669,"g"),B(670,"line",205)(671,"line",206)(672,"line",207),A(),C(673,"g"),B(674,"polygon",208)(675,"circle",209)(676,"circle",210)(677,"circle",211),A()(),C(678,"svg",183)(679,"g"),B(680,"polygon",203),A(),C(681,"g"),B(682,"circle",204),A(),C(683,"g"),B(684,"line",205)(685,"line",206)(686,"line",207),A(),C(687,"g"),B(688,"polygon",208)(689,"circle",209)(690,"circle",210)(691,"circle",211),A(),C(692,"g"),B(693,"polygon",212),A()()()()()()()),t&2&&(_(5),q(i.settings.t("GAME_GUIDE")),_(2),q(i.settings.t("TURN_BASED_STRATEGY")),_(6),q(i.settings.t("VICTORY_CONDITIONS")),_(7),q(i.settings.t("MONOPOLY_LABEL")),_(2),q(i.settings.t("MONOPOLY_DESC")),_(6),q(i.settings.t("ANNIHILATION")),_(2),q(i.settings.t("ANNIHILATION_DESC")),_(4),q(i.settings.t("UNIT_EVOLUTION")),_(8),nt("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),_(17),q(i.settings.t("EVOLUTION_DESC")),_(13),X(" ",i.settings.currentLang()==="uk"?"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0435 \u0443\u043F\u0440\u0430\u0432\u043B\u0456\u043D\u043D\u044F":"Tactical Controls"," "),_(9),X(" ",i.settings.currentLang()==="uk"?"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0438\u0439 \u0432\u0456\u043B\u044C\u043D\u0438\u0439 \u044E\u043D\u0456\u0442":"Cycle through available units"," "),_(13),X(" ",i.settings.currentLang()==="uk"?"\u0420\u0443\u0445 \u0430\u0431\u043E \u0430\u0442\u0430\u043A\u0430 \u0432\u0438\u0431\u0440\u0430\u043D\u0438\u043C \u044E\u043D\u0456\u0442\u043E\u043C":"Move or attack with selected unit"," "),_(5),X(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0445\u0456\u0434":"End player turn"," "),_(4),X(" ",i.settings.currentLang()==="uk"?"\u041D\u0430 \u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043A\u043E\u0436\u043D\u043E\u0433\u043E \u0445\u043E\u0434\u0443 \u0433\u0440\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u0444\u043E\u043A\u0443\u0441\u0443\u0454\u0442\u044C\u0441\u044F \u043D\u0430 \u043C\u043E\u0431\u0456\u043B\u044C\u043D\u043E\u043C\u0443 \u044E\u043D\u0456\u0442\u0456.":"At turn start, the game auto-focuses on your most mobile unit."," "),_(3),q(i.settings.t("COMBAT_DEEP_DIVE")),_(4),q(i.settings.t("SUCCESSFUL_ATTACK")),_(7),q(i.settings.t("SUCCESSFUL_ATTACK_DESC")),_(3),q(i.settings.t("CRITICAL_HIT")),_(9),q(i.settings.t("CRITICAL_HIT_DESC")),_(3),q(i.settings.t("MISS")),_(9),q(i.settings.t("MISS_DESC")),_(4),X(" ",i.settings.currentLang()==="uk"?"\u0414\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0438":"Extra Mechanics"," "),_(6),X(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043A\u0440\u0438\u0442\u0443":"Crit Chance"," "),_(5),X(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u0443":"Miss Chance"," "),_(7),X(" ",i.settings.currentLang()==="uk"?"\u043F\u0440\u0438 \u0440\u0456\u0432\u043D\u0438\u0445 \u0441\u0438\u043B\u0430\u0445: \u0417\u0430\u0445\u0438\u0441\u0442/\u041D\u0456\u0447\u0438\u044F":"at equal force: Defense/Draw"," "),_(5),Ft("fill","url(#vol-fill-player)"),_(10),X(" ",i.settings.currentLang()==="uk"?"-10% \u0443 \u0432\u043E\u0440\u043E\u0433\u0430 \u0448\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u043D\u0443\u0442\u0438\u0441\u044C":"-10% enemy chance to miss"," "),_(4),Ft("fill","url(#vol-fill-player)"),_(11),X(" ",i.settings.currentLang()==="uk"?"10% \u0448\u0430\u043D\u0441 \u043F\u043E\u043F\u0430\u0441\u0442\u0438 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0443":"10% chance to hit the enemy"," "),_(4),X(" ",i.settings.currentLang()==="uk"?"\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F Tier-\u0440\u0456\u0432\u043D\u0456\u0432":"Tier Values"," "),_(25),Ft("fill","url(#vol-fill-player)"),_(9),X(" ",i.settings.currentLang()==="uk"?"+1 \u0434\u043E \u0430\u0442\u0430\u043A\u0438 \u0432\u0456\u0434 \u0441\u0443\u0441\u0456\u0434\u0441\u0442\u0432\u0430":"+1 to an attack from the neighborhood"," "),_(3),q(i.settings.t("MOVEMENT")),_(4),q(i.settings.t("T1_1_TILE")),_(30),nt("left",6,"px")("top",6,"px"),_(4),q(i.settings.t("T3_3_TILES")),_(30),nt("right",6,"px")("bottom",6,"px"),_(4),q(i.settings.t("T4_4_TILES")),_(30),nt("left",6,"px")("top",6,"px"),_(5),q(i.settings.t("FOREST_CYCLE")),_(6),q(i.settings.t("TURN_1")),_(7),q(i.settings.t("TURN_2")),_(7),q(i.settings.t("PLUS_8_WOOD_PER_TURN")),_(3),q(i.settings.t("IRON_CYCLE")),_(6),q(i.settings.t("TURN_1")),_(7),q(i.settings.t("TURN_2")),_(7),q(i.settings.t("TURN_3")),_(7),q(i.settings.t("TURN_4")),_(7),q(i.settings.t("PLUS_2_IRON_PER_TURN")),_(3),q(i.settings.t("WALL_LEGEND")),_(5),q(i.settings.t("PLAYER")),_(4),q(i.settings.t("AI_FACTION")),_(8),X(" ",i.settings.currentLang()==="uk"?"\u0422\u0440\u0435\u0442\u044F \u0456\u0442\u0435\u0440\u0430\u0446\u0456\u044F \u043E\u0434\u0438\u043D\u0438\u0446\u044C":"Third iteration the units"," "),_(6),X(" ",1," "),_(5),X(" ",2," "),_(),Z(430),_(5),X(" ",3," "),_(),Z(436),_(),Z(437),_(5),X(" ",4," "),_(),Z(443),_(),Z(444),_(),Z(445),_(3),q(i.settings.t("NEW_DESIGN_UNIT")),_(82),q(i.settings.t("NEW_UNIT_EVOLUTION")))},dependencies:[qt],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:60px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:10px;font-size:12px;font-weight:800;color:#fde047;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:10px;font-size:12px;font-weight:800;color:#93c5fd;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}.unit-svg-wrapper-game_rules:hover{transform:scale(1)}
`],encapsulation:2})};var n0=class n{constructor(e){this.gameEngine=e}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(Ee(ni))};static \u0275cmp=Ot({type:n,selectors:[["app-support-community"]],decls:51,vars:0,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),v(4,"Support & Community"),A(),C(5,"button",4),Dt("click",function(){return i.gameEngine.closeSupport()}),v(6," \u2716 "),A()(),C(7,"div",5)(8,"div",6)(9,"div",7),v(10,"Donate"),A(),C(11,"div",8),v(12,"Monobank Jar"),A(),C(13,"div",9)(14,"div",10),B(15,"img",11),A(),C(16,"div",12)(17,"div",13),v(18,"send.monobank.ua/jar/2fqGoPhV7G"),A(),C(19,"div",14)(20,"button",15),Dt("click",function(){return i.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(21," Open Link \u{1F4DC} "),A(),C(22,"button",16),Dt("click",function(){return i.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(23," Copy Link \u{1F4CB} "),A()()()(),C(24,"div",17)(25,"div",8),v(26,"Donatello"),A(),C(27,"button",18),Dt("click",function(){return i.openExternalLink("https://donatello.to/jaerbi")}),v(28," Go to Donatello.to \u{1F48E} "),A()(),C(29,"div",19),v(30,"Thank you for supporting the project!"),A()(),C(31,"div",6)(32,"div",7),v(33,"Social & Feedback"),A(),C(34,"div",20)(35,"button",21),Dt("click",function(){return i.openExternalLink("https://discord.gg/c9tCWFtFaG")}),C(36,"span",22),v(37,"\u{1F5E8}\uFE0F"),A(),C(38,"div",23)(39,"div",24),v(40,"Discord Server"),A(),C(41,"div",25),v(42,"Share ideas & feedback"),A()()(),C(43,"button",26),Dt("click",function(){return i.openExternalLink("https://www.youtube.com/@jaerb1")}),C(44,"span",22),v(45,"\u25B6\uFE0F"),A(),C(46,"div",23)(47,"div",24),v(48,"YouTube"),A(),C(49,"div",25),v(50,"Dev logs & gameplay"),A()()()()()()()())},dependencies:[qt],encapsulation:2})};function mG(n,e){if(n&1){let t=at();E(0,"button",7),ue("click",function(){he(t);let r=O();return fe(r.switchToMyStats())}),v(1," My Statistics "),x()}if(n&2){let t=O();Be("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function yG(n,e){n&1&&(E(0,"div",15)(1,"span",16),W(2,"span",17),E(3,"span"),v(4,"Loading..."),x()()())}function vG(n,e){if(n&1&&W(0,"img",27),n&2){let t=O().$implicit;Je("src",t.userPhoto,qi)}}function _G(n,e){n&1&&(E(0,"div",28),v(1,"\u{1F464}"),x())}function EG(n,e){if(n&1&&(E(0,"tr",22)(1,"td",23),v(2),x(),E(3,"td",24),xr(4,vG,1,1,"img",25)(5,_G,2,0,"ng-template",null,0,rE),v(7),x(),E(8,"td",23),v(9),x(),E(10,"td",26),v(11),x()()),n&2){let t=e.$implicit,i=e.index,r=xu(6),o=O(3);Be("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),_(2),q(i+1),_(2),Je("ngIf",t.userPhoto)("ngIfElse",r),_(3),X(" ",t.playerName," "),_(2),q(t.victoryType),_(2),q(t.turnsPlayed)}}function bG(n,e){if(n&1&&(E(0,"tr")(1,"td",29),v(2),W(3,"br"),E(4,"span",30),v(5,"Be the first to claim victory!"),x()()()),n&2){let t=O(3);_(2),Ln(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function wG(n,e){if(n&1&&(E(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),v(5,"Rank"),x(),E(6,"th",20),v(7,"Name"),x(),E(8,"th",20),v(9,"Victory Type"),x(),E(10,"th",20),v(11,"Turns"),x()()(),E(12,"tbody"),xr(13,EG,12,12,"tr",21)(14,bG,6,2,"tr",9),x()()()),n&2){let t=O(2);_(13),Je("ngForOf",t.scores()),_(),Je("ngIf",t.scores().length===0)}}function xG(n,e){if(n&1&&(E(0,"div")(1,"div",11)(2,"span"),v(3,"Top 10 scores for:"),x(),E(4,"span",12),v(5),x(),E(6,"span",13),v(7),x()(),xr(8,yG,5,0,"div",14)(9,wG,15,2,"div",9),x()),n&2){let t=O();_(5),X(" ",t.settings.difficultyLabel()," "),_(2),X(" ",t.settings.mapSizeLabel()," "),_(),Je("ngIf",t.loading()),_(),Je("ngIf",!t.loading())}}function SG(n,e){n&1&&(E(0,"div",15)(1,"span",16),W(2,"span",17),E(3,"span"),v(4,"Loading your stats..."),x()()())}function IG(n,e){n&1&&(E(0,"div",35),v(1," No victories recorded yet. keep playing! "),x())}function TG(n,e){if(n&1&&(E(0,"div",36)(1,"div",37)(2,"span",38),v(3),x(),E(4,"span",39),v(5),x()(),E(6,"div",40)(7,"span",41),v(8,"Best Performance"),x(),E(9,"span",42),v(10),x()(),E(11,"div",43),v(12),ta(13,"date"),x()()),n&2){let t=e.$implicit;_(3),X(" ",t.difficulty," "),_(2),X(" ",t.mapSize," "),_(5),X("",t.turnsPlayed," Turns"),_(2),Ln(" ",t.victoryType," \u2022 ",hl(13,5,t.timestamp,"mediumDate")," ")}}function CG(n,e){if(n&1&&(E(0,"div",32),xr(1,IG,2,0,"div",33)(2,TG,14,8,"div",34),x()),n&2){let t=O(2);_(),Je("ngIf",t.myBestScores().length===0),_(),Je("ngForOf",t.myBestScores())}}function DG(n,e){if(n&1&&(E(0,"div",22),xr(1,SG,5,0,"div",14)(2,CG,3,2,"div",31),x()),n&2){let t=O();_(),Je("ngIf",t.loading()),_(),Je("ngIf",!t.loading())}}var i0=class n{constructor(e,t,i,r){this.firebase=e;this.gameEngine=t;this.playerName=i;this.settings=r;this.fetch()}loading=z(!0);scores=z([]);activeTab=z("top10");myBestScores=z([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),i=await this.firebase.getTopScores(10,e,t);this.scores.set(i??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),i=new Map;t.forEach(r=>{let o=`${r.difficulty}-${r.mapSize}`;(!i.has(o)||r.turnsPlayed<i.get(o).turnsPlayed)&&i.set(o,r)}),this.myBestScores.set(Array.from(i.values()).sort((r,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[r.difficulty];return a!==0?a:r.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(Ee(Ur),Ee(ni),Ee(sc),Ee(Kt))};static \u0275cmp=Ot({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,i){t&1&&(E(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),v(4,"Leaderboard"),x(),E(5,"button",5),ue("click",function(){return i.gameEngine.closeLeaderboard()}),v(6," \u2716 "),x()(),E(7,"div",6)(8,"button",7),ue("click",function(){return i.activeTab.set("top10")}),v(9," Top 10 "),x(),xr(10,mG,2,6,"button",8),x(),xr(11,xG,10,4,"div",9)(12,DG,3,2,"div",10),x()()),t&2&&(_(8),Be("text-white",i.activeTab()==="top10")("border-b-2",i.activeTab()==="top10")("border-indigo-500",i.activeTab()==="top10"),_(2),Je("ngIf",i.firebase.user$()),_(),Je("ngIf",i.activeTab()==="top10"),_(),Je("ngIf",i.activeTab()==="mystats"))},dependencies:[qt,Vp,IE,ku],encapsulation:2})};function AG(n,e){n&1&&(Y(),C(0,"g"),B(1,"path",10)(2,"path",11),A())}function MG(n,e){n&1&&(Y(),C(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function RG(n,e){n&1&&(Y(),C(0,"g",6),B(1,"path",15)(2,"path",16),A())}function NG(n,e){n&1&&(Y(),B(0,"circle",7))}function PG(n,e){n&1&&(Y(),B(0,"circle",8))}function kG(n,e){n&1&&(Y(),B(0,"circle",9))}function OG(n,e){if(n&1&&(Y(),C(0,"svg",0),B(1,"circle",2)(2,"circle",3),C(3,"text",4),v(4),A(),J(5,AG,3,0,":svg:g"),J(6,MG,4,0,":svg:g",5),J(7,RG,3,0,":svg:g",6),J(8,NG,1,0,":svg:circle",7),J(9,PG,1,0,":svg:circle",8),J(10,kG,1,0,":svg:circle",9),A()),n&2){let t=O();_(),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),_(3),X(" ",t.unit.level," "),_(),Z(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),_(),Z(t.unit.hasWeapon?6:-1),_(),Z(t.unit.hasArmor?7:-1),_(),Z(t.unit.level>=2?8:-1),_(),Z(t.unit.level>=3?9:-1),_(),Z(t.unit.level>=4?10:-1)}}function FG(n,e){n&1&&(Y(),C(0,"g"),B(1,"path",10)(2,"path",11),A())}function LG(n,e){n&1&&(Y(),C(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function VG(n,e){n&1&&(Y(),C(0,"g",6),B(1,"path",15)(2,"path",16),A())}function UG(n,e){n&1&&(Y(),B(0,"polygon",21))}function BG(n,e){n&1&&(Y(),B(0,"polygon",22))}function jG(n,e){n&1&&(Y(),C(0,"g"),B(1,"polygon",23)(2,"polygon",24)(3,"polygon",25),A())}function HG(n,e){if(n&1&&(Y(),C(0,"svg",1)(1,"g",17),B(2,"polygon",18)(3,"polygon",19),C(4,"text",20),v(5),A(),J(6,FG,3,0,":svg:g"),J(7,LG,4,0,":svg:g",5),J(8,VG,3,0,":svg:g",6),J(9,UG,1,0,":svg:polygon",21),J(10,BG,1,0,":svg:polygon",22),J(11,jG,4,0,":svg:g"),A()()),n&2){let t=O();_(2),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),_(3),X(" ",t.unit.level," "),_(),Z(t.gameEngine.hasDefenseBonus(t.unit)?6:-1),_(),Z(t.unit.hasWeapon?7:-1),_(),Z(t.unit.hasArmor?8:-1),_(),Z(t.unit.level>=2?9:-1),_(),Z(t.unit.level>=3?10:-1),_(),Z(t.unit.level>=4?11:-1)}}function $G(n,e){n&1&&(Y(),C(0,"g"),B(1,"path",10)(2,"path",11),A())}function GG(n,e){n&1&&(Y(),C(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function zG(n,e){n&1&&(Y(),C(0,"g",6),B(1,"path",15)(2,"path",16),A())}function WG(n,e){n&1&&(Y(),B(0,"rect",29))}function qG(n,e){n&1&&(Y(),B(0,"rect",30))}function KG(n,e){n&1&&(Y(),B(0,"rect",31)(1,"rect",32)(2,"rect",33)(3,"rect",34))}function QG(n,e){if(n&1&&(Y(),C(0,"svg",0),B(1,"rect",26)(2,"rect",27),C(3,"text",28),v(4),A(),J(5,$G,3,0,":svg:g"),J(6,GG,4,0,":svg:g",5),J(7,zG,3,0,":svg:g",6),J(8,WG,1,0,":svg:rect",29),J(9,qG,1,0,":svg:rect",30),J(10,KG,4,0),A()),n&2){let t=O();_(),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),_(3),X(" ",t.unit.level," "),_(),Z(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),_(),Z(t.unit.hasWeapon?6:-1),_(),Z(t.unit.hasArmor?7:-1),_(),Z(t.unit.level>=2?8:-1),_(),Z(t.unit.level>=3?9:-1),_(),Z(t.unit.level>=4?10:-1)}}function YG(n,e){n&1&&(Y(),C(0,"g"),B(1,"path",10)(2,"path",11),A())}function JG(n,e){n&1&&(Y(),C(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function ZG(n,e){n&1&&(Y(),C(0,"g",6),B(1,"path",15)(2,"path",16),A())}function XG(n,e){n&1&&(Y(),B(0,"polygon",38))}function ez(n,e){n&1&&(Y(),B(0,"polygon",39))}function tz(n,e){n&1&&(Y(),B(0,"circle",40)(1,"circle",41)(2,"circle",42)(3,"circle",43)(4,"circle",44)(5,"circle",45))}function nz(n,e){if(n&1&&(Y(),C(0,"svg",0),B(1,"polygon",35)(2,"polygon",36),C(3,"text",37),v(4),A(),J(5,YG,3,0,":svg:g"),J(6,JG,4,0,":svg:g",5),J(7,ZG,3,0,":svg:g",6),J(8,XG,1,0,":svg:polygon",38),J(9,ez,1,0,":svg:polygon",39),J(10,tz,6,0),A()),n&2){let t=O();_(),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),_(3),X(" ",t.unit.level," "),_(),Z(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),_(),Z(t.unit.hasWeapon?6:-1),_(),Z(t.unit.hasArmor?7:-1),_(),Z(t.unit.level>=2?8:-1),_(),Z(t.unit.level>=3?9:-1),_(),Z(t.unit.level>=4?10:-1)}}var r0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}unit;static \u0275fac=function(t){return new(t||n)(Ee(ni),Ee(Kt))};static \u0275cmp=Ot({type:n,selectors:[["app-units"]],inputs:{unit:"unit"},decls:4,vars:1,consts:[["viewBox","0 0 100 100",1,"w-full","h-full"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-95"],["cx","50","cy","50","r","32","filter","url(#soft-shadow)"],["cx","50","cy","50","r","31","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","61","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["transform","rotate(-45 30 14)"],["transform","translate(16, 2)"],["cx","50","cy","50","r","35","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["cx","50","cy","50","r","40","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["cx","50","cy","50","r","28","fill","none","stroke","var(--u-light)","stroke-width","2"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","var(--u-light)","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],["x","5","y","0","width","2","height","10","fill","var(--u-light)"],["points","6,-2 8,2 4,2","fill","var(--u-light)"],["x","3","y","10","width","6","height","2","fill","var(--u-fill)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","var(--u-light)"],["d","M5 3V8M3 5H9","stroke","var(--u-fill)","stroke-width","1.2","stroke-linecap","round","opacity","0.7"],["transform","translate(0, 4)"],["points","50,16 86,78 14,78","filter","url(#soft-shadow)"],["points","50,18 82,74 18,74","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","50","y","68","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2","stroke-linejoin","round"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["points","50,0 56,10 44,10","fill","var(--u-light)","stroke-linejoin","round"],["points","99,87 92,74 84,87","fill","var(--u-light)","stroke-linejoin","round"],["points","1,87 15,87 8,74","fill","var(--u-light)","stroke-linejoin","round"],["x","21","y","21","width","56","height","56","rx","6","filter","url(#soft-shadow)"],["x","23","y","23","width","52","height","52","rx","5","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","60","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["x","18","y","18","width","62","height","62","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","14","y","14","width","70","height","70","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["x","12","y","12","width","8","height","8","fill","var(--u-light)"],["x","78","y","12","width","8","height","8","fill","var(--u-light)"],["x","12","y","78","width","8","height","8","fill","var(--u-light)"],["x","78","y","78","width","8","height","8","fill","var(--u-light)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","filter","url(#soft-shadow)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","fill","none","stroke","var(--u-light)","stroke-width","2","opacity","0.4"],["x","49","y","62","text-anchor","middle","font-size","28","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,17 81,35 81,65 50,83 19,65 19,35","fill","none","stroke","var(--u-core)","stroke-width","1.5","stroke-linejoin","round"],["points","50,12 86,32 86,68 50,88 14,68 14,32","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["cx","50","cy","12","r","3","fill","var(--u-light)"],["cx","86","cy","32","r","3","fill","var(--u-light)"],["cx","86","cy","68","r","3","fill","var(--u-light)"],["cx","50","cy","88","r","3","fill","var(--u-light)"],["cx","14","cy","68","r","3","fill","var(--u-light)"],["cx","14","cy","32","r","3","fill","var(--u-light)"]],template:function(t,i){if(t&1&&J(0,OG,11,8,":svg:svg",0)(1,HG,12,8,":svg:svg",1)(2,QG,11,8,":svg:svg",0)(3,nz,11,8,":svg:svg",0),t&2){let r;Z((r=i.unit.tier)===1?0:r===2?1:r===3?2:r===4?3:-1)}},dependencies:[qt],encapsulation:2})};function iz(n,e){if(n&1){let t=at();C(0,"div",7)(1,"div",8),v(2),A(),C(3,"button",9),Dt("click",function(){he(t);let r=O();return fe(r.gameEngine.cancelSandboxSpawn())}),v(4),A()()}if(n&2){let t=O();_(2),X(" ",t.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u0438":"Click an empty tile to spawn"," "),_(2),X(" ",t.settings.currentLang()==="uk"?"\u0412\u0456\u0434\u043C\u0456\u043D\u0430":"Cancel"," ")}}var o0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(Ee(ni),Ee(Kt))};static \u0275cmp=Ot({type:n,selectors:[["app-sandbox"]],decls:24,vars:3,consts:[[1,"absolute","-top-7","left-[-10px]","ml-2","px-3","py-1","rounded-full","bg-pink-600/20","border","border-pink-500/30","text-pink-200","text-[10px]","font-black","uppercase","tracking-widest"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-28","right-[-254px]","min-w-[238px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"mt-2","flex","flex-col","gap-2","w-full","px-2","py-2","rounded-lg","border","border-white/5","bg-white/5"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-pink-200"],[1,"grid","grid-cols-4","gap-2"],[1,"px-2","py-1","rounded","bg-blue-600/20","border","border-blue-500/30","text-blue-100","text-[10px]","cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","bg-red-600/20","border","border-red-500/30","text-red-100","text-[10px]","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-[10px]","text-gray-300"],[1,"px-2","py-1","rounded","bg-gray-700","hover:bg-gray-600","border","border-gray-600","text-white","text-[10px]","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0),v(1),A(),C(2,"div",1)(3,"div",2)(4,"div",3),v(5),A(),C(6,"div",4)(7,"button",5),Dt("click",function(){return i.gameEngine.startSandboxSpawn("player",1)}),v(8," T1 "),A(),C(9,"button",5),Dt("click",function(){return i.gameEngine.startSandboxSpawn("player",2)}),v(10," T2 "),A(),C(11,"button",5),Dt("click",function(){return i.gameEngine.startSandboxSpawn("player",3)}),v(12," T3 "),A(),C(13,"button",5),Dt("click",function(){return i.gameEngine.startSandboxSpawn("player",4)}),v(14," T4 "),A(),C(15,"button",6),Dt("click",function(){return i.gameEngine.startSandboxSpawn("ai",1)}),v(16," T1 "),A(),C(17,"button",6),Dt("click",function(){return i.gameEngine.startSandboxSpawn("ai",2)}),v(18," T2 "),A(),C(19,"button",6),Dt("click",function(){return i.gameEngine.startSandboxSpawn("ai",3)}),v(20," T3 "),A(),C(21,"button",6),Dt("click",function(){return i.gameEngine.startSandboxSpawn("ai",4)}),v(22," T4 "),A()(),J(23,iz,5,2,"div",7),A()()),t&2&&(_(),X(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox",`
`),_(4),X(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox"," "),_(18),Z(i.gameEngine.sandboxSpawnPending()?23:-1))},dependencies:[qt],encapsulation:2})};var rz=["boardContainer"],It=(n,e)=>({x:n,y:e}),oz=()=>[10,20,30],sz=(n,e)=>e.id,$2=(n,e)=>e.date;function az(n,e){if(n&1){let t=at();E(0,"div",82)(1,"div",233)(2,"span",234),v(3),x(),E(4,"button",235),ue("click",function(){he(t);let r=O();return fe(r.firebase.logout())}),v(5),x()(),E(6,"div",236),W(7,"img",237)(8,"div",238),x()()}if(n&2){let t=O();_(3),X(" ",t.settings.t("VERIFIED")," "),_(2),X(" ",t.settings.t("LOGOUT")," "),_(2),Je("src",e.photoURL,qi)}}function lz(n,e){if(n&1){let t=at();E(0,"button",239),ue("click",function(){he(t);let r=O();return fe(r.firebase.loginWithGoogle())}),W(1,"div",240),E(2,"span",241),v(3),x()()}if(n&2){let t=O();_(3),X(" ",t.settings.t("CONNECT")," ")}}function cz(n,e){if(n&1){let t=at();E(0,"div",82)(1,"div",233)(2,"span",234),v(3),x(),E(4,"button",235),ue("click",function(){he(t);let r=O(2);return fe(r.firebase.logout())}),v(5),x()(),E(6,"div",236),W(7,"img",237)(8,"div",238),x()(),E(9,"button",197),ue("click",function(){he(t);let r=O(2);return fe(r.toggleAutoBattle())}),E(10,"div",198)(11,"span",199),v(12),x(),E(13,"span",200),v(14),x()(),E(15,"div",198),W(16,"span",201),x(),W(17,"div",202),x()}if(n&2){let t=O(2);_(3),X(" ",t.settings.t("VERIFIED")," "),_(2),X(" ",t.settings.t("LOGOUT")," "),_(2),Je("src",e.photoURL,qi),_(2),Be("ring-2",t.isAutoBattleActive())("ring-green-400",t.isAutoBattleActive()),Je("disabled",t.gameEngine.gameStatus()!=="playing"),_(3),q(t.settings.t("AUTO")),_(2),q(t.settings.t("ENGAGE")),_(2),Be("bg-green-400",t.isAutoBattleActive())("bg-gray-500",!t.isAutoBattleActive())}}function uz(n,e){if(n&1){let t=at();E(0,"button",239),ue("click",function(){he(t);let r=O(2);return fe(r.firebase.loginWithGoogle())}),W(1,"div",240),E(2,"span",241),v(3),x()()}if(n&2){let t=O(2);_(3),X(" ",t.settings.t("CONNECT")," ")}}function dz(n,e){if(n&1){let t=at();E(0,"div",119)(1,"div",242)(2,"button",243),ue("click",function(){he(t);let r=O();return fe(r.closeMobileMenu())}),Y(),E(3,"svg",103),W(4,"path",244),x()(),Ne(),E(5,"button",245),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.resetGame())}),v(6),x(),E(7,"button",245),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.toggleRules())}),v(8),x(),E(9,"button",245),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.toggleLeaderboard())}),v(10),x(),E(11,"button",245),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.toggleLog())}),v(12),x(),E(13,"button",245),ue("click",function(){he(t);let r=O();return fe(r.navigateToFeedback())}),v(14),x(),E(15,"button",245),ue("click",function(){he(t);let r=O();return fe(r.navigateToRoadmap())}),v(16),x(),E(17,"button",245),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.toggleSettings())}),v(18),x(),E(19,"button",245),ue("click",function(){he(t);let r=O();return fe(r.navigateToRoadmap())}),v(20),x(),J(21,cz,18,14)(22,uz,4,1,"button",83),x()()}if(n&2){let t,i=O();_(6),q(i.settings.t("RELOAD")),_(2),q(i.settings.t("INFO")),_(2),q(i.settings.t("RANKING")),_(2),q(i.settings.t("SYSTEM_LOG")),_(2),q(i.settings.t("FEEDBACK_MODULE")),_(2),q(i.settings.t("STRATEGIC_PLAN")),_(2),q(i.settings.t("SETTINGS")),_(2),q(i.settings.t("STRATEGIC_PLAN")),_(),Z((t=i.firebase.user$())?21:22,t)}}function hz(n,e){if(n&1&&(E(0,"div",161),v(1),x()),n&2){let t=O();_(),dl(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function fz(n,e){if(n&1&&(E(0,"div",248),v(1),x()),n&2){let t=O(2);_(),q(t.gameEngine.endReason())}}function pz(n,e){if(n&1){let t=at();E(0,"div",249)(1,"div",252),v(2),x(),W(3,"input",253,1),E(5,"button",254),ue("click",function(){he(t);let r=xu(4),o=O(2);return fe(o.gameEngine.confirmAndSaveScore(r.value))}),v(6),x()()}if(n&2){let t=O(2);_(2),q(t.settings.t("CONFIRM_NAME")),_(),Je("value",t.gameEngine.getPlayerName()),_(3),X(" ",t.settings.t("SAVE_SCORE")," ")}}function gz(n,e){if(n&1){let t=at();E(0,"div",169)(1,"div",246)(2,"h2",247),v(3),ta(4,"titlecase"),x(),J(5,fz,2,1,"div",248),J(6,pz,7,3,"div",249),E(7,"button",250),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.resetGame())}),v(8),x()(),E(9,"button",251),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.toggleLeaderboard())}),v(10),x()()}if(n&2){let t=O();_(2),Be("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),_(),X(" ",iE(4,9,t.gameEngine.gameStatus()),"! "),_(2),Z(t.gameEngine.endReason()?5:-1),_(),Z(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),_(2),X(" ",t.settings.t("PLAY_AGAIN")," "),_(2),X(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function mz(n,e){n&1&&W(0,"app-support-community")}function yz(n,e){n&1&&W(0,"app-leaderboard-modal")}function vz(n,e){n&1&&W(0,"app-sandbox")}function _z(n,e){if(n&1&&(E(0,"div",184)(1,"span",255),v(2),x()()),n&2){let t=O();_(2),X(" ",t.gameEngine.baseHealth().ai," ")}}function Ez(n,e){n&1&&(E(0,"span",267),v(1," \u{1F92C} "),x()),n&2&&nt("z-index",100)}function bz(n,e){n&1&&(E(0,"span",267),v(1," \u{1F620} "),x()),n&2&&nt("z-index",100)}function wz(n,e){if(n&1&&J(0,Ez,2,2,"span",266)(1,bz,2,2,"span",266),n&2){let t=O(3);Z(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function xz(n,e){n&1&&W(0,"div",259)}function Sz(n,e){if(n&1){let t=at();E(0,"button",268),ue("click",function(){he(t);let r=O().$implicit,o=O().$implicit,s=O();return fe(s.gameEngine.buildForgeAt({x:r,y:o}))}),v(1," Build Forge "),x()}n&2&&nt("z-index",60)}function Iz(n,e){if(n&1&&(E(0,"span",269),v(1),x()),n&2){let t=O().$implicit,i=O().$implicit,r=O();nt("z-index",55),_(),X(" ",r.gameEngine.getForgeProgress(t,i),"% ")}}function Tz(n,e){n&1&&(E(0,"span",273),Y(),E(1,"svg",274)(2,"g",275),W(3,"rect",276)(4,"rect",277)(5,"path",278)(6,"rect",279)(7,"rect",280),x()()()),n&2&&nt("z-index",50)}function Cz(n,e){if(n&1){let t=at();E(0,"button",284),ue("click",function(){he(t),O(3);let r=Qo(5),o=O(2);return fe(o.gameEngine.buyWeapon(r.id))}),v(1," Weapon "),x()}}function Dz(n,e){if(n&1){let t=at();E(0,"button",285),ue("click",function(){he(t),O(3);let r=Qo(5),o=O(2);return fe(o.gameEngine.buyArmor(r.id))}),v(1," Armor "),x()}}function Az(n,e){if(n&1&&(E(0,"div",281),J(1,Cz,2,0,"button",282),J(2,Dz,2,0,"button",283),x()),n&2){O(2);let t=Qo(5),i=O(2);nt("z-index",60),_(),Z(!t.hasWeapon&&i.gameEngine.resources().iron>=20?1:-1),_(),Z(!t.hasArmor&&i.gameEngine.resources().iron>=20?2:-1)}}function Mz(n,e){if(n&1&&(E(0,"span",270),v(1," Forge "),x(),J(2,Tz,8,2,"span",271),J(3,Az,3,4,"div",272)),n&2){let t=O().$implicit,i=Qo(5),r=O().$implicit,o=O();nt("z-index",55),Be("scale-60",i&&i.owner==="player")("scale-50",i&&i.owner==="player")("top-1",!(i&&i.owner==="player"))("left-1",!(i&&i.owner==="player"))("top-0",i&&i.owner==="player")("-right-1",i&&i.owner==="player"),_(2),Z(o.gameEngine.isVisibleToPlayer(t,r)?2:-1),_(),Z(i&&i.owner==="player"?3:-1)}}function Rz(n,e){n&1&&(Y(),E(0,"g",291),W(1,"polygon",294)(2,"polygon",295),x())}function Nz(n,e){n&1&&(Y(),E(0,"g",296),W(1,"rect",297),x(),E(2,"g",298),W(3,"rect",299)(4,"path",300),x())}function Pz(n,e){if(n&1&&(E(0,"span",286),Y(),E(1,"svg",287)(2,"defs")(3,"linearGradient",288),W(4,"stop",289)(5,"stop",290),x()(),J(6,Rz,3,0,":svg:g",291),E(7,"g"),W(8,"polygon",292)(9,"rect",293),x(),J(10,Nz,5,0),x()()),n&2){O();let t=Qo(5);Be("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),_(6),Z(t?-1:6),_(),Be("scale-90",t),_(3),Z(t?-1:10)}}function kz(n,e){n&1&&(Y(),E(0,"g",304),W(1,"rect",305)(2,"path",306),x())}function Oz(n,e){if(n&1&&(E(0,"span",286),Y(),E(1,"svg",287)(2,"g"),W(3,"ellipse",301)(4,"path",302)(5,"circle",303),x(),J(6,kz,3,0,":svg:g",304),x()()),n&2){O();let t=Qo(5);Be("scale-50",t)("opacity-40",t)("-translate-x-4",t)("translate-y-4",t),_(6),Z(t?-1:6)}}function Fz(n,e){n&1&&W(0,"div",307),n&2&&nt("height",2,"px")}function Lz(n,e){if(n&1&&(E(0,"span",308),v(1),x(),E(2,"span",309),v(3),x()),n&2){let t=O(3);_(),X(" ",t.gameEngine.baseHealth().player," "),_(2),X(" ",t.gameEngine.reservePoints().player," ")}}function Vz(n,e){if(n&1&&(E(0,"span",310),v(1),x(),E(2,"span",311),v(3),x()),n&2){let t=O(4);_(),X(" ",t.gameEngine.baseHealth().ai," "),_(2),X(" ",t.gameEngine.reservePoints().ai," ")}}function Uz(n,e){if(n&1&&J(0,Vz,4,2),n&2){let t=O().$implicit,i=O().$implicit,r=O();Z(r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function Bz(n,e){n&1&&(Y(),E(0,"svg",317),W(1,"path",318),x())}function jz(n,e){n&1&&(Y(),E(0,"svg",317),W(1,"path",319),x())}function Hz(n,e){if(n&1){let t=at();E(0,"button",316),ue("click",function(r){he(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return fe(o.owner==="player"?l.onDestroyIconClick(r,s,a,s+1,a):l.onAttackIconClick(r,s,a,s+1,a))}),J(1,Bz,2,0,":svg:svg",317)(2,jz,2,0,":svg:svg",317),x()}if(n&2){let t=O(2),i=O(4);nt("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Be("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),_(),Z(t.owner==="player"?1:2)}}function $z(n,e){if(n&1){let t=at();E(0,"div",314),ue("mouseenter",function(){he(t);let r=O(),o=O(4);return fe(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){he(t);let r=O(5);return fe(r.gameEngine.hoverFormationById(null))}),J(1,Hz,3,13,"button",315),x()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();nt("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","height 0.25s ease-out"),Be("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ft("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),_(),Z(o.gameEngine.canShowAttackIcon(_t(26,It,i,r),_t(29,It,i+1,r))?1:-1)}}function Gz(n,e){if(n&1&&J(0,$z,2,32,"div",313),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();Z(r.gameEngine.shouldRenderWall(_t(1,It,t,i),_t(4,It,t+1,i),e.owner)?0:-1)}}function zz(n,e){if(n&1){let t=at();E(0,"button",323),ue("click",function(r){he(t);let o=O(3).$implicit,s=O().$implicit,a=O();return fe(a.onBuildIconClick(r,o,s,o+1,s))}),v(1," \u2714 "),x()}if(n&2){let t=O(5);nt("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function Wz(n,e){if(n&1&&(E(0,"span",322),v(1),x()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();_(),Ln(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,It,t,i),_t(5,It,t+1,i))," ")}}function qz(n,e){if(n&1&&(E(0,"div",320),J(1,zz,2,8,"button",321),J(2,Wz,2,8,"span",322),x()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();nt("right",-r.gameEngine.wallThicknessPx-2,"px")("width",r.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Be("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,It,t,i),_t(19,It,t+1,i)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,It,t,i),_t(25,It,t+1,i))),_(),Z(r.gameEngine.canShowBuildIcon(_t(28,It,t,i),_t(31,It,t+1,i))?1:-1),_(),Z(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t+1,i))&&r.gameEngine.edgeCooldownRemaining(_t(34,It,t,i),_t(37,It,t+1,i))>0?2:-1)}}function Kz(n,e){if(n&1&&J(0,Gz,1,7)(1,qz,3,40,"div",312),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();Z((t=o.gameEngine.getWallBetween(i,r,i+1,r))?0:1,t)}}function Qz(n,e){n&1&&(Y(),E(0,"svg",317),W(1,"path",318),x())}function Yz(n,e){n&1&&(Y(),E(0,"svg",317),W(1,"path",319),x())}function Jz(n,e){if(n&1){let t=at();E(0,"button",316),ue("click",function(r){he(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return fe(o.owner==="player"?l.onDestroyIconClick(r,s,a,s,a+1):l.onAttackIconClick(r,s,a,s,a+1))}),J(1,Qz,2,0,":svg:svg",317)(2,Yz,2,0,":svg:svg",317),x()}if(n&2){let t=O(2),i=O(4);nt("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Be("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),_(),Z(t.owner==="player"?1:2)}}function Zz(n,e){if(n&1){let t=at();E(0,"div",326),ue("mouseenter",function(){he(t);let r=O(),o=O(4);return fe(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){he(t);let r=O(5);return fe(r.gameEngine.hoverFormationById(null))}),J(1,Jz,3,13,"button",315),x()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();nt("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","width 0.25s ease-out"),Be("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ft("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),_(),Z(o.gameEngine.canShowAttackIcon(_t(26,It,i,r),_t(29,It,i,r+1))?1:-1)}}function Xz(n,e){if(n&1&&J(0,Zz,2,32,"div",325),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();Z(r.gameEngine.shouldRenderWall(_t(1,It,t,i),_t(4,It,t,i+1),e.owner)?0:-1)}}function eW(n,e){if(n&1){let t=at();E(0,"button",330),ue("click",function(r){he(t);let o=O(3).$implicit,s=O().$implicit,a=O();return fe(a.onBuildIconClick(r,o,s,o,s+1))}),v(1," \u2714 "),x()}if(n&2){let t=O(5);nt("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function tW(n,e){if(n&1&&(E(0,"span",329),v(1),x()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();_(),Ln(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,It,t,i),_t(5,It,t,i+1))," ")}}function nW(n,e){if(n&1&&(E(0,"div",327),J(1,eW,2,8,"button",328),J(2,tW,2,8,"span",329),x()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();nt("bottom",-r.gameEngine.wallThicknessPx-2,"px")("height",r.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Be("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,It,t,i),_t(19,It,t,i+1)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,It,t,i),_t(25,It,t,i+1))),_(),Z(r.gameEngine.canShowBuildIcon(_t(28,It,t,i),_t(31,It,t,i+1))?1:-1),_(),Z(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t,i+1))&&r.gameEngine.edgeCooldownRemaining(_t(34,It,t,i),_t(37,It,t,i+1))>0?2:-1)}}function iW(n,e){if(n&1&&J(0,Xz,1,7)(1,nW,3,40,"div",324),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();Z((t=o.gameEngine.getWallBetween(i,r,i,r+1))?0:1,t)}}function rW(n,e){if(n&1&&W(0,"app-units",334),n&2){let t=O(3);Je("unit",t)}}function oW(n,e){if(n&1&&(E(0,"span",338),v(1),x()),n&2){let t=e;nt("z-index",200),Be("bg-green-600",t.bg==="bg-green-600")("bg-amber-600",t.bg==="bg-amber-600")("bg-red-600",t.bg==="bg-red-600"),_(),X(" ",t.chance,"% ")}}function sW(n,e){n&1&&(E(0,"span",339),v(1," \u{1F333} "),x()),n&2&&nt("z-index",100)}function aW(n,e){n&1&&(E(0,"span",340),v(1," \u{1F331} "),x()),n&2&&nt("z-index",100)}function lW(n,e){n&1&&(E(0,"span",340),v(1," \u{1F33F} "),x()),n&2&&nt("z-index",100)}function cW(n,e){n&1&&(E(0,"span",343),v(1," \u{1F9F1} "),x()),n&2&&nt("z-index",100)}function uW(n,e){n&1&&(E(0,"span",342),v(1,"\u26F0\uFE0F"),x())}function dW(n,e){n&1&&(E(0,"span",342),v(1,"\u26CF\uFE0F"),x())}function hW(n,e){n&1&&(E(0,"span",342),v(1,"\u26CF"),x())}function fW(n,e){n&1&&(E(0,"span",342),v(1,"\u2692"),x())}function pW(n,e){if(n&1&&J(0,cW,2,2,"span",341)(1,uW,2,0,"span",342)(2,dW,2,0,"span",342)(3,hW,2,0,"span",342)(4,fW,2,0,"span",342),n&2){let t=O(3);Z((t.mineOccupationTurns??0)>=5?0:(t.mineOccupationTurns??0)===1?1:(t.mineOccupationTurns??0)===2?2:(t.mineOccupationTurns??0)===3?3:(t.mineOccupationTurns??0)>3?4:-1)}}function gW(n,e){if(n&1&&(E(0,"div",332)(1,"div",333),J(2,rW,1,1,"app-units",334),x(),J(3,oW,2,9,"span",335),J(4,sW,2,2,"span",336)(5,aW,2,2,"span",337)(6,lW,2,2,"span",337),J(7,pW,5,1),x()),n&2){let t,i=O(2),r=O(3);nt("transform",r.gameEngine.getCombinedTransform(i.id))("z-index",r.gameEngine.isUnitMoving(i.id)||r.gameEngine.isUnitAttacking(i.id)?200:null),Be("shake",r.gameEngine.isUnitShaking(i.id)),_(),nt("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px"),Be("theme-player",i.owner==="player")("theme-ai",i.owner==="ai")("fatigued",i.hasActed)("merge-anim",r.gameEngine.lastMergedUnitId()===i.id)("ring",r.gameEngine.selectedUnitId()===i.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===i.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===i.id)("scale-115",r.gameEngine.selectedUnitId()===i.id&&!r.gameEngine.buildMode())("scale-120",r.gameEngine.lastMergedUnitId()===i.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===i.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===i.id)("pulse-glow",r.gameEngine.pulseUnitId()===i.id),Ft("title",r.gameEngine.formatHoverInfo(i.id)),_(),Z(i?2:-1),_(),Z((t=r.gameEngine.isUnitHovered(i.id)&&r.gameEngine.getHitChanceInfo(i.id))?3:-1,t),_(),Z(i.productionActive?4:(i.forestOccupationTurns??0)===1?5:(i.forestOccupationTurns??0)>1?6:-1),_(3),Z(r.gameEngine.isMine(i.position.x,i.position.y)?7:-1)}}function mW(n,e){if(n&1&&J(0,gW,8,41,"div",331),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();Z(!(t===0&&i===0)&&!(t===r.gameEngine.gridSize-1&&i===r.gameEngine.gridSize-1)?0:-1)}}function yW(n,e){if(n&1&&J(0,mW,1,1),n&2){let t=O().$implicit,i=O().$implicit,r=O();Z(e.owner==="player"||r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function vW(n,e){if(n&1&&(E(0,"div",344)(1,"span",345),v(2),x()()),n&2){let t=e.$implicit,i=O(3);nt("z-index",100)("opacity",t.opacity),_(),Be("text-xs",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-base",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text))("text-yellow-300",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-yellow-400",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text)),_(),X(" ",t.text," ")}}function _W(n,e){if(n&1){let t=at();E(0,"div",257),ue("click",function(){let r=he(t).$implicit,o=O().$implicit,s=O();return fe(s.onTileClick(r,o))})("mouseenter",function(){let r=he(t).$implicit,o=O().$implicit,s=O();return fe(s.gameEngine.setHoveredUnit(s.gameEngine.getUnitAt(r,o)&&(s.gameEngine.getUnitAt(r,o).owner==="player"||s.gameEngine.isVisibleToPlayer(r,o))?s.gameEngine.getUnitAt(r,o).id:null))})("mouseleave",function(){he(t);let r=O(2);return fe(r.gameEngine.setHoveredUnit(null))}),E(1,"span",258),v(2),x(),J(3,wz,2,1),J(4,xz,1,0,"div",259),_p(5),J(6,Sz,2,2,"button",260),J(7,Iz,2,3,"span",261),J(8,Mz,4,16),J(9,Pz,11,12,"span",262),J(10,Oz,7,9,"span",263),J(11,Fz,1,2,"div",264),J(12,Lz,4,2),J(13,Uz,1,1),J(14,Kz,2,1),J(15,iW,2,1),J(16,yW,1,1),On(17,vW,3,13,"div",265,sz),x()}if(n&2){let t,i=e.$implicit,r=O().$implicit,o=O();nt("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Be("cursor-pointer",o.gameEngine.isValidMove(i,r))("bg-gray-700",!o.gameEngine.isValidMove(i,r))("border-gray-600",!o.gameEngine.isValidMove(i,r))("bg-blue-900",i===0&&r===0)("bg-red-900",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-4",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-blue-400",i===0&&r===0)("border-red-400",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-2",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-blue-300",i===0&&r===0&&o.gameEngine.baseDeployActive())("ring-red-300",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&i<=2&&r<=2&&(i!==0||r!==0))("forest-area",o.gameEngine.isForest(i,r))("mine-area",o.gameEngine.isMine(i,r))("forge-area",o.gameEngine.isForge(i,r))("bg-amber-900",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(i,r))("border-gray-800",!o.gameEngine.isVisibleToPlayer(i,r))("bg-green-900",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("border-green-500",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("bg-cyan-900",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("border-cyan-500",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("animate-pulse",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("hover:bg-gray-600",!o.gameEngine.isValidMove(i,r))("hover:bg-green-800",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("hover:bg-cyan-800",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r)),Ft("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0456\u0437\u043D\u0430 \u0448\u0430\u0445\u0442\u0430: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +2 \u0437\u0430\u043B\u0456\u0437\u0430 \u0437\u0430 \u0445\u0456\u0434.":"Iron Mine: Requires 5 consecutive turns of occupation to activate. Once active, yields +2 Iron per turn.":null)("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u041B\u0456\u0441\u043E\u043F\u0438\u043B\u044C\u043D\u044F: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 2 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +8 \u0434\u0435\u0440\u0435\u0432\u0438\u043D\u0438 \u0437\u0430 \u0445\u0456\u0434.":"Sawmill: Requires 2 consecutive occupation turns to activate. Once activated, it gives +8 wood per turn.":null),_(2),Ln(" ",i,",",r," "),_(),Z(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(i,r)?3:-1),_(),Z(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(i,r)?4:-1),_(),tE(o.gameEngine.getUnitAt(i,r)),_(),Z(o.gameEngine.buildMode()&&o.gameEngine.canBuildForgeAt(i,r)?6:-1),_(),Z(o.gameEngine.isForgeSite(i,r)?7:-1),_(),Z(o.gameEngine.isForge(i,r)?8:-1),_(),Z(o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?9:-1),_(),Z(o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?10:-1),_(),Z(o.gameEngine.isForest(i,r)&&o.gameEngine.getUnitAt(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?11:-1),_(),Z(i===0&&r===0?12:-1),_(),Z(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1?13:-1),_(),Z(i<o.gameEngine.gridSize-1?14:-1),_(),Z(r<o.gameEngine.gridSize-1?15:-1),_(),Z((t=o.gameEngine.getUnitAt(i,r))?16:-1,t),_(),Fn(o.gameEngine.getCombatTextEntriesAt(i,r))}}function EW(n,e){if(n&1&&On(0,_W,19,80,"div",256,Sr),n&2){let t=O();Fn(t.gameEngine.gridCols)}}function bW(n,e){n&1&&W(0,"app-game-rules")}function wW(n,e){if(n&1&&(E(0,"div",361),v(1),x()),n&2){let t=O(2);_(),q(t.settings.t("NOT_LOGS_DATA"))}}function xW(n,e){if(n&1&&(E(0,"div",363)(1,"span",364),v(2),x()()),n&2){let t=e.$implicit;nt("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Be("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),_(),X_(t.color),_(),q(t.text)}}function SW(n,e){if(n&1){let t=at();E(0,"div",229)(1,"button",346),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.toggleLog())}),E(2,"span",347),v(3,"\u2715"),x()(),E(4,"div",348)(5,"div",349)(6,"h3",350),v(7),x(),E(8,"button",351),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.clearLogs())}),Y(),E(9,"svg",352),W(10,"path",353),x(),v(11),x()(),Ne(),E(12,"label",354)(13,"div",109)(14,"input",355),ue("change",function(){he(t);let r=O();return fe(r.gameEngine.toggleCombatOnly())}),x(),W(15,"div",356),Y(),E(16,"svg",357),W(17,"path",358),x()(),Ne(),E(18,"span",359),v(19),x()()(),E(20,"div",360),J(21,wW,2,1,"div",361),On(22,xW,3,7,"div",362,J_),x()()}if(n&2){let t=O();_(7),X(" ",t.settings.t("Action_LOG")," "),_(4),X(" ",t.settings.t("CLEAR")," "),_(3),Je("checked",t.gameEngine.combatOnly()),_(5),X(" ",t.settings.t("COMBAT_ONLY")," "),_(2),Z(t.gameEngine.logsFiltered().length===0?21:-1),_(),Fn(t.gameEngine.logsFiltered().reverse())}}function IW(n,e){if(n&1){let t=at();E(0,"button",381),ue("click",function(){let r=he(t).$implicit,o=O(2);return fe(o.onDifficultyChange(r))}),E(1,"span",382),v(2),x(),v(3),x()}if(n&2){let t=e.$implicit,i=O(2);Be("bg-blue-500/20",i.settings.difficulty()===t)("border-blue-400/40",i.settings.difficulty()===t)("text-blue-200",i.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",i.settings.difficulty()===t)("bg-white/5",i.settings.difficulty()!==t)("border-white/5",i.settings.difficulty()!==t)("text-stone-500",i.settings.difficulty()!==t)("hover:bg-white/10",i.settings.difficulty()!==t),_(),Be("opacity-100",i.settings.difficulty()===t),_(),X(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),_(),X(" ",i.settings.t(i.settings.getDifficultyLabel(t))," ")}}function TW(n,e){if(n&1){let t=at();E(0,"button",383),ue("click",function(){let r=he(t).$implicit,o=O(2);return fe(o.onMapSizeChange(r))}),v(1),x()}if(n&2){let t=e.$implicit,i=O(2);Be("bg-gradient-to-br",i.settings.mapSize()===t)("from-indigo-600",i.settings.mapSize()===t)("to-indigo-800",i.settings.mapSize()===t)("text-white",i.settings.mapSize()===t)("shadow-lg",i.settings.mapSize()===t)("text-stone-500",i.settings.mapSize()!==t)("hover:text-stone-300",i.settings.mapSize()!==t),_(),Ln(" ",t,"x",t," ")}}function CW(n,e){if(n&1){let t=at();E(0,"div",230)(1,"div",365),W(2,"div",366),E(3,"h3",367),v(4),x(),E(5,"button",368),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.toggleSettings())}),v(6," \u2716 "),x()(),E(7,"div",369)(8,"div",190)(9,"label",370),v(10),x(),E(11,"span",371),v(12),x()(),E(13,"div",372),On(14,IW,4,20,"button",373,Sr),x()(),E(16,"div",369)(17,"label",374),v(18),x(),E(19,"div",375),On(20,TW,2,16,"button",376,Sr),x()(),E(22,"div",377)(23,"button",378),ue("click",function(){he(t);let r=O();return fe(r.settings.setLang("uk"))}),v(24," UA "),x(),E(25,"button",378),ue("click",function(){he(t);let r=O();return fe(r.settings.setLang("en"))}),v(26," EN "),x()(),E(27,"label",379)(28,"div",109)(29,"input",110),ue("change",function(r){he(t);let o=O();return fe(o.setCustomMode(r.target.checked))}),x(),E(30,"div",380),W(31,"div",112),x()(),E(32,"span",113),v(33,"Custom Mode"),x()()()}if(n&2){let t=O();_(4),q(t.settings.t("SYSTEM_SETTINGS")),_(6),X(" ",t.settings.t("TACTICAL_DIFF")," "),_(2),X(" ",t.settings.t("LEVEL_SELECTION")," "),_(2),Fn(t.settings.diffArr),_(4),X(" ",t.settings.t("SECTOR_DIMENSIONS")," "),_(2),Fn(ea(13,oz)),_(3),Be("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),_(2),Be("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en"),_(4),Je("checked",t.settings.customMode())}}function DW(n,e){if(n&1&&(E(0,"div",392)(1,"span"),v(2),ta(3,"date"),x(),E(4,"span",396),v(5),x(),E(6,"span",397),v(7),x()()),n&2){let t=e.$implicit,i=O(2);_(2),q(hl(3,4,t.date,"yyyy-MM-dd HH:mm")),_(3),q(t.condition),_(2),Ln("",t.turns," ",i.settings.t("TURNS"))}}function AW(n,e){if(n&1&&(E(0,"div",393),v(1),x()),n&2){let t=O(2);_(),q(t.settings.t("NO_RECORDS_YET"))}}function MW(n,e){if(n&1&&(E(0,"div",392)(1,"span"),v(2),ta(3,"date"),x(),E(4,"span",396),v(5),x(),E(6,"span",397),v(7),x()()),n&2){let t=e.$implicit,i=O(2);_(2),q(hl(3,4,t.date,"yyyy-MM-dd HH:mm")),_(3),q(t.condition),_(2),Ln("",t.turns," ",i.settings.t("TURNS"))}}function RW(n,e){if(n&1&&(E(0,"div",393),v(1),x()),n&2){let t=O(2);_(),q(t.settings.t("NO_RECORDS_YET"))}}function NW(n,e){if(n&1){let t=at();E(0,"div",231)(1,"div",384)(2,"div",385)(3,"h2",386),v(4),x(),E(5,"button",387),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.closeHighScores())}),v(6," \u2716 "),x()(),E(7,"div",388),v(8),x(),E(9,"div",389)(10,"div",390)(11,"h3",391),v(12),x(),On(13,DW,8,7,"div",392,$2,!1,AW,2,1,"div",393),x(),E(16,"div",390)(17,"h3",394),v(18),x(),On(19,MW,8,7,"div",392,$2,!1,RW,2,1,"div",393),x()(),E(22,"div",395),v(23),x()()()}if(n&2){let t=O();_(4),q(t.settings.t("HIGH_SCORES")),_(4),dl(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),_(4),q(t.settings.t("TOP_3_PLAYER")),_(),Fn(t.gameEngine.getHighScoresForCurrentCombo().wins),_(5),q(t.settings.t("TOP_3_LOSES_PLAYER")),_(),Fn(t.gameEngine.getHighScoresForCurrentCombo().losses),_(4),q(t.settings.t("CHANGE_RECORDS_INFO"))}}function PW(n,e){if(n&1){let t=at();E(0,"div",232)(1,"div",398),v(2," Debug Mode "),x(),E(3,"button",399),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.debugInstantWin())}),v(4," \u26A1 Instant Win "),x(),E(5,"button",400),ue("click",function(){he(t);let r=O();return fe(r.gameEngine.debugCycleSettings())}),v(6," \u{1F504} Cycle Settings "),x(),E(7,"div",401),v(8),x()()}if(n&2){let t=O();_(8),Ln(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var s0=class n{constructor(e,t,i,r){this.gameEngine=e;this.settings=t;this.firebase=i;this.router=r}boardContainer;isAutoBattleActive=z(!1);isMobileMenuOpen=z(!1);lastEconomyProcessedTurn=-1;ngOnInit(){this.gameEngine.resetGame()}ngOnDestroy(){this.isAutoBattleActive.set(!1),this.gameEngine.pauseGame()}goToHub(){this.isAutoBattleActive.set(!1),this.router.navigate(["/"])}get isProduction(){return!iM()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}centerOnSelectedUnit(){let e=this.boardContainer?.nativeElement;if(!e)return;let t=this.gameEngine.selectedUnit();if(!t)return;let i=this.gameEngine.tileSizePx,r=this.gameEngine.wallThicknessPx+2,o=i+r,s=t.position.x*o+i/2,a=t.position.y*o+i/2,l=Math.max(0,Math.min(s-e.clientWidth/2,e.scrollWidth-e.clientWidth)),u=Math.max(0,Math.min(a-e.clientHeight/2,e.scrollHeight-e.clientHeight));e.scrollTo({left:l,top:u,behavior:"smooth"})}activeKeys=new Set;onKeyDown(e){if(this.gameEngine.gameStatus()!=="playing")return;let t=e.key;if(t==="Tab"||t===" "||e.code==="Space"){e.preventDefault(),this.gameEngine.isPlayerTurn()&&this.gameEngine.selectNextAvailableUnitTab();return}if(t==="Enter"){e.preventDefault(),this.gameEngine.endPlayerTurn();return}let i=this.gameEngine.selectedUnit();if(!i||i.hasActed)return;this.activeKeys.add(t);let r=0,o=0;if((this.activeKeys.has("ArrowUp")||this.activeKeys.has("w")||this.activeKeys.has("W"))&&(o-=1),(this.activeKeys.has("ArrowDown")||this.activeKeys.has("s")||this.activeKeys.has("S"))&&(o+=1),(this.activeKeys.has("ArrowLeft")||this.activeKeys.has("a")||this.activeKeys.has("A"))&&(r-=1),(this.activeKeys.has("ArrowRight")||this.activeKeys.has("d")||this.activeKeys.has("D"))&&(r+=1),r===0&&o===0)return;e.preventDefault();let s=this.gameEngine.validMoves(),l=r!==0&&o!==0?i.tier===4?3:1:i.tier>=3||i.tier===2?2:1,u=null;for(let d=1;d<=l;d++){let h=i.position.x+r*d,p=i.position.y+o*d,g={x:h,y:p};if(s.some(w=>w.x===h&&w.y===p))u=g;else break}if(!u){let d={x:i.position.x,y:i.position.y},h={x:i.position.x+r,y:i.position.y+o};if(this.gameEngine.getWallBetween(d.x,d.y,h.x,h.y)){this.gameEngine.attackOrDestroyWallBetween(d,h);return}let g=this.gameEngine.getUnitAt(h.x,h.y);if(g&&g.owner!==i.owner){this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.isValidMove(h.x,h.y)&&this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.moveSelectedUnit(u)}onKeyUp(e){this.activeKeys.delete(e.key)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.settings.customMode()&&this.gameEngine.sandboxSpawnPending()){this.gameEngine.getUnitAt(e,t)||this.gameEngine.spawnSandboxAt({x:e,y:t});return}if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let i=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}let r=this.gameEngine.selectedUnit();if(r){let o=e-r.position.x,s=t-r.position.y;if(Math.abs(o)+Math.abs(s)===1&&this.gameEngine.getWallBetween(r.position.x,r.position.y,e,t)){this.gameEngine.attackOrDestroyWallBetween(r.position,{x:e,y:t});return}}if(i&&i.owner==="player"){this.gameEngine.selectUnit(i.id);return}this.gameEngine.selectUnit(null)}setCustomMode(e){this.settings.setCustomMode(e),this.gameEngine.resetGame()}onEdgeClick(e,t,i,r,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,i,r,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onDestroyIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:i},{x:r,y:o})}onBuildIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onAttackIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(r=>setTimeout(r,250)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.turn();this.lastEconomyProcessedTurn!==e&&(this.gameEngine.botEconomyPhase("player"),this.lastEconomyProcessedTurn=e),this.gameEngine.playerAutoStep()||this.gameEngine.selectUnit(null),this.gameEngine.remainingActions()===0&&(await new Promise(r=>setTimeout(r,1e3)),this.isAutoBattleActive()&&this.gameEngine.isPlayerTurn()&&this.gameEngine.endPlayerTurn())}static \u0275fac=function(t){return new(t||n)(Ee(ni),Ee(Kt),Ee(Ur),Ee(yi))};static \u0275cmp=Ot({type:n,selectors:[["app-game"]],viewQuery:function(t,i){if(t&1&&mp(rz,5),t&2){let r;yp(r=vp())&&(i.boardContainer=r.first)}},hostBindings:function(t,i){t&1&&ue("keydown",function(o){return i.onKeyDown(o)},ep)("keyup",function(o){return i.onKeyUp(o)},ep)},decls:377,vars:124,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],["title","Return to Gaming Hub",1,"p-2","bg-slate-800/50","hover:bg-slate-700","border","border-slate-700/50","rounded-lg","transition-all","group/btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-slate-400","group-hover/btn:text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["d","M6 18 L10 12 L14 18 Z","fill","#9ca3af"],["cx","12","cy","10","r","3","fill","#6b7280"],[1,"hud-value","font-mono","text-sm","font-bold","text-slate-300"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-6xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],["width","24","height","24","viewBox","0 0 24 24"],[1,"font-mono","text-lg","font-bold","text-slate-300"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","roadmap","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto","no-select"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"flex","items-center","justify-between","w-full","gap-2","z-10","text-amber-200"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","mine-area","forge-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click","mouseenter","mouseleave"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"z-index"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","-translate-x-4","translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"click"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none"],[1,"absolute","text-[10px]","font-bold","px-1","rounded","bg-yellow-300/80","text-black","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90",3,"z-index"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90"],["viewBox","0 0 128 128",1,"w-full","h-full"],["transform","translate(0,10) scale(1)"],["x","20","y","80","width","88","height","18","rx","4","fill","#6b7280"],["x","30","y","70","width","68","height","12","rx","3","fill","#9ca3af"],["d","M32 40 H96 L86 56 H42 Z","fill","#4b5563"],["x","56","y","30","width","16","height","12","rx","2","fill","#6b7280"],["x","60","y","20","width","8","height","12","rx","2","fill","#9ca3af"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer",3,"click"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer",3,"click"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],["cx","64","cy","96","rx","40","ry","10","fill","#374151"],["d","M32 96 L56 48 L72 80 L96 96 Z","fill","#6b7280","stroke","#4b5563","stroke-width","4"],["cx","58","cy","60","r","6","fill","#9ca3af"],["transform","translate(82, 30) rotate(-20) scale(1.3)"],["width","4","height","30","rx","2","fill","#6b7280"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#f59e0b","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none","move-anim",3,"shake","transform","z-index"],[1,"pointer-events-none","move-anim"],[1,"unit-svg-wrapper"],[3,"unit"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow",3,"bg-green-600","bg-amber-600","bg-red-600","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-left-1","opacity-70","[style.z-index]='100'"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"mt-3","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-pink-500","peer-checked:border-pink-500","transition-all"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,i){if(t&1){let r=at();E(0,"div",2)(1,"div",3),W(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),x(),Y(),E(7,"svg",9)(8,"defs")(9,"radialGradient",10),W(10,"stop",11)(11,"stop",12)(12,"stop",13),x(),E(13,"radialGradient",14),W(14,"stop",15)(15,"stop",16)(16,"stop",17),x(),E(17,"radialGradient",18),W(18,"stop",19)(19,"stop",20)(20,"stop",21),x(),E(21,"linearGradient",22),W(22,"stop",23)(23,"stop",24),x(),E(24,"filter",25),W(25,"feDropShadow",26),x()()(),E(26,"svg",27)(27,"defs")(28,"clipPath",28),W(29,"path",29),x(),E(30,"symbol",30),W(31,"path",31),x()()(),Ne(),E(32,"div",32)(33,"button",33),ue("click",function(){return he(r),fe(i.goToHub())}),Y(),E(34,"svg",34),W(35,"path",35),x()(),Ne(),E(36,"div",36),W(37,"div",37)(38,"div",38),Y(),E(39,"svg",39),W(40,"path",40)(41,"rect",41),x(),Ne(),W(42,"div",42)(43,"div",43),x(),E(44,"div",44)(45,"div",45)(46,"h1",46)(47,"span",47),v(48,"Shape"),x(),E(49,"span",48),v(50," Tactics "),x()(),E(51,"div",49),W(52,"div",50)(53,"div",51),x()(),E(54,"div",52)(55,"span",53),v(56),x()()(),W(57,"div",54),x(),E(58,"div",55)(59,"div",56)(60,"button",57),ue("click",function(){return he(r),fe(i.gameEngine.resetGame())}),Y(),E(61,"svg",58),W(62,"path",59),x(),Ne(),E(63,"span",60),v(64),x()(),W(65,"div",61),E(66,"button",62),ue("click",function(){return he(r),fe(i.gameEngine.toggleRules())}),Y(),E(67,"svg",63),W(68,"path",64),x(),Ne(),E(69,"span",65),v(70),x()()(),E(71,"div",66)(72,"button",67),ue("click",function(){return he(r),fe(i.gameEngine.toggleHighScores())}),Y(),E(73,"svg",68),W(74,"path",69),x(),Ne(),E(75,"span",70),v(76),x()(),E(77,"button",71),ue("click",function(){return he(r),fe(i.gameEngine.toggleLeaderboard())}),Y(),E(78,"svg",68),W(79,"path",72),x(),Ne(),E(80,"span",70),v(81),x()(),E(82,"button",73),ue("click",function(){return he(r),fe(i.gameEngine.toggleLog())}),Y(),E(83,"svg",68),W(84,"path",74),x(),Ne(),E(85,"span",70),v(86),x()(),E(87,"button",75),ue("click",function(){return he(r),fe(i.navigateToFeedback())}),Y(),E(88,"svg",68),W(89,"path",76),x(),Ne(),E(90,"span",70),v(91),x()()(),E(92,"div",77)(93,"button",78),ue("click",function(){return he(r),fe(i.gameEngine.toggleSettings())}),Y(),E(94,"svg",79),W(95,"path",80)(96,"path",81),x()(),J(97,az,9,3,"div",82)(98,lz,4,1,"button",83),x()(),Ne(),E(99,"div",84)(100,"div",85),Y(),E(101,"svg",86),W(102,"rect",87)(103,"circle",88),x(),Ne(),E(104,"span",89),v(105),x()(),E(106,"div",85),Y(),E(107,"svg",86),W(108,"path",90)(109,"circle",91),x(),Ne(),E(110,"span",92),v(111),x()(),E(112,"div",85),Y(),E(113,"svg",86),W(114,"polygon",93),x(),Ne(),E(115,"span",94),v(116),x()(),E(117,"div",85),Y(),E(118,"svg",86),W(119,"circle",95)(120,"path",96),x(),Ne(),E(121,"span",97),v(122),x()(),E(123,"div",85),Y(),E(124,"svg",86),W(125,"path",98)(126,"rect",99)(127,"rect",100),x(),Ne(),E(128,"span",101),v(129),x()(),E(130,"button",102),ue("click",function(){return he(r),fe(i.toggleMobileMenu())}),Y(),E(131,"svg",103),W(132,"path",104),x()()(),Ne(),E(133,"div",105)(134,"button",106),ue("click",function(){return he(r),fe(i.gameEngine.toggleBuildMode())}),Y(),E(135,"svg",86),W(136,"path",107),x()(),Ne(),E(137,"button",106),ue("click",function(){return he(r),fe(i.gameEngine.convertWoodToReserve())}),v(138," +1 "),x(),E(139,"button",106),ue("click",function(){return he(r),fe(i.gameEngine.maxConvertWoodToReserve())}),v(140),x(),E(141,"label",108)(142,"div",109)(143,"input",110),ue("change",function(){return he(r),fe(i.gameEngine.toggleFogDebug())}),x(),E(144,"div",111),W(145,"div",112),x()(),E(146,"span",113),v(147),x()(),E(148,"div",114),v(149),x(),E(150,"button",115),ue("click",function(){return he(r),fe(i.gameEngine.endPlayerTurn())}),Y(),E(151,"svg",116),W(152,"path",117)(153,"path",118),x()()(),J(154,dz,23,9,"div",119),Ne(),E(155,"div",120),W(156,"div",121),E(157,"div",122)(158,"div",123)(159,"span",124),v(160),x(),E(161,"span",125),v(162),x()(),W(163,"div",126),E(164,"div",127)(165,"div",128)(166,"span",129),Y(),E(167,"svg",130),W(168,"rect",87)(169,"circle",131)(170,"circle",132)(171,"rect",133)(172,"circle",134)(173,"circle",135),x()(),Ne(),E(174,"span",136),v(175),x()(),E(176,"div",128)(177,"span",129),Y(),E(178,"svg",137),W(179,"path",90)(180,"circle",91),x()(),Ne(),E(181,"span",138),v(182),x()(),E(183,"div",139)(184,"span",129)(185,"div",140),Y(),E(186,"svg",141),W(187,"polygon",142)(188,"rect",143)(189,"polygon",144)(190,"rect",145)(191,"polygon",146)(192,"rect",147),E(193,"g",148),W(194,"rect",149)(195,"polygon",150),x(),E(196,"g",151),W(197,"rect",152)(198,"circle",153)(199,"circle",154),x()()()(),Ne(),E(200,"span",155),v(201),E(202,"span",156),v(203,"/"),x(),v(204),x()()()(),E(205,"div",157),W(206,"div",158),E(207,"span",159),v(208),x(),E(209,"div",45)(210,"span",160),v(211),x()(),J(212,hz,2,3,"div",161),x(),E(213,"div",122)(214,"div",127)(215,"div",128)(216,"span",162),v(217),x(),E(218,"span",129),Y(),E(219,"svg",130),W(220,"rect",87)(221,"circle",131)(222,"circle",132)(223,"rect",133)(224,"circle",134)(225,"circle",135),x()()(),Ne(),E(226,"div",128)(227,"span",129),Y(),E(228,"svg",137),W(229,"path",90)(230,"circle",91),x()(),Ne(),E(231,"span",138),v(232),x()(),E(233,"div",163)(234,"span",164),v(235),E(236,"span",156),v(237,"/"),x(),v(238),x(),E(239,"span",129)(240,"div",140),Y(),E(241,"svg",141),W(242,"polygon",142)(243,"rect",143)(244,"polygon",144)(245,"rect",145)(246,"polygon",146)(247,"rect",147),E(248,"g",148),W(249,"rect",149)(250,"polygon",165),x(),E(251,"g",151),W(252,"rect",152)(253,"circle",153)(254,"circle",154),x()()()()()(),Ne(),W(255,"div",126),E(256,"div",166)(257,"span",167),v(258),x(),E(259,"span",168),v(260,"jaerbi"),x()()()(),J(261,gz,11,11,"div",169),E(262,"button",170),ue("click",function(){return he(r),fe(i.navigateToRoadmap())}),E(263,"div",171),W(264,"div",172),E(265,"span",173),v(266),x()(),E(267,"div",174),Y(),E(268,"svg",175),W(269,"path",176),x()()(),Ne(),E(270,"button",177),ue("click",function(){return he(r),fe(i.gameEngine.toggleSupport())}),E(271,"span",129),v(272,"\u2764\uFE0F"),x(),E(273,"span",178),v(274),x()(),J(275,mz,1,0,"app-support-community"),J(276,yz,1,0,"app-leaderboard-modal"),E(277,"div",179),J(278,vz,1,0,"app-sandbox"),E(279,"div",180,0)(281,"div",181)(282,"div",182)(283,"span",183),v(284),x()(),J(285,_z,3,1,"div",184),On(286,EW,2,0,null,null,Sr),x()(),E(288,"div",185)(289,"div",186),W(290,"div",187),E(291,"div",188)(292,"span",189),v(293),x(),E(294,"div",190)(295,"span",191),v(296),x(),E(297,"div",192)(298,"span",129),v(299),x()()(),E(300,"div",193),W(301,"div",194),x()()()(),E(302,"div",195)(303,"div",196)(304,"button",197),ue("click",function(){return he(r),fe(i.toggleAutoBattle())}),E(305,"div",198)(306,"span",199),v(307),x(),E(308,"span",200),v(309),x()(),E(310,"div",198),W(311,"span",201),x(),W(312,"div",202),x(),E(313,"button",203),ue("click",function(){return he(r),fe(i.gameEngine.toggleBuildMode())}),E(314,"div",204)(315,"span",205),v(316,"+1"),x(),E(317,"div",206),Y(),E(318,"svg",207),W(319,"path",208)(320,"path",209)(321,"path",210)(322,"rect",211),x()()(),Ne(),E(323,"div",212)(324,"span"),v(325,"-10"),x(),E(326,"div",213),Y(),E(327,"svg",214),W(328,"rect",215)(329,"circle",216)(330,"circle",217),x()()(),Ne(),W(331,"div",202),x(),E(332,"button",218),ue("click",function(){return he(r),fe(i.gameEngine.convertWoodToReserve())}),E(333,"div",219)(334,"span",220)(335,"span"),v(336,"20"),x(),E(337,"div",213),Y(),E(338,"svg",214),W(339,"rect",215)(340,"circle",216)(341,"circle",217),x()()(),Ne(),E(342,"span",129),v(343,"\u2794"),x(),E(344,"span",221),v(345,"1 \u{1F464}"),x()()(),E(346,"button",222),ue("click",function(){return he(r),fe(i.gameEngine.maxConvertWoodToReserve())}),E(347,"div",223)(348,"span",224),v(349),x(),E(350,"span",129),v(351,"\u2794"),x(),E(352,"span",129),v(353,"\u{1F465}++"),x()()()(),E(354,"label",225)(355,"div",109)(356,"input",110),ue("change",function(){return he(r),fe(i.gameEngine.toggleFogDebug())}),x(),E(357,"div",111),W(358,"div",112),x()(),E(359,"span",113),v(360),x()(),E(361,"button",226),ue("click",function(){return he(r),fe(i.gameEngine.endPlayerTurn())}),E(362,"div",227)(363,"span",224),v(364),x(),Y(),E(365,"svg",116),W(366,"path",117)(367,"path",118),x()()(),Ne(),E(368,"div",114),v(369),x()()(),E(370,"div",228),v(371),x(),J(372,bW,1,0,"app-game-rules"),J(373,SW,24,5,"div",229),J(374,CW,34,14,"div",230),J(375,NW,24,9,"div",231),J(376,PW,9,2,"div",232),x()}if(t&2){let r;_(56),q(i.settings.version),_(8),X(" ",i.settings.t("RELOAD")," "),_(6),X(" ",i.settings.t("INFO")," "),_(6),q(i.settings.t("RECORDS")),_(5),q(i.settings.t("RANKING")),_(5),q(i.settings.t("SYSTEM_LOG")),_(5),q(i.settings.t("FEEDBACK_MODULE")),_(6),Z((r=i.firebase.user$())?97:98,r),_(8),q(i.gameEngine.resources().wood),_(6),q(i.gameEngine.resources().iron),_(5),Ln(" ",i.gameEngine.getForestControl().player,"/",i.gameEngine.getForestControl().total," "),_(6),q(i.gameEngine.turn()),_(7),Ln(" ",i.gameEngine.getForestControl().player," : ",i.gameEngine.getForestControl().ai," "),_(5),Je("disabled",!i.gameEngine.canBuildThisTurn()),_(3),Je("disabled",!i.gameEngine.canAddReserveTurn()),_(2),Je("disabled",!i.gameEngine.canAddReserveTurn()),_(),X(" ",i.settings.t("ALL")," "),_(3),Je("checked",i.gameEngine.fogDebugDisabled()),_(4),q(i.settings.t("MAP_HACK")),_(2),Ln(" ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),_(5),Z(i.isMobileMenuOpen()?154:-1),_(6),X(" ",i.settings.t("COMMANDER")," "),_(2),X(" ",i.settings.t("PLAYER")," "),_(3),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),_(10),q(i.gameEngine.resources().wood),_(),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),_(6),q(i.gameEngine.resources().iron),_(),Ft("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),_(18),X(" ",i.gameEngine.getForestControl().player," "),_(3),X(" ",i.gameEngine.getForestControl().total," "),_(4),X(" ",i.settings.t("TURN_CYCLE")," "),_(3),X(" ",i.gameEngine.turn()," "),_(),Z(i.gameEngine.monopolyTurnsLeft()>0?212:-1),_(3),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),_(2),q(i.gameEngine.aiWood()),_(9),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),_(6),q(i.gameEngine.aiIron()),_(),Ft("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),_(2),X(" ",i.gameEngine.getForestControl().ai," "),_(3),X(" ",i.gameEngine.getForestControl().total," "),_(20),X(" ",i.settings.t("HOSTILE")," "),_(3),Z(i.gameEngine.shouldShowEndOverlay()?261:-1),_(5),X(" ",i.settings.t("STRATEGIC_PLAN")," "),_(8),q(i.settings.t("SUPPORT")),_(),Z(i.gameEngine.supportOpen()?275:-1),_(),Z(i.gameEngine.leaderboardOpen()?276:-1),_(2),Z(i.settings.customMode()?278:-1),_(),Be("shake",i.gameEngine.screenShake())("mood-none",i.gameEngine.currentMood()==="none")("mood-angry",i.gameEngine.currentMood()==="angry")("mood-rage",i.gameEngine.currentMood()==="rage"),_(2),nt("grid-template-columns","repeat("+i.gameEngine.gridSize+", minmax("+i.gameEngine.tileMinSizePx+"px, "+i.gameEngine.tileSizePx+"px))")("gap",i.gameEngine.wallThicknessPx+2,"px"),_(3),X(" ",i.gameEngine.baseHealth().player," "),_(),Z(i.gameEngine.isVisibleToPlayer(i.gameEngine.gridSize-1,i.gameEngine.gridSize-1)?285:-1),_(),Fn(i.gameEngine.gridRows),_(4),Be("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),_(3),q(i.settings.t("RISK")),_(2),Be("text-lime-300",i.settings.difficulty()==="baby")("text-emerald-300",i.settings.difficulty()==="normal")("text-orange-400",i.settings.difficulty()==="hard")("text-red-500",i.settings.difficulty()==="nightmare"),_(),X(" ",i.settings.t(i.settings.getDifficultyLabel(i.settings.difficulty()))," "),_(3),X(" ",i.settings.difficulty()==="baby"?"\u{1F476}":i.settings.difficulty()==="normal"?"\u{1F920}":i.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),_(2),nt("width",i.settings.difficulty()==="baby"?25:i.settings.difficulty()==="normal"?50:i.settings.difficulty()==="hard"?75:100,"%"),Be("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),_(3),Be("ring-2",i.isAutoBattleActive())("ring-green-400",i.isAutoBattleActive()),Je("disabled",i.gameEngine.gameStatus()!=="playing"),_(3),q(i.settings.t("AUTO")),_(2),q(i.settings.t("ENGAGE")),_(2),Be("bg-green-400",i.isAutoBattleActive())("bg-gray-500",!i.isAutoBattleActive()),_(2),Be("ring-2",i.gameEngine.buildMode())("ring-blue-400",i.gameEngine.buildMode()),Je("disabled",i.gameEngine.wallBuiltThisTurn()||!i.gameEngine.canBuildThisTurn()),_(19),Je("disabled",!i.gameEngine.canAddReserveTurn()),_(14),Je("disabled",!i.gameEngine.canAddReserveTurn()),_(3),q(i.settings.t("ALL")),_(7),Je("checked",i.gameEngine.fogDebugDisabled()),_(4),q(i.settings.t("MAP_HACK")),_(4),q(i.settings.t("NEXT_TURN")),_(5),dl(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),_(2),X(" ",i.settings.version," | \xA9\uFE0E Created by jaerbi and just "),_(),Z(i.gameEngine.rulesOpen()?372:-1),_(),Z(i.gameEngine.logOpen()?373:-1),_(),Z(i.gameEngine.settingsOpen()?374:-1),_(),Z(i.gameEngine.highScoresOpen()?375:-1),_(),Z(i.isProduction?-1:376)}},dependencies:[qt,t0,n0,i0,r0,o0,TE,ku],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}.move-anim[_ngcontent-%COMP%]{transition:transform .15s cubic-bezier(.4,0,.2,1);will-change:transform}"]})};var Z2=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(Ee(Xs),Ee(zi))};static \u0275dir=_n({type:n})}return n})(),kW=(()=>{class n extends Z2{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Zs(n)))(r||n)}})();static \u0275dir=_n({type:n,features:[wr]})}return n})(),X2=new ve("");var OW={provide:X2,useExisting:Uo(()=>p0),multi:!0};function FW(){let n=Di()?Di().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var LW=new ve(""),p0=(()=>{class n extends Z2{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!FW())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(Ee(Xs),Ee(zi),Ee(LW,8))};static \u0275dir=_n({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&ue("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Su([OW]),wr]})}return n})();function MS(n){return n==null||RS(n)===0}function RS(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var eO=new ve(""),tO=new ve(""),VW=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,To=class{static min(e){return UW(e)}static max(e){return BW(e)}static required(e){return jW(e)}static requiredTrue(e){return HW(e)}static email(e){return $W(e)}static minLength(e){return GW(e)}static maxLength(e){return zW(e)}static pattern(e){return WW(e)}static nullValidator(e){return nO()}static compose(e){return lO(e)}static composeAsync(e){return uO(e)}};function UW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function BW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function jW(n){return MS(n.value)?{required:!0}:null}function HW(n){return n.value===!0?null:{required:!0}}function $W(n){return MS(n.value)||VW.test(n.value)?null:{email:!0}}function GW(n){return e=>{let t=e.value?.length??RS(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function zW(n){return e=>{let t=e.value?.length??RS(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function WW(n){if(!n)return nO;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(MS(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function nO(n){return null}function iO(n){return n!=null}function rO(n){return qo(n)?sn(n):n}function oO(n){let e={};return n.forEach(t=>{e=t!=null?L(L({},e),t):e}),Object.keys(e).length===0?null:e}function sO(n,e){return e.map(t=>t(n))}function qW(n){return!n.validate}function aO(n){return n.map(e=>qW(e)?e:t=>e.validate(t))}function lO(n){if(!n)return null;let e=n.filter(iO);return e.length==0?null:function(t){return oO(sO(t,e))}}function cO(n){return n!=null?lO(aO(n)):null}function uO(n){if(!n)return null;let e=n.filter(iO);return e.length==0?null:function(t){let i=sO(t,e).map(rO);return ay(i).pipe(yt(oO))}}function dO(n){return n!=null?uO(aO(n)):null}function G2(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function hO(n){return n._rawValidators}function fO(n){return n._rawAsyncValidators}function TS(n){return n?Array.isArray(n)?n:[n]:[]}function l0(n,e){return Array.isArray(n)?n.includes(e):n===e}function z2(n,e){let t=TS(e);return TS(n).forEach(r=>{l0(t,r)||t.push(r)}),t}function W2(n,e){return TS(e).filter(t=>!l0(n,t))}var c0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=cO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=dO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},uc=class extends c0{name;get formDirective(){return null}get path(){return null}},Qd=class extends c0{_parent=null;name=null;valueAccessor=null},u0=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var pO=(()=>{class n extends u0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(Ee(Qd,2))};static \u0275dir=_n({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Be("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[wr]})}return n})(),gO=(()=>{class n extends u0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(Ee(uc,10))};static \u0275dir=_n({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Be("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[wr]})}return n})();var zd="VALID",a0="INVALID",lc="PENDING",Wd="DISABLED",ys=class{},d0=class extends ys{value;source;constructor(e,t){super(),this.value=e,this.source=t}},qd=class extends ys{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Kd=class extends ys{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},cc=class extends ys{status;source;constructor(e,t){super(),this.status=e,this.source=t}},CS=class extends ys{source;constructor(e){super(),this.source=e}},Yd=class extends ys{source;constructor(e){super(),this.source=e}};function NS(n){return(g0(n)?n.validators:n)||null}function KW(n){return Array.isArray(n)?cO(n):n||null}function PS(n,e){return(g0(e)?e.asyncValidators:n)||null}function QW(n){return Array.isArray(n)?dO(n):n||null}function g0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function mO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new de(1e3,"");if(!i[t])throw new de(1001,"")}function yO(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new de(1002,"")})}var dc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return ln(this.statusReactive)}set status(e){ln(()=>this.statusReactive.set(e))}_status=Xn(()=>this.statusReactive());statusReactive=z(void 0);get valid(){return this.status===zd}get invalid(){return this.status===a0}get pending(){return this.status==lc}get disabled(){return this.status===Wd}get enabled(){return this.status!==Wd}errors;get pristine(){return ln(this.pristineReactive)}set pristine(e){ln(()=>this.pristineReactive.set(e))}_pristine=Xn(()=>this.pristineReactive());pristineReactive=z(!0);get dirty(){return!this.pristine}get touched(){return ln(this.touchedReactive)}set touched(e){ln(()=>this.touchedReactive.set(e))}_touched=Xn(()=>this.touchedReactive());touchedReactive=z(!1);get untouched(){return!this.touched}_events=new Gt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(z2(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(z2(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(W2(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(W2(e,this._rawAsyncValidators))}hasValidator(e){return l0(this._rawValidators,e)}hasAsyncValidator(e){return l0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(me(L({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Kd(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Kd(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(me(L({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new qd(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new qd(!0,i))}markAsPending(e={}){this.status=lc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new cc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(me(L({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Wd,this.errors=null,this._forEachChild(r=>{r.disable(me(L({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new d0(this.value,i)),this._events.next(new cc(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(me(L({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=zd,this._forEachChild(i=>{i.enable(me(L({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(me(L({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===zd||this.status===lc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new d0(this.value,t)),this._events.next(new cc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(me(L({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Wd:zd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=lc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=rO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new cc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new an,this.statusChanges=new an}_calculateStatus(){return this._allControlsDisabled()?Wd:this.errors?a0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(lc)?lc:this._anyControlsHaveStatus(a0)?a0:zd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new qd(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Kd(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){g0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=KW(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=QW(this._rawAsyncValidators)}},hc=class extends dc{constructor(e,t,i){super(NS(t),PS(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){yO(this,!0,e),Object.keys(e).forEach(i=>{mO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,me(L({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Yd(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var DS=class extends hc{};var vO=new ve("",{factory:()=>kS}),kS="always";function YW(n,e){return[...e.path,n]}function q2(n,e,t=kS){OS(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),ZW(n,e),eq(n,e),XW(n,e),JW(n,e)}function K2(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),f0(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function h0(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function JW(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function OS(n,e){let t=hO(n);e.validator!==null?n.setValidators(G2(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=fO(n);e.asyncValidator!==null?n.setAsyncValidators(G2(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();h0(e._rawValidators,r),h0(e._rawAsyncValidators,r)}function f0(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=hO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=fO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return h0(e._rawValidators,i),h0(e._rawAsyncValidators,i),t}function ZW(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&_O(n,e)})}function XW(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&_O(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function _O(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function eq(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function tq(n,e){n==null,OS(n,e)}function nq(n,e){return f0(n,e)}function iq(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function rq(n){return Object.getPrototypeOf(n.constructor)===kW}function oq(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function sq(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===p0?t=o:rq(o)?i=o:r=o}),r||i||t||null}function aq(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Q2(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Y2(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Ra=class extends dc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(NS(t),PS(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),g0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Y2(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Yd(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Q2(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Q2(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Y2(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var lq=n=>n instanceof Ra;var EO=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=_n({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var AS=class extends dc{constructor(e,t,i){super(NS(t),PS(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){yO(this,!1,e),e.forEach((i,r)=>{mO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],me(L({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Yd(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var cq=(()=>{class n extends uc{callSetDisabledState;get submitted(){return ln(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=Xn(()=>this._submittedReactive());_submittedReactive=z(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(f0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let i=this.form.get(t.path);return q2(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){K2(t.control||null,t,!1),aq(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,i){this.form.get(t.path).setValue(i)}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,oq(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new CS(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(K2(i||null,t),lq(r)&&(q2(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);tq(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&nq(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){OS(this.form,this),this._oldForm&&f0(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(i){return new(i||n)(Ee(eO,10),Ee(tO,10),Ee(vO,8))};static \u0275dir=_n({type:n,features:[wr,Xr]})}return n})();var bO=new ve("");var uq={provide:Qd,useExisting:Uo(()=>FS)},FS=(()=>{class n extends Qd{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new an;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=sq(this,o)}ngOnChanges(t){this._added||this._setUpControl(),iq(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return YW(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(Ee(uc,13),Ee(eO,10),Ee(tO,10),Ee(X2,10),Ee(bO,8))};static \u0275dir=_n({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Su([uq]),wr,Xr]})}return n})();var dq={provide:uc,useExisting:Uo(()=>LS)},LS=(()=>{class n extends cq{form=null;ngSubmit=new an;get control(){return this.form}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Zs(n)))(r||n)}})();static \u0275dir=_n({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&ue("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Su([dq]),wr]})}return n})();var hq=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=to({type:n});static \u0275inj=dr({})}return n})();function J2(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var wO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return J2(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new hc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new DS(r,i)}control(t,i,r){let o={};return this.useNonNullable?(J2(i)?o=i:(o.validators=i,o.asyncValidators=r),new Ra(t,me(L({},o),{nonNullable:!0}))):new Ra(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new AS(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof Ra)return t;if(t instanceof dc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var xO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:bO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:vO,useValue:t.callSetDisabledState??kS}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=to({type:n});static \u0275inj=dr({imports:[hq]})}return n})();var m0=class n{db;auth;constructor(){let e=ad(Xm);this.db=Pd(e),this.auth=Gd(e)}async addFeedback(e){let t=me(L({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:zx()});await Nm(nr(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=fs(nr(this.db,"feedbacks"),wo("timestamp","desc"),Ta(e));return(await Ca(t)).docs.map(r=>r.data())}async getFeedbackPage(e,t){let i=[wo("timestamp","desc"),Ta(e)],r=t?fs(nr(this.db,"feedbacks"),wo("timestamp","desc"),Kk(t),Ta(e)):fs(nr(this.db,"feedbacks"),wo("timestamp","desc"),Ta(e)),o=await Ca(r),s=o.docs.map(l=>l.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),i=fs(nr(this.db,"feedbacks"),ps("userId","==",e),ps("timestamp",">=",t)),o=(await Ca(i)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var VS=()=>[1,2,3,4,5],SO=(n,e)=>e.timestamp;function gq(n,e){if(n&1){let t=at();E(0,"button",39),ue("click",function(){let r=he(t).$implicit,o=O(2);return fe(o.setRating(r))}),v(1," \u2605 "),x()}if(n&2){let t=e.$implicit,i=O(2);Be("active",i.form.value.rating>=t)}}function mq(n,e){if(n&1&&(E(0,"div",36),v(1),x()),n&2){let t=O(2);_(),q(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function yq(n,e){n&1&&(E(0,"div",37),v(1),x()),n&2&&(_(),q(e))}function vq(n,e){if(n&1){let t=at();E(0,"div",25)(1,"div",26),W(2,"img",27),x(),E(3,"div",28)(4,"div",29),v(5),x(),E(6,"div",30),v(7),x()()(),E(8,"form",31),ue("ngSubmit",function(){he(t);let r=O();return fe(r.submit())}),E(9,"div")(10,"div",32),v(11),x(),E(12,"div",33),On(13,gq,2,2,"button",34,Sr),x()(),E(15,"div")(16,"div",32),v(17),x(),W(18,"textarea",35),J(19,mq,2,1,"div",36),J(20,yq,2,1,"div",37),x(),E(21,"button",38),v(22),x()()}if(n&2){let t,i=e,r=O();_(2),Je("src",i.photoURL,qi),_(3),q(i.displayName),_(2),q(r.settings.t("OPERATOR_ONLINE")),_(),Je("formGroup",r.form),_(3),q(r.settings.t("EFFICIENCY_RATING")),_(2),Fn(ea(16,VS)),_(4),q(r.settings.t("TACTICAL_NOTE")),_(),Je("placeholder",nE(r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),_(),Z(r.form.controls.text.errors?19:-1),_(),Z((t=r.message())?20:-1,t),_(),Be("cursor-pointer",r.canSubmit)("cursor-not-allowed",!r.canSubmit),Je("disabled",!r.canSubmit),_(),X(" ",r.settings.t("TRANSMIT_REPORT")," ")}}function _q(n,e){if(n&1&&(E(0,"div",21),v(1),x()),n&2){let t=O();_(),q(t.settings.t("SYSTEM_LOG"))}}function Eq(n,e){if(n&1&&(E(0,"div",22),v(1),x()),n&2){let t=O();_(),q(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function bq(n,e){if(n&1&&(E(0,"span"),v(1,"\u2605"),x()),n&2){let t=e.$implicit,i=O().$implicit;Be("active",i.rating>=t)}}function wq(n,e){if(n&1&&(E(0,"tr",44)(1,"td",47),W(2,"img",48),E(3,"span"),v(4),x()(),E(5,"td",49)(6,"div",50),On(7,bq,2,2,"span",51,Sr),x()(),E(9,"td",49)(10,"span",52),v(11),x()(),E(12,"td",49)(13,"span",53),v(14),x()()()),n&2){let t=e.$implicit,i=O(2);_(2),Je("src",t.userPhoto,qi),_(2),q(t.userName),_(3),Fn(ea(4,VS)),_(4),q(t.text),_(3),q(i.formatDate(t.timestamp))}}function xq(n,e){if(n&1&&(E(0,"tr")(1,"td",54),v(2),x()()),n&2){let t=O(2);_(2),q(t.settings.t("NO_SIGNALS"))}}function Sq(n,e){if(n&1){let t=at();E(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),v(5),x(),E(6,"th",43),v(7),x(),E(8,"th",43),v(9),x(),E(10,"th",43),v(11),x()()(),E(12,"tbody"),On(13,wq,15,5,"tr",44,SO,!1,xq,3,1,"tr"),x()()(),E(16,"div",45)(17,"button",46),ue("click",function(){he(t);let r=O();return fe(r.prevPage())}),v(18),x(),E(19,"button",46),ue("click",function(){he(t);let r=O();return fe(r.nextPage())}),v(20),x()()}if(n&2){let t=O();_(5),q(t.settings.t("TABLE_OPERATOR")),_(2),q(t.settings.t("TABLE_RATING")),_(2),q(t.settings.t("TABLE_MESSAGE")),_(2),q(t.settings.t("TABLE_DATE")),_(2),Fn(t.pageItems()),_(5),X(" ",t.settings.t("PREVIOUS")," "),_(2),X(" ",t.settings.t("NEXT")," ")}}function Iq(n,e){if(n&1&&(E(0,"span"),v(1,"\u2605"),x()),n&2){let t=e.$implicit,i=O().$implicit;Be("active",i.rating>=t)}}function Tq(n,e){if(n&1&&(E(0,"div",55)(1,"div",56)(2,"div",57),W(3,"img",58),E(4,"div",59),v(5),x()(),E(6,"div",50),On(7,Iq,2,2,"span",51,Sr),x()(),E(9,"div",60),v(10),x()()),n&2){let t=e.$implicit;_(3),Je("src",t.userPhoto,qi),_(2),q(t.userName),_(2),Fn(ea(3,VS)),_(3),q(t.text)}}function Cq(n,e){if(n&1&&On(0,Tq,11,4,"div",55,SO),n&2){let t=O();Fn(t.recent())}}var y0=class n{constructor(e,t,i,r,o){this.fb=e;this.router=t;this.feedback=i;this.firebase=r;this.settings=o;this.form=new hc({text:new Ra("",{nonNullable:!0,validators:[To.required,To.minLength(10),To.maxLength(500)]}),rating:new Ra(5,{nonNullable:!0,validators:[To.required,To.min(1),To.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,l=Number(localStorage.getItem(a)||0);this.disabledUntil.set(l)}this.loadPage(0)}recent=z([]);pageItems=z([]);pageStack=[null];pageIndex=z(0);lastDoc=null;disabledUntil=z(0);message=z(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);if(this.pageItems.set(r.items),this.lastDoc=r.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);this.pageItems.set(r.items),this.lastDoc=r.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:i}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let r=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:r.text||"",rating:Number(r.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(Ee(wO),Ee(yi),Ee(m0),Ee(Ur),Ee(Kt))};static \u0275cmp=Ot({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,i){if(t&1&&(E(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),x(),Y(),E(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),x()()(),Ne(),E(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),v(15),x(),E(16,"span",14),v(17),x()(),E(18,"a",15),v(19),x()(),E(20,"div",16)(21,"div",17)(22,"div",18),v(23),x(),J(24,vq,23,17),x(),E(25,"div",19)(26,"div",20),J(27,_q,2,1,"div",21),J(28,Eq,2,1,"div",22),E(29,"button",23),ue("click",function(){return i.isAllShow=!i.isAllShow}),v(30),x()(),E(31,"div",24),J(32,Sq,21,7),J(33,Cq,2,0),x()()()()()),t&2){let r;_(15),q(i.settings.t("FEEDBACK_MODULE")),_(2),q(i.settings.t("COMMUNITY_SIGNALS")),_(2),q(i.settings.t("RETURN_TO_MAP")),_(4),q(i.settings.t("DEPLOY_REPORT")),_(),Z((r=i.firebase.user$())?24:-1,r),_(3),Z(i.isAllShow?-1:27),_(),Z(i.isAllShow?28:-1),_(2),X(" ",i.isAllShow?i.settings.t("TOGGLE_BACK"):i.settings.t("VIEW_FULL_ARCHIVE")," "),_(2),Z(i.isAllShow?32:-1),_(),Z(i.isAllShow?-1:33)}},dependencies:[qt,xO,EO,p0,pO,gO,LS,FS,Tl],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var v0=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(Ee(Kt))};static \u0275cmp=Ot({type:n,selectors:[["app-roadmap"]],decls:93,vars:13,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"absolute","top-0","right-0","w-16","h-16","bg-emerald-500/10","blur-2xl","-mr-8","-mt-8"],[1,"card-header","relative","z-10"],[1,"text-[11px]","font-mono","text-emerald-200/50","italic"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","uppercase","tracking-wider","bg-emerald-500/20","text-emerald-400","border","border-emerald-500/40"],[1,"flex","items-start","gap-4","mt-4","relative","z-10"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/60","rotate-45","flex","items-center","justify-center","group-hover:rotate-180","transition-all","duration-700","shadow-[0_0_15px_rgba(16,185,129,0.2)]"],[1,"-rotate-45","group-hover:-rotate-180","transition-all","duration-700","text-xl"],[1,"text-lg","font-bold","text-emerald-50","leading-tight","mb-2","opacity-80","decoration-emerald-500/30","line-through","decoration-2"],[1,"text-sm","text-emerald-100/40","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-emerald-500/10","flex","justify-between","items-center","relative","z-10"],[1,"text-[9px]","uppercase","tracking-widest","text-emerald-500/40","font-bold"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-emerald-500","shadow-[0_0_5px_#10b981]"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,i){t&1&&(E(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),x(),Y(),E(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),x()()(),Ne(),W(11,"div",10)(12,"div",11),E(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),W(17,"div",16),E(18,"h1",17),v(19),x()(),E(20,"p",18),v(21,"Future_Ops // Deployment_Schedule"),x()(),E(22,"a",19)(23,"span",20),v(24,"\xAB"),x(),v(25),x()(),E(26,"div",21)(27,"div",22),W(28,"div",23),E(29,"div",24)(30,"span",25),v(31,"REF: PROJECT_VOLUMETRIC"),x(),E(32,"span",26),v(33),x()(),E(34,"div",27)(35,"div",28)(36,"div",29),v(37),x()(),E(38,"div")(39,"h3",30),v(40),x(),E(41,"p",31),v(42),x()()(),E(43,"div",32)(44,"span",33),v(45,"System_Verified"),x(),E(46,"div",34),W(47,"div",35)(48,"div",35)(49,"div",35),x()()(),E(50,"div",22)(51,"div",36)(52,"span",37),v(53,"REF: RESOURCE_IRON"),x(),E(54,"span",26),v(55),x()(),E(56,"div",38)(57,"div",39)(58,"span"),v(59,"\u26D3\uFE0F"),x()(),E(60,"div")(61,"h3",40),v(62),x(),E(63,"p",41),v(64),x()()(),E(65,"div",42)(66,"span",43),v(67,"Priority_Beta"),x(),E(68,"div",34),W(69,"div",44)(70,"div",45)(71,"div",45),x()()(),E(72,"div",46)(73,"div",36)(74,"span",37),v(75,"REF: INFRA_SMITHY"),x(),E(76,"span",26),v(77),x()(),E(78,"div",47)(79,"div",48),W(80,"div",49),E(81,"span",50),v(82,"\u2692\uFE0F"),x()(),E(83,"div")(84,"h3",51),v(85),x(),E(86,"p",52),v(87),x()()()()(),E(88,"div",53)(89,"div",54),v(90,"Community_Intel"),x(),E(91,"p",55),v(92),x()()()()),t&2&&(_(19),X(" ",i.settings.t("STRATEGIC_PLAN")," "),_(6),X(" ",i.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),_(8),X(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),_(4),X(" ",i.settings.currentLang()==="uk"?"\u2714\uFE0F":"\u2705"," "),_(3),X(" ",i.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"," "),_(2),X(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),_(13),X(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),_(7),q(i.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),_(2),X(" ",i.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),_(13),X(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),_(8),q(i.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),_(2),X(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),_(5),X(" ",i.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[qt,Tl],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var _0=class n{constructor(e,t){this.router=e;this.settings=t}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||n)(Ee(yi),Ee(Kt))};static \u0275cmp=Ot({type:n,selectors:[["app-landing-page"]],decls:41,vars:2,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden","relative"],[1,"absolute","top-1/4","-left-1/4","w-96","h-96","bg-emerald-500/20","rounded-full","blur-3xl","animate-pulse"],[1,"absolute","bottom-1/4","-right-1/4","w-96","h-96","bg-purple-500/20","rounded-full","blur-3xl","animate-pulse",2,"animation-delay","2s"],[1,"z-10","text-center","mb-12"],[1,"text-6xl","font-black","tracking-tighter","mb-4","bg-gradient-to-r","from-emerald-400","to-cyan-400","bg-clip-text","text-transparent","drop-shadow-sm"],[1,"text-slate-400","text-lg","max-w-md","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","w-full","max-w-5xl","z-10"],[1,"group","relative","overflow-hidden","bg-slate-900","border","border-emerald-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-emerald-400","hover:shadow-[0_0_40px_-10px_rgba(52,211,153,0.3)]","text-left",3,"click"],[1,"absolute","top-0","right-0","p-4","opacity-10","group-hover:opacity-20","transition-opacity"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24"],["d","M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.8L19.5 8 12 11.2 4.5 8 12 4.8zM4 15.5v-5.2l7 3.1v5.2l-7-3.1zm9 3.1v-5.2l7-3.1v5.2l-7 3.1z"],[1,"relative","z-20"],[1,"inline-block","px-3","py-1","bg-emerald-500/10","text-emerald-400","text-xs","font-bold","rounded-full","mb-4","border","border-emerald-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-emerald-50"],[1,"text-slate-400","leading-relaxed","mb-6"],[1,"flex","items-center","text-emerald-400","font-bold","group-hover:translate-x-2","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"group","relative","overflow-hidden","bg-slate-900","border","border-purple-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-purple-400","hover:shadow-[0_0_40px_-10px_rgba(168,85,247,0.3)]","text-left",3,"click"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"inline-block","px-3","py-1","bg-purple-500/10","text-purple-400","text-xs","font-bold","rounded-full","mb-4","border","border-purple-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-purple-50"],[1,"flex","items-center","text-purple-400","font-bold","group-hover:translate-x-2","transition-transform"],[1,"absolute","bottom-6","text-slate-500","text-sm","font-medium","uppercase","tracking-widest"]],template:function(t,i){t&1&&(C(0,"div",0),B(1,"div",1)(2,"div",2),C(3,"div",3)(4,"h1",4),v(5),A(),C(6,"p",5),v(7),A()(),C(8,"div",6)(9,"button",7),Dt("click",function(){return i.navigateTo("shape-tactics")}),C(10,"div",8),Y(),C(11,"svg",9),B(12,"path",10),A()(),Ne(),C(13,"div",11)(14,"span",12),v(15," Live Now "),A(),C(16,"h2",13),v(17,"Shape Tactics"),A(),C(18,"p",14),v(19," Strategic turn-based combat with AI and merging mechanics. Build your base, manage resources, and conquer the battlefield. "),A(),C(20,"div",15),v(21," ENTER PORTAL "),Y(),C(22,"svg",16),B(23,"path",17),A()()()(),Ne(),C(24,"button",18),Dt("click",function(){return i.navigateTo("new-game")}),C(25,"div",8),Y(),C(26,"svg",9),B(27,"path",19),A()(),Ne(),C(28,"div",11)(29,"span",20),v(30," In Development "),A(),C(31,"h2",21),v(32,"Project: X"),A(),C(33,"p",14),v(34," A new frontier is being mapped. Stay tuned for a completely different strategic experience. Coming soon to the Gaming Hub. "),A(),C(35,"div",22),v(36," EXPLORE LOGS "),Y(),C(37,"svg",16),B(38,"path",17),A()()()()(),Ne(),C(39,"footer",23),v(40," \xA9 2026 Shape Tactics Labs // v1.0.3 "),A()()),t&2&&(_(5),X(" ",i.settings.currentLang()==="uk"?"\u0406\u0413\u0420\u041E\u0412\u0418\u0419 \u0426\u0415\u041D\u0422\u0420":"GAMING HUB"," "),_(2),X(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043E\u0440\u0442\u0430\u043B, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0441\u0432\u043E\u044E \u043F\u043E\u0434\u043E\u0440\u043E\u0436.":"Select a portal to begin your journey."," "))},dependencies:[qt],styles:["[_nghost-%COMP%]{display:block}"]})};var E0=class n{constructor(e){this.router=e}goBack(){this.router.navigate(["/"])}static \u0275fac=function(t){return new(t||n)(Ee(yi))};static \u0275cmp=Ot({type:n,selectors:[["app-new-game-placeholder"]],decls:13,vars:0,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden"],[1,"text-center","z-10"],[1,"w-24","h-24","bg-purple-500/20","rounded-full","flex","items-center","justify-center","mx-auto","mb-8","border","border-purple-500/30","animate-bounce"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-purple-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"text-5xl","font-black","mb-4","tracking-tighter","bg-gradient-to-r","from-purple-400","to-pink-400","bg-clip-text","text-transparent"],[1,"text-slate-400","text-lg","mb-12","max-w-md"],[1,"px-8","py-3","bg-slate-900","border","border-slate-700","rounded-full","font-bold","hover:bg-slate-800","hover:border-slate-600","transition-all","flex","items-center","mx-auto",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2),Y(),C(3,"svg",3),B(4,"path",4),A()(),Ne(),C(5,"h1",5),v(6," PROJECT: X "),A(),C(7,"p",6),v(8," This sector of the Gaming Hub is still under construction. Our engineers are working hard to bring you a new strategic experience. "),A(),C(9,"button",7),Dt("click",function(){return i.goBack()}),Y(),C(10,"svg",8),B(11,"path",9),A(),v(12," RETURN TO HUB "),A()()())},dependencies:[qt],styles:["[_nghost-%COMP%]{display:block}"]})};var IO=[{path:"",component:_0},{path:"shape-tactics",component:s0},{path:"new-game",component:E0},{path:"feedback",component:y0},{path:"roadmap",component:v0}];var TO={providers:[vv(),db(IO),jM(BM())]};var b0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ot({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,i){t&1&&(E(0,"h1",0),v(1,"Turn-Based Strategy"),x(),W(2,"router-outlet"))},dependencies:[ed],encapsulation:2})};LE(b0,TO).catch(n=>console.error(n));
