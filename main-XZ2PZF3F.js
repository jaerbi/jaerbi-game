var l4=Object.defineProperty,c4=Object.defineProperties;var u4=Object.getOwnPropertyDescriptors;var Rh=Object.getOwnPropertySymbols;var PS=Object.prototype.hasOwnProperty,OS=Object.prototype.propertyIsEnumerable;var NS=(n,e,t)=>e in n?l4(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||={})PS.call(e,t)&&NS(n,t,e[t]);if(Rh)for(var t of Rh(e))OS.call(e,t)&&NS(n,t,e[t]);return n},ce=(n,e)=>c4(n,u4(e));var Xa=(n,e)=>{var t={};for(var i in n)PS.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&Rh)for(var i of Rh(n))e.indexOf(i)<0&&OS.call(n,i)&&(t[i]=n[i]);return t};var Vn=null,kh=!1,oy=1,d4=null,ei=Symbol("SIGNAL");function Ue(n){let e=Vn;return Vn=n,e}function Ph(){return Vn}var zc={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Wc(n){if(kh)throw new Error("");if(Vn===null)return;Vn.consumerOnSignalRead(n);let e=Vn.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Vn.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Vn.producers,t!==void 0&&t.producer===n)){Vn.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Vn&&(!i||f4(r,Vn)))return;let o=Za(Vn),s={producer:n,consumer:Vn,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Vn.producersTail=s,e!==void 0?e.nextProducer=s:Vn.producers=s,o&&US(n,s)}function FS(){oy++}function sy(n){if(!(Za(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===oy)){if(!n.producerMustRecompute(n)&&!Fh(n)){ry(n);return}n.producerRecomputeValue(n),ry(n)}}function ay(n){if(n.consumers===void 0)return;let e=kh;kh=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||h4(i)}}finally{kh=e}}function ly(){return Vn?.consumerAllowSignalWrites!==!1}function h4(n){n.dirty=!0,ay(n),n.consumerMarkedDirty?.(n)}function ry(n){n.dirty=!1,n.lastCleanEpoch=oy}function qc(n){return n&&LS(n),Ue(n)}function LS(n){n.producersTail=void 0,n.recomputing=!0}function Oh(n,e){Ue(e),n&&VS(n)}function VS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Za(n))do t=cy(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Fh(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(sy(t),i!==t.version))return!0}return!1}function Kc(n){if(Za(n)){let e=n.producers;for(;e!==void 0;)e=cy(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function US(n,e){let t=n.consumersTail,i=Za(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)US(r.producer,r)}function cy(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Za(e)){let o=e.producers;for(;o!==void 0;)o=cy(o)}return t}function Za(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function uy(n){d4?.(n)}function f4(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function dy(n,e){return Object.is(n,e)}function Lh(n,e){let t=Object.create(p4);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(sy(t),Wc(t),t.value===Nh)throw t.error;return t.value};return i[ei]=t,uy(t),i}var ny=Symbol("UNSET"),iy=Symbol("COMPUTING"),Nh=Symbol("ERRORED"),p4=ce(F({},zc),{value:ny,dirty:!0,error:null,equal:dy,kind:"computed",producerMustRecompute(n){return n.value===ny||n.value===iy},producerRecomputeValue(n){if(n.value===iy)throw new Error("");let e=n.value;n.value=iy;let t=qc(n),i,r=!1;try{i=n.computation(),Ue(null),r=e!==ny&&e!==Nh&&i!==Nh&&n.equal(e,i)}catch(o){i=Nh,n.error=o}finally{Oh(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function g4(){throw new Error}var BS=g4;function jS(n){BS(n)}function hy(n){BS=n}var m4=null;function fy(n,e){let t=Object.create(Vh);t.value=n,e!==void 0&&(t.equal=e);let i=()=>HS(t);return i[ei]=t,uy(t),[i,s=>Yc(t,s),s=>GS(t,s)]}function HS(n){return Wc(n),n.value}function Yc(n,e){ly()||jS(n),n.equal(n.value,e)||(n.value=e,y4(n))}function GS(n,e){ly()||jS(n),Yc(n,e(n.value))}var Vh=ce(F({},zc),{equal:dy,value:void 0,kind:"signal"});function y4(n){n.version++,FS(),ay(n),m4?.(n)}function py(n){let e=Ue(null);try{return n()}finally{Ue(e)}}function Ye(n){return typeof n=="function"}function el(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Uh=el(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function js(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var mn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ye(i))try{i()}catch(o){e=o instanceof Uh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{$S(o)}catch(s){e=e??[],s instanceof Uh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Uh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)$S(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&js(t,e)}remove(e){let{_finalizers:t}=this;t&&js(t,e),e instanceof n&&e._removeParent(this)}};mn.EMPTY=(()=>{let n=new mn;return n.closed=!0,n})();var gy=mn.EMPTY;function Bh(n){return n instanceof mn||n&&"closed"in n&&Ye(n.remove)&&Ye(n.add)&&Ye(n.unsubscribe)}function $S(n){Ye(n)?n():n.unsubscribe()}var $i={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var tl={setTimeout(n,e,...t){let{delegate:i}=tl;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=tl;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function jh(n){tl.setTimeout(()=>{let{onUnhandledError:e}=$i;if(e)e(n);else throw n})}function Qc(){}var zS=my("C",void 0,void 0);function WS(n){return my("E",void 0,n)}function qS(n){return my("N",n,void 0)}function my(n,e,t){return{kind:n,value:e,error:t}}var Hs=null;function nl(n){if($i.useDeprecatedSynchronousErrorHandling){let e=!Hs;if(e&&(Hs={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Hs;if(Hs=null,t)throw i}}else n()}function KS(n){$i.useDeprecatedSynchronousErrorHandling&&Hs&&(Hs.errorThrown=!0,Hs.error=n)}var Gs=class extends mn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Bh(e)&&e.add(this)):this.destination=E4}static create(e,t,i){return new il(e,t,i)}next(e){this.isStopped?vy(qS(e),this):this._next(e)}error(e){this.isStopped?vy(WS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?vy(zS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},v4=Function.prototype.bind;function yy(n,e){return v4.call(n,e)}var _y=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Hh(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Hh(i)}else Hh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Hh(t)}}},il=class extends Gs{constructor(e,t,i){super();let r;if(Ye(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&$i.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&yy(e.next,o),error:e.error&&yy(e.error,o),complete:e.complete&&yy(e.complete,o)}):r=e}this.destination=new _y(r)}};function Hh(n){$i.useDeprecatedSynchronousErrorHandling?KS(n):jh(n)}function _4(n){throw n}function vy(n,e){let{onStoppedNotification:t}=$i;t&&tl.setTimeout(()=>t(n,e))}var E4={closed:!0,next:Qc,error:_4,complete:Qc};var rl=typeof Symbol=="function"&&Symbol.observable||"@@observable";function zi(n){return n}function Ey(...n){return by(n)}function by(n){return n.length===0?zi:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var st=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=w4(t)?t:new il(t,i,r);return nl(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=YS(i),new i((r,o)=>{let s=new il({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[rl](){return this}pipe(...t){return by(t)(this)}toPromise(t){return t=YS(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function YS(n){var e;return(e=n??$i.Promise)!==null&&e!==void 0?e:Promise}function b4(n){return n&&Ye(n.next)&&Ye(n.error)&&Ye(n.complete)}function w4(n){return n&&n instanceof Gs||b4(n)&&Bh(n)}function x4(n){return Ye(n?.lift)}function ht(n){return e=>{if(x4(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ft(n,e,t,i,r){return new wy(n,e,t,i,r)}var wy=class extends Gs{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var QS=el(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ht=(()=>{class n extends st{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new Gh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new QS}next(t){nl(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){nl(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){nl(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?gy:(this.currentObservers=null,o.push(t),new mn(()=>{this.currentObservers=null,js(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new st;return t.source=this,t}}return n.create=(e,t)=>new Gh(e,t),n})(),Gh=class extends Ht{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:gy}};var Nn=class extends Ht{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var xy={now(){return(xy.delegate||Date).now()},delegate:void 0};var $h=class extends mn{constructor(e,t){super()}schedule(e,t=0){return this}};var Jc={setInterval(n,e,...t){let{delegate:i}=Jc;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Jc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var zh=class extends $h{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return Jc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Jc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,js(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var ol=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};ol.now=xy.now;var Wh=class extends ol{constructor(e,t=ol.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var JS=new Wh(zh);var Pn=new st(n=>n.complete());function XS(n){return n&&Ye(n.schedule)}function ZS(n){return n[n.length-1]}function qh(n){return Ye(ZS(n))?n.pop():void 0}function Ko(n){return XS(ZS(n))?n.pop():void 0}function tI(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(h){s(h)}}function l(d){try{c(i.throw(d))}catch(h){s(h)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function eI(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $s(n){return this instanceof $s?(this.v=n,this):new $s(n)}function nI(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(m){return function(w){return Promise.resolve(w).then(m,h)}}function a(m,w){i[m]&&(r[m]=function(S){return new Promise(function(k,V){o.push([m,S,k,V])>1||l(m,S)})},w&&(r[m]=w(r[m])))}function l(m,w){try{c(i[m](w))}catch(S){f(o[0][3],S)}}function c(m){m.value instanceof $s?Promise.resolve(m.value.v).then(d,h):f(o[0][2],m)}function d(m){l("next",m)}function h(m){l("throw",m)}function f(m,w){m(w),o.shift(),o.length&&l(o[0][0],o[0][1])}}function iI(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof eI=="function"?eI(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var Kh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Yh(n){return Ye(n?.then)}function Qh(n){return Ye(n[rl])}function Jh(n){return Symbol.asyncIterator&&Ye(n?.[Symbol.asyncIterator])}function Xh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function S4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Zh=S4();function ef(n){return Ye(n?.[Zh])}function tf(n){return nI(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield $s(t.read());if(r)return yield $s(void 0);yield yield $s(i)}}finally{t.releaseLock()}})}function nf(n){return Ye(n?.getReader)}function an(n){if(n instanceof st)return n;if(n!=null){if(Qh(n))return I4(n);if(Kh(n))return T4(n);if(Yh(n))return C4(n);if(Jh(n))return rI(n);if(ef(n))return D4(n);if(nf(n))return A4(n)}throw Xh(n)}function I4(n){return new st(e=>{let t=n[rl]();if(Ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function T4(n){return new st(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function C4(n){return new st(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,jh)})}function D4(n){return new st(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function rI(n){return new st(e=>{M4(n,e).catch(t=>e.error(t))})}function A4(n){return rI(tf(n))}function M4(n,e){var t,i,r,o;return tI(this,void 0,void 0,function*(){try{for(t=iI(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function ti(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function rf(n,e=0){return ht((t,i)=>{t.subscribe(ft(i,r=>ti(i,n,()=>i.next(r),e),()=>ti(i,n,()=>i.complete(),e),r=>ti(i,n,()=>i.error(r),e)))})}function of(n,e=0){return ht((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function oI(n,e){return an(n).pipe(of(e),rf(e))}function sI(n,e){return an(n).pipe(of(e),rf(e))}function aI(n,e){return new st(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function lI(n,e){return new st(t=>{let i;return ti(t,e,()=>{i=n[Zh](),ti(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Ye(i?.return)&&i.return()})}function sf(n,e){if(!n)throw new Error("Iterable cannot be null");return new st(t=>{ti(t,e,()=>{let i=n[Symbol.asyncIterator]();ti(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function cI(n,e){return sf(tf(n),e)}function uI(n,e){if(n!=null){if(Qh(n))return oI(n,e);if(Kh(n))return aI(n,e);if(Yh(n))return sI(n,e);if(Jh(n))return sf(n,e);if(ef(n))return lI(n,e);if(nf(n))return cI(n,e)}throw Xh(n)}function ln(n,e){return e?uI(n,e):an(n)}function rt(...n){let e=Ko(n);return ln(n,e)}function Sy(n,e){let t=Ye(n)?n:()=>n,i=r=>r.error(t());return new st(e?r=>e.schedule(i,0,r):i)}function af(n){return!!n&&(n instanceof st||Ye(n.lift)&&Ye(n.subscribe))}var zs=el(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function vt(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:R4}=Array;function k4(n,e){return R4(e)?n(...e):n(e)}function lf(n){return vt(e=>k4(n,e))}var{isArray:N4}=Array,{getPrototypeOf:P4,prototype:O4,keys:F4}=Object;function cf(n){if(n.length===1){let e=n[0];if(N4(e))return{args:e,keys:null};if(L4(e)){let t=F4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function L4(n){return n&&typeof n=="object"&&P4(n)===O4}function uf(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Xc(...n){let e=Ko(n),t=qh(n),{args:i,keys:r}=cf(n);if(i.length===0)return ln([],e);let o=new st(V4(i,e,r?s=>uf(r,s):zi));return t?o.pipe(lf(t)):o}function V4(n,e,t=zi){return i=>{dI(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let l=0;l<r;l++)dI(e,()=>{let c=ln(n[l],e),d=!1;c.subscribe(ft(i,h=>{o[l]=h,d||(d=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function dI(n,e,t){n?ti(t,n,e):e()}function hI(n,e,t,i,r,o,s,a){let l=[],c=0,d=0,h=!1,f=()=>{h&&!l.length&&!c&&e.complete()},m=S=>c<i?w(S):l.push(S),w=S=>{o&&e.next(S),c++;let k=!1;an(t(S,d++)).subscribe(ft(e,V=>{r?.(V),o?m(V):e.next(V)},()=>{k=!0},void 0,()=>{if(k)try{for(c--;l.length&&c<i;){let V=l.shift();s?ti(e,s,()=>w(V)):w(V)}f()}catch(V){e.error(V)}}))};return n.subscribe(ft(e,m,()=>{h=!0,f()})),()=>{a?.()}}function Wn(n,e,t=1/0){return Ye(e)?Wn((i,r)=>vt((o,s)=>e(i,o,r,s))(an(n(i,r))),t):(typeof e=="number"&&(t=e),ht((i,r)=>hI(i,r,n,t)))}function fI(n=1/0){return Wn(zi,n)}function pI(){return fI(1)}function Yo(...n){return pI()(ln(n,Ko(n)))}function Zc(n){return new st(e=>{an(n()).subscribe(e)})}function Iy(...n){let e=qh(n),{args:t,keys:i}=cf(n),r=new st(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let d=0;d<s;d++){let h=!1;an(t[d]).subscribe(ft(o,f=>{h||(h=!0,c--),a[d]=f},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?uf(i,a):a),o.complete())}))}});return e?r.pipe(lf(e)):r}function Wi(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>n.call(e,o,r++)&&i.next(o)))})}function eu(n){return ht((e,t)=>{let i=null,r=!1,o;i=e.subscribe(ft(t,void 0,void 0,s=>{o=an(n(s,eu(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function df(n,e){return Ye(e)?Wn(n,e,1):Wn(n,1)}function Ty(n,e=JS){return ht((t,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let c=o;o=null,i.next(c)}};function l(){let c=s+n,d=e.now();if(d<c){r=this.schedule(void 0,c-d),i.add(r);return}a()}t.subscribe(ft(i,c=>{o=c,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function gI(n){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function qi(n){return n<=0?()=>Pn:ht((e,t)=>{let i=0;e.subscribe(ft(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function mI(n=U4){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function U4(){return new zs}function Cy(n){return ht((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Zr(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Wi((r,o)=>n(r,o,i)):zi,qi(1),t?gI(e):mI(()=>new zs))}function hf(n){return n<=0?()=>Pn:ht((e,t)=>{let i=[];e.subscribe(ft(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Dy(n){return Wi((e,t)=>n<=t)}function tu(...n){let e=Ko(n);return ht((t,i)=>{(e?Yo(n,t,e):Yo(n,t)).subscribe(i)})}function eo(n,e){return ht((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(ft(i,l=>{r?.unsubscribe();let c=0,d=o++;an(n(l,d)).subscribe(r=ft(i,h=>i.next(e?e(l,h,d,c++):h),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Ws(n){return ht((e,t)=>{an(n).subscribe(ft(t,()=>t.complete(),Qc)),!t.closed&&e.subscribe(t)})}function yr(n,e,t){let i=Ye(n)||e||t?{next:n,error:e,complete:t}:n;return i?ht((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(ft(o,l=>{var c;(c=i.next)===null||c===void 0||c.call(i,l),o.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),o.complete()},l=>{var c;a=!1,(c=i.error)===null||c===void 0||c.call(i,l),o.error(l)},()=>{var l,c;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(c=i.finalize)===null||c===void 0||c.call(i)}))}):zi}var Ay;function ff(){return Ay}function vr(n){let e=Ay;return Ay=n,e}var yI=Symbol("NotFound");function sl(n){return n===yI||n?.name==="\u0275NotFound"}var vf="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",me=class extends Error{code;constructor(e,t){super(io(e,t)),this.code=e}};function H4(n){return`NG0${Math.abs(n)}`}function io(n,e){return`${H4(n)}${e?": "+e:""}`}var Er=globalThis;function _t(n){for(let e in n)if(n[e]===_t)return e;throw Error("")}function wI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function no(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(no).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function _f(n,e){return n?e?`${n} ${e}`:n:e||""}var G4=_t({__forward_ref__:_t});function Zo(n){return n.__forward_ref__=Zo,n.toString=function(){return no(this())},n}function On(n){return $y(n)?n():n}function $y(n){return typeof n=="function"&&n.hasOwnProperty(G4)&&n.__forward_ref__===Zo}function pe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function br(n){return{providers:n.providers||[],imports:n.imports||[]}}function au(n){return $4(n,Ef)}function zy(n){return au(n)!==null}function $4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function z4(n){let e=n?.[Ef]??null;return e||null}function Ry(n){return n&&n.hasOwnProperty(gf)?n[gf]:null}var Ef=_t({\u0275prov:_t}),gf=_t({\u0275inj:_t}),we=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Wy(n){return n&&!!n.\u0275providers}var qy=_t({\u0275cmp:_t}),Ky=_t({\u0275dir:_t}),Yy=_t({\u0275pipe:_t}),Qy=_t({\u0275mod:_t}),iu=_t({\u0275fac:_t}),Js=_t({__NG_ELEMENT_ID__:_t}),vI=_t({__NG_ENV_ID__:_t});function Jy(n){return wf(n,"@NgModule"),n[Qy]||null}function ro(n){return wf(n,"@Component"),n[qy]||null}function bf(n){return wf(n,"@Directive"),n[Ky]||null}function Xy(n){return wf(n,"@Pipe"),n[Yy]||null}function wf(n,e){if(n==null)throw new me(-919,!1)}function Ki(n){return typeof n=="string"?n:n==null?"":String(n)}function xI(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ki(n)}var SI=_t({ngErrorCode:_t}),W4=_t({ngErrorMessage:_t}),q4=_t({ngTokenPath:_t});function Zy(n,e){return II("",-200,e)}function xf(n,e){throw new me(-201,!1)}function II(n,e,t){let i=new me(e,n);return i[SI]=e,i[W4]=n,t&&(i[q4]=t),i}function K4(n){return n[SI]}var ky;function TI(){return ky}function qn(n){let e=ky;return ky=n,e}function ev(n,e,t){let i=au(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;xf(n,"")}var Y4={},qs=Y4,Q4="__NG_DI_FLAG__",Ny=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Ks(t)||0;try{return this.injector.get(e,i&8?null:qs,i)}catch(r){if(sl(r))return r;throw r}}};function J4(n,e=0){let t=ff();if(t===void 0)throw new me(-203,!1);if(t===null)return ev(n,void 0,e);{let i=X4(e),r=t.retrieve(n,i);if(sl(r)){if(i.optional)return null;throw r}return r}}function Re(n,e=0){return(TI()||J4)(On(n),e)}function K(n,e){return Re(n,Ks(e))}function Ks(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function X4(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Py(n){let e=[];for(let t=0;t<n.length;t++){let i=On(n[t]);if(Array.isArray(i)){if(i.length===0)throw new me(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],l=Z4(a);typeof l=="number"?l===-1?r=a.token:o|=l:r=a}e.push(Re(r,o))}else e.push(Re(i))}return e}function Z4(n){return n[Q4]}function Qo(n,e){let t=n.hasOwnProperty(iu);return t?n[iu]:null}function CI(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function DI(n){return n.flat(Number.POSITIVE_INFINITY)}function Sf(n,e){n.forEach(t=>Array.isArray(t)?Sf(t,e):e(t))}function tv(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function lu(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function AI(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function If(n,e,t){let i=ll(n,e);return i>=0?n[i|1]=t:(i=~i,AI(n,i,e,t)),i}function Tf(n,e){let t=ll(n,e);if(t>=0)return n[t|1]}function ll(n,e){return e3(n,e,1)}function e3(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var es={},Kn=[],wr=new we(""),nv=new we("",-1),iv=new we(""),ru=class{get(e,t=qs){if(t===qs){let r=II("",-201);throw r.name="\u0275NotFound",r}return t}};function xr(n){return{\u0275providers:n}}function MI(n){return xr([{provide:wr,multi:!0,useValue:n}])}function RI(...n){return{\u0275providers:Cf(!0,n),\u0275fromNgModule:!0}}function Cf(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return Sf(e,s=>{let a=s;mf(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&kI(r,o),t}function kI(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];rv(r,o=>{e(o,i)})}}function mf(n,e,t,i){if(n=On(n),!n)return!1;let r=null,o=Ry(n),s=!o&&ro(n);if(!o&&!s){let l=n.ngModule;if(o=Ry(l),o)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)mf(c,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let c;Sf(o.imports,d=>{mf(d,e,t,i)&&(c||=[],c.push(d))}),c!==void 0&&kI(c,e)}if(!a){let c=Qo(r)||(()=>new r);e({provide:r,useFactory:c,deps:Kn},r),e({provide:iv,useValue:r,multi:!0},r),e({provide:wr,useValue:()=>Re(r),multi:!0},r)}let l=o.providers;if(l!=null&&!a){let c=n;rv(l,d=>{e(d,c)})}}else return!1;return r!==n&&n.providers!==void 0}function rv(n,e){for(let t of n)Wy(t)&&(t=t.\u0275providers),Array.isArray(t)?rv(t,e):e(t)}var t3=_t({provide:String,useValue:_t});function NI(n){return n!==null&&typeof n=="object"&&t3 in n}function n3(n){return!!(n&&n.useExisting)}function i3(n){return!!(n&&n.useFactory)}function Ys(n){return typeof n=="function"}function PI(n){return!!n.useClass}var cu=new we(""),pf={},_I={},My;function uu(){return My===void 0&&(My=new ru),My}var Yt=class{},Qs=class extends Yt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,Fy(e,s=>this.processProvider(s)),this.records.set(nv,al(void 0,this)),r.has("environment")&&this.records.set(Yt,al(void 0,this));let o=this.records.get(cu);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(iv,Kn,{self:!0}))}retrieve(e,t){let i=Ks(t)||0;try{return this.get(e,qs,i)}catch(r){if(sl(r))return r;throw r}}destroy(){nu(this),this._destroyed=!0;let e=Ue(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ue(e)}}onDestroy(e){return nu(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){nu(this);let t=vr(this),i=qn(void 0),r;try{return e()}finally{vr(t),qn(i)}}get(e,t=qs,i){if(nu(this),e.hasOwnProperty(vI))return e[vI](this);let r=Ks(i),o,s=vr(this),a=qn(void 0);try{if(!(r&4)){let c=this.records.get(e);if(c===void 0){let d=l3(e)&&au(e);d&&this.injectableDefInScope(d)?c=al(Oy(e),pf):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let l=r&2?uu():this.parent;return t=r&8&&t===qs?null:t,l.get(e,t)}catch(l){let c=K4(l);throw c===-200||c===-201?new me(c,null):l}finally{qn(a),vr(s)}}resolveInjectorInitializers(){let e=Ue(null),t=vr(this),i=qn(void 0),r;try{let o=this.get(wr,Kn,{self:!0});for(let s of o)s()}finally{vr(t),qn(i),Ue(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(no(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=On(e);let t=Ys(e)?e:On(e&&e.provide),i=o3(e);if(!Ys(e)&&e.multi===!0){let r=this.records.get(t);r||(r=al(void 0,pf,!0),r.factory=()=>Py(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Ue(null);try{if(t.value===_I)throw Zy(no(e));return t.value===pf&&(t.value=_I,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&a3(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ue(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=On(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Oy(n){let e=au(n),t=e!==null?e.factory:Qo(n);if(t!==null)return t;if(n instanceof we)throw new me(204,!1);if(n instanceof Function)return r3(n);throw new me(204,!1)}function r3(n){if(n.length>0)throw new me(204,!1);let t=z4(n);return t!==null?()=>t.factory(n):()=>new n}function o3(n){if(NI(n))return al(void 0,n.useValue);{let e=ov(n);return al(e,pf)}}function ov(n,e,t){let i;if(Ys(n)){let r=On(n);return Qo(r)||Oy(r)}else if(NI(n))i=()=>On(n.useValue);else if(i3(n))i=()=>n.useFactory(...Py(n.deps||[]));else if(n3(n))i=(r,o)=>Re(On(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=On(n&&(n.useClass||n.provide));if(s3(n))i=()=>new r(...Py(n.deps));else return Qo(r)||Oy(r)}return i}function nu(n){if(n.destroyed)throw new me(205,!1)}function al(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function s3(n){return!!n.deps}function a3(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function l3(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Fy(n,e){for(let t of n)Array.isArray(t)?Fy(t,e):t&&Wy(t)?Fy(t.\u0275providers,e):e(t)}function Fn(n,e){let t;n instanceof Qs?(nu(n),t=n):t=new Ny(n);let i,r=vr(t),o=qn(void 0);try{return e()}finally{vr(r),qn(o)}}function OI(){return TI()!==void 0||ff()!=null}var Qn=0,ke=1,$e=2,Zt=3,Di=4,Ai=5,ni=6,cl=7,en=8,di=9,Sr=10,St=11,ul=12,sv=13,Xs=14,Jn=15,ts=16,Zs=17,Ir=18,oo=19,av=20,to=21,Df=22,du=23,hi=24,ea=25,ta=26,ut=27,FI=1,Yi=6,Tr=7,hu=8,na=9,zt=10;function fi(n){return Array.isArray(n)&&typeof n[FI]=="object"}function pi(n){return Array.isArray(n)&&n[FI]===!0}function lv(n){return(n.flags&4)!==0}function so(n){return n.componentOffset>-1}function fu(n){return(n.flags&1)===1}function Cr(n){return!!n.template}function ia(n){return(n[$e]&512)!==0}function ns(n){return(n[$e]&256)===256}var cv="svg",LI="math";function gi(n){for(;Array.isArray(n);)n=n[Qn];return n}function uv(n,e){return gi(e[n])}function Mi(n,e){return gi(e[n.index])}function ra(n,e){return n.data[e]}function pu(n,e){return n[e]}function gu(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Ri(n,e){let t=e[n];return fi(t)?t:t[Qn]}function VI(n){return(n[$e]&4)===4}function Af(n){return(n[$e]&128)===128}function UI(n){return pi(n[Zt])}function ki(n,e){return e==null?null:n[e]}function dv(n){n[Zs]=0}function hv(n){n[$e]&1024||(n[$e]|=1024,Af(n)&&dl(n))}function BI(n,e){for(;n>0;)e=e[Xs],n--;return e}function mu(n){return!!(n[$e]&9216||n[hi]?.dirty)}function Mf(n){n[Sr].changeDetectionScheduler?.notify(8),n[$e]&64&&(n[$e]|=1024),mu(n)&&dl(n)}function dl(n){n[Sr].changeDetectionScheduler?.notify(0);let e=Jo(n);for(;e!==null&&!(e[$e]&8192||(e[$e]|=8192,!Af(e)));)e=Jo(e)}function fv(n,e){if(ns(n))throw new me(911,!1);n[to]===null&&(n[to]=[]),n[to].push(e)}function jI(n,e){if(n[to]===null)return;let t=n[to].indexOf(e);t!==-1&&n[to].splice(t,1)}function Jo(n){let e=n[Zt];return pi(e)?e[Zt]:e}function pv(n){return n[cl]??=[]}function gv(n){return n.cleanup??=[]}function HI(n,e,t,i){let r=pv(e);r.push(t),n.firstCreatePass&&gv(n).push(i,r.length-1)}var Qe={lFrame:eT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Ly=!1;function GI(){return Qe.lFrame.elementDepthCount}function $I(){Qe.lFrame.elementDepthCount++}function mv(){Qe.lFrame.elementDepthCount--}function yv(){return Qe.bindingsEnabled}function vv(){return Qe.skipHydrationRootTNode!==null}function _v(n){return Qe.skipHydrationRootTNode===n}function zI(n){Qe.skipHydrationRootTNode=n}function Ev(){Qe.skipHydrationRootTNode=null}function Be(){return Qe.lFrame.lView}function tn(){return Qe.lFrame.tView}function Z(n){return Qe.lFrame.contextLView=n,n[en]}function ee(n){return Qe.lFrame.contextLView=null,n}function Un(){let n=bv();for(;n!==null&&n.type===64;)n=n.parent;return n}function bv(){return Qe.lFrame.currentTNode}function WI(){let n=Qe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function oa(n,e){let t=Qe.lFrame;t.currentTNode=n,t.isParent=e}function wv(){return Qe.lFrame.isParent}function qI(){Qe.lFrame.isParent=!1}function xv(){return Qe.lFrame.contextLView}function Sv(){return Ly}function Iv(n){let e=Ly;return Ly=n,e}function hl(){let n=Qe.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Tv(){return Qe.lFrame.bindingIndex}function KI(n){return Qe.lFrame.bindingIndex=n}function sa(){return Qe.lFrame.bindingIndex++}function yu(n){let e=Qe.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function YI(){return Qe.lFrame.inI18n}function QI(n,e){let t=Qe.lFrame;t.bindingIndex=t.bindingRootIndex=n,Rf(e)}function JI(){return Qe.lFrame.currentDirectiveIndex}function Rf(n){Qe.lFrame.currentDirectiveIndex=n}function XI(n){let e=Qe.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Cv(){return Qe.lFrame.currentQueryIndex}function kf(n){Qe.lFrame.currentQueryIndex=n}function c3(n){let e=n[ke];return e.type===2?e.declTNode:e.type===1?n[Ai]:null}function Dv(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=c3(o),r===null||(o=o[Xs],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Qe.lFrame=ZI();return i.currentTNode=e,i.lView=n,!0}function Nf(n){let e=ZI(),t=n[ke];Qe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function ZI(){let n=Qe.lFrame,e=n===null?null:n.child;return e===null?eT(n):e}function eT(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function tT(){let n=Qe.lFrame;return Qe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Av=tT;function Pf(){let n=tT();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function nT(n){return(Qe.lFrame.contextLView=BI(n,Qe.lFrame.contextLView))[en]}function Ni(){return Qe.lFrame.selectedIndex}function is(n){Qe.lFrame.selectedIndex=n}function Mv(){let n=Qe.lFrame;return ra(n.tView,n.selectedIndex)}function ie(){Qe.lFrame.currentNamespace=cv}function Oe(){u3()}function u3(){Qe.lFrame.currentNamespace=null}function Rv(){return Qe.lFrame.currentNamespace}var iT=!0;function Of(){return iT}function ao(n){iT=n}function Vy(n,e=null,t=null,i){let r=kv(n,e,t,i);return r.resolveInjectorInitializers(),r}function kv(n,e=null,t=null,i,r=new Set){let o=[t||Kn,RI(n)];return i=i||(typeof n=="object"?void 0:no(n)),new Qs(o,e||uu(),i||null,r)}var Yn=class n{static THROW_IF_NOT_FOUND=qs;static NULL=new ru;static create(e,t){if(Array.isArray(e))return Vy({name:""},t,e,"");{let i=e.name??"";return Vy({name:i},e.parent,e.providers,i)}}static \u0275prov=pe({token:n,providedIn:"any",factory:()=>Re(nv)});static __NG_ELEMENT_ID__=-1},Qt=new we(""),ii=(()=>{class n{static __NG_ELEMENT_ID__=d3;static __NG_ENV_ID__=t=>t}return n})(),Uy=class extends ii{_lView;constructor(e){super(),this._lView=e}get destroyed(){return ns(this._lView)}onDestroy(e){let t=this._lView;return fv(t,e),()=>jI(t,e)}};function d3(){return new Uy(Be())}var rT=!1,oT=new we(""),Dr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Nn(!1);debugTaskTracker=K(oT,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new st(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),By=class extends Ht{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,OI()&&(this.destroyRef=K(ii,{optional:!0})??void 0,this.pendingTasks=K(Dr,{optional:!0})??void 0)}emit(e){let t=Ue(null);try{super.next(e)}finally{Ue(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof mn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},cn=By;function yf(...n){}function Nv(n){let e,t;function i(){n=yf;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function sT(n){return queueMicrotask(()=>n()),()=>{n=yf}}var Pv="isAngularZone",ou=Pv+"_ID",h3=0,yn=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new cn(!1);onMicrotaskEmpty=new cn(!1);onStable=new cn(!1);onError=new cn(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=rT}=e;if(typeof Zone>"u")throw new me(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,g3(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Pv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new me(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new me(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,f3,yf,yf);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},f3={};function Ov(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function p3(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){Nv(()=>{n.callbackScheduled=!1,jy(n),n.isCheckStableRunning=!0,Ov(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),jy(n)}function g3(n){let e=()=>{p3(n)},t=h3++;n._inner=n._inner.fork({name:"angular",properties:{[Pv]:!0,[ou]:t,[ou+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(m3(l))return i.invokeTask(o,s,a,l);try{return EI(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),bI(n)}},onInvoke:(i,r,o,s,a,l,c)=>{try{return EI(n),i.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!y3(l)&&e(),bI(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,jy(n),Ov(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function jy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function EI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function bI(n){n._nesting--,Ov(n)}var su=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new cn;onMicrotaskEmpty=new cn;onStable=new cn;onError=new cn;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function m3(n){return aT(n,"__ignore_ng_zone__")}function y3(n){return aT(n,"__scheduler_tick__")}function aT(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var _r=class{_console=console;handleError(e){this._console.error("ERROR",e)}},mi=new we("",{factory:()=>{let n=K(yn),e=K(Yt),t;return i=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw i}):(t??=e.get(_r),t.handleError(i))})}}}),lT={provide:wr,useValue:()=>{let n=K(_r,{optional:!0})},multi:!0},v3=new we("",{factory:()=>{let n=K(Qt).defaultView;if(!n)return;let e=K(mi),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),K(ii).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function Fv(){return xr([MI(()=>{K(v3)})])}function $(n,e){let[t,i,r]=fy(n,e?.equal),o=t,s=o[ei];return o.set=i,o.update=r,o.asReadonly=cT.bind(o),o}function cT(){let n=this[ei];if(n.readonlyFn===void 0){let e=()=>this();e[ei]=n,n.readonlyFn=e}return n.readonlyFn}var Ff=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=_3}return n})();function _3(){return new Ff(Be(),Un())}var Xo=class{},vu=new we("",{factory:()=>!0});var Lv=new we(""),_u=(()=>{class n{internalPendingTasks=K(Dr);scheduler=K(Xo);errorHandler=K(mi);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),Vv=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new Hy})}return n})(),Hy=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}},Gy=class{[ei];constructor(e){this[ei]=e}destroy(){this[ei].destroy()}};function un(n){return py(n)}var Lf={JSACTION:"jsaction"};function Au(n){return{toString:n}.toString()}function I3(n){return typeof n=="function"}function KT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var qf=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}},lo=(()=>{let n=()=>YT;return n.ngInherit=!0,n})();function YT(n){return n.type.prototype.ngOnChanges&&(n.setInput=C3),T3}function T3(){let n=JT(this),e=n?.current;if(e){let t=n.previous;if(t===es)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function C3(n,e,t,i,r){let o=this.declaredInputs[i],s=JT(n)||D3(n,{previous:es,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new qf(c&&c.currentValue,t,l===es),KT(n,e,r,t)}var QT="__ngSimpleChanges__";function JT(n){return n[QT]||null}function D3(n,e){return n[QT]=e}var uT=[];var pt=function(n,e=null,t){for(let i=0;i<uT.length;i++){let r=uT[i];r(n,e,t)}},at=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(at||{});function A3(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=YT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function XT(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Bf(n,e,t){ZT(n,e,3,t)}function jf(n,e,t,i){(n[$e]&3)===t&&ZT(n,e,t,i)}function Uv(n,e){let t=n[$e];(t&3)===e&&(t&=16383,t+=1,n[$e]=t)}function ZT(n,e,t,i){let r=i!==void 0?n[Zs]&65535:0,o=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(n[Zs]+=65536),(a<o||o==-1)&&(M3(n,t,e,l),n[Zs]=(n[Zs]&4294901760)+l+2),l++}function dT(n,e){pt(at.LifecycleHookStart,n,e);let t=Ue(null);try{e.call(n)}finally{Ue(t),pt(at.LifecycleHookEnd,n,e)}}function M3(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[$e]>>14<n[Zs]>>16&&(n[$e]&3)===e&&(n[$e]+=16384,dT(a,o)):dT(a,o)}var pl=-1,ca=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function R3(n){return(n.flags&8)!==0}function k3(n){return(n.flags&16)!==0}function N3(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];P3(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function eC(n){return n===3||n===4||n===6}function P3(n){return n.charCodeAt(0)===64}function yl(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?hT(n,t,r,null,e[++i]):hT(n,t,r,null,null))}}return n}function hT(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function tC(n){return n!==pl}function Kf(n){return n&32767}function O3(n){return n>>16}function Yf(n,e){let t=O3(n),i=e;for(;t>0;)i=i[Xs],t--;return i}var Zv=!0;function Qf(n){let e=Zv;return Zv=n,e}var F3=256,nC=F3-1,iC=5,L3=0,Ar={};function V3(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Js)&&(i=t[Js]),i==null&&(i=t[Js]=L3++);let r=i&nC,o=1<<r;e.data[n+(r>>iC)]|=o}function Jf(n,e){let t=rC(n,e);if(t!==-1)return t;let i=e[ke];i.firstCreatePass&&(n.injectorIndex=e.length,Bv(i.data,n),Bv(e,null),Bv(i.blueprint,null));let r=D_(n,e),o=n.injectorIndex;if(tC(r)){let s=Kf(r),a=Yf(r,e),l=a[ke].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=r,o}function Bv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function rC(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function D_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=cC(r),i===null)return pl;if(t++,r=r[Xs],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return pl}function e_(n,e,t){V3(n,e,t)}function U3(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(eC(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function oC(n,e,t){if(t&8||n!==void 0)return n;xf(e,"NodeInjector")}function sC(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[di],o=qn(void 0);try{return r?r.get(e,i,t&8):ev(e,i,t&8)}finally{qn(o)}}return oC(i,e,t)}function aC(n,e,t,i=0,r){if(n!==null){if(e[$e]&2048&&!(i&2)){let s=G3(n,e,t,i,Ar);if(s!==Ar)return s}let o=lC(n,e,t,i,Ar);if(o!==Ar)return o}return sC(e,t,i,r)}function lC(n,e,t,i,r){let o=j3(t);if(typeof o=="function"){if(!Dv(e,n,i))return i&1?oC(r,t,i):sC(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))xf(t);else return s}finally{Av()}}else if(typeof o=="number"){let s=null,a=rC(n,e),l=pl,c=i&1?e[Jn][Ai]:null;for((a===-1||i&4)&&(l=a===-1?D_(n,e):e[a+8],l===pl||!pT(i,!1)?a=-1:(s=e[ke],a=Kf(l),e=Yf(l,e)));a!==-1;){let d=e[ke];if(fT(o,a,d.data)){let h=B3(a,e,t,s,i,c);if(h!==Ar)return h}l=e[a+8],l!==pl&&pT(i,e[ke].data[a+8]===c)&&fT(o,a,e)?(s=d,a=Kf(l),e=Yf(l,e)):a=-1}}return r}function B3(n,e,t,i,r,o){let s=e[ke],a=s.data[n+8],l=i==null?so(a)&&Zv:i!=s&&(a.type&3)!==0,c=r&1&&o===a,d=Hf(a,s,t,l,c);return d!==null?xu(e,s,d,a,r):Ar}function Hf(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,d=o>>20,h=i?a:a+d,f=r?a+d:c;for(let m=h;m<f;m++){let w=s[m];if(m<l&&t===w||m>=l&&w.type===t)return m}if(r){let m=s[l];if(m&&Cr(m)&&m.type===t)return l}return null}function xu(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof ca){let a=o;if(a.resolving){let m=xI(s[t]);throw Zy(m)}let l=Qf(a.canSeeViewProviders);a.resolving=!0;let c=s[t].type||s[t],d,h=a.injectImpl?qn(a.injectImpl):null,f=Dv(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&A3(t,s[t],e)}finally{h!==null&&qn(h),Qf(l),a.resolving=!1,Av()}}return o}function j3(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Js)?n[Js]:void 0;return typeof e=="number"?e>=0?e&nC:H3:e}function fT(n,e,t){let i=1<<n;return!!(t[e+(n>>iC)]&i)}function pT(n,e){return!(n&2)&&!(n&1&&e)}var la=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return aC(this._tNode,this._lView,e,Ks(i),t)}};function H3(){return new la(Un(),Be())}function pa(n){return Au(()=>{let e=n.prototype.constructor,t=e[iu]||t_(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[iu]||t_(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function t_(n){return $y(n)?()=>{let e=t_(On(n));return e&&e()}:Qo(n)}function G3(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[$e]&2048&&!ia(s);){let a=lC(o,s,t,i|2,Ar);if(a!==Ar)return a;let l=o.parent;if(!l){let c=s[av];if(c){let d=c.get(t,Ar,i);if(d!==Ar)return d}l=cC(s),s=s[Xs]}o=l}return r}function cC(n){let e=n[ke],t=e.type;return t===2?e.declTNode:t===1?n[Ai]:null}function Mu(n){return U3(Un(),n)}function $3(){return wl(Un(),Be())}function wl(n,e){return new Oi(Mi(n,e))}var Oi=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=$3}return n})();function z3(n){return n instanceof Oi?n.nativeElement:n}function W3(){return this._results[Symbol.iterator]()}var Xf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Ht}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=DI(e);(this._changesDetected=!CI(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=W3},uC="ngSkipHydration",q3="ngskiphydration";function dC(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let i=e[t];if(typeof i=="number")return!1;if(typeof i=="string"&&i.toLowerCase()===q3)return!0}return!1}function hC(n){return n.hasAttribute(uC)}function Zf(n){return(n.flags&128)===128}function fC(n){if(Zf(n))return!0;let e=n.parent;for(;e;){if(Zf(n)||dC(e))return!0;e=e.parent}return!1}var A_=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(A_||{}),pC=new Map,K3=0;function Y3(){return K3++}function Q3(n){pC.set(n[oo],n)}function n_(n){pC.delete(n[oo])}var gT="__ngContext__";function vl(n,e){fi(e)?(n[gT]=e[oo],Q3(e)):n[gT]=e}function gC(n){return yC(n[ul])}function mC(n){return yC(n[Di])}function yC(n){for(;n!==null&&!pi(n);)n=n[Di];return n}var i_;function M_(n){i_=n}function vC(){if(i_!==void 0)return i_;if(typeof document<"u")return document;throw new me(210,!1)}var Rr=new we("",{factory:()=>J3}),J3="ng";var gp=new we(""),Zi=new we("",{providedIn:"platform",factory:()=>"unknown"});var xl=new we("",{factory:()=>K(Qt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Sl=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=X3(K(Qt),K(Rr)),t}});store={};onSerializeCallbacks={};get(t,i){return this.store[t]!==void 0?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function X3(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}var _C="h",EC="b",Z3="f",eF="n",bC="e",wC="t",mp="c",R_="x",Su="r",xC="i",SC="n",k_="d";var IC="di",TC="s",CC="p";var Ru=new we(""),DC=!1,N_=new we("",{factory:()=>DC});var P_=new we(""),AC=!1,MC=new we("",{factory:()=>[]}),RC=new we(""),O_=new we("",{factory:()=>new Map});var ku="ngb";var kC=(n,e,t)=>{let i=n,r=i.__jsaction_fns??new Map,o=r.get(e)??[];o.push(t),r.set(e,o),i.__jsaction_fns=r},NC=(n,e)=>{let t=n,i=t.getAttribute(ku)??"",r=e.get(i)??new Set;r.has(t)||r.add(t),e.set(i,r)};var PC=n=>{n.removeAttribute(Lf.JSACTION),n.removeAttribute(ku),n.__jsaction_fns=void 0},OC=new we("",{factory:()=>({})});function F_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let i of t)i(n)}var r_=new Map;function FC(n,e){return r_.set(n,e),()=>r_.delete(n)}var mT=!1,LC=(n,e,t,i)=>{};function tF(n,e,t,i){LC(n,e,t,i)}function VC(){mT||(LC=(n,e,t,i)=>{let r=n[di].get(Rr);r_.get(r)?.(e,t,i)},mT=!0)}var yp=new we("");function vp(n){return(n.flags&32)===32}var nF="__nghData__",L_=nF,iF="__nghDeferData__",UC=iF;var Gf="ngh",BC="nghm",jC=()=>null;function rF(n,e,t=!1){let i=n.getAttribute(Gf);if(i==null)return null;let[r,o]=i.split("|");if(i=t?o:r,!i)return null;let s=o?`|${o}`:"",a=t?r:s,l={};if(i!==""){let d=e.get(Sl,null,{optional:!0});d!==null&&(l=d.get(L_,[])[Number(i)])}let c={data:l,firstChild:n.firstChild??null};return t&&(c.firstChild=n,_p(c,0,n.nextSibling)),a?n.setAttribute(Gf,a):n.removeAttribute(Gf),c}function HC(){jC=rF}function GC(n,e,t=!1){return jC(n,e,t)}function $C(n){let e=n._lView;return e[ke].type===2?null:(ia(e)&&(e=e[ut]),e)}function oF(n){return n.textContent?.replace(/\s/gm,"")}function sF(n){let e=vC(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=oF(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),i,r=[];for(;i=t.nextNode();)r.push(i);for(let o of r)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function _p(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function o_(n,e){return n.segmentHeads?.[e]??null}function zC(n){return n.get(RC,!1,{optional:!0})}function aF(n,e){let t=n.data,i=t[bC]?.[e]??null;return i===null&&t[mp]?.[e]&&(i=V_(n,e)),i}function WC(n,e){return n.data[mp]?.[e]??null}function V_(n,e){let t=WC(n,e)??[],i=0;for(let r of t)i+=r[Su]*(r[R_]??1);return i}function lF(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[k_];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function qC(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[k_];n.disconnectedNodes=t?new Set(t):null}return!!lF(n)?.has(e)}function Ep(n,e){let t=n[ni];return t!==null&&!vv()&&!vp(e)&&!qC(t,e.index-ut)}function cF(n,e){let t=e.get(yp),r=e.get(Sl).get(UC,{}),o=!1,s=n,a=null,l=[];for(;!o&&s;){o=t.has(s);let c=t.hydrating.get(s);if(a===null&&c!=null){a=c.promise;break}l.unshift(s),s=r[s][CC]}return{parentBlockPromise:a,hydrationQueue:l}}function jv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===BC}function yT(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function KC(n){for(let i of n.body.childNodes)if(jv(i))return;let e=yT(n.body.previousSibling);if(jv(e))return;let t=yT(n.head.lastChild);if(!jv(t))throw new me(-507,!1)}function YC(n,e){let t=n.contentQueries;if(t!==null){let i=Ue(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];kf(o),a.contentQueries(2,e[s],s)}}}finally{Ue(i)}}}function s_(n,e,t){kf(0);let i=Ue(null);try{e(n,t)}finally{Ue(i)}}function QC(n,e,t){if(lv(e)){let i=Ue(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ue(i)}}}var Xi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Xi||{});var Vf;function uF(){if(Vf===void 0&&(Vf=null,Er.trustedTypes))try{Vf=Er.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Vf}function vT(n){return uF()?.createScriptURL(n)||n}var ep=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${vf})`}};function Il(n){return n instanceof ep?n.changingThisBreaksApplicationSecurity:n}function bp(n,e){let t=JC(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${vf})`)}return t===e}function JC(n){return n instanceof ep&&n.getTypeName()||null}var dF=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function U_(n){return n=String(n),n.match(dF)?n:"unsafe:"+n}var hF=/^>|^->|<!--|-->|--!>|<!-$/g,fF=/(<|>)/g,pF="\u200B$1\u200B";function gF(n){return n.replace(hF,e=>e.replace(fF,pF))}function XC(n,e){return n.createText(e)}function mF(n,e,t){n.setValue(e,t)}function ZC(n,e){return n.createComment(gF(e))}function B_(n,e,t){return n.createElement(e,t)}function tp(n,e,t,i,r){n.insertBefore(e,t,i,r)}function eD(n,e,t){n.appendChild(e,t)}function _T(n,e,t,i,r){i!==null?tp(n,e,t,i,r):eD(n,e,t)}function j_(n,e,t,i){n.removeChild(null,e,t,i)}function tD(n){n.textContent=""}function yF(n,e,t){n.setAttribute(e,"style",t)}function vF(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function nD(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&N3(n,e,i),r!==null&&vF(n,e,r),o!==null&&yF(n,e,o)}var Nu=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Nu||{});function er(n){let e=rD();return e?e.sanitize(Nu.URL,n)||"":bp(n,"URL")?Il(n):U_(Ki(n))}function iD(n){let e=rD();if(e)return vT(e.sanitize(Nu.RESOURCE_URL,n)||"");if(bp(n,"ResourceURL"))return vT(Il(n));throw new me(904,!1)}var _F=new Set(["embed","frame","iframe","media","script"]),EF=new Set(["base","link","script"]);function bF(n,e){return e==="src"&&_F.has(n)||e==="href"&&EF.has(n)||e==="xlink:href"&&n==="script"?iD:er}function H_(n,e,t){return bF(e,t)(n)}function rD(){let n=Be();return n&&n[Sr].sanitizer}function ss(n){return n.ownerDocument.defaultView}function oD(n){return n.ownerDocument.body}function sD(n){return n instanceof Function?n():n}function wF(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var aD="ng-template";function xF(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&wF(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(G_(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function G_(n){return n.type===4&&n.value!==aD}function SF(n,e,t){let i=n.type===4&&!t?aD:n.value;return e===i}function IF(n,e,t){let i=4,r=n.attrs,o=r!==null?DF(r):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Qi(i)&&!Qi(l))return!1;if(s&&Qi(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!SF(n,l,t)||l===""&&e.length===1){if(Qi(i))return!1;s=!0}}else if(i&8){if(r===null||!xF(n,r,l,t)){if(Qi(i))return!1;s=!0}}else{let c=e[++a],d=TF(l,r,G_(n),t);if(d===-1){if(Qi(i))return!1;s=!0;continue}if(c!==""){let h;if(d>o?h="":h=r[d+1].toLowerCase(),i&2&&c!==h){if(Qi(i))return!1;s=!0}}}}return Qi(i)||s}function Qi(n){return(n&1)===0}function TF(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return AF(e,n)}function CF(n,e,t=!1){for(let i=0;i<e.length;i++)if(IF(n,e[i],t))return!0;return!1}function DF(n){for(let e=0;e<n.length;e++){let t=n[e];if(eC(t))return e}return n.length}function AF(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function ET(n,e){return n?":not("+e.trim()+")":e}function MF(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!Qi(s)&&(e+=ET(o,r),r=""),i=s,o=o||!Qi(i);t++}return r!==""&&(e+=ET(o,r)),e}function RF(n){return n.map(MF).join(",")}function kF(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!Qi(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var In={};function $_(n,e,t,i,r,o,s,a,l,c,d){let h=ut+i,f=h+r,m=NF(h,f),w=typeof c=="function"?c():c;return m[ke]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:w,incompleteFirstPass:!1,ssrId:d}}function NF(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:In);return t}function PF(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=$_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function z_(n,e,t,i,r,o,s,a,l,c,d){let h=e.blueprint.slice();return h[Qn]=r,h[$e]=i|4|128|8|64|1024,(c!==null||n&&n[$e]&2048)&&(h[$e]|=2048),dv(h),h[Zt]=h[Xs]=n,h[en]=t,h[Sr]=s||n&&n[Sr],h[St]=a||n&&n[St],h[di]=l||n&&n[di]||null,h[Ai]=o,h[oo]=Y3(),h[ni]=d,h[av]=c,h[Jn]=e.type==2?n[Jn]:h,h}function OF(n,e,t){let i=Mi(e,n),r=PF(t),o=n[Sr].rendererFactory,s=W_(n,z_(n,r,null,lD(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function lD(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function cD(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function W_(n,e){return n[ul]?n[sv][Di]=e:n[ul]=e,n[sv]=e,e}function g(n=1){uD(tn(),Be(),Ni()+n,!1)}function uD(n,e,t,i){if(!i)if((e[$e]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Bf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&jf(e,o,0,t)}is(t)}var wp=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(wp||{});function a_(n,e,t,i){let r=Ue(null);try{let[o,s,a]=n.inputs[t],l=null;(s&wp.SignalBased)!==0&&(l=e[o][ei]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,l,i,t,o):KT(e,l,o,i)}finally{Ue(r)}}var Mr=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Mr||{}),FF;function q_(n,e){return FF(n,e)}var ua=new Set,xp=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(xp||{}),as=new we(""),bT=new Set;function vi(n){bT.has(n)||(bT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var K_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),dD=[0,1,2,3],hD=(()=>{class n{ngZone=K(yn);scheduler=K(Xo);errorHandler=K(_r,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){K(as,{optional:!0})}execute(){let t=this.sequences.size>0;t&&pt(at.AfterRenderHooksStart),this.executing=!0;for(let i of dD)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&pt(at.AfterRenderHooksEnd)}register(t){let{view:i}=t;i!==void 0?((i[ea]??=[]).push(t),dl(i),i[$e]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(xp.AFTER_NEXT_RENDER,t):t()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),np=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[ea];e&&(this.view[ea]=e.filter(t=>t!==this))}};function Pu(n,e){let t=e?.injector??K(Yn);return vi("NgAfterNextRender"),VF(n,t,e,!0)}function LF(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function VF(n,e,t,i){let r=e.get(K_);r.impl??=e.get(hD);let o=e.get(as,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(ii):null,a=e.get(Ff,null,{optional:!0}),l=new np(r.impl,LF(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(l),l}var fD=new we("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:K(Yt)})});function pD(n,e,t){let i=n.get(fD);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function UF(n,e){let t=n.get(fD);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function BF(n,e){for(let[t,i]of e)pD(n,i.animateFns)}function wT(n,e,t,i){let r=n?.[ta]?.enter;e!==null&&r&&r.has(t.index)&&BF(i,r)}function fl(n,e,t,i,r,o,s,a){if(r!=null){let l,c=!1;pi(r)?l=r:fi(r)&&(c=!0,r=r[Qn]);let d=gi(r);n===0&&i!==null?(wT(a,i,o,t),s==null?eD(e,i,d):tp(e,i,d,s||null,!0)):n===1&&i!==null?(wT(a,i,o,t),tp(e,i,d,s||null,!0)):n===2?xT(a,o,t,h=>{j_(e,d,c,h)}):n===3&&xT(a,o,t,()=>{e.destroyNode(d)}),l!=null&&ZF(e,n,t,l,o,i,s)}}function jF(n,e){gD(n,e),e[Qn]=null,e[Ai]=null}function HF(n,e,t,i,r,o){i[Qn]=r,i[Ai]=e,Ip(n,i,t,1,r,o)}function gD(n,e){e[Sr].changeDetectionScheduler?.notify(9),Ip(n,e,e[St],2,null,null)}function GF(n){let e=n[ul];if(!e)return Hv(n[ke],n);for(;e;){let t=null;if(fi(e))t=e[ul];else{let i=e[zt];i&&(t=i)}if(!t){for(;e&&!e[Di]&&e!==n;)fi(e)&&Hv(e[ke],e),e=e[Zt];e===null&&(e=n),fi(e)&&Hv(e[ke],e),t=e&&e[Di]}e=t}}function Y_(n,e){let t=n[na],i=t.indexOf(e);t.splice(i,1)}function Sp(n,e){if(ns(e))return;let t=e[St];t.destroyNode&&Ip(n,e,t,3,null,null),GF(e)}function Hv(n,e){if(ns(e))return;let t=Ue(null);try{e[$e]&=-129,e[$e]|=256,e[hi]&&Kc(e[hi]),WF(n,e),zF(n,e),e[ke].type===1&&e[St].destroy();let i=e[ts];if(i!==null&&pi(e[Zt])){i!==e[Zt]&&Y_(i,e);let r=e[Ir];r!==null&&r.detachView(n)}n_(e)}finally{Ue(t)}}function xT(n,e,t,i){let r=n?.[ta];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&ua.add(n[oo]),pD(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let c=s.animateFns[l],{promise:d}=c();a.push(d)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),$F(n,i)}else n&&ua.delete(n[oo]),i(!1)},r)}function $F(n,e){let t=n[ta]?.running;if(t){t.then(()=>{n[ta].running=void 0,ua.delete(n[oo]),e(!0)});return}e(!1)}function zF(n,e){let t=n.cleanup,i=e[cl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[cl]=null);let r=e[to];if(r!==null){e[to]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[du];if(o!==null){e[du]=null;for(let s of o)s.destroy()}}function WF(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof ca)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],l=o[s+1];pt(at.LifecycleHookStart,a,l);try{l.call(a)}finally{pt(at.LifecycleHookEnd,a,l)}}else{pt(at.LifecycleHookStart,r,o);try{o.call(r)}finally{pt(at.LifecycleHookEnd,r,o)}}}}}function qF(n,e,t){return KF(n,e.parent,t)}function KF(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Qn];if(so(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Xi.None||r===Xi.Emulated)return null}return Mi(i,t)}function YF(n,e,t){return JF(n,e,t)}function QF(n,e,t){return n.type&40?Mi(n,t):null}var JF=QF,ST;function Q_(n,e,t,i){let r=qF(n,i,e),o=e[St],s=i.parent||e[Ai],a=YF(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)_T(o,r,t[l],a,!1);else _T(o,r,t,a,!1);ST!==void 0&&ST(o,i,e,t,r)}function bu(n,e){if(e!==null){let t=e.type;if(t&3)return Mi(e,n);if(t&4)return l_(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return bu(n,i);{let r=n[e.index];return pi(r)?l_(-1,r):gi(r)}}else{if(t&128)return bu(n,e.next);if(t&32)return q_(e,n)()||gi(n[e.index]);{let i=mD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=Jo(n[Jn]);return bu(r,i)}else return bu(n,e.next)}}}return null}function mD(n,e){if(e!==null){let i=n[Jn][Ai],r=e.projection;return i.projection[r]}return null}function l_(n,e){let t=zt+n+1;if(t<e.length){let i=e[t],r=i[ke].firstChild;if(r!==null)return bu(i,r)}return e[Tr]}function J_(n,e,t,i,r,o,s){for(;t!=null;){let a=i[di];if(t.type===128){t=t.next;continue}let l=i[t.index],c=t.type;if(s&&e===0&&(l&&vl(gi(l),i),t.flags|=2),!vp(t))if(c&8)J_(n,e,t.child,i,r,o,!1),fl(e,n,a,r,l,t,o,i);else if(c&32){let d=q_(t,i),h;for(;h=d();)fl(e,n,a,r,h,t,o,i);fl(e,n,a,r,l,t,o,i)}else c&16?XF(n,e,i,t,r,o):fl(e,n,a,r,l,t,o,i);t=s?t.projectionNext:t.next}}function Ip(n,e,t,i,r,o){J_(t,i,n.firstChild,e,r,o,!1)}function XF(n,e,t,i,r,o){let s=t[Jn],l=s[Ai].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];fl(e,n,t[di],r,d,i,o,t)}else{let c=l,d=s[Zt];Zf(i)&&(c.flags|=128),J_(n,e,c,d,r,o,!0)}}function ZF(n,e,t,i,r,o,s){let a=i[Tr],l=gi(i);a!==l&&fl(e,n,t,o,a,r,s);for(let c=zt;c<i.length;c++){let d=i[c];Ip(d[ke],d,n,e,o,a)}}function eL(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:Mr.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Mr.Important),n.setStyle(t,i,r,o))}}function yD(n,e,t,i,r){let o=Ni(),s=i&2;try{is(-1),s&&e.length>ut&&uD(n,e,ut,!1);let a=s?at.TemplateUpdateStart:at.TemplateCreateStart;pt(a,r,t),t(i,r)}finally{is(o);let a=s?at.TemplateUpdateEnd:at.TemplateCreateEnd;pt(a,r,t)}}function X_(n,e,t){lL(n,e,t),(t.flags&64)===64&&cL(n,e,t)}function Tp(n,e,t=Mi){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function tL(n,e,t,i){let o=i.get(N_,DC)||t===Xi.ShadowDom||t===Xi.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return nL(s),s}function nL(n){vD(n)}var vD=()=>null;function iL(n){hC(n)?tD(n):sF(n)}function _D(){vD=iL}function rL(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function oL(n,e,t,i,r,o){let s=e[ke];if(eE(n,s,e,t,i)){so(n)&&aL(e,n.index);return}n.type&3&&(t=rL(t)),sL(n,e,t,i,r,o)}function sL(n,e,t,i,r,o){if(n.type&3){let s=Mi(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function aL(n,e){let t=Ri(e,n);t[$e]&16||(t[$e]|=64)}function lL(n,e,t){let i=t.directiveStart,r=t.directiveEnd;so(t)&&OF(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Jf(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],l=xu(e,n,s,t);if(vl(l,e),o!==null&&fL(e,s-i,l,a,t,o),Cr(a)){let c=Ri(t.index,e);c[en]=xu(e,n,s,t)}}}function cL(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=JI();try{is(o);for(let a=i;a<r;a++){let l=n.data[a],c=e[a];Rf(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&uL(l,c)}}finally{is(-1),Rf(s)}}function uL(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function ED(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];CF(e,o.selectors,!1)&&(i??=[],Cr(o)?i.unshift(o):i.push(o))}return i}function dL(n,e,t,i,r,o){let s=Mi(n,e);hL(e[St],s,o,n.value,t,i,r)}function hL(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?Ki(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function fL(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];a_(i,t,l,c)}}function bD(n,e,t,i,r){let o=ut+t,s=e[ke],a=r(s,e,n,i,t);e[o]=a,oa(n,!0);let l=n.type===2;return l?(nD(e[St],a,n),(GI()===0||fu(n))&&vl(a,e),$I()):vl(a,e),Of()&&(!l||!vp(n))&&Q_(s,e,a,n),n}function wD(n){let e=n;return wv()?qI():(e=e.parent,oa(e,!1)),e}function Z_(n,e){let t=n[di];if(!t)return;let i;try{i=t.get(mi,null)}catch{i=null}i?.(e)}function eE(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],d=s[l+1],h=e.data[c];a_(h,t[c],d,r),a=!0}if(o)for(let l of o){let c=t[l],d=e.data[l];a_(d,c,i,r),a=!0}return a}function pL(n,e){let t=Ri(e,n),i=t[ke];gL(i,t);let r=t[Qn];r!==null&&t[ni]===null&&(t[ni]=GC(r,t[di])),pt(at.ComponentStart);try{tE(i,t,t[en])}finally{pt(at.ComponentEnd,t[en])}}function gL(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function tE(n,e,t){Nf(e);try{let i=n.viewQuery;i!==null&&s_(1,i,t);let r=n.template;r!==null&&yD(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ir]?.finishViewCreation(n),n.staticContentQueries&&YC(n,e),n.staticViewQueries&&s_(2,n.viewQuery,t);let o=n.components;o!==null&&mL(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[$e]&=-5,Pf()}}function mL(n,e){for(let t=0;t<e.length;t++)pL(n,e[t])}function Ou(n,e,t,i){let r=Ue(null);try{let o=e.tView,a=n[$e]&4096?4096:16,l=z_(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),c=n[e.index];l[ts]=c;let d=n[Ir];return d!==null&&(l[Ir]=d.createEmbeddedView(o)),tE(o,l,t),l}finally{Ue(r)}}function _l(n,e){return!e||e.firstChild===null||Zf(n)}function Iu(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(gi(o)),pi(o)&&xD(o,i);let s=t.type;if(s&8)Iu(n,e,t.child,i);else if(s&32){let a=q_(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=mD(e,t);if(Array.isArray(a))i.push(...a);else{let l=Jo(e[Jn]);Iu(l[ke],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function xD(n,e){for(let t=zt;t<n.length;t++){let i=n[t],r=i[ke].firstChild;r!==null&&Iu(i[ke],i,r,e)}n[Tr]!==n[Qn]&&e.push(n[Tr])}function SD(n){if(n[ea]!==null){for(let e of n[ea])e.impl.addSequence(e);n[ea].length=0}}var ID=[];function yL(n){return n[hi]??vL(n)}function vL(n){let e=ID.pop()??Object.create(EL);return e.lView=n,e}function _L(n){n.lView[hi]!==n&&(n.lView=null,ID.push(n))}var EL=ce(F({},zc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{dl(n.lView)},consumerOnSignalRead(){this.lView[hi]=this}});function bL(n){let e=n[hi]??Object.create(wL);return e.lView=n,e}var wL=ce(F({},zc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Jo(n.lView);for(;e&&!TD(e[ke]);)e=Jo(e);e&&hv(e)},consumerOnSignalRead(){this.lView[hi]=this}});function TD(n){return n.type!==2}function CD(n){if(n[du]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[du])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[$e]&8192)}}var xL=100;function DD(n,e=0){let i=n[Sr].rendererFactory,r=!1;r||i.begin?.();try{SL(n,e)}finally{r||i.end?.()}}function SL(n,e){let t=Sv();try{Iv(!0),c_(n,e);let i=0;for(;mu(n);){if(i===xL)throw new me(103,!1);i++,c_(n,1)}}finally{Iv(t)}}function IL(n,e,t,i){if(ns(e))return;let r=e[$e],o=!1,s=!1;Nf(e);let a=!0,l=null,c=null;o||(TD(n)?(c=yL(e),l=qc(c)):Ph()===null?(a=!1,c=bL(e),l=qc(c)):e[hi]&&(Kc(e[hi]),e[hi]=null));try{dv(e),KI(n.bindingStartIndex),t!==null&&yD(n,e,t,2,i);let d=(r&3)===3;if(!o)if(d){let m=n.preOrderCheckHooks;m!==null&&Bf(e,m,null)}else{let m=n.preOrderHooks;m!==null&&jf(e,m,0,null),Uv(e,0)}if(s||TL(e),CD(e),AD(e,0),n.contentQueries!==null&&YC(n,e),!o)if(d){let m=n.contentCheckHooks;m!==null&&Bf(e,m)}else{let m=n.contentHooks;m!==null&&jf(e,m,1),Uv(e,1)}DL(n,e);let h=n.components;h!==null&&RD(e,h,0);let f=n.viewQuery;if(f!==null&&s_(2,f,i),!o)if(d){let m=n.viewCheckHooks;m!==null&&Bf(e,m)}else{let m=n.viewHooks;m!==null&&jf(e,m,2),Uv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Df]){for(let m of e[Df])m();e[Df]=null}o||(SD(e),e[$e]&=-73)}catch(d){throw o||dl(e),d}finally{c!==null&&(Oh(c,l),a&&_L(c)),Pf()}}function AD(n,e){for(let t=gC(n);t!==null;t=mC(t))for(let i=zt;i<t.length;i++){let r=t[i];MD(r,e)}}function TL(n){for(let e=gC(n);e!==null;e=mC(e)){if(!(e[$e]&2))continue;let t=e[na];for(let i=0;i<t.length;i++){let r=t[i];hv(r)}}}function CL(n,e,t){pt(at.ComponentStart);let i=Ri(e,n);try{MD(i,t)}finally{pt(at.ComponentEnd,i[en])}}function MD(n,e){Af(n)&&c_(n,e)}function c_(n,e){let i=n[ke],r=n[$e],o=n[hi],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&Fh(o)),s||=!1,o&&(o.dirty=!1),n[$e]&=-9217,s)IL(i,n,i.template,n[en]);else if(r&8192){let a=Ue(null);try{CD(n),AD(n,1);let l=i.components;l!==null&&RD(n,l,1),SD(n)}finally{Ue(a)}}}function RD(n,e,t){for(let i=0;i<e.length;i++)CL(n,e[i],t)}function DL(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)is(~r);else{let o=r,s=t[++i],a=t[++i];QI(s,o);let l=e[o];pt(at.HostBindingsUpdateStart,l);try{a(2,l)}finally{pt(at.HostBindingsUpdateEnd,l)}}}}finally{is(-1)}}function Cp(n,e){let t=Sv()?64:1088;for(n[Sr].changeDetectionScheduler?.notify(e);n;){n[$e]|=t;let i=Jo(n);if(ia(n)&&!i)return n;n=i}return null}function kD(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function ND(n,e){let t=zt+e;if(t<n.length)return n[t]}function Fu(n,e,t,i=!0){let r=e[ke];if(AL(r,e,n,t),i){let s=l_(t,n),a=e[St],l=a.parentNode(n[Tr]);l!==null&&HF(r,n[Ai],a,e,l,s)}let o=e[ni];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function nE(n,e){let t=Tu(n,e);return t!==void 0&&Sp(t[ke],t),t}function Tu(n,e){if(n.length<=zt)return;let t=zt+e,i=n[t];if(i){let r=i[ts];r!==null&&r!==n&&Y_(r,i),e>0&&(n[t-1][Di]=i[Di]);let o=lu(n,zt+e);jF(i[ke],i);let s=o[Ir];s!==null&&s.detachView(o[ke]),i[Zt]=null,i[Di]=null,i[$e]&=-129}return i}function AL(n,e,t,i){let r=zt+i,o=t.length;i>0&&(t[r-1][Di]=e),i<o-zt?(e[Di]=t[r],tv(t,zt+i,e)):(t.push(e),e[Di]=null),e[Zt]=t;let s=e[ts];s!==null&&t!==s&&PD(s,e);let a=e[Ir];a!==null&&a.insertView(n),Mf(e),e[$e]|=128}function PD(n,e){let t=n[na],i=e[Zt];if(fi(i))n[$e]|=2;else{let r=i[Zt][Jn];e[Jn]!==r&&(n[$e]|=2)}t===null?n[na]=[e]:t.push(e)}var rs=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[ke];return Iu(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[en]}set context(e){this._lView[en]=e}get destroyed(){return ns(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Zt];if(pi(e)){let t=e[hu],i=t?t.indexOf(this):-1;i>-1&&(Tu(e,i),lu(t,i))}this._attachedToViewContainer=!1}Sp(this._lView[ke],this._lView)}onDestroy(e){fv(this._lView,e)}markForCheck(){Cp(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[$e]&=-129}reattach(){Mf(this._lView),this._lView[$e]|=128}detectChanges(){this._lView[$e]|=1024,DD(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new me(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=ia(this._lView),t=this._lView[ts];t!==null&&!e&&Y_(t,this._lView),gD(this._lView[ke],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new me(902,!1);this._appRef=e;let t=ia(this._lView),i=this._lView[ts];i!==null&&!t&&PD(i,this._lView),Mf(this._lView)}};var os=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=ML;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Ou(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new rs(o)}}return n})();function ML(){return Dp(Un(),Be())}function Dp(n,e){return n.type&4?new os(e,n,wl(n,e)):null}function Tl(n,e,t,i,r){let o=n.data[e];if(o===null)o=RL(n,e,t,i,r),YI()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=WI();o.injectorIndex=s===null?-1:s.injectorIndex}return oa(o,!0),o}function RL(n,e,t,i,r){let o=bv(),s=wv(),a=s?o:o&&o.parent,l=n.data[e]=NL(n,a,t,e,i,r);return kL(n,l,o,s),l}function kL(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function NL(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return vv()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var PL=new RegExp(`^(\\d+)*(${EC}|${_C})*(.*)`);function OL(n){let e=n.match(PL),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(let[l,c,d]of o.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(c,h)}return[s,...a]}function FL(n){return!n.prev&&n.parent?.type===8}function Gv(n){return n.index-ut}function LL(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function Ap(n,e,t,i){let r=Gv(i),o=LL(n,r);if(o===void 0){let s=n.data[SC];if(s?.[r])o=UL(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{let a=i.prev===null,l=i.prev??i.parent;if(FL(i)){let c=Gv(i.parent);o=o_(n,c)}else{let c=Mi(l,t);if(a)o=c.firstChild;else{let d=Gv(l),h=o_(n,d);if(l.type===2&&h){let m=V_(n,d)+1;o=Mp(m,h)}else o=c.nextSibling}}}}return o}function Mp(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}function VL(n,e){let t=n;for(let i=0;i<e.length;i+=2){let r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case Z3:t=t.firstChild;break;case eF:t=t.nextSibling;break}}return t}function UL(n,e){let[t,...i]=OL(n),r;if(t===_C)r=e[Jn][Qn];else if(t===EC)r=oD(e[Jn][Qn]);else{let o=Number(t);r=gi(e[o+ut])}return VL(r,i)}var BL=!1;function OD(n){BL=n}function jL(n){let e=n[ni];if(e){let{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){let r=n[St];for(let o of i.values())HL(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function HL(n,e,t){for(let i of t.node.cases[t.case]){let r=e.get(i.index-ut);r&&j_(n,r,!1)}}function Rp(n){let e=n[Yi]??[],i=n[Zt][St],r=[];for(let o of e)o.data[IC]!==void 0?r.push(o):FD(o,i);n[Yi]=r}function GL(n){let{lContainer:e}=n,t=e[Yi];if(t===null)return;let r=e[Zt][St];for(let o of t)FD(o,r)}function FD(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[Su];for(;t<r;){let o=i.nextSibling;j_(e,i,!1),i=o,t++}}}function kp(n){Rp(n);let e=n[Qn];fi(e)&&ip(e);for(let t=zt;t<n.length;t++)ip(n[t])}function ip(n){jL(n);let e=n[ke];for(let t=ut;t<e.bindingStartIndex;t++)if(pi(n[t])){let i=n[t];kp(i)}else fi(n[t])&&ip(n[t])}function iE(n){let e=n._views;for(let t of e){let i=$C(t);i!==null&&i[Qn]!==null&&(fi(i)?ip(i):kp(i))}}function $L(n,e,t,i){n!==null&&(t.cleanup(e),kp(n.lContainer),iE(i))}function zL(n,e){let t=[];for(let i of e)for(let r=0;r<(i[R_]??1);r++){let o={data:i,firstChild:null};i[Su]>0&&(o.firstChild=n,n=Mp(i[Su],n)),t.push(o)}return[n,t]}var LD=()=>null,VD=()=>null;function UD(){LD=WL,VD=qL}function WL(n,e){return jD(n,e)?n[Yi].shift():(Rp(n),null)}function rp(n,e){return LD(n,e)}function qL(n,e,t){if(e.tView.ssrId===null)return null;let i=rp(n,e.tView.ssrId);return t[ke].firstUpdatePass&&i===null&&KL(t,e),i}function BD(n,e,t){return VD(n,e,t)}function KL(n,e){let t=e;for(;t;){if(IT(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(IT(n,t))return;t=t.next}}function jD(n,e){let t=n[Yi];return!e||t===null||t.length===0?!1:t[0].data[xC]===e}function IT(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let i=n[e.index];return pi(i)&&jD(i,t)?(Rp(i),!0):!1}var HD=class{},Np=class{},u_=class{resolveComponentFactory(e){throw new me(917,!1)}},Lu=class{static NULL=new u_},da=class{},ls=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>YL()}return n})();function YL(){let n=Be(),e=Un(),t=Ri(e.index,n);return(fi(t)?t:n)[St]}var GD=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>null})}return n})();var $f={},gl=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,$f,i);return r!==$f||t===$f?r:this.parentInjector.get(e,t,i)}};function op(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=_f(r,a);else if(o==2){let l=a,c=e[++s];i=_f(i,l+": "+c+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function he(n,e=0){let t=Be();if(t===null)return Re(n,e);let i=Un();return aC(i,t,On(n),e)}function $D(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,l=null,c=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,l,c]=d.resolveHostDirectives(s);break}XL(n,e,t,a,o,l,c)}o!==null&&i!==null&&QL(t,i,o)}function QL(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new me(-301,!1);i.push(e[r],o)}}function JL(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function XL(n,e,t,i,r,o,s){let a=i.length,l=null;for(let f=0;f<a;f++){let m=i[f];l===null&&Cr(m)&&(l=m,JL(n,t,f)),e_(Jf(t,e),n,m.type)}rV(t,n.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let f=0;f<a;f++){let m=i[f];m.providersResolver&&m.providersResolver(m)}let c=!1,d=!1,h=cD(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let f=0;f<a;f++){let m=i[f];if(t.mergedAttrs=yl(t.mergedAttrs,m.hostAttrs),eV(n,t,e,h,m),iV(h,m,r),s!==null&&s.has(m)){let[S,k]=s.get(m);t.directiveToIndex.set(m.type,[h,S+t.directiveStart,k+t.directiveStart])}else(o===null||!o.has(m))&&t.directiveToIndex.set(m.type,h);m.contentQueries!==null&&(t.flags|=4),(m.hostBindings!==null||m.hostAttrs!==null||m.hostVars!==0)&&(t.flags|=64);let w=m.type.prototype;!c&&(w.ngOnChanges||w.ngOnInit||w.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!d&&(w.ngOnChanges||w.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}ZL(n,t,o)}function ZL(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))TT(0,e,r,i),TT(1,e,r,i),DT(e,i,!1);else{let o=t.get(r);CT(0,e,o,i),CT(1,e,o,i),DT(e,i,!0)}}}function TT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),zD(e,o)}}function CT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),zD(e,s)}}function zD(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function DT(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||G_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&r.hasOwnProperty(l)){let c=r[l];for(let d of c)if(d===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let c=o[l];for(let d=0;d<c.length;d+=2)if(c[d]===e){s??=[],s.push(c[d+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function eV(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Qo(r.type,!0)),s=new ca(o,Cr(r),he,null);n.blueprint[i]=s,t[i]=s,tV(n,e,i,cD(n,t,r.hostVars,In),r)}function tV(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;nV(s)!=a&&s.push(a),s.push(t,i,o)}}function nV(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function iV(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Cr(e)&&(t[""]=n)}}function rV(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function WD(n,e,t,i,r,o,s,a){let l=e[ke],c=l.consts,d=ki(c,s),h=Tl(l,n,t,i,d);return o&&$D(l,e,h,ki(c,a),r),h.mergedAttrs=yl(h.mergedAttrs,h.attrs),h.attrs!==null&&op(h,h.attrs,!1),h.mergedAttrs!==null&&op(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function qD(n,e){XT(n,e),lv(e)&&n.queries.elementEnd(e)}function oV(n,e,t,i,r,o){let s=e.consts,a=ki(s,r),l=Tl(e,n,t,i,a);if(l.mergedAttrs=yl(l.mergedAttrs,l.attrs),o!=null){let c=ki(s,o);l.localNames=[];for(let d=0;d<c.length;d+=2)l.localNames.push(c[d],-1)}return l.attrs!==null&&op(l,l.attrs,!1),l.mergedAttrs!==null&&op(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function rE(n){return YD(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function KD(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function YD(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Pp(n,e,t){return n[e]=t}function sV(n,e){return n[e]}function Pi(n,e,t){if(t===In)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function oE(n,e,t,i){let r=Pi(n,e,t);return Pi(n,e+1,i)||r}function QD(n,e,t,i,r){let o=oE(n,e,t,i);return Pi(n,e+2,r)||o}function zf(n,e,t){return function i(r){let o=so(n)?Ri(n.index,e):e;Cp(o,5);let s=e[en],a=AT(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=AT(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function AT(n,e,t,i){let r=Ue(null);try{return pt(at.OutputStart,e,t),t(i)!==!1}catch(o){return Z_(n,o),!1}finally{pt(at.OutputEnd,e,t),Ue(r)}}function JD(n,e,t,i,r,o,s,a){let l=fu(n),c=!1,d=null;if(!i&&l&&(d=lV(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,c=!0}else{let h=Mi(n,t),f=i?i(h):h;tF(t,f,o,a);let m=r.listen(f,o,a);if(!aV(o)){let w=i?S=>i(gi(S[n.index])):n.index;XD(w,e,t,o,a,m,!1)}}return c}function aV(n){return n.startsWith("animation")||n.startsWith("transition")}function lV(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[cl],l=r[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function XD(n,e,t,i,r,o,s){let a=e.firstCreatePass?gv(e):null,l=pv(t),c=l.length;l.push(r,o),a&&a.push(i,n,c,(c+1)*(s?-1:1))}function MT(n,e,t,i,r,o){let s=e[t],a=e[ke],c=a.data[t].outputs[i],h=s[c].subscribe(o);XD(n.index,a,e,r,o,h,!0)}var d_=Symbol("BINDING");var sp=class extends Lu{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ro(e);return new El(t,this.ngModule)}};function cV(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&wp.SignalBased)!==0};return r&&(o.transform=r),o})}function uV(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function dV(n,e,t){let i=e instanceof Yt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new gl(t,i):t}function hV(n){let e=n.get(da,null);if(e===null)throw new me(407,!1);let t=n.get(GD,null),i=n.get(Xo,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function fV(n,e){let t=ZD(n);return B_(e,t,t==="svg"?cv:t==="math"?LI:null)}function ZD(n){return(n.selectors[0][0]||"div").toLowerCase()}var El=class extends Np{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=cV(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=uV(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=RF(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){pt(at.DynamicComponentStart);let a=Ue(null);try{let l=this.componentDef,c=pV(i,l,s,o),d=dV(l,r||this.ngModule,e),h=hV(d),f=h.rendererFactory.createRenderer(null,l),m=i?tL(f,i,l.encapsulation,d):fV(l,f),w=s?.some(RT)||o?.some(V=>typeof V!="function"&&V.bindings.some(RT)),S=z_(null,c,null,512|lD(l),null,null,h,f,d,null,GC(m,d,!0));S[ut]=m,Nf(S);let k=null;try{let V=WD(ut,S,2,"#host",()=>c.directiveRegistry,!0,0);nD(f,m,V),vl(m,S),X_(c,S,V),QC(c,V,S),qD(c,V),t!==void 0&&mV(V,this.ngContentSelectors,t),k=Ri(V.index,S),S[en]=k[en],tE(c,S,null)}catch(V){throw k!==null&&n_(k),n_(S),V}finally{pt(at.DynamicComponentEnd),Pf()}return new ap(this.componentType,S,!!w)}finally{Ue(a)}}};function pV(n,e,t,i){let r=n?["ng-version","21.1.1"]:kF(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[d_].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(i)for(let d=0;d<i.length;d++){let h=i[d];if(typeof h!="function")for(let f of h.bindings){a+=f[d_].requiredVars;let m=d+1;f.create&&(f.targetIdx=m,(o??=[]).push(f)),f.update&&(f.targetIdx=m,(s??=[]).push(f))}}let l=[e];if(i)for(let d of i){let h=typeof d=="function"?d:d.type,f=bf(h);l.push(f)}return $_(0,null,gV(o,s),1,a,l,null,null,null,[r],null)}function gV(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function RT(n){let e=n[d_].kind;return e==="input"||e==="twoWay"}var ap=class extends HD{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=ra(t[ke],ut),this.location=wl(this._tNode,t),this.instance=Ri(this._tNode.index,t)[en],this.hostView=this.changeDetectorRef=new rs(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=eE(i,r[ke],r,e,t);this.previousInputValues.set(e,t);let s=Ri(i.index,r);Cp(s,1)}get injector(){return new la(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function mV(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var co=(()=>{class n{static __NG_ELEMENT_ID__=yV}return n})();function yV(){let n=Un();return tA(n,Be())}var vV=co,eA=class extends vV{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return wl(this._hostTNode,this._hostLView)}get injector(){return new la(this._hostTNode,this._hostLView)}get parentInjector(){let e=D_(this._hostTNode,this._hostLView);if(tC(e)){let t=Yf(e,this._hostLView),i=Kf(e),r=t[ke].data[i+8];return new la(r,t)}else return new la(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=kT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-zt}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=rp(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,_l(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let l=e&&!I3(e),c;if(l)c=t;else{let k=t||{};c=k.index,i=k.injector,r=k.projectableNodes,o=k.environmentInjector||k.ngModuleRef,s=k.directives,a=k.bindings}let d=l?e:new El(ro(e)),h=i||this.parentInjector;if(!o&&d.ngModule==null){let V=(l?h:this.parentInjector).get(Yt,null);V&&(o=V)}let f=ro(d.componentType??{}),m=rp(this._lContainer,f?.id??null),w=m?.firstChild??null,S=d.create(h,r,w,o,s,a);return this.insertImpl(S.hostView,c,_l(this._hostTNode,m)),S}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(UI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Zt],c=new eA(l,l[Ai],l[Zt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return Fu(s,r,o,i),e.attachToViewContainerRef(),tv($v(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=kT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=Tu(this._lContainer,t);i&&(lu($v(this._lContainer),t),Sp(i[ke],i))}detach(e){let t=this._adjustIndex(e,-1),i=Tu(this._lContainer,t);return i&&lu($v(this._lContainer),t)!=null?new rs(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function kT(n){return n[hu]}function $v(n){return n[hu]||(n[hu]=[])}function tA(n,e){let t,i=e[n.index];return pi(i)?t=i:(t=kD(i,e,null,n),e[n.index]=t,W_(e,t)),nA(t,e,n,i),new eA(t,n,e)}function _V(n,e){let t=n[St],i=t.createComment(""),r=Mi(e,n),o=t.parentNode(r);return tp(t,o,i,t.nextSibling(r),!1),i}var nA=iA,sE=()=>!1;function EV(n,e,t){return sE(n,e,t)}function iA(n,e,t,i){if(n[Tr])return;let r;t.type&8?r=gi(i):r=_V(e,t),n[Tr]=r}function bV(n,e,t){if(n[Tr]&&n[Yi])return!0;let i=t[ni],r=e.index-ut;if(!i||fC(e)||qC(i,r))return!1;let s=o_(i,r),a=i.data[mp]?.[r],[l,c]=zL(s,a);return n[Tr]=l,n[Yi]=c,!0}function wV(n,e,t,i){sE(n,t,e)||iA(n,e,t,i)}function rA(){nA=wV,sE=bV}var h_=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},f_=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)aE(e,t).matches!==null&&this.queries[t].setDirty()}},p_=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=MV(e):this.predicate=e}},g_=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},m_=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,xV(t,o)),this.matchTNodeWithReadOption(e,t,Hf(t,e,o,!1,!1))}else i===os?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Hf(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Oi||r===co||r===os&&t.type&4)this.addMatch(t.index,-2);else{let o=Hf(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function xV(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function SV(n,e){return n.type&11?wl(n,e):n.type&4?Dp(n,e):null}function IV(n,e,t,i){return t===-1?SV(e,n):t===-2?TV(n,e,i):xu(n,n[ke],t,e)}function TV(n,e,t){if(t===Oi)return wl(e,n);if(t===os)return Dp(e,n);if(t===co)return tA(e,n)}function oA(n,e,t,i){let r=e[Ir].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let d=o[c];a.push(IV(e,d,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function y_(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=oA(n,e,r,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)i.push(s[a/2]);else{let c=o[a+1],d=e[-l];for(let h=zt;h<d.length;h++){let f=d[h];f[ts]===f[Zt]&&y_(f[ke],f,c,i)}if(d[na]!==null){let h=d[na];for(let f=0;f<h.length;f++){let m=h[f];y_(m[ke],m,c,i)}}}}}return i}function CV(n,e){return n[Ir].queries[e].queryList}function DV(n,e,t){let i=new Xf((t&4)===4);return HI(n,e,i,i.destroy),(e[Ir]??=new f_).queries.push(new h_(i))-1}function AV(n,e,t){let i=tn();return i.firstCreatePass&&(RV(i,new p_(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),DV(i,Be(),e)}function MV(n){return n.split(",").map(e=>e.trim())}function RV(n,e,t){n.queries===null&&(n.queries=new g_),n.queries.track(new m_(e,t))}function aE(n,e){return n.queries.getByIndex(e)}function kV(n,e){let t=n[ke],i=aE(t,e);return i.crossesNgTemplate?y_(t,n,e,[]):oA(t,n,i,e)}var ha=class{},Op=class{};var lp=class extends ha{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new sp(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=Jy(e);this._bootstrapComponents=sD(o.bootstrap),this._r3Injector=kv(e,t,[{provide:ha,useValue:this},{provide:Lu,useValue:this.componentFactoryResolver},...i],no(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},cp=class extends Op{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new lp(this.moduleType,e,[])}};var Cu=class extends ha{injector;componentFactoryResolver=new sp(this);instance=null;constructor(e){super();let t=new Qs([...e.providers,{provide:ha,useValue:this},{provide:Lu,useValue:this.componentFactoryResolver}],e.parent||uu(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Cl(n,e,t=null){return new Cu({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var NV=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=Cf(!1,t.type),r=i.length>0?Cl([i],this._injector,""):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=pe({token:n,providedIn:"environment",factory:()=>new n(Re(Yt))})}return n})();function It(n){return Au(()=>{let e=sA(n),t=ce(F({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===A_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(NV).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Xi.Emulated,styles:n.styles||Kn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&vi("NgStandalone"),aA(t);let i=n.dependencies;return t.directiveDefs=NT(i,PV),t.pipeDefs=NT(i,Xy),t.id=LV(t),t})}function PV(n){return ro(n)||bf(n)}function uo(n){return Au(()=>({type:n.type,bootstrap:n.bootstrap||Kn,declarations:n.declarations||Kn,imports:n.imports||Kn,exports:n.exports||Kn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function OV(n,e){if(n==null)return es;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=wp.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function FV(n){if(n==null)return es;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function vn(n){return Au(()=>{let e=sA(n);return aA(e),e})}function Dl(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function sA(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||es,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Kn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:OV(n.inputs,e),outputs:FV(n.outputs),debugInfo:null}}function aA(n){n.features?.forEach(e=>e(n))}function NT(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function LV(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function VV(n){return Object.getPrototypeOf(n.prototype).constructor}function kr(n){let e=VV(n.type),t=!0,i=[n];for(;e;){let r;if(Cr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new me(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=zv(n.inputs),s.declaredInputs=zv(n.declaredInputs),s.outputs=zv(n.outputs);let a=r.hostBindings;a&&GV(n,a);let l=r.viewQuery,c=r.contentQueries;if(l&&jV(n,l),c&&HV(n,c),UV(n,r),wI(n.outputs,r.outputs),Cr(r)&&r.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===kr&&(t=!1)}}e=Object.getPrototypeOf(e)}BV(i)}function UV(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function BV(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=yl(r.hostAttrs,t=yl(t,r.hostAttrs))}}function zv(n){return n===es?{}:n===Kn?[]:n}function jV(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function HV(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function GV(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function lA(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=yl(n.mergedAttrs,n.attrs);let d=n.tView=$_(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),oa(n,!1);let l=cA(t,e,n,i);Of()&&Q_(t,e,l,n),vl(l,e);let c=kD(l,e,l,n);e[i+ut]=c,W_(e,c),EV(c,n,e)}function $V(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,f;return e.firstCreatePass?(f=Tl(e,h,4,s||null,a||null),yv()&&$D(e,n,f,ki(e.consts,c),ED),XT(e,f)):f=e.data[h],lA(f,n,e,t,i,r,o,l),fu(f)&&X_(e,n,f),c!=null&&Tp(n,f,d),f}function up(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,f;if(e.firstCreatePass){if(f=Tl(e,h,4,s||null,a||null),c!=null){let m=ki(e.consts,c);f.localNames=[];for(let w=0;w<m.length;w+=2)f.localNames.push(m[w],-1)}}else f=e.data[h];return lA(f,n,e,t,i,r,o,l),c!=null&&Tp(n,f,d),f}function Ut(n,e,t,i,r,o,s,a){let l=Be(),c=tn(),d=ki(c.consts,o);return $V(l,c,n,e,t,i,r,d,void 0,s,a),Ut}var cA=uA;function uA(n,e,t,i){return ao(!0),e[St].createComment("")}function zV(n,e,t,i){let r=!Ep(e,t);ao(r);let o=e[ni]?.data[wC]?.[i]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),r)return uA(n,e);let s=e[ni],a=Ap(s,n,e,t);_p(s,i,a);let l=V_(s,i);return Mp(l,a)}function dA(){cA=zV}var yi=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(yi||{}),PT=0,WV=1,dn=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(dn||{});var qV=0,Vu=1;var KV=4,YV=5;var QV=7,ml=8,JV=9,lE=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(lE||{});function Wf(n,e){let t=ZV(n),i=e[t];if(i!==null){for(let r of i)r();e[t]=null}}function XV(n){Wf(1,n),Wf(0,n),Wf(2,n)}function ZV(n){let e=KV;return n===1?e=YV:n===2&&(e=JV),e}function hA(n){return n+1}function Al(n,e){let t=n[ke],i=hA(e.index);return n[i]}function Uu(n,e){let t=hA(e.index);return n.data[t]}function e5(n,e,t){let i=e[ke],r=Uu(i,t);switch(n){case dn.Complete:return r.primaryTmplIndex;case dn.Loading:return r.loadingTmplIndex;case dn.Error:return r.errorTmplIndex;case dn.Placeholder:return r.placeholderTmplIndex;default:return null}}function OT(n,e){return e===dn.Placeholder?n.placeholderBlockConfig?.[PT]??null:e===dn.Loading?n.loadingBlockConfig?.[PT]??null:null}function t5(n){return n.loadingBlockConfig?.[WV]??null}function FT(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let i of e)t.add(i);return n.length===t.size?n:Array.from(t)}function n5(n,e){let t=e.primaryTmplIndex+ut;return ra(n,t)}var i5=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,i,r,o){if(!this.cachedInjectors.has(t)){let s=r.length>0?Cl(r,i,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=pe({token:n,providedIn:"environment",factory:()=>new n})}return n})();var fA=new we("");function Wv(n,e,t){return n.get(i5).getOrCreateInjector(e,n,t,"")}function r5(n,e,t){if(n instanceof gl){let r=n.injector,o=n.parentInjector,s=Wv(o,e,t);return new gl(r,s)}let i=n.get(Yt);if(i!==n){let r=Wv(i,e,t);return new gl(n,r)}return Wv(n,e,t)}function aa(n,e,t,i=!1){let r=t[Zt],o=r[ke];if(ns(r))return;let s=Al(r,e),a=s[Vu],l=s[QV];if(!(l!==null&&n<l)&&LT(a,n)&&LT(s[qV]??-1,n)){let c=Uu(o,e),h=!i&&!0&&(t5(c)!==null||OT(c,dn.Loading)!==null||OT(c,dn.Placeholder))?a5:s5;try{h(n,s,t,e,r)}catch(f){Z_(r,f)}}}function o5(n,e){let t=n[Yi]?.findIndex(r=>r.data[TC]===e[Vu])??-1;return{dehydratedView:t>-1?n[Yi][t]:null,dehydratedViewIx:t}}function s5(n,e,t,i,r){pt(at.DeferBlockStateStart);let o=e5(n,r,i);if(o!==null){e[Vu]=n;let s=r[ke],a=o+ut,l=ra(s,a),c=0;nE(t,c);let d;if(n===dn.Complete){let w=Uu(s,i),S=w.providers;S&&S.length>0&&(d=r5(r[di],w,S))}let{dehydratedView:h,dehydratedViewIx:f}=o5(t,e),m=Ou(r,l,null,{injector:d,dehydratedView:h});if(Fu(t,m,c,_l(l,h)),Cp(m,2),f>-1&&t[Yi]?.splice(f,1),(n===dn.Complete||n===dn.Error)&&Array.isArray(e[ml])){for(let w of e[ml])w();e[ml]=null}}pt(at.DeferBlockStateEnd)}function LT(n,e){return n<e}function VT(n,e,t){n.loadingPromise.then(()=>{n.loadingState===yi.COMPLETE?aa(dn.Complete,e,t):n.loadingState===yi.FAILED&&aa(dn.Error,e,t)})}var a5=null;var Fp=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var cE=new we("");function cs(n){return!!n&&typeof n.then=="function"}function uE(n){return!!n&&typeof n.subscribe=="function"}var pA=new we("");var dE=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=K(pA,{optional:!0})??[];injector=K(Yn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Fn(this.injector,r);if(cs(o))t.push(o);else if(uE(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),us=new we("");function gA(){hy(()=>{let n="";throw new me(600,n)})}function mA(n){return n.isBoundToModule}var l5=10;var ri=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=K(mi);afterRenderManager=K(K_);zonelessEnabled=K(vu);rootEffectScheduler=K(Vv);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Ht;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=K(Dr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(vt(t=>!t))}constructor(){K(as,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=K(Yt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Yn.NULL){return this._injector.get(yn).run(()=>{pt(at.BootstrapComponentStart);let s=t instanceof Np;if(!this._injector.get(dE).done){let w="";throw new me(405,w)}let l;s?l=t:l=this._injector.get(Lu).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let c=mA(l)?void 0:this._injector.get(ha),d=i||l.selector,h=l.create(r,[],d,c),f=h.location.nativeElement,m=h.injector.get(cE,null);return m?.registerApplication(f),h.onDestroy(()=>{this.detachView(h.hostView),wu(this.components,h),m?.unregisterApplication(f)}),this._loadComponent(h),pt(at.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){pt(at.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(xp.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw pt(at.ChangeDetectionEnd),new me(101,!1);let t=Ue(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Ue(t),this.afterTick.next(),pt(at.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(da,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<l5;){pt(at.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{pt(at.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!mu(r))continue;let o=i&&!this.zonelessEnabled?0:1;DD(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>mu(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;wu(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(us,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>wu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new me(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function wu(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function hE(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}function yA(n,e,t){let i=e[di],r=e[ke];if(n.loadingState!==yi.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=Al(e,t),s=n5(r,n);n.loadingState=yi.IN_PROGRESS,Wf(1,o);let a=n.dependencyResolverFn,l=i.get(_u).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(c=>{let d=!1,h=[],f=[];for(let m of c)if(m.status==="fulfilled"){let w=m.value,S=ro(w)||bf(w);if(S)h.push(S);else{let k=Xy(w);k&&f.push(k)}}else{d=!0;break}if(d){if(n.loadingState=yi.FAILED,n.errorTmplIndex===null){let w=new me(-750,!1);Z_(e,w)}}else{n.loadingState=yi.COMPLETE;let m=s.tView;if(h.length>0){m.directiveRegistry=FT(m.directiveRegistry,h);let w=h.map(k=>k.type),S=Cf(!1,...w);n.providers=S}f.length>0&&(m.pipeRegistry=FT(m.pipeRegistry,f))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,l()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=yi.COMPLETE,l()}),n.loadingPromise)}function c5(n,e){return e[di].get(fA,null,{optional:!0})?.behavior!==lE.Manual}function u5(n,e,t){let i=e[ke],r=e[t.index];if(!c5(n,e))return;let o=Al(e,t),s=Uu(i,t);switch(XV(o),s.loadingState){case yi.NOT_STARTED:aa(dn.Loading,t,r),yA(s,e,t),s.loadingState===yi.IN_PROGRESS&&VT(s,t,r);break;case yi.IN_PROGRESS:aa(dn.Loading,t,r),VT(s,t,r);break;case yi.COMPLETE:aa(dn.Complete,t,r);break;case yi.FAILED:aa(dn.Error,t,r);break;default:}}async function vA(n,e,t){let i=n.get(yp);if(i.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=cF(e,n);if(s.length===0)return;o!==null&&s.shift(),f5(i,s),o!==null&&await o;let a=s[0];i.has(a)?await UT(n,s,t):i.awaitParentBlock(a,async()=>await UT(n,s,t))}async function UT(n,e,t){let i=n.get(yp),r=i.hydrating,o=n.get(Dr),s=o.add();for(let l=0;l<e.length;l++){let c=e[l],d=i.get(c);if(d!=null){if(await g5(d),await p5(n),d5(d)){GL(d),BT(e.slice(l),i);break}r.get(c).resolve()}else{h5(l,e,i),BT(e.slice(l),i);break}}let a=e[e.length-1];await r.get(a)?.promise,o.remove(s),t&&t(e),$L(i.get(a),e,i,n.get(ri))}function d5(n){return Al(n.lView,n.tNode)[Vu]===dn.Error}function h5(n,e,t){let i=n-1,r=i>-1?t.get(e[i]):null;r&&kp(r.lContainer)}function BT(n,e){let t=e.hydrating;for(let i in n)t.get(i)?.reject();e.cleanup(n)}function f5(n,e){for(let t of e)n.hydrating.set(t,hE())}function p5(n){return new Promise(e=>Pu(e,{injector:n}))}async function g5(n){let{tNode:e,lView:t}=n,i=Al(t,e);return new Promise(r=>{m5(i,r),u5(2,t,e)})}function m5(n,e){Array.isArray(n[ml])||(n[ml]=[]),n[ml].push(e)}function Bt(n,e,t,i){let r=Be(),o=sa();if(Pi(r,o,e)){let s=tn(),a=Mv();dL(a,r,n,e,t,i)}return Bt}var nne=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var v_=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function qv(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function y5(n,e,t,i){let r,o,s=0,a=n.length-1,l=void 0;if(Array.isArray(e)){Ue(i);let c=e.length-1;for(Ue(null);s<=a&&s<=c;){let d=n.at(s),h=e[s],f=qv(s,d,s,h,t);if(f!==0){f<0&&n.updateValue(s,h),s++;continue}let m=n.at(a),w=e[c],S=qv(a,m,c,w,t);if(S!==0){S<0&&n.updateValue(a,w),a--,c--;continue}let k=t(s,d),V=t(a,m),q=t(s,h);if(Object.is(q,V)){let ye=t(c,w);Object.is(ye,k)?(n.swap(s,a),n.updateValue(a,w),c--,a--):n.move(a,s),n.updateValue(s,h),s++;continue}if(r??=new dp,o??=HT(n,s,a,t),__(n,r,s,q))n.updateValue(s,h),s++,a++;else if(o.has(q))r.set(k,n.detach(s)),a--;else{let ye=n.create(s,e[s]);n.attach(s,ye),s++,a++}}for(;s<=c;)jT(n,r,t,s,e[s]),s++}else if(e!=null){Ue(i);let c=e[Symbol.iterator]();Ue(null);let d=c.next();for(;!d.done&&s<=a;){let h=n.at(s),f=d.value,m=qv(s,h,s,f,t);if(m!==0)m<0&&n.updateValue(s,f),s++,d=c.next();else{r??=new dp,o??=HT(n,s,a,t);let w=t(s,f);if(__(n,r,s,w))n.updateValue(s,f),s++,a++,d=c.next();else if(!o.has(w))n.attach(s,n.create(s,f)),s++,a++,d=c.next();else{let S=t(s,h);r.set(S,n.detach(s)),a--}}}for(;!d.done;)jT(n,r,t,n.length,d.value),d=c.next()}for(;s<=a;)n.destroy(n.detach(a--));r?.forEach(c=>{n.destroy(c)})}function __(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function jT(n,e,t,i,r){if(__(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function HT(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var dp=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function Y(n,e,t,i,r,o,s,a){vi("NgControlFlow");let l=Be(),c=tn(),d=ki(c.consts,o);return up(l,c,n,e,t,i,r,d,256,s,a),fE}function fE(n,e,t,i,r,o,s,a){vi("NgControlFlow");let l=Be(),c=tn(),d=ki(c.consts,o);return up(l,c,n,e,t,i,r,d,512,s,a),fE}function Q(n,e){vi("NgControlFlow");let t=Be(),i=sa(),r=t[i]!==In?t[i]:-1,o=r!==-1?hp(t,ut+r):void 0,s=0;if(Pi(t,i,n)){let a=Ue(null);try{if(o!==void 0&&nE(o,s),n!==-1){let l=ut+n,c=hp(t,l),d=x_(t[ke],l),h=BD(c,d,t),f=Ou(t,d,e,{dehydratedView:h});Fu(c,f,s,_l(d,h))}}finally{Ue(a)}}else if(o!==void 0){let a=ND(o,s);a!==void 0&&(a[en]=e)}}var E_=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-zt}};function Bu(n){return n}function Nr(n,e){return e}var b_=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function _n(n,e,t,i,r,o,s,a,l,c,d,h,f){vi("NgControlFlow");let m=Be(),w=tn(),S=l!==void 0,k=Be(),V=a?s.bind(k[Jn][en]):s,q=new b_(S,V);k[ut+n]=q,up(m,w,n+1,e,t,i,r,ki(w.consts,o),256),S&&up(m,w,n+2,l,c,d,h,ki(w.consts,f),512)}var w_=class extends v_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-zt}at(e){return this.getLView(e)[en].$implicit}attach(e,t){let i=t[ni];this.needsIndexUpdate||=e!==this.length,Fu(this.lContainer,t,e,_l(this.templateTNode,i)),v5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,_5(this.lContainer,e),E5(this.lContainer,e)}create(e,t){let i=rp(this.lContainer,this.templateTNode.tView.ssrId);return Ou(this.hostLView,this.templateTNode,new E_(this.lContainer,t,e),{dehydratedView:i})}destroy(e){Sp(e[ke],e)}updateValue(e,t){this.getLView(e)[en].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[en].$index=e}getLView(e){return b5(this.lContainer,e)}};function En(n){let e=Ue(null),t=Ni();try{let i=Be(),r=i[ke],o=i[t],s=t+1,a=hp(i,s);if(o.liveCollection===void 0){let c=x_(r,s);o.liveCollection=new w_(a,i,c)}else o.liveCollection.reset();let l=o.liveCollection;if(y5(l,n,o.trackByFn,e),l.updateIndexes(),o.hasEmptyBlock){let c=sa(),d=l.length===0;if(Pi(i,c,d)){let h=t+2,f=hp(i,h);if(d){let m=x_(r,h),w=BD(f,m,i),S=Ou(i,m,void 0,{dehydratedView:w});Fu(f,S,0,_l(m,w))}else r.firstUpdatePass&&Rp(f),nE(f,0)}}}finally{Ue(e)}}function hp(n,e){return n[e]}function v5(n,e){if(n.length<=zt)return;let t=zt+e,i=n[t],r=i?i[ta]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[di];UF(o,r),ua.delete(i[oo]),r.detachedLeaveAnimationFns=void 0}}function _5(n,e){if(n.length<=zt)return;let t=zt+e,i=n[t],r=i?i[ta]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function E5(n,e){return Tu(n,e)}function b5(n,e){return ND(n,e)}function x_(n,e){return ra(n,e)}function Se(n,e,t){let i=Be(),r=sa();if(Pi(i,r,e)){let o=tn(),s=Mv();oL(s,i,n,e,i[St],t)}return Se}function S_(n,e,t,i,r){eE(e,n,t,r?"class":"style",i)}function y(n,e,t,i){let r=Be(),o=r[ke],s=n+ut,a=o.firstCreatePass?WD(s,r,2,e,ED,yv(),t,i):o.data[s];if(bD(a,r,n,e,pE),fu(a)){let l=r[ke];X_(l,r,a),QC(l,a,r)}return i!=null&&Tp(r,a),y}function _(){let n=tn(),e=Un(),t=wD(e);return n.firstCreatePass&&qD(n,t),_v(t)&&Ev(),mv(),t.classesWithoutHost!=null&&R3(t)&&S_(n,t,Be(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&k3(t)&&S_(n,t,Be(),t.stylesWithoutHost,!1),_}function W(n,e,t,i){return y(n,e,t,i),_(),W}function D(n,e,t,i){let r=Be(),o=r[ke],s=n+ut,a=o.firstCreatePass?oV(s,o,2,e,t,i):o.data[s];return bD(a,r,n,e,pE),i!=null&&Tp(r,a),D}function A(){let n=Un(),e=wD(n);return _v(e)&&Ev(),mv(),A}function G(n,e,t,i){return D(n,e,t,i),A(),G}var pE=(n,e,t,i,r)=>(ao(!0),B_(e[St],i,Rv()));function w5(n,e,t,i,r){let o=!Ep(e,t);if(ao(o),o)return B_(e[St],i,Rv());let s=e[ni],a=Ap(s,n,e,t);return WC(s,r)&&_p(s,r,a.nextSibling),s&&(dC(t)||hC(a))&&so(t)&&(zI(t),tD(a)),a}function _A(){pE=w5}var x5=(n,e,t,i,r)=>(ao(!0),ZC(e[St],""));function S5(n,e,t,i,r){let o,s=!Ep(e,t);if(ao(s),s)return ZC(e[St],"");let a=e[ni],l=Ap(a,n,e,t),c=aF(a,r);return _p(a,r,l),o=Mp(c,l),o}function EA(){x5=S5}function je(){return Be()}var Eu=void 0;function I5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var T5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Eu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Eu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",Eu,Eu,Eu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",I5],Kv={};function _i(n){let e=C5(n),t=GT(e);if(t)return t;let i=e.split("-")[0];if(t=GT(i),t)return t;if(i==="en")return T5;throw new me(701,!1)}function GT(n){return n in Kv||(Kv[n]=Er.ng&&Er.ng.common&&Er.ng.common.locales&&Er.ng.common.locales[n]),Kv[n]}var nn=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(nn||{});function C5(n){return n.toLowerCase().replace(/_/g,"-")}var ju="en-US";var D5=ju;function bA(n){typeof n=="string"&&(D5=n.toLowerCase().replace(/_/g,"-"))}function X(n,e,t){let i=Be(),r=tn(),o=Un();return A5(r,i,i[St],o,n,e,t),X}function Gt(n,e,t){let i=Be(),r=tn(),o=Un();return(o.type&3||t)&&JD(o,r,i,t,i[St],n,e,zf(o,i,e)),Gt}function A5(n,e,t,i,r,o,s){let a=!0,l=null;if((i.type&3||s)&&(l??=zf(i,e,o),JD(i,n,e,s,t,r,o,l)&&(a=!1)),a){let c=i.outputs?.[r],d=i.hostDirectiveOutputs?.[r];if(d&&d.length)for(let h=0;h<d.length;h+=2){let f=d[h],m=d[h+1];l??=zf(i,e,o),MT(i,e,f,m,r,l)}if(c&&c.length)for(let h of c)l??=zf(i,e,o),MT(i,e,h,r,r,l)}}function N(n=1){return nT(n)}function Ml(n,e,t){return AV(n,e,t),Ml}function Rl(n){let e=Be(),t=tn(),i=Cv();kf(i+1);let r=aE(t,i);if(n.dirty&&VI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=kV(e,i);n.reset(o,z3),n.notifyOnChanges()}return!0}return!1}function kl(){return CV(Be(),Cv())}function tr(n){let e=xv();return pu(e,ut+n)}function Uf(n,e){return n<<17|e<<2}function fa(n){return n>>17&32767}function M5(n){return(n&2)==2}function R5(n,e){return n&131071|e<<17}function I_(n){return n|2}function bl(n){return(n&131068)>>2}function Yv(n,e){return n&-131069|e<<2}function k5(n){return(n&1)===1}function T_(n){return n|1}function N5(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=fa(s),l=bl(s);n[i]=t;let c=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||ll(h,d)>0)&&(c=!0)}else d=t;if(r)if(l!==0){let f=fa(n[a+1]);n[i+1]=Uf(f,a),f!==0&&(n[f+1]=Yv(n[f+1],i)),n[a+1]=R5(n[a+1],i)}else n[i+1]=Uf(a,0),a!==0&&(n[a+1]=Yv(n[a+1],i)),a=i;else n[i+1]=Uf(l,0),a===0?a=i:n[l+1]=Yv(n[l+1],i),l=i;c&&(n[i+1]=I_(n[i+1])),$T(n,d,i,!0),$T(n,d,i,!1),P5(e,d,n,i,o),s=Uf(a,l),o?e.classBindings=s:e.styleBindings=s}function P5(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&ll(o,e)>=0&&(t[i+1]=T_(t[i+1]))}function $T(n,e,t,i){let r=n[t+1],o=e===null,s=i?fa(r):bl(r),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];O5(l,e)&&(a=!0,n[s+1]=i?T_(c):I_(c)),s=i?fa(c):bl(c)}a&&(n[t+1]=i?I_(r):T_(r))}function O5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?ll(n,e)>=0:!1}var Ji={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function F5(n){return n.substring(Ji.key,Ji.keyEnd)}function L5(n){return V5(n),wA(n,xA(n,0,Ji.textEnd))}function wA(n,e){let t=Ji.textEnd;return t===e?-1:(e=Ji.keyEnd=U5(n,Ji.key=e,t),xA(n,e,t))}function V5(n){Ji.key=0,Ji.keyEnd=0,Ji.value=0,Ji.valueEnd=0,Ji.textEnd=n.length}function xA(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function U5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function Je(n,e,t){return SA(n,e,t,!1),Je}function Te(n,e){return SA(n,e,null,!0),Te}function gE(n){j5(q5,B5,n,!0)}function B5(n,e){for(let t=L5(e);t>=0;t=wA(e,t))If(n,F5(e),!0)}function SA(n,e,t,i){let r=Be(),o=tn(),s=yu(2);if(o.firstUpdatePass&&TA(o,n,s,i),e!==In&&Pi(r,s,e)){let a=o.data[Ni()];CA(o,a,r,r[St],n,r[s+1]=Y5(e,t),i,s)}}function j5(n,e,t,i){let r=tn(),o=yu(2);r.firstUpdatePass&&TA(r,null,o,i);let s=Be();if(t!==In&&Pi(s,o,t)){let a=r.data[Ni()];if(DA(a,i)&&!IA(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=_f(l,t||"")),S_(r,a,s,t,i)}else K5(r,a,s,s[St],s[o+1],s[o+1]=W5(n,e,t),i,o)}}function IA(n,e){return e>=n.expandoStartIndex}function TA(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Ni()],s=IA(n,t);DA(o,i)&&e===null&&!s&&(e=!1),e=H5(r,o,e,i),N5(r,o,e,t,s,i)}}function H5(n,e,t,i){let r=XI(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Qv(null,n,e,t,i),t=Du(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Qv(r,n,e,t,i),o===null){let l=G5(n,e,i);l!==void 0&&Array.isArray(l)&&(l=Qv(null,n,e,l[1],i),l=Du(l,e.attrs,i),$5(n,e,i,l))}else o=z5(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function G5(n,e,t){let i=t?e.classBindings:e.styleBindings;if(bl(i)!==0)return n[fa(i)]}function $5(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[fa(r)]=i}function z5(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=Du(i,s,t)}return Du(i,e.attrs,t)}function Qv(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=Du(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function Du(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),If(n,s,t?!0:e[++o]))}return n===void 0?null:n}function W5(n,e,t){if(t==null||t==="")return Kn;let i=[],r=Il(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(r instanceof Set)for(let o of r)n(i,o,!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function q5(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&If(n,i,t)}function K5(n,e,t,i,r,o,s,a){r===In&&(r=Kn);let l=0,c=0,d=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;d!==null||h!==null;){let f=l<r.length?r[l+1]:void 0,m=c<o.length?o[c+1]:void 0,w=null,S;d===h?(l+=2,c+=2,f!==m&&(w=h,S=m)):h===null||d!==null&&d<h?(l+=2,w=d):(c+=2,w=h,S=m),w!==null&&CA(n,e,t,i,w,S,s,a),d=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}function CA(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],d=k5(c)?zT(l,e,t,r,bl(c),s):void 0;if(!fp(d)){fp(o)||M5(c)&&(o=zT(l,null,t,r,a,s));let h=uv(Ni(),t);eL(i,s,h,r,o)}}function zT(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let l=n[r],c=Array.isArray(l),d=c?l[1]:l,h=d===null,f=t[r+1];f===In&&(f=h?Kn:void 0);let m=h?Tf(f,i):d===i?f:void 0;if(c&&!fp(m)&&(m=Tf(l,i)),fp(m)&&(a=m,s))return a;let w=n[r+1];r=s?fa(w):bl(w)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=Tf(l,i))}return a}function fp(n){return n!==void 0}function Y5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=no(Il(n)))),n}function DA(n,e){return(n.flags&(e?8:16))!==0}function v(n,e=""){let t=Be(),i=tn(),r=n+ut,o=i.firstCreatePass?Tl(i,r,1,e,null):i.data[r],s=AA(i,t,o,e,n);t[r]=s,Of()&&Q_(i,t,s,o),oa(o,!1)}var AA=(n,e,t,i,r)=>(ao(!0),XC(e[St],i));function Q5(n,e,t,i,r){let o=!Ep(e,t);if(ao(o),o)return XC(e[St],i);let s=e[ni];return Ap(s,n,e,t)}function MA(){AA=Q5}function J5(n,e,t,i=""){return Pi(n,sa(),t)?e+Ki(t)+i:In}function X5(n,e,t,i,r,o=""){let s=Tv(),a=oE(n,s,t,r);return yu(2),a?e+Ki(t)+i+Ki(r)+o:In}function Z5(n,e,t,i,r,o,s,a=""){let l=Tv(),c=QD(n,l,t,r,s);return yu(3),c?e+Ki(t)+i+Ki(r)+o+Ki(s)+a:In}function j(n){return L("",n),j}function L(n,e,t){let i=Be(),r=J5(i,n,e,t);return r!==In&&mE(i,Ni(),r),L}function Rt(n,e,t,i,r){let o=Be(),s=X5(o,n,e,t,i,r);return s!==In&&mE(o,Ni(),s),Rt}function ds(n,e,t,i,r,o,s){let a=Be(),l=Z5(a,n,e,t,i,r,o,s);return l!==In&&mE(a,Ni(),l),ds}function mE(n,e,t){let i=uv(e,n);mF(n[St],i,t)}var RA={};function ga(n){vi("NgLet");let e=tn(),t=Be(),i=n+ut,r=Tl(e,i,128,null,null);return oa(r,!1),gu(e,t,i,RA),ga}function Nl(n){let e=tn(),t=Be(),i=Ni();return gu(e,t,i,n),n}function nr(n){let e=xv(),t=pu(e,ut+n);if(t===RA)throw new me(314,!1);return t}function yE(n){return Pi(Be(),sa(),n)?Ki(n):In}function WT(n,e,t){let i=tn();i.firstCreatePass&&kA(e,i.data,i.blueprint,Cr(n),t)}function kA(n,e,t,i,r){if(n=On(n),Array.isArray(n))for(let o=0;o<n.length;o++)kA(n[o],e,t,i,r);else{let o=tn(),s=Be(),a=Un(),l=Ys(n)?n:On(n.provide),c=ov(n),d=a.providerIndexes&1048575,h=a.directiveStart,f=a.providerIndexes>>20;if(Ys(n)||!n.multi){let m=new ca(c,r,he,null),w=Xv(l,e,r?d:d+f,h);w===-1?(e_(Jf(a,s),o,l),Jv(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),s.push(m)):(t[w]=m,s[w]=m)}else{let m=Xv(l,e,d+f,h),w=Xv(l,e,d,d+f),S=m>=0&&t[m],k=w>=0&&t[w];if(r&&!k||!r&&!S){e_(Jf(a,s),o,l);let V=n6(r?t6:e6,t.length,r,i,c,n);!r&&k&&(t[w].providerFactory=V),Jv(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(V),s.push(V)}else{let V=NA(t[r?w:m],c,!r&&i);Jv(o,n,m>-1?m:w,V)}!r&&i&&k&&t[w].componentProviders++}}}function Jv(n,e,t,i){let r=Ys(e),o=PI(e);if(r||o){let l=(o?On(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function NA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Xv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function e6(n,e,t,i,r){return C_(this.multi,[])}function t6(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=xu(i,i[ke],this.providerFactory.index,r);s=l.slice(0,a),C_(o,s);for(let c=a;c<l.length;c++)s.push(l[c])}else s=[],C_(o,s);return s}function C_(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function n6(n,e,t,i,r,o){let s=new ca(n,t,he,null);return s.multi=[],s.index=e,s.componentProviders=0,NA(s,r,i&&!t),s}function Hu(n,e){return t=>{t.providersResolver=(i,r)=>WT(i,r?r(n):n,!1),e&&(t.viewProvidersResolver=(i,r)=>WT(i,r?r(e):e,!0))}}function ma(n,e){let t=hl()+n,i=Be();return i[t]===In?Pp(i,t,e()):sV(i,t)}function Et(n,e,t,i){return PA(Be(),hl(),n,e,t,i)}function vE(n,e,t,i,r){return r6(Be(),hl(),n,e,t,i,r)}function _E(n,e){let t=n[e];return t===In?void 0:t}function i6(n,e,t,i,r,o){let s=e+t;return Pi(n,s,r)?Pp(n,s+1,o?i.call(o,r):i(r)):_E(n,s+1)}function PA(n,e,t,i,r,o,s){let a=e+t;return oE(n,a,r,o)?Pp(n,a+2,s?i.call(s,r,o):i(r,o)):_E(n,a+2)}function r6(n,e,t,i,r,o,s,a){let l=e+t;return QD(n,l,r,o,s)?Pp(n,l+3,a?i.call(a,r,o,s):i(r,o,s)):_E(n,l+3)}function Xn(n,e){let t=tn(),i,r=n+ut;t.firstCreatePass?(i=o6(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Qo(i.type,!0)),s,a=qn(he);try{let l=Qf(!1),c=o();return Qf(l),gu(t,Be(),r,c),c}finally{qn(a)}}function o6(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function Pl(n,e,t){let i=n+ut,r=Be(),o=pu(r,i);return OA(r,i)?i6(r,hl(),e,o.transform,t,o):o.transform(t)}function ir(n,e,t,i){let r=n+ut,o=Be(),s=pu(o,r);return OA(o,r)?PA(o,hl(),e,s.transform,t,i,s):s.transform(t,i)}function OA(n,e){return n[ke].data[e].pure}function ho(n,e){return Dp(n,e)}var pp=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},EE=(()=>{class n{compileModuleSync(t){return new cp(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=Jy(t),o=sD(r.declarations).reduce((s,a)=>{let l=ro(a);return l&&s.push(new El(l)),s},[]);return new pp(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var FA=(()=>{class n{applicationErrorHandler=K(mi);appRef=K(ri);taskService=K(Dr);ngZone=K(yn);zonelessEnabled=K(vu);tracing=K(as,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new mn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(ou):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(K(Lv,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?sT:Nv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(ou+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.applicationErrorHandler(i)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function LA(){return[{provide:Xo,useExisting:FA},{provide:yn,useClass:su},{provide:vu,useValue:!0}]}function s6(){return typeof $localize<"u"&&$localize.locale||ju}var Gu=new we("",{factory:()=>K(Gu,{optional:!0,skipSelf:!0})||s6()});function Bn(n,e){return Lh(n,e?.equal)}var IE={JSACTION:"__jsaction",OWNER:"__owner"},jA={};function a6(n){return n[IE.JSACTION]}function VA(n,e){n[IE.JSACTION]=e}function l6(n){return jA[n]}function c6(n,e){jA[n]=e}var Fe={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},u6=[Fe.MOUSEENTER,Fe.MOUSELEAVE,"pointerenter","pointerleave"],lne=[Fe.CLICK,Fe.DBLCLICK,Fe.FOCUSIN,Fe.FOCUSOUT,Fe.KEYDOWN,Fe.KEYUP,Fe.KEYPRESS,Fe.MOUSEOVER,Fe.MOUSEOUT,Fe.SUBMIT,Fe.TOUCHSTART,Fe.TOUCHEND,Fe.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],d6=[Fe.FOCUS,Fe.BLUR,Fe.ERROR,Fe.LOAD,Fe.TOGGLE],TE=n=>d6.indexOf(n)>=0;function h6(n){return n===Fe.MOUSEENTER?Fe.MOUSEOVER:n===Fe.MOUSELEAVE?Fe.MOUSEOUT:n===Fe.POINTERENTER?Fe.POINTEROVER:n===Fe.POINTERLEAVE?Fe.POINTEROUT:n}function f6(n,e,t,i){let r=!1;TE(e)&&(r=!0);let o=typeof i=="boolean"?{capture:r,passive:i}:r;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:r,passive:i}}function p6(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function g6(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var UA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function m6(n){return n.which===2||n.which==null&&n.button===4}function y6(n){return UA&&n.metaKey||!UA&&n.ctrlKey||m6(n)||n.shiftKey}function v6(n,e,t){let i=n.relatedTarget;return(n.type===Fe.MOUSEOVER&&e===Fe.MOUSEENTER||n.type===Fe.MOUSEOUT&&e===Fe.MOUSELEAVE||n.type===Fe.POINTEROVER&&e===Fe.POINTERENTER||n.type===Fe.POINTEROUT&&e===Fe.POINTERLEAVE)&&(!i||i!==t&&!t.contains(i))}function _6(n,e){let t={};for(let i in n){if(i==="srcElement"||i==="target")continue;let r=i,o=n[r];typeof o!="function"&&(t[r]=o)}return n.type===Fe.MOUSEOVER?t.type=Fe.MOUSEENTER:n.type===Fe.MOUSEOUT?t.type=Fe.MOUSELEAVE:n.type===Fe.POINTEROVER?t.type=Fe.POINTERENTER:t.type=Fe.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var E6=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),Bp=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,i){E6&&(this.element.style.cursor="pointer"),this.handlerInfos.push(f6(this.element,e,t(this.element),i))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)p6(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},b6={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function hs(n){return n.eventType}function CE(n,e){n.eventType=e}function Vp(n){return n.event}function HA(n,e){n.event=e}function GA(n){return n.targetElement}function $A(n,e){n.targetElement=e}function zA(n){return n.eic}function w6(n,e){n.eic=e}function x6(n){return n.timeStamp}function S6(n,e){n.timeStamp=e}function Up(n){return n.eia}function WA(n,e,t){n.eia=[e,t]}function bE(n){n.eia=void 0}function Lp(n){return n[1]}function I6(n){return n.eirp}function qA(n,e){n.eirp=e}function KA(n){return n.eir}function YA(n,e){n.eir=e}function QA(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function T6(n,e,t,i,r,o,s,a){return{eventType:n,event:e,targetElement:t,eic:i,timeStamp:r,eia:o,eirp:s,eiack:a}}var wE=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return hs(this.eventInfo)}setEventType(e){CE(this.eventInfo,e)}getEvent(){return Vp(this.eventInfo)}setEvent(e){HA(this.eventInfo,e)}getTargetElement(){return GA(this.eventInfo)}setTargetElement(e){$A(this.eventInfo,e)}getContainer(){return zA(this.eventInfo)}setContainer(e){w6(this.eventInfo,e)}getTimestamp(){return x6(this.eventInfo)}setTimestamp(e){S6(this.eventInfo,e)}getAction(){let e=Up(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){bE(this.eventInfo);return}WA(this.eventInfo,e.name,e.element)}getIsReplay(){return I6(this.eventInfo)}setIsReplay(e){qA(this.eventInfo,e)}getResolved(){return KA(this.eventInfo)}setResolved(e){YA(this.eventInfo,e)}clone(){return new n(QA(this.eventInfo))}},C6={},D6=/\s*;\s*/,A6=Fe.CLICK,xE=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&hs(e)===Fe.CLICK&&y6(Vp(e))?CE(e,Fe.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){KA(e)||(this.populateAction(e,GA(e)),YA(e,!0))}resolveParentAction(e){let t=Up(e),i=t&&Lp(t);bE(e);let r=i&&this.getParentNode(i);r&&this.populateAction(e,r)}populateAction(e,t){let i=t;for(;i&&i!==zA(e)&&(i.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(i,e),!Up(e));)i=this.getParentNode(i);let r=Up(e);if(r&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(hs(e)===Fe.MOUSEENTER||hs(e)===Fe.MOUSELEAVE||hs(e)===Fe.POINTERENTER||hs(e)===Fe.POINTERLEAVE)))if(v6(Vp(e),hs(e),Lp(r))){let o=_6(Vp(e),Lp(r));HA(e,o),$A(e,Lp(r))}else bE(e)}getParentNode(e){let t=e[IE.OWNER];if(t)return t;let i=e.parentNode;return i?.nodeName==="#document-fragment"?i?.host??null:i}populateActionOnElement(e,t){let i=this.parseActions(e),r=i[hs(t)];r!==void 0&&WA(t,r,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,i)}parseActions(e){let t=a6(e);if(!t){let i=e.getAttribute(Lf.JSACTION);if(!i)t=C6,VA(e,t);else{if(t=l6(i),!t){t={};let r=i.split(D6);for(let o=0;o<r.length;o++){let s=r[o];if(!s)continue;let a=s.indexOf(b6.EVENT_ACTION_SEPARATOR),l=a!==-1,c=l?s.substr(0,a).trim():A6,d=l?s.substr(a+1).trim():s;t[c]=d}c6(i,t)}VA(e,t)}}return t}addA11yClickSupport(e,t,i){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=i}},JA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(JA||{}),SE=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:i}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=i}dispatch(e){let t=new wE(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let i=t.getAction();if(i&&M6(i.element,t)&&g6(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function M6(n,e){return n.tagName==="A"&&(e.getEventType()===Fe.CLICK||e.getEventType()===Fe.CLICKMOD)}var XA=Symbol.for("propagationStopped"),DE={REPLAY:101};var R6="`preventDefault` called during event replay.";var k6="`composedPath` called during event replay.",jp=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new xE({clickModSupport:t}),this.dispatcher=new SE(i=>{this.dispatchToDelegate(i)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&O6(e),N6(e);e.getAction();){if(F6(e),TE(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),P6(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function N6(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),i=()=>{e[XA]=!0,t()};ya(e,"stopPropagation",i),ya(e,"stopImmediatePropagation",i)}function P6(n){return!!n.getEvent()[XA]}function O6(n){let e=n.getEvent(),t=n.getTargetElement(),i=e.preventDefault.bind(e);ya(e,"target",t),ya(e,"eventPhase",DE.REPLAY),ya(e,"preventDefault",()=>{throw i(),new Error(R6+"")}),ya(e,"composedPath",()=>{throw new Error(k6+"")})}function F6(n){let e=n.getEvent(),t=n.getAction()?.element;t&&ya(e,"currentTarget",t,{configurable:!0})}function ya(n,e,t,{configurable:i=!1}={}){Object.defineProperty(n,e,{value:t,configurable:i})}function ZA(n,e){n.ecrd(t=>{e.dispatch(t)},JA.I_AM_THE_JSACTION_FRAMEWORK)}function L6(n){return n?.q??[]}function V6(n){n&&(BA(n.c,n.et,n.h),BA(n.c,n.etc,n.h,!0))}function BA(n,e,t,i){for(let r=0;r<e.length;r++)n.removeEventListener(e[r],t,i)}var U6=!1,eM=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=U6;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,i,r){let o=T6(t,i,i.target,r,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){qA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,i,r){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&u6.indexOf(t)>=0)return;let o=(a,l,c)=>{this.handleEvent(a,l,c)};this.eventHandlers[t]=o;let s=h6(i||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>l=>{o(t,l,a)},r)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),V6(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let i=0;i<t.length;i++){let r=t[i],o=this.getEventTypesForBrowserEventType(r.eventType);for(let s=0;s<o.length;s++){let a=QA(r);CE(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let i=[];return this.eventHandlers[t]&&i.push(t),this.browserEventTypeToExtraEventTypes[t]&&i.push(...this.browserEventTypeToExtraEventTypes[t]),i}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,i){this.ecrd(t,i)}ecrd(t,i){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let r=0;r<this.queuedEventInfos.length;r++)this.handleEventInfo(this.queuedEventInfos[r]);this.queuedEventInfos=null}}}return n})();function tM(n,e=window){return L6(e._ejsas?.[n])}function AE(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var dM=Symbol("InputSignalNode#UNSET"),fU=ce(F({},Vh),{transformFn:void 0,applyValueToInputSignal(n,e){Yc(n,e)}});function hM(n,e){let t=Object.create(fU);t.value=n,t.transformFn=e?.transform;function i(){if(Wc(t),t.value===dM){let r=null;throw new me(-950,r)}return t.value}return i[ei]=t,i}var $p=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Mu(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function nM(n,e){return hM(n,e)}function pU(n){return hM(dM,n)}var fM=(nM.required=pU,nM);var ME=new we(""),gU=new we("");function $u(n){return!n.moduleRef}function mU(n){let e=$u(n)?n.r3Injector:n.moduleRef.injector,t=e.get(yn);return t.run(()=>{$u(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(mi),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),$u(n)){let o=()=>e.destroy(),s=n.platformInjector.get(ME);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(ME);s.add(o),n.moduleRef.onDestroy(()=>{wu(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return vU(i,t,()=>{let o=e.get(Dr),s=o.add(),a=e.get(dE);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(Gu,ju);if(bA(l||ju),!e.get(gU,!0))return $u(n)?e.get(ri):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if($u(n)){let d=e.get(ri);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return yU?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var yU;function vU(n,e,t){try{let i=t();return cs(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Gp=null;function _U(n=[],e){return Yn.create({name:e,providers:[{provide:cu,useValue:"platform"},{provide:ME,useValue:new Set([()=>Gp=null])},...n]})}function EU(n=[]){if(Gp)return Gp;let e=_U(n);return Gp=e,gA(),bU(e),e}function bU(n){let e=n.get(gp,null);Fn(n,()=>{e?.forEach(t=>t())})}function pM(){return!1}var Hp=new WeakSet,iM="";function rM(n){return n.get(P_,AC)}function gM(){let n=[{provide:P_,useFactory:()=>{let e=!0;{let t=K(Rr);e=!!window._ejsas?.[t]}return e&&vi("NgEventReplay"),e}}];return n.push({provide:wr,useValue:()=>{let e=K(ri),{injector:t}=e;if(!Hp.has(e)){let i=K(O_);if(rM(t)){VC();let r=t.get(Rr),o=FC(r,(s,a,l)=>{s.nodeType===Node.ELEMENT_NODE&&(kC(s,a,l),NC(s,i))});e.onDestroy(o)}}},multi:!0},{provide:us,useFactory:()=>{let e=K(ri),{injector:t}=e;return()=>{if(!rM(t)||Hp.has(e))return;Hp.add(e);let i=t.get(Rr);e.onDestroy(()=>{Hp.delete(e),AE(i)}),e.whenStable().then(()=>{if(e.destroyed)return;let r=t.get(OC);wU(r,t);let o=t.get(O_);o.get(iM)?.forEach(PC),o.delete(iM);let s=r.instance;zC(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var wU=(n,e)=>{let t=e.get(Rr),i=window._ejsas[t],r=n.instance=new eM(new Bp(i.c));for(let a of i.et)r.addEvent(a);for(let a of i.etc)r.addEvent(a);let o=tM(t);r.replayEarlyEventInfos(o),AE(t);let s=new jp(a=>{xU(e,a,a.currentTarget)});ZA(r,s)};function xU(n,e,t){let i=(t&&t.getAttribute(ku))??"";/d\d+/.test(i)?SU(i,n,e,t):e.eventPhase===DE.REPLAY&&F_(e,t)}function SU(n,e,t,i){let r=e.get(MC);r.push({event:t,currentTarget:i}),vA(e,n,IU(r))}function IU(n){return e=>{let t=new Set(e),i=[];for(let{event:r,currentTarget:o}of n){let s=o.getAttribute(ku);t.has(s)?F_(r,o):i.push({event:r,currentTarget:o})}n.length=0,n.push(...i)}}var oM=!1;var TU=1e4;function CU(){oM||(oM=!0,HC(),_A(),MA(),EA(),dA(),rA(),UD(),_D())}function DU(n){return n.whenStable()}function mM(){let n=[{provide:Ru,useFactory:()=>{let e=!0;return e=!!K(Sl,{optional:!0})?.get(L_,null),e&&vi("NgHydration"),e}},{provide:wr,useValue:()=>{OD(!1);let e=K(Qt);K(Ru)&&(KC(e),CU())},multi:!0}];return n.push({provide:N_,useFactory:()=>K(Ru)},{provide:us,useFactory:()=>{if(K(Ru)){let e=K(ri);return()=>{DU(e).then(()=>{e.destroyed||iE(e)})}}return()=>{}},multi:!0}),xr(n)}var zse=TU-1e3;var va=(()=>{class n{static __NG_ELEMENT_ID__=AU}return n})();function AU(n){return MU(Un(),Be(),(n&16)===16)}function MU(n,e,t){if(so(n)&&!t){let i=Ri(n.index,e);return new rs(i,i)}else if(n.type&175){let i=e[Jn];return new rs(i,e)}return null}var RE=class{constructor(){}supports(e){return rE(e)}create(e){return new kE(e)}},RU=(n,e)=>e,kE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||RU}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<sM(i,r,o)?t:i,a=sM(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let c=a-r,d=l-r;if(c!=d){for(let f=0;f<c;f++){let m=f<o.length?o[f]:o[f]=0,w=m+f;d<=w&&w<c&&(o[f]=m+1)}let h=s.previousIndex;o[h]=d-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!rE(e))throw new me(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,KD(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new NE(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new zp),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new zp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},NE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},PE=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},zp=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new PE,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function sM(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function aM(){return new OE([new RE])}var OE=(()=>{class n{factories;static \u0275prov=pe({token:n,providedIn:"root",factory:aM});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=K(n,{optional:!0,skipSelf:!0});return n.create(t,i||aM())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new me(901,!1)}}return n})();function yM(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;pt(at.BootstrapApplicationStart);try{let o=r?.injector??EU(i),s=[LA(),lT,...t||[]],a=new Cu({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return mU({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{pt(at.BootstrapApplicationEnd)}}function zu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var vM=null;function Fi(){return vM}function FE(n){vM??=n}var Wu=class{},Wp=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(_M),providedIn:"platform"})}return n})();var _M=(()=>{class n extends Wp{_location;_history;_doc=K(Qt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Fi().getBaseHref(this._doc)}onPopState(t){let i=Fi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Fi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function wM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function EM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function fs(n){return n&&n[0]!=="?"?`?${n}`:n}var Ol=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(NU),providedIn:"root"})}return n})(),kU=new we(""),NU=(()=>{class n extends Ol{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??K(Qt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return wM(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+fs(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+fs(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+fs(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Re(Wp),Re(kU,8))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Fl=(()=>{class n{_subject=new Ht;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=FU(EM(bM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+fs(i))}normalize(t){return n.stripTrailingSlash(OU(this._basePath,bM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fs(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fs(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=fs;static joinWithSlash=wM;static stripTrailingSlash=EM;static \u0275fac=function(i){return new(i||n)(Re(Ol))};static \u0275prov=pe({token:n,factory:()=>PU(),providedIn:"root"})}return n})();function PU(){return new Fl(Re(Ol))}function OU(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function bM(n){return n.replace(/\/index.html$/,"")}function FU(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var jn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(jn||{}),Ct=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(Ct||{}),oi=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(oi||{}),po={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function CM(n){return _i(n)[nn.LocaleId]}function DM(n,e,t){let i=_i(n),r=[i[nn.DayPeriodsFormat],i[nn.DayPeriodsStandalone]],o=Li(r,e);return Li(o,t)}function AM(n,e,t){let i=_i(n),r=[i[nn.DaysFormat],i[nn.DaysStandalone]],o=Li(r,e);return Li(o,t)}function MM(n,e,t){let i=_i(n),r=[i[nn.MonthsFormat],i[nn.MonthsStandalone]],o=Li(r,e);return Li(o,t)}function RM(n,e){let i=_i(n)[nn.Eras];return Li(i,e)}function qu(n,e){let t=_i(n);return Li(t[nn.DateFormat],e)}function Ku(n,e){let t=_i(n);return Li(t[nn.TimeFormat],e)}function Yu(n,e){let i=_i(n)[nn.DateTimeFormat];return Li(i,e)}function Qu(n,e){let t=_i(n),i=t[nn.NumberSymbols][e];if(typeof i>"u"){if(e===po.CurrencyDecimal)return t[nn.NumberSymbols][po.Decimal];if(e===po.CurrencyGroup)return t[nn.NumberSymbols][po.Group]}return i}function kM(n){if(!n[nn.ExtraData])throw new me(2303,!1)}function NM(n){let e=_i(n);return kM(e),(e[nn.ExtraData][2]||[]).map(i=>typeof i=="string"?LE(i):[LE(i[0]),LE(i[1])])}function PM(n,e,t){let i=_i(n);kM(i);let r=[i[nn.ExtraData][0],i[nn.ExtraData][1]],o=Li(r,e)||[];return Li(o,t)||[]}function Li(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new me(2304,!1)}function LE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var LU=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,qp={},VU=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function OM(n,e,t,i){let r=qU(n);e=fo(t,e)||e;let s=[],a;for(;e;)if(a=VU.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let l=r.getTimezoneOffset();i&&(l=LM(i,l),r=WU(r,i));let c="";return s.forEach(d=>{let h=$U(d);c+=h?h(r,t,l):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Xp(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function fo(n,e){let t=CM(n);if(qp[t]??={},qp[t][e])return qp[t][e];let i="";switch(e){case"shortDate":i=qu(n,oi.Short);break;case"mediumDate":i=qu(n,oi.Medium);break;case"longDate":i=qu(n,oi.Long);break;case"fullDate":i=qu(n,oi.Full);break;case"shortTime":i=Ku(n,oi.Short);break;case"mediumTime":i=Ku(n,oi.Medium);break;case"longTime":i=Ku(n,oi.Long);break;case"fullTime":i=Ku(n,oi.Full);break;case"short":let r=fo(n,"shortTime"),o=fo(n,"shortDate");i=Kp(Yu(n,oi.Short),[r,o]);break;case"medium":let s=fo(n,"mediumTime"),a=fo(n,"mediumDate");i=Kp(Yu(n,oi.Medium),[s,a]);break;case"long":let l=fo(n,"longTime"),c=fo(n,"longDate");i=Kp(Yu(n,oi.Long),[l,c]);break;case"full":let d=fo(n,"fullTime"),h=fo(n,"fullDate");i=Kp(Yu(n,oi.Full),[d,h]);break}return i&&(qp[t][e]=i),i}function Kp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function rr(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function UU(n,e){return rr(n,3).substring(0,e)}function hn(n,e,t=0,i=!1,r=!1){return function(o,s){let a=BU(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return UU(a,e);let l=Qu(s,po.MinusSign);return rr(a,e,l,i,r)}}function BU(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new me(2301,!1)}}function kt(n,e,t=jn.Format,i=!1){return function(r,o){return jU(r,o,n,e,t,i)}}function jU(n,e,t,i,r,o){switch(t){case 2:return MM(e,r,i)[n.getMonth()];case 1:return AM(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let c=NM(e),d=PM(e,r,i),h=c.findIndex(f=>{if(Array.isArray(f)){let[m,w]=f,S=s>=m.hours&&a>=m.minutes,k=s<w.hours||s===w.hours&&a<w.minutes;if(m.hours<w.hours){if(S&&k)return!0}else if(S||k)return!0}else if(f.hours===s&&f.minutes===a)return!0;return!1});if(h!==-1)return d[h]}return DM(e,r,i)[s<12?0:1];case 3:return RM(e,i)[n.getFullYear()<=0?0:1];default:let l=t;throw new me(2302,!1)}}function Yp(n){return function(e,t,i){let r=-1*i,o=Qu(t,po.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+rr(s,2,o)+rr(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+rr(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+rr(s,2,o)+":"+rr(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+rr(s,2,o)+":"+rr(Math.abs(r%60),2,o);default:throw new me(2310,!1)}}}var HU=0,Jp=4;function GU(n){let e=Xp(n,HU,1).getDay();return Xp(n,0,1+(e<=Jp?Jp:Jp+7)-e)}function FM(n){let e=n.getDay(),t=e===0?-3:Jp-e;return Xp(n.getFullYear(),n.getMonth(),n.getDate()+t)}function VE(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=FM(t),s=GU(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return rr(r,n,Qu(i,po.MinusSign))}}function Qp(n,e=!1){return function(t,i){let o=FM(t).getFullYear();return rr(o,n,Qu(i,po.MinusSign),e)}}var UE={};function $U(n){if(UE[n])return UE[n];let e;switch(n){case"G":case"GG":case"GGG":e=kt(3,Ct.Abbreviated);break;case"GGGG":e=kt(3,Ct.Wide);break;case"GGGGG":e=kt(3,Ct.Narrow);break;case"y":e=hn(0,1,0,!1,!0);break;case"yy":e=hn(0,2,0,!0,!0);break;case"yyy":e=hn(0,3,0,!1,!0);break;case"yyyy":e=hn(0,4,0,!1,!0);break;case"Y":e=Qp(1);break;case"YY":e=Qp(2,!0);break;case"YYY":e=Qp(3);break;case"YYYY":e=Qp(4);break;case"M":case"L":e=hn(1,1,1);break;case"MM":case"LL":e=hn(1,2,1);break;case"MMM":e=kt(2,Ct.Abbreviated);break;case"MMMM":e=kt(2,Ct.Wide);break;case"MMMMM":e=kt(2,Ct.Narrow);break;case"LLL":e=kt(2,Ct.Abbreviated,jn.Standalone);break;case"LLLL":e=kt(2,Ct.Wide,jn.Standalone);break;case"LLLLL":e=kt(2,Ct.Narrow,jn.Standalone);break;case"w":e=VE(1);break;case"ww":e=VE(2);break;case"W":e=VE(1,!0);break;case"d":e=hn(2,1);break;case"dd":e=hn(2,2);break;case"c":case"cc":e=hn(7,1);break;case"ccc":e=kt(1,Ct.Abbreviated,jn.Standalone);break;case"cccc":e=kt(1,Ct.Wide,jn.Standalone);break;case"ccccc":e=kt(1,Ct.Narrow,jn.Standalone);break;case"cccccc":e=kt(1,Ct.Short,jn.Standalone);break;case"E":case"EE":case"EEE":e=kt(1,Ct.Abbreviated);break;case"EEEE":e=kt(1,Ct.Wide);break;case"EEEEE":e=kt(1,Ct.Narrow);break;case"EEEEEE":e=kt(1,Ct.Short);break;case"a":case"aa":case"aaa":e=kt(0,Ct.Abbreviated);break;case"aaaa":e=kt(0,Ct.Wide);break;case"aaaaa":e=kt(0,Ct.Narrow);break;case"b":case"bb":case"bbb":e=kt(0,Ct.Abbreviated,jn.Standalone,!0);break;case"bbbb":e=kt(0,Ct.Wide,jn.Standalone,!0);break;case"bbbbb":e=kt(0,Ct.Narrow,jn.Standalone,!0);break;case"B":case"BB":case"BBB":e=kt(0,Ct.Abbreviated,jn.Format,!0);break;case"BBBB":e=kt(0,Ct.Wide,jn.Format,!0);break;case"BBBBB":e=kt(0,Ct.Narrow,jn.Format,!0);break;case"h":e=hn(3,1,-12);break;case"hh":e=hn(3,2,-12);break;case"H":e=hn(3,1);break;case"HH":e=hn(3,2);break;case"m":e=hn(4,1);break;case"mm":e=hn(4,2);break;case"s":e=hn(5,1);break;case"ss":e=hn(5,2);break;case"S":e=hn(6,1);break;case"SS":e=hn(6,2);break;case"SSS":e=hn(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Yp(0);break;case"ZZZZZ":e=Yp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Yp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Yp(2);break;default:return null}return UE[n]=e,e}function LM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function zU(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function WU(n,e,t){let r=n.getTimezoneOffset(),o=LM(e,r);return zU(n,-1*(o-r))}function qU(n){if(xM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return Xp(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(LU))return KU(i)}let e=new Date(n);if(!xM(e))throw new me(2311,!1);return e}function KU(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),c=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,c),e}function xM(n){return n instanceof Date&&!isNaN(n.valueOf())}var BE=/\s+/,SM=[],Ju=(()=>{class n{_ngEl;_renderer;initialClasses=SM;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(BE):SM}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(BE):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(BE).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(he(Oi),he(ls))};static \u0275dir=vn({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var Zp=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ps=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Zp(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),IM(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);IM(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(he(co),he(os),he(OE))};static \u0275dir=vn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function IM(n,e){n.context.$implicit=e.item}var go=(()=>{class n{_viewContainer;_context=new eg;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){TM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){TM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(he(co),he(os))};static \u0275dir=vn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),eg=class{$implicit=null;ngIf=null};function TM(n,e){if(n&&!n.createEmbeddedView)throw new me(2020,!1)}function VM(n,e){return new me(2100,!1)}var YU=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,jE=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw VM(n,t);return t.replace(YU,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=Dl({name:"titlecase",type:n,pure:!0})}return n})();var QU="mediumDate",UM=new we(""),BM=new we(""),_a=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??QU,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return OM(t,s,o||this.locale,a)}catch(s){throw VM(n,s.message)}}static \u0275fac=function(i){return new(i||n)(he(Gu,16),he(UM,24),he(BM,24))};static \u0275pipe=Dl({name:"date",type:n,pure:!0})}return n})();var Nt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=uo({type:n});static \u0275inj=br({})}return n})();function HE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Xu=class{};var GE="browser";function gs(n){return n===GE}var Zu=class{_doc;constructor(e){this._doc=e}manager},tg=(()=>{class n extends Zu{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(Re(Qt))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),rg=new we(""),qE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof tg));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof tg);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new me(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Re(rg),Re(yn))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),$E="ng-app-id";function jM(n){for(let e of n)e.remove()}function HM(n,e){let t=e.createElement("style");return t.textContent=n,t}function JU(n,e,t,i){let r=n.head?.querySelectorAll(`style[${$E}="${e}"],link[${$E}="${e}"]`);if(r)for(let o of r)o.removeAttribute($E),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function WE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var KE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,JU(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,HM);i?.forEach(r=>this.addUsage(r,this.external,WE))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(jM(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])jM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,HM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,WE(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Re(Qt),Re(Rr),Re(xl,8),Re(Zi))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),zE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},YE=/%COMP%/g;var $M="%COMP%",XU=`_nghost-${$M}`,ZU=`_ngcontent-${$M}`,eB=!0,tB=new we("",{factory:()=>eB});function nB(n){return ZU.replace(YE,n)}function iB(n){return XU.replace(YE,n)}function zM(n,e){return e.map(t=>t.replace(YE,n))}var QE=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,r,o,s,a,l=null,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.defaultRenderer=new ed(t,s,a,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof ig?r.applyToHost(t):r instanceof td&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.tracingService;switch(i.encapsulation){case Xi.Emulated:o=new ig(l,c,i,this.appId,d,s,a,h);break;case Xi.ShadowDom:return new ng(l,t,i,s,a,this.nonce,h,c);case Xi.ExperimentalIsolatedShadowDom:return new ng(l,t,i,s,a,this.nonce,h);default:o=new td(l,c,i,d,s,a,h);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Re(qE),Re(KE),Re(Rr),Re(tB),Re(Qt),Re(yn),Re(xl),Re(as,8))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),ed=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(zE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(GM(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(GM(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new me(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=zE[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=zE[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Mr.DashCase|Mr.Important)?e.style.setProperty(t,i,r&Mr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Mr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Fi().getGlobalEventTarget(this.doc,e),!e))throw new me(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function GM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var ng=class extends ed{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let c=i.styles;c=zM(i.id,c);for(let h of c){let f=document.createElement("style");s&&f.setAttribute("nonce",s),f.textContent=h,this.shadowRoot.appendChild(f)}let d=i.getExternalStyles?.();if(d)for(let h of d){let f=WE(h,r);s&&f.setAttribute("nonce",s),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},td=class extends ed{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let c=i.styles;this.styles=l?zM(l,c):c,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&ua.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ig=class extends td{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l){let c=r+"-"+i.id;super(e,t,i,o,s,a,l,c),this.contentAttr=nB(c),this.hostAttr=iB(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var og=class n extends Wu{supportsDOMEvents=!0;static makeCurrent(){FE(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=rB();return t==null?null:oB(t)}resetBaseElement(){nd=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return HE(document.cookie,e)}},nd=null;function rB(){return nd=nd||document.head.querySelector("base"),nd?nd.getAttribute("href"):null}function oB(n){return new URL(n,document.baseURI).pathname}var sB=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),WM=["alt","control","meta","shift"],aB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},lB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},qM=(()=>{class n extends Zu{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Fi().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),WM.forEach(c=>{let d=i.indexOf(c);d>-1&&(i.splice(d,1),s+=c+".")}),s+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=aB[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),WM.forEach(s=>{if(s!==r){let a=lB[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(Re(Qt))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})();async function JE(n,e,t){let i=F({rootComponent:n},cB(e,t));return yM(i)}function cB(n,e){return{platformRef:e?.platformRef,appProviders:[...pB,...n?.providers??[]],platformProviders:fB}}function uB(){og.makeCurrent()}function dB(){return new _r}function hB(){return M_(document),document}var fB=[{provide:Zi,useValue:GE},{provide:gp,useValue:uB,multi:!0},{provide:Qt,useFactory:hB}];var pB=[{provide:cu,useValue:"root"},{provide:_r,useFactory:dB},{provide:rg,useClass:tg,multi:!0},{provide:rg,useClass:qM,multi:!0},QE,KE,qE,{provide:da,useExisting:QE},{provide:Xu,useClass:sB},[]];var id=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var gB="text/plain",mB="application/json",Ole=`${mB}, ${gB}, */*`;var ZE=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(ZE||{}),XE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new id,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var sg=class n extends XE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=ZE.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var KM=new we("");var yB=new we(""),vB="b",_B="h",EB="s",bB="st",wB="u",xB="rt",eb=new we(""),SB=["GET","HEAD"];function IB(n,e){let m=K(eb),{isCacheActive:t}=m,i=Xa(m,["isCacheActive"]),{transferCache:r,method:o}=n;if(!t||r===!1||o==="POST"&&!i.includePostRequests&&!r||o!=="POST"&&!SB.includes(o)||!i.includeRequestsWithAuthHeaders&&TB(n)||i.filter?.(n)===!1)return e(n);let s=K(Sl);if(K(yB,{optional:!0}))throw new me(2803,!1);let l=n.url,c=CB(n,l),d=s.get(c,null),h=i.includeHeaders;if(typeof r=="object"&&r.includeHeaders&&(h=r.includeHeaders),d){let{[vB]:w,[xB]:S,[_B]:k,[EB]:V,[bB]:q,[wB]:ye}=d,ve=w;switch(S){case"arraybuffer":ve=new TextEncoder().encode(w).buffer;break;case"blob":ve=new Blob([w]);break}let xe=new id(k);return rt(new sg({body:ve,headers:xe,status:V,statusText:q,url:ye}))}return e(n)}function TB(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function YM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function CB(n,e){let{params:t,method:i,responseType:r}=n,o=YM(t),s=n.serializeBody();s instanceof URLSearchParams?s=YM(s):typeof s!="string"&&(s="");let a=[i,r,e,s,o].join("|"),l=DB(a);return l}function DB(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function QM(n){return[{provide:eb,useFactory:()=>(vi("NgHttpTransferCache"),F({isCacheActive:!0},n))},{provide:KM,useValue:IB,multi:!0},{provide:us,multi:!0,useFactory:()=>{let e=K(ri),t=K(eb);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var JM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Re(Qt))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ag=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(ag||{});function AB(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function XM(){return AB(ag.EventReplay,gM())}function ZM(...n){let e=[],t=new Set;for(let{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);let i=t.has(ag.HttpTransferCacheOptions);return xr([[],[],mM(),t.has(ag.NoHttpTransferCache)||i?[]:QM({}),e])}var ze="primary",gd=Symbol("RouteTitle"),ob=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function wa(n){return new ob(n)}function tb(n,e,t){for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function c2(n,e,t){let i=t.path.split("/"),r=i.indexOf("**");if(r===-1){if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let l={},c=n.slice(0,i.length);return tb(i,c,l)?{consumed:c,posParams:l}:null}if(r!==i.lastIndexOf("**"))return null;let o=i.slice(0,r),s=i.slice(r+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!tb(o,n.slice(0,o.length),a)||!tb(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function fg(n){return new Promise((e,t)=>{n.pipe(Zr()).subscribe({next:i=>e(i),error:i=>t(i)})})}function RB(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Pr(n[t],e[t]))return!1;return!0}function Pr(n,e){let t=n?sb(n):void 0,i=e?sb(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!u2(n[r],e[r]))return!1;return!0}function sb(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function u2(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function kB(n){return n.length>0?n[n.length-1]:null}function Ia(n){return af(n)?n:cs(n)?ln(Promise.resolve(n)):rt(n)}function d2(n){return af(n)?fg(n):Promise.resolve(n)}var NB={exact:f2,subset:p2},h2={exact:PB,subset:OB,ignored:()=>!0};function e2(n,e,t){return NB[t.paths](n.root,e.root,t.matrixParams)&&h2[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function PB(n,e){return Pr(n,e)}function f2(n,e,t){if(!Ea(n.segments,e.segments)||!ug(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!f2(n.children[i],e.children[i],t))return!1;return!0}function OB(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>u2(n[t],e[t]))}function p2(n,e,t){return g2(n,e,e.segments,t)}function g2(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!Ea(r,t)||e.hasChildren()||!ug(r,t,i))}else if(n.segments.length===t.length){if(!Ea(n.segments,t)||!ug(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!p2(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!Ea(n.segments,r)||!ug(n.segments,r,i)||!n.children[ze]?!1:g2(n.children[ze],e,o,i)}}function ug(n,e,t){return e.every((i,r)=>h2[t](n[r].parameters,i.parameters))}var sr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new mt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=wa(this.queryParams),this._queryParamMap}toString(){return VB.serialize(this)}},mt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return dg(this)}},ms=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=wa(this.parameters),this._parameterMap}toString(){return y2(this)}};function FB(n,e){return Ea(n,e)&&n.every((t,i)=>Pr(t.parameters,e[i].parameters))}function Ea(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function LB(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===ze&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ze&&(t=t.concat(e(r,i)))}),t}var md=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>new ys,providedIn:"root"})}return n})(),ys=class{parse(e){let t=new lb(e);return new sr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${rd(e.root,!0)}`,i=jB(e.queryParams),r=typeof e.fragment=="string"?`#${UB(e.fragment)}`:"";return`${t}${i}${r}`}},VB=new ys;function dg(n){return n.segments.map(e=>y2(e)).join("/")}function rd(n,e){if(!n.hasChildren())return dg(n);if(e){let t=n.children[ze]?rd(n.children[ze],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==ze&&i.push(`${r}:${rd(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=LB(n,(i,r)=>r===ze?[rd(n.children[ze],!1)]:[`${r}:${rd(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[ze]!=null?`${dg(n)}/${t[0]}`:`${dg(n)}/(${t.join("//")})`}}function m2(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lg(n){return m2(n).replace(/%3B/gi,";")}function UB(n){return encodeURI(n)}function ab(n){return m2(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hg(n){return decodeURIComponent(n)}function t2(n){return hg(n.replace(/\+/g,"%20"))}function y2(n){return`${ab(n.path)}${BB(n.parameters)}`}function BB(n){return Object.entries(n).map(([e,t])=>`;${ab(e)}=${ab(t)}`).join("")}function jB(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${lg(t)}=${lg(r)}`).join("&"):`${lg(t)}=${lg(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var HB=/^[^\/()?;#]+/;function nb(n){let e=n.match(HB);return e?e[0]:""}var GB=/^[^\/()?;=#]+/;function $B(n){let e=n.match(GB);return e?e[0]:""}var zB=/^[^=?&#]+/;function WB(n){let e=n.match(zB);return e?e[0]:""}var qB=/^[^&#]+/;function KB(n){let e=n.match(qB);return e?e[0]:""}var lb=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new mt([],{}):new mt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[ze]=new mt(e,t)),i}parseSegment(){let e=nb(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new me(4009,!1);return this.capture(e),new ms(hg(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=$B(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=nb(this.remaining);r&&(i=r,this.capture(i))}e[hg(t)]=hg(i)}parseQueryParam(e){let t=WB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=KB(this.remaining);s&&(i=s,this.capture(i))}let r=t2(t),o=t2(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=nb(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new me(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ze);let s=this.parseChildren();t[o??ze]=Object.keys(s).length===1&&s[ze]?s[ze]:new mt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new me(4011,!1)}};function v2(n){return n.segments.length>0?new mt([],{[ze]:n}):n}function _2(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=_2(r);if(i===ze&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new mt(n.segments,e);return YB(t)}function YB(n){if(n.numberOfChildren===1&&n.children[ze]){let e=n.children[ze];return new mt(n.segments.concat(e.segments),e.children)}return n}function vs(n){return n instanceof sr}function E2(n,e,t=null,i=null,r=new ys){let o=b2(n);return w2(o,e,t,i,r)}function b2(n){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new mt(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=v2(i);return e??r}function w2(n,e,t,i,r){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return ib(o,o,o,t,i,r);let s=QB(e);if(s.toRoot())return ib(o,o,new mt([],{}),t,i,r);let a=JB(s,o,n),l=a.processChildren?sd(a.segmentGroup,a.index,s.commands):S2(a.segmentGroup,a.index,s.commands);return ib(o,a.segmentGroup,l,t,i,r)}function pg(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function cd(n){return typeof n=="object"&&n!=null&&n.outlets}function n2(n,e,t){n||="\u0275";let i=new sr;return i.queryParams={[n]:e},t.parse(t.serialize(i)).queryParams[n]}function ib(n,e,t,i,r,o){let s={};for(let[c,d]of Object.entries(i??{}))s[c]=Array.isArray(d)?d.map(h=>n2(c,h,o)):n2(c,d,o);let a;n===e?a=t:a=x2(n,e,t);let l=v2(_2(a));return new sr(l,s,r)}function x2(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=x2(o,e,t)}),new mt(n.segments,i)}var gg=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&pg(i[0]))throw new me(4003,!1);let r=i.find(cd);if(r&&r!==kB(i))throw new me(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function QB(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new gg(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new gg(t,e,i)}var Ul=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function JB(n,e,t){if(n.isAbsolute)return new Ul(e,!0,0);if(!t)return new Ul(e,!1,NaN);if(t.parent===null)return new Ul(t,!0,0);let i=pg(n.commands[0])?0:1,r=t.segments.length-1+i;return XB(t,r,n.numberOfDoubleDots)}function XB(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new me(4005,!1);r=i.segments.length}return new Ul(i,!1,r-o)}function ZB(n){return cd(n[0])?n[0].outlets:{[ze]:n}}function S2(n,e,t){if(n??=new mt([],{}),n.segments.length===0&&n.hasChildren())return sd(n,e,t);let i=e8(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new mt(n.segments.slice(0,i.pathIndex),{});return o.children[ze]=new mt(n.segments.slice(i.pathIndex),n.children),sd(o,0,r)}else return i.match&&r.length===0?new mt(n.segments,{}):i.match&&!n.hasChildren()?cb(n,e,t):i.match?sd(n,0,r):cb(n,e,t)}function sd(n,e,t){if(t.length===0)return new mt(n.segments,{});{let i=ZB(t),r={};if(Object.keys(i).some(o=>o!==ze)&&n.children[ze]&&n.numberOfChildren===1&&n.children[ze].segments.length===0){let o=sd(n.children[ze],e,t);return new mt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=S2(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new mt(n.segments,r)}}function e8(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(cd(a))break;let l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!r2(l,c,s))return o;i+=2}else{if(!r2(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function cb(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(cd(o)){let l=t8(o.outlets);return new mt(i,l)}if(r===0&&pg(t[0])){let l=n.segments[e];i.push(new ms(l.path,i2(t[0]))),r++;continue}let s=cd(o)?o.outlets[ze]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&pg(a)?(i.push(new ms(s,i2(a))),r+=2):(i.push(new ms(s,{})),r++)}return new mt(i,{})}function t8(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=cb(new mt([],{}),0,i))}),e}function i2(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function r2(n,e,t){return n==t.path&&Pr(e,t.parameters)}var ad="imperative",Tn=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Tn||{}),wi=class{id;url;constructor(e,t){this.id=e,this.url=t}},xa=class extends wi{type=Tn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Or=class extends wi{urlAfterRedirects;type=Tn.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Hn=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Hn||{}),ud=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(ud||{}),Vi=class extends wi{reason;code;type=Tn.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function I2(n){return n instanceof Vi&&(n.code===Hn.Redirect||n.code===Hn.SupersededByNewNavigation)}var yo=class extends wi{reason;code;type=Tn.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},Sa=class extends wi{error;target;type=Tn.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},jl=class extends wi{urlAfterRedirects;state;type=Tn.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},mg=class extends wi{urlAfterRedirects;state;type=Tn.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yg=class extends wi{urlAfterRedirects;state;shouldActivate;type=Tn.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},vg=class extends wi{urlAfterRedirects;state;type=Tn.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_g=class extends wi{urlAfterRedirects;state;type=Tn.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Eg=class{route;type=Tn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},bg=class{route;type=Tn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},wg=class{snapshot;type=Tn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xg=class{snapshot;type=Tn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sg=class{snapshot;type=Tn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ig=class{snapshot;type=Tn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Hl=class{},Gl=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function n8(n){return!(n instanceof Hl)&&!(n instanceof Gl)}var Tg=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Wl(this.rootInjector)}},Wl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Tg(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Re(Yt))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Cg=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=ub(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=ub(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=db(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return db(e,this._root).map(t=>t.value)}};function ub(n,e){if(n===e.value)return e;for(let t of e.children){let i=ub(n,t);if(i)return i}return null}function db(n,e){if(n===e.value)return[e];for(let t of e.children){let i=db(n,t);if(i.length)return i.unshift(e),i}return[]}var bi=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Vl(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var dd=class extends Cg{snapshot;constructor(e,t){super(e),this.snapshot=t,_b(this,e)}toString(){return this.snapshot.toString()}};function T2(n,e){let t=i8(n,e),i=new Nn([new ms("",{})]),r=new Nn({}),o=new Nn({}),s=new Nn({}),a=new Nn(""),l=new vo(i,r,s,a,o,ze,n,t.root);return l.snapshot=t.root,new dd(new bi(l,[]),t)}function i8(n,e){let t={},i={},r={},s=new ba([],t,r,"",i,ze,n,null,{},e);return new hd("",new bi(s,[]))}var vo=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(vt(c=>c[gd]))??rt(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(vt(e=>wa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(vt(e=>wa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Dg(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),r?.data),n._resolvedData)}:i={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},r&&D2(r)&&(i.resolve[gd]=r.title),i}var ba=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[gd]}constructor(e,t,i,r,o,s,a,l,c,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=wa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=wa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},hd=class extends Cg{url;constructor(e,t){super(t),this.url=e,_b(this,t)}toString(){return C2(this._root)}};function _b(n,e){e.value._routerState=n,e.children.forEach(t=>_b(n,t))}function C2(n){let e=n.children.length>0?` { ${n.children.map(C2).join(", ")} } `:"";return`${n.value}${e}`}function rb(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Pr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Pr(e.params,t.params)||n.paramsSubject.next(t.params),RB(e.url,t.url)||n.urlSubject.next(t.url),Pr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function hb(n,e){let t=Pr(n.params,e.params)&&FB(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||hb(n.parent,e.parent))}function D2(n){return typeof n.title=="string"||n.title===null}var A2=new we(""),yd=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ze;activateEvents=new cn;deactivateEvents=new cn;attachEvents=new cn;detachEvents=new cn;routerOutletData=fM();parentContexts=K(Wl);location=K(co);changeDetector=K(va);inputBinder=K(kg,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new me(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new me(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new me(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new me(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new fb(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=vn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[lo]})}return n})(),fb=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===vo?this.route:e===Wl?this.childContexts:e===A2?this.outletData:this.parent.get(e,t)}},kg=new we("");var Eb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=It({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&W(0,"router-outlet")},dependencies:[yd],encapsulation:2})}return n})();function bb(n){let e=n.children&&n.children.map(bb),t=e?ce(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ze&&(t.component=Eb),t}function r8(n,e,t){let i=fd(n,e._root,t?t._root:void 0);return new dd(i,e)}function fd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=o8(n,e,t);return new bi(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>fd(n,a)),s}}let i=s8(e.value),r=e.children.map(o=>fd(n,o));return new bi(i,r)}}function o8(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return fd(n,i,r);return fd(n,i)})}function s8(n){return new vo(new Nn(n.url),new Nn(n.params),new Nn(n.queryParams),new Nn(n.fragment),new Nn(n.data),n.outlet,n.component,n)}var $l=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},M2="ngNavigationCancelingError";function Ag(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=vs(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=R2(!1,Hn.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function R2(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[M2]=!0,t.cancellationCode=e,t}function a8(n){return k2(n)&&vs(n.url)}function k2(n){return!!n&&n[M2]}var pb=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),rb(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=Vl(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Vl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Vl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=Vl(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Ig(o.value.snapshot))}),e.children.length&&this.forwardEvent(new xg(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(rb(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),rb(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},Mg=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Bl=class{component;route;constructor(e,t){this.component=e,this.route=t}};function l8(n,e,t){let i=n._root,r=e?e._root:null;return od(i,r,t,[i.value])}function c8(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function ql(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!zy(n)?n:e.get(n):i}function od(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=Vl(e);return n.children.forEach(s=>{u8(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>ld(a,t.getContext(s),r)),r}function u8(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=d8(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Mg(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?od(n,e,a?a.children:null,i,r):od(n,e,t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Bl(a.outlet.component,s))}else s&&ld(e,a,r),r.canActivateChecks.push(new Mg(i)),o.component?od(n,null,a?a.children:null,i,r):od(n,null,t,i,r);return r}function d8(n,e,t){if(typeof t=="function")return Fn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!Ea(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Ea(n.url,e.url)||!Pr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hb(n,e)||!Pr(n.queryParams,e.queryParams);default:return!hb(n,e)}}function ld(n,e,t){let i=Vl(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?ld(s,e.children.getContext(o),t):ld(s,null,t):ld(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Bl(e.outlet.component,r)):t.canDeactivateChecks.push(new Bl(null,r)):t.canDeactivateChecks.push(new Bl(null,r))}function vd(n){return typeof n=="function"}function h8(n){return typeof n=="boolean"}function f8(n){return n&&vd(n.canLoad)}function p8(n){return n&&vd(n.canActivate)}function g8(n){return n&&vd(n.canActivateChild)}function m8(n){return n&&vd(n.canDeactivate)}function y8(n){return n&&vd(n.canMatch)}function N2(n){return n instanceof zs||n?.name==="EmptyError"}var cg=Symbol("INITIAL_VALUE");function zl(){return eo(n=>Xc(n.map(e=>e.pipe(qi(1),tu(cg)))).pipe(vt(e=>{for(let t of e)if(t!==!0){if(t===cg)return cg;if(t===!1||v8(t))return t}return!0}),Wi(e=>e!==cg),qi(1)))}function v8(n){return vs(n)||n instanceof $l}function P2(n){return n.aborted?rt(void 0).pipe(qi(1)):new st(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function O2(n){return Ws(P2(n))}function _8(n){return Wn(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?rt(ce(F({},e),{guardsResult:!0})):E8(o,t,i).pipe(Wn(s=>s&&h8(s)?b8(t,r,n):rt(s)),vt(s=>ce(F({},e),{guardsResult:s})))})}function E8(n,e,t){return ln(n).pipe(Wn(i=>T8(i.component,i.route,t,e)),Zr(i=>i!==!0,!0))}function b8(n,e,t){return ln(e).pipe(df(i=>Yo(x8(i.route.parent,t),w8(i.route,t),I8(n,i.path),S8(n,i.route))),Zr(i=>i!==!0,!0))}function w8(n,e){return n!==null&&e&&e(new Sg(n)),rt(!0)}function x8(n,e){return n!==null&&e&&e(new wg(n)),rt(!0)}function S8(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return rt(!0);let i=t.map(r=>Zc(()=>{let o=e._environmentInjector,s=ql(r,o),a=p8(s)?s.canActivate(e,n):Fn(o,()=>s(e,n));return Ia(a).pipe(Zr())}));return rt(i).pipe(zl())}function I8(n,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>c8(o)).filter(o=>o!==null).map(o=>Zc(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,c=ql(a,l),d=g8(c)?c.canActivateChild(t,n):Fn(l,()=>c(t,n));return Ia(d).pipe(Zr())});return rt(s).pipe(zl())}));return rt(r).pipe(zl())}function T8(n,e,t,i){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return rt(!0);let o=r.map(s=>{let a=e._environmentInjector,l=ql(s,a),c=m8(l)?l.canDeactivate(n,e,t,i):Fn(a,()=>l(n,e,t,i));return Ia(c).pipe(Zr())});return rt(o).pipe(zl())}function C8(n,e,t,i,r){let o=e.canLoad;if(o===void 0||o.length===0)return rt(!0);let s=o.map(a=>{let l=ql(a,n),c=f8(l)?l.canLoad(e,t):Fn(n,()=>l(e,t)),d=Ia(c);return r?d.pipe(O2(r)):d});return rt(s).pipe(zl(),F2(i))}function F2(n){return Ey(yr(e=>{if(typeof e!="boolean")throw Ag(n,e)}),vt(e=>e===!0))}function D8(n,e,t,i,r){let o=e.canMatch;if(!o||o.length===0)return rt(!0);let s=o.map(a=>{let l=ql(a,n),c=y8(l)?l.canMatch(e,t):Fn(n,()=>l(e,t));return Ia(c).pipe(O2(r))});return rt(s).pipe(zl(),F2(i))}var mo=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},pd=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function A8(n){throw new me(4e3,!1)}function M8(n){throw R2(!1,Hn.GuardRejected)}var gb=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return i;if(r.numberOfChildren>1||!r.children[ze])throw A8(`${e.redirectTo}`);r=r.children[ze]}}async applyRedirectCommands(e,t,i,r,o){let s=await R8(t,r,o);if(s instanceof sr)throw new pd(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new pd(a);return a}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new sr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new mt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new me(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function R8(n,e,t){if(typeof n=="string")return Promise.resolve(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:c,data:d,title:h,paramMap:f,queryParamMap:m}=e;return fg(Ia(Fn(t,()=>i({params:c,data:d,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:f,queryParamMap:m}))))}function k8(n,e){return n.providers&&!n._injector&&(n._injector=Cl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function or(n){return n.outlet||ze}function N8(n,e){let t=n.filter(i=>or(i)===e);return t.push(...n.filter(i=>or(i)!==e)),t}var mb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function P8(n,e,t,i,r,o){let s=L2(n,e,t);return s.matched?(i=k8(e,i),D8(i,e,t,r,o).pipe(vt(a=>a===!0?s:F({},mb)))):rt(s)}function L2(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},mb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||c2)(t,n,e);if(!r)return F({},mb);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?F(F({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function o2(n,e,t,i){return t.length>0&&L8(n,t,i)?{segmentGroup:new mt(e,F8(i,new mt(t,n.children))),slicedSegments:[]}:t.length===0&&V8(n,t,i)?{segmentGroup:new mt(n.segments,O8(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new mt(n.segments,n.children),slicedSegments:t}}function O8(n,e,t,i){let r={};for(let o of t)if(Ng(n,e,o)&&!i[or(o)]){let s=new mt([],{});r[or(o)]=s}return F(F({},i),r)}function F8(n,e){let t={};t[ze]=e;for(let i of n)if(i.path===""&&or(i)!==ze){let r=new mt([],{});t[or(i)]=r}return t}function L8(n,e,t){return t.some(i=>Ng(n,e,i)&&or(i)!==ze)}function V8(n,e,t){return t.some(i=>Ng(n,e,i))}function Ng(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function U8(n,e,t){return e.length===0&&!n.children[t]}var yb=class{};async function B8(n,e,t,i,r,o,s="emptyOnly",a){return new vb(n,e,t,i,r,s,o,a).recognize()}var j8=31,vb=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new gb(this.urlSerializer,this.urlTree)}noMatchError(e){return new me(4002,`'${e.segmentGroup}'`)}async recognize(){let e=o2(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),r=new bi(i,t),o=new hd("",r),s=E2(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new ba([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ze,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,ze,t),rootSnapshot:t}}catch(i){if(i instanceof pd)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof mo?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,r,o){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,o);let s=await this.processSegment(e,t,i,i.segments,r,!0,o);return s instanceof bi?[s]:[]}async processChildren(e,t,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let c=i.children[l],d=N8(t,l),h=await this.processSegmentGroup(e,d,c,l,r);s.push(...h)}let a=V2(s);return H8(a),a}async processSegment(e,t,i,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a)}catch(c){if(c instanceof mo||N2(c))continue;throw c}if(U8(i,r,o))return new yb;throw new mo(i)}async processSegmentAgainstRoute(e,t,i,r,o,s,a,l){if(or(i)!==s&&(s===ze||!Ng(r,o,i)))throw new mo(r);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,i,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l);throw new mo(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:h,remainingSegments:f}=L2(t,r,o);if(!l)throw new mo(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>j8&&(this.allowRedirects=!1));let m=new ba(o,c,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,s2(r),or(r),r.component??r._loadedComponent??null,r,a2(r),e),w=Dg(m,a,this.paramsInheritanceStrategy);if(m.params=Object.freeze(w.params),m.data=Object.freeze(w.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let S=await this.applyRedirects.applyRedirectCommands(d,r.redirectTo,h,m,e),k=await this.applyRedirects.lineralizeSegments(r,S);return this.processSegment(e,i,t,k.concat(f),s,!1,a)}async matchSegmentAgainstRoute(e,t,i,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await fg(P8(t,i,r,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!a?.matched)throw new mo(t);e=i._injector??e;let{routes:l}=await this.getChildConfig(e,i,r),c=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=a,m=new ba(h,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,s2(i),or(i),i.component??i._loadedComponent??null,i,a2(i),e),w=Dg(m,s,this.paramsInheritanceStrategy);m.params=Object.freeze(w.params),m.data=Object.freeze(w.data);let{segmentGroup:S,slicedSegments:k}=o2(t,h,f,l);if(k.length===0&&S.hasChildren()){let ye=await this.processChildren(c,l,S,m);return new bi(m,ye)}if(l.length===0&&k.length===0)return new bi(m,[]);let V=or(i)===o,q=await this.processSegment(c,l,S,k,V?ze:o,!0,m);return new bi(m,q instanceof bi?[q]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await fg(C8(e,t,i,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw M8(t)}return{routes:[],injector:e}}};function H8(n){n.sort((e,t)=>e.value.outlet===ze?-1:t.value.outlet===ze?1:e.value.outlet.localeCompare(t.value.outlet))}function G8(n){let e=n.value.routeConfig;return e&&e.path===""}function V2(n){let e=[],t=new Set;for(let i of n){if(!G8(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=V2(i.children);e.push(new bi(i.value,r))}return e.filter(i=>!t.has(i))}function s2(n){return n.data||{}}function a2(n){return n.resolve||{}}function $8(n,e,t,i,r,o,s){return Wn(async a=>{let{state:l,tree:c}=await B8(n,e,t,i,a.extractedUrl,r,o,s);return ce(F({},a),{targetSnapshot:l,urlAfterRedirects:c})})}function z8(n){return Wn(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return rt(e);let r=new Set(i.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of U2(a))o.add(l);let s=0;return ln(o).pipe(df(a=>r.has(a)?W8(a,t,n):(a.data=Dg(a,a.parent,n).resolve,rt(void 0))),yr(()=>s++),hf(1),Wn(a=>s===o.size?rt(e):Pn))})}function U2(n){let e=n.children.map(t=>U2(t)).flat();return[n,...e]}function W8(n,e,t){let i=n.routeConfig,r=n._resolve;return i?.title!==void 0&&!D2(i)&&(r[gd]=i.title),Zc(()=>(n.data=Dg(n,n.parent,t).resolve,q8(r,n,e).pipe(vt(o=>(n._resolvedData=o,n.data=F(F({},n.data),o),null)))))}function q8(n,e,t){let i=sb(n);if(i.length===0)return rt({});let r={};return ln(i).pipe(Wn(o=>K8(n[o],e,t).pipe(Zr(),yr(s=>{if(s instanceof $l)throw Ag(new ys,s);r[o]=s}))),hf(1),vt(()=>r),eu(o=>N2(o)?Pn:Sy(o)))}function K8(n,e,t){let i=e._environmentInjector,r=ql(n,i),o=r.resolve?r.resolve(e,t):Fn(i,()=>r(e,t));return Ia(o)}function l2(n){return eo(e=>{let t=n(e);return t?ln(t).pipe(vt(()=>e)):rt(e)})}var wb=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===ze);return i}getResolvedTitleForRoute(t){return t.data[gd]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(B2),providedIn:"root"})}return n})(),B2=(()=>{class n extends wb{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Re(JM))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Kl=new we("",{factory:()=>({})}),_d=new we(""),j2=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=K(EE);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await d2(Fn(t,()=>i.loadComponent())),s=await $2(G2(o));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s,s}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await H2(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=o.routes,i._loadedInjector=o.injector,i._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function H2(n,e,t,i){let r=await d2(Fn(t,()=>n.loadChildren())),o=await $2(G2(r)),s;o instanceof Op||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),i&&i(n);let a,l,c=!1,d;return Array.isArray(s)?(l=s,c=!0):(a=s.create(t).injector,d=s,l=a.get(_d,[],{optional:!0,self:!0}).flat()),{routes:l.map(bb),injector:a,factory:d}}function Y8(n){return n&&typeof n=="object"&&"default"in n}function G2(n){return Y8(n)?n.default:n}async function $2(n){return n}var Pg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(Q8),providedIn:"root"})}return n})(),Q8=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),z2=new we("");var J8=()=>{},W2=new we(""),q2=(()=>{class n{currentNavigation=$(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=$(null);events=new Ht;transitionAbortWithErrorSubject=new Ht;configLoader=K(j2);environmentInjector=K(Yt);destroyRef=K(ii);urlSerializer=K(md);rootContexts=K(Wl);location=K(Fl);inputBindingEnabled=K(kg,{optional:!0})!==null;titleStrategy=K(wb);options=K(Kl,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=K(Pg);createViewTransition=K(z2,{optional:!0});navigationErrorHandler=K(W2,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>rt(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new Eg(r)),i=r=>this.events.next(new bg(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;un(()=>{this.transitions?.next(ce(F({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new Nn(null),this.transitions.pipe(Wi(i=>i!==null),eo(i=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===i.id;return rt(i).pipe(eo(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Hn.SupersededByNewNavigation),Pn;this.currentTransition=i;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?ce(F({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload")return this.events.next(new yo(a.id,this.urlSerializer.serialize(a.rawUrl),"",ud.IgnoredSameUrlNavigation)),a.resolve(!1),Pn;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return rt(a).pipe(eo(h=>(this.events.next(new xa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?Pn:Promise.resolve(h))),$8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),yr(h=>{i.targetSnapshot=h.targetSnapshot,i.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(m=>(m.finalUrl=h.urlAfterRedirects,m));let f=new jl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:f,source:m,restoredState:w,extras:S}=a,k=new xa(h,this.urlSerializer.serialize(f),m,w);this.events.next(k);let V=T2(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=ce(F({},a),{targetSnapshot:V,urlAfterRedirects:f,extras:ce(F({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(q=>(q.finalUrl=f,q)),rt(i)}else return this.events.next(new yo(a.id,this.urlSerializer.serialize(a.extractedUrl),"",ud.IgnoredByUrlHandlingStrategy)),a.resolve(!1),Pn}),vt(a=>{let l=new mg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=i=ce(F({},a),{guards:l8(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i}),_8(a=>this.events.next(a)),eo(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw Ag(this.urlSerializer,a.guardsResult);let l=new yg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return Pn;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",Hn.GuardRejected),Pn;if(a.guards.canActivateChecks.length===0)return rt(a);let c=new vg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(c),!s())return Pn;let d=!1;return rt(a).pipe(z8(this.paramsInheritanceStrategy),yr({next:()=>{d=!0;let h=new _g(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{d||this.cancelNavigationTransition(a,"",Hn.NoDataFromResolver)}}))}),l2(a=>{let l=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let f=d._environmentInjector;h.push(this.configLoader.loadComponent(f,d.routeConfig).then(m=>{d.component=m}))}for(let f of d.children)h.push(...l(f));return h},c=l(a.targetSnapshot.root);return c.length===0?rt(a):ln(Promise.all(c).then(()=>a))}),l2(()=>this.afterPreactivation()),eo(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,c=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return c?ln(c).pipe(vt(()=>i)):rt(i)}),qi(1),vt(a=>{let l=r8(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=i=a=ce(F({},a),{targetRouterState:l}),this.currentNavigation.update(c=>(c.targetRouterState=l,c)),this.events.next(new Hl),s()&&(new pb(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,c=>this.events.next(c),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(c=>(c.abort=J8,c)),this.lastSuccessfulNavigation.set(un(this.currentNavigation)),this.events.next(new Or(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Ws(P2(o.signal).pipe(Wi(()=>!r&&!i.targetRouterState),yr(()=>{this.cancelNavigationTransition(i,o.signal.reason+"",Hn.Aborted)}))),yr({complete:()=>{r=!0}}),Ws(this.transitionAbortWithErrorSubject.pipe(yr(a=>{throw a}))),Cy(()=>{o.abort(),r||this.cancelNavigationTransition(i,"",Hn.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),eu(a=>{if(r=!0,this.destroyed)return i.resolve(!1),Pn;if(k2(a))this.events.next(new Vi(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),a8(a)?this.events.next(new Gl(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new Sa(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let c=Fn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(c instanceof $l){let{message:d,cancellationCode:h}=Ag(this.urlSerializer,c);this.events.next(new Vi(i.id,this.urlSerializer.serialize(i.extractedUrl),d,h)),this.events.next(new Gl(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(c){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(c)}}return Pn}))}))}cancelNavigationTransition(t,i,r){let o=new Vi(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=un(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function X8(n){return n!==ad}var K2=new we("");var Y2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(Z8),providedIn:"root"})}return n})(),Rg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},Z8=(()=>{class n extends Rg{static \u0275fac=(()=>{let t;return function(r){return(t||(t=pa(n)))(r||n)}})();static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xb=(()=>{class n{urlSerializer=K(md);options=K(Kl,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=K(Fl);urlHandlingStrategy=K(Pg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new sr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof sr?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=T2(null,K(Yt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(ej),providedIn:"root"})}return n})(),ej=(()=>{class n extends xb{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof xa?this.updateStateMemento():t instanceof yo?this.commitTransition(i):t instanceof jl?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Hl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Vi&&!I2(t)?this.restoreHistory(i):t instanceof Sa?this.restoreHistory(i,!0):t instanceof Or&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=F(F({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=F(F({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=pa(n)))(r||n)}})();static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Sb(n,e){n.events.pipe(Wi(t=>t instanceof Or||t instanceof Vi||t instanceof Sa||t instanceof yo),vt(t=>t instanceof Or||t instanceof yo?0:(t instanceof Vi?t.code===Hn.Redirect||t.code===Hn.SupersededByNewNavigation:!1)?2:1),Wi(t=>t!==2),qi(1)).subscribe(()=>{e()})}var Q2={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},J2={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},xi=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=K(Fp);stateManager=K(xb);options=K(Kl,{optional:!0})||{};pendingTasks=K(Dr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=K(q2);urlSerializer=K(md);location=K(Fl);urlHandlingStrategy=K(Pg);injector=K(Yt);_events=new Ht;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=K(Y2);injectorCleanup=K(K2,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=K(_d,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!K(kg,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new mn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=un(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Vi&&i.code!==Hn.Redirect&&i.code!==Hn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Or)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof Gl){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=F({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||X8(r.source)},s);this.scheduleNavigation(a,ad,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}n8(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ad,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=F({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(mi)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return un(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(bb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=r?r.snapshot:this.routerState.snapshot.root;h=b2(f)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return w2(h,t,d,c??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let r=vs(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,ad,null,i)}navigate(t,i={skipLocationChange:!1}){return tj(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(io(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=F({},Q2):i===!1?r=F({},J2):r=i,vs(t))return e2(this.currentUrlTree,t,r);let o=this.parseUrl(t);return e2(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((h,f)=>{a=h,l=f});let d=this.pendingTasks.add();return Sb(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tj(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new me(4008,!1)}var Fr=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=$(null);get href(){return un(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Ht;applicationErrorHandler=K(mi);options=K(Kl,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(K(new $p("href"),{optional:!0}));let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area"||!!(typeof customElements=="object"&&customElements.get(l)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Or&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(vs(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l)?.catch(c=>{this.applicationErrorHandler(c)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:vs(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(he(xi),he(vo),Mu("tabindex"),he(ls),he(Oi),he(Ol))};static \u0275dir=vn({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&X("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&Bt("href",r.reactiveHref(),H_)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",zu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",zu],replaceUrl:[2,"replaceUrl","replaceUrl",zu],routerLink:"routerLink"},features:[lo]})}return n})();var rj=new we("");function Ib(n,...e){return xr([{provide:_d,multi:!0,useValue:n},[],{provide:vo,useFactory:oj},{provide:us,multi:!0,useFactory:sj},e.map(t=>t.\u0275providers)])}function oj(){return K(xi).routerState.root}function sj(){let n=K(Yn);return e=>{let t=n.get(ri);if(e!==t.components[0])return;let i=n.get(xi),r=n.get(aj);n.get(lj)===1&&i.initialNavigation(),n.get(cj,null,{optional:!0})?.setUpPreloading(),n.get(rj,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var aj=new we("",{factory:()=>new Ht}),lj=new we("",{factory:()=>1});var cj=new we("");function X2(n,e){let i=!e?.manualCleanup?e?.injector?.get(ii)??K(ii):null,r=uj(e?.equal),o;e?.requireSync?o=$({kind:0},{equal:r}):o=$({kind:1,value:e?.initialValue},{equal:r});let s,a=n.subscribe({next:l=>o.set({kind:1,value:l}),error:l=>{o.set({kind:2,error:l}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&o().kind===0)throw new me(601,!1);return s=i?.onDestroy(a.unsubscribe.bind(a)),Bn(()=>{let l=o();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:throw new me(601,!1)}},{equal:e?.equal})}function uj(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var Tb;try{Tb=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Tb=!1}var Z2=(()=>{class n{_platformId=K(Zi);isBrowser=this._platformId?gs(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Tb)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cb(n){return Array.isArray(n)?n:[n]}var eR=new Set,Ta,nR=(()=>{class n{_platform=K(Z2);_nonce=K(xl,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):hj}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&dj(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function dj(n,e){if(!eR.has(n))try{Ta||(Ta=document.createElement("style"),e&&Ta.setAttribute("nonce",e),Ta.setAttribute("type","text/css"),document.head.appendChild(Ta)),Ta.sheet&&(Ta.sheet.insertRule(`@media ${n} {body{ }}`,0),eR.add(n))}catch(t){console.error(t)}}function hj(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var Db=(()=>{class n{_mediaMatcher=K(nR);_zone=K(yn);_queries=new Map;_destroySubject=new Ht;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return tR(Cb(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=tR(Cb(t)).map(s=>this._registerQuery(s).observable),o=Xc(r);return o=Yo(o.pipe(qi(1)),o.pipe(Dy(1),Ty(0))),o.pipe(vt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),o={observable:new st(s=>{let a=l=>this._zone.run(()=>s.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(tu(i),vt(({matches:s})=>({query:t,matches:s})),Ws(this._destroySubject)),mql:i};return this._queries.set(t,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tR(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var Yl=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let r={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return r?r[t-1]:1}getDefenseBonus(e,t){let i=0,r=[];(e.turnsStationary??0)>=3&&(i+=1,r.push("Shield +1"));let o=t.filter(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1);return o.length&&(i+=o.length,r.push(`Support +${o.length}`)),{bonus:i,tags:r}}getAttackLuckModifier(e){let t=Math.random(),r={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:r,tag:`CRIT! +${r}`,isCrit:!0}:t>.8?{delta:-r,tag:`MISS! -${r}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}getWallHitAmount(e){return e===1?34:e===2?51:101}applyDamage(e,t){let i=e.armorHp??0,r=Math.max(0,i-t),o=Math.max(0,t-i),s=Math.max(0,e.points-o),{tier:a,level:l}=this.calculateTierAndLevel(s);return ce(F({},e),{armorHp:r,points:s,tier:a,level:l})}calculateHitChance(e,t){let i=t.tier-e.tier,r=e.level??1,o=0;i<=0?o=100:i===1?o=Math.min(100,50+r*15):i===2?o=Math.min(100,25+r*5):o=Math.min(100,1+r*1);let s=e.hasWeapon&&t.tier>e.tier?10:0,a=t.hasArmor?10:0;return Math.max(1,Math.min(100,o+s-a))}isDiagonalBlocked(e,t,i){let r=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(r===0||o===0)return!1;let s=i(e.x,e.y,e.x+r,e.y),a=i(e.x,e.y,e.x,e.y+o),l=i(t.x-r,t.y,t.x,t.y),c=i(t.x,t.y-o,t.x,t.y);return!!(s||a||l||c)}checkWallAlongPath(e,t,i,r){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),l=Math.sign(s),c=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=c;d++){let h={x:e.x+a*(d-1),y:e.y+l*(d-1)},f={x:e.x+a*d,y:e.y+l*d},m=r(h.x,h.y,f.x,f.y);if(m)return m.owner===i?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:h}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Fg=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,i){let r=[t,i];for(let o of r){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,i,r){return e.some(o=>o.owner===t&&(o.position.x===i.x&&o.position.y===i.y||o.position.x===r.x&&o.position.y===r.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Lg=class n{entriesSignal=$([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(i=>[...i,{text:e,color:t,type:"other"}])}addCombat(e,t,i){let r=i?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:r,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var gj={SELECT_TILE_TO_BUILD:{en:"\u041E\u0431\u0435\u0440\u0456\u0442\u044C \u0432\u0456\u043B\u044C\u043D\u0443 \u0434\u0456\u043B\u044F\u043D\u043A\u0443 \u0434\u043B\u044F \u0431\u0443\u0434\u0456\u0432\u043D\u0438\u0446\u0442\u0432\u0430",uk:"Select an empty tile to build"},DAMAGE_STATS:{en:"Damage Statistics",uk:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 \u0443\u0440\u043E\u043D\u0443"},NO_DATA:{en:"No data yet",uk:"\u0414\u0430\u043D\u0456 \u0432\u0456\u0434\u0441\u0443\u0442\u043D\u0456"},DAMAGE_STATS_DESC:{en:"Cumulative damage dealt by each tower type",uk:"\u0421\u0443\u043C\u0430\u0440\u043D\u0438\u0439 \u0443\u0440\u043E\u043D \u0437\u0430 \u0442\u0438\u043F\u0430\u043C\u0438 \u0432\u0435\u0436"},RANDOM:{en:"Random",uk:"\u0412\u0438\u043F\u0430\u0434\u043A\u043E\u0432\u0438\u0439"},STRONGEST:{en:"Strongest",uk:"\u041D\u0430\u0439\u0441\u0438\u043B\u044C\u043D\u0456\u0448\u0438\u0439"},WEAKEST:{en:"Weakest",uk:"\u041D\u0430\u0439\u0441\u043B\u0430\u0431\u0448\u0438\u0439"},FIRST:{en:"First",uk:"\u041F\u0435\u0440\u0448\u0438\u0439"},SPEED:{en:"Speed",uk:"\u0428\u0432\u0438\u0434\u043A\u0456\u0441\u0442\u044C"},TARGETING:{en:"Targeting",uk:"\u0422\u0430\u0440\u0433\u0435\u0442\u0438\u043D\u0433"},SOCIAL_FEEDBACK:{en:"Social & Feedback",uk:"\u0421\u043E\u0446\u0456\u0430\u043B\u044C\u043D\u0456 \u043C\u0435\u0440\u0435\u0436\u0456 \u0442\u0430 \u0437\u0432\u043E\u0440\u043E\u0442\u043D\u0438\u0439 \u0437\u0432'\u044F\u0437\u043E\u043A"},MONOBANK_JAR:{en:"Monobank Jar",uk:"\u0411\u0430\u043D\u043A\u0430 Monobank"},SUPPORT_COMMUNITY:{en:"Support & Community",uk:"\u041F\u0456\u0434\u0442\u0440\u0438\u043C\u043A\u0430 \u0442\u0430 \u0441\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0430"},COPY_LINK:{en:"Copy Link",uk:"\u041A\u043E\u043F\u0456\u044E\u0432\u0430\u0442\u0438 \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F"},OPEN_LINK:{en:"Open Link",uk:"\u0412\u0456\u0434\u043A\u0440\u0438\u0442\u0438 \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F"},THANK_SUPPORTING:{en:"Thank you for supporting the project!",uk:"\u0414\u044F\u043A\u0443\u044E \u0437\u0430 \u043F\u0456\u0434\u0442\u0440\u0438\u043C\u043A\u0443 \u043F\u0440\u043E\u0454\u043A\u0442\u0443!"},MASTERIES:{en:"Masteries",uk:"\u0412\u043C\u0456\u043D\u043D\u044F"},GOLD_MASTERY:{en:"Gold Mastery",uk:"\u0417\u043E\u043B\u043E\u0442\u0430 \u043C\u0430\u0439\u0441\u0442\u0435\u0440\u043D\u0456\u0441\u0442\u044C"},GOLD_MASTERY_INFO:{en:"Lv 1-7: +5% gold per kill. Lv 8-14: +10% per kill and extra starting gold. Lv 15-20: higher gold and bonus after each wave.",uk:"\u0420\u0456\u0432\u043D\u0456 1-7: +5% \u0437\u043E\u043B\u043E\u0442\u0430 \u0437\u0430 \u0432\u0431\u0438\u0432\u0441\u0442\u0432\u043E. \u0420\u0456\u0432\u043D\u0456 8-14: +10% \u0437\u0430 \u0432\u0431\u0438\u0432\u0441\u0442\u0432\u043E \u0442\u0430 \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0435 \u043F\u043E\u0447\u0430\u0442\u043A\u043E\u0432\u0435 \u0437\u043E\u043B\u043E\u0442\u043E. \u0420\u0456\u0432\u043D\u0456 15-20: \u0431\u0456\u043B\u044C\u0448\u0435 \u0437\u043E\u043B\u043E\u0442\u0430 \u0442\u0430 \u0431\u043E\u043D\u0443\u0441 \u043F\u0456\u0441\u043B\u044F \u043A\u043E\u0436\u043D\u043E\u0457 \u0445\u0432\u0438\u043B\u0456."},BACK_TO_DEFENSE:{en:"Back to Defense",uk:"\u041D\u0430\u0437\u0430\u0434 \u0434\u043E \u0437\u0430\u0445\u0438\u0441\u0442\u0443"},TOTAL_XP:{en:"XP",uk:"\u0414\u043E\u0441\u0432\u0456\u0434"},SPENT:{en:"Spent",uk:"\u0412\u0438\u0442\u0440\u0430\u0447\u0435\u043D\u043E"},AVAILABLE:{en:"Available",uk:"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E"},LOG_IN_MASTERY_MSG:{en:"Log in to earn and spend Mastery XP.",uk:"\u0423\u0432\u0456\u0439\u0434\u0456\u0442\u044C, \u0449\u043E\u0431 \u0437\u0430\u0440\u043E\u0431\u043B\u044F\u0442\u0438 \u0442\u0430 \u0432\u0438\u0442\u0440\u0430\u0447\u0430\u0442\u0438 \u0434\u043E\u0441\u0432\u0456\u0434 \u043C\u0430\u0439\u0441\u0442\u0435\u0440\u043D\u043E\u0441\u0442\u0456."},NEED_LOG_IN:{en:"You need to be logged in to earn XP and unlock Masteries.",uk:"\u0412\u0430\u043C \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E \u0443\u0432\u0456\u0439\u0442\u0438, \u0449\u043E\u0431 \u0437\u0430\u0440\u043E\u0431\u043B\u044F\u0442\u0438 \u0434\u043E\u0441\u0432\u0456\u0434 \u0442\u0430 \u0432\u0456\u0434\u043A\u0440\u0438\u0432\u0430\u0442\u0438 \u0412\u043C\u0456\u043D\u043D\u044F."},LOGIN_GOOGLE:{en:"Login with Google",uk:"\u0423\u0432\u0456\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Google"},MASTERIES_SUBTITLE:{en:"Spend points to permanently improve each tower tier.",uk:"\u0412\u0438\u0442\u0440\u0430\u0447\u0430\u0439\u0442\u0435 \u043E\u0447\u043A\u0438, \u0449\u043E\u0431 \u043D\u0430\u0437\u0430\u0432\u0436\u0434\u0438 \u043F\u043E\u043A\u0440\u0430\u0449\u0438\u0442\u0438 \u043A\u043E\u0436\u0435\u043D \u0442\u0438\u0440 \u0432\u0435\u0436."},DAMAGE:{en:"Damage",uk:"\u0428\u043A\u043E\u0434\u0430"},RANGE:{en:"Range",uk:"\u0414\u0430\u043B\u044C\u043D\u0456\u0441\u0442\u044C"},PER_LEVEL:{en:"per level",uk:"\u0437\u0430 \u0440\u0456\u0432\u0435\u043D\u044C"},REQUIRES_5_POINTS:{en:"Requires 15 points in tier.",uk:"\u041F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 15 \u043E\u0447\u043E\u043A \u0432 \u0442\u0438\u0440\u0456"},SAVE_CHANGES:{en:"Save Changes",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u043C\u0456\u043D\u0438"},SAVING:{en:"Saving...",uk:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043D\u044F..."},SAVED:{en:"Saved",uk:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E"},COST:{en:"Cost",uk:"\u0412\u0430\u0440\u0442\u0456\u0441\u0442\u044C"},MAXED:{en:"MAXED",uk:"\u041C\u0410\u041A\u0421"},LOCAL_STORAGE_MSG:{en:"Changes are stored locally until you save.",uk:"\u0417\u043C\u0456\u043D\u0438 \u0437\u0431\u0435\u0440\u0456\u0433\u0430\u044E\u0442\u044C\u0441\u044F \u043B\u043E\u043A\u0430\u043B\u044C\u043D\u043E, \u043F\u043E\u043A\u0438 \u0432\u0438 \u0457\u0445 \u043D\u0435 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u0442\u0435."},T1_NAME:{en:"Tier 1 \u2013 Frost",uk:"\u0422\u0438\u0440 1 \u2013 \u041C\u043E\u0440\u043E\u0437"},T1_GOLDEN_TITLE:{en:"Frost Aura",uk:"\u0410\u0443\u0440\u0430 \u043C\u043E\u0440\u043E\u0437\u0443"},T1_GOLDEN_DESC:{en:"Slow enemies by an extra 10% and increase aura radius.",uk:"\u0423\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u043D\u0430 \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 10% \u0442\u0430 \u0437\u0431\u0456\u043B\u044C\u0448\u0443\u0454 \u0440\u0430\u0434\u0456\u0443\u0441 \u0430\u0443\u0440\u0438."},T2_NAME:{en:"Tier 2 \u2013 Precision",uk:"\u0422\u0438\u0440 2 \u2013 \u0422\u043E\u0447\u043D\u0456\u0441\u0442\u044C"},T2_GOLDEN_TITLE:{en:"Critical Focus",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0435 \u0444\u043E\u043A\u0443\u0441\u0443\u0432\u0430\u043D\u043D\u044F"},T2_GOLDEN_DESC:{en:"Boosts Ricochet: higher trigger chance and up to 150%+ damage.",uk:"\u041F\u0456\u0434\u0441\u0438\u043B\u044E\u0454 \u0440\u0438\u043A\u043E\u0448\u0435\u0442: \u0432\u0438\u0449\u0438\u0439 \u0448\u0430\u043D\u0441 \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0442\u0430 \u0434\u043E 150%+ \u0448\u043A\u043E\u0434\u0438."},T3_NAME:{en:"Tier 3 \u2013 Impact",uk:"\u0422\u0438\u0440 3 \u2013 \u0423\u0434\u0430\u0440"},T3_GOLDEN_TITLE:{en:"Concussive Blasts",uk:"\u041A\u043E\u043D\u0442\u0443\u0437\u0456\u0439\u043D\u0456 \u0432\u0438\u0431\u0443\u0445\u0438"},T3_GOLDEN_DESC:{en:"Concussive blasts: stronger stun chance and duration on shattered foes.",uk:"\u041A\u043E\u043D\u0442\u0443\u0437\u0456\u0439\u043D\u0456 \u0432\u0438\u0431\u0443\u0445\u0438: \u0432\u0438\u0449\u0438\u0439 \u0448\u0430\u043D\u0441 \u0456 \u0442\u0440\u0438\u0432\u0430\u043B\u0456\u0441\u0442\u044C \u043E\u0433\u043B\u0443\u0448\u0435\u043D\u043D\u044F \u0440\u043E\u0437\u0431\u0438\u0442\u0438\u0445 \u0432\u043E\u0440\u043E\u0433\u0456\u0432."},T4_NAME:{en:"Tier 4 \u2013 Storm",uk:"\u0422\u0438\u0440 4 \u2013 \u0428\u0442\u043E\u0440\u043C"},T4_GOLDEN_TITLE:{en:"Chain Lightning",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430"},T4_GOLDEN_DESC:{en:"Chance to chain attack and strike an additional target.",uk:"\u0428\u0430\u043D\u0441 \u043D\u0430 \u043B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0443 \u0430\u0442\u0430\u043A\u0443 \u043F\u043E \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456\u0439 \u0446\u0456\u043B\u0456."},T5_NAME:{en:"Tier 5 \u2013 Inferno",uk:"\u0422\u0438\u0440 5 \u2013 \u0406\u043D\u0444\u0435\u0440\u043D\u043E"},T5_GOLDEN_TITLE:{en:"Chain Reaction",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0440\u0435\u0430\u043A\u0446\u0456\u044F"},T5_GOLDEN_DESC:{en:"Kills from Inferno or Napalm cause explosions for 50% of max HP.",uk:"\u0423\u0431\u0438\u0432\u0441\u0442\u0432\u0430 \u0432\u0456\u0434 \u0406\u043D\u0444\u0435\u0440\u043D\u043E \u0447\u0438 \u043D\u0430\u043F\u0430\u043B\u043C\u0443 \u0441\u043F\u0440\u0438\u0447\u0438\u043D\u044F\u044E\u0442\u044C \u0432\u0438\u0431\u0443\u0445\u0438 \u043D\u0430 50% \u0432\u0456\u0434 \u043C\u0430\u043A\u0441. HP."},T6_NAME:{en:"Tier 6 \u2013 Prism",uk:"\u0422\u0438\u0440 6 \u2013 \u041F\u0440\u0438\u0437\u043C\u0430"},T6_GOLDEN_TITLE:{en:"Spectrum Break",uk:"\u0421\u043F\u0435\u043A\u0442\u0440\u0430\u043B\u044C\u043D\u0438\u0439 \u0440\u043E\u0437\u043B\u043E\u043C"},T6_GOLDEN_DESC:{en:"Increases ramp-up cap to +300% and adds +15% taken damage.",uk:"\u041F\u0456\u0434\u0432\u0438\u0449\u0443\u0454 \u043B\u0456\u043C\u0456\u0442 \u043D\u0430\u0440\u043E\u0449\u0435\u043D\u043D\u044F \u0434\u043E +300% \u0442\u0430 \u0434\u043E\u0434\u0430\u0454 +15% \u043E\u0442\u0440\u0438\u043C\u0443\u0432\u0430\u043D\u043E\u0457 \u0448\u043A\u043E\u0434\u0438."},T7_NAME:{en:"Tier 7 \u2013 Venom",uk:"\u0422\u0438\u0440 7 \u2013 \u041E\u0442\u0440\u0443\u0442\u0430"},T7_GOLDEN_TITLE:{en:"Septic Shock",uk:"\u0421\u0435\u043F\u0442\u0438\u0447\u043D\u0438\u0439 \u0448\u043E\u043A"},T7_GOLDEN_DESC:{en:"Neurotoxin causes stronger slow and heavier stacking poison over time.",uk:"\u041D\u0435\u0439\u0440\u043E\u0442\u043E\u043A\u0441\u0438\u043D \u0441\u0438\u043B\u044C\u043D\u0456\u0448\u0435 \u0441\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0442\u0430 \u043F\u043E\u0441\u0438\u043B\u044E\u0454 \u043D\u0430\u043A\u043E\u043F\u0438\u0447\u0435\u043D\u043D\u044F \u043E\u0442\u0440\u0443\u0442\u0438 \u0437 \u0447\u0430\u0441\u043E\u043C."},FINAL_STRIKE_INFO:{en:"Execute: Crit on enemies below 50% HP. Bosses take even more damage.",uk:"\u0415\u043A\u0437\u0435\u043A\u0443\u0446\u0456\u044F: \u043A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0443\u0434\u0430\u0440 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0430\u0445 \u0437 HP \u043D\u0438\u0436\u0447\u0435 50%. \u0411\u043E\u0441\u0438 \u043E\u0442\u0440\u0438\u043C\u0443\u044E\u0442\u044C \u0449\u0435 \u0431\u0456\u043B\u044C\u0448\u0435 \u0448\u043A\u043E\u0434\u0438."},FINAL_STRIKE:{en:"Final Strike",uk:"\u041E\u0441\u0442\u0430\u043D\u043D\u0456\u0439 \u0443\u0434\u0430\u0440"},SHATTER_INFO:{en:"Each hit adds 1 stack (Max 5). Damage is multiplied by (1 + stacks * 0.20). (Stack up to +100% dmg).",uk:"\u041A\u043E\u0436\u0435\u043D \u0443\u0434\u0430\u0440 \u0434\u043E\u0434\u0430\u0454 1 \u0437\u0430\u0440\u044F\u0434 (\u043C\u0430\u043A\u0441\u0438\u043C\u0443\u043C 5). \u0428\u043A\u043E\u0434\u0430 \u043C\u043D\u043E\u0436\u0438\u0442\u044C\u0441\u044F \u043D\u0430 (1 + \u0437\u0430\u0440\u044F\u0434\u0438 * 0.20). (\u041D\u0430\u043A\u043E\u043F\u0438\u0447\u0443\u0454\u0442\u044C\u0441\u044F \u0434\u043E +100% \u0448\u043A\u043E\u0434\u0438)."},SHATTER:{en:"Shatter",uk:"\u0420\u043E\u0437\u043A\u043E\u043B\u043E\u0442\u0438"},CHAIN_LIGHTNING_INFO:{en:"Chance for shots to ricochet and deal up to 150% damage to nearby enemies.",uk:"\u0428\u0430\u043D\u0441 \u0440\u0438\u043A\u043E\u0448\u0435\u0442\u0443 \u043F\u043E\u0441\u0442\u0440\u0456\u043B\u0443 \u0442\u0430 \u043D\u0430\u043D\u0435\u0441\u0435\u043D\u043D\u044F \u0434\u043E 150% \u0448\u043A\u043E\u0434\u0438 \u0441\u0443\u0441\u0456\u0434\u043D\u0456\u043C \u0432\u043E\u0440\u043E\u0433\u0430\u043C."},CHAIN_LIGHTNING:{en:"Chain Lightning",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430"},FROST_AURA_INFO:{en:"Apply 30% slow to enemies in range.",uk:"\u0423\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u0443 \u0440\u0430\u0434\u0456\u0443\u0441\u0456 \u0434\u0456\u0457 \u043D\u0430 30%."},FROST_AURA:{en:"Frost Aura",uk:"\u041C\u043E\u0440\u043E\u0437\u043D\u0430 \u0430\u0443\u0440\u0430"},REFRACTION_BEAM:{en:"Refraction Beam",uk:"\u0417\u0430\u043B\u043E\u043C\u043B\u0435\u043D\u043D\u044F \u043F\u0440\u043E\u043C\u0435\u043D\u044F"},REFRACTION_BEAM_INFO:{en:"Allows attacking up to 3 targets simultaneously. Each beam benefits from the laser ramp-up bonus.",uk:"\u0414\u043E\u0437\u0432\u043E\u043B\u044F\u0454 \u0430\u0442\u0430\u043A\u0443\u0432\u0430\u0442\u0438 \u0434\u043E 3 \u0446\u0456\u043B\u0435\u0439 \u043E\u0434\u043D\u043E\u0447\u0430\u0441\u043D\u043E. \u041A\u043E\u0436\u043D\u0430 \u0446\u0456\u043B\u044C \u043E\u0442\u0440\u0438\u043C\u0443\u0454 \u0431\u043E\u043D\u0443\u0441 \u0432\u0456\u0434 \u043D\u0430\u0440\u043E\u0441\u0442\u0430\u043D\u043D\u044F \u043F\u043E\u0442\u0443\u0436\u043D\u043E\u0441\u0442\u0456 \u043B\u0430\u0437\u0435\u0440\u0430."},NAPALM_STRIKE:{en:"\u041D\u0430\u043F\u0430\u043B\u043C\u043E\u0432\u0438\u0439 \u0443\u0434\u0430\u0440",uk:"\u041D\u0430\u043F\u0430\u043B\u043C\u043E\u0432\u0438\u0439 \u0443\u0434\u0430\u0440"},NAPALM_STRIKE_INFO:{en:"Leaves a fire zone for 4s, dealing 50% tower damage per second to all enemies in the blast radius.",uk:"\u0417\u0430\u043B\u0438\u0448\u0430\u0454 \u0432\u043E\u0433\u043D\u044F\u043D\u0443 \u0437\u043E\u043D\u0443 \u043D\u0430 4 \u0441\u0435\u043A., \u0449\u043E \u043D\u0430\u043D\u043E\u0441\u0438\u0442\u044C 50% \u0443\u0440\u043E\u043D\u0443 \u0449\u043E\u0441\u0435\u043A\u0443\u043D\u0434\u0438 \u0432\u0441\u0456\u043C \u0432\u043E\u0440\u043E\u0433\u0430\u043C \u0443 \u0440\u0430\u0434\u0456\u0443\u0441\u0456 \u0432\u0438\u0431\u0443\u0445\u0443."},NEUROTOXIN:{en:"Neurotoxin",uk:"\u041D\u0435\u0439\u0440\u043E\u0442\u043E\u043A\u0441\u0438\u043D"},NEUROTOXIN_INFO:{en:"Poison now slows enemies by 20%.",uk:"\u041E\u0442\u0440\u0443\u0442\u0430 \u0442\u0435\u043F\u0435\u0440 \u0443\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u043D\u0430 20%."},BUY_ABILITY:{en:"Buy Ability",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0434\u0456\u0431\u043D\u0456\u0441\u0442\u044C"},ABILITY_ACTIVE:{en:"Ability Active",uk:"\u0410\u043A\u0442\u0438\u0432\u043D\u0430 \u0437\u0434\u0430\u0442\u043D\u0456\u0441\u0442\u044C"},TRY_AGAIN:{en:"TRY AGAIN",uk:"\u0421\u041F\u0420\u041E\u0411\u0423\u0419\u0422\u0415 \u0417\u041D\u041E\u0412\u0423"},WAVES:{en:"waves",uk:"\u0445\u0432\u0438\u043B\u044C"},YOU_SURVIVED:{en:"You survived",uk:"\u0422\u0438 \u0432\u0438\u0436\u0438\u0432"},GAME_OVER:{en:"GAME OVER",uk:"\u0413\u0420\u0410 \u0417\u0410\u041A\u0406\u041D\u0427\u0415\u041D\u0410"},TO_PLACE_DEFENDER:{en:"to place a defender",uk:"\u0449\u043E\u0431 \u0440\u043E\u0437\u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},SELECT_BUILD_TILE:{en:"Select a buildable tile",uk:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u0431\u0443\u0434\u0456\u0432\u043D\u0438\u0446\u0442\u0432\u0430,"},SELL:{en:"SELL",uk:"\u041F\u0420\u041E\u0414\u0410\u0422\u0418"},MAX_LEVEL:{en:"MAX LEVEL",uk:"\u041C\u0410\u041A\u0421 \u0420\u0406\u0412\u0415\u041D\u042C"},UPGRADE:{en:"UPGRADE",uk:"\u041E\u041D\u041E\u0412\u041B\u0415\u041D\u041D\u042F"},TIER:{en:"Tier",uk:"\u0420\u0430\u043D\u0433"},LEVEL:{en:"Level",uk:"\u0420\u0456\u0432\u0435\u043D\u044C"},DEFENDER_INFO:{en:"Defender Info",uk:"\u0406\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044F \u043F\u0440\u043E \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},BUY_DEFENDER:{en:"Buy Defender",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},START_WAVE:{en:"START WAVE",uk:"\u041F\u041E\u0427\u0410\u0422\u041E\u041A \u0425\u0412\u0418\u041B\u0406"},WAVE_IN_PROGRESS:{en:"WAVE IN PROGRESS",uk:"\u0425\u0412\u0418\u041B\u042F \u0412 \u041F\u0420\u041E\u0426\u0415\u0421\u0406"},RESTART_GAME:{en:"RESTART GAME",uk:"\u041F\u0415\u0420\u0415\u0417\u0410\u041F\u0423\u0421\u041A \u0413\u0420\u0418"},WAVE:{en:"WAVE",uk:"\u0425\u0412\u0418\u041B\u042F"},LIVES:{en:"LIVES",uk:"\u0416\u0418\u0422\u0422\u042F"},MONEY:{en:"MONEY",uk:"\u0413\u0420\u041E\u0428\u0406"},EXIT_GAME:{en:"EXIT GAME",uk:"\u0412\u0418\u0425\u0406\u0414 \u0417 \u0413\u0420\u0418"},TOWER_DEFFENCE_DESCRIPTION:{en:"A new game is already in development. Stay tuned for a completely different strategy experience. Coming soon to Game Center.",uk:"\u041D\u043E\u0432\u0430 \u0433\u0440\u0430 \u0432\u0436\u0435 \u0440\u043E\u0437\u0440\u043E\u0431\u043B\u044F\u0454\u0442\u044C\u0441\u044F. \u0421\u043B\u0456\u0434\u043A\u0443\u0439\u0442\u0435 \u0437\u0430 \u043E\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044F\u043C\u0438, \u0449\u043E\u0431 \u0434\u0456\u0437\u043D\u0430\u0442\u0438\u0441\u044F \u043F\u0440\u043E \u0437\u043E\u0432\u0441\u0456\u043C \u0456\u043D\u0448\u0438\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u0434\u043E\u0441\u0432\u0456\u0434. \u0421\u043A\u043E\u0440\u043E \u0432 \u0456\u0433\u0440\u043E\u0432\u043E\u043C\u0443 \u0446\u0435\u043D\u0442\u0440\u0456."},SHAPE_TACTIC_DESCRIPTION:{en:"Strategic turn-based combat with AI and merging mechanics. Build your base, manage resources, and conquer the battlefield.",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u043F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0438\u0439 \u0431\u0456\u0439 \u0437\u0456 \u0448\u0442\u0443\u0447\u043D\u0438\u043C \u0456\u043D\u0442\u0435\u043B\u0435\u043A\u0442\u043E\u043C \u0442\u0430 \u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0438\u043C\u0438 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0430\u043C\u0438. \u041F\u043E\u0431\u0443\u0434\u0443\u0439\u0442\u0435 \u0441\u0432\u043E\u044E \u0431\u0430\u0437\u0443, \u043A\u0435\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043C\u0438 \u0442\u0430 \u0437\u0430\u0432\u043E\u0439\u043E\u0432\u0443\u0439\u0442\u0435 \u043F\u043E\u043B\u0435 \u0431\u043E\u044E."},IRON_CYCLE:{en:"Iron Cycle",uk:"\u0426\u0438\u043A\u043B \u0417\u0430\u043B\u0456\u0437\u0430"},NEW_DESIGN_UNIT:{en:"New Evolution",uk:"\u041D\u043E\u0432\u0430 \u0435\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},NEW_UNIT_EVOLUTION:{en:"New Unit Evolution",uk:"\u041D\u043E\u0432\u0430 \u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},T4_4_TILES:{en:"T4: 4 tiles",uk:"T4: 4 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},TURN_3:{en:"Turn 3",uk:"\u0425\u0456\u0434 3"},TURN_4:{en:"Turn 4",uk:"\u0425\u0456\u0434 4"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0414\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},PLUS_2_IRON_PER_TURN:{en:"+2 Iron/turn",uk:"+2 \u0417\u0430\u043B\u0456\u0437\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function rR(n,e){let t=gj[n];return t?t[e]??t.en:n}var gt=class n{difficultySignal=$("normal");mapSizeSignal=$(10);langSignal=$("uk");customModeSignal=$(!1);version="v.2.5.7";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),i=e%2===0;return t==="baby"?i?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return rR(e,this.langSignal())}customMode(){return this.customModeSignal()}setCustomMode(e){this.customModeSignal.set(e),this.persistSettings()}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let i=["baby","normal","hard","nightmare"],r=[10,20,30],o=["en","uk"],s=t.difficulty&&i.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&r.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),l=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(l),this.customModeSignal.set(!!t.customMode)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal(),customMode:this.customModeSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vg=class n{generateForests(e,t,i){let r=e*e,o=Math.max(1,Math.floor(r*.1)),s=[],a=(l,c)=>{let d=Math.max(Math.abs(l-t.x),Math.abs(c-t.y)),h=Math.max(Math.abs(l-i.x),Math.abs(c-i.y));return d<=3||h<=3};for(;s.length<o;){let l=Math.floor(Math.random()*e),c=Math.floor(Math.random()*e);a(l,c)||s.some(d=>d.x===l&&d.y===c)||s.push({x:l,y:c})}return s}generateMines(e,t,i,r){let o=new Set(r.map(c=>`${c.x},${c.y}`)),s=e===10?4:Math.max(1,Math.floor(e*e*.04)),a=[],l=(c,d)=>{let h=Math.max(Math.abs(c-t.x),Math.abs(d-t.y)),f=Math.max(Math.abs(c-i.x),Math.abs(d-i.y));return h<=3||f<=3};for(;a.length<s;){let c=Math.floor(Math.random()*e),d=Math.floor(Math.random()*e);if(l(c,d))continue;let h=`${c},${d}`;o.has(h)||a.some(f=>f.x===c&&f.y===d)||a.push({x:c,y:d})}return a}computeVisibility(e,t,i,r,o){let s={player:new Set,ai:new Set},a=(d,h)=>d>=0&&d<e&&h>=0&&h<e,l=(d,h,f)=>{a(h,f)&&d.add(`${h},${f}`)},c=(d,h,f)=>{for(let m=-f;m<=f;m++)for(let w=-f;w<=f;w++){let S=h.x+m,k=h.y+w;Math.max(Math.abs(m),Math.abs(w))<=f&&l(d,S,k)}};if(o){for(let d=0;d<e;d++)for(let h=0;h<e;h++)s.player.add(`${d},${h}`),s.ai.add(`${d},${h}`);return s}c(s.player,i,3),c(s.ai,r,3);for(let d of t){let h=d.owner==="player"?s.player:s.ai;c(h,d.position,2)}return s}mergeExplored(e,t){let i=new Set(e);return t.forEach(r=>i.add(r)),i}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ug=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let i of t)if(e>=i)return i;return 0}computeWoodGain(e,t){let i=e.filter(r=>r.owner===t).filter(r=>r.position&&r.position.x!==void 0&&r.position.y!==void 0).length;return i>0?i*2:0}applyMonopolyTick(e,t,i){let r=t.length;if(r===0)return{next:{player:0,ai:0}};let o=c=>i.filter(d=>d.owner===c&&t.some(h=>h.x===d.position.x&&h.y===d.position.y)).length,s=o("player"),a=o("ai"),l={player:e.player,ai:e.ai};if(s===r){if(l.player=e.player+1,l.ai=0,l.player>=10)return{next:l,winner:"player"}}else if(a===r){if(l.ai=e.ai+1,l.player=0,l.ai>=10)return{next:l,winner:"ai"}}else l.player=0,l.ai=0;return{next:l}}computeAiReserveDump(e,t,i,r){let o=i,s=[];for(let l=-2;l<=2;l++)for(let c=-2;c<=2;c++){if(l===0&&c===0)continue;let d=t.x+l,h=t.y+c;d<0||d>=e||h<0||h>=e||Math.max(Math.abs(l),Math.abs(c))>2||r(d,h)||s.push({x:d,y:h})}let a=[];for(;o>0&&s.length>0;){let l=this.getHighestAffordableCost(o);if(l<=0)break;let c=this.calculateTierAndLevel(l),d=s.shift();a.push({id:crypto.randomUUID(),position:F({},d),level:c.level,tier:c.tier,points:l,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=l}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Bg=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(b=>b.owner==="ai"&&!b.hasActed);t=t.filter(b=>!(b.tier<=2&&e.isForest(b.position.x,b.position.y)&&e.isAnchoredGatherer(b.id)));let i=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;i&&(t=t.filter(b=>b.id===i));let r=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:r==="rage"?5e4:r==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),l=e.forestsSignal(),d=l.filter(b=>!e.getUnitAt(b.x,b.y)).filter(b=>e.isVisibleToAi(b.x,b.y)),h=l.filter(b=>!e.isVisibleToAi(b.x,b.y)),f=e.unitsSignal().filter(b=>b.owner==="ai"&&e.isForest(b.position.x,b.position.y)).length,m=e.unitsSignal().filter(b=>b.owner==="ai").length,w=[1,2,3].some(b=>e.unitsSignal().filter(ue=>ue.owner==="ai"&&ue.tier===b&&!e.isForest(ue.position.x,ue.position.y)).length>=5),S=e.unitsSignal().filter(b=>b.owner==="player"),k=S.some(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3),V=S.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=4),q=V.length>0,ve=V.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=2).length>0,xe=S.some(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=5),Ae=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,O=e.unitsSignal().filter(b=>b.owner==="ai"),T=O.filter(b=>b.tier===3&&!e.isForest(b.position.x,b.position.y)).length,P=O.filter(b=>b.tier===4&&!e.isForest(b.position.x,b.position.y)).length,I=T+P>=5,x=I?"full_rush":q?"defense":Ae?"expansion":"none";if(x!==this.lastPhase){try{console.log(x==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":x==="defense"?"AI Phase: Base Defense Activated":x==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=x}I&&t.sort((b,ue)=>{let qe=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ke=Math.abs(ue.position.x-a.x)+Math.abs(ue.position.y-a.y);return qe-Ke});let R=typeof e.aggressionMode=="function"?!!e.aggressionMode():S.filter(b=>e.isForest(b.position.x,b.position.y)).length*2>=t.filter(b=>e.isForest(b.position.x,b.position.y)).length*2,M=l.length>0?l.every(b=>{let ue=e.getUnitAt(b.x,b.y);return!!ue&&ue.owner==="ai"}):!0,ae=l.length>0?l.every(b=>!!e.getUnitAt(b.x,b.y)):!1,be=l.filter(b=>{let ue=e.getUnitAt(b.x,b.y);return!!ue&&ue.owner==="player"}),de=null,Tt=t.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3).length,Xt={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Ne=V.length>0?V.reduce((b,ue)=>{let qe=Math.max(Math.abs(ue.position.x-s.x),Math.abs(ue.position.y-s.y)),Ke=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y));return qe<Ke?ue:b},V[0]):null,Wt=t.length>0?t.reduce((b,ue)=>this.combat.calculateTotalPoints(ue)>this.combat.calculateTotalPoints(b)?ue:b,t[0]):null,lt=[];if(Ne){let b=Ne.position.x,ue=Ne.position.y,qe=Math.sign(s.x-b),Ke=Math.sign(s.y-ue),le=0,wt=Math.max(10,e.gridSize*2);for(;b!==s.x||ue!==s.y;){if(le++,le>wt){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(b+=qe,ue+=Ke,!e.inBounds(b,ue)||b===s.x&&ue===s.y)break;lt.push({x:b,y:ue})}}q&&Wt&&Ne&&(this.goals.set(Wt.id,{x:Ne.position.x,y:Ne.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(Wt.id,e.turnSignal()+3));let oe=new Map(e.aiUnitTimeNearBase()),se=new Map(e.unitStutterBanSignal?.()??new Map),Ie=new Map;for(let[b,ue]of this.goals.entries())if(ue&&e.isForest(ue.x,ue.y)){let qe=`${ue.x},${ue.y}`;Ie.set(qe,(Ie.get(qe)||0)+1)}for(let b of t){let ue=e.calculateValidMoves(b),qe=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3,Ke=oe.get(b.id)||0,le=this.goals.get(b.id)||null,wt=le!==null,Ci=wt?(()=>{let z=e.getUnitAt(le.x,le.y);return!!(z&&z.owner==="ai"&&this.combat.calculateTotalPoints(z)>=this.combat.calculateTotalPoints(b))})():!1,li=(!wt||Ci)&&(!e.isForest(b.position.x,b.position.y)||xe||b.tier>=3),Ps=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(li){if(Ps)le={x:a.x,y:a.y};else if(e.isForest(b.position.x,b.position.y)){let z=S.filter(U=>e.isForest(U.position.x,U.position.y));if(R&&z.length>0){let U=z.reduce((te,ne)=>{let Me=Math.abs(b.position.x-ne.position.x)+Math.abs(b.position.y-ne.position.y),Ve=Math.abs(b.position.x-te.position.x)+Math.abs(b.position.y-te.position.y);return Me<Ve?ne:te},z[0]);le={x:U.position.x,y:U.position.y}}else{let U=S.length===0?null:[...S].sort((ne,Me)=>{let Ve=Math.abs(b.position.x-ne.position.x)+Math.abs(b.position.y-ne.position.y),et=Math.abs(b.position.x-Me.position.x)+Math.abs(b.position.y-Me.position.y);return Ve-et})[0];U?le={x:U.position.x,y:U.position.y}:d.length>0?le=d.reduce((te,ne)=>Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)<Math.abs(b.position.x-te.x)+Math.abs(b.position.y-te.y)?ne:te,d[0]):h.length>0?le=h.reduce((te,ne)=>Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)<Math.abs(b.position.x-te.x)+Math.abs(b.position.y-te.y)?ne:te,h[0]):le={x:0,y:0}}}else{let z=S.filter(U=>e.isForest(U.position.x,U.position.y)).map(U=>({x:U.position.x,y:U.position.y}));if(z.length>0)le=z.reduce((te,ne)=>{let Me=Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y),Ve=Math.abs(b.position.x-te.x)+Math.abs(b.position.y-te.y);return Me<Ve?ne:te},z[0]);else if(d.length>0){let U=Math.min(...d.map(ne=>Ie.get(`${ne.x},${ne.y}`)||0)),te=d.filter(ne=>(Ie.get(`${ne.x},${ne.y}`)||0)===U);le=te.reduce((ne,Me)=>Math.abs(b.position.x-Me.x)+Math.abs(b.position.y-Me.y)<Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)?Me:ne,te[0])}else if(h.length>0){let U=Math.min(...h.map(ne=>Ie.get(`${ne.x},${ne.y}`)||0)),te=h.filter(ne=>(Ie.get(`${ne.x},${ne.y}`)||0)===U);le=te.reduce((ne,Me)=>Math.abs(b.position.x-Me.x)+Math.abs(b.position.y-Me.y)<Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)?Me:ne,te[0])}else{let U=S.length===0?null:[...S].sort((ne,Me)=>{let Ve=Math.abs(b.position.x-ne.position.x)+Math.abs(b.position.y-ne.position.y),et=Math.abs(b.position.x-Me.position.x)+Math.abs(b.position.y-Me.position.y);return Ve-et})[0];le=U?{x:U.position.x,y:U.position.y}:{x:0,y:0}}}this.goals.set(b.id,le)}Tt>3&&Ke>=5&&(le=Xt);let zn=e.isForest(b.position.x,b.position.y),kc=zn&&(b.forestOccupationTurns??0)>0&&!(b.productionActive??!1),Nc=e.unitsSignal().some(z=>z.owner==="ai"&&z.id!==b.id&&z.tier<=2&&Math.max(Math.abs(z.position.x-b.position.x),Math.abs(z.position.y-b.position.y))<=2);if(kc&&!xe&&b.tier<3){this.goals.set(b.id,{x:b.position.x,y:b.position.y});continue}if(b.tier>=3){let z=l,U=z.length?z.reduce((ne,Me)=>{let Ve=Math.abs(b.position.x-Me.x)+Math.abs(b.position.y-Me.y),et=Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y);return Ve<et?Me:ne},z[0]):null;if((b.forestOccupationTurns??0)===0&&!zn&&U&&(le={x:U.x,y:U.y},this.goals.set(b.id,le)),zn&&Nc){this.goals.set(b.id,{x:a.x,y:a.y});let ne=[{x:b.position.x+1,y:b.position.y},{x:b.position.x-1,y:b.position.y},{x:b.position.x,y:b.position.y+1},{x:b.position.x,y:b.position.y-1}].filter(Ve=>e.inBounds(Ve.x,Ve.y));if(ne.filter(Ve=>!!e.getWallBetween(b.position.x,b.position.y,Ve.x,Ve.y)).length===ne.length){let Ve=ne.reduce((et,dt)=>{let xt=Math.abs(dt.x-a.x)+Math.abs(dt.y-a.y),yt=Math.abs(et.x-a.x)+Math.abs(et.y-a.y);return xt<yt?dt:et});de={unit:b,target:{x:b.position.x,y:b.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:F({},b.position),to:Ve}};continue}}}if(ue.some(z=>z.x===a.x&&z.y===a.y)){let z=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,U=5e7+o+z;(de===null||U>de.score)&&(de={unit:b,target:{x:a.x,y:a.y},score:U,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let z=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(U=>e.inBounds(U.x,U.y));for(let U of z){let te=e.getWallBetween(a.x,a.y,U.x,U.y);if(te&&te.owner==="neutral"){if(b.position.x===U.x&&b.position.y===U.y||b.position.x===a.x&&b.position.y===a.y){let Me=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,Ve=2e6+o+Me;(de===null||Ve>de.score)&&(de={unit:b,target:F({},b.position),score:Ve,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:U.x,y:U.y}}})}else if(ue.some(Ve=>Ve.x===U.x&&Ve.y===U.y||Ve.x===a.x&&Ve.y===a.y)){let Ve=ue.find(yt=>yt.x===U.x&&yt.y===U.y||yt.x===a.x&&yt.y===a.y),et=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,dt=18e5+o+et;(de===null||dt>de.score)&&(de={unit:b,target:{x:Ve.x,y:Ve.y},score:dt,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(le){let z=e.getUnitAt(le.x,le.y);if(z&&z.owner==="player"&&e.isForest(le.x,le.y)){let U=le.x,te=le.y;if(ue.some(Me=>Me.x===U&&Me.y===te)){(de===null||3e5>de.score)&&(de={unit:b,target:{x:U,y:te},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let Me=d.length>0?d:h;if(Me.length>0)le=Me.reduce((et,dt)=>{let xt=Math.abs(b.position.x-dt.x)+Math.abs(b.position.y-dt.y),yt=Math.abs(b.position.x-et.x)+Math.abs(b.position.y-et.y);return xt<yt?dt:et},Me[0]),this.goals.set(b.id,le);else continue}}}let Ot=null;if(le&&e.isForest(le.x,le.y)&&!e.getUnitAt(le.x,le.y)){let U=[{x:le.x+1,y:le.y},{x:le.x-1,y:le.y},{x:le.x,y:le.y+1},{x:le.x,y:le.y-1}].filter(te=>e.inBounds(te.x,te.y)).filter(te=>{let ne=e.getWallBetween(te.x,te.y,le.x,le.y);return!!(ne&&ne.owner==="neutral")});U.length>0&&(Ot=U.reduce((te,ne)=>{let Me=Math.abs(b.position.x-te.x)+Math.abs(b.position.y-te.y);return Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)+3<Me?ne:te},U[0]))}let Yr=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let z of Yr){let U={x:b.position.x+z.x,y:b.position.y+z.y};if(!e.inBounds(U.x,U.y)||!e.isForest(U.x,U.y)||e.getUnitAt(U.x,U.y))continue;let ne=e.getWallBetween(b.position.x,b.position.y,U.x,U.y);if(ne&&(ne.owner==="neutral"||ne.owner==="ai")){let Me=(b.tier>=3?7e6:9e5)+o,Ve=ne.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(de===null||Me>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:Me,type:"wall_attack",reason:Ve,edge:{from:F({},b.position),to:U}})}else if(ne&&ne.owner==="player"){let Ve=[{x:U.x+1,y:U.y},{x:U.x-1,y:U.y},{x:U.x,y:U.y+1},{x:U.x,y:U.y-1}].filter(xt=>e.inBounds(xt.x,xt.y)).filter(xt=>e.getUnitAt(xt.x,xt.y)?!1:!e.getWallBetween(xt.x,xt.y,U.x,U.y)),et=Math.abs(b.position.x-U.x)+Math.abs(b.position.y-U.y);if((Ve.length>0?Ve.reduce((xt,yt)=>{let wn=Math.abs(b.position.x-yt.x)+Math.abs(b.position.y-yt.y)+1;return Math.min(xt,wn)},1/0):1/0)-et>4){let xt=(b.tier>=3?8e6:b.tier===3&&b.level===1?105e4:85e4)+o;(de===null||xt>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:xt,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:F({},b.position),to:U}})}}}for(let z of Yr){let U={x:b.position.x+z.x,y:b.position.y+z.y};if(U.x===a.x&&U.y===a.y){let te=e.getWallBetween(b.position.x,b.position.y,U.x,U.y);if(te&&(te.owner==="neutral"||te.owner==="player")&&b.tier>=3){let ne=8e6+o;(de===null||ne>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:ne,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:F({},b.position),to:U}})}}}if(le){let z=Math.sign(le.x-b.position.x),U=Math.sign(le.y-b.position.y),te=b.position.x+(z!==0?z:0),ne=b.position.y+(U!==0?U:0);if(e.inBounds(te,ne)){let Me=e.getUnitAt(te,ne);if(Me&&Me.owner==="ai")for(let Ve of Yr){let et={x:b.position.x+Ve.x,y:b.position.y+Ve.y};if(!e.inBounds(et.x,et.y))continue;let dt=e.getWallBetween(b.position.x,b.position.y,et.x,et.y);if(dt&&(dt.owner==="player"||dt.owner==="neutral")){let yt=(dt.owner==="player"?65e4:6e5)+o;(de===null||yt>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:yt,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:F({},b.position),to:et}})}}}}if(le){let z=le.x-b.position.x,U=le.y-b.position.y;if(z!==0&&U===0||z===0&&U!==0){let te=Math.sign(z),ne=Math.sign(U),Me={x:b.position.x+te,y:b.position.y+ne};if(e.inBounds(Me.x,Me.y)&&e.getWallBetween(b.position.x,b.position.y,Me.x,Me.y)){let et=(b.tier>=3?8e6:15e5)+o;(de===null||et>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:et,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:F({},b.position),to:Me}})}}if(Math.abs(z)>=1&&Math.abs(U)>=1){let te=Math.sign(z),ne=Math.sign(U),Me={x:b.position.x+te,y:b.position.y+ne};if(e.inBounds(Me.x,Me.y)&&this.combat.isDiagonalBlocked(b.position,Me,(et,dt,xt,yt)=>e.getWallBetween(et,dt,xt,yt))){let et={x:b.position.x+te,y:b.position.y},dt={x:b.position.x,y:b.position.y+ne},xt=e.getWallBetween(b.position.x,b.position.y,et.x,et.y),yt=e.getWallBetween(b.position.x,b.position.y,dt.x,dt.y),wn=null;if(xt?wn={from:F({},b.position),to:et}:yt&&(wn={from:F({},b.position),to:dt}),wn){let Ho=(b.tier>=3?8e6:15e5)+o;(de===null||Ho>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:Ho,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:wn})}}}}let B0=d.length===0&&h.length===0&&!Ot;if(Ke>=2&&(B0||S.length>0))for(let z of Yr){let U={x:b.position.x+z.x,y:b.position.y+z.y};if(!e.inBounds(U.x,U.y))continue;let te=e.getWallBetween(b.position.x,b.position.y,U.x,U.y);if(te&&(te.owner==="neutral"||te.owner==="player")){let ne=b.tier>=3?8e6:12e5;(de===null||ne>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:ne,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:F({},b.position),to:U}})}}let pr=S.filter(z=>Math.max(Math.abs(z.position.x-b.position.x),Math.abs(z.position.y-b.position.y))===1),jo=pr.length>0?pr.reduce((z,U)=>this.combat.calculateTotalPoints(U)>this.combat.calculateTotalPoints(z)?U:z,pr[0]):null,Os=lt.length>0&&ue.some(z=>lt.some(U=>U.x===z.x&&U.y===z.y));for(let z of ue){let U=0,te="Action",ne=e.getUnitAt(z.x,z.y),Me=Ce=>[{x:Ce.x+1,y:Ce.y},{x:Ce.x-1,y:Ce.y},{x:Ce.x,y:Ce.y+1},{x:Ce.x,y:Ce.y-1}].filter(Mt=>e.inBounds(Mt.x,Mt.y)).filter(Mt=>!e.getUnitAt(Mt.x,Mt.y)).length,Ve=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y)),et=Math.max(Math.abs(z.x-s.x),Math.abs(z.y-s.y)),dt=l.length?Math.min(...l.map(Ce=>Math.abs(b.position.x-Ce.x)+Math.abs(b.position.y-Ce.y))):1/0,xt=l.length?Math.min(...l.map(Ce=>Math.abs(z.x-Ce.x)+Math.abs(z.y-Ce.y))):1/0,yt=l.filter(Ce=>{let Ge=e.getUnitAt(Ce.x,Ce.y);return!!Ge&&Ge.owner==="player"}),wn=yt.length?Math.min(...yt.map(Ce=>Math.abs(b.position.x-Ce.x)+Math.abs(b.position.y-Ce.y))):1/0,Ho=yt.length?Math.min(...yt.map(Ce=>Math.abs(z.x-Ce.x)+Math.abs(z.y-Ce.y))):1/0,Pc=new Map(e.unitMoveHistorySignal()).get(b.id),ci=Array.isArray(Pc)?Pc:[],Qr=ci.length>=2?ci[ci.length-2]:null,qt=ci.length>=3?ci[ci.length-3]:null,Eh=Qr&&z.x===Qr.x&&z.y===Qr.y,Jr=zn&&!e.isForest(z.x,z.y);if(I){let Ce=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ge=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);Ge<Ce?(U+=5e7,te="FULL RUSH: Charge Base"):Ge===Ce?U+=1e5:U-=5e6,ne&&ne.owner==="player"&&Math.abs(ne.position.x-a.x)+Math.abs(ne.position.y-a.y)<Ce&&(U+=2e7,te="FULL RUSH: Clear Path to Base"),zn&&z.x===b.position.x&&z.y===b.position.y&&f>=3&&(U=-5e6,te="FULL RUSH: Abandon Forest for Assault")}else if(b.tier>=3&&Jr){let Ce=Math.abs(z.x-a.x)+Math.abs(z.y-a.y)<=2,Ge=S.some(jt=>Math.abs(z.x-jt.position.x)+Math.abs(z.y-jt.position.y)<=2),Mt=e.unitsSignal().some(jt=>jt.owner==="ai"&&jt.id!==b.id&&Math.max(Math.abs(jt.position.x-b.position.x),Math.abs(jt.position.y-b.position.y))<=1);!M&&!(Ce||Ge)&&!Mt&&(U-=2e6,te="Penalty: Leaving forest without replacement")}let Xr=se.get(b.id),j0=Xr&&Xr.until>e.turnSignal()&&Xr.tiles.has(`${z.x},${z.y}`);if(b.tier===1&&(Qr&&z.x===Qr.x&&z.y===Qr.y||qt&&z.x===qt.x&&z.y===qt.y)&&(U-=25e3,te="Anti-Loop Penalty"),b.tier<=2&&!ne&&qt&&z.x===qt.x&&z.y===qt.y&&(U=-1e6,te="Anti-Loop: Stay or different path"),j0&&(U-=3e4,te="Stutter Ban Penalty"),zn&&pr.length===0&&!ne&&Jr&&!q&&(U=-1e3),zn&&b.tier<=2&&Jr&&pr.length>0&&pr.some(Ge=>this.combat.calculateTotalPoints(Ge)>this.combat.calculateTotalPoints(b))&&(U=-1e6,te="Hold Forest"),I)zn&&z.x===b.position.x&&z.y===b.position.y&&f>=3&&(U=-5e6,te="FULL RUSH: Abandon Forest for Assault");else if(!ne&&zn&&z.x===b.position.x&&z.y===b.position.y){let Ce=pr.some(Mt=>this.combat.calculateTotalPoints(Mt)>this.combat.calculateTotalPoints(b)),Ge=M&&b.tier>=3;!Ce&&!Ge&&(U=Math.max(U,1e7),te="Hold: Stay on forest")}if(!ne&&!I){if(e.isForest(z.x,z.y)&&!e.getUnitAt(z.x,z.y)&&(Ps?(U=-1e3,te="Ignore Forest (Total War)"):b.tier>=3?(U=5e6*(Ae&&!q?3:1),te="Priority: T3 capture empty forest"):(U=1e6*(Ae&&!q?3:1),te=f<3?`Priority 0: Capture Forest ${z.x},${z.y}`:`Priority 1: Capture Forest ${z.x},${z.y}`,Ae&&!q&&Math.abs(b.position.x-z.x)+Math.abs(b.position.y-z.y)===1&&(U=Math.max(U,12e6),te=`Early Capture: Forest ${z.x},${z.y}`))),le){let Ce=Math.abs(b.position.x-le.x)+Math.abs(b.position.y-le.y),Ge=Math.abs(z.x-le.x)+Math.abs(z.y-le.y);if(Ge<Ce&&(U+=5e4*(Ce-Ge),te=d.length>0?`Priority 1: Toward Forest ${le.x},${le.y}`:h.length>0?`Priority 7: Toward Fog Forest ${le.x},${le.y}`:`Toward Goal ${le.x},${le.y}`),m>10||w){let jt=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ft=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);Ft<jt&&(U+=15e4*(jt-Ft),te="Aggress: Toward Player Base"),Ho<wn&&(U+=12e4*(wn-Ho),te="Aggress: Toward Player Forest");let xn=Me(z)-Me(b.position);xn>0&&(U+=5e4*xn,te="Unblock: Clear path")}if((()=>{let jt=Math.sign(le.x-b.position.x),Ft=Math.sign(le.y-b.position.y),xn=b.position.x+(jt!==0?jt:0),Lt=b.position.y+(Ft!==0?Ft:0);return e.inBounds(xn,Lt)?!!e.getWallBetween(b.position.x,b.position.y,xn,Lt):!1})()&&z.x===b.position.x&&z.y===b.position.y){let Ft=e.getWallBetween(b.position.x,b.position.y,b.position.x+Math.sign(le.x-b.position.x),b.position.y+Math.sign(le.y-b.position.y))?.owner;b.tier>=3?(U=Math.max(U,8e6+o),te="Breach: Wall blocks high-priority path"):(U+=(Ft==="ai"?7e5:8e5)+o,te=Ft==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(Ot){let Ce=Math.abs(b.position.x-Ot.x)+Math.abs(b.position.y-Ot.y),Ge=Math.abs(z.x-Ot.x)+Math.abs(z.y-Ot.y);Ge<Ce&&(U+=2e5*(Ce-Ge),te="Approach Neutral Wall to Forest"),z.x===Ot.x&&z.y===Ot.y&&(U+=5e5,te="Position for Wall Breach")}if(z.x===a.x&&z.y===a.y&&(U+=1e4,te="Attack Base (Override)"),Ne){let Ce=lt.some(Lt=>Lt.x===z.x&&Lt.y===z.y),Ge=Math.abs(b.position.x-Ne.position.x)+Math.abs(b.position.y-Ne.position.y),Mt=Math.abs(z.x-Ne.position.x)+Math.abs(z.y-Ne.position.y),Ft=Math.max(Math.abs(Ne.position.x-s.x),Math.abs(Ne.position.y-s.y))<=2,xn=z.x===b.position.x&&z.y===b.position.y;if(b.tier>=3&&Ne.tier>=3&&Mt===1)U=4e7,te="DEFENSE: T3 Move to Intercept Threat";else if(Ce){let Lt=Ft?25e5:15e5;U<Lt&&(U=Lt),U+=Ft?2e4:5e3,te=Ft?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(Mt<Ge){let Lt=b.id===(Wt?.id??"")?1e6:5e3;U+=Lt*(Ge-Mt),b.tier>=3&&(U+=4e3),te=b.id===(Wt?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}xn&&Os&&(U-=Ft?5e4:1e4,ve?te="Penalty: Standing Still With Imminent Base Threat":q&&(te="Penalty: Standing Still With Base Threat"))}if(b.tier>=3){let Ce=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ge=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);Ge<Ce&&(U+=2e3*(Ce-Ge),te="Hunter: Toward Base",M&&(U=Math.max(U,4e6),te="Hunt: Approach Base"))}if(qe&&xt<dt&&(U*=10),et>Ve&&xt<dt&&(U+=500),jo&&this.combat.calculateTotalPoints(jo)>this.combat.calculateTotalPoints(b)){let Ce=Math.abs(b.position.x-jo.position.x)+Math.abs(b.position.y-jo.position.y),Ge=Math.abs(z.x-jo.position.x)+Math.abs(z.y-jo.position.y);Ge>Ce&&(U+=75e3*(Ge-Ce),te="Retreat")}}else if(ne.owner==="player"){let Ce=Math.max(Math.abs(ne.position.x-s.x),Math.abs(ne.position.y-s.y)),Ge=Ce<=3,Mt=Ce<=2,jt=this.combat.calculateTotalPoints(b),Ft=this.combat.calculateTotalPoints(ne),xn=jt>Ft,Lt=ne.tier>=3,Fs=b.tier>=3;b.tier>=3&&e.isForest(ne.position.x,ne.position.y)&&(U=1e7,te="Aggression: Liberate forest"),!zn&&ae&&yt.length>0&&e.isForest(ne.position.x,ne.position.y)&&(U=12e6,te="LIBERATE: Attack player forest"),Ce<=4&&(b.tier>=3||xn)&&(U=15e6,te="INTERCEPT: Base Siege"),Ge?Fs&&Lt?(U=5e7,te="CRITICAL DEFENSE: T3 Intercepts Threat"):xn?(U=2e7,te="CRITICAL DEFENSE: Eliminate Base Threat",Mt&&(U+=5e6)):Lt&&b.tier<=2?(U=0,te="Ignore: T1 Suicide vs T3 useless"):(U=1e3,te="DEFENSE: Desperation Attack"):xn?(Lt?(U=8e6,te="COMBAT: Kill High Value Target (T3+)"):(U=4e6,te="COMBAT: Kill Enemy"),b.tier<ne.tier&&(U+=2e6,te+=" (Efficient Trade)")):b.tier<=2?(U=0,te="Ignore: No guaranteed kill"):(U=1e5,te="COMBAT: Chip Damage"),R&&(U+=5e5),k&&(U+=1e6)}else if(ne.tier===b.tier&&et>Ve){let Ce=this.combat.calculateTotalPoints(b)+this.combat.calculateTotalPoints(ne),{tier:Ge}=this.combat.calculateTierAndLevel(Ce);Ge>b.tier&&!qe&&!zn&&(U=1e3,te="Merge Up")}let Gi="move";ne&&ne.owner==="player"&&(Gi="attack"),ne&&ne.owner==="ai"&&ne.tier===b.tier&&(Gi="merge"),(m>10||w)&&Gi==="merge"&&(U+=5e6,te="Anti-Stall: Merge first");let H0=this.interceptUntil.get(b.id)||0;if(b.id===(Wt?.id??"")&&H0>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Ne){let Ce=Math.abs(b.position.x-Ne.position.x)+Math.abs(b.position.y-Ne.position.y),Ge=Math.abs(z.x-Ne.position.x)+Math.abs(z.y-Ne.position.y);Ge<Ce&&(U+=5e5*(Ce-Ge),te="DEFENSE: Intercept Lock")}Eh&&(U=Math.floor(U*.1),U-=3e5,te="Penalty: Inertia");let G0=(()=>{let Ce=ci.slice(-6),Ge=new Set(Ce.map(Mt=>`${Mt.x},${Mt.y}`));return Ce.length>=6&&Ge.size<=3})();if(b.tier===1&&G0){let Ce=d.length>0?d:h;if(Ce.length>0){let Ge=Ce.reduce((Ft,xn)=>{let Lt=Math.abs(b.position.x-xn.x)+Math.abs(b.position.y-xn.y),Fs=Math.abs(b.position.x-Ft.x)+Math.abs(b.position.y-Ft.y);return Lt<Fs?xn:Ft},Ce[0]),Mt=Math.abs(b.position.x-Ge.x)+Math.abs(b.position.y-Ge.y),jt=Math.abs(z.x-Ge.x)+Math.abs(z.y-Ge.y);jt<Mt&&(U+=1e5*(Mt-jt),te="Breakout: Toward Forest")}}(b.forestOccupationTurns??0)>0&&(z.x!==b.position.x||z.y!==b.position.y)&&(U-=2e3),(de===null||U>de.score)&&(de={unit:b,target:z,score:U,type:Gi,reason:te})}}if(!de)return null;let Ee=this.goals.get(de.unit.id),_e=Ee?`Goal: Forest at ${Ee.x},${Ee.y}`:"Goal: None";return{type:de.type,unit:de.unit,target:de.target,reason:de.reason,edge:de.edge}}getWallBuildActions(e){let t=[],i=e.unitsSignal().filter(d=>d.owner==="ai"),r=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,h)=>o.some(f=>f.tile1.x===d.x&&f.tile1.y===d.y&&f.tile2.x===h.x&&f.tile2.y===h.y||f.tile1.x===h.x&&f.tile1.y===h.y&&f.tile2.x===d.x&&f.tile2.y===d.y),l=(d,h)=>Math.abs(d.x-h.x)+Math.abs(d.y-h.y),c=(d,h)=>Math.max(Math.abs(d.x-h.x),Math.abs(d.y-h.y));for(let d of i){if(d.tier>=3)continue;let h=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(S=>e.inBounds(S.x,S.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let S of h)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});continue}let f=r.filter(S=>c(d.position,S.position)<=2);if(f.length===0)continue;let m=f.sort((S,k)=>l(d.position,S.position)-l(d.position,k.position))[0],w=h.sort((S,k)=>l(S,m.position)-l(k,m.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let S of w)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});else if(d.tier===2){let S=0;for(let k of w){if(S>=2)break;!a(d.position,k)&&e.canBuildWallBetween(d.position,k)&&(t.push({from:d.position,to:k}),S++)}}}return t}static \u0275fac=function(t){return new(t||n)(Re(Yl),Re(gt))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var oR=()=>{};var lR=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},_j=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=n[t++],s=n[t++],a=n[t++],l=((r&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63)}}return e.join("")},cR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,a=s?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,d=o>>2,h=(o&3)<<4|a>>4,f=(a&15)<<2|c>>6,m=c&63;l||(m=64,s||(f=64)),i.push(t[d],t[h],t[f],t[m])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(lR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_j(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let c=r<n.length?t[n.charAt(r)]:64;++r;let h=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||a==null||c==null||h==null)throw new Mb;let f=o<<2|a>>4;if(i.push(f),c!==64){let m=a<<4&240|c>>2;if(i.push(m),h!==64){let w=c<<6&192|h;i.push(w)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Mb=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Ej=function(n){let e=lR(n);return cR.encodeByteArray(e,!0)},bd=function(n){return Ej(n).replace(/\./g,"")},Hg=function(n){try{return cR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function uR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var bj=()=>uR().__FIREBASE_DEFAULTS__,wj=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Hg(n[1]);return e&&JSON.parse(e)},Gg=()=>{try{return oR()||bj()||wj()||xj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},kb=n=>Gg()?.emulatorHosts?.[n],dR=n=>{let e=kb(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Nb=()=>Gg()?.config,Pb=n=>Gg()?.[`_${n}`];var jg=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function _s(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $g(n){return(await fetch(n,{credentials:"include"})).ok}function hR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=F({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[bd(JSON.stringify(t)),bd(JSON.stringify(s)),""].join(".")}var Ed={};function Sj(){let n={prod:[],emulator:[]};for(let e of Object.keys(Ed))Ed[e]?n.emulator.push(e):n.prod.push(e);return n}function Ij(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var sR=!1;function zg(n,e){if(typeof window>"u"||typeof document>"u"||!_s(window.location.host)||Ed[n]===e||Ed[n]||sR)return;Ed[n]=e;function t(f){return`__firebase__banner__${f}`}let i="__firebase__banner",o=Sj().prod.length>0;function s(){let f=document.getElementById(i);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){let f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{sR=!0,s()},f}function d(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){let f=Ij(i),m=t("text"),w=document.getElementById(m)||document.createElement("span"),S=t("learnmore"),k=document.getElementById(S)||document.createElement("a"),V=t("preprendIcon"),q=document.getElementById(V)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){let ye=f.element;a(ye),d(k,S);let ve=c();l(q,V),ye.append(q,w,k,ve),document.body.appendChild(ye)}o?(w.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Cn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cn())}function Tj(){let n=Gg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gR(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function mR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yR(){let n=Cn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vR(){return!Tj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ob(){try{return typeof indexedDB=="object"}catch{return!1}}function _R(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var Cj="FirebaseError",Si=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Cj,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_o.prototype.create)}},_o=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?Dj(o,i):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new Si(r,a,i)}};function Dj(n,e){return n.replace(Aj,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var Aj=/\{\$([^}]+)}/g;function ER(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ar(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(aR(o)&&aR(s)){if(!ar(o,s))return!1}else if(o!==s)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function aR(n){return n!==null&&typeof n=="object"}function Ql(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function bR(n,e){let t=new Rb(n,e);return t.subscribe.bind(t)}var Rb=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Mj(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Ab),r.error===void 0&&(r.error=Ab),r.complete===void 0&&(r.complete=Ab);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Mj(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ab(){}var Kue=14400*1e3;function Dn(n){return n&&n._delegate?n._delegate:n}var Ui=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ca="[DEFAULT]";var Fb=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new jg;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kj(e))try{this.getOrInitializeService({instanceIdentifier:Ca})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=Ca){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ca){return this.instances.has(e)}getOptions(e=Ca){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&s.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Rj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ca){return this.component?this.component.multipleInstances?e:Ca:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Rj(n){return n===Ca?void 0:n}function kj(n){return n.instantiationMode==="EAGER"}var Wg=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Fb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Nj=[],nt=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(nt||{}),Pj={debug:nt.DEBUG,verbose:nt.VERBOSE,info:nt.INFO,warn:nt.WARN,error:nt.ERROR,silent:nt.SILENT},Oj=nt.INFO,Fj={[nt.DEBUG]:"log",[nt.VERBOSE]:"log",[nt.INFO]:"info",[nt.WARN]:"warn",[nt.ERROR]:"error"},Lj=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=Fj[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Es=class{constructor(e){this.name=e,this._logLevel=Oj,this._logHandler=Lj,this._userLogHandler=null,Nj.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in nt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Pj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,nt.DEBUG,...e),this._logHandler(this,nt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,nt.VERBOSE,...e),this._logHandler(this,nt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,nt.INFO,...e),this._logHandler(this,nt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,nt.WARN,...e),this._logHandler(this,nt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,nt.ERROR,...e),this._logHandler(this,nt.ERROR,...e)}};var Vj=(n,e)=>e.some(t=>n instanceof t),wR,xR;function Uj(){return wR||(wR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bj(){return xR||(xR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var SR=new WeakMap,Vb=new WeakMap,IR=new WeakMap,Lb=new WeakMap,Bb=new WeakMap;function jj(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Lr(n.result)),r()},s=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&SR.set(t,n)}).catch(()=>{}),Bb.set(e,n),e}function Hj(n){if(Vb.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Vb.set(n,e)}var Ub={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||IR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Lr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function TR(n){Ub=n(Ub)}function Gj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(qg(this),e,...t);return IR.set(i,e.sort?e.sort():[e]),Lr(i)}:Bj().includes(n)?function(...e){return n.apply(qg(this),e),Lr(SR.get(this))}:function(...e){return Lr(n.apply(qg(this),e))}}function $j(n){return typeof n=="function"?Gj(n):(n instanceof IDBTransaction&&Hj(n),Vj(n,Uj())?new Proxy(n,Ub):n)}function Lr(n){if(n instanceof IDBRequest)return jj(n);if(Lb.has(n))return Lb.get(n);let e=$j(n);return e!==n&&(Lb.set(n,e),Bb.set(e,n)),e}var qg=n=>Bb.get(n);function DR(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),a=Lr(s);return i&&s.addEventListener("upgradeneeded",l=>{i(Lr(s.result),l.oldVersion,l.newVersion,Lr(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var zj=["get","getKey","getAll","getAllKeys","count"],Wj=["put","add","delete","clear"],jb=new Map;function CR(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(jb.get(e))return jb.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Wj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||zj.includes(t)))return;let o=async function(s,...a){let l=this.transaction(s,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return jb.set(e,o),o}TR(n=>ce(F({},n),{get:(e,t,i)=>CR(e,t)||n.get(e,t,i),has:(e,t)=>!!CR(e,t)||n.has(e,t)}));var Gb=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qj(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function qj(n){return n.getComponent()?.type==="VERSION"}var $b="@firebase/app",AR="0.14.7";var Eo=new Es("@firebase/app"),Kj="@firebase/app-compat",Yj="@firebase/analytics-compat",Qj="@firebase/analytics",Jj="@firebase/app-check-compat",Xj="@firebase/app-check",Zj="@firebase/auth",e9="@firebase/auth-compat",t9="@firebase/database",n9="@firebase/data-connect",i9="@firebase/database-compat",r9="@firebase/functions",o9="@firebase/functions-compat",s9="@firebase/installations",a9="@firebase/installations-compat",l9="@firebase/messaging",c9="@firebase/messaging-compat",u9="@firebase/performance",d9="@firebase/performance-compat",h9="@firebase/remote-config",f9="@firebase/remote-config-compat",p9="@firebase/storage",g9="@firebase/storage-compat",m9="@firebase/firestore",y9="@firebase/ai",v9="@firebase/firestore-compat",_9="firebase",E9="12.8.0";var zb="[DEFAULT]",b9={[$b]:"fire-core",[Kj]:"fire-core-compat",[Qj]:"fire-analytics",[Yj]:"fire-analytics-compat",[Xj]:"fire-app-check",[Jj]:"fire-app-check-compat",[Zj]:"fire-auth",[e9]:"fire-auth-compat",[t9]:"fire-rtdb",[n9]:"fire-data-connect",[i9]:"fire-rtdb-compat",[r9]:"fire-fn",[o9]:"fire-fn-compat",[s9]:"fire-iid",[a9]:"fire-iid-compat",[l9]:"fire-fcm",[c9]:"fire-fcm-compat",[u9]:"fire-perf",[d9]:"fire-perf-compat",[h9]:"fire-rc",[f9]:"fire-rc-compat",[p9]:"fire-gcs",[g9]:"fire-gcs-compat",[m9]:"fire-fst",[v9]:"fire-fst-compat",[y9]:"fire-vertex","fire-js":"fire-js",[_9]:"fire-js-all"};var Kg=new Map,w9=new Map,Wb=new Map;function MR(n,e){try{n.container.addComponent(e)}catch(t){Eo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ws(n){let e=n.name;if(Wb.has(e))return Eo.debug(`There were multiple attempts to register component ${e}.`),!1;Wb.set(e,n);for(let t of Kg.values())MR(t,n);for(let t of w9.values())MR(t,n);return!0}function xd(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ii(n){return n==null?!1:n.settings!==void 0}var x9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bs=new _o("app","Firebase",x9);var qb=class{constructor(e,t,i){this._isDeleted=!1,this._options=F({},e),this._config=F({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bs.create("app-deleted",{appName:this._name})}};var xs=E9;function Sd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=F({name:zb,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw bs.create("bad-app-name",{appName:String(r)});if(t||(t=Nb()),!t)throw bs.create("no-options");let o=Kg.get(r);if(o){if(ar(t,o.options)&&ar(i,o.config))return o;throw bs.create("duplicate-app",{appName:r})}let s=new Wg(r);for(let l of Wb.values())s.addComponent(l);let a=new qb(t,i,s);return Kg.set(r,a),a}function Yg(n=zb){let e=Kg.get(n);if(!e&&n===zb&&Nb())return Sd();if(!e)throw bs.create("no-app",{appName:n});return e}function lr(n,e,t){let i=b9[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let s=[`Unable to register library "${i}" with version "${e}":`];r&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Eo.warn(s.join(" "));return}ws(new Ui(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var S9="firebase-heartbeat-database",I9=1,wd="firebase-heartbeat-store",Hb=null;function PR(){return Hb||(Hb=DR(S9,I9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(wd)}catch(t){console.warn(t)}}}}).catch(n=>{throw bs.create("idb-open",{originalErrorMessage:n.message})})),Hb}async function T9(n){try{let t=(await PR()).transaction(wd),i=await t.objectStore(wd).get(OR(n));return await t.done,i}catch(e){if(e instanceof Si)Eo.warn(e.message);else{let t=bs.create("idb-get",{originalErrorMessage:e?.message});Eo.warn(t.message)}}}async function RR(n,e){try{let i=(await PR()).transaction(wd,"readwrite");await i.objectStore(wd).put(e,OR(n)),await i.done}catch(t){if(t instanceof Si)Eo.warn(t.message);else{let i=bs.create("idb-set",{originalErrorMessage:t?.message});Eo.warn(i.message)}}}function OR(n){return`${n.name}!${n.options.appId}`}var C9=1024,D9=30,Kb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Yb(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=kR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>D9){let r=M9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Eo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=kR(),{heartbeatsToSend:t,unsentEntries:i}=A9(this._heartbeatsCache.heartbeats),r=bd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Eo.warn(e),""}}};function kR(){return new Date().toISOString().substring(0,10)}function A9(n,e=C9){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),NR(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),NR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Yb=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ob()?_R().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await T9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return RR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return RR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function NR(n){return bd(JSON.stringify({version:2,heartbeats:n})).length}function M9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function R9(n){ws(new Ui("platform-logger",e=>new Gb(e),"PRIVATE")),ws(new Ui("heartbeat",e=>new Kb(e),"PRIVATE")),lr($b,AR,n),lr($b,AR,"esm2020"),lr("fire-js","")}R9("");var k9="firebase",N9="12.8.0";lr(k9,N9,"app");var FR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},LR={};var bo,Qb;(function(){var n;function e(O,T){function P(){}P.prototype=T.prototype,O.F=T.prototype,O.prototype=new P,O.prototype.constructor=O,O.D=function(I,x,R){for(var M=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)M[ae-2]=arguments[ae];return T.prototype[x].apply(I,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(O,T,P){P||(P=0);let I=Array(16);if(typeof T=="string")for(var x=0;x<16;++x)I[x]=T.charCodeAt(P++)|T.charCodeAt(P++)<<8|T.charCodeAt(P++)<<16|T.charCodeAt(P++)<<24;else for(x=0;x<16;++x)I[x]=T[P++]|T[P++]<<8|T[P++]<<16|T[P++]<<24;T=O.g[0],P=O.g[1],x=O.g[2];let R=O.g[3],M;M=T+(R^P&(x^R))+I[0]+3614090360&4294967295,T=P+(M<<7&4294967295|M>>>25),M=R+(x^T&(P^x))+I[1]+3905402710&4294967295,R=T+(M<<12&4294967295|M>>>20),M=x+(P^R&(T^P))+I[2]+606105819&4294967295,x=R+(M<<17&4294967295|M>>>15),M=P+(T^x&(R^T))+I[3]+3250441966&4294967295,P=x+(M<<22&4294967295|M>>>10),M=T+(R^P&(x^R))+I[4]+4118548399&4294967295,T=P+(M<<7&4294967295|M>>>25),M=R+(x^T&(P^x))+I[5]+1200080426&4294967295,R=T+(M<<12&4294967295|M>>>20),M=x+(P^R&(T^P))+I[6]+2821735955&4294967295,x=R+(M<<17&4294967295|M>>>15),M=P+(T^x&(R^T))+I[7]+4249261313&4294967295,P=x+(M<<22&4294967295|M>>>10),M=T+(R^P&(x^R))+I[8]+1770035416&4294967295,T=P+(M<<7&4294967295|M>>>25),M=R+(x^T&(P^x))+I[9]+2336552879&4294967295,R=T+(M<<12&4294967295|M>>>20),M=x+(P^R&(T^P))+I[10]+4294925233&4294967295,x=R+(M<<17&4294967295|M>>>15),M=P+(T^x&(R^T))+I[11]+2304563134&4294967295,P=x+(M<<22&4294967295|M>>>10),M=T+(R^P&(x^R))+I[12]+1804603682&4294967295,T=P+(M<<7&4294967295|M>>>25),M=R+(x^T&(P^x))+I[13]+4254626195&4294967295,R=T+(M<<12&4294967295|M>>>20),M=x+(P^R&(T^P))+I[14]+2792965006&4294967295,x=R+(M<<17&4294967295|M>>>15),M=P+(T^x&(R^T))+I[15]+1236535329&4294967295,P=x+(M<<22&4294967295|M>>>10),M=T+(x^R&(P^x))+I[1]+4129170786&4294967295,T=P+(M<<5&4294967295|M>>>27),M=R+(P^x&(T^P))+I[6]+3225465664&4294967295,R=T+(M<<9&4294967295|M>>>23),M=x+(T^P&(R^T))+I[11]+643717713&4294967295,x=R+(M<<14&4294967295|M>>>18),M=P+(R^T&(x^R))+I[0]+3921069994&4294967295,P=x+(M<<20&4294967295|M>>>12),M=T+(x^R&(P^x))+I[5]+3593408605&4294967295,T=P+(M<<5&4294967295|M>>>27),M=R+(P^x&(T^P))+I[10]+38016083&4294967295,R=T+(M<<9&4294967295|M>>>23),M=x+(T^P&(R^T))+I[15]+3634488961&4294967295,x=R+(M<<14&4294967295|M>>>18),M=P+(R^T&(x^R))+I[4]+3889429448&4294967295,P=x+(M<<20&4294967295|M>>>12),M=T+(x^R&(P^x))+I[9]+568446438&4294967295,T=P+(M<<5&4294967295|M>>>27),M=R+(P^x&(T^P))+I[14]+3275163606&4294967295,R=T+(M<<9&4294967295|M>>>23),M=x+(T^P&(R^T))+I[3]+4107603335&4294967295,x=R+(M<<14&4294967295|M>>>18),M=P+(R^T&(x^R))+I[8]+1163531501&4294967295,P=x+(M<<20&4294967295|M>>>12),M=T+(x^R&(P^x))+I[13]+2850285829&4294967295,T=P+(M<<5&4294967295|M>>>27),M=R+(P^x&(T^P))+I[2]+4243563512&4294967295,R=T+(M<<9&4294967295|M>>>23),M=x+(T^P&(R^T))+I[7]+1735328473&4294967295,x=R+(M<<14&4294967295|M>>>18),M=P+(R^T&(x^R))+I[12]+2368359562&4294967295,P=x+(M<<20&4294967295|M>>>12),M=T+(P^x^R)+I[5]+4294588738&4294967295,T=P+(M<<4&4294967295|M>>>28),M=R+(T^P^x)+I[8]+2272392833&4294967295,R=T+(M<<11&4294967295|M>>>21),M=x+(R^T^P)+I[11]+1839030562&4294967295,x=R+(M<<16&4294967295|M>>>16),M=P+(x^R^T)+I[14]+4259657740&4294967295,P=x+(M<<23&4294967295|M>>>9),M=T+(P^x^R)+I[1]+2763975236&4294967295,T=P+(M<<4&4294967295|M>>>28),M=R+(T^P^x)+I[4]+1272893353&4294967295,R=T+(M<<11&4294967295|M>>>21),M=x+(R^T^P)+I[7]+4139469664&4294967295,x=R+(M<<16&4294967295|M>>>16),M=P+(x^R^T)+I[10]+3200236656&4294967295,P=x+(M<<23&4294967295|M>>>9),M=T+(P^x^R)+I[13]+681279174&4294967295,T=P+(M<<4&4294967295|M>>>28),M=R+(T^P^x)+I[0]+3936430074&4294967295,R=T+(M<<11&4294967295|M>>>21),M=x+(R^T^P)+I[3]+3572445317&4294967295,x=R+(M<<16&4294967295|M>>>16),M=P+(x^R^T)+I[6]+76029189&4294967295,P=x+(M<<23&4294967295|M>>>9),M=T+(P^x^R)+I[9]+3654602809&4294967295,T=P+(M<<4&4294967295|M>>>28),M=R+(T^P^x)+I[12]+3873151461&4294967295,R=T+(M<<11&4294967295|M>>>21),M=x+(R^T^P)+I[15]+530742520&4294967295,x=R+(M<<16&4294967295|M>>>16),M=P+(x^R^T)+I[2]+3299628645&4294967295,P=x+(M<<23&4294967295|M>>>9),M=T+(x^(P|~R))+I[0]+4096336452&4294967295,T=P+(M<<6&4294967295|M>>>26),M=R+(P^(T|~x))+I[7]+1126891415&4294967295,R=T+(M<<10&4294967295|M>>>22),M=x+(T^(R|~P))+I[14]+2878612391&4294967295,x=R+(M<<15&4294967295|M>>>17),M=P+(R^(x|~T))+I[5]+4237533241&4294967295,P=x+(M<<21&4294967295|M>>>11),M=T+(x^(P|~R))+I[12]+1700485571&4294967295,T=P+(M<<6&4294967295|M>>>26),M=R+(P^(T|~x))+I[3]+2399980690&4294967295,R=T+(M<<10&4294967295|M>>>22),M=x+(T^(R|~P))+I[10]+4293915773&4294967295,x=R+(M<<15&4294967295|M>>>17),M=P+(R^(x|~T))+I[1]+2240044497&4294967295,P=x+(M<<21&4294967295|M>>>11),M=T+(x^(P|~R))+I[8]+1873313359&4294967295,T=P+(M<<6&4294967295|M>>>26),M=R+(P^(T|~x))+I[15]+4264355552&4294967295,R=T+(M<<10&4294967295|M>>>22),M=x+(T^(R|~P))+I[6]+2734768916&4294967295,x=R+(M<<15&4294967295|M>>>17),M=P+(R^(x|~T))+I[13]+1309151649&4294967295,P=x+(M<<21&4294967295|M>>>11),M=T+(x^(P|~R))+I[4]+4149444226&4294967295,T=P+(M<<6&4294967295|M>>>26),M=R+(P^(T|~x))+I[11]+3174756917&4294967295,R=T+(M<<10&4294967295|M>>>22),M=x+(T^(R|~P))+I[2]+718787259&4294967295,x=R+(M<<15&4294967295|M>>>17),M=P+(R^(x|~T))+I[9]+3951481745&4294967295,O.g[0]=O.g[0]+T&4294967295,O.g[1]=O.g[1]+(x+(M<<21&4294967295|M>>>11))&4294967295,O.g[2]=O.g[2]+x&4294967295,O.g[3]=O.g[3]+R&4294967295}i.prototype.v=function(O,T){T===void 0&&(T=O.length);let P=T-this.blockSize,I=this.C,x=this.h,R=0;for(;R<T;){if(x==0)for(;R<=P;)r(this,O,R),R+=this.blockSize;if(typeof O=="string"){for(;R<T;)if(I[x++]=O.charCodeAt(R++),x==this.blockSize){r(this,I),x=0;break}}else for(;R<T;)if(I[x++]=O[R++],x==this.blockSize){r(this,I),x=0;break}}this.h=x,this.o+=T},i.prototype.A=function(){var O=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);O[0]=128;for(var T=1;T<O.length-8;++T)O[T]=0;T=this.o*8;for(var P=O.length-8;P<O.length;++P)O[P]=T&255,T/=256;for(this.v(O),O=Array(16),T=0,P=0;P<4;++P)for(let I=0;I<32;I+=8)O[T++]=this.g[P]>>>I&255;return O};function o(O,T){var P=a;return Object.prototype.hasOwnProperty.call(P,O)?P[O]:P[O]=T(O)}function s(O,T){this.h=T;let P=[],I=!0;for(let x=O.length-1;x>=0;x--){let R=O[x]|0;I&&R==T||(P[x]=R,I=!1)}this.g=P}var a={};function l(O){return-128<=O&&O<128?o(O,function(T){return new s([T|0],T<0?-1:0)}):new s([O|0],O<0?-1:0)}function c(O){if(isNaN(O)||!isFinite(O))return h;if(O<0)return k(c(-O));let T=[],P=1;for(let I=0;O>=P;I++)T[I]=O/P|0,P*=4294967296;return new s(T,0)}function d(O,T){if(O.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(O.charAt(0)=="-")return k(d(O.substring(1),T));if(O.indexOf("-")>=0)throw Error('number format error: interior "-" character');let P=c(Math.pow(T,8)),I=h;for(let R=0;R<O.length;R+=8){var x=Math.min(8,O.length-R);let M=parseInt(O.substring(R,R+x),T);x<8?(x=c(Math.pow(T,x)),I=I.j(x).add(c(M))):(I=I.j(P),I=I.add(c(M)))}return I}var h=l(0),f=l(1),m=l(16777216);n=s.prototype,n.m=function(){if(S(this))return-k(this).m();let O=0,T=1;for(let P=0;P<this.g.length;P++){let I=this.i(P);O+=(I>=0?I:4294967296+I)*T,T*=4294967296}return O},n.toString=function(O){if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(w(this))return"0";if(S(this))return"-"+k(this).toString(O);let T=c(Math.pow(O,6));var P=this;let I="";for(;;){let x=ve(P,T).g;P=V(P,x.j(T));let R=((P.g.length>0?P.g[0]:P.h)>>>0).toString(O);if(P=x,w(P))return R+I;for(;R.length<6;)R="0"+R;I=R+I}},n.i=function(O){return O<0?0:O<this.g.length?this.g[O]:this.h};function w(O){if(O.h!=0)return!1;for(let T=0;T<O.g.length;T++)if(O.g[T]!=0)return!1;return!0}function S(O){return O.h==-1}n.l=function(O){return O=V(this,O),S(O)?-1:w(O)?0:1};function k(O){let T=O.g.length,P=[];for(let I=0;I<T;I++)P[I]=~O.g[I];return new s(P,~O.h).add(f)}n.abs=function(){return S(this)?k(this):this},n.add=function(O){let T=Math.max(this.g.length,O.g.length),P=[],I=0;for(let x=0;x<=T;x++){let R=I+(this.i(x)&65535)+(O.i(x)&65535),M=(R>>>16)+(this.i(x)>>>16)+(O.i(x)>>>16);I=M>>>16,R&=65535,M&=65535,P[x]=M<<16|R}return new s(P,P[P.length-1]&-2147483648?-1:0)};function V(O,T){return O.add(k(T))}n.j=function(O){if(w(this)||w(O))return h;if(S(this))return S(O)?k(this).j(k(O)):k(k(this).j(O));if(S(O))return k(this.j(k(O)));if(this.l(m)<0&&O.l(m)<0)return c(this.m()*O.m());let T=this.g.length+O.g.length,P=[];for(var I=0;I<2*T;I++)P[I]=0;for(I=0;I<this.g.length;I++)for(let x=0;x<O.g.length;x++){let R=this.i(I)>>>16,M=this.i(I)&65535,ae=O.i(x)>>>16,be=O.i(x)&65535;P[2*I+2*x]+=M*be,q(P,2*I+2*x),P[2*I+2*x+1]+=R*be,q(P,2*I+2*x+1),P[2*I+2*x+1]+=M*ae,q(P,2*I+2*x+1),P[2*I+2*x+2]+=R*ae,q(P,2*I+2*x+2)}for(O=0;O<T;O++)P[O]=P[2*O+1]<<16|P[2*O];for(O=T;O<2*T;O++)P[O]=0;return new s(P,0)};function q(O,T){for(;(O[T]&65535)!=O[T];)O[T+1]+=O[T]>>>16,O[T]&=65535,T++}function ye(O,T){this.g=O,this.h=T}function ve(O,T){if(w(T))throw Error("division by zero");if(w(O))return new ye(h,h);if(S(O))return T=ve(k(O),T),new ye(k(T.g),k(T.h));if(S(T))return T=ve(O,k(T)),new ye(k(T.g),T.h);if(O.g.length>30){if(S(O)||S(T))throw Error("slowDivide_ only works with positive integers.");for(var P=f,I=T;I.l(O)<=0;)P=xe(P),I=xe(I);var x=Ae(P,1),R=Ae(I,1);for(I=Ae(I,2),P=Ae(P,2);!w(I);){var M=R.add(I);M.l(O)<=0&&(x=x.add(P),R=M),I=Ae(I,1),P=Ae(P,1)}return T=V(O,x.j(T)),new ye(x,T)}for(x=h;O.l(T)>=0;){for(P=Math.max(1,Math.floor(O.m()/T.m())),I=Math.ceil(Math.log(P)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),R=c(P),M=R.j(T);S(M)||M.l(O)>0;)P-=I,R=c(P),M=R.j(T);w(R)&&(R=f),x=x.add(R),O=V(O,M)}return new ye(x,O)}n.B=function(O){return ve(this,O).h},n.and=function(O){let T=Math.max(this.g.length,O.g.length),P=[];for(let I=0;I<T;I++)P[I]=this.i(I)&O.i(I);return new s(P,this.h&O.h)},n.or=function(O){let T=Math.max(this.g.length,O.g.length),P=[];for(let I=0;I<T;I++)P[I]=this.i(I)|O.i(I);return new s(P,this.h|O.h)},n.xor=function(O){let T=Math.max(this.g.length,O.g.length),P=[];for(let I=0;I<T;I++)P[I]=this.i(I)^O.i(I);return new s(P,this.h^O.h)};function xe(O){let T=O.g.length+1,P=[];for(let I=0;I<T;I++)P[I]=O.i(I)<<1|O.i(I-1)>>>31;return new s(P,O.h)}function Ae(O,T){let P=T>>5;T%=32;let I=O.g.length-P,x=[];for(let R=0;R<I;R++)x[R]=T>0?O.i(R+P)>>>T|O.i(R+P+1)<<32-T:O.i(R+P);return new s(x,O.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Qb=LR.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=d,bo=LR.Integer=s}).apply(typeof FR<"u"?FR:typeof self<"u"?self:typeof window<"u"?window:{});var Qg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wo={};var Jb,P9,Jl,Xb,Id,Jg,Zb,ew,tw;(function(){var n,e=Object.defineProperty;function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qg=="object"&&Qg];for(var p=0;p<u.length;++p){var E=u[p];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function r(u,p){if(p)e:{var E=i;u=u.split(".");for(var C=0;C<u.length-1;C++){var B=u[C];if(!(B in E))break e;E=E[B]}u=u[u.length-1],C=E[u],p=p(C),p!=C&&p!=null&&e(E,u,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(u){return u||function(p){var E=[],C;for(C in p)Object.prototype.hasOwnProperty.call(p,C)&&E.push([C,p[C]]);return E}});var o=o||{},s=this||self;function a(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function l(u,p,E){return u.call.apply(u.bind,arguments)}function c(u,p,E){return c=l,c.apply(null,arguments)}function d(u,p){var E=Array.prototype.slice.call(arguments,1);return function(){var C=E.slice();return C.push.apply(C,arguments),u.apply(this,C)}}function h(u,p){function E(){}E.prototype=p.prototype,u.Z=p.prototype,u.prototype=new E,u.prototype.constructor=u,u.Ob=function(C,B,H){for(var ge=Array(arguments.length-2),Ze=2;Ze<arguments.length;Ze++)ge[Ze-2]=arguments[Ze];return p.prototype[B].apply(C,ge)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function m(u){let p=u.length;if(p>0){let E=Array(p);for(let C=0;C<p;C++)E[C]=u[C];return E}return[]}function w(u,p){for(let C=1;C<arguments.length;C++){let B=arguments[C];var E=typeof B;if(E=E!="object"?E:B?Array.isArray(B)?"array":E:"null",E=="array"||E=="object"&&typeof B.length=="number"){E=u.length||0;let H=B.length||0;u.length=E+H;for(let ge=0;ge<H;ge++)u[E+ge]=B[ge]}else u.push(B)}}class S{constructor(p,E){this.i=p,this.j=E,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function k(u){s.setTimeout(()=>{throw u},0)}function V(){var u=O;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class q{constructor(){this.h=this.g=null}add(p,E){let C=ye.get();C.set(p,E),this.h?this.h.next=C:this.g=C,this.h=C}}var ye=new S(()=>new ve,u=>u.reset());class ve{constructor(){this.next=this.g=this.h=null}set(p,E){this.h=p,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,Ae=!1,O=new q,T=()=>{let u=Promise.resolve(void 0);xe=()=>{u.then(P)}};function P(){for(var u;u=V();){try{u.h.call(u.g)}catch(E){k(E)}var p=ye;p.j(u),p.h<100&&(p.h++,u.next=p.g,p.g=u)}Ae=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function x(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}x.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let E=()=>{};s.addEventListener("test",E,p),s.removeEventListener("test",E,p)}catch{}return u})();function M(u){return/^[\s\xa0]*$/.test(u)}function ae(u,p){x.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,p)}h(ae,x),ae.prototype.init=function(u,p){let E=this.type=u.type,C=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget,p||(E=="mouseover"?p=u.fromElement:E=="mouseout"&&(p=u.toElement)),this.relatedTarget=p,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);let u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var be="closure_listenable_"+(Math.random()*1e6|0),de=0;function Tt(u,p,E,C,B){this.listener=u,this.proxy=null,this.src=p,this.type=E,this.capture=!!C,this.ha=B,this.key=++de,this.da=this.fa=!1}function Xt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ne(u,p,E){for(let C in u)p.call(E,u[C],C,u)}function Wt(u,p){for(let E in u)p.call(void 0,u[E],E,u)}function lt(u){let p={};for(let E in u)p[E]=u[E];return p}let oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function se(u,p){let E,C;for(let B=1;B<arguments.length;B++){C=arguments[B];for(E in C)u[E]=C[E];for(let H=0;H<oe.length;H++)E=oe[H],Object.prototype.hasOwnProperty.call(C,E)&&(u[E]=C[E])}}function Ie(u){this.src=u,this.g={},this.h=0}Ie.prototype.add=function(u,p,E,C,B){let H=u.toString();u=this.g[H],u||(u=this.g[H]=[],this.h++);let ge=_e(u,p,C,B);return ge>-1?(p=u[ge],E||(p.fa=!1)):(p=new Tt(p,this.src,H,!!C,B),p.fa=E,u.push(p)),p};function Ee(u,p){let E=p.type;if(E in u.g){var C=u.g[E],B=Array.prototype.indexOf.call(C,p,void 0),H;(H=B>=0)&&Array.prototype.splice.call(C,B,1),H&&(Xt(p),u.g[E].length==0&&(delete u.g[E],u.h--))}}function _e(u,p,E,C){for(let B=0;B<u.length;++B){let H=u[B];if(!H.da&&H.listener==p&&H.capture==!!E&&H.ha==C)return B}return-1}var b="closure_lm_"+(Math.random()*1e6|0),ue={};function qe(u,p,E,C,B){if(C&&C.once)return wt(u,p,E,C,B);if(Array.isArray(p)){for(let H=0;H<p.length;H++)qe(u,p[H],E,C,B);return null}return E=Nc(E),u&&u[be]?u.J(p,E,a(C)?!!C.capture:!!C,B):Ke(u,p,E,!1,C,B)}function Ke(u,p,E,C,B,H){if(!p)throw Error("Invalid event type");let ge=a(B)?!!B.capture:!!B,Ze=zn(u);if(Ze||(u[b]=Ze=new Ie(u)),E=Ze.add(p,E,C,ge,H),E.proxy)return E;if(C=le(),E.proxy=C,C.src=u,C.listener=E,u.addEventListener)R||(B=ge),B===void 0&&(B=!1),u.addEventListener(p.toString(),C,B);else if(u.attachEvent)u.attachEvent(Ps(p.toString()),C);else if(u.addListener&&u.removeListener)u.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return E}function le(){function u(E){return p.call(u.src,u.listener,E)}let p=_h;return u}function wt(u,p,E,C,B){if(Array.isArray(p)){for(let H=0;H<p.length;H++)wt(u,p[H],E,C,B);return null}return E=Nc(E),u&&u[be]?u.K(p,E,a(C)?!!C.capture:!!C,B):Ke(u,p,E,!0,C,B)}function Ci(u,p,E,C,B){if(Array.isArray(p))for(var H=0;H<p.length;H++)Ci(u,p[H],E,C,B);else C=a(C)?!!C.capture:!!C,E=Nc(E),u&&u[be]?(u=u.i,H=String(p).toString(),H in u.g&&(p=u.g[H],E=_e(p,E,C,B),E>-1&&(Xt(p[E]),Array.prototype.splice.call(p,E,1),p.length==0&&(delete u.g[H],u.h--)))):u&&(u=zn(u))&&(p=u.g[p.toString()],u=-1,p&&(u=_e(p,E,C,B)),(E=u>-1?p[u]:null)&&li(E))}function li(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[be])Ee(p.i,u);else{var E=u.type,C=u.proxy;p.removeEventListener?p.removeEventListener(E,C,u.capture):p.detachEvent?p.detachEvent(Ps(E),C):p.addListener&&p.removeListener&&p.removeListener(C),(E=zn(p))?(Ee(E,u),E.h==0&&(E.src=null,p[b]=null)):Xt(u)}}}function Ps(u){return u in ue?ue[u]:ue[u]="on"+u}function _h(u,p){if(u.da)u=!0;else{p=new ae(p,this);let E=u.listener,C=u.ha||u.src;u.fa&&li(u),u=E.call(C,p)}return u}function zn(u){return u=u[b],u instanceof Ie?u:null}var kc="__closure_events_fn_"+(Math.random()*1e9>>>0);function Nc(u){return typeof u=="function"?u:(u[kc]||(u[kc]=function(p){return u.handleEvent(p)}),u[kc])}function kn(){I.call(this),this.i=new Ie(this),this.M=this,this.G=null}h(kn,I),kn.prototype[be]=!0,kn.prototype.removeEventListener=function(u,p,E,C){Ci(this,u,p,E,C)};function Ot(u,p){var E,C=u.G;if(C)for(E=[];C;C=C.G)E.push(C);if(u=u.M,C=p.type||p,typeof p=="string")p=new x(p,u);else if(p instanceof x)p.target=p.target||u;else{var B=p;p=new x(C,u),se(p,B)}B=!0;let H,ge;if(E)for(ge=E.length-1;ge>=0;ge--)H=p.g=E[ge],B=Yr(H,C,!0,p)&&B;if(H=p.g=u,B=Yr(H,C,!0,p)&&B,B=Yr(H,C,!1,p)&&B,E)for(ge=0;ge<E.length;ge++)H=p.g=E[ge],B=Yr(H,C,!1,p)&&B}kn.prototype.N=function(){if(kn.Z.N.call(this),this.i){var u=this.i;for(let p in u.g){let E=u.g[p];for(let C=0;C<E.length;C++)Xt(E[C]);delete u.g[p],u.h--}}this.G=null},kn.prototype.J=function(u,p,E,C){return this.i.add(String(u),p,!1,E,C)},kn.prototype.K=function(u,p,E,C){return this.i.add(String(u),p,!0,E,C)};function Yr(u,p,E,C){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();let B=!0;for(let H=0;H<p.length;++H){let ge=p[H];if(ge&&!ge.da&&ge.capture==E){let Ze=ge.listener,gn=ge.ha||ge.src;ge.fa&&Ee(u.i,ge),B=Ze.call(gn,C)!==!1&&B}}return B&&!C.defaultPrevented}function B0(u,p){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=c(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:s.setTimeout(u,p||0)}function pr(u){u.g=B0(()=>{u.g=null,u.i&&(u.i=!1,pr(u))},u.l);let p=u.h;u.h=null,u.m.apply(null,p)}class jo extends I{constructor(p,E){super(),this.m=p,this.l=E,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:pr(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Os(u){I.call(this),this.h=u,this.g={}}h(Os,I);var z=[];function U(u){Ne(u.g,function(p,E){this.g.hasOwnProperty(E)&&li(p)},u),u.g={}}Os.prototype.N=function(){Os.Z.N.call(this),U(this)},Os.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var te=s.JSON.stringify,ne=s.JSON.parse,Me=class{stringify(u){return s.JSON.stringify(u,void 0)}parse(u){return s.JSON.parse(u,void 0)}};function Ve(){}function et(){}var dt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function xt(){x.call(this,"d")}h(xt,x);function yt(){x.call(this,"c")}h(yt,x);var wn={},Ho=null;function Ya(){return Ho=Ho||new kn}wn.Ia="serverreachability";function Pc(u){x.call(this,wn.Ia,u)}h(Pc,x);function ci(u){let p=Ya();Ot(p,new Pc(p))}wn.STAT_EVENT="statevent";function Qr(u,p){x.call(this,wn.STAT_EVENT,u),this.stat=p}h(Qr,x);function qt(u){let p=Ya();Ot(p,new Qr(p,u))}wn.Ja="timingevent";function Eh(u,p){x.call(this,wn.Ja,u),this.size=p}h(Eh,x);function Jr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){u()},p)}function Xr(){this.g=!0}Xr.prototype.ua=function(){this.g=!1};function j0(u,p,E,C,B,H){u.info(function(){if(u.g)if(H){var ge="",Ze=H.split("&");for(let At=0;At<Ze.length;At++){var gn=Ze[At].split("=");if(gn.length>1){let Sn=gn[0];gn=gn[1];let mr=Sn.split("_");ge=mr.length>=2&&mr[1]=="type"?ge+(Sn+"="+gn+"&"):ge+(Sn+"=redacted&")}}}else ge=null;else ge=H;return"XMLHTTP REQ ("+C+") [attempt "+B+"]: "+p+`
`+E+`
`+ge})}function Qx(u,p,E,C,B,H,ge){u.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+B+"]: "+p+`
`+E+`
`+H+" "+ge})}function Gi(u,p,E,C){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+G0(u,E)+(C?" "+C:"")})}function H0(u,p){u.info(function(){return"TIMEOUT: "+p})}Xr.prototype.info=function(){};function G0(u,p){if(!u.g)return p;if(!p)return null;try{let H=JSON.parse(p);if(H){for(u=0;u<H.length;u++)if(Array.isArray(H[u])){var E=H[u];if(!(E.length<2)){var C=E[1];if(Array.isArray(C)&&!(C.length<1)){var B=C[0];if(B!="noop"&&B!="stop"&&B!="close")for(let ge=1;ge<C.length;ge++)C[ge]=""}}}}return te(H)}catch{return p}}var Ce={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ge={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Mt;function jt(){}h(jt,Ve),jt.prototype.g=function(){return new XMLHttpRequest},Mt=new jt;function Ft(u){return encodeURIComponent(String(u))}function xn(u){var p=1;u=u.split(":");let E=[];for(;p>0&&u.length;)E.push(u.shift()),p--;return u.length&&E.push(u.join(":")),E}function Lt(u,p,E,C){this.j=u,this.i=p,this.l=E,this.S=C||1,this.V=new Os(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Fs}function Fs(){this.i=null,this.g="",this.h=!1}var Jx={},$0={};function z0(u,p,E){u.M=1,u.A=wh(gr(p)),u.u=E,u.R=!0,Xx(u,null)}function Xx(u,p){u.F=Date.now(),bh(u),u.B=gr(u.A);var E=u.B,C=u.S;Array.isArray(C)||(C=[String(C)]),dS(E.i,"t",C),u.C=0,E=u.j.L,u.h=new Fs,u.g=AS(u.j,E?p:null,!u.u),u.P>0&&(u.O=new jo(c(u.Y,u,u.g),u.P)),p=u.V,E=u.g,C=u.ba;var B="readystatechange";Array.isArray(B)||(B&&(z[0]=B.toString()),B=z);for(let H=0;H<B.length;H++){let ge=qe(E,B[H],C||p.handleEvent,!1,p.h||p);if(!ge)break;p.g[ge.key]=ge}p=u.J?lt(u.J):{},u.u?(u.v||(u.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,p)):(u.v="GET",u.g.ea(u.B,u.v,null,p)),ci(),j0(u.i,u.v,u.B,u.l,u.S,u.u)}Lt.prototype.ba=function(u){u=u.target;let p=this.O;p&&zo(u)==3?p.j():this.Y(u)},Lt.prototype.Y=function(u){try{if(u==this.g)e:{let Ze=zo(this.g),gn=this.g.ya(),At=this.g.ca();if(!(Ze<3)&&(Ze!=3||this.g&&(this.h.h||this.g.la()||vS(this.g)))){this.K||Ze!=4||gn==7||(gn==8||At<=0?ci(3):ci(2)),W0(this);var p=this.g.ca();this.X=p;var E=zO(this);if(this.o=p==200,Qx(this.i,this.v,this.B,this.l,this.S,Ze,p),this.o){if(this.U&&!this.L){t:{if(this.g){var C,B=this.g;if((C=B.g?B.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(C)){var H=C;break t}}H=null}if(u=H)Gi(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,q0(this,u);else{this.o=!1,this.m=3,qt(12),Ls(this),Oc(this);break e}}if(this.R){u=!0;let Sn;for(;!this.K&&this.C<E.length;)if(Sn=WO(this,E),Sn==$0){Ze==4&&(this.m=4,qt(14),u=!1),Gi(this.i,this.l,null,"[Incomplete Response]");break}else if(Sn==Jx){this.m=4,qt(15),Gi(this.i,this.l,E,"[Invalid Chunk]"),u=!1;break}else Gi(this.i,this.l,Sn,null),q0(this,Sn);if(Zx(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||E.length!=0||this.h.h||(this.m=1,qt(16),u=!1),this.o=this.o&&u,!u)Gi(this.i,this.l,E,"[Invalid Chunked Response]"),Ls(this),Oc(this);else if(E.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),ey(ge),ge.P=!0,qt(11))}}else Gi(this.i,this.l,E,null),q0(this,E);Ze==4&&Ls(this),this.o&&!this.K&&(Ze==4?IS(this.j,this):(this.o=!1,bh(this)))}else s4(this.g),p==400&&E.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),Ls(this),Oc(this)}}}catch{}};function zO(u){if(!Zx(u))return u.g.la();let p=vS(u.g);if(p==="")return"";let E="",C=p.length,B=zo(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Ls(u),Oc(u),"";u.h.i=new s.TextDecoder}for(let H=0;H<C;H++)u.h.h=!0,E+=u.h.i.decode(p[H],{stream:!(B&&H==C-1)});return p.length=0,u.h.g+=E,u.C=0,u.h.g}function Zx(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function WO(u,p){var E=u.C,C=p.indexOf(`
`,E);return C==-1?$0:(E=Number(p.substring(E,C)),isNaN(E)?Jx:(C+=1,C+E>p.length?$0:(p=p.slice(C,C+E),u.C=C+E,p)))}Lt.prototype.cancel=function(){this.K=!0,Ls(this)};function bh(u){u.T=Date.now()+u.H,eS(u,u.H)}function eS(u,p){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Jr(c(u.aa,u),p)}function W0(u){u.D&&(s.clearTimeout(u.D),u.D=null)}Lt.prototype.aa=function(){this.D=null;let u=Date.now();u-this.T>=0?(H0(this.i,this.B),this.M!=2&&(ci(),qt(17)),Ls(this),this.m=2,Oc(this)):eS(this,this.T-u)};function Oc(u){u.j.I==0||u.K||IS(u.j,u)}function Ls(u){W0(u);var p=u.O;p&&typeof p.dispose=="function"&&p.dispose(),u.O=null,U(u.V),u.g&&(p=u.g,u.g=null,p.abort(),p.dispose())}function q0(u,p){try{var E=u.j;if(E.I!=0&&(E.g==u||K0(E.h,u))){if(!u.L&&K0(E.h,u)&&E.I==3){try{var C=E.Ba.g.parse(p)}catch{C=null}if(Array.isArray(C)&&C.length==3){var B=C;if(B[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<u.F)Dh(E),Th(E);else break e;Z0(E),qt(18)}}else E.xa=B[1],0<E.xa-E.K&&B[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Jr(c(E.Va,E),6e3));iS(E.h)<=1&&E.ta&&(E.ta=void 0)}else Us(E,11)}else if((u.L||E.g==u)&&Dh(E),!M(p))for(B=E.Ba.g.parse(p),p=0;p<B.length;p++){let At=B[p],Sn=At[0];if(!(Sn<=E.K))if(E.K=Sn,At=At[1],E.I==2)if(At[0]=="c"){E.M=At[1],E.ba=At[2];let mr=At[3];mr!=null&&(E.ka=mr,E.j.info("VER="+E.ka));let Bs=At[4];Bs!=null&&(E.za=Bs,E.j.info("SVER="+E.za));let Wo=At[5];Wo!=null&&typeof Wo=="number"&&Wo>0&&(C=1.5*Wo,E.O=C,E.j.info("backChannelRequestTimeoutMs_="+C)),C=E;let qo=u.g;if(qo){let Mh=qo.g?qo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mh){var H=C.h;H.g||Mh.indexOf("spdy")==-1&&Mh.indexOf("quic")==-1&&Mh.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(Y0(H,H.h),H.h=null))}if(C.G){let ty=qo.g?qo.g.getResponseHeader("X-HTTP-Session-Id"):null;ty&&(C.wa=ty,Vt(C.J,C.G,ty))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-u.F,E.j.info("Handshake RTT: "+E.T+"ms")),C=E;var ge=u;if(C.na=DS(C,C.L?C.ba:null,C.W),ge.L){rS(C.h,ge);var Ze=ge,gn=C.O;gn&&(Ze.H=gn),Ze.D&&(W0(Ze),bh(Ze)),C.g=ge}else xS(C);E.i.length>0&&Ch(E)}else At[0]!="stop"&&At[0]!="close"||Us(E,7);else E.I==3&&(At[0]=="stop"||At[0]=="close"?At[0]=="stop"?Us(E,7):X0(E):At[0]!="noop"&&E.l&&E.l.qa(At),E.A=0)}}ci(4)}catch{}}var qO=class{constructor(u,p){this.g=u,this.map=p}};function tS(u){this.l=u||10,s.PerformanceNavigationTiming?(u=s.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function nS(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function iS(u){return u.h?1:u.g?u.g.size:0}function K0(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Y0(u,p){u.g?u.g.add(p):u.h=p}function rS(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}tS.prototype.cancel=function(){if(this.i=oS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function oS(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let p=u.i;for(let E of u.g.values())p=p.concat(E.G);return p}return m(u.i)}var sS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function KO(u,p){if(u){u=u.split("&");for(let E=0;E<u.length;E++){let C=u[E].indexOf("="),B,H=null;C>=0?(B=u[E].substring(0,C),H=u[E].substring(C+1)):B=u[E],p(B,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Go(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;u instanceof Go?(this.l=u.l,Fc(this,u.j),this.o=u.o,this.g=u.g,Lc(this,u.u),this.h=u.h,Q0(this,hS(u.i)),this.m=u.m):u&&(p=String(u).match(sS))?(this.l=!1,Fc(this,p[1]||"",!0),this.o=Vc(p[2]||""),this.g=Vc(p[3]||"",!0),Lc(this,p[4]),this.h=Vc(p[5]||"",!0),Q0(this,p[6]||"",!0),this.m=Vc(p[7]||"")):(this.l=!1,this.i=new Bc(null,this.l))}Go.prototype.toString=function(){let u=[];var p=this.j;p&&u.push(Uc(p,aS,!0),":");var E=this.g;return(E||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Uc(p,aS,!0),"@"),u.push(Ft(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&u.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&u.push("/"),u.push(Uc(E,E.charAt(0)=="/"?JO:QO,!0))),(E=this.i.toString())&&u.push("?",E),(E=this.m)&&u.push("#",Uc(E,ZO)),u.join("")},Go.prototype.resolve=function(u){let p=gr(this),E=!!u.j;E?Fc(p,u.j):E=!!u.o,E?p.o=u.o:E=!!u.g,E?p.g=u.g:E=u.u!=null;var C=u.h;if(E)Lc(p,u.u);else if(E=!!u.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var B=p.h.lastIndexOf("/");B!=-1&&(C=p.h.slice(0,B+1)+C)}if(B=C,B==".."||B==".")C="";else if(B.indexOf("./")!=-1||B.indexOf("/.")!=-1){C=B.lastIndexOf("/",0)==0,B=B.split("/");let H=[];for(let ge=0;ge<B.length;){let Ze=B[ge++];Ze=="."?C&&ge==B.length&&H.push(""):Ze==".."?((H.length>1||H.length==1&&H[0]!="")&&H.pop(),C&&ge==B.length&&H.push("")):(H.push(Ze),C=!0)}C=H.join("/")}else C=B}return E?p.h=C:E=u.i.toString()!=="",E?Q0(p,hS(u.i)):E=!!u.m,E&&(p.m=u.m),p};function gr(u){return new Go(u)}function Fc(u,p,E){u.j=E?Vc(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Lc(u,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);u.u=p}else u.u=null}function Q0(u,p,E){p instanceof Bc?(u.i=p,e4(u.i,u.l)):(E||(p=Uc(p,XO)),u.i=new Bc(p,u.l))}function Vt(u,p,E){u.i.set(p,E)}function wh(u){return Vt(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function Vc(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Uc(u,p,E){return typeof u=="string"?(u=encodeURI(u).replace(p,YO),E&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function YO(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var aS=/[#\/\?@]/g,QO=/[#\?:]/g,JO=/[#\?]/g,XO=/[#\?@]/g,ZO=/#/g;function Bc(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Vs(u){u.g||(u.g=new Map,u.h=0,u.i&&KO(u.i,function(p,E){u.add(decodeURIComponent(p.replace(/\+/g," ")),E)}))}n=Bc.prototype,n.add=function(u,p){Vs(this),this.i=null,u=Qa(this,u);let E=this.g.get(u);return E||this.g.set(u,E=[]),E.push(p),this.h+=1,this};function lS(u,p){Vs(u),p=Qa(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function cS(u,p){return Vs(u),p=Qa(u,p),u.g.has(p)}n.forEach=function(u,p){Vs(this),this.g.forEach(function(E,C){E.forEach(function(B){u.call(p,B,C,this)},this)},this)};function uS(u,p){Vs(u);let E=[];if(typeof p=="string")cS(u,p)&&(E=E.concat(u.g.get(Qa(u,p))));else for(u=Array.from(u.g.values()),p=0;p<u.length;p++)E=E.concat(u[p]);return E}n.set=function(u,p){return Vs(this),this.i=null,u=Qa(this,u),cS(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=uS(this,u),u.length>0?String(u[0]):p):p};function dS(u,p,E){lS(u,p),E.length>0&&(u.i=null,u.g.set(Qa(u,p),m(E)),u.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],p=Array.from(this.g.keys());for(let C=0;C<p.length;C++){var E=p[C];let B=Ft(E);E=uS(this,E);for(let H=0;H<E.length;H++){let ge=B;E[H]!==""&&(ge+="="+Ft(E[H])),u.push(ge)}}return this.i=u.join("&")};function hS(u){let p=new Bc;return p.i=u.i,u.g&&(p.g=new Map(u.g),p.h=u.h),p}function Qa(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function e4(u,p){p&&!u.j&&(Vs(u),u.i=null,u.g.forEach(function(E,C){let B=C.toLowerCase();C!=B&&(lS(this,C),dS(this,B,E))},u)),u.j=p}function t4(u,p){let E=new Xr;if(s.Image){let C=new Image;C.onload=d($o,E,"TestLoadImage: loaded",!0,p,C),C.onerror=d($o,E,"TestLoadImage: error",!1,p,C),C.onabort=d($o,E,"TestLoadImage: abort",!1,p,C),C.ontimeout=d($o,E,"TestLoadImage: timeout",!1,p,C),s.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=u}else p(!1)}function n4(u,p){let E=new Xr,C=new AbortController,B=setTimeout(()=>{C.abort(),$o(E,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:C.signal}).then(H=>{clearTimeout(B),H.ok?$o(E,"TestPingServer: ok",!0,p):$o(E,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(B),$o(E,"TestPingServer: error",!1,p)})}function $o(u,p,E,C,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),C(E)}catch{}}function i4(){this.g=new Me}function xh(u){this.i=u.Sb||null,this.h=u.ab||!1}h(xh,Ve),xh.prototype.g=function(){return new Sh(this.i,this.h)};function Sh(u,p){kn.call(this),this.H=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(Sh,kn),n=Sh.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=p,this.readyState=1,Hc(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(p.body=u),(this.H||s).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,jc(this)),this.readyState=0},n.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Hc(this)),this.g&&(this.readyState=3,Hc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;fS(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function fS(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}n.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?jc(this):Hc(this),this.readyState==3&&fS(this)}},n.Oa=function(u){this.g&&(this.response=this.responseText=u,jc(this))},n.Na=function(u){this.g&&(this.response=u,jc(this))},n.ga=function(){this.g&&jc(this)};function jc(u){u.readyState=4,u.l=null,u.j=null,u.B=null,Hc(u)}n.setRequestHeader=function(u,p){this.A.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],p=this.h.entries();for(var E=p.next();!E.done;)E=E.value,u.push(E[0]+": "+E[1]),E=p.next();return u.join(`\r
`)};function Hc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Sh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function pS(u){let p="";return Ne(u,function(E,C){p+=C,p+=":",p+=E,p+=`\r
`}),p}function J0(u,p,E){e:{for(C in E){var C=!1;break e}C=!0}C||(E=pS(E),typeof u=="string"?E!=null&&Ft(E):Vt(u,p,E))}function Kt(u){kn.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Kt,kn);var r4=/^https?$/i,o4=["POST","PUT"];n=Kt.prototype,n.Fa=function(u){this.H=u},n.ea=function(u,p,E,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Mt.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(H){gS(this,H);return}if(u=E||"",E=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var B in C)E.set(B,C[B]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(let H of C.keys())E.set(H,C.get(H));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(E.keys()).find(H=>H.toLowerCase()=="content-type"),B=s.FormData&&u instanceof s.FormData,!(Array.prototype.indexOf.call(o4,p,void 0)>=0)||C||B||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[H,ge]of E)this.g.setRequestHeader(H,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(H){gS(this,H)}};function gS(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.o=5,mS(u),Ih(u)}function mS(u){u.A||(u.A=!0,Ot(u,"complete"),Ot(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,Ot(this,"complete"),Ot(this,"abort"),Ih(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ih(this,!0)),Kt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?yS(this):this.Xa())},n.Xa=function(){yS(this)};function yS(u){if(u.h&&typeof o<"u"){if(u.v&&zo(u)==4)setTimeout(u.Ca.bind(u),0);else if(Ot(u,"readystatechange"),zo(u)==4){u.h=!1;try{let H=u.ca();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var E;if(!(E=p)){var C;if(C=H===0){let ge=String(u.D).match(sS)[1]||null;!ge&&s.self&&s.self.location&&(ge=s.self.location.protocol.slice(0,-1)),C=!r4.test(ge?ge.toLowerCase():"")}E=C}if(E)Ot(u,"complete"),Ot(u,"success");else{u.o=6;try{var B=zo(u)>2?u.g.statusText:""}catch{B=""}u.l=B+" ["+u.ca()+"]",mS(u)}}finally{Ih(u)}}}}function Ih(u,p){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);let E=u.g;u.g=null,p||Ot(u,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function zo(u){return u.g?u.g.readyState:0}n.ca=function(){try{return zo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),ne(p)}};function vS(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function s4(u){let p={};u=(u.g&&zo(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<u.length;C++){if(M(u[C]))continue;var E=xn(u[C]);let B=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();let H=p[B]||[];p[B]=H,H.push(E)}Wt(p,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gc(u,p,E){return E&&E.internalChannelParams&&E.internalChannelParams[u]||p}function _S(u){this.za=0,this.i=[],this.j=new Xr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Gc("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Gc("baseRetryDelayMs",5e3,u),this.Za=Gc("retryDelaySeedMs",1e4,u),this.Ta=Gc("forwardChannelMaxRetries",2,u),this.va=Gc("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new tS(u&&u.concurrentRequestLimit),this.Ba=new i4,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=_S.prototype,n.ka=8,n.I=1,n.connect=function(u,p,E,C){qt(0),this.W=u,this.H=p||{},E&&C!==void 0&&(this.H.OSID=E,this.H.OAID=C),this.F=this.X,this.J=DS(this,null,this.W),Ch(this)};function X0(u){if(ES(u),u.I==3){var p=u.V++,E=gr(u.J);if(Vt(E,"SID",u.M),Vt(E,"RID",p),Vt(E,"TYPE","terminate"),$c(u,E),p=new Lt(u,u.j,p),p.M=2,p.A=wh(gr(E)),E=!1,s.navigator&&s.navigator.sendBeacon)try{E=s.navigator.sendBeacon(p.A.toString(),"")}catch{}!E&&s.Image&&(new Image().src=p.A,E=!0),E||(p.g=AS(p.j,null),p.g.ea(p.A)),p.F=Date.now(),bh(p)}CS(u)}function Th(u){u.g&&(ey(u),u.g.cancel(),u.g=null)}function ES(u){Th(u),u.v&&(s.clearTimeout(u.v),u.v=null),Dh(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&s.clearTimeout(u.m),u.m=null)}function Ch(u){if(!nS(u.h)&&!u.m){u.m=!0;var p=u.Ea;xe||T(),Ae||(xe(),Ae=!0),O.add(p,u),u.D=0}}function a4(u,p){return iS(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=p.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Jr(c(u.Ea,u,p),TS(u,u.D)),u.D++,!0)}n.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;let B=new Lt(this,this.j,u),H=this.o;if(this.U&&(H?(H=lt(H),se(H,this.U)):H=this.U),this.u!==null||this.R||(B.J=H,H=null),this.S)e:{for(var p=0,E=0;E<this.i.length;E++){t:{var C=this.i[E];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(p+=C,p>4096){p=E;break e}if(p===4096||E===this.i.length-1){p=E+1;break e}}p=1e3}else p=1e3;p=wS(this,B,p),E=gr(this.J),Vt(E,"RID",u),Vt(E,"CVER",22),this.G&&Vt(E,"X-HTTP-Session-Id",this.G),$c(this,E),H&&(this.R?p="headers="+Ft(pS(H))+"&"+p:this.u&&J0(E,this.u,H)),Y0(this.h,B),this.Ra&&Vt(E,"TYPE","init"),this.S?(Vt(E,"$req",p),Vt(E,"SID","null"),B.U=!0,z0(B,E,null)):z0(B,E,p),this.I=2}}else this.I==3&&(u?bS(this,u):this.i.length==0||nS(this.h)||bS(this))};function bS(u,p){var E;p?E=p.l:E=u.V++;let C=gr(u.J);Vt(C,"SID",u.M),Vt(C,"RID",E),Vt(C,"AID",u.K),$c(u,C),u.u&&u.o&&J0(C,u.u,u.o),E=new Lt(u,u.j,E,u.D+1),u.u===null&&(E.J=u.o),p&&(u.i=p.G.concat(u.i)),p=wS(u,E,1e3),E.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),Y0(u.h,E),z0(E,C,p)}function $c(u,p){u.H&&Ne(u.H,function(E,C){Vt(p,C,E)}),u.l&&Ne({},function(E,C){Vt(p,C,E)})}function wS(u,p,E){E=Math.min(u.i.length,E);let C=u.l?c(u.l.Ka,u.l,u):null;e:{var B=u.i;let Ze=-1;for(;;){let gn=["count="+E];Ze==-1?E>0?(Ze=B[0].g,gn.push("ofs="+Ze)):Ze=0:gn.push("ofs="+Ze);let At=!0;for(let Sn=0;Sn<E;Sn++){var H=B[Sn].g;let mr=B[Sn].map;if(H-=Ze,H<0)Ze=Math.max(0,B[Sn].g-100),At=!1;else try{H="req"+H+"_"||"";try{var ge=mr instanceof Map?mr:Object.entries(mr);for(let[Bs,Wo]of ge){let qo=Wo;a(Wo)&&(qo=te(Wo)),gn.push(H+Bs+"="+encodeURIComponent(qo))}}catch(Bs){throw gn.push(H+"type="+encodeURIComponent("_badmap")),Bs}}catch{C&&C(mr)}}if(At){ge=gn.join("&");break e}}ge=void 0}return u=u.i.splice(0,E),p.G=u,ge}function xS(u){if(!u.g&&!u.v){u.Y=1;var p=u.Da;xe||T(),Ae||(xe(),Ae=!0),O.add(p,u),u.A=0}}function Z0(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Jr(c(u.Da,u),TS(u,u.A)),u.A++,!0)}n.Da=function(){if(this.v=null,SS(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Jr(c(this.Wa,this),u)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),Th(this),SS(this))};function ey(u){u.B!=null&&(s.clearTimeout(u.B),u.B=null)}function SS(u){u.g=new Lt(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var p=gr(u.na);Vt(p,"RID","rpc"),Vt(p,"SID",u.M),Vt(p,"AID",u.K),Vt(p,"CI",u.F?"0":"1"),!u.F&&u.ia&&Vt(p,"TO",u.ia),Vt(p,"TYPE","xmlhttp"),$c(u,p),u.u&&u.o&&J0(p,u.u,u.o),u.O&&(u.g.H=u.O);var E=u.g;u=u.ba,E.M=1,E.A=wh(gr(p)),E.u=null,E.R=!0,Xx(E,u)}n.Va=function(){this.C!=null&&(this.C=null,Th(this),Z0(this),qt(19))};function Dh(u){u.C!=null&&(s.clearTimeout(u.C),u.C=null)}function IS(u,p){var E=null;if(u.g==p){Dh(u),ey(u),u.g=null;var C=2}else if(K0(u.h,p))E=p.G,rS(u.h,p),C=1;else return;if(u.I!=0){if(p.o)if(C==1){E=p.u?p.u.length:0,p=Date.now()-p.F;var B=u.D;C=Ya(),Ot(C,new Eh(C,E)),Ch(u)}else xS(u);else if(B=p.m,B==3||B==0&&p.X>0||!(C==1&&a4(u,p)||C==2&&Z0(u)))switch(E&&E.length>0&&(p=u.h,p.i=p.i.concat(E)),B){case 1:Us(u,5);break;case 4:Us(u,10);break;case 3:Us(u,6);break;default:Us(u,2)}}}function TS(u,p){let E=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(E*=2),E*p}function Us(u,p){if(u.j.info("Error code "+p),p==2){var E=c(u.bb,u),C=u.Ua;let B=!C;C=new Go(C||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Fc(C,"https"),wh(C),B?t4(C.toString(),E):n4(C.toString(),E)}else qt(2);u.I=0,u.l&&u.l.pa(p),CS(u),ES(u)}n.bb=function(u){u?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function CS(u){if(u.I=0,u.ja=[],u.l){let p=oS(u.h);(p.length!=0||u.i.length!=0)&&(w(u.ja,p),w(u.ja,u.i),u.h.i.length=0,m(u.i),u.i.length=0),u.l.oa()}}function DS(u,p,E){var C=E instanceof Go?gr(E):new Go(E);if(C.g!="")p&&(C.g=p+"."+C.g),Lc(C,C.u);else{var B=s.location;C=B.protocol,p=p?p+"."+B.hostname:B.hostname,B=+B.port;let H=new Go(null);C&&Fc(H,C),p&&(H.g=p),B&&Lc(H,B),E&&(H.h=E),C=H}return E=u.G,p=u.wa,E&&p&&Vt(C,E,p),Vt(C,"VER",u.ka),$c(u,C),C}function AS(u,p,E){if(p&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Aa&&!u.ma?new Kt(new xh({ab:E})):new Kt(u.ma),p.Fa(u.L),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function MS(){}n=MS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ah(){}Ah.prototype.g=function(u,p){return new ui(u,p)};function ui(u,p){kn.call(this),this.g=new _S(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(u?u["X-WebChannel-Client-Profile"]=p.sa:u={"X-WebChannel-Client-Profile":p.sa}),this.g.U=u,(u=p&&p.Qb)&&!M(u)&&(this.g.u=u),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!M(p)&&(this.g.G=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ja(this)}h(ui,kn),ui.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ui.prototype.close=function(){X0(this.g)},ui.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var E={};E.__data__=u,u=E}else this.v&&(E={},E.__data__=te(u),u=E);p.i.push(new qO(p.Ya++,u)),p.I==3&&Ch(p)},ui.prototype.N=function(){this.g.l=null,delete this.j,X0(this.g),delete this.g,ui.Z.N.call(this)};function RS(u){xt.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(let E in p){u=E;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}h(RS,xt);function kS(){yt.call(this),this.status=1}h(kS,yt);function Ja(u){this.g=u}h(Ja,MS),Ja.prototype.ra=function(){Ot(this.g,"a")},Ja.prototype.qa=function(u){Ot(this.g,new RS(u))},Ja.prototype.pa=function(u){Ot(this.g,new kS)},Ja.prototype.oa=function(){Ot(this.g,"b")},Ah.prototype.createWebChannel=Ah.prototype.g,ui.prototype.send=ui.prototype.o,ui.prototype.open=ui.prototype.m,ui.prototype.close=ui.prototype.close,tw=wo.createWebChannelTransport=function(){return new Ah},ew=wo.getStatEventTarget=function(){return Ya()},Zb=wo.Event=wn,Jg=wo.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ce.NO_ERROR=0,Ce.TIMEOUT=8,Ce.HTTP_ERROR=6,Id=wo.ErrorCode=Ce,Ge.COMPLETE="complete",Xb=wo.EventType=Ge,et.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",kn.prototype.listen=kn.prototype.J,Jl=wo.WebChannel=et,P9=wo.FetchXmlHttpFactory=xh,Kt.prototype.listenOnce=Kt.prototype.K,Kt.prototype.getLastError=Kt.prototype.Ha,Kt.prototype.getLastErrorCode=Kt.prototype.ya,Kt.prototype.getStatus=Kt.prototype.ca,Kt.prototype.getResponseJson=Kt.prototype.La,Kt.prototype.getResponseText=Kt.prototype.la,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Fa,Jb=wo.XhrIo=Kt}).apply(typeof Qg<"u"?Qg:typeof self<"u"?self:typeof window<"u"?window:{});var An=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");var pc="12.8.0";function xk(n){pc=n}var Ra=new Es("@firebase/firestore");function Xl(){return Ra.logLevel}function De(n,...e){if(Ra.logLevel<=nt.DEBUG){let t=e.map(N1);Ra.debug(`Firestore (${pc}): ${n}`,...t)}}function To(n,...e){if(Ra.logLevel<=nt.ERROR){let t=e.map(N1);Ra.error(`Firestore (${pc}): ${n}`,...t)}}function Ss(n,...e){if(Ra.logLevel<=nt.WARN){let t=e.map(N1);Ra.warn(`Firestore (${pc}): ${n}`,...t)}}function N1(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Le(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Sk(n,i,t)}function Sk(n,e,t){let i=`FIRESTORE (${pc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw To(i),new Error(i)}function bt(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Sk(e,r,i)}function We(n,e){return n}var J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},fe=class extends Si{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var cr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var rm=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},om=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(An.UNAUTHENTICATED))}shutdown(){}},aw=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},sm=class{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){bt(this.o===void 0,42304);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),o=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new cr,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{De("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(De("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new cr)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(De("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(bt(typeof i.accessToken=="string",31837,{l:i}),new rm(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return bt(e===null||typeof e=="string",2055,{h:e}),new An(e)}},lw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=An.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},cw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new lw(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(An.FIRST_PARTY))}shutdown(){}invalidateToken(){}},am=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},lm=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ii(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){bt(this.o===void 0,3512);let i=o=>{o.error!=null&&De("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,De("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{De("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):De("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new am(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(bt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new am(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function O9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var ka=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=O9(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}};function ot(n,e){return n<e?-1:n>e?1:0}function uw(n,e){let t=Math.min(n.length,e.length);for(let i=0;i<t;i++){let r=n.charAt(i),o=e.charAt(i);if(r!==o)return nw(r)===nw(o)?ot(r,o):nw(r)?1:-1}return ot(n.length,e.length)}var F9=55296,L9=57343;function nw(n){let e=n.charCodeAt(0);return e>=F9&&e<=L9}function rc(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var VR="__name__",cm=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Le(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return ot(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):uw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bo.fromString(e.substring(4,e.length-2))}},Pt=class n extends cm{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new fe(J.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},V9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=class n extends cm{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return V9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===VR}static keyField(){return new n([VR])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new fe(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new fe(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new fe(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(s=!s,r++):a!=="."||s?(i+=a,r++):(o(),r++)}if(o(),s)throw new fe(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Pe=class n{constructor(e){this.path=e}static fromPath(e){return new n(Pt.fromString(e))}static fromName(e){return new n(Pt.fromString(e).popFirst(5))}static empty(){return new n(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Pt(e.slice()))}};function Ik(n,e,t){if(!t)throw new fe(J.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Tk(n,e,t,i){if(e===!0&&i===!0)throw new fe(J.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function UR(n){if(!Pe.isDocumentKey(n))throw new fe(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function BR(n){if(Pe.isDocumentKey(n))throw new fe(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ck(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function zd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function zr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new fe(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=zd(n);throw new fe(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Dk(n,e){if(e<=0)throw new fe(J.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function on(n,e){let t={typeString:n};return e&&(t.value=e),t}function gc(n,e){if(!Ck(n))throw new fe(J.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let s=n[i];if(r&&typeof s!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new fe(J.INVALID_ARGUMENT,t);return!0}var jR=-62135596800,HR=1e6,sn=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*HR);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<jR)throw new fe(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/HR}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gc(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-jR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};sn._jsonSchemaVersion="firestore/timestamp/1.0",sn._jsonSchema={type:on("string",sn._jsonSchemaVersion),seconds:on("number"),nanoseconds:on("number")};var Xe=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new sn(0,0))}static max(){return new n(new sn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Rd=-1,um=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};um.UNKNOWN_ID=-1;function U9(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Xe.fromTimestamp(i===1e9?new sn(t+1,0):new sn(t,i));return new Na(r,Pe.empty(),e)}function B9(n){return new Na(n.readTime,n.key,Rd)}var Na=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Xe.min(),Pe.empty(),Rd)}static max(){return new n(Xe.max(),Pe.empty(),Rd)}};function j9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Pe.comparator(n.documentKey,e.documentKey),t!==0?t:ot(n.largestBatchId,e.largestBatchId))}var H9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",dw=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function mc(n){if(n.code!==J.FAILED_PRECONDITION||n.message!==H9)throw n;De("LocalStore","Unexpectedly lost primary lease")}var re=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(a=>{++r,a.next(()=>{++o,s&&o===r&&t()},l=>i(l))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let c=l;t(e[c]).next(d=>{s[c]=d,++a,a===o&&i(s)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};function G9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function yc(n){return n.name==="IndexedDbTransactionError"}var P1=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),O1=-1;function Vm(n){return n==null}function kd(n){return n===0&&1/n==-1/0}function $9(n){return typeof n=="number"&&Number.isInteger(n)&&!kd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Ak="";function z9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=GR(e)),e=W9(n.get(t),e);return GR(e)}function W9(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case Ak:t+="";break;default:t+=o}}return t}function GR(n){return n+Ak+""}var q9="remoteDocuments",Mk="owner";var Rk="mutationQueues";var kk="mutations";var Nk="documentMutations",K9="remoteDocumentsV14";var Pk="remoteDocumentGlobal";var Ok="targets";var Fk="targetDocuments";var Lk="targetGlobal",Vk="collectionParents";var Uk="clientMetadata";var Bk="bundles";var jk="namedQueries";var Y9="indexConfiguration";var Q9="indexState";var J9="indexEntries";var Hk="documentOverlays";var X9="globals";var Z9=[Rk,kk,Nk,q9,Ok,Mk,Lk,Fk,Uk,Pk,Vk,Bk,jk],Mde=[...Z9,Hk],e7=[Rk,kk,Nk,K9,Ok,Mk,Lk,Fk,Uk,Pk,Vk,Bk,jk,Hk],t7=e7,n7=[...t7,Y9,Q9,J9];var Rde=[...n7,X9];function $R(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ba(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Gk(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Jt=class n{constructor(e,t){this.comparator=e,this.root=t||Ur.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ur.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ur.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nc(this.root,e,this.comparator,!1)}getReverseIterator(){return new nc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nc(this.root,e,this.comparator,!0)}},nc=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ur=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}};Ur.EMPTY=null,Ur.RED=!0,Ur.BLACK=!1;Ur.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Ur(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Mn=class n{constructor(e){this.comparator=e,this.data=new Jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dm(this.data.getIterator())}getIteratorFrom(e){return new dm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},dm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Vr=class n{constructor(e){this.fields=e,e.sort(si.comparator)}static empty(){return new n([])}unionWith(e){let t=new Mn(si.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rc(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var hm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ln=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new hm("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ln.EMPTY_BYTE_STRING=new Ln("");var i7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Co(n){if(bt(!!n,39018),typeof n=="string"){let e=0,t=i7.exec(n);if(bt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$t(n.seconds),nanos:$t(n.nanos)}}function $t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Do(n){return typeof n=="string"?Ln.fromBase64String(n):Ln.fromUint8Array(n)}var $k="server_timestamp",zk="__type__",Wk="__previous_value__",qk="__local_write_time__";function Wd(n){return(n?.mapValue?.fields||{})[zk]?.stringValue===$k}function Um(n){let e=n.mapValue.fields[Wk];return Wd(e)?Um(e):e}function Nd(n){let e=Co(n.mapValue.fields[qk].timestampValue);return new sn(e.seconds,e.nanos)}var hw=class{constructor(e,t,i,r,o,s,a,l,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=d,this.apiKey=h}},fm="(default)",Pd=class n{constructor(e,t){this.projectId=e,this.database=t||fm}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===fm}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function Kk(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new fe(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pd(n.options.projectId,e)}var F1="__type__",Yk="__max__",Xg={mapValue:{fields:{__type__:{stringValue:Yk}}}},L1="__vector__",oc="value";function Is(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Wd(n)?4:Jk(n)?9007199254740991:Qk(n)?10:11:Le(28295,{value:n})}function $r(n,e){if(n===e)return!0;let t=Is(n);if(t!==Is(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Nd(n).isEqual(Nd(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=Co(r.timestampValue),a=Co(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return Do(r.bytesValue).isEqual(Do(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return $t(r.geoPointValue.latitude)===$t(o.geoPointValue.latitude)&&$t(r.geoPointValue.longitude)===$t(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return $t(r.integerValue)===$t(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=$t(r.doubleValue),a=$t(o.doubleValue);return s===a?kd(s)===kd(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return rc(n.arrayValue.values||[],e.arrayValue.values||[],$r);case 10:case 11:return(function(r,o){let s=r.mapValue.fields||{},a=o.mapValue.fields||{};if($R(s)!==$R(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!$r(s[l],a[l])))return!1;return!0})(n,e);default:return Le(52216,{left:n})}}function Od(n,e){return(n.values||[]).find(t=>$r(t,e))!==void 0}function sc(n,e){if(n===e)return 0;let t=Is(n),i=Is(e);if(t!==i)return ot(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ot(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=$t(o.integerValue||o.doubleValue),l=$t(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return zR(n.timestampValue,e.timestampValue);case 4:return zR(Nd(n),Nd(e));case 5:return uw(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=Do(o),l=Do(s);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){let d=ot(a[c],l[c]);if(d!==0)return d}return ot(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=ot($t(o.latitude),$t(s.latitude));return a!==0?a:ot($t(o.longitude),$t(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return WR(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},l=s.fields||{},c=a[oc]?.arrayValue,d=l[oc]?.arrayValue,h=ot(c?.values?.length||0,d?.values?.length||0);return h!==0?h:WR(c,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===Xg.mapValue&&s===Xg.mapValue)return 0;if(o===Xg.mapValue)return 1;if(s===Xg.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),c=s.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let f=uw(l[h],d[h]);if(f!==0)return f;let m=sc(a[l[h]],c[d[h]]);if(m!==0)return m}return ot(l.length,d.length)})(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function zR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ot(n,e);let t=Co(n),i=Co(e),r=ot(t.seconds,i.seconds);return r!==0?r:ot(t.nanos,i.nanos)}function WR(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=sc(t[r],i[r]);if(o)return o}return ot(t.length,i.length)}function ac(n){return fw(n)}function fw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=Co(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Do(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=fw(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${fw(t.fields[s])}`;return r+"}"})(n.mapValue):Le(61005,{value:n})}function tm(n){switch(Is(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Um(n);return e?16+tm(e):16;case 5:return 2*n.stringValue.length;case 6:return Do(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,o)=>r+tm(o),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ba(i.fields,(o,s)=>{r+=o.length+tm(s)}),r})(n.mapValue);default:throw Le(13486,{value:n})}}function qd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function pw(n){return!!n&&"integerValue"in n}function V1(n){return!!n&&"arrayValue"in n}function qR(n){return!!n&&"nullValue"in n}function KR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function nm(n){return!!n&&"mapValue"in n}function Qk(n){return(n?.mapValue?.fields||{})[F1]?.stringValue===L1}function Dd(n){if(n.geoPointValue)return{geoPointValue:F({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:F({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ba(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Dd(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dd(n.arrayValue.values[t]);return e}return F({},n)}function Jk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Yk}var Nde={mapValue:{fields:{[F1]:{stringValue:L1},[oc]:{arrayValue:{}}}}};var ji=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!nm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dd(t)}setAll(e){let t=si.emptyPath(),i={},r=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}s?i[a.lastSegment()]=Dd(s):r.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());nm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $r(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];nm(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ba(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(Dd(this.value))}};function Xk(n){let e=[];return Ba(n.fields,(t,i)=>{let r=new si([t]);if(nm(i)){let o=Xk(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new Vr(e)}var ur=class n{constructor(e,t,i,r,o,s,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Xe.min(),Xe.min(),Xe.min(),ji.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Xe.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Xe.min(),Xe.min(),ji.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Xe.min(),Xe.min(),ji.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ji.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ji.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ao=class{constructor(e,t){this.position=e,this.inclusive=t}};function YR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=Pe.comparator(Pe.fromName(s.referenceValue),t.key):i=sc(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function QR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$r(n.position[t],e.position[t]))return!1;return!0}var Ts=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function r7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var pm=class{},rn=class n extends pm{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new mw(e,t,i):t==="array-contains"?new _w(e,i):t==="in"?new Ew(e,i):t==="not-in"?new bw(e,i):t==="array-contains-any"?new ww(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new yw(e,i):new vw(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sc(t,this.value)):t!==null&&Is(this.value)===Is(t)&&this.matchesComparison(sc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Hi=class n extends pm{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return Zk(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function Zk(n){return n.op==="and"}function eN(n){return o7(n)&&Zk(n)}function o7(n){for(let e of n.filters)if(e instanceof Hi)return!1;return!0}function gw(n){if(n instanceof rn)return n.field.canonicalString()+n.op.toString()+ac(n.value);if(eN(n))return n.filters.map(e=>gw(e)).join(",");{let e=n.filters.map(t=>gw(t)).join(",");return`${n.op}(${e})`}}function tN(n,e){return n instanceof rn?(function(i,r){return r instanceof rn&&i.op===r.op&&i.field.isEqual(r.field)&&$r(i.value,r.value)})(n,e):n instanceof Hi?(function(i,r){return r instanceof Hi&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,a)=>o&&tN(s,r.filters[a]),!0):!1})(n,e):void Le(19439)}function nN(n){return n instanceof rn?(function(t){return`${t.field.canonicalString()} ${t.op} ${ac(t.value)}`})(n):n instanceof Hi?(function(t){return t.op.toString()+" {"+t.getFilters().map(nN).join(" ,")+"}"})(n):"Filter"}var mw=class extends rn{constructor(e,t,i){super(e,t,i),this.key=Pe.fromName(i.referenceValue)}matches(e){let t=Pe.comparator(e.key,this.key);return this.matchesComparison(t)}},yw=class extends rn{constructor(e,t){super(e,"in",t),this.keys=iN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},vw=class extends rn{constructor(e,t){super(e,"not-in",t),this.keys=iN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function iN(n,e){return(e.arrayValue?.values||[]).map(t=>Pe.fromName(t.referenceValue))}var _w=class extends rn{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return V1(t)&&Od(t.arrayValue,this.value)}},Ew=class extends rn{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Od(this.value.arrayValue,t)}},bw=class extends rn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Od(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Od(this.value.arrayValue,t)}},ww=class extends rn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!V1(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Od(this.value.arrayValue,i))}};var xw=class{constructor(e,t=null,i=[],r=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function JR(n,e=null,t=[],i=[],r=null,o=null,s=null){return new xw(n,e,t,i,r,o,s)}function U1(n){let e=We(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>gw(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(o){return o.field.canonicalString()+o.dir})(i)).join(","),Vm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ac(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ac(i)).join(",")),e.Te=t}return e.Te}function B1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!r7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!tN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!QR(n.startAt,e.startAt)&&QR(n.endAt,e.endAt)}function Sw(n){return Pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Mo=class{constructor(e,t=null,i=[],r=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function s7(n,e,t,i,r,o,s,a){return new Mo(n,e,t,i,r,o,s,a)}function Bm(n){return new Mo(n)}function XR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function a7(n){return Pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function jm(n){return n.collectionGroup!==null}function Ma(n){let e=We(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Mn(si.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Ts(o,i))}),t.has(si.keyField().canonicalString())||e.Ie.push(new Ts(si.keyField(),i))}return e.Ie}function Br(n){let e=We(n);return e.Ee||(e.Ee=l7(e,Ma(n))),e.Ee}function l7(n,e){if(n.limitType==="F")return JR(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new Ts(r.field,o)});let t=n.endAt?new Ao(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ao(n.startAt.position,n.startAt.inclusive):null;return JR(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Hm(n,e){let t=n.filters.concat([e]);return new Mo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function rN(n,e){let t=n.explicitOrderBy.concat([e]);return new Mo(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Fd(n,e,t){return new Mo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function oN(n,e){return new Mo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Gm(n,e){return B1(Br(n),Br(e))&&n.limitType===e.limitType}function sN(n){return`${U1(Br(n))}|lt:${n.limitType}`}function Zl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>nN(r)).join(", ")}]`),Vm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>ac(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>ac(r)).join(",")),`Target(${i})`})(Br(n))}; limitType=${n.limitType})`}function $m(n,e){return e.isFoundDocument()&&(function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Pe.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(let o of Ma(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(s,a,l){let c=YR(s,a,l);return s.inclusive?c<=0:c<0})(i.startAt,Ma(i),r)||i.endAt&&!(function(s,a,l){let c=YR(s,a,l);return s.inclusive?c>=0:c>0})(i.endAt,Ma(i),r))})(n,e)}function c7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function aN(n){return(e,t)=>{let i=!1;for(let r of Ma(n)){let o=u7(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function u7(n,e,t){let i=n.field.isKeyField()?Pe.comparator(e.key,t.key):(function(o,s,a){let l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?sc(l,c):Le(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Le(19790,{direction:n.dir})}}var Ro=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ba(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return Gk(this.inner)}size(){return this.innerSize}};var d7=new Jt(Pe.comparator);function ko(){return d7}var lN=new Jt(Pe.comparator);function Cd(...n){let e=lN;for(let t of n)e=e.insert(t.key,t);return e}function cN(n){let e=lN;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Da(){return Ad()}function uN(){return Ad()}function Ad(){return new Ro(n=>n.toString(),(n,e)=>n.isEqual(e))}var h7=new Jt(Pe.comparator),f7=new Mn(Pe.comparator);function it(...n){let e=f7;for(let t of n)e=e.add(t);return e}var p7=new Mn(ot);function g7(){return p7}function j1(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kd(e)?"-0":e}}function dN(n){return{integerValue:""+n}}function m7(n,e){return $9(e)?dN(e):j1(n,e)}var lc=class{constructor(){this._=void 0}};function y7(n,e,t){return n instanceof Pa?(function(r,o){let s={fields:{[zk]:{stringValue:$k},[qk]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Wd(o)&&(o=Um(o)),o&&(s.fields[Wk]=o),{mapValue:s}})(t,e):n instanceof Oa?fN(n,e):n instanceof Fa?pN(n,e):(function(r,o){let s=hN(r,o),a=ZR(s)+ZR(r.Ae);return pw(s)&&pw(r.Ae)?dN(a):j1(r.serializer,a)})(n,e)}function v7(n,e,t){return n instanceof Oa?fN(n,e):n instanceof Fa?pN(n,e):t}function hN(n,e){return n instanceof cc?(function(i){return pw(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}var Pa=class extends lc{},Oa=class extends lc{constructor(e){super(),this.elements=e}};function fN(n,e){let t=gN(e);for(let i of n.elements)t.some(r=>$r(r,i))||t.push(i);return{arrayValue:{values:t}}}var Fa=class extends lc{constructor(e){super(),this.elements=e}};function pN(n,e){let t=gN(e);for(let i of n.elements)t=t.filter(r=>!$r(r,i));return{arrayValue:{values:t}}}var cc=class extends lc{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function ZR(n){return $t(n.integerValue||n.doubleValue)}function gN(n){return V1(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Iw=class{constructor(e,t){this.field=e,this.transform=t}};function _7(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Oa&&r instanceof Oa||i instanceof Fa&&r instanceof Fa?rc(i.elements,r.elements,$r):i instanceof cc&&r instanceof cc?$r(i.Ae,r.Ae):i instanceof Pa&&r instanceof Pa})(n.transform,e.transform)}var Tw=class{constructor(e,t){this.version=e,this.transformResults=t}},xo=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function im(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var uc=class{};function mN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ld(n.key,xo.none()):new La(n.key,n.data,xo.none());{let t=n.data,i=ji.empty(),r=new Mn(si.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new No(n.key,i,new Vr(r.toArray()),xo.none())}}function E7(n,e,t){n instanceof La?(function(r,o,s){let a=r.value.clone(),l=tk(r.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof No?(function(r,o,s){if(!im(r.precondition,o))return void o.convertToUnknownDocument(s.version);let a=tk(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(yN(r)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):(function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Md(n,e,t,i){return n instanceof La?(function(o,s,a,l){if(!im(o.precondition,s))return a;let c=o.value.clone(),d=nk(o.fieldTransforms,l,s);return c.setAll(d),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null})(n,e,t,i):n instanceof No?(function(o,s,a,l){if(!im(o.precondition,s))return a;let c=nk(o.fieldTransforms,l,s),d=s.data;return d.setAll(yN(o)),d.setAll(c),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,i):(function(o,s,a){return im(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function b7(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=hN(i.transform,r||null);o!=null&&(t===null&&(t=ji.empty()),t.set(i.field,o))}return t||null}function ek(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&rc(i,r,(o,s)=>_7(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var La=class extends uc{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},No=class extends uc{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function yN(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function tk(n,e,t){let i=new Map;bt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,v7(s,a,t[r]))}return i}function nk(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,y7(o,s,e))}return i}var Ld=class extends uc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Cw=class extends uc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Dw=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&E7(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Md(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Md(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=uN();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(r.key)?null:a;let l=mN(s,a);l!==null&&i.set(r.key,l),s.isValidDocument()||s.convertToNoDocument(Xe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),it())}isEqual(e){return this.batchId===e.batchId&&rc(this.mutations,e.mutations,(t,i)=>ek(t,i))&&rc(this.baseMutations,e.baseMutations,(t,i)=>ek(t,i))}},Aw=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){bt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return h7})(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var Mw=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Rw=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var fn,ct;function w7(n){switch(n){case J.OK:return Le(64938);case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function vN(n){if(n===void 0)return To("GRPC error has no .code"),J.UNKNOWN;switch(n){case fn.OK:return J.OK;case fn.CANCELLED:return J.CANCELLED;case fn.UNKNOWN:return J.UNKNOWN;case fn.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case fn.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case fn.INTERNAL:return J.INTERNAL;case fn.UNAVAILABLE:return J.UNAVAILABLE;case fn.UNAUTHENTICATED:return J.UNAUTHENTICATED;case fn.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case fn.NOT_FOUND:return J.NOT_FOUND;case fn.ALREADY_EXISTS:return J.ALREADY_EXISTS;case fn.PERMISSION_DENIED:return J.PERMISSION_DENIED;case fn.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case fn.ABORTED:return J.ABORTED;case fn.OUT_OF_RANGE:return J.OUT_OF_RANGE;case fn.UNIMPLEMENTED:return J.UNIMPLEMENTED;case fn.DATA_LOSS:return J.DATA_LOSS;default:return Le(39323,{code:n})}}(ct=fn||(fn={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";var x7=null;function S7(){return new TextEncoder}var I7=new bo([4294967295,4294967295],0);function ik(n){let e=S7().encode(n),t=new Qb;return t.update(e),new Uint8Array(t.digest())}function rk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new bo([t,i],0),new bo([r,o],0)]}var kw=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Aa(`Invalid padding: ${t}`);if(i<0)throw new Aa(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Aa(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Aa(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=bo.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(bo.fromNumber(i)));return r.compare(I7)===1&&(r=new bo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=ik(e),[i,r]=rk(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);if(!this.we(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=ik(e),[i,r]=rk(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);this.be(s)}}be(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},Aa=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var gm=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Vd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Xe.min(),r,new Jt(ot),ko(),it())}},Vd=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,it(),it(),it())}};var ic=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}},mm=class{constructor(e,t){this.targetId=e,this.Ce=t}},ym=class{constructor(e,t,i=Ln.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},vm=class{constructor(){this.ve=0,this.Fe=ok(),this.Me=Ln.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=it(),t=it(),i=it();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Le(38017,{changeType:o})}}),new Vd(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=ok()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,bt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},Nw=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=ko(),this.He=Zg(),this.Je=Zg(),this.Ze=new Jt(ot)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){let o=r.target;if(Sw(o))if(i===0){let s=new Pe(o.path);this.et(t,s,ur.newNoDocument(s,Xe.min()))}else bt(i===1,20013,{expectedCount:i});else{let s=this._t(t);if(s!==i){let a=this.ut(e),l=a?this.ct(a,e,s):1;if(l!==0){this.it(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}x7?.lt((function(d,h,f,m,w){let S={localCacheCount:d,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},k=h.unchangedNames;return k&&(S.bloomFilter={applied:w===0,hashCount:k?.hashCount??0,bitmapLength:k?.bits?.bitmap?.length??0,padding:k?.bits?.padding??0,mightContain:V=>m?.mightContain(V)??!1}),S})(s,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,a;try{s=Do(i).toUint8Array()}catch(l){if(l instanceof hm)return Ss("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new kw(s,r,o)}catch(l){return Ss(l instanceof Aa?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){let i=this.Ge.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),r++)}),r}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&Sw(a.target)){let l=new Pe(a.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,ur.newNoDocument(l,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let i=it();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let r=new gm(e,t,this.Ze,this.je,i);return this.je=ko(),this.He=Zg(),this.Je=Zg(),this.Ze=new Jt(ot),r}Ye(e,t){if(!this.rt(e))return;let i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new vm,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Mn(ot),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Mn(ot),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||De("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new vm),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Zg(){return new Jt(Pe.comparator)}function ok(){return new Jt(Pe.comparator)}var T7={asc:"ASCENDING",desc:"DESCENDING"},C7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},D7={and:"AND",or:"OR"},Pw=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Ow(n,e){return n.useProto3Json||Vm(e)?e:{value:e}}function _m(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _N(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function A7(n,e){return _m(n,e.toTimestamp())}function jr(n){return bt(!!n,49232),Xe.fromTimestamp((function(t){let i=Co(t);return new sn(i.seconds,i.nanos)})(n))}function H1(n,e){return Fw(n,e).canonicalString()}function Fw(n,e){let t=(function(r){return new Pt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function EN(n){let e=Pt.fromString(n);return bt(IN(e),10190,{key:e.toString()}),e}function Lw(n,e){return H1(n.databaseId,e.path)}function iw(n,e){let t=EN(e);if(t.get(1)!==n.databaseId.projectId)throw new fe(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new fe(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Pe(wN(t))}function bN(n,e){return H1(n.databaseId,e)}function M7(n){let e=EN(n);return e.length===4?Pt.emptyPath():wN(e)}function Vw(n){return new Pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function wN(n){return bt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function sk(n,e,t){return{name:Lw(n,e),fields:t.value.mapValue.fields}}function R7(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(c,d){return c.useProto3Json?(bt(d===void 0||typeof d=="string",58123),Ln.fromBase64String(d||"")):(bt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ln.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(c){let d=c.code===void 0?J.UNKNOWN:vN(c.code);return new fe(d,c.message||"")})(s);t=new ym(i,r,o,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=iw(n,i.document.name),o=jr(i.document.updateTime),s=i.document.createTime?jr(i.document.createTime):Xe.min(),a=new ji({mapValue:{fields:i.document.fields}}),l=ur.newFoundDocument(r,o,s,a),c=i.targetIds||[],d=i.removedTargetIds||[];t=new ic(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=iw(n,i.document),o=i.readTime?jr(i.readTime):Xe.min(),s=ur.newNoDocument(r,o),a=i.removedTargetIds||[];t=new ic([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=iw(n,i.document),o=i.removedTargetIds||[];t=new ic([],o,r,null)}else{if(!("filter"in e))return Le(11601,{Vt:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new Rw(r,o),a=i.targetId;t=new mm(a,s)}}return t}function k7(n,e){let t;if(e instanceof La)t={update:sk(n,e.key,e.value)};else if(e instanceof Ld)t={delete:Lw(n,e.key)};else if(e instanceof No)t={update:sk(n,e.key,e.data),updateMask:j7(e.fieldMask)};else{if(!(e instanceof Cw))return Le(16599,{dt:e.type});t={verify:Lw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(o,s){let a=s.transform;if(a instanceof Pa)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Oa)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Fa)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof cc)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw Le(20930,{transform:s.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:A7(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Le(27497)})(n,e.precondition)),t}function N7(n,e){return n&&n.length>0?(bt(e!==void 0,14353),n.map(t=>(function(r,o){let s=r.updateTime?jr(r.updateTime):jr(o);return s.isEqual(Xe.min())&&(s=jr(o)),new Tw(s,r.transformResults||[])})(t,e))):[]}function P7(n,e){return{documents:[bN(n,e.path)]}}function O7(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=bN(n,r);let o=(function(c){if(c.length!==0)return SN(Hi.create(c,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(c){if(c.length!==0)return c.map(d=>(function(f){return{field:ec(f.field),direction:V7(f.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Ow(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:r}}function F7(n){let e=M7(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){bt(i===1,65062);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let f=xN(h);return f instanceof Hi&&eN(f)?f.getFilters():[f]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(f=>(function(w){return new Ts(tc(w.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(f))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,Vm(f)?null:f})(t.limit));let l=null;t.startAt&&(l=(function(h){let f=!!h.before,m=h.values||[];return new Ao(m,f)})(t.startAt));let c=null;return t.endAt&&(c=(function(h){let f=!h.before,m=h.values||[];return new Ao(m,f)})(t.endAt)),s7(e,r,s,o,a,"F",l,c)}function L7(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=tc(t.unaryFilter.field);return rn.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=tc(t.unaryFilter.field);return rn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=tc(t.unaryFilter.field);return rn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=tc(t.unaryFilter.field);return rn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}})(n):n.fieldFilter!==void 0?(function(t){return rn.create(tc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Hi.create(t.compositeFilter.filters.map(i=>xN(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Le(1026)}})(t.compositeFilter.op))})(n):Le(30097,{filter:n})}function V7(n){return T7[n]}function U7(n){return C7[n]}function B7(n){return D7[n]}function ec(n){return{fieldPath:n.canonicalString()}}function tc(n){return si.fromServerFormat(n.fieldPath)}function SN(n){return n instanceof rn?(function(t){if(t.op==="=="){if(KR(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NAN"}};if(qR(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(KR(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NOT_NAN"}};if(qR(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ec(t.field),op:U7(t.op),value:t.value}}})(n):n instanceof Hi?(function(t){let i=t.getFilters().map(r=>SN(r));return i.length===1?i[0]:{compositeFilter:{op:B7(t.op),filters:i}}})(n):Le(54877,{filter:n})}function j7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function IN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function TN(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var Ud=class n{constructor(e,t,i,r,o=Xe.min(),s=Xe.min(),a=Ln.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Uw=class{constructor(e){this.yt=e}};function CN(n){let e=F7({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Fd(e,e.limit,"L"):e}var Em=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt($t(e.integerValue));else if("doubleValue"in e){let i=$t(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),kd(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Co(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Do(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?Jk(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Qk(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):Le(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let i=e.fields||{};this.Ft(t,55);for(let r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){let i=e.fields||{};this.Ft(t,53);let r=oc,o=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt($t(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){let i=e.values||[];this.Ft(t,50);for(let r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Pe.fromName(e).path.forEach(i=>{this.Ft(t,60),this.$t(i,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};Em.Wt=new Em;var Bw=class{constructor(){this.Sn=new jw}addToCollectionParentIndex(e,t){return this.Sn.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(Na.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(Na.min())}updateCollectionGroup(e,t,i){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}},jw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Mn(Pt.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Mn(Pt.comparator)).toArray()}};var Pde=new Uint8Array(0);var ak={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DN=41943040,Bi=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};Bi.DEFAULT_COLLECTION_PERCENTILE=10,Bi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bi.DEFAULT=new Bi(DN,Bi.DEFAULT_COLLECTION_PERCENTILE,Bi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bi.DISABLED=new Bi(-1,0,0);var Bd=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var lk="LruGarbageCollector",H7=1048576;function ck([n,e],[t,i]){let r=ot(n,t);return r===0?ot(e,i):r}var Hw=class{constructor(e){this.Pr=e,this.buffer=new Mn(ck),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();ck(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Gw=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){De(lk,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){yc(t)?De(lk,"Ignoring IndexedDB error during garbage collection: ",t):await mc(t)}await this.Ar(3e5)})}},$w=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return re.resolve(P1.ce);let i=new Hw(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(De("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(ak)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(De("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ak):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,s,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(De("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,s=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(c=Date.now(),Xl()<=nt.DEBUG&&De("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${r} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:h})))}};function G7(n,e){return new $w(n,e)}var zw=class{constructor(){this.changes=new Ro(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ur.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?re.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ww=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var qw=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Md(i.mutation,r,Vr.empty(),sn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,it()).next(()=>i))}getLocalViewOfDocuments(e,t,i=it()){let r=Da();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=Cd();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=Da();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,it()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,i,r){let o=ko(),s=Ad(),a=(function(){return Ad()})();return t.forEach((l,c)=>{let d=i.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof No)?o=o.insert(c.key,c):d!==void 0?(s.set(c.key,d.mutation.getFieldMask()),Md(d.mutation,c,d.mutation.getFieldMask(),sn.now())):s.set(c.key,Vr.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,d)=>s.set(c,d)),t.forEach((c,d)=>a.set(c,new Ww(d,s.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){let i=Ad(),r=new Jt((s,a)=>s-a),o=it();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=i.get(l)||Vr.empty();d=a.applyToLocalView(c,d),i.set(l,d);let h=(r.get(a.batchId)||it()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,h=uN();d.forEach(f=>{if(!o.has(f)){let m=mN(t.get(f),i.get(f));m!==null&&h.set(f,m),o=o.add(f)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return re.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return a7(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):jm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):re.resolve(Da()),a=Rd,l=o;return s.next(c=>re.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?re.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,it())).next(d=>({batchId:a,changes:cN(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Pe(t)).next(i=>{let r=Cd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=Cd();return this.indexManager.getCollectionParents(e,o).next(a=>re.forEach(a,l=>{let c=(function(h,f){return new Mo(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,i,r).next(d=>{d.forEach((h,f)=>{s=s.insert(h,f)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((l,c)=>{let d=c.getKey();s.get(d)===null&&(s=s.insert(d,ur.newInvalidDocument(d)))});let a=Cd();return s.forEach((l,c)=>{let d=o.get(l);d!==void 0&&Md(d.mutation,c,Vr.empty(),sn.now()),$m(t,c)&&(a=a.insert(l,c))}),a})}};var Kw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return re.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:jr(r.createTime)}})(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:CN(r.bundledQuery),readTime:jr(r.readTime)}})(t)),re.resolve()}};var Yw=class{constructor(){this.overlays=new Jt(Pe.comparator),this.Lr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Da();return re.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.bt(e,t,o)}),re.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Lr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(i)),re.resolve()}getOverlaysForCollection(e,t,i){let r=Da(),o=t.length+1,s=new Pe(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>i&&r.set(l.getKey(),l)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Jt((c,d)=>c-d),s=this.overlays.getIterator();for(;s.hasNext();){let c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let d=o.get(c.largestBatchId);d===null&&(d=Da(),o=o.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}let a=Da(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=r)););return re.resolve(a)}bt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new Mw(t,i));let o=this.Lr.get(t);o===void 0&&(o=it(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}};var Qw=class{constructor(){this.sessionToken=Ln.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}};var jd=class{constructor(){this.kr=new Mn(pn.Kr),this.qr=new Mn(pn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let i=new pn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new pn(e,t))}Qr(e,t){e.forEach(i=>this.removeReference(i,t))}Gr(e){let t=new Pe(new Pt([])),i=new pn(t,e),r=new pn(t,e+1),o=[];return this.qr.forEachInRange([i,r],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new Pe(new Pt([])),i=new pn(t,e),r=new pn(t,e+1),o=it();return this.qr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new pn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},pn=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Pe.comparator(e.key,t.key)||ot(e.Hr,t.Hr)}static Ur(e,t){return ot(e.Hr,t.Hr)||Pe.comparator(e.key,t.key)}};var Jw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Mn(pn.Kr)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Dw(o,t,i,r);this.mutationQueue.push(s);for(let a of r)this.Jr=this.Jr.add(new pn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return re.resolve(s)}lookupMutationBatch(e,t){return re.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),o=r<0?0:r;return re.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?O1:this.Yn-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new pn(t,0),r=new pn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],s=>{let a=this.Zr(s.Hr);o.push(a)}),re.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Mn(ot);return t.forEach(r=>{let o=new pn(r,0),s=new pn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{i=i.add(a.Hr)})}),re.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;Pe.isDocumentKey(o)||(o=o.child(""));let s=new pn(new Pe(o),0),a=new Mn(ot);return this.Jr.forEachWhile(l=>{let c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Hr)),!0)},s),re.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){bt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return re.forEach(t.mutations,r=>{let o=new pn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Jr=i})}nr(e){}containsKey(e,t){let i=new pn(t,0),r=this.Jr.firstAfterOrEqual(i);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Xw=class{constructor(e){this.ti=e,this.docs=(function(){return new Jt(Pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return re.resolve(i?i.document.mutableCopy():ur.newInvalidDocument(t))}getEntries(e,t){let i=ko();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():ur.newInvalidDocument(r))}),re.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=ko(),s=t.path,a=new Pe(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||j9(B9(d),i)<=0||(r.has(d.key)||$m(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return re.resolve(o)}getAllFromCollectionGroup(e,t,i,r){Le(9500)}ni(e,t){return re.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Zw(this)}getSize(e){return re.resolve(this.size)}},Zw=class extends zw{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)}),re.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var e1=class{constructor(e){this.persistence=e,this.ri=new Ro(t=>U1(t),B1),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.ii=0,this.si=new jd,this.targetCount=0,this.oi=Bd._r()}forEachTarget(e,t){return this.ri.forEach((i,r)=>t(r)),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),re.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new Bd(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.lr(t),re.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),re.waitFor(o).next(()=>r)}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){let i=this.ri.get(t)||null;return re.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),re.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),re.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),re.resolve()}getMatchingKeysForTargetId(e,t){let i=this.si.jr(t);return re.resolve(i)}containsKey(e,t){return re.resolve(this.si.containsKey(t))}};var bm=class{constructor(e,t){this._i={},this.overlays={},this.ai=new P1(0),this.ui=!1,this.ui=!0,this.ci=new Qw,this.referenceDelegate=e(this),this.li=new e1(this),this.indexManager=new Bw,this.remoteDocumentCache=(function(r){return new Xw(r)})(i=>this.referenceDelegate.hi(i)),this.serializer=new Uw(t),this.Pi=new Kw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Yw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new Jw(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){De("MemoryPersistence","Starting transaction:",e);let r=new t1(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(o=>this.referenceDelegate.Ii(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ei(e,t){return re.or(Object.values(this._i).map(i=>()=>i.containsKey(e,t)))}},t1=class extends dw{constructor(e){super(),this.currentSequenceNumber=e}},n1=class n{constructor(e){this.persistence=e,this.Ri=new jd,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw Le(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),re.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),re.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(r=>this.di.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.di,i=>{let r=Pe.fromPath(i);return this.mi(e,r).next(o=>{o||t.removeEntry(r,Xe.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return re.or([()=>re.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},wm=class n{constructor(e,t){this.persistence=e,this.fi=new Ro(i=>z9(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=G7(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}pr(e){let t=0;return this.mr(e,i=>{t++}).next(()=>t)}mr(e,t){return re.forEach(this.fi,(i,r)=>this.wr(e,i,r).next(o=>o?re.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,s=>this.wr(e,s,t).next(a=>{a||(i++,o.removeEntry(s,Xe.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),re.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=tm(e.data.value)),t}wr(e,t,i){return re.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.fi.get(t);return re.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var i1=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=it(),r=it();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var r1=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var o1=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return vR()?8:G9(Cn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new r1;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,i,r){return i.documentReadCount<this.Vs?(Xl()<=nt.DEBUG&&De("QueryEngine","SDK will not create cache indexes for query:",Zl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),re.resolve()):(Xl()<=nt.DEBUG&&De("QueryEngine","Query:",Zl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Xl()<=nt.DEBUG&&De("QueryEngine","The SDK decides to create cache indexes for query:",Zl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Br(t))):re.resolve())}gs(e,t){if(XR(t))return re.resolve(null);let i=Br(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Fd(t,null,"F"),i=Br(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=it(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{let c=this.bs(t,a);return this.Ss(t,c,s,l.readTime)?this.gs(e,Fd(t,null,"F")):this.Ds(e,c,t,l)}))})))}ps(e,t,i,r){return XR(t)||r.isEqual(Xe.min())?re.resolve(null):this.fs.getDocuments(e,i).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,i,r)?re.resolve(null):(Xl()<=nt.DEBUG&&De("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Zl(t)),this.Ds(e,s,t,U9(r,Rd)).next(a=>a))})}bs(e,t){let i=new Mn(aN(e));return t.forEach((r,o)=>{$m(e,o)&&(i=i.add(o))}),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return Xl()<=nt.DEBUG&&De("QueryEngine","Using full collection scan to execute query:",Zl(t)),this.fs.getDocumentsMatchingQuery(e,t,Na.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var G1="LocalStore",$7=3e8,s1=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Jt(ot),this.Fs=new Ro(o=>U1(o),B1),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function z7(n,e,t,i){return new s1(n,e,t,i)}async function AN(n,e){let t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],a=[],l=it();for(let c of r){s.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}for(let c of o){a.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Ns:c,removedBatchIds:s,addedBatchIds:a}))})})}function W7(n,e){let t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,d){let h=c.batch,f=h.keys(),m=re.resolve();return f.forEach(w=>{m=m.next(()=>d.getEntry(l,w)).next(S=>{let k=c.docVersions.get(w);bt(k!==null,48541),S.version.compareTo(k)<0&&(h.applyToRemoteDocument(S,c),S.isValidDocument()&&(S.setReadTime(c.commitVersion),d.addEntry(S)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))})(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=it();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function MN(n){let e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function q7(n,e){let t=We(n),i=e.snapshotVersion,r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;let a=[];e.targetChanges.forEach((d,h)=>{let f=r.get(h);if(!f)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,h)));let m=f.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Ln.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,i)),r=r.insert(h,m),(function(S,k,V){return S.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=$7?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0})(f,m,d)&&a.push(t.li.updateTargetData(o,m))});let l=ko(),c=it();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(K7(o,s,e.documentUpdates).next(d=>{l=d.Bs,c=d.Ls})),!i.isEqual(Xe.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(h=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i));a.push(d)}return re.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.vs=r,o))}function K7(n,e,t){let i=it(),r=it();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=ko();return t.forEach((a,l)=>{let c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Xe.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):De(G1,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Bs:s,Ls:r}})}function Y7(n,e){let t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=O1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Q7(n,e){let t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.li.getTargetData(i,e).next(o=>o?(r=o,re.resolve(r)):t.li.allocateTargetId(i).next(s=>(r=new Ud(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i})}async function a1(n,e,t){let i=We(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r))}catch(s){if(!yc(s))throw s;De(G1,`Failed to update sequence numbers for target ${e}: ${s}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function uk(n,e,t){let i=We(n),r=Xe.min(),o=it();return i.persistence.runTransaction("Execute query","readwrite",s=>(function(l,c,d){let h=We(l),f=h.Fs.get(d);return f!==void 0?re.resolve(h.vs.get(f)):h.li.getTargetData(c,d)})(i,s,Br(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(s,e,t?r:Xe.min(),t?o:it())).next(a=>(J7(i,c7(e),a),{documents:a,ks:o})))}function J7(n,e,t){let i=n.Ms.get(e)||Xe.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ms.set(e,i)}var xm=class{constructor(){this.activeTargetIds=g7()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var l1=class{constructor(){this.vo=new xm,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new xm,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var c1=class{Mo(e){}shutdown(){}};var dk="ConnectivityMonitor",Sm=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){De(dk,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){De(dk,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var em=null;function u1(){return em===null?em=(function(){return 268435456+Math.round(2147483648*Math.random())})():em++,"0x"+em.toString(16)}var rw="RestConnection",X7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},d1=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===fm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){let s=u1(),a=this.Qo(e,t.toUriEncodedString());De(rw,`Sending RPC '${e}' ${s}:`,a,i);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,r,o);let{host:c}=new URL(a),d=_s(c);return this.zo(e,a,l,i,d).then(h=>(De(rw,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Ss(rw,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",i),h})}jo(e,t,i,r,o,s){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+pc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),i&&i.headers.forEach((r,o)=>e[o]=r)}Qo(e,t){let i=X7[e],r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}};var h1=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Gn="WebChannelConnection",Td=(n,e,t)=>{n.listen(e,i=>{try{t(i)}catch(r){setTimeout(()=>{throw r},0)}})},Im=class n extends d1{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=ew();Td(e,Zb.STAT_EVENT,t=>{t.stat===Jg.PROXY?De(Gn,"STAT_EVENT: detected buffering proxy"):t.stat===Jg.NOPROXY&&De(Gn,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,i,r,o){let s=u1();return new Promise((a,l)=>{let c=new Jb;c.setWithCredentials(!0),c.listenOnce(Xb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Id.NO_ERROR:let h=c.getResponseJson();De(Gn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case Id.TIMEOUT:De(Gn,`RPC '${e}' ${s} timed out`),l(new fe(J.DEADLINE_EXCEEDED,"Request time out"));break;case Id.HTTP_ERROR:let f=c.getStatus();if(De(Gn,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let w=m?.error;if(w&&w.status&&w.message){let S=(function(V){let q=V.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(q)>=0?q:J.UNKNOWN})(w.status);l(new fe(S,w.message))}else l(new fe(J.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new fe(J.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{De(Gn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);De(Gn,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",d,i,15)})}T_(e,t,i){let r=u1(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;let c=o.join("");De(Gn,`Creating RPC '${e}' stream ${r}: ${c}`,a);let d=s.createWebChannel(c,a);this.I_(d);let h=!1,f=!1,m=new h1({Ho:w=>{f?De(Gn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(h||(De(Gn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),De(Gn,`RPC '${e}' stream ${r} sending:`,w),d.send(w))},Jo:()=>d.close()});return Td(d,Jl.EventType.OPEN,()=>{f||(De(Gn,`RPC '${e}' stream ${r} transport opened.`),m.i_())}),Td(d,Jl.EventType.CLOSE,()=>{f||(f=!0,De(Gn,`RPC '${e}' stream ${r} transport closed`),m.o_(),this.E_(d))}),Td(d,Jl.EventType.ERROR,w=>{f||(f=!0,Ss(Gn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),m.o_(new fe(J.UNAVAILABLE,"The operation could not be completed")))}),Td(d,Jl.EventType.MESSAGE,w=>{if(!f){let S=w.data[0];bt(!!S,16349);let k=S,V=k?.error||k[0]?.error;if(V){De(Gn,`RPC '${e}' stream ${r} received error:`,V);let q=V.status,ye=(function(Ae){let O=fn[Ae];if(O!==void 0)return vN(O)})(q),ve=V.message;ye===void 0&&(ye=J.INTERNAL,ve="Unknown error status: "+q+" with message "+V.message),f=!0,m.o_(new fe(ye,ve)),d.close()}else De(Gn,`RPC '${e}' stream ${r} received:`,S),m.__(S)}}),n.u_(),setTimeout(()=>{m.s_()},0),m}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return tw()}};function Z7(n){return new Im(n)}function ow(){return typeof document<"u"?document:null}function Kd(n){return new Pw(n,!0)}Im.c_=!1;var Tm=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&De("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var hk="PersistentStream",Cm=class{constructor(e,t,i,r,o,s,a,l){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Tm(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===J.RESOURCE_EXHAUSTED?(To(t.toString()),To("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{let r=new fe(J.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){let i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return De(hk,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(De(hk,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},f1=class extends Cm{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=R7(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Xe.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Xe.min():s.readTime?jr(s.readTime):Xe.min()})(e);return this.listener.J_(t,i)}Z_(e){let t={};t.database=Vw(this.serializer),t.addTarget=(function(o,s){let a,l=s.target;if(a=Sw(l)?{documents:P7(o,l)}:{query:O7(o,l).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=_N(o,s.resumeToken);let c=Ow(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(Xe.min())>0){a.readTime=_m(o,s.snapshotVersion.toTimestamp());let c=Ow(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);let i=L7(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){let t={};t.database=Vw(this.serializer),t.removeTarget=e,this.K_(t)}},p1=class extends Cm{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return bt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,bt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){bt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=N7(e.writeResults,e.commitTime),i=jr(e.commitTime);return this.listener.na(i,t)}ra(){let e={};e.database=Vw(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>k7(this.serializer,i))};this.K_(t)}};var g1=class{},m1=class extends g1{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new fe(J.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,Fw(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new fe(J.UNKNOWN,o.toString())})}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,Fw(t,i),r,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new fe(J.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function eH(n,e,t,i){return new m1(n,e,t,i)}var y1=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(To(t),this.aa=!1):De("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Va="RemoteStore",v1=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{i.enqueueAndForget(async()=>{ja(this)&&(De(Va,"Restarting streams for network reachability change."),await(async function(l){let c=We(l);c.Ea.add(4),await Yd(c),c.Va.set("Unknown"),c.Ea.delete(4),await zm(c)})(this))})}),this.Va=new y1(i,r)}};async function zm(n){if(ja(n))for(let e of n.Ra)await e(!0)}async function Yd(n){for(let e of n.Ra)await e(!1)}function RN(n,e){let t=We(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),q1(t)?W1(t):vc(t).O_()&&z1(t,e))}function $1(n,e){let t=We(n),i=vc(t);t.Ia.delete(e),i.O_()&&kN(t,e),t.Ia.size===0&&(i.O_()?i.L_():ja(t)&&t.Va.set("Unknown"))}function z1(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}vc(n).Z_(e)}function kN(n,e){n.da.$e(e),vc(n).X_(e)}function W1(n){n.da=new Nw({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),vc(n).start(),n.Va.ua()}function q1(n){return ja(n)&&!vc(n).x_()&&n.Ia.size>0}function ja(n){return We(n).Ea.size===0}function NN(n){n.da=void 0}async function tH(n){n.Va.set("Online")}async function nH(n){n.Ia.forEach((e,t)=>{z1(n,e)})}async function iH(n,e){NN(n),q1(n)?(n.Va.ha(e),W1(n)):n.Va.set("Unknown")}async function rH(n,e,t){if(n.Va.set("Online"),e instanceof ym&&e.state===2&&e.cause)try{await(async function(r,o){let s=o.cause;for(let a of o.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.da.removeTarget(a))})(n,e)}catch(i){De(Va,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Dm(n,i)}else if(e instanceof ic?n.da.Xe(e):e instanceof mm?n.da.st(e):n.da.tt(e),!t.isEqual(Xe.min()))try{let i=await MN(n.localStore);t.compareTo(i)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.Ia.get(c);d&&o.Ia.set(c,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{let d=o.Ia.get(l);if(!d)return;o.Ia.set(l,d.withResumeToken(Ln.EMPTY_BYTE_STRING,d.snapshotVersion)),kN(o,l);let h=new Ud(d.target,l,c,d.sequenceNumber);z1(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){De(Va,"Failed to raise snapshot:",i),await Dm(n,i)}}async function Dm(n,e,t){if(!yc(e))throw e;n.Ea.add(1),await Yd(n),n.Va.set("Offline"),t||(t=()=>MN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{De(Va,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await zm(n)})}function PN(n,e){return e().catch(t=>Dm(n,t,e))}async function Wm(n){let e=We(n),t=Cs(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:O1;for(;oH(e);)try{let r=await Y7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,sH(e,r)}catch(r){await Dm(e,r)}ON(e)&&FN(e)}function oH(n){return ja(n)&&n.Ta.length<10}function sH(n,e){n.Ta.push(e);let t=Cs(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function ON(n){return ja(n)&&!Cs(n).x_()&&n.Ta.length>0}function FN(n){Cs(n).start()}async function aH(n){Cs(n).ra()}async function lH(n){let e=Cs(n);for(let t of n.Ta)e.ea(t.mutations)}async function cH(n,e,t){let i=n.Ta.shift(),r=Aw.from(i,e,t);await PN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Wm(n)}async function uH(n,e){e&&Cs(n).Y_&&await(async function(i,r){if((function(s){return w7(s)&&s!==J.ABORTED})(r.code)){let o=i.Ta.shift();Cs(i).B_(),await PN(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Wm(i)}})(n,e),ON(n)&&FN(n)}async function fk(n,e){let t=We(n);t.asyncQueue.verifyOperationInProgress(),De(Va,"RemoteStore received new credentials");let i=ja(t);t.Ea.add(3),await Yd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await zm(t)}async function dH(n,e){let t=We(n);e?(t.Ea.delete(2),await zm(t)):e||(t.Ea.add(2),await Yd(t),t.Va.set("Unknown"))}function vc(n){return n.ma||(n.ma=(function(t,i,r){let o=We(t);return o.sa(),new f1(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:tH.bind(null,n),Yo:nH.bind(null,n),t_:iH.bind(null,n),J_:rH.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),q1(n)?W1(n):n.Va.set("Unknown")):(await n.ma.stop(),NN(n))})),n.ma}function Cs(n){return n.fa||(n.fa=(function(t,i,r){let o=We(t);return o.sa(),new p1(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:aH.bind(null,n),t_:uH.bind(null,n),ta:lH.bind(null,n),na:cH.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Wm(n)):(await n.fa.stop(),n.Ta.length>0&&(De(Va,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var _1=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,a=new n(e,t,s,r,o);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function K1(n,e){if(To("AsyncQueue",`${e}: ${n}`),yc(n))return new fe(J.UNAVAILABLE,`${e}: ${n}`);throw n}var Hd=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Pe.comparator(t.key,i.key):(t,i)=>Pe.comparator(t.key,i.key),this.keyedMap=Cd(),this.sortedSet=new Jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Am=class{constructor(){this.ga=new Jt(Pe.comparator)}track(e){let t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}},Ua=class n{constructor(e,t,i,r,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Hd.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var E1=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},b1=class{constructor(){this.queries=pk(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){let r=We(t),o=r.queries;r.queries=pk(),o.forEach((s,a)=>{for(let l of a.ba)l.onError(i)})})(this,new fe(J.ABORTED,"Firestore shutting down"))}};function pk(){return new Ro(n=>sN(n),Gm)}async function LN(n,e){let t=We(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new E1,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(s){let a=K1(s,`Initialization of query '${Zl(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Y1(t)}async function VN(n,e){let t=We(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function hH(n,e){let t=We(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(r)&&(i=!0);s.wa=r}}i&&Y1(t)}function fH(n,e,t){let i=We(n),r=i.queries.get(e);if(r)for(let o of r.ba)o.onError(t);i.queries.delete(e)}function Y1(n){n.Ca.forEach(e=>{e.next()})}var w1,gk;(gk=w1||(w1={})).Ma="default",gk.Cache="cache";var Mm=class{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ua(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ua.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==w1.Cache}};var Rm=class{constructor(e){this.key=e}},km=class{constructor(e){this.key=e}},x1=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=it(),this.mutatedKeys=it(),this.eu=aN(e),this.tu=new Hd(this.eu)}get nu(){return this.Za}ru(e,t){let i=t?t.iu:new Am,r=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{let f=r.get(d),m=$m(this.query,h)?h:null,w=!!f&&this.mutatedKeys.has(f.key),S=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),k=!1;f&&m?f.data.isEqual(m.data)?w!==S&&(i.track({type:3,doc:m}),k=!0):this.su(f,m)||(i.track({type:2,doc:m}),k=!0,(l&&this.eu(m,l)>0||c&&this.eu(m,c)<0)&&(a=!0)):!f&&m?(i.track({type:0,doc:m}),k=!0):f&&!m&&(i.track({type:1,doc:f}),k=!0,(l||c)&&(a=!0)),k&&(m?(s=s.add(m),o=S?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),i.track({type:1,doc:d})}return{tu:s,iu:i,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,h)=>(function(m,w){let S=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Vt:k})}};return S(m)-S(w)})(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(i),r=r??!1;let a=t&&!r?this._u():[],l=this.Ya.size===0&&this.current&&!r?1:0,c=l!==this.Xa;return this.Xa=l,s.length!==0||c?{snapshot:new Ua(this.query,e.tu,o,s,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Am,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=it(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});let t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new km(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new Rm(i))}),t}cu(e){this.Za=e.ks,this.Ya=it();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ua.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},Q1="SyncEngine",S1=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},I1=class{constructor(e){this.key=e,this.hu=!1}},T1=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Ro(a=>sN(a),Gm),this.Iu=new Map,this.Eu=new Set,this.Ru=new Jt(Pe.comparator),this.Au=new Map,this.Vu=new jd,this.du={},this.mu=new Map,this.fu=Bd.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function pH(n,e,t=!0){let i=$N(n),r,o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await UN(i,e,t,!0),r}async function gH(n,e){let t=$N(n);await UN(t,e,!0,!1)}async function UN(n,e,t,i){let r=await Q7(n.localStore,Br(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return i&&(a=await mH(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&RN(n.remoteStore,r),a}async function mH(n,e,t,i,r){n.pu=(h,f,m)=>(async function(S,k,V,q){let ye=k.view.ru(V);ye.Ss&&(ye=await uk(S.localStore,k.query,!1).then(({documents:O})=>k.view.ru(O,ye)));let ve=q&&q.targetChanges.get(k.targetId),xe=q&&q.targetMismatches.get(k.targetId)!=null,Ae=k.view.applyChanges(ye,S.isPrimaryClient,ve,xe);return yk(S,k.targetId,Ae.au),Ae.snapshot})(n,h,f,m);let o=await uk(n.localStore,e,!0),s=new x1(e,o.ks),a=s.ru(o.documents),l=Vd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),c=s.applyChanges(a,n.isPrimaryClient,l);yk(n,t,c.au);let d=new S1(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function yH(n,e,t){let i=We(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter(s=>!Gm(s,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await a1(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&$1(i.remoteStore,r.targetId),C1(i,r.targetId)}).catch(mc)):(C1(i,r.targetId),await a1(i.localStore,r.targetId,!0))}async function vH(n,e){let t=We(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),$1(t.remoteStore,i.targetId))}async function _H(n,e,t){let i=TH(n);try{let r=await(function(s,a){let l=We(s),c=sn.now(),d=a.reduce((m,w)=>m.add(w.key),it()),h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let w=ko(),S=it();return l.xs.getEntries(m,d).next(k=>{w=k,w.forEach((V,q)=>{q.isValidDocument()||(S=S.add(V))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,w)).next(k=>{h=k;let V=[];for(let q of a){let ye=b7(q,h.get(q.key).overlayedDocument);ye!=null&&V.push(new No(q.key,ye,Xk(ye.value.mapValue),xo.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,V,a)}).next(k=>{f=k;let V=k.applyToLocalDocumentSet(h,S);return l.documentOverlayCache.saveOverlays(m,k.batchId,V)})}).then(()=>({batchId:f.batchId,changes:cN(h)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(s,a,l){let c=s.du[s.currentUser.toKey()];c||(c=new Jt(ot)),c=c.insert(a,l),s.du[s.currentUser.toKey()]=c})(i,r.batchId,t),await Qd(i,r.changes),await Wm(i.remoteStore)}catch(r){let o=K1(r,"Failed to persist write");t.reject(o)}}async function BN(n,e){let t=We(n);try{let i=await q7(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Au.get(o);s&&(bt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?s.hu=!0:r.modifiedDocuments.size>0?bt(s.hu,14607):r.removedDocuments.size>0&&(bt(s.hu,42227),s.hu=!1))}),await Qd(t,i,e)}catch(i){await mc(i)}}function mk(n,e,t){let i=We(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(s,a){let l=We(s);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(let f of h.ba)f.va(a)&&(c=!0)}),c&&Y1(l)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function EH(n,e,t){let i=We(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Au.get(e),o=r&&r.key;if(o){let s=new Jt(Pe.comparator);s=s.insert(o,ur.newNoDocument(o,Xe.min()));let a=it().add(o),l=new gm(Xe.min(),new Map,new Jt(ot),s,a);await BN(i,l),i.Ru=i.Ru.remove(o),i.Au.delete(e),J1(i)}else await a1(i.localStore,e,!1).then(()=>C1(i,e,t)).catch(mc)}async function bH(n,e){let t=We(n),i=e.batch.batchId;try{let r=await W7(t.localStore,e);HN(t,i,null),jN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Qd(t,r)}catch(r){await mc(r)}}async function wH(n,e,t){let i=We(n);try{let r=await(function(s,a){let l=We(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(bt(h!==null,37113),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})})(i.localStore,e);HN(i,e,t),jN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Qd(i,r)}catch(r){await mc(r)}}function jN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function HN(n,e,t){let i=We(n),r=i.du[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function C1(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(i=>{n.Vu.containsKey(i)||GN(n,i)})}function GN(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&($1(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),J1(n))}function yk(n,e,t){for(let i of t)i instanceof Rm?(n.Vu.addReference(i.key,e),xH(n,i)):i instanceof km?(De(Q1,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||GN(n,i.key)):Le(19791,{wu:i})}function xH(n,e){let t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(De(Q1,"New document in limbo: "+t),n.Eu.add(i),J1(n))}function J1(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new Pe(Pt.fromString(e)),i=n.fu.next();n.Au.set(i,new I1(t)),n.Ru=n.Ru.insert(t,i),RN(n.remoteStore,new Ud(Br(Bm(t.path)),i,"TargetPurposeLimboResolution",P1.ce))}}async function Qd(n,e,t){let i=We(n),r=[],o=[],s=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{s.push(i.pu(l,e,t).then(c=>{if((c||t)&&i.isPrimaryClient){let d=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){r.push(c);let d=i1.Es(l.targetId,c);o.push(d)}}))}),await Promise.all(s),i.Pu.J_(r),await(async function(l,c){let d=We(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>re.forEach(c,f=>re.forEach(f.Ts,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>re.forEach(f.Is,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!yc(h))throw h;De(G1,"Failed to update sequence numbers: "+h)}for(let h of c){let f=h.targetId;if(!h.fromCache){let m=d.vs.get(f),w=m.snapshotVersion,S=m.withLastLimboFreeSnapshotVersion(w);d.vs=d.vs.insert(f,S)}}})(i.localStore,o))}async function SH(n,e){let t=We(n);if(!t.currentUser.isEqual(e)){De(Q1,"User change. New user:",e.toKey());let i=await AN(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(l=>{l.reject(new fe(J.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Qd(t,i.Ns)}}function IH(n,e){let t=We(n),i=t.Au.get(e);if(i&&i.hu)return it().add(i.key);{let r=it(),o=t.Iu.get(e);if(!o)return r;for(let s of o){let a=t.Tu.get(s);r=r.unionWith(a.view.nu)}return r}}function $N(n){let e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=BN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EH.bind(null,e),e.Pu.J_=hH.bind(null,e.eventManager),e.Pu.yu=fH.bind(null,e.eventManager),e}function TH(n){let e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wH.bind(null,e),e}var X1=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Kd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return z7(this.persistence,new o1,t.initialUser,this.serializer)}Cu(t){return new bm(n1.Vi,this.serializer)}Du(t){return new l1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Nm=class extends X1{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){bt(this.persistence.referenceDelegate instanceof wm,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new Gw(i,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Bi.withCacheSize(this.cacheSizeBytes):Bi.DEFAULT;return new bm(i=>wm.Vi(i,t),this.serializer)}};var zN=(()=>{class n{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>mk(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=SH.bind(null,this.syncEngine),await dH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new b1})()}createDatastore(t){let i=Kd(t.databaseInfo.databaseId),r=Z7(t.databaseInfo);return eH(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,s,a,l){return new v1(r,o,s,a,l)})(this.localStore,this.datastore,t.asyncQueue,i=>mk(this.syncEngine,i,0),(function(){return Sm.v()?new Sm:new c1})())}createSyncEngine(t,i){return(function(o,s,a,l,c,d,h){let f=new T1(o,s,a,l,c,d);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){let r=We(i);De(Va,"RemoteStore shutting down."),r.Ea.add(5),await Yd(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var Pm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):To("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ds="FirestoreClient",D1=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=An.UNAUTHENTICATED,this.clientId=ka.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async s=>{De(Ds,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(De(Ds,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=K1(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}};async function sw(n,e){n.asyncQueue.verifyOperationInProgress(),De(Ds,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await AN(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function vk(n,e){n.asyncQueue.verifyOperationInProgress();let t=await CH(n);De(Ds,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>fk(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>fk(e.remoteStore,r)),n._onlineComponents=e}async function CH(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){De(Ds,"Using user provided OfflineComponentProvider");try{await sw(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===J.FAILED_PRECONDITION||r.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Ss("Error using user provided cache. Falling back to memory cache: "+t),await sw(n,new X1)}}else De(Ds,"Using default OfflineComponentProvider"),await sw(n,new Nm(void 0));return n._offlineComponents}async function WN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(De(Ds,"Using user provided OnlineComponentProvider"),await vk(n,n._uninitializedComponentsProvider._online)):(De(Ds,"Using default OnlineComponentProvider"),await vk(n,new zN))),n._onlineComponents}function DH(n){return WN(n).then(e=>e.syncEngine)}async function qN(n){let e=await WN(n),t=e.eventManager;return t.onListen=pH.bind(null,e.syncEngine),t.onUnlisten=yH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=gH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=vH.bind(null,e.syncEngine),t}function KN(n,e,t={}){let i=new cr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new Pm({next:f=>{d.Nu(),s.enqueueAndForget(()=>VN(o,h));let m=f.docs.has(a);!m&&f.fromCache?c.reject(new fe(J.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?c.reject(new fe(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Mm(Bm(a.path),d,{includeMetadataChanges:!0,Ka:!0});return LN(o,h)})(await qN(n),n.asyncQueue,e,t,i)),i.promise}function YN(n,e,t={}){let i=new cr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new Pm({next:f=>{d.Nu(),s.enqueueAndForget(()=>VN(o,h)),f.fromCache&&l.source==="server"?c.reject(new fe(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Mm(a,d,{includeMetadataChanges:!0,Ka:!0});return LN(o,h)})(await qN(n),n.asyncQueue,e,t,i)),i.promise}function QN(n,e){let t=new cr;return n.asyncQueue.enqueueAndForget(async()=>_H(await DH(n),e,t)),t.promise}function JN(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var AH="ComponentProvider",_k=new Map;function MH(n,e,t,i,r){return new hw(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,JN(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}var XN="firestore.googleapis.com",Ek=!0,Om=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new fe(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=XN,this.ssl=Ek}else this.host=e.host,this.ssl=e.ssl??Ek;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=DN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<H7)throw new fe(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Tk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=JN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new fe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new fe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new fe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},dc=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Om({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Om(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new om;switch(i.type){case"firstParty":return new cw(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new fe(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=_k.get(t);i&&(De(AH,"Removing Datastore"),_k.delete(t),i.terminate())})(this),Promise.resolve()}};function ZN(n,e,t,i={}){n=zr(n,dc);let r=_s(e),o=n._getSettings(),s=ce(F({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;r&&($g(`https://${a}`),zg("Firestore",!0)),o.host!==XN&&o.host!==a&&Ss("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=ce(F({},o),{host:a,ssl:r,emulatorOptions:i});if(!ar(l,s)&&(n._setSettings(l),i.mockUserToken)){let c,d;if(typeof i.mockUserToken=="string")c=i.mockUserToken,d=An.MOCK_USER;else{c=hR(i.mockUserToken,n._app?.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new fe(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new An(h)}n._authCredentials=new aw(new rm(c,d))}}var dr=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},bn=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new So(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(gc(t,n._jsonSchema))return new n(e,i||null,new Pe(Pt.fromString(t.referencePath)))}};bn._jsonSchemaVersion="firestore/documentReference/1.0",bn._jsonSchema={type:on("string",bn._jsonSchemaVersion),referencePath:on("string")};var So=class n extends dr{constructor(e,t,i){super(e,t,Bm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new Pe(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function ai(n,e,...t){if(n=Dn(n),Ik("collection","path",e),n instanceof dc){let i=Pt.fromString(e,...t);return BR(i),new So(n,null,i)}{if(!(n instanceof bn||n instanceof So))throw new fe(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Pt.fromString(e,...t));return BR(i),new So(n.firestore,null,i)}}function As(n,e,...t){if(n=Dn(n),arguments.length===1&&(e=ka.newId()),Ik("doc","path",e),n instanceof dc){let i=Pt.fromString(e,...t);return UR(i),new bn(n,null,new Pe(i))}{if(!(n instanceof bn||n instanceof So))throw new fe(J.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Pt.fromString(e,...t));return UR(i),new bn(n.firestore,n instanceof So?n.converter:null,new Pe(i))}}var bk="AsyncQueue",Fm=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Tm(this,"async_queue_retry"),this._c=()=>{let i=ow();i&&De(bk,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;let t=ow();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=ow();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new cr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!yc(e))throw e;De(bk,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,To("INTERNAL UNHANDLED ERROR: ",wk(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=_1.createAndSchedule(this,e,t,i,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&Le(47125,{Pc:wk(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function wk(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Po=class extends dc{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Fm,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Fm(e),this._firestoreClient=void 0,await e}}};function Jd(n,e){let t=typeof n=="object"?n:Yg(),i=typeof n=="string"?n:e||fm,r=xd(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let o=dR("firestore");o&&ZN(r,...o)}return r}function Xd(n){if(n._terminated)throw new fe(J.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||RH(n),n._firestoreClient}function RH(n){let e=n._freezeSettings(),t=MH(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new D1(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}var Hr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ln.fromBase64String(e))}catch(t){throw new fe(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gc(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Hr._jsonSchemaVersion="firestore/bytes/1.0",Hr._jsonSchema={type:on("string",Hr._jsonSchemaVersion),bytes:on("string")};var hc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new si(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var fc=class{constructor(e){this._methodName=e}};var Io=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(gc(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Io._jsonSchemaVersion="firestore/geoPoint/1.0",Io._jsonSchema={type:on("string",Io._jsonSchemaVersion),latitude:on("number"),longitude:on("number")};var Gr=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gc(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new fe(J.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Gr._jsonSchemaVersion="firestore/vectorValue/1.0",Gr._jsonSchema={type:on("string",Gr._jsonSchemaVersion),vectorValues:on("object")};var kH=/^__.*__$/,A1=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new No(e,this.data,this.fieldMask,t,this.fieldTransforms):new La(e,this.data,t,this.fieldTransforms)}};function eP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{dataSource:n})}}var M1=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(F(F({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Lm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(eP(this.dataSource)&&kH.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},R1=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Kd(e)}createContext(e,t,i,r=!1){return new M1({dataSource:e,methodName:t,targetDoc:i,path:si.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Zd(n){let e=n._freezeSettings(),t=Kd(n._databaseId);return new R1(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Z1(n,e,t,i,r,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);iP("Data must be an object, but it was:",s,i);let a=tP(i,s),l,c;if(o.merge)l=new Vr(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let f=_c(e,h,t);if(!s.contains(f))throw new fe(J.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);PH(d,f)||d.push(f)}l=new Vr(d),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new A1(new ji(a),l,c)}var k1=class n extends fc{_toFieldTransform(e){return new Iw(e.path,new Pa)}isEqual(e){return e instanceof n}};function ex(n,e,t,i=!1){return tx(t,n.createContext(i?4:3,e))}function tx(n,e){if(nP(n=Dn(n)))return iP("Unsupported field value:",e,n),tP(n,e);if(n instanceof fc)return(function(i,r){if(!eP(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){let o=[],s=0;for(let a of i){let l=tx(a,r.childContextForArray(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Dn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return m7(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=sn.fromDate(i);return{timestampValue:_m(r.serializer,o)}}if(i instanceof sn){let o=new sn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:_m(r.serializer,o)}}if(i instanceof Io)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Hr)return{bytesValue:_N(r.serializer,i._byteString)};if(i instanceof bn){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:H1(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Gr)return(function(s,a){let l=s instanceof Gr?s.toArray():s;return{mapValue:{fields:{[F1]:{stringValue:L1},[oc]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return j1(a.serializer,d)})}}}}}})(i,r);if(TN(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${zd(i)}`)})(n,e)}function tP(n,e){let t={};return Gk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ba(n,(i,r)=>{let o=tx(r,e.childContextForField(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function nP(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof sn||n instanceof Io||n instanceof Hr||n instanceof bn||n instanceof fc||n instanceof Gr||TN(n))}function iP(n,e,t){if(!nP(t)||!Ck(t)){let i=zd(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function _c(n,e,t){if((e=Dn(e))instanceof hc)return e._internalPath;if(typeof e=="string")return rP(n,e);throw Lm("Field path arguments must be of type string or ",n,!1,void 0,t)}var NH=new RegExp("[~\\*/\\[\\]]");function rP(n,e,t){if(e.search(NH)>=0)throw Lm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new hc(...e.split("."))._internalPath}catch{throw Lm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Lm(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new fe(J.INVALID_ARGUMENT,a+n+l)}function PH(n,e){return n.some(t=>t.isEqual(e))}var Gd=class{convertValue(e,t="none"){switch(Is(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Do(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Ba(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){let t=e.fields?.[oc].arrayValue?.values?.map(i=>$t(i.doubleValue));return new Gr(t)}convertGeoPoint(e){return new Io($t(e.latitude),$t(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Um(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Nd(e));default:return null}}convertTimestamp(e){let t=Co(e);return new sn(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Pt.fromString(e);bt(IN(i),9688,{name:e});let r=new Pd(i.get(1),i.get(3)),o=new Pe(i.popFirst(5));return r.isEqual(t)||To(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var $d=class extends Gd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,t)}};function eh(){return new k1("serverTimestamp")}var oP="@firebase/firestore",sP="4.10.0";var th=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new nx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(_c("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},nx=class extends th{data(){return super.data()}};function VH(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new fe(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var nh=class{},wc=class extends nh{};function Wr(n,e,...t){let i=[];e instanceof nh&&i.push(e),i=i.concat(t),(function(o){let s=o.filter(l=>l instanceof ix).length,a=o.filter(l=>l instanceof qm).length;if(s>1||s>0&&a>0)throw new fe(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var qm=class n extends wc{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return uP(e._query,t),new dr(e.firestore,e.converter,Hm(e._query,t))}_parse(e){let t=Zd(e.firestore);return(function(o,s,a,l,c,d,h){let f;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new fe(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){lP(h,d);let w=[];for(let S of h)w.push(aP(l,o,S));f={arrayValue:{values:w}}}else f=aP(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||lP(h,d),f=ex(a,s,h,d==="in"||d==="not-in");return rn.create(c,d,f)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function hr(n,e,t){let i=e,r=_c("where",n);return qm._create(r,i,t)}var ix=class n extends nh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Hi.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let s=r,a=o.getFlattenedFilters();for(let l of a)uP(s,l),s=Hm(s,l)})(e._query,t),new dr(e.firestore,e.converter,Hm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var rx=class n extends wc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(r,o,s){if(r.startAt!==null)throw new fe(J.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new fe(J.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ts(o,s)})(e._query,this._field,this._direction);return new dr(e.firestore,e.converter,rN(e._query,t))}};function Ti(n,e="asc"){let t=e,i=_c("orderBy",n);return rx._create(i,t)}var ox=class n extends wc{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new dr(e.firestore,e.converter,Fd(e._query,this._limit,this._limitType))}};function Oo(n){return Dk("limit",n),ox._create("limit",n,"F")}var sx=class n extends wc{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=UH(e,this.type,this._docOrFields,this._inclusive);return new dr(e.firestore,e.converter,oN(e._query,t))}};function cP(...n){return sx._create("startAfter",n,!1)}function UH(n,e,t,i){if(t[0]=Dn(t[0]),t[0]instanceof th)return(function(o,s,a,l,c){if(!l)throw new fe(J.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of Ma(o))if(h.field.isKeyField())d.push(qd(s,l.key));else{let f=l.data.field(h.field);if(Wd(f))throw new fe(J.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){let m=h.field.canonicalString();throw new fe(J.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}d.push(f)}return new Ao(d,c)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Zd(n.firestore);return(function(s,a,l,c,d,h){let f=s.explicitOrderBy;if(d.length>f.length)throw new fe(J.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let m=[];for(let w=0;w<d.length;w++){let S=d[w];if(f[w].field.isKeyField()){if(typeof S!="string")throw new fe(J.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof S}`);if(!jm(s)&&S.indexOf("/")!==-1)throw new fe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${S}' contains a slash.`);let k=s.path.child(Pt.fromString(S));if(!Pe.isDocumentKey(k))throw new fe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);let V=new Pe(k);m.push(qd(a,V))}else{let k=ex(l,c,S);m.push(k)}}return new Ao(m,h)})(n._query,n.firestore._databaseId,r,e,t,i)}}function aP(n,e,t){if(typeof(t=Dn(t))=="string"){if(t==="")throw new fe(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jm(e)&&t.indexOf("/")!==-1)throw new fe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Pt.fromString(t));if(!Pe.isDocumentKey(i))throw new fe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return qd(n,new Pe(i))}if(t instanceof bn)return qd(n,t._key);throw new fe(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zd(t)}.`)}function lP(n,e){if(!Array.isArray(n)||n.length===0)throw new fe(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uP(n,e){let t=(function(r,o){for(let s of r)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new fe(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function dP(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var Ha=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ga=class n extends th{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Ec(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(_c("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(J.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Ga._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ga._jsonSchema={type:on("string",Ga._jsonSchemaVersion),bundleSource:on("string","DocumentSnapshot"),bundleName:on("string"),bundle:on("string")};var Ec=class extends Ga{data(e={}){return super.data(e)}},bc=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ha(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Ec(this._firestore,this._userDataWriter,i.key,i,new Ha(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{let l=new Ec(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Ha(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new Ec(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Ha(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),c=-1,d=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:BH(a.type),doc:l,oldIndex:c,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(J.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ka.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function BH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}bc._jsonSchemaVersion="firestore/querySnapshot/1.0",bc._jsonSchema={type:on("string",bc._jsonSchemaVersion),bundleSource:on("string","QuerySnapshot"),bundleName:on("string"),bundle:on("string")};function ax(n){n=zr(n,bn);let e=zr(n.firestore,Po),t=Xd(e);return KN(t,n._key).then(i=>jH(e,n,i))}function Fo(n){n=zr(n,dr);let e=zr(n.firestore,Po),t=Xd(e),i=new $d(e);return VH(n._query),YN(t,n._query).then(r=>new bc(e,i,n,r))}function Km(n,e,t){n=zr(n,bn);let i=zr(n.firestore,Po),r=dP(n.converter,e,t),o=Zd(i);return hP(i,[Z1(o,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,xo.none())])}function ih(n,e){let t=zr(n.firestore,Po),i=As(n),r=dP(n.converter,e),o=Zd(n.firestore);return hP(t,[Z1(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,xo.exists(!1))]).then(()=>i)}function hP(n,e){let t=Xd(n);return QN(t,e)}function jH(n,e,t){let i=t.docs.get(e._key),r=new $d(n);return new Ga(n,r,e._key,i,new Ha(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){xk(xs),ws(new Ui("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),a=new Po(new sm(i.getProvider("auth-internal")),new lm(s,i.getProvider("app-check-internal")),Kk(s,r),s);return o=F({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),lr(oP,sP,e),lr(oP,sP,"esm2020")})();function CP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var DP=CP,AP=new _o("auth","Firebase",CP());var e0=new Es("@firebase/auth");function HH(n,...e){e0.logLevel<=nt.WARN&&e0.warn(`Auth (${xs}): ${n}`,...e)}function Qm(n,...e){e0.logLevel<=nt.ERROR&&e0.error(`Auth (${xs}): ${n}`,...e)}function Kr(n,...e){throw Ix(n,...e)}function fr(n,...e){return Ix(n,...e)}function Sx(n,e,t){let i=ce(F({},DP()),{[e]:t});return new _o("auth","Firebase",i).create(e,{appName:n.name})}function $a(n){return Sx(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function GH(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Kr(n,"argument-error"),Sx(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ix(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return AP.create(n,...e)}function He(n,e,...t){if(!n)throw Ix(e,...t)}function Lo(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Qm(e),new Error(e)}function Uo(n,e){n||Lo(e)}function ux(){return typeof self<"u"&&self.location?.href||""}function $H(){return fP()==="http:"||fP()==="https:"}function fP(){return typeof self<"u"&&self.location?.protocol||null}function zH(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($H()||gR()||"connection"in navigator)?navigator.onLine:!0}function WH(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var za=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Uo(t>e,"Short delay should be less than long delay!"),this.isMobile=fR()||mR()}get(){return zH()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Tx(n,e){Uo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var t0=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Lo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Lo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Lo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var qH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var KH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],YH=new za(3e4,6e4);function Cx(n,e){return n.tenantId&&!e.tenantId?ce(F({},e),{tenantId:n.tenantId}):e}async function Sc(n,e,t,i,r={}){return MP(n,r,async()=>{let o={},s={};i&&(e==="GET"?s=i:o={body:JSON.stringify(i)});let a=Ql(F({key:n.config.apiKey},s)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let c=F({method:e,headers:l},o);return pR()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&_s(n.emulatorConfig.host)&&(c.credentials="include"),t0.fetch()(await RP(n,n.config.apiHost,t,a),c)})}async function MP(n,e,t){n._canInitEmulator=!1;let i=F(F({},qH),e);try{let r=new dx(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw Ym(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ym(n,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw Ym(n,"email-already-in-use",s);if(l==="USER_DISABLED")throw Ym(n,"user-disabled",s);let d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Sx(n,d,c);Kr(n,d)}}catch(r){if(r instanceof Si)throw r;Kr(n,"network-request-failed",{message:String(r)})}}async function QH(n,e,t,i,r={}){let o=await Sc(n,e,t,i,r);return"mfaPendingCredential"in o&&Kr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function RP(n,e,t,i){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?Tx(n.config,r):`${n.config.apiScheme}://${r}`;return KH.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var dx=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(fr(this.auth,"network-request-failed")),YH.get())})}};function Ym(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=fr(n,e,i);return r.customData._tokenResponse=t,r}async function JH(n,e){return Sc(n,"POST","/v1/accounts:delete",e)}async function n0(n,e){return Sc(n,"POST","/v1/accounts:lookup",e)}function rh(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kP(n,e=!1){let t=Dn(n),i=await t.getIdToken(e),r=Dx(i);He(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:rh(lx(r.auth_time)),issuedAtTime:rh(lx(r.iat)),expirationTime:rh(lx(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function lx(n){return Number(n)*1e3}function Dx(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Qm("JWT malformed, contained fewer than 3 sections"),null;try{let r=Hg(t);return r?JSON.parse(r):(Qm("Failed to decode base64 JWT payload"),null)}catch(r){return Qm("Caught error parsing JWT payload as JSON",r?.toString()),null}}function pP(n){let e=Dx(n);return He(e,"internal-error"),He(typeof e.exp<"u","internal-error"),He(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function sh(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Si&&XH(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function XH({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var hx=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var ah=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=rh(this.lastLoginAt),this.creationTime=rh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function i0(n){let e=n.auth,t=await n.getIdToken(),i=await sh(n,n0(e,{idToken:t}));He(i?.users.length,e,"internal-error");let r=i.users[0];n._notifyReloadListener(r);let o=r.providerUserInfo?.length?PP(r.providerUserInfo):[],s=ZH(n.providerData,o),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!s?.length,c=a?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new ah(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(n,d)}async function NP(n){let e=Dn(n);await i0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZH(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function PP(n){return n.map(i=>{var r=i,{providerId:e}=r,t=Xa(r,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function eG(n,e){let t=await MP(n,{},async()=>{let i=Ql({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=await RP(n,r,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return n.emulatorConfig&&_s(n.emulatorConfig.host)&&(l.credentials="include"),t0.fetch()(s,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tG(n,e){return Sc(n,"POST","/v2/accounts:revokeToken",Cx(n,e))}var oh=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){He(e.idToken,"internal-error"),He(typeof e.idToken<"u","internal-error"),He(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pP(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){He(e.length!==0,"internal-error");let t=pP(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(He(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:r,expiresIn:o}=await eG(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n;return i&&(He(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(He(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(He(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Lo("not implemented")}};function Ms(n,e){He(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Rs=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:i}=s,r=Xa(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new hx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ah(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await sh(this,this.stsTokenManager.getToken(this.auth,e));return He(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return kP(this,e)}reload(){return NP(this)}_assign(e){this!==e&&(He(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>F({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(ce(F({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){He(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await i0(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ii(this.auth.app))return Promise.reject($a(this.auth));let e=await this.getIdToken();return await sh(this,JH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return ce(F({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>F({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:m,providerData:w,stsTokenManager:S}=t;He(h&&S,e,"internal-error");let k=oh.fromJSON(this.name,S);He(typeof h=="string",e,"internal-error"),Ms(i,e.name),Ms(r,e.name),He(typeof f=="boolean",e,"internal-error"),He(typeof m=="boolean",e,"internal-error"),Ms(o,e.name),Ms(s,e.name),Ms(a,e.name),Ms(l,e.name),Ms(c,e.name),Ms(d,e.name);let V=new n({uid:h,auth:e,email:r,emailVerified:f,displayName:i,isAnonymous:m,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:k,createdAt:c,lastLoginAt:d});return w&&Array.isArray(w)&&(V.providerData=w.map(q=>F({},q))),l&&(V._redirectEventId=l),V}static async _fromIdTokenResponse(e,t,i=!1){let r=new oh;r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await i0(o),o}static async _fromGetAccountInfoResponse(e,t,i){let r=t.users[0];He(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?PP(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,a=new oh;a.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new ah(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(l,c),l}};var gP=new Map;function Vo(n){Uo(n instanceof Function,"Expected a class definition");let e=gP.get(n);return e?(Uo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,gP.set(n,e),e)}var nG=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,i){this.storage[t]=i}async _get(t){let i=this.storage[t];return i===void 0?null:i}async _remove(t){delete this.storage[t]}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),fx=nG;function Jm(n,e,t){return`firebase:${n}:${e}:${t}`}var r0=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=Jm(this.userKey,r.apiKey,o),this.fullPersistenceKey=Jm("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await n0(this.auth,{idToken:e}).catch(()=>{});return t?Rs._fromGetAccountInfoResponse(this.auth,t,e):null}return Rs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new n(Vo(fx),e,i);let r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c),o=r[0]||Vo(fx),s=Jm(i,e.config.apiKey,e.name),a=null;for(let c of t)try{let d=await c._get(s);if(d){let h;if(typeof d=="string"){let f=await n0(e,{idToken:d}).catch(()=>{});if(!f)break;h=await Rs._fromGetAccountInfoResponse(e,f,d)}else h=Rs._fromJSON(e,d);c!==o&&(a=h),o=c;break}}catch{}let l=r.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,i):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==o)try{await c._remove(s)}catch{}})),new n(o,e,i))}};function mP(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(OP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BP(e))return"Blackberry";if(jP(e))return"Webos";if(FP(e))return"Safari";if((e.includes("chrome/")||LP(e))&&!e.includes("edge/"))return"Chrome";if(UP(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function OP(n=Cn()){return/firefox\//i.test(n)}function FP(n=Cn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function LP(n=Cn()){return/crios\//i.test(n)}function VP(n=Cn()){return/iemobile/i.test(n)}function UP(n=Cn()){return/android/i.test(n)}function BP(n=Cn()){return/blackberry/i.test(n)}function jP(n=Cn()){return/webos/i.test(n)}function Ax(n=Cn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function iG(n=Cn()){return Ax(n)&&!!window.navigator?.standalone}function rG(){return yR()&&document.documentMode===10}function HP(n=Cn()){return Ax(n)||UP(n)||jP(n)||BP(n)||/windows phone/i.test(n)||VP(n)}function GP(n,e=[]){let t;switch(n){case"Browser":t=mP(Cn());break;case"Worker":t=`${mP(Cn())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xs}/${i}`}var px=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=o=>new Promise((s,a)=>{try{let l=e(o);s(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}};async function oG(n,e={}){return Sc(n,"GET","/v2/passwordPolicy",Cx(n,e))}var sG=6,gx=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??sG,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var mx=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new o0(this),this.idTokenSubscription=new o0(this),this.beforeStateQueue=new px(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vo(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await r0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await n0(this,{idToken:e}),i=await Rs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ii(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return He(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await i0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WH()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ii(this.app))return Promise.reject($a(this));let t=e?Dn(e):null;return t&&He(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&He(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ii(this.app)?Promise.reject($a(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ii(this.app)?Promise.reject($a(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await oG(this),t=new gx(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new _o("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await tG(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Vo(e)||this._popupRedirectResolver;He(t,this,"argument-error"),this.redirectPersistenceManager=await r0.create(this,[Vo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(He(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{s=!0,l()}}else{let l=e.addObserver(t);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return He(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=GP(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Ii(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&HH(`Error while retrieving App Check token: ${e.error}`),e?.token}};function f0(n){return Dn(n)}var o0=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=bR(t=>this.observer=t)}get next(){return He(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Mx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aG(n){Mx=n}function lG(n){return Mx.loadJS(n)}function cG(){return Mx.gapiScript}function $P(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function zP(n,e){let t=xd(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(ar(o,e??{}))return r;Kr(r,"already-initialized")}return t.initialize({options:e})}function uG(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vo);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function WP(n,e,t){let i=f0(n);He(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=qP(e),{host:s,port:a}=dG(e),l=a===null?"":`:${a}`,c={url:`${o}//${s}${l}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){He(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),He(ar(c,i.config.emulator)&&ar(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,_s(s)?($g(`${o}//${s}${l}`),zg("Auth",!0)):r||hG()}function qP(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function dG(n){let e=qP(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:yP(i.substr(o.length+1))}}else{let[o,s]=i.split(":");return{host:o,port:yP(s)}}}function yP(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function hG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var lh=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Lo("not implemented")}_getIdTokenResponse(e){return Lo("not implemented")}_linkToIdToken(e,t){return Lo("not implemented")}_getReauthenticationResolver(e){return Lo("not implemented")}};async function xc(n,e){return QH(n,"POST","/v1/accounts:signInWithIdp",Cx(n,e))}var fG="http://localhost",s0=class n extends lh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Kr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=a,o=Xa(a,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return xc(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,xc(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,xc(e,t)}buildRequest(){let e={requestUri:fG,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ql(t)}return e}};var ch=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var a0=class extends ch{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Rx=(()=>{class n extends a0{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return s0._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var uh=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){let o=await Rs._fromIdTokenResponse(e,i,r),s=vP(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);let r=vP(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})}};function vP(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var yx=class n extends Si{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function KP(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?yx._fromErrorAndOperation(n,o,e,i):o})}async function pG(n,e,t=!1){let i=await sh(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return uh._forOperation(n,"link",i)}async function gG(n,e,t=!1){let{auth:i}=n;if(Ii(i.app))return Promise.reject($a(i));let r="reauthenticate";try{let o=await sh(n,KP(i,r,e,n),t);He(o.idToken,i,"internal-error");let s=Dx(o.idToken);He(s,i,"internal-error");let{sub:a}=s;return He(n.uid===a,i,"user-mismatch"),uh._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&Kr(i,"user-mismatch"),o}}async function mG(n,e,t=!1){if(Ii(n.app))return Promise.reject($a(n));let i="signIn",r=await KP(n,i,e),o=await uh._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}function YP(n,e,t,i){return Dn(n).onIdTokenChanged(e,t,i)}function QP(n,e,t){return Dn(n).beforeAuthStateChanged(e,t)}function kx(n,e,t,i){return Dn(n).onAuthStateChanged(e,t,i)}function Nx(n){return Dn(n).signOut()}var l0="__sak";var c0=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(l0,"1"),this.storage.removeItem(l0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var yG=1e3,vG=10,_G=(()=>{class n extends c0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=HP(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);rG()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,vG):o()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},yG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,i){await super._set(t,i),this.localCache[t]=JSON.stringify(i)}async _get(t){let i=await super._get(t);return this.localCache[t]=JSON.stringify(i),i}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),JP=_G;var EG=(()=>{class n extends c0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),Px=EG;function bG(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var wG=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let i=t,{eventId:r,eventType:o,data:s}=i.data,a=this.handlersMap[o];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let l=Array.from(a).map(async d=>d(i.origin,s)),c=await bG(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:c})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Ox(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var vx=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{let c=Ox("",20);r.port1.start();let d=setTimeout(()=>{l(new Error("unsupported_event"))},i);s={messageChannel:r,onMessage(h){let f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(f.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function qr(){return window}function xG(n){qr().location.href=n}function XP(){return typeof qr().WorkerGlobalScope<"u"&&typeof qr().importScripts=="function"}async function SG(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function IG(){return navigator?.serviceWorker?.controller||null}function TG(){return XP()?self:null}var ZP="firebaseLocalStorageDb",CG=1,u0="firebaseLocalStorage",eO="fbase_key",Wa=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function p0(n,e){return n.transaction([u0],e?"readwrite":"readonly").objectStore(u0)}function DG(){let n=indexedDB.deleteDatabase(ZP);return new Wa(n).toPromise()}function _x(){let n=indexedDB.open(ZP,CG);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(u0,{keyPath:eO})}catch(r){t(r)}}),n.addEventListener("success",async()=>{let i=n.result;i.objectStoreNames.contains(u0)?e(i):(i.close(),await DG(),e(await _x()))})})}async function _P(n,e,t){let i=p0(n,!0).put({[eO]:e,value:t});return new Wa(i).toPromise()}async function AG(n,e){let t=p0(n,!1).get(e),i=await new Wa(t).toPromise();return i===void 0?null:i.value}function EP(n,e){let t=p0(n,!0).delete(e);return new Wa(t).toPromise()}var MG=800,RG=3,kG=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _x(),this.db)}async _withRetries(t){let i=0;for(;;)try{let r=await this._openDb();return await t(r)}catch(r){if(i++>RG)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return XP()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wG._getInstance(TG()),this.receiver._subscribe("keyChanged",async(t,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(t,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await SG(),!this.activeServiceWorker)return;this.sender=new vx(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||IG()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await _x();return await _P(t,l0,"1"),await EP(t,l0),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,i){return this._withPendingWrite(async()=>(await this._withRetries(r=>_P(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)))}async _get(t){let i=await this._withRetries(r=>AG(r,t));return this.localCache[t]=i,i}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(i=>EP(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=p0(o,!1).getAll();return new Wa(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),MG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),tO=kG;var qhe=$P("rcb"),Khe=new za(3e4,6e4);function nO(n,e){return e?Vo(e):(He(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var dh=class extends lh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return xc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return xc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function NG(n){return mG(n.auth,new dh(n),n.bypassAuthState)}function PG(n){let{auth:e,user:t}=n;return He(t,e,"internal-error"),gG(t,new dh(n),n.bypassAuthState)}async function OG(n){let{auth:e,user:t}=n;return He(t,e,"internal-error"),pG(t,new dh(n),n.bypassAuthState)}var d0=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NG;case"linkViaPopup":case"linkViaRedirect":return OG;case"reauthViaPopup":case"reauthViaRedirect":return PG;default:Kr(this.auth,"internal-error")}}resolve(e){Uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var FG=new za(2e3,1e4);async function Fx(n,e,t){if(Ii(n.app))return Promise.reject(fr(n,"operation-not-supported-in-this-environment"));let i=f0(n);GH(n,e,ch);let r=nO(i,t);return new LG(i,"signInViaPopup",e,r).executeNotNull()}var LG=(()=>{class n extends d0{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return He(t,this.auth,"internal-error"),t}async onExecution(){Uo(this.filter.length===1,"Popup operations only handle one event");let t=Ox();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(fr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(fr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,FG.get())};t()}}n.currentPopupAction=null;return n})(),VG="pendingRedirect",Xm=new Map,Ex=class extends d0{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Xm.get(this.auth._key());if(!e){try{let i=await UG(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Xm.set(this.auth._key(),e)}return this.bypassAuthState||Xm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function UG(n,e){let t=HG(e),i=jG(n);if(!await i._isAvailable())return!1;let r=await i._get(t)==="true";return await i._remove(t),r}function BG(n,e){Xm.set(n._key(),e)}function jG(n){return Vo(n._redirectPersistence)}function HG(n){return Jm(VG,n.config.apiKey,n.name)}async function GG(n,e,t=!1){if(Ii(n.app))return Promise.reject($a(n));let i=f0(n),r=nO(i,e),s=await new Ex(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}var $G=600*1e3,bx=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zG(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!iO(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(fr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$G&&this.cachedEventUids.clear(),this.cachedEventUids.has(bP(e))}saveEventToCache(e){this.cachedEventUids.add(bP(e)),this.lastProcessedEventTime=Date.now()}};function bP(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function iO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function zG(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iO(n);default:return!1}}async function WG(n,e={}){return Sc(n,"GET","/v1/projects",e)}var qG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KG=/^https?/;async function YG(n){if(n.config.emulator)return;let{authorizedDomains:e}=await WG(n);for(let t of e)try{if(QG(t))return}catch{}Kr(n,"unauthorized-domain")}function QG(n){let e=ux(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i}if(!KG.test(t))return!1;if(qG.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var JG=new za(3e4,6e4);function wP(){let n=qr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function XG(n){return new Promise((e,t)=>{function i(){wP(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wP(),t(fr(n,"network-request-failed"))},timeout:JG.get()})}if(qr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(qr().gapi?.load)i();else{let r=$P("iframefcb");return qr()[r]=()=>{gapi.load?i():t(fr(n,"network-request-failed"))},lG(`${cG()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw Zm=null,e})}var Zm=null;function ZG(n){return Zm=Zm||XG(n),Zm}var e$=new za(5e3,15e3),t$="__/auth/iframe",n$="emulator/auth/iframe",i$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},r$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function o$(n){let e=n.config;He(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Tx(e,n$):`https://${n.config.authDomain}/${t$}`,i={apiKey:e.apiKey,appName:n.name,v:xs},r=r$.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Ql(i).slice(1)}`}async function s$(n){let e=await ZG(n),t=qr().gapi;return He(t,n,"internal-error"),e.open({where:document.body,url:o$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:i$,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});let s=fr(n,"network-request-failed"),a=qr().setTimeout(()=>{o(s)},e$.get());function l(){qr().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{o(s)})}))}var a$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},l$=500,c$=600,u$="_blank",d$="http://localhost",h0=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function h$(n,e,t,i=l$,r=c$){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=ce(F({},a$),{width:i.toString(),height:r.toString(),top:o,left:s}),c=Cn().toLowerCase();t&&(a=LP(c)?u$:t),OP(c)&&(e=e||d$,l.scrollbars="yes");let d=Object.entries(l).reduce((f,[m,w])=>`${f}${m}=${w},`,"");if(iG(c)&&a!=="_self")return f$(e||"",a),new h0(null);let h=window.open(e||"",a,d);He(h,n,"popup-blocked");try{h.focus()}catch{}return new h0(h)}function f$(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var p$="__/auth/handler",g$="emulator/auth/handler",m$=encodeURIComponent("fac");async function xP(n,e,t,i,r,o){He(n.config.authDomain,n,"auth-domain-config-required"),He(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:xs,eventId:r};if(e instanceof ch){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",ER(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(o||{}))s[d]=h}if(e instanceof a0){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let l=await n._getAppCheckToken(),c=l?`#${m$}=${encodeURIComponent(l)}`:"";return`${y$(n)}?${Ql(a).slice(1)}${c}`}function y$({config:n}){return n.emulator?Tx(n,g$):`https://${n.authDomain}/${p$}`}var cx="webStorageSupport",wx=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Px,this._completeRedirectFn=GG,this._overrideRedirectResult=BG}async _openPopup(e,t,i,r){Uo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await xP(e,t,i,ux(),r);return h$(e,o,Ox())}async _openRedirect(e,t,i,r){await this._originValidation(e);let o=await xP(e,t,i,ux(),r);return xG(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Uo(o,"If manager is not set, promise should be"),o)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await s$(e),i=new bx(e);return t.register("authEvent",r=>(He(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(cx,{type:cx},r=>{let o=r?.[0]?.[cx];o!==void 0&&t(!!o),Kr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YG(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return HP()||FP()||Ax()}},rO=wx;var SP="@firebase/auth",IP="1.12.0";var xx=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){He(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function v$(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _$(n){ws(new Ui("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=i.options;He(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:GP(n)},c=new mx(i,r,o,l);return uG(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ws(new Ui("auth-internal",e=>{let t=f0(e.getProvider("auth").getImmediate());return(i=>new xx(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),lr(SP,IP,v$(n)),lr(SP,IP,"esm2020")}var E$=300,b$=Pb("authIdTokenMaxAge")||E$,TP=null,w$=n=>async e=>{let t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>b$)return;let r=t?.token;TP!==r&&(TP=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function hh(n=Yg()){let e=xd(n,"auth");if(e.isInitialized())return e.getImmediate();let t=zP(n,{popupRedirectResolver:rO,persistence:[tO,JP,Px]}),i=Pb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=w$(o.toString());QP(t,s,()=>s(t.currentUser)),YP(t,a=>s(a))}}let r=kb("auth");return r&&WP(t,`http://${r}`),t}function x$(){return document.getElementsByTagName("head")?.[0]??document}aG({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=fr("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",x$().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_$("Browser");var g0={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var Rn=class n{constructor(e){this.platformId=e;let t=Sd(g0);try{this.db=Jd(t)}catch(i){console.warn("Firestore init failed (likely SSR)",i)}if(gs(this.platformId))try{this.auth=hh(t),kx(this.auth,i=>{this.user$.set(i),i?(this.loadedMasteriesUserId!==i.uid||!this.masteryProfile())&&this.loadTowerDefenseMasteries(i.uid):(this.masteryProfile.set(null),this.loadedMasteriesUserId=null)})}catch(i){console.warn("Auth init failed",i)}}db=null;auth=null;loadedMasteriesUserId=null;user$=$(null);masteryProfile=$(null);async loginWithGoogle(){if(!(!this.auth||!gs(this.platformId)))try{let e=new Rx;await Fx(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await Nx(this.auth)}async saveHighScore(e){if(this.db)try{await ih(ai(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,i){if(!this.db)return[];try{let r=Wr(ai(this.db,"highscores"),hr("difficulty","==",t),hr("mapSize","==",i),Ti("victory","desc"),Ti("turnsPlayed","asc"),Oo(e));return(await Fo(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching scores: ",r),[]}}async getUserScores(e){if(!this.db)return[];try{let t=Wr(ai(this.db,"highscores"),hr("userId","==",e),hr("victory","==",!0),Ti("turnsPlayed","asc"));return(await Fo(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}async saveTowerDefenseScore(e){if(this.db)try{console.count("FIREBASE_CALL: saveTowerDefenseScore");let t;if(e.userId)try{let r=As(this.db,"towerDefenseMasteries",e.userId),o=await ax(r);if(o.exists()){let s=o.data();t=s&&typeof s.totalXp=="number"?s.totalXp:0}}catch{t=void 0}let i=ce(F({},e),{userTotalXp:t,timestamp:eh()});await ih(ai(this.db,"towerDefenseLeaderboards"),i)}catch(t){console.error("Error adding TD score: ",t)}}async getTopTowerDefenseScores(e,t){if(!this.db)return[];let i=`${t}x${t}`;try{let r=Wr(ai(this.db,"towerDefenseLeaderboards"),hr("mapSize","==",i),Ti("maxWave","desc"),Ti("timestamp","desc"),Oo(e));return(await Fo(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching TD scores: ",r),[]}}async getUserBestTowerDefenseScore(e,t){if(!this.db)return null;let i=`${t}x${t}`;try{let r=Wr(ai(this.db,"towerDefenseLeaderboards"),hr("userId","==",e),hr("mapSize","==",i),Ti("maxWave","desc"),Ti("timestamp","desc"),Oo(1)),o=await Fo(r);return o.empty?null:o.docs[0].data()}catch{return null}}async loadTowerDefenseMasteries(e){if(this.db&&!(this.loadedMasteriesUserId===e&&this.masteryProfile()))try{console.count("FIREBASE_CALL: loadTowerDefenseMasteries");let t=As(this.db,"towerDefenseMasteries",e),i=await ax(t);if(i.exists()){let r=i.data(),o={totalXp:typeof r.totalXp=="number"?r.totalXp:0,usedPoints:typeof r.usedPoints=="number"?r.usedPoints:0,upgrades:r.upgrades&&typeof r.upgrades=="object"?r.upgrades:{}};this.masteryProfile.set(o)}else{let r={totalXp:0,usedPoints:0,upgrades:{}};await Km(t,F({userId:e},r)),this.masteryProfile.set(r)}this.loadedMasteriesUserId=e}catch(t){console.error("Error loading TD mastery profile: ",t)}}setMasteryProfile(e){this.masteryProfile.set(e)}async saveTowerDefenseMasteries(){if(!this.db)return;let e=this.user$(),t=this.masteryProfile();if(!(!e||!t))try{console.count("FIREBASE_CALL: saveTowerDefenseMasteries");let i=As(this.db,"towerDefenseMasteries",e.uid);await Km(i,F({userId:e.uid},t),{merge:!0})}catch(i){console.error("Error saving TD mastery profile: ",i)}}async awardTowerDefenseXp(e){if(!this.db||e<=0)return;let t=this.user$();if(t)try{console.count("FIREBASE_CALL: awardTowerDefenseXp");let i=this.masteryProfile()??{totalXp:0,usedPoints:0,upgrades:{}},r={totalXp:i.totalXp+e,usedPoints:i.usedPoints,upgrades:i.upgrades},o=As(this.db,"towerDefenseMasteries",t.uid);await Km(o,F({userId:t.uid},r),{merge:!0}),this.masteryProfile.set(r)}catch(i){console.error("Error awarding TD XP: ",i)}}static \u0275fac=function(t){return new(t||n)(Re(Zi))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ic=class n{platformId=K(Zi);nameSignal=$("Player");constructor(){if(gs(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),gs(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let i=(e??"").toString().trim().slice(0,24);return i.length>0?i:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var $n=class n{constructor(e,t,i,r,o,s,a,l,c){this.combat=e;this.build=t;this.log=i;this.settings=r;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=l;this.playerName=c;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}breakpointObserver=K(Db);screenState=X2(this.breakpointObserver.observe("(max-width: 1024px)").pipe(vt(e=>e.matches)),{initialValue:!1});unitsSignal=$([]);turnSignal=$(1);selectedUnitIdSignal=$(null);gameStatusSignal=$("playing");lastMergedUnitIdSignal=$(null);lastRemainderUnitIdSignal=$(null);resourcesSignal=$({wood:0,iron:0});forestsSignal=$([]);minesSignal=$([]);forgeSitesSignal=$([]);forgesSignal=$([]);aiForgesSignal=$([]);baseHealthSignal=$({player:100,ai:100});reservePointsSignal=$({player:0,ai:0});deployTargetsSignal=$([]);baseDeployActiveSignal=$(!1);wallsSignal=$([]);playerVisibilitySignal=$(new Set);aiVisibilitySignal=$(new Set);playerExploredSignal=$(new Set);aiExploredSignal=$(new Set);unitMoveHistorySignal=$(new Map);unitStutterBanSignal=$(new Map);lastAiMovedUnitIdSignal=$(null);aiConsecMovesSignal=$(0);buildModeSignal=$(!1);fogDebugDisabledSignal=$(!1);wallBuiltThisTurnSignal=$(!1);rulesOpenSignal=$(!1);movedThisTurnSignal=$(new Set);hoveredFormationIdSignal=$(null);aiWoodSignal=$(0);aiIronSignal=$(0);logsOpenSignal=$(!1);settingsOpenSignal=$(!1);activeSideSignal=$("ai");lastArrivedUnitIdSignal=$(null);attackerNudgeSignal=$(null);shakenUnitIdSignal=$(null);shakenWallIdSignal=$(null);pulseUnitIdSignal=$(null);screenShakeSignal=$(!1);endOverlaySignal=$(!1);endReasonSignal=$(null);combatOnlySignal=$(!0);forestMonopolySignal=$({player:0,ai:0});hoveredUnitIdSignal=$(null);autoDeployEnabledSignal=$(!1);highScoresOpenSignal=$(!1);leaderboardOpenSignal=$(!1);namePromptOpenSignal=$(!1);pendingScoreSignal=$(null);supportOpenSignal=$(!1);highScoresSignal=$({});playerConvertedThisTurnSignal=$(!1);unitQuadrantBiasSignal=$(new Map);aiUnitTimeNearBaseSignal=$(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=$(!1);wallCooldownSignal=$(new Map);aiQueuedUnitIdSignal=$(null);aiMoodSignal=$("none");rageCaptureCounterSignal=$(0);anchoredGatherersSignal=$(new Set);totalWarModeSignal=$(!1);aiInvalidActionCountSignal=$(0);aiLastRejectedActionKeySignal=$(null);sandboxSpawnPendingSignal=$(null);unitMoveOffsetSignal=$(new Map);movingUnitsSignal=$(new Set);attackingUnitsSignal=$(new Set);reclamationGoalsSignal=$(new Map);mergeIntentSignal=$(new Map);ignoreForgeUntilTurnSignal=$(new Map);playerClaimedTargetsSignal=$(new Set);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();mines=this.minesSignal.asReadonly();forges=this.forgesSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();isMobile=Bn(()=>this.screenState());sandboxSpawnPending(){return this.sandboxSpawnPendingSignal()}getMoveOffsetFor(e){return this.unitMoveOffsetSignal().get(e)??null}isUnitMoving(e){return this.movingUnitsSignal().has(e)}isUnitAttacking(e){return this.attackingUnitsSignal().has(e)}getCombinedTransform(e){let t=this.attackerNudgeSignal(),i=this.getMoveOffsetFor(e),r=(t&&t.id===e?t.dx:0)+(i?i.dx:0),o=(t&&t.id===e?t.dy:0)+(i?i.dy:0);return`translate(${r}px, ${o}px)`}aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=Bn(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=Bn(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?this.isMobile()?4:6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?12:16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(r=>r.owner==="player"&&this.isForest(r.position.x,r.position.y)).length,i=this.unitsSignal().filter(r=>r.owner==="ai"&&this.isForest(r.position.x,r.position.y)).length;return{total:e,player:t,ai:i}}resetGame(){let e=this.settings.difficulty();this.stopAiLoops(),this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0,iron:0}),this.baseHealthSignal.set(this.settings.customMode()?{player:1e3,ai:1e3}:{player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:5,ai:5}):e==="normal"?this.reservePointsSignal.set({player:1,ai:1}):e==="hard"?this.reservePointsSignal.set({player:1,ai:3}):this.reservePointsSignal.set({player:1,ai:5}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"))),this.minesSignal.set(this.map.generateMines(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"),this.forestsSignal())),this.forgeSitesSignal.set([]),this.forgesSignal.set([]),this.aiForgesSignal.set([]);let t=new Set(this.forestsSignal().map(i=>`${i.x},${i.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(i=>i.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(r=>r.x===e.x&&r.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let i=!1,r=!1,o=null;this.unitsSignal.update(f=>{let m=[...f],w=m.findIndex(T=>T.id===e.id);if(w===-1)return f;let S=F({},m[w]),k={x:S.position.x,y:S.position.y},V=t.x-k.x,q=t.y-k.y,ye=Math.sign(V),ve=Math.sign(q),xe=this.combat.checkWallAlongPath(k,t,S.owner,(T,P,I,x)=>this.getWallBetween(T,P,I,x));if(xe.hitOwn)return m;if(xe.hitEnemy){let T=xe.lastFrom,P=this.getWallBetween(T.x,T.y,t.x,t.y);{let x=P.maxHealth??100,R=this.combat.getWallHitAmount(S.tier),M=Math.max(0,P.health-R);this.wallsSignal.update(be=>be.map(de=>de.id===P.id?ce(F({},de),{health:M}):de).filter(de=>(de.health??de.hitsRemaining??0)>0)),M<=0&&this.registerWallDestroyedEdge(T,t);let ae=P.owner==="neutral"?"Neutral":P.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${S.tier} Unit attacked ${ae} Wall. Damage: ${R}. Wall HP: ${M}/${x}.`)}this.updateWallFormations(),this.shakenWallIdSignal.set(P.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let I=m.findIndex(x=>x.id===S.id);return I!==-1&&(m[I]=ce(F({},m[I]),{hasActed:!0})),m}let Ae=this.getBasePosition(S.owner==="player"?"ai":"player");if(t.x===Ae.x&&t.y===Ae.y)return this.baseHealthSignal.update(T=>{let P=S.owner==="player"?"ai":"player",I=F({},T);return I[P]=Math.max(0,I[P]-this.calculatePower(S)),I}),m.splice(w,1),m;let O=m.findIndex(T=>T.position.x===t.x&&T.position.y===t.y&&T.id!==S.id);if(O!==-1){let T=m[O],P={x:t.x-ye,y:t.y-ve};if(this.inBounds(P.x,P.y)){if(ye!==0&&ve!==0){if(this.combat.isDiagonalBlocked(P,t,(I,x,R,M)=>this.getWallBetween(I,x,R,M)))return i=!1,m}else if(this.getWallBetween(P.x,P.y,t.x,t.y))return i=!1,m}if(T.owner===S.owner)if(this.shakenUnitIdSignal.set(S.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),T.tier===S.tier){let I=T.tier,x=this.calculateTotalPoints(S)+this.calculateTotalPoints(T),R={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},M=R[I][3];if(x<=M){T.points=x;let be=this.calculateTierAndLevel(T.points);T.tier=be.tier,T.level=be.level;let de=!!(T.hasWeapon||S.hasWeapon),Tt=!!(T.hasArmor||S.hasArmor),Xt=Tt?Math.max(T.armorHp??0,S.armorHp??0):0;T.hasWeapon=de,T.hasArmor=Tt,T.armorHp=Xt,m.splice(w,1)}else{let be=Math.min(4,I+1),de=R[be][0];T.points=de;let Tt=this.calculateTierAndLevel(T.points);T.tier=Tt.tier,T.level=Tt.level;let Xt=!!(T.hasWeapon||S.hasWeapon),Ne=!!(T.hasArmor||S.hasArmor),Wt=Ne?Math.max(T.armorHp??0,S.armorHp??0):0;T.hasWeapon=Xt,T.hasArmor=Ne,T.armorHp=Wt;let lt=x-de;if(lt>0){S.points=lt;let oe=this.calculateTierAndLevel(S.points);S.tier=oe.tier,S.level=oe.level,S.hasWeapon=!1,S.hasArmor=!1,S.armorHp=0,m[w]=S,o=S.id}else m.splice(w,1)}r=!0;let ae=new Map(this.mergeIntentSignal());ae.delete(S.id),ae.delete(T.id),this.mergeIntentSignal.set(ae)}else return m;else{{let oe=t.x-k.x,se=t.y-k.y,Ie=Math.abs(oe)>=Math.abs(se),Ee=Math.sign(Ie?oe:se),_e=this.wallThicknessPx+2,b=this.tileSizePx+_e,ue=Math.round(b*.35),qe=Ie?Ee*ue:0,Ke=Ie?0:Ee*ue,le=new Set(this.attackingUnitsSignal());le.add(S.id),this.attackingUnitsSignal.set(le),this.attackerNudgeSignal.set({id:S.id,dx:qe,dy:Ke}),setTimeout(()=>{this.attackerNudgeSignal.set({id:S.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let wt=new Set(this.attackingUnitsSignal());wt.delete(S.id),this.attackingUnitsSignal.set(wt)},200)}this.shakenUnitIdSignal.set(T.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let I=this.combat.calculateHitChance(S,T);if(Math.floor(Math.random()*100)+1>I)return this.queueCombatText("DEFLECTED!",t),this.log.addCombat(S.owner,`[Combat] DEFLECTED! T${S.tier} failed to penetrate T${T.tier}. Attacker destroyed.`,!1),m.splice(w,1),m;this.log.addCombat(S.owner,`[Combat] HIT! T${S.tier} breached T${T.tier} armor.`,!1);let R=this.calculateTotalPoints(S)+(S.hasWeapon?20:0),M=this.getAttackLuckModifier(S),ae=this.calculateTotalPoints(T),be=this.combat.getDefenseBonus(T,m),de=Math.max(0,R+M.delta),Tt=ae+be.bonus,Xt=S.hasWeapon?"Weapon +20":"",Ne=[...be.tags,M.tag??"",Xt].filter(Boolean).join(", ")||"None",Wt=de-Tt,lt=`[Turn ${this.turnSignal()}] ${S.owner==="player"?"Player":"AI"} T${S.tier}(L${S.level}) attacked ${T.owner==="player"?"Player":"AI"} T${T.tier}(L${T.level}). Power: ${R} vs ${ae}. Modifiers: ${Ne}. Final: (${R}${M.delta!==0?M.delta>0?`+${M.delta}`:`${M.delta}`:""}${be.bonus>0?` - ${be.bonus}`:""}) - ${ae} = ${Wt}.`;if(this.log.addCombat(S.owner,lt,!!M.isCrit),de<Tt&&this.queueCombatText("WEAK!",t),de>Tt){let oe=this.combat.calculateHitChance(T,S),Ie=Math.floor(Math.random()*100)+1<=oe,Ee=Ie?ae:0;if(Ee>0){let _e=this.combat.applyDamage(S,Ee);S.points=_e.points,S.tier=_e.tier,S.level=_e.level,S.armorHp=_e.armorHp}Ie||this.log.addCombat(S.owner,`[Combat] T${S.tier} armor deflected the counter-attack from T${T.tier}. Final HP: ${S.points}`,!1),m.splice(O,1),M.tag&&this.queueCombatText(M.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(de<Tt){let oe=de,se=this.combat.applyDamage(T,oe),Ie=F({},se);return m[O]=Ie,m.splice(w,1),m}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),m.filter(se=>se.id!==S.id&&se.id!==T.id);{let se=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),se){let Ie=this.getPointsForTierLevel(S.tier,1);S.points=Ie;let Ee=this.calculateTierAndLevel(Ie);S.tier=Ee.tier,S.level=Ee.level,m.splice(O,1),this.pulseUnitIdSignal.set(S.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let Ie=this.getPointsForTierLevel(T.tier,1),Ee=ce(F({},T),{points:Ie}),_e=this.calculateTierAndLevel(Ie);return Ee.tier=_e.tier,Ee.level=_e.level,m[O]=Ee,m.splice(w,1),this.pulseUnitIdSignal.set(Ee.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),m}}}}}if(m.find(T=>T.id===S.id)&&o!==S.id){S.position=t,S.turnsStationary=0,S.hasActed=!0;let T=m.findIndex(be=>be.id===S.id);T!==-1&&(m[T]=S),S.owner==="ai"&&S.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(S.id,{x:t.x,y:t.y}),S.tier<=2&&this.anchorGatherer(S.id));let P=new Set(this.movedThisTurnSignal());P.add(S.id),this.movedThisTurnSignal.set(P),this.lastArrivedUnitIdSignal.set(S.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let I=new Map(this.unitMoveHistorySignal()),x=I.get(S.id)??[],R={x:k.x,y:k.y},M={x:t.x,y:t.y},ae=[...x,R,M].slice(-4);I.set(S.id,ae),this.unitMoveHistorySignal.set(I)}return m});let s=t.x-e.position.x,a=t.y-e.position.y,l=this.wallThicknessPx+2,c=this.tileSizePx+l,d={dx:-s*c,dy:-a*c};if(s!==0||a!==0){let f=new Map(this.unitMoveOffsetSignal());f.set(e.id,d),this.unitMoveOffsetSignal.set(f);let m=new Set(this.movingUnitsSignal());m.add(e.id),this.movingUnitsSignal.set(m),setTimeout(()=>{let w=new Map(this.unitMoveOffsetSignal());w.set(e.id,{dx:0,dy:0}),this.unitMoveOffsetSignal.set(w),setTimeout(()=>{let S=new Map(this.unitMoveOffsetSignal());S.delete(e.id),this.unitMoveOffsetSignal.set(S);let k=new Set(this.movingUnitsSignal());k.delete(e.id),this.movingUnitsSignal.set(k)},180)},0)}if(r){let f=this.getUnitAt(t.x,t.y);f&&(this.lastMergedUnitIdSignal.set(f.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(k=>k+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let w=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(w.length>=4&&w[0].x===w[2].x&&w[0].y===w[2].y&&w[1].x===w[3].x&&w[1].y===w[3].y&&(w[0].x!==w[1].x||w[0].y!==w[1].y)){let k=new Map(this.unitStutterBanSignal()),V=new Set([`${w[0].x},${w[0].y}`,`${w[1].x},${w[1].y}`]);k.set(e.id,{tiles:V,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(k);let q={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},ve=(this.getQuadrant(e.position,q)+2)%4,xe=new Map(this.unitQuadrantBiasSignal());xe.set(e.id,{quadrant:ve,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(xe)}}let h=this.selectedUnitIdSignal();h&&!this.unitsSignal().some(f=>f.id===h)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility(),e.owner==="player"&&this.selectNextAvailableUnit()}selectNextAvailableUnit(){let t=this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((i,r)=>{let o=this.isForest(i.position.x,i.position.y)||this.isMine(i.position.x,i.position.y)?1:0,s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0;return o!==s?o-s:0}),this.selectUnit(t[0].id)}selectNextAvailableUnitTab(){let t=this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((r,o)=>{let s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0,a=this.isForest(o.position.x,o.position.y)||this.isMine(o.position.x,o.position.y)?1:0;return s!==a?s-a:r.id.localeCompare(o.id)});let i=this.selectedUnitId();if(!i)this.selectUnit(t[0].id);else{let r=t.findIndex(o=>o.id===i);if(r===-1)this.selectUnit(t[0].id);else{let o=(r+1)%t.length;this.selectUnit(t[o].id)}}}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}effectiveAttack(e){return this.calculateTotalPoints(e)+(e.hasWeapon?20:0)}effectiveDefense(e){return(e.points??0)+(e.armorHp??0)}computeSideEffectivePower(e){let t=this.unitsSignal().filter(r=>r.owner===e),i=0;for(let r of t)i+=this.effectiveAttack(r);return i}getWood(e){return e==="ai"?this.aiWoodSignal():this.resourcesSignal().wood}getIron(e){return e==="ai"?this.aiIronSignal():this.resourcesSignal().iron}getForges(e){return e==="ai"?this.aiForgesSignal():this.forgesSignal()}buyArmorGeneric(e,t){e==="ai"?this.aiBuyArmor(t):this.buyArmor(t)}buyWeaponGeneric(e,t){e==="ai"?this.aiBuyWeapon(t):this.buyWeapon(t)}isUnitInDanger(e){let t=this.getNeighbors(e.position);for(let i of t){let r=this.getUnitAt(i.x,i.y);if(r&&r.owner!==e.owner){let o=this.effectiveAttack(r),s=this.effectiveDefense(e),a=e.hasWeapon?e.tier>=3?20:10:0;if(o>s+a)return!0}}return!1}findSafeMove(e,t){let i=this.getBasePosition("ai");return t.length===0?null:t.reduce((r,o)=>{let s=Math.abs(o.x-i.x)+Math.abs(o.y-i.y),a=Math.abs(r.x-i.x)+Math.abs(r.y-i.y);return s<a?o:r},t[0])}findResourceTarget(e,t){let i=this.forestsSignal(),r=this.minesSignal(),o=this.turnSignal()<=20,s=i.filter(w=>{let S=`${w.x},${w.y}`;if(t.claimedTargets.has(S))return!1;let k=this.getUnitAt(w.x,w.y);return!(k&&k.owner==="ai")}),a=r.filter(w=>{let S=`${w.x},${w.y}`;if(t.claimedTargets.has(S))return!1;let k=this.getUnitAt(w.x,w.y);return!(k&&k.owner==="ai")}),l=s.filter(w=>!this.getUnitAt(w.x,w.y)),c=a.filter(w=>!this.getUnitAt(w.x,w.y));if(o){if(l.length>0)return l.sort((w,S)=>{let k=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),V=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return k-V}),l[0];if(c.length>0)return c.sort((w,S)=>{let k=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),V=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return k-V}),c[0]}else{let w=[...l,...c];if(w.length>0)return w.sort((S,k)=>{let V=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),q=Math.abs(k.x-e.position.x)+Math.abs(k.y-e.position.y);return V-q}),w[0]}let d=s.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&S.owner==="player"}),f=a.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&S.owner==="player"}).filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&e.tier>=S.tier}),m=d.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&e.tier>=S.tier});if(o){if(m.length>0)return m.sort((w,S)=>{let k=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),V=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return k-V}),m[0];if(f.length>0)return f.sort((w,S)=>{let k=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),V=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return k-V}),f[0]}else{let w=[...m,...f];if(w.length>0)return w.sort((S,k)=>{let V=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),q=Math.abs(k.x-e.position.x)+Math.abs(k.y-e.position.y);return V-q}),w[0]}return d.length>0?(d.sort((w,S)=>{let k=this.getUnitAt(w.x,w.y),V=this.getUnitAt(S.x,S.y),q=k?k.tier:99,ye=V?V.tier:99;if(q!==ye)return q-ye;let ve=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),xe=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return ve-xe}),d[0]):null}findDefensiveWallTarget(e){let t=this.getNeighbors(e.position),r=this.unitsSignal().filter(c=>c.owner==="player").filter(c=>Math.abs(c.position.x-e.position.x)+Math.abs(c.position.y-e.position.y)<=5);if(r.length===0)return null;let o=0,s=0;r.forEach(c=>{o+=c.position.x,s+=c.position.y}),o/=r.length,s/=r.length;let a=null,l=-1/0;for(let c of t){if(this.getWallBetween(e.position.x,e.position.y,c.x,c.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(c)||this.isEdgeOnCooldown(e.position,c))continue;let d=c.x-e.position.x,h=c.y-e.position.y,f=o-e.position.x,m=s-e.position.y,w=d*f+h*m;w>l&&(l=w,a=c)}return l>0?a:null}findBlockingWall(e,t){let i=this.bfsPath(e,t,{respectWalls:!1});if(!i||i.length<2)return null;for(let r=0;r<i.length-1;r++){let o=i[r],s=i[r+1],a=this.getWallBetween(o.x,o.y,s.x,s.y);if(a)return{pos:s,wall:a}}return null}findDefensiveWallTargetForOwner(e,t){let i=this.getNeighbors(e.position),r=t==="player"?"ai":"player",s=this.unitsSignal().filter(h=>h.owner===r).filter(h=>Math.abs(h.position.x-e.position.x)+Math.abs(h.position.y-e.position.y)<=5);if(s.length===0)return null;let a=0,l=0;s.forEach(h=>{a+=h.position.x,l+=h.position.y}),a/=s.length,l/=s.length;let c=null,d=-1/0;for(let h of i){if(this.getWallBetween(e.position.x,e.position.y,h.x,h.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(h)||this.isEdgeOnCooldown(e.position,h))continue;let f=h.x-e.position.x,m=h.y-e.position.y,w=a-e.position.x,S=l-e.position.y,k=f*w+m*S;k>d&&(d=k,c=h)}return d>0?c:null}getNextStepTowards(e,t,i,r){if(i.length===0)return null;let o=l=>{let c=Math.abs(l.x-t.x)+Math.abs(l.y-t.y);if(r?.noCohesion&&!r?.antiClump&&!r?.fogBonus)return c*10;let h=this.getNeighbors(l).filter(m=>{let w=this.getUnitAt(m.x,m.y);return w&&w.owner===e.owner}).length,f=c*10;return r?.antiClump?f+=h*3:r?.noCohesion||(f-=h*2),r?.fogBonus&&!this.isVisibleToPlayer(l.x,l.y)&&e.owner==="player"&&(f-=3),f},s=null,a=1/0;for(let l of i){let c=o(l);c<a&&(a=c,s=l)}return s}findPlayerResourceTarget(e){let t=this.turnSignal(),i=this.forestsSignal(),r=this.minesSignal(),o=this.playerClaimedTargetsSignal(),s=m=>`${m.x},${m.y}`,a=m=>!this.getUnitAt(m.x,m.y),l=m=>{let w=this.getUnitAt(m.x,m.y);return!!(w&&w.owner==="player")},c=i.filter(m=>!o.has(s(m))),d=r.filter(m=>!o.has(s(m))),h=(m,w)=>{let S=Math.abs(m.x-e.position.x)+Math.abs(m.y-e.position.y),k=l(m)?100:0,V=t<=15&&w==="forest"?-5:0;return S*10+k+(a(m)?0:20)+V},f=[...c.map(m=>({p:m,t:"forest",s:h(m,"forest")})),...d.map(m=>({p:m,t:"mine",s:h(m,"mine")}))];return f.length===0?null:(f.sort((m,w)=>m.s-w.s),f[0].p)}findCombatTarget(e,t,i){let r=t.priorityTargets.find(c=>Math.max(Math.abs(c.position.x-e.position.x),Math.abs(c.position.y-e.position.y))<=5);if(r&&!this.bfsPath(e.position,r.position,{respectWalls:!0})){let d=this.findBlockingWall(e.position,r.position);if(d)return this.appendLog(`[Obstacle Smash] T${e.tier} targeting wall at (${d.pos.x},${d.pos.y}) blocking path to high-value target`),d.pos}let o=t.priorityTargets.filter(c=>i.some(d=>d.x===c.position.x&&d.y===c.position.y));if(o.length>0){let c=o.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),c[0].position):(o.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),o[0].position)}let s=this.getNeighbors(e.position),a=[];for(let c of s){let d=this.getWallBetween(e.position.x,e.position.y,c.x,c.y);if(!d||d.owner===e.owner)continue;let h=d.maxHealth??100,f=100-(h-100);h>200&&!e.hasWeapon&&(f-=150),e.hasWeapon&&(f+=40),(d.formationSize??1)<=2&&(f+=30),a.push({pos:c,score:f})}if(a.length>0)return a.sort((c,d)=>d.score-c.score),a[0].pos;let l=i.map(c=>{let d=this.getUnitAt(c.x,c.y);return!d||d.owner===e.owner?null:{pos:c,enemy:d}}).filter(Boolean);if(l.length>0){let c=l.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d.enemy));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),c[0].pos):(l.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),l[0].pos)}return null}findFallbackMove(e,t,i){if(t.length===0)return null;let r=Math.abs(e.position.x-i.x)+Math.abs(e.position.y-i.y),o=null,s=1/0;for(let a of t){let l=Math.abs(a.x-i.x)+Math.abs(a.y-i.y);l<s&&(s=l,o=a)}if(!o)return null;if(s>r){let a=this.isUnitInDanger(e),l=!1;if(a&&(l=this.getNeighbors(e.position).some(d=>{let h=this.getUnitAt(d.x,d.y);return!h||h.owner===e.owner?!1:this.effectiveAttack(h)>this.effectiveDefense(e)})),!l)return null}return o}isTileThreatenedByEnemy(e,t){let i=this.getNeighbors(t);for(let r of i){let o=this.getUnitAt(r.x,r.y);if(o&&o.owner!==e.owner&&this.effectiveAttack(o)>=this.effectiveDefense(e))return!0}return!1}getMergePartnerForUnit(e,t){let r=this.reclamationGoalsSignal().get(e.id);if(r&&r.type==="merge"){let c=this.getUnitAt(r.target.x,r.target.y);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let s=this.mergeIntentSignal().get(e.id);if(s){let c=this.unitsSignal().find(d=>d.id===s);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let a=this.unitsSignal().find(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y)&&t.some(d=>d.x===c.position.x&&d.y===c.position.y));if(a)return a;let l=this.unitsSignal().filter(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y));for(let c of l){let d=this.getNextStepTowards(e,c.position,t);if(!d)continue;let h=this.calculateValidMoves(c),f=this.getNextStepTowards(c,e.position,h);if(!f)continue;let m=Math.abs(e.position.x-c.position.x)+Math.abs(e.position.y-c.position.y);if(Math.abs(d.x-f.x)+Math.abs(d.y-f.y)<m)return c}return null}computeHighestTierNeedingUpgrade(){let e=this.unitsSignal().filter(t=>t.owner==="ai"&&t.tier>=2&&(!t.hasArmor||!t.hasWeapon));return e.length===0?0:e.reduce((t,i)=>Math.max(t,i.tier),0)}getNeighbors(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}].filter(t=>this.inBounds(t.x,t.y))}bfsPath(e,t,i){let r=[{pos:e,path:[e]}],o=new Set;o.add(`${e.x},${e.y}`);let s=0;for(;r.length>0&&s<500;){s++;let a=r.shift();if(a.pos.x===t.x&&a.pos.y===t.y)return a.path;let l=this.getNeighbors(a.pos);for(let c of l){let d=`${c.x},${c.y}`;if(!o.has(d)){if(i?.avoidFriendlyUnits){let h=this.getUnitAt(c.x,c.y);if(h&&h.owner==="ai")continue}if(i?.respectWalls&&this.getWallBetween(a.pos.x,a.pos.y,c.x,c.y))continue;o.add(d),r.push({pos:c,path:[...a.path,c]})}}}return null}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=$([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){if(this.settings.customMode()&&this.endReasonSignal()!=="Debug Victory"&&e==="Jaerbi")return;this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let i=this.firebase.user$(),r=ce(F({},t),{playerName:this.playerName.name(),userId:i?.uid,userPhoto:i?.photoURL??void 0});this.firebase.saveHighScore(r),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}aiIron(){return this.aiIronSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;return r?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let i=this.calculateTotalPoints(t),r=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,i-r),atkMax:i+r+(t.hasWeapon?20:0),hp:t.points,support:o}}isUnitHovered(e){return this.hoveredUnitIdSignal()===e}getHitChanceInfo(e){let t=this.selectedUnit();if(!t)return null;let i=this.unitsSignal().find(l=>l.id===e);if(!i||t.owner!=="player"||i.owner===t.owner||!this.isVisibleToPlayer(i.position.x,i.position.y)||!this.validMoves().some(l=>l.x===i.position.x&&l.y===i.position.y))return null;let o=this.combat.calculateHitChance(t,i),s="bg-green-600";o<50?s="bg-red-600":o<100&&(s="bg-amber-600");let a=o<10;return{chance:o,bg:s,icon:a?"\u2620\uFE0F":"\u2694\uFE0F",skull:a}}shouldRenderWall(e,t,i){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return r?(i??r.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}hoverFormationById(e){this.hoveredFormationIdSignal.set(e??null)}isFormationHovered(e){return e?this.hoveredFormationIdSignal()===e:!1}getFormationInfo(e){let t=e??null;if(!t)return null;let i=this.wallsSignal().find(r=>r.formationId===t);return i?{size:i.formationSize??1,bonus:i.bonusHp??0}:null}updateWallFormations(){let e=this.wallsSignal();if(e.length===0)return;let t=new Map,i=new Map;for(let l of e){t.set(l.id,l);let c=`${l.tile1.x},${l.tile1.y}`,d=`${l.tile2.x},${l.tile2.y}`,h=i.get(c)??[];h.push(l.id),i.set(c,h);let f=i.get(d)??[];f.push(l.id),i.set(d,f)}let r=new Set,o=[];for(let l of e){if(r.has(l.id))continue;if(l.owner==="neutral"){o.push([l.id]),r.add(l.id);continue}let c=[l.id];r.add(l.id);let d=[],h=l.owner;for(;c.length>0;){let f=c.shift();d.push(f);let m=t.get(f),w=[`${m.tile1.x},${m.tile1.y}`,`${m.tile2.x},${m.tile2.y}`];for(let S of w){let k=i.get(S)??[];for(let V of k)r.has(V)||t.get(V).owner===h&&(r.add(V),c.push(V))}}o.push(d)}let s=e.map(l=>F({},l)),a=new Map;for(let l=0;l<s.length;l++)a.set(s[l].id,l);for(let l of o){let d=t.get(l[0]).owner==="neutral",h=d?1:l.length,f=d?0:Math.max(0,h*20),m=100+f,w=d?null:l[0];for(let S of l){let k=a.get(S),V=s[k],q=V.maxHealth??100,ye=m-q,ve=V.health;ye>0?ve=V.health+ye:ye<0&&(ve=Math.min(V.health,m)),ve=Math.max(0,Math.min(m,ve)),s[k]=ce(F({},V),{formationId:w??void 0,formationSize:h,maxHealth:m,bonusHp:f,health:ve})}}this.wallsSignal.set(s)}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(i=>i.position.x===e&&i.position.y===t).map(i=>({id:i.id,text:i.text,opacity:i.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let i=this.unitsSignal().find(d=>d.id===e);if(!i)return"";let r=this.combat.getPointsForTierLevel(i.tier,4),o=t.support>0?`+${t.support}`:"+0",s=i.hasWeapon?" | Weapon:+20":"",a=i.armorHp??0,l=i.hasArmor?` | Armor:${a}`:"",c=a>0?`${t.hp} + ${a}`:`${t.hp}`;return`Unit T${i.tier} | HP: ${c}/${r} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}${s}${l}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.endReasonSignal.set("Debug Victory"),this.endOverlaySignal.set(!0);let t=this.getForestControl().player,r={playerName:this.playerName.name(),turnsPlayed:this.turnSignal(),forestsCaptured:t,victoryType:"Annihilation",timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:!0};this.pendingScoreSignal.set(r),this.namePromptOpenSignal.set(!0)}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],i=e.indexOf(this.settings.difficulty()),r=t.indexOf(this.settings.mapSize());i++,i>=e.length&&(i=0,r++,r>=t.length&&(r=0)),this.settings.setDifficulty(e[i]),this.settings.setMapSize(t[r]),this.resetGame()}recordHighScore(e,t){if(this.settings.customMode()){this.endReasonSignal.set("Match Finished (Custom Mode)");return}let i=`${this.settings.difficulty()}|${this.settings.mapSize()}`,r=F({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=r[i]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((h,f)=>h.turns-f.turns).slice(0,3):s.losses=[...s.losses,o].sort((h,f)=>h.turns-f.turns).slice(0,3),r[i]=s,this.highScoresSignal.set(r),this.persistHighScores();let a=this.getForestControl(),l=e==="player wins"?a.player:a.ai,c=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:l,victoryType:c,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"&&(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0))}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let i=crypto.randomUUID(),r={id:i,text:e,position:F({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),r]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===i?ce(F({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==i))},2e3)}calculateValidMoves(e){let t=[],i=e.position,r=c=>c.x>=0&&c.x<this.gridSize&&c.y>=0&&c.y<this.gridSize,o=(c,d)=>{if(!r(d))return"blocked";if(c.x===d.x||c.y===d.y){if(this.getWallBetween(c.x,c.y,d.x,d.y))return"blocked"}else if(this.isDiagonalBlocked(c,d))return"blocked";let h=this.getUnitAt(d.x,d.y);return h?h.owner===e.owner?"ally":"enemy":"empty"},s=(c,d)=>{(d==="empty"||d==="enemy"||this.getUnitAt(c.x,c.y)?.tier===e.tier)&&t.push(c)},a=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],l=[{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}];if(e.tier===1){for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);h!=="blocked"&&s(d,h)}return t}for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===3&&h==="empty"){let f={x:i.x+c.x*2,y:i.y+c.y*2},m=o(d,f);m!=="blocked"&&s(f,m)}}for(let c of l){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===4&&h==="empty"){let f={x:i.x+c.x*2,y:i.y+c.y*2},m=o(d,f);if(m!=="blocked"&&(s(f,m),m==="empty")){let w={x:i.x+c.x*3,y:i.y+c.y*3},S=o(f,w);S!=="blocked"&&s(w,S)}}}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),l=this.isForest(s.position.x,s.position.y),c=this.isMine(s.position.x,s.position.y),d=l?a?1:(s.forestOccupationTurns??0)+1:0,h=c?a?1:(s.mineOccupationTurns??0)+1:0,f=l?d>=3:!1;return ce(F({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:d,mineOccupationTurns:h,productionActive:f})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let i=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(a=>a.owner===e&&this.isForest(a.position.x,a.position.y)&&(a.productionActive??!1)).length,s=this.unitsSignal().filter(a=>a.owner===e&&this.isMine(a.position.x,a.position.y)&&(a.mineOccupationTurns??0)>=5).length;if(o>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood+o*i(this.settings.difficulty()),iron:a.iron})):this.aiWoodSignal.update(a=>a+o*i(this.settings.difficulty()))),s>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood,iron:a.iron+s*2})):this.aiIronSignal.update(a=>a+s*2)),e==="player"){let a=this.forgeSitesSignal().map(h=>F({},h));for(let h of a)h.turnsLeft=Math.max(0,h.turnsLeft-1);let l=a.filter(h=>h.turnsLeft===0),c=l.map(h=>h.position),d=a.filter(h=>h.turnsLeft>0);if(c.length>0){this.forgesSignal.update(f=>[...f,...c]);let h=l.filter(f=>f.owner==="ai").map(f=>f.position);if(h.length>0){this.aiForgesSignal.update(f=>[...f,...h]);for(let f of h)this.appendLog(`[AI] Forge completed at (${f.x},${f.y}).`)}}this.forgeSitesSignal.set(d)}}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let r=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(r),this.startSideTurn(r),r==="ai"&&this.gameStatus()==="playing"&&(this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10))}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}pauseGame(){this.stopAiLoops()}aiTurnTimeout=null;stopAiLoops(){this.aiTurnTimeout&&(clearTimeout(this.aiTurnTimeout),this.aiTurnTimeout=null),this.isAiThinking=!1}startSideTurn(e){this.unitsSignal.update(t=>t.map(i=>i.owner===e?ce(F({},i),{hasActed:!1}):i)),e==="player"&&(this.selectNextAvailableUnit(),this.playerClaimedTargetsSignal.set(new Set))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;if(r){let s=F({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=F({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai"),t=this.forestsSignal().length+this.minesSignal().length,i=this.unitsSignal().filter(I=>I.owner==="player"&&(this.isForest(I.position.x,I.position.y)||this.isMine(I.position.x,I.position.y))),r=t>0?i.length/t:0;if(r>.5){let I=new Map,x=this.unitsSignal().filter(ae=>ae.owner==="ai"&&!ae.hasActed),R=new Set,M=i.slice().sort((ae,be)=>be.tier-ae.tier);for(let ae of M){let be=Math.min(4,ae.tier+1),de=x.filter(Ne=>Ne.tier===be&&!R.has(Ne.id)).sort((Ne,Wt)=>{let lt=Math.max(Math.abs(Ne.position.x-ae.position.x),Math.abs(Ne.position.y-ae.position.y)),oe=Math.max(Math.abs(Wt.position.x-ae.position.x),Math.abs(Wt.position.y-ae.position.y));return lt-oe});if(de.length>0){let Ne=de[0];I.set(Ne.id,{target:F({},ae.position),type:"hunt"}),R.add(Ne.id);continue}let Tt=x.filter(Ne=>Ne.tier===ae.tier&&!R.has(Ne.id)),Xt=!1;for(let Ne of Tt){let Wt=this.calculateValidMoves(Ne),lt=this.unitsSignal().find(oe=>oe.owner==="ai"&&oe.tier===Ne.tier&&(oe.position.x!==Ne.position.x||oe.position.y!==Ne.position.y)&&Wt.some(se=>se.x===oe.position.x&&se.y===oe.position.y));if(lt){I.set(Ne.id,{target:F({},lt.position),type:"merge"}),R.add(Ne.id),Xt=!0;break}}Xt||this.aiSpawnTier(be,1,new Set)}this.reclamationGoalsSignal.set(I),this.appendLog(`[AI Mode] Reclamation active. Player controls ${(r*100).toFixed(0)}% of resources.`)}else this.reclamationGoalsSignal.set(new Map);let a=this.unitsSignal().filter(I=>I.owner==="ai"&&this.isForest(I.position.x,I.position.y)).length>3;{let I=0,x=50,M=this.baseHealthSignal().ai<50?20:70;for(;this.aiWoodSignal()>M;){if(I++,I>x){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let I=this.forestsSignal().length,x=this.unitsSignal().filter(lt=>lt.owner==="ai"&&this.isForest(lt.position.x,lt.position.y)).length,R=this.unitsSignal().filter(lt=>lt.owner==="player"&&this.isForest(lt.position.x,lt.position.y)).length,M=this.settings.difficulty(),ae=I>0?R/I:0,be="none";R<=x?be="none":ae>=.9||R>=9?be="rage":R>=x+(M==="baby"?4:M==="normal"?3:M==="hard"?2:1)?be="angry":be="none",this.aiMoodSignal.set(be);let de=this.turnSignal()%2===0,Tt=this.turnSignal()%5===0,Xt=I>0?x/I:0,Ne=this.totalWarModeSignal(),Wt=Xt>=.65;if(!Ne&&Wt)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(Wt),be==="rage"){let lt=M==="baby"?de?1:2:M==="normal"?de?3:2:M==="hard"?de?4:3:4;this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+lt}))}else if(be==="angry"){if(M==="baby")Tt&&this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+1}));else if(de){let lt=M==="normal"?de?1:0:M==="hard"?Tt?2:1:2;this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+lt}))}}}catch{}if(this.manageInfrastructure(),this.turnSignal()<=10){let I=0,x=this.getPointsForTierLevel(1,1);for(;this.reservePointsSignal().ai>=x&&I<2&&this.aiSpawnTier(1,1,new Set)!==0;)I++,await new Promise(M=>setTimeout(M,60))}await new Promise(I=>setTimeout(I,100));let l=this.unitsSignal().filter(I=>I.owner==="ai"),c=new Map(this.aiUnitTimeNearBaseSignal()),d=new Set(l.map(I=>I.id));for(let I of c.keys())d.has(I)||c.delete(I);for(let I of l)Math.max(Math.abs(I.position.x-e.x),Math.abs(I.position.y-e.y))<=3?c.set(I.id,(c.get(I.id)||0)+1):c.set(I.id,0);this.aiUnitTimeNearBaseSignal.set(c);for(let I of l){let x=this.isForest(I.position.x,I.position.y);I.owner==="ai"&&x&&I.tier<=2&&this.anchorGatherer(I.id)}let h=this.unitsSignal().filter(I=>I.owner==="player"&&this.isForest(I.position.x,I.position.y)&&(I.productionActive??!1)).length*2,f=this.unitsSignal().filter(I=>I.owner==="ai"&&this.isForest(I.position.x,I.position.y)&&(I.productionActive??!1)).length*2,m=h>=f;this.aggressionModeSignal.set(m);let k=this.forestsSignal().filter(I=>!this.getUnitAt(I.x,I.y)).filter(I=>this.isVisibleToAi(I.x,I.y)),V=this.unitsSignal().filter(I=>I.owner==="ai");if(this.turnSignal()<=15){let I=this.aiQueuedUnitIdSignal(),x=I?V.find(M=>M.id===I):null;if(!(x&&!this.isForest(x.position.x,x.position.y)&&k.length>0)){let M=V.filter(be=>be.tier<=2&&!this.isForest(be.position.x,be.position.y)),ae=M.length>0&&k.length>0?M.reduce((be,de)=>{let Tt=Math.min(...k.map(Ne=>Math.abs(de.position.x-Ne.x)+Math.abs(de.position.y-Ne.y))),Xt=Math.min(...k.map(Ne=>Math.abs(be.position.x-Ne.x)+Math.abs(be.position.y-Ne.y)));return Tt<Xt?de:be},M[0]):null;this.aiQueuedUnitIdSignal.set(ae?ae.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let I=this.getPointsForTierLevel(3,1),x=this.forestsSignal().length,R=this.unitsSignal().filter(be=>be.owner==="ai"&&this.isForest(be.position.x,be.position.y)).length,M=x>0?R/x:0;this.reservePointsSignal().ai>=I&&M<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let q=this.unitsSignal().filter(I=>I.owner==="player"&&Math.max(Math.abs(I.position.x-e.x),Math.abs(I.position.y-e.y))<=3&&I.tier>=2);if(q.length>0){let I=q.reduce((x,R)=>this.calculateTotalPoints(R)>this.calculateTotalPoints(x)?R:x,q[0]);this.aiDefenseSpawn(I)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let I=this.aiStrategy.getWallBuildActions(this);for(let x of I){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(x.from,x.to)}}else this.tryDefensiveWallsNearForests();let ye=0,ve=10;for(;ye<ve&&this.executeOneFreeAction();)ye++,await new Promise(x=>setTimeout(x,100));this.aiQueuedUnitIdSignal.set(null);let xe=this.getBasePosition("player"),Ae=this.unitsSignal().filter(I=>I.owner==="player"&&(this.isForest(I.position.x,I.position.y)||this.isMine(I.position.x,I.position.y)||this.isForge(I.position.x,I.position.y)||Math.max(Math.abs(I.position.x-e.x),Math.abs(I.position.y-e.y))<=4)),O={claimedTargets:new Set,priorityTargets:Ae},P=this.unitsSignal().filter(I=>I.owner==="ai"&&!I.hasActed).sort((I,x)=>x.tier-I.tier);for(let I of P){let x=this.unitsSignal().find(oe=>oe.id===I.id);if(!x||x.hasActed)continue;let R=null,ae=this.calculateValidMoves(x).filter(oe=>!O.claimedTargets.has(`${oe.x},${oe.y}`)),be=Math.max(Math.abs(x.position.x-e.x),Math.abs(x.position.y-e.y)),de=this.unitsSignal().filter(oe=>oe.owner==="player"&&Math.max(Math.abs(oe.position.x-e.x),Math.abs(oe.position.y-e.y))<=3);if(de.length>0&&!this.isForest(x.position.x,x.position.y)&&be<=6){let oe=de.reduce((Ie,Ee)=>{let _e=Math.max(Math.abs(Ie.position.x-e.x),Math.abs(Ie.position.y-e.y));return Math.max(Math.abs(Ee.position.x-e.x),Math.abs(Ee.position.y-e.y))<_e?Ee:Ie});if(ae.some(Ie=>Ie.x===oe.position.x&&Ie.y===oe.position.y))R={type:"attack",target:oe.position,reason:"Base Defense: Eliminate Threat"};else{let Ie=this.getNextStepTowards(x,oe.position,ae);Ie&&(R={type:"move",target:Ie,reason:"Base Defense: Intercept"})}}if(!R){let oe=this.reclamationGoalsSignal().get(x.id);if(oe){let se=oe.target,Ie=this.getUnitAt(se.x,se.y);if(Ie&&Ie.owner!==x.owner)if(ae.some(_e=>_e.x===se.x&&_e.y===se.y))R={type:"attack",target:se,reason:"Reclaim: Attack Occupier"};else{let _e=this.bfsPath(x.position,se,{respectWalls:!0,avoidFriendlyUnits:!0});if(_e||(_e=this.bfsPath(x.position,se,{avoidFriendlyUnits:!0})),_e&&_e.length>1){let b=_e[1],ue=this.getWallBetween(x.position.x,x.position.y,b.x,b.y),qe=this.getUnitAt(b.x,b.y);if(qe&&qe.owner!==x.owner){let Ke=this.effectiveAttack(qe)>this.effectiveDefense(x),le=ae.some(wt=>wt.x===b.x&&wt.y===b.y);if(Ke&&le)R={type:"attack",target:b,reason:"Reclaim: Engage Blocker"};else if(ue)R={type:"wall_attack",target:b,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(x,b)){let wt=ae.filter(li=>{let Ps=Math.abs(li.x-se.x)+Math.abs(li.y-se.y),_h=Math.abs(b.x-se.x)+Math.abs(b.y-se.y);return Ps<=_h&&!this.isTileThreatenedByEnemy(x,li)}),Ci=wt.length>0?this.getNextStepTowards(x,se,wt):null;R=Ci?{type:"move",target:Ci,reason:"Reclaim: Bypass Threat"}:{type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else if(ue)R={type:"wall_attack",target:b,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(x,b)){let Ke=ae.filter(wt=>{let Ci=Math.abs(wt.x-se.x)+Math.abs(wt.y-se.y),li=Math.abs(b.x-se.x)+Math.abs(b.y-se.y);return Ci<=li&&!this.isTileThreatenedByEnemy(x,wt)}),le=Ke.length>0?this.getNextStepTowards(x,se,Ke):null;R=le?{type:"move",target:le,reason:"Reclaim: Bypass Threat"}:{type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:b,reason:"Reclaim: Pursue Resource"}}}else if(oe.type==="merge")if(ae.some(_e=>_e.x===se.x&&_e.y===se.y))R={type:"move",target:se,reason:"Reclaim: Merge to Counter"};else{let _e=this.getNextStepTowards(x,se,ae);_e&&(R=this.getWallBetween(x.position.x,x.position.y,_e.x,_e.y)?{type:"wall_attack",target:_e,reason:"Reclaim: Breach to Merge"}:{type:"move",target:_e,reason:"Reclaim: Approach Ally"})}else{let Ee=this.getNextStepTowards(x,se,ae);if(Ee){let _e=this.getWallBetween(x.position.x,x.position.y,Ee.x,Ee.y),b=this.getUnitAt(Ee.x,Ee.y);if(b&&b.owner!==x.owner){let ue=this.effectiveAttack(b)>this.effectiveDefense(x),qe=ae.some(Ke=>Ke.x===Ee.x&&Ke.y===Ee.y);if(ue&&qe)R={type:"attack",target:Ee,reason:"Reclaim: Engage Blocker"};else if(_e)R={type:"wall_attack",target:Ee,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(x,Ee)){let Ke=ae.filter(wt=>{let Ci=Math.abs(wt.x-se.x)+Math.abs(wt.y-se.y),li=Math.abs(Ee.x-se.x)+Math.abs(Ee.y-se.y);return Ci<=li&&!this.isTileThreatenedByEnemy(x,wt)}),le=Ke.length>0?this.getNextStepTowards(x,se,Ke):null;R=le?{type:"move",target:le,reason:"Reclaim: Bypass Threat"}:{type:"move",target:Ee,reason:"Reclaim: Close Distance"}}else R={type:"move",target:Ee,reason:"Reclaim: Close Distance"}}else if(_e)R={type:"wall_attack",target:Ee,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(x,Ee)){let ue=ae.filter(Ke=>{let le=Math.abs(Ke.x-se.x)+Math.abs(Ke.y-se.y),wt=Math.abs(Ee.x-se.x)+Math.abs(Ee.y-se.y);return le<=wt&&!this.isTileThreatenedByEnemy(x,Ke)}),qe=ue.length>0?this.getNextStepTowards(x,se,ue):null;R=qe?{type:"move",target:qe,reason:"Reclaim: Bypass Threat"}:{type:"move",target:Ee,reason:"Reclaim: Close Distance"}}else R={type:"move",target:Ee,reason:"Reclaim: Close Distance"}}}}}if(this.isForest(x.position.x,x.position.y)){let oe=this.calculateValidMoves(x),se=this.findCombatTarget(x,O,oe);if(se)R={type:"attack",target:se,reason:"Defense: Defend Forest"};else{if(this.aiWoodSignal()>=50){let Ie=this.findDefensiveWallTarget(x);Ie&&(R={type:"build_wall",target:Ie,reason:"Defense: Fortify Position"})}if(!R&&!this.isUnitInDanger(x)){this.unitsSignal.update(Ee=>Ee.map(_e=>_e.id===x.id?ce(F({},_e),{hasActed:!0}):_e));continue}}}if(!R&&this.isMine(x.position.x,x.position.y)){let oe=this.calculateValidMoves(x),se=this.findCombatTarget(x,O,oe);if(se)R={type:"attack",target:se,reason:"Defense: Defend Mine"};else if(!this.isUnitInDanger(x)){this.unitsSignal.update(Ee=>Ee.map(_e=>_e.id===x.id?ce(F({},_e),{hasActed:!0}):_e));continue}}let Tt=this.forestsSignal().length,Xt=this.unitsSignal().filter(oe=>oe.owner==="ai"&&this.isForest(oe.position.x,oe.position.y)).length,Ne=Tt>0?Xt/Tt:0,Wt=x.tier>=3||Ne>=.7,lt=Math.max(Math.abs(x.position.x-xe.x),Math.abs(x.position.y-xe.y));if(!R&&lt<4){if(Wt&&lt<=3){let oe=[];ae.some(ue=>ue.x===xe.x&&ue.y===xe.y)&&oe.push({type:"attack",target:xe,weight:1,reason:"Siege: Strike Base"});let Ie=this.getNeighbors(x.position),Ee=lt,_e=!1;for(let ue of Ie)this.getWallBetween(x.position.x,x.position.y,ue.x,ue.y)&&Math.max(Math.abs(ue.x-xe.x),Math.abs(ue.y-xe.y))<Ee&&(oe.push({type:"wall_attack",target:ue,weight:.9,reason:"Siege: Breach (Path to Base)"}),_e=!0);let b=this.getNextStepTowards(x,xe,ae,{noCohesion:!0});if(b){let ue=Math.max(Math.abs(b.x-xe.x),Math.abs(b.y-xe.y));(!_e||ue<Ee)&&oe.push({type:"move",target:b,weight:.5,reason:"Siege: Advance on Base"})}if(oe.length>0){oe.sort((qe,Ke)=>Ke.weight-qe.weight);let ue=oe[0];R={type:ue.type,target:ue.target,reason:ue.reason},ue.type==="move"&&_e&&this.appendLog(`[AI Debug] Unit at (${x.position.x},${x.position.y}) chose Move over Wall Attack. Weights: wall=0.9, move=${ue.weight}`)}}if(!R)if(ae.some(se=>se.x===xe.x&&se.y===xe.y))R={type:"attack",target:xe,reason:"Siege: Strike Base"};else{let se=this.getNextStepTowards(x,xe,ae,{noCohesion:!0});if(se)this.getWallBetween(x.position.x,x.position.y,se.x,se.y)?R={type:"wall_attack",target:se,reason:"Siege: Breach"}:R={type:"move",target:se,reason:"Siege: Advance on Base"};else{let Ie=this.bfsPath(x.position,xe);if(Ie&&Ie.length>1){let Ee=Ie[1];this.getWallBetween(x.position.x,x.position.y,Ee.x,Ee.y)&&(R={type:"wall_attack",target:Ee,reason:"Siege: Breaching"})}}}}if(!R){let oe=this.aiForgesSignal(),se=this.unitsSignal().filter(Ee=>Ee.owner==="player"),Ie=[];for(let Ee of oe)for(let _e of se)Math.max(Math.abs(_e.position.x-Ee.x),Math.abs(_e.position.y-Ee.y))<=3&&Ie.push(_e);if(Ie.length>0){let Ee=Ie.reduce((b,ue)=>{let qe=Math.abs(b.position.x-x.position.x)+Math.abs(b.position.y-x.position.y);return Math.abs(ue.position.x-x.position.x)+Math.abs(ue.position.y-x.position.y)<qe?ue:b});if(ae.some(b=>b.x===Ee.position.x&&b.y===Ee.position.y))R={type:"attack",target:Ee.position,reason:"Defense: Guard Forge"};else{let b=this.getNextStepTowards(x,Ee.position,ae);b&&(R=this.getWallBetween(x.position.x,x.position.y,b.x,b.y)?{type:"wall_attack",target:b,reason:"Defense: Breach to Forge"}:{type:"move",target:b,reason:"Defense: Approach Forge Threat"})}}}if(!R&&x.tier>=2&&(!x.hasArmor||!x.hasWeapon)){let oe=this.seekUpgrades(x,ae);oe.type==="move"&&oe.target&&(R={type:"move",target:oe.target,reason:"Upgrade: Move to Forge"})}if(!R){let oe=this.isUnitInDanger(x),se=this.reclamationGoalsSignal().has(x.id);if(!se&&oe){let Ie=this.findSafeMove(x,ae);Ie&&(R={type:"move",target:Ie,reason:"Survival: Evade Threat"})}else if(se&&oe&&this.getNeighbors(x.position).some(_e=>{let b=this.getUnitAt(_e.x,_e.y);return!b||b.owner===x.owner?!1:this.effectiveAttack(b)>this.effectiveDefense(x)+(x.tier>=3?10:0)})){let _e=this.findSafeMove(x,ae);_e&&(R={type:"move",target:_e,reason:"Survival: Lethal Evade"})}}if(!R&&x.tier===4){let oe=this.unitsSignal().filter(se=>se.owner==="player");if(oe.length>0){let se=this.getBasePosition("player"),Ie=oe.map(_e=>({u:_e,baseDist:Math.max(Math.abs(_e.position.x-se.x),Math.abs(_e.position.y-se.y))})).sort((_e,b)=>_e.u.tier!==b.u.tier?_e.u.tier-b.u.tier:_e.baseDist-b.baseDist)[0].u,Ee=this.getNextStepTowards(x,Ie.position,ae);Ee&&(R={type:"move",target:Ee,reason:"T4 Raid: Flank Backline"})}}if(!R){let oe=this.computeSideEffectivePower("ai"),se=this.computeSideEffectivePower("player");if(se>0&&oe>se*1.2&&!this.isForest(x.position.x,x.position.y)&&parseInt(x.id.slice(-1),16)%2===0){let _e=this.unitsSignal().filter(qe=>qe.owner==="player"),b=xe;if(_e.length>0&&(b=_e.reduce((Ke,le)=>{let wt=Math.max(Math.abs(Ke.position.x-x.position.x),Math.abs(Ke.position.y-x.position.y));return Math.max(Math.abs(le.position.x-x.position.x),Math.abs(le.position.y-x.position.y))<wt?le:Ke}).position),Math.max(Math.abs(b.x-x.position.x),Math.abs(b.y-x.position.y))<=1){let qe=this.findCombatTarget(x,O,ae);qe&&(R={type:"attack",target:qe,reason:"Siege: Engage Enemy"})}else{let qe=this.getNextStepTowards(x,b,ae,{noCohesion:!0});if(qe)R={type:"move",target:qe,reason:"Siege: Advance"};else{let Ke=this.bfsPath(x.position,b);if(Ke&&Ke.length>1){let le=Ke[1];this.getWallBetween(x.position.x,x.position.y,le.x,le.y)&&(R={type:"wall_attack",target:le,reason:"Siege: Breaching"})}}}}if(!R){let _e=this.findResourceTarget(x,O);if(_e){let b=this.bfsPath(x.position,_e,{respectWalls:!0,avoidFriendlyUnits:!0});if(b||(b=this.bfsPath(x.position,_e,{avoidFriendlyUnits:!0})),b&&b.length>1){let ue=b[1],qe=this.getWallBetween(x.position.x,x.position.y,ue.x,ue.y);qe?qe.owner==="ai"&&this.isBaseProtectionEdge(x.position,ue)||(R={type:"wall_attack",target:ue,reason:"Objective: Breaching Wall"}):ae.some(Ke=>Ke.x===ue.x&&Ke.y===ue.y)&&(R={type:"move",target:ue,reason:"Objective: Capture Resource"})}}}}if(!R){let oe=this.findCombatTarget(x,O,ae);oe&&(R={type:"attack",target:oe,reason:"Combat: Engage Enemy"})}if(!R&&this.aiWoodSignal()>=10&&this.getNeighbors(x.position).some(Ie=>this.isForest(Ie.x,Ie.y)&&this.getUnitAt(Ie.x,Ie.y)?.owner==="ai")){let Ie=this.findDefensiveWallTarget(x);Ie&&(R={type:"build_wall",target:Ie,reason:"Defense: Fortify Perimeter"})}if(!R){let oe=xe,se=this.findFallbackMove(x,ae,oe);se&&(R={type:"move",target:se,reason:"Fallback: Advance on Enemy"})}if(R){if(this.appendLog(`[AI Unit ${x.id.substring(0,4)}] Action: ${R.reason} -> Target: (${R.target.x},${R.target.y})`),R.type==="build_wall")this.aiBuildWallBetween(x.position,R.target);else{if(R.type==="move"){let oe=this.getUnitAt(R.target.x,R.target.y);if(oe&&oe.owner==="ai"&&oe.tier===x.tier){let se=new Map(this.mergeIntentSignal());se.set(x.id,oe.id),se.set(oe.id,x.id),this.mergeIntentSignal.set(se)}}this.executeMove(x,R.target)}O.claimedTargets.add(`${R.target.x},${R.target.y}`)}else this.appendLog(`[AI Unit ${x.id.substring(0,4)}] No valid moves. Passing.`),this.unitsSignal.update(oe=>oe.map(se=>se.id===x.id?ce(F({},se),{hasActed:!0}):se));await new Promise(oe=>setTimeout(oe,60))}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(s=>s.owner==="player"&&Math.max(Math.abs(s.position.x-e.x),Math.abs(s.position.y-e.y))<=3&&s.tier>=2);if(t.length>0){let s=t.reduce((l,c)=>this.calculateTotalPoints(c)>this.calculateTotalPoints(l)?c:l,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(s))return!0}let i=this.unitsSignal().filter(s=>s.owner==="ai").length;if(i<6){let s=this.reservePointsSignal().ai,a=this.getPointsForTierLevel(2,1);if(s>=a&&this.aiSpawnTier(2,1,new Set)>0)return!0}let o=this.baseHealthSignal().ai<50?20:70;if(this.aiWoodSignal()>=o)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;{let s=this.reservePointsSignal().ai,a=this.unitsSignal().filter(l=>l.owner==="ai"&&this.isForest(l.position.x,l.position.y)).length;if(s>25&&a>5&&this.aiSpawnTier(3,1,new Set,!0)>0)return!0}if(t.length===0)try{let s=this.getPointsForTierLevel(3,1),a=this.forestsSignal().length,l=this.unitsSignal().filter(h=>h.owner==="ai"&&this.isForest(h.position.x,h.position.y)).length,c=a>0?l/a:0,d=this.reservePointsSignal().ai;if(i>=6&&d>=s&&c<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),i=[],r=e.position.x,o=e.position.y,s=Math.sign(t.x-r),a=Math.sign(t.y-o);{let f=0,m=Math.max(10,this.gridSize*2);for(;r!==t.x||o!==t.y;){if(f++,f>m){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(r+=s,o+=a,!this.inBounds(r,o)||r===t.x&&o===t.y)break;i.push({x:r,y:o})}}let l=i.reverse().find(f=>!this.getUnitAt(f.x,f.y))||(()=>{for(let f=-1;f<=1;f++)for(let m=-1;m<=1;m++){if(f===0&&m===0)continue;let w=t.x+f,S=t.y+m;if(this.inBounds(w,S)&&!this.getUnitAt(w,S))return{x:w,y:S}}return null})();if(!l)return!1;{let f=0,m=50;for(;this.aiWoodSignal()>=20;){if(f++,f>m){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let c=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(c);if(d<=0)return!1;let h=this.calculateTierAndLevel(d);return this.unitsSignal().filter(m=>m.owner==="ai"&&m.tier===h.tier&&!this.isForest(m.position.x,m.position.y)).length>=5?!1:(this.unitsSignal.update(f=>[...f,{id:crypto.randomUUID(),position:F({},l),level:h.level,tier:h.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1}]),this.reservePointsSignal.update(f=>({player:f.player,ai:f.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,i,r=!1){let o=this.getBasePosition("ai"),s=[],a=2;for(let k=-a;k<=a;k++)for(let V=-a;V<=a;V++){if(k===0&&V===0)continue;let q=o.x+k,ye=o.y+V;if(!this.inBounds(q,ye)||Math.max(Math.abs(k),Math.abs(V))>a)continue;let ve=`${q},${ye}`;i.has(ve)||this.getUnitAt(q,ye)||s.push({x:q,y:ye})}let l=this.aiForgesSignal(),c=this.aiIronSignal()<40;c&&l.length>0&&s.sort((k,V)=>{let q=l.reduce((ve,xe)=>Math.min(ve,Math.max(Math.abs(k.x-xe.x),Math.abs(k.y-xe.y))),1/0);return l.reduce((ve,xe)=>Math.min(ve,Math.max(Math.abs(V.x-xe.x),Math.abs(V.y-xe.y))),1/0)-q});let d=this.reservePointsSignal().ai,h=this.getPointsForTierLevel(e,1),f=0,m=[],w=k=>this.unitsSignal().filter(V=>V.owner==="ai"&&V.tier===k&&!this.isForest(V.position.x,V.position.y)).length;if(w(e)>=5&&!(r&&e===3))return 0;for(let k of s){if(f>=t||d<h||w(e)>=5)break;let V=this.calculateTierAndLevel(h);m.push({id:crypto.randomUUID(),position:F({},k),level:V.level,tier:V.tier,points:h,owner:"ai",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}),d-=h,f++}if(m.length>0){this.unitsSignal.update(q=>[...q,...m]),this.reservePointsSignal.update(q=>({player:q.player,ai:d})),this.recomputeVisibility();let k=new Map(this.ignoreForgeUntilTurnSignal()),V=this.turnSignal()+(c?2:1);for(let q of m)k.set(q.id,V);this.ignoreForgeUntilTurnSignal.set(k)}return f}aiConvertWoodToReserve(){let e=this.aiWoodSignal(),i=this.baseHealthSignal().ai<50?20:70;e<i||(this.aiWoodSignal.update(r=>r-20),this.reservePointsSignal.update(r=>({player:r.player,ai:r.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(i=>{if(i.some(s=>s.position.x===t.x&&s.position.y===t.y))return i;let o={id:crypto.randomUUID(),position:F({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};return[...i,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),i=2,r=[];for(let c=-i;c<=i;c++)for(let d=-i;d<=i;d++){let h=t.x+c,f=t.y+d;this.inBounds(h,f)&&(c===0&&d===0||Math.max(Math.abs(c),Math.abs(d))>i||r.push({x:h,y:f}))}let o=this.settings.difficulty(),s;o==="baby"?s=[{tier:4,level:1},{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}]:s=[{tier:1,level:1},{tier:1,level:1}];let a=[],l=(c,d)=>this.unitsSignal().some(h=>h.position.x===c&&h.position.y===d)||a.some(h=>h.position.x===c&&h.position.y===d);for(let c of s){let d=r.filter(w=>!l(w.x,w.y));if(d.length===0)break;let h=Math.floor(Math.random()*d.length),f=d[h],m=this.getPointsForTierLevel(c.tier,c.level);a.push({id:crypto.randomUUID(),position:F({},f),level:c.level,tier:c.tier,points:m,owner:e,turnsStationary:0,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0})}a.length>0&&this.unitsSignal.update(c=>[...c,...a])}getUnitAt(e,t){return this.unitsSignal().find(i=>i.position.x===e&&i.position.y===t)}getWallBetween(e,t,i,r){let o={x:e,y:t},s={x:i,y:r};if(!this.areAdjacent(o,s))return;let[a,l]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(c=>c.tile1.x===a.x&&c.tile1.y===a.y&&c.tile2.x===l.x&&c.tile2.y===l.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(i,r,o,s)=>this.getWallBetween(i,r,o,s))}isValidMove(e,t){return this.validMoves().some(i=>i.x===e&&i.y===t)}isForest(e,t){return this.forestsSignal().some(i=>i.x===e&&i.y===t)}isMine(e,t){return this.minesSignal().some(i=>i.x===e&&i.y===t)}isForgeSite(e,t){return this.forgeSitesSignal().some(i=>i.position.x===e&&i.position.y===t)}isForge(e,t){return this.forgesSignal().some(i=>i.x===e&&i.y===t)}getForgeProgress(e,t){let i=this.forgeSitesSignal().find(o=>o.position.x===e&&o.position.y===t);if(!i)return 0;let r=5;return Math.round((r-i.turnsLeft)/r*100)}canBuildForgeAt(e,t){let i=this.getBasePosition("player");if(Math.max(Math.abs(e-i.x),Math.abs(t-i.y))>2||!this.inBounds(e,t)||e===i.x&&t===i.y||this.getUnitAt(e,t)||this.isForest(e,t)||this.isMine(e,t)||this.isForgeSite(e,t)||this.isForge(e,t))return!1;let o=this.resourcesSignal();return o.wood>=40&&o.iron>=20&&this.isPlayerTurn()}buildForgeAt(e){this.canBuildForgeAt(e.x,e.y)&&(this.resourcesSignal.update(t=>({wood:t.wood-40,iron:t.iron-20})),this.forgeSitesSignal.update(t=>[...t,{position:F({},e),owner:"player",turnsLeft:5}]))}buyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy weapon without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasWeapon:!0}):s)))}buyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy armor without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[Forge] Player unit equipped Armor (+20 Shield HP)."))}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}aiBuyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy armor without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[AI] AI unit equipped Heavy Armor (+20 Shield HP)."))}aiBuyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy weapon without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasWeapon:!0}):s)),this.appendLog("[AI] AI unit forged a Weapon (+20 ATK, +10 hit vs higher tier)."))}manageInfrastructure(){let e=this.aiForgesSignal().length+this.forgeSitesSignal().filter(c=>c.owner==="ai").length;if(e>=2)return;let t=this.aiWoodSignal(),i=this.aiIronSignal(),r=this.aiIronSignal();if(e===0){if(t<40||i<20)return}else if(e<2&&(r<=50||t<40||i<20))return;let o=this.getBasePosition("ai"),s=[];for(let c=-2;c<=2;c++)for(let d=-2;d<=2;d++){let h=o.x+c,f=o.y+d;this.inBounds(h,f)&&(h===o.x&&f===o.y||Math.max(Math.abs(c),Math.abs(d))>2||this.getUnitAt(h,f)||this.isForest(h,f)||this.isMine(h,f)||this.isForgeSite(h,f)||this.isForge(h,f)||s.push({x:h,y:f}))}if(s.length===0)return;let a=Math.floor(Math.random()*s.length),l=s[a];this.aiWoodSignal.update(c=>c-40),this.aiIronSignal.update(c=>c-20),this.forgeSitesSignal.update(c=>[...c,{position:F({},l),owner:"ai",turnsLeft:5}]),this.appendLog(`[AI] Constructing a Forge at (${l.x},${l.y}).`)}seekUpgrades(e,t){if(e.owner!=="ai")return{type:"none"};if(e.tier<2)return{type:"none"};if(e.hasArmor&&e.hasWeapon||this.aiIronSignal()<20)return{type:"none"};let i=this.aiForgesSignal();if(i.length===0)return{type:"none"};let r=this.getMergePartnerForUnit(e,t),o=this.aiIronSignal(),s=o>=100;if(s)this.appendLog(`[AI Wealth Override] T${e.tier} at (${e.position.x},${e.position.y}) bypassing normal checks (iron: ${o})`);else if(o<40){let h=this.computeHighestTierNeedingUpgrade();if(h>0&&e.tier<h)return{type:"none"}}if(!s&&r){let h=!e.hasWeapon&&r.hasWeapon,f=!e.hasArmor&&r.hasArmor;if(h||f){let m=h&&f?"Weapon & Armor":h?"Weapon":"Armor";return this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored ${m} purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) already has it).`),{type:"none"}}}let a=i.reduce((h,f)=>{let m=Math.max(Math.abs(f.x-e.position.x),Math.abs(f.y-e.position.y)),w=Math.max(Math.abs(h.x-e.position.x),Math.abs(h.y-e.position.y));return m<w?f:h},i[0]),c=this.ignoreForgeUntilTurnSignal().get(e.id)??0;if(this.turnSignal()<=c)return{type:"none"};if(e.position.x===a.x&&e.position.y===a.y){let h=this.aiIronSignal();if(r){let f=!1;return!r.hasArmor&&!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal(),f=!0),!r.hasWeapon&&!e.hasWeapon&&h>=20&&(this.aiBuyWeapon(e.id),f=!0),!f&&r.hasArmor&&r.hasWeapon&&this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) fully equipped).`),{type:"none"}}else return!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal()),!e.hasWeapon&&h>=20&&this.aiBuyWeapon(e.id),{type:"none"}}let d=this.getNextStepTowards(e,a,t);return d?{type:"move",target:d}:{type:"none"}}seekUpgradesFor(e,t,i){if(t.owner!==e)return{type:"none"};if(t.tier<2)return{type:"none"};let r=this.getIron(e);if(t.hasArmor&&t.hasWeapon||r<20)return{type:"none"};let o=this.getForges(e);if(o.length===0)return{type:"none"};let s=e==="ai"?this.getMergePartnerForUnit(t,i):this.getMergePartnerForUnit(t,i),a=this.getIron(e),l=e==="ai"&&a>=100;if(l)this.appendLog(`[AI Wealth Override] T${t.tier} at (${t.position.x},${t.position.y}) bypassing normal checks (iron: ${a})`);else if(a<40){let m=this.computeHighestTierNeedingUpgrade();if(m>0&&t.tier<m)return{type:"none"}}if(!l&&s){let m=!t.hasWeapon&&s.hasWeapon,w=!t.hasArmor&&s.hasArmor;if(m||w)return this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored ${m&&w?"Weapon & Armor":m?"Weapon":"Armor"} purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) already has it).`),{type:"none"}}let c=o.reduce((m,w)=>{let S=Math.max(Math.abs(w.x-t.position.x),Math.abs(w.y-t.position.y)),k=Math.max(Math.abs(m.x-t.position.x),Math.abs(m.y-t.position.y));return S<k?w:m},o[0]),h=this.ignoreForgeUntilTurnSignal().get(t.id)??0;if(this.turnSignal()<=h)return{type:"none"};if(t.position.x===c.x&&t.position.y===c.y){let m=this.getIron(e);if(s){let w=!1;return!s.hasArmor&&!t.hasArmor&&m>=20&&(this.buyArmorGeneric(e,t.id),m=this.getIron(e),w=!0),!s.hasWeapon&&!t.hasWeapon&&m>=20&&(this.buyWeaponGeneric(e,t.id),w=!0),!w&&s.hasArmor&&s.hasWeapon&&this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) fully equipped).`),{type:"none"}}else return!t.hasArmor&&m>=20&&(this.buyArmorGeneric(e,t.id),m=this.getIron(e)),!t.hasWeapon&&m>=20&&this.buyWeaponGeneric(e,t.id),{type:"none"}}let f=this.getNextStepTowards(t,c,i,void 0);return f?{type:"move",target:f}:{type:"none"}}async executeBotTurn(e){if(this.activeSideSignal()!==e||this.gameStatus()!=="playing")return;let t=e==="ai"?"player":"ai",i=this.getBasePosition(t),r=this.getBasePosition("player"),o=this.getBasePosition("ai"),s=this.forestsSignal().length+this.minesSignal().length,a=this.unitsSignal().filter(f=>f.owner===t&&(this.isForest(f.position.x,f.position.y)||this.isMine(f.position.x,f.position.y)));if((s>0?a.length/s:0)>.5){let f=new Map,m=this.unitsSignal().filter(k=>k.owner===e&&!k.hasActed),w=new Set,S=a.slice().sort((k,V)=>V.tier-k.tier);for(let k of S){let V=Math.min(4,k.tier+1),q=m.filter(ve=>ve.tier===V&&!w.has(ve.id)).sort((ve,xe)=>{let Ae=Math.max(Math.abs(ve.position.x-k.position.x),Math.abs(ve.position.y-k.position.y)),O=Math.max(Math.abs(xe.position.x-k.position.x),Math.abs(xe.position.y-k.position.y));return Ae-O});if(q.length>0){let ve=q[0];f.set(ve.id,{target:F({},k.position),type:"hunt"}),w.add(ve.id);continue}let ye=m.filter(ve=>ve.tier===k.tier&&!w.has(ve.id));for(let ve of ye){let xe=this.calculateValidMoves(ve),Ae=this.unitsSignal().find(O=>O.owner===e&&O.tier===ve.tier&&(O.position.x!==ve.position.x||O.position.y!==ve.position.y)&&xe.some(T=>T.x===O.position.x&&T.y===O.position.y));if(Ae){f.set(ve.id,{target:F({},Ae.position),type:"merge"}),w.add(ve.id);break}}}e==="ai"?this.reclamationGoalsSignal.set(f):this.reclamationGoalsSignal.set(f)}else this.reclamationGoalsSignal.set(new Map);let d=this.unitsSignal().filter(f=>f.owner===e&&!f.hasActed),h={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(f=>f.owner===t&&f.tier>=3)};for(let f of d){let m=null,w=this.calculateValidMoves(f),S=this.getForges(e),k=this.unitsSignal().filter(Ae=>Ae.owner===t),V=[];for(let Ae of S)for(let O of k)Math.max(Math.abs(O.position.x-Ae.x),Math.abs(O.position.y-Ae.y))<=3&&V.push(O);if(V.length>0){let Ae=V.reduce((T,P)=>{let I=Math.abs(T.position.x-f.position.x)+Math.abs(T.position.y-f.position.y);return Math.abs(P.position.x-f.position.x)+Math.abs(P.position.y-f.position.y)<I?P:T});if(w.some(T=>T.x===Ae.position.x&&T.y===Ae.position.y))m={type:"attack",target:Ae.position,reason:"Defense: Guard Forge"};else{let T=this.getNextStepTowards(f,Ae.position,w);T&&(m=this.getWallBetween(f.position.x,f.position.y,T.x,T.y)?{type:"wall_attack",target:T,reason:"Defense: Breach to Forge"}:{type:"move",target:T,reason:"Defense: Approach Forge Threat"})}}if(!m&&f.tier>=2&&(!f.hasArmor||!f.hasWeapon)){let Ae=this.seekUpgradesFor(e,f,w);Ae.type==="move"&&Ae.target&&(m={type:"move",target:Ae.target,reason:"Upgrade: Move to Forge"})}let q=this.computeSideEffectivePower(e),ye=this.computeSideEffectivePower(t),xe=ye>0&&q>ye*1.2&&!this.isForest(f.position.x,f.position.y)&&parseInt(f.id.slice(-1),16)%2===0;if(!m&&xe){let Ae=this.getBasePosition(t);if(Math.max(Math.abs(Ae.x-f.position.x),Math.abs(Ae.y-f.position.y))<=1){let T=this.findCombatTarget(f,h,w);T&&(m={type:"attack",target:T,reason:"Siege: Engage Enemy"})}else{let T=this.getNextStepTowards(f,Ae,w,{noCohesion:!0});T&&(m={type:"move",target:T,reason:"Siege: Advance"})}}if(!m){let Ae=this.findCombatTarget(f,h,w);Ae&&(m={type:"attack",target:Ae,reason:"Combat: Engage Enemy"})}if(!m&&this.getWood(e)>=10&&this.getNeighbors(f.position).some(T=>this.isForest(T.x,T.y)&&this.getUnitAt(T.x,T.y)?.owner===e)){let T=this.findDefensiveWallTarget(f);T&&(m={type:"build_wall",target:T,reason:"Defense: Fortify Perimeter"})}if(!m){let Ae=t==="ai"?o:r,O=this.findFallbackMove(f,w,Ae);O&&(m={type:"move",target:O,reason:"Fallback: Advance on Enemy"})}m?m.type==="build_wall"?e==="ai"?this.aiBuildWallBetween(f.position,m.target):this.buildWallBetween(f.position,m.target):this.executeMove(f,m.target):this.unitsSignal.update(Ae=>Ae.map(O=>O.id===f.id?ce(F({},O),{hasActed:!0}):O)),await new Promise(Ae=>setTimeout(Ae,60))}e==="player"?this.endTurn():this.endTurn()}playerAutoStep(){if(!this.isPlayerTurn()||this.gameStatus()!=="playing")return!1;let e="player",t="ai",i=this.unitsSignal().find(a=>a.owner===e&&!a.hasActed);if(!i)return!1;let r=this.calculateValidMoves(i),o=this.seekUpgradesFor(e,i,r),s=null;if(o.type==="move"&&o.target&&(s={type:"move",target:o.target,reason:"Upgrade: Move to Forge"}),!s){let a=this.isForest(i.position.x,i.position.y),l=this.isMine(i.position.x,i.position.y),c=this.totalWarMode();if((a||l)&&!c&&!this.getNeighbors(i.position).some(f=>{let m=this.getUnitAt(f.x,f.y);return m&&m.owner===t}))return this.unitsSignal.update(f=>f.map(m=>m.id===i.id?ce(F({},m),{hasActed:!0}):m)),!0}if(!s){let a=this.findPlayerResourceTarget(i);if(a){let l=`${a.x},${a.y}`,c=new Set(this.playerClaimedTargetsSignal());c.add(l),this.playerClaimedTargetsSignal.set(c);let d=this.bfsPath(i.position,a,{respectWalls:!0,avoidFriendlyUnits:!0});if(d||(d=this.bfsPath(i.position,a,{avoidFriendlyUnits:!0})),d&&d.length>1){let h=d[1];this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?s={type:"wall_attack",target:h,reason:"Resource: Breach to Capture"}:r.some(m=>m.x===h.x&&m.y===h.y)&&(s={type:"move",target:h,reason:"Resource: Move to Capture"})}else{let h=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});h&&(s=this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?{type:"wall_attack",target:h,reason:"Resource: Breach"}:{type:"move",target:h,reason:"Resource: Advance"})}}}if(!s){let a={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(c=>c.owner===t&&c.tier>=3)},l=this.findCombatTarget(i,a,r);l&&(s={type:"attack",target:l,reason:"Combat: Engage Enemy"})}if(!s){let a=this.getBasePosition(t),l=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});l&&(s={type:"move",target:l,reason:"Advance"})}return s?(s.type==="build_wall"?this.buildWallBetween(i.position,s.target):s.type==="wall_attack"?this.attackOrDestroyWallBetween(i.position,s.target):this.executeMove(i,s.target),!0):(this.unitsSignal.update(a=>a.map(l=>l.id===i.id?ce(F({},l),{hasActed:!0}):l)),!1)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10)return;if(!this.canBuildWallBetween(e,t)){if(this.isEdgeOnCooldown(e,t)){let a=this.edgeCooldownRemaining(e,t);this.appendLog(`[Build] This area is too unstable to rebuild yet (CD: ${a} turns).`)}return}let r=this.getBestAdjacentPlayerUnit(e,t);if(!r||r.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.updateWallFormations(),this.resourcesSignal.update(a=>({wood:a.wood-10,iron:a.iron})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(l=>l.id===r.id?ce(F({},l),{hasActed:!0}):l))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20,iron:t.iron})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(i=>({wood:i.wood-t*20,iron:i.iron})),this.reservePointsSignal.update(i=>({player:i.player+t,ai:i.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let i=[];for(let r=-2;r<=2;r++)for(let o=-2;o<=2;o++){if(r===0&&o===0)continue;let s=t.x+r,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(r),Math.abs(o))>2)continue;this.getUnitAt(s,a)||i.push({x:s,y:a})}this.deployTargetsSignal.set(i),this.baseDeployActiveSignal.set(!0)}startSandboxSpawn(e,t){this.settings.customMode()&&this.sandboxSpawnPendingSignal.set({owner:e,tier:t})}cancelSandboxSpawn(){this.sandboxSpawnPendingSignal.set(null)}spawnSandboxAt(e){let t=this.sandboxSpawnPendingSignal();if(!t||!this.settings.customMode()||this.getUnitAt(e.x,e.y))return;let i=this.getPointsForTierLevel(t.tier,1),r={id:crypto.randomUUID(),position:F({},e),level:1,tier:t.tier,points:i,owner:t.owner,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};this.unitsSignal.update(o=>[...o,r]),this.sandboxSpawnPendingSignal.set(null),this.recomputeVisibility()}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,l=e.y+s;this.inBounds(a,l)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,l)||t.push({x:a,y:l}))}let i=this.reservePointsSignal().player,r=[];for(let o of t){if(i<=0)break;let s=this.economy.getHighestAffordableCost(i);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(l=>[...l,{id:crypto.randomUUID(),position:F({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}]),i-=s,r.push(o)}r.length>0&&(this.reservePointsSignal.update(o=>({player:i,ai:o.ai})),this.recomputeVisibility())}botEconomyPhase(e){if(this.gameStatus()!=="playing"||e!=="player"||!this.isPlayerTurn())return!1;let t=!1;{let r=this.baseHealthSignal().player<50?20:50,o=0;for(;this.resourcesSignal().wood>=r+20;)this.convertWoodToReserve(),o+=20;o>0&&(this.appendLog(`[Auto-Engage] Player converted ${o} wood to reserves.`),t=!0)}try{let i=this.forgesSignal().length,r=this.forgeSitesSignal().length,o=i+r,s=this.resourcesSignal();if(o<2&&s.iron>=20&&s.wood>=40){let a=this.getBasePosition("player"),l=2,c=!1;for(let d=-l;d<=l&&!c;d++)for(let h=-l;h<=l&&!c;h++){if(d===0&&h===0)continue;let f=a.x+d,m=a.y+h;this.inBounds(f,m)&&(Math.max(Math.abs(d),Math.abs(h))>l||this.canBuildForgeAt(f,m)&&(this.appendLog(`[Auto-Engage] Player building Forge at (${f},${m}).`),this.buildForgeAt({x:f,y:m}),t=!0,c=!0))}}}catch{}if(!this.wallBuiltThisTurnSignal()&&this.resourcesSignal().wood>=10){let r=this.unitsSignal().filter(o=>o.owner==="player"&&this.isForest(o.position.x,o.position.y));for(let o of r){let s=this.findDefensiveWallTargetForOwner(o,"player");if(s){this.buildWallBetween(o.position,s),t=!0;break}}}{let i=this.unitsSignal().length;this.autoDeployFromReserves(),this.unitsSignal().length>i&&(t=!0)}return t}isDeployTarget(e,t){return this.deployTargetsSignal().some(i=>i.x===e&&i.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let i=this.economy.getHighestAffordableCost(t);if(i<=0)return;let r=this.calculateTierAndLevel(i);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:F({},e),level:r.level,tier:r.tier,points:i,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-i,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${r.tier}(L${r.level}) at (${e.x},${e.y}) costing ${i} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[i,r]=this.sortEdgeEndpoints(e,t);return`${i.x},${i.y}|${r.x},${r.y}`}registerWallDestroyedEdge(e,t){let i=this.edgeKey(e,t),r=new Map(this.wallCooldownSignal());r.set(i,this.turnSignal()),this.wallCooldownSignal.set(r)}isEdgeOnCooldown(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);return r===void 0?!1:5-(this.turnSignal()-r)>0}edgeCooldownRemaining(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);if(r===void 0)return 0;let o=5-(this.turnSignal()-r);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,i=!1){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(r.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(r.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(r.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;{let w=t.x-e.x,S=t.y-e.y,k=Math.abs(w)>=Math.abs(S),V=Math.sign(k?w:S),q=this.wallThicknessPx+2,ye=this.tileSizePx+q,ve=Math.round(ye*.35),xe=k?V*ve:0,Ae=k?0:V*ve,O=new Set(this.attackingUnitsSignal());O.add(s.id),this.attackingUnitsSignal.set(O),this.attackerNudgeSignal.set({id:s.id,dx:xe,dy:Ae}),setTimeout(()=>{this.attackerNudgeSignal.set({id:s.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let T=new Set(this.attackingUnitsSignal());T.delete(s.id),this.attackingUnitsSignal.set(T)},200)}let a=this.combat.getWallHitAmount(s.tier),[l,c]=this.sortEdgeEndpoints(e,t),d=r.maxHealth??100,h=Math.max(0,r.health-a);this.wallsSignal.update(w=>w.map(S=>S.id===r.id?ce(F({},S),{health:Math.max(0,S.health-a)}):S).filter(S=>S.health>0)),h<=0?(this.registerWallDestroyedEdge(l,c),this.updateWallFormations()):this.updateWallFormations(),this.shakenWallIdSignal.set(r.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let f=o==="player"?"Player":"AI",m=r.owner==="neutral"?"Neutral":r.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${s.tier} Unit attacked ${m} Wall. Damage: ${a}. Wall HP: ${h}/${d}.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(w=>w.map(S=>S.id===s.id?ce(F({},S),{hasActed:!0}):S)),o==="player"&&this.selectNextAvailableUnit()}destroyOwnWallBetween(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i||i.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==i.id));let[r,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(r,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`),this.updateWallFormations()}canDestroyOwnWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||i.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!i||i.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||!this.canActThisTurn()?!1:i.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(i=>i.owner==="player"&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let i=this.getAdjacentPlayerUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="ai"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentAiUnit(e,t){let i=this.getAdjacentAiUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<50)return;let i=this.getBestAdjacentAiUnit(e,t);if(!i||i.hasActed||!this.unitsSignal().filter(l=>l.owner==="player").some(l=>{let c=Math.max(Math.abs(l.position.x-e.x),Math.abs(l.position.y-e.y)),d=Math.max(Math.abs(l.position.x-t.x),Math.abs(l.position.y-t.y));return c<=2||d<=2?l.tier>=i.tier:!1})||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let[s,a]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(l=>[...l,{id:crypto.randomUUID(),tile1:{x:s.x,y:s.y},tile2:{x:a.x,y:a.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(l=>l-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(l=>l.map(c=>c.id===i.id?ce(F({},c),{hasActed:!0}):c)),this.updateWallFormations()}isBaseProtectionEdge(e,t){let i=this.getBasePosition("ai"),r=o=>Math.max(Math.abs(o.x-i.x),Math.abs(o.y-i.y))<=1||o.x===i.x&&o.y===i.y;return r(e)||r(t)}wouldCageElite(e,t){let i=(s,a,l,c)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:l,y:c}),h=this.sortEdgeEndpoints(e,t);return d[0].x===h[0].x&&d[0].y===h[0].y&&d[1].x===h[1].x&&d[1].y===h[1].y},r=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||i(s.x,s.y,a.x,a.y));{let l=Math.sign(a.x-s.x),c=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+l,s.y),h=this.getWallBetween(s.x,s.y,s.x,s.y+c),f=this.getWallBetween(a.x-l,a.y,a.x,a.y),m=this.getWallBetween(a.x,a.y-c,a.x,a.y);return!!(d||h||f||m||i(s.x,s.y,s.x+l,s.y)||i(s.x,s.y,s.x,s.y+c)||i(a.x-l,a.y,a.x,a.y)||i(a.x,a.y-c,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(l=>{let c={x:s.position.x+l.x,y:s.position.y+l.y};return this.inBounds(c.x,c.y)?!r(s.position,c):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(r=>r.owner==="ai"),t=this.unitsSignal().filter(r=>r.owner==="player"),i=this.getBasePosition("ai");for(let r of e){if(!this.isForest(r.position.x,r.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y))<=2);for(let s of o){let a=r.level??this.calculateTierAndLevel(r.points).level,l=s.level??this.calculateTierAndLevel(s.points).level,c=Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y)),d=Math.sign(s.position.x-r.position.x),h=Math.sign(s.position.y-r.position.y);if(Math.abs(d)+Math.abs(h)===2)continue;let f=c===1?{x:r.position.x+d,y:r.position.y+h}:{x:r.position.x+Math.sign(s.position.x-r.position.x),y:r.position.y+Math.sign(s.position.y-r.position.y)};if(!this.inBounds(f.x,f.y))continue;let m=Math.sign(i.x-r.position.x),w=Math.sign(i.y-r.position.y);if((f.x-r.position.x)*m+(f.y-r.position.y)*w>0)continue;let k=r.position,V=f;if(!this.getWallBetween(k.x,k.y,V.x,V.y)&&(l>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(k,V),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${k.x},${k.y})-(${V.x},${V.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let i=e.x<=t.x,r=e.y<=t.y;return i&&r?0:!i&&r?1:i&&!r?2:3}placeNeutralWalls(){let e=(i,r)=>{if(!this.areAdjacent(i,r)||!this.inBounds(i.x,i.y)||!this.inBounds(r.x,r.y)||this.getWallBetween(i.x,i.y,r.x,r.y))return;let[o,s]=this.sortEdgeEndpoints(i,r);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}]),this.updateWallFormations()},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let i of t){let r=[{x:i.x+1,y:i.y},{x:i.x-1,y:i.y},{x:i.x,y:i.y+1},{x:i.x,y:i.y-1}];for(let o of r)this.inBounds(o.x,o.y)&&e(i,o)}for(let i of this.forestsSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}for(let i of this.minesSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}}static \u0275fac=function(t){return new(t||n)(Re(Yl),Re(Fg),Re(Lg),Re(gt),Re(Vg),Re(Ug),Re(Bg),Re(Rn),Re(Ic))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};function S$(n,e){n&1&&(ie(),G(0,"polygon",127))}function I$(n,e){n&1&&(ie(),G(0,"polygon",127))}function T$(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",213),A())}function C$(n,e){n&1&&(ie(),G(0,"polygon",127))}function D$(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",213),A())}function A$(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",214)(2,"polygon",215)(3,"polygon",216),A())}var m0=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(he($n),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-game-rules"]],decls:694,vars:76,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","flex-col","justify-between"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"bg-gray-800/60","border","border-blue-500/30","rounded-lg","p-4","shadow-[0_0_15px_rgba(59,130,246,0.1)]"],[1,"text-lg","font-semibold","mb-3","flex","items-center","gap-2"],[1,"text-blue-400"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[45px]","text-center"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[60px]","text-center"],[1,"text-xs","text-gray-400","text-right","italic"],[1,"flex","flex-col","items-center","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","text-white"],[1,"flex","items-center","justify-between","gap-4","border-t","border-white/5","pt-3"],[1,"px-4","py-1","bg-blue-600","border-b-4","border-blue-800","rounded","text-xs","font-mono","text-white","font-bold"],[1,"text-xs","text-blue-300","font-semibold","uppercase","tracking-wider"],[1,"mt-4","p-2","bg-blue-500/10","border","border-blue-500/20","rounded","text-[10px]","text-blue-200/70","leading-tight"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"bg-gray-800/60","border","border-gray-700","rounded-xl","p-6","md:col-span-2","shadow-2xl","backdrop-blur-sm"],[1,"text-xs","uppercase","tracking-widest","text-gray-500","font-bold","mb-6","flex","items-center","gap-2"],[1,"w-8","h-[1px]","bg-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8","items-start"],[1,"space-y-6"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-gray-300","text-sm"],[1,"text-orange-400","font-bold"],[1,"text-blue-400","font-bold"],[1,"p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-xs","text-gray-400","leading-relaxed"],[1,"text-white","font-semibold"],[1,"lg:col-span-2","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-blue-500/50","transition-all","duration-300","flex","items-center","gap-4"],[1,"w-20","h-20","shrink-0"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],["cx","50","cy","50","r","32"],["cx","50","cy","50","r","31","fill","none","stroke","rgba(255,255,255,0.2)","stroke-width","2"],["x","50","y","62","text-anchor","middle","font-size","32","font-weight","800","fill","white"],["transform","translate(18, 5) scale(0.8)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","#60a5fa"],[1,"flex","flex-col"],[1,"text-blue-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"text-gray-300","text-sm","leading-tight"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-red-500/50","transition-all","duration-300","flex","items-center","gap-4"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],["transform","rotate(-45 50 50) translate(40, 10) scale(1.2)"],["x","5","y","0","width","2","height","10","fill","#f87171"],["x","3","y","10","width","6","height","2","fill","#991b1b"],[1,"text-red-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"p-4","bg-gray-800/40","rounded-lg","border","border-gray-700/30"],[1,"text-[10px]","uppercase","tracking-wider","text-gray-500","font-bold","mb-3"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"flex","justify-between","border-b","border-gray-700/50","pb-1"],[1,"text-gray-500"],[1,"text-white"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","#60a5fa","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],[1,"text-lg","font-semibold","mb-1"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","3"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","4"],[1,"mover","triangle","t1-path"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"flex","items-center","gap-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","theme-test-player"],[1,"flex","flex-col","flex-center"],[1,"flex","flex-center","gap-2"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-80"],["points","50,16 86,78 14,78","fill","var(--u-fill)"],["x","49","y","66","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2"],["viewBox","0 0 100 100"],["id","base-circle"],["id","eye"],["id","scan-lvl2"],["id","radar-lvl3"],["id","field-lvl4"],["cx","50","cy","50","r","14","fill","#94a3b8"],["cx","50","cy","50","r","4","fill","#e5e7eb"],["cx","50","cy","50","r","20","fill","none","stroke","#cbd5f5","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","#e5e7eb","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","#f8fafc"],["cx","50","cy","50","r","30","fill","none","stroke","#f1f5f9","stroke-width","1","opacity","0.4"],[1,"unit-svg-wrapper","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-70"],["cx","50","cy","55","r","6","fill","var(--u-core)"],["points","50,5 55,15 45,15","fill","var(--u-stroke)"],["points","92,82 82,78 86,70","fill","var(--u-stroke)"],["points","8,82 18,78 14,70","fill","var(--u-stroke)"],["points","50,2 95,85 5,85","fill","none","stroke","var(--u-core)","stroke-width","2"],["points","50,48 56,52 56,60 50,64 44,60 44,52","fill","var(--u-light)"],["points","50,-2 102,88 -2,88","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","opacity","0.6"],["points","50,-5 54,8 46,8","fill","var(--u-light)"],["points","92,82 88,70 80,78","fill","var(--u-light)"],["points","8,82 20,78 12,70","fill","var(--u-light)"],["id","base-shape"],["id","core"],["id","armor-lvl2"],["id","armor-lvl3"],["id","fortress-lvl4"],["id","fx"],["x","20","y","20","width","60","height","60","rx","6","fill","#2563eb"],["x","46","y","46","width","8","height","8","fill","#93c5fd"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","#60a5fa","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","#93c5fd","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","#bfdbfe"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","#60a5fa","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","#bfdbfe"],["x","78","y","12","width","10","height","10","fill","#bfdbfe"],["x","12","y","78","width","10","height","10","fill","#bfdbfe"],["x","78","y","78","width","10","height","10","fill","#bfdbfe"],["id","base-hex"],["id","links-lvl2"],["id","network-lvl3"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","#10b981"],["cx","50","cy","50","r","4","fill","#6ee7b7"],["x1","50","y1","20","x2","50","y2","40","stroke","#6ee7b7","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","#6ee7b7","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","#6ee7b7","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","#a7f3d0","stroke-width","2"],["cx","50","cy","20","r","3","fill","#34d399"],["cx","80","cy","50","r","3","fill","#34d399"],["cx","50","cy","80","r","3","fill","#34d399"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","#6ee7b7","stroke-width","1.5","stroke-dasharray","4 4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","unit-svg-wrapper-game_rules"],[1,"flex","items-center","gap-6","theme-test-player"],["viewBox","0 0 100 100",1,"w-full","h-full"],["cx","50","cy","50","r","20","fill","var(--u-fill)"],["cx","50","cy","50","r","4","fill","var(--u-light)"],["cx","50","cy","50","r","26","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","var(--u-light)","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","var(--u-light)"],["cx","50","cy","50","r","34","fill","none","stroke","var(--u-light)","stroke-width","1","opacity","0.4"],[1,"flex","items-center","gap-6","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-75"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-110"],["x","20","y","20","width","60","height","60","rx","6","fill","var(--u-dark)"],["x","46","y","46","width","8","height","8","fill","var(--u-core)"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","var(--u-light)"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","var(--u-light)"],["x","78","y","12","width","10","height","10","fill","var(--u-light)"],["x","12","y","78","width","10","height","10","fill","var(--u-light)"],["x","78","y","78","width","10","height","10","fill","var(--u-light)"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","var(--u-emerald)"],["cx","50","cy","50","r","4","fill","var(--u-emerald-stroke)"],["x1","50","y1","20","x2","50","y2","40","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","var(--u-emerald-stroke)","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","2"],["cx","50","cy","20","r","3","fill","var(--u-emerald-stroke)"],["cx","80","cy","50","r","3","fill","var(--u-emerald-stroke)"],["cx","50","cy","80","r","3","fill","var(--u-emerald-stroke)"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 56,10 44,10","fill","var(--u-light)"],["points","99,87 92,74 84,87","fill","var(--u-light)"],["points","1,87 15,87 8,74","fill","var(--u-light)"]],template:function(t,i){t&1&&(D(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),v(5),A(),D(6,"h3",5),v(7),A()(),D(8,"button",6),Gt("click",function(){return i.engine.closeRules()}),v(9," \u2716 "),A()(),D(10,"div",7)(11,"div",8)(12,"div",9),v(13),A(),D(14,"div",10)(15,"div",11)(16,"div",12),v(17,"\u{1F333}"),A(),D(18,"div")(19,"div",13),v(20),A(),D(21,"div",14),v(22),A()()(),D(23,"div",11)(24,"div",12),v(25,"\u{1F3F0}"),A(),D(26,"div")(27,"div",13),v(28),A(),D(29,"div",14),v(30),A()()()()(),D(31,"div",15)(32,"div",16)(33,"div",9),v(34),A(),D(35,"div",17)(36,"div",18)(37,"div",19),v(38," 1 "),A(),D(39,"div",20),v(40,"1\u20134"),A()(),D(41,"div",18)(42,"div",21),v(43," 5 "),A(),D(44,"div",20),v(45,"5\u201320"),A()(),D(46,"div",18)(47,"div",21),v(48,"25"),A(),D(49,"div",20),v(50,"25\u2013100"),A()(),D(51,"div",18)(52,"div",22)(53,"span",23),v(54,"125"),A()(),D(55,"div",20),v(56,"125\u2013500"),A()()()(),D(57,"div",16)(58,"div",24),v(59),A(),D(60,"div",25)(61,"div",26)(62,"div",27),v(63,"2"),A(),D(64,"div",28),v(65,"2"),A(),D(66,"div",29),v(67,"1"),A()()()()(),D(68,"div",30)(69,"div",31)(70,"span",32),v(71,"\u2328\uFE0F"),A(),v(72),A(),D(73,"div",33)(74,"div",34)(75,"div",35)(76,"kbd",36),v(77," Tab "),A(),D(78,"kbd",37),v(79," Space "),A()(),D(80,"div",38),v(81),A()(),D(82,"div",34)(83,"div",39)(84,"kbd",40),v(85,"\u2191"),A(),D(86,"div",35)(87,"kbd",40),v(88,"\u2190"),A(),D(89,"kbd",40),v(90,"\u2193"),A(),D(91,"kbd",40),v(92,"\u2192"),A()()(),D(93,"div",38),v(94),A()(),D(95,"div",41)(96,"kbd",42),v(97," Enter "),A(),D(98,"div",43),v(99),A()()(),D(100,"div",44)(101,"strong"),v(102,"TIP:"),A(),v(103),A()(),D(104,"div",8)(105,"div",9),v(106),A(),D(107,"div",45)(108,"div")(109,"div",46),v(110),A(),D(111,"div",47)(112,"div",48),v(113,"1"),A(),D(114,"div",49),v(115,"1"),A()(),D(116,"div",50),v(117),A()(),D(118,"div")(119,"div",46),v(120),A(),D(121,"div",47)(122,"div",48),v(123,"4"),A(),D(124,"div",51),v(125,"1"),A(),D(126,"span",52),v(127,"CRIT!"),A()(),D(128,"div",50),v(129),A()(),D(130,"div")(131,"div",46),v(132),A(),D(133,"div",47)(134,"div",48),v(135,"1"),A(),D(136,"div",53),v(137,"4"),A(),D(138,"span",54),v(139,"MISS!"),A()(),D(140,"div",50),v(141),A()()()(),D(142,"div",55)(143,"div",56),G(144,"span",57),v(145),A(),D(146,"div",58)(147,"div",59)(148,"div",60)(149,"div",61)(150,"span",62),v(151),A(),D(152,"span",63),v(153,"20%"),A()(),D(154,"div",61)(155,"span",62),v(156),A(),D(157,"span",64),v(158,"20%"),A()(),D(159,"div",65)(160,"p",66)(161,"span",67),v(162,"50%"),A(),v(163),A()()()(),D(164,"div",68)(165,"div",69)(166,"div",70),ie(),D(167,"svg",71),G(168,"circle",72)(169,"circle",73),D(170,"text",74),v(171,"1"),A(),D(172,"g",75),G(173,"path",76),A()()(),Oe(),D(174,"div",77)(175,"span",78),v(176,"+20 HP Bonus"),A(),D(177,"p",79),v(178),A()()(),D(179,"div",80)(180,"div",70),ie(),D(181,"svg",81),G(182,"circle",72)(183,"circle",73),D(184,"text",74),v(185,"1"),A(),D(186,"g",82),G(187,"rect",83)(188,"rect",84),A()()(),Oe(),D(189,"div",77)(190,"span",85),v(191,"+20 DMG Bonus"),A(),D(192,"p",79),v(193),A()()()(),D(194,"div",68)(195,"div",86)(196,"p",87),v(197),A(),D(198,"div",88)(199,"div",89)(200,"span",90),v(201,"T1"),A(),D(202,"span",91),v(203,"1"),A()(),D(204,"div",89)(205,"span",90),v(206,"T2"),A(),D(207,"span",91),v(208,"2"),A()(),D(209,"div",89)(210,"span",90),v(211,"T3"),A(),D(212,"span",91),v(213,"4"),A()(),D(214,"div",89)(215,"span",90),v(216,"T4"),A(),D(217,"span",91),v(218,"8"),A()()()(),D(219,"div",80)(220,"div",70),ie(),D(221,"svg",81),G(222,"circle",72)(223,"circle",73),D(224,"text",74),v(225,"1"),A(),D(226,"g"),G(227,"path",92)(228,"path",93),A()()(),Oe(),D(229,"div",77)(230,"p",79),v(231),A()()()()()(),D(232,"div",16)(233,"div",94),v(234),A(),D(235,"div",95)(236,"div")(237,"div",96),v(238),A(),D(239,"div",97),G(240,"div",98)(241,"div",98)(242,"div",98)(243,"div",98)(244,"div",98)(245,"div",98)(246,"div",99)(247,"div",99)(248,"div",98)(249,"div",98)(250,"div",98)(251,"div",98)(252,"div",98)(253,"div",98)(254,"div",98)(255,"div",98)(256,"div",98)(257,"div",98)(258,"div",98)(259,"div",98)(260,"div",98)(261,"div",98)(262,"div",98)(263,"div",98)(264,"div",98),D(265,"div",100),v(266,"2"),A(),G(267,"div",101),D(268,"div",102),v(269,"\u{1F3F0}"),A()()(),D(270,"div")(271,"div",96),v(272),A(),D(273,"div",103),G(274,"div",98)(275,"div",98)(276,"div",98)(277,"div",98)(278,"div",98)(279,"div",98)(280,"div",99)(281,"div",99)(282,"div",99)(283,"div",98)(284,"div",98)(285,"div",98)(286,"div",98)(287,"div",98)(288,"div",98)(289,"div",98)(290,"div",98)(291,"div",98)(292,"div",98)(293,"div",98)(294,"div",98)(295,"div",98)(296,"div",98)(297,"div",98)(298,"div",98),D(299,"div",104),v(300,"3"),A(),G(301,"div",101),D(302,"div",105),v(303,"\u{1F3F0}"),A()()(),D(304,"div")(305,"div",96),v(306),A(),D(307,"div",106),G(308,"div",98)(309,"div",98)(310,"div",98)(311,"div",98)(312,"div",98)(313,"div",98)(314,"div",99)(315,"div",99)(316,"div",99)(317,"div",99)(318,"div",98)(319,"div",98)(320,"div",98)(321,"div",98)(322,"div",98)(323,"div",98)(324,"div",98)(325,"div",98)(326,"div",98)(327,"div",98)(328,"div",98)(329,"div",98)(330,"div",98)(331,"div",98)(332,"div",98),D(333,"div",107),v(334,"4"),A(),G(335,"div",101),D(336,"div",102),v(337,"\u{1F3F0}"),A()()()()(),D(338,"div",15)(339,"div",16)(340,"div",9),v(341),A(),D(342,"div",17)(343,"div",108)(344,"div",109),v(345,"\u{1F331}"),A(),D(346,"div",110),v(347),A()(),D(348,"div",111),v(349,"\u2192"),A(),D(350,"div",108)(351,"div",109),v(352,"\u{1F33F}"),A(),D(353,"div",110),v(354),A()(),D(355,"div",111),v(356,"\u2192"),A(),D(357,"div",108)(358,"div",109),v(359,"\u{1F333}"),A(),D(360,"div",112),v(361),A()()()(),D(362,"div",16)(363,"div",9),v(364),A(),D(365,"div",113)(366,"div",108)(367,"div",109),v(368,"\u26F0\uFE0F"),A(),D(369,"div",114),v(370),A()(),D(371,"div",111),v(372,"\u2192"),A(),D(373,"div",108)(374,"div",109),v(375,"\u26CF\uFE0F"),A(),D(376,"div",114),v(377),A()(),D(378,"div",111),v(379,"\u2192"),A(),D(380,"div",108)(381,"div",109),v(382,"\u26CF"),A(),D(383,"div",114),v(384),A()(),D(385,"div",111),v(386,"\u2192"),A(),D(387,"div",108)(388,"div",109),v(389,"\u2692"),A(),D(390,"div",114),v(391),A()(),D(392,"div",111),v(393,"\u2192"),A(),D(394,"div",108)(395,"div",109),v(396,"\u{1F9F1}"),A(),D(397,"div",115),v(398),A()()()(),D(399,"div",16)(400,"div",116),v(401),A(),D(402,"div",117)(403,"div",3),G(404,"div",118),D(405,"div",20),v(406),A()(),D(407,"div",3),G(408,"div",119),D(409,"div",20),v(410),A()(),D(411,"div",3),G(412,"div",120),D(413,"div",20),v(414,"Neutral"),A()()()()(),D(415,"div",121)(416,"div",122)(417,"div",9),v(418),A(),D(419,"div",123),ie(),D(420,"svg",124)(421,"g"),G(422,"polygon",125),A(),D(423,"text",126),v(424),A()(),D(425,"svg",124)(426,"g"),G(427,"polygon",125),A(),D(428,"text",126),v(429),A(),Y(430,S$,1,0,":svg:polygon",127),A(),D(431,"svg",124)(432,"g"),G(433,"polygon",125),A(),D(434,"text",126),v(435),A(),Y(436,I$,1,0,":svg:polygon",127),Y(437,T$,2,0,":svg:g"),A(),D(438,"svg",124)(439,"g"),G(440,"polygon",125),A(),D(441,"text",126),v(442),A(),Y(443,C$,1,0,":svg:polygon",127),Y(444,D$,2,0,":svg:g"),Y(445,A$,4,0,":svg:g"),A()()()(),Oe(),D(446,"div",16)(447,"div",9),v(448),A(),D(449,"div",17),ie(),D(450,"svg",128),G(451,"g",129)(452,"g",130)(453,"g",131)(454,"g",132)(455,"g",133),D(456,"g",129),G(457,"circle",134),A(),D(458,"g",130),G(459,"circle",135),A(),D(460,"g",131),G(461,"circle",136),A(),D(462,"g",132),G(463,"line",137)(464,"circle",138),A(),D(465,"g",133),G(466,"circle",139),A()(),Oe(),D(467,"div",140),ie(),D(468,"svg",141)(469,"g"),G(470,"polygon",125),A(),D(471,"g"),G(472,"circle",142),A(),D(473,"g"),G(474,"polygon",143)(475,"polygon",144)(476,"polygon",145),A(),D(477,"g"),G(478,"polygon",146)(479,"polygon",147),A(),D(480,"g"),G(481,"polygon",148)(482,"polygon",149)(483,"polygon",150)(484,"polygon",151),A()()(),D(485,"svg",128),G(486,"g",152)(487,"g",153)(488,"g",154)(489,"g",155)(490,"g",156)(491,"g",157),D(492,"g",152),G(493,"rect",158),A(),D(494,"g",153),G(495,"rect",159),A(),D(496,"g",154),G(497,"rect",160),A(),D(498,"g",155),G(499,"rect",161)(500,"rect",162),A(),D(501,"g",156),G(502,"rect",163)(503,"rect",164)(504,"rect",165)(505,"rect",166)(506,"rect",167),A()(),D(507,"svg",128),G(508,"g",168)(509,"g",153)(510,"g",169)(511,"g",170)(512,"g",133),D(513,"g",168),G(514,"polygon",171),A(),D(515,"g",153),G(516,"circle",172),A(),D(517,"g",169),G(518,"line",173)(519,"line",174)(520,"line",175),A(),D(521,"g",170),G(522,"polygon",176)(523,"circle",177)(524,"circle",178)(525,"circle",179),A(),D(526,"g",133),G(527,"polygon",180),A()()()(),Oe(),D(528,"div",181)(529,"div",9),v(530),A(),D(531,"div",182),ie(),D(532,"svg",183)(533,"g"),G(534,"circle",184),A(),D(535,"g"),G(536,"circle",185),A()(),D(537,"svg",183)(538,"g"),G(539,"circle",184),A(),D(540,"g"),G(541,"circle",185),A(),D(542,"g"),G(543,"circle",186),A()(),D(544,"svg",183)(545,"g"),G(546,"circle",184),A(),D(547,"g"),G(548,"circle",185),A(),D(549,"g"),G(550,"circle",186),A(),D(551,"g"),G(552,"line",187)(553,"circle",188),A()(),D(554,"svg",183)(555,"g"),G(556,"circle",184),A(),D(557,"g"),G(558,"circle",185),A(),D(559,"g"),G(560,"circle",186),A(),D(561,"g"),G(562,"line",187)(563,"circle",188),A(),D(564,"g"),G(565,"circle",189),A()()(),Oe(),D(566,"div",190),ie(),D(567,"svg",191)(568,"g"),G(569,"polygon",125),A(),D(570,"g"),G(571,"circle",142),A()(),D(572,"svg",191)(573,"g"),G(574,"polygon",125),A(),D(575,"g"),G(576,"circle",142),A(),D(577,"g"),G(578,"polygon",143)(579,"polygon",144)(580,"polygon",145),A()(),D(581,"svg",191)(582,"g"),G(583,"polygon",125),A(),D(584,"g"),G(585,"circle",142),A(),D(586,"g"),G(587,"polygon",143)(588,"polygon",144)(589,"polygon",145),A(),D(590,"g"),G(591,"polygon",146)(592,"polygon",147),A()(),D(593,"svg",141)(594,"g"),G(595,"polygon",125),A(),D(596,"g"),G(597,"circle",142),A(),D(598,"g"),G(599,"polygon",143)(600,"polygon",144)(601,"polygon",145),A(),D(602,"g"),G(603,"polygon",146)(604,"polygon",147),A(),D(605,"g"),G(606,"polygon",148)(607,"polygon",149)(608,"polygon",150)(609,"polygon",151),A()()(),Oe(),D(610,"div",182),ie(),D(611,"svg",192)(612,"g"),G(613,"rect",193),A(),D(614,"g"),G(615,"rect",194),A()(),D(616,"svg",192)(617,"g"),G(618,"rect",193),A(),D(619,"g"),G(620,"rect",194),A(),D(621,"g"),G(622,"rect",195),A()(),D(623,"svg",192)(624,"g"),G(625,"rect",193),A(),D(626,"g"),G(627,"rect",194),A(),D(628,"g"),G(629,"rect",195),A(),D(630,"g"),G(631,"rect",196)(632,"rect",197),A()(),D(633,"svg",192)(634,"g"),G(635,"rect",193),A(),D(636,"g"),G(637,"rect",194),A(),D(638,"g"),G(639,"rect",195),A(),D(640,"g"),G(641,"rect",196)(642,"rect",197),A(),D(643,"g"),G(644,"rect",198)(645,"rect",199)(646,"rect",200)(647,"rect",201)(648,"rect",202),A()()(),Oe(),D(649,"div",190),ie(),D(650,"svg",183)(651,"g"),G(652,"polygon",203),A(),D(653,"g"),G(654,"circle",204),A()(),D(655,"svg",183)(656,"g"),G(657,"polygon",203),A(),D(658,"g"),G(659,"circle",204),A(),D(660,"g"),G(661,"line",205)(662,"line",206)(663,"line",207),A()(),D(664,"svg",183)(665,"g"),G(666,"polygon",203),A(),D(667,"g"),G(668,"circle",204),A(),D(669,"g"),G(670,"line",205)(671,"line",206)(672,"line",207),A(),D(673,"g"),G(674,"polygon",208)(675,"circle",209)(676,"circle",210)(677,"circle",211),A()(),D(678,"svg",183)(679,"g"),G(680,"polygon",203),A(),D(681,"g"),G(682,"circle",204),A(),D(683,"g"),G(684,"line",205)(685,"line",206)(686,"line",207),A(),D(687,"g"),G(688,"polygon",208)(689,"circle",209)(690,"circle",210)(691,"circle",211),A(),D(692,"g"),G(693,"polygon",212),A()()()()()()()),t&2&&(g(5),j(i.settings.t("GAME_GUIDE")),g(2),j(i.settings.t("TURN_BASED_STRATEGY")),g(6),j(i.settings.t("VICTORY_CONDITIONS")),g(7),j(i.settings.t("MONOPOLY_LABEL")),g(2),j(i.settings.t("MONOPOLY_DESC")),g(6),j(i.settings.t("ANNIHILATION")),g(2),j(i.settings.t("ANNIHILATION_DESC")),g(4),j(i.settings.t("UNIT_EVOLUTION")),g(8),Je("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),g(17),j(i.settings.t("EVOLUTION_DESC")),g(13),L(" ",i.settings.currentLang()==="uk"?"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0435 \u0443\u043F\u0440\u0430\u0432\u043B\u0456\u043D\u043D\u044F":"Tactical Controls"," "),g(9),L(" ",i.settings.currentLang()==="uk"?"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0438\u0439 \u0432\u0456\u043B\u044C\u043D\u0438\u0439 \u044E\u043D\u0456\u0442":"Cycle through available units"," "),g(13),L(" ",i.settings.currentLang()==="uk"?"\u0420\u0443\u0445 \u0430\u0431\u043E \u0430\u0442\u0430\u043A\u0430 \u0432\u0438\u0431\u0440\u0430\u043D\u0438\u043C \u044E\u043D\u0456\u0442\u043E\u043C":"Move or attack with selected unit"," "),g(5),L(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0445\u0456\u0434":"End player turn"," "),g(4),L(" ",i.settings.currentLang()==="uk"?"\u041D\u0430 \u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043A\u043E\u0436\u043D\u043E\u0433\u043E \u0445\u043E\u0434\u0443 \u0433\u0440\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u0444\u043E\u043A\u0443\u0441\u0443\u0454\u0442\u044C\u0441\u044F \u043D\u0430 \u043C\u043E\u0431\u0456\u043B\u044C\u043D\u043E\u043C\u0443 \u044E\u043D\u0456\u0442\u0456.":"At turn start, the game auto-focuses on your most mobile unit."," "),g(3),j(i.settings.t("COMBAT_DEEP_DIVE")),g(4),j(i.settings.t("SUCCESSFUL_ATTACK")),g(7),j(i.settings.t("SUCCESSFUL_ATTACK_DESC")),g(3),j(i.settings.t("CRITICAL_HIT")),g(9),j(i.settings.t("CRITICAL_HIT_DESC")),g(3),j(i.settings.t("MISS")),g(9),j(i.settings.t("MISS_DESC")),g(4),L(" ",i.settings.currentLang()==="uk"?"\u0414\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0438":"Extra Mechanics"," "),g(6),L(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043A\u0440\u0438\u0442\u0443":"Crit Chance"," "),g(5),L(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u0443":"Miss Chance"," "),g(7),L(" ",i.settings.currentLang()==="uk"?"\u043F\u0440\u0438 \u0440\u0456\u0432\u043D\u0438\u0445 \u0441\u0438\u043B\u0430\u0445: \u0417\u0430\u0445\u0438\u0441\u0442/\u041D\u0456\u0447\u0438\u044F":"at equal force: Defense/Draw"," "),g(5),Bt("fill","url(#vol-fill-player)"),g(10),L(" ",i.settings.currentLang()==="uk"?"-10% \u0443 \u0432\u043E\u0440\u043E\u0433\u0430 \u0448\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u043D\u0443\u0442\u0438\u0441\u044C":"-10% enemy chance to miss"," "),g(4),Bt("fill","url(#vol-fill-player)"),g(11),L(" ",i.settings.currentLang()==="uk"?"10% \u0448\u0430\u043D\u0441 \u043F\u043E\u043F\u0430\u0441\u0442\u0438 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0443":"10% chance to hit the enemy"," "),g(4),L(" ",i.settings.currentLang()==="uk"?"\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F Tier-\u0440\u0456\u0432\u043D\u0456\u0432":"Tier Values"," "),g(25),Bt("fill","url(#vol-fill-player)"),g(9),L(" ",i.settings.currentLang()==="uk"?"+1 \u0434\u043E \u0430\u0442\u0430\u043A\u0438 \u0432\u0456\u0434 \u0441\u0443\u0441\u0456\u0434\u0441\u0442\u0432\u0430":"+1 to an attack from the neighborhood"," "),g(3),j(i.settings.t("MOVEMENT")),g(4),j(i.settings.t("T1_1_TILE")),g(30),Je("left",6,"px")("top",6,"px"),g(4),j(i.settings.t("T3_3_TILES")),g(30),Je("right",6,"px")("bottom",6,"px"),g(4),j(i.settings.t("T4_4_TILES")),g(30),Je("left",6,"px")("top",6,"px"),g(5),j(i.settings.t("FOREST_CYCLE")),g(6),j(i.settings.t("TURN_1")),g(7),j(i.settings.t("TURN_2")),g(7),j(i.settings.t("PLUS_8_WOOD_PER_TURN")),g(3),j(i.settings.t("IRON_CYCLE")),g(6),j(i.settings.t("TURN_1")),g(7),j(i.settings.t("TURN_2")),g(7),j(i.settings.t("TURN_3")),g(7),j(i.settings.t("TURN_4")),g(7),j(i.settings.t("PLUS_2_IRON_PER_TURN")),g(3),j(i.settings.t("WALL_LEGEND")),g(5),j(i.settings.t("PLAYER")),g(4),j(i.settings.t("AI_FACTION")),g(8),L(" ",i.settings.currentLang()==="uk"?"\u0422\u0440\u0435\u0442\u044F \u0456\u0442\u0435\u0440\u0430\u0446\u0456\u044F \u043E\u0434\u0438\u043D\u0438\u0446\u044C":"Third iteration the units"," "),g(6),L(" ",1," "),g(5),L(" ",2," "),g(),Q(430),g(5),L(" ",3," "),g(),Q(436),g(),Q(437),g(5),L(" ",4," "),g(),Q(443),g(),Q(444),g(),Q(445),g(3),j(i.settings.t("NEW_DESIGN_UNIT")),g(82),j(i.settings.t("NEW_UNIT_EVOLUTION")))},dependencies:[Nt],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:60px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:10px;font-size:12px;font-weight:800;color:#fde047;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:10px;font-size:12px;font-weight:800;color:#93c5fd;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}.unit-svg-wrapper-game_rules:hover{transform:scale(1)}
`],encapsulation:2})};var Tc=class n{constructor(e,t){this.gameEngine=e;this.settings=t}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(he($n),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-support-community"]],decls:51,vars:6,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,i){t&1&&(D(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),v(4),A(),D(5,"button",4),Gt("click",function(){return i.gameEngine.closeSupport()}),v(6," \u2716 "),A()(),D(7,"div",5)(8,"div",6)(9,"div",7),v(10,"Donate"),A(),D(11,"div",8),v(12),A(),D(13,"div",9)(14,"div",10),G(15,"img",11),A(),D(16,"div",12)(17,"div",13),v(18,"send.monobank.ua/jar/2fqGoPhV7G"),A(),D(19,"div",14)(20,"button",15),Gt("click",function(){return i.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(21),A(),D(22,"button",16),Gt("click",function(){return i.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(23),A()()()(),D(24,"div",17)(25,"div",8),v(26,"Donatello"),A(),D(27,"button",18),Gt("click",function(){return i.openExternalLink("https://donatello.to/jaerbi")}),v(28," Go to Donatello.to \u{1F48E} "),A()(),D(29,"div",19),v(30),A()(),D(31,"div",6)(32,"div",7),v(33),A(),D(34,"div",20)(35,"button",21),Gt("click",function(){return i.openExternalLink("https://discord.gg/c9tCWFtFaG")}),D(36,"span",22),v(37,"\u{1F5E8}\uFE0F"),A(),D(38,"div",23)(39,"div",24),v(40,"Discord Server"),A(),D(41,"div",25),v(42,"Share ideas & feedback"),A()()(),D(43,"button",26),Gt("click",function(){return i.openExternalLink("https://www.youtube.com/@jaerb1")}),D(44,"span",22),v(45,"\u25B6\uFE0F"),A(),D(46,"div",23)(47,"div",24),v(48,"YouTube"),A(),D(49,"div",25),v(50,"Dev logs & gameplay"),A()()()()()()()()),t&2&&(g(4),j(i.settings.t("SUPPORT_COMMUNITY")),g(8),j(i.settings.t("MONOBANK_JAR")),g(9),L(" ",i.settings.t("OPEN_LINK")," \u{1F4DC} "),g(2),L(" ",i.settings.t("COPY_LINK")," \u{1F4CB} "),g(7),j(i.settings.t("THANK_SUPPORTING")),g(3),j(i.settings.t("SOCIAL_FEEDBACK")))},dependencies:[Nt],encapsulation:2})};function M$(n,e){if(n&1){let t=je();y(0,"button",7),X("click",function(){Z(t);let r=N();return ee(r.switchToMyStats())}),v(1," My Statistics "),_()}if(n&2){let t=N();Te("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function R$(n,e){n&1&&(y(0,"div",15)(1,"span",16),W(2,"span",17),y(3,"span"),v(4,"Loading..."),_()()())}function k$(n,e){if(n&1&&W(0,"img",27),n&2){let t=N().$implicit;Se("src",t.userPhoto,er)}}function N$(n,e){n&1&&(y(0,"div",28),v(1,"\u{1F464}"),_())}function P$(n,e){if(n&1&&(y(0,"tr",22)(1,"td",23),v(2),_(),y(3,"td",24),Ut(4,k$,1,1,"img",25)(5,N$,2,0,"ng-template",null,0,ho),v(7),_(),y(8,"td",23),v(9),_(),y(10,"td",26),v(11),_()()),n&2){let t=e.$implicit,i=e.index,r=tr(6),o=N(3);Te("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),g(2),j(i+1),g(2),Se("ngIf",t.userPhoto)("ngIfElse",r),g(3),L(" ",t.playerName," "),g(2),j(t.victoryType),g(2),j(t.turnsPlayed)}}function O$(n,e){if(n&1&&(y(0,"tr")(1,"td",29),v(2),W(3,"br"),y(4,"span",30),v(5,"Be the first to claim victory!"),_()()()),n&2){let t=N(3);g(2),Rt(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function F$(n,e){if(n&1&&(y(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),v(5,"Rank"),_(),y(6,"th",20),v(7,"Name"),_(),y(8,"th",20),v(9,"Victory Type"),_(),y(10,"th",20),v(11,"Turns"),_()()(),y(12,"tbody"),Ut(13,P$,12,12,"tr",21)(14,O$,6,2,"tr",9),_()()()),n&2){let t=N(2);g(13),Se("ngForOf",t.scores()),g(),Se("ngIf",t.scores().length===0)}}function L$(n,e){if(n&1&&(y(0,"div")(1,"div",11)(2,"span"),v(3,"Top 10 scores for:"),_(),y(4,"span",12),v(5),_(),y(6,"span",13),v(7),_()(),Ut(8,R$,5,0,"div",14)(9,F$,15,2,"div",9),_()),n&2){let t=N();g(5),L(" ",t.settings.difficultyLabel()," "),g(2),L(" ",t.settings.mapSizeLabel()," "),g(),Se("ngIf",t.loading()),g(),Se("ngIf",!t.loading())}}function V$(n,e){n&1&&(y(0,"div",15)(1,"span",16),W(2,"span",17),y(3,"span"),v(4,"Loading your stats..."),_()()())}function U$(n,e){n&1&&(y(0,"div",35),v(1," No victories recorded yet. keep playing! "),_())}function B$(n,e){if(n&1&&(y(0,"div",36)(1,"div",37)(2,"span",38),v(3),_(),y(4,"span",39),v(5),_()(),y(6,"div",40)(7,"span",41),v(8,"Best Performance"),_(),y(9,"span",42),v(10),_()(),y(11,"div",43),v(12),Xn(13,"date"),_()()),n&2){let t=e.$implicit;g(3),L(" ",t.difficulty," "),g(2),L(" ",t.mapSize," "),g(5),L("",t.turnsPlayed," Turns"),g(2),Rt(" ",t.victoryType," \u2022 ",ir(13,5,t.timestamp,"mediumDate")," ")}}function j$(n,e){if(n&1&&(y(0,"div",32),Ut(1,U$,2,0,"div",33)(2,B$,14,8,"div",34),_()),n&2){let t=N(2);g(),Se("ngIf",t.myBestScores().length===0),g(),Se("ngForOf",t.myBestScores())}}function H$(n,e){if(n&1&&(y(0,"div",22),Ut(1,V$,5,0,"div",14)(2,j$,3,2,"div",31),_()),n&2){let t=N();g(),Se("ngIf",t.loading()),g(),Se("ngIf",!t.loading())}}var y0=class n{constructor(e,t,i,r){this.firebase=e;this.gameEngine=t;this.playerName=i;this.settings=r;this.fetch()}loading=$(!0);scores=$([]);activeTab=$("top10");myBestScores=$([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),i=await this.firebase.getTopScores(10,e,t);this.scores.set(i??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),i=new Map;t.forEach(r=>{let o=`${r.difficulty}-${r.mapSize}`;(!i.has(o)||r.turnsPlayed<i.get(o).turnsPlayed)&&i.set(o,r)}),this.myBestScores.set(Array.from(i.values()).sort((r,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[r.difficulty];return a!==0?a:r.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(he(Rn),he($n),he(Ic),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,i){t&1&&(y(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),v(4,"Leaderboard"),_(),y(5,"button",5),X("click",function(){return i.gameEngine.closeLeaderboard()}),v(6," \u2716 "),_()(),y(7,"div",6)(8,"button",7),X("click",function(){return i.activeTab.set("top10")}),v(9," Top 10 "),_(),Ut(10,M$,2,6,"button",8),_(),Ut(11,L$,10,4,"div",9)(12,H$,3,2,"div",10),_()()),t&2&&(g(8),Te("text-white",i.activeTab()==="top10")("border-b-2",i.activeTab()==="top10")("border-indigo-500",i.activeTab()==="top10"),g(2),Se("ngIf",i.firebase.user$()),g(),Se("ngIf",i.activeTab()==="top10"),g(),Se("ngIf",i.activeTab()==="mystats"))},dependencies:[Nt,ps,go,_a],encapsulation:2})};function G$(n,e){if(n&1&&(ie(),D(0,"text",4),v(1),A()),n&2){let t=N(2);g(),L(" ",t.unit.level," ")}}function $$(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function z$(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function W$(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function q$(n,e){n&1&&(ie(),G(0,"circle",7))}function K$(n,e){n&1&&(ie(),G(0,"circle",8))}function Y$(n,e){n&1&&(ie(),G(0,"circle",9))}function Q$(n,e){if(n&1&&(ie(),D(0,"svg",0),G(1,"circle",2)(2,"circle",3),Y(3,G$,2,1,":svg:text",4),Y(4,$$,3,0,":svg:g"),Y(5,z$,4,0,":svg:g",5),Y(6,W$,3,0,":svg:g",6),Y(7,q$,1,0,":svg:circle",7),Y(8,K$,1,0,":svg:circle",8),Y(9,Y$,1,0,":svg:circle",9),A()),n&2){let t=N();g(),Bt("fill","url(#vol-fill-"+t.unit.owner+")"),g(2),Q(t.isTower?-1:3),g(),Q(t.gameEngine.hasDefenseBonus(t.unit)&&!t.isTower?4:-1),g(),Q(t.unit.hasWeapon?5:-1),g(),Q(t.unit.hasArmor?6:-1),g(),Q(t.unit.level>=2?7:-1),g(),Q(t.unit.level>=3?8:-1),g(),Q(t.unit.level>=4?9:-1)}}function J$(n,e){if(n&1&&(ie(),D(0,"text",20),v(1),A()),n&2){let t=N(2);g(),L(" ",t.unit.level," ")}}function X$(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function Z$(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function ez(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function tz(n,e){n&1&&(ie(),G(0,"polygon",21))}function nz(n,e){n&1&&(ie(),G(0,"polygon",22))}function iz(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",23)(2,"polygon",24)(3,"polygon",25),A())}function rz(n,e){if(n&1&&(ie(),D(0,"svg",1)(1,"g",17),G(2,"polygon",18)(3,"polygon",19),Y(4,J$,2,1,":svg:text",20),Y(5,X$,3,0,":svg:g"),Y(6,Z$,4,0,":svg:g",5),Y(7,ez,3,0,":svg:g",6),Y(8,tz,1,0,":svg:polygon",21),Y(9,nz,1,0,":svg:polygon",22),Y(10,iz,4,0,":svg:g"),A()()),n&2){let t=N();g(2),Bt("fill","url(#vol-fill-"+t.unit.owner+")"),g(2),Q(t.isTower?-1:4),g(),Q(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),g(),Q(t.unit.hasWeapon?6:-1),g(),Q(t.unit.hasArmor?7:-1),g(),Q(t.unit.level>=2?8:-1),g(),Q(t.unit.level>=3?9:-1),g(),Q(t.unit.level>=4?10:-1)}}function oz(n,e){if(n&1&&(ie(),D(0,"text",28),v(1),A()),n&2){let t=N(2);g(),L(" ",t.unit.level," ")}}function sz(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function az(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function lz(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function cz(n,e){n&1&&(ie(),G(0,"rect",29))}function uz(n,e){n&1&&(ie(),G(0,"rect",30))}function dz(n,e){n&1&&(ie(),G(0,"rect",31)(1,"rect",32)(2,"rect",33)(3,"rect",34))}function hz(n,e){if(n&1&&(ie(),D(0,"svg",0),G(1,"rect",26)(2,"rect",27),Y(3,oz,2,1,":svg:text",28),Y(4,sz,3,0,":svg:g"),Y(5,az,4,0,":svg:g",5),Y(6,lz,3,0,":svg:g",6),Y(7,cz,1,0,":svg:rect",29),Y(8,uz,1,0,":svg:rect",30),Y(9,dz,4,0),A()),n&2){let t=N();g(),Bt("fill","url(#vol-fill-"+t.unit.owner+")"),g(2),Q(t.isTower?-1:3),g(),Q(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),g(),Q(t.unit.hasWeapon?5:-1),g(),Q(t.unit.hasArmor?6:-1),g(),Q(t.unit.level>=2?7:-1),g(),Q(t.unit.level>=3?8:-1),g(),Q(t.unit.level>=4?9:-1)}}function fz(n,e){if(n&1&&(ie(),D(0,"text",37),v(1),A()),n&2){let t=N(2);g(),L(" ",t.unit.level," ")}}function pz(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function gz(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function mz(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function yz(n,e){n&1&&(ie(),G(0,"polygon",38))}function vz(n,e){n&1&&(ie(),G(0,"polygon",39))}function _z(n,e){n&1&&(ie(),G(0,"circle",40)(1,"circle",41)(2,"circle",42)(3,"circle",43)(4,"circle",44)(5,"circle",45))}function Ez(n,e){if(n&1&&(ie(),D(0,"svg",0),G(1,"polygon",35)(2,"polygon",36),Y(3,fz,2,1,":svg:text",37),Y(4,pz,3,0,":svg:g"),Y(5,gz,4,0,":svg:g",5),Y(6,mz,3,0,":svg:g",6),Y(7,yz,1,0,":svg:polygon",38),Y(8,vz,1,0,":svg:polygon",39),Y(9,_z,6,0),A()),n&2){let t=N();g(),Bt("fill","url(#vol-fill-"+t.unit.owner+")"),g(2),Q(t.isTower?-1:3),g(),Q(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),g(),Q(t.unit.hasWeapon?5:-1),g(),Q(t.unit.hasArmor?6:-1),g(),Q(t.unit.level>=2?7:-1),g(),Q(t.unit.level>=3?8:-1),g(),Q(t.unit.level>=4?9:-1)}}var v0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}unit;isTower=!1;static \u0275fac=function(t){return new(t||n)(he($n),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-units"]],inputs:{unit:"unit",isTower:"isTower"},decls:4,vars:1,consts:[["viewBox","0 0 100 100",1,"w-full","h-full"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-95"],["cx","50","cy","50","r","32","filter","url(#soft-shadow)"],["cx","50","cy","50","r","31","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","61","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["transform","rotate(-45 30 14)"],["transform","translate(16, 2)"],["cx","50","cy","50","r","35","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["cx","50","cy","50","r","40","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["cx","50","cy","50","r","28","fill","none","stroke","var(--u-light)","stroke-width","2"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","var(--u-light)","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],["x","5","y","0","width","2","height","10","fill","var(--u-light)"],["points","6,-2 8,2 4,2","fill","var(--u-light)"],["x","3","y","10","width","6","height","2","fill","var(--u-fill)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","var(--u-light)"],["d","M5 3V8M3 5H9","stroke","var(--u-fill)","stroke-width","1.2","stroke-linecap","round","opacity","0.7"],["transform","translate(0, 4)"],["points","50,16 86,78 14,78","filter","url(#soft-shadow)"],["points","50,18 82,74 18,74","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","50","y","68","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2","stroke-linejoin","round"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["points","50,0 56,10 44,10","fill","var(--u-light)","stroke-linejoin","round"],["points","99,87 92,74 84,87","fill","var(--u-light)","stroke-linejoin","round"],["points","1,87 15,87 8,74","fill","var(--u-light)","stroke-linejoin","round"],["x","21","y","21","width","56","height","56","rx","6","filter","url(#soft-shadow)"],["x","23","y","23","width","52","height","52","rx","5","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","60","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["x","18","y","18","width","62","height","62","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","14","y","14","width","70","height","70","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["x","12","y","12","width","8","height","8","fill","var(--u-light)"],["x","78","y","12","width","8","height","8","fill","var(--u-light)"],["x","12","y","78","width","8","height","8","fill","var(--u-light)"],["x","78","y","78","width","8","height","8","fill","var(--u-light)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","filter","url(#soft-shadow)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","fill","none","stroke","var(--u-light)","stroke-width","2","opacity","0.4"],["x","49","y","62","text-anchor","middle","font-size","28","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,17 81,35 81,65 50,83 19,65 19,35","fill","none","stroke","var(--u-core)","stroke-width","1.5","stroke-linejoin","round"],["points","50,12 86,32 86,68 50,88 14,68 14,32","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["cx","50","cy","12","r","3","fill","var(--u-light)"],["cx","86","cy","32","r","3","fill","var(--u-light)"],["cx","86","cy","68","r","3","fill","var(--u-light)"],["cx","50","cy","88","r","3","fill","var(--u-light)"],["cx","14","cy","68","r","3","fill","var(--u-light)"],["cx","14","cy","32","r","3","fill","var(--u-light)"]],template:function(t,i){if(t&1&&Y(0,Q$,10,8,":svg:svg",0)(1,rz,11,8,":svg:svg",1)(2,hz,10,8,":svg:svg",0)(3,Ez,10,8,":svg:svg",0),t&2){let r;Q((r=i.unit.tier)===1?0:r===2?1:r===3?2:r===4?3:-1)}},dependencies:[Nt],encapsulation:2})};function bz(n,e){if(n&1){let t=je();D(0,"div",7)(1,"div",8),v(2),A(),D(3,"button",9),Gt("click",function(){Z(t);let r=N();return ee(r.gameEngine.cancelSandboxSpawn())}),v(4),A()()}if(n&2){let t=N();g(2),L(" ",t.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u0438":"Click an empty tile to spawn"," "),g(2),L(" ",t.settings.currentLang()==="uk"?"\u0412\u0456\u0434\u043C\u0456\u043D\u0430":"Cancel"," ")}}var _0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(he($n),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-sandbox"]],decls:24,vars:3,consts:[[1,"absolute","-top-7","left-[-10px]","ml-2","px-3","py-1","rounded-full","bg-pink-600/20","border","border-pink-500/30","text-pink-200","text-[10px]","font-black","uppercase","tracking-widest"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-28","right-[-254px]","min-w-[238px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"mt-2","flex","flex-col","gap-2","w-full","px-2","py-2","rounded-lg","border","border-white/5","bg-white/5"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-pink-200"],[1,"grid","grid-cols-4","gap-2"],[1,"px-2","py-1","rounded","bg-blue-600/20","border","border-blue-500/30","text-blue-100","text-[10px]","cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","bg-red-600/20","border","border-red-500/30","text-red-100","text-[10px]","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-[10px]","text-gray-300"],[1,"px-2","py-1","rounded","bg-gray-700","hover:bg-gray-600","border","border-gray-600","text-white","text-[10px]","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(D(0,"div",0),v(1),A(),D(2,"div",1)(3,"div",2)(4,"div",3),v(5),A(),D(6,"div",4)(7,"button",5),Gt("click",function(){return i.gameEngine.startSandboxSpawn("player",1)}),v(8," T1 "),A(),D(9,"button",5),Gt("click",function(){return i.gameEngine.startSandboxSpawn("player",2)}),v(10," T2 "),A(),D(11,"button",5),Gt("click",function(){return i.gameEngine.startSandboxSpawn("player",3)}),v(12," T3 "),A(),D(13,"button",5),Gt("click",function(){return i.gameEngine.startSandboxSpawn("player",4)}),v(14," T4 "),A(),D(15,"button",6),Gt("click",function(){return i.gameEngine.startSandboxSpawn("ai",1)}),v(16," T1 "),A(),D(17,"button",6),Gt("click",function(){return i.gameEngine.startSandboxSpawn("ai",2)}),v(18," T2 "),A(),D(19,"button",6),Gt("click",function(){return i.gameEngine.startSandboxSpawn("ai",3)}),v(20," T3 "),A(),D(21,"button",6),Gt("click",function(){return i.gameEngine.startSandboxSpawn("ai",4)}),v(22," T4 "),A()(),Y(23,bz,5,2,"div",7),A()()),t&2&&(g(),L(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox",`
`),g(4),L(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox"," "),g(18),Q(i.gameEngine.sandboxSpawnPending()?23:-1))},dependencies:[Nt],encapsulation:2})};var wz=["boardContainer"],Dt=(n,e)=>({x:n,y:e}),xz=()=>[10,20,30],Sz=(n,e)=>e.id,sO=(n,e)=>e.date;function Iz(n,e){if(n&1){let t=je();y(0,"div",82)(1,"div",233)(2,"span",234),v(3),_(),y(4,"button",235),X("click",function(){Z(t);let r=N();return ee(r.firebase.logout())}),v(5),_()(),y(6,"div",236),W(7,"img",237)(8,"div",238),_()()}if(n&2){let t=N();g(3),L(" ",t.settings.t("VERIFIED")," "),g(2),L(" ",t.settings.t("LOGOUT")," "),g(2),Se("src",e.photoURL,er)}}function Tz(n,e){if(n&1){let t=je();y(0,"button",239),X("click",function(){Z(t);let r=N();return ee(r.firebase.loginWithGoogle())}),W(1,"div",240),y(2,"span",241),v(3),_()()}if(n&2){let t=N();g(3),L(" ",t.settings.t("CONNECT")," ")}}function Cz(n,e){if(n&1){let t=je();y(0,"div",82)(1,"div",233)(2,"span",234),v(3),_(),y(4,"button",235),X("click",function(){Z(t);let r=N(2);return ee(r.firebase.logout())}),v(5),_()(),y(6,"div",236),W(7,"img",237)(8,"div",238),_()(),y(9,"button",197),X("click",function(){Z(t);let r=N(2);return ee(r.toggleAutoBattle())}),y(10,"div",198)(11,"span",199),v(12),_(),y(13,"span",200),v(14),_()(),y(15,"div",198),W(16,"span",201),_(),W(17,"div",202),_()}if(n&2){let t=N(2);g(3),L(" ",t.settings.t("VERIFIED")," "),g(2),L(" ",t.settings.t("LOGOUT")," "),g(2),Se("src",e.photoURL,er),g(2),Te("ring-2",t.isAutoBattleActive())("ring-green-400",t.isAutoBattleActive()),Se("disabled",t.gameEngine.gameStatus()!=="playing"),g(3),j(t.settings.t("AUTO")),g(2),j(t.settings.t("ENGAGE")),g(2),Te("bg-green-400",t.isAutoBattleActive())("bg-gray-500",!t.isAutoBattleActive())}}function Dz(n,e){if(n&1){let t=je();y(0,"button",239),X("click",function(){Z(t);let r=N(2);return ee(r.firebase.loginWithGoogle())}),W(1,"div",240),y(2,"span",241),v(3),_()()}if(n&2){let t=N(2);g(3),L(" ",t.settings.t("CONNECT")," ")}}function Az(n,e){if(n&1){let t=je();y(0,"div",119)(1,"div",242)(2,"button",243),X("click",function(){Z(t);let r=N();return ee(r.closeMobileMenu())}),ie(),y(3,"svg",103),W(4,"path",244),_()(),Oe(),y(5,"button",245),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.resetGame())}),v(6),_(),y(7,"button",245),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.toggleRules())}),v(8),_(),y(9,"button",245),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.toggleLeaderboard())}),v(10),_(),y(11,"button",245),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.toggleLog())}),v(12),_(),y(13,"button",245),X("click",function(){Z(t);let r=N();return ee(r.navigateToFeedback())}),v(14),_(),y(15,"button",245),X("click",function(){Z(t);let r=N();return ee(r.navigateToRoadmap())}),v(16),_(),y(17,"button",245),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.toggleSettings())}),v(18),_(),y(19,"button",245),X("click",function(){Z(t);let r=N();return ee(r.navigateToRoadmap())}),v(20),_(),Y(21,Cz,18,14)(22,Dz,4,1,"button",83),_()()}if(n&2){let t,i=N();g(6),j(i.settings.t("RELOAD")),g(2),j(i.settings.t("INFO")),g(2),j(i.settings.t("RANKING")),g(2),j(i.settings.t("SYSTEM_LOG")),g(2),j(i.settings.t("FEEDBACK_MODULE")),g(2),j(i.settings.t("STRATEGIC_PLAN")),g(2),j(i.settings.t("SETTINGS")),g(2),j(i.settings.t("STRATEGIC_PLAN")),g(),Q((t=i.firebase.user$())?21:22,t)}}function Mz(n,e){if(n&1&&(y(0,"div",161),v(1),_()),n&2){let t=N();g(),ds(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function Rz(n,e){if(n&1&&(y(0,"div",248),v(1),_()),n&2){let t=N(2);g(),j(t.gameEngine.endReason())}}function kz(n,e){if(n&1){let t=je();y(0,"div",249)(1,"div",252),v(2),_(),W(3,"input",253,1),y(5,"button",254),X("click",function(){Z(t);let r=tr(4),o=N(2);return ee(o.gameEngine.confirmAndSaveScore(r.value))}),v(6),_()()}if(n&2){let t=N(2);g(2),j(t.settings.t("CONFIRM_NAME")),g(),Se("value",t.gameEngine.getPlayerName()),g(3),L(" ",t.settings.t("SAVE_SCORE")," ")}}function Nz(n,e){if(n&1){let t=je();y(0,"div",169)(1,"div",246)(2,"h2",247),v(3),Xn(4,"titlecase"),_(),Y(5,Rz,2,1,"div",248),Y(6,kz,7,3,"div",249),y(7,"button",250),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.resetGame())}),v(8),_()(),y(9,"button",251),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.toggleLeaderboard())}),v(10),_()()}if(n&2){let t=N();g(2),Te("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),g(),L(" ",Pl(4,9,t.gameEngine.gameStatus()),"! "),g(2),Q(t.gameEngine.endReason()?5:-1),g(),Q(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),g(2),L(" ",t.settings.t("PLAY_AGAIN")," "),g(2),L(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function Pz(n,e){n&1&&W(0,"app-support-community")}function Oz(n,e){n&1&&W(0,"app-leaderboard-modal")}function Fz(n,e){n&1&&W(0,"app-sandbox")}function Lz(n,e){if(n&1&&(y(0,"div",184)(1,"span",255),v(2),_()()),n&2){let t=N();g(2),L(" ",t.gameEngine.baseHealth().ai," ")}}function Vz(n,e){n&1&&(y(0,"span",267),v(1," \u{1F92C} "),_()),n&2&&Je("z-index",100)}function Uz(n,e){n&1&&(y(0,"span",267),v(1," \u{1F620} "),_()),n&2&&Je("z-index",100)}function Bz(n,e){if(n&1&&Y(0,Vz,2,2,"span",266)(1,Uz,2,2,"span",266),n&2){let t=N(3);Q(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function jz(n,e){n&1&&W(0,"div",259)}function Hz(n,e){if(n&1){let t=je();y(0,"button",268),X("click",function(){Z(t);let r=N().$implicit,o=N().$implicit,s=N();return ee(s.gameEngine.buildForgeAt({x:r,y:o}))}),v(1," Build Forge "),_()}n&2&&Je("z-index",60)}function Gz(n,e){if(n&1&&(y(0,"span",269),v(1),_()),n&2){let t=N().$implicit,i=N().$implicit,r=N();Je("z-index",55),g(),L(" ",r.gameEngine.getForgeProgress(t,i),"% ")}}function $z(n,e){n&1&&(y(0,"span",273),ie(),y(1,"svg",274)(2,"g",275),W(3,"rect",276)(4,"rect",277)(5,"path",278)(6,"rect",279)(7,"rect",280),_()()()),n&2&&Je("z-index",50)}function zz(n,e){if(n&1){let t=je();y(0,"button",284),X("click",function(){Z(t),N(3);let r=nr(5),o=N(2);return ee(o.gameEngine.buyWeapon(r.id))}),v(1," Weapon "),_()}}function Wz(n,e){if(n&1){let t=je();y(0,"button",285),X("click",function(){Z(t),N(3);let r=nr(5),o=N(2);return ee(o.gameEngine.buyArmor(r.id))}),v(1," Armor "),_()}}function qz(n,e){if(n&1&&(y(0,"div",281),Y(1,zz,2,0,"button",282),Y(2,Wz,2,0,"button",283),_()),n&2){N(2);let t=nr(5),i=N(2);Je("z-index",60),g(),Q(!t.hasWeapon&&i.gameEngine.resources().iron>=20?1:-1),g(),Q(!t.hasArmor&&i.gameEngine.resources().iron>=20?2:-1)}}function Kz(n,e){if(n&1&&(y(0,"span",270),v(1," Forge "),_(),Y(2,$z,8,2,"span",271),Y(3,qz,3,4,"div",272)),n&2){let t=N().$implicit,i=nr(5),r=N().$implicit,o=N();Je("z-index",55),Te("scale-60",i&&i.owner==="player")("scale-50",i&&i.owner==="player")("top-1",!(i&&i.owner==="player"))("left-1",!(i&&i.owner==="player"))("top-0",i&&i.owner==="player")("-right-1",i&&i.owner==="player"),g(2),Q(o.gameEngine.isVisibleToPlayer(t,r)?2:-1),g(),Q(i&&i.owner==="player"?3:-1)}}function Yz(n,e){n&1&&(ie(),y(0,"g",291),W(1,"polygon",294)(2,"polygon",295),_())}function Qz(n,e){n&1&&(ie(),y(0,"g",296),W(1,"rect",297),_(),y(2,"g",298),W(3,"rect",299)(4,"path",300),_())}function Jz(n,e){if(n&1&&(y(0,"span",286),ie(),y(1,"svg",287)(2,"defs")(3,"linearGradient",288),W(4,"stop",289)(5,"stop",290),_()(),Y(6,Yz,3,0,":svg:g",291),y(7,"g"),W(8,"polygon",292)(9,"rect",293),_(),Y(10,Qz,5,0),_()()),n&2){N();let t=nr(5);Te("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),g(6),Q(t?-1:6),g(),Te("scale-90",t),g(3),Q(t?-1:10)}}function Xz(n,e){n&1&&(ie(),y(0,"g",304),W(1,"rect",305)(2,"path",306),_())}function Zz(n,e){if(n&1&&(y(0,"span",286),ie(),y(1,"svg",287)(2,"g"),W(3,"ellipse",301)(4,"path",302)(5,"circle",303),_(),Y(6,Xz,3,0,":svg:g",304),_()()),n&2){N();let t=nr(5);Te("scale-50",t)("opacity-40",t)("-translate-x-4",t)("translate-y-4",t),g(6),Q(t?-1:6)}}function eW(n,e){n&1&&W(0,"div",307),n&2&&Je("height",2,"px")}function tW(n,e){if(n&1&&(y(0,"span",308),v(1),_(),y(2,"span",309),v(3),_()),n&2){let t=N(3);g(),L(" ",t.gameEngine.baseHealth().player," "),g(2),L(" ",t.gameEngine.reservePoints().player," ")}}function nW(n,e){if(n&1&&(y(0,"span",310),v(1),_(),y(2,"span",311),v(3),_()),n&2){let t=N(4);g(),L(" ",t.gameEngine.baseHealth().ai," "),g(2),L(" ",t.gameEngine.reservePoints().ai," ")}}function iW(n,e){if(n&1&&Y(0,nW,4,2),n&2){let t=N().$implicit,i=N().$implicit,r=N();Q(r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function rW(n,e){n&1&&(ie(),y(0,"svg",317),W(1,"path",318),_())}function oW(n,e){n&1&&(ie(),y(0,"svg",317),W(1,"path",319),_())}function sW(n,e){if(n&1){let t=je();y(0,"button",316),X("click",function(r){Z(t);let o=N(2),s=N(2).$implicit,a=N().$implicit,l=N();return ee(o.owner==="player"?l.onDestroyIconClick(r,s,a,s+1,a):l.onAttackIconClick(r,s,a,s+1,a))}),Y(1,rW,2,0,":svg:svg",317)(2,oW,2,0,":svg:svg",317),_()}if(n&2){let t=N(2),i=N(4);Je("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Te("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),g(),Q(t.owner==="player"?1:2)}}function aW(n,e){if(n&1){let t=je();y(0,"div",314),X("mouseenter",function(){Z(t);let r=N(),o=N(4);return ee(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){Z(t);let r=N(5);return ee(r.gameEngine.hoverFormationById(null))}),Y(1,sW,3,13,"button",315),_()}if(n&2){let t=N(),i=N(2).$implicit,r=N().$implicit,o=N();Je("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","height 0.25s ease-out"),Te("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Bt("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),g(),Q(o.gameEngine.canShowAttackIcon(Et(26,Dt,i,r),Et(29,Dt,i+1,r))?1:-1)}}function lW(n,e){if(n&1&&Y(0,aW,2,32,"div",313),n&2){let t=N(2).$implicit,i=N().$implicit,r=N();Q(r.gameEngine.shouldRenderWall(Et(1,Dt,t,i),Et(4,Dt,t+1,i),e.owner)?0:-1)}}function cW(n,e){if(n&1){let t=je();y(0,"button",323),X("click",function(r){Z(t);let o=N(3).$implicit,s=N().$implicit,a=N();return ee(a.onBuildIconClick(r,o,s,o+1,s))}),v(1," \u2714 "),_()}if(n&2){let t=N(5);Je("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function uW(n,e){if(n&1&&(y(0,"span",322),v(1),_()),n&2){let t=N(3).$implicit,i=N().$implicit,r=N();g(),Rt(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(Et(2,Dt,t,i),Et(5,Dt,t+1,i))," ")}}function dW(n,e){if(n&1&&(y(0,"div",320),Y(1,cW,2,8,"button",321),Y(2,uW,2,8,"span",322),_()),n&2){let t=N(2).$implicit,i=N().$implicit,r=N();Je("right",-r.gameEngine.wallThicknessPx-2,"px")("width",r.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Te("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(Et(16,Dt,t,i),Et(19,Dt,t+1,i)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(Et(22,Dt,t,i),Et(25,Dt,t+1,i))),g(),Q(r.gameEngine.canShowBuildIcon(Et(28,Dt,t,i),Et(31,Dt,t+1,i))?1:-1),g(),Q(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t+1,i))&&r.gameEngine.edgeCooldownRemaining(Et(34,Dt,t,i),Et(37,Dt,t+1,i))>0?2:-1)}}function hW(n,e){if(n&1&&Y(0,lW,1,7)(1,dW,3,40,"div",312),n&2){let t,i=N().$implicit,r=N().$implicit,o=N();Q((t=o.gameEngine.getWallBetween(i,r,i+1,r))?0:1,t)}}function fW(n,e){n&1&&(ie(),y(0,"svg",317),W(1,"path",318),_())}function pW(n,e){n&1&&(ie(),y(0,"svg",317),W(1,"path",319),_())}function gW(n,e){if(n&1){let t=je();y(0,"button",316),X("click",function(r){Z(t);let o=N(2),s=N(2).$implicit,a=N().$implicit,l=N();return ee(o.owner==="player"?l.onDestroyIconClick(r,s,a,s,a+1):l.onAttackIconClick(r,s,a,s,a+1))}),Y(1,fW,2,0,":svg:svg",317)(2,pW,2,0,":svg:svg",317),_()}if(n&2){let t=N(2),i=N(4);Je("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Te("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),g(),Q(t.owner==="player"?1:2)}}function mW(n,e){if(n&1){let t=je();y(0,"div",326),X("mouseenter",function(){Z(t);let r=N(),o=N(4);return ee(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){Z(t);let r=N(5);return ee(r.gameEngine.hoverFormationById(null))}),Y(1,gW,3,13,"button",315),_()}if(n&2){let t=N(),i=N(2).$implicit,r=N().$implicit,o=N();Je("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","width 0.25s ease-out"),Te("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Bt("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),g(),Q(o.gameEngine.canShowAttackIcon(Et(26,Dt,i,r),Et(29,Dt,i,r+1))?1:-1)}}function yW(n,e){if(n&1&&Y(0,mW,2,32,"div",325),n&2){let t=N(2).$implicit,i=N().$implicit,r=N();Q(r.gameEngine.shouldRenderWall(Et(1,Dt,t,i),Et(4,Dt,t,i+1),e.owner)?0:-1)}}function vW(n,e){if(n&1){let t=je();y(0,"button",330),X("click",function(r){Z(t);let o=N(3).$implicit,s=N().$implicit,a=N();return ee(a.onBuildIconClick(r,o,s,o,s+1))}),v(1," \u2714 "),_()}if(n&2){let t=N(5);Je("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function _W(n,e){if(n&1&&(y(0,"span",329),v(1),_()),n&2){let t=N(3).$implicit,i=N().$implicit,r=N();g(),Rt(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(Et(2,Dt,t,i),Et(5,Dt,t,i+1))," ")}}function EW(n,e){if(n&1&&(y(0,"div",327),Y(1,vW,2,8,"button",328),Y(2,_W,2,8,"span",329),_()),n&2){let t=N(2).$implicit,i=N().$implicit,r=N();Je("bottom",-r.gameEngine.wallThicknessPx-2,"px")("height",r.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Te("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(Et(16,Dt,t,i),Et(19,Dt,t,i+1)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(Et(22,Dt,t,i),Et(25,Dt,t,i+1))),g(),Q(r.gameEngine.canShowBuildIcon(Et(28,Dt,t,i),Et(31,Dt,t,i+1))?1:-1),g(),Q(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t,i+1))&&r.gameEngine.edgeCooldownRemaining(Et(34,Dt,t,i),Et(37,Dt,t,i+1))>0?2:-1)}}function bW(n,e){if(n&1&&Y(0,yW,1,7)(1,EW,3,40,"div",324),n&2){let t,i=N().$implicit,r=N().$implicit,o=N();Q((t=o.gameEngine.getWallBetween(i,r,i,r+1))?0:1,t)}}function wW(n,e){if(n&1&&W(0,"app-units",334),n&2){let t=N(3);Se("unit",t)}}function xW(n,e){if(n&1&&(y(0,"span",338),v(1),_()),n&2){let t=e;Je("z-index",200),Te("bg-green-600",t.bg==="bg-green-600")("bg-amber-600",t.bg==="bg-amber-600")("bg-red-600",t.bg==="bg-red-600"),g(),L(" ",t.chance,"% ")}}function SW(n,e){n&1&&(y(0,"span",339),v(1," \u{1F333} "),_()),n&2&&Je("z-index",100)}function IW(n,e){n&1&&(y(0,"span",340),v(1," \u{1F331} "),_()),n&2&&Je("z-index",100)}function TW(n,e){n&1&&(y(0,"span",340),v(1," \u{1F33F} "),_()),n&2&&Je("z-index",100)}function CW(n,e){n&1&&(y(0,"span",343),v(1," \u{1F9F1} "),_()),n&2&&Je("z-index",100)}function DW(n,e){n&1&&(y(0,"span",342),v(1,"\u26F0\uFE0F"),_())}function AW(n,e){n&1&&(y(0,"span",342),v(1,"\u26CF\uFE0F"),_())}function MW(n,e){n&1&&(y(0,"span",342),v(1,"\u26CF"),_())}function RW(n,e){n&1&&(y(0,"span",342),v(1,"\u2692"),_())}function kW(n,e){if(n&1&&Y(0,CW,2,2,"span",341)(1,DW,2,0,"span",342)(2,AW,2,0,"span",342)(3,MW,2,0,"span",342)(4,RW,2,0,"span",342),n&2){let t=N(3);Q((t.mineOccupationTurns??0)>=5?0:(t.mineOccupationTurns??0)===1?1:(t.mineOccupationTurns??0)===2?2:(t.mineOccupationTurns??0)===3?3:(t.mineOccupationTurns??0)>3?4:-1)}}function NW(n,e){if(n&1&&(y(0,"div",332)(1,"div",333),Y(2,wW,1,1,"app-units",334),_(),Y(3,xW,2,9,"span",335),Y(4,SW,2,2,"span",336)(5,IW,2,2,"span",337)(6,TW,2,2,"span",337),Y(7,kW,5,1),_()),n&2){let t,i=N(2),r=N(3);Je("transform",r.gameEngine.getCombinedTransform(i.id))("z-index",r.gameEngine.isUnitMoving(i.id)||r.gameEngine.isUnitAttacking(i.id)?200:null),Te("shake",r.gameEngine.isUnitShaking(i.id)),g(),Je("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px"),Te("theme-player",i.owner==="player")("theme-ai",i.owner==="ai")("fatigued",i.hasActed)("merge-anim",r.gameEngine.lastMergedUnitId()===i.id)("ring",r.gameEngine.selectedUnitId()===i.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===i.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===i.id)("scale-115",r.gameEngine.selectedUnitId()===i.id&&!r.gameEngine.buildMode())("scale-120",r.gameEngine.lastMergedUnitId()===i.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===i.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===i.id)("pulse-glow",r.gameEngine.pulseUnitId()===i.id),Bt("title",r.gameEngine.formatHoverInfo(i.id)),g(),Q(i?2:-1),g(),Q((t=r.gameEngine.isUnitHovered(i.id)&&r.gameEngine.getHitChanceInfo(i.id))?3:-1,t),g(),Q(i.productionActive?4:(i.forestOccupationTurns??0)===1?5:(i.forestOccupationTurns??0)>1?6:-1),g(3),Q(r.gameEngine.isMine(i.position.x,i.position.y)?7:-1)}}function PW(n,e){if(n&1&&Y(0,NW,8,41,"div",331),n&2){let t=N(2).$implicit,i=N().$implicit,r=N();Q(!(t===0&&i===0)&&!(t===r.gameEngine.gridSize-1&&i===r.gameEngine.gridSize-1)?0:-1)}}function OW(n,e){if(n&1&&Y(0,PW,1,1),n&2){let t=N().$implicit,i=N().$implicit,r=N();Q(e.owner==="player"||r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function FW(n,e){if(n&1&&(y(0,"div",344)(1,"span",345),v(2),_()()),n&2){let t=e.$implicit,i=N(3);Je("z-index",100)("opacity",t.opacity),g(),Te("text-xs",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-base",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text))("text-yellow-300",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-yellow-400",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text)),g(),L(" ",t.text," ")}}function LW(n,e){if(n&1){let t=je();y(0,"div",257),X("click",function(){let r=Z(t).$implicit,o=N().$implicit,s=N();return ee(s.onTileClick(r,o))})("mouseenter",function(){let r=Z(t).$implicit,o=N().$implicit,s=N();return ee(s.gameEngine.setHoveredUnit(s.gameEngine.getUnitAt(r,o)&&(s.gameEngine.getUnitAt(r,o).owner==="player"||s.gameEngine.isVisibleToPlayer(r,o))?s.gameEngine.getUnitAt(r,o).id:null))})("mouseleave",function(){Z(t);let r=N(2);return ee(r.gameEngine.setHoveredUnit(null))}),y(1,"span",258),v(2),_(),Y(3,Bz,2,1),Y(4,jz,1,0,"div",259),ga(5),Y(6,Hz,2,2,"button",260),Y(7,Gz,2,3,"span",261),Y(8,Kz,4,16),Y(9,Jz,11,12,"span",262),Y(10,Zz,7,9,"span",263),Y(11,eW,1,2,"div",264),Y(12,tW,4,2),Y(13,iW,1,1),Y(14,hW,2,1),Y(15,bW,2,1),Y(16,OW,1,1),_n(17,FW,3,13,"div",265,Sz),_()}if(n&2){let t,i=e.$implicit,r=N().$implicit,o=N();Je("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Te("cursor-pointer",o.gameEngine.isValidMove(i,r))("bg-gray-700",!o.gameEngine.isValidMove(i,r))("border-gray-600",!o.gameEngine.isValidMove(i,r))("bg-blue-900",i===0&&r===0)("bg-red-900",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-4",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-blue-400",i===0&&r===0)("border-red-400",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-2",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-blue-300",i===0&&r===0&&o.gameEngine.baseDeployActive())("ring-red-300",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&i<=2&&r<=2&&(i!==0||r!==0))("forest-area",o.gameEngine.isForest(i,r))("mine-area",o.gameEngine.isMine(i,r))("forge-area",o.gameEngine.isForge(i,r))("bg-amber-900",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(i,r))("border-gray-800",!o.gameEngine.isVisibleToPlayer(i,r))("bg-green-900",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("border-green-500",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("bg-cyan-900",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("border-cyan-500",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("animate-pulse",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("hover:bg-gray-600",!o.gameEngine.isValidMove(i,r))("hover:bg-green-800",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("hover:bg-cyan-800",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r)),Bt("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0456\u0437\u043D\u0430 \u0448\u0430\u0445\u0442\u0430: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +2 \u0437\u0430\u043B\u0456\u0437\u0430 \u0437\u0430 \u0445\u0456\u0434.":"Iron Mine: Requires 5 consecutive turns of occupation to activate. Once active, yields +2 Iron per turn.":null)("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u041B\u0456\u0441\u043E\u043F\u0438\u043B\u044C\u043D\u044F: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 2 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +8 \u0434\u0435\u0440\u0435\u0432\u0438\u043D\u0438 \u0437\u0430 \u0445\u0456\u0434.":"Sawmill: Requires 2 consecutive occupation turns to activate. Once activated, it gives +8 wood per turn.":null),g(2),Rt(" ",i,",",r," "),g(),Q(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(i,r)?3:-1),g(),Q(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(i,r)?4:-1),g(),Nl(o.gameEngine.getUnitAt(i,r)),g(),Q(o.gameEngine.buildMode()&&o.gameEngine.canBuildForgeAt(i,r)?6:-1),g(),Q(o.gameEngine.isForgeSite(i,r)?7:-1),g(),Q(o.gameEngine.isForge(i,r)?8:-1),g(),Q(o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?9:-1),g(),Q(o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?10:-1),g(),Q(o.gameEngine.isForest(i,r)&&o.gameEngine.getUnitAt(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?11:-1),g(),Q(i===0&&r===0?12:-1),g(),Q(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1?13:-1),g(),Q(i<o.gameEngine.gridSize-1?14:-1),g(),Q(r<o.gameEngine.gridSize-1?15:-1),g(),Q((t=o.gameEngine.getUnitAt(i,r))?16:-1,t),g(),En(o.gameEngine.getCombatTextEntriesAt(i,r))}}function VW(n,e){if(n&1&&_n(0,LW,19,80,"div",256,Nr),n&2){let t=N();En(t.gameEngine.gridCols)}}function UW(n,e){n&1&&W(0,"app-game-rules")}function BW(n,e){if(n&1&&(y(0,"div",361),v(1),_()),n&2){let t=N(2);g(),j(t.settings.t("NOT_LOGS_DATA"))}}function jW(n,e){if(n&1&&(y(0,"div",363)(1,"span",364),v(2),_()()),n&2){let t=e.$implicit;Je("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Te("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),g(),gE(t.color),g(),j(t.text)}}function HW(n,e){if(n&1){let t=je();y(0,"div",229)(1,"button",346),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.toggleLog())}),y(2,"span",347),v(3,"\u2715"),_()(),y(4,"div",348)(5,"div",349)(6,"h3",350),v(7),_(),y(8,"button",351),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.clearLogs())}),ie(),y(9,"svg",352),W(10,"path",353),_(),v(11),_()(),Oe(),y(12,"label",354)(13,"div",109)(14,"input",355),X("change",function(){Z(t);let r=N();return ee(r.gameEngine.toggleCombatOnly())}),_(),W(15,"div",356),ie(),y(16,"svg",357),W(17,"path",358),_()(),Oe(),y(18,"span",359),v(19),_()()(),y(20,"div",360),Y(21,BW,2,1,"div",361),_n(22,jW,3,7,"div",362,Bu),_()()}if(n&2){let t=N();g(7),L(" ",t.settings.t("Action_LOG")," "),g(4),L(" ",t.settings.t("CLEAR")," "),g(3),Se("checked",t.gameEngine.combatOnly()),g(5),L(" ",t.settings.t("COMBAT_ONLY")," "),g(2),Q(t.gameEngine.logsFiltered().length===0?21:-1),g(),En(t.gameEngine.logsFiltered().reverse())}}function GW(n,e){if(n&1){let t=je();y(0,"button",381),X("click",function(){let r=Z(t).$implicit,o=N(2);return ee(o.onDifficultyChange(r))}),y(1,"span",382),v(2),_(),v(3),_()}if(n&2){let t=e.$implicit,i=N(2);Te("bg-blue-500/20",i.settings.difficulty()===t)("border-blue-400/40",i.settings.difficulty()===t)("text-blue-200",i.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",i.settings.difficulty()===t)("bg-white/5",i.settings.difficulty()!==t)("border-white/5",i.settings.difficulty()!==t)("text-stone-500",i.settings.difficulty()!==t)("hover:bg-white/10",i.settings.difficulty()!==t),g(),Te("opacity-100",i.settings.difficulty()===t),g(),L(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),g(),L(" ",i.settings.t(i.settings.getDifficultyLabel(t))," ")}}function $W(n,e){if(n&1){let t=je();y(0,"button",383),X("click",function(){let r=Z(t).$implicit,o=N(2);return ee(o.onMapSizeChange(r))}),v(1),_()}if(n&2){let t=e.$implicit,i=N(2);Te("bg-gradient-to-br",i.settings.mapSize()===t)("from-indigo-600",i.settings.mapSize()===t)("to-indigo-800",i.settings.mapSize()===t)("text-white",i.settings.mapSize()===t)("shadow-lg",i.settings.mapSize()===t)("text-stone-500",i.settings.mapSize()!==t)("hover:text-stone-300",i.settings.mapSize()!==t),g(),Rt(" ",t,"x",t," ")}}function zW(n,e){if(n&1){let t=je();y(0,"div",230)(1,"div",365),W(2,"div",366),y(3,"h3",367),v(4),_(),y(5,"button",368),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.toggleSettings())}),v(6," \u2716 "),_()(),y(7,"div",369)(8,"div",190)(9,"label",370),v(10),_(),y(11,"span",371),v(12),_()(),y(13,"div",372),_n(14,GW,4,20,"button",373,Nr),_()(),y(16,"div",369)(17,"label",374),v(18),_(),y(19,"div",375),_n(20,$W,2,16,"button",376,Nr),_()(),y(22,"div",377)(23,"button",378),X("click",function(){Z(t);let r=N();return ee(r.settings.setLang("uk"))}),v(24," UA "),_(),y(25,"button",378),X("click",function(){Z(t);let r=N();return ee(r.settings.setLang("en"))}),v(26," EN "),_()(),y(27,"label",379)(28,"div",109)(29,"input",110),X("change",function(r){Z(t);let o=N();return ee(o.setCustomMode(r.target.checked))}),_(),y(30,"div",380),W(31,"div",112),_()(),y(32,"span",113),v(33,"Custom Mode"),_()()()}if(n&2){let t=N();g(4),j(t.settings.t("SYSTEM_SETTINGS")),g(6),L(" ",t.settings.t("TACTICAL_DIFF")," "),g(2),L(" ",t.settings.t("LEVEL_SELECTION")," "),g(2),En(t.settings.diffArr),g(4),L(" ",t.settings.t("SECTOR_DIMENSIONS")," "),g(2),En(ma(13,xz)),g(3),Te("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),g(2),Te("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en"),g(4),Se("checked",t.settings.customMode())}}function WW(n,e){if(n&1&&(y(0,"div",392)(1,"span"),v(2),Xn(3,"date"),_(),y(4,"span",396),v(5),_(),y(6,"span",397),v(7),_()()),n&2){let t=e.$implicit,i=N(2);g(2),j(ir(3,4,t.date,"yyyy-MM-dd HH:mm")),g(3),j(t.condition),g(2),Rt("",t.turns," ",i.settings.t("TURNS"))}}function qW(n,e){if(n&1&&(y(0,"div",393),v(1),_()),n&2){let t=N(2);g(),j(t.settings.t("NO_RECORDS_YET"))}}function KW(n,e){if(n&1&&(y(0,"div",392)(1,"span"),v(2),Xn(3,"date"),_(),y(4,"span",396),v(5),_(),y(6,"span",397),v(7),_()()),n&2){let t=e.$implicit,i=N(2);g(2),j(ir(3,4,t.date,"yyyy-MM-dd HH:mm")),g(3),j(t.condition),g(2),Rt("",t.turns," ",i.settings.t("TURNS"))}}function YW(n,e){if(n&1&&(y(0,"div",393),v(1),_()),n&2){let t=N(2);g(),j(t.settings.t("NO_RECORDS_YET"))}}function QW(n,e){if(n&1){let t=je();y(0,"div",231)(1,"div",384)(2,"div",385)(3,"h2",386),v(4),_(),y(5,"button",387),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.closeHighScores())}),v(6," \u2716 "),_()(),y(7,"div",388),v(8),_(),y(9,"div",389)(10,"div",390)(11,"h3",391),v(12),_(),_n(13,WW,8,7,"div",392,sO,!1,qW,2,1,"div",393),_(),y(16,"div",390)(17,"h3",394),v(18),_(),_n(19,KW,8,7,"div",392,sO,!1,YW,2,1,"div",393),_()(),y(22,"div",395),v(23),_()()()}if(n&2){let t=N();g(4),j(t.settings.t("HIGH_SCORES")),g(4),ds(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),g(4),j(t.settings.t("TOP_3_PLAYER")),g(),En(t.gameEngine.getHighScoresForCurrentCombo().wins),g(5),j(t.settings.t("TOP_3_LOSES_PLAYER")),g(),En(t.gameEngine.getHighScoresForCurrentCombo().losses),g(4),j(t.settings.t("CHANGE_RECORDS_INFO"))}}function JW(n,e){if(n&1){let t=je();y(0,"div",232)(1,"div",398),v(2," Debug Mode "),_(),y(3,"button",399),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.debugInstantWin())}),v(4," \u26A1 Instant Win "),_(),y(5,"button",400),X("click",function(){Z(t);let r=N();return ee(r.gameEngine.debugCycleSettings())}),v(6," \u{1F504} Cycle Settings "),_(),y(7,"div",401),v(8),_()()}if(n&2){let t=N();g(8),Rt(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var E0=class n{constructor(e,t,i,r){this.gameEngine=e;this.settings=t;this.firebase=i;this.router=r}boardContainer;isAutoBattleActive=$(!1);isMobileMenuOpen=$(!1);lastEconomyProcessedTurn=-1;ngOnInit(){this.gameEngine.resetGame()}ngOnDestroy(){this.isAutoBattleActive.set(!1),this.gameEngine.pauseGame()}goToHub(){this.isAutoBattleActive.set(!1),this.router.navigate(["/"])}get isProduction(){return!pM()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}centerOnSelectedUnit(){let e=this.boardContainer?.nativeElement;if(!e)return;let t=this.gameEngine.selectedUnit();if(!t)return;let i=this.gameEngine.tileSizePx,r=this.gameEngine.wallThicknessPx+2,o=i+r,s=t.position.x*o+i/2,a=t.position.y*o+i/2,l=Math.max(0,Math.min(s-e.clientWidth/2,e.scrollWidth-e.clientWidth)),c=Math.max(0,Math.min(a-e.clientHeight/2,e.scrollHeight-e.clientHeight));e.scrollTo({left:l,top:c,behavior:"smooth"})}activeKeys=new Set;onKeyDown(e){if(this.gameEngine.gameStatus()!=="playing")return;let t=e.key;if(t==="Tab"||t===" "||e.code==="Space"){e.preventDefault(),this.gameEngine.isPlayerTurn()&&this.gameEngine.selectNextAvailableUnitTab();return}if(t==="Enter"){e.preventDefault(),this.gameEngine.endPlayerTurn();return}let i=this.gameEngine.selectedUnit();if(!i||i.hasActed)return;this.activeKeys.add(t);let r=0,o=0;if((this.activeKeys.has("ArrowUp")||this.activeKeys.has("w")||this.activeKeys.has("W"))&&(o-=1),(this.activeKeys.has("ArrowDown")||this.activeKeys.has("s")||this.activeKeys.has("S"))&&(o+=1),(this.activeKeys.has("ArrowLeft")||this.activeKeys.has("a")||this.activeKeys.has("A"))&&(r-=1),(this.activeKeys.has("ArrowRight")||this.activeKeys.has("d")||this.activeKeys.has("D"))&&(r+=1),r===0&&o===0)return;e.preventDefault();let s=this.gameEngine.validMoves(),l=r!==0&&o!==0?i.tier===4?3:1:i.tier>=3||i.tier===2?2:1,c=null;for(let d=1;d<=l;d++){let h=i.position.x+r*d,f=i.position.y+o*d,m={x:h,y:f};if(s.some(w=>w.x===h&&w.y===f))c=m;else break}if(!c){let d={x:i.position.x,y:i.position.y},h={x:i.position.x+r,y:i.position.y+o};if(this.gameEngine.getWallBetween(d.x,d.y,h.x,h.y)){this.gameEngine.attackOrDestroyWallBetween(d,h);return}let m=this.gameEngine.getUnitAt(h.x,h.y);if(m&&m.owner!==i.owner){this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.isValidMove(h.x,h.y)&&this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.moveSelectedUnit(c)}onKeyUp(e){this.activeKeys.delete(e.key)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.settings.customMode()&&this.gameEngine.sandboxSpawnPending()){this.gameEngine.getUnitAt(e,t)||this.gameEngine.spawnSandboxAt({x:e,y:t});return}if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let i=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}let r=this.gameEngine.selectedUnit();if(r){let o=e-r.position.x,s=t-r.position.y;if(Math.abs(o)+Math.abs(s)===1&&this.gameEngine.getWallBetween(r.position.x,r.position.y,e,t)){this.gameEngine.attackOrDestroyWallBetween(r.position,{x:e,y:t});return}}if(i&&i.owner==="player"){this.gameEngine.selectUnit(i.id);return}this.gameEngine.selectUnit(null)}setCustomMode(e){this.settings.setCustomMode(e),this.gameEngine.resetGame()}onEdgeClick(e,t,i,r,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,i,r,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onDestroyIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:i},{x:r,y:o})}onBuildIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onAttackIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(r=>setTimeout(r,250)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.turn();this.lastEconomyProcessedTurn!==e&&(this.gameEngine.botEconomyPhase("player"),this.lastEconomyProcessedTurn=e),this.gameEngine.playerAutoStep()||this.gameEngine.selectUnit(null),this.gameEngine.remainingActions()===0&&(await new Promise(r=>setTimeout(r,1e3)),this.isAutoBattleActive()&&this.gameEngine.isPlayerTurn()&&this.gameEngine.endPlayerTurn())}static \u0275fac=function(t){return new(t||n)(he($n),he(gt),he(Rn),he(xi))};static \u0275cmp=It({type:n,selectors:[["app-game"]],viewQuery:function(t,i){if(t&1&&Ml(wz,5),t&2){let r;Rl(r=kl())&&(i.boardContainer=r.first)}},hostBindings:function(t,i){t&1&&X("keydown",function(o){return i.onKeyDown(o)},ss)("keyup",function(o){return i.onKeyUp(o)},ss)},decls:377,vars:124,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],["title","Return to Gaming Hub",1,"cursor-pointer","p-2","bg-slate-800/50","hover:bg-slate-700","border","border-slate-700/50","rounded-lg","transition-all","group/btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-slate-400","group-hover/btn:text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["d","M6 18 L10 12 L14 18 Z","fill","#9ca3af"],["cx","12","cy","10","r","3","fill","#6b7280"],[1,"hud-value","font-mono","text-sm","font-bold","text-slate-300"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-6xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],["width","24","height","24","viewBox","0 0 24 24"],[1,"font-mono","text-lg","font-bold","text-slate-300"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","roadmap","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto","no-select"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"flex","items-center","justify-between","w-full","gap-2","z-10","text-amber-200"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","mine-area","forge-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click","mouseenter","mouseleave"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"z-index"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","-translate-x-4","translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"click"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none"],[1,"absolute","text-[10px]","font-bold","px-1","rounded","bg-yellow-300/80","text-black","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90",3,"z-index"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90"],["viewBox","0 0 128 128",1,"w-full","h-full"],["transform","translate(0,10) scale(1)"],["x","20","y","80","width","88","height","18","rx","4","fill","#6b7280"],["x","30","y","70","width","68","height","12","rx","3","fill","#9ca3af"],["d","M32 40 H96 L86 56 H42 Z","fill","#4b5563"],["x","56","y","30","width","16","height","12","rx","2","fill","#6b7280"],["x","60","y","20","width","8","height","12","rx","2","fill","#9ca3af"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer",3,"click"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer",3,"click"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],["cx","64","cy","96","rx","40","ry","10","fill","#374151"],["d","M32 96 L56 48 L72 80 L96 96 Z","fill","#6b7280","stroke","#4b5563","stroke-width","4"],["cx","58","cy","60","r","6","fill","#9ca3af"],["transform","translate(82, 30) rotate(-20) scale(1.3)"],["width","4","height","30","rx","2","fill","#6b7280"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#f59e0b","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none","move-anim",3,"shake","transform","z-index"],[1,"pointer-events-none","move-anim"],[1,"unit-svg-wrapper"],[3,"unit"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow",3,"bg-green-600","bg-amber-600","bg-red-600","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-left-1","opacity-70","[style.z-index]='100'"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"mt-3","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-pink-500","peer-checked:border-pink-500","transition-all"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,i){if(t&1){let r=je();y(0,"div",2)(1,"div",3),W(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),_(),ie(),y(7,"svg",9)(8,"defs")(9,"radialGradient",10),W(10,"stop",11)(11,"stop",12)(12,"stop",13),_(),y(13,"radialGradient",14),W(14,"stop",15)(15,"stop",16)(16,"stop",17),_(),y(17,"radialGradient",18),W(18,"stop",19)(19,"stop",20)(20,"stop",21),_(),y(21,"linearGradient",22),W(22,"stop",23)(23,"stop",24),_(),y(24,"filter",25),W(25,"feDropShadow",26),_()()(),y(26,"svg",27)(27,"defs")(28,"clipPath",28),W(29,"path",29),_(),y(30,"symbol",30),W(31,"path",31),_()()(),Oe(),y(32,"div",32)(33,"button",33),X("click",function(){return Z(r),ee(i.goToHub())}),ie(),y(34,"svg",34),W(35,"path",35),_()(),Oe(),y(36,"div",36),W(37,"div",37)(38,"div",38),ie(),y(39,"svg",39),W(40,"path",40)(41,"rect",41),_(),Oe(),W(42,"div",42)(43,"div",43),_(),y(44,"div",44)(45,"div",45)(46,"h1",46)(47,"span",47),v(48,"Shape"),_(),y(49,"span",48),v(50," Tactics "),_()(),y(51,"div",49),W(52,"div",50)(53,"div",51),_()(),y(54,"div",52)(55,"span",53),v(56),_()()(),W(57,"div",54),_(),y(58,"div",55)(59,"div",56)(60,"button",57),X("click",function(){return Z(r),ee(i.gameEngine.resetGame())}),ie(),y(61,"svg",58),W(62,"path",59),_(),Oe(),y(63,"span",60),v(64),_()(),W(65,"div",61),y(66,"button",62),X("click",function(){return Z(r),ee(i.gameEngine.toggleRules())}),ie(),y(67,"svg",63),W(68,"path",64),_(),Oe(),y(69,"span",65),v(70),_()()(),y(71,"div",66)(72,"button",67),X("click",function(){return Z(r),ee(i.gameEngine.toggleHighScores())}),ie(),y(73,"svg",68),W(74,"path",69),_(),Oe(),y(75,"span",70),v(76),_()(),y(77,"button",71),X("click",function(){return Z(r),ee(i.gameEngine.toggleLeaderboard())}),ie(),y(78,"svg",68),W(79,"path",72),_(),Oe(),y(80,"span",70),v(81),_()(),y(82,"button",73),X("click",function(){return Z(r),ee(i.gameEngine.toggleLog())}),ie(),y(83,"svg",68),W(84,"path",74),_(),Oe(),y(85,"span",70),v(86),_()(),y(87,"button",75),X("click",function(){return Z(r),ee(i.navigateToFeedback())}),ie(),y(88,"svg",68),W(89,"path",76),_(),Oe(),y(90,"span",70),v(91),_()()(),y(92,"div",77)(93,"button",78),X("click",function(){return Z(r),ee(i.gameEngine.toggleSettings())}),ie(),y(94,"svg",79),W(95,"path",80)(96,"path",81),_()(),Y(97,Iz,9,3,"div",82)(98,Tz,4,1,"button",83),_()(),Oe(),y(99,"div",84)(100,"div",85),ie(),y(101,"svg",86),W(102,"rect",87)(103,"circle",88),_(),Oe(),y(104,"span",89),v(105),_()(),y(106,"div",85),ie(),y(107,"svg",86),W(108,"path",90)(109,"circle",91),_(),Oe(),y(110,"span",92),v(111),_()(),y(112,"div",85),ie(),y(113,"svg",86),W(114,"polygon",93),_(),Oe(),y(115,"span",94),v(116),_()(),y(117,"div",85),ie(),y(118,"svg",86),W(119,"circle",95)(120,"path",96),_(),Oe(),y(121,"span",97),v(122),_()(),y(123,"div",85),ie(),y(124,"svg",86),W(125,"path",98)(126,"rect",99)(127,"rect",100),_(),Oe(),y(128,"span",101),v(129),_()(),y(130,"button",102),X("click",function(){return Z(r),ee(i.toggleMobileMenu())}),ie(),y(131,"svg",103),W(132,"path",104),_()()(),Oe(),y(133,"div",105)(134,"button",106),X("click",function(){return Z(r),ee(i.gameEngine.toggleBuildMode())}),ie(),y(135,"svg",86),W(136,"path",107),_()(),Oe(),y(137,"button",106),X("click",function(){return Z(r),ee(i.gameEngine.convertWoodToReserve())}),v(138," +1 "),_(),y(139,"button",106),X("click",function(){return Z(r),ee(i.gameEngine.maxConvertWoodToReserve())}),v(140),_(),y(141,"label",108)(142,"div",109)(143,"input",110),X("change",function(){return Z(r),ee(i.gameEngine.toggleFogDebug())}),_(),y(144,"div",111),W(145,"div",112),_()(),y(146,"span",113),v(147),_()(),y(148,"div",114),v(149),_(),y(150,"button",115),X("click",function(){return Z(r),ee(i.gameEngine.endPlayerTurn())}),ie(),y(151,"svg",116),W(152,"path",117)(153,"path",118),_()()(),Y(154,Az,23,9,"div",119),Oe(),y(155,"div",120),W(156,"div",121),y(157,"div",122)(158,"div",123)(159,"span",124),v(160),_(),y(161,"span",125),v(162),_()(),W(163,"div",126),y(164,"div",127)(165,"div",128)(166,"span",129),ie(),y(167,"svg",130),W(168,"rect",87)(169,"circle",131)(170,"circle",132)(171,"rect",133)(172,"circle",134)(173,"circle",135),_()(),Oe(),y(174,"span",136),v(175),_()(),y(176,"div",128)(177,"span",129),ie(),y(178,"svg",137),W(179,"path",90)(180,"circle",91),_()(),Oe(),y(181,"span",138),v(182),_()(),y(183,"div",139)(184,"span",129)(185,"div",140),ie(),y(186,"svg",141),W(187,"polygon",142)(188,"rect",143)(189,"polygon",144)(190,"rect",145)(191,"polygon",146)(192,"rect",147),y(193,"g",148),W(194,"rect",149)(195,"polygon",150),_(),y(196,"g",151),W(197,"rect",152)(198,"circle",153)(199,"circle",154),_()()()(),Oe(),y(200,"span",155),v(201),y(202,"span",156),v(203,"/"),_(),v(204),_()()()(),y(205,"div",157),W(206,"div",158),y(207,"span",159),v(208),_(),y(209,"div",45)(210,"span",160),v(211),_()(),Y(212,Mz,2,3,"div",161),_(),y(213,"div",122)(214,"div",127)(215,"div",128)(216,"span",162),v(217),_(),y(218,"span",129),ie(),y(219,"svg",130),W(220,"rect",87)(221,"circle",131)(222,"circle",132)(223,"rect",133)(224,"circle",134)(225,"circle",135),_()()(),Oe(),y(226,"div",128)(227,"span",129),ie(),y(228,"svg",137),W(229,"path",90)(230,"circle",91),_()(),Oe(),y(231,"span",138),v(232),_()(),y(233,"div",163)(234,"span",164),v(235),y(236,"span",156),v(237,"/"),_(),v(238),_(),y(239,"span",129)(240,"div",140),ie(),y(241,"svg",141),W(242,"polygon",142)(243,"rect",143)(244,"polygon",144)(245,"rect",145)(246,"polygon",146)(247,"rect",147),y(248,"g",148),W(249,"rect",149)(250,"polygon",165),_(),y(251,"g",151),W(252,"rect",152)(253,"circle",153)(254,"circle",154),_()()()()()(),Oe(),W(255,"div",126),y(256,"div",166)(257,"span",167),v(258),_(),y(259,"span",168),v(260,"jaerbi"),_()()()(),Y(261,Nz,11,11,"div",169),y(262,"button",170),X("click",function(){return Z(r),ee(i.navigateToRoadmap())}),y(263,"div",171),W(264,"div",172),y(265,"span",173),v(266),_()(),y(267,"div",174),ie(),y(268,"svg",175),W(269,"path",176),_()()(),Oe(),y(270,"button",177),X("click",function(){return Z(r),ee(i.gameEngine.toggleSupport())}),y(271,"span",129),v(272,"\u2764\uFE0F"),_(),y(273,"span",178),v(274),_()(),Y(275,Pz,1,0,"app-support-community"),Y(276,Oz,1,0,"app-leaderboard-modal"),y(277,"div",179),Y(278,Fz,1,0,"app-sandbox"),y(279,"div",180,0)(281,"div",181)(282,"div",182)(283,"span",183),v(284),_()(),Y(285,Lz,3,1,"div",184),_n(286,VW,2,0,null,null,Nr),_()(),y(288,"div",185)(289,"div",186),W(290,"div",187),y(291,"div",188)(292,"span",189),v(293),_(),y(294,"div",190)(295,"span",191),v(296),_(),y(297,"div",192)(298,"span",129),v(299),_()()(),y(300,"div",193),W(301,"div",194),_()()()(),y(302,"div",195)(303,"div",196)(304,"button",197),X("click",function(){return Z(r),ee(i.toggleAutoBattle())}),y(305,"div",198)(306,"span",199),v(307),_(),y(308,"span",200),v(309),_()(),y(310,"div",198),W(311,"span",201),_(),W(312,"div",202),_(),y(313,"button",203),X("click",function(){return Z(r),ee(i.gameEngine.toggleBuildMode())}),y(314,"div",204)(315,"span",205),v(316,"+1"),_(),y(317,"div",206),ie(),y(318,"svg",207),W(319,"path",208)(320,"path",209)(321,"path",210)(322,"rect",211),_()()(),Oe(),y(323,"div",212)(324,"span"),v(325,"-10"),_(),y(326,"div",213),ie(),y(327,"svg",214),W(328,"rect",215)(329,"circle",216)(330,"circle",217),_()()(),Oe(),W(331,"div",202),_(),y(332,"button",218),X("click",function(){return Z(r),ee(i.gameEngine.convertWoodToReserve())}),y(333,"div",219)(334,"span",220)(335,"span"),v(336,"20"),_(),y(337,"div",213),ie(),y(338,"svg",214),W(339,"rect",215)(340,"circle",216)(341,"circle",217),_()()(),Oe(),y(342,"span",129),v(343,"\u2794"),_(),y(344,"span",221),v(345,"1 \u{1F464}"),_()()(),y(346,"button",222),X("click",function(){return Z(r),ee(i.gameEngine.maxConvertWoodToReserve())}),y(347,"div",223)(348,"span",224),v(349),_(),y(350,"span",129),v(351,"\u2794"),_(),y(352,"span",129),v(353,"\u{1F465}++"),_()()()(),y(354,"label",225)(355,"div",109)(356,"input",110),X("change",function(){return Z(r),ee(i.gameEngine.toggleFogDebug())}),_(),y(357,"div",111),W(358,"div",112),_()(),y(359,"span",113),v(360),_()(),y(361,"button",226),X("click",function(){return Z(r),ee(i.gameEngine.endPlayerTurn())}),y(362,"div",227)(363,"span",224),v(364),_(),ie(),y(365,"svg",116),W(366,"path",117)(367,"path",118),_()()(),Oe(),y(368,"div",114),v(369),_()()(),y(370,"div",228),v(371),_(),Y(372,UW,1,0,"app-game-rules"),Y(373,HW,24,5,"div",229),Y(374,zW,34,14,"div",230),Y(375,QW,24,9,"div",231),Y(376,JW,9,2,"div",232),_()}if(t&2){let r;g(56),j(i.settings.version),g(8),L(" ",i.settings.t("RELOAD")," "),g(6),L(" ",i.settings.t("INFO")," "),g(6),j(i.settings.t("RECORDS")),g(5),j(i.settings.t("RANKING")),g(5),j(i.settings.t("SYSTEM_LOG")),g(5),j(i.settings.t("FEEDBACK_MODULE")),g(6),Q((r=i.firebase.user$())?97:98,r),g(8),j(i.gameEngine.resources().wood),g(6),j(i.gameEngine.resources().iron),g(5),Rt(" ",i.gameEngine.getForestControl().player,"/",i.gameEngine.getForestControl().total," "),g(6),j(i.gameEngine.turn()),g(7),Rt(" ",i.gameEngine.getForestControl().player," : ",i.gameEngine.getForestControl().ai," "),g(5),Se("disabled",!i.gameEngine.canBuildThisTurn()),g(3),Se("disabled",!i.gameEngine.canAddReserveTurn()),g(2),Se("disabled",!i.gameEngine.canAddReserveTurn()),g(),L(" ",i.settings.t("ALL")," "),g(3),Se("checked",i.gameEngine.fogDebugDisabled()),g(4),j(i.settings.t("MAP_HACK")),g(2),Rt(" ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),g(5),Q(i.isMobileMenuOpen()?154:-1),g(6),L(" ",i.settings.t("COMMANDER")," "),g(2),L(" ",i.settings.t("PLAYER")," "),g(3),Bt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),g(10),j(i.gameEngine.resources().wood),g(),Bt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),g(6),j(i.gameEngine.resources().iron),g(),Bt("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),g(18),L(" ",i.gameEngine.getForestControl().player," "),g(3),L(" ",i.gameEngine.getForestControl().total," "),g(4),L(" ",i.settings.t("TURN_CYCLE")," "),g(3),L(" ",i.gameEngine.turn()," "),g(),Q(i.gameEngine.monopolyTurnsLeft()>0?212:-1),g(3),Bt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),g(2),j(i.gameEngine.aiWood()),g(9),Bt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),g(6),j(i.gameEngine.aiIron()),g(),Bt("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),g(2),L(" ",i.gameEngine.getForestControl().ai," "),g(3),L(" ",i.gameEngine.getForestControl().total," "),g(20),L(" ",i.settings.t("HOSTILE")," "),g(3),Q(i.gameEngine.shouldShowEndOverlay()?261:-1),g(5),L(" ",i.settings.t("STRATEGIC_PLAN")," "),g(8),j(i.settings.t("SUPPORT")),g(),Q(i.gameEngine.supportOpen()?275:-1),g(),Q(i.gameEngine.leaderboardOpen()?276:-1),g(2),Q(i.settings.customMode()?278:-1),g(),Te("shake",i.gameEngine.screenShake())("mood-none",i.gameEngine.currentMood()==="none")("mood-angry",i.gameEngine.currentMood()==="angry")("mood-rage",i.gameEngine.currentMood()==="rage"),g(2),Je("grid-template-columns","repeat("+i.gameEngine.gridSize+", minmax("+i.gameEngine.tileMinSizePx+"px, "+i.gameEngine.tileSizePx+"px))")("gap",i.gameEngine.wallThicknessPx+2,"px"),g(3),L(" ",i.gameEngine.baseHealth().player," "),g(),Q(i.gameEngine.isVisibleToPlayer(i.gameEngine.gridSize-1,i.gameEngine.gridSize-1)?285:-1),g(),En(i.gameEngine.gridRows),g(4),Te("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),g(3),j(i.settings.t("RISK")),g(2),Te("text-lime-300",i.settings.difficulty()==="baby")("text-emerald-300",i.settings.difficulty()==="normal")("text-orange-400",i.settings.difficulty()==="hard")("text-red-500",i.settings.difficulty()==="nightmare"),g(),L(" ",i.settings.t(i.settings.getDifficultyLabel(i.settings.difficulty()))," "),g(3),L(" ",i.settings.difficulty()==="baby"?"\u{1F476}":i.settings.difficulty()==="normal"?"\u{1F920}":i.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),g(2),Je("width",i.settings.difficulty()==="baby"?25:i.settings.difficulty()==="normal"?50:i.settings.difficulty()==="hard"?75:100,"%"),Te("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),g(3),Te("ring-2",i.isAutoBattleActive())("ring-green-400",i.isAutoBattleActive()),Se("disabled",i.gameEngine.gameStatus()!=="playing"),g(3),j(i.settings.t("AUTO")),g(2),j(i.settings.t("ENGAGE")),g(2),Te("bg-green-400",i.isAutoBattleActive())("bg-gray-500",!i.isAutoBattleActive()),g(2),Te("ring-2",i.gameEngine.buildMode())("ring-blue-400",i.gameEngine.buildMode()),Se("disabled",i.gameEngine.wallBuiltThisTurn()||!i.gameEngine.canBuildThisTurn()),g(19),Se("disabled",!i.gameEngine.canAddReserveTurn()),g(14),Se("disabled",!i.gameEngine.canAddReserveTurn()),g(3),j(i.settings.t("ALL")),g(7),Se("checked",i.gameEngine.fogDebugDisabled()),g(4),j(i.settings.t("MAP_HACK")),g(4),j(i.settings.t("NEXT_TURN")),g(5),ds(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),g(2),L(" ",i.settings.version," | \xA9\uFE0E Created by jaerbi and just "),g(),Q(i.gameEngine.rulesOpen()?372:-1),g(),Q(i.gameEngine.logOpen()?373:-1),g(),Q(i.gameEngine.settingsOpen()?374:-1),g(),Q(i.gameEngine.highScoresOpen()?375:-1),g(),Q(i.isProduction?-1:376)}},dependencies:[Nt,m0,Tc,y0,v0,_0,jE,_a],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}.move-anim[_ngcontent-%COMP%]{transition:transform .15s cubic-bezier(.4,0,.2,1);will-change:transform}"]})};var gO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(he(ls),he(Oi))};static \u0275dir=vn({type:n})}return n})(),XW=(()=>{class n extends gO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=pa(n)))(r||n)}})();static \u0275dir=vn({type:n,features:[kr]})}return n})(),mO=new we("");var ZW={provide:mO,useExisting:Zo(()=>D0),multi:!0};function eq(){let n=Fi()?Fi().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var tq=new we(""),D0=(()=>{class n extends gO{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!eq())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(he(ls),he(Oi),he(tq,8))};static \u0275dir=vn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&X("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Hu([ZW]),kr]})}return n})();function jx(n){return n==null||Hx(n)===0}function Hx(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var yO=new we(""),vO=new we(""),nq=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Bo=class{static min(e){return iq(e)}static max(e){return rq(e)}static required(e){return oq(e)}static requiredTrue(e){return sq(e)}static email(e){return aq(e)}static minLength(e){return lq(e)}static maxLength(e){return cq(e)}static pattern(e){return uq(e)}static nullValidator(e){return _O()}static compose(e){return IO(e)}static composeAsync(e){return CO(e)}};function iq(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function rq(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function oq(n){return jx(n.value)?{required:!0}:null}function sq(n){return n.value===!0?null:{required:!0}}function aq(n){return jx(n.value)||nq.test(n.value)?null:{email:!0}}function lq(n){return e=>{let t=e.value?.length??Hx(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function cq(n){return e=>{let t=e.value?.length??Hx(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function uq(n){if(!n)return _O;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(jx(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function _O(n){return null}function EO(n){return n!=null}function bO(n){return cs(n)?ln(n):n}function wO(n){let e={};return n.forEach(t=>{e=t!=null?F(F({},e),t):e}),Object.keys(e).length===0?null:e}function xO(n,e){return e.map(t=>t(n))}function dq(n){return!n.validate}function SO(n){return n.map(e=>dq(e)?e:t=>e.validate(t))}function IO(n){if(!n)return null;let e=n.filter(EO);return e.length==0?null:function(t){return wO(xO(t,e))}}function TO(n){return n!=null?IO(SO(n)):null}function CO(n){if(!n)return null;let e=n.filter(EO);return e.length==0?null:function(t){let i=xO(t,e).map(bO);return Iy(i).pipe(vt(wO))}}function DO(n){return n!=null?CO(SO(n)):null}function aO(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function AO(n){return n._rawValidators}function MO(n){return n._rawAsyncValidators}function Lx(n){return n?Array.isArray(n)?n:[n]:[]}function w0(n,e){return Array.isArray(n)?n.includes(e):n===e}function lO(n,e){let t=Lx(e);return Lx(n).forEach(r=>{w0(t,r)||t.push(r)}),t}function cO(n,e){return Lx(e).filter(t=>!w0(n,t))}var x0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=TO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=DO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ac=class extends x0{name;get formDirective(){return null}get path(){return null}},yh=class extends x0{_parent=null;name=null;valueAccessor=null},S0=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var RO=(()=>{class n extends S0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(he(yh,2))};static \u0275dir=vn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Te("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[kr]})}return n})(),kO=(()=>{class n extends S0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(he(Ac,10))};static \u0275dir=vn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Te("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[kr]})}return n})();var fh="VALID",b0="INVALID",Cc="PENDING",ph="DISABLED",Ns=class{},I0=class extends Ns{value;source;constructor(e,t){super(),this.value=e,this.source=t}},gh=class extends Ns{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},mh=class extends Ns{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Dc=class extends Ns{status;source;constructor(e,t){super(),this.status=e,this.source=t}},Vx=class extends Ns{source;constructor(e){super(),this.source=e}},vh=class extends Ns{source;constructor(e){super(),this.source=e}};function Gx(n){return(A0(n)?n.validators:n)||null}function hq(n){return Array.isArray(n)?TO(n):n||null}function $x(n,e){return(A0(e)?e.asyncValidators:n)||null}function fq(n){return Array.isArray(n)?DO(n):n||null}function A0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function NO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new me(1e3,"");if(!i[t])throw new me(1001,"")}function PO(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new me(1002,"")})}var Mc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return un(this.statusReactive)}set status(e){un(()=>this.statusReactive.set(e))}_status=Bn(()=>this.statusReactive());statusReactive=$(void 0);get valid(){return this.status===fh}get invalid(){return this.status===b0}get pending(){return this.status==Cc}get disabled(){return this.status===ph}get enabled(){return this.status!==ph}errors;get pristine(){return un(this.pristineReactive)}set pristine(e){un(()=>this.pristineReactive.set(e))}_pristine=Bn(()=>this.pristineReactive());pristineReactive=$(!0);get dirty(){return!this.pristine}get touched(){return un(this.touchedReactive)}set touched(e){un(()=>this.touchedReactive.set(e))}_touched=Bn(()=>this.touchedReactive());touchedReactive=$(!1);get untouched(){return!this.touched}_events=new Ht;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(lO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(lO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(cO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(cO(e,this._rawAsyncValidators))}hasValidator(e){return w0(this._rawValidators,e)}hasAsyncValidator(e){return w0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ce(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new mh(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new mh(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ce(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new gh(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new gh(!0,i))}markAsPending(e={}){this.status=Cc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Dc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ce(F({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ph,this.errors=null,this._forEachChild(r=>{r.disable(ce(F({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new I0(this.value,i)),this._events.next(new Dc(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ce(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=fh,this._forEachChild(i=>{i.enable(ce(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ce(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===fh||this.status===Cc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new I0(this.value,t)),this._events.next(new Dc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ce(F({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ph:fh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Cc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=bO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new Dc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new cn,this.statusChanges=new cn}_calculateStatus(){return this._allControlsDisabled()?ph:this.errors?b0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Cc)?Cc:this._anyControlsHaveStatus(b0)?b0:fh}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new gh(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new mh(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){A0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=hq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=fq(this._rawAsyncValidators)}},Rc=class extends Mc{constructor(e,t,i){super(Gx(t),$x(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){PO(this,!0,e),Object.keys(e).forEach(i=>{NO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,ce(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new vh(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Ux=class extends Rc{};var OO=new we("",{factory:()=>zx}),zx="always";function pq(n,e){return[...e.path,n]}function uO(n,e,t=zx){Wx(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),mq(n,e),vq(n,e),yq(n,e),gq(n,e)}function dO(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),C0(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function T0(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function gq(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Wx(n,e){let t=AO(n);e.validator!==null?n.setValidators(aO(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=MO(n);e.asyncValidator!==null?n.setAsyncValidators(aO(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();T0(e._rawValidators,r),T0(e._rawAsyncValidators,r)}function C0(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=AO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=MO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return T0(e._rawValidators,i),T0(e._rawAsyncValidators,i),t}function mq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&FO(n,e)})}function yq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&FO(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function FO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function vq(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function _q(n,e){n==null,Wx(n,e)}function Eq(n,e){return C0(n,e)}function bq(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function wq(n){return Object.getPrototypeOf(n.constructor)===XW}function xq(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function Sq(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===D0?t=o:wq(o)?i=o:r=o}),r||i||t||null}function Iq(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function hO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function fO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Ka=class extends Mc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(Gx(t),$x(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),A0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(fO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new vh(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){hO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){hO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){fO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Tq=n=>n instanceof Ka;var LO=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=vn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var Bx=class extends Mc{constructor(e,t,i){super(Gx(t),$x(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){PO(this,!1,e),e.forEach((i,r)=>{NO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],ce(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new vh(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var Cq=(()=>{class n extends Ac{callSetDisabledState;get submitted(){return un(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=Bn(()=>this._submittedReactive());_submittedReactive=$(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(C0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let i=this.form.get(t.path);return uO(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){dO(t.control||null,t,!1),Iq(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,i){this.form.get(t.path).setValue(i)}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,xq(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Vx(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(dO(i||null,t),Tq(r)&&(uO(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);_q(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&Eq(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Wx(this.form,this),this._oldForm&&C0(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(i){return new(i||n)(he(yO,10),he(vO,10),he(OO,8))};static \u0275dir=vn({type:n,features:[kr,lo]})}return n})();var VO=new we("");var Dq={provide:yh,useExisting:Zo(()=>qx)},qx=(()=>{class n extends yh{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new cn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=Sq(this,o)}ngOnChanges(t){this._added||this._setUpControl(),bq(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return pq(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(he(Ac,13),he(yO,10),he(vO,10),he(mO,10),he(VO,8))};static \u0275dir=vn({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Hu([Dq]),kr,lo]})}return n})();var Aq={provide:Ac,useExisting:Zo(()=>Kx)},Kx=(()=>{class n extends Cq{form=null;ngSubmit=new cn;get control(){return this.form}static \u0275fac=(()=>{let t;return function(r){return(t||(t=pa(n)))(r||n)}})();static \u0275dir=vn({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&X("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Hu([Aq]),kr]})}return n})();var Mq=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=uo({type:n});static \u0275inj=br({})}return n})();function pO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var UO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return pO(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Rc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new Ux(r,i)}control(t,i,r){let o={};return this.useNonNullable?(pO(i)?o=i:(o.validators=i,o.asyncValidators=r),new Ka(t,ce(F({},o),{nonNullable:!0}))):new Ka(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new Bx(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof Ka)return t;if(t instanceof Mc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var BO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:VO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:OO,useValue:t.callSetDisabledState??zx}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=uo({type:n});static \u0275inj=br({imports:[Mq]})}return n})();var M0=class n{db;auth;constructor(){let e=Sd(g0);this.db=Jd(e),this.auth=hh(e)}async addFeedback(e){let t=ce(F({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:eh()});await ih(ai(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=Wr(ai(this.db,"feedbacks"),Ti("timestamp","desc"),Oo(e));return(await Fo(t)).docs.map(r=>r.data())}async getFeedbackPage(e,t){let i=[Ti("timestamp","desc"),Oo(e)],r=t?Wr(ai(this.db,"feedbacks"),Ti("timestamp","desc"),cP(t),Oo(e)):Wr(ai(this.db,"feedbacks"),Ti("timestamp","desc"),Oo(e)),o=await Fo(r),s=o.docs.map(l=>l.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),i=Wr(ai(this.db,"feedbacks"),hr("userId","==",e),hr("timestamp",">=",t)),o=(await Fo(i)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Yx=()=>[1,2,3,4,5],jO=(n,e)=>e.timestamp;function Nq(n,e){if(n&1){let t=je();y(0,"button",39),X("click",function(){let r=Z(t).$implicit,o=N(2);return ee(o.setRating(r))}),v(1," \u2605 "),_()}if(n&2){let t=e.$implicit,i=N(2);Te("active",i.form.value.rating>=t)}}function Pq(n,e){if(n&1&&(y(0,"div",36),v(1),_()),n&2){let t=N(2);g(),j(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function Oq(n,e){n&1&&(y(0,"div",37),v(1),_()),n&2&&(g(),j(e))}function Fq(n,e){if(n&1){let t=je();y(0,"div",25)(1,"div",26),W(2,"img",27),_(),y(3,"div",28)(4,"div",29),v(5),_(),y(6,"div",30),v(7),_()()(),y(8,"form",31),X("ngSubmit",function(){Z(t);let r=N();return ee(r.submit())}),y(9,"div")(10,"div",32),v(11),_(),y(12,"div",33),_n(13,Nq,2,2,"button",34,Nr),_()(),y(15,"div")(16,"div",32),v(17),_(),W(18,"textarea",35),Y(19,Pq,2,1,"div",36),Y(20,Oq,2,1,"div",37),_(),y(21,"button",38),v(22),_()()}if(n&2){let t,i=e,r=N();g(2),Se("src",i.photoURL,er),g(3),j(i.displayName),g(2),j(r.settings.t("OPERATOR_ONLINE")),g(),Se("formGroup",r.form),g(3),j(r.settings.t("EFFICIENCY_RATING")),g(2),En(ma(16,Yx)),g(4),j(r.settings.t("TACTICAL_NOTE")),g(),Se("placeholder",yE(r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),g(),Q(r.form.controls.text.errors?19:-1),g(),Q((t=r.message())?20:-1,t),g(),Te("cursor-pointer",r.canSubmit)("cursor-not-allowed",!r.canSubmit),Se("disabled",!r.canSubmit),g(),L(" ",r.settings.t("TRANSMIT_REPORT")," ")}}function Lq(n,e){if(n&1&&(y(0,"div",21),v(1),_()),n&2){let t=N();g(),j(t.settings.t("SYSTEM_LOG"))}}function Vq(n,e){if(n&1&&(y(0,"div",22),v(1),_()),n&2){let t=N();g(),j(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function Uq(n,e){if(n&1&&(y(0,"span"),v(1,"\u2605"),_()),n&2){let t=e.$implicit,i=N().$implicit;Te("active",i.rating>=t)}}function Bq(n,e){if(n&1&&(y(0,"tr",44)(1,"td",47),W(2,"img",48),y(3,"span"),v(4),_()(),y(5,"td",49)(6,"div",50),_n(7,Uq,2,2,"span",51,Nr),_()(),y(9,"td",49)(10,"span",52),v(11),_()(),y(12,"td",49)(13,"span",53),v(14),_()()()),n&2){let t=e.$implicit,i=N(2);g(2),Se("src",t.userPhoto,er),g(2),j(t.userName),g(3),En(ma(4,Yx)),g(4),j(t.text),g(3),j(i.formatDate(t.timestamp))}}function jq(n,e){if(n&1&&(y(0,"tr")(1,"td",54),v(2),_()()),n&2){let t=N(2);g(2),j(t.settings.t("NO_SIGNALS"))}}function Hq(n,e){if(n&1){let t=je();y(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),v(5),_(),y(6,"th",43),v(7),_(),y(8,"th",43),v(9),_(),y(10,"th",43),v(11),_()()(),y(12,"tbody"),_n(13,Bq,15,5,"tr",44,jO,!1,jq,3,1,"tr"),_()()(),y(16,"div",45)(17,"button",46),X("click",function(){Z(t);let r=N();return ee(r.prevPage())}),v(18),_(),y(19,"button",46),X("click",function(){Z(t);let r=N();return ee(r.nextPage())}),v(20),_()()}if(n&2){let t=N();g(5),j(t.settings.t("TABLE_OPERATOR")),g(2),j(t.settings.t("TABLE_RATING")),g(2),j(t.settings.t("TABLE_MESSAGE")),g(2),j(t.settings.t("TABLE_DATE")),g(2),En(t.pageItems()),g(5),L(" ",t.settings.t("PREVIOUS")," "),g(2),L(" ",t.settings.t("NEXT")," ")}}function Gq(n,e){if(n&1&&(y(0,"span"),v(1,"\u2605"),_()),n&2){let t=e.$implicit,i=N().$implicit;Te("active",i.rating>=t)}}function $q(n,e){if(n&1&&(y(0,"div",55)(1,"div",56)(2,"div",57),W(3,"img",58),y(4,"div",59),v(5),_()(),y(6,"div",50),_n(7,Gq,2,2,"span",51,Nr),_()(),y(9,"div",60),v(10),_()()),n&2){let t=e.$implicit;g(3),Se("src",t.userPhoto,er),g(2),j(t.userName),g(2),En(ma(3,Yx)),g(3),j(t.text)}}function zq(n,e){if(n&1&&_n(0,$q,11,4,"div",55,jO),n&2){let t=N();En(t.recent())}}var R0=class n{constructor(e,t,i,r,o){this.fb=e;this.router=t;this.feedback=i;this.firebase=r;this.settings=o;this.form=new Rc({text:new Ka("",{nonNullable:!0,validators:[Bo.required,Bo.minLength(10),Bo.maxLength(500)]}),rating:new Ka(5,{nonNullable:!0,validators:[Bo.required,Bo.min(1),Bo.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,l=Number(localStorage.getItem(a)||0);this.disabledUntil.set(l)}this.loadPage(0)}recent=$([]);pageItems=$([]);pageStack=[null];pageIndex=$(0);lastDoc=null;disabledUntil=$(0);message=$(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);if(this.pageItems.set(r.items),this.lastDoc=r.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);this.pageItems.set(r.items),this.lastDoc=r.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:i}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let r=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:r.text||"",rating:Number(r.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(he(UO),he(xi),he(M0),he(Rn),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,i){if(t&1&&(y(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),_(),ie(),y(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),_()()(),Oe(),y(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),v(15),_(),y(16,"span",14),v(17),_()(),y(18,"a",15),v(19),_()(),y(20,"div",16)(21,"div",17)(22,"div",18),v(23),_(),Y(24,Fq,23,17),_(),y(25,"div",19)(26,"div",20),Y(27,Lq,2,1,"div",21),Y(28,Vq,2,1,"div",22),y(29,"button",23),X("click",function(){return i.isAllShow=!i.isAllShow}),v(30),_()(),y(31,"div",24),Y(32,Hq,21,7),Y(33,zq,2,0),_()()()()()),t&2){let r;g(15),j(i.settings.t("FEEDBACK_MODULE")),g(2),j(i.settings.t("COMMUNITY_SIGNALS")),g(2),j(i.settings.t("RETURN_TO_MAP")),g(4),j(i.settings.t("DEPLOY_REPORT")),g(),Q((r=i.firebase.user$())?24:-1,r),g(3),Q(i.isAllShow?-1:27),g(),Q(i.isAllShow?28:-1),g(2),L(" ",i.isAllShow?i.settings.t("TOGGLE_BACK"):i.settings.t("VIEW_FULL_ARCHIVE")," "),g(2),Q(i.isAllShow?32:-1),g(),Q(i.isAllShow?-1:33)}},dependencies:[Nt,BO,LO,D0,RO,kO,Kx,qx,Fr],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var k0=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(he(gt))};static \u0275cmp=It({type:n,selectors:[["app-roadmap"]],decls:93,vars:13,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"absolute","top-0","right-0","w-16","h-16","bg-emerald-500/10","blur-2xl","-mr-8","-mt-8"],[1,"card-header","relative","z-10"],[1,"text-[11px]","font-mono","text-emerald-200/50","italic"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","uppercase","tracking-wider","bg-emerald-500/20","text-emerald-400","border","border-emerald-500/40"],[1,"flex","items-start","gap-4","mt-4","relative","z-10"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/60","rotate-45","flex","items-center","justify-center","group-hover:rotate-180","transition-all","duration-700","shadow-[0_0_15px_rgba(16,185,129,0.2)]"],[1,"-rotate-45","group-hover:-rotate-180","transition-all","duration-700","text-xl"],[1,"text-lg","font-bold","text-emerald-50","leading-tight","mb-2","opacity-80","decoration-emerald-500/30","line-through","decoration-2"],[1,"text-sm","text-emerald-100/40","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-emerald-500/10","flex","justify-between","items-center","relative","z-10"],[1,"text-[9px]","uppercase","tracking-widest","text-emerald-500/40","font-bold"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-emerald-500","shadow-[0_0_5px_#10b981]"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,i){t&1&&(y(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),_(),ie(),y(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),_()()(),Oe(),W(11,"div",10)(12,"div",11),y(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),W(17,"div",16),y(18,"h1",17),v(19),_()(),y(20,"p",18),v(21,"Future_Ops // Deployment_Schedule"),_()(),y(22,"a",19)(23,"span",20),v(24,"\xAB"),_(),v(25),_()(),y(26,"div",21)(27,"div",22),W(28,"div",23),y(29,"div",24)(30,"span",25),v(31,"REF: PROJECT_VOLUMETRIC"),_(),y(32,"span",26),v(33),_()(),y(34,"div",27)(35,"div",28)(36,"div",29),v(37),_()(),y(38,"div")(39,"h3",30),v(40),_(),y(41,"p",31),v(42),_()()(),y(43,"div",32)(44,"span",33),v(45,"System_Verified"),_(),y(46,"div",34),W(47,"div",35)(48,"div",35)(49,"div",35),_()()(),y(50,"div",22)(51,"div",36)(52,"span",37),v(53,"REF: RESOURCE_IRON"),_(),y(54,"span",26),v(55),_()(),y(56,"div",38)(57,"div",39)(58,"span"),v(59,"\u26D3\uFE0F"),_()(),y(60,"div")(61,"h3",40),v(62),_(),y(63,"p",41),v(64),_()()(),y(65,"div",42)(66,"span",43),v(67,"Priority_Beta"),_(),y(68,"div",34),W(69,"div",44)(70,"div",45)(71,"div",45),_()()(),y(72,"div",46)(73,"div",36)(74,"span",37),v(75,"REF: INFRA_SMITHY"),_(),y(76,"span",26),v(77),_()(),y(78,"div",47)(79,"div",48),W(80,"div",49),y(81,"span",50),v(82,"\u2692\uFE0F"),_()(),y(83,"div")(84,"h3",51),v(85),_(),y(86,"p",52),v(87),_()()()()(),y(88,"div",53)(89,"div",54),v(90,"Community_Intel"),_(),y(91,"p",55),v(92),_()()()()),t&2&&(g(19),L(" ",i.settings.t("STRATEGIC_PLAN")," "),g(6),L(" ",i.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),g(8),L(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),g(4),L(" ",i.settings.currentLang()==="uk"?"\u2714\uFE0F":"\u2705"," "),g(3),L(" ",i.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"," "),g(2),L(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),g(13),L(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),g(7),j(i.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),g(2),L(" ",i.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),g(13),L(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),g(8),j(i.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),g(2),L(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),g(5),L(" ",i.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[Nt,Fr],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var N0=class n{constructor(e,t){this.router=e;this.settings=t}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||n)(he(xi),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-landing-page"]],decls:41,vars:7,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden","relative"],[1,"absolute","top-1/4","-left-1/4","w-96","h-96","bg-emerald-500/20","rounded-full","blur-3xl","animate-pulse"],[1,"absolute","bottom-1/4","-right-1/4","w-96","h-96","bg-purple-500/20","rounded-full","blur-3xl","animate-pulse",2,"animation-delay","1ms"],[1,"z-10","text-center","mb-12"],[1,"text-6xl","font-black","tracking-tighter","mb-4","bg-gradient-to-r","from-emerald-400","to-cyan-400","bg-clip-text","text-transparent","drop-shadow-sm"],[1,"text-slate-400","text-lg","max-w-md","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","w-full","max-w-5xl","z-10"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-emerald-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-emerald-400","hover:shadow-[0_0_40px_-10px_rgba(52,211,153,0.3)]","text-left",3,"click"],[1,"absolute","top-0","right-0","p-4","opacity-10","group-hover:opacity-20","transition-opacity"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24"],["d","M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.8L19.5 8 12 11.2 4.5 8 12 4.8zM4 15.5v-5.2l7 3.1v5.2l-7-3.1zm9 3.1v-5.2l7-3.1v5.2l-7 3.1z"],[1,"relative","z-20"],[1,"inline-block","px-3","py-1","bg-emerald-500/10","text-emerald-400","text-xs","font-bold","rounded-full","mb-4","border","border-emerald-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-emerald-50"],[1,"text-slate-400","leading-relaxed","mb-6"],[1,"flex","items-center","text-emerald-400","font-bold","group-hover:translate-x-2","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-purple-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-purple-400","hover:shadow-[0_0_40px_-10px_rgba(168,85,247,0.3)]","text-left",3,"click"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"inline-block","px-3","py-1","bg-purple-500/10","text-purple-400","text-xs","font-bold","rounded-full","mb-4","border","border-purple-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-purple-50"],[1,"flex","items-center","text-purple-400","font-bold","group-hover:translate-x-2","transition-transform"],[1,"absolute","bottom-6","text-slate-500","text-sm","font-medium","uppercase","tracking-widest"]],template:function(t,i){t&1&&(D(0,"div",0),G(1,"div",1)(2,"div",2),D(3,"div",3)(4,"h1",4),v(5),A(),D(6,"p",5),v(7),A()(),D(8,"div",6)(9,"button",7),Gt("click",function(){return i.navigateTo("shape-tactics")}),D(10,"div",8),ie(),D(11,"svg",9),G(12,"path",10),A()(),Oe(),D(13,"div",11)(14,"span",12),v(15),A(),D(16,"h2",13),v(17,"Shape Tactics"),A(),D(18,"p",14),v(19),A(),D(20,"div",15),v(21," ENTER PORTAL "),ie(),D(22,"svg",16),G(23,"path",17),A()()()(),Oe(),D(24,"button",18),Gt("click",function(){return i.navigateTo("tower-defense")}),D(25,"div",8),ie(),D(26,"svg",9),G(27,"path",19),A()(),Oe(),D(28,"div",11)(29,"span",20),v(30),A(),D(31,"h2",21),v(32,"Shape Defense"),A(),D(33,"p",14),v(34),A(),D(35,"div",22),v(36," DEFEND BASE "),ie(),D(37,"svg",16),G(38,"path",17),A()()()()(),Oe(),D(39,"footer",23),v(40),A()()),t&2&&(g(5),L(" ",i.settings.currentLang()==="uk"?"\u0406\u0413\u0420\u041E\u0412\u0418\u0419 \u0426\u0415\u041D\u0422\u0420":"GAMING HUB"," "),g(2),L(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043E\u0440\u0442\u0430\u043B, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0441\u0432\u043E\u044E \u043F\u043E\u0434\u043E\u0440\u043E\u0436.":"Select a portal to begin your journey."," "),g(8),L(" ","Live Now"," "),g(4),L(" ",i.settings.t("SHAPE_TACTIC_DESCRIPTION")," "),g(11),L(" ",i.settings.currentLang()==="uk"?"\u0413\u0420\u0410\u0422\u0418 \u0417\u0410\u0420\u0410\u0417":"PLAY NOW"," "),g(4),L(" ",i.settings.t("TOWER_DEFFENCE_DESCRIPTION")," "),g(6),L(" \xA9 2026 Shape Tactics Labs // ",i.settings.version," "))},dependencies:[Nt],styles:["[_nghost-%COMP%]{display:block}"]})};var P0=class n{transform(e){if(e==null||e===0||e==="0")return"0";let t=Number(e);if(isNaN(t))return"0";if(Math.abs(t)<1e3)return t.toString();let i=["","k","M","B","T","Q"],r=Math.floor(Math.log10(Math.abs(t))/3);if(r===0)return t.toString();let o=Math.min(r,i.length-1),s=i[o],a=Math.pow(10,o*3),l=t/a;return l.toFixed(l>=10?0:1).replace(/\.0$/,"")+s}static \u0275fac=function(t){return new(t||n)};static \u0275pipe=Dl({name:"abbreviateNumber",type:n,pure:!0})};var O0=class n{constructor(e,t,i){this.ngZone=e;this.firebase=t;this.settings=i;this.initGame()}money=$(100);lives=$(20);wave=$(0);isWaveInProgress=$(!1);gameOver=$(!1);gridSize=20;grid=$([]);path=$([]);tileSize=62;enemies=$([]);projectiles=$([]);gameSpeedMultiplier=$(1);nextWaveEnemyType=$("standard");isHardMode=$(!1);statsByTowerType=$({});enemiesInternal=[];projectilesInternal=[];towersInternal=[];infernoZones=[];enemyIdCounter=1;projectileIdCounter=1;uiTick$=new Ht;animationFrameId=null;lastUpdateTime=0;enemiesToSpawn=0;currentWaveEnemyCount=0;spawnTimer=0;spawnInterval=1e3;currentWaveType="standard";towerCosts=[15,50,250,900,1300,1400,1500];tierStats=[{damage:5,range:2,fireInterval:.5},{damage:21,range:3,fireInterval:.7},{damage:83,range:2.5,fireInterval:1},{damage:342,range:3.5,fireInterval:1.5},{damage:71,range:2.5,fireInterval:2.5},{damage:23,range:3,fireInterval:.2},{damage:66,range:2.5,fireInterval:1}];savedResult=!1;gameEndedHard=!1;async saveResultIfLoggedIn(){let e=this.firebase.user$();if(!e)return;let t=this.gridSize===20?"20x20":"10x10",i={userId:e.uid,displayName:e.displayName||"Anonymous",maxWave:this.wave(),totalMoney:this.money(),mapSize:t,gridSize:this.gridSize};try{await this.firebase.saveTowerDefenseScore(i)}catch{}}dispose(){this.stopGameLoop(),this.enemiesInternal=[],this.projectilesInternal=[],this.towersInternal=[],this.infernoZones=[],this.enemiesToSpawn=0,this.currentWaveEnemyCount=0,this.spawnTimer=0,this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!1),this.savedResult=!1,this.gameEndedHard=!1,this.money.set(100),this.lives.set(100),this.wave.set(0);let e=this.grid();if(e&&e.length){let t=e.map(i=>i.map(r=>r.tower?ce(F({},r),{tower:null}):r));this.grid.set(t)}}resetEngine(){this.initializeGame(1)}initGame(){this.initializeGame(1)}resetGame(){this.initializeGame(1)}generateMap(){let e=this.generateRandomPath();this.path.set(e);let t=[];this.towersInternal=[];let i=new Set(e.map(r=>`${r.x},${r.y}`));for(let r=0;r<this.gridSize;r++){let o=[];for(let s=0;s<this.gridSize;s++){let a="void";i.has(`${s},${r}`)?a="path":[{x:s-1,y:r},{x:s+1,y:r},{x:s,y:r-1},{x:s,y:r+1}].some(c=>i.has(`${c.x},${c.y}`))&&(a="buildable"),o.push({x:s,y:r,type:a,tower:null})}t.push(o)}this.grid.set(t)}initializeGame(e){this.gridSize=e===2?20:10,this.gridSize===10?this.tileSize=62:this.gridSize===20?this.tileSize=32:this.tileSize=32,this.dispose(),this.generateMap(),this.statsByTowerType.set({}),this.nextWaveEnemyType.set(this.determineWaveType(1));let t=this.getGoldMasteryLevel();if(t>=8){let i=(t-7)*20;this.money.set(100+i)}}determineWaveType(e){if(e<=2)return"standard";if(e<=8)return Math.random()<.5?"scout":"standard";let t=Math.random();return t<.2?"tank":t<.41?"scout":"standard"}getGoldMasteryLevel(){let e=this.firebase.masteryProfile(),t=e&&e.upgrades?e.upgrades.gold_mastery:0;return typeof t=="number"?t:0}getGoldKillMultiplier(){let e=this.getGoldMasteryLevel();if(e<=0)return 1;let t=Math.min(e,7),i=Math.max(0,Math.min(e-7,7)),r=Math.max(0,e-14);return 1+(t*.05+i*.1+r*.15)}generateRandomPath(){let e=this.gridSize,t=e*e,i=Math.floor(t*.35),r=Math.floor(t*.4),o=1e3,s=I=>`${I.x},${I.y}`,a=(I,x)=>I>=0&&x>=0&&I<e&&x<e,l=(I,x)=>I+Math.floor(Math.random()*(x-I+1)),c=l(0,e-1),d=l(0,e-1),h={x:0,y:c},f={x:e-1,y:d},m=()=>{let I=[],x=h.x,R=h.y;I.push({x,y:R});let M=f.x>x?1:-1;for(let be=0;be<o&&x!==f.x;be++)x+=M,I.push({x,y:R});let ae=f.y>R?1:-1;for(let be=0;be<o&&R!==f.y;be++)R+=ae,I.push({x,y:R});return I},w=new Set,S=[],k=0,V=(I,x,R)=>{if(!a(I,x))return!1;let M=s({x:I,y:x});if(w.has(M))return!1;let ae=[{x:I+1,y:x},{x:I-1,y:x},{x:I,y:x+1},{x:I,y:x-1}];for(let be of ae){if(!a(be.x,be.y))continue;let de=s(be);if(w.has(de)&&!(be.x===R.x&&be.y===R.y))return!1}return!0},q=F({},h);S.push(q),w.add(s(q));let ye=Math.floor(e/3),ve=Math.floor(2*e/3),xe=Math.floor(e/2),Ae={x:ye,y:l(0,Math.max(0,xe-1))},O={x:ve,y:l(xe,e-1)},T=[Ae,O,f],P=I=>{for(let x=0;x<o&&q.x!==I.x;x++){if(k++,k>o||S.length>=r)return;let R=I.x>q.x?1:-1,M=q.x+R,ae=q.y;if(!V(M,ae,q))break;let be={x:M,y:ae};S.push(be),w.add(s(be)),q=be}for(let x=0;x<o&&q.y!==I.y;x++){if(k++,k>o||S.length>=r)return;let R=I.y>q.y?1:-1,M=q.x,ae=q.y+R;if(!V(M,ae,q))break;let be={x:M,y:ae};S.push(be),w.add(s(be)),q=be}};for(let I=0;I<T.length;I++){if(k++,k>o)return m();P(T[I])}if(S.length<i)for(let I=0;I<o&&S.length<i;I++){if(k++,k>o)return m();let x=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}],R=!1;for(let M=0;M<x.length;M++){let ae=x[M],be=q.x+ae.x,de=q.y+ae.y;if(!V(be,de,q))continue;let Tt={x:be,y:de};S.push(Tt),w.add(s(Tt)),q=Tt,R=!0;break}if(!R)break}return S.length===0?m():S}startWave(){if(this.isWaveInProgress()||this.gameOver())return;this.wave.update(t=>t+1),this.isWaveInProgress.set(!0),this.currentWaveType=this.nextWaveEnemyType(),this.nextWaveEnemyType.set(this.determineWaveType(this.wave()+1));let e=5+this.wave()*2;this.enemiesToSpawn=e,this.currentWaveEnemyCount=e,this.spawnTimer=0,this.startGameLoop()}startGameLoop(){this.stopGameLoop(),this.lastUpdateTime=performance.now(),this.ngZone.runOutsideAngular(()=>{let e=t=>{if(this.gameOver())return;let i=(t-this.lastUpdateTime)/1e3;this.lastUpdateTime=t;let r=Math.min(i,.05);this.updateGame(r),this.enemies.set([...this.enemiesInternal]),this.gameSpeedMultiplier()===1?this.projectiles.set([...this.projectilesInternal]):this.projectiles.set([]),this.uiTick$.next(),this.animationFrameId=requestAnimationFrame(e)};this.animationFrameId=requestAnimationFrame(e)})}stopGameLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateGame(e){if(this.gameEndedHard)return;let t=e*this.gameSpeedMultiplier();if(this.handleSpawning(t),this.updateEnemies(t),this.updateTowers(t),this.updateProjectiles(t),this.lives()<=0&&!this.gameOver()){if(this.enemiesInternal=[],this.projectilesInternal=[],this.enemiesToSpawn=0,this.stopGameLoop(),this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!0)}),!this.savedResult){this.savedResult=!0,this.saveResultIfLoggedIn();let i=this.wave(),r=0;if(i>=5){let o=i*1.5,s=i>20?(i-20)*2:0;r=Math.floor(o+s)}r>0&&this.firebase.awardTowerDefenseXp(r)}this.gameEndedHard=!0;return}if(this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&this.isWaveInProgress()){this.enemiesInternal=[],this.projectilesInternal=[],this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1)});let i=this.getGoldMasteryLevel();if(i>=15){let r=(i-14)*5;this.money.update(o=>o+r)}}}getUpgradeLevel(e,t){let i=this.firebase.masteryProfile();if(!i)return 0;let r=`t${e}_${t}`,o=i.upgrades?.[r];return typeof o=="number"?o:0}getProjectileSpeedMultiplierForTower(e){if(e.type===2){let t=this.getUpgradeLevel(2,"golden");if(t>0)return 1+.2*t}return 1}triggerInfernoChainReaction(e,t){if(this.getUpgradeLevel(5,"golden")<=0)return;let r=Math.floor(t*.5),o=2,s=o*o;for(let l of this.enemiesInternal){let c=e.x-l.position.x,d=e.y-l.position.y;c*c+d*d<=s&&this.applyDamageWithResists(l,r,5)}let a={id:"z"+this.projectileIdCounter++,position:F({},e),radius:o,remaining:.3,dps:0};this.infernoZones.push(a)}applyVenom(e,t){if(e.isSlime)return;let i=Math.min(3,(e.venomStacks??0)+1);e.venomStacks=i,e.venomDuration=4,e.venomTickTimer=0,t.specialActive&&(e.venomSlowActive=!0);let r=Math.max(e.venomBaseDamage??0,t.damage);e.venomBaseDamage=r}applyDamageWithResists(e,t,i){let r=t;(e.isMagma&&i===5||e.isMirror&&i===6||e.isSlime&&i===7)&&(r=Math.floor(r*.1)),e.hp-=r;let o=i|0;this.statsByTowerType.update(s=>{let a=F({},s);return a[o]=(a[o]??0)+r,a})}handleSpawning(e){this.enemiesToSpawn<=0||(this.spawnTimer+=e*1e3,this.spawnTimer>=this.spawnInterval&&(this.spawnTimer=0,this.spawnEnemy(),this.enemiesToSpawn--))}spawnEnemy(){let e=50*Math.pow(1.2,this.wave()),t=.5+this.wave()*.05,i=this.currentWaveEnemyCount||5+this.wave()*2,r=i-this.enemiesToSpawn,o=this.wave()%5===0,s=r===i-1,a=o&&s,l=this.wave()*40%360,c=this.currentWaveType;a&&(c="boss");let d=e,h=t;c==="tank"?(d=e*2,h=t*.5):c==="scout"?(d=e*.4,h=t*2):c==="boss"&&(d=e*4,h=t*.5),this.isHardMode()&&(d*=1.5,h*=1.1);let f={id:"e"+this.enemyIdCounter++,position:F({},this.path()[0]),pathIndex:0,hp:d,maxHp:d,speed:h,progress:0,isBoss:a,hue:l,baseSpeed:t,speedModifier:1,shatterStacks:0,isFrozen:!1,type:c};if(this.wave()>=15){let m=Math.random();m<.2?f.isMagma=!0:m<.4?f.isMirror=!0:m<.6&&(f.isSlime=!0)}this.enemiesInternal.push(f)}updateEnemies(e){for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i];if(r.speedModifier=1,r.isFrozen=!1,r.burnedByInferno=!1,r.stunTime&&r.stunTime>0&&(r.stunTime=Math.max(0,r.stunTime-e)),r.prismVulnerableTime&&r.prismVulnerableTime>0&&(r.prismVulnerableTime=Math.max(0,r.prismVulnerableTime-e)),r.venomDuration&&r.venomDuration>0&&r.venomStacks&&r.venomStacks>0){r.venomDuration=Math.max(0,r.venomDuration-e),r.venomTickTimer=(r.venomTickTimer??0)+e;let o=r.venomBaseDamage??0;for(;r.venomTickTimer>=1&&r.venomDuration>0;){r.venomTickTimer-=1;let s=o*r.venomStacks;this.applyDamageWithResists(r,s,7)}r.venomDuration<=0&&(r.venomStacks=0,r.venomTickTimer=0),r.venomStacks&&r.venomStacks>0&&r.venomSlowActive&&(r.speedModifier*=.8)}}for(let i=this.infernoZones.length-1;i>=0;i--){let r=this.infernoZones[i];r.remaining-=e,r.remaining<=0&&this.infernoZones.splice(i,1)}this.applyFrostAuras();let t=this.tileSize;for(let i of this.infernoZones){let r=i.radius*i.radius;for(let o of this.enemiesInternal){let s=i.position.x-o.position.x,a=i.position.y-o.position.y;s*s+a*a<=r&&i.dps>0&&(this.applyDamageWithResists(o,i.dps*e,5),o.burnedByInferno=!0)}}for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i];if(!!!(r.stunTime&&r.stunTime>0)){let w=r.baseSpeed,S=r.type==="tank"?.5:r.type==="scout"?2:r.type==="boss"?.5:1,k=w*S*r.speedModifier;if(r.progress+=k*e,r.progress>=1){if(r.pathIndex++,r.progress=0,r.pathIndex>=this.path().length-1){let V=r.type==="boss"?5:1;this.enemiesInternal.splice(i,1),this.ngZone.run(()=>this.lives.update(q=>Math.max(0,q-V))),this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&(this.currentWaveType="standard");continue}r.position=F({},this.path()[r.pathIndex])}}let s=this.path(),a=s[r.pathIndex],l=s[r.pathIndex+1]||a,c=a.x+(l.x-a.x)*r.progress,d=a.y+(l.y-a.y)*r.progress;r.displayX=(c+.5)*t,r.displayY=(d+.5)*t;let f=60,m=1;if(r.type==="tank"?m=1.2:r.type==="scout"?m=.9:r.type==="boss"&&(m=1.6),r.scale=m,r.isFrozen?r.bg=`hsl(190, 80%, ${f}%)`:r.type==="tank"?r.bg="hsl(330, 70%, 60%)":r.type==="scout"?r.bg="hsl(50, 90%, 60%)":r.type==="boss"?r.bg=`hsl(${r.hue}, 90%, 65%)`:r.bg="hsl(200, 70%, 60%)",r.hp<=0){let w=!!r.burnedByInferno,S=F({},r.position),k=r.maxHp;this.enemiesInternal.splice(i,1),w&&this.triggerInfernoChainReaction(S,k);let V=5+this.wave(),q=this.getGoldKillMultiplier(),ye=Math.floor(V*q);this.isHardMode()&&(ye=Math.floor(ye*.8)),this.ngZone.run(()=>this.money.update(ve=>ve+ye))}}}updateTowers(e){if(!(this.enemiesInternal.length===0||this.towersInternal.length===0)){for(let t of this.towersInternal)if(t.cooldown-=e,t.cooldown<=0){let i=this.findTargetForTower(t,this.enemiesInternal);i?(t.targetEnemyId=i.id,this.fireAt(t,i),t.type===7&&(t.hitsOnTarget=(t.hitsOnTarget||0)+1),t.cooldown=t.fireInterval):(t.targetEnemyId=void 0,t.beamTime=0,t.lastBeamTargetId=void 0,t.extraTargetIds=void 0,t.cooldown=0,t.type===7&&(t.hitsOnTarget=0))}}}applyFrostAuras(){if(this.enemiesInternal.length===0)return;let e=this.towersInternal.filter(c=>c.type===1&&c.specialActive);if(e.length===0)return;let t=this.getUpgradeLevel(1,"golden"),o=2*(1+t*.1),s=o*o,a=.3+t*.06,l=Math.max(.1,1-a);for(let c of this.enemiesInternal){let d=!1;for(let h of e){let f=h.position.x-c.position.x,m=h.position.y-c.position.y;if(f*f+m*m<=s){d=!0;break}}d&&(c.speedModifier=l,c.isFrozen=!0)}}findTargetForTower(e,t){let i=[3,6];if(e.targetEnemyId){let l=t.find(c=>c.id===e.targetEnemyId);if(l&&l.hp>0){let c=e.position.x-l.position.x,d=e.position.y-l.position.y,h=c*c+d*d,f=e.type===1?this.getEffectiveRange(e):e.range,m=f*f;if(h<=m){if(e.type===7){if((e.hitsOnTarget??0)<3)return l}else if(i.includes(e.type))return l}}}let r=e.type===1?this.getEffectiveRange(e):e.range,o=r*r,s=[];for(let l of t){let c=e.position.x-l.position.x,d=e.position.y-l.position.y,h=c*c+d*d;if(h>o||e.type===7&&l.id===e.targetEnemyId&&(e.hitsOnTarget??0)>=3)continue;let f=l.pathIndex??0,m=l.progress??0,w=f+m;s.push({enemy:l,distSq:h,progressScore:w})}if(s.length===0)return e.hitsOnTarget=0,null;let a=this.applyStrategy(e,s);return e.targetEnemyId!==a.id&&(e.hitsOnTarget=0),a}getEffectiveRange(e){if(e.type===1){let t=this.getUpgradeLevel(1,"golden");return e.range*(1+t*.1)}return e.range}applyStrategy(e,t){let i=e.strategy||"first";return i==="random"?t[Math.floor(Math.random()*t.length)].enemy:i==="weakest"?t.reduce((r,o)=>o.enemy.hp<r.enemy.hp?o:r).enemy:i==="strongest"?t.reduce((r,o)=>o.enemy.hp>r.enemy.hp?o:r).enemy:t.reduce((r,o)=>o.progressScore>r.progressScore?o:r).enemy}pushProjectile(e){this.projectilesInternal.length>=100&&this.projectilesInternal.shift(),this.projectilesInternal.push(e)}fireAt(e,t){if(e.type!==6){let r={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},t.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(r)}let i=e.damage;if(e.specialActive&&e.type===4&&t.hp/t.maxHp<.5){let o=t.isBoss?3:2;i=Math.floor(e.damage*o)}if(e.specialActive&&e.type===3){let r=Math.min(5,t.shatterStacks+1);t.shatterStacks=r;let o=1+r*.2;i=Math.floor(i*o)}if(e.type===6){let r=e.lastBeamTargetId===t.id,o=e.beamTime??0,s=r?o+e.fireInterval:e.fireInterval;e.beamTime=s,e.lastBeamTargetId=t.id;let l=this.getUpgradeLevel(6,"golden")>0?3:1,c=1+Math.min(l,s*.5);i=Math.floor(i*c)}if(t.prismVulnerableTime&&t.prismVulnerableTime>0&&(i=Math.floor(i*1.15)),e.type===2){let r=this.getUpgradeLevel(2,"golden"),o=t.hp*(.01+r*.01);i+=o}else if(e.type===4){let r=this.getUpgradeLevel(4,"golden"),o=t.hp*(.05+r*.02);i+=o}if(e.type===5){let s=t.position;for(let a of this.enemiesInternal){let l=s.x-a.position.x,c=s.y-a.position.y;if(l*l+c*c<=2.25){let d=i;a.prismVulnerableTime&&a.prismVulnerableTime>0&&(d=Math.floor(d*1.15)),this.applyDamageWithResists(a,d,5),a.burnedByInferno=!0}}if(e.specialActive){let a={id:"z"+this.projectileIdCounter++,position:F({},s),radius:1.5,remaining:4,dps:e.damage*.5};this.infernoZones.push(a)}}else e.type===7?(this.applyVenom(t,e),this.applyDamageWithResists(t,i,e.type)):(e.type!==6||!e.specialActive)&&this.applyDamageWithResists(t,i,e.type);if(e.type===3){let r=this.getUpgradeLevel(3,"golden");if(r>0){let o=.15+r*.05;if(Math.random()<o){let s=(.5+r*.2)*1.2;t.stunTime=Math.max(t.stunTime??0,s)}}}if(e.specialActive&&e.type===2){let r=this.getUpgradeLevel(2,"golden"),o=.25+r*.1,s=1.5+r*.5;if(Math.random()<o){let a=[];for(let l of this.enemiesInternal){if(l.id===t.id||l.hp<=0)continue;let c=t.position.x-l.position.x,d=t.position.y-l.position.y,h=c*c+d*d;h<=9&&a.push({enemy:l,distSq:h})}if(a.length>0){a.sort((c,d)=>c.distSq-d.distSq);let l=Math.min(2,a.length);for(let c=0;c<l;c++){let d=a[c].enemy,h={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},d.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(h);let f=Math.floor(e.damage*s);this.applyDamageWithResists(d,f,e.type)}}}}if(e.specialActive&&e.type===6){let r=this.getUpgradeLevel(6,"golden"),o=e.lastBeamTargetId===t.id,s=e.beamTime??0,a=r>0?3:1,l=1+Math.min(a,s*.5),c=Math.floor(e.damage*l),d=[t];if(o){let f=e.range*e.range,m=[];for(let w of this.enemiesInternal){if(w.id===t.id||w.hp<=0)continue;let S=e.position.x-w.position.x,k=e.position.y-w.position.y,V=S*S+k*k;V<=f&&m.push({enemy:w,distSq:V})}if(m.length>0){m.sort((S,k)=>S.distSq-k.distSq);let w=Math.min(2,m.length);e.extraTargetIds=[];for(let S=0;S<w;S++){let k=m[S].enemy;d.push(k),e.extraTargetIds.push(k.id)}}}let h=r>0;for(let f of d){let m=c;f.prismVulnerableTime&&f.prismVulnerableTime>0&&(m=Math.floor(m*1.15)),this.applyDamageWithResists(f,m,e.type),h&&(f.prismVulnerableTime=Math.max(f.prismVulnerableTime??0,.25))}}if(e.type===4){let r=this.getUpgradeLevel(4,"golden");if(r>0){let o=.1;if(r===2?o=.15:r>=3&&(o=.2),Math.random()<o){let s=null,a=1/0;for(let l of this.enemiesInternal){if(l.id===t.id||l.hp<=0)continue;let c=t.position.x-l.position.x,d=t.position.y-l.position.y,h=Math.sqrt(c*c+d*d);h<=3&&h<a&&(a=h,s=l)}if(s){let l={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},s.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(l);let c=e.damage;if(e.specialActive&&s.hp/s.maxHp<.5){let h=s.isBoss?3:2;c=Math.floor(e.damage*h)}s.prismVulnerableTime&&s.prismVulnerableTime>0&&(c=Math.floor(c*1.15)),this.applyDamageWithResists(s,c,e.type)}}}}}updateProjectiles(e){for(let t=this.projectilesInternal.length-1;t>=0;t--){let i=this.projectilesInternal[t],r=i.speedMultiplier??1;i.progress+=5*r*e,i.progress>=1&&this.projectilesInternal.splice(t,1)}}buyTower(e,t,i){let r=this.towerCosts[i-1];this.money()<r||this.grid.update(o=>{let s=o[t][e];if(s.type==="buildable"&&!s.tower){let a=this.tierStats[i-1],l=this.getUpgradeLevel(i,"damage"),c=this.getUpgradeLevel(i,"range"),d=this.getUpgradeLevel(i,"golden"),h=1+l*.05,f=c*.1;s.tower={id:crypto.randomUUID(),type:i,level:1,position:{x:e,y:t},baseCost:r,invested:r,damage:Math.floor(a.damage*h),range:a.range+f,fireInterval:a.fireInterval,cooldown:0,specialActive:!1,strategy:"first",hasGolden:d>0,description:this.getTowerDescription(i)},this.towersInternal.push(s.tower),this.money.update(m=>m-r)}return[...o]})}upgradeTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level<4){let o=this.getUpgradeCost(r.tower);this.money()>=o&&(r.tower.level++,r.tower.damage=Math.floor(r.tower.damage*1.3),r.tower.range+=.5,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i]})}getUpgradeCost(e){let t=.5;switch(e.level){case 1:t=.5;break;case 2:t=.6;break;case 3:t=.7;break}return Math.floor(e.baseCost*t)}getSpecialCost(e){return e.baseCost*4}getTowerDescription(e){let t=this.settings.currentLang()==="uk";switch(e){case 1:return t?"\u0421\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u0443 \u0440\u0430\u0434\u0456\u0443\u0441\u0456 \u0434\u0456\u0457":"Slows enemies in range";case 2:return t?"\u0423\u0440\u0430\u0436\u0430\u0454 \u043B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u043E\u044E \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u043E\u044E \u0434\u0435\u043A\u0456\u043B\u044C\u043A\u0430 \u0446\u0456\u043B\u0435\u0439":"Chains lightning to nearby enemies";case 3:return t?"\u041F\u043E\u0441\u0438\u043B\u044E\u0454 \u0443\u0440\u043E\u043D \u0437\u0430 \u0440\u0430\u0445\u0443\u043D\u043E\u043A \u0435\u0444\u0435\u043A\u0442\u0443 \u0440\u043E\u0437\u043A\u043E\u043B\u0443":"Amplifies damage with shatter stacks";case 4:return t?"\u0417\u0430\u0432\u0434\u0430\u0454 \u0431\u043E\u043D\u0443\u0441\u043D\u0438\u0439 \u0443\u0440\u043E\u043D \u043F\u043E \u043F\u043E\u0440\u0430\u043D\u0435\u043D\u0438\u0445 \u0432\u043E\u0440\u043E\u0433\u0430\u0445":"Deals bonus damage to weakened enemies";case 5:return t?"AOE \u0443\u0440\u043E\u043D \u043F\u043E \u043E\u0431\u043B\u0430\u0441\u0442\u0456 \u0442\u0430 \u0437\u043E\u043D\u0438 \u0433\u043E\u0440\u0456\u043D\u043D\u044F":"Splash AOE damage and burning zones";case 6:return t?"\u041F\u0440\u043E\u043C\u0456\u043D\u044C, \u0449\u043E \u043F\u043E\u0441\u0438\u043B\u044E\u0454\u0442\u044C\u0441\u044F, \u0442\u0430 \u043B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0430\u0442\u0430\u043A\u0430":"Beam ramps damage and chains with golden";case 7:return t?"\u041D\u0430\u043A\u043B\u0430\u0434\u0430\u0454 \u0435\u0444\u0435\u043A\u0442\u0438 \u043E\u0442\u0440\u0443\u0442\u0438 \u0437 \u043F\u043E\u0441\u0442\u0443\u043F\u043E\u0432\u0438\u043C \u0443\u0440\u043E\u043D\u043E\u043C":"Applies venom stacks and poison DOT";default:return t?"\u0421\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u0430 \u0432\u0435\u0436\u0430":"Standard tower"}}buyAbility(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level===4&&!r.tower.specialActive){let o=this.getSpecialCost(r.tower);this.money()>=o&&(r.tower.specialActive=!0,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i.map(o=>[...o])]})}setTowerStrategy(e,t,i){this.grid.update(r=>{let o=r[t];if(!o)return r;let s=o[e];return s&&s.tower&&(s.tower.strategy=i),[...r]})}sellTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower){let o=r.tower.invested??r.tower.baseCost,s=Math.floor(o*.5),a=r.tower.id;r.tower=null,this.money.update(c=>c+s);let l=this.towersInternal.findIndex(c=>c.id===a);l!==-1&&this.towersInternal.splice(l,1)}return[...i]})}getEnemiesRef(){return this.enemiesInternal}getProjectilesRef(){return this.projectilesInternal}getTowersRef(){return this.towersInternal}getInfernoZonesRef(){return this.infernoZones}getPathRef(){return this.path()}getGridRef(){return this.grid()}static \u0275fac=function(t){return new(t||n)(Re(yn),Re(Rn),Re(gt))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var qq=["gameCanvas"],Kq=(n,e,t)=>({"shape-circle":n,"shape-triangle":e,"shape-square":t}),Yq=(n,e)=>e.type;function Qq(n,e){n&1&&W(0,"div",58)}function Jq(n,e){if(n&1){let t=je();ga(0),y(1,"button",49),X("click",function(){Z(t);let r=nr(0),o=N(3);return ee(o.buyTower(r))}),y(2,"div",50)(3,"div",51),W(4,"span",52),y(5,"span",53),v(6),_(),y(7,"span",54),v(8),_()(),y(9,"span",55),v(10),_()(),y(11,"p",56),v(12),_(),Ut(13,Qq,1,0,"div",57),_()}if(n&2){let t=e.$implicit,i=e.$index,r=N(3),o=Nl(i+1),s=r.tdEngine.money()>=t;g(),Te("bg-slate-800",s)("border-slate-700",s)("hover:border-sky-500",s)("hover:bg-slate-700",s)("opacity-50",!s)("bg-slate-900",!s)("border-transparent",!s),Se("disabled",!s),g(3),Je("background-color",r.getTowerColor(o)),g(2),L(" ",r.getTowerName(o)," "),g(2),L("T",o),g(),Te("text-emerald-400",s)("text-slate-500",!s),g(),L(" $",t," "),g(2),L(" ",r.tdEngine.getTowerDescription(o)," "),g(),Se("ngIf",s)}}function Xq(n,e){if(n&1&&(y(0,"h3",45),v(1),y(2,"span",46),v(3),_()(),y(4,"div",47),_n(5,Jq,14,27,"button",48,Bu),_()),n&2){let t=N(2);g(),L(" ",t.settings.t("BUY_DEFENDER")," "),g(2),L("Balance: $",t.tdEngine.money()),g(2),En(t.tdEngine.towerCosts)}}function Zq(n,e){if(n&1&&(y(0,"div",68),v(1),_()),n&2){let t=N(2);g(),L(" ",t.tower.description," ")}}function eK(n,e){if(n&1){let t=je();y(0,"button",77),X("click",function(){Z(t);let r=N(3);return ee(r.upgradeTower())}),y(1,"span"),v(2),_(),y(3,"span",78),v(4),_()()}if(n&2){let t=N(2),i=N();Se("disabled",i.tdEngine.money()<i.tdEngine.getUpgradeCost(t.tower)),g(2),j(i.settings.t("UPGRADE")),g(2),L("$",i.tdEngine.getUpgradeCost(t.tower))}}function tK(n,e){if(n&1&&(y(0,"div",75),v(1),_()),n&2){let t=N(3);g(),L(" ",t.settings.t("MAX_LEVEL")," ")}}function nK(n,e){if(n&1&&(y(0,"span",78),v(1),_()),n&2){let t=N(3),i=N();g(),L("$",i.tdEngine.getSpecialCost(t.tower))}}function iK(n,e){if(n&1&&(y(0,"div",81),v(1),_(),y(2,"div",82),v(3),_()),n&2){let t=N(4);g(),L(" ",t.settings.t("FROST_AURA")," "),g(2),L(" ",t.settings.t("FROST_AURA_INFO")," ")}}function rK(n,e){if(n&1&&(y(0,"div",83),v(1),_(),y(2,"div",82),v(3),_()),n&2){let t=N(4);g(),L(" ",t.settings.t("CHAIN_LIGHTNING")," "),g(2),L(" ",t.settings.t("CHAIN_LIGHTNING_INFO")," ")}}function oK(n,e){if(n&1&&(y(0,"div",84),v(1),_(),y(2,"div",82),v(3),_()),n&2){let t=N(4);g(),L(" ",t.settings.t("SHATTER")," "),g(2),L(" ",t.settings.t("SHATTER_INFO")," ")}}function sK(n,e){if(n&1&&(y(0,"div",85),v(1),_(),y(2,"div",82),v(3),_()),n&2){let t=N(4);g(),L(" ",t.settings.t("FINAL_STRIKE")," "),g(2),L(" ",t.settings.t("FINAL_STRIKE_INFO")," ")}}function aK(n,e){if(n&1&&(y(0,"div",85),v(1),_(),y(2,"div",82),v(3),_()),n&2){let t=N(4);g(),L(" ",t.settings.t("NAPALM_STRIKE")," "),g(2),L(" ",t.settings.t("NAPALM_STRIKE_INFO")," ")}}function lK(n,e){if(n&1&&(y(0,"div",85),v(1),_(),y(2,"div",82),v(3),_()),n&2){let t=N(4);g(),L(" ",t.settings.t("REFRACTION_BEAM")," "),g(2),L(" ",t.settings.t("REFRACTION_BEAM_INFO")," ")}}function cK(n,e){if(n&1&&(y(0,"div",85),v(1),_(),y(2,"div",82),v(3),_()),n&2){let t=N(4);g(),L(" ",t.settings.t("NEUROTOXIN")," "),g(2),L(" ",t.settings.t("NEUROTOXIN_INFO")," ")}}function uK(n,e){if(n&1){let t=je();y(0,"button",79),X("click",function(){Z(t);let r=N(3);return ee(r.buyAbility())}),y(1,"span"),v(2),_(),Y(3,nK,2,1,"span",78),_(),y(4,"div",80),Y(5,iK,4,2),Y(6,rK,4,2),Y(7,oK,4,2),Y(8,sK,4,2),Y(9,aK,4,2),Y(10,lK,4,2),Y(11,cK,4,2),_()}if(n&2){let t=N(2),i=N();Te("bg-purple-600",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("hover:bg-purple-500",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("bg-slate-700",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),Se("disabled",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),g(2),L(" ",t.tower.specialActive?i.settings.t("ABILITY_ACTIVE"):i.settings.t("BUY_ABILITY")," "),g(),Q(t.tower.specialActive?-1:3),g(2),Q(t.tower.type===1?5:-1),g(),Q(t.tower.type===2?6:-1),g(),Q(t.tower.type===3?7:-1),g(),Q(t.tower.type===4?8:-1),g(),Q(t.tower.type===5?9:-1),g(),Q(t.tower.type===6?10:-1),g(),Q(t.tower.type===7?11:-1)}}function dK(n,e){if(n&1){let t=je();y(0,"h3",59),v(1),_(),y(2,"div",60)(3,"div",61)(4,"span",62),v(5),_(),y(6,"span",63),v(7),_()(),y(8,"div",61)(9,"span",62),v(10),_(),y(11,"span",63),v(12),_()(),y(13,"div",61)(14,"span",62),v(15),_(),y(16,"span",64),v(17),_()(),y(18,"div",61)(19,"span",62),v(20),_(),y(21,"span",65),v(22),_()(),y(23,"div",66)(24,"span",62),v(25),_(),y(26,"span",67),v(27),_()(),Y(28,Zq,2,1,"div",68),_(),y(29,"div",69)(30,"div",70)(31,"div",71),v(32),_(),y(33,"div",72)(34,"button",73),X("click",function(){Z(t);let r=N(2);return ee(r.setTowerStrategy("first"))}),v(35),_(),y(36,"button",73),X("click",function(){Z(t);let r=N(2);return ee(r.setTowerStrategy("weakest"))}),v(37),_(),y(38,"button",73),X("click",function(){Z(t);let r=N(2);return ee(r.setTowerStrategy("strongest"))}),v(39),_(),y(40,"button",73),X("click",function(){Z(t);let r=N(2);return ee(r.setTowerStrategy("random"))}),v(41),_()()(),Y(42,eK,5,3,"button",74)(43,tK,2,1,"div",75),y(44,"button",76),X("click",function(){Z(t);let r=N(2);return ee(r.sellTower())}),v(45),_(),Y(46,uK,12,16),_()}if(n&2){let t=N(),i=N();g(),L(" ",i.settings.t("DEFENDER_INFO")," "),g(4),j(i.settings.t("TIER")),g(2),j(t.tower.type),g(3),j(i.settings.t("LEVEL")),g(2),L("",t.tower.level," / 4"),g(3),j(i.settings.t("DAMAGE")),g(2),j(t.tower.damage),g(3),j(i.settings.t("RANGE")),g(2),j(t.tower.range),g(3),j(i.settings.t("SPEED")),g(2),j(t.tower.fireInterval),g(),Q(t.tower.description?28:-1),g(4),j(i.settings.t("TARGETING")),g(2),Te("bg-sky-600",t.tower.strategy==="first"||!t.tower.strategy)("text-white",t.tower.strategy==="first"||!t.tower.strategy),g(),L(" ",i.settings.t("FIRST")," "),g(),Te("bg-sky-600",t.tower.strategy==="weakest")("text-white",t.tower.strategy==="weakest"),g(),L(" ",i.settings.t("WEAKEST")," "),g(),Te("bg-sky-600",t.tower.strategy==="strongest")("text-white",t.tower.strategy==="strongest"),g(),L(" ",i.settings.t("STRONGEST")," "),g(),Te("bg-sky-600",t.tower.strategy==="random")("text-white",t.tower.strategy==="random"),g(),L(" ",i.settings.t("RANDOM")," "),g(),Q(t.tower.level<4?42:43),g(3),L(" ",i.settings.t("SELL")," (50% REFUND) "),g(),Q(t.tower.level===4?46:-1)}}function hK(n,e){n&1&&Y(0,Xq,7,2)(1,dK,47,36),n&2&&Q(e.tower?1:0)}function fK(n,e){if(n&1&&(y(0,"div",94)(1,"div",98)(2,"div",51),W(3,"div",99),y(4,"span",100),v(5),_()(),y(6,"span",101),v(7),Xn(8,"abbreviateNumber"),_()(),y(9,"div",102),W(10,"div",103),y(11,"div",104),W(12,"div",105),_()()()),n&2){let t=e.$implicit;N();let i=nr(9);g(3),Je("background-color",t.color)("box-shadow","0 0 8px "+t.color),g(2),L(" ",t.name," "),g(),Je("color",t.color),g(),L(" ",Pl(8,14,t.damage)," "),g(3),Je("background-color",t.color),g(),Je("width",i.max>0?t.damage/i.max*100:0,"%")("background","linear-gradient(90deg, "+t.color+"dd, "+t.color+")")}}function pK(n,e){if(n&1&&(y(0,"div",95)(1,"p"),v(2),_()()),n&2){let t=N(2);g(2),j(t.settings.t("NO_DATA"))}}function gK(n,e){if(n&1&&(y(0,"div",40)(1,"div",86)(2,"div",51)(3,"span",87),v(4,"\u{1F4CA}"),_(),y(5,"h3",88),v(6),_()(),y(7,"p",89),v(8),_()(),ga(9),y(10,"div",90)(11,"div",91)(12,"span",92),v(13),_(),y(14,"span",93),v(15),Xn(16,"abbreviateNumber"),_()(),_n(17,fK,13,16,"div",94,Yq,!1,pK,3,1,"div",95),_(),y(20,"div",96)(21,"p",97),v(22),_()()()),n&2){let t=N();g(6),L(" ",t.settings.t("DAMAGE_STATS")," "),g(2),L(" ",t.settings.t("DAMAGE_STATS_DESC")," "),g();let i=Nl(t.getDamageStatsView());g(4),L(" ",t.settings.currentLang()==="uk"?"\u0412\u0441\u044C\u043E\u0433\u043E \u043D\u0430\u043D\u0435\u0441\u0435\u043D\u043E:":"Total Output:"," "),g(2),L(" ",Pl(16,7,t.getTotalDamage(i.list))," "),g(2),En(i.list),g(5),L(" ",t.settings.t("SELECT_TILE_TO_BUILD")," ")}}function mK(n,e){n&1&&W(0,"app-support-community")}function yK(n,e){if(n&1){let t=je();y(0,"div",44)(1,"div",106)(2,"h2",107),v(3),_(),y(4,"p",108),v(5),_(),y(6,"button",109),X("click",function(){Z(t);let r=N();return ee(r.onRestart())}),v(7),_()()()}if(n&2){let t=N();g(3),j(t.settings.t("GAME_OVER")),g(2),ds(" ",t.settings.t("YOU_SURVIVED")," ",t.tdEngine.wave()," ",t.settings.t("WAVES")," "),g(2),L(" ",t.settings.t("TRY_AGAIN")," ")}}var F0=class n{constructor(e,t,i,r,o,s){this.tdEngine=e;this.settings=t;this.gameEngine=i;this.firebase=r;this.router=o;this.cdr=s}selectedTile=$(null);mapLevel=$(1);autoWave=$(!1);uiSub;gameCanvas;ctx;rafId=null;isBrowser=typeof window<"u"&&typeof document<"u";onKeyDown(e){if(this.tdEngine.isWaveInProgress())return;if(e.key==="Enter"){e.preventDefault(),this.tdEngine.startWave();return}}onKeyUp(e){}unloadNotification(e){let t=this.tdEngine.getTowersRef().length>0,i=this.tdEngine.isWaveInProgress();(t||i)&&(e.returnValue=!0)}ngOnInit(){this.tdEngine.initializeGame(this.mapLevel()),this.cdr.detectChanges(),this.uiSub=this.tdEngine.uiTick$.subscribe(()=>{this.cdr.detectChanges(),this.autoWave()&&!this.tdEngine.isWaveInProgress()&&setTimeout(()=>{this.autoWave()&&!this.tdEngine.isWaveInProgress()&&this.tdEngine.startWave()},1e3)})}ngAfterViewInit(){this.isBrowser&&(setTimeout(()=>{this.initCanvas(),this.startCanvasLoop(),setTimeout(()=>this.resizeCanvas(),100)},0),window.addEventListener("resize",this.resizeCanvas))}ngOnDestroy(){this.uiSub?.unsubscribe(),this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.isBrowser&&window.removeEventListener("resize",this.resizeCanvas),this.tdEngine.resetEngine()}goBack(){this.tdEngine.resetEngine(),this.router.navigate(["/"])}onRestart(){this.tdEngine.initializeGame(this.mapLevel()),this.selectedTile.set(null)}onTileClick(e){e.type==="buildable"||e.tower?this.selectedTile.set(e):this.selectedTile.set(null)}buyTower(e){let t=this.selectedTile();t&&(this.tdEngine.buyTower(t.x,t.y,e),this.selectedTile.set(null))}upgradeTower(){let e=this.selectedTile();e&&e.tower&&this.tdEngine.upgradeTower(e.x,e.y)}getRangeStyle(){let e=this.selectedTile();if(!e||!e.tower)return{display:"none"};let t=e.tower,i=this.tdEngine.tileSize,o=(t.type===1?this.tdEngine.getEffectiveRange(t):t.range)*2*i;return{left:`${t.position.x*i+i/2}px`,top:`${t.position.y*i+i/2}px`,width:`${o}px`,height:`${o}px`,display:"block"}}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}sellTower(){let e=this.selectedTile();e&&e.tower&&(this.tdEngine.sellTower(e.x,e.y),this.selectedTile.set(null))}setTowerStrategy(e){let t=this.selectedTile();t&&t.tower&&this.tdEngine.setTowerStrategy(t.x,t.y,e)}buyAbility(){let e=this.selectedTile();e&&e.tower&&e.tower.level===4&&!e.tower.specialActive&&this.tdEngine.buyAbility(e.x,e.y)}getTowerName(e){let t=this.settings.currentLang()==="uk";switch(e){case 1:return t?"\u041B\u044C\u043E\u0434\u044F\u043D\u0430":"Ice";case 2:return t?"\u0411\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430":"Lightning";case 3:return t?"\u0420\u043E\u0437\u043A\u043E\u043B\u044E\u0432\u0430\u0447":"Shatter";case 4:return t?"\u041A\u0430\u0442":"Executioner";case 5:return t?"\u0406\u043D\u0444\u0435\u0440\u043D\u043E":"Inferno";case 6:return t?"\u041F\u0440\u0438\u0437\u043C\u0430\u0442\u0438\u0447\u043D\u0438\u0439 \u043F\u0440\u043E\u043C\u0456\u043D\u044C":"Prism Beam";default:return t?"\u041D\u0435\u0439\u0440\u043E\u0442\u043E\u043A\u0441\u0438\u043D":"Neurotoxin"}}getTowerColor(e){return e===1?"#0ea5e9":e===2?"#a855f7":e===3?"#f59e0b":e===4?"#ef4444":e===5?"#fb923c":e===6?"#22d3ee":"#84cc16"}getDamageStatsView(){let e=this.tdEngine.statsByTowerType(),t=[1,2,3,4,5,6,7].map(r=>({type:r,name:this.getTowerName(r),color:this.getTowerColor(r),damage:e[r]??0})),i=t.reduce((r,o)=>o.damage>r?o.damage:r,0);return{list:t,max:i}}getTotalDamage(e){return e.reduce((t,i)=>t+i.damage,0)}setSpeed(e){this.tdEngine.gameSpeedMultiplier.set(e)}onMapSizeChange(e){e!==this.mapLevel()&&(this.mapLevel.set(e),this.tdEngine.initializeGame(e),this.selectedTile.set(null),this.isBrowser&&this.resizeCanvas())}setHardMode(e){this.tdEngine.isWaveInProgress()||this.tdEngine.isHardMode.set(e)}onLoginClick(){if(!this.firebase.user$())try{this.firebase.loginWithGoogle()}catch{}}initCanvas=()=>{let e=this.gameCanvas?.nativeElement;e&&(this.ctx=e.getContext("2d"),this.resizeCanvas())};resizeCanvas=()=>{let e=this.gameCanvas?.nativeElement;if(!e)return;let t=this.tdEngine.tileSize,i=this.tdEngine.gridSize;if(!t||!i)return;let r=this.tdEngine.gridSize*t;e.style.width=`${r}px`,e.style.height=`${r}px`;let o=Math.max(1,window.devicePixelRatio||1);e.width=Math.floor(r*o),e.height=Math.floor(r*o);let s=e.getContext("2d");s&&(s.setTransform(o,0,0,o,0,0),this.ctx=s)};startCanvasLoop(){let e=()=>{this.drawFrame(),this.rafId=requestAnimationFrame(e)};this.rafId=requestAnimationFrame(e)}clearCanvas(e,t){e.clearRect(0,0,t,t)}drawFrame(){let e=this.gameCanvas?.nativeElement,t=this.ctx;if(!e||!t)return;let i=this.tdEngine.tileSize,r=this.tdEngine.gridSize*i;this.clearCanvas(t,r),this.drawGrid(t,i),this.drawPathOverlay(t,i),this.drawSelection(t,i),this.drawFrostAuras(t,i),this.drawTowers(t,i),this.drawEnemies(t,i),this.tdEngine.gameSpeedMultiplier()===1&&this.drawProjectiles(t,i),this.drawRangeIndicator(t,i)}drawPathOverlay(e,t){let i=this.tdEngine.getPathRef();if(!i||i.length<2)return;e.save(),e.strokeStyle="rgba(255,255,255,0.3)",e.setLineDash([10,10]),e.lineWidth=2,e.beginPath();for(let q=0;q<i.length;q++){let ye=i[q],ve=ye.x*t+t/2,xe=ye.y*t+t/2;q===0?e.moveTo(ve,xe):e.lineTo(ve,xe)}e.stroke(),e.setLineDash([]);let r=i[0],o=i[i.length-1],s=r.x*t+t/2,a=r.y*t+t/2,l=o.x*t+t/2,c=o.y*t+t/2;e.save(),e.translate(s,a);let d=t*.35;e.lineWidth=2,e.strokeStyle="rgba(56,189,248,0.95)",e.shadowColor="rgba(56,189,248,1)",e.shadowBlur=14,e.beginPath();let f=Math.PI*2*3,m=!0;for(let q=0;q<=f;q+=Math.PI/32){let ye=q/f,ve=d*(.4+.6*ye),xe=Math.cos(q)*ve,Ae=Math.sin(q)*ve;m?(e.moveTo(xe,Ae),m=!1):e.lineTo(xe,Ae)}e.stroke(),e.restore(),e.save(),e.translate(l,c);let w=t*.65,S=t*.7,k=w/2,V=S/2;e.fillStyle="rgba(248,113,113,0.95)",e.strokeStyle="#fecaca",e.lineWidth=2,e.shadowColor="rgba(248,113,113,0.9)",e.shadowBlur=10,e.beginPath(),e.moveTo(0,-V),e.lineTo(k,-V*.1),e.lineTo(k*.8,V),e.lineTo(-k*.8,V),e.lineTo(-k,-V*.2),e.closePath(),e.fill(),e.stroke(),e.restore(),e.restore()}drawGrid(e,t){let i=this.tdEngine.getGridRef();for(let r=0;r<i.length;r++){let o=i[r];for(let s=0;s<o.length;s++){let a=o[s];a.type==="path"?e.fillStyle="#475569":a.type==="buildable"?e.fillStyle="#1e293b":e.fillStyle="rgba(203, 23, 23, 0)",e.fillRect(s*t,r*t,t-2,t-2)}}}drawTowers(e,t){let i=this.tdEngine.getTowersRef(),r=this.tdEngine.getEnemiesRef(),o=this.tdEngine.gameSpeedMultiplier();for(let s of i){let a=s.position.x*t+t/2,l=s.position.y*t+t/2,c=t*.15;if(this.drawTowerShape(e,a,l,s.type,s.level,t),s.specialActive&&(e.save(),e.fillStyle="#00F2FF",e.shadowColor="black",e.shadowBlur=4,e.font=`bold ${Math.floor(t*.3)}px Arial`,e.textAlign="left",e.textBaseline="top",e.fillText("\u2605",a-t/2+c,l-t/2+c),e.restore()),s.specialActive&&s.hasGolden&&(e.save(),e.fillStyle="#FFD700",e.shadowColor="black",e.shadowBlur=4,e.font=`bold ${Math.floor(t*.3)}px Arial`,e.textAlign="right",e.textBaseline="top",e.fillText("\u26A1",a+t/2-c,l-t/2+c),e.restore()),o===1&&s.type===6&&s.targetEnemyId){let d=r.find(h=>h.id===s.targetEnemyId);if(d){let h=d.displayX??(d.position.x+.5)*t,f=d.displayY??(d.position.y+.5)*t;e.save();let m="rgba(56,189,248,0.9)";if(s.hasGolden){let w=e.createLinearGradient(a,l,h,f);w.addColorStop(0,"#22c1c3"),w.addColorStop(.5,"#a855f7"),w.addColorStop(1,"#f97316"),m=w}e.strokeStyle=m,e.lineWidth=2,e.beginPath(),e.moveTo(a,l),e.lineTo(h,f),e.stroke(),e.restore()}if(s.extraTargetIds&&s.extraTargetIds.length)for(let h of s.extraTargetIds){let f=r.find(k=>k.id===h);if(!f)continue;let m=f.displayX??(f.position.x+.5)*t,w=f.displayY??(f.position.y+.5)*t;e.save();let S="rgba(56,189,248,0.7)";if(s.hasGolden){let k=e.createLinearGradient(a,l,m,w);k.addColorStop(0,"#22c1c3"),k.addColorStop(.5,"#a855f7"),k.addColorStop(1,"#f97316"),S=k}e.strokeStyle=S,e.lineWidth=1.5,e.beginPath(),e.moveTo(a,l),e.lineTo(m,w),e.stroke(),e.restore()}}}}drawTowerShape(e,t,i,r,o,s){let a=s*.5,l=a/2,c=r===1?"#0ea5e9":r===2?"#a855f7":r===3?"#f59e0b":r===4?"#ef4444":r===5?"#fb923c":r===6?"#22d3ee":"#84cc16",d=2.5,h=Math.max(1,Math.min(4,o||1));if(e.save(),e.lineWidth=d,e.strokeStyle=c,h>=4&&(e.shadowColor=c,e.shadowBlur=16),e.beginPath(),r===1){let f=a*.5;e.arc(t,i,f,0,Math.PI*2)}else if(r===2){let f=a*.9,m=a*.9;e.moveTo(t,i-f/2),e.lineTo(t-m/2,i+f/2),e.lineTo(t+m/2,i+f/2),e.closePath()}else if(r===3)e.rect(t-l,i-l,a,a);else if(r===4){let f=a*.9,m=a*.9;e.moveTo(t,i-f/2),e.lineTo(t+m/2,i),e.lineTo(t,i+f/2),e.lineTo(t-m/2,i),e.closePath()}else if(r===5){let f=a*.5;for(let m=0;m<5;m++){let w=Math.PI*2*m/5-Math.PI/2,S=t+Math.cos(w)*f,k=i+Math.sin(w)*f;m===0?e.moveTo(S,k):e.lineTo(S,k)}e.closePath()}else if(r===6){let f=a*.5;for(let m=0;m<6;m++){let w=Math.PI/3*m-Math.PI/2,S=t+Math.cos(w)*f,k=i+Math.sin(w)*f;m===0?e.moveTo(S,k):e.lineTo(S,k)}e.closePath()}else if(r===7){let f=a*.5,m=.35;e.moveTo(t-f*m,i-f),e.lineTo(t+f*m,i-f),e.lineTo(t+f*m,i-f*m),e.lineTo(t+f,i-f*m),e.lineTo(t+f,i+f*m),e.lineTo(t+f*m,i+f*m),e.lineTo(t+f*m,i+f),e.lineTo(t-f*m,i+f),e.lineTo(t-f*m,i+f*m),e.lineTo(t-f,i+f*m),e.lineTo(t-f,i-f*m),e.lineTo(t-f*m,i-f*m),e.closePath()}if(h>=2&&(e.fillStyle=c,e.globalAlpha=h===2?.7:.9,e.fill(),e.globalAlpha=1),e.stroke(),h>=3){e.beginPath();let f=a*.18;e.arc(t,i,f,0,Math.PI*2),e.fillStyle="#0f172a",e.fill()}if(h>=4){e.beginPath();let f=a*.75;e.arc(t,i,f,0,Math.PI*2),e.setLineDash([2,4]),e.strokeStyle=c,e.globalAlpha=.5,e.stroke(),e.setLineDash([])}e.restore()}drawFrostAuras(e,t){let i=this.tdEngine.getTowersRef();for(let r of i)if(r.type===1&&r.specialActive){let o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=2*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.05)",e.fill(),e.lineWidth=1,e.strokeStyle="rgba(56, 189, 248, 0.1)",e.stroke()}}drawEnemies(e,t){let i=this.tdEngine.getEnemiesRef(),r=this.tdEngine.gameSpeedMultiplier(),o=r>1;for(let s of i){let l=(s.scale??1)*(t*.65),c=l/2,d=s.displayX??(s.position.x+.5)*t,h=s.displayY??(s.position.y+.5)*t;e.fillStyle=s.bg||(s.isFrozen?"#7dd3fc":"#ef4444");let f="transparent",m=o?"transparent":e.fillStyle,w=o?0:10,S=2;if(s.isMagma?(f="#f97316",m="#f97316",w=o?0:15,S=2):s.isMirror?(f="#f0f9ff",m="#0ea5e9",w=o?0:15,S=2):s.isSlime&&(f="#22c55e",m="#22c55e",w=o?0:15,S=2),e.shadowColor=m,e.shadowBlur=w,e.strokeStyle=f,e.lineWidth=S,e.beginPath(),s.type==="tank")e.arc(d,h,c,0,Math.PI*2);else if(s.type==="scout")e.moveTo(d,h-c),e.lineTo(d-c,h+c),e.lineTo(d+c,h+c),e.closePath();else if(s.type==="boss"){for(let V=0;V<6;V++){let q=Math.PI*2*V/6-Math.PI/2,ye=d+c*Math.cos(q),ve=h+c*Math.sin(q);V===0?e.moveTo(ye,ve):e.lineTo(ye,ve)}e.closePath()}else e.rect(d-c,h-c,l,l);e.fill(),f!=="transparent"&&e.stroke(),e.shadowBlur=0}for(let s of i){let a=(s.isBoss?1.5:1)*(t*.65),l=a/2,c=s.displayX??(s.position.x+.5)*t,d=s.displayY??(s.position.y+.5)*t,h=a,f=4,m=d-l-10;e.fillStyle="#0f172a",e.fillRect(c-l,d-l-10,h,f),e.fillStyle="#10b981";let w=Math.max(0,Math.min(1,s.hp/s.maxHp));e.fillRect(c-l,d-l-10,h*w,f);let S=s.venomStacks||0;if(r===1&&S>0){e.save();let k=3,V=6,q=2,ye=c-l,ve=m-V-2;e.fillStyle="#84cc16",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2;for(let xe=0;xe<S;xe++)e.fillRect(ye+xe*(k+q),ve,k,V);e.restore()}}}drawSelection(e,t){let i=this.selectedTile();if(!i)return;let r=i.x*t,o=i.y*t;e.save(),e.lineWidth=3,e.strokeStyle="rgba(56, 189, 248, 0.95)",e.shadowColor="rgba(56, 189, 248, 0.9)",e.shadowBlur=14,e.strokeRect(r+1.5,o+1.5,t-3,t-3),e.restore()}drawProjectiles(e,t){if(this.tdEngine.gameSpeedMultiplier()>=2)return;let r=this.tdEngine.getProjectilesRef();e.fillStyle="#fbbf24";for(let s of r){let a=s.from.x+(s.to.x-s.from.x)*s.progress,l=s.from.y+(s.to.y-s.from.y)*s.progress;e.beginPath(),e.arc(a*t+t/2,l*t+t/2,3,0,Math.PI*2),e.fill()}let o=this.tdEngine.getInfernoZonesRef();for(let s of o){if(s.dps<=0)continue;let a=s.position.x*t+t/2,l=s.position.y*t+t/2,c=s.radius*t;e.save(),e.beginPath(),e.arc(a,l,c,0,Math.PI*2),e.fillStyle="rgba(248, 113, 113, 0.15)",e.fill(),e.lineWidth=1,e.strokeStyle="rgba(248, 113, 113, 0.4)",e.setLineDash([4,4]),e.stroke(),e.restore()}}drawRangeIndicator(e,t){let i=this.selectedTile();if(!i||!i.tower)return;let r=i.tower,o=r.position.x*t+t/2,s=r.position.y*t+t/2,l=(r.type===1?this.tdEngine.getEffectiveRange(r):r.range)*t;e.beginPath(),e.arc(o,s,l,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.12)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56, 189, 248, 0.4)",e.stroke()}onCanvasClick(e){let t=this.gameCanvas?.nativeElement;if(!t)return;let i=t.getBoundingClientRect(),r=e.clientX-i.left,o=e.clientY-i.top,s=this.tdEngine.tileSize,a=Math.floor(r/s),l=Math.floor(o/s),c=this.tdEngine.getGridRef();l>=0&&l<c.length&&a>=0&&a<c[0].length&&this.onTileClick(c[l][a])}static \u0275fac=function(t){return new(t||n)(he(O0),he(gt),he($n),he(Rn),he(xi),he(va))};static \u0275cmp=It({type:n,selectors:[["app-tower-defense"]],viewQuery:function(t,i){if(t&1&&Ml(qq,5),t&2){let r;Rl(r=kl())&&(i.gameCanvas=r.first)}},hostBindings:function(t,i){t&1&&X("keydown",function(o){return i.onKeyDown(o)},ss)("keyup",function(o){return i.onKeyUp(o)},ss)("beforeunload",function(o){return i.unloadNotification(o)},ss)},decls:77,vars:80,consts:[["gameCanvas",""],[1,"flex","flex-col","h-full","p-4","overflow-hidden"],[1,"relative"],[1,"hud-overlay"],[1,"flex","items-center","justify-between","mb-4","bg-slate-800","p-3","rounded-lg","border","border-slate-700"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors",3,"click"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-4","py-2","bg-amber-600","hover:bg-amber-500","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"flex","flex-col","items-center","gap-1","font-black","tracking-wide"],[1,"flex","items-baseline","gap-6"],[1,"text-emerald-400","text-lg","font-mono"],[1,"text-rose-400","text-lg","font-mono"],[1,"text-sky-400","text-lg","font-mono"],[1,"flex","items-center","gap-4","text-xs"],[1,"flex","items-center","gap-1"],[1,"text-slate-400","mr-1"],[1,"px-2","py-0.5","rounded","border","text-[10px]","font-bold",3,"click"],[1,"cursor-pointer","bg-rose-600","hover:bg-rose-500","text-white","text-xs","font-bold","px-3","py-2","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-3","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"auto-wave-control"],[1,"flex","items-center","space-x-2","cursor-pointer"],["type","checkbox",1,"form-checkbox","h-5","w-5","text-blue-600",3,"change","checked"],[1,"text-white"],[1,"cursor-pointer","px-4","py-2","rounded","text-sm","font-black","transition-all",3,"click","disabled"],[1,"relative","flex","gap-4","flex-1","min-h-0","td-layout"],[1,"flex","items-center","gap-2","text-xs","font-bold","text-rose-400","absolute","top-2","left-2","z-5"],["type","checkbox",1,"accent-rose-500",3,"change","checked"],[1,"flex","items-center","gap-2","px-3","py-2","rounded","bg-white/5","border","border-white/10","absolute","bottom-2","left-2","z-5"],[1,"text-xs","text-slate-300"],[1,"text-xs","font-bold","text-slate-100","capitalize"],[1,"shape-preview",3,"ngClass"],[1,"absolute","bottom-2","right-70","z-5","cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"text-[14px]","font-bold","uppercase","tracking-tighter"],[1,"flex-1","relative","bg-slate-900","rounded-lg","overflow-auto","border","flex","items-center","justify-center","p-4","min-h-[400px]","td-main-area"],[1,"block","rounded","transition-opacity","duration-300","td-canvas",3,"click"],[1,"w-64","flex","flex-col","gap-4","td-sidebar"],[1,"flex-1","bg-slate-800","rounded-lg","border","border-slate-700","p-4","overflow-y-auto"],[1,"h-full","w-full","flex","flex-col","p-5","bg-slate-900/40","backdrop-blur-sm","rounded-xl","border","border-slate-700/50","shadow-inner","text-slate-300"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-5","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg"],[1,"text-lg","mobile-actions-hide-text"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-slate-950/70","backdrop-blur-sm","z-[200]"],[1,"text-xs","font-bold","text-slate-400","mb-4","uppercase","tracking-wider","flex","justify-between","items-center"],[1,"text-[10px]","font-normal","normal-case","text-slate-500"],[1,"flex","flex-col","gap-2","td-shop-list"],[1,"group","relative","flex","flex-col","p-3","rounded-lg","border","transition-all","duration-200","text-left","w-full",3,"disabled","bg-slate-800","border-slate-700","hover:border-sky-500","hover:bg-slate-700","opacity-50","bg-slate-900","border-transparent"],[1,"group","relative","flex","flex-col","p-3","rounded-lg","border","transition-all","duration-200","text-left","w-full",3,"click","disabled"],[1,"flex","justify-between","items-start","w-full","mb-1"],[1,"flex","items-center","gap-2"],[1,"w-2","h-2","rounded-full"],[1,"font-bold","text-sm","text-slate-100","uppercase","tracking-tight"],[1,"text-[14px]","text-slate-500","font-mono"],[1,"font-mono","font-bold"],[1,"text-[11px]","leading-relaxed","text-slate-400","group-hover:text-slate-200","transition-colors"],["class","absolute left-0 top-1/4 bottom-1/4 w-1 bg-sky-500 rounded-r opacity-0 group-hover:opacity-100 transition-opacity",4,"ngIf"],[1,"absolute","left-0","top-1/4","bottom-1/4","w-1","bg-sky-500","rounded-r","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"text-sm","font-bold","text-slate-400","mb-2","uppercase","tracking-wider"],[1,"bg-slate-900","rounded","p-3","mb-4"],[1,"flex","justify-between","mb-1"],[1,"text-xs","text-slate-500"],[1,"text-xs","font-bold"],[1,"text-xs","font-bold","text-rose-400"],[1,"text-xs","font-bold","text-sky-400"],[1,"flex","justify-between"],[1,"text-xs","font-bold","text-lime-400"],[1,"mt-3","text-[11px]","text-slate-300","leading-snug"],[1,"flex","flex-col","gap-2","td-shop-actions"],[1,"bg-slate-900","rounded","p-3","mb-2"],[1,"text-xs","text-slate-500","mb-1"],[1,"flex","flex-wrap","gap-1"],[1,"px-2","py-1","text-[10px]","rounded-full","border","border-slate-600",3,"click"],[1,"cursor-pointer","w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"disabled"],[1,"w-full","py-3","bg-slate-900","text-slate-500","rounded","text-center","font-bold","border","border-slate-700"],[1,"cursor-pointer","w-full","py-3","bg-rose-700","hover:bg-rose-600","rounded","font-bold","transition-all","flex","justify-center","items-center","text-sm",3,"click"],[1,"cursor-pointer","w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"font-mono"],[1,"cursor-pointer","w-full","py-3","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"mt-4","pt-4","border-t","border-white/10","space-y-2"],[1,"text-blue-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-gray-400","text-sm","leading-relaxed"],[1,"text-yellow-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-red-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-purple-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"mb-2"],[1,"text-xl"],[1,"text-lg","font-black","tracking-tight","text-white","uppercase","italic"],[1,"text-[11px]","text-slate-500","leading-tight","mt-1"],[1,"flex-1","space-y-4","overflow-y-auto","pr-2","custom-scrollbar"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-[10px]","text-slate-500","uppercase","font-bold","tracking-tighter"],[1,"text-xs","font-mono","text-white","font-bold"],[1,"group","flex","flex-col","gap-1.5","transition-all","duration-300","hover:translate-x-1"],[1,"h-full","flex","flex-col","items-center","justify-center","opacity-30","italic","text-sm"],[1,"mb-6","pb-2","border-t","border-slate-800","text-center"],[1,"text-[10px]","text-slate-600","uppercase","tracking-[0.2em]"],[1,"flex","justify-between","items-end"],[1,"w-1.5","h-1.5","rounded-full","shadow-[0_0_8px]"],[1,"text-xs","font-bold","uppercase","tracking-wide","text-slate-200","group-hover:text-white","transition-colors"],[1,"font-mono","text-xs","font-bold"],[1,"relative","h-2.5","w-full","bg-slate-800/80","rounded-full","overflow-hidden","border","border-slate-700/30"],[1,"absolute","inset-0","opacity-10"],[1,"h-full","rounded-full","shadow-lg","transition-all","duration-700","ease-out","relative"],[1,"absolute","inset-0","bg-white/10","w-full","h-[1px]","top-0"],[1,"bg-slate-900","border","border-slate-700","rounded-lg","px-8","py-6","text-center","shadow-xl"],[1,"text-2xl","font-black","text-rose-400","mb-2"],[1,"text-slate-300","mb-4"],[1,"bg-emerald-600","hover:bg-emerald-500","text-white","font-bold","px-6","py-2","rounded",3,"click"]],template:function(t,i){if(t&1){let r=je();y(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"button",6),X("click",function(){return Z(r),ee(i.goBack())}),v(6),_(),y(7,"button",7),X("click",function(){return Z(r),ee(i.router.navigate(["/tower-defense-leaderboard"]))}),v(8),_(),y(9,"button",8),X("click",function(){return Z(r),ee(i.router.navigate(["/masteries"]))}),v(10),_()(),y(11,"div",9)(12,"div",10)(13,"div",11),v(14),_(),y(15,"div",12),v(16),_(),y(17,"div",13),v(18),_()(),y(19,"div",14)(20,"div",15)(21,"span",16),v(22,"Speed:"),_(),y(23,"button",17),X("click",function(){return Z(r),ee(i.setSpeed(1))}),v(24," 1x "),_(),y(25,"button",17),X("click",function(){return Z(r),ee(i.setSpeed(2))}),v(26," 2x "),_(),y(27,"button",17),X("click",function(){return Z(r),ee(i.setSpeed(4))}),v(28," 4x "),_()(),y(29,"div",15)(30,"span",16),v(31,"Map Size:"),_(),y(32,"button",17),X("click",function(){return Z(r),ee(i.onMapSizeChange(1))}),v(33," Small (10x10) "),_(),y(34,"button",17),X("click",function(){return Z(r),ee(i.onMapSizeChange(2))}),v(35," Large (20x20) "),_()()()(),y(36,"div",5)(37,"button",18),X("click",function(){return Z(r),ee(i.onRestart())}),v(38),_(),y(39,"button",19),X("click",function(){return Z(r),ee(i.onLoginClick())}),v(40),_(),y(41,"div",20)(42,"label",21)(43,"input",22),X("change",function(){return Z(r),ee(i.autoWave.set(!i.autoWave()))}),_(),y(44,"span",23),v(45,"Auto"),_()()(),y(46,"button",24),X("click",function(){return Z(r),ee(i.tdEngine.startWave())}),v(47),_()()()()(),y(48,"div",25)(49,"label",26)(50,"input",27),X("change",function(s){return Z(r),ee(i.setHardMode(s.target.checked))}),_(),v(51," Hard Mode "),_(),y(52,"div",28)(53,"span",29),v(54,"Next:"),_(),y(55,"span",30),v(56),_(),W(57,"span",31),_(),y(58,"button",32),X("click",function(){return Z(r),ee(i.navigateToFeedback())}),ie(),y(59,"svg",33),W(60,"path",34),_(),Oe(),y(61,"span",35),v(62),_()(),y(63,"div",36)(64,"canvas",37,0),X("click",function(s){return Z(r),ee(i.onCanvasClick(s))}),_()(),y(66,"div",38)(67,"div",39),Y(68,hK,2,1)(69,gK,23,9,"div",40),_()(),y(70,"button",41),X("click",function(){return Z(r),ee(i.gameEngine.toggleSupport())}),y(71,"span",42),v(72,"\u2764\uFE0F"),_(),y(73,"span",43),v(74),_()(),Y(75,mK,1,0,"app-support-community"),_(),Y(76,yK,8,5,"div",44),_()}if(t&2){let r,o;g(6),L(" ",i.settings.t("EXIT_GAME")," "),g(2),L(" ",i.settings.t("RANKING")," "),g(2),L(" ",i.settings.t("MASTERIES")," "),g(4),Rt("",i.settings.t("MONEY"),": $",i.tdEngine.money()),g(2),Rt("",i.settings.t("LIVES"),": ",i.tdEngine.lives()),g(2),Rt("",i.settings.t("WAVE"),": ",i.tdEngine.wave()),g(5),Te("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===1)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===1)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==1)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==1),g(2),Te("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===2)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===2)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==2)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==2),g(2),Te("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===4)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===4)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==4)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==4),g(5),Te("bg-slate-200",i.mapLevel()===1)("text-slate-900",i.mapLevel()===1)("bg-slate-800",i.mapLevel()!==1)("text-slate-300",i.mapLevel()!==1),g(2),Te("bg-slate-200",i.mapLevel()===2)("text-slate-900",i.mapLevel()===2)("bg-slate-800",i.mapLevel()!==2)("text-slate-300",i.mapLevel()!==2),g(4),L(" ",i.settings.t("RESTART_GAME")," "),g(2),L(" ",i.firebase.user$()?((r=i.firebase.user$())==null?null:r.displayName)||"Account":"Login to Save Score"," "),g(3),Se("checked",i.autoWave()),g(3),Te("bg-sky-600",!i.tdEngine.isWaveInProgress())("hover:bg-sky-500",!i.tdEngine.isWaveInProgress())("bg-slate-700",i.tdEngine.isWaveInProgress())("text-slate-500",i.tdEngine.isWaveInProgress()),Se("disabled",i.tdEngine.isWaveInProgress()),g(),L(" ",i.tdEngine.isWaveInProgress()?i.settings.t("WAVE_IN_PROGRESS"):i.settings.t("START_WAVE")," "),g(3),Se("checked",i.tdEngine.isHardMode()),g(6),j(i.tdEngine.nextWaveEnemyType()),g(),Je("background",i.tdEngine.nextWaveEnemyType()==="tank"?"hsl(330,70%,60%)":i.tdEngine.nextWaveEnemyType()==="scout"?"hsl(50,90%,60%)":"hsl(200,70%,60%)"),Se("ngClass",vE(76,Kq,i.tdEngine.nextWaveEnemyType()==="tank",i.tdEngine.nextWaveEnemyType()==="scout",i.tdEngine.nextWaveEnemyType()==="standard")),g(5),j(i.settings.t("FEEDBACK_MODULE")),g(),Te("border-rose-600",i.tdEngine.isHardMode())("shadow-[0_0_25px_rgba(248,113,113,0",i.tdEngine.isHardMode()),g(5),Q((o=i.selectedTile())?68:69,o),g(6),j(i.settings.t("SUPPORT")),g(),Q(i.gameEngine.supportOpen()?75:-1),g(),Q(i.tdEngine.gameOver()?76:-1)}},dependencies:[Nt,Ju,go,Tc,P0],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"[_nghost-%COMP%]{display:block;height:100vh;background:#0f172a;color:#fff}.td-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,60px);grid-template-rows:repeat(10,60px);gap:2px;background:#1e293b;border:4px solid #334155;border-radius:8px;position:relative}.td-tile[_ngcontent-%COMP%]{position:relative;width:60px;height:60px;transition:all .2s;overflow:hidden}.tile-path[_ngcontent-%COMP%]{background:#475569}.tile-buildable[_ngcontent-%COMP%]{background:#1e293b;cursor:pointer}.tile-buildable[_ngcontent-%COMP%]:hover{background:#334155}.tile-void[_ngcontent-%COMP%]{opacity:.1}.range-indicator[_ngcontent-%COMP%]{position:absolute;background:#38bdf826;border:2px solid rgba(56,189,248,.5);border-radius:50%;pointer-events:none;z-index:50;transform:translate(-50%,-50%);transition:all .2s ease-out}.frost-aura-visual[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:248px;height:248px;transform:translate(-50%,-50%);border-radius:50%;background:#00ffff1a;border:1px solid rgba(0,255,255,.3);pointer-events:none;z-index:5;box-shadow:0 0 15px #0ff3}.enemy[_ngcontent-%COMP%]{position:absolute;width:40px;height:40px;background:#ef4444;border-radius:50%;z-index:10;box-shadow:0 0 10px #ef4444;display:flex;align-items:center;justify-content:center}.enemy-fast[_ngcontent-%COMP%]{box-shadow:none}.projectile[_ngcontent-%COMP%]{position:absolute;width:6px;height:6px;background:#fbbf24;border-radius:50%;z-index:20;box-shadow:0 0 5px #fbbf24}.shop-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.25rem;font-weight:700;transition:all .2s}.shop-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.shape-preview[_ngcontent-%COMP%]{width:18px;height:18px;display:inline-block;background:#fff3}.shape-square[_ngcontent-%COMP%]{border-radius:4px}.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.shape-triangle[_ngcontent-%COMP%]{clip-path:polygon(50% 0%,0% 100%,100% 100%)}.shape-hexagon[_ngcontent-%COMP%]{clip-path:polygon(25% 5%,75% 5%,100% 50%,75% 95%,25% 95%,0% 50%)}.td-shop-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{box-shadow:inset 0 1px #ffffff0d}.td-shop-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active:not([disabled]){transform:scale(.98)}.td-shop-list[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{cursor:not-allowed;filter:grayscale(.8)}@media(max-width:900px){.td-layout[_ngcontent-%COMP%]{flex-direction:column}.td-main-area[_ngcontent-%COMP%]{width:100vw;max-width:100vw;margin-left:-1rem;margin-right:-1rem;padding:.5rem;min-height:auto}.td-sidebar[_ngcontent-%COMP%]{width:100%}.td-canvas[_ngcontent-%COMP%]{width:100vw;max-width:100vw;touch-action:none}.td-shop-list[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;gap:.5rem;overflow-x:auto;padding-bottom:.5rem}.td-shop-list[_ngcontent-%COMP%]   .shop-btn[_ngcontent-%COMP%]{min-width:72px;min-height:50px}.td-shop-actions[_ngcontent-%COMP%]{position:sticky;bottom:0;background:#0f172af5;padding-top:.5rem}}"],changeDetection:0})};function vK(n,e){n&1&&(y(0,"div",8)(1,"span",9),W(2,"span",10),y(3,"span"),v(4,"Loading leaderboard..."),_()()())}function _K(n,e){if(n&1&&(y(0,"tr",18)(1,"td",19),v(2),_(),y(3,"td",20),v(4),_(),y(5,"td",21),v(6),_(),y(7,"td",19),v(8),_(),y(9,"td",19),v(10),_(),y(11,"td",22),v(12),Xn(13,"date"),Xn(14,"date"),_()()),n&2){let t=e.$implicit,i=e.index;g(2),j(i+1),g(2),L(" ",t.displayName||"Anonymous"," "),g(2),L(" ",t.maxWave," "),g(2),L(" ",t.mapSize||"10x10"," "),g(2),L(" ",t.userTotalXp??0," "),g(2),L(" ",t.timestamp!=null&&t.timestamp.toDate?ir(13,6,t.timestamp.toDate(),"mediumDate"):ir(14,9,t.timestamp,"mediumDate")," ")}}function EK(n,e){n&1&&(y(0,"tr")(1,"td",23),v(2," No runs recorded yet. Finish a game while logged in to appear here. "),_()())}function bK(n,e){if(n&1&&(y(0,"div",24)(1,"div",25),v(2," Your Personal Best "),_(),y(3,"table",13)(4,"tbody")(5,"tr",18)(6,"td",26),v(7," Your Best "),_(),y(8,"td",20),v(9),_(),y(10,"td",21),v(11),_(),y(12,"td",19),v(13),_(),y(14,"td",19),v(15),_(),y(16,"td",22),v(17),Xn(18,"date"),Xn(19,"date"),_()()()()()),n&2){let t=e.ngIf;g(9),L(" ",t.displayName||"You"," "),g(2),L(" ",t.maxWave," "),g(2),L(" ",t.mapSize||"10x10"," "),g(2),L(" ",t.userTotalXp??0," "),g(2),L(" ",t.timestamp!=null&&t.timestamp.toDate?ir(18,5,t.timestamp.toDate(),"mediumDate"):ir(19,8,t.timestamp,"mediumDate")," ")}}function wK(n,e){if(n&1){let t=je();y(0,"div")(1,"div",11)(2,"button",12),X("click",function(){Z(t);let r=N();return ee(r.selectMapSize(10))}),v(3," Map 10x10 "),_(),y(4,"button",12),X("click",function(){Z(t);let r=N();return ee(r.selectMapSize(20))}),v(5," Map 20x20 "),_()(),y(6,"table",13)(7,"thead")(8,"tr",14)(9,"th",15),v(10,"Rank"),_(),y(11,"th",15),v(12,"Name"),_(),y(13,"th",15),v(14,"Wave"),_(),y(15,"th",15),v(16,"Map"),_(),y(17,"th",15),v(18,"Mastery XP"),_(),y(19,"th",15),v(20,"Date"),_()()(),y(21,"tbody"),Ut(22,_K,15,12,"tr",16)(23,EK,3,0,"tr",7),_()(),Ut(24,bK,20,11,"div",17),_()}if(n&2){let t=N();g(2),Te("bg-sky-500",t.selectedMapSize()===10)("text-slate-900",t.selectedMapSize()===10)("text-slate-300",t.selectedMapSize()!==10),g(2),Te("bg-sky-500",t.selectedMapSize()===20)("text-slate-900",t.selectedMapSize()===20)("text-slate-300",t.selectedMapSize()!==20),g(18),Se("ngForOf",t.scores()),g(),Se("ngIf",t.scores().length===0),g(),Se("ngIf",t.best())}}var L0=class n{constructor(e,t){this.firebase=e;this.settings=t}loading=$(!0);scores=$([]);best=$(null);selectedMapSize=$(10);displayScores=Bn(()=>this.scores());ngOnInit(){this.settings.mapSize()===20?this.selectedMapSize.set(20):this.selectedMapSize.set(10),this.loadScores()}async loadScores(){this.loading.set(!0);let e=this.selectedMapSize();try{let t=await this.firebase.getTopTowerDefenseScores(10,e);this.scores.set(t??[]),await this.loadPersonalBest(e)}catch{this.scores.set([])}finally{this.loading.set(!1)}}async loadPersonalBest(e){let t=this.firebase.user$();if(!t)return;let i=await this.firebase.getUserBestTowerDefenseScore(t.uid,e);this.best.set(i??null)}selectMapSize(e){this.selectedMapSize()!==e&&(this.selectedMapSize.set(e),this.loadScores())}static \u0275fac=function(t){return new(t||n)(he(Rn),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-tower-defense-leaderboard"]],decls:11,vars:3,consts:[[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center","py-10","px-4"],[1,"w-full","max-w-3xl","bg-slate-800","border","border-slate-700","rounded-lg","shadow-xl","p-6"],["routerLink","/tower-defense",1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors"],[1,"flex","items-center","justify-between","mb-4","mt-4"],[1,"text-2xl","font-black","tracking-wide"],[1,"mb-4","text-sm","text-slate-300"],["class","min-h-[80px] flex items-center justify-center",4,"ngIf"],[4,"ngIf"],[1,"min-h-[80px]","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-slate-300"],[1,"w-4","h-4","border-2","border-slate-500","border-t-transparent","rounded-full","animate-spin"],[1,"mb-4","inline-flex","rounded-full","bg-slate-900/70","p-1","border","border-slate-700"],[1,"px-4","py-1","text-xs","font-semibold","rounded-full","transition-colors",3,"click"],[1,"w-full","text-sm"],[1,"text-slate-300"],[1,"text-left","py-2","px-2","border-b","border-slate-700"],["class","text-white",4,"ngFor","ngForOf"],["class","mt-6 pt-4 border-t border-slate-700",4,"ngIf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-sky-300"],[1,"py-2","px-2","border-b","border-slate-800"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-emerald-400"],[1,"py-2","px-2","border-b","border-slate-800","text-slate-300"],["colspan","6",1,"py-8","text-center","text-slate-400","italic"],[1,"mt-6","pt-4","border-t","border-slate-700"],[1,"text-xs","font-semibold","text-slate-400","mb-2"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-amber-300"]],template:function(t,i){t&1&&(y(0,"div",0)(1,"div",1)(2,"a",2),v(3),_(),y(4,"div",3)(5,"h1",4),v(6,"Tower Defense Leaderboard"),_()(),y(7,"div",5),v(8," Top 10 runs ranked by highest wave reached. "),_(),Ut(9,vK,5,0,"div",6)(10,wK,25,15,"div",7),_()()),t&2&&(g(3),j(i.settings.t("RETURN_TO_MAP")),g(6),Se("ngIf",i.loading()),g(),Se("ngIf",!i.loading()))},dependencies:[Nt,ps,go,Fr,_a],encapsulation:2})};function xK(n,e){if(n&1&&(y(0,"div",22),W(1,"span",23),y(2,"span",24),v(3),_()()),n&2){let t=N(2);g(3),L(" ",t.settings.t("SAVED")," ")}}function SK(n,e){if(n&1&&(y(0,"div",16)(1,"div",17)(2,"span",18),v(3),_(),y(4,"span",19),v(5),_()(),y(6,"div",17)(7,"span",18),v(8),_(),y(9,"span",20),v(10),_()(),Ut(11,xK,4,1,"div",21),_()),n&2){let t,i=N();g(3),j(i.settings.t("TOTAL_XP")),g(2),j((t=i.profile())==null?null:t.totalXp),g(3),j(i.settings.t("AVAILABLE")),g(2),j(i.availablePoints()),g(),Se("ngIf",i.isSaved()&&!i.saving())}}function IK(n,e){if(n&1&&(y(0,"div",25),v(1),_()),n&2){let t=N();g(),L(" ",t.settings.t("LOG_IN_MASTERY_MSG")," ")}}function TK(n,e){if(n&1){let t=je();y(0,"div",26)(1,"div",27)(2,"span",28),v(3,"\u{1F512}"),_()(),y(4,"p",29),v(5),_(),y(6,"button",30),X("click",function(){Z(t);let r=N();return ee(r.login())}),v(7),_()()}if(n&2){let t=N();g(5),j(t.settings.t("NEED_LOG_IN")),g(2),L(" ",t.settings.t("LOGIN_GOOGLE")," ")}}function CK(n,e){if(n&1&&(y(0,"span",76),v(1),_()),n&2){let t=N().$implicit,i=N(2);g(),Rt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"damage")," XP ")}}function DK(n,e){if(n&1&&(y(0,"span",77),v(1),_()),n&2){let t=N(3);g(),L(" ",t.settings.t("MAXED")," ")}}function AK(n,e){if(n&1&&(y(0,"span",76),v(1),_()),n&2){let t=N().$implicit,i=N(2);g(),Rt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"range")," XP ")}}function MK(n,e){if(n&1&&(y(0,"span",77),v(1),_()),n&2){let t=N(3);g(),L(" ",t.settings.t("MAXED")," ")}}function RK(n,e){if(n&1&&(y(0,"div",78)(1,"div",79),v(2),_()()),n&2){let t=N(3);g(2),L(" \u{1F512} ",t.settings.t("REQUIRES_5_POINTS")," ")}}function kK(n,e){if(n&1&&(y(0,"span",80),v(1),_()),n&2){let t=N().$implicit,i=N(2);g(),Rt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"golden")," XP ")}}function NK(n,e){if(n&1&&(y(0,"span",77),v(1),_()),n&2){let t=N(3);g(),L(" ",t.settings.t("MAXED")," ")}}function PK(n,e){if(n&1){let t=je();y(0,"div",53)(1,"div",54)(2,"div",55)(3,"div",56),v(4),_(),W(5,"div",57),_(),y(6,"h3",58),v(7),_(),y(8,"div",59)(9,"div",60)(10,"div",61)(11,"div",62),v(12),_(),y(13,"div",63),v(14),_()(),y(15,"div",16)(16,"div",40)(17,"span",41),v(18),_(),Ut(19,CK,2,2,"span",64)(20,DK,2,1,"ng-template",null,2,ho),_(),y(22,"button",65),X("click",function(){let r=Z(t).$implicit,o=N(2);return ee(o.increaseBasic(r.id,"damage"))}),v(23," + "),_()()(),y(24,"div",60)(25,"div",61)(26,"div",62),v(27),_(),y(28,"div",63),v(29),_()(),y(30,"div",16)(31,"div",40)(32,"span",41),v(33),_(),Ut(34,AK,2,2,"span",64)(35,MK,2,1,"ng-template",null,3,ho),_(),y(37,"button",65),X("click",function(){let r=Z(t).$implicit,o=N(2);return ee(o.increaseBasic(r.id,"range"))}),v(38," + "),_()()()()(),y(39,"div",66)(40,"div",67)(41,"div",61)(42,"div",68),v(43),_(),y(44,"div",69),v(45),_(),Ut(46,RK,3,1,"div",70),_(),y(47,"div",71)(48,"div",72)(49,"span",73),v(50),_(),Ut(51,kK,2,2,"span",74)(52,NK,2,1,"ng-template",null,4,ho),_(),y(54,"button",75),X("click",function(){let r=Z(t).$implicit,o=N(2);return ee(o.increaseGolden(r.id))}),v(55," + "),_()()()()()}if(n&2){let t=e.$implicit,i=tr(21),r=tr(36),o=tr(53),s=N(2);g(4),Rt(" ",s.settings.t("TIER")," ",t.id," "),g(),Se("ngClass",t.color.replace("text","bg")),g(),Se("ngClass",t.color),g(),L(" ",s.settings.t(t.nameKey)," "),g(5),j(s.settings.t("DAMAGE")),g(2),L("+5% ",s.settings.t("PER_LEVEL")),g(4),L(" ",s.getUpgradeLevel(t.id,"damage")," / 20 "),g(),Se("ngIf",s.getUpgradeLevel(t.id,"damage")<20)("ngIfElse",i),g(3),Te("bg-emerald-500",s.canIncreaseBasic(t.id,"damage"))("border-emerald-400",s.canIncreaseBasic(t.id,"damage"))("text-slate-900",s.canIncreaseBasic(t.id,"damage"))("hover:scale-110",s.canIncreaseBasic(t.id,"damage")),Se("disabled",!s.canIncreaseBasic(t.id,"damage")),g(5),j(s.settings.t("RANGE")),g(2),L("+0.1 ",s.settings.t("PER_LEVEL")),g(4),L(" ",s.getUpgradeLevel(t.id,"range")," / 20 "),g(),Se("ngIf",s.getUpgradeLevel(t.id,"range")<20)("ngIfElse",r),g(3),Te("bg-emerald-500",s.canIncreaseBasic(t.id,"range"))("border-emerald-400",s.canIncreaseBasic(t.id,"range"))("text-slate-900",s.canIncreaseBasic(t.id,"range"))("hover:scale-110",s.canIncreaseBasic(t.id,"range")),Se("disabled",!s.canIncreaseBasic(t.id,"range")),g(6),L(" ",s.settings.t(t.goldenTitleKey)," "),g(2),L(" ",s.settings.t(t.goldenDescriptionKey)," "),g(),Se("ngIf",!s.canUnlockGolden(t.id)),g(4),L(" ",s.getUpgradeLevel(t.id,"golden")," / 3 "),g(),Se("ngIf",s.getUpgradeLevel(t.id,"golden")<3)("ngIfElse",o),g(3),Te("bg-amber-500",s.canIncreaseGolden(t.id))("border-amber-400",s.canIncreaseGolden(t.id))("text-slate-950",s.canIncreaseGolden(t.id))("hover:scale-110",s.canIncreaseGolden(t.id)),Se("disabled",!s.canIncreaseGolden(t.id))}}function OK(n,e){n&1&&W(0,"span",51)}function FK(n,e){if(n&1){let t=je();y(0,"div",31)(1,"div",16),W(2,"div",32),y(3,"p",33),v(4),_(),W(5,"div",32),_(),y(6,"div",34),Ut(7,PK,56,48,"div",35),_(),y(8,"div",36)(9,"div",37)(10,"div")(11,"div",38),v(12),_(),y(13,"div",39),v(14),_()(),y(15,"div",16)(16,"div",40)(17,"span",41),v(18),_()(),y(19,"button",42),X("click",function(){Z(t);let r=N();return ee(r.increaseGold())}),v(20," + "),_()()(),y(21,"div",43),v(22),_()()(),y(23,"div",44)(24,"div",45)(25,"span",46),v(26,"\u2139\uFE0F"),_(),y(27,"p",47),v(28),_()(),y(29,"div",48)(30,"button",49),X("click",function(){Z(t);let r=N();return ee(r.save())}),y(31,"span",50),Y(32,OK,1,0,"span",51),v(33),_(),W(34,"div",52),_()()()}if(n&2){let t=N();g(4),j(t.settings.t("MASTERIES_SUBTITLE")),g(3),Se("ngForOf",t.tiers),g(5),L(" ",t.settings.t("GOLD_MASTERY")," "),g(2),Rt(" ",t.settings.t("COST"),": ",t.getGoldNextLevelCost()," XP "),g(4),L(" ",t.getGoldMasteryLevel()," / 20 "),g(),Te("bg-emerald-500",t.canIncreaseGold())("border-emerald-400",t.canIncreaseGold())("text-slate-900",t.canIncreaseGold())("hover:scale-110",t.canIncreaseGold()),Se("disabled",!t.canIncreaseGold()),g(3),L(" ",t.settings.t("GOLD_MASTERY_INFO")," "),g(6),j(t.settings.t("LOCAL_STORAGE_MSG")),g(2),Te("bg-emerald-600",t.profile()&&!t.saving())("text-white",t.profile()&&!t.saving())("shadow-[0_0_30px_rgba(16,185,129,0",t.profile()&&!t.saving())("bg-slate-700",!t.profile()||t.saving()),Se("disabled",!t.profile()||t.saving()||t.isSaved()),g(2),Q(t.saving()?32:-1),g(),L(" ",t.saving()?t.settings.t("SAVING"):t.settings.t("SAVE_CHANGES")," ")}}var V0=class n{constructor(e,t){this.firebase=e;this.settings=t}static BASIC_COST_MULTIPLIER=5;static GOLDEN_COST=150;static GOLDEN_MAX_LEVEL=3;static GOLDEN_LEVEL_COSTS={1:50,2:150,3:400};tiers=[{id:1,nameKey:"T1_NAME",color:"text-sky-400",goldenTitleKey:"T1_GOLDEN_TITLE",goldenDescriptionKey:"T1_GOLDEN_DESC"},{id:2,nameKey:"T2_NAME",color:"text-purple-400",goldenTitleKey:"T2_GOLDEN_TITLE",goldenDescriptionKey:"T2_GOLDEN_DESC"},{id:3,nameKey:"T3_NAME",color:"text-amber-400",goldenTitleKey:"T3_GOLDEN_TITLE",goldenDescriptionKey:"T3_GOLDEN_DESC"},{id:4,nameKey:"T4_NAME",color:"text-rose-400",goldenTitleKey:"T4_GOLDEN_TITLE",goldenDescriptionKey:"T4_GOLDEN_DESC"},{id:5,nameKey:"T5_NAME",color:"text-orange-400",goldenTitleKey:"T5_GOLDEN_TITLE",goldenDescriptionKey:"T5_GOLDEN_DESC"},{id:6,nameKey:"T6_NAME",color:"text-cyan-400",goldenTitleKey:"T6_GOLDEN_TITLE",goldenDescriptionKey:"T6_GOLDEN_DESC"},{id:7,nameKey:"T7_NAME",color:"text-lime-400",goldenTitleKey:"T7_GOLDEN_TITLE",goldenDescriptionKey:"T7_GOLDEN_DESC"}];saving=$(!1);isSaved=$(!1);ngOnInit(){}user(){return this.firebase.user$()}profile(){return this.firebase.masteryProfile()}availablePoints(){let e=this.firebase.masteryProfile();if(!e)return 0;let t=e.totalXp-e.usedPoints;return t>0?t:0}keyFor(e,t){return`t${e}_${t}`}getUpgradeLevel(e,t){let i=this.firebase.masteryProfile();if(!i)return 0;let r=this.keyFor(e,t),o=i.upgrades?.[r];return typeof o=="number"?o:0}getNextLevelCost(e,t){let i=this.getUpgradeLevel(e,t);if(t==="golden"){let r=i+1;return r>n.GOLDEN_MAX_LEVEL?0:n.GOLDEN_LEVEL_COSTS[r]??0}return i>=20?0:(i+1)*n.BASIC_COST_MULTIPLIER}canIncreaseBasic(e,t){if(this.getUpgradeLevel(e,t)>=20)return!1;let r=this.getNextLevelCost(e,t);return r<=0||!this.profile()||this.availablePoints()<r?!1:!!this.profile()}getGoldMasteryLevel(){let e=this.firebase.masteryProfile();if(!e||!e.upgrades)return 0;let t=e.upgrades.gold_mastery;return typeof t=="number"?t:0}getGoldNextLevelCost(){let e=this.getGoldMasteryLevel();return e>=20?0:(e+1)*n.BASIC_COST_MULTIPLIER}canIncreaseGold(){if(this.getGoldMasteryLevel()>=20||!this.profile())return!1;let t=this.getGoldNextLevelCost();return!(t<=0||this.availablePoints()<t)}increaseGold(){if(!this.canIncreaseGold())return;let e=this.getGoldNextLevelCost();e<=0||(this.updateProfile(t=>{let r=(typeof t.upgrades?.gold_mastery=="number"?t.upgrades.gold_mastery:0)+1,o=ce(F({},t.upgrades),{gold_mastery:r});return ce(F({},t),{usedPoints:t.usedPoints+e,upgrades:o})}),this.isSaved.set(!1))}updateProfile(e){let t=this.firebase.masteryProfile();if(!t)return;let i=e(t);this.firebase.setMasteryProfile(i)}increaseBasic(e,t){if(!this.canIncreaseBasic(e,t))return;let i=this.getNextLevelCost(e,t);i<=0||(this.updateProfile(r=>{let o=this.keyFor(e,t),s=r.upgrades?.[o]??0,a=ce(F({},r.upgrades),{[o]:s+1});return ce(F({},r),{usedPoints:r.usedPoints+i,upgrades:a})}),this.isSaved.set(!1))}canUnlockGolden(e){let t=this.getUpgradeLevel(e,"damage"),i=this.getUpgradeLevel(e,"range");return t+i>=15}canIncreaseGolden(e){if(!this.profile()||!this.canUnlockGolden(e)||this.getUpgradeLevel(e,"golden")>=n.GOLDEN_MAX_LEVEL)return!1;let i=this.getNextLevelCost(e,"golden");return!(this.availablePoints()<i)}increaseGolden(e){if(!this.canIncreaseGolden(e))return;let t=this.getNextLevelCost(e,"golden");t<=0||(this.updateProfile(i=>{let r=this.keyFor(e,"golden"),o=i.upgrades?.[r]??0,s=ce(F({},i.upgrades),{[r]:o+1});return ce(F({},i),{usedPoints:i.usedPoints+t,upgrades:s})}),this.isSaved.set(!1))}async save(){if(this.profile()){this.saving.set(!0);try{await this.firebase.saveTowerDefenseMasteries()}catch{}finally{this.saving.set(!1),this.isSaved.set(!0)}}}login(){this.firebase.loginWithGoogle()}static \u0275fac=function(t){return new(t||n)(he(Rn),he(gt))};static \u0275cmp=It({type:n,selectors:[["app-masteries"]],decls:18,vars:6,consts:[["noProfile",""],["loggedInBlock",""],["dmgMaxed",""],["rangeMaxed",""],["goldenMaxed",""],[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center"],[1,"min-h-screen","bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))]","from-slate-800","via-slate-900","to-black","text-white","flex","flex-col","items-center","py-4","px-4","selection:bg-sky-500/30"],[1,"w-full","max-w-6xl","bg-slate-800/50","backdrop-blur-md","border","border-slate-700/50","rounded-2xl","shadow-2xl","overflow-hidden"],[1,"p-6","border-b","border-slate-700/50","bg-slate-900/40","flex","flex-col","md:flex-row","items-center","justify-between","gap-6"],[1,"flex","items-center","gap-4"],["routerLink","/tower-defense",1,"group","flex","items-center","gap-2","px-5","py-2.5","bg-slate-700/50","hover:bg-slate-600","rounded-xl","text-sm","font-bold","transition-all","border","border-slate-600/50","hover:border-sky-500/50","shadow-lg"],[1,"group-hover:-translate-x-1","transition-transform"],[1,"text-3xl","font-black","tracking-tighter","uppercase","italic","text-transparent","bg-clip-text","bg-gradient-to-r","from-white","to-slate-400"],["class","flex items-center gap-3",4,"ngIf","ngIfElse"],[1,"p-8"],["class","flex flex-col items-center justify-center py-20 text-center",4,"ngIf","ngIfElse"],[1,"flex","items-center","gap-3"],[1,"flex","flex-col","items-end","px-4","py-2","bg-black/30","rounded-xl","border","border-slate-700/50"],[1,"text-[10px]","uppercase","font-bold","text-slate-500"],[1,"font-mono","text-lg","text-emerald-400","leading-none"],[1,"font-mono","text-lg","text-sky-400","leading-none"],["class","flex items-center gap-2 px-3 py-1 bg-emerald-500/10 rounded-xl border border-emerald-500/30",4,"ngIf"],[1,"flex","items-center","gap-2","px-3","py-1","bg-emerald-500/10","rounded-xl","border","border-emerald-500/30"],[1,"w-2","h-2","rounded-full","bg-emerald-400","animate-pulse"],[1,"text-[10px]","font-bold","uppercase","tracking-wide","text-emerald-300"],[1,"px-6","py-2","bg-rose-500/10","border","border-rose-500/20","rounded-xl","text-rose-400","text-xs","animate-pulse"],[1,"flex","flex-col","items-center","justify-center","py-20","text-center"],[1,"w-20","h-20","bg-slate-700/30","rounded-full","flex","items-center","justify-center","mb-6","border","border-slate-600"],[1,"text-4xl"],[1,"text-slate-400","max-w-md","mb-8","leading-relaxed"],[1,"px-8","py-4","bg-sky-600","hover:bg-sky-500","hover:scale-105","active:scale-95","rounded-2xl","text-base","font-black","transition-all","shadow-[0_0_20px_rgba(14,165,233,0.4)]",3,"click"],[1,"space-y-8"],[1,"h-px","flex-1","bg-gradient-to-r","from-transparent","via-slate-600","to-transparent"],[1,"text-sm","font-medium","text-slate-400","tracking-wide"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-6"],["class","group relative bg-slate-900/40 rounded-3xl border border-slate-700/50 p-1 transition-all hover:border-slate-500/50 hover:bg-slate-900/60 shadow-xl",4,"ngFor","ngForOf"],[1,"bg-slate-900/70","border","border-amber-500/30","rounded-2xl","px-4","py-3","w-full","md:w-auto"],[1,"flex","items-center","justify-between","gap-4"],[1,"text-xs","font-black","uppercase","tracking-wider","text-amber-400"],[1,"text-[11px]","text-slate-300"],[1,"flex","flex-col","items-end","gap-1"],[1,"font-mono","text-xs","text-emerald-400","bg-emerald-500/10","px-2","py-1","rounded","border","border-emerald-500/20"],[1,"w-9","h-9","rounded-xl","flex","items-center","justify-center","text-xl","font-bold","transition-all","border","shadow-lg","disabled:opacity-20","disabled:grayscale",3,"click","disabled"],[1,"mt-2","text-[11px]","text-slate-400"],[1,"flex","flex-col","md:flex-row","items-center","justify-between","mt-12","pt-8","border-t","border-slate-700/50","gap-6"],[1,"flex","items-center","gap-3","text-slate-500"],[1,"text-xl"],[1,"text-xs","italic"],[1,"flex","flex-col","items-end","gap-4"],[1,"group","relative","px-10","py-4","rounded-2xl","font-black","uppercase","tracking-widest","transition-all","overflow-hidden","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"relative","z-10","flex","items-center","gap-2"],[1,"w-4","h-4","border-2","border-white/30","border-t-white","rounded-full","animate-spin"],[1,"absolute","inset-0","bg-white/10","translate-y-full","group-hover:translate-y-0","transition-transform"],[1,"group","relative","bg-slate-900/40","rounded-3xl","border","border-slate-700/50","p-1","transition-all","hover:border-slate-500/50","hover:bg-slate-900/60","shadow-xl"],[1,"p-5"],[1,"flex","items-center","justify-between","mb-6"],[1,"px-3","py-1","bg-black/40","rounded-lg","text-[10px]","font-black","uppercase","tracking-widest","text-slate-400","border","border-slate-700/50"],[1,"w-2","h-2","rounded-full","blur-[2px]","animate-pulse",3,"ngClass"],[1,"text-lg","font-black","mb-6","tracking-tight",3,"ngClass"],[1,"space-y-6"],[1,"flex","items-center","justify-between","group/item"],[1,"flex-1"],[1,"text-xs","font-bold","text-white","mb-0.5"],[1,"text-[10px]","text-slate-500"],["class","text-[10px] text-slate-400",4,"ngIf","ngIfElse"],[1,"w-8","h-8","rounded-xl","flex","items-center","justify-center","text-xl","font-bold","transition-all","border","shadow-lg","disabled:opacity-20","disabled:grayscale",3,"click","disabled"],[1,"mt-2","p-5","bg-gradient-to-b","from-amber-500/5","to-amber-500/10","rounded-b-[22px]","border-t","border-amber-500/20"],[1,"flex","items-start","justify-between","gap-4"],[1,"text-xs","font-black","uppercase","tracking-wider","text-amber-400","mb-1"],[1,"text-[11px]","text-slate-300","leading-relaxed","italic"],["class","mt-3 inline-block px-2 py-1 rounded bg-black/40 border border-amber-500/20",4,"ngIf"],[1,"flex","flex-col","items-center","gap-2"],[1,"flex","flex-col","items-center","gap-1"],[1,"font-mono","text-xs","text-amber-400"],["class","text-[10px] text-amber-200",4,"ngIf","ngIfElse"],[1,"w-10","h-10","rounded-2xl","flex","items-center","justify-center","text-2xl","font-black","transition-all","border-2","shadow-[0_0_15px_rgba(245,158,11,0.3)]","disabled:opacity-20","disabled:grayscale","disabled:shadow-none",3,"click","disabled"],[1,"text-[10px]","text-slate-400"],[1,"text-[10px]","text-amber-400","font-bold","uppercase"],[1,"mt-3","inline-block","px-2","py-1","rounded","bg-black/40","border","border-amber-500/20"],[1,"text-[9px]","text-amber-500/80","uppercase","font-bold"],[1,"text-[10px]","text-amber-200"]],template:function(t,i){if(t&1&&(y(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"a",10)(6,"span",11),v(7,"\u2190"),_(),v(8),_(),y(9,"h1",12),v(10),_()(),Ut(11,SK,12,5,"div",13)(12,IK,2,1,"ng-template",null,0,ho),_(),y(14,"div",14),Ut(15,TK,8,2,"div",15)(16,FK,35,28,"ng-template",null,1,ho),_()()()()),t&2){let r=tr(13),o=tr(17);g(8),L(" ",i.settings.t("BACK_TO_DEFENSE")," "),g(2),L(" ",i.settings.t("MASTERIES")," "),g(),Se("ngIf",i.profile())("ngIfElse",r),g(4),Se("ngIf",!i.user())("ngIfElse",o)}},dependencies:[Nt,Ju,ps,go,Fr],encapsulation:2})};var HO=n=>{let e=n.tdEngine.getTowersRef().length>0,t=n.tdEngine.isWaveInProgress();return e||t?confirm("\u0412\u0438 \u0432\u043F\u0435\u0432\u043D\u0435\u043D\u0456, \u0449\u043E \u0445\u043E\u0447\u0435\u0442\u0435 \u0432\u0438\u0439\u0442\u0438? \u0412\u0435\u0441\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441 \u043F\u043E\u0442\u043E\u0447\u043D\u043E\u0457 \u0433\u0440\u0438 \u0431\u0443\u0434\u0435 \u0432\u0442\u0440\u0430\u0447\u0435\u043D\u043E."):!0};var GO=[{path:"",component:N0},{path:"shape-tactics",component:E0},{path:"tower-defense",component:F0,canDeactivate:[HO]},{path:"tower-defense-leaderboard",component:L0},{path:"masteries",component:V0},{path:"feedback",component:R0},{path:"roadmap",component:k0}];var $O={providers:[Fv(),Ib(GO),ZM(XM())]};var U0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=It({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,i){t&1&&(y(0,"h1",0),v(1,"Turn-Based Strategy"),_(),W(2,"router-outlet"))},dependencies:[yd],encapsulation:2})};JE(U0,$O).catch(n=>console.error(n));
