var s4=Object.defineProperty,a4=Object.defineProperties;var l4=Object.getOwnPropertyDescriptors;var Ah=Object.getOwnPropertySymbols;var PS=Object.prototype.hasOwnProperty,kS=Object.prototype.propertyIsEnumerable;var NS=(n,e,t)=>e in n?s4(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||={})PS.call(e,t)&&NS(n,t,e[t]);if(Ah)for(var t of Ah(e))kS.call(e,t)&&NS(n,t,e[t]);return n},ce=(n,e)=>a4(n,l4(e));var Ja=(n,e)=>{var t={};for(var i in n)PS.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&Ah)for(var i of Ah(n))e.indexOf(i)<0&&kS.call(n,i)&&(t[i]=n[i]);return t};var Vn=null,Mh=!1,iy=1,c4=null,Jn=Symbol("SIGNAL");function Ue(n){let e=Vn;return Vn=n,e}function Nh(){return Vn}var Hc={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Gc(n){if(Mh)throw new Error("");if(Vn===null)return;Vn.consumerOnSignalRead(n);let e=Vn.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Vn.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Vn.producers,t!==void 0&&t.producer===n)){Vn.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Vn&&(!i||d4(r,Vn)))return;let o=Xa(Vn),s={producer:n,consumer:Vn,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Vn.producersTail=s,e!==void 0?e.nextProducer=s:Vn.producers=s,o&&VS(n,s)}function OS(){iy++}function ry(n){if(!(Xa(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===iy)){if(!n.producerMustRecompute(n)&&!kh(n)){ny(n);return}n.producerRecomputeValue(n),ny(n)}}function oy(n){if(n.consumers===void 0)return;let e=Mh;Mh=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||u4(i)}}finally{Mh=e}}function sy(){return Vn?.consumerAllowSignalWrites!==!1}function u4(n){n.dirty=!0,oy(n),n.consumerMarkedDirty?.(n)}function ny(n){n.dirty=!1,n.lastCleanEpoch=iy}function $c(n){return n&&FS(n),Ue(n)}function FS(n){n.producersTail=void 0,n.recomputing=!0}function Ph(n,e){Ue(e),n&&LS(n)}function LS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Xa(n))do t=ay(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function kh(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(ry(t),i!==t.version))return!0}return!1}function zc(n){if(Xa(n)){let e=n.producers;for(;e!==void 0;)e=ay(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function VS(n,e){let t=n.consumersTail,i=Xa(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)VS(r.producer,r)}function ay(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Xa(e)){let o=e.producers;for(;o!==void 0;)o=ay(o)}return t}function Xa(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function ly(n){c4?.(n)}function d4(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function cy(n,e){return Object.is(n,e)}function Oh(n,e){let t=Object.create(h4);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(ry(t),Gc(t),t.value===Rh)throw t.error;return t.value};return i[Jn]=t,ly(t),i}var ey=Symbol("UNSET"),ty=Symbol("COMPUTING"),Rh=Symbol("ERRORED"),h4=ce(F({},Hc),{value:ey,dirty:!0,error:null,equal:cy,kind:"computed",producerMustRecompute(n){return n.value===ey||n.value===ty},producerRecomputeValue(n){if(n.value===ty)throw new Error("");let e=n.value;n.value=ty;let t=$c(n),i,r=!1;try{i=n.computation(),Ue(null),r=e!==ey&&e!==Rh&&i!==Rh&&n.equal(e,i)}catch(o){i=Rh,n.error=o}finally{Ph(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function f4(){throw new Error}var US=f4;function BS(n){US(n)}function uy(n){US=n}var p4=null;function dy(n,e){let t=Object.create(Fh);t.value=n,e!==void 0&&(t.equal=e);let i=()=>jS(t);return i[Jn]=t,ly(t),[i,s=>Wc(t,s),s=>HS(t,s)]}function jS(n){return Gc(n),n.value}function Wc(n,e){sy()||BS(n),n.equal(n.value,e)||(n.value=e,g4(n))}function HS(n,e){sy()||BS(n),Wc(n,e(n.value))}var Fh=ce(F({},Hc),{equal:cy,value:void 0,kind:"signal"});function g4(n){n.version++,OS(),oy(n),p4?.(n)}function hy(n){let e=Ue(null);try{return n()}finally{Ue(e)}}function Ye(n){return typeof n=="function"}function Za(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Lh=Za(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Us(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var mn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ye(i))try{i()}catch(o){e=o instanceof Lh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{GS(o)}catch(s){e=e??[],s instanceof Lh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Lh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)GS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Us(t,e)}remove(e){let{_finalizers:t}=this;t&&Us(t,e),e instanceof n&&e._removeParent(this)}};mn.EMPTY=(()=>{let n=new mn;return n.closed=!0,n})();var fy=mn.EMPTY;function Vh(n){return n instanceof mn||n&&"closed"in n&&Ye(n.remove)&&Ye(n.add)&&Ye(n.unsubscribe)}function GS(n){Ye(n)?n():n.unsubscribe()}var $i={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var el={setTimeout(n,e,...t){let{delegate:i}=el;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=el;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Uh(n){el.setTimeout(()=>{let{onUnhandledError:e}=$i;if(e)e(n);else throw n})}function qc(){}var $S=py("C",void 0,void 0);function zS(n){return py("E",void 0,n)}function WS(n){return py("N",n,void 0)}function py(n,e,t){return{kind:n,value:e,error:t}}var Bs=null;function tl(n){if($i.useDeprecatedSynchronousErrorHandling){let e=!Bs;if(e&&(Bs={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Bs;if(Bs=null,t)throw i}}else n()}function qS(n){$i.useDeprecatedSynchronousErrorHandling&&Bs&&(Bs.errorThrown=!0,Bs.error=n)}var js=class extends mn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Vh(e)&&e.add(this)):this.destination=v4}static create(e,t,i){return new nl(e,t,i)}next(e){this.isStopped?my(WS(e),this):this._next(e)}error(e){this.isStopped?my(zS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?my($S,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},m4=Function.prototype.bind;function gy(n,e){return m4.call(n,e)}var yy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Bh(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Bh(i)}else Bh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Bh(t)}}},nl=class extends js{constructor(e,t,i){super();let r;if(Ye(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&$i.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&gy(e.next,o),error:e.error&&gy(e.error,o),complete:e.complete&&gy(e.complete,o)}):r=e}this.destination=new yy(r)}};function Bh(n){$i.useDeprecatedSynchronousErrorHandling?qS(n):Uh(n)}function y4(n){throw n}function my(n,e){let{onStoppedNotification:t}=$i;t&&el.setTimeout(()=>t(n,e))}var v4={closed:!0,next:qc,error:y4,complete:qc};var il=typeof Symbol=="function"&&Symbol.observable||"@@observable";function zi(n){return n}function vy(...n){return _y(n)}function _y(n){return n.length===0?zi:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var st=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=E4(t)?t:new nl(t,i,r);return tl(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=KS(i),new i((r,o)=>{let s=new nl({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[il](){return this}pipe(...t){return _y(t)(this)}toPromise(t){return t=KS(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function KS(n){var e;return(e=n??$i.Promise)!==null&&e!==void 0?e:Promise}function _4(n){return n&&Ye(n.next)&&Ye(n.error)&&Ye(n.complete)}function E4(n){return n&&n instanceof js||_4(n)&&Vh(n)}function b4(n){return Ye(n?.lift)}function ht(n){return e=>{if(b4(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ft(n,e,t,i,r){return new Ey(n,e,t,i,r)}var Ey=class extends js{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var YS=Za(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var jt=(()=>{class n extends st{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new jh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new YS}next(t){tl(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){tl(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){tl(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?fy:(this.currentObservers=null,o.push(t),new mn(()=>{this.currentObservers=null,Us(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new st;return t.source=this,t}}return n.create=(e,t)=>new jh(e,t),n})(),jh=class extends jt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:fy}};var Pn=class extends jt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var by={now(){return(by.delegate||Date).now()},delegate:void 0};var Hh=class extends mn{constructor(e,t){super()}schedule(e,t=0){return this}};var Kc={setInterval(n,e,...t){let{delegate:i}=Kc;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Kc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Gh=class extends Hh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return Kc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Kc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Us(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var rl=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};rl.now=by.now;var $h=class extends rl{constructor(e,t=rl.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var QS=new $h(Gh);var kn=new st(n=>n.complete());function JS(n){return n&&Ye(n.schedule)}function XS(n){return n[n.length-1]}function zh(n){return Ye(XS(n))?n.pop():void 0}function qo(n){return JS(XS(n))?n.pop():void 0}function eI(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(h){s(h)}}function l(d){try{c(i.throw(d))}catch(h){s(h)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function ZS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hs(n){return this instanceof Hs?(this.v=n,this):new Hs(n)}function tI(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(g){return function(x){return Promise.resolve(x).then(g,h)}}function a(g,x){i[g]&&(r[g]=function(S){return new Promise(function(R,L){o.push([g,S,R,L])>1||l(g,S)})},x&&(r[g]=x(r[g])))}function l(g,x){try{c(i[g](x))}catch(S){f(o[0][3],S)}}function c(g){g.value instanceof Hs?Promise.resolve(g.value.v).then(d,h):f(o[0][2],g)}function d(g){l("next",g)}function h(g){l("throw",g)}function f(g,x){g(x),o.shift(),o.length&&l(o[0][0],o[0][1])}}function nI(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ZS=="function"?ZS(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var Wh=n=>n&&typeof n.length=="number"&&typeof n!="function";function qh(n){return Ye(n?.then)}function Kh(n){return Ye(n[il])}function Yh(n){return Symbol.asyncIterator&&Ye(n?.[Symbol.asyncIterator])}function Qh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function w4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Jh=w4();function Xh(n){return Ye(n?.[Jh])}function Zh(n){return tI(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Hs(t.read());if(r)return yield Hs(void 0);yield yield Hs(i)}}finally{t.releaseLock()}})}function ef(n){return Ye(n?.getReader)}function an(n){if(n instanceof st)return n;if(n!=null){if(Kh(n))return x4(n);if(Wh(n))return S4(n);if(qh(n))return I4(n);if(Yh(n))return iI(n);if(Xh(n))return T4(n);if(ef(n))return C4(n)}throw Qh(n)}function x4(n){return new st(e=>{let t=n[il]();if(Ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function S4(n){return new st(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function I4(n){return new st(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Uh)})}function T4(n){return new st(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function iI(n){return new st(e=>{D4(n,e).catch(t=>e.error(t))})}function C4(n){return iI(Zh(n))}function D4(n,e){var t,i,r,o;return eI(this,void 0,void 0,function*(){try{for(t=nI(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function Xn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function tf(n,e=0){return ht((t,i)=>{t.subscribe(ft(i,r=>Xn(i,n,()=>i.next(r),e),()=>Xn(i,n,()=>i.complete(),e),r=>Xn(i,n,()=>i.error(r),e)))})}function nf(n,e=0){return ht((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function rI(n,e){return an(n).pipe(nf(e),tf(e))}function oI(n,e){return an(n).pipe(nf(e),tf(e))}function sI(n,e){return new st(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function aI(n,e){return new st(t=>{let i;return Xn(t,e,()=>{i=n[Jh](),Xn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Ye(i?.return)&&i.return()})}function rf(n,e){if(!n)throw new Error("Iterable cannot be null");return new st(t=>{Xn(t,e,()=>{let i=n[Symbol.asyncIterator]();Xn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function lI(n,e){return rf(Zh(n),e)}function cI(n,e){if(n!=null){if(Kh(n))return rI(n,e);if(Wh(n))return sI(n,e);if(qh(n))return oI(n,e);if(Yh(n))return rf(n,e);if(Xh(n))return aI(n,e);if(ef(n))return lI(n,e)}throw Qh(n)}function ln(n,e){return e?cI(n,e):an(n)}function it(...n){let e=qo(n);return ln(n,e)}function wy(n,e){let t=Ye(n)?n:()=>n,i=r=>r.error(t());return new st(e?r=>e.schedule(i,0,r):i)}function of(n){return!!n&&(n instanceof st||Ye(n.lift)&&Ye(n.subscribe))}var Gs=Za(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function yt(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:A4}=Array;function M4(n,e){return A4(e)?n(...e):n(e)}function sf(n){return yt(e=>M4(n,e))}var{isArray:R4}=Array,{getPrototypeOf:N4,prototype:P4,keys:k4}=Object;function af(n){if(n.length===1){let e=n[0];if(R4(e))return{args:e,keys:null};if(O4(e)){let t=k4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function O4(n){return n&&typeof n=="object"&&N4(n)===P4}function lf(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Yc(...n){let e=qo(n),t=zh(n),{args:i,keys:r}=af(n);if(i.length===0)return ln([],e);let o=new st(F4(i,e,r?s=>lf(r,s):zi));return t?o.pipe(sf(t)):o}function F4(n,e,t=zi){return i=>{uI(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let l=0;l<r;l++)uI(e,()=>{let c=ln(n[l],e),d=!1;c.subscribe(ft(i,h=>{o[l]=h,d||(d=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function uI(n,e,t){n?Xn(t,n,e):e()}function dI(n,e,t,i,r,o,s,a){let l=[],c=0,d=0,h=!1,f=()=>{h&&!l.length&&!c&&e.complete()},g=S=>c<i?x(S):l.push(S),x=S=>{o&&e.next(S),c++;let R=!1;an(t(S,d++)).subscribe(ft(e,L=>{r?.(L),o?g(L):e.next(L)},()=>{R=!0},void 0,()=>{if(R)try{for(c--;l.length&&c<i;){let L=l.shift();s?Xn(e,s,()=>x(L)):x(L)}f()}catch(L){e.error(L)}}))};return n.subscribe(ft(e,g,()=>{h=!0,f()})),()=>{a?.()}}function zn(n,e,t=1/0){return Ye(e)?zn((i,r)=>yt((o,s)=>e(i,o,r,s))(an(n(i,r))),t):(typeof e=="number"&&(t=e),ht((i,r)=>dI(i,r,n,t)))}function hI(n=1/0){return zn(zi,n)}function fI(){return hI(1)}function Ko(...n){return fI()(ln(n,qo(n)))}function Qc(n){return new st(e=>{an(n()).subscribe(e)})}function xy(...n){let e=zh(n),{args:t,keys:i}=af(n),r=new st(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let d=0;d<s;d++){let h=!1;an(t[d]).subscribe(ft(o,f=>{h||(h=!0,c--),a[d]=f},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?lf(i,a):a),o.complete())}))}});return e?r.pipe(sf(e)):r}function Wi(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>n.call(e,o,r++)&&i.next(o)))})}function Jc(n){return ht((e,t)=>{let i=null,r=!1,o;i=e.subscribe(ft(t,void 0,void 0,s=>{o=an(n(s,Jc(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function cf(n,e){return Ye(e)?zn(n,e,1):zn(n,1)}function Sy(n,e=QS){return ht((t,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let c=o;o=null,i.next(c)}};function l(){let c=s+n,d=e.now();if(d<c){r=this.schedule(void 0,c-d),i.add(r);return}a()}t.subscribe(ft(i,c=>{o=c,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function pI(n){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function qi(n){return n<=0?()=>kn:ht((e,t)=>{let i=0;e.subscribe(ft(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function gI(n=L4){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function L4(){return new Gs}function Iy(n){return ht((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Xr(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Wi((r,o)=>n(r,o,i)):zi,qi(1),t?pI(e):gI(()=>new Gs))}function uf(n){return n<=0?()=>kn:ht((e,t)=>{let i=[];e.subscribe(ft(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Ty(n){return Wi((e,t)=>n<=t)}function Xc(...n){let e=qo(n);return ht((t,i)=>{(e?Ko(n,t,e):Ko(n,t)).subscribe(i)})}function Zr(n,e){return ht((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(ft(i,l=>{r?.unsubscribe();let c=0,d=o++;an(n(l,d)).subscribe(r=ft(i,h=>i.next(e?e(l,h,d,c++):h),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function $s(n){return ht((e,t)=>{an(n).subscribe(ft(t,()=>t.complete(),qc)),!t.closed&&e.subscribe(t)})}function gr(n,e,t){let i=Ye(n)||e||t?{next:n,error:e,complete:t}:n;return i?ht((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(ft(o,l=>{var c;(c=i.next)===null||c===void 0||c.call(i,l),o.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),o.complete()},l=>{var c;a=!1,(c=i.error)===null||c===void 0||c.call(i,l),o.error(l)},()=>{var l,c;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(c=i.finalize)===null||c===void 0||c.call(i)}))}):zi}var Cy;function df(){return Cy}function mr(n){let e=Cy;return Cy=n,e}var mI=Symbol("NotFound");function ol(n){return n===mI||n?.name==="\u0275NotFound"}var mf="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",me=class extends Error{code;constructor(e,t){super(no(e,t)),this.code=e}};function B4(n){return`NG0${Math.abs(n)}`}function no(n,e){return`${B4(n)}${e?": "+e:""}`}var vr=globalThis;function vt(n){for(let e in n)if(n[e]===vt)return e;throw Error("")}function bI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function to(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(to).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function yf(n,e){return n?e?`${n} ${e}`:n:e||""}var j4=vt({__forward_ref__:vt});function Xo(n){return n.__forward_ref__=Xo,n.toString=function(){return to(this())},n}function On(n){return Hy(n)?n():n}function Hy(n){return typeof n=="function"&&n.hasOwnProperty(j4)&&n.__forward_ref__===Xo}function pe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function _r(n){return{providers:n.providers||[],imports:n.imports||[]}}function ru(n){return H4(n,vf)}function Gy(n){return ru(n)!==null}function H4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function G4(n){let e=n?.[vf]??null;return e||null}function Ay(n){return n&&n.hasOwnProperty(ff)?n[ff]:null}var vf=vt({\u0275prov:vt}),ff=vt({\u0275inj:vt}),we=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function $y(n){return n&&!!n.\u0275providers}var zy=vt({\u0275cmp:vt}),Wy=vt({\u0275dir:vt}),qy=vt({\u0275pipe:vt}),Ky=vt({\u0275mod:vt}),eu=vt({\u0275fac:vt}),Ys=vt({__NG_ELEMENT_ID__:vt}),yI=vt({__NG_ENV_ID__:vt});function Yy(n){return Ef(n,"@NgModule"),n[Ky]||null}function io(n){return Ef(n,"@Component"),n[zy]||null}function _f(n){return Ef(n,"@Directive"),n[Wy]||null}function Qy(n){return Ef(n,"@Pipe"),n[qy]||null}function Ef(n,e){if(n==null)throw new me(-919,!1)}function Ki(n){return typeof n=="string"?n:n==null?"":String(n)}function wI(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ki(n)}var xI=vt({ngErrorCode:vt}),$4=vt({ngErrorMessage:vt}),z4=vt({ngTokenPath:vt});function Jy(n,e){return SI("",-200,e)}function bf(n,e){throw new me(-201,!1)}function SI(n,e,t){let i=new me(e,n);return i[xI]=e,i[$4]=n,t&&(i[z4]=t),i}function W4(n){return n[xI]}var My;function II(){return My}function Wn(n){let e=My;return My=n,e}function Xy(n,e,t){let i=ru(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;bf(n,"")}var q4={},zs=q4,K4="__NG_DI_FLAG__",Ry=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Ws(t)||0;try{return this.injector.get(e,i&8?null:zs,i)}catch(r){if(ol(r))return r;throw r}}};function Y4(n,e=0){let t=df();if(t===void 0)throw new me(-203,!1);if(t===null)return Xy(n,void 0,e);{let i=Q4(e),r=t.retrieve(n,i);if(ol(r)){if(i.optional)return null;throw r}return r}}function Ne(n,e=0){return(II()||Y4)(On(n),e)}function K(n,e){return Ne(n,Ws(e))}function Ws(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Q4(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Ny(n){let e=[];for(let t=0;t<n.length;t++){let i=On(n[t]);if(Array.isArray(i)){if(i.length===0)throw new me(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],l=J4(a);typeof l=="number"?l===-1?r=a.token:o|=l:r=a}e.push(Ne(r,o))}else e.push(Ne(i))}return e}function J4(n){return n[K4]}function Yo(n,e){let t=n.hasOwnProperty(eu);return t?n[eu]:null}function TI(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function CI(n){return n.flat(Number.POSITIVE_INFINITY)}function wf(n,e){n.forEach(t=>Array.isArray(t)?wf(t,e):e(t))}function Zy(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function ou(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function DI(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function xf(n,e,t){let i=al(n,e);return i>=0?n[i|1]=t:(i=~i,DI(n,i,e,t)),i}function Sf(n,e){let t=al(n,e);if(t>=0)return n[t|1]}function al(n,e){return X4(n,e,1)}function X4(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var Zo={},qn=[],Er=new we(""),ev=new we("",-1),tv=new we(""),tu=class{get(e,t=zs){if(t===zs){let r=SI("",-201);throw r.name="\u0275NotFound",r}return t}};function br(n){return{\u0275providers:n}}function AI(n){return br([{provide:Er,multi:!0,useValue:n}])}function MI(...n){return{\u0275providers:If(!0,n),\u0275fromNgModule:!0}}function If(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return wf(e,s=>{let a=s;pf(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&RI(r,o),t}function RI(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];nv(r,o=>{e(o,i)})}}function pf(n,e,t,i){if(n=On(n),!n)return!1;let r=null,o=Ay(n),s=!o&&io(n);if(!o&&!s){let l=n.ngModule;if(o=Ay(l),o)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)pf(c,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let c;wf(o.imports,d=>{pf(d,e,t,i)&&(c||=[],c.push(d))}),c!==void 0&&RI(c,e)}if(!a){let c=Yo(r)||(()=>new r);e({provide:r,useFactory:c,deps:qn},r),e({provide:tv,useValue:r,multi:!0},r),e({provide:Er,useValue:()=>Ne(r),multi:!0},r)}let l=o.providers;if(l!=null&&!a){let c=n;nv(l,d=>{e(d,c)})}}else return!1;return r!==n&&n.providers!==void 0}function nv(n,e){for(let t of n)$y(t)&&(t=t.\u0275providers),Array.isArray(t)?nv(t,e):e(t)}var Z4=vt({provide:String,useValue:vt});function NI(n){return n!==null&&typeof n=="object"&&Z4 in n}function e3(n){return!!(n&&n.useExisting)}function t3(n){return!!(n&&n.useFactory)}function qs(n){return typeof n=="function"}function PI(n){return!!n.useClass}var su=new we(""),hf={},vI={},Dy;function au(){return Dy===void 0&&(Dy=new tu),Dy}var Yt=class{},Ks=class extends Yt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,ky(e,s=>this.processProvider(s)),this.records.set(ev,sl(void 0,this)),r.has("environment")&&this.records.set(Yt,sl(void 0,this));let o=this.records.get(su);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(tv,qn,{self:!0}))}retrieve(e,t){let i=Ws(t)||0;try{return this.get(e,zs,i)}catch(r){if(ol(r))return r;throw r}}destroy(){Zc(this),this._destroyed=!0;let e=Ue(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ue(e)}}onDestroy(e){return Zc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Zc(this);let t=mr(this),i=Wn(void 0),r;try{return e()}finally{mr(t),Wn(i)}}get(e,t=zs,i){if(Zc(this),e.hasOwnProperty(yI))return e[yI](this);let r=Ws(i),o,s=mr(this),a=Wn(void 0);try{if(!(r&4)){let c=this.records.get(e);if(c===void 0){let d=s3(e)&&ru(e);d&&this.injectableDefInScope(d)?c=sl(Py(e),hf):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let l=r&2?au():this.parent;return t=r&8&&t===zs?null:t,l.get(e,t)}catch(l){let c=W4(l);throw c===-200||c===-201?new me(c,null):l}finally{Wn(a),mr(s)}}resolveInjectorInitializers(){let e=Ue(null),t=mr(this),i=Wn(void 0),r;try{let o=this.get(Er,qn,{self:!0});for(let s of o)s()}finally{mr(t),Wn(i),Ue(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(to(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=On(e);let t=qs(e)?e:On(e&&e.provide),i=i3(e);if(!qs(e)&&e.multi===!0){let r=this.records.get(t);r||(r=sl(void 0,hf,!0),r.factory=()=>Ny(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Ue(null);try{if(t.value===vI)throw Jy(to(e));return t.value===hf&&(t.value=vI,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&o3(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ue(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=On(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Py(n){let e=ru(n),t=e!==null?e.factory:Yo(n);if(t!==null)return t;if(n instanceof we)throw new me(204,!1);if(n instanceof Function)return n3(n);throw new me(204,!1)}function n3(n){if(n.length>0)throw new me(204,!1);let t=G4(n);return t!==null?()=>t.factory(n):()=>new n}function i3(n){if(NI(n))return sl(void 0,n.useValue);{let e=iv(n);return sl(e,hf)}}function iv(n,e,t){let i;if(qs(n)){let r=On(n);return Yo(r)||Py(r)}else if(NI(n))i=()=>On(n.useValue);else if(t3(n))i=()=>n.useFactory(...Ny(n.deps||[]));else if(e3(n))i=(r,o)=>Ne(On(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=On(n&&(n.useClass||n.provide));if(r3(n))i=()=>new r(...Ny(n.deps));else return Yo(r)||Py(r)}return i}function Zc(n){if(n.destroyed)throw new me(205,!1)}function sl(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function r3(n){return!!n.deps}function o3(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function s3(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function ky(n,e){for(let t of n)Array.isArray(t)?ky(t,e):t&&$y(t)?ky(t.\u0275providers,e):e(t)}function Fn(n,e){let t;n instanceof Ks?(Zc(n),t=n):t=new Ry(n);let i,r=mr(t),o=Wn(void 0);try{return e()}finally{mr(r),Wn(o)}}function kI(){return II()!==void 0||df()!=null}var Yn=0,Re=1,Ge=2,Zt=3,Ci=4,Di=5,Zn=6,ll=7,en=8,ui=9,wr=10,St=11,cl=12,rv=13,Qs=14,Qn=15,es=16,Js=17,xr=18,ro=19,ov=20,eo=21,Tf=22,lu=23,di=24,Xs=25,Zs=26,ut=27,OI=1,Yi=6,Sr=7,cu=8,ea=9,$t=10;function hi(n){return Array.isArray(n)&&typeof n[OI]=="object"}function fi(n){return Array.isArray(n)&&n[OI]===!0}function sv(n){return(n.flags&4)!==0}function oo(n){return n.componentOffset>-1}function uu(n){return(n.flags&1)===1}function Ir(n){return!!n.template}function ta(n){return(n[Ge]&512)!==0}function ts(n){return(n[Ge]&256)===256}var av="svg",FI="math";function pi(n){for(;Array.isArray(n);)n=n[Yn];return n}function lv(n,e){return pi(e[n])}function Ai(n,e){return pi(e[n.index])}function na(n,e){return n.data[e]}function du(n,e){return n[e]}function hu(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Mi(n,e){let t=e[n];return hi(t)?t:t[Yn]}function LI(n){return(n[Ge]&4)===4}function Cf(n){return(n[Ge]&128)===128}function VI(n){return fi(n[Zt])}function Ri(n,e){return e==null?null:n[e]}function cv(n){n[Js]=0}function uv(n){n[Ge]&1024||(n[Ge]|=1024,Cf(n)&&ul(n))}function UI(n,e){for(;n>0;)e=e[Qs],n--;return e}function fu(n){return!!(n[Ge]&9216||n[di]?.dirty)}function Df(n){n[wr].changeDetectionScheduler?.notify(8),n[Ge]&64&&(n[Ge]|=1024),fu(n)&&ul(n)}function ul(n){n[wr].changeDetectionScheduler?.notify(0);let e=Qo(n);for(;e!==null&&!(e[Ge]&8192||(e[Ge]|=8192,!Cf(e)));)e=Qo(e)}function dv(n,e){if(ts(n))throw new me(911,!1);n[eo]===null&&(n[eo]=[]),n[eo].push(e)}function BI(n,e){if(n[eo]===null)return;let t=n[eo].indexOf(e);t!==-1&&n[eo].splice(t,1)}function Qo(n){let e=n[Zt];return fi(e)?e[Zt]:e}function hv(n){return n[ll]??=[]}function fv(n){return n.cleanup??=[]}function jI(n,e,t,i){let r=hv(e);r.push(t),n.firstCreatePass&&fv(n).push(i,r.length-1)}var Qe={lFrame:ZI(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Oy=!1;function HI(){return Qe.lFrame.elementDepthCount}function GI(){Qe.lFrame.elementDepthCount++}function pv(){Qe.lFrame.elementDepthCount--}function gv(){return Qe.bindingsEnabled}function mv(){return Qe.skipHydrationRootTNode!==null}function yv(n){return Qe.skipHydrationRootTNode===n}function $I(n){Qe.skipHydrationRootTNode=n}function vv(){Qe.skipHydrationRootTNode=null}function Be(){return Qe.lFrame.lView}function tn(){return Qe.lFrame.tView}function ee(n){return Qe.lFrame.contextLView=n,n[en]}function te(n){return Qe.lFrame.contextLView=null,n}function Un(){let n=_v();for(;n!==null&&n.type===64;)n=n.parent;return n}function _v(){return Qe.lFrame.currentTNode}function zI(){let n=Qe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ia(n,e){let t=Qe.lFrame;t.currentTNode=n,t.isParent=e}function Ev(){return Qe.lFrame.isParent}function WI(){Qe.lFrame.isParent=!1}function bv(){return Qe.lFrame.contextLView}function wv(){return Oy}function xv(n){let e=Oy;return Oy=n,e}function dl(){let n=Qe.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Sv(){return Qe.lFrame.bindingIndex}function qI(n){return Qe.lFrame.bindingIndex=n}function ra(){return Qe.lFrame.bindingIndex++}function pu(n){let e=Qe.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function KI(){return Qe.lFrame.inI18n}function YI(n,e){let t=Qe.lFrame;t.bindingIndex=t.bindingRootIndex=n,Af(e)}function QI(){return Qe.lFrame.currentDirectiveIndex}function Af(n){Qe.lFrame.currentDirectiveIndex=n}function JI(n){let e=Qe.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Iv(){return Qe.lFrame.currentQueryIndex}function Mf(n){Qe.lFrame.currentQueryIndex=n}function a3(n){let e=n[Re];return e.type===2?e.declTNode:e.type===1?n[Di]:null}function Tv(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=a3(o),r===null||(o=o[Qs],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Qe.lFrame=XI();return i.currentTNode=e,i.lView=n,!0}function Rf(n){let e=XI(),t=n[Re];Qe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function XI(){let n=Qe.lFrame,e=n===null?null:n.child;return e===null?ZI(n):e}function ZI(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function eT(){let n=Qe.lFrame;return Qe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Cv=eT;function Nf(){let n=eT();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function tT(n){return(Qe.lFrame.contextLView=UI(n,Qe.lFrame.contextLView))[en]}function Ni(){return Qe.lFrame.selectedIndex}function ns(n){Qe.lFrame.selectedIndex=n}function Dv(){let n=Qe.lFrame;return na(n.tView,n.selectedIndex)}function ie(){Qe.lFrame.currentNamespace=av}function ke(){l3()}function l3(){Qe.lFrame.currentNamespace=null}function Av(){return Qe.lFrame.currentNamespace}var nT=!0;function Pf(){return nT}function so(n){nT=n}function Fy(n,e=null,t=null,i){let r=Mv(n,e,t,i);return r.resolveInjectorInitializers(),r}function Mv(n,e=null,t=null,i,r=new Set){let o=[t||qn,MI(n)];return i=i||(typeof n=="object"?void 0:to(n)),new Ks(o,e||au(),i||null,r)}var Kn=class n{static THROW_IF_NOT_FOUND=zs;static NULL=new tu;static create(e,t){if(Array.isArray(e))return Fy({name:""},t,e,"");{let i=e.name??"";return Fy({name:i},e.parent,e.providers,i)}}static \u0275prov=pe({token:n,providedIn:"any",factory:()=>Ne(ev)});static __NG_ELEMENT_ID__=-1},Qt=new we(""),ei=(()=>{class n{static __NG_ELEMENT_ID__=c3;static __NG_ENV_ID__=t=>t}return n})(),Ly=class extends ei{_lView;constructor(e){super(),this._lView=e}get destroyed(){return ts(this._lView)}onDestroy(e){let t=this._lView;return dv(t,e),()=>BI(t,e)}};function c3(){return new Ly(Be())}var iT=!1,rT=new we(""),Tr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Pn(!1);debugTaskTracker=K(rT,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new st(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),Vy=class extends jt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,kI()&&(this.destroyRef=K(ei,{optional:!0})??void 0,this.pendingTasks=K(Tr,{optional:!0})??void 0)}emit(e){let t=Ue(null);try{super.next(e)}finally{Ue(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof mn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},cn=Vy;function gf(...n){}function Rv(n){let e,t;function i(){n=gf;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function oT(n){return queueMicrotask(()=>n()),()=>{n=gf}}var Nv="isAngularZone",nu=Nv+"_ID",u3=0,yn=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new cn(!1);onMicrotaskEmpty=new cn(!1);onStable=new cn(!1);onError=new cn(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=iT}=e;if(typeof Zone>"u")throw new me(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,f3(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Nv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new me(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new me(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,d3,gf,gf);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},d3={};function Pv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function h3(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){Rv(()=>{n.callbackScheduled=!1,Uy(n),n.isCheckStableRunning=!0,Pv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Uy(n)}function f3(n){let e=()=>{h3(n)},t=u3++;n._inner=n._inner.fork({name:"angular",properties:{[Nv]:!0,[nu]:t,[nu+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(p3(l))return i.invokeTask(o,s,a,l);try{return _I(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),EI(n)}},onInvoke:(i,r,o,s,a,l,c)=>{try{return _I(n),i.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!g3(l)&&e(),EI(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Uy(n),Pv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Uy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function _I(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function EI(n){n._nesting--,Pv(n)}var iu=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new cn;onMicrotaskEmpty=new cn;onStable=new cn;onError=new cn;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function p3(n){return sT(n,"__ignore_ng_zone__")}function g3(n){return sT(n,"__scheduler_tick__")}function sT(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var yr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},gi=new we("",{factory:()=>{let n=K(yn),e=K(Yt),t;return i=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw i}):(t??=e.get(yr),t.handleError(i))})}}}),aT={provide:Er,useValue:()=>{let n=K(yr,{optional:!0})},multi:!0},m3=new we("",{factory:()=>{let n=K(Qt).defaultView;if(!n)return;let e=K(gi),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),K(ei).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function kv(){return br([AI(()=>{K(m3)})])}function $(n,e){let[t,i,r]=dy(n,e?.equal),o=t,s=o[Jn];return o.set=i,o.update=r,o.asReadonly=lT.bind(o),o}function lT(){let n=this[Jn];if(n.readonlyFn===void 0){let e=()=>this();e[Jn]=n,n.readonlyFn=e}return n.readonlyFn}var kf=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=y3}return n})();function y3(){return new kf(Be(),Un())}var Jo=class{},gu=new we("",{factory:()=>!0});var Ov=new we(""),mu=(()=>{class n{internalPendingTasks=K(Tr);scheduler=K(Jo);errorHandler=K(gi);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),Fv=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new By})}return n})(),By=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}},jy=class{[Jn];constructor(e){this[Jn]=e}destroy(){this[Jn].destroy()}};function un(n){return hy(n)}var Of={JSACTION:"jsaction"};function Tu(n){return{toString:n}.toString()}function x3(n){return typeof n=="function"}function qT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var zf=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}},ao=(()=>{let n=()=>KT;return n.ngInherit=!0,n})();function KT(n){return n.type.prototype.ngOnChanges&&(n.setInput=I3),S3}function S3(){let n=QT(this),e=n?.current;if(e){let t=n.previous;if(t===Zo)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function I3(n,e,t,i,r){let o=this.declaredInputs[i],s=QT(n)||T3(n,{previous:Zo,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new zf(c&&c.currentValue,t,l===Zo),qT(n,e,r,t)}var YT="__ngSimpleChanges__";function QT(n){return n[YT]||null}function T3(n,e){return n[YT]=e}var cT=[];var pt=function(n,e=null,t){for(let i=0;i<cT.length;i++){let r=cT[i];r(n,e,t)}},at=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(at||{});function C3(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=KT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function JT(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Vf(n,e,t){XT(n,e,3,t)}function Uf(n,e,t,i){(n[Ge]&3)===t&&XT(n,e,t,i)}function Lv(n,e){let t=n[Ge];(t&3)===e&&(t&=16383,t+=1,n[Ge]=t)}function XT(n,e,t,i){let r=i!==void 0?n[Js]&65535:0,o=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(n[Js]+=65536),(a<o||o==-1)&&(D3(n,t,e,l),n[Js]=(n[Js]&4294901760)+l+2),l++}function uT(n,e){pt(at.LifecycleHookStart,n,e);let t=Ue(null);try{e.call(n)}finally{Ue(t),pt(at.LifecycleHookEnd,n,e)}}function D3(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[Ge]>>14<n[Js]>>16&&(n[Ge]&3)===e&&(n[Ge]+=16384,uT(a,o)):uT(a,o)}var fl=-1,aa=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function A3(n){return(n.flags&8)!==0}function M3(n){return(n.flags&16)!==0}function R3(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];N3(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function ZT(n){return n===3||n===4||n===6}function N3(n){return n.charCodeAt(0)===64}function ml(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?dT(n,t,r,null,e[++i]):dT(n,t,r,null,null))}}return n}function dT(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function eC(n){return n!==fl}function Wf(n){return n&32767}function P3(n){return n>>16}function qf(n,e){let t=P3(n),i=e;for(;t>0;)i=i[Qs],t--;return i}var Jv=!0;function Kf(n){let e=Jv;return Jv=n,e}var k3=256,tC=k3-1,nC=5,O3=0,Cr={};function F3(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ys)&&(i=t[Ys]),i==null&&(i=t[Ys]=O3++);let r=i&tC,o=1<<r;e.data[n+(r>>nC)]|=o}function Yf(n,e){let t=iC(n,e);if(t!==-1)return t;let i=e[Re];i.firstCreatePass&&(n.injectorIndex=e.length,Vv(i.data,n),Vv(e,null),Vv(i.blueprint,null));let r=T_(n,e),o=n.injectorIndex;if(eC(r)){let s=Wf(r),a=qf(r,e),l=a[Re].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=r,o}function Vv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function iC(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function T_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=lC(r),i===null)return fl;if(t++,r=r[Qs],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return fl}function Xv(n,e,t){F3(n,e,t)}function L3(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(ZT(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function rC(n,e,t){if(t&8||n!==void 0)return n;bf(e,"NodeInjector")}function oC(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[ui],o=Wn(void 0);try{return r?r.get(e,i,t&8):Xy(e,i,t&8)}finally{Wn(o)}}return rC(i,e,t)}function sC(n,e,t,i=0,r){if(n!==null){if(e[Ge]&2048&&!(i&2)){let s=j3(n,e,t,i,Cr);if(s!==Cr)return s}let o=aC(n,e,t,i,Cr);if(o!==Cr)return o}return oC(e,t,i,r)}function aC(n,e,t,i,r){let o=U3(t);if(typeof o=="function"){if(!Tv(e,n,i))return i&1?rC(r,t,i):oC(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))bf(t);else return s}finally{Cv()}}else if(typeof o=="number"){let s=null,a=iC(n,e),l=fl,c=i&1?e[Qn][Di]:null;for((a===-1||i&4)&&(l=a===-1?T_(n,e):e[a+8],l===fl||!fT(i,!1)?a=-1:(s=e[Re],a=Wf(l),e=qf(l,e)));a!==-1;){let d=e[Re];if(hT(o,a,d.data)){let h=V3(a,e,t,s,i,c);if(h!==Cr)return h}l=e[a+8],l!==fl&&fT(i,e[Re].data[a+8]===c)&&hT(o,a,e)?(s=d,a=Wf(l),e=qf(l,e)):a=-1}}return r}function V3(n,e,t,i,r,o){let s=e[Re],a=s.data[n+8],l=i==null?oo(a)&&Jv:i!=s&&(a.type&3)!==0,c=r&1&&o===a,d=Bf(a,s,t,l,c);return d!==null?Eu(e,s,d,a,r):Cr}function Bf(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,d=o>>20,h=i?a:a+d,f=r?a+d:c;for(let g=h;g<f;g++){let x=s[g];if(g<l&&t===x||g>=l&&x.type===t)return g}if(r){let g=s[l];if(g&&Ir(g)&&g.type===t)return l}return null}function Eu(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof aa){let a=o;if(a.resolving){let g=wI(s[t]);throw Jy(g)}let l=Kf(a.canSeeViewProviders);a.resolving=!0;let c=s[t].type||s[t],d,h=a.injectImpl?Wn(a.injectImpl):null,f=Tv(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&C3(t,s[t],e)}finally{h!==null&&Wn(h),Kf(l),a.resolving=!1,Cv()}}return o}function U3(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Ys)?n[Ys]:void 0;return typeof e=="number"?e>=0?e&tC:B3:e}function hT(n,e,t){let i=1<<n;return!!(t[e+(n>>nC)]&i)}function fT(n,e){return!(n&2)&&!(n&1&&e)}var sa=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return sC(this._tNode,this._lView,e,Ws(i),t)}};function B3(){return new sa(Un(),Be())}function ha(n){return Tu(()=>{let e=n.prototype.constructor,t=e[eu]||Zv(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[eu]||Zv(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Zv(n){return Hy(n)?()=>{let e=Zv(On(n));return e&&e()}:Yo(n)}function j3(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[Ge]&2048&&!ta(s);){let a=aC(o,s,t,i|2,Cr);if(a!==Cr)return a;let l=o.parent;if(!l){let c=s[ov];if(c){let d=c.get(t,Cr,i);if(d!==Cr)return d}l=lC(s),s=s[Qs]}o=l}return r}function lC(n){let e=n[Re],t=e.type;return t===2?e.declTNode:t===1?n[Di]:null}function Cu(n){return L3(Un(),n)}function H3(){return bl(Un(),Be())}function bl(n,e){return new ki(Ai(n,e))}var ki=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=H3}return n})();function G3(n){return n instanceof ki?n.nativeElement:n}function $3(){return this._results[Symbol.iterator]()}var Qf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new jt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=CI(e);(this._changesDetected=!TI(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=$3},cC="ngSkipHydration",z3="ngskiphydration";function uC(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let i=e[t];if(typeof i=="number")return!1;if(typeof i=="string"&&i.toLowerCase()===z3)return!0}return!1}function dC(n){return n.hasAttribute(cC)}function Jf(n){return(n.flags&128)===128}function hC(n){if(Jf(n))return!0;let e=n.parent;for(;e;){if(Jf(n)||uC(e))return!0;e=e.parent}return!1}var C_=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(C_||{}),fC=new Map,W3=0;function q3(){return W3++}function K3(n){fC.set(n[ro],n)}function e_(n){fC.delete(n[ro])}var pT="__ngContext__";function yl(n,e){hi(e)?(n[pT]=e[ro],K3(e)):n[pT]=e}function pC(n){return mC(n[cl])}function gC(n){return mC(n[Ci])}function mC(n){for(;n!==null&&!fi(n);)n=n[Ci];return n}var t_;function D_(n){t_=n}function yC(){if(t_!==void 0)return t_;if(typeof document<"u")return document;throw new me(210,!1)}var Ar=new we("",{factory:()=>Y3}),Y3="ng";var fp=new we(""),Zi=new we("",{providedIn:"platform",factory:()=>"unknown"});var wl=new we("",{factory:()=>K(Qt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var xl=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=Q3(K(Qt),K(Ar)),t}});store={};onSerializeCallbacks={};get(t,i){return this.store[t]!==void 0?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function Q3(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}var vC="h",_C="b",J3="f",X3="n",EC="e",bC="t",pp="c",A_="x",bu="r",wC="i",xC="n",M_="d";var SC="di",IC="s",TC="p";var Du=new we(""),CC=!1,R_=new we("",{factory:()=>CC});var N_=new we(""),DC=!1,AC=new we("",{factory:()=>[]}),MC=new we(""),P_=new we("",{factory:()=>new Map});var Au="ngb";var RC=(n,e,t)=>{let i=n,r=i.__jsaction_fns??new Map,o=r.get(e)??[];o.push(t),r.set(e,o),i.__jsaction_fns=r},NC=(n,e)=>{let t=n,i=t.getAttribute(Au)??"",r=e.get(i)??new Set;r.has(t)||r.add(t),e.set(i,r)};var PC=n=>{n.removeAttribute(Of.JSACTION),n.removeAttribute(Au),n.__jsaction_fns=void 0},kC=new we("",{factory:()=>({})});function k_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let i of t)i(n)}var n_=new Map;function OC(n,e){return n_.set(n,e),()=>n_.delete(n)}var gT=!1,FC=(n,e,t,i)=>{};function Z3(n,e,t,i){FC(n,e,t,i)}function LC(){gT||(FC=(n,e,t,i)=>{let r=n[ui].get(Ar);n_.get(r)?.(e,t,i)},gT=!0)}var gp=new we("");function mp(n){return(n.flags&32)===32}var eF="__nghData__",O_=eF,tF="__nghDeferData__",VC=tF;var jf="ngh",UC="nghm",BC=()=>null;function nF(n,e,t=!1){let i=n.getAttribute(jf);if(i==null)return null;let[r,o]=i.split("|");if(i=t?o:r,!i)return null;let s=o?`|${o}`:"",a=t?r:s,l={};if(i!==""){let d=e.get(xl,null,{optional:!0});d!==null&&(l=d.get(O_,[])[Number(i)])}let c={data:l,firstChild:n.firstChild??null};return t&&(c.firstChild=n,yp(c,0,n.nextSibling)),a?n.setAttribute(jf,a):n.removeAttribute(jf),c}function jC(){BC=nF}function HC(n,e,t=!1){return BC(n,e,t)}function GC(n){let e=n._lView;return e[Re].type===2?null:(ta(e)&&(e=e[ut]),e)}function iF(n){return n.textContent?.replace(/\s/gm,"")}function rF(n){let e=yC(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=iF(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),i,r=[];for(;i=t.nextNode();)r.push(i);for(let o of r)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function yp(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function i_(n,e){return n.segmentHeads?.[e]??null}function $C(n){return n.get(MC,!1,{optional:!0})}function oF(n,e){let t=n.data,i=t[EC]?.[e]??null;return i===null&&t[pp]?.[e]&&(i=F_(n,e)),i}function zC(n,e){return n.data[pp]?.[e]??null}function F_(n,e){let t=zC(n,e)??[],i=0;for(let r of t)i+=r[bu]*(r[A_]??1);return i}function sF(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[M_];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function WC(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[M_];n.disconnectedNodes=t?new Set(t):null}return!!sF(n)?.has(e)}function vp(n,e){let t=n[Zn];return t!==null&&!mv()&&!mp(e)&&!WC(t,e.index-ut)}function aF(n,e){let t=e.get(gp),r=e.get(xl).get(VC,{}),o=!1,s=n,a=null,l=[];for(;!o&&s;){o=t.has(s);let c=t.hydrating.get(s);if(a===null&&c!=null){a=c.promise;break}l.unshift(s),s=r[s][TC]}return{parentBlockPromise:a,hydrationQueue:l}}function Uv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===UC}function mT(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function qC(n){for(let i of n.body.childNodes)if(Uv(i))return;let e=mT(n.body.previousSibling);if(Uv(e))return;let t=mT(n.head.lastChild);if(!Uv(t))throw new me(-507,!1)}function KC(n,e){let t=n.contentQueries;if(t!==null){let i=Ue(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];Mf(o),a.contentQueries(2,e[s],s)}}}finally{Ue(i)}}}function r_(n,e,t){Mf(0);let i=Ue(null);try{e(n,t)}finally{Ue(i)}}function YC(n,e,t){if(sv(e)){let i=Ue(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ue(i)}}}var Xi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Xi||{});var Ff;function lF(){if(Ff===void 0&&(Ff=null,vr.trustedTypes))try{Ff=vr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Ff}function yT(n){return lF()?.createScriptURL(n)||n}var Xf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${mf})`}};function Sl(n){return n instanceof Xf?n.changingThisBreaksApplicationSecurity:n}function _p(n,e){let t=QC(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${mf})`)}return t===e}function QC(n){return n instanceof Xf&&n.getTypeName()||null}var cF=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function L_(n){return n=String(n),n.match(cF)?n:"unsafe:"+n}var uF=/^>|^->|<!--|-->|--!>|<!-$/g,dF=/(<|>)/g,hF="\u200B$1\u200B";function fF(n){return n.replace(uF,e=>e.replace(dF,hF))}function JC(n,e){return n.createText(e)}function pF(n,e,t){n.setValue(e,t)}function XC(n,e){return n.createComment(fF(e))}function V_(n,e,t){return n.createElement(e,t)}function Zf(n,e,t,i,r){n.insertBefore(e,t,i,r)}function ZC(n,e,t){n.appendChild(e,t)}function vT(n,e,t,i,r){i!==null?Zf(n,e,t,i,r):ZC(n,e,t)}function U_(n,e,t,i){n.removeChild(null,e,t,i)}function eD(n){n.textContent=""}function gF(n,e,t){n.setAttribute(e,"style",t)}function mF(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function tD(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&R3(n,e,i),r!==null&&mF(n,e,r),o!==null&&gF(n,e,o)}var Mu=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Mu||{});function er(n){let e=iD();return e?e.sanitize(Mu.URL,n)||"":_p(n,"URL")?Sl(n):L_(Ki(n))}function nD(n){let e=iD();if(e)return yT(e.sanitize(Mu.RESOURCE_URL,n)||"");if(_p(n,"ResourceURL"))return yT(Sl(n));throw new me(904,!1)}var yF=new Set(["embed","frame","iframe","media","script"]),vF=new Set(["base","link","script"]);function _F(n,e){return e==="src"&&yF.has(n)||e==="href"&&vF.has(n)||e==="xlink:href"&&n==="script"?nD:er}function B_(n,e,t){return _F(e,t)(n)}function iD(){let n=Be();return n&&n[wr].sanitizer}function fa(n){return n.ownerDocument.defaultView}function rD(n){return n.ownerDocument.body}function oD(n){return n instanceof Function?n():n}function EF(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var sD="ng-template";function bF(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&EF(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(j_(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function j_(n){return n.type===4&&n.value!==sD}function wF(n,e,t){let i=n.type===4&&!t?sD:n.value;return e===i}function xF(n,e,t){let i=4,r=n.attrs,o=r!==null?TF(r):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Qi(i)&&!Qi(l))return!1;if(s&&Qi(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!wF(n,l,t)||l===""&&e.length===1){if(Qi(i))return!1;s=!0}}else if(i&8){if(r===null||!bF(n,r,l,t)){if(Qi(i))return!1;s=!0}}else{let c=e[++a],d=SF(l,r,j_(n),t);if(d===-1){if(Qi(i))return!1;s=!0;continue}if(c!==""){let h;if(d>o?h="":h=r[d+1].toLowerCase(),i&2&&c!==h){if(Qi(i))return!1;s=!0}}}}return Qi(i)||s}function Qi(n){return(n&1)===0}function SF(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return CF(e,n)}function IF(n,e,t=!1){for(let i=0;i<e.length;i++)if(xF(n,e[i],t))return!0;return!1}function TF(n){for(let e=0;e<n.length;e++){let t=n[e];if(ZT(t))return e}return n.length}function CF(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function _T(n,e){return n?":not("+e.trim()+")":e}function DF(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!Qi(s)&&(e+=_T(o,r),r=""),i=s,o=o||!Qi(i);t++}return r!==""&&(e+=_T(o,r)),e}function AF(n){return n.map(DF).join(",")}function MF(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!Qi(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var xn={};function H_(n,e,t,i,r,o,s,a,l,c,d){let h=ut+i,f=h+r,g=RF(h,f),x=typeof c=="function"?c():c;return g[Re]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:x,incompleteFirstPass:!1,ssrId:d}}function RF(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:xn);return t}function NF(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=H_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function G_(n,e,t,i,r,o,s,a,l,c,d){let h=e.blueprint.slice();return h[Yn]=r,h[Ge]=i|4|128|8|64|1024,(c!==null||n&&n[Ge]&2048)&&(h[Ge]|=2048),cv(h),h[Zt]=h[Qs]=n,h[en]=t,h[wr]=s||n&&n[wr],h[St]=a||n&&n[St],h[ui]=l||n&&n[ui]||null,h[Di]=o,h[ro]=q3(),h[Zn]=d,h[ov]=c,h[Qn]=e.type==2?n[Qn]:h,h}function PF(n,e,t){let i=Ai(e,n),r=NF(t),o=n[wr].rendererFactory,s=$_(n,G_(n,r,null,aD(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function aD(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function lD(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function $_(n,e){return n[cl]?n[rv][Ci]=e:n[cl]=e,n[rv]=e,e}function m(n=1){cD(tn(),Be(),Ni()+n,!1)}function cD(n,e,t,i){if(!i)if((e[Ge]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Vf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Uf(e,o,0,t)}ns(t)}var Ep=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Ep||{});function o_(n,e,t,i){let r=Ue(null);try{let[o,s,a]=n.inputs[t],l=null;(s&Ep.SignalBased)!==0&&(l=e[o][Jn]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,l,i,t,o):qT(e,l,o,i)}finally{Ue(r)}}var Dr=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Dr||{}),kF;function z_(n,e){return kF(n,e)}var la=new Set,bp=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(bp||{}),os=new we(""),ET=new Set;function yi(n){ET.has(n)||(ET.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var W_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),uD=[0,1,2,3],dD=(()=>{class n{ngZone=K(yn);scheduler=K(Jo);errorHandler=K(yr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){K(os,{optional:!0})}execute(){let t=this.sequences.size>0;t&&pt(at.AfterRenderHooksStart),this.executing=!0;for(let i of uD)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&pt(at.AfterRenderHooksEnd)}register(t){let{view:i}=t;i!==void 0?((i[Xs]??=[]).push(t),ul(i),i[Ge]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(bp.AFTER_NEXT_RENDER,t):t()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),ep=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Xs];e&&(this.view[Xs]=e.filter(t=>t!==this))}};function Ru(n,e){let t=e?.injector??K(Kn);return yi("NgAfterNextRender"),FF(n,t,e,!0)}function OF(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function FF(n,e,t,i){let r=e.get(W_);r.impl??=e.get(dD);let o=e.get(os,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(ei):null,a=e.get(kf,null,{optional:!0}),l=new ep(r.impl,OF(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(l),l}var hD=new we("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:K(Yt)})});function fD(n,e,t){let i=n.get(hD);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function LF(n,e){let t=n.get(hD);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function VF(n,e){for(let[t,i]of e)fD(n,i.animateFns)}function bT(n,e,t,i){let r=n?.[Zs]?.enter;e!==null&&r&&r.has(t.index)&&VF(i,r)}function hl(n,e,t,i,r,o,s,a){if(r!=null){let l,c=!1;fi(r)?l=r:hi(r)&&(c=!0,r=r[Yn]);let d=pi(r);n===0&&i!==null?(bT(a,i,o,t),s==null?ZC(e,i,d):Zf(e,i,d,s||null,!0)):n===1&&i!==null?(bT(a,i,o,t),Zf(e,i,d,s||null,!0)):n===2?wT(a,o,t,h=>{U_(e,d,c,h)}):n===3&&wT(a,o,t,()=>{e.destroyNode(d)}),l!=null&&JF(e,n,t,l,o,i,s)}}function UF(n,e){pD(n,e),e[Yn]=null,e[Di]=null}function BF(n,e,t,i,r,o){i[Yn]=r,i[Di]=e,xp(n,i,t,1,r,o)}function pD(n,e){e[wr].changeDetectionScheduler?.notify(9),xp(n,e,e[St],2,null,null)}function jF(n){let e=n[cl];if(!e)return Bv(n[Re],n);for(;e;){let t=null;if(hi(e))t=e[cl];else{let i=e[$t];i&&(t=i)}if(!t){for(;e&&!e[Ci]&&e!==n;)hi(e)&&Bv(e[Re],e),e=e[Zt];e===null&&(e=n),hi(e)&&Bv(e[Re],e),t=e&&e[Ci]}e=t}}function q_(n,e){let t=n[ea],i=t.indexOf(e);t.splice(i,1)}function wp(n,e){if(ts(e))return;let t=e[St];t.destroyNode&&xp(n,e,t,3,null,null),jF(e)}function Bv(n,e){if(ts(e))return;let t=Ue(null);try{e[Ge]&=-129,e[Ge]|=256,e[di]&&zc(e[di]),$F(n,e),GF(n,e),e[Re].type===1&&e[St].destroy();let i=e[es];if(i!==null&&fi(e[Zt])){i!==e[Zt]&&q_(i,e);let r=e[xr];r!==null&&r.detachView(n)}e_(e)}finally{Ue(t)}}function wT(n,e,t,i){let r=n?.[Zs];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&la.add(n[ro]),fD(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let c=s.animateFns[l],{promise:d}=c();a.push(d)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),HF(n,i)}else n&&la.delete(n[ro]),i(!1)},r)}function HF(n,e){let t=n[Zs]?.running;if(t){t.then(()=>{n[Zs].running=void 0,la.delete(n[ro]),e(!0)});return}e(!1)}function GF(n,e){let t=n.cleanup,i=e[ll];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[ll]=null);let r=e[eo];if(r!==null){e[eo]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[lu];if(o!==null){e[lu]=null;for(let s of o)s.destroy()}}function $F(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof aa)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],l=o[s+1];pt(at.LifecycleHookStart,a,l);try{l.call(a)}finally{pt(at.LifecycleHookEnd,a,l)}}else{pt(at.LifecycleHookStart,r,o);try{o.call(r)}finally{pt(at.LifecycleHookEnd,r,o)}}}}}function zF(n,e,t){return WF(n,e.parent,t)}function WF(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Yn];if(oo(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Xi.None||r===Xi.Emulated)return null}return Ai(i,t)}function qF(n,e,t){return YF(n,e,t)}function KF(n,e,t){return n.type&40?Ai(n,t):null}var YF=KF,xT;function K_(n,e,t,i){let r=zF(n,i,e),o=e[St],s=i.parent||e[Di],a=qF(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)vT(o,r,t[l],a,!1);else vT(o,r,t,a,!1);xT!==void 0&&xT(o,i,e,t,r)}function vu(n,e){if(e!==null){let t=e.type;if(t&3)return Ai(e,n);if(t&4)return s_(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return vu(n,i);{let r=n[e.index];return fi(r)?s_(-1,r):pi(r)}}else{if(t&128)return vu(n,e.next);if(t&32)return z_(e,n)()||pi(n[e.index]);{let i=gD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=Qo(n[Qn]);return vu(r,i)}else return vu(n,e.next)}}}return null}function gD(n,e){if(e!==null){let i=n[Qn][Di],r=e.projection;return i.projection[r]}return null}function s_(n,e){let t=$t+n+1;if(t<e.length){let i=e[t],r=i[Re].firstChild;if(r!==null)return vu(i,r)}return e[Sr]}function Y_(n,e,t,i,r,o,s){for(;t!=null;){let a=i[ui];if(t.type===128){t=t.next;continue}let l=i[t.index],c=t.type;if(s&&e===0&&(l&&yl(pi(l),i),t.flags|=2),!mp(t))if(c&8)Y_(n,e,t.child,i,r,o,!1),hl(e,n,a,r,l,t,o,i);else if(c&32){let d=z_(t,i),h;for(;h=d();)hl(e,n,a,r,h,t,o,i);hl(e,n,a,r,l,t,o,i)}else c&16?QF(n,e,i,t,r,o):hl(e,n,a,r,l,t,o,i);t=s?t.projectionNext:t.next}}function xp(n,e,t,i,r,o){Y_(t,i,n.firstChild,e,r,o,!1)}function QF(n,e,t,i,r,o){let s=t[Qn],l=s[Di].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];hl(e,n,t[ui],r,d,i,o,t)}else{let c=l,d=s[Zt];Jf(i)&&(c.flags|=128),Y_(n,e,c,d,r,o,!0)}}function JF(n,e,t,i,r,o,s){let a=i[Sr],l=pi(i);a!==l&&hl(e,n,t,o,a,r,s);for(let c=$t;c<i.length;c++){let d=i[c];xp(d[Re],d,n,e,o,a)}}function XF(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:Dr.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Dr.Important),n.setStyle(t,i,r,o))}}function mD(n,e,t,i,r){let o=Ni(),s=i&2;try{ns(-1),s&&e.length>ut&&cD(n,e,ut,!1);let a=s?at.TemplateUpdateStart:at.TemplateCreateStart;pt(a,r,t),t(i,r)}finally{ns(o);let a=s?at.TemplateUpdateEnd:at.TemplateCreateEnd;pt(a,r,t)}}function Q_(n,e,t){sL(n,e,t),(t.flags&64)===64&&aL(n,e,t)}function Sp(n,e,t=Ai){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function ZF(n,e,t,i){let o=i.get(R_,CC)||t===Xi.ShadowDom||t===Xi.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return eL(s),s}function eL(n){yD(n)}var yD=()=>null;function tL(n){dC(n)?eD(n):rF(n)}function vD(){yD=tL}function nL(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function iL(n,e,t,i,r,o){let s=e[Re];if(X_(n,s,e,t,i)){oo(n)&&oL(e,n.index);return}n.type&3&&(t=nL(t)),rL(n,e,t,i,r,o)}function rL(n,e,t,i,r,o){if(n.type&3){let s=Ai(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function oL(n,e){let t=Mi(e,n);t[Ge]&16||(t[Ge]|=64)}function sL(n,e,t){let i=t.directiveStart,r=t.directiveEnd;oo(t)&&PF(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Yf(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],l=Eu(e,n,s,t);if(yl(l,e),o!==null&&dL(e,s-i,l,a,t,o),Ir(a)){let c=Mi(t.index,e);c[en]=Eu(e,n,s,t)}}}function aL(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=QI();try{ns(o);for(let a=i;a<r;a++){let l=n.data[a],c=e[a];Af(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&lL(l,c)}}finally{ns(-1),Af(s)}}function lL(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function _D(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];IF(e,o.selectors,!1)&&(i??=[],Ir(o)?i.unshift(o):i.push(o))}return i}function cL(n,e,t,i,r,o){let s=Ai(n,e);uL(e[St],s,o,n.value,t,i,r)}function uL(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?Ki(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function dL(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];o_(i,t,l,c)}}function ED(n,e,t,i,r){let o=ut+t,s=e[Re],a=r(s,e,n,i,t);e[o]=a,ia(n,!0);let l=n.type===2;return l?(tD(e[St],a,n),(HI()===0||uu(n))&&yl(a,e),GI()):yl(a,e),Pf()&&(!l||!mp(n))&&K_(s,e,a,n),n}function bD(n){let e=n;return Ev()?WI():(e=e.parent,ia(e,!1)),e}function J_(n,e){let t=n[ui];if(!t)return;let i;try{i=t.get(gi,null)}catch{i=null}i?.(e)}function X_(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],d=s[l+1],h=e.data[c];o_(h,t[c],d,r),a=!0}if(o)for(let l of o){let c=t[l],d=e.data[l];o_(d,c,i,r),a=!0}return a}function hL(n,e){let t=Mi(e,n),i=t[Re];fL(i,t);let r=t[Yn];r!==null&&t[Zn]===null&&(t[Zn]=HC(r,t[ui])),pt(at.ComponentStart);try{Z_(i,t,t[en])}finally{pt(at.ComponentEnd,t[en])}}function fL(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Z_(n,e,t){Rf(e);try{let i=n.viewQuery;i!==null&&r_(1,i,t);let r=n.template;r!==null&&mD(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[xr]?.finishViewCreation(n),n.staticContentQueries&&KC(n,e),n.staticViewQueries&&r_(2,n.viewQuery,t);let o=n.components;o!==null&&pL(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ge]&=-5,Nf()}}function pL(n,e){for(let t=0;t<e.length;t++)hL(n,e[t])}function Nu(n,e,t,i){let r=Ue(null);try{let o=e.tView,a=n[Ge]&4096?4096:16,l=G_(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),c=n[e.index];l[es]=c;let d=n[xr];return d!==null&&(l[xr]=d.createEmbeddedView(o)),Z_(o,l,t),l}finally{Ue(r)}}function vl(n,e){return!e||e.firstChild===null||Jf(n)}function wu(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(pi(o)),fi(o)&&wD(o,i);let s=t.type;if(s&8)wu(n,e,t.child,i);else if(s&32){let a=z_(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=gD(e,t);if(Array.isArray(a))i.push(...a);else{let l=Qo(e[Qn]);wu(l[Re],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function wD(n,e){for(let t=$t;t<n.length;t++){let i=n[t],r=i[Re].firstChild;r!==null&&wu(i[Re],i,r,e)}n[Sr]!==n[Yn]&&e.push(n[Sr])}function xD(n){if(n[Xs]!==null){for(let e of n[Xs])e.impl.addSequence(e);n[Xs].length=0}}var SD=[];function gL(n){return n[di]??mL(n)}function mL(n){let e=SD.pop()??Object.create(vL);return e.lView=n,e}function yL(n){n.lView[di]!==n&&(n.lView=null,SD.push(n))}var vL=ce(F({},Hc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{ul(n.lView)},consumerOnSignalRead(){this.lView[di]=this}});function _L(n){let e=n[di]??Object.create(EL);return e.lView=n,e}var EL=ce(F({},Hc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Qo(n.lView);for(;e&&!ID(e[Re]);)e=Qo(e);e&&uv(e)},consumerOnSignalRead(){this.lView[di]=this}});function ID(n){return n.type!==2}function TD(n){if(n[lu]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[lu])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[Ge]&8192)}}var bL=100;function CD(n,e=0){let i=n[wr].rendererFactory,r=!1;r||i.begin?.();try{wL(n,e)}finally{r||i.end?.()}}function wL(n,e){let t=wv();try{xv(!0),a_(n,e);let i=0;for(;fu(n);){if(i===bL)throw new me(103,!1);i++,a_(n,1)}}finally{xv(t)}}function xL(n,e,t,i){if(ts(e))return;let r=e[Ge],o=!1,s=!1;Rf(e);let a=!0,l=null,c=null;o||(ID(n)?(c=gL(e),l=$c(c)):Nh()===null?(a=!1,c=_L(e),l=$c(c)):e[di]&&(zc(e[di]),e[di]=null));try{cv(e),qI(n.bindingStartIndex),t!==null&&mD(n,e,t,2,i);let d=(r&3)===3;if(!o)if(d){let g=n.preOrderCheckHooks;g!==null&&Vf(e,g,null)}else{let g=n.preOrderHooks;g!==null&&Uf(e,g,0,null),Lv(e,0)}if(s||SL(e),TD(e),DD(e,0),n.contentQueries!==null&&KC(n,e),!o)if(d){let g=n.contentCheckHooks;g!==null&&Vf(e,g)}else{let g=n.contentHooks;g!==null&&Uf(e,g,1),Lv(e,1)}TL(n,e);let h=n.components;h!==null&&MD(e,h,0);let f=n.viewQuery;if(f!==null&&r_(2,f,i),!o)if(d){let g=n.viewCheckHooks;g!==null&&Vf(e,g)}else{let g=n.viewHooks;g!==null&&Uf(e,g,2),Lv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Tf]){for(let g of e[Tf])g();e[Tf]=null}o||(xD(e),e[Ge]&=-73)}catch(d){throw o||ul(e),d}finally{c!==null&&(Ph(c,l),a&&yL(c)),Nf()}}function DD(n,e){for(let t=pC(n);t!==null;t=gC(t))for(let i=$t;i<t.length;i++){let r=t[i];AD(r,e)}}function SL(n){for(let e=pC(n);e!==null;e=gC(e)){if(!(e[Ge]&2))continue;let t=e[ea];for(let i=0;i<t.length;i++){let r=t[i];uv(r)}}}function IL(n,e,t){pt(at.ComponentStart);let i=Mi(e,n);try{AD(i,t)}finally{pt(at.ComponentEnd,i[en])}}function AD(n,e){Cf(n)&&a_(n,e)}function a_(n,e){let i=n[Re],r=n[Ge],o=n[di],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&kh(o)),s||=!1,o&&(o.dirty=!1),n[Ge]&=-9217,s)xL(i,n,i.template,n[en]);else if(r&8192){let a=Ue(null);try{TD(n),DD(n,1);let l=i.components;l!==null&&MD(n,l,1),xD(n)}finally{Ue(a)}}}function MD(n,e,t){for(let i=0;i<e.length;i++)IL(n,e[i],t)}function TL(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)ns(~r);else{let o=r,s=t[++i],a=t[++i];YI(s,o);let l=e[o];pt(at.HostBindingsUpdateStart,l);try{a(2,l)}finally{pt(at.HostBindingsUpdateEnd,l)}}}}finally{ns(-1)}}function Ip(n,e){let t=wv()?64:1088;for(n[wr].changeDetectionScheduler?.notify(e);n;){n[Ge]|=t;let i=Qo(n);if(ta(n)&&!i)return n;n=i}return null}function RD(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function ND(n,e){let t=$t+e;if(t<n.length)return n[t]}function Pu(n,e,t,i=!0){let r=e[Re];if(CL(r,e,n,t),i){let s=s_(t,n),a=e[St],l=a.parentNode(n[Sr]);l!==null&&BF(r,n[Di],a,e,l,s)}let o=e[Zn];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function eE(n,e){let t=xu(n,e);return t!==void 0&&wp(t[Re],t),t}function xu(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t];if(i){let r=i[es];r!==null&&r!==n&&q_(r,i),e>0&&(n[t-1][Ci]=i[Ci]);let o=ou(n,$t+e);UF(i[Re],i);let s=o[xr];s!==null&&s.detachView(o[Re]),i[Zt]=null,i[Ci]=null,i[Ge]&=-129}return i}function CL(n,e,t,i){let r=$t+i,o=t.length;i>0&&(t[r-1][Ci]=e),i<o-$t?(e[Ci]=t[r],Zy(t,$t+i,e)):(t.push(e),e[Ci]=null),e[Zt]=t;let s=e[es];s!==null&&t!==s&&PD(s,e);let a=e[xr];a!==null&&a.insertView(n),Df(e),e[Ge]|=128}function PD(n,e){let t=n[ea],i=e[Zt];if(hi(i))n[Ge]|=2;else{let r=i[Zt][Qn];e[Qn]!==r&&(n[Ge]|=2)}t===null?n[ea]=[e]:t.push(e)}var is=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Re];return wu(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[en]}set context(e){this._lView[en]=e}get destroyed(){return ts(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Zt];if(fi(e)){let t=e[cu],i=t?t.indexOf(this):-1;i>-1&&(xu(e,i),ou(t,i))}this._attachedToViewContainer=!1}wp(this._lView[Re],this._lView)}onDestroy(e){dv(this._lView,e)}markForCheck(){Ip(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ge]&=-129}reattach(){Df(this._lView),this._lView[Ge]|=128}detectChanges(){this._lView[Ge]|=1024,CD(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new me(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=ta(this._lView),t=this._lView[es];t!==null&&!e&&q_(t,this._lView),pD(this._lView[Re],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new me(902,!1);this._appRef=e;let t=ta(this._lView),i=this._lView[es];i!==null&&!t&&PD(i,this._lView),Df(this._lView)}};var rs=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=DL;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Nu(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new is(o)}}return n})();function DL(){return Tp(Un(),Be())}function Tp(n,e){return n.type&4?new rs(e,n,bl(n,e)):null}function Il(n,e,t,i,r){let o=n.data[e];if(o===null)o=AL(n,e,t,i,r),KI()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=zI();o.injectorIndex=s===null?-1:s.injectorIndex}return ia(o,!0),o}function AL(n,e,t,i,r){let o=_v(),s=Ev(),a=s?o:o&&o.parent,l=n.data[e]=RL(n,a,t,e,i,r);return ML(n,l,o,s),l}function ML(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function RL(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return mv()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var NL=new RegExp(`^(\\d+)*(${_C}|${vC})*(.*)`);function PL(n){let e=n.match(NL),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(let[l,c,d]of o.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(c,h)}return[s,...a]}function kL(n){return!n.prev&&n.parent?.type===8}function jv(n){return n.index-ut}function OL(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function Cp(n,e,t,i){let r=jv(i),o=OL(n,r);if(o===void 0){let s=n.data[xC];if(s?.[r])o=LL(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{let a=i.prev===null,l=i.prev??i.parent;if(kL(i)){let c=jv(i.parent);o=i_(n,c)}else{let c=Ai(l,t);if(a)o=c.firstChild;else{let d=jv(l),h=i_(n,d);if(l.type===2&&h){let g=F_(n,d)+1;o=Dp(g,h)}else o=c.nextSibling}}}}return o}function Dp(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}function FL(n,e){let t=n;for(let i=0;i<e.length;i+=2){let r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case J3:t=t.firstChild;break;case X3:t=t.nextSibling;break}}return t}function LL(n,e){let[t,...i]=PL(n),r;if(t===vC)r=e[Qn][Yn];else if(t===_C)r=rD(e[Qn][Yn]);else{let o=Number(t);r=pi(e[o+ut])}return FL(r,i)}var VL=!1;function kD(n){VL=n}function UL(n){let e=n[Zn];if(e){let{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){let r=n[St];for(let o of i.values())BL(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function BL(n,e,t){for(let i of t.node.cases[t.case]){let r=e.get(i.index-ut);r&&U_(n,r,!1)}}function Ap(n){let e=n[Yi]??[],i=n[Zt][St],r=[];for(let o of e)o.data[SC]!==void 0?r.push(o):OD(o,i);n[Yi]=r}function jL(n){let{lContainer:e}=n,t=e[Yi];if(t===null)return;let r=e[Zt][St];for(let o of t)OD(o,r)}function OD(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[bu];for(;t<r;){let o=i.nextSibling;U_(e,i,!1),i=o,t++}}}function Mp(n){Ap(n);let e=n[Yn];hi(e)&&tp(e);for(let t=$t;t<n.length;t++)tp(n[t])}function tp(n){UL(n);let e=n[Re];for(let t=ut;t<e.bindingStartIndex;t++)if(fi(n[t])){let i=n[t];Mp(i)}else hi(n[t])&&tp(n[t])}function tE(n){let e=n._views;for(let t of e){let i=GC(t);i!==null&&i[Yn]!==null&&(hi(i)?tp(i):Mp(i))}}function HL(n,e,t,i){n!==null&&(t.cleanup(e),Mp(n.lContainer),tE(i))}function GL(n,e){let t=[];for(let i of e)for(let r=0;r<(i[A_]??1);r++){let o={data:i,firstChild:null};i[bu]>0&&(o.firstChild=n,n=Dp(i[bu],n)),t.push(o)}return[n,t]}var FD=()=>null,LD=()=>null;function VD(){FD=$L,LD=zL}function $L(n,e){return BD(n,e)?n[Yi].shift():(Ap(n),null)}function np(n,e){return FD(n,e)}function zL(n,e,t){if(e.tView.ssrId===null)return null;let i=np(n,e.tView.ssrId);return t[Re].firstUpdatePass&&i===null&&WL(t,e),i}function UD(n,e,t){return LD(n,e,t)}function WL(n,e){let t=e;for(;t;){if(ST(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(ST(n,t))return;t=t.next}}function BD(n,e){let t=n[Yi];return!e||t===null||t.length===0?!1:t[0].data[wC]===e}function ST(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let i=n[e.index];return fi(i)&&BD(i,t)?(Ap(i),!0):!1}var jD=class{},Rp=class{},l_=class{resolveComponentFactory(e){throw new me(917,!1)}},ku=class{static NULL=new l_},ca=class{},ss=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>qL()}return n})();function qL(){let n=Be(),e=Un(),t=Mi(e.index,n);return(hi(t)?t:n)[St]}var HD=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>null})}return n})();var Hf={},pl=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,Hf,i);return r!==Hf||t===Hf?r:this.parentInjector.get(e,t,i)}};function ip(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=yf(r,a);else if(o==2){let l=a,c=e[++s];i=yf(i,l+": "+c+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function he(n,e=0){let t=Be();if(t===null)return Ne(n,e);let i=Un();return sC(i,t,On(n),e)}function GD(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,l=null,c=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,l,c]=d.resolveHostDirectives(s);break}QL(n,e,t,a,o,l,c)}o!==null&&i!==null&&KL(t,i,o)}function KL(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new me(-301,!1);i.push(e[r],o)}}function YL(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function QL(n,e,t,i,r,o,s){let a=i.length,l=null;for(let f=0;f<a;f++){let g=i[f];l===null&&Ir(g)&&(l=g,YL(n,t,f)),Xv(Yf(t,e),n,g.type)}nV(t,n.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let f=0;f<a;f++){let g=i[f];g.providersResolver&&g.providersResolver(g)}let c=!1,d=!1,h=lD(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let f=0;f<a;f++){let g=i[f];if(t.mergedAttrs=ml(t.mergedAttrs,g.hostAttrs),XL(n,t,e,h,g),tV(h,g,r),s!==null&&s.has(g)){let[S,R]=s.get(g);t.directiveToIndex.set(g.type,[h,S+t.directiveStart,R+t.directiveStart])}else(o===null||!o.has(g))&&t.directiveToIndex.set(g.type,h);g.contentQueries!==null&&(t.flags|=4),(g.hostBindings!==null||g.hostAttrs!==null||g.hostVars!==0)&&(t.flags|=64);let x=g.type.prototype;!c&&(x.ngOnChanges||x.ngOnInit||x.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!d&&(x.ngOnChanges||x.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}JL(n,t,o)}function JL(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))IT(0,e,r,i),IT(1,e,r,i),CT(e,i,!1);else{let o=t.get(r);TT(0,e,o,i),TT(1,e,o,i),CT(e,i,!0)}}}function IT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),$D(e,o)}}function TT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),$D(e,s)}}function $D(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function CT(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||j_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&r.hasOwnProperty(l)){let c=r[l];for(let d of c)if(d===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let c=o[l];for(let d=0;d<c.length;d+=2)if(c[d]===e){s??=[],s.push(c[d+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function XL(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Yo(r.type,!0)),s=new aa(o,Ir(r),he,null);n.blueprint[i]=s,t[i]=s,ZL(n,e,i,lD(n,t,r.hostVars,xn),r)}function ZL(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;eV(s)!=a&&s.push(a),s.push(t,i,o)}}function eV(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function tV(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Ir(e)&&(t[""]=n)}}function nV(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function zD(n,e,t,i,r,o,s,a){let l=e[Re],c=l.consts,d=Ri(c,s),h=Il(l,n,t,i,d);return o&&GD(l,e,h,Ri(c,a),r),h.mergedAttrs=ml(h.mergedAttrs,h.attrs),h.attrs!==null&&ip(h,h.attrs,!1),h.mergedAttrs!==null&&ip(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function WD(n,e){JT(n,e),sv(e)&&n.queries.elementEnd(e)}function iV(n,e,t,i,r,o){let s=e.consts,a=Ri(s,r),l=Il(e,n,t,i,a);if(l.mergedAttrs=ml(l.mergedAttrs,l.attrs),o!=null){let c=Ri(s,o);l.localNames=[];for(let d=0;d<c.length;d+=2)l.localNames.push(c[d],-1)}return l.attrs!==null&&ip(l,l.attrs,!1),l.mergedAttrs!==null&&ip(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function nE(n){return KD(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function qD(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function KD(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Np(n,e,t){return n[e]=t}function rV(n,e){return n[e]}function Pi(n,e,t){if(t===xn)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function iE(n,e,t,i){let r=Pi(n,e,t);return Pi(n,e+1,i)||r}function YD(n,e,t,i,r){let o=iE(n,e,t,i);return Pi(n,e+2,r)||o}function Gf(n,e,t){return function i(r){let o=oo(n)?Mi(n.index,e):e;Ip(o,5);let s=e[en],a=DT(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=DT(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function DT(n,e,t,i){let r=Ue(null);try{return pt(at.OutputStart,e,t),t(i)!==!1}catch(o){return J_(n,o),!1}finally{pt(at.OutputEnd,e,t),Ue(r)}}function QD(n,e,t,i,r,o,s,a){let l=uu(n),c=!1,d=null;if(!i&&l&&(d=sV(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,c=!0}else{let h=Ai(n,t),f=i?i(h):h;Z3(t,f,o,a);let g=r.listen(f,o,a);if(!oV(o)){let x=i?S=>i(pi(S[n.index])):n.index;JD(x,e,t,o,a,g,!1)}}return c}function oV(n){return n.startsWith("animation")||n.startsWith("transition")}function sV(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[ll],l=r[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function JD(n,e,t,i,r,o,s){let a=e.firstCreatePass?fv(e):null,l=hv(t),c=l.length;l.push(r,o),a&&a.push(i,n,c,(c+1)*(s?-1:1))}function AT(n,e,t,i,r,o){let s=e[t],a=e[Re],c=a.data[t].outputs[i],h=s[c].subscribe(o);JD(n.index,a,e,r,o,h,!0)}var c_=Symbol("BINDING");var rp=class extends ku{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=io(e);return new _l(t,this.ngModule)}};function aV(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&Ep.SignalBased)!==0};return r&&(o.transform=r),o})}function lV(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function cV(n,e,t){let i=e instanceof Yt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new pl(t,i):t}function uV(n){let e=n.get(ca,null);if(e===null)throw new me(407,!1);let t=n.get(HD,null),i=n.get(Jo,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function dV(n,e){let t=XD(n);return V_(e,t,t==="svg"?av:t==="math"?FI:null)}function XD(n){return(n.selectors[0][0]||"div").toLowerCase()}var _l=class extends Rp{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=aV(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=lV(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=AF(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){pt(at.DynamicComponentStart);let a=Ue(null);try{let l=this.componentDef,c=hV(i,l,s,o),d=cV(l,r||this.ngModule,e),h=uV(d),f=h.rendererFactory.createRenderer(null,l),g=i?ZF(f,i,l.encapsulation,d):dV(l,f),x=s?.some(MT)||o?.some(L=>typeof L!="function"&&L.bindings.some(MT)),S=G_(null,c,null,512|aD(l),null,null,h,f,d,null,HC(g,d,!0));S[ut]=g,Rf(S);let R=null;try{let L=zD(ut,S,2,"#host",()=>c.directiveRegistry,!0,0);tD(f,g,L),yl(g,S),Q_(c,S,L),YC(c,L,S),WD(c,L),t!==void 0&&pV(L,this.ngContentSelectors,t),R=Mi(L.index,S),S[en]=R[en],Z_(c,S,null)}catch(L){throw R!==null&&e_(R),e_(S),L}finally{pt(at.DynamicComponentEnd),Nf()}return new op(this.componentType,S,!!x)}finally{Ue(a)}}};function hV(n,e,t,i){let r=n?["ng-version","21.1.1"]:MF(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[c_].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(i)for(let d=0;d<i.length;d++){let h=i[d];if(typeof h!="function")for(let f of h.bindings){a+=f[c_].requiredVars;let g=d+1;f.create&&(f.targetIdx=g,(o??=[]).push(f)),f.update&&(f.targetIdx=g,(s??=[]).push(f))}}let l=[e];if(i)for(let d of i){let h=typeof d=="function"?d:d.type,f=_f(h);l.push(f)}return H_(0,null,fV(o,s),1,a,l,null,null,null,[r],null)}function fV(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function MT(n){let e=n[c_].kind;return e==="input"||e==="twoWay"}var op=class extends jD{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=na(t[Re],ut),this.location=bl(this._tNode,t),this.instance=Mi(this._tNode.index,t)[en],this.hostView=this.changeDetectorRef=new is(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=X_(i,r[Re],r,e,t);this.previousInputValues.set(e,t);let s=Mi(i.index,r);Ip(s,1)}get injector(){return new sa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function pV(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var lo=(()=>{class n{static __NG_ELEMENT_ID__=gV}return n})();function gV(){let n=Un();return eA(n,Be())}var mV=lo,ZD=class extends mV{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return bl(this._hostTNode,this._hostLView)}get injector(){return new sa(this._hostTNode,this._hostLView)}get parentInjector(){let e=T_(this._hostTNode,this._hostLView);if(eC(e)){let t=qf(e,this._hostLView),i=Wf(e),r=t[Re].data[i+8];return new sa(r,t)}else return new sa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=RT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-$t}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=np(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,vl(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let l=e&&!x3(e),c;if(l)c=t;else{let R=t||{};c=R.index,i=R.injector,r=R.projectableNodes,o=R.environmentInjector||R.ngModuleRef,s=R.directives,a=R.bindings}let d=l?e:new _l(io(e)),h=i||this.parentInjector;if(!o&&d.ngModule==null){let L=(l?h:this.parentInjector).get(Yt,null);L&&(o=L)}let f=io(d.componentType??{}),g=np(this._lContainer,f?.id??null),x=g?.firstChild??null,S=d.create(h,r,x,o,s,a);return this.insertImpl(S.hostView,c,vl(this._hostTNode,g)),S}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(VI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Zt],c=new ZD(l,l[Di],l[Zt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return Pu(s,r,o,i),e.attachToViewContainerRef(),Zy(Hv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=RT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=xu(this._lContainer,t);i&&(ou(Hv(this._lContainer),t),wp(i[Re],i))}detach(e){let t=this._adjustIndex(e,-1),i=xu(this._lContainer,t);return i&&ou(Hv(this._lContainer),t)!=null?new is(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function RT(n){return n[cu]}function Hv(n){return n[cu]||(n[cu]=[])}function eA(n,e){let t,i=e[n.index];return fi(i)?t=i:(t=RD(i,e,null,n),e[n.index]=t,$_(e,t)),tA(t,e,n,i),new ZD(t,n,e)}function yV(n,e){let t=n[St],i=t.createComment(""),r=Ai(e,n),o=t.parentNode(r);return Zf(t,o,i,t.nextSibling(r),!1),i}var tA=nA,rE=()=>!1;function vV(n,e,t){return rE(n,e,t)}function nA(n,e,t,i){if(n[Sr])return;let r;t.type&8?r=pi(i):r=yV(e,t),n[Sr]=r}function _V(n,e,t){if(n[Sr]&&n[Yi])return!0;let i=t[Zn],r=e.index-ut;if(!i||hC(e)||WC(i,r))return!1;let s=i_(i,r),a=i.data[pp]?.[r],[l,c]=GL(s,a);return n[Sr]=l,n[Yi]=c,!0}function EV(n,e,t,i){rE(n,t,e)||nA(n,e,t,i)}function iA(){tA=EV,rE=_V}var u_=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},d_=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)oE(e,t).matches!==null&&this.queries[t].setDirty()}},h_=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=DV(e):this.predicate=e}},f_=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},p_=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,bV(t,o)),this.matchTNodeWithReadOption(e,t,Bf(t,e,o,!1,!1))}else i===rs?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Bf(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===ki||r===lo||r===rs&&t.type&4)this.addMatch(t.index,-2);else{let o=Bf(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function bV(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function wV(n,e){return n.type&11?bl(n,e):n.type&4?Tp(n,e):null}function xV(n,e,t,i){return t===-1?wV(e,n):t===-2?SV(n,e,i):Eu(n,n[Re],t,e)}function SV(n,e,t){if(t===ki)return bl(e,n);if(t===rs)return Tp(e,n);if(t===lo)return eA(e,n)}function rA(n,e,t,i){let r=e[xr].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let d=o[c];a.push(xV(e,d,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function g_(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=rA(n,e,r,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)i.push(s[a/2]);else{let c=o[a+1],d=e[-l];for(let h=$t;h<d.length;h++){let f=d[h];f[es]===f[Zt]&&g_(f[Re],f,c,i)}if(d[ea]!==null){let h=d[ea];for(let f=0;f<h.length;f++){let g=h[f];g_(g[Re],g,c,i)}}}}}return i}function IV(n,e){return n[xr].queries[e].queryList}function TV(n,e,t){let i=new Qf((t&4)===4);return jI(n,e,i,i.destroy),(e[xr]??=new d_).queries.push(new u_(i))-1}function CV(n,e,t){let i=tn();return i.firstCreatePass&&(AV(i,new h_(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),TV(i,Be(),e)}function DV(n){return n.split(",").map(e=>e.trim())}function AV(n,e,t){n.queries===null&&(n.queries=new f_),n.queries.track(new p_(e,t))}function oE(n,e){return n.queries.getByIndex(e)}function MV(n,e){let t=n[Re],i=oE(t,e);return i.crossesNgTemplate?g_(t,n,e,[]):rA(t,n,i,e)}var ua=class{},Pp=class{};var sp=class extends ua{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new rp(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=Yy(e);this._bootstrapComponents=oD(o.bootstrap),this._r3Injector=Mv(e,t,[{provide:ua,useValue:this},{provide:ku,useValue:this.componentFactoryResolver},...i],to(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},ap=class extends Pp{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new sp(this.moduleType,e,[])}};var Su=class extends ua{injector;componentFactoryResolver=new rp(this);instance=null;constructor(e){super();let t=new Ks([...e.providers,{provide:ua,useValue:this},{provide:ku,useValue:this.componentFactoryResolver}],e.parent||au(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Tl(n,e,t=null){return new Su({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var RV=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=If(!1,t.type),r=i.length>0?Tl([i],this._injector,""):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=pe({token:n,providedIn:"environment",factory:()=>new n(Ne(Yt))})}return n})();function It(n){return Tu(()=>{let e=oA(n),t=ce(F({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===C_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(RV).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Xi.Emulated,styles:n.styles||qn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&yi("NgStandalone"),sA(t);let i=n.dependencies;return t.directiveDefs=NT(i,NV),t.pipeDefs=NT(i,Qy),t.id=OV(t),t})}function NV(n){return io(n)||_f(n)}function co(n){return Tu(()=>({type:n.type,bootstrap:n.bootstrap||qn,declarations:n.declarations||qn,imports:n.imports||qn,exports:n.exports||qn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function PV(n,e){if(n==null)return Zo;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=Ep.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function kV(n){if(n==null)return Zo;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function vn(n){return Tu(()=>{let e=oA(n);return sA(e),e})}function kp(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function oA(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Zo,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||qn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:PV(n.inputs,e),outputs:kV(n.outputs),debugInfo:null}}function sA(n){n.features?.forEach(e=>e(n))}function NT(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function OV(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function FV(n){return Object.getPrototypeOf(n.prototype).constructor}function Mr(n){let e=FV(n.type),t=!0,i=[n];for(;e;){let r;if(Ir(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new me(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=Gv(n.inputs),s.declaredInputs=Gv(n.declaredInputs),s.outputs=Gv(n.outputs);let a=r.hostBindings;a&&jV(n,a);let l=r.viewQuery,c=r.contentQueries;if(l&&UV(n,l),c&&BV(n,c),LV(n,r),bI(n.outputs,r.outputs),Ir(r)&&r.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Mr&&(t=!1)}}e=Object.getPrototypeOf(e)}VV(i)}function LV(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function VV(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=ml(r.hostAttrs,t=ml(t,r.hostAttrs))}}function Gv(n){return n===Zo?{}:n===qn?[]:n}function UV(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function BV(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function jV(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function aA(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=ml(n.mergedAttrs,n.attrs);let d=n.tView=H_(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),ia(n,!1);let l=lA(t,e,n,i);Pf()&&K_(t,e,l,n),yl(l,e);let c=RD(l,e,l,n);e[i+ut]=c,$_(e,c),vV(c,n,e)}function HV(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,f;return e.firstCreatePass?(f=Il(e,h,4,s||null,a||null),gv()&&GD(e,n,f,Ri(e.consts,c),_D),JT(e,f)):f=e.data[h],aA(f,n,e,t,i,r,o,l),uu(f)&&Q_(e,n,f),c!=null&&Sp(n,f,d),f}function lp(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,f;if(e.firstCreatePass){if(f=Il(e,h,4,s||null,a||null),c!=null){let g=Ri(e.consts,c);f.localNames=[];for(let x=0;x<g.length;x+=2)f.localNames.push(g[x],-1)}}else f=e.data[h];return aA(f,n,e,t,i,r,o,l),c!=null&&Sp(n,f,d),f}function zt(n,e,t,i,r,o,s,a){let l=Be(),c=tn(),d=Ri(c.consts,o);return HV(l,c,n,e,t,i,r,d,void 0,s,a),zt}var lA=cA;function cA(n,e,t,i){return so(!0),e[St].createComment("")}function GV(n,e,t,i){let r=!vp(e,t);so(r);let o=e[Zn]?.data[bC]?.[i]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),r)return cA(n,e);let s=e[Zn],a=Cp(s,n,e,t);yp(s,i,a);let l=F_(s,i);return Dp(l,a)}function uA(){lA=GV}var mi=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(mi||{}),PT=0,$V=1,dn=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(dn||{});var zV=0,Ou=1;var WV=4,qV=5;var KV=7,gl=8,YV=9,sE=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(sE||{});function $f(n,e){let t=JV(n),i=e[t];if(i!==null){for(let r of i)r();e[t]=null}}function QV(n){$f(1,n),$f(0,n),$f(2,n)}function JV(n){let e=WV;return n===1?e=qV:n===2&&(e=YV),e}function dA(n){return n+1}function Cl(n,e){let t=n[Re],i=dA(e.index);return n[i]}function Fu(n,e){let t=dA(e.index);return n.data[t]}function XV(n,e,t){let i=e[Re],r=Fu(i,t);switch(n){case dn.Complete:return r.primaryTmplIndex;case dn.Loading:return r.loadingTmplIndex;case dn.Error:return r.errorTmplIndex;case dn.Placeholder:return r.placeholderTmplIndex;default:return null}}function kT(n,e){return e===dn.Placeholder?n.placeholderBlockConfig?.[PT]??null:e===dn.Loading?n.loadingBlockConfig?.[PT]??null:null}function ZV(n){return n.loadingBlockConfig?.[$V]??null}function OT(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let i of e)t.add(i);return n.length===t.size?n:Array.from(t)}function e5(n,e){let t=e.primaryTmplIndex+ut;return na(n,t)}var t5=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,i,r,o){if(!this.cachedInjectors.has(t)){let s=r.length>0?Tl(r,i,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=pe({token:n,providedIn:"environment",factory:()=>new n})}return n})();var hA=new we("");function $v(n,e,t){return n.get(t5).getOrCreateInjector(e,n,t,"")}function n5(n,e,t){if(n instanceof pl){let r=n.injector,o=n.parentInjector,s=$v(o,e,t);return new pl(r,s)}let i=n.get(Yt);if(i!==n){let r=$v(i,e,t);return new pl(n,r)}return $v(n,e,t)}function oa(n,e,t,i=!1){let r=t[Zt],o=r[Re];if(ts(r))return;let s=Cl(r,e),a=s[Ou],l=s[KV];if(!(l!==null&&n<l)&&FT(a,n)&&FT(s[zV]??-1,n)){let c=Fu(o,e),h=!i&&!0&&(ZV(c)!==null||kT(c,dn.Loading)!==null||kT(c,dn.Placeholder))?o5:r5;try{h(n,s,t,e,r)}catch(f){J_(r,f)}}}function i5(n,e){let t=n[Yi]?.findIndex(r=>r.data[IC]===e[Ou])??-1;return{dehydratedView:t>-1?n[Yi][t]:null,dehydratedViewIx:t}}function r5(n,e,t,i,r){pt(at.DeferBlockStateStart);let o=XV(n,r,i);if(o!==null){e[Ou]=n;let s=r[Re],a=o+ut,l=na(s,a),c=0;eE(t,c);let d;if(n===dn.Complete){let x=Fu(s,i),S=x.providers;S&&S.length>0&&(d=n5(r[ui],x,S))}let{dehydratedView:h,dehydratedViewIx:f}=i5(t,e),g=Nu(r,l,null,{injector:d,dehydratedView:h});if(Pu(t,g,c,vl(l,h)),Ip(g,2),f>-1&&t[Yi]?.splice(f,1),(n===dn.Complete||n===dn.Error)&&Array.isArray(e[gl])){for(let x of e[gl])x();e[gl]=null}}pt(at.DeferBlockStateEnd)}function FT(n,e){return n<e}function LT(n,e,t){n.loadingPromise.then(()=>{n.loadingState===mi.COMPLETE?oa(dn.Complete,e,t):n.loadingState===mi.FAILED&&oa(dn.Error,e,t)})}var o5=null;var Op=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var aE=new we("");function as(n){return!!n&&typeof n.then=="function"}function lE(n){return!!n&&typeof n.subscribe=="function"}var fA=new we("");var cE=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=K(fA,{optional:!0})??[];injector=K(Kn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Fn(this.injector,r);if(as(o))t.push(o);else if(lE(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ls=new we("");function pA(){uy(()=>{let n="";throw new me(600,n)})}function gA(n){return n.isBoundToModule}var s5=10;var ti=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=K(gi);afterRenderManager=K(W_);zonelessEnabled=K(gu);rootEffectScheduler=K(Fv);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new jt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=K(Tr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(yt(t=>!t))}constructor(){K(os,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=K(Yt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Kn.NULL){return this._injector.get(yn).run(()=>{pt(at.BootstrapComponentStart);let s=t instanceof Rp;if(!this._injector.get(cE).done){let x="";throw new me(405,x)}let l;s?l=t:l=this._injector.get(ku).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let c=gA(l)?void 0:this._injector.get(ua),d=i||l.selector,h=l.create(r,[],d,c),f=h.location.nativeElement,g=h.injector.get(aE,null);return g?.registerApplication(f),h.onDestroy(()=>{this.detachView(h.hostView),_u(this.components,h),g?.unregisterApplication(f)}),this._loadComponent(h),pt(at.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){pt(at.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(bp.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw pt(at.ChangeDetectionEnd),new me(101,!1);let t=Ue(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Ue(t),this.afterTick.next(),pt(at.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ca,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<s5;){pt(at.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{pt(at.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!fu(r))continue;let o=i&&!this.zonelessEnabled?0:1;CD(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>fu(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;_u(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(ls,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>_u(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new me(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function _u(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function uE(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}function mA(n,e,t){let i=e[ui],r=e[Re];if(n.loadingState!==mi.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=Cl(e,t),s=e5(r,n);n.loadingState=mi.IN_PROGRESS,$f(1,o);let a=n.dependencyResolverFn,l=i.get(mu).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(c=>{let d=!1,h=[],f=[];for(let g of c)if(g.status==="fulfilled"){let x=g.value,S=io(x)||_f(x);if(S)h.push(S);else{let R=Qy(x);R&&f.push(R)}}else{d=!0;break}if(d){if(n.loadingState=mi.FAILED,n.errorTmplIndex===null){let x=new me(-750,!1);J_(e,x)}}else{n.loadingState=mi.COMPLETE;let g=s.tView;if(h.length>0){g.directiveRegistry=OT(g.directiveRegistry,h);let x=h.map(R=>R.type),S=If(!1,...x);n.providers=S}f.length>0&&(g.pipeRegistry=OT(g.pipeRegistry,f))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,l()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=mi.COMPLETE,l()}),n.loadingPromise)}function a5(n,e){return e[ui].get(hA,null,{optional:!0})?.behavior!==sE.Manual}function l5(n,e,t){let i=e[Re],r=e[t.index];if(!a5(n,e))return;let o=Cl(e,t),s=Fu(i,t);switch(QV(o),s.loadingState){case mi.NOT_STARTED:oa(dn.Loading,t,r),mA(s,e,t),s.loadingState===mi.IN_PROGRESS&&LT(s,t,r);break;case mi.IN_PROGRESS:oa(dn.Loading,t,r),LT(s,t,r);break;case mi.COMPLETE:oa(dn.Complete,t,r);break;case mi.FAILED:oa(dn.Error,t,r);break;default:}}async function yA(n,e,t){let i=n.get(gp);if(i.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=aF(e,n);if(s.length===0)return;o!==null&&s.shift(),d5(i,s),o!==null&&await o;let a=s[0];i.has(a)?await VT(n,s,t):i.awaitParentBlock(a,async()=>await VT(n,s,t))}async function VT(n,e,t){let i=n.get(gp),r=i.hydrating,o=n.get(Tr),s=o.add();for(let l=0;l<e.length;l++){let c=e[l],d=i.get(c);if(d!=null){if(await f5(d),await h5(n),c5(d)){jL(d),UT(e.slice(l),i);break}r.get(c).resolve()}else{u5(l,e,i),UT(e.slice(l),i);break}}let a=e[e.length-1];await r.get(a)?.promise,o.remove(s),t&&t(e),HL(i.get(a),e,i,n.get(ti))}function c5(n){return Cl(n.lView,n.tNode)[Ou]===dn.Error}function u5(n,e,t){let i=n-1,r=i>-1?t.get(e[i]):null;r&&Mp(r.lContainer)}function UT(n,e){let t=e.hydrating;for(let i in n)t.get(i)?.reject();e.cleanup(n)}function d5(n,e){for(let t of e)n.hydrating.set(t,uE())}function h5(n){return new Promise(e=>Ru(e,{injector:n}))}async function f5(n){let{tNode:e,lView:t}=n,i=Cl(t,e);return new Promise(r=>{p5(i,r),l5(2,t,e)})}function p5(n,e){Array.isArray(n[gl])||(n[gl]=[]),n[gl].push(e)}function Ut(n,e,t,i){let r=Be(),o=ra();if(Pi(r,o,e)){let s=tn(),a=Dv();cL(a,r,n,e,t,i)}return Ut}var Yte=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var m_=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function zv(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function g5(n,e,t,i){let r,o,s=0,a=n.length-1,l=void 0;if(Array.isArray(e)){Ue(i);let c=e.length-1;for(Ue(null);s<=a&&s<=c;){let d=n.at(s),h=e[s],f=zv(s,d,s,h,t);if(f!==0){f<0&&n.updateValue(s,h),s++;continue}let g=n.at(a),x=e[c],S=zv(a,g,c,x,t);if(S!==0){S<0&&n.updateValue(a,x),a--,c--;continue}let R=t(s,d),L=t(a,g),q=t(s,h);if(Object.is(q,L)){let ye=t(c,x);Object.is(ye,R)?(n.swap(s,a),n.updateValue(a,x),c--,a--):n.move(a,s),n.updateValue(s,h),s++;continue}if(r??=new cp,o??=jT(n,s,a,t),y_(n,r,s,q))n.updateValue(s,h),s++,a++;else if(o.has(q))r.set(R,n.detach(s)),a--;else{let ye=n.create(s,e[s]);n.attach(s,ye),s++,a++}}for(;s<=c;)BT(n,r,t,s,e[s]),s++}else if(e!=null){Ue(i);let c=e[Symbol.iterator]();Ue(null);let d=c.next();for(;!d.done&&s<=a;){let h=n.at(s),f=d.value,g=zv(s,h,s,f,t);if(g!==0)g<0&&n.updateValue(s,f),s++,d=c.next();else{r??=new cp,o??=jT(n,s,a,t);let x=t(s,f);if(y_(n,r,s,x))n.updateValue(s,f),s++,a++,d=c.next();else if(!o.has(x))n.attach(s,n.create(s,f)),s++,a++,d=c.next();else{let S=t(s,h);r.set(S,n.detach(s)),a--}}}for(;!d.done;)BT(n,r,t,n.length,d.value),d=c.next()}for(;s<=a;)n.destroy(n.detach(a--));r?.forEach(c=>{n.destroy(c)})}function y_(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function BT(n,e,t,i,r){if(y_(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function jT(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var cp=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function Q(n,e,t,i,r,o,s,a){yi("NgControlFlow");let l=Be(),c=tn(),d=Ri(c.consts,o);return lp(l,c,n,e,t,i,r,d,256,s,a),dE}function dE(n,e,t,i,r,o,s,a){yi("NgControlFlow");let l=Be(),c=tn(),d=Ri(c.consts,o);return lp(l,c,n,e,t,i,r,d,512,s,a),dE}function J(n,e){yi("NgControlFlow");let t=Be(),i=ra(),r=t[i]!==xn?t[i]:-1,o=r!==-1?up(t,ut+r):void 0,s=0;if(Pi(t,i,n)){let a=Ue(null);try{if(o!==void 0&&eE(o,s),n!==-1){let l=ut+n,c=up(t,l),d=b_(t[Re],l),h=UD(c,d,t),f=Nu(t,d,e,{dehydratedView:h});Pu(c,f,s,vl(d,h))}}finally{Ue(a)}}else if(o!==void 0){let a=ND(o,s);a!==void 0&&(a[en]=e)}}var v_=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-$t}};function Lu(n){return n}function Rr(n,e){return e}var __=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function Sn(n,e,t,i,r,o,s,a,l,c,d,h,f){yi("NgControlFlow");let g=Be(),x=tn(),S=l!==void 0,R=Be(),L=a?s.bind(R[Qn][en]):s,q=new __(S,L);R[ut+n]=q,lp(g,x,n+1,e,t,i,r,Ri(x.consts,o),256),S&&lp(g,x,n+2,l,c,d,h,Ri(x.consts,f),512)}var E_=class extends m_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-$t}at(e){return this.getLView(e)[en].$implicit}attach(e,t){let i=t[Zn];this.needsIndexUpdate||=e!==this.length,Pu(this.lContainer,t,e,vl(this.templateTNode,i)),m5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,y5(this.lContainer,e),v5(this.lContainer,e)}create(e,t){let i=np(this.lContainer,this.templateTNode.tView.ssrId);return Nu(this.hostLView,this.templateTNode,new v_(this.lContainer,t,e),{dehydratedView:i})}destroy(e){wp(e[Re],e)}updateValue(e,t){this.getLView(e)[en].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[en].$index=e}getLView(e){return _5(this.lContainer,e)}};function In(n){let e=Ue(null),t=Ni();try{let i=Be(),r=i[Re],o=i[t],s=t+1,a=up(i,s);if(o.liveCollection===void 0){let c=b_(r,s);o.liveCollection=new E_(a,i,c)}else o.liveCollection.reset();let l=o.liveCollection;if(g5(l,n,o.trackByFn,e),l.updateIndexes(),o.hasEmptyBlock){let c=ra(),d=l.length===0;if(Pi(i,c,d)){let h=t+2,f=up(i,h);if(d){let g=b_(r,h),x=UD(f,g,i),S=Nu(i,g,void 0,{dehydratedView:x});Pu(f,S,0,vl(g,x))}else r.firstUpdatePass&&Ap(f),eE(f,0)}}}finally{Ue(e)}}function up(n,e){return n[e]}function m5(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t],r=i?i[Zs]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[ui];LF(o,r),la.delete(i[ro]),r.detachedLeaveAnimationFns=void 0}}function y5(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t],r=i?i[Zs]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function v5(n,e){return xu(n,e)}function _5(n,e){return ND(n,e)}function b_(n,e){return na(n,e)}function Ce(n,e,t){let i=Be(),r=ra();if(Pi(i,r,e)){let o=tn(),s=Dv();iL(s,i,n,e,i[St],t)}return Ce}function w_(n,e,t,i,r){X_(e,n,t,r?"class":"style",i)}function v(n,e,t,i){let r=Be(),o=r[Re],s=n+ut,a=o.firstCreatePass?zD(s,r,2,e,_D,gv(),t,i):o.data[s];if(ED(a,r,n,e,hE),uu(a)){let l=r[Re];Q_(l,r,a),YC(l,a,r)}return i!=null&&Sp(r,a),v}function _(){let n=tn(),e=Un(),t=bD(e);return n.firstCreatePass&&WD(n,t),yv(t)&&vv(),pv(),t.classesWithoutHost!=null&&A3(t)&&w_(n,t,Be(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&M3(t)&&w_(n,t,Be(),t.stylesWithoutHost,!1),_}function W(n,e,t,i){return v(n,e,t,i),_(),W}function D(n,e,t,i){let r=Be(),o=r[Re],s=n+ut,a=o.firstCreatePass?iV(s,o,2,e,t,i):o.data[s];return ED(a,r,n,e,hE),i!=null&&Sp(r,a),D}function A(){let n=Un(),e=bD(n);return yv(e)&&vv(),pv(),A}function G(n,e,t,i){return D(n,e,t,i),A(),G}var hE=(n,e,t,i,r)=>(so(!0),V_(e[St],i,Av()));function E5(n,e,t,i,r){let o=!vp(e,t);if(so(o),o)return V_(e[St],i,Av());let s=e[Zn],a=Cp(s,n,e,t);return zC(s,r)&&yp(s,r,a.nextSibling),s&&(uC(t)||dC(a))&&oo(t)&&($I(t),eD(a)),a}function vA(){hE=E5}var b5=(n,e,t,i,r)=>(so(!0),XC(e[St],""));function w5(n,e,t,i,r){let o,s=!vp(e,t);if(so(s),s)return XC(e[St],"");let a=e[Zn],l=Cp(a,n,e,t),c=oF(a,r);return yp(a,r,l),o=Dp(c,l),o}function _A(){b5=w5}function $e(){return Be()}var yu=void 0;function x5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var S5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],yu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],yu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",yu,yu,yu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",x5],Wv={};function vi(n){let e=I5(n),t=HT(e);if(t)return t;let i=e.split("-")[0];if(t=HT(i),t)return t;if(i==="en")return S5;throw new me(701,!1)}function HT(n){return n in Wv||(Wv[n]=vr.ng&&vr.ng.common&&vr.ng.common.locales&&vr.ng.common.locales[n]),Wv[n]}var nn=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(nn||{});function I5(n){return n.toLowerCase().replace(/_/g,"-")}var Vu="en-US";var T5=Vu;function EA(n){typeof n=="string"&&(T5=n.toLowerCase().replace(/_/g,"-"))}function X(n,e,t){let i=Be(),r=tn(),o=Un();return C5(r,i,i[St],o,n,e,t),X}function Ht(n,e,t){let i=Be(),r=tn(),o=Un();return(o.type&3||t)&&QD(o,r,i,t,i[St],n,e,Gf(o,i,e)),Ht}function C5(n,e,t,i,r,o,s){let a=!0,l=null;if((i.type&3||s)&&(l??=Gf(i,e,o),QD(i,n,e,s,t,r,o,l)&&(a=!1)),a){let c=i.outputs?.[r],d=i.hostDirectiveOutputs?.[r];if(d&&d.length)for(let h=0;h<d.length;h+=2){let f=d[h],g=d[h+1];l??=Gf(i,e,o),AT(i,e,f,g,r,l)}if(c&&c.length)for(let h of c)l??=Gf(i,e,o),AT(i,e,h,r,r,l)}}function P(n=1){return tT(n)}function Dl(n,e,t){return CV(n,e,t),Dl}function Al(n){let e=Be(),t=tn(),i=Iv();Mf(i+1);let r=oE(t,i);if(n.dirty&&LI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=MV(e,i);n.reset(o,G3),n.notifyOnChanges()}return!0}return!1}function Ml(){return IV(Be(),Iv())}function tr(n){let e=bv();return du(e,ut+n)}function Lf(n,e){return n<<17|e<<2}function da(n){return n>>17&32767}function D5(n){return(n&2)==2}function A5(n,e){return n&131071|e<<17}function x_(n){return n|2}function El(n){return(n&131068)>>2}function qv(n,e){return n&-131069|e<<2}function M5(n){return(n&1)===1}function S_(n){return n|1}function R5(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=da(s),l=El(s);n[i]=t;let c=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||al(h,d)>0)&&(c=!0)}else d=t;if(r)if(l!==0){let f=da(n[a+1]);n[i+1]=Lf(f,a),f!==0&&(n[f+1]=qv(n[f+1],i)),n[a+1]=A5(n[a+1],i)}else n[i+1]=Lf(a,0),a!==0&&(n[a+1]=qv(n[a+1],i)),a=i;else n[i+1]=Lf(l,0),a===0?a=i:n[l+1]=qv(n[l+1],i),l=i;c&&(n[i+1]=x_(n[i+1])),GT(n,d,i,!0),GT(n,d,i,!1),N5(e,d,n,i,o),s=Lf(a,l),o?e.classBindings=s:e.styleBindings=s}function N5(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&al(o,e)>=0&&(t[i+1]=S_(t[i+1]))}function GT(n,e,t,i){let r=n[t+1],o=e===null,s=i?da(r):El(r),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];P5(l,e)&&(a=!0,n[s+1]=i?S_(c):x_(c)),s=i?da(c):El(c)}a&&(n[t+1]=i?x_(r):S_(r))}function P5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?al(n,e)>=0:!1}var Ji={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function k5(n){return n.substring(Ji.key,Ji.keyEnd)}function O5(n){return F5(n),bA(n,wA(n,0,Ji.textEnd))}function bA(n,e){let t=Ji.textEnd;return t===e?-1:(e=Ji.keyEnd=L5(n,Ji.key=e,t),wA(n,e,t))}function F5(n){Ji.key=0,Ji.keyEnd=0,Ji.value=0,Ji.valueEnd=0,Ji.textEnd=n.length}function wA(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function L5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function et(n,e,t){return xA(n,e,t,!1),et}function Ae(n,e){return xA(n,e,null,!0),Ae}function fE(n){U5(z5,V5,n,!0)}function V5(n,e){for(let t=O5(e);t>=0;t=bA(e,t))xf(n,k5(e),!0)}function xA(n,e,t,i){let r=Be(),o=tn(),s=pu(2);if(o.firstUpdatePass&&IA(o,n,s,i),e!==xn&&Pi(r,s,e)){let a=o.data[Ni()];TA(o,a,r,r[St],n,r[s+1]=q5(e,t),i,s)}}function U5(n,e,t,i){let r=tn(),o=pu(2);r.firstUpdatePass&&IA(r,null,o,i);let s=Be();if(t!==xn&&Pi(s,o,t)){let a=r.data[Ni()];if(CA(a,i)&&!SA(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=yf(l,t||"")),w_(r,a,s,t,i)}else W5(r,a,s,s[St],s[o+1],s[o+1]=$5(n,e,t),i,o)}}function SA(n,e){return e>=n.expandoStartIndex}function IA(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Ni()],s=SA(n,t);CA(o,i)&&e===null&&!s&&(e=!1),e=B5(r,o,e,i),R5(r,o,e,t,s,i)}}function B5(n,e,t,i){let r=JI(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Kv(null,n,e,t,i),t=Iu(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Kv(r,n,e,t,i),o===null){let l=j5(n,e,i);l!==void 0&&Array.isArray(l)&&(l=Kv(null,n,e,l[1],i),l=Iu(l,e.attrs,i),H5(n,e,i,l))}else o=G5(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function j5(n,e,t){let i=t?e.classBindings:e.styleBindings;if(El(i)!==0)return n[da(i)]}function H5(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[da(r)]=i}function G5(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=Iu(i,s,t)}return Iu(i,e.attrs,t)}function Kv(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=Iu(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function Iu(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),xf(n,s,t?!0:e[++o]))}return n===void 0?null:n}function $5(n,e,t){if(t==null||t==="")return qn;let i=[],r=Sl(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(r instanceof Set)for(let o of r)n(i,o,!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function z5(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&xf(n,i,t)}function W5(n,e,t,i,r,o,s,a){r===xn&&(r=qn);let l=0,c=0,d=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;d!==null||h!==null;){let f=l<r.length?r[l+1]:void 0,g=c<o.length?o[c+1]:void 0,x=null,S;d===h?(l+=2,c+=2,f!==g&&(x=h,S=g)):h===null||d!==null&&d<h?(l+=2,x=d):(c+=2,x=h,S=g),x!==null&&TA(n,e,t,i,x,S,s,a),d=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}function TA(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],d=M5(c)?$T(l,e,t,r,El(c),s):void 0;if(!dp(d)){dp(o)||D5(c)&&(o=$T(l,null,t,r,a,s));let h=lv(Ni(),t);XF(i,s,h,r,o)}}function $T(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let l=n[r],c=Array.isArray(l),d=c?l[1]:l,h=d===null,f=t[r+1];f===xn&&(f=h?qn:void 0);let g=h?Sf(f,i):d===i?f:void 0;if(c&&!dp(g)&&(g=Sf(l,i)),dp(g)&&(a=g,s))return a;let x=n[r+1];r=s?da(x):El(x)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=Sf(l,i))}return a}function dp(n){return n!==void 0}function q5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=to(Sl(n)))),n}function CA(n,e){return(n.flags&(e?8:16))!==0}function y(n,e=""){let t=Be(),i=tn(),r=n+ut,o=i.firstCreatePass?Il(i,r,1,e,null):i.data[r],s=DA(i,t,o,e,n);t[r]=s,Pf()&&K_(i,t,s,o),ia(o,!1)}var DA=(n,e,t,i,r)=>(so(!0),JC(e[St],i));function K5(n,e,t,i,r){let o=!vp(e,t);if(so(o),o)return JC(e[St],i);let s=e[Zn];return Cp(s,n,e,t)}function AA(){DA=K5}function Y5(n,e,t,i=""){return Pi(n,ra(),t)?e+Ki(t)+i:xn}function Q5(n,e,t,i,r,o=""){let s=Sv(),a=iE(n,s,t,r);return pu(2),a?e+Ki(t)+i+Ki(r)+o:xn}function J5(n,e,t,i,r,o,s,a=""){let l=Sv(),c=YD(n,l,t,r,s);return pu(3),c?e+Ki(t)+i+Ki(r)+o+Ki(s)+a:xn}function j(n){return V("",n),j}function V(n,e,t){let i=Be(),r=Y5(i,n,e,t);return r!==xn&&pE(i,Ni(),r),V}function Mt(n,e,t,i,r){let o=Be(),s=Q5(o,n,e,t,i,r);return s!==xn&&pE(o,Ni(),s),Mt}function cs(n,e,t,i,r,o,s){let a=Be(),l=J5(a,n,e,t,i,r,o,s);return l!==xn&&pE(a,Ni(),l),cs}function pE(n,e,t){let i=lv(e,n);pF(n[St],i,t)}var MA={};function Rl(n){yi("NgLet");let e=tn(),t=Be(),i=n+ut,r=Il(e,i,128,null,null);return ia(r,!1),hu(e,t,i,MA),Rl}function Uu(n){let e=tn(),t=Be(),i=Ni();return hu(e,t,i,n),n}function Nr(n){let e=bv(),t=du(e,ut+n);if(t===MA)throw new me(314,!1);return t}function gE(n){return Pi(Be(),ra(),n)?Ki(n):xn}function zT(n,e,t){let i=tn();i.firstCreatePass&&RA(e,i.data,i.blueprint,Ir(n),t)}function RA(n,e,t,i,r){if(n=On(n),Array.isArray(n))for(let o=0;o<n.length;o++)RA(n[o],e,t,i,r);else{let o=tn(),s=Be(),a=Un(),l=qs(n)?n:On(n.provide),c=iv(n),d=a.providerIndexes&1048575,h=a.directiveStart,f=a.providerIndexes>>20;if(qs(n)||!n.multi){let g=new aa(c,r,he,null),x=Qv(l,e,r?d:d+f,h);x===-1?(Xv(Yf(a,s),o,l),Yv(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)):(t[x]=g,s[x]=g)}else{let g=Qv(l,e,d+f,h),x=Qv(l,e,d,d+f),S=g>=0&&t[g],R=x>=0&&t[x];if(r&&!R||!r&&!S){Xv(Yf(a,s),o,l);let L=e6(r?Z5:X5,t.length,r,i,c,n);!r&&R&&(t[x].providerFactory=L),Yv(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(L),s.push(L)}else{let L=NA(t[r?x:g],c,!r&&i);Yv(o,n,g>-1?g:x,L)}!r&&i&&R&&t[x].componentProviders++}}}function Yv(n,e,t,i){let r=qs(e),o=PI(e);if(r||o){let l=(o?On(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function NA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Qv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function X5(n,e,t,i,r){return I_(this.multi,[])}function Z5(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=Eu(i,i[Re],this.providerFactory.index,r);s=l.slice(0,a),I_(o,s);for(let c=a;c<l.length;c++)s.push(l[c])}else s=[],I_(o,s);return s}function I_(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function e6(n,e,t,i,r,o){let s=new aa(n,t,he,null);return s.multi=[],s.index=e,s.componentProviders=0,NA(s,r,i&&!t),s}function Bu(n,e){return t=>{t.providersResolver=(i,r)=>zT(i,r?r(n):n,!1),e&&(t.viewProvidersResolver=(i,r)=>zT(i,r?r(e):e,!0))}}function pa(n,e){let t=dl()+n,i=Be();return i[t]===xn?Np(i,t,e()):rV(i,t)}function _t(n,e,t,i){return PA(Be(),dl(),n,e,t,i)}function mE(n,e,t,i,r){return n6(Be(),dl(),n,e,t,i,r)}function yE(n,e){let t=n[e];return t===xn?void 0:t}function t6(n,e,t,i,r,o){let s=e+t;return Pi(n,s,r)?Np(n,s+1,o?i.call(o,r):i(r)):yE(n,s+1)}function PA(n,e,t,i,r,o,s){let a=e+t;return iE(n,a,r,o)?Np(n,a+2,s?i.call(s,r,o):i(r,o)):yE(n,a+2)}function n6(n,e,t,i,r,o,s,a){let l=e+t;return YD(n,l,r,o,s)?Np(n,l+3,a?i.call(a,r,o,s):i(r,o,s)):yE(n,l+3)}function Oi(n,e){let t=tn(),i,r=n+ut;t.firstCreatePass?(i=i6(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Yo(i.type,!0)),s,a=Wn(he);try{let l=Kf(!1),c=o();return Kf(l),hu(t,Be(),r,c),c}finally{Wn(a)}}function i6(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function vE(n,e,t){let i=n+ut,r=Be(),o=du(r,i);return kA(r,i)?t6(r,dl(),e,o.transform,t,o):o.transform(t)}function nr(n,e,t,i){let r=n+ut,o=Be(),s=du(o,r);return kA(o,r)?PA(o,dl(),e,s.transform,t,i,s):s.transform(t,i)}function kA(n,e){return n[Re].data[e].pure}function uo(n,e){return Tp(n,e)}var hp=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},_E=(()=>{class n{compileModuleSync(t){return new ap(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=Yy(t),o=oD(r.declarations).reduce((s,a)=>{let l=io(a);return l&&s.push(new _l(l)),s},[]);return new hp(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var OA=(()=>{class n{applicationErrorHandler=K(gi);appRef=K(ti);taskService=K(Tr);ngZone=K(yn);zonelessEnabled=K(gu);tracing=K(os,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new mn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(nu):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(K(Ov,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?oT:Rv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(nu+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.applicationErrorHandler(i)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function FA(){return[{provide:Jo,useExisting:OA},{provide:yn,useClass:iu},{provide:gu,useValue:!0}]}function r6(){return typeof $localize<"u"&&$localize.locale||Vu}var ju=new we("",{factory:()=>K(ju,{optional:!0,skipSelf:!0})||r6()});function ni(n,e){return Oh(n,e?.equal)}var SE={JSACTION:"__jsaction",OWNER:"__owner"},BA={};function o6(n){return n[SE.JSACTION]}function LA(n,e){n[SE.JSACTION]=e}function s6(n){return BA[n]}function a6(n,e){BA[n]=e}var Fe={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},l6=[Fe.MOUSEENTER,Fe.MOUSELEAVE,"pointerenter","pointerleave"],tne=[Fe.CLICK,Fe.DBLCLICK,Fe.FOCUSIN,Fe.FOCUSOUT,Fe.KEYDOWN,Fe.KEYUP,Fe.KEYPRESS,Fe.MOUSEOVER,Fe.MOUSEOUT,Fe.SUBMIT,Fe.TOUCHSTART,Fe.TOUCHEND,Fe.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],c6=[Fe.FOCUS,Fe.BLUR,Fe.ERROR,Fe.LOAD,Fe.TOGGLE],IE=n=>c6.indexOf(n)>=0;function u6(n){return n===Fe.MOUSEENTER?Fe.MOUSEOVER:n===Fe.MOUSELEAVE?Fe.MOUSEOUT:n===Fe.POINTERENTER?Fe.POINTEROVER:n===Fe.POINTERLEAVE?Fe.POINTEROUT:n}function d6(n,e,t,i){let r=!1;IE(e)&&(r=!0);let o=typeof i=="boolean"?{capture:r,passive:i}:r;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:r,passive:i}}function h6(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function f6(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var VA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function p6(n){return n.which===2||n.which==null&&n.button===4}function g6(n){return VA&&n.metaKey||!VA&&n.ctrlKey||p6(n)||n.shiftKey}function m6(n,e,t){let i=n.relatedTarget;return(n.type===Fe.MOUSEOVER&&e===Fe.MOUSEENTER||n.type===Fe.MOUSEOUT&&e===Fe.MOUSELEAVE||n.type===Fe.POINTEROVER&&e===Fe.POINTERENTER||n.type===Fe.POINTEROUT&&e===Fe.POINTERLEAVE)&&(!i||i!==t&&!t.contains(i))}function y6(n,e){let t={};for(let i in n){if(i==="srcElement"||i==="target")continue;let r=i,o=n[r];typeof o!="function"&&(t[r]=o)}return n.type===Fe.MOUSEOVER?t.type=Fe.MOUSEENTER:n.type===Fe.MOUSEOUT?t.type=Fe.MOUSELEAVE:n.type===Fe.POINTEROVER?t.type=Fe.POINTERENTER:t.type=Fe.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var v6=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),Up=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,i){v6&&(this.element.style.cursor="pointer"),this.handlerInfos.push(d6(this.element,e,t(this.element),i))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)h6(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},_6={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function us(n){return n.eventType}function TE(n,e){n.eventType=e}function Lp(n){return n.event}function jA(n,e){n.event=e}function HA(n){return n.targetElement}function GA(n,e){n.targetElement=e}function $A(n){return n.eic}function E6(n,e){n.eic=e}function b6(n){return n.timeStamp}function w6(n,e){n.timeStamp=e}function Vp(n){return n.eia}function zA(n,e,t){n.eia=[e,t]}function EE(n){n.eia=void 0}function Fp(n){return n[1]}function x6(n){return n.eirp}function WA(n,e){n.eirp=e}function qA(n){return n.eir}function KA(n,e){n.eir=e}function YA(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function S6(n,e,t,i,r,o,s,a){return{eventType:n,event:e,targetElement:t,eic:i,timeStamp:r,eia:o,eirp:s,eiack:a}}var bE=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return us(this.eventInfo)}setEventType(e){TE(this.eventInfo,e)}getEvent(){return Lp(this.eventInfo)}setEvent(e){jA(this.eventInfo,e)}getTargetElement(){return HA(this.eventInfo)}setTargetElement(e){GA(this.eventInfo,e)}getContainer(){return $A(this.eventInfo)}setContainer(e){E6(this.eventInfo,e)}getTimestamp(){return b6(this.eventInfo)}setTimestamp(e){w6(this.eventInfo,e)}getAction(){let e=Vp(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){EE(this.eventInfo);return}zA(this.eventInfo,e.name,e.element)}getIsReplay(){return x6(this.eventInfo)}setIsReplay(e){WA(this.eventInfo,e)}getResolved(){return qA(this.eventInfo)}setResolved(e){KA(this.eventInfo,e)}clone(){return new n(YA(this.eventInfo))}},I6={},T6=/\s*;\s*/,C6=Fe.CLICK,wE=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&us(e)===Fe.CLICK&&g6(Lp(e))?TE(e,Fe.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){qA(e)||(this.populateAction(e,HA(e)),KA(e,!0))}resolveParentAction(e){let t=Vp(e),i=t&&Fp(t);EE(e);let r=i&&this.getParentNode(i);r&&this.populateAction(e,r)}populateAction(e,t){let i=t;for(;i&&i!==$A(e)&&(i.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(i,e),!Vp(e));)i=this.getParentNode(i);let r=Vp(e);if(r&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(us(e)===Fe.MOUSEENTER||us(e)===Fe.MOUSELEAVE||us(e)===Fe.POINTERENTER||us(e)===Fe.POINTERLEAVE)))if(m6(Lp(e),us(e),Fp(r))){let o=y6(Lp(e),Fp(r));jA(e,o),GA(e,Fp(r))}else EE(e)}getParentNode(e){let t=e[SE.OWNER];if(t)return t;let i=e.parentNode;return i?.nodeName==="#document-fragment"?i?.host??null:i}populateActionOnElement(e,t){let i=this.parseActions(e),r=i[us(t)];r!==void 0&&zA(t,r,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,i)}parseActions(e){let t=o6(e);if(!t){let i=e.getAttribute(Of.JSACTION);if(!i)t=I6,LA(e,t);else{if(t=s6(i),!t){t={};let r=i.split(T6);for(let o=0;o<r.length;o++){let s=r[o];if(!s)continue;let a=s.indexOf(_6.EVENT_ACTION_SEPARATOR),l=a!==-1,c=l?s.substr(0,a).trim():C6,d=l?s.substr(a+1).trim():s;t[c]=d}a6(i,t)}LA(e,t)}}return t}addA11yClickSupport(e,t,i){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=i}},QA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(QA||{}),xE=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:i}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=i}dispatch(e){let t=new bE(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let i=t.getAction();if(i&&D6(i.element,t)&&f6(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function D6(n,e){return n.tagName==="A"&&(e.getEventType()===Fe.CLICK||e.getEventType()===Fe.CLICKMOD)}var JA=Symbol.for("propagationStopped"),CE={REPLAY:101};var A6="`preventDefault` called during event replay.";var M6="`composedPath` called during event replay.",Bp=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new wE({clickModSupport:t}),this.dispatcher=new xE(i=>{this.dispatchToDelegate(i)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&P6(e),R6(e);e.getAction();){if(k6(e),IE(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),N6(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function R6(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),i=()=>{e[JA]=!0,t()};ga(e,"stopPropagation",i),ga(e,"stopImmediatePropagation",i)}function N6(n){return!!n.getEvent()[JA]}function P6(n){let e=n.getEvent(),t=n.getTargetElement(),i=e.preventDefault.bind(e);ga(e,"target",t),ga(e,"eventPhase",CE.REPLAY),ga(e,"preventDefault",()=>{throw i(),new Error(A6+"")}),ga(e,"composedPath",()=>{throw new Error(M6+"")})}function k6(n){let e=n.getEvent(),t=n.getAction()?.element;t&&ga(e,"currentTarget",t,{configurable:!0})}function ga(n,e,t,{configurable:i=!1}={}){Object.defineProperty(n,e,{value:t,configurable:i})}function XA(n,e){n.ecrd(t=>{e.dispatch(t)},QA.I_AM_THE_JSACTION_FRAMEWORK)}function O6(n){return n?.q??[]}function F6(n){n&&(UA(n.c,n.et,n.h),UA(n.c,n.etc,n.h,!0))}function UA(n,e,t,i){for(let r=0;r<e.length;r++)n.removeEventListener(e[r],t,i)}var L6=!1,ZA=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=L6;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,i,r){let o=S6(t,i,i.target,r,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){WA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,i,r){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&l6.indexOf(t)>=0)return;let o=(a,l,c)=>{this.handleEvent(a,l,c)};this.eventHandlers[t]=o;let s=u6(i||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>l=>{o(t,l,a)},r)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),F6(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let i=0;i<t.length;i++){let r=t[i],o=this.getEventTypesForBrowserEventType(r.eventType);for(let s=0;s<o.length;s++){let a=YA(r);TE(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let i=[];return this.eventHandlers[t]&&i.push(t),this.browserEventTypeToExtraEventTypes[t]&&i.push(...this.browserEventTypeToExtraEventTypes[t]),i}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,i){this.ecrd(t,i)}ecrd(t,i){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let r=0;r<this.queuedEventInfos.length;r++)this.handleEventInfo(this.queuedEventInfos[r]);this.queuedEventInfos=null}}}return n})();function eM(n,e=window){return O6(e._ejsas?.[n])}function DE(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var uM=Symbol("InputSignalNode#UNSET"),dU=ce(F({},Fh),{transformFn:void 0,applyValueToInputSignal(n,e){Wc(n,e)}});function dM(n,e){let t=Object.create(dU);t.value=n,t.transformFn=e?.transform;function i(){if(Gc(t),t.value===uM){let r=null;throw new me(-950,r)}return t.value}return i[Jn]=t,i}var Gp=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Cu(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function tM(n,e){return dM(n,e)}function hU(n){return dM(uM,n)}var hM=(tM.required=hU,tM);var AE=new we(""),fU=new we("");function Hu(n){return!n.moduleRef}function pU(n){let e=Hu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(yn);return t.run(()=>{Hu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(gi),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Hu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(AE);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(AE);s.add(o),n.moduleRef.onDestroy(()=>{_u(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return mU(i,t,()=>{let o=e.get(Tr),s=o.add(),a=e.get(cE);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(ju,Vu);if(EA(l||Vu),!e.get(fU,!0))return Hu(n)?e.get(ti):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Hu(n)){let d=e.get(ti);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return gU?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var gU;function mU(n,e,t){try{let i=t();return as(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Hp=null;function yU(n=[],e){return Kn.create({name:e,providers:[{provide:su,useValue:"platform"},{provide:AE,useValue:new Set([()=>Hp=null])},...n]})}function vU(n=[]){if(Hp)return Hp;let e=yU(n);return Hp=e,pA(),_U(e),e}function _U(n){let e=n.get(fp,null);Fn(n,()=>{e?.forEach(t=>t())})}function fM(){return!1}var jp=new WeakSet,nM="";function iM(n){return n.get(N_,DC)}function pM(){let n=[{provide:N_,useFactory:()=>{let e=!0;{let t=K(Ar);e=!!window._ejsas?.[t]}return e&&yi("NgEventReplay"),e}}];return n.push({provide:Er,useValue:()=>{let e=K(ti),{injector:t}=e;if(!jp.has(e)){let i=K(P_);if(iM(t)){LC();let r=t.get(Ar),o=OC(r,(s,a,l)=>{s.nodeType===Node.ELEMENT_NODE&&(RC(s,a,l),NC(s,i))});e.onDestroy(o)}}},multi:!0},{provide:ls,useFactory:()=>{let e=K(ti),{injector:t}=e;return()=>{if(!iM(t)||jp.has(e))return;jp.add(e);let i=t.get(Ar);e.onDestroy(()=>{jp.delete(e),DE(i)}),e.whenStable().then(()=>{if(e.destroyed)return;let r=t.get(kC);EU(r,t);let o=t.get(P_);o.get(nM)?.forEach(PC),o.delete(nM);let s=r.instance;$C(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var EU=(n,e)=>{let t=e.get(Ar),i=window._ejsas[t],r=n.instance=new ZA(new Up(i.c));for(let a of i.et)r.addEvent(a);for(let a of i.etc)r.addEvent(a);let o=eM(t);r.replayEarlyEventInfos(o),DE(t);let s=new Bp(a=>{bU(e,a,a.currentTarget)});XA(r,s)};function bU(n,e,t){let i=(t&&t.getAttribute(Au))??"";/d\d+/.test(i)?wU(i,n,e,t):e.eventPhase===CE.REPLAY&&k_(e,t)}function wU(n,e,t,i){let r=e.get(AC);r.push({event:t,currentTarget:i}),yA(e,n,xU(r))}function xU(n){return e=>{let t=new Set(e),i=[];for(let{event:r,currentTarget:o}of n){let s=o.getAttribute(Au);t.has(s)?k_(r,o):i.push({event:r,currentTarget:o})}n.length=0,n.push(...i)}}var rM=!1;var SU=1e4;function IU(){rM||(rM=!0,jC(),vA(),AA(),_A(),uA(),iA(),VD(),vD())}function TU(n){return n.whenStable()}function gM(){let n=[{provide:Du,useFactory:()=>{let e=!0;return e=!!K(xl,{optional:!0})?.get(O_,null),e&&yi("NgHydration"),e}},{provide:Er,useValue:()=>{kD(!1);let e=K(Qt);K(Du)&&(qC(e),IU())},multi:!0}];return n.push({provide:R_,useFactory:()=>K(Du)},{provide:ls,useFactory:()=>{if(K(Du)){let e=K(ti);return()=>{TU(e).then(()=>{e.destroyed||tE(e)})}}return()=>{}},multi:!0}),br(n)}var Vse=SU-1e3;var ma=(()=>{class n{static __NG_ELEMENT_ID__=CU}return n})();function CU(n){return DU(Un(),Be(),(n&16)===16)}function DU(n,e,t){if(oo(n)&&!t){let i=Mi(n.index,e);return new is(i,i)}else if(n.type&175){let i=e[Qn];return new is(i,e)}return null}var ME=class{constructor(){}supports(e){return nE(e)}create(e){return new RE(e)}},AU=(n,e)=>e,RE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||AU}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<oM(i,r,o)?t:i,a=oM(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let c=a-r,d=l-r;if(c!=d){for(let f=0;f<c;f++){let g=f<o.length?o[f]:o[f]=0,x=g+f;d<=x&&x<c&&(o[f]=g+1)}let h=s.previousIndex;o[h]=d-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!nE(e))throw new me(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,qD(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new NE(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new $p),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new $p),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},NE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},PE=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},$p=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new PE,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function oM(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function sM(){return new kE([new ME])}var kE=(()=>{class n{factories;static \u0275prov=pe({token:n,providedIn:"root",factory:sM});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=K(n,{optional:!0,skipSelf:!0});return n.create(t,i||sM())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new me(901,!1)}}return n})();function mM(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;pt(at.BootstrapApplicationStart);try{let o=r?.injector??vU(i),s=[FA(),aT,...t||[]],a=new Su({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return pU({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{pt(at.BootstrapApplicationEnd)}}function Gu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var yM=null;function Fi(){return yM}function OE(n){yM??=n}var $u=class{},zp=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(vM),providedIn:"platform"})}return n})();var vM=(()=>{class n extends zp{_location;_history;_doc=K(Qt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Fi().getBaseHref(this._doc)}onPopState(t){let i=Fi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Fi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function bM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function _M(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ds(n){return n&&n[0]!=="?"?`?${n}`:n}var Nl=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(RU),providedIn:"root"})}return n})(),MU=new we(""),RU=(()=>{class n extends Nl{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??K(Qt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return bM(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+ds(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+ds(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+ds(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Ne(zp),Ne(MU,8))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pl=(()=>{class n{_subject=new jt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=kU(_M(EM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ds(i))}normalize(t){return n.stripTrailingSlash(PU(this._basePath,EM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ds(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ds(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=ds;static joinWithSlash=bM;static stripTrailingSlash=_M;static \u0275fac=function(i){return new(i||n)(Ne(Nl))};static \u0275prov=pe({token:n,factory:()=>NU(),providedIn:"root"})}return n})();function NU(){return new Pl(Ne(Nl))}function PU(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function EM(n){return n.replace(/\/index.html$/,"")}function kU(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Bn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Bn||{}),Ct=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(Ct||{}),ii=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(ii||{}),fo={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function TM(n){return vi(n)[nn.LocaleId]}function CM(n,e,t){let i=vi(n),r=[i[nn.DayPeriodsFormat],i[nn.DayPeriodsStandalone]],o=Li(r,e);return Li(o,t)}function DM(n,e,t){let i=vi(n),r=[i[nn.DaysFormat],i[nn.DaysStandalone]],o=Li(r,e);return Li(o,t)}function AM(n,e,t){let i=vi(n),r=[i[nn.MonthsFormat],i[nn.MonthsStandalone]],o=Li(r,e);return Li(o,t)}function MM(n,e){let i=vi(n)[nn.Eras];return Li(i,e)}function zu(n,e){let t=vi(n);return Li(t[nn.DateFormat],e)}function Wu(n,e){let t=vi(n);return Li(t[nn.TimeFormat],e)}function qu(n,e){let i=vi(n)[nn.DateTimeFormat];return Li(i,e)}function Ku(n,e){let t=vi(n),i=t[nn.NumberSymbols][e];if(typeof i>"u"){if(e===fo.CurrencyDecimal)return t[nn.NumberSymbols][fo.Decimal];if(e===fo.CurrencyGroup)return t[nn.NumberSymbols][fo.Group]}return i}function RM(n){if(!n[nn.ExtraData])throw new me(2303,!1)}function NM(n){let e=vi(n);return RM(e),(e[nn.ExtraData][2]||[]).map(i=>typeof i=="string"?FE(i):[FE(i[0]),FE(i[1])])}function PM(n,e,t){let i=vi(n);RM(i);let r=[i[nn.ExtraData][0],i[nn.ExtraData][1]],o=Li(r,e)||[];return Li(o,t)||[]}function Li(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new me(2304,!1)}function FE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var OU=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Wp={},FU=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function kM(n,e,t,i){let r=zU(n);e=ho(t,e)||e;let s=[],a;for(;e;)if(a=FU.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let l=r.getTimezoneOffset();i&&(l=FM(i,l),r=$U(r,i));let c="";return s.forEach(d=>{let h=HU(d);c+=h?h(r,t,l):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Jp(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function ho(n,e){let t=TM(n);if(Wp[t]??={},Wp[t][e])return Wp[t][e];let i="";switch(e){case"shortDate":i=zu(n,ii.Short);break;case"mediumDate":i=zu(n,ii.Medium);break;case"longDate":i=zu(n,ii.Long);break;case"fullDate":i=zu(n,ii.Full);break;case"shortTime":i=Wu(n,ii.Short);break;case"mediumTime":i=Wu(n,ii.Medium);break;case"longTime":i=Wu(n,ii.Long);break;case"fullTime":i=Wu(n,ii.Full);break;case"short":let r=ho(n,"shortTime"),o=ho(n,"shortDate");i=qp(qu(n,ii.Short),[r,o]);break;case"medium":let s=ho(n,"mediumTime"),a=ho(n,"mediumDate");i=qp(qu(n,ii.Medium),[s,a]);break;case"long":let l=ho(n,"longTime"),c=ho(n,"longDate");i=qp(qu(n,ii.Long),[l,c]);break;case"full":let d=ho(n,"fullTime"),h=ho(n,"fullDate");i=qp(qu(n,ii.Full),[d,h]);break}return i&&(Wp[t][e]=i),i}function qp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function ir(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function LU(n,e){return ir(n,3).substring(0,e)}function hn(n,e,t=0,i=!1,r=!1){return function(o,s){let a=VU(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return LU(a,e);let l=Ku(s,fo.MinusSign);return ir(a,e,l,i,r)}}function VU(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new me(2301,!1)}}function Nt(n,e,t=Bn.Format,i=!1){return function(r,o){return UU(r,o,n,e,t,i)}}function UU(n,e,t,i,r,o){switch(t){case 2:return AM(e,r,i)[n.getMonth()];case 1:return DM(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let c=NM(e),d=PM(e,r,i),h=c.findIndex(f=>{if(Array.isArray(f)){let[g,x]=f,S=s>=g.hours&&a>=g.minutes,R=s<x.hours||s===x.hours&&a<x.minutes;if(g.hours<x.hours){if(S&&R)return!0}else if(S||R)return!0}else if(f.hours===s&&f.minutes===a)return!0;return!1});if(h!==-1)return d[h]}return CM(e,r,i)[s<12?0:1];case 3:return MM(e,i)[n.getFullYear()<=0?0:1];default:let l=t;throw new me(2302,!1)}}function Kp(n){return function(e,t,i){let r=-1*i,o=Ku(t,fo.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+ir(s,2,o)+ir(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+ir(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+ir(s,2,o)+":"+ir(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+ir(s,2,o)+":"+ir(Math.abs(r%60),2,o);default:throw new me(2310,!1)}}}var BU=0,Qp=4;function jU(n){let e=Jp(n,BU,1).getDay();return Jp(n,0,1+(e<=Qp?Qp:Qp+7)-e)}function OM(n){let e=n.getDay(),t=e===0?-3:Qp-e;return Jp(n.getFullYear(),n.getMonth(),n.getDate()+t)}function LE(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=OM(t),s=jU(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return ir(r,n,Ku(i,fo.MinusSign))}}function Yp(n,e=!1){return function(t,i){let o=OM(t).getFullYear();return ir(o,n,Ku(i,fo.MinusSign),e)}}var VE={};function HU(n){if(VE[n])return VE[n];let e;switch(n){case"G":case"GG":case"GGG":e=Nt(3,Ct.Abbreviated);break;case"GGGG":e=Nt(3,Ct.Wide);break;case"GGGGG":e=Nt(3,Ct.Narrow);break;case"y":e=hn(0,1,0,!1,!0);break;case"yy":e=hn(0,2,0,!0,!0);break;case"yyy":e=hn(0,3,0,!1,!0);break;case"yyyy":e=hn(0,4,0,!1,!0);break;case"Y":e=Yp(1);break;case"YY":e=Yp(2,!0);break;case"YYY":e=Yp(3);break;case"YYYY":e=Yp(4);break;case"M":case"L":e=hn(1,1,1);break;case"MM":case"LL":e=hn(1,2,1);break;case"MMM":e=Nt(2,Ct.Abbreviated);break;case"MMMM":e=Nt(2,Ct.Wide);break;case"MMMMM":e=Nt(2,Ct.Narrow);break;case"LLL":e=Nt(2,Ct.Abbreviated,Bn.Standalone);break;case"LLLL":e=Nt(2,Ct.Wide,Bn.Standalone);break;case"LLLLL":e=Nt(2,Ct.Narrow,Bn.Standalone);break;case"w":e=LE(1);break;case"ww":e=LE(2);break;case"W":e=LE(1,!0);break;case"d":e=hn(2,1);break;case"dd":e=hn(2,2);break;case"c":case"cc":e=hn(7,1);break;case"ccc":e=Nt(1,Ct.Abbreviated,Bn.Standalone);break;case"cccc":e=Nt(1,Ct.Wide,Bn.Standalone);break;case"ccccc":e=Nt(1,Ct.Narrow,Bn.Standalone);break;case"cccccc":e=Nt(1,Ct.Short,Bn.Standalone);break;case"E":case"EE":case"EEE":e=Nt(1,Ct.Abbreviated);break;case"EEEE":e=Nt(1,Ct.Wide);break;case"EEEEE":e=Nt(1,Ct.Narrow);break;case"EEEEEE":e=Nt(1,Ct.Short);break;case"a":case"aa":case"aaa":e=Nt(0,Ct.Abbreviated);break;case"aaaa":e=Nt(0,Ct.Wide);break;case"aaaaa":e=Nt(0,Ct.Narrow);break;case"b":case"bb":case"bbb":e=Nt(0,Ct.Abbreviated,Bn.Standalone,!0);break;case"bbbb":e=Nt(0,Ct.Wide,Bn.Standalone,!0);break;case"bbbbb":e=Nt(0,Ct.Narrow,Bn.Standalone,!0);break;case"B":case"BB":case"BBB":e=Nt(0,Ct.Abbreviated,Bn.Format,!0);break;case"BBBB":e=Nt(0,Ct.Wide,Bn.Format,!0);break;case"BBBBB":e=Nt(0,Ct.Narrow,Bn.Format,!0);break;case"h":e=hn(3,1,-12);break;case"hh":e=hn(3,2,-12);break;case"H":e=hn(3,1);break;case"HH":e=hn(3,2);break;case"m":e=hn(4,1);break;case"mm":e=hn(4,2);break;case"s":e=hn(5,1);break;case"ss":e=hn(5,2);break;case"S":e=hn(6,1);break;case"SS":e=hn(6,2);break;case"SSS":e=hn(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Kp(0);break;case"ZZZZZ":e=Kp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Kp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Kp(2);break;default:return null}return VE[n]=e,e}function FM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function GU(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function $U(n,e,t){let r=n.getTimezoneOffset(),o=FM(e,r);return GU(n,-1*(o-r))}function zU(n){if(wM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return Jp(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(OU))return WU(i)}let e=new Date(n);if(!wM(e))throw new me(2311,!1);return e}function WU(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),c=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,c),e}function wM(n){return n instanceof Date&&!isNaN(n.valueOf())}var UE=/\s+/,xM=[],Yu=(()=>{class n{_ngEl;_renderer;initialClasses=xM;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(UE):xM}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(UE):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(UE).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(he(ki),he(ss))};static \u0275dir=vn({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var Xp=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},hs=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Xp(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),SM(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);SM(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(he(lo),he(rs),he(kE))};static \u0275dir=vn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function SM(n,e){n.context.$implicit=e.item}var ya=(()=>{class n{_viewContainer;_context=new Zp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){IM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){IM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(he(lo),he(rs))};static \u0275dir=vn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Zp=class{$implicit=null;ngIf=null};function IM(n,e){if(n&&!n.createEmbeddedView)throw new me(2020,!1)}function LM(n,e){return new me(2100,!1)}var qU=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,BE=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw LM(n,t);return t.replace(qU,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=kp({name:"titlecase",type:n,pure:!0})}return n})();var KU="mediumDate",VM=new we(""),UM=new we(""),va=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??KU,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return kM(t,s,o||this.locale,a)}catch(s){throw LM(n,s.message)}}static \u0275fac=function(i){return new(i||n)(he(ju,16),he(VM,24),he(UM,24))};static \u0275pipe=kp({name:"date",type:n,pure:!0})}return n})();var Pt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=co({type:n});static \u0275inj=_r({})}return n})();function jE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Qu=class{};var HE="browser";function fs(n){return n===HE}var Ju=class{_doc;constructor(e){this._doc=e}manager},eg=(()=>{class n extends Ju{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(Ne(Qt))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),ig=new we(""),WE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof eg));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof eg);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new me(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Ne(ig),Ne(yn))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),GE="ng-app-id";function BM(n){for(let e of n)e.remove()}function jM(n,e){let t=e.createElement("style");return t.textContent=n,t}function YU(n,e,t,i){let r=n.head?.querySelectorAll(`style[${GE}="${e}"],link[${GE}="${e}"]`);if(r)for(let o of r)o.removeAttribute(GE),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function zE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var qE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,YU(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,jM);i?.forEach(r=>this.addUsage(r,this.external,zE))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(BM(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])BM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,jM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,zE(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Ne(Qt),Ne(Ar),Ne(wl,8),Ne(Zi))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),$E={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},KE=/%COMP%/g;var GM="%COMP%",QU=`_nghost-${GM}`,JU=`_ngcontent-${GM}`,XU=!0,ZU=new we("",{factory:()=>XU});function eB(n){return JU.replace(KE,n)}function tB(n){return QU.replace(KE,n)}function $M(n,e){return e.map(t=>t.replace(KE,n))}var YE=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,r,o,s,a,l=null,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.defaultRenderer=new Xu(t,s,a,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof ng?r.applyToHost(t):r instanceof Zu&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.tracingService;switch(i.encapsulation){case Xi.Emulated:o=new ng(l,c,i,this.appId,d,s,a,h);break;case Xi.ShadowDom:return new tg(l,t,i,s,a,this.nonce,h,c);case Xi.ExperimentalIsolatedShadowDom:return new tg(l,t,i,s,a,this.nonce,h);default:o=new Zu(l,c,i,d,s,a,h);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Ne(WE),Ne(qE),Ne(Ar),Ne(ZU),Ne(Qt),Ne(yn),Ne(wl),Ne(os,8))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),Xu=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS($E[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(HM(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(HM(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new me(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=$E[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=$E[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Dr.DashCase|Dr.Important)?e.style.setProperty(t,i,r&Dr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Dr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Fi().getGlobalEventTarget(this.doc,e),!e))throw new me(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function HM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var tg=class extends Xu{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let c=i.styles;c=$M(i.id,c);for(let h of c){let f=document.createElement("style");s&&f.setAttribute("nonce",s),f.textContent=h,this.shadowRoot.appendChild(f)}let d=i.getExternalStyles?.();if(d)for(let h of d){let f=zE(h,r);s&&f.setAttribute("nonce",s),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Zu=class extends Xu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let c=i.styles;this.styles=l?$M(l,c):c,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&la.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ng=class extends Zu{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l){let c=r+"-"+i.id;super(e,t,i,o,s,a,l,c),this.contentAttr=eB(c),this.hostAttr=tB(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var rg=class n extends $u{supportsDOMEvents=!0;static makeCurrent(){OE(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=nB();return t==null?null:iB(t)}resetBaseElement(){ed=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return jE(document.cookie,e)}},ed=null;function nB(){return ed=ed||document.head.querySelector("base"),ed?ed.getAttribute("href"):null}function iB(n){return new URL(n,document.baseURI).pathname}var rB=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),zM=["alt","control","meta","shift"],oB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},WM=(()=>{class n extends Ju{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Fi().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),zM.forEach(c=>{let d=i.indexOf(c);d>-1&&(i.splice(d,1),s+=c+".")}),s+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=oB[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),zM.forEach(s=>{if(s!==r){let a=sB[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(Ne(Qt))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})();async function QE(n,e,t){let i=F({rootComponent:n},aB(e,t));return mM(i)}function aB(n,e){return{platformRef:e?.platformRef,appProviders:[...hB,...n?.providers??[]],platformProviders:dB}}function lB(){rg.makeCurrent()}function cB(){return new yr}function uB(){return D_(document),document}var dB=[{provide:Zi,useValue:HE},{provide:fp,useValue:lB,multi:!0},{provide:Qt,useFactory:uB}];var hB=[{provide:su,useValue:"root"},{provide:yr,useFactory:cB},{provide:ig,useClass:eg,multi:!0},{provide:ig,useClass:WM,multi:!0},YE,qE,WE,{provide:ca,useExisting:YE},{provide:Qu,useClass:rB},[]];var td=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var fB="text/plain",pB="application/json",Dle=`${pB}, ${fB}, */*`;var XE=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(XE||{}),JE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new td,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var og=class n extends JE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=XE.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var qM=new we("");var gB=new we(""),mB="b",yB="h",vB="s",_B="st",EB="u",bB="rt",ZE=new we(""),wB=["GET","HEAD"];function xB(n,e){let g=K(ZE),{isCacheActive:t}=g,i=Ja(g,["isCacheActive"]),{transferCache:r,method:o}=n;if(!t||r===!1||o==="POST"&&!i.includePostRequests&&!r||o!=="POST"&&!wB.includes(o)||!i.includeRequestsWithAuthHeaders&&SB(n)||i.filter?.(n)===!1)return e(n);let s=K(xl);if(K(gB,{optional:!0}))throw new me(2803,!1);let l=n.url,c=IB(n,l),d=s.get(c,null),h=i.includeHeaders;if(typeof r=="object"&&r.includeHeaders&&(h=r.includeHeaders),d){let{[mB]:x,[bB]:S,[yB]:R,[vB]:L,[_B]:q,[EB]:ye}=d,_e=x;switch(S){case"arraybuffer":_e=new TextEncoder().encode(x).buffer;break;case"blob":_e=new Blob([x]);break}let xe=new td(R);return it(new og({body:_e,headers:xe,status:L,statusText:q,url:ye}))}return e(n)}function SB(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function KM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function IB(n,e){let{params:t,method:i,responseType:r}=n,o=KM(t),s=n.serializeBody();s instanceof URLSearchParams?s=KM(s):typeof s!="string"&&(s="");let a=[i,r,e,s,o].join("|"),l=TB(a);return l}function TB(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function YM(n){return[{provide:ZE,useFactory:()=>(yi("NgHttpTransferCache"),F({isCacheActive:!0},n))},{provide:qM,useValue:xB,multi:!0},{provide:ls,multi:!0,useFactory:()=>{let e=K(ti),t=K(ZE);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var QM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Ne(Qt))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var sg=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(sg||{});function CB(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function JM(){return CB(sg.EventReplay,pM())}function XM(...n){let e=[],t=new Set;for(let{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);let i=t.has(sg.HttpTransferCacheOptions);return br([[],[],gM(),t.has(sg.NoHttpTransferCache)||i?[]:YM({}),e])}var ze="primary",fd=Symbol("RouteTitle"),rb=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ba(n){return new rb(n)}function eb(n,e,t){for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function l2(n,e,t){let i=t.path.split("/"),r=i.indexOf("**");if(r===-1){if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let l={},c=n.slice(0,i.length);return eb(i,c,l)?{consumed:c,posParams:l}:null}if(r!==i.lastIndexOf("**"))return null;let o=i.slice(0,r),s=i.slice(r+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!eb(o,n.slice(0,o.length),a)||!eb(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function hg(n){return new Promise((e,t)=>{n.pipe(Xr()).subscribe({next:i=>e(i),error:i=>t(i)})})}function AB(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Pr(n[t],e[t]))return!1;return!0}function Pr(n,e){let t=n?ob(n):void 0,i=e?ob(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!c2(n[r],e[r]))return!1;return!0}function ob(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function c2(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function MB(n){return n.length>0?n[n.length-1]:null}function Sa(n){return of(n)?n:as(n)?ln(Promise.resolve(n)):it(n)}function u2(n){return of(n)?hg(n):Promise.resolve(n)}var RB={exact:h2,subset:f2},d2={exact:NB,subset:PB,ignored:()=>!0};function ZM(n,e,t){return RB[t.paths](n.root,e.root,t.matrixParams)&&d2[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function NB(n,e){return Pr(n,e)}function h2(n,e,t){if(!_a(n.segments,e.segments)||!cg(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!h2(n.children[i],e.children[i],t))return!1;return!0}function PB(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>c2(n[t],e[t]))}function f2(n,e,t){return p2(n,e,e.segments,t)}function p2(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!_a(r,t)||e.hasChildren()||!cg(r,t,i))}else if(n.segments.length===t.length){if(!_a(n.segments,t)||!cg(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!f2(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!_a(n.segments,r)||!cg(n.segments,r,i)||!n.children[ze]?!1:p2(n.children[ze],e,o,i)}}function cg(n,e,t){return e.every((i,r)=>d2[t](n[r].parameters,i.parameters))}var or=class{root;queryParams;fragment;_queryParamMap;constructor(e=new gt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=ba(this.queryParams),this._queryParamMap}toString(){return FB.serialize(this)}},gt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ug(this)}},ps=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ba(this.parameters),this._parameterMap}toString(){return m2(this)}};function kB(n,e){return _a(n,e)&&n.every((t,i)=>Pr(t.parameters,e[i].parameters))}function _a(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function OB(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===ze&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ze&&(t=t.concat(e(r,i)))}),t}var pd=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>new gs,providedIn:"root"})}return n})(),gs=class{parse(e){let t=new ab(e);return new or(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${nd(e.root,!0)}`,i=UB(e.queryParams),r=typeof e.fragment=="string"?`#${LB(e.fragment)}`:"";return`${t}${i}${r}`}},FB=new gs;function ug(n){return n.segments.map(e=>m2(e)).join("/")}function nd(n,e){if(!n.hasChildren())return ug(n);if(e){let t=n.children[ze]?nd(n.children[ze],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==ze&&i.push(`${r}:${nd(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=OB(n,(i,r)=>r===ze?[nd(n.children[ze],!1)]:[`${r}:${nd(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[ze]!=null?`${ug(n)}/${t[0]}`:`${ug(n)}/(${t.join("//")})`}}function g2(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ag(n){return g2(n).replace(/%3B/gi,";")}function LB(n){return encodeURI(n)}function sb(n){return g2(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dg(n){return decodeURIComponent(n)}function e2(n){return dg(n.replace(/\+/g,"%20"))}function m2(n){return`${sb(n.path)}${VB(n.parameters)}`}function VB(n){return Object.entries(n).map(([e,t])=>`;${sb(e)}=${sb(t)}`).join("")}function UB(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${ag(t)}=${ag(r)}`).join("&"):`${ag(t)}=${ag(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var BB=/^[^\/()?;#]+/;function tb(n){let e=n.match(BB);return e?e[0]:""}var jB=/^[^\/()?;=#]+/;function HB(n){let e=n.match(jB);return e?e[0]:""}var GB=/^[^=?&#]+/;function $B(n){let e=n.match(GB);return e?e[0]:""}var zB=/^[^&#]+/;function WB(n){let e=n.match(zB);return e?e[0]:""}var ab=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new gt([],{}):new gt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[ze]=new gt(e,t)),i}parseSegment(){let e=tb(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new me(4009,!1);return this.capture(e),new ps(dg(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=HB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=tb(this.remaining);r&&(i=r,this.capture(i))}e[dg(t)]=dg(i)}parseQueryParam(e){let t=$B(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=WB(this.remaining);s&&(i=s,this.capture(i))}let r=e2(t),o=e2(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=tb(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new me(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ze);let s=this.parseChildren();t[o??ze]=Object.keys(s).length===1&&s[ze]?s[ze]:new gt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new me(4011,!1)}};function y2(n){return n.segments.length>0?new gt([],{[ze]:n}):n}function v2(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=v2(r);if(i===ze&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new gt(n.segments,e);return qB(t)}function qB(n){if(n.numberOfChildren===1&&n.children[ze]){let e=n.children[ze];return new gt(n.segments.concat(e.segments),e.children)}return n}function ms(n){return n instanceof or}function _2(n,e,t=null,i=null,r=new gs){let o=E2(n);return b2(o,e,t,i,r)}function E2(n){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new gt(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=y2(i);return e??r}function b2(n,e,t,i,r){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return nb(o,o,o,t,i,r);let s=KB(e);if(s.toRoot())return nb(o,o,new gt([],{}),t,i,r);let a=YB(s,o,n),l=a.processChildren?rd(a.segmentGroup,a.index,s.commands):x2(a.segmentGroup,a.index,s.commands);return nb(o,a.segmentGroup,l,t,i,r)}function fg(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function ad(n){return typeof n=="object"&&n!=null&&n.outlets}function t2(n,e,t){n||="\u0275";let i=new or;return i.queryParams={[n]:e},t.parse(t.serialize(i)).queryParams[n]}function nb(n,e,t,i,r,o){let s={};for(let[c,d]of Object.entries(i??{}))s[c]=Array.isArray(d)?d.map(h=>t2(c,h,o)):t2(c,d,o);let a;n===e?a=t:a=w2(n,e,t);let l=y2(v2(a));return new or(l,s,r)}function w2(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=w2(o,e,t)}),new gt(n.segments,i)}var pg=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&fg(i[0]))throw new me(4003,!1);let r=i.find(ad);if(r&&r!==MB(i))throw new me(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function KB(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new pg(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new pg(t,e,i)}var Fl=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function YB(n,e,t){if(n.isAbsolute)return new Fl(e,!0,0);if(!t)return new Fl(e,!1,NaN);if(t.parent===null)return new Fl(t,!0,0);let i=fg(n.commands[0])?0:1,r=t.segments.length-1+i;return QB(t,r,n.numberOfDoubleDots)}function QB(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new me(4005,!1);r=i.segments.length}return new Fl(i,!1,r-o)}function JB(n){return ad(n[0])?n[0].outlets:{[ze]:n}}function x2(n,e,t){if(n??=new gt([],{}),n.segments.length===0&&n.hasChildren())return rd(n,e,t);let i=XB(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new gt(n.segments.slice(0,i.pathIndex),{});return o.children[ze]=new gt(n.segments.slice(i.pathIndex),n.children),rd(o,0,r)}else return i.match&&r.length===0?new gt(n.segments,{}):i.match&&!n.hasChildren()?lb(n,e,t):i.match?rd(n,0,r):lb(n,e,t)}function rd(n,e,t){if(t.length===0)return new gt(n.segments,{});{let i=JB(t),r={};if(Object.keys(i).some(o=>o!==ze)&&n.children[ze]&&n.numberOfChildren===1&&n.children[ze].segments.length===0){let o=rd(n.children[ze],e,t);return new gt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=x2(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new gt(n.segments,r)}}function XB(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(ad(a))break;let l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!i2(l,c,s))return o;i+=2}else{if(!i2(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function lb(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(ad(o)){let l=ZB(o.outlets);return new gt(i,l)}if(r===0&&fg(t[0])){let l=n.segments[e];i.push(new ps(l.path,n2(t[0]))),r++;continue}let s=ad(o)?o.outlets[ze]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&fg(a)?(i.push(new ps(s,n2(a))),r+=2):(i.push(new ps(s,{})),r++)}return new gt(i,{})}function ZB(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=lb(new gt([],{}),0,i))}),e}function n2(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function i2(n,e,t){return n==t.path&&Pr(e,t.parameters)}var od="imperative",Tn=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Tn||{}),bi=class{id;url;constructor(e,t){this.id=e,this.url=t}},wa=class extends bi{type=Tn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},kr=class extends bi{urlAfterRedirects;type=Tn.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},jn=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(jn||{}),ld=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(ld||{}),Vi=class extends bi{reason;code;type=Tn.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function S2(n){return n instanceof Vi&&(n.code===jn.Redirect||n.code===jn.SupersededByNewNavigation)}var go=class extends bi{reason;code;type=Tn.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},xa=class extends bi{error;target;type=Tn.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Vl=class extends bi{urlAfterRedirects;state;type=Tn.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},gg=class extends bi{urlAfterRedirects;state;type=Tn.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},mg=class extends bi{urlAfterRedirects;state;shouldActivate;type=Tn.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},yg=class extends bi{urlAfterRedirects;state;type=Tn.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},vg=class extends bi{urlAfterRedirects;state;type=Tn.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_g=class{route;type=Tn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Eg=class{route;type=Tn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},bg=class{snapshot;type=Tn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},wg=class{snapshot;type=Tn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xg=class{snapshot;type=Tn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sg=class{snapshot;type=Tn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ul=class{},Bl=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function e8(n){return!(n instanceof Ul)&&!(n instanceof Bl)}var Ig=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Gl(this.rootInjector)}},Gl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Ig(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Ne(Yt))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Tg=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=cb(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=cb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=ub(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return ub(e,this._root).map(t=>t.value)}};function cb(n,e){if(n===e.value)return e;for(let t of e.children){let i=cb(n,t);if(i)return i}return null}function ub(n,e){if(n===e.value)return[e];for(let t of e.children){let i=ub(n,t);if(i.length)return i.unshift(e),i}return[]}var Ei=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ol(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var cd=class extends Tg{snapshot;constructor(e,t){super(e),this.snapshot=t,vb(this,e)}toString(){return this.snapshot.toString()}};function I2(n,e){let t=t8(n,e),i=new Pn([new ps("",{})]),r=new Pn({}),o=new Pn({}),s=new Pn({}),a=new Pn(""),l=new mo(i,r,s,a,o,ze,n,t.root);return l.snapshot=t.root,new cd(new Ei(l,[]),t)}function t8(n,e){let t={},i={},r={},s=new Ea([],t,r,"",i,ze,n,null,{},e);return new ud("",new Ei(s,[]))}var mo=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(yt(c=>c[fd]))??it(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(yt(e=>ba(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(yt(e=>ba(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Cg(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),r?.data),n._resolvedData)}:i={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},r&&C2(r)&&(i.resolve[fd]=r.title),i}var Ea=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[fd]}constructor(e,t,i,r,o,s,a,l,c,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ba(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ba(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ud=class extends Tg{url;constructor(e,t){super(t),this.url=e,vb(this,t)}toString(){return T2(this._root)}};function vb(n,e){e.value._routerState=n,e.children.forEach(t=>vb(n,t))}function T2(n){let e=n.children.length>0?` { ${n.children.map(T2).join(", ")} } `:"";return`${n.value}${e}`}function ib(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Pr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Pr(e.params,t.params)||n.paramsSubject.next(t.params),AB(e.url,t.url)||n.urlSubject.next(t.url),Pr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function db(n,e){let t=Pr(n.params,e.params)&&kB(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||db(n.parent,e.parent))}function C2(n){return typeof n.title=="string"||n.title===null}var D2=new we(""),gd=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ze;activateEvents=new cn;deactivateEvents=new cn;attachEvents=new cn;detachEvents=new cn;routerOutletData=hM();parentContexts=K(Gl);location=K(lo);changeDetector=K(ma);inputBinder=K(Rg,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new me(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new me(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new me(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new me(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new hb(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=vn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[ao]})}return n})(),hb=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===mo?this.route:e===Gl?this.childContexts:e===D2?this.outletData:this.parent.get(e,t)}},Rg=new we("");var _b=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=It({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&W(0,"router-outlet")},dependencies:[gd],encapsulation:2})}return n})();function Eb(n){let e=n.children&&n.children.map(Eb),t=e?ce(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ze&&(t.component=_b),t}function n8(n,e,t){let i=dd(n,e._root,t?t._root:void 0);return new cd(i,e)}function dd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=i8(n,e,t);return new Ei(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>dd(n,a)),s}}let i=r8(e.value),r=e.children.map(o=>dd(n,o));return new Ei(i,r)}}function i8(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return dd(n,i,r);return dd(n,i)})}function r8(n){return new mo(new Pn(n.url),new Pn(n.params),new Pn(n.queryParams),new Pn(n.fragment),new Pn(n.data),n.outlet,n.component,n)}var jl=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},A2="ngNavigationCancelingError";function Dg(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=ms(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=M2(!1,jn.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function M2(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[A2]=!0,t.cancellationCode=e,t}function o8(n){return R2(n)&&ms(n.url)}function R2(n){return!!n&&n[A2]}var fb=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),ib(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=Ol(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Ol(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Ol(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=Ol(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Sg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new wg(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(ib(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),ib(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},Ag=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ll=class{component;route;constructor(e,t){this.component=e,this.route=t}};function s8(n,e,t){let i=n._root,r=e?e._root:null;return id(i,r,t,[i.value])}function a8(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function $l(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!Gy(n)?n:e.get(n):i}function id(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=Ol(e);return n.children.forEach(s=>{l8(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>sd(a,t.getContext(s),r)),r}function l8(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=c8(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Ag(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?id(n,e,a?a.children:null,i,r):id(n,e,t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Ll(a.outlet.component,s))}else s&&sd(e,a,r),r.canActivateChecks.push(new Ag(i)),o.component?id(n,null,a?a.children:null,i,r):id(n,null,t,i,r);return r}function c8(n,e,t){if(typeof t=="function")return Fn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!_a(n.url,e.url);case"pathParamsOrQueryParamsChange":return!_a(n.url,e.url)||!Pr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!db(n,e)||!Pr(n.queryParams,e.queryParams);default:return!db(n,e)}}function sd(n,e,t){let i=Ol(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?sd(s,e.children.getContext(o),t):sd(s,null,t):sd(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ll(e.outlet.component,r)):t.canDeactivateChecks.push(new Ll(null,r)):t.canDeactivateChecks.push(new Ll(null,r))}function md(n){return typeof n=="function"}function u8(n){return typeof n=="boolean"}function d8(n){return n&&md(n.canLoad)}function h8(n){return n&&md(n.canActivate)}function f8(n){return n&&md(n.canActivateChild)}function p8(n){return n&&md(n.canDeactivate)}function g8(n){return n&&md(n.canMatch)}function N2(n){return n instanceof Gs||n?.name==="EmptyError"}var lg=Symbol("INITIAL_VALUE");function Hl(){return Zr(n=>Yc(n.map(e=>e.pipe(qi(1),Xc(lg)))).pipe(yt(e=>{for(let t of e)if(t!==!0){if(t===lg)return lg;if(t===!1||m8(t))return t}return!0}),Wi(e=>e!==lg),qi(1)))}function m8(n){return ms(n)||n instanceof jl}function P2(n){return n.aborted?it(void 0).pipe(qi(1)):new st(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function k2(n){return $s(P2(n))}function y8(n){return zn(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?it(ce(F({},e),{guardsResult:!0})):v8(o,t,i).pipe(zn(s=>s&&u8(s)?_8(t,r,n):it(s)),yt(s=>ce(F({},e),{guardsResult:s})))})}function v8(n,e,t){return ln(n).pipe(zn(i=>S8(i.component,i.route,t,e)),Xr(i=>i!==!0,!0))}function _8(n,e,t){return ln(e).pipe(cf(i=>Ko(b8(i.route.parent,t),E8(i.route,t),x8(n,i.path),w8(n,i.route))),Xr(i=>i!==!0,!0))}function E8(n,e){return n!==null&&e&&e(new xg(n)),it(!0)}function b8(n,e){return n!==null&&e&&e(new bg(n)),it(!0)}function w8(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return it(!0);let i=t.map(r=>Qc(()=>{let o=e._environmentInjector,s=$l(r,o),a=h8(s)?s.canActivate(e,n):Fn(o,()=>s(e,n));return Sa(a).pipe(Xr())}));return it(i).pipe(Hl())}function x8(n,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>a8(o)).filter(o=>o!==null).map(o=>Qc(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,c=$l(a,l),d=f8(c)?c.canActivateChild(t,n):Fn(l,()=>c(t,n));return Sa(d).pipe(Xr())});return it(s).pipe(Hl())}));return it(r).pipe(Hl())}function S8(n,e,t,i){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return it(!0);let o=r.map(s=>{let a=e._environmentInjector,l=$l(s,a),c=p8(l)?l.canDeactivate(n,e,t,i):Fn(a,()=>l(n,e,t,i));return Sa(c).pipe(Xr())});return it(o).pipe(Hl())}function I8(n,e,t,i,r){let o=e.canLoad;if(o===void 0||o.length===0)return it(!0);let s=o.map(a=>{let l=$l(a,n),c=d8(l)?l.canLoad(e,t):Fn(n,()=>l(e,t)),d=Sa(c);return r?d.pipe(k2(r)):d});return it(s).pipe(Hl(),O2(i))}function O2(n){return vy(gr(e=>{if(typeof e!="boolean")throw Dg(n,e)}),yt(e=>e===!0))}function T8(n,e,t,i,r){let o=e.canMatch;if(!o||o.length===0)return it(!0);let s=o.map(a=>{let l=$l(a,n),c=g8(l)?l.canMatch(e,t):Fn(n,()=>l(e,t));return Sa(c).pipe(k2(r))});return it(s).pipe(Hl(),O2(i))}var po=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},hd=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function C8(n){throw new me(4e3,!1)}function D8(n){throw M2(!1,jn.GuardRejected)}var pb=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return i;if(r.numberOfChildren>1||!r.children[ze])throw C8(`${e.redirectTo}`);r=r.children[ze]}}async applyRedirectCommands(e,t,i,r,o){let s=await A8(t,r,o);if(s instanceof or)throw new hd(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new hd(a);return a}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new or(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new gt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new me(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function A8(n,e,t){if(typeof n=="string")return Promise.resolve(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:c,data:d,title:h,paramMap:f,queryParamMap:g}=e;return hg(Sa(Fn(t,()=>i({params:c,data:d,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:f,queryParamMap:g}))))}function M8(n,e){return n.providers&&!n._injector&&(n._injector=Tl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function rr(n){return n.outlet||ze}function R8(n,e){let t=n.filter(i=>rr(i)===e);return t.push(...n.filter(i=>rr(i)!==e)),t}var gb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function N8(n,e,t,i,r,o){let s=F2(n,e,t);return s.matched?(i=M8(e,i),T8(i,e,t,r,o).pipe(yt(a=>a===!0?s:F({},gb)))):it(s)}function F2(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},gb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||l2)(t,n,e);if(!r)return F({},gb);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?F(F({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function r2(n,e,t,i){return t.length>0&&O8(n,t,i)?{segmentGroup:new gt(e,k8(i,new gt(t,n.children))),slicedSegments:[]}:t.length===0&&F8(n,t,i)?{segmentGroup:new gt(n.segments,P8(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new gt(n.segments,n.children),slicedSegments:t}}function P8(n,e,t,i){let r={};for(let o of t)if(Ng(n,e,o)&&!i[rr(o)]){let s=new gt([],{});r[rr(o)]=s}return F(F({},i),r)}function k8(n,e){let t={};t[ze]=e;for(let i of n)if(i.path===""&&rr(i)!==ze){let r=new gt([],{});t[rr(i)]=r}return t}function O8(n,e,t){return t.some(i=>Ng(n,e,i)&&rr(i)!==ze)}function F8(n,e,t){return t.some(i=>Ng(n,e,i))}function Ng(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function L8(n,e,t){return e.length===0&&!n.children[t]}var mb=class{};async function V8(n,e,t,i,r,o,s="emptyOnly",a){return new yb(n,e,t,i,r,s,o,a).recognize()}var U8=31,yb=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new pb(this.urlSerializer,this.urlTree)}noMatchError(e){return new me(4002,`'${e.segmentGroup}'`)}async recognize(){let e=r2(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),r=new Ei(i,t),o=new ud("",r),s=_2(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new Ea([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ze,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,ze,t),rootSnapshot:t}}catch(i){if(i instanceof hd)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof po?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,r,o){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,o);let s=await this.processSegment(e,t,i,i.segments,r,!0,o);return s instanceof Ei?[s]:[]}async processChildren(e,t,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let c=i.children[l],d=R8(t,l),h=await this.processSegmentGroup(e,d,c,l,r);s.push(...h)}let a=L2(s);return B8(a),a}async processSegment(e,t,i,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a)}catch(c){if(c instanceof po||N2(c))continue;throw c}if(L8(i,r,o))return new mb;throw new po(i)}async processSegmentAgainstRoute(e,t,i,r,o,s,a,l){if(rr(i)!==s&&(s===ze||!Ng(r,o,i)))throw new po(r);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,i,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l);throw new po(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:h,remainingSegments:f}=F2(t,r,o);if(!l)throw new po(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>U8&&(this.allowRedirects=!1));let g=new Ea(o,c,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,o2(r),rr(r),r.component??r._loadedComponent??null,r,s2(r),e),x=Cg(g,a,this.paramsInheritanceStrategy);if(g.params=Object.freeze(x.params),g.data=Object.freeze(x.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let S=await this.applyRedirects.applyRedirectCommands(d,r.redirectTo,h,g,e),R=await this.applyRedirects.lineralizeSegments(r,S);return this.processSegment(e,i,t,R.concat(f),s,!1,a)}async matchSegmentAgainstRoute(e,t,i,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await hg(N8(t,i,r,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!a?.matched)throw new po(t);e=i._injector??e;let{routes:l}=await this.getChildConfig(e,i,r),c=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=a,g=new Ea(h,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,o2(i),rr(i),i.component??i._loadedComponent??null,i,s2(i),e),x=Cg(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(x.params),g.data=Object.freeze(x.data);let{segmentGroup:S,slicedSegments:R}=r2(t,h,f,l);if(R.length===0&&S.hasChildren()){let ye=await this.processChildren(c,l,S,g);return new Ei(g,ye)}if(l.length===0&&R.length===0)return new Ei(g,[]);let L=rr(i)===o,q=await this.processSegment(c,l,S,R,L?ze:o,!0,g);return new Ei(g,q instanceof Ei?[q]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await hg(I8(e,t,i,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw D8(t)}return{routes:[],injector:e}}};function B8(n){n.sort((e,t)=>e.value.outlet===ze?-1:t.value.outlet===ze?1:e.value.outlet.localeCompare(t.value.outlet))}function j8(n){let e=n.value.routeConfig;return e&&e.path===""}function L2(n){let e=[],t=new Set;for(let i of n){if(!j8(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=L2(i.children);e.push(new Ei(i.value,r))}return e.filter(i=>!t.has(i))}function o2(n){return n.data||{}}function s2(n){return n.resolve||{}}function H8(n,e,t,i,r,o,s){return zn(async a=>{let{state:l,tree:c}=await V8(n,e,t,i,a.extractedUrl,r,o,s);return ce(F({},a),{targetSnapshot:l,urlAfterRedirects:c})})}function G8(n){return zn(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return it(e);let r=new Set(i.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of V2(a))o.add(l);let s=0;return ln(o).pipe(cf(a=>r.has(a)?$8(a,t,n):(a.data=Cg(a,a.parent,n).resolve,it(void 0))),gr(()=>s++),uf(1),zn(a=>s===o.size?it(e):kn))})}function V2(n){let e=n.children.map(t=>V2(t)).flat();return[n,...e]}function $8(n,e,t){let i=n.routeConfig,r=n._resolve;return i?.title!==void 0&&!C2(i)&&(r[fd]=i.title),Qc(()=>(n.data=Cg(n,n.parent,t).resolve,z8(r,n,e).pipe(yt(o=>(n._resolvedData=o,n.data=F(F({},n.data),o),null)))))}function z8(n,e,t){let i=ob(n);if(i.length===0)return it({});let r={};return ln(i).pipe(zn(o=>W8(n[o],e,t).pipe(Xr(),gr(s=>{if(s instanceof jl)throw Dg(new gs,s);r[o]=s}))),uf(1),yt(()=>r),Jc(o=>N2(o)?kn:wy(o)))}function W8(n,e,t){let i=e._environmentInjector,r=$l(n,i),o=r.resolve?r.resolve(e,t):Fn(i,()=>r(e,t));return Sa(o)}function a2(n){return Zr(e=>{let t=n(e);return t?ln(t).pipe(yt(()=>e)):it(e)})}var bb=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===ze);return i}getResolvedTitleForRoute(t){return t.data[fd]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(U2),providedIn:"root"})}return n})(),U2=(()=>{class n extends bb{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Ne(QM))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),zl=new we("",{factory:()=>({})}),yd=new we(""),B2=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=K(_E);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await u2(Fn(t,()=>i.loadComponent())),s=await G2(H2(o));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s,s}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await j2(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=o.routes,i._loadedInjector=o.injector,i._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function j2(n,e,t,i){let r=await u2(Fn(t,()=>n.loadChildren())),o=await G2(H2(r)),s;o instanceof Pp||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),i&&i(n);let a,l,c=!1,d;return Array.isArray(s)?(l=s,c=!0):(a=s.create(t).injector,d=s,l=a.get(yd,[],{optional:!0,self:!0}).flat()),{routes:l.map(Eb),injector:a,factory:d}}function q8(n){return n&&typeof n=="object"&&"default"in n}function H2(n){return q8(n)?n.default:n}async function G2(n){return n}var Pg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(K8),providedIn:"root"})}return n})(),K8=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$2=new we("");var Y8=()=>{},z2=new we(""),W2=(()=>{class n{currentNavigation=$(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=$(null);events=new jt;transitionAbortWithErrorSubject=new jt;configLoader=K(B2);environmentInjector=K(Yt);destroyRef=K(ei);urlSerializer=K(pd);rootContexts=K(Gl);location=K(Pl);inputBindingEnabled=K(Rg,{optional:!0})!==null;titleStrategy=K(bb);options=K(zl,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=K(Pg);createViewTransition=K($2,{optional:!0});navigationErrorHandler=K(z2,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>it(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new _g(r)),i=r=>this.events.next(new Eg(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;un(()=>{this.transitions?.next(ce(F({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new Pn(null),this.transitions.pipe(Wi(i=>i!==null),Zr(i=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===i.id;return it(i).pipe(Zr(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",jn.SupersededByNewNavigation),kn;this.currentTransition=i;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?ce(F({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload")return this.events.next(new go(a.id,this.urlSerializer.serialize(a.rawUrl),"",ld.IgnoredSameUrlNavigation)),a.resolve(!1),kn;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return it(a).pipe(Zr(h=>(this.events.next(new wa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?kn:Promise.resolve(h))),H8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),gr(h=>{i.targetSnapshot=h.targetSnapshot,i.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=h.urlAfterRedirects,g));let f=new Vl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:f,source:g,restoredState:x,extras:S}=a,R=new wa(h,this.urlSerializer.serialize(f),g,x);this.events.next(R);let L=I2(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=ce(F({},a),{targetSnapshot:L,urlAfterRedirects:f,extras:ce(F({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(q=>(q.finalUrl=f,q)),it(i)}else return this.events.next(new go(a.id,this.urlSerializer.serialize(a.extractedUrl),"",ld.IgnoredByUrlHandlingStrategy)),a.resolve(!1),kn}),yt(a=>{let l=new gg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=i=ce(F({},a),{guards:s8(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i}),y8(a=>this.events.next(a)),Zr(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw Dg(this.urlSerializer,a.guardsResult);let l=new mg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return kn;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",jn.GuardRejected),kn;if(a.guards.canActivateChecks.length===0)return it(a);let c=new yg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(c),!s())return kn;let d=!1;return it(a).pipe(G8(this.paramsInheritanceStrategy),gr({next:()=>{d=!0;let h=new vg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{d||this.cancelNavigationTransition(a,"",jn.NoDataFromResolver)}}))}),a2(a=>{let l=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let f=d._environmentInjector;h.push(this.configLoader.loadComponent(f,d.routeConfig).then(g=>{d.component=g}))}for(let f of d.children)h.push(...l(f));return h},c=l(a.targetSnapshot.root);return c.length===0?it(a):ln(Promise.all(c).then(()=>a))}),a2(()=>this.afterPreactivation()),Zr(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,c=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return c?ln(c).pipe(yt(()=>i)):it(i)}),qi(1),yt(a=>{let l=n8(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=i=a=ce(F({},a),{targetRouterState:l}),this.currentNavigation.update(c=>(c.targetRouterState=l,c)),this.events.next(new Ul),s()&&(new fb(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,c=>this.events.next(c),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(c=>(c.abort=Y8,c)),this.lastSuccessfulNavigation.set(un(this.currentNavigation)),this.events.next(new kr(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),$s(P2(o.signal).pipe(Wi(()=>!r&&!i.targetRouterState),gr(()=>{this.cancelNavigationTransition(i,o.signal.reason+"",jn.Aborted)}))),gr({complete:()=>{r=!0}}),$s(this.transitionAbortWithErrorSubject.pipe(gr(a=>{throw a}))),Iy(()=>{o.abort(),r||this.cancelNavigationTransition(i,"",jn.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Jc(a=>{if(r=!0,this.destroyed)return i.resolve(!1),kn;if(R2(a))this.events.next(new Vi(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),o8(a)?this.events.next(new Bl(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new xa(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let c=Fn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(c instanceof jl){let{message:d,cancellationCode:h}=Dg(this.urlSerializer,c);this.events.next(new Vi(i.id,this.urlSerializer.serialize(i.extractedUrl),d,h)),this.events.next(new Bl(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(c){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(c)}}return kn}))}))}cancelNavigationTransition(t,i,r){let o=new Vi(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=un(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Q8(n){return n!==od}var q2=new we("");var K2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(J8),providedIn:"root"})}return n})(),Mg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},J8=(()=>{class n extends Mg{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wb=(()=>{class n{urlSerializer=K(pd);options=K(zl,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=K(Pl);urlHandlingStrategy=K(Pg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new or;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof or?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=I2(null,K(Yt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:()=>K(X8),providedIn:"root"})}return n})(),X8=(()=>{class n extends wb{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof wa?this.updateStateMemento():t instanceof go?this.commitTransition(i):t instanceof Vl?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Ul?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Vi&&!S2(t)?this.restoreHistory(i):t instanceof xa?this.restoreHistory(i,!0):t instanceof kr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=F(F({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=F(F({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xb(n,e){n.events.pipe(Wi(t=>t instanceof kr||t instanceof Vi||t instanceof xa||t instanceof go),yt(t=>t instanceof kr||t instanceof go?0:(t instanceof Vi?t.code===jn.Redirect||t.code===jn.SupersededByNewNavigation:!1)?2:1),Wi(t=>t!==2),qi(1)).subscribe(()=>{e()})}var Y2={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Q2={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},wi=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=K(Op);stateManager=K(wb);options=K(zl,{optional:!0})||{};pendingTasks=K(Tr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=K(W2);urlSerializer=K(pd);location=K(Pl);urlHandlingStrategy=K(Pg);injector=K(Yt);_events=new jt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=K(K2);injectorCleanup=K(q2,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=K(yd,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!K(Rg,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new mn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=un(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Vi&&i.code!==jn.Redirect&&i.code!==jn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof kr)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof Bl){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=F({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Q8(r.source)},s);this.scheduleNavigation(a,od,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}e8(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),od,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=F({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(gi)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return un(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Eb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=r?r.snapshot:this.routerState.snapshot.root;h=E2(f)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return b2(h,t,d,c??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let r=ms(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,od,null,i)}navigate(t,i={skipLocationChange:!1}){return Z8(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(no(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=F({},Y2):i===!1?r=F({},Q2):r=i,ms(t))return ZM(this.currentUrlTree,t,r);let o=this.parseUrl(t);return ZM(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((h,f)=>{a=h,l=f});let d=this.pendingTasks.add();return xb(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Z8(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new me(4008,!1)}var Or=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=$(null);get href(){return un(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new jt;applicationErrorHandler=K(gi);options=K(zl,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(K(new Gp("href"),{optional:!0}));let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area"||!!(typeof customElements=="object"&&customElements.get(l)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof kr&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(ms(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l)?.catch(c=>{this.applicationErrorHandler(c)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:ms(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(he(wi),he(mo),Cu("tabindex"),he(ss),he(ki),he(Nl))};static \u0275dir=vn({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&X("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&Ut("href",r.reactiveHref(),B_)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Gu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Gu],replaceUrl:[2,"replaceUrl","replaceUrl",Gu],routerLink:"routerLink"},features:[ao]})}return n})();var nj=new we("");function Sb(n,...e){return br([{provide:yd,multi:!0,useValue:n},[],{provide:mo,useFactory:ij},{provide:ls,multi:!0,useFactory:rj},e.map(t=>t.\u0275providers)])}function ij(){return K(wi).routerState.root}function rj(){let n=K(Kn);return e=>{let t=n.get(ti);if(e!==t.components[0])return;let i=n.get(wi),r=n.get(oj);n.get(sj)===1&&i.initialNavigation(),n.get(aj,null,{optional:!0})?.setUpPreloading(),n.get(nj,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var oj=new we("",{factory:()=>new jt}),sj=new we("",{factory:()=>1});var aj=new we("");function J2(n,e){let i=!e?.manualCleanup?e?.injector?.get(ei)??K(ei):null,r=lj(e?.equal),o;e?.requireSync?o=$({kind:0},{equal:r}):o=$({kind:1,value:e?.initialValue},{equal:r});let s,a=n.subscribe({next:l=>o.set({kind:1,value:l}),error:l=>{o.set({kind:2,error:l}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&o().kind===0)throw new me(601,!1);return s=i?.onDestroy(a.unsubscribe.bind(a)),ni(()=>{let l=o();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:throw new me(601,!1)}},{equal:e?.equal})}function lj(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var Ib;try{Ib=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Ib=!1}var X2=(()=>{class n{_platformId=K(Zi);isBrowser=this._platformId?fs(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Ib)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Tb(n){return Array.isArray(n)?n:[n]}var Z2=new Set,Ia,tR=(()=>{class n{_platform=K(X2);_nonce=K(wl,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):uj}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&cj(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cj(n,e){if(!Z2.has(n))try{Ia||(Ia=document.createElement("style"),e&&Ia.setAttribute("nonce",e),Ia.setAttribute("type","text/css"),document.head.appendChild(Ia)),Ia.sheet&&(Ia.sheet.insertRule(`@media ${n} {body{ }}`,0),Z2.add(n))}catch(t){console.error(t)}}function uj(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var Cb=(()=>{class n{_mediaMatcher=K(tR);_zone=K(yn);_queries=new Map;_destroySubject=new jt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return eR(Tb(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=eR(Tb(t)).map(s=>this._registerQuery(s).observable),o=Yc(r);return o=Ko(o.pipe(qi(1)),o.pipe(Ty(1),Sy(0))),o.pipe(yt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),o={observable:new st(s=>{let a=l=>this._zone.run(()=>s.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Xc(i),yt(({matches:s})=>({query:t,matches:s})),$s(this._destroySubject)),mql:i};return this._queries.set(t,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function eR(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var Wl=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let r={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return r?r[t-1]:1}getDefenseBonus(e,t){let i=0,r=[];(e.turnsStationary??0)>=3&&(i+=1,r.push("Shield +1"));let o=t.filter(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1);return o.length&&(i+=o.length,r.push(`Support +${o.length}`)),{bonus:i,tags:r}}getAttackLuckModifier(e){let t=Math.random(),r={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:r,tag:`CRIT! +${r}`,isCrit:!0}:t>.8?{delta:-r,tag:`MISS! -${r}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}getWallHitAmount(e){return e===1?34:e===2?51:101}applyDamage(e,t){let i=e.armorHp??0,r=Math.max(0,i-t),o=Math.max(0,t-i),s=Math.max(0,e.points-o),{tier:a,level:l}=this.calculateTierAndLevel(s);return ce(F({},e),{armorHp:r,points:s,tier:a,level:l})}calculateHitChance(e,t){let i=t.tier-e.tier,r=e.level??1,o=0;i<=0?o=100:i===1?o=Math.min(100,50+r*15):i===2?o=Math.min(100,25+r*5):o=Math.min(100,1+r*1);let s=e.hasWeapon&&t.tier>e.tier?10:0,a=t.hasArmor?10:0;return Math.max(1,Math.min(100,o+s-a))}isDiagonalBlocked(e,t,i){let r=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(r===0||o===0)return!1;let s=i(e.x,e.y,e.x+r,e.y),a=i(e.x,e.y,e.x,e.y+o),l=i(t.x-r,t.y,t.x,t.y),c=i(t.x,t.y-o,t.x,t.y);return!!(s||a||l||c)}checkWallAlongPath(e,t,i,r){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),l=Math.sign(s),c=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=c;d++){let h={x:e.x+a*(d-1),y:e.y+l*(d-1)},f={x:e.x+a*d,y:e.y+l*d},g=r(h.x,h.y,f.x,f.y);if(g)return g.owner===i?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:h}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Og=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,i){let r=[t,i];for(let o of r){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,i,r){return e.some(o=>o.owner===t&&(o.position.x===i.x&&o.position.y===i.y||o.position.x===r.x&&o.position.y===r.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Fg=class n{entriesSignal=$([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(i=>[...i,{text:e,color:t,type:"other"}])}addCombat(e,t,i){let r=i?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:r,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var fj={RANDOM:{en:"Random",uk:"\u0412\u0438\u043F\u0430\u0434\u043A\u043E\u0432\u0438\u0439"},STRONGEST:{en:"Strongest",uk:"\u041D\u0430\u0439\u0441\u0438\u043B\u044C\u043D\u0456\u0448\u0438\u0439"},WEAKEST:{en:"Weakest",uk:"\u041D\u0430\u0439\u0441\u043B\u0430\u0431\u0448\u0438\u0439"},FIRST:{en:"First",uk:"\u041F\u0435\u0440\u0448\u0438\u0439"},SPEED:{en:"Speed",uk:"\u0428\u0432\u0438\u0434\u043A\u0456\u0441\u0442\u044C"},TARGETING:{en:"Targeting",uk:"\u0422\u0430\u0440\u0433\u0435\u0442\u0438\u043D\u0433"},SOCIAL_FEEDBACK:{en:"Social & Feedback",uk:"\u0421\u043E\u0446\u0456\u0430\u043B\u044C\u043D\u0456 \u043C\u0435\u0440\u0435\u0436\u0456 \u0442\u0430 \u0437\u0432\u043E\u0440\u043E\u0442\u043D\u0438\u0439 \u0437\u0432'\u044F\u0437\u043E\u043A"},MONOBANK_JAR:{en:"Monobank Jar",uk:"\u0411\u0430\u043D\u043A\u0430 Monobank"},SUPPORT_COMMUNITY:{en:"Support & Community",uk:"\u041F\u0456\u0434\u0442\u0440\u0438\u043C\u043A\u0430 \u0442\u0430 \u0441\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0430"},COPY_LINK:{en:"Copy Link",uk:"\u041A\u043E\u043F\u0456\u044E\u0432\u0430\u0442\u0438 \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F"},OPEN_LINK:{en:"Open Link",uk:"\u0412\u0456\u0434\u043A\u0440\u0438\u0442\u0438 \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F"},THANK_SUPPORTING:{en:"Thank you for supporting the project!",uk:"\u0414\u044F\u043A\u0443\u044E \u0437\u0430 \u043F\u0456\u0434\u0442\u0440\u0438\u043C\u043A\u0443 \u043F\u0440\u043E\u0454\u043A\u0442\u0443!"},MASTERIES:{en:"Masteries",uk:"\u0412\u043C\u0456\u043D\u043D\u044F"},GOLD_MASTERY:{en:"Gold Mastery",uk:"\u0417\u043E\u043B\u043E\u0442\u0430 \u043C\u0430\u0439\u0441\u0442\u0435\u0440\u043D\u0456\u0441\u0442\u044C"},GOLD_MASTERY_INFO:{en:"Lv 1-7: +5% gold per kill. Lv 8-14: +10% per kill and extra starting gold. Lv 15-20: higher gold and bonus after each wave.",uk:"\u0420\u0456\u0432\u043D\u0456 1-7: +5% \u0437\u043E\u043B\u043E\u0442\u0430 \u0437\u0430 \u0432\u0431\u0438\u0432\u0441\u0442\u0432\u043E. \u0420\u0456\u0432\u043D\u0456 8-14: +10% \u0437\u0430 \u0432\u0431\u0438\u0432\u0441\u0442\u0432\u043E \u0442\u0430 \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0435 \u043F\u043E\u0447\u0430\u0442\u043A\u043E\u0432\u0435 \u0437\u043E\u043B\u043E\u0442\u043E. \u0420\u0456\u0432\u043D\u0456 15-20: \u0431\u0456\u043B\u044C\u0448\u0435 \u0437\u043E\u043B\u043E\u0442\u0430 \u0442\u0430 \u0431\u043E\u043D\u0443\u0441 \u043F\u0456\u0441\u043B\u044F \u043A\u043E\u0436\u043D\u043E\u0457 \u0445\u0432\u0438\u043B\u0456."},BACK_TO_DEFENSE:{en:"Back to Defense",uk:"\u041D\u0430\u0437\u0430\u0434 \u0434\u043E \u0437\u0430\u0445\u0438\u0441\u0442\u0443"},TOTAL_XP:{en:"XP",uk:"\u0414\u043E\u0441\u0432\u0456\u0434"},SPENT:{en:"Spent",uk:"\u0412\u0438\u0442\u0440\u0430\u0447\u0435\u043D\u043E"},AVAILABLE:{en:"Available",uk:"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E"},LOG_IN_MASTERY_MSG:{en:"Log in to earn and spend Mastery XP.",uk:"\u0423\u0432\u0456\u0439\u0434\u0456\u0442\u044C, \u0449\u043E\u0431 \u0437\u0430\u0440\u043E\u0431\u043B\u044F\u0442\u0438 \u0442\u0430 \u0432\u0438\u0442\u0440\u0430\u0447\u0430\u0442\u0438 \u0434\u043E\u0441\u0432\u0456\u0434 \u043C\u0430\u0439\u0441\u0442\u0435\u0440\u043D\u043E\u0441\u0442\u0456."},NEED_LOG_IN:{en:"You need to be logged in to earn XP and unlock Masteries.",uk:"\u0412\u0430\u043C \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E \u0443\u0432\u0456\u0439\u0442\u0438, \u0449\u043E\u0431 \u0437\u0430\u0440\u043E\u0431\u043B\u044F\u0442\u0438 \u0434\u043E\u0441\u0432\u0456\u0434 \u0442\u0430 \u0432\u0456\u0434\u043A\u0440\u0438\u0432\u0430\u0442\u0438 \u0412\u043C\u0456\u043D\u043D\u044F."},LOGIN_GOOGLE:{en:"Login with Google",uk:"\u0423\u0432\u0456\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Google"},MASTERIES_SUBTITLE:{en:"Spend points to permanently improve each tower tier.",uk:"\u0412\u0438\u0442\u0440\u0430\u0447\u0430\u0439\u0442\u0435 \u043E\u0447\u043A\u0438, \u0449\u043E\u0431 \u043D\u0430\u0437\u0430\u0432\u0436\u0434\u0438 \u043F\u043E\u043A\u0440\u0430\u0449\u0438\u0442\u0438 \u043A\u043E\u0436\u0435\u043D \u0442\u0438\u0440 \u0432\u0435\u0436."},DAMAGE:{en:"Damage",uk:"\u0428\u043A\u043E\u0434\u0430"},RANGE:{en:"Range",uk:"\u0414\u0430\u043B\u044C\u043D\u0456\u0441\u0442\u044C"},PER_LEVEL:{en:"per level",uk:"\u0437\u0430 \u0440\u0456\u0432\u0435\u043D\u044C"},REQUIRES_5_POINTS:{en:"Requires 15 points in tier.",uk:"\u041F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 15 \u043E\u0447\u043E\u043A \u0432 \u0442\u0438\u0440\u0456"},SAVE_CHANGES:{en:"Save Changes",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u043C\u0456\u043D\u0438"},SAVING:{en:"Saving...",uk:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043D\u044F..."},SAVED:{en:"Saved",uk:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E"},COST:{en:"Cost",uk:"\u0412\u0430\u0440\u0442\u0456\u0441\u0442\u044C"},MAXED:{en:"MAXED",uk:"\u041C\u0410\u041A\u0421"},LOCAL_STORAGE_MSG:{en:"Changes are stored locally until you save.",uk:"\u0417\u043C\u0456\u043D\u0438 \u0437\u0431\u0435\u0440\u0456\u0433\u0430\u044E\u0442\u044C\u0441\u044F \u043B\u043E\u043A\u0430\u043B\u044C\u043D\u043E, \u043F\u043E\u043A\u0438 \u0432\u0438 \u0457\u0445 \u043D\u0435 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u0442\u0435."},T1_NAME:{en:"Tier 1 \u2013 Frost",uk:"\u0422\u0438\u0440 1 \u2013 \u041C\u043E\u0440\u043E\u0437"},T1_GOLDEN_TITLE:{en:"Frost Aura",uk:"\u0410\u0443\u0440\u0430 \u043C\u043E\u0440\u043E\u0437\u0443"},T1_GOLDEN_DESC:{en:"Slow enemies by an extra 10% and increase aura radius.",uk:"\u0423\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u043D\u0430 \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 10% \u0442\u0430 \u0437\u0431\u0456\u043B\u044C\u0448\u0443\u0454 \u0440\u0430\u0434\u0456\u0443\u0441 \u0430\u0443\u0440\u0438."},T2_NAME:{en:"Tier 2 \u2013 Precision",uk:"\u0422\u0438\u0440 2 \u2013 \u0422\u043E\u0447\u043D\u0456\u0441\u0442\u044C"},T2_GOLDEN_TITLE:{en:"Critical Focus",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0435 \u0444\u043E\u043A\u0443\u0441\u0443\u0432\u0430\u043D\u043D\u044F"},T2_GOLDEN_DESC:{en:"Boosts Ricochet: higher trigger chance and up to 150%+ damage.",uk:"\u041F\u0456\u0434\u0441\u0438\u043B\u044E\u0454 \u0440\u0438\u043A\u043E\u0448\u0435\u0442: \u0432\u0438\u0449\u0438\u0439 \u0448\u0430\u043D\u0441 \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0442\u0430 \u0434\u043E 150%+ \u0448\u043A\u043E\u0434\u0438."},T3_NAME:{en:"Tier 3 \u2013 Impact",uk:"\u0422\u0438\u0440 3 \u2013 \u0423\u0434\u0430\u0440"},T3_GOLDEN_TITLE:{en:"Concussive Blasts",uk:"\u041A\u043E\u043D\u0442\u0443\u0437\u0456\u0439\u043D\u0456 \u0432\u0438\u0431\u0443\u0445\u0438"},T3_GOLDEN_DESC:{en:"Concussive blasts: stronger stun chance and duration on shattered foes.",uk:"\u041A\u043E\u043D\u0442\u0443\u0437\u0456\u0439\u043D\u0456 \u0432\u0438\u0431\u0443\u0445\u0438: \u0432\u0438\u0449\u0438\u0439 \u0448\u0430\u043D\u0441 \u0456 \u0442\u0440\u0438\u0432\u0430\u043B\u0456\u0441\u0442\u044C \u043E\u0433\u043B\u0443\u0448\u0435\u043D\u043D\u044F \u0440\u043E\u0437\u0431\u0438\u0442\u0438\u0445 \u0432\u043E\u0440\u043E\u0433\u0456\u0432."},T4_NAME:{en:"Tier 4 \u2013 Storm",uk:"\u0422\u0438\u0440 4 \u2013 \u0428\u0442\u043E\u0440\u043C"},T4_GOLDEN_TITLE:{en:"Chain Lightning",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430"},T4_GOLDEN_DESC:{en:"Chance to chain attack and strike an additional target.",uk:"\u0428\u0430\u043D\u0441 \u043D\u0430 \u043B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0443 \u0430\u0442\u0430\u043A\u0443 \u043F\u043E \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456\u0439 \u0446\u0456\u043B\u0456."},T5_NAME:{en:"Tier 5 \u2013 Inferno",uk:"\u0422\u0438\u0440 5 \u2013 \u0406\u043D\u0444\u0435\u0440\u043D\u043E"},T5_GOLDEN_TITLE:{en:"Chain Reaction",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0440\u0435\u0430\u043A\u0446\u0456\u044F"},T5_GOLDEN_DESC:{en:"Kills from Inferno or Napalm cause explosions for 50% of max HP.",uk:"\u0423\u0431\u0438\u0432\u0441\u0442\u0432\u0430 \u0432\u0456\u0434 \u0406\u043D\u0444\u0435\u0440\u043D\u043E \u0447\u0438 \u043D\u0430\u043F\u0430\u043B\u043C\u0443 \u0441\u043F\u0440\u0438\u0447\u0438\u043D\u044F\u044E\u0442\u044C \u0432\u0438\u0431\u0443\u0445\u0438 \u043D\u0430 50% \u0432\u0456\u0434 \u043C\u0430\u043A\u0441. HP."},T6_NAME:{en:"Tier 6 \u2013 Prism",uk:"\u0422\u0438\u0440 6 \u2013 \u041F\u0440\u0438\u0437\u043C\u0430"},T6_GOLDEN_TITLE:{en:"Spectrum Break",uk:"\u0421\u043F\u0435\u043A\u0442\u0440\u0430\u043B\u044C\u043D\u0438\u0439 \u0440\u043E\u0437\u043B\u043E\u043C"},T6_GOLDEN_DESC:{en:"Increases ramp-up cap to +300% and adds +15% taken damage.",uk:"\u041F\u0456\u0434\u0432\u0438\u0449\u0443\u0454 \u043B\u0456\u043C\u0456\u0442 \u043D\u0430\u0440\u043E\u0449\u0435\u043D\u043D\u044F \u0434\u043E +300% \u0442\u0430 \u0434\u043E\u0434\u0430\u0454 +15% \u043E\u0442\u0440\u0438\u043C\u0443\u0432\u0430\u043D\u043E\u0457 \u0448\u043A\u043E\u0434\u0438."},T7_NAME:{en:"Tier 7 \u2013 Venom",uk:"\u0422\u0438\u0440 7 \u2013 \u041E\u0442\u0440\u0443\u0442\u0430"},T7_GOLDEN_TITLE:{en:"Septic Shock",uk:"\u0421\u0435\u043F\u0442\u0438\u0447\u043D\u0438\u0439 \u0448\u043E\u043A"},T7_GOLDEN_DESC:{en:"Neurotoxin causes stronger slow and heavier stacking poison over time.",uk:"\u041D\u0435\u0439\u0440\u043E\u0442\u043E\u043A\u0441\u0438\u043D \u0441\u0438\u043B\u044C\u043D\u0456\u0448\u0435 \u0441\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0442\u0430 \u043F\u043E\u0441\u0438\u043B\u044E\u0454 \u043D\u0430\u043A\u043E\u043F\u0438\u0447\u0435\u043D\u043D\u044F \u043E\u0442\u0440\u0443\u0442\u0438 \u0437 \u0447\u0430\u0441\u043E\u043C."},FINAL_STRIKE_INFO:{en:"Execute: Crit on enemies below 50% HP. Bosses take even more damage.",uk:"\u0415\u043A\u0437\u0435\u043A\u0443\u0446\u0456\u044F: \u043A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0443\u0434\u0430\u0440 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0430\u0445 \u0437 HP \u043D\u0438\u0436\u0447\u0435 50%. \u0411\u043E\u0441\u0438 \u043E\u0442\u0440\u0438\u043C\u0443\u044E\u0442\u044C \u0449\u0435 \u0431\u0456\u043B\u044C\u0448\u0435 \u0448\u043A\u043E\u0434\u0438."},FINAL_STRIKE:{en:"Final Strike",uk:"\u041E\u0441\u0442\u0430\u043D\u043D\u0456\u0439 \u0443\u0434\u0430\u0440"},SHATTER_INFO:{en:"Each hit adds 1 stack (Max 5). Damage is multiplied by (1 + stacks * 0.20). (Stack up to +100% dmg).",uk:"\u041A\u043E\u0436\u0435\u043D \u0443\u0434\u0430\u0440 \u0434\u043E\u0434\u0430\u0454 1 \u0437\u0430\u0440\u044F\u0434 (\u043C\u0430\u043A\u0441\u0438\u043C\u0443\u043C 5). \u0428\u043A\u043E\u0434\u0430 \u043C\u043D\u043E\u0436\u0438\u0442\u044C\u0441\u044F \u043D\u0430 (1 + \u0437\u0430\u0440\u044F\u0434\u0438 * 0.20). (\u041D\u0430\u043A\u043E\u043F\u0438\u0447\u0443\u0454\u0442\u044C\u0441\u044F \u0434\u043E +100% \u0448\u043A\u043E\u0434\u0438)."},SHATTER:{en:"Shatter",uk:"\u0420\u043E\u0437\u043A\u043E\u043B\u043E\u0442\u0438"},CHAIN_LIGHTNING_INFO:{en:"Chance for shots to ricochet and deal up to 150% damage to nearby enemies.",uk:"\u0428\u0430\u043D\u0441 \u0440\u0438\u043A\u043E\u0448\u0435\u0442\u0443 \u043F\u043E\u0441\u0442\u0440\u0456\u043B\u0443 \u0442\u0430 \u043D\u0430\u043D\u0435\u0441\u0435\u043D\u043D\u044F \u0434\u043E 150% \u0448\u043A\u043E\u0434\u0438 \u0441\u0443\u0441\u0456\u0434\u043D\u0456\u043C \u0432\u043E\u0440\u043E\u0433\u0430\u043C."},CHAIN_LIGHTNING:{en:"Chain Lightning",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430"},FROST_AURA_INFO:{en:"Apply 30% slow to enemies in range.",uk:"\u0423\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u0443 \u0440\u0430\u0434\u0456\u0443\u0441\u0456 \u0434\u0456\u0457 \u043D\u0430 30%."},FROST_AURA:{en:"Frost Aura",uk:"\u041C\u043E\u0440\u043E\u0437\u043D\u0430 \u0430\u0443\u0440\u0430"},REFRACTION_BEAM:{en:"Refraction Beam",uk:"\u0417\u0430\u043B\u043E\u043C\u043B\u0435\u043D\u043D\u044F \u043F\u0440\u043E\u043C\u0435\u043D\u044F"},REFRACTION_BEAM_INFO:{en:"Allows attacking up to 3 targets simultaneously. Each beam benefits from the laser ramp-up bonus.",uk:"\u0414\u043E\u0437\u0432\u043E\u043B\u044F\u0454 \u0430\u0442\u0430\u043A\u0443\u0432\u0430\u0442\u0438 \u0434\u043E 3 \u0446\u0456\u043B\u0435\u0439 \u043E\u0434\u043D\u043E\u0447\u0430\u0441\u043D\u043E. \u041A\u043E\u0436\u043D\u0430 \u0446\u0456\u043B\u044C \u043E\u0442\u0440\u0438\u043C\u0443\u0454 \u0431\u043E\u043D\u0443\u0441 \u0432\u0456\u0434 \u043D\u0430\u0440\u043E\u0441\u0442\u0430\u043D\u043D\u044F \u043F\u043E\u0442\u0443\u0436\u043D\u043E\u0441\u0442\u0456 \u043B\u0430\u0437\u0435\u0440\u0430."},NAPALM_STRIKE:{en:"\u041D\u0430\u043F\u0430\u043B\u043C\u043E\u0432\u0438\u0439 \u0443\u0434\u0430\u0440",uk:"\u041D\u0430\u043F\u0430\u043B\u043C\u043E\u0432\u0438\u0439 \u0443\u0434\u0430\u0440"},NAPALM_STRIKE_INFO:{en:"Leaves a fire zone for 4s, dealing 50% tower damage per second to all enemies in the blast radius.",uk:"\u0417\u0430\u043B\u0438\u0448\u0430\u0454 \u0432\u043E\u0433\u043D\u044F\u043D\u0443 \u0437\u043E\u043D\u0443 \u043D\u0430 4 \u0441\u0435\u043A., \u0449\u043E \u043D\u0430\u043D\u043E\u0441\u0438\u0442\u044C 50% \u0443\u0440\u043E\u043D\u0443 \u0449\u043E\u0441\u0435\u043A\u0443\u043D\u0434\u0438 \u0432\u0441\u0456\u043C \u0432\u043E\u0440\u043E\u0433\u0430\u043C \u0443 \u0440\u0430\u0434\u0456\u0443\u0441\u0456 \u0432\u0438\u0431\u0443\u0445\u0443."},NEUROTOXIN:{en:"Neurotoxin",uk:"\u041D\u0435\u0439\u0440\u043E\u0442\u043E\u043A\u0441\u0438\u043D"},NEUROTOXIN_INFO:{en:"Poison now slows enemies by 20%.",uk:"\u041E\u0442\u0440\u0443\u0442\u0430 \u0442\u0435\u043F\u0435\u0440 \u0443\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u043D\u0430 20%."},BUY_ABILITY:{en:"Buy Ability",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0434\u0456\u0431\u043D\u0456\u0441\u0442\u044C"},ABILITY_ACTIVE:{en:"Ability Active",uk:"\u0410\u043A\u0442\u0438\u0432\u043D\u0430 \u0437\u0434\u0430\u0442\u043D\u0456\u0441\u0442\u044C"},TRY_AGAIN:{en:"TRY AGAIN",uk:"\u0421\u041F\u0420\u041E\u0411\u0423\u0419\u0422\u0415 \u0417\u041D\u041E\u0412\u0423"},WAVES:{en:"waves",uk:"\u0445\u0432\u0438\u043B\u044C"},YOU_SURVIVED:{en:"You survived",uk:"\u0422\u0438 \u0432\u0438\u0436\u0438\u0432"},GAME_OVER:{en:"GAME OVER",uk:"\u0413\u0420\u0410 \u0417\u0410\u041A\u0406\u041D\u0427\u0415\u041D\u0410"},TO_PLACE_DEFENDER:{en:"to place a defender",uk:"\u0449\u043E\u0431 \u0440\u043E\u0437\u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},SELECT_BUILD_TILE:{en:"Select a buildable tile",uk:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u0431\u0443\u0434\u0456\u0432\u043D\u0438\u0446\u0442\u0432\u0430,"},SELL:{en:"SELL",uk:"\u041F\u0420\u041E\u0414\u0410\u0422\u0418"},MAX_LEVEL:{en:"MAX LEVEL",uk:"\u041C\u0410\u041A\u0421 \u0420\u0406\u0412\u0415\u041D\u042C"},UPGRADE:{en:"UPGRADE",uk:"\u041E\u041D\u041E\u0412\u041B\u0415\u041D\u041D\u042F"},TIER:{en:"Tier",uk:"\u0420\u0430\u043D\u0433"},LEVEL:{en:"Level",uk:"\u0420\u0456\u0432\u0435\u043D\u044C"},DEFENDER_INFO:{en:"Defender Info",uk:"\u0406\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044F \u043F\u0440\u043E \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},BUY_DEFENDER:{en:"Buy Defender",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},START_WAVE:{en:"START WAVE",uk:"\u041F\u041E\u0427\u0410\u0422\u041E\u041A \u0425\u0412\u0418\u041B\u0406"},WAVE_IN_PROGRESS:{en:"WAVE IN PROGRESS",uk:"\u0425\u0412\u0418\u041B\u042F \u0412 \u041F\u0420\u041E\u0426\u0415\u0421\u0406"},RESTART_GAME:{en:"RESTART GAME",uk:"\u041F\u0415\u0420\u0415\u0417\u0410\u041F\u0423\u0421\u041A \u0413\u0420\u0418"},WAVE:{en:"WAVE",uk:"\u0425\u0412\u0418\u041B\u042F"},LIVES:{en:"LIVES",uk:"\u0416\u0418\u0422\u0422\u042F"},MONEY:{en:"MONEY",uk:"\u0413\u0420\u041E\u0428\u0406"},EXIT_GAME:{en:"EXIT GAME",uk:"\u0412\u0418\u0425\u0406\u0414 \u0417 \u0413\u0420\u0418"},TOWER_DEFFENCE_DESCRIPTION:{en:"A new game is already in development. Stay tuned for a completely different strategy experience. Coming soon to Game Center.",uk:"\u041D\u043E\u0432\u0430 \u0433\u0440\u0430 \u0432\u0436\u0435 \u0440\u043E\u0437\u0440\u043E\u0431\u043B\u044F\u0454\u0442\u044C\u0441\u044F. \u0421\u043B\u0456\u0434\u043A\u0443\u0439\u0442\u0435 \u0437\u0430 \u043E\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044F\u043C\u0438, \u0449\u043E\u0431 \u0434\u0456\u0437\u043D\u0430\u0442\u0438\u0441\u044F \u043F\u0440\u043E \u0437\u043E\u0432\u0441\u0456\u043C \u0456\u043D\u0448\u0438\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u0434\u043E\u0441\u0432\u0456\u0434. \u0421\u043A\u043E\u0440\u043E \u0432 \u0456\u0433\u0440\u043E\u0432\u043E\u043C\u0443 \u0446\u0435\u043D\u0442\u0440\u0456."},SHAPE_TACTIC_DESCRIPTION:{en:"Strategic turn-based combat with AI and merging mechanics. Build your base, manage resources, and conquer the battlefield.",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u043F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0438\u0439 \u0431\u0456\u0439 \u0437\u0456 \u0448\u0442\u0443\u0447\u043D\u0438\u043C \u0456\u043D\u0442\u0435\u043B\u0435\u043A\u0442\u043E\u043C \u0442\u0430 \u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0438\u043C\u0438 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0430\u043C\u0438. \u041F\u043E\u0431\u0443\u0434\u0443\u0439\u0442\u0435 \u0441\u0432\u043E\u044E \u0431\u0430\u0437\u0443, \u043A\u0435\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043C\u0438 \u0442\u0430 \u0437\u0430\u0432\u043E\u0439\u043E\u0432\u0443\u0439\u0442\u0435 \u043F\u043E\u043B\u0435 \u0431\u043E\u044E."},IRON_CYCLE:{en:"Iron Cycle",uk:"\u0426\u0438\u043A\u043B \u0417\u0430\u043B\u0456\u0437\u0430"},NEW_DESIGN_UNIT:{en:"New Evolution",uk:"\u041D\u043E\u0432\u0430 \u0435\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},NEW_UNIT_EVOLUTION:{en:"New Unit Evolution",uk:"\u041D\u043E\u0432\u0430 \u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},T4_4_TILES:{en:"T4: 4 tiles",uk:"T4: 4 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},TURN_3:{en:"Turn 3",uk:"\u0425\u0456\u0434 3"},TURN_4:{en:"Turn 4",uk:"\u0425\u0456\u0434 4"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0414\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},PLUS_2_IRON_PER_TURN:{en:"+2 Iron/turn",uk:"+2 \u0417\u0430\u043B\u0456\u0437\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function iR(n,e){let t=fj[n];return t?t[e]??t.en:n}var Et=class n{difficultySignal=$("normal");mapSizeSignal=$(10);langSignal=$("uk");customModeSignal=$(!1);version="v.2.5.1";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),i=e%2===0;return t==="baby"?i?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return iR(e,this.langSignal())}customMode(){return this.customModeSignal()}setCustomMode(e){this.customModeSignal.set(e),this.persistSettings()}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let i=["baby","normal","hard","nightmare"],r=[10,20,30],o=["en","uk"],s=t.difficulty&&i.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&r.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),l=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(l),this.customModeSignal.set(!!t.customMode)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal(),customMode:this.customModeSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Lg=class n{generateForests(e,t,i){let r=e*e,o=Math.max(1,Math.floor(r*.1)),s=[],a=(l,c)=>{let d=Math.max(Math.abs(l-t.x),Math.abs(c-t.y)),h=Math.max(Math.abs(l-i.x),Math.abs(c-i.y));return d<=3||h<=3};for(;s.length<o;){let l=Math.floor(Math.random()*e),c=Math.floor(Math.random()*e);a(l,c)||s.some(d=>d.x===l&&d.y===c)||s.push({x:l,y:c})}return s}generateMines(e,t,i,r){let o=new Set(r.map(c=>`${c.x},${c.y}`)),s=e===10?4:Math.max(1,Math.floor(e*e*.04)),a=[],l=(c,d)=>{let h=Math.max(Math.abs(c-t.x),Math.abs(d-t.y)),f=Math.max(Math.abs(c-i.x),Math.abs(d-i.y));return h<=3||f<=3};for(;a.length<s;){let c=Math.floor(Math.random()*e),d=Math.floor(Math.random()*e);if(l(c,d))continue;let h=`${c},${d}`;o.has(h)||a.some(f=>f.x===c&&f.y===d)||a.push({x:c,y:d})}return a}computeVisibility(e,t,i,r,o){let s={player:new Set,ai:new Set},a=(d,h)=>d>=0&&d<e&&h>=0&&h<e,l=(d,h,f)=>{a(h,f)&&d.add(`${h},${f}`)},c=(d,h,f)=>{for(let g=-f;g<=f;g++)for(let x=-f;x<=f;x++){let S=h.x+g,R=h.y+x;Math.max(Math.abs(g),Math.abs(x))<=f&&l(d,S,R)}};if(o){for(let d=0;d<e;d++)for(let h=0;h<e;h++)s.player.add(`${d},${h}`),s.ai.add(`${d},${h}`);return s}c(s.player,i,3),c(s.ai,r,3);for(let d of t){let h=d.owner==="player"?s.player:s.ai;c(h,d.position,2)}return s}mergeExplored(e,t){let i=new Set(e);return t.forEach(r=>i.add(r)),i}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vg=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let i of t)if(e>=i)return i;return 0}computeWoodGain(e,t){let i=e.filter(r=>r.owner===t).filter(r=>r.position&&r.position.x!==void 0&&r.position.y!==void 0).length;return i>0?i*2:0}applyMonopolyTick(e,t,i){let r=t.length;if(r===0)return{next:{player:0,ai:0}};let o=c=>i.filter(d=>d.owner===c&&t.some(h=>h.x===d.position.x&&h.y===d.position.y)).length,s=o("player"),a=o("ai"),l={player:e.player,ai:e.ai};if(s===r){if(l.player=e.player+1,l.ai=0,l.player>=10)return{next:l,winner:"player"}}else if(a===r){if(l.ai=e.ai+1,l.player=0,l.ai>=10)return{next:l,winner:"ai"}}else l.player=0,l.ai=0;return{next:l}}computeAiReserveDump(e,t,i,r){let o=i,s=[];for(let l=-2;l<=2;l++)for(let c=-2;c<=2;c++){if(l===0&&c===0)continue;let d=t.x+l,h=t.y+c;d<0||d>=e||h<0||h>=e||Math.max(Math.abs(l),Math.abs(c))>2||r(d,h)||s.push({x:d,y:h})}let a=[];for(;o>0&&s.length>0;){let l=this.getHighestAffordableCost(o);if(l<=0)break;let c=this.calculateTierAndLevel(l),d=s.shift();a.push({id:crypto.randomUUID(),position:F({},d),level:c.level,tier:c.tier,points:l,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=l}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ug=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(b=>b.owner==="ai"&&!b.hasActed);t=t.filter(b=>!(b.tier<=2&&e.isForest(b.position.x,b.position.y)&&e.isAnchoredGatherer(b.id)));let i=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;i&&(t=t.filter(b=>b.id===i));let r=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:r==="rage"?5e4:r==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),l=e.forestsSignal(),d=l.filter(b=>!e.getUnitAt(b.x,b.y)).filter(b=>e.isVisibleToAi(b.x,b.y)),h=l.filter(b=>!e.isVisibleToAi(b.x,b.y)),f=e.unitsSignal().filter(b=>b.owner==="ai"&&e.isForest(b.position.x,b.position.y)).length,g=e.unitsSignal().filter(b=>b.owner==="ai").length,x=[1,2,3].some(b=>e.unitsSignal().filter(ue=>ue.owner==="ai"&&ue.tier===b&&!e.isForest(ue.position.x,ue.position.y)).length>=5),S=e.unitsSignal().filter(b=>b.owner==="player"),R=S.some(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3),L=S.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=4),q=L.length>0,_e=L.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=2).length>0,xe=S.some(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=5),Ie=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,O=e.unitsSignal().filter(b=>b.owner==="ai"),T=O.filter(b=>b.tier===3&&!e.isForest(b.position.x,b.position.y)).length,k=O.filter(b=>b.tier===4&&!e.isForest(b.position.x,b.position.y)).length,I=T+k>=5,w=I?"full_rush":q?"defense":Ie?"expansion":"none";if(w!==this.lastPhase){try{console.log(w==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":w==="defense"?"AI Phase: Base Defense Activated":w==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=w}I&&t.sort((b,ue)=>{let qe=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ke=Math.abs(ue.position.x-a.x)+Math.abs(ue.position.y-a.y);return qe-Ke});let N=typeof e.aggressionMode=="function"?!!e.aggressionMode():S.filter(b=>e.isForest(b.position.x,b.position.y)).length*2>=t.filter(b=>e.isForest(b.position.x,b.position.y)).length*2,M=l.length>0?l.every(b=>{let ue=e.getUnitAt(b.x,b.y);return!!ue&&ue.owner==="ai"}):!0,ae=l.length>0?l.every(b=>!!e.getUnitAt(b.x,b.y)):!1,be=l.filter(b=>{let ue=e.getUnitAt(b.x,b.y);return!!ue&&ue.owner==="player"}),de=null,Tt=t.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3).length,Xt={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Pe=L.length>0?L.reduce((b,ue)=>{let qe=Math.max(Math.abs(ue.position.x-s.x),Math.abs(ue.position.y-s.y)),Ke=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y));return qe<Ke?ue:b},L[0]):null,Wt=t.length>0?t.reduce((b,ue)=>this.combat.calculateTotalPoints(ue)>this.combat.calculateTotalPoints(b)?ue:b,t[0]):null,lt=[];if(Pe){let b=Pe.position.x,ue=Pe.position.y,qe=Math.sign(s.x-b),Ke=Math.sign(s.y-ue),le=0,wt=Math.max(10,e.gridSize*2);for(;b!==s.x||ue!==s.y;){if(le++,le>wt){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(b+=qe,ue+=Ke,!e.inBounds(b,ue)||b===s.x&&ue===s.y)break;lt.push({x:b,y:ue})}}q&&Wt&&Pe&&(this.goals.set(Wt.id,{x:Pe.position.x,y:Pe.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(Wt.id,e.turnSignal()+3));let oe=new Map(e.aiUnitTimeNearBase()),se=new Map(e.unitStutterBanSignal?.()??new Map),Se=new Map;for(let[b,ue]of this.goals.entries())if(ue&&e.isForest(ue.x,ue.y)){let qe=`${ue.x},${ue.y}`;Se.set(qe,(Se.get(qe)||0)+1)}for(let b of t){let ue=e.calculateValidMoves(b),qe=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3,Ke=oe.get(b.id)||0,le=this.goals.get(b.id)||null,wt=le!==null,Ti=wt?(()=>{let z=e.getUnitAt(le.x,le.y);return!!(z&&z.owner==="ai"&&this.combat.calculateTotalPoints(z)>=this.combat.calculateTotalPoints(b))})():!1,ai=(!wt||Ti)&&(!e.isForest(b.position.x,b.position.y)||xe||b.tier>=3),Ns=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(ai){if(Ns)le={x:a.x,y:a.y};else if(e.isForest(b.position.x,b.position.y)){let z=S.filter(U=>e.isForest(U.position.x,U.position.y));if(N&&z.length>0){let U=z.reduce((Z,ne)=>{let Me=Math.abs(b.position.x-ne.position.x)+Math.abs(b.position.y-ne.position.y),Ve=Math.abs(b.position.x-Z.position.x)+Math.abs(b.position.y-Z.position.y);return Me<Ve?ne:Z},z[0]);le={x:U.position.x,y:U.position.y}}else{let U=S.length===0?null:[...S].sort((ne,Me)=>{let Ve=Math.abs(b.position.x-ne.position.x)+Math.abs(b.position.y-ne.position.y),Ze=Math.abs(b.position.x-Me.position.x)+Math.abs(b.position.y-Me.position.y);return Ve-Ze})[0];U?le={x:U.position.x,y:U.position.y}:d.length>0?le=d.reduce((Z,ne)=>Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)<Math.abs(b.position.x-Z.x)+Math.abs(b.position.y-Z.y)?ne:Z,d[0]):h.length>0?le=h.reduce((Z,ne)=>Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)<Math.abs(b.position.x-Z.x)+Math.abs(b.position.y-Z.y)?ne:Z,h[0]):le={x:0,y:0}}}else{let z=S.filter(U=>e.isForest(U.position.x,U.position.y)).map(U=>({x:U.position.x,y:U.position.y}));if(z.length>0)le=z.reduce((Z,ne)=>{let Me=Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y),Ve=Math.abs(b.position.x-Z.x)+Math.abs(b.position.y-Z.y);return Me<Ve?ne:Z},z[0]);else if(d.length>0){let U=Math.min(...d.map(ne=>Se.get(`${ne.x},${ne.y}`)||0)),Z=d.filter(ne=>(Se.get(`${ne.x},${ne.y}`)||0)===U);le=Z.reduce((ne,Me)=>Math.abs(b.position.x-Me.x)+Math.abs(b.position.y-Me.y)<Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)?Me:ne,Z[0])}else if(h.length>0){let U=Math.min(...h.map(ne=>Se.get(`${ne.x},${ne.y}`)||0)),Z=h.filter(ne=>(Se.get(`${ne.x},${ne.y}`)||0)===U);le=Z.reduce((ne,Me)=>Math.abs(b.position.x-Me.x)+Math.abs(b.position.y-Me.y)<Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)?Me:ne,Z[0])}else{let U=S.length===0?null:[...S].sort((ne,Me)=>{let Ve=Math.abs(b.position.x-ne.position.x)+Math.abs(b.position.y-ne.position.y),Ze=Math.abs(b.position.x-Me.position.x)+Math.abs(b.position.y-Me.position.y);return Ve-Ze})[0];le=U?{x:U.position.x,y:U.position.y}:{x:0,y:0}}}this.goals.set(b.id,le)}Tt>3&&Ke>=5&&(le=Xt);let $n=e.isForest(b.position.x,b.position.y),Ac=$n&&(b.forestOccupationTurns??0)>0&&!(b.productionActive??!1),Mc=e.unitsSignal().some(z=>z.owner==="ai"&&z.id!==b.id&&z.tier<=2&&Math.max(Math.abs(z.position.x-b.position.x),Math.abs(z.position.y-b.position.y))<=2);if(Ac&&!xe&&b.tier<3){this.goals.set(b.id,{x:b.position.x,y:b.position.y});continue}if(b.tier>=3){let z=l,U=z.length?z.reduce((ne,Me)=>{let Ve=Math.abs(b.position.x-Me.x)+Math.abs(b.position.y-Me.y),Ze=Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y);return Ve<Ze?Me:ne},z[0]):null;if((b.forestOccupationTurns??0)===0&&!$n&&U&&(le={x:U.x,y:U.y},this.goals.set(b.id,le)),$n&&Mc){this.goals.set(b.id,{x:a.x,y:a.y});let ne=[{x:b.position.x+1,y:b.position.y},{x:b.position.x-1,y:b.position.y},{x:b.position.x,y:b.position.y+1},{x:b.position.x,y:b.position.y-1}].filter(Ve=>e.inBounds(Ve.x,Ve.y));if(ne.filter(Ve=>!!e.getWallBetween(b.position.x,b.position.y,Ve.x,Ve.y)).length===ne.length){let Ve=ne.reduce((Ze,dt)=>{let xt=Math.abs(dt.x-a.x)+Math.abs(dt.y-a.y),mt=Math.abs(Ze.x-a.x)+Math.abs(Ze.y-a.y);return xt<mt?dt:Ze});de={unit:b,target:{x:b.position.x,y:b.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:F({},b.position),to:Ve}};continue}}}if(ue.some(z=>z.x===a.x&&z.y===a.y)){let z=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,U=5e7+o+z;(de===null||U>de.score)&&(de={unit:b,target:{x:a.x,y:a.y},score:U,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let z=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(U=>e.inBounds(U.x,U.y));for(let U of z){let Z=e.getWallBetween(a.x,a.y,U.x,U.y);if(Z&&Z.owner==="neutral"){if(b.position.x===U.x&&b.position.y===U.y||b.position.x===a.x&&b.position.y===a.y){let Me=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,Ve=2e6+o+Me;(de===null||Ve>de.score)&&(de={unit:b,target:F({},b.position),score:Ve,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:U.x,y:U.y}}})}else if(ue.some(Ve=>Ve.x===U.x&&Ve.y===U.y||Ve.x===a.x&&Ve.y===a.y)){let Ve=ue.find(mt=>mt.x===U.x&&mt.y===U.y||mt.x===a.x&&mt.y===a.y),Ze=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,dt=18e5+o+Ze;(de===null||dt>de.score)&&(de={unit:b,target:{x:Ve.x,y:Ve.y},score:dt,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(le){let z=e.getUnitAt(le.x,le.y);if(z&&z.owner==="player"&&e.isForest(le.x,le.y)){let U=le.x,Z=le.y;if(ue.some(Me=>Me.x===U&&Me.y===Z)){(de===null||3e5>de.score)&&(de={unit:b,target:{x:U,y:Z},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let Me=d.length>0?d:h;if(Me.length>0)le=Me.reduce((Ze,dt)=>{let xt=Math.abs(b.position.x-dt.x)+Math.abs(b.position.y-dt.y),mt=Math.abs(b.position.x-Ze.x)+Math.abs(b.position.y-Ze.y);return xt<mt?dt:Ze},Me[0]),this.goals.set(b.id,le);else continue}}}let Ot=null;if(le&&e.isForest(le.x,le.y)&&!e.getUnitAt(le.x,le.y)){let U=[{x:le.x+1,y:le.y},{x:le.x-1,y:le.y},{x:le.x,y:le.y+1},{x:le.x,y:le.y-1}].filter(Z=>e.inBounds(Z.x,Z.y)).filter(Z=>{let ne=e.getWallBetween(Z.x,Z.y,le.x,le.y);return!!(ne&&ne.owner==="neutral")});U.length>0&&(Ot=U.reduce((Z,ne)=>{let Me=Math.abs(b.position.x-Z.x)+Math.abs(b.position.y-Z.y);return Math.abs(b.position.x-ne.x)+Math.abs(b.position.y-ne.y)+3<Me?ne:Z},U[0]))}let Kr=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let z of Kr){let U={x:b.position.x+z.x,y:b.position.y+z.y};if(!e.inBounds(U.x,U.y)||!e.isForest(U.x,U.y)||e.getUnitAt(U.x,U.y))continue;let ne=e.getWallBetween(b.position.x,b.position.y,U.x,U.y);if(ne&&(ne.owner==="neutral"||ne.owner==="ai")){let Me=(b.tier>=3?7e6:9e5)+o,Ve=ne.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(de===null||Me>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:Me,type:"wall_attack",reason:Ve,edge:{from:F({},b.position),to:U}})}else if(ne&&ne.owner==="player"){let Ve=[{x:U.x+1,y:U.y},{x:U.x-1,y:U.y},{x:U.x,y:U.y+1},{x:U.x,y:U.y-1}].filter(xt=>e.inBounds(xt.x,xt.y)).filter(xt=>e.getUnitAt(xt.x,xt.y)?!1:!e.getWallBetween(xt.x,xt.y,U.x,U.y)),Ze=Math.abs(b.position.x-U.x)+Math.abs(b.position.y-U.y);if((Ve.length>0?Ve.reduce((xt,mt)=>{let En=Math.abs(b.position.x-mt.x)+Math.abs(b.position.y-mt.y)+1;return Math.min(xt,En)},1/0):1/0)-Ze>4){let xt=(b.tier>=3?8e6:b.tier===3&&b.level===1?105e4:85e4)+o;(de===null||xt>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:xt,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:F({},b.position),to:U}})}}}for(let z of Kr){let U={x:b.position.x+z.x,y:b.position.y+z.y};if(U.x===a.x&&U.y===a.y){let Z=e.getWallBetween(b.position.x,b.position.y,U.x,U.y);if(Z&&(Z.owner==="neutral"||Z.owner==="player")&&b.tier>=3){let ne=8e6+o;(de===null||ne>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:ne,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:F({},b.position),to:U}})}}}if(le){let z=Math.sign(le.x-b.position.x),U=Math.sign(le.y-b.position.y),Z=b.position.x+(z!==0?z:0),ne=b.position.y+(U!==0?U:0);if(e.inBounds(Z,ne)){let Me=e.getUnitAt(Z,ne);if(Me&&Me.owner==="ai")for(let Ve of Kr){let Ze={x:b.position.x+Ve.x,y:b.position.y+Ve.y};if(!e.inBounds(Ze.x,Ze.y))continue;let dt=e.getWallBetween(b.position.x,b.position.y,Ze.x,Ze.y);if(dt&&(dt.owner==="player"||dt.owner==="neutral")){let mt=(dt.owner==="player"?65e4:6e5)+o;(de===null||mt>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:mt,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:F({},b.position),to:Ze}})}}}}if(le){let z=le.x-b.position.x,U=le.y-b.position.y;if(z!==0&&U===0||z===0&&U!==0){let Z=Math.sign(z),ne=Math.sign(U),Me={x:b.position.x+Z,y:b.position.y+ne};if(e.inBounds(Me.x,Me.y)&&e.getWallBetween(b.position.x,b.position.y,Me.x,Me.y)){let Ze=(b.tier>=3?8e6:15e5)+o;(de===null||Ze>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:Ze,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:F({},b.position),to:Me}})}}if(Math.abs(z)>=1&&Math.abs(U)>=1){let Z=Math.sign(z),ne=Math.sign(U),Me={x:b.position.x+Z,y:b.position.y+ne};if(e.inBounds(Me.x,Me.y)&&this.combat.isDiagonalBlocked(b.position,Me,(Ze,dt,xt,mt)=>e.getWallBetween(Ze,dt,xt,mt))){let Ze={x:b.position.x+Z,y:b.position.y},dt={x:b.position.x,y:b.position.y+ne},xt=e.getWallBetween(b.position.x,b.position.y,Ze.x,Ze.y),mt=e.getWallBetween(b.position.x,b.position.y,dt.x,dt.y),En=null;if(xt?En={from:F({},b.position),to:Ze}:mt&&(En={from:F({},b.position),to:dt}),En){let jo=(b.tier>=3?8e6:15e5)+o;(de===null||jo>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:jo,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:En})}}}}let V0=d.length===0&&h.length===0&&!Ot;if(Ke>=2&&(V0||S.length>0))for(let z of Kr){let U={x:b.position.x+z.x,y:b.position.y+z.y};if(!e.inBounds(U.x,U.y))continue;let Z=e.getWallBetween(b.position.x,b.position.y,U.x,U.y);if(Z&&(Z.owner==="neutral"||Z.owner==="player")){let ne=b.tier>=3?8e6:12e5;(de===null||ne>de.score)&&(de={unit:b,target:{x:b.position.x,y:b.position.y},score:ne,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:F({},b.position),to:U}})}}let hr=S.filter(z=>Math.max(Math.abs(z.position.x-b.position.x),Math.abs(z.position.y-b.position.y))===1),Bo=hr.length>0?hr.reduce((z,U)=>this.combat.calculateTotalPoints(U)>this.combat.calculateTotalPoints(z)?U:z,hr[0]):null,Ps=lt.length>0&&ue.some(z=>lt.some(U=>U.x===z.x&&U.y===z.y));for(let z of ue){let U=0,Z="Action",ne=e.getUnitAt(z.x,z.y),Me=Te=>[{x:Te.x+1,y:Te.y},{x:Te.x-1,y:Te.y},{x:Te.x,y:Te.y+1},{x:Te.x,y:Te.y-1}].filter(Rt=>e.inBounds(Rt.x,Rt.y)).filter(Rt=>!e.getUnitAt(Rt.x,Rt.y)).length,Ve=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y)),Ze=Math.max(Math.abs(z.x-s.x),Math.abs(z.y-s.y)),dt=l.length?Math.min(...l.map(Te=>Math.abs(b.position.x-Te.x)+Math.abs(b.position.y-Te.y))):1/0,xt=l.length?Math.min(...l.map(Te=>Math.abs(z.x-Te.x)+Math.abs(z.y-Te.y))):1/0,mt=l.filter(Te=>{let He=e.getUnitAt(Te.x,Te.y);return!!He&&He.owner==="player"}),En=mt.length?Math.min(...mt.map(Te=>Math.abs(b.position.x-Te.x)+Math.abs(b.position.y-Te.y))):1/0,jo=mt.length?Math.min(...mt.map(Te=>Math.abs(z.x-Te.x)+Math.abs(z.y-Te.y))):1/0,Rc=new Map(e.unitMoveHistorySignal()).get(b.id),li=Array.isArray(Rc)?Rc:[],Yr=li.length>=2?li[li.length-2]:null,qt=li.length>=3?li[li.length-3]:null,vh=Yr&&z.x===Yr.x&&z.y===Yr.y,Qr=$n&&!e.isForest(z.x,z.y);if(I){let Te=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),He=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);He<Te?(U+=5e7,Z="FULL RUSH: Charge Base"):He===Te?U+=1e5:U-=5e6,ne&&ne.owner==="player"&&Math.abs(ne.position.x-a.x)+Math.abs(ne.position.y-a.y)<Te&&(U+=2e7,Z="FULL RUSH: Clear Path to Base"),$n&&z.x===b.position.x&&z.y===b.position.y&&f>=3&&(U=-5e6,Z="FULL RUSH: Abandon Forest for Assault")}else if(b.tier>=3&&Qr){let Te=Math.abs(z.x-a.x)+Math.abs(z.y-a.y)<=2,He=S.some(Bt=>Math.abs(z.x-Bt.position.x)+Math.abs(z.y-Bt.position.y)<=2),Rt=e.unitsSignal().some(Bt=>Bt.owner==="ai"&&Bt.id!==b.id&&Math.max(Math.abs(Bt.position.x-b.position.x),Math.abs(Bt.position.y-b.position.y))<=1);!M&&!(Te||He)&&!Rt&&(U-=2e6,Z="Penalty: Leaving forest without replacement")}let Jr=se.get(b.id),U0=Jr&&Jr.until>e.turnSignal()&&Jr.tiles.has(`${z.x},${z.y}`);if(b.tier===1&&(Yr&&z.x===Yr.x&&z.y===Yr.y||qt&&z.x===qt.x&&z.y===qt.y)&&(U-=25e3,Z="Anti-Loop Penalty"),b.tier<=2&&!ne&&qt&&z.x===qt.x&&z.y===qt.y&&(U=-1e6,Z="Anti-Loop: Stay or different path"),U0&&(U-=3e4,Z="Stutter Ban Penalty"),$n&&hr.length===0&&!ne&&Qr&&!q&&(U=-1e3),$n&&b.tier<=2&&Qr&&hr.length>0&&hr.some(He=>this.combat.calculateTotalPoints(He)>this.combat.calculateTotalPoints(b))&&(U=-1e6,Z="Hold Forest"),I)$n&&z.x===b.position.x&&z.y===b.position.y&&f>=3&&(U=-5e6,Z="FULL RUSH: Abandon Forest for Assault");else if(!ne&&$n&&z.x===b.position.x&&z.y===b.position.y){let Te=hr.some(Rt=>this.combat.calculateTotalPoints(Rt)>this.combat.calculateTotalPoints(b)),He=M&&b.tier>=3;!Te&&!He&&(U=Math.max(U,1e7),Z="Hold: Stay on forest")}if(!ne&&!I){if(e.isForest(z.x,z.y)&&!e.getUnitAt(z.x,z.y)&&(Ns?(U=-1e3,Z="Ignore Forest (Total War)"):b.tier>=3?(U=5e6*(Ie&&!q?3:1),Z="Priority: T3 capture empty forest"):(U=1e6*(Ie&&!q?3:1),Z=f<3?`Priority 0: Capture Forest ${z.x},${z.y}`:`Priority 1: Capture Forest ${z.x},${z.y}`,Ie&&!q&&Math.abs(b.position.x-z.x)+Math.abs(b.position.y-z.y)===1&&(U=Math.max(U,12e6),Z=`Early Capture: Forest ${z.x},${z.y}`))),le){let Te=Math.abs(b.position.x-le.x)+Math.abs(b.position.y-le.y),He=Math.abs(z.x-le.x)+Math.abs(z.y-le.y);if(He<Te&&(U+=5e4*(Te-He),Z=d.length>0?`Priority 1: Toward Forest ${le.x},${le.y}`:h.length>0?`Priority 7: Toward Fog Forest ${le.x},${le.y}`:`Toward Goal ${le.x},${le.y}`),g>10||x){let Bt=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ft=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);Ft<Bt&&(U+=15e4*(Bt-Ft),Z="Aggress: Toward Player Base"),jo<En&&(U+=12e4*(En-jo),Z="Aggress: Toward Player Forest");let bn=Me(z)-Me(b.position);bn>0&&(U+=5e4*bn,Z="Unblock: Clear path")}if((()=>{let Bt=Math.sign(le.x-b.position.x),Ft=Math.sign(le.y-b.position.y),bn=b.position.x+(Bt!==0?Bt:0),Lt=b.position.y+(Ft!==0?Ft:0);return e.inBounds(bn,Lt)?!!e.getWallBetween(b.position.x,b.position.y,bn,Lt):!1})()&&z.x===b.position.x&&z.y===b.position.y){let Ft=e.getWallBetween(b.position.x,b.position.y,b.position.x+Math.sign(le.x-b.position.x),b.position.y+Math.sign(le.y-b.position.y))?.owner;b.tier>=3?(U=Math.max(U,8e6+o),Z="Breach: Wall blocks high-priority path"):(U+=(Ft==="ai"?7e5:8e5)+o,Z=Ft==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(Ot){let Te=Math.abs(b.position.x-Ot.x)+Math.abs(b.position.y-Ot.y),He=Math.abs(z.x-Ot.x)+Math.abs(z.y-Ot.y);He<Te&&(U+=2e5*(Te-He),Z="Approach Neutral Wall to Forest"),z.x===Ot.x&&z.y===Ot.y&&(U+=5e5,Z="Position for Wall Breach")}if(z.x===a.x&&z.y===a.y&&(U+=1e4,Z="Attack Base (Override)"),Pe){let Te=lt.some(Lt=>Lt.x===z.x&&Lt.y===z.y),He=Math.abs(b.position.x-Pe.position.x)+Math.abs(b.position.y-Pe.position.y),Rt=Math.abs(z.x-Pe.position.x)+Math.abs(z.y-Pe.position.y),Ft=Math.max(Math.abs(Pe.position.x-s.x),Math.abs(Pe.position.y-s.y))<=2,bn=z.x===b.position.x&&z.y===b.position.y;if(b.tier>=3&&Pe.tier>=3&&Rt===1)U=4e7,Z="DEFENSE: T3 Move to Intercept Threat";else if(Te){let Lt=Ft?25e5:15e5;U<Lt&&(U=Lt),U+=Ft?2e4:5e3,Z=Ft?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(Rt<He){let Lt=b.id===(Wt?.id??"")?1e6:5e3;U+=Lt*(He-Rt),b.tier>=3&&(U+=4e3),Z=b.id===(Wt?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}bn&&Ps&&(U-=Ft?5e4:1e4,_e?Z="Penalty: Standing Still With Imminent Base Threat":q&&(Z="Penalty: Standing Still With Base Threat"))}if(b.tier>=3){let Te=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),He=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);He<Te&&(U+=2e3*(Te-He),Z="Hunter: Toward Base",M&&(U=Math.max(U,4e6),Z="Hunt: Approach Base"))}if(qe&&xt<dt&&(U*=10),Ze>Ve&&xt<dt&&(U+=500),Bo&&this.combat.calculateTotalPoints(Bo)>this.combat.calculateTotalPoints(b)){let Te=Math.abs(b.position.x-Bo.position.x)+Math.abs(b.position.y-Bo.position.y),He=Math.abs(z.x-Bo.position.x)+Math.abs(z.y-Bo.position.y);He>Te&&(U+=75e3*(He-Te),Z="Retreat")}}else if(ne.owner==="player"){let Te=Math.max(Math.abs(ne.position.x-s.x),Math.abs(ne.position.y-s.y)),He=Te<=3,Rt=Te<=2,Bt=this.combat.calculateTotalPoints(b),Ft=this.combat.calculateTotalPoints(ne),bn=Bt>Ft,Lt=ne.tier>=3,ks=b.tier>=3;b.tier>=3&&e.isForest(ne.position.x,ne.position.y)&&(U=1e7,Z="Aggression: Liberate forest"),!$n&&ae&&mt.length>0&&e.isForest(ne.position.x,ne.position.y)&&(U=12e6,Z="LIBERATE: Attack player forest"),Te<=4&&(b.tier>=3||bn)&&(U=15e6,Z="INTERCEPT: Base Siege"),He?ks&&Lt?(U=5e7,Z="CRITICAL DEFENSE: T3 Intercepts Threat"):bn?(U=2e7,Z="CRITICAL DEFENSE: Eliminate Base Threat",Rt&&(U+=5e6)):Lt&&b.tier<=2?(U=0,Z="Ignore: T1 Suicide vs T3 useless"):(U=1e3,Z="DEFENSE: Desperation Attack"):bn?(Lt?(U=8e6,Z="COMBAT: Kill High Value Target (T3+)"):(U=4e6,Z="COMBAT: Kill Enemy"),b.tier<ne.tier&&(U+=2e6,Z+=" (Efficient Trade)")):b.tier<=2?(U=0,Z="Ignore: No guaranteed kill"):(U=1e5,Z="COMBAT: Chip Damage"),N&&(U+=5e5),R&&(U+=1e6)}else if(ne.tier===b.tier&&Ze>Ve){let Te=this.combat.calculateTotalPoints(b)+this.combat.calculateTotalPoints(ne),{tier:He}=this.combat.calculateTierAndLevel(Te);He>b.tier&&!qe&&!$n&&(U=1e3,Z="Merge Up")}let Gi="move";ne&&ne.owner==="player"&&(Gi="attack"),ne&&ne.owner==="ai"&&ne.tier===b.tier&&(Gi="merge"),(g>10||x)&&Gi==="merge"&&(U+=5e6,Z="Anti-Stall: Merge first");let B0=this.interceptUntil.get(b.id)||0;if(b.id===(Wt?.id??"")&&B0>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Pe){let Te=Math.abs(b.position.x-Pe.position.x)+Math.abs(b.position.y-Pe.position.y),He=Math.abs(z.x-Pe.position.x)+Math.abs(z.y-Pe.position.y);He<Te&&(U+=5e5*(Te-He),Z="DEFENSE: Intercept Lock")}vh&&(U=Math.floor(U*.1),U-=3e5,Z="Penalty: Inertia");let j0=(()=>{let Te=li.slice(-6),He=new Set(Te.map(Rt=>`${Rt.x},${Rt.y}`));return Te.length>=6&&He.size<=3})();if(b.tier===1&&j0){let Te=d.length>0?d:h;if(Te.length>0){let He=Te.reduce((Ft,bn)=>{let Lt=Math.abs(b.position.x-bn.x)+Math.abs(b.position.y-bn.y),ks=Math.abs(b.position.x-Ft.x)+Math.abs(b.position.y-Ft.y);return Lt<ks?bn:Ft},Te[0]),Rt=Math.abs(b.position.x-He.x)+Math.abs(b.position.y-He.y),Bt=Math.abs(z.x-He.x)+Math.abs(z.y-He.y);Bt<Rt&&(U+=1e5*(Rt-Bt),Z="Breakout: Toward Forest")}}(b.forestOccupationTurns??0)>0&&(z.x!==b.position.x||z.y!==b.position.y)&&(U-=2e3),(de===null||U>de.score)&&(de={unit:b,target:z,score:U,type:Gi,reason:Z})}}if(!de)return null;let Ee=this.goals.get(de.unit.id),ve=Ee?`Goal: Forest at ${Ee.x},${Ee.y}`:"Goal: None";return{type:de.type,unit:de.unit,target:de.target,reason:de.reason,edge:de.edge}}getWallBuildActions(e){let t=[],i=e.unitsSignal().filter(d=>d.owner==="ai"),r=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,h)=>o.some(f=>f.tile1.x===d.x&&f.tile1.y===d.y&&f.tile2.x===h.x&&f.tile2.y===h.y||f.tile1.x===h.x&&f.tile1.y===h.y&&f.tile2.x===d.x&&f.tile2.y===d.y),l=(d,h)=>Math.abs(d.x-h.x)+Math.abs(d.y-h.y),c=(d,h)=>Math.max(Math.abs(d.x-h.x),Math.abs(d.y-h.y));for(let d of i){if(d.tier>=3)continue;let h=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(S=>e.inBounds(S.x,S.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let S of h)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});continue}let f=r.filter(S=>c(d.position,S.position)<=2);if(f.length===0)continue;let g=f.sort((S,R)=>l(d.position,S.position)-l(d.position,R.position))[0],x=h.sort((S,R)=>l(S,g.position)-l(R,g.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let S of x)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});else if(d.tier===2){let S=0;for(let R of x){if(S>=2)break;!a(d.position,R)&&e.canBuildWallBetween(d.position,R)&&(t.push({from:d.position,to:R}),S++)}}}return t}static \u0275fac=function(t){return new(t||n)(Ne(Wl),Ne(Et))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var rR=()=>{};var aR=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},yj=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=n[t++],s=n[t++],a=n[t++],l=((r&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63)}}return e.join("")},lR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,a=s?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,d=o>>2,h=(o&3)<<4|a>>4,f=(a&15)<<2|c>>6,g=c&63;l||(g=64,s||(f=64)),i.push(t[d],t[h],t[f],t[g])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(aR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yj(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let c=r<n.length?t[n.charAt(r)]:64;++r;let h=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||a==null||c==null||h==null)throw new Ab;let f=o<<2|a>>4;if(i.push(f),c!==64){let g=a<<4&240|c>>2;if(i.push(g),h!==64){let x=c<<6&192|h;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ab=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},vj=function(n){let e=aR(n);return lR.encodeByteArray(e,!0)},_d=function(n){return vj(n).replace(/\./g,"")},jg=function(n){try{return lR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function cR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var _j=()=>cR().__FIREBASE_DEFAULTS__,Ej=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},bj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&jg(n[1]);return e&&JSON.parse(e)},Hg=()=>{try{return rR()||_j()||Ej()||bj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Rb=n=>Hg()?.emulatorHosts?.[n],uR=n=>{let e=Rb(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Nb=()=>Hg()?.config,Pb=n=>Hg()?.[`_${n}`];var Bg=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function ys(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Gg(n){return(await fetch(n,{credentials:"include"})).ok}function dR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=F({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[_d(JSON.stringify(t)),_d(JSON.stringify(s)),""].join(".")}var vd={};function wj(){let n={prod:[],emulator:[]};for(let e of Object.keys(vd))vd[e]?n.emulator.push(e):n.prod.push(e);return n}function xj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var oR=!1;function $g(n,e){if(typeof window>"u"||typeof document>"u"||!ys(window.location.host)||vd[n]===e||vd[n]||oR)return;vd[n]=e;function t(f){return`__firebase__banner__${f}`}let i="__firebase__banner",o=wj().prod.length>0;function s(){let f=document.getElementById(i);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){let f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{oR=!0,s()},f}function d(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){let f=xj(i),g=t("text"),x=document.getElementById(g)||document.createElement("span"),S=t("learnmore"),R=document.getElementById(S)||document.createElement("a"),L=t("preprendIcon"),q=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){let ye=f.element;a(ye),d(R,S);let _e=c();l(q,L),ye.append(q,x,R,_e),document.body.appendChild(ye)}o?(x.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Cn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cn())}function Sj(){let n=Hg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pR(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mR(){let n=Cn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function yR(){return!Sj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kb(){try{return typeof indexedDB=="object"}catch{return!1}}function vR(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var Ij="FirebaseError",xi=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Ij,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yo.prototype.create)}},yo=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?Tj(o,i):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new xi(r,a,i)}};function Tj(n,e){return n.replace(Cj,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var Cj=/\{\$([^}]+)}/g;function _R(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function sr(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(sR(o)&&sR(s)){if(!sr(o,s))return!1}else if(o!==s)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function sR(n){return n!==null&&typeof n=="object"}function ql(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ER(n,e){let t=new Mb(n,e);return t.subscribe.bind(t)}var Mb=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Dj(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Db),r.error===void 0&&(r.error=Db),r.complete===void 0&&(r.complete=Db);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Dj(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Db(){}var jue=14400*1e3;function Dn(n){return n&&n._delegate?n._delegate:n}var Ui=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ta="[DEFAULT]";var Ob=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Bg;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Mj(e))try{this.getOrInitializeService({instanceIdentifier:Ta})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=Ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ta){return this.instances.has(e)}getOptions(e=Ta){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&s.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Aj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ta){return this.component?this.component.multipleInstances?e:Ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Aj(n){return n===Ta?void 0:n}function Mj(n){return n.instantiationMode==="EAGER"}var zg=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ob(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Rj=[],tt=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(tt||{}),Nj={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},Pj=tt.INFO,kj={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},Oj=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=kj[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},vs=class{constructor(e){this.name=e,this._logLevel=Pj,this._logHandler=Oj,this._userLogHandler=null,Rj.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Nj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}};var Fj=(n,e)=>e.some(t=>n instanceof t),bR,wR;function Lj(){return bR||(bR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vj(){return wR||(wR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var xR=new WeakMap,Lb=new WeakMap,SR=new WeakMap,Fb=new WeakMap,Ub=new WeakMap;function Uj(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Fr(n.result)),r()},s=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&xR.set(t,n)}).catch(()=>{}),Ub.set(e,n),e}function Bj(n){if(Lb.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Lb.set(n,e)}var Vb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Lb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||SR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function IR(n){Vb=n(Vb)}function jj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(Wg(this),e,...t);return SR.set(i,e.sort?e.sort():[e]),Fr(i)}:Vj().includes(n)?function(...e){return n.apply(Wg(this),e),Fr(xR.get(this))}:function(...e){return Fr(n.apply(Wg(this),e))}}function Hj(n){return typeof n=="function"?jj(n):(n instanceof IDBTransaction&&Bj(n),Fj(n,Lj())?new Proxy(n,Vb):n)}function Fr(n){if(n instanceof IDBRequest)return Uj(n);if(Fb.has(n))return Fb.get(n);let e=Hj(n);return e!==n&&(Fb.set(n,e),Ub.set(e,n)),e}var Wg=n=>Ub.get(n);function CR(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),a=Fr(s);return i&&s.addEventListener("upgradeneeded",l=>{i(Fr(s.result),l.oldVersion,l.newVersion,Fr(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var Gj=["get","getKey","getAll","getAllKeys","count"],$j=["put","add","delete","clear"],Bb=new Map;function TR(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Bb.get(e))return Bb.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=$j.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Gj.includes(t)))return;let o=async function(s,...a){let l=this.transaction(s,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return Bb.set(e,o),o}IR(n=>ce(F({},n),{get:(e,t,i)=>TR(e,t)||n.get(e,t,i),has:(e,t)=>!!TR(e,t)||n.has(e,t)}));var Hb=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(zj(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function zj(n){return n.getComponent()?.type==="VERSION"}var Gb="@firebase/app",DR="0.14.7";var vo=new vs("@firebase/app"),Wj="@firebase/app-compat",qj="@firebase/analytics-compat",Kj="@firebase/analytics",Yj="@firebase/app-check-compat",Qj="@firebase/app-check",Jj="@firebase/auth",Xj="@firebase/auth-compat",Zj="@firebase/database",e9="@firebase/data-connect",t9="@firebase/database-compat",n9="@firebase/functions",i9="@firebase/functions-compat",r9="@firebase/installations",o9="@firebase/installations-compat",s9="@firebase/messaging",a9="@firebase/messaging-compat",l9="@firebase/performance",c9="@firebase/performance-compat",u9="@firebase/remote-config",d9="@firebase/remote-config-compat",h9="@firebase/storage",f9="@firebase/storage-compat",p9="@firebase/firestore",g9="@firebase/ai",m9="@firebase/firestore-compat",y9="firebase",v9="12.8.0";var $b="[DEFAULT]",_9={[Gb]:"fire-core",[Wj]:"fire-core-compat",[Kj]:"fire-analytics",[qj]:"fire-analytics-compat",[Qj]:"fire-app-check",[Yj]:"fire-app-check-compat",[Jj]:"fire-auth",[Xj]:"fire-auth-compat",[Zj]:"fire-rtdb",[e9]:"fire-data-connect",[t9]:"fire-rtdb-compat",[n9]:"fire-fn",[i9]:"fire-fn-compat",[r9]:"fire-iid",[o9]:"fire-iid-compat",[s9]:"fire-fcm",[a9]:"fire-fcm-compat",[l9]:"fire-perf",[c9]:"fire-perf-compat",[u9]:"fire-rc",[d9]:"fire-rc-compat",[h9]:"fire-gcs",[f9]:"fire-gcs-compat",[p9]:"fire-fst",[m9]:"fire-fst-compat",[g9]:"fire-vertex","fire-js":"fire-js",[y9]:"fire-js-all"};var qg=new Map,E9=new Map,zb=new Map;function AR(n,e){try{n.container.addComponent(e)}catch(t){vo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Es(n){let e=n.name;if(zb.has(e))return vo.debug(`There were multiple attempts to register component ${e}.`),!1;zb.set(e,n);for(let t of qg.values())AR(t,n);for(let t of E9.values())AR(t,n);return!0}function bd(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Si(n){return n==null?!1:n.settings!==void 0}var b9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_s=new yo("app","Firebase",b9);var Wb=class{constructor(e,t,i){this._isDeleted=!1,this._options=F({},e),this._config=F({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _s.create("app-deleted",{appName:this._name})}};var bs=v9;function wd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=F({name:$b,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw _s.create("bad-app-name",{appName:String(r)});if(t||(t=Nb()),!t)throw _s.create("no-options");let o=qg.get(r);if(o){if(sr(t,o.options)&&sr(i,o.config))return o;throw _s.create("duplicate-app",{appName:r})}let s=new zg(r);for(let l of zb.values())s.addComponent(l);let a=new Wb(t,i,s);return qg.set(r,a),a}function Kg(n=$b){let e=qg.get(n);if(!e&&n===$b&&Nb())return wd();if(!e)throw _s.create("no-app",{appName:n});return e}function ar(n,e,t){let i=_9[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let s=[`Unable to register library "${i}" with version "${e}":`];r&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vo.warn(s.join(" "));return}Es(new Ui(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var w9="firebase-heartbeat-database",x9=1,Ed="firebase-heartbeat-store",jb=null;function PR(){return jb||(jb=CR(w9,x9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ed)}catch(t){console.warn(t)}}}}).catch(n=>{throw _s.create("idb-open",{originalErrorMessage:n.message})})),jb}async function S9(n){try{let t=(await PR()).transaction(Ed),i=await t.objectStore(Ed).get(kR(n));return await t.done,i}catch(e){if(e instanceof xi)vo.warn(e.message);else{let t=_s.create("idb-get",{originalErrorMessage:e?.message});vo.warn(t.message)}}}async function MR(n,e){try{let i=(await PR()).transaction(Ed,"readwrite");await i.objectStore(Ed).put(e,kR(n)),await i.done}catch(t){if(t instanceof xi)vo.warn(t.message);else{let i=_s.create("idb-set",{originalErrorMessage:t?.message});vo.warn(i.message)}}}function kR(n){return`${n.name}!${n.options.appId}`}var I9=1024,T9=30,qb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Kb(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=RR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>T9){let r=D9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){vo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=RR(),{heartbeatsToSend:t,unsentEntries:i}=C9(this._heartbeatsCache.heartbeats),r=_d(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return vo.warn(e),""}}};function RR(){return new Date().toISOString().substring(0,10)}function C9(n,e=I9){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),NR(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),NR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Kb=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kb()?vR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await S9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return MR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return MR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function NR(n){return _d(JSON.stringify({version:2,heartbeats:n})).length}function D9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function A9(n){Es(new Ui("platform-logger",e=>new Hb(e),"PRIVATE")),Es(new Ui("heartbeat",e=>new qb(e),"PRIVATE")),ar(Gb,DR,n),ar(Gb,DR,"esm2020"),ar("fire-js","")}A9("");var M9="firebase",R9="12.8.0";ar(M9,R9,"app");var OR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},FR={};var _o,Yb;(function(){var n;function e(O,T){function k(){}k.prototype=T.prototype,O.F=T.prototype,O.prototype=new k,O.prototype.constructor=O,O.D=function(I,w,N){for(var M=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)M[ae-2]=arguments[ae];return T.prototype[w].apply(I,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(O,T,k){k||(k=0);let I=Array(16);if(typeof T=="string")for(var w=0;w<16;++w)I[w]=T.charCodeAt(k++)|T.charCodeAt(k++)<<8|T.charCodeAt(k++)<<16|T.charCodeAt(k++)<<24;else for(w=0;w<16;++w)I[w]=T[k++]|T[k++]<<8|T[k++]<<16|T[k++]<<24;T=O.g[0],k=O.g[1],w=O.g[2];let N=O.g[3],M;M=T+(N^k&(w^N))+I[0]+3614090360&4294967295,T=k+(M<<7&4294967295|M>>>25),M=N+(w^T&(k^w))+I[1]+3905402710&4294967295,N=T+(M<<12&4294967295|M>>>20),M=w+(k^N&(T^k))+I[2]+606105819&4294967295,w=N+(M<<17&4294967295|M>>>15),M=k+(T^w&(N^T))+I[3]+3250441966&4294967295,k=w+(M<<22&4294967295|M>>>10),M=T+(N^k&(w^N))+I[4]+4118548399&4294967295,T=k+(M<<7&4294967295|M>>>25),M=N+(w^T&(k^w))+I[5]+1200080426&4294967295,N=T+(M<<12&4294967295|M>>>20),M=w+(k^N&(T^k))+I[6]+2821735955&4294967295,w=N+(M<<17&4294967295|M>>>15),M=k+(T^w&(N^T))+I[7]+4249261313&4294967295,k=w+(M<<22&4294967295|M>>>10),M=T+(N^k&(w^N))+I[8]+1770035416&4294967295,T=k+(M<<7&4294967295|M>>>25),M=N+(w^T&(k^w))+I[9]+2336552879&4294967295,N=T+(M<<12&4294967295|M>>>20),M=w+(k^N&(T^k))+I[10]+4294925233&4294967295,w=N+(M<<17&4294967295|M>>>15),M=k+(T^w&(N^T))+I[11]+2304563134&4294967295,k=w+(M<<22&4294967295|M>>>10),M=T+(N^k&(w^N))+I[12]+1804603682&4294967295,T=k+(M<<7&4294967295|M>>>25),M=N+(w^T&(k^w))+I[13]+4254626195&4294967295,N=T+(M<<12&4294967295|M>>>20),M=w+(k^N&(T^k))+I[14]+2792965006&4294967295,w=N+(M<<17&4294967295|M>>>15),M=k+(T^w&(N^T))+I[15]+1236535329&4294967295,k=w+(M<<22&4294967295|M>>>10),M=T+(w^N&(k^w))+I[1]+4129170786&4294967295,T=k+(M<<5&4294967295|M>>>27),M=N+(k^w&(T^k))+I[6]+3225465664&4294967295,N=T+(M<<9&4294967295|M>>>23),M=w+(T^k&(N^T))+I[11]+643717713&4294967295,w=N+(M<<14&4294967295|M>>>18),M=k+(N^T&(w^N))+I[0]+3921069994&4294967295,k=w+(M<<20&4294967295|M>>>12),M=T+(w^N&(k^w))+I[5]+3593408605&4294967295,T=k+(M<<5&4294967295|M>>>27),M=N+(k^w&(T^k))+I[10]+38016083&4294967295,N=T+(M<<9&4294967295|M>>>23),M=w+(T^k&(N^T))+I[15]+3634488961&4294967295,w=N+(M<<14&4294967295|M>>>18),M=k+(N^T&(w^N))+I[4]+3889429448&4294967295,k=w+(M<<20&4294967295|M>>>12),M=T+(w^N&(k^w))+I[9]+568446438&4294967295,T=k+(M<<5&4294967295|M>>>27),M=N+(k^w&(T^k))+I[14]+3275163606&4294967295,N=T+(M<<9&4294967295|M>>>23),M=w+(T^k&(N^T))+I[3]+4107603335&4294967295,w=N+(M<<14&4294967295|M>>>18),M=k+(N^T&(w^N))+I[8]+1163531501&4294967295,k=w+(M<<20&4294967295|M>>>12),M=T+(w^N&(k^w))+I[13]+2850285829&4294967295,T=k+(M<<5&4294967295|M>>>27),M=N+(k^w&(T^k))+I[2]+4243563512&4294967295,N=T+(M<<9&4294967295|M>>>23),M=w+(T^k&(N^T))+I[7]+1735328473&4294967295,w=N+(M<<14&4294967295|M>>>18),M=k+(N^T&(w^N))+I[12]+2368359562&4294967295,k=w+(M<<20&4294967295|M>>>12),M=T+(k^w^N)+I[5]+4294588738&4294967295,T=k+(M<<4&4294967295|M>>>28),M=N+(T^k^w)+I[8]+2272392833&4294967295,N=T+(M<<11&4294967295|M>>>21),M=w+(N^T^k)+I[11]+1839030562&4294967295,w=N+(M<<16&4294967295|M>>>16),M=k+(w^N^T)+I[14]+4259657740&4294967295,k=w+(M<<23&4294967295|M>>>9),M=T+(k^w^N)+I[1]+2763975236&4294967295,T=k+(M<<4&4294967295|M>>>28),M=N+(T^k^w)+I[4]+1272893353&4294967295,N=T+(M<<11&4294967295|M>>>21),M=w+(N^T^k)+I[7]+4139469664&4294967295,w=N+(M<<16&4294967295|M>>>16),M=k+(w^N^T)+I[10]+3200236656&4294967295,k=w+(M<<23&4294967295|M>>>9),M=T+(k^w^N)+I[13]+681279174&4294967295,T=k+(M<<4&4294967295|M>>>28),M=N+(T^k^w)+I[0]+3936430074&4294967295,N=T+(M<<11&4294967295|M>>>21),M=w+(N^T^k)+I[3]+3572445317&4294967295,w=N+(M<<16&4294967295|M>>>16),M=k+(w^N^T)+I[6]+76029189&4294967295,k=w+(M<<23&4294967295|M>>>9),M=T+(k^w^N)+I[9]+3654602809&4294967295,T=k+(M<<4&4294967295|M>>>28),M=N+(T^k^w)+I[12]+3873151461&4294967295,N=T+(M<<11&4294967295|M>>>21),M=w+(N^T^k)+I[15]+530742520&4294967295,w=N+(M<<16&4294967295|M>>>16),M=k+(w^N^T)+I[2]+3299628645&4294967295,k=w+(M<<23&4294967295|M>>>9),M=T+(w^(k|~N))+I[0]+4096336452&4294967295,T=k+(M<<6&4294967295|M>>>26),M=N+(k^(T|~w))+I[7]+1126891415&4294967295,N=T+(M<<10&4294967295|M>>>22),M=w+(T^(N|~k))+I[14]+2878612391&4294967295,w=N+(M<<15&4294967295|M>>>17),M=k+(N^(w|~T))+I[5]+4237533241&4294967295,k=w+(M<<21&4294967295|M>>>11),M=T+(w^(k|~N))+I[12]+1700485571&4294967295,T=k+(M<<6&4294967295|M>>>26),M=N+(k^(T|~w))+I[3]+2399980690&4294967295,N=T+(M<<10&4294967295|M>>>22),M=w+(T^(N|~k))+I[10]+4293915773&4294967295,w=N+(M<<15&4294967295|M>>>17),M=k+(N^(w|~T))+I[1]+2240044497&4294967295,k=w+(M<<21&4294967295|M>>>11),M=T+(w^(k|~N))+I[8]+1873313359&4294967295,T=k+(M<<6&4294967295|M>>>26),M=N+(k^(T|~w))+I[15]+4264355552&4294967295,N=T+(M<<10&4294967295|M>>>22),M=w+(T^(N|~k))+I[6]+2734768916&4294967295,w=N+(M<<15&4294967295|M>>>17),M=k+(N^(w|~T))+I[13]+1309151649&4294967295,k=w+(M<<21&4294967295|M>>>11),M=T+(w^(k|~N))+I[4]+4149444226&4294967295,T=k+(M<<6&4294967295|M>>>26),M=N+(k^(T|~w))+I[11]+3174756917&4294967295,N=T+(M<<10&4294967295|M>>>22),M=w+(T^(N|~k))+I[2]+718787259&4294967295,w=N+(M<<15&4294967295|M>>>17),M=k+(N^(w|~T))+I[9]+3951481745&4294967295,O.g[0]=O.g[0]+T&4294967295,O.g[1]=O.g[1]+(w+(M<<21&4294967295|M>>>11))&4294967295,O.g[2]=O.g[2]+w&4294967295,O.g[3]=O.g[3]+N&4294967295}i.prototype.v=function(O,T){T===void 0&&(T=O.length);let k=T-this.blockSize,I=this.C,w=this.h,N=0;for(;N<T;){if(w==0)for(;N<=k;)r(this,O,N),N+=this.blockSize;if(typeof O=="string"){for(;N<T;)if(I[w++]=O.charCodeAt(N++),w==this.blockSize){r(this,I),w=0;break}}else for(;N<T;)if(I[w++]=O[N++],w==this.blockSize){r(this,I),w=0;break}}this.h=w,this.o+=T},i.prototype.A=function(){var O=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);O[0]=128;for(var T=1;T<O.length-8;++T)O[T]=0;T=this.o*8;for(var k=O.length-8;k<O.length;++k)O[k]=T&255,T/=256;for(this.v(O),O=Array(16),T=0,k=0;k<4;++k)for(let I=0;I<32;I+=8)O[T++]=this.g[k]>>>I&255;return O};function o(O,T){var k=a;return Object.prototype.hasOwnProperty.call(k,O)?k[O]:k[O]=T(O)}function s(O,T){this.h=T;let k=[],I=!0;for(let w=O.length-1;w>=0;w--){let N=O[w]|0;I&&N==T||(k[w]=N,I=!1)}this.g=k}var a={};function l(O){return-128<=O&&O<128?o(O,function(T){return new s([T|0],T<0?-1:0)}):new s([O|0],O<0?-1:0)}function c(O){if(isNaN(O)||!isFinite(O))return h;if(O<0)return R(c(-O));let T=[],k=1;for(let I=0;O>=k;I++)T[I]=O/k|0,k*=4294967296;return new s(T,0)}function d(O,T){if(O.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(O.charAt(0)=="-")return R(d(O.substring(1),T));if(O.indexOf("-")>=0)throw Error('number format error: interior "-" character');let k=c(Math.pow(T,8)),I=h;for(let N=0;N<O.length;N+=8){var w=Math.min(8,O.length-N);let M=parseInt(O.substring(N,N+w),T);w<8?(w=c(Math.pow(T,w)),I=I.j(w).add(c(M))):(I=I.j(k),I=I.add(c(M)))}return I}var h=l(0),f=l(1),g=l(16777216);n=s.prototype,n.m=function(){if(S(this))return-R(this).m();let O=0,T=1;for(let k=0;k<this.g.length;k++){let I=this.i(k);O+=(I>=0?I:4294967296+I)*T,T*=4294967296}return O},n.toString=function(O){if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(x(this))return"0";if(S(this))return"-"+R(this).toString(O);let T=c(Math.pow(O,6));var k=this;let I="";for(;;){let w=_e(k,T).g;k=L(k,w.j(T));let N=((k.g.length>0?k.g[0]:k.h)>>>0).toString(O);if(k=w,x(k))return N+I;for(;N.length<6;)N="0"+N;I=N+I}},n.i=function(O){return O<0?0:O<this.g.length?this.g[O]:this.h};function x(O){if(O.h!=0)return!1;for(let T=0;T<O.g.length;T++)if(O.g[T]!=0)return!1;return!0}function S(O){return O.h==-1}n.l=function(O){return O=L(this,O),S(O)?-1:x(O)?0:1};function R(O){let T=O.g.length,k=[];for(let I=0;I<T;I++)k[I]=~O.g[I];return new s(k,~O.h).add(f)}n.abs=function(){return S(this)?R(this):this},n.add=function(O){let T=Math.max(this.g.length,O.g.length),k=[],I=0;for(let w=0;w<=T;w++){let N=I+(this.i(w)&65535)+(O.i(w)&65535),M=(N>>>16)+(this.i(w)>>>16)+(O.i(w)>>>16);I=M>>>16,N&=65535,M&=65535,k[w]=M<<16|N}return new s(k,k[k.length-1]&-2147483648?-1:0)};function L(O,T){return O.add(R(T))}n.j=function(O){if(x(this)||x(O))return h;if(S(this))return S(O)?R(this).j(R(O)):R(R(this).j(O));if(S(O))return R(this.j(R(O)));if(this.l(g)<0&&O.l(g)<0)return c(this.m()*O.m());let T=this.g.length+O.g.length,k=[];for(var I=0;I<2*T;I++)k[I]=0;for(I=0;I<this.g.length;I++)for(let w=0;w<O.g.length;w++){let N=this.i(I)>>>16,M=this.i(I)&65535,ae=O.i(w)>>>16,be=O.i(w)&65535;k[2*I+2*w]+=M*be,q(k,2*I+2*w),k[2*I+2*w+1]+=N*be,q(k,2*I+2*w+1),k[2*I+2*w+1]+=M*ae,q(k,2*I+2*w+1),k[2*I+2*w+2]+=N*ae,q(k,2*I+2*w+2)}for(O=0;O<T;O++)k[O]=k[2*O+1]<<16|k[2*O];for(O=T;O<2*T;O++)k[O]=0;return new s(k,0)};function q(O,T){for(;(O[T]&65535)!=O[T];)O[T+1]+=O[T]>>>16,O[T]&=65535,T++}function ye(O,T){this.g=O,this.h=T}function _e(O,T){if(x(T))throw Error("division by zero");if(x(O))return new ye(h,h);if(S(O))return T=_e(R(O),T),new ye(R(T.g),R(T.h));if(S(T))return T=_e(O,R(T)),new ye(R(T.g),T.h);if(O.g.length>30){if(S(O)||S(T))throw Error("slowDivide_ only works with positive integers.");for(var k=f,I=T;I.l(O)<=0;)k=xe(k),I=xe(I);var w=Ie(k,1),N=Ie(I,1);for(I=Ie(I,2),k=Ie(k,2);!x(I);){var M=N.add(I);M.l(O)<=0&&(w=w.add(k),N=M),I=Ie(I,1),k=Ie(k,1)}return T=L(O,w.j(T)),new ye(w,T)}for(w=h;O.l(T)>=0;){for(k=Math.max(1,Math.floor(O.m()/T.m())),I=Math.ceil(Math.log(k)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),N=c(k),M=N.j(T);S(M)||M.l(O)>0;)k-=I,N=c(k),M=N.j(T);x(N)&&(N=f),w=w.add(N),O=L(O,M)}return new ye(w,O)}n.B=function(O){return _e(this,O).h},n.and=function(O){let T=Math.max(this.g.length,O.g.length),k=[];for(let I=0;I<T;I++)k[I]=this.i(I)&O.i(I);return new s(k,this.h&O.h)},n.or=function(O){let T=Math.max(this.g.length,O.g.length),k=[];for(let I=0;I<T;I++)k[I]=this.i(I)|O.i(I);return new s(k,this.h|O.h)},n.xor=function(O){let T=Math.max(this.g.length,O.g.length),k=[];for(let I=0;I<T;I++)k[I]=this.i(I)^O.i(I);return new s(k,this.h^O.h)};function xe(O){let T=O.g.length+1,k=[];for(let I=0;I<T;I++)k[I]=O.i(I)<<1|O.i(I-1)>>>31;return new s(k,O.h)}function Ie(O,T){let k=T>>5;T%=32;let I=O.g.length-k,w=[];for(let N=0;N<I;N++)w[N]=T>0?O.i(N+k)>>>T|O.i(N+k+1)<<32-T:O.i(N+k);return new s(w,O.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Yb=FR.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=d,_o=FR.Integer=s}).apply(typeof OR<"u"?OR:typeof self<"u"?self:typeof window<"u"?window:{});var Yg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Eo={};var Qb,N9,Kl,Jb,xd,Qg,Xb,Zb,ew;(function(){var n,e=Object.defineProperty;function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yg=="object"&&Yg];for(var p=0;p<u.length;++p){var E=u[p];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function r(u,p){if(p)e:{var E=i;u=u.split(".");for(var C=0;C<u.length-1;C++){var B=u[C];if(!(B in E))break e;E=E[B]}u=u[u.length-1],C=E[u],p=p(C),p!=C&&p!=null&&e(E,u,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(u){return u||function(p){var E=[],C;for(C in p)Object.prototype.hasOwnProperty.call(p,C)&&E.push([C,p[C]]);return E}});var o=o||{},s=this||self;function a(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function l(u,p,E){return u.call.apply(u.bind,arguments)}function c(u,p,E){return c=l,c.apply(null,arguments)}function d(u,p){var E=Array.prototype.slice.call(arguments,1);return function(){var C=E.slice();return C.push.apply(C,arguments),u.apply(this,C)}}function h(u,p){function E(){}E.prototype=p.prototype,u.Z=p.prototype,u.prototype=new E,u.prototype.constructor=u,u.Ob=function(C,B,H){for(var ge=Array(arguments.length-2),Xe=2;Xe<arguments.length;Xe++)ge[Xe-2]=arguments[Xe];return p.prototype[B].apply(C,ge)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function g(u){let p=u.length;if(p>0){let E=Array(p);for(let C=0;C<p;C++)E[C]=u[C];return E}return[]}function x(u,p){for(let C=1;C<arguments.length;C++){let B=arguments[C];var E=typeof B;if(E=E!="object"?E:B?Array.isArray(B)?"array":E:"null",E=="array"||E=="object"&&typeof B.length=="number"){E=u.length||0;let H=B.length||0;u.length=E+H;for(let ge=0;ge<H;ge++)u[E+ge]=B[ge]}else u.push(B)}}class S{constructor(p,E){this.i=p,this.j=E,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function R(u){s.setTimeout(()=>{throw u},0)}function L(){var u=O;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class q{constructor(){this.h=this.g=null}add(p,E){let C=ye.get();C.set(p,E),this.h?this.h.next=C:this.g=C,this.h=C}}var ye=new S(()=>new _e,u=>u.reset());class _e{constructor(){this.next=this.g=this.h=null}set(p,E){this.h=p,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,Ie=!1,O=new q,T=()=>{let u=Promise.resolve(void 0);xe=()=>{u.then(k)}};function k(){for(var u;u=L();){try{u.h.call(u.g)}catch(E){R(E)}var p=ye;p.j(u),p.h<100&&(p.h++,u.next=p.g,p.g=u)}Ie=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var N=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let E=()=>{};s.addEventListener("test",E,p),s.removeEventListener("test",E,p)}catch{}return u})();function M(u){return/^[\s\xa0]*$/.test(u)}function ae(u,p){w.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,p)}h(ae,w),ae.prototype.init=function(u,p){let E=this.type=u.type,C=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget,p||(E=="mouseover"?p=u.fromElement:E=="mouseout"&&(p=u.toElement)),this.relatedTarget=p,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);let u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var be="closure_listenable_"+(Math.random()*1e6|0),de=0;function Tt(u,p,E,C,B){this.listener=u,this.proxy=null,this.src=p,this.type=E,this.capture=!!C,this.ha=B,this.key=++de,this.da=this.fa=!1}function Xt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Pe(u,p,E){for(let C in u)p.call(E,u[C],C,u)}function Wt(u,p){for(let E in u)p.call(void 0,u[E],E,u)}function lt(u){let p={};for(let E in u)p[E]=u[E];return p}let oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function se(u,p){let E,C;for(let B=1;B<arguments.length;B++){C=arguments[B];for(E in C)u[E]=C[E];for(let H=0;H<oe.length;H++)E=oe[H],Object.prototype.hasOwnProperty.call(C,E)&&(u[E]=C[E])}}function Se(u){this.src=u,this.g={},this.h=0}Se.prototype.add=function(u,p,E,C,B){let H=u.toString();u=this.g[H],u||(u=this.g[H]=[],this.h++);let ge=ve(u,p,C,B);return ge>-1?(p=u[ge],E||(p.fa=!1)):(p=new Tt(p,this.src,H,!!C,B),p.fa=E,u.push(p)),p};function Ee(u,p){let E=p.type;if(E in u.g){var C=u.g[E],B=Array.prototype.indexOf.call(C,p,void 0),H;(H=B>=0)&&Array.prototype.splice.call(C,B,1),H&&(Xt(p),u.g[E].length==0&&(delete u.g[E],u.h--))}}function ve(u,p,E,C){for(let B=0;B<u.length;++B){let H=u[B];if(!H.da&&H.listener==p&&H.capture==!!E&&H.ha==C)return B}return-1}var b="closure_lm_"+(Math.random()*1e6|0),ue={};function qe(u,p,E,C,B){if(C&&C.once)return wt(u,p,E,C,B);if(Array.isArray(p)){for(let H=0;H<p.length;H++)qe(u,p[H],E,C,B);return null}return E=Mc(E),u&&u[be]?u.J(p,E,a(C)?!!C.capture:!!C,B):Ke(u,p,E,!1,C,B)}function Ke(u,p,E,C,B,H){if(!p)throw Error("Invalid event type");let ge=a(B)?!!B.capture:!!B,Xe=$n(u);if(Xe||(u[b]=Xe=new Se(u)),E=Xe.add(p,E,C,ge,H),E.proxy)return E;if(C=le(),E.proxy=C,C.src=u,C.listener=E,u.addEventListener)N||(B=ge),B===void 0&&(B=!1),u.addEventListener(p.toString(),C,B);else if(u.attachEvent)u.attachEvent(Ns(p.toString()),C);else if(u.addListener&&u.removeListener)u.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return E}function le(){function u(E){return p.call(u.src,u.listener,E)}let p=yh;return u}function wt(u,p,E,C,B){if(Array.isArray(p)){for(let H=0;H<p.length;H++)wt(u,p[H],E,C,B);return null}return E=Mc(E),u&&u[be]?u.K(p,E,a(C)?!!C.capture:!!C,B):Ke(u,p,E,!0,C,B)}function Ti(u,p,E,C,B){if(Array.isArray(p))for(var H=0;H<p.length;H++)Ti(u,p[H],E,C,B);else C=a(C)?!!C.capture:!!C,E=Mc(E),u&&u[be]?(u=u.i,H=String(p).toString(),H in u.g&&(p=u.g[H],E=ve(p,E,C,B),E>-1&&(Xt(p[E]),Array.prototype.splice.call(p,E,1),p.length==0&&(delete u.g[H],u.h--)))):u&&(u=$n(u))&&(p=u.g[p.toString()],u=-1,p&&(u=ve(p,E,C,B)),(E=u>-1?p[u]:null)&&ai(E))}function ai(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[be])Ee(p.i,u);else{var E=u.type,C=u.proxy;p.removeEventListener?p.removeEventListener(E,C,u.capture):p.detachEvent?p.detachEvent(Ns(E),C):p.addListener&&p.removeListener&&p.removeListener(C),(E=$n(p))?(Ee(E,u),E.h==0&&(E.src=null,p[b]=null)):Xt(u)}}}function Ns(u){return u in ue?ue[u]:ue[u]="on"+u}function yh(u,p){if(u.da)u=!0;else{p=new ae(p,this);let E=u.listener,C=u.ha||u.src;u.fa&&ai(u),u=E.call(C,p)}return u}function $n(u){return u=u[b],u instanceof Se?u:null}var Ac="__closure_events_fn_"+(Math.random()*1e9>>>0);function Mc(u){return typeof u=="function"?u:(u[Ac]||(u[Ac]=function(p){return u.handleEvent(p)}),u[Ac])}function Nn(){I.call(this),this.i=new Se(this),this.M=this,this.G=null}h(Nn,I),Nn.prototype[be]=!0,Nn.prototype.removeEventListener=function(u,p,E,C){Ti(this,u,p,E,C)};function Ot(u,p){var E,C=u.G;if(C)for(E=[];C;C=C.G)E.push(C);if(u=u.M,C=p.type||p,typeof p=="string")p=new w(p,u);else if(p instanceof w)p.target=p.target||u;else{var B=p;p=new w(C,u),se(p,B)}B=!0;let H,ge;if(E)for(ge=E.length-1;ge>=0;ge--)H=p.g=E[ge],B=Kr(H,C,!0,p)&&B;if(H=p.g=u,B=Kr(H,C,!0,p)&&B,B=Kr(H,C,!1,p)&&B,E)for(ge=0;ge<E.length;ge++)H=p.g=E[ge],B=Kr(H,C,!1,p)&&B}Nn.prototype.N=function(){if(Nn.Z.N.call(this),this.i){var u=this.i;for(let p in u.g){let E=u.g[p];for(let C=0;C<E.length;C++)Xt(E[C]);delete u.g[p],u.h--}}this.G=null},Nn.prototype.J=function(u,p,E,C){return this.i.add(String(u),p,!1,E,C)},Nn.prototype.K=function(u,p,E,C){return this.i.add(String(u),p,!0,E,C)};function Kr(u,p,E,C){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();let B=!0;for(let H=0;H<p.length;++H){let ge=p[H];if(ge&&!ge.da&&ge.capture==E){let Xe=ge.listener,gn=ge.ha||ge.src;ge.fa&&Ee(u.i,ge),B=Xe.call(gn,C)!==!1&&B}}return B&&!C.defaultPrevented}function V0(u,p){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=c(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:s.setTimeout(u,p||0)}function hr(u){u.g=V0(()=>{u.g=null,u.i&&(u.i=!1,hr(u))},u.l);let p=u.h;u.h=null,u.m.apply(null,p)}class Bo extends I{constructor(p,E){super(),this.m=p,this.l=E,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:hr(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ps(u){I.call(this),this.h=u,this.g={}}h(Ps,I);var z=[];function U(u){Pe(u.g,function(p,E){this.g.hasOwnProperty(E)&&ai(p)},u),u.g={}}Ps.prototype.N=function(){Ps.Z.N.call(this),U(this)},Ps.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Z=s.JSON.stringify,ne=s.JSON.parse,Me=class{stringify(u){return s.JSON.stringify(u,void 0)}parse(u){return s.JSON.parse(u,void 0)}};function Ve(){}function Ze(){}var dt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function xt(){w.call(this,"d")}h(xt,w);function mt(){w.call(this,"c")}h(mt,w);var En={},jo=null;function Ka(){return jo=jo||new Nn}En.Ia="serverreachability";function Rc(u){w.call(this,En.Ia,u)}h(Rc,w);function li(u){let p=Ka();Ot(p,new Rc(p))}En.STAT_EVENT="statevent";function Yr(u,p){w.call(this,En.STAT_EVENT,u),this.stat=p}h(Yr,w);function qt(u){let p=Ka();Ot(p,new Yr(p,u))}En.Ja="timingevent";function vh(u,p){w.call(this,En.Ja,u),this.size=p}h(vh,w);function Qr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){u()},p)}function Jr(){this.g=!0}Jr.prototype.ua=function(){this.g=!1};function U0(u,p,E,C,B,H){u.info(function(){if(u.g)if(H){var ge="",Xe=H.split("&");for(let At=0;At<Xe.length;At++){var gn=Xe[At].split("=");if(gn.length>1){let wn=gn[0];gn=gn[1];let pr=wn.split("_");ge=pr.length>=2&&pr[1]=="type"?ge+(wn+"="+gn+"&"):ge+(wn+"=redacted&")}}}else ge=null;else ge=H;return"XMLHTTP REQ ("+C+") [attempt "+B+"]: "+p+`
`+E+`
`+ge})}function Yx(u,p,E,C,B,H,ge){u.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+B+"]: "+p+`
`+E+`
`+H+" "+ge})}function Gi(u,p,E,C){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+j0(u,E)+(C?" "+C:"")})}function B0(u,p){u.info(function(){return"TIMEOUT: "+p})}Jr.prototype.info=function(){};function j0(u,p){if(!u.g)return p;if(!p)return null;try{let H=JSON.parse(p);if(H){for(u=0;u<H.length;u++)if(Array.isArray(H[u])){var E=H[u];if(!(E.length<2)){var C=E[1];if(Array.isArray(C)&&!(C.length<1)){var B=C[0];if(B!="noop"&&B!="stop"&&B!="close")for(let ge=1;ge<C.length;ge++)C[ge]=""}}}}return Z(H)}catch{return p}}var Te={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},He={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Rt;function Bt(){}h(Bt,Ve),Bt.prototype.g=function(){return new XMLHttpRequest},Rt=new Bt;function Ft(u){return encodeURIComponent(String(u))}function bn(u){var p=1;u=u.split(":");let E=[];for(;p>0&&u.length;)E.push(u.shift()),p--;return u.length&&E.push(u.join(":")),E}function Lt(u,p,E,C){this.j=u,this.i=p,this.l=E,this.S=C||1,this.V=new Ps(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ks}function ks(){this.i=null,this.g="",this.h=!1}var Qx={},H0={};function G0(u,p,E){u.M=1,u.A=Eh(fr(p)),u.u=E,u.R=!0,Jx(u,null)}function Jx(u,p){u.F=Date.now(),_h(u),u.B=fr(u.A);var E=u.B,C=u.S;Array.isArray(C)||(C=[String(C)]),uS(E.i,"t",C),u.C=0,E=u.j.L,u.h=new ks,u.g=DS(u.j,E?p:null,!u.u),u.P>0&&(u.O=new Bo(c(u.Y,u,u.g),u.P)),p=u.V,E=u.g,C=u.ba;var B="readystatechange";Array.isArray(B)||(B&&(z[0]=B.toString()),B=z);for(let H=0;H<B.length;H++){let ge=qe(E,B[H],C||p.handleEvent,!1,p.h||p);if(!ge)break;p.g[ge.key]=ge}p=u.J?lt(u.J):{},u.u?(u.v||(u.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,p)):(u.v="GET",u.g.ea(u.B,u.v,null,p)),li(),U0(u.i,u.v,u.B,u.l,u.S,u.u)}Lt.prototype.ba=function(u){u=u.target;let p=this.O;p&&$o(u)==3?p.j():this.Y(u)},Lt.prototype.Y=function(u){try{if(u==this.g)e:{let Xe=$o(this.g),gn=this.g.ya(),At=this.g.ca();if(!(Xe<3)&&(Xe!=3||this.g&&(this.h.h||this.g.la()||yS(this.g)))){this.K||Xe!=4||gn==7||(gn==8||At<=0?li(3):li(2)),$0(this);var p=this.g.ca();this.X=p;var E=GO(this);if(this.o=p==200,Yx(this.i,this.v,this.B,this.l,this.S,Xe,p),this.o){if(this.U&&!this.L){t:{if(this.g){var C,B=this.g;if((C=B.g?B.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(C)){var H=C;break t}}H=null}if(u=H)Gi(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,z0(this,u);else{this.o=!1,this.m=3,qt(12),Os(this),Nc(this);break e}}if(this.R){u=!0;let wn;for(;!this.K&&this.C<E.length;)if(wn=$O(this,E),wn==H0){Xe==4&&(this.m=4,qt(14),u=!1),Gi(this.i,this.l,null,"[Incomplete Response]");break}else if(wn==Qx){this.m=4,qt(15),Gi(this.i,this.l,E,"[Invalid Chunk]"),u=!1;break}else Gi(this.i,this.l,wn,null),z0(this,wn);if(Xx(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xe!=4||E.length!=0||this.h.h||(this.m=1,qt(16),u=!1),this.o=this.o&&u,!u)Gi(this.i,this.l,E,"[Invalid Chunked Response]"),Os(this),Nc(this);else if(E.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),X0(ge),ge.P=!0,qt(11))}}else Gi(this.i,this.l,E,null),z0(this,E);Xe==4&&Os(this),this.o&&!this.K&&(Xe==4?SS(this.j,this):(this.o=!1,_h(this)))}else r4(this.g),p==400&&E.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),Os(this),Nc(this)}}}catch{}};function GO(u){if(!Xx(u))return u.g.la();let p=yS(u.g);if(p==="")return"";let E="",C=p.length,B=$o(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Os(u),Nc(u),"";u.h.i=new s.TextDecoder}for(let H=0;H<C;H++)u.h.h=!0,E+=u.h.i.decode(p[H],{stream:!(B&&H==C-1)});return p.length=0,u.h.g+=E,u.C=0,u.h.g}function Xx(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function $O(u,p){var E=u.C,C=p.indexOf(`
`,E);return C==-1?H0:(E=Number(p.substring(E,C)),isNaN(E)?Qx:(C+=1,C+E>p.length?H0:(p=p.slice(C,C+E),u.C=C+E,p)))}Lt.prototype.cancel=function(){this.K=!0,Os(this)};function _h(u){u.T=Date.now()+u.H,Zx(u,u.H)}function Zx(u,p){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Qr(c(u.aa,u),p)}function $0(u){u.D&&(s.clearTimeout(u.D),u.D=null)}Lt.prototype.aa=function(){this.D=null;let u=Date.now();u-this.T>=0?(B0(this.i,this.B),this.M!=2&&(li(),qt(17)),Os(this),this.m=2,Nc(this)):Zx(this,this.T-u)};function Nc(u){u.j.I==0||u.K||SS(u.j,u)}function Os(u){$0(u);var p=u.O;p&&typeof p.dispose=="function"&&p.dispose(),u.O=null,U(u.V),u.g&&(p=u.g,u.g=null,p.abort(),p.dispose())}function z0(u,p){try{var E=u.j;if(E.I!=0&&(E.g==u||W0(E.h,u))){if(!u.L&&W0(E.h,u)&&E.I==3){try{var C=E.Ba.g.parse(p)}catch{C=null}if(Array.isArray(C)&&C.length==3){var B=C;if(B[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<u.F)Th(E),Sh(E);else break e;J0(E),qt(18)}}else E.xa=B[1],0<E.xa-E.K&&B[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Qr(c(E.Va,E),6e3));nS(E.h)<=1&&E.ta&&(E.ta=void 0)}else Ls(E,11)}else if((u.L||E.g==u)&&Th(E),!M(p))for(B=E.Ba.g.parse(p),p=0;p<B.length;p++){let At=B[p],wn=At[0];if(!(wn<=E.K))if(E.K=wn,At=At[1],E.I==2)if(At[0]=="c"){E.M=At[1],E.ba=At[2];let pr=At[3];pr!=null&&(E.ka=pr,E.j.info("VER="+E.ka));let Vs=At[4];Vs!=null&&(E.za=Vs,E.j.info("SVER="+E.za));let zo=At[5];zo!=null&&typeof zo=="number"&&zo>0&&(C=1.5*zo,E.O=C,E.j.info("backChannelRequestTimeoutMs_="+C)),C=E;let Wo=u.g;if(Wo){let Dh=Wo.g?Wo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Dh){var H=C.h;H.g||Dh.indexOf("spdy")==-1&&Dh.indexOf("quic")==-1&&Dh.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(q0(H,H.h),H.h=null))}if(C.G){let Z0=Wo.g?Wo.g.getResponseHeader("X-HTTP-Session-Id"):null;Z0&&(C.wa=Z0,Vt(C.J,C.G,Z0))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-u.F,E.j.info("Handshake RTT: "+E.T+"ms")),C=E;var ge=u;if(C.na=CS(C,C.L?C.ba:null,C.W),ge.L){iS(C.h,ge);var Xe=ge,gn=C.O;gn&&(Xe.H=gn),Xe.D&&($0(Xe),_h(Xe)),C.g=ge}else wS(C);E.i.length>0&&Ih(E)}else At[0]!="stop"&&At[0]!="close"||Ls(E,7);else E.I==3&&(At[0]=="stop"||At[0]=="close"?At[0]=="stop"?Ls(E,7):Q0(E):At[0]!="noop"&&E.l&&E.l.qa(At),E.A=0)}}li(4)}catch{}}var zO=class{constructor(u,p){this.g=u,this.map=p}};function eS(u){this.l=u||10,s.PerformanceNavigationTiming?(u=s.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function tS(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function nS(u){return u.h?1:u.g?u.g.size:0}function W0(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function q0(u,p){u.g?u.g.add(p):u.h=p}function iS(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}eS.prototype.cancel=function(){if(this.i=rS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function rS(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let p=u.i;for(let E of u.g.values())p=p.concat(E.G);return p}return g(u.i)}var oS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function WO(u,p){if(u){u=u.split("&");for(let E=0;E<u.length;E++){let C=u[E].indexOf("="),B,H=null;C>=0?(B=u[E].substring(0,C),H=u[E].substring(C+1)):B=u[E],p(B,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Ho(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;u instanceof Ho?(this.l=u.l,Pc(this,u.j),this.o=u.o,this.g=u.g,kc(this,u.u),this.h=u.h,K0(this,dS(u.i)),this.m=u.m):u&&(p=String(u).match(oS))?(this.l=!1,Pc(this,p[1]||"",!0),this.o=Oc(p[2]||""),this.g=Oc(p[3]||"",!0),kc(this,p[4]),this.h=Oc(p[5]||"",!0),K0(this,p[6]||"",!0),this.m=Oc(p[7]||"")):(this.l=!1,this.i=new Lc(null,this.l))}Ho.prototype.toString=function(){let u=[];var p=this.j;p&&u.push(Fc(p,sS,!0),":");var E=this.g;return(E||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Fc(p,sS,!0),"@"),u.push(Ft(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&u.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&u.push("/"),u.push(Fc(E,E.charAt(0)=="/"?YO:KO,!0))),(E=this.i.toString())&&u.push("?",E),(E=this.m)&&u.push("#",Fc(E,JO)),u.join("")},Ho.prototype.resolve=function(u){let p=fr(this),E=!!u.j;E?Pc(p,u.j):E=!!u.o,E?p.o=u.o:E=!!u.g,E?p.g=u.g:E=u.u!=null;var C=u.h;if(E)kc(p,u.u);else if(E=!!u.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var B=p.h.lastIndexOf("/");B!=-1&&(C=p.h.slice(0,B+1)+C)}if(B=C,B==".."||B==".")C="";else if(B.indexOf("./")!=-1||B.indexOf("/.")!=-1){C=B.lastIndexOf("/",0)==0,B=B.split("/");let H=[];for(let ge=0;ge<B.length;){let Xe=B[ge++];Xe=="."?C&&ge==B.length&&H.push(""):Xe==".."?((H.length>1||H.length==1&&H[0]!="")&&H.pop(),C&&ge==B.length&&H.push("")):(H.push(Xe),C=!0)}C=H.join("/")}else C=B}return E?p.h=C:E=u.i.toString()!=="",E?K0(p,dS(u.i)):E=!!u.m,E&&(p.m=u.m),p};function fr(u){return new Ho(u)}function Pc(u,p,E){u.j=E?Oc(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function kc(u,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);u.u=p}else u.u=null}function K0(u,p,E){p instanceof Lc?(u.i=p,XO(u.i,u.l)):(E||(p=Fc(p,QO)),u.i=new Lc(p,u.l))}function Vt(u,p,E){u.i.set(p,E)}function Eh(u){return Vt(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function Oc(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Fc(u,p,E){return typeof u=="string"?(u=encodeURI(u).replace(p,qO),E&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function qO(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var sS=/[#\/\?@]/g,KO=/[#\?:]/g,YO=/[#\?]/g,QO=/[#\?@]/g,JO=/#/g;function Lc(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Fs(u){u.g||(u.g=new Map,u.h=0,u.i&&WO(u.i,function(p,E){u.add(decodeURIComponent(p.replace(/\+/g," ")),E)}))}n=Lc.prototype,n.add=function(u,p){Fs(this),this.i=null,u=Ya(this,u);let E=this.g.get(u);return E||this.g.set(u,E=[]),E.push(p),this.h+=1,this};function aS(u,p){Fs(u),p=Ya(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function lS(u,p){return Fs(u),p=Ya(u,p),u.g.has(p)}n.forEach=function(u,p){Fs(this),this.g.forEach(function(E,C){E.forEach(function(B){u.call(p,B,C,this)},this)},this)};function cS(u,p){Fs(u);let E=[];if(typeof p=="string")lS(u,p)&&(E=E.concat(u.g.get(Ya(u,p))));else for(u=Array.from(u.g.values()),p=0;p<u.length;p++)E=E.concat(u[p]);return E}n.set=function(u,p){return Fs(this),this.i=null,u=Ya(this,u),lS(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=cS(this,u),u.length>0?String(u[0]):p):p};function uS(u,p,E){aS(u,p),E.length>0&&(u.i=null,u.g.set(Ya(u,p),g(E)),u.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],p=Array.from(this.g.keys());for(let C=0;C<p.length;C++){var E=p[C];let B=Ft(E);E=cS(this,E);for(let H=0;H<E.length;H++){let ge=B;E[H]!==""&&(ge+="="+Ft(E[H])),u.push(ge)}}return this.i=u.join("&")};function dS(u){let p=new Lc;return p.i=u.i,u.g&&(p.g=new Map(u.g),p.h=u.h),p}function Ya(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function XO(u,p){p&&!u.j&&(Fs(u),u.i=null,u.g.forEach(function(E,C){let B=C.toLowerCase();C!=B&&(aS(this,C),uS(this,B,E))},u)),u.j=p}function ZO(u,p){let E=new Jr;if(s.Image){let C=new Image;C.onload=d(Go,E,"TestLoadImage: loaded",!0,p,C),C.onerror=d(Go,E,"TestLoadImage: error",!1,p,C),C.onabort=d(Go,E,"TestLoadImage: abort",!1,p,C),C.ontimeout=d(Go,E,"TestLoadImage: timeout",!1,p,C),s.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=u}else p(!1)}function e4(u,p){let E=new Jr,C=new AbortController,B=setTimeout(()=>{C.abort(),Go(E,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:C.signal}).then(H=>{clearTimeout(B),H.ok?Go(E,"TestPingServer: ok",!0,p):Go(E,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(B),Go(E,"TestPingServer: error",!1,p)})}function Go(u,p,E,C,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),C(E)}catch{}}function t4(){this.g=new Me}function bh(u){this.i=u.Sb||null,this.h=u.ab||!1}h(bh,Ve),bh.prototype.g=function(){return new wh(this.i,this.h)};function wh(u,p){Nn.call(this),this.H=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(wh,Nn),n=wh.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=p,this.readyState=1,Uc(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(p.body=u),(this.H||s).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Vc(this)),this.readyState=0},n.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Uc(this)),this.g&&(this.readyState=3,Uc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;hS(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function hS(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}n.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Vc(this):Uc(this),this.readyState==3&&hS(this)}},n.Oa=function(u){this.g&&(this.response=this.responseText=u,Vc(this))},n.Na=function(u){this.g&&(this.response=u,Vc(this))},n.ga=function(){this.g&&Vc(this)};function Vc(u){u.readyState=4,u.l=null,u.j=null,u.B=null,Uc(u)}n.setRequestHeader=function(u,p){this.A.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],p=this.h.entries();for(var E=p.next();!E.done;)E=E.value,u.push(E[0]+": "+E[1]),E=p.next();return u.join(`\r
`)};function Uc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(wh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function fS(u){let p="";return Pe(u,function(E,C){p+=C,p+=":",p+=E,p+=`\r
`}),p}function Y0(u,p,E){e:{for(C in E){var C=!1;break e}C=!0}C||(E=fS(E),typeof u=="string"?E!=null&&Ft(E):Vt(u,p,E))}function Kt(u){Nn.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Kt,Nn);var n4=/^https?$/i,i4=["POST","PUT"];n=Kt.prototype,n.Fa=function(u){this.H=u},n.ea=function(u,p,E,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Rt.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(H){pS(this,H);return}if(u=E||"",E=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var B in C)E.set(B,C[B]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(let H of C.keys())E.set(H,C.get(H));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(E.keys()).find(H=>H.toLowerCase()=="content-type"),B=s.FormData&&u instanceof s.FormData,!(Array.prototype.indexOf.call(i4,p,void 0)>=0)||C||B||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[H,ge]of E)this.g.setRequestHeader(H,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(H){pS(this,H)}};function pS(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.o=5,gS(u),xh(u)}function gS(u){u.A||(u.A=!0,Ot(u,"complete"),Ot(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,Ot(this,"complete"),Ot(this,"abort"),xh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xh(this,!0)),Kt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?mS(this):this.Xa())},n.Xa=function(){mS(this)};function mS(u){if(u.h&&typeof o<"u"){if(u.v&&$o(u)==4)setTimeout(u.Ca.bind(u),0);else if(Ot(u,"readystatechange"),$o(u)==4){u.h=!1;try{let H=u.ca();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var E;if(!(E=p)){var C;if(C=H===0){let ge=String(u.D).match(oS)[1]||null;!ge&&s.self&&s.self.location&&(ge=s.self.location.protocol.slice(0,-1)),C=!n4.test(ge?ge.toLowerCase():"")}E=C}if(E)Ot(u,"complete"),Ot(u,"success");else{u.o=6;try{var B=$o(u)>2?u.g.statusText:""}catch{B=""}u.l=B+" ["+u.ca()+"]",gS(u)}}finally{xh(u)}}}}function xh(u,p){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);let E=u.g;u.g=null,p||Ot(u,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function $o(u){return u.g?u.g.readyState:0}n.ca=function(){try{return $o(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),ne(p)}};function yS(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function r4(u){let p={};u=(u.g&&$o(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<u.length;C++){if(M(u[C]))continue;var E=bn(u[C]);let B=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();let H=p[B]||[];p[B]=H,H.push(E)}Wt(p,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bc(u,p,E){return E&&E.internalChannelParams&&E.internalChannelParams[u]||p}function vS(u){this.za=0,this.i=[],this.j=new Jr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Bc("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Bc("baseRetryDelayMs",5e3,u),this.Za=Bc("retryDelaySeedMs",1e4,u),this.Ta=Bc("forwardChannelMaxRetries",2,u),this.va=Bc("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new eS(u&&u.concurrentRequestLimit),this.Ba=new t4,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=vS.prototype,n.ka=8,n.I=1,n.connect=function(u,p,E,C){qt(0),this.W=u,this.H=p||{},E&&C!==void 0&&(this.H.OSID=E,this.H.OAID=C),this.F=this.X,this.J=CS(this,null,this.W),Ih(this)};function Q0(u){if(_S(u),u.I==3){var p=u.V++,E=fr(u.J);if(Vt(E,"SID",u.M),Vt(E,"RID",p),Vt(E,"TYPE","terminate"),jc(u,E),p=new Lt(u,u.j,p),p.M=2,p.A=Eh(fr(E)),E=!1,s.navigator&&s.navigator.sendBeacon)try{E=s.navigator.sendBeacon(p.A.toString(),"")}catch{}!E&&s.Image&&(new Image().src=p.A,E=!0),E||(p.g=DS(p.j,null),p.g.ea(p.A)),p.F=Date.now(),_h(p)}TS(u)}function Sh(u){u.g&&(X0(u),u.g.cancel(),u.g=null)}function _S(u){Sh(u),u.v&&(s.clearTimeout(u.v),u.v=null),Th(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&s.clearTimeout(u.m),u.m=null)}function Ih(u){if(!tS(u.h)&&!u.m){u.m=!0;var p=u.Ea;xe||T(),Ie||(xe(),Ie=!0),O.add(p,u),u.D=0}}function o4(u,p){return nS(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=p.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Qr(c(u.Ea,u,p),IS(u,u.D)),u.D++,!0)}n.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;let B=new Lt(this,this.j,u),H=this.o;if(this.U&&(H?(H=lt(H),se(H,this.U)):H=this.U),this.u!==null||this.R||(B.J=H,H=null),this.S)e:{for(var p=0,E=0;E<this.i.length;E++){t:{var C=this.i[E];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(p+=C,p>4096){p=E;break e}if(p===4096||E===this.i.length-1){p=E+1;break e}}p=1e3}else p=1e3;p=bS(this,B,p),E=fr(this.J),Vt(E,"RID",u),Vt(E,"CVER",22),this.G&&Vt(E,"X-HTTP-Session-Id",this.G),jc(this,E),H&&(this.R?p="headers="+Ft(fS(H))+"&"+p:this.u&&Y0(E,this.u,H)),q0(this.h,B),this.Ra&&Vt(E,"TYPE","init"),this.S?(Vt(E,"$req",p),Vt(E,"SID","null"),B.U=!0,G0(B,E,null)):G0(B,E,p),this.I=2}}else this.I==3&&(u?ES(this,u):this.i.length==0||tS(this.h)||ES(this))};function ES(u,p){var E;p?E=p.l:E=u.V++;let C=fr(u.J);Vt(C,"SID",u.M),Vt(C,"RID",E),Vt(C,"AID",u.K),jc(u,C),u.u&&u.o&&Y0(C,u.u,u.o),E=new Lt(u,u.j,E,u.D+1),u.u===null&&(E.J=u.o),p&&(u.i=p.G.concat(u.i)),p=bS(u,E,1e3),E.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),q0(u.h,E),G0(E,C,p)}function jc(u,p){u.H&&Pe(u.H,function(E,C){Vt(p,C,E)}),u.l&&Pe({},function(E,C){Vt(p,C,E)})}function bS(u,p,E){E=Math.min(u.i.length,E);let C=u.l?c(u.l.Ka,u.l,u):null;e:{var B=u.i;let Xe=-1;for(;;){let gn=["count="+E];Xe==-1?E>0?(Xe=B[0].g,gn.push("ofs="+Xe)):Xe=0:gn.push("ofs="+Xe);let At=!0;for(let wn=0;wn<E;wn++){var H=B[wn].g;let pr=B[wn].map;if(H-=Xe,H<0)Xe=Math.max(0,B[wn].g-100),At=!1;else try{H="req"+H+"_"||"";try{var ge=pr instanceof Map?pr:Object.entries(pr);for(let[Vs,zo]of ge){let Wo=zo;a(zo)&&(Wo=Z(zo)),gn.push(H+Vs+"="+encodeURIComponent(Wo))}}catch(Vs){throw gn.push(H+"type="+encodeURIComponent("_badmap")),Vs}}catch{C&&C(pr)}}if(At){ge=gn.join("&");break e}}ge=void 0}return u=u.i.splice(0,E),p.G=u,ge}function wS(u){if(!u.g&&!u.v){u.Y=1;var p=u.Da;xe||T(),Ie||(xe(),Ie=!0),O.add(p,u),u.A=0}}function J0(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Qr(c(u.Da,u),IS(u,u.A)),u.A++,!0)}n.Da=function(){if(this.v=null,xS(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Qr(c(this.Wa,this),u)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),Sh(this),xS(this))};function X0(u){u.B!=null&&(s.clearTimeout(u.B),u.B=null)}function xS(u){u.g=new Lt(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var p=fr(u.na);Vt(p,"RID","rpc"),Vt(p,"SID",u.M),Vt(p,"AID",u.K),Vt(p,"CI",u.F?"0":"1"),!u.F&&u.ia&&Vt(p,"TO",u.ia),Vt(p,"TYPE","xmlhttp"),jc(u,p),u.u&&u.o&&Y0(p,u.u,u.o),u.O&&(u.g.H=u.O);var E=u.g;u=u.ba,E.M=1,E.A=Eh(fr(p)),E.u=null,E.R=!0,Jx(E,u)}n.Va=function(){this.C!=null&&(this.C=null,Sh(this),J0(this),qt(19))};function Th(u){u.C!=null&&(s.clearTimeout(u.C),u.C=null)}function SS(u,p){var E=null;if(u.g==p){Th(u),X0(u),u.g=null;var C=2}else if(W0(u.h,p))E=p.G,iS(u.h,p),C=1;else return;if(u.I!=0){if(p.o)if(C==1){E=p.u?p.u.length:0,p=Date.now()-p.F;var B=u.D;C=Ka(),Ot(C,new vh(C,E)),Ih(u)}else wS(u);else if(B=p.m,B==3||B==0&&p.X>0||!(C==1&&o4(u,p)||C==2&&J0(u)))switch(E&&E.length>0&&(p=u.h,p.i=p.i.concat(E)),B){case 1:Ls(u,5);break;case 4:Ls(u,10);break;case 3:Ls(u,6);break;default:Ls(u,2)}}}function IS(u,p){let E=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(E*=2),E*p}function Ls(u,p){if(u.j.info("Error code "+p),p==2){var E=c(u.bb,u),C=u.Ua;let B=!C;C=new Ho(C||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Pc(C,"https"),Eh(C),B?ZO(C.toString(),E):e4(C.toString(),E)}else qt(2);u.I=0,u.l&&u.l.pa(p),TS(u),_S(u)}n.bb=function(u){u?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function TS(u){if(u.I=0,u.ja=[],u.l){let p=rS(u.h);(p.length!=0||u.i.length!=0)&&(x(u.ja,p),x(u.ja,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.oa()}}function CS(u,p,E){var C=E instanceof Ho?fr(E):new Ho(E);if(C.g!="")p&&(C.g=p+"."+C.g),kc(C,C.u);else{var B=s.location;C=B.protocol,p=p?p+"."+B.hostname:B.hostname,B=+B.port;let H=new Ho(null);C&&Pc(H,C),p&&(H.g=p),B&&kc(H,B),E&&(H.h=E),C=H}return E=u.G,p=u.wa,E&&p&&Vt(C,E,p),Vt(C,"VER",u.ka),jc(u,C),C}function DS(u,p,E){if(p&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Aa&&!u.ma?new Kt(new bh({ab:E})):new Kt(u.ma),p.Fa(u.L),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function AS(){}n=AS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ch(){}Ch.prototype.g=function(u,p){return new ci(u,p)};function ci(u,p){Nn.call(this),this.g=new vS(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(u?u["X-WebChannel-Client-Profile"]=p.sa:u={"X-WebChannel-Client-Profile":p.sa}),this.g.U=u,(u=p&&p.Qb)&&!M(u)&&(this.g.u=u),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!M(p)&&(this.g.G=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Qa(this)}h(ci,Nn),ci.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ci.prototype.close=function(){Q0(this.g)},ci.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var E={};E.__data__=u,u=E}else this.v&&(E={},E.__data__=Z(u),u=E);p.i.push(new zO(p.Ya++,u)),p.I==3&&Ih(p)},ci.prototype.N=function(){this.g.l=null,delete this.j,Q0(this.g),delete this.g,ci.Z.N.call(this)};function MS(u){xt.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(let E in p){u=E;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}h(MS,xt);function RS(){mt.call(this),this.status=1}h(RS,mt);function Qa(u){this.g=u}h(Qa,AS),Qa.prototype.ra=function(){Ot(this.g,"a")},Qa.prototype.qa=function(u){Ot(this.g,new MS(u))},Qa.prototype.pa=function(u){Ot(this.g,new RS)},Qa.prototype.oa=function(){Ot(this.g,"b")},Ch.prototype.createWebChannel=Ch.prototype.g,ci.prototype.send=ci.prototype.o,ci.prototype.open=ci.prototype.m,ci.prototype.close=ci.prototype.close,ew=Eo.createWebChannelTransport=function(){return new Ch},Zb=Eo.getStatEventTarget=function(){return Ka()},Xb=Eo.Event=En,Qg=Eo.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,xd=Eo.ErrorCode=Te,He.COMPLETE="complete",Jb=Eo.EventType=He,Ze.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",Nn.prototype.listen=Nn.prototype.J,Kl=Eo.WebChannel=Ze,N9=Eo.FetchXmlHttpFactory=bh,Kt.prototype.listenOnce=Kt.prototype.K,Kt.prototype.getLastError=Kt.prototype.Ha,Kt.prototype.getLastErrorCode=Kt.prototype.ya,Kt.prototype.getStatus=Kt.prototype.ca,Kt.prototype.getResponseJson=Kt.prototype.La,Kt.prototype.getResponseText=Kt.prototype.la,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Fa,Qb=Eo.XhrIo=Kt}).apply(typeof Yg<"u"?Yg:typeof self<"u"?self:typeof window<"u"?window:{});var An=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");var dc="12.8.0";function wN(n){dc=n}var Ma=new vs("@firebase/firestore");function Yl(){return Ma.logLevel}function De(n,...e){if(Ma.logLevel<=tt.DEBUG){let t=e.map(N1);Ma.debug(`Firestore (${dc}): ${n}`,...t)}}function So(n,...e){if(Ma.logLevel<=tt.ERROR){let t=e.map(N1);Ma.error(`Firestore (${dc}): ${n}`,...t)}}function ws(n,...e){if(Ma.logLevel<=tt.WARN){let t=e.map(N1);Ma.warn(`Firestore (${dc}): ${n}`,...t)}}function N1(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Le(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,xN(n,i,t)}function xN(n,e,t){let i=`FIRESTORE (${dc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw So(i),new Error(i)}function bt(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||xN(e,r,i)}function We(n,e){return n}var Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},fe=class extends xi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var lr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var im=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},rm=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(An.UNAUTHENTICATED))}shutdown(){}},sw=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},om=class{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){bt(this.o===void 0,42304);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),o=new lr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new lr,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{De("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(De("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new lr)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(De("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(bt(typeof i.accessToken=="string",31837,{l:i}),new im(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return bt(e===null||typeof e=="string",2055,{h:e}),new An(e)}},aw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=An.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},lw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new aw(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(An.FIRST_PARTY))}shutdown(){}invalidateToken(){}},sm=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},am=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Si(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){bt(this.o===void 0,3512);let i=o=>{o.error!=null&&De("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,De("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{De("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):De("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new sm(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(bt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new sm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function P9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var Ra=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=P9(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}};function ot(n,e){return n<e?-1:n>e?1:0}function cw(n,e){let t=Math.min(n.length,e.length);for(let i=0;i<t;i++){let r=n.charAt(i),o=e.charAt(i);if(r!==o)return tw(r)===tw(o)?ot(r,o):tw(r)?1:-1}return ot(n.length,e.length)}var k9=55296,O9=57343;function tw(n){let e=n.charCodeAt(0);return e>=k9&&e<=O9}function tc(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var LR="__name__",lm=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Le(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return ot(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):cw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _o.fromString(e.substring(4,e.length-2))}},kt=class n extends lm{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new fe(Y.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},F9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=class n extends lm{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return F9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===LR}static keyField(){return new n([LR])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new fe(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new fe(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new fe(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(s=!s,r++):a!=="."||s?(i+=a,r++):(o(),r++)}if(o(),s)throw new fe(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Oe=class n{constructor(e){this.path=e}static fromPath(e){return new n(kt.fromString(e))}static fromName(e){return new n(kt.fromString(e).popFirst(5))}static empty(){return new n(kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return kt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new kt(e.slice()))}};function SN(n,e,t){if(!t)throw new fe(Y.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function IN(n,e,t,i){if(e===!0&&i===!0)throw new fe(Y.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function VR(n){if(!Oe.isDocumentKey(n))throw new fe(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function UR(n){if(Oe.isDocumentKey(n))throw new fe(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function TN(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Gd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function $r(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new fe(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Gd(n);throw new fe(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function CN(n,e){if(e<=0)throw new fe(Y.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function on(n,e){let t={typeString:n};return e&&(t.value=e),t}function hc(n,e){if(!TN(n))throw new fe(Y.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let s=n[i];if(r&&typeof s!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new fe(Y.INVALID_ARGUMENT,t);return!0}var BR=-62135596800,jR=1e6,sn=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*jR);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<BR)throw new fe(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jR}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(hc(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-BR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};sn._jsonSchemaVersion="firestore/timestamp/1.0",sn._jsonSchema={type:on("string",sn._jsonSchemaVersion),seconds:on("number"),nanoseconds:on("number")};var Je=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new sn(0,0))}static max(){return new n(new sn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ad=-1,cm=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};cm.UNKNOWN_ID=-1;function L9(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Je.fromTimestamp(i===1e9?new sn(t+1,0):new sn(t,i));return new Na(r,Oe.empty(),e)}function V9(n){return new Na(n.readTime,n.key,Ad)}var Na=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Je.min(),Oe.empty(),Ad)}static max(){return new n(Je.max(),Oe.empty(),Ad)}};function U9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Oe.comparator(n.documentKey,e.documentKey),t!==0?t:ot(n.largestBatchId,e.largestBatchId))}var B9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",uw=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function fc(n){if(n.code!==Y.FAILED_PRECONDITION||n.message!==B9)throw n;De("LocalStore","Unexpectedly lost primary lease")}var re=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(a=>{++r,a.next(()=>{++o,s&&o===r&&t()},l=>i(l))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let c=l;t(e[c]).next(d=>{s[c]=d,++a,a===o&&i(s)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};function j9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function pc(n){return n.name==="IndexedDbTransactionError"}var P1=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),k1=-1;function Lm(n){return n==null}function Md(n){return n===0&&1/n==-1/0}function H9(n){return typeof n=="number"&&Number.isInteger(n)&&!Md(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var DN="";function G9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=HR(e)),e=$9(n.get(t),e);return HR(e)}function $9(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case DN:t+="";break;default:t+=o}}return t}function HR(n){return n+DN+""}var z9="remoteDocuments",AN="owner";var MN="mutationQueues";var RN="mutations";var NN="documentMutations",W9="remoteDocumentsV14";var PN="remoteDocumentGlobal";var kN="targets";var ON="targetDocuments";var FN="targetGlobal",LN="collectionParents";var VN="clientMetadata";var UN="bundles";var BN="namedQueries";var q9="indexConfiguration";var K9="indexState";var Y9="indexEntries";var jN="documentOverlays";var Q9="globals";var J9=[MN,RN,NN,z9,kN,AN,FN,ON,VN,PN,LN,UN,BN],xde=[...J9,jN],X9=[MN,RN,NN,W9,kN,AN,FN,ON,VN,PN,LN,UN,BN,jN],Z9=X9,e7=[...Z9,q9,K9,Y9];var Sde=[...e7,Q9];function GR(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ua(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function HN(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Jt=class n{constructor(e,t){this.comparator=e,this.root=t||Vr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Vr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zl(this.root,e,this.comparator,!0)}},Zl=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Vr=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}};Vr.EMPTY=null,Vr.RED=!0,Vr.BLACK=!1;Vr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Vr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Mn=class n{constructor(e){this.comparator=e,this.data=new Jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new um(this.data.getIterator())}getIteratorFrom(e){return new um(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},um=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Lr=class n{constructor(e){this.fields=e,e.sort(oi.comparator)}static empty(){return new n([])}unionWith(e){let t=new Mn(oi.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tc(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var dm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ln=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new dm("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ln.EMPTY_BYTE_STRING=new Ln("");var t7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Io(n){if(bt(!!n,39018),typeof n=="string"){let e=0,t=t7.exec(n);if(bt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Gt(n.seconds),nanos:Gt(n.nanos)}}function Gt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function To(n){return typeof n=="string"?Ln.fromBase64String(n):Ln.fromUint8Array(n)}var GN="server_timestamp",$N="__type__",zN="__previous_value__",WN="__local_write_time__";function $d(n){return(n?.mapValue?.fields||{})[$N]?.stringValue===GN}function Vm(n){let e=n.mapValue.fields[zN];return $d(e)?Vm(e):e}function Rd(n){let e=Io(n.mapValue.fields[WN].timestampValue);return new sn(e.seconds,e.nanos)}var dw=class{constructor(e,t,i,r,o,s,a,l,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=d,this.apiKey=h}},hm="(default)",Nd=class n{constructor(e,t){this.projectId=e,this.database=t||hm}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===hm}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function qN(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new fe(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nd(n.options.projectId,e)}var O1="__type__",KN="__max__",Jg={mapValue:{fields:{__type__:{stringValue:KN}}}},F1="__vector__",nc="value";function xs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?$d(n)?4:QN(n)?9007199254740991:YN(n)?10:11:Le(28295,{value:n})}function Gr(n,e){if(n===e)return!0;let t=xs(n);if(t!==xs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Rd(n).isEqual(Rd(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=Io(r.timestampValue),a=Io(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return To(r.bytesValue).isEqual(To(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return Gt(r.geoPointValue.latitude)===Gt(o.geoPointValue.latitude)&&Gt(r.geoPointValue.longitude)===Gt(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return Gt(r.integerValue)===Gt(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=Gt(r.doubleValue),a=Gt(o.doubleValue);return s===a?Md(s)===Md(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return tc(n.arrayValue.values||[],e.arrayValue.values||[],Gr);case 10:case 11:return(function(r,o){let s=r.mapValue.fields||{},a=o.mapValue.fields||{};if(GR(s)!==GR(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Gr(s[l],a[l])))return!1;return!0})(n,e);default:return Le(52216,{left:n})}}function Pd(n,e){return(n.values||[]).find(t=>Gr(t,e))!==void 0}function ic(n,e){if(n===e)return 0;let t=xs(n),i=xs(e);if(t!==i)return ot(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ot(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=Gt(o.integerValue||o.doubleValue),l=Gt(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return $R(n.timestampValue,e.timestampValue);case 4:return $R(Rd(n),Rd(e));case 5:return cw(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=To(o),l=To(s);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){let d=ot(a[c],l[c]);if(d!==0)return d}return ot(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=ot(Gt(o.latitude),Gt(s.latitude));return a!==0?a:ot(Gt(o.longitude),Gt(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return zR(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},l=s.fields||{},c=a[nc]?.arrayValue,d=l[nc]?.arrayValue,h=ot(c?.values?.length||0,d?.values?.length||0);return h!==0?h:zR(c,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===Jg.mapValue&&s===Jg.mapValue)return 0;if(o===Jg.mapValue)return 1;if(s===Jg.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),c=s.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let f=cw(l[h],d[h]);if(f!==0)return f;let g=ic(a[l[h]],c[d[h]]);if(g!==0)return g}return ot(l.length,d.length)})(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function $R(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ot(n,e);let t=Io(n),i=Io(e),r=ot(t.seconds,i.seconds);return r!==0?r:ot(t.nanos,i.nanos)}function zR(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=ic(t[r],i[r]);if(o)return o}return ot(t.length,i.length)}function rc(n){return hw(n)}function hw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=Io(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return To(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Oe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=hw(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${hw(t.fields[s])}`;return r+"}"})(n.mapValue):Le(61005,{value:n})}function em(n){switch(xs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Vm(n);return e?16+em(e):16;case 5:return 2*n.stringValue.length;case 6:return To(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,o)=>r+em(o),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ua(i.fields,(o,s)=>{r+=o.length+em(s)}),r})(n.mapValue);default:throw Le(13486,{value:n})}}function zd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function fw(n){return!!n&&"integerValue"in n}function L1(n){return!!n&&"arrayValue"in n}function WR(n){return!!n&&"nullValue"in n}function qR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function tm(n){return!!n&&"mapValue"in n}function YN(n){return(n?.mapValue?.fields||{})[O1]?.stringValue===F1}function Td(n){if(n.geoPointValue)return{geoPointValue:F({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:F({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ua(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Td(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Td(n.arrayValue.values[t]);return e}return F({},n)}function QN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===KN}var Tde={mapValue:{fields:{[O1]:{stringValue:F1},[nc]:{arrayValue:{}}}}};var ji=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!tm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Td(t)}setAll(e){let t=oi.emptyPath(),i={},r=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}s?i[a.lastSegment()]=Td(s):r.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());tm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];tm(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ua(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(Td(this.value))}};function JN(n){let e=[];return Ua(n.fields,(t,i)=>{let r=new oi([t]);if(tm(i)){let o=JN(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new Lr(e)}var cr=class n{constructor(e,t,i,r,o,s,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Je.min(),Je.min(),Je.min(),ji.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Je.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Je.min(),Je.min(),ji.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Je.min(),Je.min(),ji.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ji.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ji.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Co=class{constructor(e,t){this.position=e,this.inclusive=t}};function KR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=Oe.comparator(Oe.fromName(s.referenceValue),t.key):i=ic(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function YR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Gr(n.position[t],e.position[t]))return!1;return!0}var Ss=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function n7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var fm=class{},rn=class n extends fm{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new gw(e,t,i):t==="array-contains"?new vw(e,i):t==="in"?new _w(e,i):t==="not-in"?new Ew(e,i):t==="array-contains-any"?new bw(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new mw(e,i):new yw(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ic(t,this.value)):t!==null&&xs(this.value)===xs(t)&&this.matchesComparison(ic(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Hi=class n extends fm{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return XN(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function XN(n){return n.op==="and"}function ZN(n){return i7(n)&&XN(n)}function i7(n){for(let e of n.filters)if(e instanceof Hi)return!1;return!0}function pw(n){if(n instanceof rn)return n.field.canonicalString()+n.op.toString()+rc(n.value);if(ZN(n))return n.filters.map(e=>pw(e)).join(",");{let e=n.filters.map(t=>pw(t)).join(",");return`${n.op}(${e})`}}function eP(n,e){return n instanceof rn?(function(i,r){return r instanceof rn&&i.op===r.op&&i.field.isEqual(r.field)&&Gr(i.value,r.value)})(n,e):n instanceof Hi?(function(i,r){return r instanceof Hi&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,a)=>o&&eP(s,r.filters[a]),!0):!1})(n,e):void Le(19439)}function tP(n){return n instanceof rn?(function(t){return`${t.field.canonicalString()} ${t.op} ${rc(t.value)}`})(n):n instanceof Hi?(function(t){return t.op.toString()+" {"+t.getFilters().map(tP).join(" ,")+"}"})(n):"Filter"}var gw=class extends rn{constructor(e,t,i){super(e,t,i),this.key=Oe.fromName(i.referenceValue)}matches(e){let t=Oe.comparator(e.key,this.key);return this.matchesComparison(t)}},mw=class extends rn{constructor(e,t){super(e,"in",t),this.keys=nP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},yw=class extends rn{constructor(e,t){super(e,"not-in",t),this.keys=nP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function nP(n,e){return(e.arrayValue?.values||[]).map(t=>Oe.fromName(t.referenceValue))}var vw=class extends rn{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return L1(t)&&Pd(t.arrayValue,this.value)}},_w=class extends rn{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Pd(this.value.arrayValue,t)}},Ew=class extends rn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Pd(this.value.arrayValue,t)}},bw=class extends rn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!L1(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Pd(this.value.arrayValue,i))}};var ww=class{constructor(e,t=null,i=[],r=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function QR(n,e=null,t=[],i=[],r=null,o=null,s=null){return new ww(n,e,t,i,r,o,s)}function V1(n){let e=We(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>pw(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(o){return o.field.canonicalString()+o.dir})(i)).join(","),Lm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>rc(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>rc(i)).join(",")),e.Te=t}return e.Te}function U1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!n7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!eP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!YR(n.startAt,e.startAt)&&YR(n.endAt,e.endAt)}function xw(n){return Oe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Do=class{constructor(e,t=null,i=[],r=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function r7(n,e,t,i,r,o,s,a){return new Do(n,e,t,i,r,o,s,a)}function Um(n){return new Do(n)}function JR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function o7(n){return Oe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Bm(n){return n.collectionGroup!==null}function Aa(n){let e=We(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Mn(oi.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Ss(o,i))}),t.has(oi.keyField().canonicalString())||e.Ie.push(new Ss(oi.keyField(),i))}return e.Ie}function Ur(n){let e=We(n);return e.Ee||(e.Ee=s7(e,Aa(n))),e.Ee}function s7(n,e){if(n.limitType==="F")return QR(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new Ss(r.field,o)});let t=n.endAt?new Co(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Co(n.startAt.position,n.startAt.inclusive):null;return QR(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function jm(n,e){let t=n.filters.concat([e]);return new Do(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function iP(n,e){let t=n.explicitOrderBy.concat([e]);return new Do(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function kd(n,e,t){return new Do(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function rP(n,e){return new Do(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Hm(n,e){return U1(Ur(n),Ur(e))&&n.limitType===e.limitType}function oP(n){return`${V1(Ur(n))}|lt:${n.limitType}`}function Ql(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>tP(r)).join(", ")}]`),Lm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>rc(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>rc(r)).join(",")),`Target(${i})`})(Ur(n))}; limitType=${n.limitType})`}function Gm(n,e){return e.isFoundDocument()&&(function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Oe.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(let o of Aa(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(s,a,l){let c=KR(s,a,l);return s.inclusive?c<=0:c<0})(i.startAt,Aa(i),r)||i.endAt&&!(function(s,a,l){let c=KR(s,a,l);return s.inclusive?c>=0:c>0})(i.endAt,Aa(i),r))})(n,e)}function a7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function sP(n){return(e,t)=>{let i=!1;for(let r of Aa(n)){let o=l7(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function l7(n,e,t){let i=n.field.isKeyField()?Oe.comparator(e.key,t.key):(function(o,s,a){let l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?ic(l,c):Le(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Le(19790,{direction:n.dir})}}var Ao=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ua(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return HN(this.inner)}size(){return this.innerSize}};var c7=new Jt(Oe.comparator);function Mo(){return c7}var aP=new Jt(Oe.comparator);function Id(...n){let e=aP;for(let t of n)e=e.insert(t.key,t);return e}function lP(n){let e=aP;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ca(){return Cd()}function cP(){return Cd()}function Cd(){return new Ao(n=>n.toString(),(n,e)=>n.isEqual(e))}var u7=new Jt(Oe.comparator),d7=new Mn(Oe.comparator);function nt(...n){let e=d7;for(let t of n)e=e.add(t);return e}var h7=new Mn(ot);function f7(){return h7}function B1(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Md(e)?"-0":e}}function uP(n){return{integerValue:""+n}}function p7(n,e){return H9(e)?uP(e):B1(n,e)}var oc=class{constructor(){this._=void 0}};function g7(n,e,t){return n instanceof Pa?(function(r,o){let s={fields:{[$N]:{stringValue:GN},[WN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&$d(o)&&(o=Vm(o)),o&&(s.fields[zN]=o),{mapValue:s}})(t,e):n instanceof ka?hP(n,e):n instanceof Oa?fP(n,e):(function(r,o){let s=dP(r,o),a=XR(s)+XR(r.Ae);return fw(s)&&fw(r.Ae)?uP(a):B1(r.serializer,a)})(n,e)}function m7(n,e,t){return n instanceof ka?hP(n,e):n instanceof Oa?fP(n,e):t}function dP(n,e){return n instanceof sc?(function(i){return fw(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}var Pa=class extends oc{},ka=class extends oc{constructor(e){super(),this.elements=e}};function hP(n,e){let t=pP(e);for(let i of n.elements)t.some(r=>Gr(r,i))||t.push(i);return{arrayValue:{values:t}}}var Oa=class extends oc{constructor(e){super(),this.elements=e}};function fP(n,e){let t=pP(e);for(let i of n.elements)t=t.filter(r=>!Gr(r,i));return{arrayValue:{values:t}}}var sc=class extends oc{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function XR(n){return Gt(n.integerValue||n.doubleValue)}function pP(n){return L1(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Sw=class{constructor(e,t){this.field=e,this.transform=t}};function y7(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof ka&&r instanceof ka||i instanceof Oa&&r instanceof Oa?tc(i.elements,r.elements,Gr):i instanceof sc&&r instanceof sc?Gr(i.Ae,r.Ae):i instanceof Pa&&r instanceof Pa})(n.transform,e.transform)}var Iw=class{constructor(e,t){this.version=e,this.transformResults=t}},bo=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function nm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ac=class{};function gP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Od(n.key,bo.none()):new Fa(n.key,n.data,bo.none());{let t=n.data,i=ji.empty(),r=new Mn(oi.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new Ro(n.key,i,new Lr(r.toArray()),bo.none())}}function v7(n,e,t){n instanceof Fa?(function(r,o,s){let a=r.value.clone(),l=eN(r.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Ro?(function(r,o,s){if(!nm(r.precondition,o))return void o.convertToUnknownDocument(s.version);let a=eN(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(mP(r)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):(function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Dd(n,e,t,i){return n instanceof Fa?(function(o,s,a,l){if(!nm(o.precondition,s))return a;let c=o.value.clone(),d=tN(o.fieldTransforms,l,s);return c.setAll(d),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ro?(function(o,s,a,l){if(!nm(o.precondition,s))return a;let c=tN(o.fieldTransforms,l,s),d=s.data;return d.setAll(mP(o)),d.setAll(c),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,i):(function(o,s,a){return nm(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function _7(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=dP(i.transform,r||null);o!=null&&(t===null&&(t=ji.empty()),t.set(i.field,o))}return t||null}function ZR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&tc(i,r,(o,s)=>y7(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Fa=class extends ac{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Ro=class extends ac{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function mP(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function eN(n,e,t){let i=new Map;bt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,m7(s,a,t[r]))}return i}function tN(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,g7(o,s,e))}return i}var Od=class extends ac{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Tw=class extends ac{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Cw=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&v7(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Dd(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Dd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=cP();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(r.key)?null:a;let l=gP(s,a);l!==null&&i.set(r.key,l),s.isValidDocument()||s.convertToNoDocument(Je.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nt())}isEqual(e){return this.batchId===e.batchId&&tc(this.mutations,e.mutations,(t,i)=>ZR(t,i))&&tc(this.baseMutations,e.baseMutations,(t,i)=>ZR(t,i))}},Dw=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){bt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return u7})(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var Aw=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Mw=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var fn,ct;function E7(n){switch(n){case Y.OK:return Le(64938);case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function yP(n){if(n===void 0)return So("GRPC error has no .code"),Y.UNKNOWN;switch(n){case fn.OK:return Y.OK;case fn.CANCELLED:return Y.CANCELLED;case fn.UNKNOWN:return Y.UNKNOWN;case fn.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case fn.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case fn.INTERNAL:return Y.INTERNAL;case fn.UNAVAILABLE:return Y.UNAVAILABLE;case fn.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case fn.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case fn.NOT_FOUND:return Y.NOT_FOUND;case fn.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case fn.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case fn.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case fn.ABORTED:return Y.ABORTED;case fn.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case fn.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case fn.DATA_LOSS:return Y.DATA_LOSS;default:return Le(39323,{code:n})}}(ct=fn||(fn={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";var b7=null;function w7(){return new TextEncoder}var x7=new _o([4294967295,4294967295],0);function nN(n){let e=w7().encode(n),t=new Yb;return t.update(e),new Uint8Array(t.digest())}function iN(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new _o([t,i],0),new _o([r,o],0)]}var Rw=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Da(`Invalid padding: ${t}`);if(i<0)throw new Da(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Da(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Da(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=_o.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(_o.fromNumber(i)));return r.compare(x7)===1&&(r=new _o([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=nN(e),[i,r]=iN(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);if(!this.we(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=nN(e),[i,r]=iN(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);this.be(s)}}be(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},Da=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var pm=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Fd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Je.min(),r,new Jt(ot),Mo(),nt())}},Fd=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,nt(),nt(),nt())}};var ec=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}},gm=class{constructor(e,t){this.targetId=e,this.Ce=t}},mm=class{constructor(e,t,i=Ln.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},ym=class{constructor(){this.ve=0,this.Fe=rN(),this.Me=Ln.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),t=nt(),i=nt();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Le(38017,{changeType:o})}}),new Fd(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=rN()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,bt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},Nw=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Mo(),this.He=Xg(),this.Je=Xg(),this.Ze=new Jt(ot)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){let o=r.target;if(xw(o))if(i===0){let s=new Oe(o.path);this.et(t,s,cr.newNoDocument(s,Je.min()))}else bt(i===1,20013,{expectedCount:i});else{let s=this._t(t);if(s!==i){let a=this.ut(e),l=a?this.ct(a,e,s):1;if(l!==0){this.it(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}b7?.lt((function(d,h,f,g,x){let S={localCacheCount:d,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},R=h.unchangedNames;return R&&(S.bloomFilter={applied:x===0,hashCount:R?.hashCount??0,bitmapLength:R?.bits?.bitmap?.length??0,padding:R?.bits?.padding??0,mightContain:L=>g?.mightContain(L)??!1}),S})(s,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,a;try{s=To(i).toUint8Array()}catch(l){if(l instanceof dm)return ws("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Rw(s,r,o)}catch(l){return ws(l instanceof Da?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){let i=this.Ge.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),r++)}),r}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&xw(a.target)){let l=new Oe(a.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,cr.newNoDocument(l,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let i=nt();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let r=new pm(e,t,this.Ze,this.je,i);return this.je=Mo(),this.He=Xg(),this.Je=Xg(),this.Ze=new Jt(ot),r}Ye(e,t){if(!this.rt(e))return;let i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new ym,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Mn(ot),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Mn(ot),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||De("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ym),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Xg(){return new Jt(Oe.comparator)}function rN(){return new Jt(Oe.comparator)}var S7={asc:"ASCENDING",desc:"DESCENDING"},I7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},T7={and:"AND",or:"OR"},Pw=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function kw(n,e){return n.useProto3Json||Lm(e)?e:{value:e}}function vm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function C7(n,e){return vm(n,e.toTimestamp())}function Br(n){return bt(!!n,49232),Je.fromTimestamp((function(t){let i=Io(t);return new sn(i.seconds,i.nanos)})(n))}function j1(n,e){return Ow(n,e).canonicalString()}function Ow(n,e){let t=(function(r){return new kt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function _P(n){let e=kt.fromString(n);return bt(SP(e),10190,{key:e.toString()}),e}function Fw(n,e){return j1(n.databaseId,e.path)}function nw(n,e){let t=_P(e);if(t.get(1)!==n.databaseId.projectId)throw new fe(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new fe(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Oe(bP(t))}function EP(n,e){return j1(n.databaseId,e)}function D7(n){let e=_P(n);return e.length===4?kt.emptyPath():bP(e)}function Lw(n){return new kt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function bP(n){return bt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function oN(n,e,t){return{name:Fw(n,e),fields:t.value.mapValue.fields}}function A7(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(c,d){return c.useProto3Json?(bt(d===void 0||typeof d=="string",58123),Ln.fromBase64String(d||"")):(bt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ln.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(c){let d=c.code===void 0?Y.UNKNOWN:yP(c.code);return new fe(d,c.message||"")})(s);t=new mm(i,r,o,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=nw(n,i.document.name),o=Br(i.document.updateTime),s=i.document.createTime?Br(i.document.createTime):Je.min(),a=new ji({mapValue:{fields:i.document.fields}}),l=cr.newFoundDocument(r,o,s,a),c=i.targetIds||[],d=i.removedTargetIds||[];t=new ec(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=nw(n,i.document),o=i.readTime?Br(i.readTime):Je.min(),s=cr.newNoDocument(r,o),a=i.removedTargetIds||[];t=new ec([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=nw(n,i.document),o=i.removedTargetIds||[];t=new ec([],o,r,null)}else{if(!("filter"in e))return Le(11601,{Vt:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new Mw(r,o),a=i.targetId;t=new gm(a,s)}}return t}function M7(n,e){let t;if(e instanceof Fa)t={update:oN(n,e.key,e.value)};else if(e instanceof Od)t={delete:Fw(n,e.key)};else if(e instanceof Ro)t={update:oN(n,e.key,e.data),updateMask:U7(e.fieldMask)};else{if(!(e instanceof Tw))return Le(16599,{dt:e.type});t={verify:Fw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(o,s){let a=s.transform;if(a instanceof Pa)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ka)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Oa)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof sc)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw Le(20930,{transform:s.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:C7(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Le(27497)})(n,e.precondition)),t}function R7(n,e){return n&&n.length>0?(bt(e!==void 0,14353),n.map(t=>(function(r,o){let s=r.updateTime?Br(r.updateTime):Br(o);return s.isEqual(Je.min())&&(s=Br(o)),new Iw(s,r.transformResults||[])})(t,e))):[]}function N7(n,e){return{documents:[EP(n,e.path)]}}function P7(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=EP(n,r);let o=(function(c){if(c.length!==0)return xP(Hi.create(c,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(c){if(c.length!==0)return c.map(d=>(function(f){return{field:Jl(f.field),direction:F7(f.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=kw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:r}}function k7(n){let e=D7(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){bt(i===1,65062);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let f=wP(h);return f instanceof Hi&&ZN(f)?f.getFilters():[f]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(f=>(function(x){return new Ss(Xl(x.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(f))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,Lm(f)?null:f})(t.limit));let l=null;t.startAt&&(l=(function(h){let f=!!h.before,g=h.values||[];return new Co(g,f)})(t.startAt));let c=null;return t.endAt&&(c=(function(h){let f=!h.before,g=h.values||[];return new Co(g,f)})(t.endAt)),r7(e,r,s,o,a,"F",l,c)}function O7(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function wP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Xl(t.unaryFilter.field);return rn.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Xl(t.unaryFilter.field);return rn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Xl(t.unaryFilter.field);return rn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Xl(t.unaryFilter.field);return rn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}})(n):n.fieldFilter!==void 0?(function(t){return rn.create(Xl(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Hi.create(t.compositeFilter.filters.map(i=>wP(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Le(1026)}})(t.compositeFilter.op))})(n):Le(30097,{filter:n})}function F7(n){return S7[n]}function L7(n){return I7[n]}function V7(n){return T7[n]}function Jl(n){return{fieldPath:n.canonicalString()}}function Xl(n){return oi.fromServerFormat(n.fieldPath)}function xP(n){return n instanceof rn?(function(t){if(t.op==="=="){if(qR(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NAN"}};if(WR(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(qR(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NOT_NAN"}};if(WR(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jl(t.field),op:L7(t.op),value:t.value}}})(n):n instanceof Hi?(function(t){let i=t.getFilters().map(r=>xP(r));return i.length===1?i[0]:{compositeFilter:{op:V7(t.op),filters:i}}})(n):Le(54877,{filter:n})}function U7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function SP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function IP(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var Ld=class n{constructor(e,t,i,r,o=Je.min(),s=Je.min(),a=Ln.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Vw=class{constructor(e){this.yt=e}};function TP(n){let e=k7({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?kd(e,e.limit,"L"):e}var _m=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Gt(e.integerValue));else if("doubleValue"in e){let i=Gt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Md(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Io(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(To(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?QN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):YN(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):Le(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let i=e.fields||{};this.Ft(t,55);for(let r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){let i=e.fields||{};this.Ft(t,53);let r=nc,o=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Gt(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){let i=e.values||[];this.Ft(t,50);for(let r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Oe.fromName(e).path.forEach(i=>{this.Ft(t,60),this.$t(i,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};_m.Wt=new _m;var Uw=class{constructor(){this.Sn=new Bw}addToCollectionParentIndex(e,t){return this.Sn.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(Na.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(Na.min())}updateCollectionGroup(e,t,i){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}},Bw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Mn(kt.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Mn(kt.comparator)).toArray()}};var Cde=new Uint8Array(0);var sN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},CP=41943040,Bi=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};Bi.DEFAULT_COLLECTION_PERCENTILE=10,Bi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bi.DEFAULT=new Bi(CP,Bi.DEFAULT_COLLECTION_PERCENTILE,Bi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bi.DISABLED=new Bi(-1,0,0);var Vd=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var aN="LruGarbageCollector",B7=1048576;function lN([n,e],[t,i]){let r=ot(n,t);return r===0?ot(e,i):r}var jw=class{constructor(e){this.Pr=e,this.buffer=new Mn(lN),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();lN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Hw=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){De(aN,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){pc(t)?De(aN,"Ignoring IndexedDB error during garbage collection: ",t):await fc(t)}await this.Ar(3e5)})}},Gw=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return re.resolve(P1.ce);let i=new jw(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(De("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(sN)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(De("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sN):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,s,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(De("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,s=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(c=Date.now(),Yl()<=tt.DEBUG&&De("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${r} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:h})))}};function j7(n,e){return new Gw(n,e)}var $w=class{constructor(){this.changes=new Ao(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?re.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var zw=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ww=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Dd(i.mutation,r,Lr.empty(),sn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,nt()).next(()=>i))}getLocalViewOfDocuments(e,t,i=nt()){let r=Ca();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=Id();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=Ca();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,nt()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,i,r){let o=Mo(),s=Cd(),a=(function(){return Cd()})();return t.forEach((l,c)=>{let d=i.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof Ro)?o=o.insert(c.key,c):d!==void 0?(s.set(c.key,d.mutation.getFieldMask()),Dd(d.mutation,c,d.mutation.getFieldMask(),sn.now())):s.set(c.key,Lr.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,d)=>s.set(c,d)),t.forEach((c,d)=>a.set(c,new zw(d,s.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){let i=Cd(),r=new Jt((s,a)=>s-a),o=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=i.get(l)||Lr.empty();d=a.applyToLocalView(c,d),i.set(l,d);let h=(r.get(a.batchId)||nt()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,h=cP();d.forEach(f=>{if(!o.has(f)){let g=gP(t.get(f),i.get(f));g!==null&&h.set(f,g),o=o.add(f)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return re.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return o7(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Bm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):re.resolve(Ca()),a=Ad,l=o;return s.next(c=>re.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?re.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,nt())).next(d=>({batchId:a,changes:lP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Oe(t)).next(i=>{let r=Id();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=Id();return this.indexManager.getCollectionParents(e,o).next(a=>re.forEach(a,l=>{let c=(function(h,f){return new Do(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,i,r).next(d=>{d.forEach((h,f)=>{s=s.insert(h,f)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((l,c)=>{let d=c.getKey();s.get(d)===null&&(s=s.insert(d,cr.newInvalidDocument(d)))});let a=Id();return s.forEach((l,c)=>{let d=o.get(l);d!==void 0&&Dd(d.mutation,c,Lr.empty(),sn.now()),Gm(t,c)&&(a=a.insert(l,c))}),a})}};var qw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return re.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Br(r.createTime)}})(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:TP(r.bundledQuery),readTime:Br(r.readTime)}})(t)),re.resolve()}};var Kw=class{constructor(){this.overlays=new Jt(Oe.comparator),this.Lr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Ca();return re.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.bt(e,t,o)}),re.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Lr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(i)),re.resolve()}getOverlaysForCollection(e,t,i){let r=Ca(),o=t.length+1,s=new Oe(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>i&&r.set(l.getKey(),l)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Jt((c,d)=>c-d),s=this.overlays.getIterator();for(;s.hasNext();){let c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let d=o.get(c.largestBatchId);d===null&&(d=Ca(),o=o.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}let a=Ca(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=r)););return re.resolve(a)}bt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new Aw(t,i));let o=this.Lr.get(t);o===void 0&&(o=nt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}};var Yw=class{constructor(){this.sessionToken=Ln.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}};var Ud=class{constructor(){this.kr=new Mn(pn.Kr),this.qr=new Mn(pn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let i=new pn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new pn(e,t))}Qr(e,t){e.forEach(i=>this.removeReference(i,t))}Gr(e){let t=new Oe(new kt([])),i=new pn(t,e),r=new pn(t,e+1),o=[];return this.qr.forEachInRange([i,r],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new Oe(new kt([])),i=new pn(t,e),r=new pn(t,e+1),o=nt();return this.qr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new pn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},pn=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Oe.comparator(e.key,t.key)||ot(e.Hr,t.Hr)}static Ur(e,t){return ot(e.Hr,t.Hr)||Oe.comparator(e.key,t.key)}};var Qw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Mn(pn.Kr)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Cw(o,t,i,r);this.mutationQueue.push(s);for(let a of r)this.Jr=this.Jr.add(new pn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return re.resolve(s)}lookupMutationBatch(e,t){return re.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),o=r<0?0:r;return re.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?k1:this.Yn-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new pn(t,0),r=new pn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],s=>{let a=this.Zr(s.Hr);o.push(a)}),re.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Mn(ot);return t.forEach(r=>{let o=new pn(r,0),s=new pn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{i=i.add(a.Hr)})}),re.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;Oe.isDocumentKey(o)||(o=o.child(""));let s=new pn(new Oe(o),0),a=new Mn(ot);return this.Jr.forEachWhile(l=>{let c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Hr)),!0)},s),re.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){bt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return re.forEach(t.mutations,r=>{let o=new pn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Jr=i})}nr(e){}containsKey(e,t){let i=new pn(t,0),r=this.Jr.firstAfterOrEqual(i);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Jw=class{constructor(e){this.ti=e,this.docs=(function(){return new Jt(Oe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return re.resolve(i?i.document.mutableCopy():cr.newInvalidDocument(t))}getEntries(e,t){let i=Mo();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():cr.newInvalidDocument(r))}),re.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=Mo(),s=t.path,a=new Oe(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||U9(V9(d),i)<=0||(r.has(d.key)||Gm(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return re.resolve(o)}getAllFromCollectionGroup(e,t,i,r){Le(9500)}ni(e,t){return re.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Xw(this)}getSize(e){return re.resolve(this.size)}},Xw=class extends $w{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)}),re.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var Zw=class{constructor(e){this.persistence=e,this.ri=new Ao(t=>V1(t),U1),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.ii=0,this.si=new Ud,this.targetCount=0,this.oi=Vd._r()}forEachTarget(e,t){return this.ri.forEach((i,r)=>t(r)),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),re.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new Vd(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.lr(t),re.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),re.waitFor(o).next(()=>r)}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){let i=this.ri.get(t)||null;return re.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),re.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),re.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),re.resolve()}getMatchingKeysForTargetId(e,t){let i=this.si.jr(t);return re.resolve(i)}containsKey(e,t){return re.resolve(this.si.containsKey(t))}};var Em=class{constructor(e,t){this._i={},this.overlays={},this.ai=new P1(0),this.ui=!1,this.ui=!0,this.ci=new Yw,this.referenceDelegate=e(this),this.li=new Zw(this),this.indexManager=new Uw,this.remoteDocumentCache=(function(r){return new Jw(r)})(i=>this.referenceDelegate.hi(i)),this.serializer=new Vw(t),this.Pi=new qw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Kw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new Qw(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){De("MemoryPersistence","Starting transaction:",e);let r=new e1(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(o=>this.referenceDelegate.Ii(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ei(e,t){return re.or(Object.values(this._i).map(i=>()=>i.containsKey(e,t)))}},e1=class extends uw{constructor(e){super(),this.currentSequenceNumber=e}},t1=class n{constructor(e){this.persistence=e,this.Ri=new Ud,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw Le(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),re.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),re.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(r=>this.di.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.di,i=>{let r=Oe.fromPath(i);return this.mi(e,r).next(o=>{o||t.removeEntry(r,Je.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return re.or([()=>re.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},bm=class n{constructor(e,t){this.persistence=e,this.fi=new Ao(i=>G9(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=j7(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}pr(e){let t=0;return this.mr(e,i=>{t++}).next(()=>t)}mr(e,t){return re.forEach(this.fi,(i,r)=>this.wr(e,i,r).next(o=>o?re.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,s=>this.wr(e,s,t).next(a=>{a||(i++,o.removeEntry(s,Je.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),re.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=em(e.data.value)),t}wr(e,t,i){return re.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.fi.get(t);return re.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var n1=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=nt(),r=nt();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var i1=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var r1=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return yR()?8:j9(Cn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new i1;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,i,r){return i.documentReadCount<this.Vs?(Yl()<=tt.DEBUG&&De("QueryEngine","SDK will not create cache indexes for query:",Ql(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),re.resolve()):(Yl()<=tt.DEBUG&&De("QueryEngine","Query:",Ql(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Yl()<=tt.DEBUG&&De("QueryEngine","The SDK decides to create cache indexes for query:",Ql(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ur(t))):re.resolve())}gs(e,t){if(JR(t))return re.resolve(null);let i=Ur(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=kd(t,null,"F"),i=Ur(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=nt(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{let c=this.bs(t,a);return this.Ss(t,c,s,l.readTime)?this.gs(e,kd(t,null,"F")):this.Ds(e,c,t,l)}))})))}ps(e,t,i,r){return JR(t)||r.isEqual(Je.min())?re.resolve(null):this.fs.getDocuments(e,i).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,i,r)?re.resolve(null):(Yl()<=tt.DEBUG&&De("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ql(t)),this.Ds(e,s,t,L9(r,Ad)).next(a=>a))})}bs(e,t){let i=new Mn(sP(e));return t.forEach((r,o)=>{Gm(e,o)&&(i=i.add(o))}),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return Yl()<=tt.DEBUG&&De("QueryEngine","Using full collection scan to execute query:",Ql(t)),this.fs.getDocumentsMatchingQuery(e,t,Na.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var H1="LocalStore",H7=3e8,o1=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Jt(ot),this.Fs=new Ao(o=>V1(o),U1),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ww(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function G7(n,e,t,i){return new o1(n,e,t,i)}async function DP(n,e){let t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],a=[],l=nt();for(let c of r){s.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}for(let c of o){a.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Ns:c,removedBatchIds:s,addedBatchIds:a}))})})}function $7(n,e){let t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,d){let h=c.batch,f=h.keys(),g=re.resolve();return f.forEach(x=>{g=g.next(()=>d.getEntry(l,x)).next(S=>{let R=c.docVersions.get(x);bt(R!==null,48541),S.version.compareTo(R)<0&&(h.applyToRemoteDocument(S,c),S.isValidDocument()&&(S.setReadTime(c.commitVersion),d.addEntry(S)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))})(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=nt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function AP(n){let e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function z7(n,e){let t=We(n),i=e.snapshotVersion,r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;let a=[];e.targetChanges.forEach((d,h)=>{let f=r.get(h);if(!f)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,h)));let g=f.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Ln.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,i)),r=r.insert(h,g),(function(S,R,L){return S.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=H7?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(f,g,d)&&a.push(t.li.updateTargetData(o,g))});let l=Mo(),c=nt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(W7(o,s,e.documentUpdates).next(d=>{l=d.Bs,c=d.Ls})),!i.isEqual(Je.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(h=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i));a.push(d)}return re.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.vs=r,o))}function W7(n,e,t){let i=nt(),r=nt();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=Mo();return t.forEach((a,l)=>{let c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Je.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):De(H1,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Bs:s,Ls:r}})}function q7(n,e){let t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=k1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function K7(n,e){let t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.li.getTargetData(i,e).next(o=>o?(r=o,re.resolve(r)):t.li.allocateTargetId(i).next(s=>(r=new Ld(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i})}async function s1(n,e,t){let i=We(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r))}catch(s){if(!pc(s))throw s;De(H1,`Failed to update sequence numbers for target ${e}: ${s}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function cN(n,e,t){let i=We(n),r=Je.min(),o=nt();return i.persistence.runTransaction("Execute query","readwrite",s=>(function(l,c,d){let h=We(l),f=h.Fs.get(d);return f!==void 0?re.resolve(h.vs.get(f)):h.li.getTargetData(c,d)})(i,s,Ur(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(s,e,t?r:Je.min(),t?o:nt())).next(a=>(Y7(i,a7(e),a),{documents:a,ks:o})))}function Y7(n,e,t){let i=n.Ms.get(e)||Je.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ms.set(e,i)}var wm=class{constructor(){this.activeTargetIds=f7()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var a1=class{constructor(){this.vo=new wm,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new wm,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var l1=class{Mo(e){}shutdown(){}};var uN="ConnectivityMonitor",xm=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){De(uN,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){De(uN,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Zg=null;function c1(){return Zg===null?Zg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Zg++,"0x"+Zg.toString(16)}var iw="RestConnection",Q7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},u1=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===hm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){let s=c1(),a=this.Qo(e,t.toUriEncodedString());De(iw,`Sending RPC '${e}' ${s}:`,a,i);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,r,o);let{host:c}=new URL(a),d=ys(c);return this.zo(e,a,l,i,d).then(h=>(De(iw,`Received RPC '${e}' ${s}: `,h),h),h=>{throw ws(iw,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",i),h})}jo(e,t,i,r,o,s){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+dc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),i&&i.headers.forEach((r,o)=>e[o]=r)}Qo(e,t){let i=Q7[e],r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}};var d1=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Hn="WebChannelConnection",Sd=(n,e,t)=>{n.listen(e,i=>{try{t(i)}catch(r){setTimeout(()=>{throw r},0)}})},Sm=class n extends u1{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=Zb();Sd(e,Xb.STAT_EVENT,t=>{t.stat===Qg.PROXY?De(Hn,"STAT_EVENT: detected buffering proxy"):t.stat===Qg.NOPROXY&&De(Hn,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,i,r,o){let s=c1();return new Promise((a,l)=>{let c=new Qb;c.setWithCredentials(!0),c.listenOnce(Jb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case xd.NO_ERROR:let h=c.getResponseJson();De(Hn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case xd.TIMEOUT:De(Hn,`RPC '${e}' ${s} timed out`),l(new fe(Y.DEADLINE_EXCEEDED,"Request time out"));break;case xd.HTTP_ERROR:let f=c.getStatus();if(De(Hn,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let x=g?.error;if(x&&x.status&&x.message){let S=(function(L){let q=L.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(q)>=0?q:Y.UNKNOWN})(x.status);l(new fe(S,x.message))}else l(new fe(Y.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new fe(Y.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{De(Hn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);De(Hn,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",d,i,15)})}T_(e,t,i){let r=c1(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;let c=o.join("");De(Hn,`Creating RPC '${e}' stream ${r}: ${c}`,a);let d=s.createWebChannel(c,a);this.I_(d);let h=!1,f=!1,g=new d1({Ho:x=>{f?De(Hn,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(h||(De(Hn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),De(Hn,`RPC '${e}' stream ${r} sending:`,x),d.send(x))},Jo:()=>d.close()});return Sd(d,Kl.EventType.OPEN,()=>{f||(De(Hn,`RPC '${e}' stream ${r} transport opened.`),g.i_())}),Sd(d,Kl.EventType.CLOSE,()=>{f||(f=!0,De(Hn,`RPC '${e}' stream ${r} transport closed`),g.o_(),this.E_(d))}),Sd(d,Kl.EventType.ERROR,x=>{f||(f=!0,ws(Hn,`RPC '${e}' stream ${r} transport errored. Name:`,x.name,"Message:",x.message),g.o_(new fe(Y.UNAVAILABLE,"The operation could not be completed")))}),Sd(d,Kl.EventType.MESSAGE,x=>{if(!f){let S=x.data[0];bt(!!S,16349);let R=S,L=R?.error||R[0]?.error;if(L){De(Hn,`RPC '${e}' stream ${r} received error:`,L);let q=L.status,ye=(function(Ie){let O=fn[Ie];if(O!==void 0)return yP(O)})(q),_e=L.message;ye===void 0&&(ye=Y.INTERNAL,_e="Unknown error status: "+q+" with message "+L.message),f=!0,g.o_(new fe(ye,_e)),d.close()}else De(Hn,`RPC '${e}' stream ${r} received:`,S),g.__(S)}}),n.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return ew()}};function J7(n){return new Sm(n)}function rw(){return typeof document<"u"?document:null}function Wd(n){return new Pw(n,!0)}Sm.c_=!1;var Im=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&De("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var dN="PersistentStream",Tm=class{constructor(e,t,i,r,o,s,a,l){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Im(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Y.RESOURCE_EXHAUSTED?(So(t.toString()),So("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{let r=new fe(Y.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){let i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return De(dN,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(De(dN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},h1=class extends Tm{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=A7(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Je.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Je.min():s.readTime?Br(s.readTime):Je.min()})(e);return this.listener.J_(t,i)}Z_(e){let t={};t.database=Lw(this.serializer),t.addTarget=(function(o,s){let a,l=s.target;if(a=xw(l)?{documents:N7(o,l)}:{query:P7(o,l).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=vP(o,s.resumeToken);let c=kw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(Je.min())>0){a.readTime=vm(o,s.snapshotVersion.toTimestamp());let c=kw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);let i=O7(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){let t={};t.database=Lw(this.serializer),t.removeTarget=e,this.K_(t)}},f1=class extends Tm{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return bt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,bt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){bt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=R7(e.writeResults,e.commitTime),i=Br(e.commitTime);return this.listener.na(i,t)}ra(){let e={};e.database=Lw(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>M7(this.serializer,i))};this.K_(t)}};var p1=class{},g1=class extends p1{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new fe(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,Ow(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new fe(Y.UNKNOWN,o.toString())})}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,Ow(t,i),r,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new fe(Y.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function X7(n,e,t,i){return new g1(n,e,t,i)}var m1=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(So(t),this.aa=!1):De("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var La="RemoteStore",y1=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{i.enqueueAndForget(async()=>{Ba(this)&&(De(La,"Restarting streams for network reachability change."),await(async function(l){let c=We(l);c.Ea.add(4),await qd(c),c.Va.set("Unknown"),c.Ea.delete(4),await $m(c)})(this))})}),this.Va=new m1(i,r)}};async function $m(n){if(Ba(n))for(let e of n.Ra)await e(!0)}async function qd(n){for(let e of n.Ra)await e(!1)}function MP(n,e){let t=We(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),W1(t)?z1(t):gc(t).O_()&&$1(t,e))}function G1(n,e){let t=We(n),i=gc(t);t.Ia.delete(e),i.O_()&&RP(t,e),t.Ia.size===0&&(i.O_()?i.L_():Ba(t)&&t.Va.set("Unknown"))}function $1(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}gc(n).Z_(e)}function RP(n,e){n.da.$e(e),gc(n).X_(e)}function z1(n){n.da=new Nw({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),gc(n).start(),n.Va.ua()}function W1(n){return Ba(n)&&!gc(n).x_()&&n.Ia.size>0}function Ba(n){return We(n).Ea.size===0}function NP(n){n.da=void 0}async function Z7(n){n.Va.set("Online")}async function eH(n){n.Ia.forEach((e,t)=>{$1(n,e)})}async function tH(n,e){NP(n),W1(n)?(n.Va.ha(e),z1(n)):n.Va.set("Unknown")}async function nH(n,e,t){if(n.Va.set("Online"),e instanceof mm&&e.state===2&&e.cause)try{await(async function(r,o){let s=o.cause;for(let a of o.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.da.removeTarget(a))})(n,e)}catch(i){De(La,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Cm(n,i)}else if(e instanceof ec?n.da.Xe(e):e instanceof gm?n.da.st(e):n.da.tt(e),!t.isEqual(Je.min()))try{let i=await AP(n.localStore);t.compareTo(i)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.Ia.get(c);d&&o.Ia.set(c,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{let d=o.Ia.get(l);if(!d)return;o.Ia.set(l,d.withResumeToken(Ln.EMPTY_BYTE_STRING,d.snapshotVersion)),RP(o,l);let h=new Ld(d.target,l,c,d.sequenceNumber);$1(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){De(La,"Failed to raise snapshot:",i),await Cm(n,i)}}async function Cm(n,e,t){if(!pc(e))throw e;n.Ea.add(1),await qd(n),n.Va.set("Offline"),t||(t=()=>AP(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{De(La,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await $m(n)})}function PP(n,e){return e().catch(t=>Cm(n,t,e))}async function zm(n){let e=We(n),t=Is(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:k1;for(;iH(e);)try{let r=await q7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,rH(e,r)}catch(r){await Cm(e,r)}kP(e)&&OP(e)}function iH(n){return Ba(n)&&n.Ta.length<10}function rH(n,e){n.Ta.push(e);let t=Is(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function kP(n){return Ba(n)&&!Is(n).x_()&&n.Ta.length>0}function OP(n){Is(n).start()}async function oH(n){Is(n).ra()}async function sH(n){let e=Is(n);for(let t of n.Ta)e.ea(t.mutations)}async function aH(n,e,t){let i=n.Ta.shift(),r=Dw.from(i,e,t);await PP(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await zm(n)}async function lH(n,e){e&&Is(n).Y_&&await(async function(i,r){if((function(s){return E7(s)&&s!==Y.ABORTED})(r.code)){let o=i.Ta.shift();Is(i).B_(),await PP(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await zm(i)}})(n,e),kP(n)&&OP(n)}async function hN(n,e){let t=We(n);t.asyncQueue.verifyOperationInProgress(),De(La,"RemoteStore received new credentials");let i=Ba(t);t.Ea.add(3),await qd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await $m(t)}async function cH(n,e){let t=We(n);e?(t.Ea.delete(2),await $m(t)):e||(t.Ea.add(2),await qd(t),t.Va.set("Unknown"))}function gc(n){return n.ma||(n.ma=(function(t,i,r){let o=We(t);return o.sa(),new h1(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:Z7.bind(null,n),Yo:eH.bind(null,n),t_:tH.bind(null,n),J_:nH.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),W1(n)?z1(n):n.Va.set("Unknown")):(await n.ma.stop(),NP(n))})),n.ma}function Is(n){return n.fa||(n.fa=(function(t,i,r){let o=We(t);return o.sa(),new f1(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:oH.bind(null,n),t_:lH.bind(null,n),ta:sH.bind(null,n),na:aH.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await zm(n)):(await n.fa.stop(),n.Ta.length>0&&(De(La,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var v1=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new lr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,a=new n(e,t,s,r,o);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function q1(n,e){if(So("AsyncQueue",`${e}: ${n}`),pc(n))return new fe(Y.UNAVAILABLE,`${e}: ${n}`);throw n}var Bd=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Oe.comparator(t.key,i.key):(t,i)=>Oe.comparator(t.key,i.key),this.keyedMap=Id(),this.sortedSet=new Jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Dm=class{constructor(){this.ga=new Jt(Oe.comparator)}track(e){let t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}},Va=class n{constructor(e,t,i,r,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Bd.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var _1=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},E1=class{constructor(){this.queries=fN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){let r=We(t),o=r.queries;r.queries=fN(),o.forEach((s,a)=>{for(let l of a.ba)l.onError(i)})})(this,new fe(Y.ABORTED,"Firestore shutting down"))}};function fN(){return new Ao(n=>oP(n),Hm)}async function FP(n,e){let t=We(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new _1,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(s){let a=q1(s,`Initialization of query '${Ql(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&K1(t)}async function LP(n,e){let t=We(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function uH(n,e){let t=We(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(r)&&(i=!0);s.wa=r}}i&&K1(t)}function dH(n,e,t){let i=We(n),r=i.queries.get(e);if(r)for(let o of r.ba)o.onError(t);i.queries.delete(e)}function K1(n){n.Ca.forEach(e=>{e.next()})}var b1,pN;(pN=b1||(b1={})).Ma="default",pN.Cache="cache";var Am=class{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Va(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Va.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==b1.Cache}};var Mm=class{constructor(e){this.key=e}},Rm=class{constructor(e){this.key=e}},w1=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=nt(),this.mutatedKeys=nt(),this.eu=sP(e),this.tu=new Bd(this.eu)}get nu(){return this.Za}ru(e,t){let i=t?t.iu:new Dm,r=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{let f=r.get(d),g=Gm(this.query,h)?h:null,x=!!f&&this.mutatedKeys.has(f.key),S=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),R=!1;f&&g?f.data.isEqual(g.data)?x!==S&&(i.track({type:3,doc:g}),R=!0):this.su(f,g)||(i.track({type:2,doc:g}),R=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(i.track({type:0,doc:g}),R=!0):f&&!g&&(i.track({type:1,doc:f}),R=!0,(l||c)&&(a=!0)),R&&(g?(s=s.add(g),o=S?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),i.track({type:1,doc:d})}return{tu:s,iu:i,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,h)=>(function(g,x){let S=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Vt:R})}};return S(g)-S(x)})(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(i),r=r??!1;let a=t&&!r?this._u():[],l=this.Ya.size===0&&this.current&&!r?1:0,c=l!==this.Xa;return this.Xa=l,s.length!==0||c?{snapshot:new Va(this.query,e.tu,o,s,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Dm,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=nt(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});let t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new Rm(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new Mm(i))}),t}cu(e){this.Za=e.ks,this.Ya=nt();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Va.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},Y1="SyncEngine",x1=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},S1=class{constructor(e){this.key=e,this.hu=!1}},I1=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Ao(a=>oP(a),Hm),this.Iu=new Map,this.Eu=new Set,this.Ru=new Jt(Oe.comparator),this.Au=new Map,this.Vu=new Ud,this.du={},this.mu=new Map,this.fu=Vd.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function hH(n,e,t=!0){let i=GP(n),r,o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await VP(i,e,t,!0),r}async function fH(n,e){let t=GP(n);await VP(t,e,!0,!1)}async function VP(n,e,t,i){let r=await K7(n.localStore,Ur(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return i&&(a=await pH(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&MP(n.remoteStore,r),a}async function pH(n,e,t,i,r){n.pu=(h,f,g)=>(async function(S,R,L,q){let ye=R.view.ru(L);ye.Ss&&(ye=await cN(S.localStore,R.query,!1).then(({documents:O})=>R.view.ru(O,ye)));let _e=q&&q.targetChanges.get(R.targetId),xe=q&&q.targetMismatches.get(R.targetId)!=null,Ie=R.view.applyChanges(ye,S.isPrimaryClient,_e,xe);return mN(S,R.targetId,Ie.au),Ie.snapshot})(n,h,f,g);let o=await cN(n.localStore,e,!0),s=new w1(e,o.ks),a=s.ru(o.documents),l=Fd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),c=s.applyChanges(a,n.isPrimaryClient,l);mN(n,t,c.au);let d=new x1(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function gH(n,e,t){let i=We(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter(s=>!Hm(s,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await s1(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&G1(i.remoteStore,r.targetId),T1(i,r.targetId)}).catch(fc)):(T1(i,r.targetId),await s1(i.localStore,r.targetId,!0))}async function mH(n,e){let t=We(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),G1(t.remoteStore,i.targetId))}async function yH(n,e,t){let i=SH(n);try{let r=await(function(s,a){let l=We(s),c=sn.now(),d=a.reduce((g,x)=>g.add(x.key),nt()),h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=Mo(),S=nt();return l.xs.getEntries(g,d).next(R=>{x=R,x.forEach((L,q)=>{q.isValidDocument()||(S=S.add(L))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,x)).next(R=>{h=R;let L=[];for(let q of a){let ye=_7(q,h.get(q.key).overlayedDocument);ye!=null&&L.push(new Ro(q.key,ye,JN(ye.value.mapValue),bo.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,L,a)}).next(R=>{f=R;let L=R.applyToLocalDocumentSet(h,S);return l.documentOverlayCache.saveOverlays(g,R.batchId,L)})}).then(()=>({batchId:f.batchId,changes:lP(h)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(s,a,l){let c=s.du[s.currentUser.toKey()];c||(c=new Jt(ot)),c=c.insert(a,l),s.du[s.currentUser.toKey()]=c})(i,r.batchId,t),await Kd(i,r.changes),await zm(i.remoteStore)}catch(r){let o=q1(r,"Failed to persist write");t.reject(o)}}async function UP(n,e){let t=We(n);try{let i=await z7(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Au.get(o);s&&(bt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?s.hu=!0:r.modifiedDocuments.size>0?bt(s.hu,14607):r.removedDocuments.size>0&&(bt(s.hu,42227),s.hu=!1))}),await Kd(t,i,e)}catch(i){await fc(i)}}function gN(n,e,t){let i=We(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(s,a){let l=We(s);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(let f of h.ba)f.va(a)&&(c=!0)}),c&&K1(l)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function vH(n,e,t){let i=We(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Au.get(e),o=r&&r.key;if(o){let s=new Jt(Oe.comparator);s=s.insert(o,cr.newNoDocument(o,Je.min()));let a=nt().add(o),l=new pm(Je.min(),new Map,new Jt(ot),s,a);await UP(i,l),i.Ru=i.Ru.remove(o),i.Au.delete(e),Q1(i)}else await s1(i.localStore,e,!1).then(()=>T1(i,e,t)).catch(fc)}async function _H(n,e){let t=We(n),i=e.batch.batchId;try{let r=await $7(t.localStore,e);jP(t,i,null),BP(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Kd(t,r)}catch(r){await fc(r)}}async function EH(n,e,t){let i=We(n);try{let r=await(function(s,a){let l=We(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(bt(h!==null,37113),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})})(i.localStore,e);jP(i,e,t),BP(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Kd(i,r)}catch(r){await fc(r)}}function BP(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function jP(n,e,t){let i=We(n),r=i.du[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function T1(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(i=>{n.Vu.containsKey(i)||HP(n,i)})}function HP(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(G1(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Q1(n))}function mN(n,e,t){for(let i of t)i instanceof Mm?(n.Vu.addReference(i.key,e),bH(n,i)):i instanceof Rm?(De(Y1,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||HP(n,i.key)):Le(19791,{wu:i})}function bH(n,e){let t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(De(Y1,"New document in limbo: "+t),n.Eu.add(i),Q1(n))}function Q1(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new Oe(kt.fromString(e)),i=n.fu.next();n.Au.set(i,new S1(t)),n.Ru=n.Ru.insert(t,i),MP(n.remoteStore,new Ld(Ur(Um(t.path)),i,"TargetPurposeLimboResolution",P1.ce))}}async function Kd(n,e,t){let i=We(n),r=[],o=[],s=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{s.push(i.pu(l,e,t).then(c=>{if((c||t)&&i.isPrimaryClient){let d=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){r.push(c);let d=n1.Es(l.targetId,c);o.push(d)}}))}),await Promise.all(s),i.Pu.J_(r),await(async function(l,c){let d=We(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>re.forEach(c,f=>re.forEach(f.Ts,g=>d.persistence.referenceDelegate.addReference(h,f.targetId,g)).next(()=>re.forEach(f.Is,g=>d.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))}catch(h){if(!pc(h))throw h;De(H1,"Failed to update sequence numbers: "+h)}for(let h of c){let f=h.targetId;if(!h.fromCache){let g=d.vs.get(f),x=g.snapshotVersion,S=g.withLastLimboFreeSnapshotVersion(x);d.vs=d.vs.insert(f,S)}}})(i.localStore,o))}async function wH(n,e){let t=We(n);if(!t.currentUser.isEqual(e)){De(Y1,"User change. New user:",e.toKey());let i=await DP(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(l=>{l.reject(new fe(Y.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Kd(t,i.Ns)}}function xH(n,e){let t=We(n),i=t.Au.get(e);if(i&&i.hu)return nt().add(i.key);{let r=nt(),o=t.Iu.get(e);if(!o)return r;for(let s of o){let a=t.Tu.get(s);r=r.unionWith(a.view.nu)}return r}}function GP(n){let e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=UP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vH.bind(null,e),e.Pu.J_=uH.bind(null,e.eventManager),e.Pu.yu=dH.bind(null,e.eventManager),e}function SH(n){let e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_H.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EH.bind(null,e),e}var J1=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Wd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return G7(this.persistence,new r1,t.initialUser,this.serializer)}Cu(t){return new Em(t1.Vi,this.serializer)}Du(t){return new a1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Nm=class extends J1{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){bt(this.persistence.referenceDelegate instanceof bm,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new Hw(i,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Bi.withCacheSize(this.cacheSizeBytes):Bi.DEFAULT;return new Em(i=>bm.Vi(i,t),this.serializer)}};var $P=(()=>{class n{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>gN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=wH.bind(null,this.syncEngine),await cH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new E1})()}createDatastore(t){let i=Wd(t.databaseInfo.databaseId),r=J7(t.databaseInfo);return X7(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,s,a,l){return new y1(r,o,s,a,l)})(this.localStore,this.datastore,t.asyncQueue,i=>gN(this.syncEngine,i,0),(function(){return xm.v()?new xm:new l1})())}createSyncEngine(t,i){return(function(o,s,a,l,c,d,h){let f=new I1(o,s,a,l,c,d);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){let r=We(i);De(La,"RemoteStore shutting down."),r.Ea.add(5),await qd(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var Pm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):So("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ts="FirestoreClient",C1=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=An.UNAUTHENTICATED,this.clientId=Ra.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async s=>{De(Ts,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(De(Ts,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new lr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=q1(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}};async function ow(n,e){n.asyncQueue.verifyOperationInProgress(),De(Ts,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await DP(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function yN(n,e){n.asyncQueue.verifyOperationInProgress();let t=await IH(n);De(Ts,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>hN(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>hN(e.remoteStore,r)),n._onlineComponents=e}async function IH(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){De(Ts,"Using user provided OfflineComponentProvider");try{await ow(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Y.FAILED_PRECONDITION||r.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;ws("Error using user provided cache. Falling back to memory cache: "+t),await ow(n,new J1)}}else De(Ts,"Using default OfflineComponentProvider"),await ow(n,new Nm(void 0));return n._offlineComponents}async function zP(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(De(Ts,"Using user provided OnlineComponentProvider"),await yN(n,n._uninitializedComponentsProvider._online)):(De(Ts,"Using default OnlineComponentProvider"),await yN(n,new $P))),n._onlineComponents}function TH(n){return zP(n).then(e=>e.syncEngine)}async function WP(n){let e=await zP(n),t=e.eventManager;return t.onListen=hH.bind(null,e.syncEngine),t.onUnlisten=gH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=fH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=mH.bind(null,e.syncEngine),t}function qP(n,e,t={}){let i=new lr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new Pm({next:f=>{d.Nu(),s.enqueueAndForget(()=>LP(o,h));let g=f.docs.has(a);!g&&f.fromCache?c.reject(new fe(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new fe(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Am(Um(a.path),d,{includeMetadataChanges:!0,Ka:!0});return FP(o,h)})(await WP(n),n.asyncQueue,e,t,i)),i.promise}function KP(n,e,t={}){let i=new lr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new Pm({next:f=>{d.Nu(),s.enqueueAndForget(()=>LP(o,h)),f.fromCache&&l.source==="server"?c.reject(new fe(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Am(a,d,{includeMetadataChanges:!0,Ka:!0});return FP(o,h)})(await WP(n),n.asyncQueue,e,t,i)),i.promise}function YP(n,e){let t=new lr;return n.asyncQueue.enqueueAndForget(async()=>yH(await TH(n),e,t)),t.promise}function QP(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var CH="ComponentProvider",vN=new Map;function DH(n,e,t,i,r){return new dw(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,QP(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}var JP="firestore.googleapis.com",_N=!0,km=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new fe(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JP,this.ssl=_N}else this.host=e.host,this.ssl=e.ssl??_N;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=CP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<B7)throw new fe(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QP(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new fe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new fe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new fe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},lc=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new km({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new km(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new rm;switch(i.type){case"firstParty":return new lw(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new fe(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=vN.get(t);i&&(De(CH,"Removing Datastore"),vN.delete(t),i.terminate())})(this),Promise.resolve()}};function XP(n,e,t,i={}){n=$r(n,lc);let r=ys(e),o=n._getSettings(),s=ce(F({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;r&&(Gg(`https://${a}`),$g("Firestore",!0)),o.host!==JP&&o.host!==a&&ws("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=ce(F({},o),{host:a,ssl:r,emulatorOptions:i});if(!sr(l,s)&&(n._setSettings(l),i.mockUserToken)){let c,d;if(typeof i.mockUserToken=="string")c=i.mockUserToken,d=An.MOCK_USER;else{c=dR(i.mockUserToken,n._app?.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new fe(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new An(h)}n._authCredentials=new sw(new im(c,d))}}var ur=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},_n=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(hc(t,n._jsonSchema))return new n(e,i||null,new Oe(kt.fromString(t.referencePath)))}};_n._jsonSchemaVersion="firestore/documentReference/1.0",_n._jsonSchema={type:on("string",_n._jsonSchemaVersion),referencePath:on("string")};var wo=class n extends ur{constructor(e,t,i){super(e,t,Um(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new _n(this.firestore,null,new Oe(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function si(n,e,...t){if(n=Dn(n),SN("collection","path",e),n instanceof lc){let i=kt.fromString(e,...t);return UR(i),new wo(n,null,i)}{if(!(n instanceof _n||n instanceof wo))throw new fe(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(kt.fromString(e,...t));return UR(i),new wo(n.firestore,null,i)}}function Cs(n,e,...t){if(n=Dn(n),arguments.length===1&&(e=Ra.newId()),SN("doc","path",e),n instanceof lc){let i=kt.fromString(e,...t);return VR(i),new _n(n,null,new Oe(i))}{if(!(n instanceof _n||n instanceof wo))throw new fe(Y.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(kt.fromString(e,...t));return VR(i),new _n(n.firestore,n instanceof wo?n.converter:null,new Oe(i))}}var EN="AsyncQueue",Om=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Im(this,"async_queue_retry"),this._c=()=>{let i=rw();i&&De(EN,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;let t=rw();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=rw();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new lr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!pc(e))throw e;De(EN,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,So("INTERNAL UNHANDLED ERROR: ",bN(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=v1.createAndSchedule(this,e,t,i,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&Le(47125,{Pc:bN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function bN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var No=class extends lc{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Om,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Om(e),this._firestoreClient=void 0,await e}}};function Yd(n,e){let t=typeof n=="object"?n:Kg(),i=typeof n=="string"?n:e||hm,r=bd(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let o=uR("firestore");o&&XP(r,...o)}return r}function Qd(n){if(n._terminated)throw new fe(Y.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AH(n),n._firestoreClient}function AH(n){let e=n._freezeSettings(),t=DH(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new C1(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}var jr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ln.fromBase64String(e))}catch(t){throw new fe(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(hc(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};jr._jsonSchemaVersion="firestore/bytes/1.0",jr._jsonSchema={type:on("string",jr._jsonSchemaVersion),bytes:on("string")};var cc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new oi(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var uc=class{constructor(e){this._methodName=e}};var xo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(hc(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};xo._jsonSchemaVersion="firestore/geoPoint/1.0",xo._jsonSchema={type:on("string",xo._jsonSchemaVersion),latitude:on("number"),longitude:on("number")};var Hr=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(hc(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new fe(Y.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Hr._jsonSchemaVersion="firestore/vectorValue/1.0",Hr._jsonSchema={type:on("string",Hr._jsonSchemaVersion),vectorValues:on("object")};var MH=/^__.*__$/,D1=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ro(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fa(e,this.data,t,this.fieldTransforms)}};function ZP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{dataSource:n})}}var A1=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(F(F({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Fm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(ZP(this.dataSource)&&MH.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},M1=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Wd(e)}createContext(e,t,i,r=!1){return new A1({dataSource:e,methodName:t,targetDoc:i,path:oi.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Jd(n){let e=n._freezeSettings(),t=Wd(n._databaseId);return new M1(n._databaseId,!!e.ignoreUndefinedProperties,t)}function X1(n,e,t,i,r,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);nk("Data must be an object, but it was:",s,i);let a=ek(i,s),l,c;if(o.merge)l=new Lr(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let f=mc(e,h,t);if(!s.contains(f))throw new fe(Y.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);NH(d,f)||d.push(f)}l=new Lr(d),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new D1(new ji(a),l,c)}var R1=class n extends uc{_toFieldTransform(e){return new Sw(e.path,new Pa)}isEqual(e){return e instanceof n}};function Z1(n,e,t,i=!1){return ex(t,n.createContext(i?4:3,e))}function ex(n,e){if(tk(n=Dn(n)))return nk("Unsupported field value:",e,n),ek(n,e);if(n instanceof uc)return(function(i,r){if(!ZP(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){let o=[],s=0;for(let a of i){let l=ex(a,r.childContextForArray(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Dn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return p7(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=sn.fromDate(i);return{timestampValue:vm(r.serializer,o)}}if(i instanceof sn){let o=new sn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:vm(r.serializer,o)}}if(i instanceof xo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof jr)return{bytesValue:vP(r.serializer,i._byteString)};if(i instanceof _n){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:j1(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Hr)return(function(s,a){let l=s instanceof Hr?s.toArray():s;return{mapValue:{fields:{[O1]:{stringValue:F1},[nc]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return B1(a.serializer,d)})}}}}}})(i,r);if(IP(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Gd(i)}`)})(n,e)}function ek(n,e){let t={};return HN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ua(n,(i,r)=>{let o=ex(r,e.childContextForField(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function tk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof sn||n instanceof xo||n instanceof jr||n instanceof _n||n instanceof uc||n instanceof Hr||IP(n))}function nk(n,e,t){if(!tk(t)||!TN(t)){let i=Gd(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function mc(n,e,t){if((e=Dn(e))instanceof cc)return e._internalPath;if(typeof e=="string")return ik(n,e);throw Fm("Field path arguments must be of type string or ",n,!1,void 0,t)}var RH=new RegExp("[~\\*/\\[\\]]");function ik(n,e,t){if(e.search(RH)>=0)throw Fm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new cc(...e.split("."))._internalPath}catch{throw Fm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fm(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new fe(Y.INVALID_ARGUMENT,a+n+l)}function NH(n,e){return n.some(t=>t.isEqual(e))}var jd=class{convertValue(e,t="none"){switch(xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(To(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Ua(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){let t=e.fields?.[nc].arrayValue?.values?.map(i=>Gt(i.doubleValue));return new Hr(t)}convertGeoPoint(e){return new xo(Gt(e.latitude),Gt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Vm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Rd(e));default:return null}}convertTimestamp(e){let t=Io(e);return new sn(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=kt.fromString(e);bt(SP(i),9688,{name:e});let r=new Nd(i.get(1),i.get(3)),o=new Oe(i.popFirst(5));return r.isEqual(t)||So(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var Hd=class extends jd{constructor(e){super(),this.firestore=e}convertBytes(e){return new jr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new _n(this.firestore,null,t)}};function Xd(){return new R1("serverTimestamp")}var rk="@firebase/firestore",ok="4.10.0";var Zd=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new _n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new tx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(mc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},tx=class extends Zd{data(){return super.data()}};function FH(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new fe(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var eh=class{},_c=class extends eh{};function zr(n,e,...t){let i=[];e instanceof eh&&i.push(e),i=i.concat(t),(function(o){let s=o.filter(l=>l instanceof nx).length,a=o.filter(l=>l instanceof Wm).length;if(s>1||s>0&&a>0)throw new fe(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var Wm=class n extends _c{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return ck(e._query,t),new ur(e.firestore,e.converter,jm(e._query,t))}_parse(e){let t=Jd(e.firestore);return(function(o,s,a,l,c,d,h){let f;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new fe(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ak(h,d);let x=[];for(let S of h)x.push(sk(l,o,S));f={arrayValue:{values:x}}}else f=sk(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ak(h,d),f=Z1(a,s,h,d==="in"||d==="not-in");return rn.create(c,d,f)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Po(n,e,t){let i=e,r=mc("where",n);return Wm._create(r,i,t)}var nx=class n extends eh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Hi.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let s=r,a=o.getFlattenedFilters();for(let l of a)ck(s,l),s=jm(s,l)})(e._query,t),new ur(e.firestore,e.converter,jm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var ix=class n extends _c{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(r,o,s){if(r.startAt!==null)throw new fe(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new fe(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ss(o,s)})(e._query,this._field,this._direction);return new ur(e.firestore,e.converter,iP(e._query,t))}};function Ii(n,e="asc"){let t=e,i=mc("orderBy",n);return ix._create(i,t)}var rx=class n extends _c{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new ur(e.firestore,e.converter,kd(e._query,this._limit,this._limitType))}};function ko(n){return CN("limit",n),rx._create("limit",n,"F")}var ox=class n extends _c{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=LH(e,this.type,this._docOrFields,this._inclusive);return new ur(e.firestore,e.converter,rP(e._query,t))}};function lk(...n){return ox._create("startAfter",n,!1)}function LH(n,e,t,i){if(t[0]=Dn(t[0]),t[0]instanceof Zd)return(function(o,s,a,l,c){if(!l)throw new fe(Y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of Aa(o))if(h.field.isKeyField())d.push(zd(s,l.key));else{let f=l.data.field(h.field);if($d(f))throw new fe(Y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){let g=h.field.canonicalString();throw new fe(Y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(f)}return new Co(d,c)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Jd(n.firestore);return(function(s,a,l,c,d,h){let f=s.explicitOrderBy;if(d.length>f.length)throw new fe(Y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let x=0;x<d.length;x++){let S=d[x];if(f[x].field.isKeyField()){if(typeof S!="string")throw new fe(Y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof S}`);if(!Bm(s)&&S.indexOf("/")!==-1)throw new fe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${S}' contains a slash.`);let R=s.path.child(kt.fromString(S));if(!Oe.isDocumentKey(R))throw new fe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let L=new Oe(R);g.push(zd(a,L))}else{let R=Z1(l,c,S);g.push(R)}}return new Co(g,h)})(n._query,n.firestore._databaseId,r,e,t,i)}}function sk(n,e,t){if(typeof(t=Dn(t))=="string"){if(t==="")throw new fe(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bm(e)&&t.indexOf("/")!==-1)throw new fe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(kt.fromString(t));if(!Oe.isDocumentKey(i))throw new fe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return zd(n,new Oe(i))}if(t instanceof _n)return zd(n,t._key);throw new fe(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gd(t)}.`)}function ak(n,e){if(!Array.isArray(n)||n.length===0)throw new fe(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ck(n,e){let t=(function(r,o){for(let s of r)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new fe(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function uk(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var ja=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ha=class n extends Zd{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new yc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(mc("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(Y.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Ha._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ha._jsonSchema={type:on("string",Ha._jsonSchemaVersion),bundleSource:on("string","DocumentSnapshot"),bundleName:on("string"),bundle:on("string")};var yc=class extends Ha{data(e={}){return super.data(e)}},vc=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ja(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new yc(this._firestore,this._userDataWriter,i.key,i,new ja(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{let l=new yc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new ja(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new yc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new ja(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),c=-1,d=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:VH(a.type),doc:l,oldIndex:c,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(Y.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ra.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function VH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}vc._jsonSchemaVersion="firestore/querySnapshot/1.0",vc._jsonSchema={type:on("string",vc._jsonSchemaVersion),bundleSource:on("string","QuerySnapshot"),bundleName:on("string"),bundle:on("string")};function sx(n){n=$r(n,_n);let e=$r(n.firestore,No),t=Qd(e);return qP(t,n._key).then(i=>UH(e,n,i))}function Oo(n){n=$r(n,ur);let e=$r(n.firestore,No),t=Qd(e),i=new Hd(e);return FH(n._query),KP(t,n._query).then(r=>new vc(e,i,n,r))}function qm(n,e,t){n=$r(n,_n);let i=$r(n.firestore,No),r=uk(n.converter,e,t),o=Jd(i);return dk(i,[X1(o,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,bo.none())])}function th(n,e){let t=$r(n.firestore,No),i=Cs(n),r=uk(n.converter,e),o=Jd(n.firestore);return dk(t,[X1(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,bo.exists(!1))]).then(()=>i)}function dk(n,e){let t=Qd(n);return YP(t,e)}function UH(n,e,t){let i=t.docs.get(e._key),r=new Hd(n);return new Ha(n,r,e._key,i,new ja(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){wN(bs),Es(new Ui("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),a=new No(new om(i.getProvider("auth-internal")),new am(s,i.getProvider("app-check-internal")),qN(s,r),s);return o=F({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),ar(rk,ok,e),ar(rk,ok,"esm2020")})();function Tk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Ck=Tk,Dk=new yo("auth","Firebase",Tk());var Zm=new vs("@firebase/auth");function BH(n,...e){Zm.logLevel<=tt.WARN&&Zm.warn(`Auth (${bs}): ${n}`,...e)}function Ym(n,...e){Zm.logLevel<=tt.ERROR&&Zm.error(`Auth (${bs}): ${n}`,...e)}function qr(n,...e){throw Sx(n,...e)}function dr(n,...e){return Sx(n,...e)}function xx(n,e,t){let i=ce(F({},Ck()),{[e]:t});return new yo("auth","Firebase",i).create(e,{appName:n.name})}function Ga(n){return xx(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jH(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&qr(n,"argument-error"),xx(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Sx(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Dk.create(n,...e)}function je(n,e,...t){if(!n)throw Sx(e,...t)}function Fo(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ym(e),new Error(e)}function Vo(n,e){n||Fo(e)}function cx(){return typeof self<"u"&&self.location?.href||""}function HH(){return hk()==="http:"||hk()==="https:"}function hk(){return typeof self<"u"&&self.location?.protocol||null}function GH(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HH()||pR()||"connection"in navigator)?navigator.onLine:!0}function $H(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var $a=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vo(t>e,"Short delay should be less than long delay!"),this.isMobile=hR()||gR()}get(){return GH()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ix(n,e){Vo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var e0=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var zH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var WH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qH=new $a(3e4,6e4);function Tx(n,e){return n.tenantId&&!e.tenantId?ce(F({},e),{tenantId:n.tenantId}):e}async function bc(n,e,t,i,r={}){return Ak(n,r,async()=>{let o={},s={};i&&(e==="GET"?s=i:o={body:JSON.stringify(i)});let a=ql(F({key:n.config.apiKey},s)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let c=F({method:e,headers:l},o);return fR()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&ys(n.emulatorConfig.host)&&(c.credentials="include"),e0.fetch()(await Mk(n,n.config.apiHost,t,a),c)})}async function Ak(n,e,t){n._canInitEmulator=!1;let i=F(F({},zH),e);try{let r=new ux(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw Km(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Km(n,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw Km(n,"email-already-in-use",s);if(l==="USER_DISABLED")throw Km(n,"user-disabled",s);let d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw xx(n,d,c);qr(n,d)}}catch(r){if(r instanceof xi)throw r;qr(n,"network-request-failed",{message:String(r)})}}async function KH(n,e,t,i,r={}){let o=await bc(n,e,t,i,r);return"mfaPendingCredential"in o&&qr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function Mk(n,e,t,i){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?Ix(n.config,r):`${n.config.apiScheme}://${r}`;return WH.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var ux=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(dr(this.auth,"network-request-failed")),qH.get())})}};function Km(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=dr(n,e,i);return r.customData._tokenResponse=t,r}async function YH(n,e){return bc(n,"POST","/v1/accounts:delete",e)}async function t0(n,e){return bc(n,"POST","/v1/accounts:lookup",e)}function nh(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Rk(n,e=!1){let t=Dn(n),i=await t.getIdToken(e),r=Cx(i);je(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:nh(ax(r.auth_time)),issuedAtTime:nh(ax(r.iat)),expirationTime:nh(ax(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function ax(n){return Number(n)*1e3}function Cx(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Ym("JWT malformed, contained fewer than 3 sections"),null;try{let r=jg(t);return r?JSON.parse(r):(Ym("Failed to decode base64 JWT payload"),null)}catch(r){return Ym("Caught error parsing JWT payload as JSON",r?.toString()),null}}function fk(n){let e=Cx(n);return je(e,"internal-error"),je(typeof e.exp<"u","internal-error"),je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function rh(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof xi&&QH(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function QH({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var dx=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var oh=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nh(this.lastLoginAt),this.creationTime=nh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function n0(n){let e=n.auth,t=await n.getIdToken(),i=await rh(n,t0(e,{idToken:t}));je(i?.users.length,e,"internal-error");let r=i.users[0];n._notifyReloadListener(r);let o=r.providerUserInfo?.length?Pk(r.providerUserInfo):[],s=JH(n.providerData,o),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!s?.length,c=a?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new oh(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(n,d)}async function Nk(n){let e=Dn(n);await n0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function JH(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Pk(n){return n.map(i=>{var r=i,{providerId:e}=r,t=Ja(r,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function XH(n,e){let t=await Ak(n,{},async()=>{let i=ql({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=await Mk(n,r,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return n.emulatorConfig&&ys(n.emulatorConfig.host)&&(l.credentials="include"),e0.fetch()(s,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function ZH(n,e){return bc(n,"POST","/v2/accounts:revokeToken",Tx(n,e))}var ih=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){je(e.idToken,"internal-error"),je(typeof e.idToken<"u","internal-error"),je(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){je(e.length!==0,"internal-error");let t=fk(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:r,expiresIn:o}=await XH(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n;return i&&(je(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(je(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(je(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Fo("not implemented")}};function Ds(n,e){je(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var As=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:i}=s,r=Ja(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new dx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new oh(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await rh(this,this.stsTokenManager.getToken(this.auth,e));return je(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Rk(this,e)}reload(){return Nk(this)}_assign(e){this!==e&&(je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>F({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(ce(F({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await n0(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Si(this.auth.app))return Promise.reject(Ga(this.auth));let e=await this.getIdToken();return await rh(this,YH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return ce(F({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>F({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:g,providerData:x,stsTokenManager:S}=t;je(h&&S,e,"internal-error");let R=ih.fromJSON(this.name,S);je(typeof h=="string",e,"internal-error"),Ds(i,e.name),Ds(r,e.name),je(typeof f=="boolean",e,"internal-error"),je(typeof g=="boolean",e,"internal-error"),Ds(o,e.name),Ds(s,e.name),Ds(a,e.name),Ds(l,e.name),Ds(c,e.name),Ds(d,e.name);let L=new n({uid:h,auth:e,email:r,emailVerified:f,displayName:i,isAnonymous:g,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:R,createdAt:c,lastLoginAt:d});return x&&Array.isArray(x)&&(L.providerData=x.map(q=>F({},q))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,i=!1){let r=new ih;r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await n0(o),o}static async _fromGetAccountInfoResponse(e,t,i){let r=t.users[0];je(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?Pk(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,a=new ih;a.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new oh(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(l,c),l}};var pk=new Map;function Lo(n){Vo(n instanceof Function,"Expected a class definition");let e=pk.get(n);return e?(Vo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,pk.set(n,e),e)}var eG=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,i){this.storage[t]=i}async _get(t){let i=this.storage[t];return i===void 0?null:i}async _remove(t){delete this.storage[t]}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),hx=eG;function Qm(n,e,t){return`firebase:${n}:${e}:${t}`}var i0=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=Qm(this.userKey,r.apiKey,o),this.fullPersistenceKey=Qm("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await t0(this.auth,{idToken:e}).catch(()=>{});return t?As._fromGetAccountInfoResponse(this.auth,t,e):null}return As._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new n(Lo(hx),e,i);let r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c),o=r[0]||Lo(hx),s=Qm(i,e.config.apiKey,e.name),a=null;for(let c of t)try{let d=await c._get(s);if(d){let h;if(typeof d=="string"){let f=await t0(e,{idToken:d}).catch(()=>{});if(!f)break;h=await As._fromGetAccountInfoResponse(e,f,d)}else h=As._fromJSON(e,d);c!==o&&(a=h),o=c;break}}catch{}let l=r.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,i):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==o)try{await c._remove(s)}catch{}})),new n(o,e,i))}};function gk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Lk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(kk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Uk(e))return"Blackberry";if(Bk(e))return"Webos";if(Ok(e))return"Safari";if((e.includes("chrome/")||Fk(e))&&!e.includes("edge/"))return"Chrome";if(Vk(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function kk(n=Cn()){return/firefox\//i.test(n)}function Ok(n=Cn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fk(n=Cn()){return/crios\//i.test(n)}function Lk(n=Cn()){return/iemobile/i.test(n)}function Vk(n=Cn()){return/android/i.test(n)}function Uk(n=Cn()){return/blackberry/i.test(n)}function Bk(n=Cn()){return/webos/i.test(n)}function Dx(n=Cn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function tG(n=Cn()){return Dx(n)&&!!window.navigator?.standalone}function nG(){return mR()&&document.documentMode===10}function jk(n=Cn()){return Dx(n)||Vk(n)||Bk(n)||Uk(n)||/windows phone/i.test(n)||Lk(n)}function Hk(n,e=[]){let t;switch(n){case"Browser":t=gk(Cn());break;case"Worker":t=`${gk(Cn())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bs}/${i}`}var fx=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=o=>new Promise((s,a)=>{try{let l=e(o);s(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}};async function iG(n,e={}){return bc(n,"GET","/v2/passwordPolicy",Tx(n,e))}var rG=6,px=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??rG,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var gx=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new r0(this),this.idTokenSubscription=new r0(this),this.beforeStateQueue=new fx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Lo(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await i0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await t0(this,{idToken:e}),i=await As._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Si(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await n0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$H()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Si(this.app))return Promise.reject(Ga(this));let t=e?Dn(e):null;return t&&je(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Si(this.app)?Promise.reject(Ga(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Si(this.app)?Promise.reject(Ga(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Lo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await iG(this),t=new px(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await ZH(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Lo(e)||this._popupRedirectResolver;je(t,this,"argument-error"),this.redirectPersistenceManager=await i0.create(this,[Lo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(je(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{s=!0,l()}}else{let l=e.addObserver(t);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Si(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&BH(`Error while retrieving App Check token: ${e.error}`),e?.token}};function h0(n){return Dn(n)}var r0=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=ER(t=>this.observer=t)}get next(){return je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ax={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oG(n){Ax=n}function sG(n){return Ax.loadJS(n)}function aG(){return Ax.gapiScript}function Gk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function $k(n,e){let t=bd(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(sr(o,e??{}))return r;qr(r,"already-initialized")}return t.initialize({options:e})}function lG(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Lo);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function zk(n,e,t){let i=h0(n);je(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=Wk(e),{host:s,port:a}=cG(e),l=a===null?"":`:${a}`,c={url:`${o}//${s}${l}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){je(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),je(sr(c,i.config.emulator)&&sr(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,ys(s)?(Gg(`${o}//${s}${l}`),$g("Auth",!0)):r||uG()}function Wk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function cG(n){let e=Wk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:mk(i.substr(o.length+1))}}else{let[o,s]=i.split(":");return{host:o,port:mk(s)}}}function mk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function uG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var sh=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fo("not implemented")}_getIdTokenResponse(e){return Fo("not implemented")}_linkToIdToken(e,t){return Fo("not implemented")}_getReauthenticationResolver(e){return Fo("not implemented")}};async function Ec(n,e){return KH(n,"POST","/v1/accounts:signInWithIdp",Tx(n,e))}var dG="http://localhost",o0=class n extends sh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=a,o=Ja(a,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return Ec(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,Ec(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ec(e,t)}buildRequest(){let e={requestUri:dG,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ql(t)}return e}};var ah=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var s0=class extends ah{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Mx=(()=>{class n extends s0{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return o0._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var lh=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){let o=await As._fromIdTokenResponse(e,i,r),s=yk(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);let r=yk(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})}};function yk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var mx=class n extends xi{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function qk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?mx._fromErrorAndOperation(n,o,e,i):o})}async function hG(n,e,t=!1){let i=await rh(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return lh._forOperation(n,"link",i)}async function fG(n,e,t=!1){let{auth:i}=n;if(Si(i.app))return Promise.reject(Ga(i));let r="reauthenticate";try{let o=await rh(n,qk(i,r,e,n),t);je(o.idToken,i,"internal-error");let s=Cx(o.idToken);je(s,i,"internal-error");let{sub:a}=s;return je(n.uid===a,i,"user-mismatch"),lh._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&qr(i,"user-mismatch"),o}}async function pG(n,e,t=!1){if(Si(n.app))return Promise.reject(Ga(n));let i="signIn",r=await qk(n,i,e),o=await lh._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}function Kk(n,e,t,i){return Dn(n).onIdTokenChanged(e,t,i)}function Yk(n,e,t){return Dn(n).beforeAuthStateChanged(e,t)}function Rx(n,e,t,i){return Dn(n).onAuthStateChanged(e,t,i)}function Nx(n){return Dn(n).signOut()}var a0="__sak";var l0=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(a0,"1"),this.storage.removeItem(a0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var gG=1e3,mG=10,yG=(()=>{class n extends l0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);nG()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,mG):o()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},gG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,i){await super._set(t,i),this.localCache[t]=JSON.stringify(i)}async _get(t){let i=await super._get(t);return this.localCache[t]=JSON.stringify(i),i}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),Qk=yG;var vG=(()=>{class n extends l0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),Px=vG;function _G(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var EG=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let i=t,{eventId:r,eventType:o,data:s}=i.data,a=this.handlersMap[o];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let l=Array.from(a).map(async d=>d(i.origin,s)),c=await _G(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:c})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function kx(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var yx=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{let c=kx("",20);r.port1.start();let d=setTimeout(()=>{l(new Error("unsupported_event"))},i);s={messageChannel:r,onMessage(h){let f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(f.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function Wr(){return window}function bG(n){Wr().location.href=n}function Jk(){return typeof Wr().WorkerGlobalScope<"u"&&typeof Wr().importScripts=="function"}async function wG(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xG(){return navigator?.serviceWorker?.controller||null}function SG(){return Jk()?self:null}var Xk="firebaseLocalStorageDb",IG=1,c0="firebaseLocalStorage",Zk="fbase_key",za=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function f0(n,e){return n.transaction([c0],e?"readwrite":"readonly").objectStore(c0)}function TG(){let n=indexedDB.deleteDatabase(Xk);return new za(n).toPromise()}function vx(){let n=indexedDB.open(Xk,IG);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(c0,{keyPath:Zk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{let i=n.result;i.objectStoreNames.contains(c0)?e(i):(i.close(),await TG(),e(await vx()))})})}async function vk(n,e,t){let i=f0(n,!0).put({[Zk]:e,value:t});return new za(i).toPromise()}async function CG(n,e){let t=f0(n,!1).get(e),i=await new za(t).toPromise();return i===void 0?null:i.value}function _k(n,e){let t=f0(n,!0).delete(e);return new za(t).toPromise()}var DG=800,AG=3,MG=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await vx(),this.db)}async _withRetries(t){let i=0;for(;;)try{let r=await this._openDb();return await t(r)}catch(r){if(i++>AG)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Jk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=EG._getInstance(SG()),this.receiver._subscribe("keyChanged",async(t,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(t,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await wG(),!this.activeServiceWorker)return;this.sender=new yx(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||xG()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await vx();return await vk(t,a0,"1"),await _k(t,a0),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,i){return this._withPendingWrite(async()=>(await this._withRetries(r=>vk(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)))}async _get(t){let i=await this._withRetries(r=>CG(r,t));return this.localCache[t]=i,i}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(i=>_k(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=f0(o,!1).getAll();return new za(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),eO=MG;var Bhe=Gk("rcb"),jhe=new $a(3e4,6e4);function tO(n,e){return e?Lo(e):(je(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var ch=class extends sh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ec(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ec(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ec(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function RG(n){return pG(n.auth,new ch(n),n.bypassAuthState)}function NG(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),fG(t,new ch(n),n.bypassAuthState)}async function PG(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),hG(t,new ch(n),n.bypassAuthState)}var u0=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RG;case"linkViaPopup":case"linkViaRedirect":return PG;case"reauthViaPopup":case"reauthViaRedirect":return NG;default:qr(this.auth,"internal-error")}}resolve(e){Vo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var kG=new $a(2e3,1e4);async function Ox(n,e,t){if(Si(n.app))return Promise.reject(dr(n,"operation-not-supported-in-this-environment"));let i=h0(n);jH(n,e,ah);let r=tO(i,t);return new OG(i,"signInViaPopup",e,r).executeNotNull()}var OG=(()=>{class n extends u0{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return je(t,this.auth,"internal-error"),t}async onExecution(){Vo(this.filter.length===1,"Popup operations only handle one event");let t=kx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(dr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(dr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,kG.get())};t()}}n.currentPopupAction=null;return n})(),FG="pendingRedirect",Jm=new Map,_x=class extends u0{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Jm.get(this.auth._key());if(!e){try{let i=await LG(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Jm.set(this.auth._key(),e)}return this.bypassAuthState||Jm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function LG(n,e){let t=BG(e),i=UG(n);if(!await i._isAvailable())return!1;let r=await i._get(t)==="true";return await i._remove(t),r}function VG(n,e){Jm.set(n._key(),e)}function UG(n){return Lo(n._redirectPersistence)}function BG(n){return Qm(FG,n.config.apiKey,n.name)}async function jG(n,e,t=!1){if(Si(n.app))return Promise.reject(Ga(n));let i=h0(n),r=tO(i,e),s=await new _x(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}var HG=600*1e3,Ex=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!GG(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!nO(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(dr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=HG&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ek(e))}saveEventToCache(e){this.cachedEventUids.add(Ek(e)),this.lastProcessedEventTime=Date.now()}};function Ek(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function nO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function GG(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nO(n);default:return!1}}async function $G(n,e={}){return bc(n,"GET","/v1/projects",e)}var zG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,WG=/^https?/;async function qG(n){if(n.config.emulator)return;let{authorizedDomains:e}=await $G(n);for(let t of e)try{if(KG(t))return}catch{}qr(n,"unauthorized-domain")}function KG(n){let e=cx(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i}if(!WG.test(t))return!1;if(zG.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var YG=new $a(3e4,6e4);function bk(){let n=Wr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function QG(n){return new Promise((e,t)=>{function i(){bk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bk(),t(dr(n,"network-request-failed"))},timeout:YG.get()})}if(Wr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Wr().gapi?.load)i();else{let r=Gk("iframefcb");return Wr()[r]=()=>{gapi.load?i():t(dr(n,"network-request-failed"))},sG(`${aG()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw Xm=null,e})}var Xm=null;function JG(n){return Xm=Xm||QG(n),Xm}var XG=new $a(5e3,15e3),ZG="__/auth/iframe",e$="emulator/auth/iframe",t$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function i$(n){let e=n.config;je(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Ix(e,e$):`https://${n.config.authDomain}/${ZG}`,i={apiKey:e.apiKey,appName:n.name,v:bs},r=n$.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${ql(i).slice(1)}`}async function r$(n){let e=await JG(n),t=Wr().gapi;return je(t,n,"internal-error"),e.open({where:document.body,url:i$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t$,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});let s=dr(n,"network-request-failed"),a=Wr().setTimeout(()=>{o(s)},XG.get());function l(){Wr().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{o(s)})}))}var o$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},s$=500,a$=600,l$="_blank",c$="http://localhost",d0=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function u$(n,e,t,i=s$,r=a$){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=ce(F({},o$),{width:i.toString(),height:r.toString(),top:o,left:s}),c=Cn().toLowerCase();t&&(a=Fk(c)?l$:t),kk(c)&&(e=e||c$,l.scrollbars="yes");let d=Object.entries(l).reduce((f,[g,x])=>`${f}${g}=${x},`,"");if(tG(c)&&a!=="_self")return d$(e||"",a),new d0(null);let h=window.open(e||"",a,d);je(h,n,"popup-blocked");try{h.focus()}catch{}return new d0(h)}function d$(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var h$="__/auth/handler",f$="emulator/auth/handler",p$=encodeURIComponent("fac");async function wk(n,e,t,i,r,o){je(n.config.authDomain,n,"auth-domain-config-required"),je(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:bs,eventId:r};if(e instanceof ah){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",_R(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(o||{}))s[d]=h}if(e instanceof s0){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let l=await n._getAppCheckToken(),c=l?`#${p$}=${encodeURIComponent(l)}`:"";return`${g$(n)}?${ql(a).slice(1)}${c}`}function g$({config:n}){return n.emulator?Ix(n,f$):`https://${n.authDomain}/${h$}`}var lx="webStorageSupport",bx=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Px,this._completeRedirectFn=jG,this._overrideRedirectResult=VG}async _openPopup(e,t,i,r){Vo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await wk(e,t,i,cx(),r);return u$(e,o,kx())}async _openRedirect(e,t,i,r){await this._originValidation(e);let o=await wk(e,t,i,cx(),r);return bG(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Vo(o,"If manager is not set, promise should be"),o)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await r$(e),i=new Ex(e);return t.register("authEvent",r=>(je(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(lx,{type:lx},r=>{let o=r?.[0]?.[lx];o!==void 0&&t(!!o),qr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=qG(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jk()||Ok()||Dx()}},iO=bx;var xk="@firebase/auth",Sk="1.12.0";var wx=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function m$(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function y$(n){Es(new Ui("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=i.options;je(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hk(n)},c=new gx(i,r,o,l);return lG(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Es(new Ui("auth-internal",e=>{let t=h0(e.getProvider("auth").getImmediate());return(i=>new wx(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ar(xk,Sk,m$(n)),ar(xk,Sk,"esm2020")}var v$=300,_$=Pb("authIdTokenMaxAge")||v$,Ik=null,E$=n=>async e=>{let t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>_$)return;let r=t?.token;Ik!==r&&(Ik=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function uh(n=Kg()){let e=bd(n,"auth");if(e.isInitialized())return e.getImmediate();let t=$k(n,{popupRedirectResolver:iO,persistence:[eO,Qk,Px]}),i=Pb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=E$(o.toString());Yk(t,s,()=>s(t.currentUser)),Kk(t,a=>s(a))}}let r=Rb("auth");return r&&zk(t,`http://${r}`),t}function b$(){return document.getElementsByTagName("head")?.[0]??document}oG({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=dr("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",b$().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});y$("Browser");var p0={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var Rn=class n{constructor(e){this.platformId=e;let t=wd(p0);try{this.db=Yd(t)}catch(i){console.warn("Firestore init failed (likely SSR)",i)}if(fs(this.platformId))try{this.auth=uh(t),Rx(this.auth,i=>{this.user$.set(i),i?(this.loadedMasteriesUserId!==i.uid||!this.masteryProfile())&&this.loadTowerDefenseMasteries(i.uid):(this.masteryProfile.set(null),this.loadedMasteriesUserId=null)})}catch(i){console.warn("Auth init failed",i)}}db=null;auth=null;loadedMasteriesUserId=null;user$=$(null);masteryProfile=$(null);async loginWithGoogle(){if(!(!this.auth||!fs(this.platformId)))try{let e=new Mx;await Ox(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await Nx(this.auth)}async saveHighScore(e){if(this.db)try{await th(si(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,i){if(!this.db)return[];try{let r=zr(si(this.db,"highscores"),Po("difficulty","==",t),Po("mapSize","==",i),Ii("victory","desc"),Ii("turnsPlayed","asc"),ko(e));return(await Oo(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching scores: ",r),[]}}async getUserScores(e){if(!this.db)return[];try{let t=zr(si(this.db,"highscores"),Po("userId","==",e),Po("victory","==",!0),Ii("turnsPlayed","asc"));return(await Oo(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}async saveTowerDefenseScore(e){if(this.db)try{console.count("FIREBASE_CALL: saveTowerDefenseScore");let t;if(e.userId)try{let r=Cs(this.db,"towerDefenseMasteries",e.userId),o=await sx(r);if(o.exists()){let s=o.data();t=s&&typeof s.totalXp=="number"?s.totalXp:0}}catch{t=void 0}let i=ce(F({},e),{userTotalXp:t,timestamp:Xd()});await th(si(this.db,"towerDefenseLeaderboards"),i)}catch(t){console.error("Error adding TD score: ",t)}}async getTopTowerDefenseScores(e){if(!this.db)return[];try{let t=zr(si(this.db,"towerDefenseLeaderboards"),Ii("maxWave","desc"),Ii("timestamp","desc"),ko(e));return(await Oo(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching TD scores: ",t),[]}}async getUserBestTowerDefenseScore(e){if(!this.db)return null;try{let t=zr(si(this.db,"towerDefenseLeaderboards"),Po("userId","==",e),Ii("maxWave","desc"),Ii("timestamp","desc"),ko(1)),i=await Oo(t);return i.empty?null:i.docs[0].data()}catch{return null}}async loadTowerDefenseMasteries(e){if(this.db&&!(this.loadedMasteriesUserId===e&&this.masteryProfile()))try{console.count("FIREBASE_CALL: loadTowerDefenseMasteries");let t=Cs(this.db,"towerDefenseMasteries",e),i=await sx(t);if(i.exists()){let r=i.data(),o={totalXp:typeof r.totalXp=="number"?r.totalXp:0,usedPoints:typeof r.usedPoints=="number"?r.usedPoints:0,upgrades:r.upgrades&&typeof r.upgrades=="object"?r.upgrades:{}};this.masteryProfile.set(o)}else{let r={totalXp:0,usedPoints:0,upgrades:{}};await qm(t,F({userId:e},r)),this.masteryProfile.set(r)}this.loadedMasteriesUserId=e}catch(t){console.error("Error loading TD mastery profile: ",t)}}setMasteryProfile(e){this.masteryProfile.set(e)}async saveTowerDefenseMasteries(){if(!this.db)return;let e=this.user$(),t=this.masteryProfile();if(!(!e||!t))try{console.count("FIREBASE_CALL: saveTowerDefenseMasteries");let i=Cs(this.db,"towerDefenseMasteries",e.uid);await qm(i,F({userId:e.uid},t),{merge:!0})}catch(i){console.error("Error saving TD mastery profile: ",i)}}async awardTowerDefenseXp(e){if(!this.db||e<=0)return;let t=this.user$();if(t)try{console.count("FIREBASE_CALL: awardTowerDefenseXp");let i=this.masteryProfile()??{totalXp:0,usedPoints:0,upgrades:{}},r={totalXp:i.totalXp+e,usedPoints:i.usedPoints,upgrades:i.upgrades},o=Cs(this.db,"towerDefenseMasteries",t.uid);await qm(o,F({userId:t.uid},r),{merge:!0}),this.masteryProfile.set(r)}catch(i){console.error("Error awarding TD XP: ",i)}}static \u0275fac=function(t){return new(t||n)(Ne(Zi))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var wc=class n{platformId=K(Zi);nameSignal=$("Player");constructor(){if(fs(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),fs(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let i=(e??"").toString().trim().slice(0,24);return i.length>0?i:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Gn=class n{constructor(e,t,i,r,o,s,a,l,c){this.combat=e;this.build=t;this.log=i;this.settings=r;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=l;this.playerName=c;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}breakpointObserver=K(Cb);screenState=J2(this.breakpointObserver.observe("(max-width: 1024px)").pipe(yt(e=>e.matches)),{initialValue:!1});unitsSignal=$([]);turnSignal=$(1);selectedUnitIdSignal=$(null);gameStatusSignal=$("playing");lastMergedUnitIdSignal=$(null);lastRemainderUnitIdSignal=$(null);resourcesSignal=$({wood:0,iron:0});forestsSignal=$([]);minesSignal=$([]);forgeSitesSignal=$([]);forgesSignal=$([]);aiForgesSignal=$([]);baseHealthSignal=$({player:100,ai:100});reservePointsSignal=$({player:0,ai:0});deployTargetsSignal=$([]);baseDeployActiveSignal=$(!1);wallsSignal=$([]);playerVisibilitySignal=$(new Set);aiVisibilitySignal=$(new Set);playerExploredSignal=$(new Set);aiExploredSignal=$(new Set);unitMoveHistorySignal=$(new Map);unitStutterBanSignal=$(new Map);lastAiMovedUnitIdSignal=$(null);aiConsecMovesSignal=$(0);buildModeSignal=$(!1);fogDebugDisabledSignal=$(!1);wallBuiltThisTurnSignal=$(!1);rulesOpenSignal=$(!1);movedThisTurnSignal=$(new Set);hoveredFormationIdSignal=$(null);aiWoodSignal=$(0);aiIronSignal=$(0);logsOpenSignal=$(!1);settingsOpenSignal=$(!1);activeSideSignal=$("ai");lastArrivedUnitIdSignal=$(null);attackerNudgeSignal=$(null);shakenUnitIdSignal=$(null);shakenWallIdSignal=$(null);pulseUnitIdSignal=$(null);screenShakeSignal=$(!1);endOverlaySignal=$(!1);endReasonSignal=$(null);combatOnlySignal=$(!0);forestMonopolySignal=$({player:0,ai:0});hoveredUnitIdSignal=$(null);autoDeployEnabledSignal=$(!1);highScoresOpenSignal=$(!1);leaderboardOpenSignal=$(!1);namePromptOpenSignal=$(!1);pendingScoreSignal=$(null);supportOpenSignal=$(!1);highScoresSignal=$({});playerConvertedThisTurnSignal=$(!1);unitQuadrantBiasSignal=$(new Map);aiUnitTimeNearBaseSignal=$(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=$(!1);wallCooldownSignal=$(new Map);aiQueuedUnitIdSignal=$(null);aiMoodSignal=$("none");rageCaptureCounterSignal=$(0);anchoredGatherersSignal=$(new Set);totalWarModeSignal=$(!1);aiInvalidActionCountSignal=$(0);aiLastRejectedActionKeySignal=$(null);sandboxSpawnPendingSignal=$(null);unitMoveOffsetSignal=$(new Map);movingUnitsSignal=$(new Set);attackingUnitsSignal=$(new Set);reclamationGoalsSignal=$(new Map);mergeIntentSignal=$(new Map);ignoreForgeUntilTurnSignal=$(new Map);playerClaimedTargetsSignal=$(new Set);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();mines=this.minesSignal.asReadonly();forges=this.forgesSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();isMobile=ni(()=>this.screenState());sandboxSpawnPending(){return this.sandboxSpawnPendingSignal()}getMoveOffsetFor(e){return this.unitMoveOffsetSignal().get(e)??null}isUnitMoving(e){return this.movingUnitsSignal().has(e)}isUnitAttacking(e){return this.attackingUnitsSignal().has(e)}getCombinedTransform(e){let t=this.attackerNudgeSignal(),i=this.getMoveOffsetFor(e),r=(t&&t.id===e?t.dx:0)+(i?i.dx:0),o=(t&&t.id===e?t.dy:0)+(i?i.dy:0);return`translate(${r}px, ${o}px)`}aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=ni(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=ni(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?this.isMobile()?4:6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?12:16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(r=>r.owner==="player"&&this.isForest(r.position.x,r.position.y)).length,i=this.unitsSignal().filter(r=>r.owner==="ai"&&this.isForest(r.position.x,r.position.y)).length;return{total:e,player:t,ai:i}}resetGame(){let e=this.settings.difficulty();this.stopAiLoops(),this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0,iron:0}),this.baseHealthSignal.set(this.settings.customMode()?{player:1e3,ai:1e3}:{player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:5,ai:5}):e==="normal"?this.reservePointsSignal.set({player:1,ai:1}):e==="hard"?this.reservePointsSignal.set({player:1,ai:3}):this.reservePointsSignal.set({player:1,ai:5}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"))),this.minesSignal.set(this.map.generateMines(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"),this.forestsSignal())),this.forgeSitesSignal.set([]),this.forgesSignal.set([]),this.aiForgesSignal.set([]);let t=new Set(this.forestsSignal().map(i=>`${i.x},${i.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(i=>i.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(r=>r.x===e.x&&r.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let i=!1,r=!1,o=null;this.unitsSignal.update(f=>{let g=[...f],x=g.findIndex(T=>T.id===e.id);if(x===-1)return f;let S=F({},g[x]),R={x:S.position.x,y:S.position.y},L=t.x-R.x,q=t.y-R.y,ye=Math.sign(L),_e=Math.sign(q),xe=this.combat.checkWallAlongPath(R,t,S.owner,(T,k,I,w)=>this.getWallBetween(T,k,I,w));if(xe.hitOwn)return g;if(xe.hitEnemy){let T=xe.lastFrom,k=this.getWallBetween(T.x,T.y,t.x,t.y);{let w=k.maxHealth??100,N=this.combat.getWallHitAmount(S.tier),M=Math.max(0,k.health-N);this.wallsSignal.update(be=>be.map(de=>de.id===k.id?ce(F({},de),{health:M}):de).filter(de=>(de.health??de.hitsRemaining??0)>0)),M<=0&&this.registerWallDestroyedEdge(T,t);let ae=k.owner==="neutral"?"Neutral":k.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${S.tier} Unit attacked ${ae} Wall. Damage: ${N}. Wall HP: ${M}/${w}.`)}this.updateWallFormations(),this.shakenWallIdSignal.set(k.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let I=g.findIndex(w=>w.id===S.id);return I!==-1&&(g[I]=ce(F({},g[I]),{hasActed:!0})),g}let Ie=this.getBasePosition(S.owner==="player"?"ai":"player");if(t.x===Ie.x&&t.y===Ie.y)return this.baseHealthSignal.update(T=>{let k=S.owner==="player"?"ai":"player",I=F({},T);return I[k]=Math.max(0,I[k]-this.calculatePower(S)),I}),g.splice(x,1),g;let O=g.findIndex(T=>T.position.x===t.x&&T.position.y===t.y&&T.id!==S.id);if(O!==-1){let T=g[O],k={x:t.x-ye,y:t.y-_e};if(this.inBounds(k.x,k.y)){if(ye!==0&&_e!==0){if(this.combat.isDiagonalBlocked(k,t,(I,w,N,M)=>this.getWallBetween(I,w,N,M)))return i=!1,g}else if(this.getWallBetween(k.x,k.y,t.x,t.y))return i=!1,g}if(T.owner===S.owner)if(this.shakenUnitIdSignal.set(S.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),T.tier===S.tier){let I=T.tier,w=this.calculateTotalPoints(S)+this.calculateTotalPoints(T),N={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},M=N[I][3];if(w<=M){T.points=w;let be=this.calculateTierAndLevel(T.points);T.tier=be.tier,T.level=be.level;let de=!!(T.hasWeapon||S.hasWeapon),Tt=!!(T.hasArmor||S.hasArmor),Xt=Tt?Math.max(T.armorHp??0,S.armorHp??0):0;T.hasWeapon=de,T.hasArmor=Tt,T.armorHp=Xt,g.splice(x,1)}else{let be=Math.min(4,I+1),de=N[be][0];T.points=de;let Tt=this.calculateTierAndLevel(T.points);T.tier=Tt.tier,T.level=Tt.level;let Xt=!!(T.hasWeapon||S.hasWeapon),Pe=!!(T.hasArmor||S.hasArmor),Wt=Pe?Math.max(T.armorHp??0,S.armorHp??0):0;T.hasWeapon=Xt,T.hasArmor=Pe,T.armorHp=Wt;let lt=w-de;if(lt>0){S.points=lt;let oe=this.calculateTierAndLevel(S.points);S.tier=oe.tier,S.level=oe.level,S.hasWeapon=!1,S.hasArmor=!1,S.armorHp=0,g[x]=S,o=S.id}else g.splice(x,1)}r=!0;let ae=new Map(this.mergeIntentSignal());ae.delete(S.id),ae.delete(T.id),this.mergeIntentSignal.set(ae)}else return g;else{{let oe=t.x-R.x,se=t.y-R.y,Se=Math.abs(oe)>=Math.abs(se),Ee=Math.sign(Se?oe:se),ve=this.wallThicknessPx+2,b=this.tileSizePx+ve,ue=Math.round(b*.35),qe=Se?Ee*ue:0,Ke=Se?0:Ee*ue,le=new Set(this.attackingUnitsSignal());le.add(S.id),this.attackingUnitsSignal.set(le),this.attackerNudgeSignal.set({id:S.id,dx:qe,dy:Ke}),setTimeout(()=>{this.attackerNudgeSignal.set({id:S.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let wt=new Set(this.attackingUnitsSignal());wt.delete(S.id),this.attackingUnitsSignal.set(wt)},200)}this.shakenUnitIdSignal.set(T.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let I=this.combat.calculateHitChance(S,T);if(Math.floor(Math.random()*100)+1>I)return this.queueCombatText("DEFLECTED!",t),this.log.addCombat(S.owner,`[Combat] DEFLECTED! T${S.tier} failed to penetrate T${T.tier}. Attacker destroyed.`,!1),g.splice(x,1),g;this.log.addCombat(S.owner,`[Combat] HIT! T${S.tier} breached T${T.tier} armor.`,!1);let N=this.calculateTotalPoints(S)+(S.hasWeapon?20:0),M=this.getAttackLuckModifier(S),ae=this.calculateTotalPoints(T),be=this.combat.getDefenseBonus(T,g),de=Math.max(0,N+M.delta),Tt=ae+be.bonus,Xt=S.hasWeapon?"Weapon +20":"",Pe=[...be.tags,M.tag??"",Xt].filter(Boolean).join(", ")||"None",Wt=de-Tt,lt=`[Turn ${this.turnSignal()}] ${S.owner==="player"?"Player":"AI"} T${S.tier}(L${S.level}) attacked ${T.owner==="player"?"Player":"AI"} T${T.tier}(L${T.level}). Power: ${N} vs ${ae}. Modifiers: ${Pe}. Final: (${N}${M.delta!==0?M.delta>0?`+${M.delta}`:`${M.delta}`:""}${be.bonus>0?` - ${be.bonus}`:""}) - ${ae} = ${Wt}.`;if(this.log.addCombat(S.owner,lt,!!M.isCrit),de<Tt&&this.queueCombatText("WEAK!",t),de>Tt){let oe=this.combat.calculateHitChance(T,S),Se=Math.floor(Math.random()*100)+1<=oe,Ee=Se?ae:0;if(Ee>0){let ve=this.combat.applyDamage(S,Ee);S.points=ve.points,S.tier=ve.tier,S.level=ve.level,S.armorHp=ve.armorHp}Se||this.log.addCombat(S.owner,`[Combat] T${S.tier} armor deflected the counter-attack from T${T.tier}. Final HP: ${S.points}`,!1),g.splice(O,1),M.tag&&this.queueCombatText(M.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(de<Tt){let oe=de,se=this.combat.applyDamage(T,oe),Se=F({},se);return g[O]=Se,g.splice(x,1),g}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),g.filter(se=>se.id!==S.id&&se.id!==T.id);{let se=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),se){let Se=this.getPointsForTierLevel(S.tier,1);S.points=Se;let Ee=this.calculateTierAndLevel(Se);S.tier=Ee.tier,S.level=Ee.level,g.splice(O,1),this.pulseUnitIdSignal.set(S.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let Se=this.getPointsForTierLevel(T.tier,1),Ee=ce(F({},T),{points:Se}),ve=this.calculateTierAndLevel(Se);return Ee.tier=ve.tier,Ee.level=ve.level,g[O]=Ee,g.splice(x,1),this.pulseUnitIdSignal.set(Ee.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),g}}}}}if(g.find(T=>T.id===S.id)&&o!==S.id){S.position=t,S.turnsStationary=0,S.hasActed=!0;let T=g.findIndex(be=>be.id===S.id);T!==-1&&(g[T]=S),S.owner==="ai"&&S.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(S.id,{x:t.x,y:t.y}),S.tier<=2&&this.anchorGatherer(S.id));let k=new Set(this.movedThisTurnSignal());k.add(S.id),this.movedThisTurnSignal.set(k),this.lastArrivedUnitIdSignal.set(S.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let I=new Map(this.unitMoveHistorySignal()),w=I.get(S.id)??[],N={x:R.x,y:R.y},M={x:t.x,y:t.y},ae=[...w,N,M].slice(-4);I.set(S.id,ae),this.unitMoveHistorySignal.set(I)}return g});let s=t.x-e.position.x,a=t.y-e.position.y,l=this.wallThicknessPx+2,c=this.tileSizePx+l,d={dx:-s*c,dy:-a*c};if(s!==0||a!==0){let f=new Map(this.unitMoveOffsetSignal());f.set(e.id,d),this.unitMoveOffsetSignal.set(f);let g=new Set(this.movingUnitsSignal());g.add(e.id),this.movingUnitsSignal.set(g),setTimeout(()=>{let x=new Map(this.unitMoveOffsetSignal());x.set(e.id,{dx:0,dy:0}),this.unitMoveOffsetSignal.set(x),setTimeout(()=>{let S=new Map(this.unitMoveOffsetSignal());S.delete(e.id),this.unitMoveOffsetSignal.set(S);let R=new Set(this.movingUnitsSignal());R.delete(e.id),this.movingUnitsSignal.set(R)},180)},0)}if(r){let f=this.getUnitAt(t.x,t.y);f&&(this.lastMergedUnitIdSignal.set(f.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(R=>R+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let x=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(x.length>=4&&x[0].x===x[2].x&&x[0].y===x[2].y&&x[1].x===x[3].x&&x[1].y===x[3].y&&(x[0].x!==x[1].x||x[0].y!==x[1].y)){let R=new Map(this.unitStutterBanSignal()),L=new Set([`${x[0].x},${x[0].y}`,`${x[1].x},${x[1].y}`]);R.set(e.id,{tiles:L,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(R);let q={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},_e=(this.getQuadrant(e.position,q)+2)%4,xe=new Map(this.unitQuadrantBiasSignal());xe.set(e.id,{quadrant:_e,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(xe)}}let h=this.selectedUnitIdSignal();h&&!this.unitsSignal().some(f=>f.id===h)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility(),e.owner==="player"&&this.selectNextAvailableUnit()}selectNextAvailableUnit(){let t=this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((i,r)=>{let o=this.isForest(i.position.x,i.position.y)||this.isMine(i.position.x,i.position.y)?1:0,s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0;return o!==s?o-s:0}),this.selectUnit(t[0].id)}selectNextAvailableUnitTab(){let t=this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((r,o)=>{let s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0,a=this.isForest(o.position.x,o.position.y)||this.isMine(o.position.x,o.position.y)?1:0;return s!==a?s-a:r.id.localeCompare(o.id)});let i=this.selectedUnitId();if(!i)this.selectUnit(t[0].id);else{let r=t.findIndex(o=>o.id===i);if(r===-1)this.selectUnit(t[0].id);else{let o=(r+1)%t.length;this.selectUnit(t[o].id)}}}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}effectiveAttack(e){return this.calculateTotalPoints(e)+(e.hasWeapon?20:0)}effectiveDefense(e){return(e.points??0)+(e.armorHp??0)}computeSideEffectivePower(e){let t=this.unitsSignal().filter(r=>r.owner===e),i=0;for(let r of t)i+=this.effectiveAttack(r);return i}getWood(e){return e==="ai"?this.aiWoodSignal():this.resourcesSignal().wood}getIron(e){return e==="ai"?this.aiIronSignal():this.resourcesSignal().iron}getForges(e){return e==="ai"?this.aiForgesSignal():this.forgesSignal()}buyArmorGeneric(e,t){e==="ai"?this.aiBuyArmor(t):this.buyArmor(t)}buyWeaponGeneric(e,t){e==="ai"?this.aiBuyWeapon(t):this.buyWeapon(t)}isUnitInDanger(e){let t=this.getNeighbors(e.position);for(let i of t){let r=this.getUnitAt(i.x,i.y);if(r&&r.owner!==e.owner){let o=this.effectiveAttack(r),s=this.effectiveDefense(e),a=e.hasWeapon?e.tier>=3?20:10:0;if(o>s+a)return!0}}return!1}findSafeMove(e,t){let i=this.getBasePosition("ai");return t.length===0?null:t.reduce((r,o)=>{let s=Math.abs(o.x-i.x)+Math.abs(o.y-i.y),a=Math.abs(r.x-i.x)+Math.abs(r.y-i.y);return s<a?o:r},t[0])}findResourceTarget(e,t){let i=this.forestsSignal(),r=this.minesSignal(),o=this.turnSignal()<=20,s=i.filter(x=>{let S=`${x.x},${x.y}`;if(t.claimedTargets.has(S))return!1;let R=this.getUnitAt(x.x,x.y);return!(R&&R.owner==="ai")}),a=r.filter(x=>{let S=`${x.x},${x.y}`;if(t.claimedTargets.has(S))return!1;let R=this.getUnitAt(x.x,x.y);return!(R&&R.owner==="ai")}),l=s.filter(x=>!this.getUnitAt(x.x,x.y)),c=a.filter(x=>!this.getUnitAt(x.x,x.y));if(o){if(l.length>0)return l.sort((x,S)=>{let R=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return R-L}),l[0];if(c.length>0)return c.sort((x,S)=>{let R=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return R-L}),c[0]}else{let x=[...l,...c];if(x.length>0)return x.sort((S,R)=>{let L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),q=Math.abs(R.x-e.position.x)+Math.abs(R.y-e.position.y);return L-q}),x[0]}let d=s.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&S.owner==="player"}),f=a.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&S.owner==="player"}).filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&e.tier>=S.tier}),g=d.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&e.tier>=S.tier});if(o){if(g.length>0)return g.sort((x,S)=>{let R=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return R-L}),g[0];if(f.length>0)return f.sort((x,S)=>{let R=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return R-L}),f[0]}else{let x=[...g,...f];if(x.length>0)return x.sort((S,R)=>{let L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),q=Math.abs(R.x-e.position.x)+Math.abs(R.y-e.position.y);return L-q}),x[0]}return d.length>0?(d.sort((x,S)=>{let R=this.getUnitAt(x.x,x.y),L=this.getUnitAt(S.x,S.y),q=R?R.tier:99,ye=L?L.tier:99;if(q!==ye)return q-ye;let _e=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),xe=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return _e-xe}),d[0]):null}findDefensiveWallTarget(e){let t=this.getNeighbors(e.position),r=this.unitsSignal().filter(c=>c.owner==="player").filter(c=>Math.abs(c.position.x-e.position.x)+Math.abs(c.position.y-e.position.y)<=5);if(r.length===0)return null;let o=0,s=0;r.forEach(c=>{o+=c.position.x,s+=c.position.y}),o/=r.length,s/=r.length;let a=null,l=-1/0;for(let c of t){if(this.getWallBetween(e.position.x,e.position.y,c.x,c.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(c)||this.isEdgeOnCooldown(e.position,c))continue;let d=c.x-e.position.x,h=c.y-e.position.y,f=o-e.position.x,g=s-e.position.y,x=d*f+h*g;x>l&&(l=x,a=c)}return l>0?a:null}findBlockingWall(e,t){let i=this.bfsPath(e,t,{respectWalls:!1});if(!i||i.length<2)return null;for(let r=0;r<i.length-1;r++){let o=i[r],s=i[r+1],a=this.getWallBetween(o.x,o.y,s.x,s.y);if(a)return{pos:s,wall:a}}return null}findDefensiveWallTargetForOwner(e,t){let i=this.getNeighbors(e.position),r=t==="player"?"ai":"player",s=this.unitsSignal().filter(h=>h.owner===r).filter(h=>Math.abs(h.position.x-e.position.x)+Math.abs(h.position.y-e.position.y)<=5);if(s.length===0)return null;let a=0,l=0;s.forEach(h=>{a+=h.position.x,l+=h.position.y}),a/=s.length,l/=s.length;let c=null,d=-1/0;for(let h of i){if(this.getWallBetween(e.position.x,e.position.y,h.x,h.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(h)||this.isEdgeOnCooldown(e.position,h))continue;let f=h.x-e.position.x,g=h.y-e.position.y,x=a-e.position.x,S=l-e.position.y,R=f*x+g*S;R>d&&(d=R,c=h)}return d>0?c:null}getNextStepTowards(e,t,i,r){if(i.length===0)return null;let o=l=>{let c=Math.abs(l.x-t.x)+Math.abs(l.y-t.y);if(r?.noCohesion&&!r?.antiClump&&!r?.fogBonus)return c*10;let h=this.getNeighbors(l).filter(g=>{let x=this.getUnitAt(g.x,g.y);return x&&x.owner===e.owner}).length,f=c*10;return r?.antiClump?f+=h*3:r?.noCohesion||(f-=h*2),r?.fogBonus&&!this.isVisibleToPlayer(l.x,l.y)&&e.owner==="player"&&(f-=3),f},s=null,a=1/0;for(let l of i){let c=o(l);c<a&&(a=c,s=l)}return s}findPlayerResourceTarget(e){let t=this.turnSignal(),i=this.forestsSignal(),r=this.minesSignal(),o=this.playerClaimedTargetsSignal(),s=g=>`${g.x},${g.y}`,a=g=>!this.getUnitAt(g.x,g.y),l=g=>{let x=this.getUnitAt(g.x,g.y);return!!(x&&x.owner==="player")},c=i.filter(g=>!o.has(s(g))),d=r.filter(g=>!o.has(s(g))),h=(g,x)=>{let S=Math.abs(g.x-e.position.x)+Math.abs(g.y-e.position.y),R=l(g)?100:0,L=t<=15&&x==="forest"?-5:0;return S*10+R+(a(g)?0:20)+L},f=[...c.map(g=>({p:g,t:"forest",s:h(g,"forest")})),...d.map(g=>({p:g,t:"mine",s:h(g,"mine")}))];return f.length===0?null:(f.sort((g,x)=>g.s-x.s),f[0].p)}findCombatTarget(e,t,i){let r=t.priorityTargets.find(c=>Math.max(Math.abs(c.position.x-e.position.x),Math.abs(c.position.y-e.position.y))<=5);if(r&&!this.bfsPath(e.position,r.position,{respectWalls:!0})){let d=this.findBlockingWall(e.position,r.position);if(d)return this.appendLog(`[Obstacle Smash] T${e.tier} targeting wall at (${d.pos.x},${d.pos.y}) blocking path to high-value target`),d.pos}let o=t.priorityTargets.filter(c=>i.some(d=>d.x===c.position.x&&d.y===c.position.y));if(o.length>0){let c=o.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),c[0].position):(o.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),o[0].position)}let s=this.getNeighbors(e.position),a=[];for(let c of s){let d=this.getWallBetween(e.position.x,e.position.y,c.x,c.y);if(!d||d.owner===e.owner)continue;let h=d.maxHealth??100,f=100-(h-100);h>200&&!e.hasWeapon&&(f-=150),e.hasWeapon&&(f+=40),(d.formationSize??1)<=2&&(f+=30),a.push({pos:c,score:f})}if(a.length>0)return a.sort((c,d)=>d.score-c.score),a[0].pos;let l=i.map(c=>{let d=this.getUnitAt(c.x,c.y);return!d||d.owner===e.owner?null:{pos:c,enemy:d}}).filter(Boolean);if(l.length>0){let c=l.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d.enemy));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),c[0].pos):(l.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),l[0].pos)}return null}findFallbackMove(e,t,i){if(t.length===0)return null;let r=Math.abs(e.position.x-i.x)+Math.abs(e.position.y-i.y),o=null,s=1/0;for(let a of t){let l=Math.abs(a.x-i.x)+Math.abs(a.y-i.y);l<s&&(s=l,o=a)}if(!o)return null;if(s>r){let a=this.isUnitInDanger(e),l=!1;if(a&&(l=this.getNeighbors(e.position).some(d=>{let h=this.getUnitAt(d.x,d.y);return!h||h.owner===e.owner?!1:this.effectiveAttack(h)>this.effectiveDefense(e)})),!l)return null}return o}isTileThreatenedByEnemy(e,t){let i=this.getNeighbors(t);for(let r of i){let o=this.getUnitAt(r.x,r.y);if(o&&o.owner!==e.owner&&this.effectiveAttack(o)>=this.effectiveDefense(e))return!0}return!1}getMergePartnerForUnit(e,t){let r=this.reclamationGoalsSignal().get(e.id);if(r&&r.type==="merge"){let c=this.getUnitAt(r.target.x,r.target.y);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let s=this.mergeIntentSignal().get(e.id);if(s){let c=this.unitsSignal().find(d=>d.id===s);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let a=this.unitsSignal().find(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y)&&t.some(d=>d.x===c.position.x&&d.y===c.position.y));if(a)return a;let l=this.unitsSignal().filter(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y));for(let c of l){let d=this.getNextStepTowards(e,c.position,t);if(!d)continue;let h=this.calculateValidMoves(c),f=this.getNextStepTowards(c,e.position,h);if(!f)continue;let g=Math.abs(e.position.x-c.position.x)+Math.abs(e.position.y-c.position.y);if(Math.abs(d.x-f.x)+Math.abs(d.y-f.y)<g)return c}return null}computeHighestTierNeedingUpgrade(){let e=this.unitsSignal().filter(t=>t.owner==="ai"&&t.tier>=2&&(!t.hasArmor||!t.hasWeapon));return e.length===0?0:e.reduce((t,i)=>Math.max(t,i.tier),0)}getNeighbors(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}].filter(t=>this.inBounds(t.x,t.y))}bfsPath(e,t,i){let r=[{pos:e,path:[e]}],o=new Set;o.add(`${e.x},${e.y}`);let s=0;for(;r.length>0&&s<500;){s++;let a=r.shift();if(a.pos.x===t.x&&a.pos.y===t.y)return a.path;let l=this.getNeighbors(a.pos);for(let c of l){let d=`${c.x},${c.y}`;if(!o.has(d)){if(i?.avoidFriendlyUnits){let h=this.getUnitAt(c.x,c.y);if(h&&h.owner==="ai")continue}if(i?.respectWalls&&this.getWallBetween(a.pos.x,a.pos.y,c.x,c.y))continue;o.add(d),r.push({pos:c,path:[...a.path,c]})}}}return null}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=$([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){if(this.settings.customMode()&&this.endReasonSignal()!=="Debug Victory"&&e==="Jaerbi")return;this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let i=this.firebase.user$(),r=ce(F({},t),{playerName:this.playerName.name(),userId:i?.uid,userPhoto:i?.photoURL??void 0});this.firebase.saveHighScore(r),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}aiIron(){return this.aiIronSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;return r?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let i=this.calculateTotalPoints(t),r=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,i-r),atkMax:i+r+(t.hasWeapon?20:0),hp:t.points,support:o}}isUnitHovered(e){return this.hoveredUnitIdSignal()===e}getHitChanceInfo(e){let t=this.selectedUnit();if(!t)return null;let i=this.unitsSignal().find(l=>l.id===e);if(!i||t.owner!=="player"||i.owner===t.owner||!this.isVisibleToPlayer(i.position.x,i.position.y)||!this.validMoves().some(l=>l.x===i.position.x&&l.y===i.position.y))return null;let o=this.combat.calculateHitChance(t,i),s="bg-green-600";o<50?s="bg-red-600":o<100&&(s="bg-amber-600");let a=o<10;return{chance:o,bg:s,icon:a?"\u2620\uFE0F":"\u2694\uFE0F",skull:a}}shouldRenderWall(e,t,i){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return r?(i??r.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}hoverFormationById(e){this.hoveredFormationIdSignal.set(e??null)}isFormationHovered(e){return e?this.hoveredFormationIdSignal()===e:!1}getFormationInfo(e){let t=e??null;if(!t)return null;let i=this.wallsSignal().find(r=>r.formationId===t);return i?{size:i.formationSize??1,bonus:i.bonusHp??0}:null}updateWallFormations(){let e=this.wallsSignal();if(e.length===0)return;let t=new Map,i=new Map;for(let l of e){t.set(l.id,l);let c=`${l.tile1.x},${l.tile1.y}`,d=`${l.tile2.x},${l.tile2.y}`,h=i.get(c)??[];h.push(l.id),i.set(c,h);let f=i.get(d)??[];f.push(l.id),i.set(d,f)}let r=new Set,o=[];for(let l of e){if(r.has(l.id))continue;if(l.owner==="neutral"){o.push([l.id]),r.add(l.id);continue}let c=[l.id];r.add(l.id);let d=[],h=l.owner;for(;c.length>0;){let f=c.shift();d.push(f);let g=t.get(f),x=[`${g.tile1.x},${g.tile1.y}`,`${g.tile2.x},${g.tile2.y}`];for(let S of x){let R=i.get(S)??[];for(let L of R)r.has(L)||t.get(L).owner===h&&(r.add(L),c.push(L))}}o.push(d)}let s=e.map(l=>F({},l)),a=new Map;for(let l=0;l<s.length;l++)a.set(s[l].id,l);for(let l of o){let d=t.get(l[0]).owner==="neutral",h=d?1:l.length,f=d?0:Math.max(0,h*20),g=100+f,x=d?null:l[0];for(let S of l){let R=a.get(S),L=s[R],q=L.maxHealth??100,ye=g-q,_e=L.health;ye>0?_e=L.health+ye:ye<0&&(_e=Math.min(L.health,g)),_e=Math.max(0,Math.min(g,_e)),s[R]=ce(F({},L),{formationId:x??void 0,formationSize:h,maxHealth:g,bonusHp:f,health:_e})}}this.wallsSignal.set(s)}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(i=>i.position.x===e&&i.position.y===t).map(i=>({id:i.id,text:i.text,opacity:i.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let i=this.unitsSignal().find(d=>d.id===e);if(!i)return"";let r=this.combat.getPointsForTierLevel(i.tier,4),o=t.support>0?`+${t.support}`:"+0",s=i.hasWeapon?" | Weapon:+20":"",a=i.armorHp??0,l=i.hasArmor?` | Armor:${a}`:"",c=a>0?`${t.hp} + ${a}`:`${t.hp}`;return`Unit T${i.tier} | HP: ${c}/${r} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}${s}${l}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.endReasonSignal.set("Debug Victory"),this.endOverlaySignal.set(!0);let t=this.getForestControl().player,r={playerName:this.playerName.name(),turnsPlayed:this.turnSignal(),forestsCaptured:t,victoryType:"Annihilation",timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:!0};this.pendingScoreSignal.set(r),this.namePromptOpenSignal.set(!0)}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],i=e.indexOf(this.settings.difficulty()),r=t.indexOf(this.settings.mapSize());i++,i>=e.length&&(i=0,r++,r>=t.length&&(r=0)),this.settings.setDifficulty(e[i]),this.settings.setMapSize(t[r]),this.resetGame()}recordHighScore(e,t){if(this.settings.customMode()){this.endReasonSignal.set("Match Finished (Custom Mode)");return}let i=`${this.settings.difficulty()}|${this.settings.mapSize()}`,r=F({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=r[i]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((h,f)=>h.turns-f.turns).slice(0,3):s.losses=[...s.losses,o].sort((h,f)=>h.turns-f.turns).slice(0,3),r[i]=s,this.highScoresSignal.set(r),this.persistHighScores();let a=this.getForestControl(),l=e==="player wins"?a.player:a.ai,c=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:l,victoryType:c,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"&&(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0))}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let i=crypto.randomUUID(),r={id:i,text:e,position:F({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),r]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===i?ce(F({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==i))},2e3)}calculateValidMoves(e){let t=[],i=e.position,r=c=>c.x>=0&&c.x<this.gridSize&&c.y>=0&&c.y<this.gridSize,o=(c,d)=>{if(!r(d))return"blocked";if(c.x===d.x||c.y===d.y){if(this.getWallBetween(c.x,c.y,d.x,d.y))return"blocked"}else if(this.isDiagonalBlocked(c,d))return"blocked";let h=this.getUnitAt(d.x,d.y);return h?h.owner===e.owner?"ally":"enemy":"empty"},s=(c,d)=>{(d==="empty"||d==="enemy"||this.getUnitAt(c.x,c.y)?.tier===e.tier)&&t.push(c)},a=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],l=[{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}];if(e.tier===1){for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);h!=="blocked"&&s(d,h)}return t}for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===3&&h==="empty"){let f={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,f);g!=="blocked"&&s(f,g)}}for(let c of l){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===4&&h==="empty"){let f={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,f);if(g!=="blocked"&&(s(f,g),g==="empty")){let x={x:i.x+c.x*3,y:i.y+c.y*3},S=o(f,x);S!=="blocked"&&s(x,S)}}}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),l=this.isForest(s.position.x,s.position.y),c=this.isMine(s.position.x,s.position.y),d=l?a?1:(s.forestOccupationTurns??0)+1:0,h=c?a?1:(s.mineOccupationTurns??0)+1:0,f=l?d>=3:!1;return ce(F({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:d,mineOccupationTurns:h,productionActive:f})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let i=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(a=>a.owner===e&&this.isForest(a.position.x,a.position.y)&&(a.productionActive??!1)).length,s=this.unitsSignal().filter(a=>a.owner===e&&this.isMine(a.position.x,a.position.y)&&(a.mineOccupationTurns??0)>=5).length;if(o>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood+o*i(this.settings.difficulty()),iron:a.iron})):this.aiWoodSignal.update(a=>a+o*i(this.settings.difficulty()))),s>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood,iron:a.iron+s*2})):this.aiIronSignal.update(a=>a+s*2)),e==="player"){let a=this.forgeSitesSignal().map(h=>F({},h));for(let h of a)h.turnsLeft=Math.max(0,h.turnsLeft-1);let l=a.filter(h=>h.turnsLeft===0),c=l.map(h=>h.position),d=a.filter(h=>h.turnsLeft>0);if(c.length>0){this.forgesSignal.update(f=>[...f,...c]);let h=l.filter(f=>f.owner==="ai").map(f=>f.position);if(h.length>0){this.aiForgesSignal.update(f=>[...f,...h]);for(let f of h)this.appendLog(`[AI] Forge completed at (${f.x},${f.y}).`)}}this.forgeSitesSignal.set(d)}}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let r=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(r),this.startSideTurn(r),r==="ai"&&this.gameStatus()==="playing"&&(this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10))}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}pauseGame(){this.stopAiLoops()}aiTurnTimeout=null;stopAiLoops(){this.aiTurnTimeout&&(clearTimeout(this.aiTurnTimeout),this.aiTurnTimeout=null),this.isAiThinking=!1}startSideTurn(e){this.unitsSignal.update(t=>t.map(i=>i.owner===e?ce(F({},i),{hasActed:!1}):i)),e==="player"&&(this.selectNextAvailableUnit(),this.playerClaimedTargetsSignal.set(new Set))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;if(r){let s=F({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=F({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai"),t=this.forestsSignal().length+this.minesSignal().length,i=this.unitsSignal().filter(I=>I.owner==="player"&&(this.isForest(I.position.x,I.position.y)||this.isMine(I.position.x,I.position.y))),r=t>0?i.length/t:0;if(r>.5){let I=new Map,w=this.unitsSignal().filter(ae=>ae.owner==="ai"&&!ae.hasActed),N=new Set,M=i.slice().sort((ae,be)=>be.tier-ae.tier);for(let ae of M){let be=Math.min(4,ae.tier+1),de=w.filter(Pe=>Pe.tier===be&&!N.has(Pe.id)).sort((Pe,Wt)=>{let lt=Math.max(Math.abs(Pe.position.x-ae.position.x),Math.abs(Pe.position.y-ae.position.y)),oe=Math.max(Math.abs(Wt.position.x-ae.position.x),Math.abs(Wt.position.y-ae.position.y));return lt-oe});if(de.length>0){let Pe=de[0];I.set(Pe.id,{target:F({},ae.position),type:"hunt"}),N.add(Pe.id);continue}let Tt=w.filter(Pe=>Pe.tier===ae.tier&&!N.has(Pe.id)),Xt=!1;for(let Pe of Tt){let Wt=this.calculateValidMoves(Pe),lt=this.unitsSignal().find(oe=>oe.owner==="ai"&&oe.tier===Pe.tier&&(oe.position.x!==Pe.position.x||oe.position.y!==Pe.position.y)&&Wt.some(se=>se.x===oe.position.x&&se.y===oe.position.y));if(lt){I.set(Pe.id,{target:F({},lt.position),type:"merge"}),N.add(Pe.id),Xt=!0;break}}Xt||this.aiSpawnTier(be,1,new Set)}this.reclamationGoalsSignal.set(I),this.appendLog(`[AI Mode] Reclamation active. Player controls ${(r*100).toFixed(0)}% of resources.`)}else this.reclamationGoalsSignal.set(new Map);let a=this.unitsSignal().filter(I=>I.owner==="ai"&&this.isForest(I.position.x,I.position.y)).length>3;{let I=0,w=50,M=this.baseHealthSignal().ai<50?20:70;for(;this.aiWoodSignal()>M;){if(I++,I>w){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let I=this.forestsSignal().length,w=this.unitsSignal().filter(lt=>lt.owner==="ai"&&this.isForest(lt.position.x,lt.position.y)).length,N=this.unitsSignal().filter(lt=>lt.owner==="player"&&this.isForest(lt.position.x,lt.position.y)).length,M=this.settings.difficulty(),ae=I>0?N/I:0,be="none";N<=w?be="none":ae>=.9||N>=9?be="rage":N>=w+(M==="baby"?4:M==="normal"?3:M==="hard"?2:1)?be="angry":be="none",this.aiMoodSignal.set(be);let de=this.turnSignal()%2===0,Tt=this.turnSignal()%5===0,Xt=I>0?w/I:0,Pe=this.totalWarModeSignal(),Wt=Xt>=.65;if(!Pe&&Wt)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(Wt),be==="rage"){let lt=M==="baby"?de?1:2:M==="normal"?de?3:2:M==="hard"?de?4:3:4;this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+lt}))}else if(be==="angry"){if(M==="baby")Tt&&this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+1}));else if(de){let lt=M==="normal"?de?1:0:M==="hard"?Tt?2:1:2;this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+lt}))}}}catch{}if(this.manageInfrastructure(),this.turnSignal()<=10){let I=0,w=this.getPointsForTierLevel(1,1);for(;this.reservePointsSignal().ai>=w&&I<2&&this.aiSpawnTier(1,1,new Set)!==0;)I++,await new Promise(M=>setTimeout(M,60))}await new Promise(I=>setTimeout(I,100));let l=this.unitsSignal().filter(I=>I.owner==="ai"),c=new Map(this.aiUnitTimeNearBaseSignal()),d=new Set(l.map(I=>I.id));for(let I of c.keys())d.has(I)||c.delete(I);for(let I of l)Math.max(Math.abs(I.position.x-e.x),Math.abs(I.position.y-e.y))<=3?c.set(I.id,(c.get(I.id)||0)+1):c.set(I.id,0);this.aiUnitTimeNearBaseSignal.set(c);for(let I of l){let w=this.isForest(I.position.x,I.position.y);I.owner==="ai"&&w&&I.tier<=2&&this.anchorGatherer(I.id)}let h=this.unitsSignal().filter(I=>I.owner==="player"&&this.isForest(I.position.x,I.position.y)&&(I.productionActive??!1)).length*2,f=this.unitsSignal().filter(I=>I.owner==="ai"&&this.isForest(I.position.x,I.position.y)&&(I.productionActive??!1)).length*2,g=h>=f;this.aggressionModeSignal.set(g);let R=this.forestsSignal().filter(I=>!this.getUnitAt(I.x,I.y)).filter(I=>this.isVisibleToAi(I.x,I.y)),L=this.unitsSignal().filter(I=>I.owner==="ai");if(this.turnSignal()<=15){let I=this.aiQueuedUnitIdSignal(),w=I?L.find(M=>M.id===I):null;if(!(w&&!this.isForest(w.position.x,w.position.y)&&R.length>0)){let M=L.filter(be=>be.tier<=2&&!this.isForest(be.position.x,be.position.y)),ae=M.length>0&&R.length>0?M.reduce((be,de)=>{let Tt=Math.min(...R.map(Pe=>Math.abs(de.position.x-Pe.x)+Math.abs(de.position.y-Pe.y))),Xt=Math.min(...R.map(Pe=>Math.abs(be.position.x-Pe.x)+Math.abs(be.position.y-Pe.y)));return Tt<Xt?de:be},M[0]):null;this.aiQueuedUnitIdSignal.set(ae?ae.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let I=this.getPointsForTierLevel(3,1),w=this.forestsSignal().length,N=this.unitsSignal().filter(be=>be.owner==="ai"&&this.isForest(be.position.x,be.position.y)).length,M=w>0?N/w:0;this.reservePointsSignal().ai>=I&&M<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let q=this.unitsSignal().filter(I=>I.owner==="player"&&Math.max(Math.abs(I.position.x-e.x),Math.abs(I.position.y-e.y))<=3&&I.tier>=2);if(q.length>0){let I=q.reduce((w,N)=>this.calculateTotalPoints(N)>this.calculateTotalPoints(w)?N:w,q[0]);this.aiDefenseSpawn(I)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let I=this.aiStrategy.getWallBuildActions(this);for(let w of I){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(w.from,w.to)}}else this.tryDefensiveWallsNearForests();let ye=0,_e=10;for(;ye<_e&&this.executeOneFreeAction();)ye++,await new Promise(w=>setTimeout(w,100));this.aiQueuedUnitIdSignal.set(null);let xe=this.getBasePosition("player"),Ie=this.unitsSignal().filter(I=>I.owner==="player"&&(this.isForest(I.position.x,I.position.y)||this.isMine(I.position.x,I.position.y)||this.isForge(I.position.x,I.position.y)||Math.max(Math.abs(I.position.x-e.x),Math.abs(I.position.y-e.y))<=4)),O={claimedTargets:new Set,priorityTargets:Ie},k=this.unitsSignal().filter(I=>I.owner==="ai"&&!I.hasActed).sort((I,w)=>w.tier-I.tier);for(let I of k){let w=this.unitsSignal().find(oe=>oe.id===I.id);if(!w||w.hasActed)continue;let N=null,ae=this.calculateValidMoves(w).filter(oe=>!O.claimedTargets.has(`${oe.x},${oe.y}`)),be=Math.max(Math.abs(w.position.x-e.x),Math.abs(w.position.y-e.y)),de=this.unitsSignal().filter(oe=>oe.owner==="player"&&Math.max(Math.abs(oe.position.x-e.x),Math.abs(oe.position.y-e.y))<=3);if(de.length>0&&!this.isForest(w.position.x,w.position.y)&&be<=6){let oe=de.reduce((Se,Ee)=>{let ve=Math.max(Math.abs(Se.position.x-e.x),Math.abs(Se.position.y-e.y));return Math.max(Math.abs(Ee.position.x-e.x),Math.abs(Ee.position.y-e.y))<ve?Ee:Se});if(ae.some(Se=>Se.x===oe.position.x&&Se.y===oe.position.y))N={type:"attack",target:oe.position,reason:"Base Defense: Eliminate Threat"};else{let Se=this.getNextStepTowards(w,oe.position,ae);Se&&(N={type:"move",target:Se,reason:"Base Defense: Intercept"})}}if(!N){let oe=this.reclamationGoalsSignal().get(w.id);if(oe){let se=oe.target,Se=this.getUnitAt(se.x,se.y);if(Se&&Se.owner!==w.owner)if(ae.some(ve=>ve.x===se.x&&ve.y===se.y))N={type:"attack",target:se,reason:"Reclaim: Attack Occupier"};else{let ve=this.bfsPath(w.position,se,{respectWalls:!0,avoidFriendlyUnits:!0});if(ve||(ve=this.bfsPath(w.position,se,{avoidFriendlyUnits:!0})),ve&&ve.length>1){let b=ve[1],ue=this.getWallBetween(w.position.x,w.position.y,b.x,b.y),qe=this.getUnitAt(b.x,b.y);if(qe&&qe.owner!==w.owner){let Ke=this.effectiveAttack(qe)>this.effectiveDefense(w),le=ae.some(wt=>wt.x===b.x&&wt.y===b.y);if(Ke&&le)N={type:"attack",target:b,reason:"Reclaim: Engage Blocker"};else if(ue)N={type:"wall_attack",target:b,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,b)){let wt=ae.filter(ai=>{let Ns=Math.abs(ai.x-se.x)+Math.abs(ai.y-se.y),yh=Math.abs(b.x-se.x)+Math.abs(b.y-se.y);return Ns<=yh&&!this.isTileThreatenedByEnemy(w,ai)}),Ti=wt.length>0?this.getNextStepTowards(w,se,wt):null;N=Ti?{type:"move",target:Ti,reason:"Reclaim: Bypass Threat"}:{type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else N={type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else if(ue)N={type:"wall_attack",target:b,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,b)){let Ke=ae.filter(wt=>{let Ti=Math.abs(wt.x-se.x)+Math.abs(wt.y-se.y),ai=Math.abs(b.x-se.x)+Math.abs(b.y-se.y);return Ti<=ai&&!this.isTileThreatenedByEnemy(w,wt)}),le=Ke.length>0?this.getNextStepTowards(w,se,Ke):null;N=le?{type:"move",target:le,reason:"Reclaim: Bypass Threat"}:{type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else N={type:"move",target:b,reason:"Reclaim: Pursue Resource"}}}else if(oe.type==="merge")if(ae.some(ve=>ve.x===se.x&&ve.y===se.y))N={type:"move",target:se,reason:"Reclaim: Merge to Counter"};else{let ve=this.getNextStepTowards(w,se,ae);ve&&(N=this.getWallBetween(w.position.x,w.position.y,ve.x,ve.y)?{type:"wall_attack",target:ve,reason:"Reclaim: Breach to Merge"}:{type:"move",target:ve,reason:"Reclaim: Approach Ally"})}else{let Ee=this.getNextStepTowards(w,se,ae);if(Ee){let ve=this.getWallBetween(w.position.x,w.position.y,Ee.x,Ee.y),b=this.getUnitAt(Ee.x,Ee.y);if(b&&b.owner!==w.owner){let ue=this.effectiveAttack(b)>this.effectiveDefense(w),qe=ae.some(Ke=>Ke.x===Ee.x&&Ke.y===Ee.y);if(ue&&qe)N={type:"attack",target:Ee,reason:"Reclaim: Engage Blocker"};else if(ve)N={type:"wall_attack",target:Ee,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,Ee)){let Ke=ae.filter(wt=>{let Ti=Math.abs(wt.x-se.x)+Math.abs(wt.y-se.y),ai=Math.abs(Ee.x-se.x)+Math.abs(Ee.y-se.y);return Ti<=ai&&!this.isTileThreatenedByEnemy(w,wt)}),le=Ke.length>0?this.getNextStepTowards(w,se,Ke):null;N=le?{type:"move",target:le,reason:"Reclaim: Bypass Threat"}:{type:"move",target:Ee,reason:"Reclaim: Close Distance"}}else N={type:"move",target:Ee,reason:"Reclaim: Close Distance"}}else if(ve)N={type:"wall_attack",target:Ee,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,Ee)){let ue=ae.filter(Ke=>{let le=Math.abs(Ke.x-se.x)+Math.abs(Ke.y-se.y),wt=Math.abs(Ee.x-se.x)+Math.abs(Ee.y-se.y);return le<=wt&&!this.isTileThreatenedByEnemy(w,Ke)}),qe=ue.length>0?this.getNextStepTowards(w,se,ue):null;N=qe?{type:"move",target:qe,reason:"Reclaim: Bypass Threat"}:{type:"move",target:Ee,reason:"Reclaim: Close Distance"}}else N={type:"move",target:Ee,reason:"Reclaim: Close Distance"}}}}}if(this.isForest(w.position.x,w.position.y)){let oe=this.calculateValidMoves(w),se=this.findCombatTarget(w,O,oe);if(se)N={type:"attack",target:se,reason:"Defense: Defend Forest"};else{if(this.aiWoodSignal()>=50){let Se=this.findDefensiveWallTarget(w);Se&&(N={type:"build_wall",target:Se,reason:"Defense: Fortify Position"})}if(!N&&!this.isUnitInDanger(w)){this.unitsSignal.update(Ee=>Ee.map(ve=>ve.id===w.id?ce(F({},ve),{hasActed:!0}):ve));continue}}}if(!N&&this.isMine(w.position.x,w.position.y)){let oe=this.calculateValidMoves(w),se=this.findCombatTarget(w,O,oe);if(se)N={type:"attack",target:se,reason:"Defense: Defend Mine"};else if(!this.isUnitInDanger(w)){this.unitsSignal.update(Ee=>Ee.map(ve=>ve.id===w.id?ce(F({},ve),{hasActed:!0}):ve));continue}}let Tt=this.forestsSignal().length,Xt=this.unitsSignal().filter(oe=>oe.owner==="ai"&&this.isForest(oe.position.x,oe.position.y)).length,Pe=Tt>0?Xt/Tt:0,Wt=w.tier>=3||Pe>=.7,lt=Math.max(Math.abs(w.position.x-xe.x),Math.abs(w.position.y-xe.y));if(!N&&lt<4){if(Wt&&lt<=3){let oe=[];ae.some(ue=>ue.x===xe.x&&ue.y===xe.y)&&oe.push({type:"attack",target:xe,weight:1,reason:"Siege: Strike Base"});let Se=this.getNeighbors(w.position),Ee=lt,ve=!1;for(let ue of Se)this.getWallBetween(w.position.x,w.position.y,ue.x,ue.y)&&Math.max(Math.abs(ue.x-xe.x),Math.abs(ue.y-xe.y))<Ee&&(oe.push({type:"wall_attack",target:ue,weight:.9,reason:"Siege: Breach (Path to Base)"}),ve=!0);let b=this.getNextStepTowards(w,xe,ae,{noCohesion:!0});if(b){let ue=Math.max(Math.abs(b.x-xe.x),Math.abs(b.y-xe.y));(!ve||ue<Ee)&&oe.push({type:"move",target:b,weight:.5,reason:"Siege: Advance on Base"})}if(oe.length>0){oe.sort((qe,Ke)=>Ke.weight-qe.weight);let ue=oe[0];N={type:ue.type,target:ue.target,reason:ue.reason},ue.type==="move"&&ve&&this.appendLog(`[AI Debug] Unit at (${w.position.x},${w.position.y}) chose Move over Wall Attack. Weights: wall=0.9, move=${ue.weight}`)}}if(!N)if(ae.some(se=>se.x===xe.x&&se.y===xe.y))N={type:"attack",target:xe,reason:"Siege: Strike Base"};else{let se=this.getNextStepTowards(w,xe,ae,{noCohesion:!0});if(se)this.getWallBetween(w.position.x,w.position.y,se.x,se.y)?N={type:"wall_attack",target:se,reason:"Siege: Breach"}:N={type:"move",target:se,reason:"Siege: Advance on Base"};else{let Se=this.bfsPath(w.position,xe);if(Se&&Se.length>1){let Ee=Se[1];this.getWallBetween(w.position.x,w.position.y,Ee.x,Ee.y)&&(N={type:"wall_attack",target:Ee,reason:"Siege: Breaching"})}}}}if(!N){let oe=this.aiForgesSignal(),se=this.unitsSignal().filter(Ee=>Ee.owner==="player"),Se=[];for(let Ee of oe)for(let ve of se)Math.max(Math.abs(ve.position.x-Ee.x),Math.abs(ve.position.y-Ee.y))<=3&&Se.push(ve);if(Se.length>0){let Ee=Se.reduce((b,ue)=>{let qe=Math.abs(b.position.x-w.position.x)+Math.abs(b.position.y-w.position.y);return Math.abs(ue.position.x-w.position.x)+Math.abs(ue.position.y-w.position.y)<qe?ue:b});if(ae.some(b=>b.x===Ee.position.x&&b.y===Ee.position.y))N={type:"attack",target:Ee.position,reason:"Defense: Guard Forge"};else{let b=this.getNextStepTowards(w,Ee.position,ae);b&&(N=this.getWallBetween(w.position.x,w.position.y,b.x,b.y)?{type:"wall_attack",target:b,reason:"Defense: Breach to Forge"}:{type:"move",target:b,reason:"Defense: Approach Forge Threat"})}}}if(!N&&w.tier>=2&&(!w.hasArmor||!w.hasWeapon)){let oe=this.seekUpgrades(w,ae);oe.type==="move"&&oe.target&&(N={type:"move",target:oe.target,reason:"Upgrade: Move to Forge"})}if(!N){let oe=this.isUnitInDanger(w),se=this.reclamationGoalsSignal().has(w.id);if(!se&&oe){let Se=this.findSafeMove(w,ae);Se&&(N={type:"move",target:Se,reason:"Survival: Evade Threat"})}else if(se&&oe&&this.getNeighbors(w.position).some(ve=>{let b=this.getUnitAt(ve.x,ve.y);return!b||b.owner===w.owner?!1:this.effectiveAttack(b)>this.effectiveDefense(w)+(w.tier>=3?10:0)})){let ve=this.findSafeMove(w,ae);ve&&(N={type:"move",target:ve,reason:"Survival: Lethal Evade"})}}if(!N&&w.tier===4){let oe=this.unitsSignal().filter(se=>se.owner==="player");if(oe.length>0){let se=this.getBasePosition("player"),Se=oe.map(ve=>({u:ve,baseDist:Math.max(Math.abs(ve.position.x-se.x),Math.abs(ve.position.y-se.y))})).sort((ve,b)=>ve.u.tier!==b.u.tier?ve.u.tier-b.u.tier:ve.baseDist-b.baseDist)[0].u,Ee=this.getNextStepTowards(w,Se.position,ae);Ee&&(N={type:"move",target:Ee,reason:"T4 Raid: Flank Backline"})}}if(!N){let oe=this.computeSideEffectivePower("ai"),se=this.computeSideEffectivePower("player");if(se>0&&oe>se*1.2&&!this.isForest(w.position.x,w.position.y)&&parseInt(w.id.slice(-1),16)%2===0){let ve=this.unitsSignal().filter(qe=>qe.owner==="player"),b=xe;if(ve.length>0&&(b=ve.reduce((Ke,le)=>{let wt=Math.max(Math.abs(Ke.position.x-w.position.x),Math.abs(Ke.position.y-w.position.y));return Math.max(Math.abs(le.position.x-w.position.x),Math.abs(le.position.y-w.position.y))<wt?le:Ke}).position),Math.max(Math.abs(b.x-w.position.x),Math.abs(b.y-w.position.y))<=1){let qe=this.findCombatTarget(w,O,ae);qe&&(N={type:"attack",target:qe,reason:"Siege: Engage Enemy"})}else{let qe=this.getNextStepTowards(w,b,ae,{noCohesion:!0});if(qe)N={type:"move",target:qe,reason:"Siege: Advance"};else{let Ke=this.bfsPath(w.position,b);if(Ke&&Ke.length>1){let le=Ke[1];this.getWallBetween(w.position.x,w.position.y,le.x,le.y)&&(N={type:"wall_attack",target:le,reason:"Siege: Breaching"})}}}}if(!N){let ve=this.findResourceTarget(w,O);if(ve){let b=this.bfsPath(w.position,ve,{respectWalls:!0,avoidFriendlyUnits:!0});if(b||(b=this.bfsPath(w.position,ve,{avoidFriendlyUnits:!0})),b&&b.length>1){let ue=b[1],qe=this.getWallBetween(w.position.x,w.position.y,ue.x,ue.y);qe?qe.owner==="ai"&&this.isBaseProtectionEdge(w.position,ue)||(N={type:"wall_attack",target:ue,reason:"Objective: Breaching Wall"}):ae.some(Ke=>Ke.x===ue.x&&Ke.y===ue.y)&&(N={type:"move",target:ue,reason:"Objective: Capture Resource"})}}}}if(!N){let oe=this.findCombatTarget(w,O,ae);oe&&(N={type:"attack",target:oe,reason:"Combat: Engage Enemy"})}if(!N&&this.aiWoodSignal()>=10&&this.getNeighbors(w.position).some(Se=>this.isForest(Se.x,Se.y)&&this.getUnitAt(Se.x,Se.y)?.owner==="ai")){let Se=this.findDefensiveWallTarget(w);Se&&(N={type:"build_wall",target:Se,reason:"Defense: Fortify Perimeter"})}if(!N){let oe=xe,se=this.findFallbackMove(w,ae,oe);se&&(N={type:"move",target:se,reason:"Fallback: Advance on Enemy"})}if(N){if(this.appendLog(`[AI Unit ${w.id.substring(0,4)}] Action: ${N.reason} -> Target: (${N.target.x},${N.target.y})`),N.type==="build_wall")this.aiBuildWallBetween(w.position,N.target);else{if(N.type==="move"){let oe=this.getUnitAt(N.target.x,N.target.y);if(oe&&oe.owner==="ai"&&oe.tier===w.tier){let se=new Map(this.mergeIntentSignal());se.set(w.id,oe.id),se.set(oe.id,w.id),this.mergeIntentSignal.set(se)}}this.executeMove(w,N.target)}O.claimedTargets.add(`${N.target.x},${N.target.y}`)}else this.appendLog(`[AI Unit ${w.id.substring(0,4)}] No valid moves. Passing.`),this.unitsSignal.update(oe=>oe.map(se=>se.id===w.id?ce(F({},se),{hasActed:!0}):se));await new Promise(oe=>setTimeout(oe,60))}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(s=>s.owner==="player"&&Math.max(Math.abs(s.position.x-e.x),Math.abs(s.position.y-e.y))<=3&&s.tier>=2);if(t.length>0){let s=t.reduce((l,c)=>this.calculateTotalPoints(c)>this.calculateTotalPoints(l)?c:l,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(s))return!0}let i=this.unitsSignal().filter(s=>s.owner==="ai").length;if(i<6){let s=this.reservePointsSignal().ai,a=this.getPointsForTierLevel(2,1);if(s>=a&&this.aiSpawnTier(2,1,new Set)>0)return!0}let o=this.baseHealthSignal().ai<50?20:70;if(this.aiWoodSignal()>=o)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;{let s=this.reservePointsSignal().ai,a=this.unitsSignal().filter(l=>l.owner==="ai"&&this.isForest(l.position.x,l.position.y)).length;if(s>25&&a>5&&this.aiSpawnTier(3,1,new Set,!0)>0)return!0}if(t.length===0)try{let s=this.getPointsForTierLevel(3,1),a=this.forestsSignal().length,l=this.unitsSignal().filter(h=>h.owner==="ai"&&this.isForest(h.position.x,h.position.y)).length,c=a>0?l/a:0,d=this.reservePointsSignal().ai;if(i>=6&&d>=s&&c<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),i=[],r=e.position.x,o=e.position.y,s=Math.sign(t.x-r),a=Math.sign(t.y-o);{let f=0,g=Math.max(10,this.gridSize*2);for(;r!==t.x||o!==t.y;){if(f++,f>g){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(r+=s,o+=a,!this.inBounds(r,o)||r===t.x&&o===t.y)break;i.push({x:r,y:o})}}let l=i.reverse().find(f=>!this.getUnitAt(f.x,f.y))||(()=>{for(let f=-1;f<=1;f++)for(let g=-1;g<=1;g++){if(f===0&&g===0)continue;let x=t.x+f,S=t.y+g;if(this.inBounds(x,S)&&!this.getUnitAt(x,S))return{x,y:S}}return null})();if(!l)return!1;{let f=0,g=50;for(;this.aiWoodSignal()>=20;){if(f++,f>g){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let c=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(c);if(d<=0)return!1;let h=this.calculateTierAndLevel(d);return this.unitsSignal().filter(g=>g.owner==="ai"&&g.tier===h.tier&&!this.isForest(g.position.x,g.position.y)).length>=5?!1:(this.unitsSignal.update(f=>[...f,{id:crypto.randomUUID(),position:F({},l),level:h.level,tier:h.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1}]),this.reservePointsSignal.update(f=>({player:f.player,ai:f.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,i,r=!1){let o=this.getBasePosition("ai"),s=[],a=2;for(let R=-a;R<=a;R++)for(let L=-a;L<=a;L++){if(R===0&&L===0)continue;let q=o.x+R,ye=o.y+L;if(!this.inBounds(q,ye)||Math.max(Math.abs(R),Math.abs(L))>a)continue;let _e=`${q},${ye}`;i.has(_e)||this.getUnitAt(q,ye)||s.push({x:q,y:ye})}let l=this.aiForgesSignal(),c=this.aiIronSignal()<40;c&&l.length>0&&s.sort((R,L)=>{let q=l.reduce((_e,xe)=>Math.min(_e,Math.max(Math.abs(R.x-xe.x),Math.abs(R.y-xe.y))),1/0);return l.reduce((_e,xe)=>Math.min(_e,Math.max(Math.abs(L.x-xe.x),Math.abs(L.y-xe.y))),1/0)-q});let d=this.reservePointsSignal().ai,h=this.getPointsForTierLevel(e,1),f=0,g=[],x=R=>this.unitsSignal().filter(L=>L.owner==="ai"&&L.tier===R&&!this.isForest(L.position.x,L.position.y)).length;if(x(e)>=5&&!(r&&e===3))return 0;for(let R of s){if(f>=t||d<h||x(e)>=5)break;let L=this.calculateTierAndLevel(h);g.push({id:crypto.randomUUID(),position:F({},R),level:L.level,tier:L.tier,points:h,owner:"ai",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}),d-=h,f++}if(g.length>0){this.unitsSignal.update(q=>[...q,...g]),this.reservePointsSignal.update(q=>({player:q.player,ai:d})),this.recomputeVisibility();let R=new Map(this.ignoreForgeUntilTurnSignal()),L=this.turnSignal()+(c?2:1);for(let q of g)R.set(q.id,L);this.ignoreForgeUntilTurnSignal.set(R)}return f}aiConvertWoodToReserve(){let e=this.aiWoodSignal(),i=this.baseHealthSignal().ai<50?20:70;e<i||(this.aiWoodSignal.update(r=>r-20),this.reservePointsSignal.update(r=>({player:r.player,ai:r.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(i=>{if(i.some(s=>s.position.x===t.x&&s.position.y===t.y))return i;let o={id:crypto.randomUUID(),position:F({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};return[...i,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),i=2,r=[];for(let c=-i;c<=i;c++)for(let d=-i;d<=i;d++){let h=t.x+c,f=t.y+d;this.inBounds(h,f)&&(c===0&&d===0||Math.max(Math.abs(c),Math.abs(d))>i||r.push({x:h,y:f}))}let o=this.settings.difficulty(),s;o==="baby"?s=[{tier:4,level:1},{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}]:s=[{tier:1,level:1},{tier:1,level:1}];let a=[],l=(c,d)=>this.unitsSignal().some(h=>h.position.x===c&&h.position.y===d)||a.some(h=>h.position.x===c&&h.position.y===d);for(let c of s){let d=r.filter(x=>!l(x.x,x.y));if(d.length===0)break;let h=Math.floor(Math.random()*d.length),f=d[h],g=this.getPointsForTierLevel(c.tier,c.level);a.push({id:crypto.randomUUID(),position:F({},f),level:c.level,tier:c.tier,points:g,owner:e,turnsStationary:0,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0})}a.length>0&&this.unitsSignal.update(c=>[...c,...a])}getUnitAt(e,t){return this.unitsSignal().find(i=>i.position.x===e&&i.position.y===t)}getWallBetween(e,t,i,r){let o={x:e,y:t},s={x:i,y:r};if(!this.areAdjacent(o,s))return;let[a,l]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(c=>c.tile1.x===a.x&&c.tile1.y===a.y&&c.tile2.x===l.x&&c.tile2.y===l.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(i,r,o,s)=>this.getWallBetween(i,r,o,s))}isValidMove(e,t){return this.validMoves().some(i=>i.x===e&&i.y===t)}isForest(e,t){return this.forestsSignal().some(i=>i.x===e&&i.y===t)}isMine(e,t){return this.minesSignal().some(i=>i.x===e&&i.y===t)}isForgeSite(e,t){return this.forgeSitesSignal().some(i=>i.position.x===e&&i.position.y===t)}isForge(e,t){return this.forgesSignal().some(i=>i.x===e&&i.y===t)}getForgeProgress(e,t){let i=this.forgeSitesSignal().find(o=>o.position.x===e&&o.position.y===t);if(!i)return 0;let r=5;return Math.round((r-i.turnsLeft)/r*100)}canBuildForgeAt(e,t){let i=this.getBasePosition("player");if(Math.max(Math.abs(e-i.x),Math.abs(t-i.y))>2||!this.inBounds(e,t)||e===i.x&&t===i.y||this.getUnitAt(e,t)||this.isForest(e,t)||this.isMine(e,t)||this.isForgeSite(e,t)||this.isForge(e,t))return!1;let o=this.resourcesSignal();return o.wood>=40&&o.iron>=20&&this.isPlayerTurn()}buildForgeAt(e){this.canBuildForgeAt(e.x,e.y)&&(this.resourcesSignal.update(t=>({wood:t.wood-40,iron:t.iron-20})),this.forgeSitesSignal.update(t=>[...t,{position:F({},e),owner:"player",turnsLeft:5}]))}buyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy weapon without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasWeapon:!0}):s)))}buyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy armor without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[Forge] Player unit equipped Armor (+20 Shield HP)."))}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}aiBuyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy armor without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[AI] AI unit equipped Heavy Armor (+20 Shield HP)."))}aiBuyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy weapon without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasWeapon:!0}):s)),this.appendLog("[AI] AI unit forged a Weapon (+20 ATK, +10 hit vs higher tier)."))}manageInfrastructure(){let e=this.aiForgesSignal().length+this.forgeSitesSignal().filter(c=>c.owner==="ai").length;if(e>=2)return;let t=this.aiWoodSignal(),i=this.aiIronSignal(),r=this.aiIronSignal();if(e===0){if(t<40||i<20)return}else if(e<2&&(r<=50||t<40||i<20))return;let o=this.getBasePosition("ai"),s=[];for(let c=-2;c<=2;c++)for(let d=-2;d<=2;d++){let h=o.x+c,f=o.y+d;this.inBounds(h,f)&&(h===o.x&&f===o.y||Math.max(Math.abs(c),Math.abs(d))>2||this.getUnitAt(h,f)||this.isForest(h,f)||this.isMine(h,f)||this.isForgeSite(h,f)||this.isForge(h,f)||s.push({x:h,y:f}))}if(s.length===0)return;let a=Math.floor(Math.random()*s.length),l=s[a];this.aiWoodSignal.update(c=>c-40),this.aiIronSignal.update(c=>c-20),this.forgeSitesSignal.update(c=>[...c,{position:F({},l),owner:"ai",turnsLeft:5}]),this.appendLog(`[AI] Constructing a Forge at (${l.x},${l.y}).`)}seekUpgrades(e,t){if(e.owner!=="ai")return{type:"none"};if(e.tier<2)return{type:"none"};if(e.hasArmor&&e.hasWeapon||this.aiIronSignal()<20)return{type:"none"};let i=this.aiForgesSignal();if(i.length===0)return{type:"none"};let r=this.getMergePartnerForUnit(e,t),o=this.aiIronSignal(),s=o>=100;if(s)this.appendLog(`[AI Wealth Override] T${e.tier} at (${e.position.x},${e.position.y}) bypassing normal checks (iron: ${o})`);else if(o<40){let h=this.computeHighestTierNeedingUpgrade();if(h>0&&e.tier<h)return{type:"none"}}if(!s&&r){let h=!e.hasWeapon&&r.hasWeapon,f=!e.hasArmor&&r.hasArmor;if(h||f){let g=h&&f?"Weapon & Armor":h?"Weapon":"Armor";return this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored ${g} purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) already has it).`),{type:"none"}}}let a=i.reduce((h,f)=>{let g=Math.max(Math.abs(f.x-e.position.x),Math.abs(f.y-e.position.y)),x=Math.max(Math.abs(h.x-e.position.x),Math.abs(h.y-e.position.y));return g<x?f:h},i[0]),c=this.ignoreForgeUntilTurnSignal().get(e.id)??0;if(this.turnSignal()<=c)return{type:"none"};if(e.position.x===a.x&&e.position.y===a.y){let h=this.aiIronSignal();if(r){let f=!1;return!r.hasArmor&&!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal(),f=!0),!r.hasWeapon&&!e.hasWeapon&&h>=20&&(this.aiBuyWeapon(e.id),f=!0),!f&&r.hasArmor&&r.hasWeapon&&this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) fully equipped).`),{type:"none"}}else return!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal()),!e.hasWeapon&&h>=20&&this.aiBuyWeapon(e.id),{type:"none"}}let d=this.getNextStepTowards(e,a,t);return d?{type:"move",target:d}:{type:"none"}}seekUpgradesFor(e,t,i){if(t.owner!==e)return{type:"none"};if(t.tier<2)return{type:"none"};let r=this.getIron(e);if(t.hasArmor&&t.hasWeapon||r<20)return{type:"none"};let o=this.getForges(e);if(o.length===0)return{type:"none"};let s=e==="ai"?this.getMergePartnerForUnit(t,i):this.getMergePartnerForUnit(t,i),a=this.getIron(e),l=e==="ai"&&a>=100;if(l)this.appendLog(`[AI Wealth Override] T${t.tier} at (${t.position.x},${t.position.y}) bypassing normal checks (iron: ${a})`);else if(a<40){let g=this.computeHighestTierNeedingUpgrade();if(g>0&&t.tier<g)return{type:"none"}}if(!l&&s){let g=!t.hasWeapon&&s.hasWeapon,x=!t.hasArmor&&s.hasArmor;if(g||x)return this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored ${g&&x?"Weapon & Armor":g?"Weapon":"Armor"} purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) already has it).`),{type:"none"}}let c=o.reduce((g,x)=>{let S=Math.max(Math.abs(x.x-t.position.x),Math.abs(x.y-t.position.y)),R=Math.max(Math.abs(g.x-t.position.x),Math.abs(g.y-t.position.y));return S<R?x:g},o[0]),h=this.ignoreForgeUntilTurnSignal().get(t.id)??0;if(this.turnSignal()<=h)return{type:"none"};if(t.position.x===c.x&&t.position.y===c.y){let g=this.getIron(e);if(s){let x=!1;return!s.hasArmor&&!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e),x=!0),!s.hasWeapon&&!t.hasWeapon&&g>=20&&(this.buyWeaponGeneric(e,t.id),x=!0),!x&&s.hasArmor&&s.hasWeapon&&this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) fully equipped).`),{type:"none"}}else return!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e)),!t.hasWeapon&&g>=20&&this.buyWeaponGeneric(e,t.id),{type:"none"}}let f=this.getNextStepTowards(t,c,i,void 0);return f?{type:"move",target:f}:{type:"none"}}async executeBotTurn(e){if(this.activeSideSignal()!==e||this.gameStatus()!=="playing")return;let t=e==="ai"?"player":"ai",i=this.getBasePosition(t),r=this.getBasePosition("player"),o=this.getBasePosition("ai"),s=this.forestsSignal().length+this.minesSignal().length,a=this.unitsSignal().filter(f=>f.owner===t&&(this.isForest(f.position.x,f.position.y)||this.isMine(f.position.x,f.position.y)));if((s>0?a.length/s:0)>.5){let f=new Map,g=this.unitsSignal().filter(R=>R.owner===e&&!R.hasActed),x=new Set,S=a.slice().sort((R,L)=>L.tier-R.tier);for(let R of S){let L=Math.min(4,R.tier+1),q=g.filter(_e=>_e.tier===L&&!x.has(_e.id)).sort((_e,xe)=>{let Ie=Math.max(Math.abs(_e.position.x-R.position.x),Math.abs(_e.position.y-R.position.y)),O=Math.max(Math.abs(xe.position.x-R.position.x),Math.abs(xe.position.y-R.position.y));return Ie-O});if(q.length>0){let _e=q[0];f.set(_e.id,{target:F({},R.position),type:"hunt"}),x.add(_e.id);continue}let ye=g.filter(_e=>_e.tier===R.tier&&!x.has(_e.id));for(let _e of ye){let xe=this.calculateValidMoves(_e),Ie=this.unitsSignal().find(O=>O.owner===e&&O.tier===_e.tier&&(O.position.x!==_e.position.x||O.position.y!==_e.position.y)&&xe.some(T=>T.x===O.position.x&&T.y===O.position.y));if(Ie){f.set(_e.id,{target:F({},Ie.position),type:"merge"}),x.add(_e.id);break}}}e==="ai"?this.reclamationGoalsSignal.set(f):this.reclamationGoalsSignal.set(f)}else this.reclamationGoalsSignal.set(new Map);let d=this.unitsSignal().filter(f=>f.owner===e&&!f.hasActed),h={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(f=>f.owner===t&&f.tier>=3)};for(let f of d){let g=null,x=this.calculateValidMoves(f),S=this.getForges(e),R=this.unitsSignal().filter(Ie=>Ie.owner===t),L=[];for(let Ie of S)for(let O of R)Math.max(Math.abs(O.position.x-Ie.x),Math.abs(O.position.y-Ie.y))<=3&&L.push(O);if(L.length>0){let Ie=L.reduce((T,k)=>{let I=Math.abs(T.position.x-f.position.x)+Math.abs(T.position.y-f.position.y);return Math.abs(k.position.x-f.position.x)+Math.abs(k.position.y-f.position.y)<I?k:T});if(x.some(T=>T.x===Ie.position.x&&T.y===Ie.position.y))g={type:"attack",target:Ie.position,reason:"Defense: Guard Forge"};else{let T=this.getNextStepTowards(f,Ie.position,x);T&&(g=this.getWallBetween(f.position.x,f.position.y,T.x,T.y)?{type:"wall_attack",target:T,reason:"Defense: Breach to Forge"}:{type:"move",target:T,reason:"Defense: Approach Forge Threat"})}}if(!g&&f.tier>=2&&(!f.hasArmor||!f.hasWeapon)){let Ie=this.seekUpgradesFor(e,f,x);Ie.type==="move"&&Ie.target&&(g={type:"move",target:Ie.target,reason:"Upgrade: Move to Forge"})}let q=this.computeSideEffectivePower(e),ye=this.computeSideEffectivePower(t),xe=ye>0&&q>ye*1.2&&!this.isForest(f.position.x,f.position.y)&&parseInt(f.id.slice(-1),16)%2===0;if(!g&&xe){let Ie=this.getBasePosition(t);if(Math.max(Math.abs(Ie.x-f.position.x),Math.abs(Ie.y-f.position.y))<=1){let T=this.findCombatTarget(f,h,x);T&&(g={type:"attack",target:T,reason:"Siege: Engage Enemy"})}else{let T=this.getNextStepTowards(f,Ie,x,{noCohesion:!0});T&&(g={type:"move",target:T,reason:"Siege: Advance"})}}if(!g){let Ie=this.findCombatTarget(f,h,x);Ie&&(g={type:"attack",target:Ie,reason:"Combat: Engage Enemy"})}if(!g&&this.getWood(e)>=10&&this.getNeighbors(f.position).some(T=>this.isForest(T.x,T.y)&&this.getUnitAt(T.x,T.y)?.owner===e)){let T=this.findDefensiveWallTarget(f);T&&(g={type:"build_wall",target:T,reason:"Defense: Fortify Perimeter"})}if(!g){let Ie=t==="ai"?o:r,O=this.findFallbackMove(f,x,Ie);O&&(g={type:"move",target:O,reason:"Fallback: Advance on Enemy"})}g?g.type==="build_wall"?e==="ai"?this.aiBuildWallBetween(f.position,g.target):this.buildWallBetween(f.position,g.target):this.executeMove(f,g.target):this.unitsSignal.update(Ie=>Ie.map(O=>O.id===f.id?ce(F({},O),{hasActed:!0}):O)),await new Promise(Ie=>setTimeout(Ie,60))}e==="player"?this.endTurn():this.endTurn()}playerAutoStep(){if(!this.isPlayerTurn()||this.gameStatus()!=="playing")return!1;let e="player",t="ai",i=this.unitsSignal().find(a=>a.owner===e&&!a.hasActed);if(!i)return!1;let r=this.calculateValidMoves(i),o=this.seekUpgradesFor(e,i,r),s=null;if(o.type==="move"&&o.target&&(s={type:"move",target:o.target,reason:"Upgrade: Move to Forge"}),!s){let a=this.isForest(i.position.x,i.position.y),l=this.isMine(i.position.x,i.position.y),c=this.totalWarMode();if((a||l)&&!c&&!this.getNeighbors(i.position).some(f=>{let g=this.getUnitAt(f.x,f.y);return g&&g.owner===t}))return this.unitsSignal.update(f=>f.map(g=>g.id===i.id?ce(F({},g),{hasActed:!0}):g)),!0}if(!s){let a=this.findPlayerResourceTarget(i);if(a){let l=`${a.x},${a.y}`,c=new Set(this.playerClaimedTargetsSignal());c.add(l),this.playerClaimedTargetsSignal.set(c);let d=this.bfsPath(i.position,a,{respectWalls:!0,avoidFriendlyUnits:!0});if(d||(d=this.bfsPath(i.position,a,{avoidFriendlyUnits:!0})),d&&d.length>1){let h=d[1];this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?s={type:"wall_attack",target:h,reason:"Resource: Breach to Capture"}:r.some(g=>g.x===h.x&&g.y===h.y)&&(s={type:"move",target:h,reason:"Resource: Move to Capture"})}else{let h=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});h&&(s=this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?{type:"wall_attack",target:h,reason:"Resource: Breach"}:{type:"move",target:h,reason:"Resource: Advance"})}}}if(!s){let a={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(c=>c.owner===t&&c.tier>=3)},l=this.findCombatTarget(i,a,r);l&&(s={type:"attack",target:l,reason:"Combat: Engage Enemy"})}if(!s){let a=this.getBasePosition(t),l=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});l&&(s={type:"move",target:l,reason:"Advance"})}return s?(s.type==="build_wall"?this.buildWallBetween(i.position,s.target):s.type==="wall_attack"?this.attackOrDestroyWallBetween(i.position,s.target):this.executeMove(i,s.target),!0):(this.unitsSignal.update(a=>a.map(l=>l.id===i.id?ce(F({},l),{hasActed:!0}):l)),!1)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10)return;if(!this.canBuildWallBetween(e,t)){if(this.isEdgeOnCooldown(e,t)){let a=this.edgeCooldownRemaining(e,t);this.appendLog(`[Build] This area is too unstable to rebuild yet (CD: ${a} turns).`)}return}let r=this.getBestAdjacentPlayerUnit(e,t);if(!r||r.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.updateWallFormations(),this.resourcesSignal.update(a=>({wood:a.wood-10,iron:a.iron})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(l=>l.id===r.id?ce(F({},l),{hasActed:!0}):l))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20,iron:t.iron})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(i=>({wood:i.wood-t*20,iron:i.iron})),this.reservePointsSignal.update(i=>({player:i.player+t,ai:i.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let i=[];for(let r=-2;r<=2;r++)for(let o=-2;o<=2;o++){if(r===0&&o===0)continue;let s=t.x+r,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(r),Math.abs(o))>2)continue;this.getUnitAt(s,a)||i.push({x:s,y:a})}this.deployTargetsSignal.set(i),this.baseDeployActiveSignal.set(!0)}startSandboxSpawn(e,t){this.settings.customMode()&&this.sandboxSpawnPendingSignal.set({owner:e,tier:t})}cancelSandboxSpawn(){this.sandboxSpawnPendingSignal.set(null)}spawnSandboxAt(e){let t=this.sandboxSpawnPendingSignal();if(!t||!this.settings.customMode()||this.getUnitAt(e.x,e.y))return;let i=this.getPointsForTierLevel(t.tier,1),r={id:crypto.randomUUID(),position:F({},e),level:1,tier:t.tier,points:i,owner:t.owner,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};this.unitsSignal.update(o=>[...o,r]),this.sandboxSpawnPendingSignal.set(null),this.recomputeVisibility()}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,l=e.y+s;this.inBounds(a,l)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,l)||t.push({x:a,y:l}))}let i=this.reservePointsSignal().player,r=[];for(let o of t){if(i<=0)break;let s=this.economy.getHighestAffordableCost(i);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(l=>[...l,{id:crypto.randomUUID(),position:F({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}]),i-=s,r.push(o)}r.length>0&&(this.reservePointsSignal.update(o=>({player:i,ai:o.ai})),this.recomputeVisibility())}botEconomyPhase(e){if(this.gameStatus()!=="playing"||e!=="player"||!this.isPlayerTurn())return!1;let t=!1;{let r=this.baseHealthSignal().player<50?20:50,o=0;for(;this.resourcesSignal().wood>=r+20;)this.convertWoodToReserve(),o+=20;o>0&&(this.appendLog(`[Auto-Engage] Player converted ${o} wood to reserves.`),t=!0)}try{let i=this.forgesSignal().length,r=this.forgeSitesSignal().length,o=i+r,s=this.resourcesSignal();if(o<2&&s.iron>=20&&s.wood>=40){let a=this.getBasePosition("player"),l=2,c=!1;for(let d=-l;d<=l&&!c;d++)for(let h=-l;h<=l&&!c;h++){if(d===0&&h===0)continue;let f=a.x+d,g=a.y+h;this.inBounds(f,g)&&(Math.max(Math.abs(d),Math.abs(h))>l||this.canBuildForgeAt(f,g)&&(this.appendLog(`[Auto-Engage] Player building Forge at (${f},${g}).`),this.buildForgeAt({x:f,y:g}),t=!0,c=!0))}}}catch{}if(!this.wallBuiltThisTurnSignal()&&this.resourcesSignal().wood>=10){let r=this.unitsSignal().filter(o=>o.owner==="player"&&this.isForest(o.position.x,o.position.y));for(let o of r){let s=this.findDefensiveWallTargetForOwner(o,"player");if(s){this.buildWallBetween(o.position,s),t=!0;break}}}{let i=this.unitsSignal().length;this.autoDeployFromReserves(),this.unitsSignal().length>i&&(t=!0)}return t}isDeployTarget(e,t){return this.deployTargetsSignal().some(i=>i.x===e&&i.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let i=this.economy.getHighestAffordableCost(t);if(i<=0)return;let r=this.calculateTierAndLevel(i);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:F({},e),level:r.level,tier:r.tier,points:i,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-i,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${r.tier}(L${r.level}) at (${e.x},${e.y}) costing ${i} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[i,r]=this.sortEdgeEndpoints(e,t);return`${i.x},${i.y}|${r.x},${r.y}`}registerWallDestroyedEdge(e,t){let i=this.edgeKey(e,t),r=new Map(this.wallCooldownSignal());r.set(i,this.turnSignal()),this.wallCooldownSignal.set(r)}isEdgeOnCooldown(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);return r===void 0?!1:5-(this.turnSignal()-r)>0}edgeCooldownRemaining(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);if(r===void 0)return 0;let o=5-(this.turnSignal()-r);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,i=!1){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(r.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(r.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(r.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;{let x=t.x-e.x,S=t.y-e.y,R=Math.abs(x)>=Math.abs(S),L=Math.sign(R?x:S),q=this.wallThicknessPx+2,ye=this.tileSizePx+q,_e=Math.round(ye*.35),xe=R?L*_e:0,Ie=R?0:L*_e,O=new Set(this.attackingUnitsSignal());O.add(s.id),this.attackingUnitsSignal.set(O),this.attackerNudgeSignal.set({id:s.id,dx:xe,dy:Ie}),setTimeout(()=>{this.attackerNudgeSignal.set({id:s.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let T=new Set(this.attackingUnitsSignal());T.delete(s.id),this.attackingUnitsSignal.set(T)},200)}let a=this.combat.getWallHitAmount(s.tier),[l,c]=this.sortEdgeEndpoints(e,t),d=r.maxHealth??100,h=Math.max(0,r.health-a);this.wallsSignal.update(x=>x.map(S=>S.id===r.id?ce(F({},S),{health:Math.max(0,S.health-a)}):S).filter(S=>S.health>0)),h<=0?(this.registerWallDestroyedEdge(l,c),this.updateWallFormations()):this.updateWallFormations(),this.shakenWallIdSignal.set(r.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let f=o==="player"?"Player":"AI",g=r.owner==="neutral"?"Neutral":r.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${s.tier} Unit attacked ${g} Wall. Damage: ${a}. Wall HP: ${h}/${d}.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(x=>x.map(S=>S.id===s.id?ce(F({},S),{hasActed:!0}):S)),o==="player"&&this.selectNextAvailableUnit()}destroyOwnWallBetween(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i||i.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==i.id));let[r,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(r,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`),this.updateWallFormations()}canDestroyOwnWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||i.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!i||i.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||!this.canActThisTurn()?!1:i.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(i=>i.owner==="player"&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let i=this.getAdjacentPlayerUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="ai"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentAiUnit(e,t){let i=this.getAdjacentAiUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<50)return;let i=this.getBestAdjacentAiUnit(e,t);if(!i||i.hasActed||!this.unitsSignal().filter(l=>l.owner==="player").some(l=>{let c=Math.max(Math.abs(l.position.x-e.x),Math.abs(l.position.y-e.y)),d=Math.max(Math.abs(l.position.x-t.x),Math.abs(l.position.y-t.y));return c<=2||d<=2?l.tier>=i.tier:!1})||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let[s,a]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(l=>[...l,{id:crypto.randomUUID(),tile1:{x:s.x,y:s.y},tile2:{x:a.x,y:a.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(l=>l-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(l=>l.map(c=>c.id===i.id?ce(F({},c),{hasActed:!0}):c)),this.updateWallFormations()}isBaseProtectionEdge(e,t){let i=this.getBasePosition("ai"),r=o=>Math.max(Math.abs(o.x-i.x),Math.abs(o.y-i.y))<=1||o.x===i.x&&o.y===i.y;return r(e)||r(t)}wouldCageElite(e,t){let i=(s,a,l,c)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:l,y:c}),h=this.sortEdgeEndpoints(e,t);return d[0].x===h[0].x&&d[0].y===h[0].y&&d[1].x===h[1].x&&d[1].y===h[1].y},r=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||i(s.x,s.y,a.x,a.y));{let l=Math.sign(a.x-s.x),c=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+l,s.y),h=this.getWallBetween(s.x,s.y,s.x,s.y+c),f=this.getWallBetween(a.x-l,a.y,a.x,a.y),g=this.getWallBetween(a.x,a.y-c,a.x,a.y);return!!(d||h||f||g||i(s.x,s.y,s.x+l,s.y)||i(s.x,s.y,s.x,s.y+c)||i(a.x-l,a.y,a.x,a.y)||i(a.x,a.y-c,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(l=>{let c={x:s.position.x+l.x,y:s.position.y+l.y};return this.inBounds(c.x,c.y)?!r(s.position,c):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(r=>r.owner==="ai"),t=this.unitsSignal().filter(r=>r.owner==="player"),i=this.getBasePosition("ai");for(let r of e){if(!this.isForest(r.position.x,r.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y))<=2);for(let s of o){let a=r.level??this.calculateTierAndLevel(r.points).level,l=s.level??this.calculateTierAndLevel(s.points).level,c=Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y)),d=Math.sign(s.position.x-r.position.x),h=Math.sign(s.position.y-r.position.y);if(Math.abs(d)+Math.abs(h)===2)continue;let f=c===1?{x:r.position.x+d,y:r.position.y+h}:{x:r.position.x+Math.sign(s.position.x-r.position.x),y:r.position.y+Math.sign(s.position.y-r.position.y)};if(!this.inBounds(f.x,f.y))continue;let g=Math.sign(i.x-r.position.x),x=Math.sign(i.y-r.position.y);if((f.x-r.position.x)*g+(f.y-r.position.y)*x>0)continue;let R=r.position,L=f;if(!this.getWallBetween(R.x,R.y,L.x,L.y)&&(l>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(R,L),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${R.x},${R.y})-(${L.x},${L.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let i=e.x<=t.x,r=e.y<=t.y;return i&&r?0:!i&&r?1:i&&!r?2:3}placeNeutralWalls(){let e=(i,r)=>{if(!this.areAdjacent(i,r)||!this.inBounds(i.x,i.y)||!this.inBounds(r.x,r.y)||this.getWallBetween(i.x,i.y,r.x,r.y))return;let[o,s]=this.sortEdgeEndpoints(i,r);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}]),this.updateWallFormations()},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let i of t){let r=[{x:i.x+1,y:i.y},{x:i.x-1,y:i.y},{x:i.x,y:i.y+1},{x:i.x,y:i.y-1}];for(let o of r)this.inBounds(o.x,o.y)&&e(i,o)}for(let i of this.forestsSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}for(let i of this.minesSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}}static \u0275fac=function(t){return new(t||n)(Ne(Wl),Ne(Og),Ne(Fg),Ne(Et),Ne(Lg),Ne(Vg),Ne(Ug),Ne(Rn),Ne(wc))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};function w$(n,e){n&1&&(ie(),G(0,"polygon",127))}function x$(n,e){n&1&&(ie(),G(0,"polygon",127))}function S$(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",213),A())}function I$(n,e){n&1&&(ie(),G(0,"polygon",127))}function T$(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",213),A())}function C$(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",214)(2,"polygon",215)(3,"polygon",216),A())}var g0=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(he(Gn),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-game-rules"]],decls:694,vars:76,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","flex-col","justify-between"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"bg-gray-800/60","border","border-blue-500/30","rounded-lg","p-4","shadow-[0_0_15px_rgba(59,130,246,0.1)]"],[1,"text-lg","font-semibold","mb-3","flex","items-center","gap-2"],[1,"text-blue-400"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[45px]","text-center"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[60px]","text-center"],[1,"text-xs","text-gray-400","text-right","italic"],[1,"flex","flex-col","items-center","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","text-white"],[1,"flex","items-center","justify-between","gap-4","border-t","border-white/5","pt-3"],[1,"px-4","py-1","bg-blue-600","border-b-4","border-blue-800","rounded","text-xs","font-mono","text-white","font-bold"],[1,"text-xs","text-blue-300","font-semibold","uppercase","tracking-wider"],[1,"mt-4","p-2","bg-blue-500/10","border","border-blue-500/20","rounded","text-[10px]","text-blue-200/70","leading-tight"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"bg-gray-800/60","border","border-gray-700","rounded-xl","p-6","md:col-span-2","shadow-2xl","backdrop-blur-sm"],[1,"text-xs","uppercase","tracking-widest","text-gray-500","font-bold","mb-6","flex","items-center","gap-2"],[1,"w-8","h-[1px]","bg-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8","items-start"],[1,"space-y-6"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-gray-300","text-sm"],[1,"text-orange-400","font-bold"],[1,"text-blue-400","font-bold"],[1,"p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-xs","text-gray-400","leading-relaxed"],[1,"text-white","font-semibold"],[1,"lg:col-span-2","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-blue-500/50","transition-all","duration-300","flex","items-center","gap-4"],[1,"w-20","h-20","shrink-0"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],["cx","50","cy","50","r","32"],["cx","50","cy","50","r","31","fill","none","stroke","rgba(255,255,255,0.2)","stroke-width","2"],["x","50","y","62","text-anchor","middle","font-size","32","font-weight","800","fill","white"],["transform","translate(18, 5) scale(0.8)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","#60a5fa"],[1,"flex","flex-col"],[1,"text-blue-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"text-gray-300","text-sm","leading-tight"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-red-500/50","transition-all","duration-300","flex","items-center","gap-4"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],["transform","rotate(-45 50 50) translate(40, 10) scale(1.2)"],["x","5","y","0","width","2","height","10","fill","#f87171"],["x","3","y","10","width","6","height","2","fill","#991b1b"],[1,"text-red-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"p-4","bg-gray-800/40","rounded-lg","border","border-gray-700/30"],[1,"text-[10px]","uppercase","tracking-wider","text-gray-500","font-bold","mb-3"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"flex","justify-between","border-b","border-gray-700/50","pb-1"],[1,"text-gray-500"],[1,"text-white"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","#60a5fa","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],[1,"text-lg","font-semibold","mb-1"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","3"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","4"],[1,"mover","triangle","t1-path"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"flex","items-center","gap-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","theme-test-player"],[1,"flex","flex-col","flex-center"],[1,"flex","flex-center","gap-2"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-80"],["points","50,16 86,78 14,78","fill","var(--u-fill)"],["x","49","y","66","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2"],["viewBox","0 0 100 100"],["id","base-circle"],["id","eye"],["id","scan-lvl2"],["id","radar-lvl3"],["id","field-lvl4"],["cx","50","cy","50","r","14","fill","#94a3b8"],["cx","50","cy","50","r","4","fill","#e5e7eb"],["cx","50","cy","50","r","20","fill","none","stroke","#cbd5f5","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","#e5e7eb","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","#f8fafc"],["cx","50","cy","50","r","30","fill","none","stroke","#f1f5f9","stroke-width","1","opacity","0.4"],[1,"unit-svg-wrapper","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-70"],["cx","50","cy","55","r","6","fill","var(--u-core)"],["points","50,5 55,15 45,15","fill","var(--u-stroke)"],["points","92,82 82,78 86,70","fill","var(--u-stroke)"],["points","8,82 18,78 14,70","fill","var(--u-stroke)"],["points","50,2 95,85 5,85","fill","none","stroke","var(--u-core)","stroke-width","2"],["points","50,48 56,52 56,60 50,64 44,60 44,52","fill","var(--u-light)"],["points","50,-2 102,88 -2,88","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","opacity","0.6"],["points","50,-5 54,8 46,8","fill","var(--u-light)"],["points","92,82 88,70 80,78","fill","var(--u-light)"],["points","8,82 20,78 12,70","fill","var(--u-light)"],["id","base-shape"],["id","core"],["id","armor-lvl2"],["id","armor-lvl3"],["id","fortress-lvl4"],["id","fx"],["x","20","y","20","width","60","height","60","rx","6","fill","#2563eb"],["x","46","y","46","width","8","height","8","fill","#93c5fd"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","#60a5fa","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","#93c5fd","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","#bfdbfe"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","#60a5fa","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","#bfdbfe"],["x","78","y","12","width","10","height","10","fill","#bfdbfe"],["x","12","y","78","width","10","height","10","fill","#bfdbfe"],["x","78","y","78","width","10","height","10","fill","#bfdbfe"],["id","base-hex"],["id","links-lvl2"],["id","network-lvl3"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","#10b981"],["cx","50","cy","50","r","4","fill","#6ee7b7"],["x1","50","y1","20","x2","50","y2","40","stroke","#6ee7b7","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","#6ee7b7","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","#6ee7b7","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","#a7f3d0","stroke-width","2"],["cx","50","cy","20","r","3","fill","#34d399"],["cx","80","cy","50","r","3","fill","#34d399"],["cx","50","cy","80","r","3","fill","#34d399"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","#6ee7b7","stroke-width","1.5","stroke-dasharray","4 4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","unit-svg-wrapper-game_rules"],[1,"flex","items-center","gap-6","theme-test-player"],["viewBox","0 0 100 100",1,"w-full","h-full"],["cx","50","cy","50","r","20","fill","var(--u-fill)"],["cx","50","cy","50","r","4","fill","var(--u-light)"],["cx","50","cy","50","r","26","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","var(--u-light)","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","var(--u-light)"],["cx","50","cy","50","r","34","fill","none","stroke","var(--u-light)","stroke-width","1","opacity","0.4"],[1,"flex","items-center","gap-6","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-75"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-110"],["x","20","y","20","width","60","height","60","rx","6","fill","var(--u-dark)"],["x","46","y","46","width","8","height","8","fill","var(--u-core)"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","var(--u-light)"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","var(--u-light)"],["x","78","y","12","width","10","height","10","fill","var(--u-light)"],["x","12","y","78","width","10","height","10","fill","var(--u-light)"],["x","78","y","78","width","10","height","10","fill","var(--u-light)"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","var(--u-emerald)"],["cx","50","cy","50","r","4","fill","var(--u-emerald-stroke)"],["x1","50","y1","20","x2","50","y2","40","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","var(--u-emerald-stroke)","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","2"],["cx","50","cy","20","r","3","fill","var(--u-emerald-stroke)"],["cx","80","cy","50","r","3","fill","var(--u-emerald-stroke)"],["cx","50","cy","80","r","3","fill","var(--u-emerald-stroke)"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 56,10 44,10","fill","var(--u-light)"],["points","99,87 92,74 84,87","fill","var(--u-light)"],["points","1,87 15,87 8,74","fill","var(--u-light)"]],template:function(t,i){t&1&&(D(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),y(5),A(),D(6,"h3",5),y(7),A()(),D(8,"button",6),Ht("click",function(){return i.engine.closeRules()}),y(9," \u2716 "),A()(),D(10,"div",7)(11,"div",8)(12,"div",9),y(13),A(),D(14,"div",10)(15,"div",11)(16,"div",12),y(17,"\u{1F333}"),A(),D(18,"div")(19,"div",13),y(20),A(),D(21,"div",14),y(22),A()()(),D(23,"div",11)(24,"div",12),y(25,"\u{1F3F0}"),A(),D(26,"div")(27,"div",13),y(28),A(),D(29,"div",14),y(30),A()()()()(),D(31,"div",15)(32,"div",16)(33,"div",9),y(34),A(),D(35,"div",17)(36,"div",18)(37,"div",19),y(38," 1 "),A(),D(39,"div",20),y(40,"1\u20134"),A()(),D(41,"div",18)(42,"div",21),y(43," 5 "),A(),D(44,"div",20),y(45,"5\u201320"),A()(),D(46,"div",18)(47,"div",21),y(48,"25"),A(),D(49,"div",20),y(50,"25\u2013100"),A()(),D(51,"div",18)(52,"div",22)(53,"span",23),y(54,"125"),A()(),D(55,"div",20),y(56,"125\u2013500"),A()()()(),D(57,"div",16)(58,"div",24),y(59),A(),D(60,"div",25)(61,"div",26)(62,"div",27),y(63,"2"),A(),D(64,"div",28),y(65,"2"),A(),D(66,"div",29),y(67,"1"),A()()()()(),D(68,"div",30)(69,"div",31)(70,"span",32),y(71,"\u2328\uFE0F"),A(),y(72),A(),D(73,"div",33)(74,"div",34)(75,"div",35)(76,"kbd",36),y(77," Tab "),A(),D(78,"kbd",37),y(79," Space "),A()(),D(80,"div",38),y(81),A()(),D(82,"div",34)(83,"div",39)(84,"kbd",40),y(85,"\u2191"),A(),D(86,"div",35)(87,"kbd",40),y(88,"\u2190"),A(),D(89,"kbd",40),y(90,"\u2193"),A(),D(91,"kbd",40),y(92,"\u2192"),A()()(),D(93,"div",38),y(94),A()(),D(95,"div",41)(96,"kbd",42),y(97," Enter "),A(),D(98,"div",43),y(99),A()()(),D(100,"div",44)(101,"strong"),y(102,"TIP:"),A(),y(103),A()(),D(104,"div",8)(105,"div",9),y(106),A(),D(107,"div",45)(108,"div")(109,"div",46),y(110),A(),D(111,"div",47)(112,"div",48),y(113,"1"),A(),D(114,"div",49),y(115,"1"),A()(),D(116,"div",50),y(117),A()(),D(118,"div")(119,"div",46),y(120),A(),D(121,"div",47)(122,"div",48),y(123,"4"),A(),D(124,"div",51),y(125,"1"),A(),D(126,"span",52),y(127,"CRIT!"),A()(),D(128,"div",50),y(129),A()(),D(130,"div")(131,"div",46),y(132),A(),D(133,"div",47)(134,"div",48),y(135,"1"),A(),D(136,"div",53),y(137,"4"),A(),D(138,"span",54),y(139,"MISS!"),A()(),D(140,"div",50),y(141),A()()()(),D(142,"div",55)(143,"div",56),G(144,"span",57),y(145),A(),D(146,"div",58)(147,"div",59)(148,"div",60)(149,"div",61)(150,"span",62),y(151),A(),D(152,"span",63),y(153,"20%"),A()(),D(154,"div",61)(155,"span",62),y(156),A(),D(157,"span",64),y(158,"20%"),A()(),D(159,"div",65)(160,"p",66)(161,"span",67),y(162,"50%"),A(),y(163),A()()()(),D(164,"div",68)(165,"div",69)(166,"div",70),ie(),D(167,"svg",71),G(168,"circle",72)(169,"circle",73),D(170,"text",74),y(171,"1"),A(),D(172,"g",75),G(173,"path",76),A()()(),ke(),D(174,"div",77)(175,"span",78),y(176,"+20 HP Bonus"),A(),D(177,"p",79),y(178),A()()(),D(179,"div",80)(180,"div",70),ie(),D(181,"svg",81),G(182,"circle",72)(183,"circle",73),D(184,"text",74),y(185,"1"),A(),D(186,"g",82),G(187,"rect",83)(188,"rect",84),A()()(),ke(),D(189,"div",77)(190,"span",85),y(191,"+20 DMG Bonus"),A(),D(192,"p",79),y(193),A()()()(),D(194,"div",68)(195,"div",86)(196,"p",87),y(197),A(),D(198,"div",88)(199,"div",89)(200,"span",90),y(201,"T1"),A(),D(202,"span",91),y(203,"1"),A()(),D(204,"div",89)(205,"span",90),y(206,"T2"),A(),D(207,"span",91),y(208,"2"),A()(),D(209,"div",89)(210,"span",90),y(211,"T3"),A(),D(212,"span",91),y(213,"4"),A()(),D(214,"div",89)(215,"span",90),y(216,"T4"),A(),D(217,"span",91),y(218,"8"),A()()()(),D(219,"div",80)(220,"div",70),ie(),D(221,"svg",81),G(222,"circle",72)(223,"circle",73),D(224,"text",74),y(225,"1"),A(),D(226,"g"),G(227,"path",92)(228,"path",93),A()()(),ke(),D(229,"div",77)(230,"p",79),y(231),A()()()()()(),D(232,"div",16)(233,"div",94),y(234),A(),D(235,"div",95)(236,"div")(237,"div",96),y(238),A(),D(239,"div",97),G(240,"div",98)(241,"div",98)(242,"div",98)(243,"div",98)(244,"div",98)(245,"div",98)(246,"div",99)(247,"div",99)(248,"div",98)(249,"div",98)(250,"div",98)(251,"div",98)(252,"div",98)(253,"div",98)(254,"div",98)(255,"div",98)(256,"div",98)(257,"div",98)(258,"div",98)(259,"div",98)(260,"div",98)(261,"div",98)(262,"div",98)(263,"div",98)(264,"div",98),D(265,"div",100),y(266,"2"),A(),G(267,"div",101),D(268,"div",102),y(269,"\u{1F3F0}"),A()()(),D(270,"div")(271,"div",96),y(272),A(),D(273,"div",103),G(274,"div",98)(275,"div",98)(276,"div",98)(277,"div",98)(278,"div",98)(279,"div",98)(280,"div",99)(281,"div",99)(282,"div",99)(283,"div",98)(284,"div",98)(285,"div",98)(286,"div",98)(287,"div",98)(288,"div",98)(289,"div",98)(290,"div",98)(291,"div",98)(292,"div",98)(293,"div",98)(294,"div",98)(295,"div",98)(296,"div",98)(297,"div",98)(298,"div",98),D(299,"div",104),y(300,"3"),A(),G(301,"div",101),D(302,"div",105),y(303,"\u{1F3F0}"),A()()(),D(304,"div")(305,"div",96),y(306),A(),D(307,"div",106),G(308,"div",98)(309,"div",98)(310,"div",98)(311,"div",98)(312,"div",98)(313,"div",98)(314,"div",99)(315,"div",99)(316,"div",99)(317,"div",99)(318,"div",98)(319,"div",98)(320,"div",98)(321,"div",98)(322,"div",98)(323,"div",98)(324,"div",98)(325,"div",98)(326,"div",98)(327,"div",98)(328,"div",98)(329,"div",98)(330,"div",98)(331,"div",98)(332,"div",98),D(333,"div",107),y(334,"4"),A(),G(335,"div",101),D(336,"div",102),y(337,"\u{1F3F0}"),A()()()()(),D(338,"div",15)(339,"div",16)(340,"div",9),y(341),A(),D(342,"div",17)(343,"div",108)(344,"div",109),y(345,"\u{1F331}"),A(),D(346,"div",110),y(347),A()(),D(348,"div",111),y(349,"\u2192"),A(),D(350,"div",108)(351,"div",109),y(352,"\u{1F33F}"),A(),D(353,"div",110),y(354),A()(),D(355,"div",111),y(356,"\u2192"),A(),D(357,"div",108)(358,"div",109),y(359,"\u{1F333}"),A(),D(360,"div",112),y(361),A()()()(),D(362,"div",16)(363,"div",9),y(364),A(),D(365,"div",113)(366,"div",108)(367,"div",109),y(368,"\u26F0\uFE0F"),A(),D(369,"div",114),y(370),A()(),D(371,"div",111),y(372,"\u2192"),A(),D(373,"div",108)(374,"div",109),y(375,"\u26CF\uFE0F"),A(),D(376,"div",114),y(377),A()(),D(378,"div",111),y(379,"\u2192"),A(),D(380,"div",108)(381,"div",109),y(382,"\u26CF"),A(),D(383,"div",114),y(384),A()(),D(385,"div",111),y(386,"\u2192"),A(),D(387,"div",108)(388,"div",109),y(389,"\u2692"),A(),D(390,"div",114),y(391),A()(),D(392,"div",111),y(393,"\u2192"),A(),D(394,"div",108)(395,"div",109),y(396,"\u{1F9F1}"),A(),D(397,"div",115),y(398),A()()()(),D(399,"div",16)(400,"div",116),y(401),A(),D(402,"div",117)(403,"div",3),G(404,"div",118),D(405,"div",20),y(406),A()(),D(407,"div",3),G(408,"div",119),D(409,"div",20),y(410),A()(),D(411,"div",3),G(412,"div",120),D(413,"div",20),y(414,"Neutral"),A()()()()(),D(415,"div",121)(416,"div",122)(417,"div",9),y(418),A(),D(419,"div",123),ie(),D(420,"svg",124)(421,"g"),G(422,"polygon",125),A(),D(423,"text",126),y(424),A()(),D(425,"svg",124)(426,"g"),G(427,"polygon",125),A(),D(428,"text",126),y(429),A(),Q(430,w$,1,0,":svg:polygon",127),A(),D(431,"svg",124)(432,"g"),G(433,"polygon",125),A(),D(434,"text",126),y(435),A(),Q(436,x$,1,0,":svg:polygon",127),Q(437,S$,2,0,":svg:g"),A(),D(438,"svg",124)(439,"g"),G(440,"polygon",125),A(),D(441,"text",126),y(442),A(),Q(443,I$,1,0,":svg:polygon",127),Q(444,T$,2,0,":svg:g"),Q(445,C$,4,0,":svg:g"),A()()()(),ke(),D(446,"div",16)(447,"div",9),y(448),A(),D(449,"div",17),ie(),D(450,"svg",128),G(451,"g",129)(452,"g",130)(453,"g",131)(454,"g",132)(455,"g",133),D(456,"g",129),G(457,"circle",134),A(),D(458,"g",130),G(459,"circle",135),A(),D(460,"g",131),G(461,"circle",136),A(),D(462,"g",132),G(463,"line",137)(464,"circle",138),A(),D(465,"g",133),G(466,"circle",139),A()(),ke(),D(467,"div",140),ie(),D(468,"svg",141)(469,"g"),G(470,"polygon",125),A(),D(471,"g"),G(472,"circle",142),A(),D(473,"g"),G(474,"polygon",143)(475,"polygon",144)(476,"polygon",145),A(),D(477,"g"),G(478,"polygon",146)(479,"polygon",147),A(),D(480,"g"),G(481,"polygon",148)(482,"polygon",149)(483,"polygon",150)(484,"polygon",151),A()()(),D(485,"svg",128),G(486,"g",152)(487,"g",153)(488,"g",154)(489,"g",155)(490,"g",156)(491,"g",157),D(492,"g",152),G(493,"rect",158),A(),D(494,"g",153),G(495,"rect",159),A(),D(496,"g",154),G(497,"rect",160),A(),D(498,"g",155),G(499,"rect",161)(500,"rect",162),A(),D(501,"g",156),G(502,"rect",163)(503,"rect",164)(504,"rect",165)(505,"rect",166)(506,"rect",167),A()(),D(507,"svg",128),G(508,"g",168)(509,"g",153)(510,"g",169)(511,"g",170)(512,"g",133),D(513,"g",168),G(514,"polygon",171),A(),D(515,"g",153),G(516,"circle",172),A(),D(517,"g",169),G(518,"line",173)(519,"line",174)(520,"line",175),A(),D(521,"g",170),G(522,"polygon",176)(523,"circle",177)(524,"circle",178)(525,"circle",179),A(),D(526,"g",133),G(527,"polygon",180),A()()()(),ke(),D(528,"div",181)(529,"div",9),y(530),A(),D(531,"div",182),ie(),D(532,"svg",183)(533,"g"),G(534,"circle",184),A(),D(535,"g"),G(536,"circle",185),A()(),D(537,"svg",183)(538,"g"),G(539,"circle",184),A(),D(540,"g"),G(541,"circle",185),A(),D(542,"g"),G(543,"circle",186),A()(),D(544,"svg",183)(545,"g"),G(546,"circle",184),A(),D(547,"g"),G(548,"circle",185),A(),D(549,"g"),G(550,"circle",186),A(),D(551,"g"),G(552,"line",187)(553,"circle",188),A()(),D(554,"svg",183)(555,"g"),G(556,"circle",184),A(),D(557,"g"),G(558,"circle",185),A(),D(559,"g"),G(560,"circle",186),A(),D(561,"g"),G(562,"line",187)(563,"circle",188),A(),D(564,"g"),G(565,"circle",189),A()()(),ke(),D(566,"div",190),ie(),D(567,"svg",191)(568,"g"),G(569,"polygon",125),A(),D(570,"g"),G(571,"circle",142),A()(),D(572,"svg",191)(573,"g"),G(574,"polygon",125),A(),D(575,"g"),G(576,"circle",142),A(),D(577,"g"),G(578,"polygon",143)(579,"polygon",144)(580,"polygon",145),A()(),D(581,"svg",191)(582,"g"),G(583,"polygon",125),A(),D(584,"g"),G(585,"circle",142),A(),D(586,"g"),G(587,"polygon",143)(588,"polygon",144)(589,"polygon",145),A(),D(590,"g"),G(591,"polygon",146)(592,"polygon",147),A()(),D(593,"svg",141)(594,"g"),G(595,"polygon",125),A(),D(596,"g"),G(597,"circle",142),A(),D(598,"g"),G(599,"polygon",143)(600,"polygon",144)(601,"polygon",145),A(),D(602,"g"),G(603,"polygon",146)(604,"polygon",147),A(),D(605,"g"),G(606,"polygon",148)(607,"polygon",149)(608,"polygon",150)(609,"polygon",151),A()()(),ke(),D(610,"div",182),ie(),D(611,"svg",192)(612,"g"),G(613,"rect",193),A(),D(614,"g"),G(615,"rect",194),A()(),D(616,"svg",192)(617,"g"),G(618,"rect",193),A(),D(619,"g"),G(620,"rect",194),A(),D(621,"g"),G(622,"rect",195),A()(),D(623,"svg",192)(624,"g"),G(625,"rect",193),A(),D(626,"g"),G(627,"rect",194),A(),D(628,"g"),G(629,"rect",195),A(),D(630,"g"),G(631,"rect",196)(632,"rect",197),A()(),D(633,"svg",192)(634,"g"),G(635,"rect",193),A(),D(636,"g"),G(637,"rect",194),A(),D(638,"g"),G(639,"rect",195),A(),D(640,"g"),G(641,"rect",196)(642,"rect",197),A(),D(643,"g"),G(644,"rect",198)(645,"rect",199)(646,"rect",200)(647,"rect",201)(648,"rect",202),A()()(),ke(),D(649,"div",190),ie(),D(650,"svg",183)(651,"g"),G(652,"polygon",203),A(),D(653,"g"),G(654,"circle",204),A()(),D(655,"svg",183)(656,"g"),G(657,"polygon",203),A(),D(658,"g"),G(659,"circle",204),A(),D(660,"g"),G(661,"line",205)(662,"line",206)(663,"line",207),A()(),D(664,"svg",183)(665,"g"),G(666,"polygon",203),A(),D(667,"g"),G(668,"circle",204),A(),D(669,"g"),G(670,"line",205)(671,"line",206)(672,"line",207),A(),D(673,"g"),G(674,"polygon",208)(675,"circle",209)(676,"circle",210)(677,"circle",211),A()(),D(678,"svg",183)(679,"g"),G(680,"polygon",203),A(),D(681,"g"),G(682,"circle",204),A(),D(683,"g"),G(684,"line",205)(685,"line",206)(686,"line",207),A(),D(687,"g"),G(688,"polygon",208)(689,"circle",209)(690,"circle",210)(691,"circle",211),A(),D(692,"g"),G(693,"polygon",212),A()()()()()()()),t&2&&(m(5),j(i.settings.t("GAME_GUIDE")),m(2),j(i.settings.t("TURN_BASED_STRATEGY")),m(6),j(i.settings.t("VICTORY_CONDITIONS")),m(7),j(i.settings.t("MONOPOLY_LABEL")),m(2),j(i.settings.t("MONOPOLY_DESC")),m(6),j(i.settings.t("ANNIHILATION")),m(2),j(i.settings.t("ANNIHILATION_DESC")),m(4),j(i.settings.t("UNIT_EVOLUTION")),m(8),et("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),m(17),j(i.settings.t("EVOLUTION_DESC")),m(13),V(" ",i.settings.currentLang()==="uk"?"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0435 \u0443\u043F\u0440\u0430\u0432\u043B\u0456\u043D\u043D\u044F":"Tactical Controls"," "),m(9),V(" ",i.settings.currentLang()==="uk"?"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0438\u0439 \u0432\u0456\u043B\u044C\u043D\u0438\u0439 \u044E\u043D\u0456\u0442":"Cycle through available units"," "),m(13),V(" ",i.settings.currentLang()==="uk"?"\u0420\u0443\u0445 \u0430\u0431\u043E \u0430\u0442\u0430\u043A\u0430 \u0432\u0438\u0431\u0440\u0430\u043D\u0438\u043C \u044E\u043D\u0456\u0442\u043E\u043C":"Move or attack with selected unit"," "),m(5),V(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0445\u0456\u0434":"End player turn"," "),m(4),V(" ",i.settings.currentLang()==="uk"?"\u041D\u0430 \u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043A\u043E\u0436\u043D\u043E\u0433\u043E \u0445\u043E\u0434\u0443 \u0433\u0440\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u0444\u043E\u043A\u0443\u0441\u0443\u0454\u0442\u044C\u0441\u044F \u043D\u0430 \u043C\u043E\u0431\u0456\u043B\u044C\u043D\u043E\u043C\u0443 \u044E\u043D\u0456\u0442\u0456.":"At turn start, the game auto-focuses on your most mobile unit."," "),m(3),j(i.settings.t("COMBAT_DEEP_DIVE")),m(4),j(i.settings.t("SUCCESSFUL_ATTACK")),m(7),j(i.settings.t("SUCCESSFUL_ATTACK_DESC")),m(3),j(i.settings.t("CRITICAL_HIT")),m(9),j(i.settings.t("CRITICAL_HIT_DESC")),m(3),j(i.settings.t("MISS")),m(9),j(i.settings.t("MISS_DESC")),m(4),V(" ",i.settings.currentLang()==="uk"?"\u0414\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0438":"Extra Mechanics"," "),m(6),V(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043A\u0440\u0438\u0442\u0443":"Crit Chance"," "),m(5),V(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u0443":"Miss Chance"," "),m(7),V(" ",i.settings.currentLang()==="uk"?"\u043F\u0440\u0438 \u0440\u0456\u0432\u043D\u0438\u0445 \u0441\u0438\u043B\u0430\u0445: \u0417\u0430\u0445\u0438\u0441\u0442/\u041D\u0456\u0447\u0438\u044F":"at equal force: Defense/Draw"," "),m(5),Ut("fill","url(#vol-fill-player)"),m(10),V(" ",i.settings.currentLang()==="uk"?"-10% \u0443 \u0432\u043E\u0440\u043E\u0433\u0430 \u0448\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u043D\u0443\u0442\u0438\u0441\u044C":"-10% enemy chance to miss"," "),m(4),Ut("fill","url(#vol-fill-player)"),m(11),V(" ",i.settings.currentLang()==="uk"?"10% \u0448\u0430\u043D\u0441 \u043F\u043E\u043F\u0430\u0441\u0442\u0438 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0443":"10% chance to hit the enemy"," "),m(4),V(" ",i.settings.currentLang()==="uk"?"\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F Tier-\u0440\u0456\u0432\u043D\u0456\u0432":"Tier Values"," "),m(25),Ut("fill","url(#vol-fill-player)"),m(9),V(" ",i.settings.currentLang()==="uk"?"+1 \u0434\u043E \u0430\u0442\u0430\u043A\u0438 \u0432\u0456\u0434 \u0441\u0443\u0441\u0456\u0434\u0441\u0442\u0432\u0430":"+1 to an attack from the neighborhood"," "),m(3),j(i.settings.t("MOVEMENT")),m(4),j(i.settings.t("T1_1_TILE")),m(30),et("left",6,"px")("top",6,"px"),m(4),j(i.settings.t("T3_3_TILES")),m(30),et("right",6,"px")("bottom",6,"px"),m(4),j(i.settings.t("T4_4_TILES")),m(30),et("left",6,"px")("top",6,"px"),m(5),j(i.settings.t("FOREST_CYCLE")),m(6),j(i.settings.t("TURN_1")),m(7),j(i.settings.t("TURN_2")),m(7),j(i.settings.t("PLUS_8_WOOD_PER_TURN")),m(3),j(i.settings.t("IRON_CYCLE")),m(6),j(i.settings.t("TURN_1")),m(7),j(i.settings.t("TURN_2")),m(7),j(i.settings.t("TURN_3")),m(7),j(i.settings.t("TURN_4")),m(7),j(i.settings.t("PLUS_2_IRON_PER_TURN")),m(3),j(i.settings.t("WALL_LEGEND")),m(5),j(i.settings.t("PLAYER")),m(4),j(i.settings.t("AI_FACTION")),m(8),V(" ",i.settings.currentLang()==="uk"?"\u0422\u0440\u0435\u0442\u044F \u0456\u0442\u0435\u0440\u0430\u0446\u0456\u044F \u043E\u0434\u0438\u043D\u0438\u0446\u044C":"Third iteration the units"," "),m(6),V(" ",1," "),m(5),V(" ",2," "),m(),J(430),m(5),V(" ",3," "),m(),J(436),m(),J(437),m(5),V(" ",4," "),m(),J(443),m(),J(444),m(),J(445),m(3),j(i.settings.t("NEW_DESIGN_UNIT")),m(82),j(i.settings.t("NEW_UNIT_EVOLUTION")))},dependencies:[Pt],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:60px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:10px;font-size:12px;font-weight:800;color:#fde047;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:10px;font-size:12px;font-weight:800;color:#93c5fd;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}.unit-svg-wrapper-game_rules:hover{transform:scale(1)}
`],encapsulation:2})};var xc=class n{constructor(e,t){this.gameEngine=e;this.settings=t}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(he(Gn),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-support-community"]],decls:51,vars:6,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,i){t&1&&(D(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),y(4),A(),D(5,"button",4),Ht("click",function(){return i.gameEngine.closeSupport()}),y(6," \u2716 "),A()(),D(7,"div",5)(8,"div",6)(9,"div",7),y(10,"Donate"),A(),D(11,"div",8),y(12),A(),D(13,"div",9)(14,"div",10),G(15,"img",11),A(),D(16,"div",12)(17,"div",13),y(18,"send.monobank.ua/jar/2fqGoPhV7G"),A(),D(19,"div",14)(20,"button",15),Ht("click",function(){return i.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),y(21),A(),D(22,"button",16),Ht("click",function(){return i.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),y(23),A()()()(),D(24,"div",17)(25,"div",8),y(26,"Donatello"),A(),D(27,"button",18),Ht("click",function(){return i.openExternalLink("https://donatello.to/jaerbi")}),y(28," Go to Donatello.to \u{1F48E} "),A()(),D(29,"div",19),y(30),A()(),D(31,"div",6)(32,"div",7),y(33),A(),D(34,"div",20)(35,"button",21),Ht("click",function(){return i.openExternalLink("https://discord.gg/c9tCWFtFaG")}),D(36,"span",22),y(37,"\u{1F5E8}\uFE0F"),A(),D(38,"div",23)(39,"div",24),y(40,"Discord Server"),A(),D(41,"div",25),y(42,"Share ideas & feedback"),A()()(),D(43,"button",26),Ht("click",function(){return i.openExternalLink("https://www.youtube.com/@jaerb1")}),D(44,"span",22),y(45,"\u25B6\uFE0F"),A(),D(46,"div",23)(47,"div",24),y(48,"YouTube"),A(),D(49,"div",25),y(50,"Dev logs & gameplay"),A()()()()()()()()),t&2&&(m(4),j(i.settings.t("SUPPORT_COMMUNITY")),m(8),j(i.settings.t("MONOBANK_JAR")),m(9),V(" ",i.settings.t("OPEN_LINK")," \u{1F4DC} "),m(2),V(" ",i.settings.t("COPY_LINK")," \u{1F4CB} "),m(7),j(i.settings.t("THANK_SUPPORTING")),m(3),j(i.settings.t("SOCIAL_FEEDBACK")))},dependencies:[Pt],encapsulation:2})};function D$(n,e){if(n&1){let t=$e();v(0,"button",7),X("click",function(){ee(t);let r=P();return te(r.switchToMyStats())}),y(1," My Statistics "),_()}if(n&2){let t=P();Ae("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function A$(n,e){n&1&&(v(0,"div",15)(1,"span",16),W(2,"span",17),v(3,"span"),y(4,"Loading..."),_()()())}function M$(n,e){if(n&1&&W(0,"img",27),n&2){let t=P().$implicit;Ce("src",t.userPhoto,er)}}function R$(n,e){n&1&&(v(0,"div",28),y(1,"\u{1F464}"),_())}function N$(n,e){if(n&1&&(v(0,"tr",22)(1,"td",23),y(2),_(),v(3,"td",24),zt(4,M$,1,1,"img",25)(5,R$,2,0,"ng-template",null,0,uo),y(7),_(),v(8,"td",23),y(9),_(),v(10,"td",26),y(11),_()()),n&2){let t=e.$implicit,i=e.index,r=tr(6),o=P(3);Ae("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),m(2),j(i+1),m(2),Ce("ngIf",t.userPhoto)("ngIfElse",r),m(3),V(" ",t.playerName," "),m(2),j(t.victoryType),m(2),j(t.turnsPlayed)}}function P$(n,e){if(n&1&&(v(0,"tr")(1,"td",29),y(2),W(3,"br"),v(4,"span",30),y(5,"Be the first to claim victory!"),_()()()),n&2){let t=P(3);m(2),Mt(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function k$(n,e){if(n&1&&(v(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),y(5,"Rank"),_(),v(6,"th",20),y(7,"Name"),_(),v(8,"th",20),y(9,"Victory Type"),_(),v(10,"th",20),y(11,"Turns"),_()()(),v(12,"tbody"),zt(13,N$,12,12,"tr",21)(14,P$,6,2,"tr",9),_()()()),n&2){let t=P(2);m(13),Ce("ngForOf",t.scores()),m(),Ce("ngIf",t.scores().length===0)}}function O$(n,e){if(n&1&&(v(0,"div")(1,"div",11)(2,"span"),y(3,"Top 10 scores for:"),_(),v(4,"span",12),y(5),_(),v(6,"span",13),y(7),_()(),zt(8,A$,5,0,"div",14)(9,k$,15,2,"div",9),_()),n&2){let t=P();m(5),V(" ",t.settings.difficultyLabel()," "),m(2),V(" ",t.settings.mapSizeLabel()," "),m(),Ce("ngIf",t.loading()),m(),Ce("ngIf",!t.loading())}}function F$(n,e){n&1&&(v(0,"div",15)(1,"span",16),W(2,"span",17),v(3,"span"),y(4,"Loading your stats..."),_()()())}function L$(n,e){n&1&&(v(0,"div",35),y(1," No victories recorded yet. keep playing! "),_())}function V$(n,e){if(n&1&&(v(0,"div",36)(1,"div",37)(2,"span",38),y(3),_(),v(4,"span",39),y(5),_()(),v(6,"div",40)(7,"span",41),y(8,"Best Performance"),_(),v(9,"span",42),y(10),_()(),v(11,"div",43),y(12),Oi(13,"date"),_()()),n&2){let t=e.$implicit;m(3),V(" ",t.difficulty," "),m(2),V(" ",t.mapSize," "),m(5),V("",t.turnsPlayed," Turns"),m(2),Mt(" ",t.victoryType," \u2022 ",nr(13,5,t.timestamp,"mediumDate")," ")}}function U$(n,e){if(n&1&&(v(0,"div",32),zt(1,L$,2,0,"div",33)(2,V$,14,8,"div",34),_()),n&2){let t=P(2);m(),Ce("ngIf",t.myBestScores().length===0),m(),Ce("ngForOf",t.myBestScores())}}function B$(n,e){if(n&1&&(v(0,"div",22),zt(1,F$,5,0,"div",14)(2,U$,3,2,"div",31),_()),n&2){let t=P();m(),Ce("ngIf",t.loading()),m(),Ce("ngIf",!t.loading())}}var m0=class n{constructor(e,t,i,r){this.firebase=e;this.gameEngine=t;this.playerName=i;this.settings=r;this.fetch()}loading=$(!0);scores=$([]);activeTab=$("top10");myBestScores=$([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),i=await this.firebase.getTopScores(10,e,t);this.scores.set(i??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),i=new Map;t.forEach(r=>{let o=`${r.difficulty}-${r.mapSize}`;(!i.has(o)||r.turnsPlayed<i.get(o).turnsPlayed)&&i.set(o,r)}),this.myBestScores.set(Array.from(i.values()).sort((r,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[r.difficulty];return a!==0?a:r.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(he(Rn),he(Gn),he(wc),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,i){t&1&&(v(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),y(4,"Leaderboard"),_(),v(5,"button",5),X("click",function(){return i.gameEngine.closeLeaderboard()}),y(6," \u2716 "),_()(),v(7,"div",6)(8,"button",7),X("click",function(){return i.activeTab.set("top10")}),y(9," Top 10 "),_(),zt(10,D$,2,6,"button",8),_(),zt(11,O$,10,4,"div",9)(12,B$,3,2,"div",10),_()()),t&2&&(m(8),Ae("text-white",i.activeTab()==="top10")("border-b-2",i.activeTab()==="top10")("border-indigo-500",i.activeTab()==="top10"),m(2),Ce("ngIf",i.firebase.user$()),m(),Ce("ngIf",i.activeTab()==="top10"),m(),Ce("ngIf",i.activeTab()==="mystats"))},dependencies:[Pt,hs,ya,va],encapsulation:2})};function j$(n,e){if(n&1&&(ie(),D(0,"text",4),y(1),A()),n&2){let t=P(2);m(),V(" ",t.unit.level," ")}}function H$(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function G$(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function $$(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function z$(n,e){n&1&&(ie(),G(0,"circle",7))}function W$(n,e){n&1&&(ie(),G(0,"circle",8))}function q$(n,e){n&1&&(ie(),G(0,"circle",9))}function K$(n,e){if(n&1&&(ie(),D(0,"svg",0),G(1,"circle",2)(2,"circle",3),Q(3,j$,2,1,":svg:text",4),Q(4,H$,3,0,":svg:g"),Q(5,G$,4,0,":svg:g",5),Q(6,$$,3,0,":svg:g",6),Q(7,z$,1,0,":svg:circle",7),Q(8,W$,1,0,":svg:circle",8),Q(9,q$,1,0,":svg:circle",9),A()),n&2){let t=P();m(),Ut("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),J(t.isTower?-1:3),m(),J(t.gameEngine.hasDefenseBonus(t.unit)&&!t.isTower?4:-1),m(),J(t.unit.hasWeapon?5:-1),m(),J(t.unit.hasArmor?6:-1),m(),J(t.unit.level>=2?7:-1),m(),J(t.unit.level>=3?8:-1),m(),J(t.unit.level>=4?9:-1)}}function Y$(n,e){if(n&1&&(ie(),D(0,"text",20),y(1),A()),n&2){let t=P(2);m(),V(" ",t.unit.level," ")}}function Q$(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function J$(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function X$(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function Z$(n,e){n&1&&(ie(),G(0,"polygon",21))}function ez(n,e){n&1&&(ie(),G(0,"polygon",22))}function tz(n,e){n&1&&(ie(),D(0,"g"),G(1,"polygon",23)(2,"polygon",24)(3,"polygon",25),A())}function nz(n,e){if(n&1&&(ie(),D(0,"svg",1)(1,"g",17),G(2,"polygon",18)(3,"polygon",19),Q(4,Y$,2,1,":svg:text",20),Q(5,Q$,3,0,":svg:g"),Q(6,J$,4,0,":svg:g",5),Q(7,X$,3,0,":svg:g",6),Q(8,Z$,1,0,":svg:polygon",21),Q(9,ez,1,0,":svg:polygon",22),Q(10,tz,4,0,":svg:g"),A()()),n&2){let t=P();m(2),Ut("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),J(t.isTower?-1:4),m(),J(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),m(),J(t.unit.hasWeapon?6:-1),m(),J(t.unit.hasArmor?7:-1),m(),J(t.unit.level>=2?8:-1),m(),J(t.unit.level>=3?9:-1),m(),J(t.unit.level>=4?10:-1)}}function iz(n,e){if(n&1&&(ie(),D(0,"text",28),y(1),A()),n&2){let t=P(2);m(),V(" ",t.unit.level," ")}}function rz(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function oz(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function sz(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function az(n,e){n&1&&(ie(),G(0,"rect",29))}function lz(n,e){n&1&&(ie(),G(0,"rect",30))}function cz(n,e){n&1&&(ie(),G(0,"rect",31)(1,"rect",32)(2,"rect",33)(3,"rect",34))}function uz(n,e){if(n&1&&(ie(),D(0,"svg",0),G(1,"rect",26)(2,"rect",27),Q(3,iz,2,1,":svg:text",28),Q(4,rz,3,0,":svg:g"),Q(5,oz,4,0,":svg:g",5),Q(6,sz,3,0,":svg:g",6),Q(7,az,1,0,":svg:rect",29),Q(8,lz,1,0,":svg:rect",30),Q(9,cz,4,0),A()),n&2){let t=P();m(),Ut("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),J(t.isTower?-1:3),m(),J(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),m(),J(t.unit.hasWeapon?5:-1),m(),J(t.unit.hasArmor?6:-1),m(),J(t.unit.level>=2?7:-1),m(),J(t.unit.level>=3?8:-1),m(),J(t.unit.level>=4?9:-1)}}function dz(n,e){if(n&1&&(ie(),D(0,"text",37),y(1),A()),n&2){let t=P(2);m(),V(" ",t.unit.level," ")}}function hz(n,e){n&1&&(ie(),D(0,"g"),G(1,"path",10)(2,"path",11),A())}function fz(n,e){n&1&&(ie(),D(0,"g",5),G(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function pz(n,e){n&1&&(ie(),D(0,"g",6),G(1,"path",15)(2,"path",16),A())}function gz(n,e){n&1&&(ie(),G(0,"polygon",38))}function mz(n,e){n&1&&(ie(),G(0,"polygon",39))}function yz(n,e){n&1&&(ie(),G(0,"circle",40)(1,"circle",41)(2,"circle",42)(3,"circle",43)(4,"circle",44)(5,"circle",45))}function vz(n,e){if(n&1&&(ie(),D(0,"svg",0),G(1,"polygon",35)(2,"polygon",36),Q(3,dz,2,1,":svg:text",37),Q(4,hz,3,0,":svg:g"),Q(5,fz,4,0,":svg:g",5),Q(6,pz,3,0,":svg:g",6),Q(7,gz,1,0,":svg:polygon",38),Q(8,mz,1,0,":svg:polygon",39),Q(9,yz,6,0),A()),n&2){let t=P();m(),Ut("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),J(t.isTower?-1:3),m(),J(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),m(),J(t.unit.hasWeapon?5:-1),m(),J(t.unit.hasArmor?6:-1),m(),J(t.unit.level>=2?7:-1),m(),J(t.unit.level>=3?8:-1),m(),J(t.unit.level>=4?9:-1)}}var y0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}unit;isTower=!1;static \u0275fac=function(t){return new(t||n)(he(Gn),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-units"]],inputs:{unit:"unit",isTower:"isTower"},decls:4,vars:1,consts:[["viewBox","0 0 100 100",1,"w-full","h-full"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-95"],["cx","50","cy","50","r","32","filter","url(#soft-shadow)"],["cx","50","cy","50","r","31","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","61","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["transform","rotate(-45 30 14)"],["transform","translate(16, 2)"],["cx","50","cy","50","r","35","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["cx","50","cy","50","r","40","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["cx","50","cy","50","r","28","fill","none","stroke","var(--u-light)","stroke-width","2"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","var(--u-light)","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],["x","5","y","0","width","2","height","10","fill","var(--u-light)"],["points","6,-2 8,2 4,2","fill","var(--u-light)"],["x","3","y","10","width","6","height","2","fill","var(--u-fill)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","var(--u-light)"],["d","M5 3V8M3 5H9","stroke","var(--u-fill)","stroke-width","1.2","stroke-linecap","round","opacity","0.7"],["transform","translate(0, 4)"],["points","50,16 86,78 14,78","filter","url(#soft-shadow)"],["points","50,18 82,74 18,74","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","50","y","68","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2","stroke-linejoin","round"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["points","50,0 56,10 44,10","fill","var(--u-light)","stroke-linejoin","round"],["points","99,87 92,74 84,87","fill","var(--u-light)","stroke-linejoin","round"],["points","1,87 15,87 8,74","fill","var(--u-light)","stroke-linejoin","round"],["x","21","y","21","width","56","height","56","rx","6","filter","url(#soft-shadow)"],["x","23","y","23","width","52","height","52","rx","5","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","60","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["x","18","y","18","width","62","height","62","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","14","y","14","width","70","height","70","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["x","12","y","12","width","8","height","8","fill","var(--u-light)"],["x","78","y","12","width","8","height","8","fill","var(--u-light)"],["x","12","y","78","width","8","height","8","fill","var(--u-light)"],["x","78","y","78","width","8","height","8","fill","var(--u-light)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","filter","url(#soft-shadow)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","fill","none","stroke","var(--u-light)","stroke-width","2","opacity","0.4"],["x","49","y","62","text-anchor","middle","font-size","28","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,17 81,35 81,65 50,83 19,65 19,35","fill","none","stroke","var(--u-core)","stroke-width","1.5","stroke-linejoin","round"],["points","50,12 86,32 86,68 50,88 14,68 14,32","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["cx","50","cy","12","r","3","fill","var(--u-light)"],["cx","86","cy","32","r","3","fill","var(--u-light)"],["cx","86","cy","68","r","3","fill","var(--u-light)"],["cx","50","cy","88","r","3","fill","var(--u-light)"],["cx","14","cy","68","r","3","fill","var(--u-light)"],["cx","14","cy","32","r","3","fill","var(--u-light)"]],template:function(t,i){if(t&1&&Q(0,K$,10,8,":svg:svg",0)(1,nz,11,8,":svg:svg",1)(2,uz,10,8,":svg:svg",0)(3,vz,10,8,":svg:svg",0),t&2){let r;J((r=i.unit.tier)===1?0:r===2?1:r===3?2:r===4?3:-1)}},dependencies:[Pt],encapsulation:2})};function _z(n,e){if(n&1){let t=$e();D(0,"div",7)(1,"div",8),y(2),A(),D(3,"button",9),Ht("click",function(){ee(t);let r=P();return te(r.gameEngine.cancelSandboxSpawn())}),y(4),A()()}if(n&2){let t=P();m(2),V(" ",t.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u0438":"Click an empty tile to spawn"," "),m(2),V(" ",t.settings.currentLang()==="uk"?"\u0412\u0456\u0434\u043C\u0456\u043D\u0430":"Cancel"," ")}}var v0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(he(Gn),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-sandbox"]],decls:24,vars:3,consts:[[1,"absolute","-top-7","left-[-10px]","ml-2","px-3","py-1","rounded-full","bg-pink-600/20","border","border-pink-500/30","text-pink-200","text-[10px]","font-black","uppercase","tracking-widest"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-28","right-[-254px]","min-w-[238px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"mt-2","flex","flex-col","gap-2","w-full","px-2","py-2","rounded-lg","border","border-white/5","bg-white/5"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-pink-200"],[1,"grid","grid-cols-4","gap-2"],[1,"px-2","py-1","rounded","bg-blue-600/20","border","border-blue-500/30","text-blue-100","text-[10px]","cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","bg-red-600/20","border","border-red-500/30","text-red-100","text-[10px]","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-[10px]","text-gray-300"],[1,"px-2","py-1","rounded","bg-gray-700","hover:bg-gray-600","border","border-gray-600","text-white","text-[10px]","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(D(0,"div",0),y(1),A(),D(2,"div",1)(3,"div",2)(4,"div",3),y(5),A(),D(6,"div",4)(7,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",1)}),y(8," T1 "),A(),D(9,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",2)}),y(10," T2 "),A(),D(11,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",3)}),y(12," T3 "),A(),D(13,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",4)}),y(14," T4 "),A(),D(15,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",1)}),y(16," T1 "),A(),D(17,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",2)}),y(18," T2 "),A(),D(19,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",3)}),y(20," T3 "),A(),D(21,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",4)}),y(22," T4 "),A()(),Q(23,_z,5,2,"div",7),A()()),t&2&&(m(),V(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox",`
`),m(4),V(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox"," "),m(18),J(i.gameEngine.sandboxSpawnPending()?23:-1))},dependencies:[Pt],encapsulation:2})};var Ez=["boardContainer"],Dt=(n,e)=>({x:n,y:e}),bz=()=>[10,20,30],wz=(n,e)=>e.id,oO=(n,e)=>e.date;function xz(n,e){if(n&1){let t=$e();v(0,"div",82)(1,"div",233)(2,"span",234),y(3),_(),v(4,"button",235),X("click",function(){ee(t);let r=P();return te(r.firebase.logout())}),y(5),_()(),v(6,"div",236),W(7,"img",237)(8,"div",238),_()()}if(n&2){let t=P();m(3),V(" ",t.settings.t("VERIFIED")," "),m(2),V(" ",t.settings.t("LOGOUT")," "),m(2),Ce("src",e.photoURL,er)}}function Sz(n,e){if(n&1){let t=$e();v(0,"button",239),X("click",function(){ee(t);let r=P();return te(r.firebase.loginWithGoogle())}),W(1,"div",240),v(2,"span",241),y(3),_()()}if(n&2){let t=P();m(3),V(" ",t.settings.t("CONNECT")," ")}}function Iz(n,e){if(n&1){let t=$e();v(0,"div",82)(1,"div",233)(2,"span",234),y(3),_(),v(4,"button",235),X("click",function(){ee(t);let r=P(2);return te(r.firebase.logout())}),y(5),_()(),v(6,"div",236),W(7,"img",237)(8,"div",238),_()(),v(9,"button",197),X("click",function(){ee(t);let r=P(2);return te(r.toggleAutoBattle())}),v(10,"div",198)(11,"span",199),y(12),_(),v(13,"span",200),y(14),_()(),v(15,"div",198),W(16,"span",201),_(),W(17,"div",202),_()}if(n&2){let t=P(2);m(3),V(" ",t.settings.t("VERIFIED")," "),m(2),V(" ",t.settings.t("LOGOUT")," "),m(2),Ce("src",e.photoURL,er),m(2),Ae("ring-2",t.isAutoBattleActive())("ring-green-400",t.isAutoBattleActive()),Ce("disabled",t.gameEngine.gameStatus()!=="playing"),m(3),j(t.settings.t("AUTO")),m(2),j(t.settings.t("ENGAGE")),m(2),Ae("bg-green-400",t.isAutoBattleActive())("bg-gray-500",!t.isAutoBattleActive())}}function Tz(n,e){if(n&1){let t=$e();v(0,"button",239),X("click",function(){ee(t);let r=P(2);return te(r.firebase.loginWithGoogle())}),W(1,"div",240),v(2,"span",241),y(3),_()()}if(n&2){let t=P(2);m(3),V(" ",t.settings.t("CONNECT")," ")}}function Cz(n,e){if(n&1){let t=$e();v(0,"div",119)(1,"div",242)(2,"button",243),X("click",function(){ee(t);let r=P();return te(r.closeMobileMenu())}),ie(),v(3,"svg",103),W(4,"path",244),_()(),ke(),v(5,"button",245),X("click",function(){ee(t);let r=P();return te(r.gameEngine.resetGame())}),y(6),_(),v(7,"button",245),X("click",function(){ee(t);let r=P();return te(r.gameEngine.toggleRules())}),y(8),_(),v(9,"button",245),X("click",function(){ee(t);let r=P();return te(r.gameEngine.toggleLeaderboard())}),y(10),_(),v(11,"button",245),X("click",function(){ee(t);let r=P();return te(r.gameEngine.toggleLog())}),y(12),_(),v(13,"button",245),X("click",function(){ee(t);let r=P();return te(r.navigateToFeedback())}),y(14),_(),v(15,"button",245),X("click",function(){ee(t);let r=P();return te(r.navigateToRoadmap())}),y(16),_(),v(17,"button",245),X("click",function(){ee(t);let r=P();return te(r.gameEngine.toggleSettings())}),y(18),_(),v(19,"button",245),X("click",function(){ee(t);let r=P();return te(r.navigateToRoadmap())}),y(20),_(),Q(21,Iz,18,14)(22,Tz,4,1,"button",83),_()()}if(n&2){let t,i=P();m(6),j(i.settings.t("RELOAD")),m(2),j(i.settings.t("INFO")),m(2),j(i.settings.t("RANKING")),m(2),j(i.settings.t("SYSTEM_LOG")),m(2),j(i.settings.t("FEEDBACK_MODULE")),m(2),j(i.settings.t("STRATEGIC_PLAN")),m(2),j(i.settings.t("SETTINGS")),m(2),j(i.settings.t("STRATEGIC_PLAN")),m(),J((t=i.firebase.user$())?21:22,t)}}function Dz(n,e){if(n&1&&(v(0,"div",161),y(1),_()),n&2){let t=P();m(),cs(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function Az(n,e){if(n&1&&(v(0,"div",248),y(1),_()),n&2){let t=P(2);m(),j(t.gameEngine.endReason())}}function Mz(n,e){if(n&1){let t=$e();v(0,"div",249)(1,"div",252),y(2),_(),W(3,"input",253,1),v(5,"button",254),X("click",function(){ee(t);let r=tr(4),o=P(2);return te(o.gameEngine.confirmAndSaveScore(r.value))}),y(6),_()()}if(n&2){let t=P(2);m(2),j(t.settings.t("CONFIRM_NAME")),m(),Ce("value",t.gameEngine.getPlayerName()),m(3),V(" ",t.settings.t("SAVE_SCORE")," ")}}function Rz(n,e){if(n&1){let t=$e();v(0,"div",169)(1,"div",246)(2,"h2",247),y(3),Oi(4,"titlecase"),_(),Q(5,Az,2,1,"div",248),Q(6,Mz,7,3,"div",249),v(7,"button",250),X("click",function(){ee(t);let r=P();return te(r.gameEngine.resetGame())}),y(8),_()(),v(9,"button",251),X("click",function(){ee(t);let r=P();return te(r.gameEngine.toggleLeaderboard())}),y(10),_()()}if(n&2){let t=P();m(2),Ae("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),m(),V(" ",vE(4,9,t.gameEngine.gameStatus()),"! "),m(2),J(t.gameEngine.endReason()?5:-1),m(),J(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),m(2),V(" ",t.settings.t("PLAY_AGAIN")," "),m(2),V(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function Nz(n,e){n&1&&W(0,"app-support-community")}function Pz(n,e){n&1&&W(0,"app-leaderboard-modal")}function kz(n,e){n&1&&W(0,"app-sandbox")}function Oz(n,e){if(n&1&&(v(0,"div",184)(1,"span",255),y(2),_()()),n&2){let t=P();m(2),V(" ",t.gameEngine.baseHealth().ai," ")}}function Fz(n,e){n&1&&(v(0,"span",267),y(1," \u{1F92C} "),_()),n&2&&et("z-index",100)}function Lz(n,e){n&1&&(v(0,"span",267),y(1," \u{1F620} "),_()),n&2&&et("z-index",100)}function Vz(n,e){if(n&1&&Q(0,Fz,2,2,"span",266)(1,Lz,2,2,"span",266),n&2){let t=P(3);J(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function Uz(n,e){n&1&&W(0,"div",259)}function Bz(n,e){if(n&1){let t=$e();v(0,"button",268),X("click",function(){ee(t);let r=P().$implicit,o=P().$implicit,s=P();return te(s.gameEngine.buildForgeAt({x:r,y:o}))}),y(1," Build Forge "),_()}n&2&&et("z-index",60)}function jz(n,e){if(n&1&&(v(0,"span",269),y(1),_()),n&2){let t=P().$implicit,i=P().$implicit,r=P();et("z-index",55),m(),V(" ",r.gameEngine.getForgeProgress(t,i),"% ")}}function Hz(n,e){n&1&&(v(0,"span",273),ie(),v(1,"svg",274)(2,"g",275),W(3,"rect",276)(4,"rect",277)(5,"path",278)(6,"rect",279)(7,"rect",280),_()()()),n&2&&et("z-index",50)}function Gz(n,e){if(n&1){let t=$e();v(0,"button",284),X("click",function(){ee(t),P(3);let r=Nr(5),o=P(2);return te(o.gameEngine.buyWeapon(r.id))}),y(1," Weapon "),_()}}function $z(n,e){if(n&1){let t=$e();v(0,"button",285),X("click",function(){ee(t),P(3);let r=Nr(5),o=P(2);return te(o.gameEngine.buyArmor(r.id))}),y(1," Armor "),_()}}function zz(n,e){if(n&1&&(v(0,"div",281),Q(1,Gz,2,0,"button",282),Q(2,$z,2,0,"button",283),_()),n&2){P(2);let t=Nr(5),i=P(2);et("z-index",60),m(),J(!t.hasWeapon&&i.gameEngine.resources().iron>=20?1:-1),m(),J(!t.hasArmor&&i.gameEngine.resources().iron>=20?2:-1)}}function Wz(n,e){if(n&1&&(v(0,"span",270),y(1," Forge "),_(),Q(2,Hz,8,2,"span",271),Q(3,zz,3,4,"div",272)),n&2){let t=P().$implicit,i=Nr(5),r=P().$implicit,o=P();et("z-index",55),Ae("scale-60",i&&i.owner==="player")("scale-50",i&&i.owner==="player")("top-1",!(i&&i.owner==="player"))("left-1",!(i&&i.owner==="player"))("top-0",i&&i.owner==="player")("-right-1",i&&i.owner==="player"),m(2),J(o.gameEngine.isVisibleToPlayer(t,r)?2:-1),m(),J(i&&i.owner==="player"?3:-1)}}function qz(n,e){n&1&&(ie(),v(0,"g",291),W(1,"polygon",294)(2,"polygon",295),_())}function Kz(n,e){n&1&&(ie(),v(0,"g",296),W(1,"rect",297),_(),v(2,"g",298),W(3,"rect",299)(4,"path",300),_())}function Yz(n,e){if(n&1&&(v(0,"span",286),ie(),v(1,"svg",287)(2,"defs")(3,"linearGradient",288),W(4,"stop",289)(5,"stop",290),_()(),Q(6,qz,3,0,":svg:g",291),v(7,"g"),W(8,"polygon",292)(9,"rect",293),_(),Q(10,Kz,5,0),_()()),n&2){P();let t=Nr(5);Ae("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),m(6),J(t?-1:6),m(),Ae("scale-90",t),m(3),J(t?-1:10)}}function Qz(n,e){n&1&&(ie(),v(0,"g",304),W(1,"rect",305)(2,"path",306),_())}function Jz(n,e){if(n&1&&(v(0,"span",286),ie(),v(1,"svg",287)(2,"g"),W(3,"ellipse",301)(4,"path",302)(5,"circle",303),_(),Q(6,Qz,3,0,":svg:g",304),_()()),n&2){P();let t=Nr(5);Ae("scale-50",t)("opacity-40",t)("-translate-x-4",t)("translate-y-4",t),m(6),J(t?-1:6)}}function Xz(n,e){n&1&&W(0,"div",307),n&2&&et("height",2,"px")}function Zz(n,e){if(n&1&&(v(0,"span",308),y(1),_(),v(2,"span",309),y(3),_()),n&2){let t=P(3);m(),V(" ",t.gameEngine.baseHealth().player," "),m(2),V(" ",t.gameEngine.reservePoints().player," ")}}function eW(n,e){if(n&1&&(v(0,"span",310),y(1),_(),v(2,"span",311),y(3),_()),n&2){let t=P(4);m(),V(" ",t.gameEngine.baseHealth().ai," "),m(2),V(" ",t.gameEngine.reservePoints().ai," ")}}function tW(n,e){if(n&1&&Q(0,eW,4,2),n&2){let t=P().$implicit,i=P().$implicit,r=P();J(r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function nW(n,e){n&1&&(ie(),v(0,"svg",317),W(1,"path",318),_())}function iW(n,e){n&1&&(ie(),v(0,"svg",317),W(1,"path",319),_())}function rW(n,e){if(n&1){let t=$e();v(0,"button",316),X("click",function(r){ee(t);let o=P(2),s=P(2).$implicit,a=P().$implicit,l=P();return te(o.owner==="player"?l.onDestroyIconClick(r,s,a,s+1,a):l.onAttackIconClick(r,s,a,s+1,a))}),Q(1,nW,2,0,":svg:svg",317)(2,iW,2,0,":svg:svg",317),_()}if(n&2){let t=P(2),i=P(4);et("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Ae("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),m(),J(t.owner==="player"?1:2)}}function oW(n,e){if(n&1){let t=$e();v(0,"div",314),X("mouseenter",function(){ee(t);let r=P(),o=P(4);return te(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){ee(t);let r=P(5);return te(r.gameEngine.hoverFormationById(null))}),Q(1,rW,3,13,"button",315),_()}if(n&2){let t=P(),i=P(2).$implicit,r=P().$implicit,o=P();et("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","height 0.25s ease-out"),Ae("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ut("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),m(),J(o.gameEngine.canShowAttackIcon(_t(26,Dt,i,r),_t(29,Dt,i+1,r))?1:-1)}}function sW(n,e){if(n&1&&Q(0,oW,2,32,"div",313),n&2){let t=P(2).$implicit,i=P().$implicit,r=P();J(r.gameEngine.shouldRenderWall(_t(1,Dt,t,i),_t(4,Dt,t+1,i),e.owner)?0:-1)}}function aW(n,e){if(n&1){let t=$e();v(0,"button",323),X("click",function(r){ee(t);let o=P(3).$implicit,s=P().$implicit,a=P();return te(a.onBuildIconClick(r,o,s,o+1,s))}),y(1," \u2714 "),_()}if(n&2){let t=P(5);et("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function lW(n,e){if(n&1&&(v(0,"span",322),y(1),_()),n&2){let t=P(3).$implicit,i=P().$implicit,r=P();m(),Mt(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,Dt,t,i),_t(5,Dt,t+1,i))," ")}}function cW(n,e){if(n&1&&(v(0,"div",320),Q(1,aW,2,8,"button",321),Q(2,lW,2,8,"span",322),_()),n&2){let t=P(2).$implicit,i=P().$implicit,r=P();et("right",-r.gameEngine.wallThicknessPx-2,"px")("width",r.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Ae("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,Dt,t,i),_t(19,Dt,t+1,i)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,Dt,t,i),_t(25,Dt,t+1,i))),m(),J(r.gameEngine.canShowBuildIcon(_t(28,Dt,t,i),_t(31,Dt,t+1,i))?1:-1),m(),J(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t+1,i))&&r.gameEngine.edgeCooldownRemaining(_t(34,Dt,t,i),_t(37,Dt,t+1,i))>0?2:-1)}}function uW(n,e){if(n&1&&Q(0,sW,1,7)(1,cW,3,40,"div",312),n&2){let t,i=P().$implicit,r=P().$implicit,o=P();J((t=o.gameEngine.getWallBetween(i,r,i+1,r))?0:1,t)}}function dW(n,e){n&1&&(ie(),v(0,"svg",317),W(1,"path",318),_())}function hW(n,e){n&1&&(ie(),v(0,"svg",317),W(1,"path",319),_())}function fW(n,e){if(n&1){let t=$e();v(0,"button",316),X("click",function(r){ee(t);let o=P(2),s=P(2).$implicit,a=P().$implicit,l=P();return te(o.owner==="player"?l.onDestroyIconClick(r,s,a,s,a+1):l.onAttackIconClick(r,s,a,s,a+1))}),Q(1,dW,2,0,":svg:svg",317)(2,hW,2,0,":svg:svg",317),_()}if(n&2){let t=P(2),i=P(4);et("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Ae("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),m(),J(t.owner==="player"?1:2)}}function pW(n,e){if(n&1){let t=$e();v(0,"div",326),X("mouseenter",function(){ee(t);let r=P(),o=P(4);return te(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){ee(t);let r=P(5);return te(r.gameEngine.hoverFormationById(null))}),Q(1,fW,3,13,"button",315),_()}if(n&2){let t=P(),i=P(2).$implicit,r=P().$implicit,o=P();et("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","width 0.25s ease-out"),Ae("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ut("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),m(),J(o.gameEngine.canShowAttackIcon(_t(26,Dt,i,r),_t(29,Dt,i,r+1))?1:-1)}}function gW(n,e){if(n&1&&Q(0,pW,2,32,"div",325),n&2){let t=P(2).$implicit,i=P().$implicit,r=P();J(r.gameEngine.shouldRenderWall(_t(1,Dt,t,i),_t(4,Dt,t,i+1),e.owner)?0:-1)}}function mW(n,e){if(n&1){let t=$e();v(0,"button",330),X("click",function(r){ee(t);let o=P(3).$implicit,s=P().$implicit,a=P();return te(a.onBuildIconClick(r,o,s,o,s+1))}),y(1," \u2714 "),_()}if(n&2){let t=P(5);et("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function yW(n,e){if(n&1&&(v(0,"span",329),y(1),_()),n&2){let t=P(3).$implicit,i=P().$implicit,r=P();m(),Mt(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,Dt,t,i),_t(5,Dt,t,i+1))," ")}}function vW(n,e){if(n&1&&(v(0,"div",327),Q(1,mW,2,8,"button",328),Q(2,yW,2,8,"span",329),_()),n&2){let t=P(2).$implicit,i=P().$implicit,r=P();et("bottom",-r.gameEngine.wallThicknessPx-2,"px")("height",r.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Ae("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,Dt,t,i),_t(19,Dt,t,i+1)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,Dt,t,i),_t(25,Dt,t,i+1))),m(),J(r.gameEngine.canShowBuildIcon(_t(28,Dt,t,i),_t(31,Dt,t,i+1))?1:-1),m(),J(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t,i+1))&&r.gameEngine.edgeCooldownRemaining(_t(34,Dt,t,i),_t(37,Dt,t,i+1))>0?2:-1)}}function _W(n,e){if(n&1&&Q(0,gW,1,7)(1,vW,3,40,"div",324),n&2){let t,i=P().$implicit,r=P().$implicit,o=P();J((t=o.gameEngine.getWallBetween(i,r,i,r+1))?0:1,t)}}function EW(n,e){if(n&1&&W(0,"app-units",334),n&2){let t=P(3);Ce("unit",t)}}function bW(n,e){if(n&1&&(v(0,"span",338),y(1),_()),n&2){let t=e;et("z-index",200),Ae("bg-green-600",t.bg==="bg-green-600")("bg-amber-600",t.bg==="bg-amber-600")("bg-red-600",t.bg==="bg-red-600"),m(),V(" ",t.chance,"% ")}}function wW(n,e){n&1&&(v(0,"span",339),y(1," \u{1F333} "),_()),n&2&&et("z-index",100)}function xW(n,e){n&1&&(v(0,"span",340),y(1," \u{1F331} "),_()),n&2&&et("z-index",100)}function SW(n,e){n&1&&(v(0,"span",340),y(1," \u{1F33F} "),_()),n&2&&et("z-index",100)}function IW(n,e){n&1&&(v(0,"span",343),y(1," \u{1F9F1} "),_()),n&2&&et("z-index",100)}function TW(n,e){n&1&&(v(0,"span",342),y(1,"\u26F0\uFE0F"),_())}function CW(n,e){n&1&&(v(0,"span",342),y(1,"\u26CF\uFE0F"),_())}function DW(n,e){n&1&&(v(0,"span",342),y(1,"\u26CF"),_())}function AW(n,e){n&1&&(v(0,"span",342),y(1,"\u2692"),_())}function MW(n,e){if(n&1&&Q(0,IW,2,2,"span",341)(1,TW,2,0,"span",342)(2,CW,2,0,"span",342)(3,DW,2,0,"span",342)(4,AW,2,0,"span",342),n&2){let t=P(3);J((t.mineOccupationTurns??0)>=5?0:(t.mineOccupationTurns??0)===1?1:(t.mineOccupationTurns??0)===2?2:(t.mineOccupationTurns??0)===3?3:(t.mineOccupationTurns??0)>3?4:-1)}}function RW(n,e){if(n&1&&(v(0,"div",332)(1,"div",333),Q(2,EW,1,1,"app-units",334),_(),Q(3,bW,2,9,"span",335),Q(4,wW,2,2,"span",336)(5,xW,2,2,"span",337)(6,SW,2,2,"span",337),Q(7,MW,5,1),_()),n&2){let t,i=P(2),r=P(3);et("transform",r.gameEngine.getCombinedTransform(i.id))("z-index",r.gameEngine.isUnitMoving(i.id)||r.gameEngine.isUnitAttacking(i.id)?200:null),Ae("shake",r.gameEngine.isUnitShaking(i.id)),m(),et("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px"),Ae("theme-player",i.owner==="player")("theme-ai",i.owner==="ai")("fatigued",i.hasActed)("merge-anim",r.gameEngine.lastMergedUnitId()===i.id)("ring",r.gameEngine.selectedUnitId()===i.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===i.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===i.id)("scale-115",r.gameEngine.selectedUnitId()===i.id&&!r.gameEngine.buildMode())("scale-120",r.gameEngine.lastMergedUnitId()===i.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===i.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===i.id)("pulse-glow",r.gameEngine.pulseUnitId()===i.id),Ut("title",r.gameEngine.formatHoverInfo(i.id)),m(),J(i?2:-1),m(),J((t=r.gameEngine.isUnitHovered(i.id)&&r.gameEngine.getHitChanceInfo(i.id))?3:-1,t),m(),J(i.productionActive?4:(i.forestOccupationTurns??0)===1?5:(i.forestOccupationTurns??0)>1?6:-1),m(3),J(r.gameEngine.isMine(i.position.x,i.position.y)?7:-1)}}function NW(n,e){if(n&1&&Q(0,RW,8,41,"div",331),n&2){let t=P(2).$implicit,i=P().$implicit,r=P();J(!(t===0&&i===0)&&!(t===r.gameEngine.gridSize-1&&i===r.gameEngine.gridSize-1)?0:-1)}}function PW(n,e){if(n&1&&Q(0,NW,1,1),n&2){let t=P().$implicit,i=P().$implicit,r=P();J(e.owner==="player"||r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function kW(n,e){if(n&1&&(v(0,"div",344)(1,"span",345),y(2),_()()),n&2){let t=e.$implicit,i=P(3);et("z-index",100)("opacity",t.opacity),m(),Ae("text-xs",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-base",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text))("text-yellow-300",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-yellow-400",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text)),m(),V(" ",t.text," ")}}function OW(n,e){if(n&1){let t=$e();v(0,"div",257),X("click",function(){let r=ee(t).$implicit,o=P().$implicit,s=P();return te(s.onTileClick(r,o))})("mouseenter",function(){let r=ee(t).$implicit,o=P().$implicit,s=P();return te(s.gameEngine.setHoveredUnit(s.gameEngine.getUnitAt(r,o)&&(s.gameEngine.getUnitAt(r,o).owner==="player"||s.gameEngine.isVisibleToPlayer(r,o))?s.gameEngine.getUnitAt(r,o).id:null))})("mouseleave",function(){ee(t);let r=P(2);return te(r.gameEngine.setHoveredUnit(null))}),v(1,"span",258),y(2),_(),Q(3,Vz,2,1),Q(4,Uz,1,0,"div",259),Rl(5),Q(6,Bz,2,2,"button",260),Q(7,jz,2,3,"span",261),Q(8,Wz,4,16),Q(9,Yz,11,12,"span",262),Q(10,Jz,7,9,"span",263),Q(11,Xz,1,2,"div",264),Q(12,Zz,4,2),Q(13,tW,1,1),Q(14,uW,2,1),Q(15,_W,2,1),Q(16,PW,1,1),Sn(17,kW,3,13,"div",265,wz),_()}if(n&2){let t,i=e.$implicit,r=P().$implicit,o=P();et("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Ae("cursor-pointer",o.gameEngine.isValidMove(i,r))("bg-gray-700",!o.gameEngine.isValidMove(i,r))("border-gray-600",!o.gameEngine.isValidMove(i,r))("bg-blue-900",i===0&&r===0)("bg-red-900",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-4",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-blue-400",i===0&&r===0)("border-red-400",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-2",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-blue-300",i===0&&r===0&&o.gameEngine.baseDeployActive())("ring-red-300",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&i<=2&&r<=2&&(i!==0||r!==0))("forest-area",o.gameEngine.isForest(i,r))("mine-area",o.gameEngine.isMine(i,r))("forge-area",o.gameEngine.isForge(i,r))("bg-amber-900",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(i,r))("border-gray-800",!o.gameEngine.isVisibleToPlayer(i,r))("bg-green-900",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("border-green-500",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("bg-cyan-900",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("border-cyan-500",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("animate-pulse",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("hover:bg-gray-600",!o.gameEngine.isValidMove(i,r))("hover:bg-green-800",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("hover:bg-cyan-800",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r)),Ut("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0456\u0437\u043D\u0430 \u0448\u0430\u0445\u0442\u0430: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +2 \u0437\u0430\u043B\u0456\u0437\u0430 \u0437\u0430 \u0445\u0456\u0434.":"Iron Mine: Requires 5 consecutive turns of occupation to activate. Once active, yields +2 Iron per turn.":null)("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u041B\u0456\u0441\u043E\u043F\u0438\u043B\u044C\u043D\u044F: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 2 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +8 \u0434\u0435\u0440\u0435\u0432\u0438\u043D\u0438 \u0437\u0430 \u0445\u0456\u0434.":"Sawmill: Requires 2 consecutive occupation turns to activate. Once activated, it gives +8 wood per turn.":null),m(2),Mt(" ",i,",",r," "),m(),J(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(i,r)?3:-1),m(),J(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(i,r)?4:-1),m(),Uu(o.gameEngine.getUnitAt(i,r)),m(),J(o.gameEngine.buildMode()&&o.gameEngine.canBuildForgeAt(i,r)?6:-1),m(),J(o.gameEngine.isForgeSite(i,r)?7:-1),m(),J(o.gameEngine.isForge(i,r)?8:-1),m(),J(o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?9:-1),m(),J(o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?10:-1),m(),J(o.gameEngine.isForest(i,r)&&o.gameEngine.getUnitAt(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?11:-1),m(),J(i===0&&r===0?12:-1),m(),J(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1?13:-1),m(),J(i<o.gameEngine.gridSize-1?14:-1),m(),J(r<o.gameEngine.gridSize-1?15:-1),m(),J((t=o.gameEngine.getUnitAt(i,r))?16:-1,t),m(),In(o.gameEngine.getCombatTextEntriesAt(i,r))}}function FW(n,e){if(n&1&&Sn(0,OW,19,80,"div",256,Rr),n&2){let t=P();In(t.gameEngine.gridCols)}}function LW(n,e){n&1&&W(0,"app-game-rules")}function VW(n,e){if(n&1&&(v(0,"div",361),y(1),_()),n&2){let t=P(2);m(),j(t.settings.t("NOT_LOGS_DATA"))}}function UW(n,e){if(n&1&&(v(0,"div",363)(1,"span",364),y(2),_()()),n&2){let t=e.$implicit;et("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Ae("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),m(),fE(t.color),m(),j(t.text)}}function BW(n,e){if(n&1){let t=$e();v(0,"div",229)(1,"button",346),X("click",function(){ee(t);let r=P();return te(r.gameEngine.toggleLog())}),v(2,"span",347),y(3,"\u2715"),_()(),v(4,"div",348)(5,"div",349)(6,"h3",350),y(7),_(),v(8,"button",351),X("click",function(){ee(t);let r=P();return te(r.gameEngine.clearLogs())}),ie(),v(9,"svg",352),W(10,"path",353),_(),y(11),_()(),ke(),v(12,"label",354)(13,"div",109)(14,"input",355),X("change",function(){ee(t);let r=P();return te(r.gameEngine.toggleCombatOnly())}),_(),W(15,"div",356),ie(),v(16,"svg",357),W(17,"path",358),_()(),ke(),v(18,"span",359),y(19),_()()(),v(20,"div",360),Q(21,VW,2,1,"div",361),Sn(22,UW,3,7,"div",362,Lu),_()()}if(n&2){let t=P();m(7),V(" ",t.settings.t("Action_LOG")," "),m(4),V(" ",t.settings.t("CLEAR")," "),m(3),Ce("checked",t.gameEngine.combatOnly()),m(5),V(" ",t.settings.t("COMBAT_ONLY")," "),m(2),J(t.gameEngine.logsFiltered().length===0?21:-1),m(),In(t.gameEngine.logsFiltered().reverse())}}function jW(n,e){if(n&1){let t=$e();v(0,"button",381),X("click",function(){let r=ee(t).$implicit,o=P(2);return te(o.onDifficultyChange(r))}),v(1,"span",382),y(2),_(),y(3),_()}if(n&2){let t=e.$implicit,i=P(2);Ae("bg-blue-500/20",i.settings.difficulty()===t)("border-blue-400/40",i.settings.difficulty()===t)("text-blue-200",i.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",i.settings.difficulty()===t)("bg-white/5",i.settings.difficulty()!==t)("border-white/5",i.settings.difficulty()!==t)("text-stone-500",i.settings.difficulty()!==t)("hover:bg-white/10",i.settings.difficulty()!==t),m(),Ae("opacity-100",i.settings.difficulty()===t),m(),V(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),m(),V(" ",i.settings.t(i.settings.getDifficultyLabel(t))," ")}}function HW(n,e){if(n&1){let t=$e();v(0,"button",383),X("click",function(){let r=ee(t).$implicit,o=P(2);return te(o.onMapSizeChange(r))}),y(1),_()}if(n&2){let t=e.$implicit,i=P(2);Ae("bg-gradient-to-br",i.settings.mapSize()===t)("from-indigo-600",i.settings.mapSize()===t)("to-indigo-800",i.settings.mapSize()===t)("text-white",i.settings.mapSize()===t)("shadow-lg",i.settings.mapSize()===t)("text-stone-500",i.settings.mapSize()!==t)("hover:text-stone-300",i.settings.mapSize()!==t),m(),Mt(" ",t,"x",t," ")}}function GW(n,e){if(n&1){let t=$e();v(0,"div",230)(1,"div",365),W(2,"div",366),v(3,"h3",367),y(4),_(),v(5,"button",368),X("click",function(){ee(t);let r=P();return te(r.gameEngine.toggleSettings())}),y(6," \u2716 "),_()(),v(7,"div",369)(8,"div",190)(9,"label",370),y(10),_(),v(11,"span",371),y(12),_()(),v(13,"div",372),Sn(14,jW,4,20,"button",373,Rr),_()(),v(16,"div",369)(17,"label",374),y(18),_(),v(19,"div",375),Sn(20,HW,2,16,"button",376,Rr),_()(),v(22,"div",377)(23,"button",378),X("click",function(){ee(t);let r=P();return te(r.settings.setLang("uk"))}),y(24," UA "),_(),v(25,"button",378),X("click",function(){ee(t);let r=P();return te(r.settings.setLang("en"))}),y(26," EN "),_()(),v(27,"label",379)(28,"div",109)(29,"input",110),X("change",function(r){ee(t);let o=P();return te(o.setCustomMode(r.target.checked))}),_(),v(30,"div",380),W(31,"div",112),_()(),v(32,"span",113),y(33,"Custom Mode"),_()()()}if(n&2){let t=P();m(4),j(t.settings.t("SYSTEM_SETTINGS")),m(6),V(" ",t.settings.t("TACTICAL_DIFF")," "),m(2),V(" ",t.settings.t("LEVEL_SELECTION")," "),m(2),In(t.settings.diffArr),m(4),V(" ",t.settings.t("SECTOR_DIMENSIONS")," "),m(2),In(pa(13,bz)),m(3),Ae("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),m(2),Ae("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en"),m(4),Ce("checked",t.settings.customMode())}}function $W(n,e){if(n&1&&(v(0,"div",392)(1,"span"),y(2),Oi(3,"date"),_(),v(4,"span",396),y(5),_(),v(6,"span",397),y(7),_()()),n&2){let t=e.$implicit,i=P(2);m(2),j(nr(3,4,t.date,"yyyy-MM-dd HH:mm")),m(3),j(t.condition),m(2),Mt("",t.turns," ",i.settings.t("TURNS"))}}function zW(n,e){if(n&1&&(v(0,"div",393),y(1),_()),n&2){let t=P(2);m(),j(t.settings.t("NO_RECORDS_YET"))}}function WW(n,e){if(n&1&&(v(0,"div",392)(1,"span"),y(2),Oi(3,"date"),_(),v(4,"span",396),y(5),_(),v(6,"span",397),y(7),_()()),n&2){let t=e.$implicit,i=P(2);m(2),j(nr(3,4,t.date,"yyyy-MM-dd HH:mm")),m(3),j(t.condition),m(2),Mt("",t.turns," ",i.settings.t("TURNS"))}}function qW(n,e){if(n&1&&(v(0,"div",393),y(1),_()),n&2){let t=P(2);m(),j(t.settings.t("NO_RECORDS_YET"))}}function KW(n,e){if(n&1){let t=$e();v(0,"div",231)(1,"div",384)(2,"div",385)(3,"h2",386),y(4),_(),v(5,"button",387),X("click",function(){ee(t);let r=P();return te(r.gameEngine.closeHighScores())}),y(6," \u2716 "),_()(),v(7,"div",388),y(8),_(),v(9,"div",389)(10,"div",390)(11,"h3",391),y(12),_(),Sn(13,$W,8,7,"div",392,oO,!1,zW,2,1,"div",393),_(),v(16,"div",390)(17,"h3",394),y(18),_(),Sn(19,WW,8,7,"div",392,oO,!1,qW,2,1,"div",393),_()(),v(22,"div",395),y(23),_()()()}if(n&2){let t=P();m(4),j(t.settings.t("HIGH_SCORES")),m(4),cs(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),m(4),j(t.settings.t("TOP_3_PLAYER")),m(),In(t.gameEngine.getHighScoresForCurrentCombo().wins),m(5),j(t.settings.t("TOP_3_LOSES_PLAYER")),m(),In(t.gameEngine.getHighScoresForCurrentCombo().losses),m(4),j(t.settings.t("CHANGE_RECORDS_INFO"))}}function YW(n,e){if(n&1){let t=$e();v(0,"div",232)(1,"div",398),y(2," Debug Mode "),_(),v(3,"button",399),X("click",function(){ee(t);let r=P();return te(r.gameEngine.debugInstantWin())}),y(4," \u26A1 Instant Win "),_(),v(5,"button",400),X("click",function(){ee(t);let r=P();return te(r.gameEngine.debugCycleSettings())}),y(6," \u{1F504} Cycle Settings "),_(),v(7,"div",401),y(8),_()()}if(n&2){let t=P();m(8),Mt(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var _0=class n{constructor(e,t,i,r){this.gameEngine=e;this.settings=t;this.firebase=i;this.router=r}boardContainer;isAutoBattleActive=$(!1);isMobileMenuOpen=$(!1);lastEconomyProcessedTurn=-1;ngOnInit(){this.gameEngine.resetGame()}ngOnDestroy(){this.isAutoBattleActive.set(!1),this.gameEngine.pauseGame()}goToHub(){this.isAutoBattleActive.set(!1),this.router.navigate(["/"])}get isProduction(){return!fM()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}centerOnSelectedUnit(){let e=this.boardContainer?.nativeElement;if(!e)return;let t=this.gameEngine.selectedUnit();if(!t)return;let i=this.gameEngine.tileSizePx,r=this.gameEngine.wallThicknessPx+2,o=i+r,s=t.position.x*o+i/2,a=t.position.y*o+i/2,l=Math.max(0,Math.min(s-e.clientWidth/2,e.scrollWidth-e.clientWidth)),c=Math.max(0,Math.min(a-e.clientHeight/2,e.scrollHeight-e.clientHeight));e.scrollTo({left:l,top:c,behavior:"smooth"})}activeKeys=new Set;onKeyDown(e){if(this.gameEngine.gameStatus()!=="playing")return;let t=e.key;if(t==="Tab"||t===" "||e.code==="Space"){e.preventDefault(),this.gameEngine.isPlayerTurn()&&this.gameEngine.selectNextAvailableUnitTab();return}if(t==="Enter"){e.preventDefault(),this.gameEngine.endPlayerTurn();return}let i=this.gameEngine.selectedUnit();if(!i||i.hasActed)return;this.activeKeys.add(t);let r=0,o=0;if((this.activeKeys.has("ArrowUp")||this.activeKeys.has("w")||this.activeKeys.has("W"))&&(o-=1),(this.activeKeys.has("ArrowDown")||this.activeKeys.has("s")||this.activeKeys.has("S"))&&(o+=1),(this.activeKeys.has("ArrowLeft")||this.activeKeys.has("a")||this.activeKeys.has("A"))&&(r-=1),(this.activeKeys.has("ArrowRight")||this.activeKeys.has("d")||this.activeKeys.has("D"))&&(r+=1),r===0&&o===0)return;e.preventDefault();let s=this.gameEngine.validMoves(),l=r!==0&&o!==0?i.tier===4?3:1:i.tier>=3||i.tier===2?2:1,c=null;for(let d=1;d<=l;d++){let h=i.position.x+r*d,f=i.position.y+o*d,g={x:h,y:f};if(s.some(x=>x.x===h&&x.y===f))c=g;else break}if(!c){let d={x:i.position.x,y:i.position.y},h={x:i.position.x+r,y:i.position.y+o};if(this.gameEngine.getWallBetween(d.x,d.y,h.x,h.y)){this.gameEngine.attackOrDestroyWallBetween(d,h);return}let g=this.gameEngine.getUnitAt(h.x,h.y);if(g&&g.owner!==i.owner){this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.isValidMove(h.x,h.y)&&this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.moveSelectedUnit(c)}onKeyUp(e){this.activeKeys.delete(e.key)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.settings.customMode()&&this.gameEngine.sandboxSpawnPending()){this.gameEngine.getUnitAt(e,t)||this.gameEngine.spawnSandboxAt({x:e,y:t});return}if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let i=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}let r=this.gameEngine.selectedUnit();if(r){let o=e-r.position.x,s=t-r.position.y;if(Math.abs(o)+Math.abs(s)===1&&this.gameEngine.getWallBetween(r.position.x,r.position.y,e,t)){this.gameEngine.attackOrDestroyWallBetween(r.position,{x:e,y:t});return}}if(i&&i.owner==="player"){this.gameEngine.selectUnit(i.id);return}this.gameEngine.selectUnit(null)}setCustomMode(e){this.settings.setCustomMode(e),this.gameEngine.resetGame()}onEdgeClick(e,t,i,r,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,i,r,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onDestroyIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:i},{x:r,y:o})}onBuildIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onAttackIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(r=>setTimeout(r,250)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.turn();this.lastEconomyProcessedTurn!==e&&(this.gameEngine.botEconomyPhase("player"),this.lastEconomyProcessedTurn=e),this.gameEngine.playerAutoStep()||this.gameEngine.selectUnit(null),this.gameEngine.remainingActions()===0&&(await new Promise(r=>setTimeout(r,1e3)),this.isAutoBattleActive()&&this.gameEngine.isPlayerTurn()&&this.gameEngine.endPlayerTurn())}static \u0275fac=function(t){return new(t||n)(he(Gn),he(Et),he(Rn),he(wi))};static \u0275cmp=It({type:n,selectors:[["app-game"]],viewQuery:function(t,i){if(t&1&&Dl(Ez,5),t&2){let r;Al(r=Ml())&&(i.boardContainer=r.first)}},hostBindings:function(t,i){t&1&&X("keydown",function(o){return i.onKeyDown(o)},fa)("keyup",function(o){return i.onKeyUp(o)},fa)},decls:377,vars:124,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],["title","Return to Gaming Hub",1,"cursor-pointer","p-2","bg-slate-800/50","hover:bg-slate-700","border","border-slate-700/50","rounded-lg","transition-all","group/btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-slate-400","group-hover/btn:text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["d","M6 18 L10 12 L14 18 Z","fill","#9ca3af"],["cx","12","cy","10","r","3","fill","#6b7280"],[1,"hud-value","font-mono","text-sm","font-bold","text-slate-300"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-6xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],["width","24","height","24","viewBox","0 0 24 24"],[1,"font-mono","text-lg","font-bold","text-slate-300"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","roadmap","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto","no-select"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"flex","items-center","justify-between","w-full","gap-2","z-10","text-amber-200"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","mine-area","forge-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click","mouseenter","mouseleave"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"z-index"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","-translate-x-4","translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"click"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none"],[1,"absolute","text-[10px]","font-bold","px-1","rounded","bg-yellow-300/80","text-black","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90",3,"z-index"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90"],["viewBox","0 0 128 128",1,"w-full","h-full"],["transform","translate(0,10) scale(1)"],["x","20","y","80","width","88","height","18","rx","4","fill","#6b7280"],["x","30","y","70","width","68","height","12","rx","3","fill","#9ca3af"],["d","M32 40 H96 L86 56 H42 Z","fill","#4b5563"],["x","56","y","30","width","16","height","12","rx","2","fill","#6b7280"],["x","60","y","20","width","8","height","12","rx","2","fill","#9ca3af"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer",3,"click"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer",3,"click"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],["cx","64","cy","96","rx","40","ry","10","fill","#374151"],["d","M32 96 L56 48 L72 80 L96 96 Z","fill","#6b7280","stroke","#4b5563","stroke-width","4"],["cx","58","cy","60","r","6","fill","#9ca3af"],["transform","translate(82, 30) rotate(-20) scale(1.3)"],["width","4","height","30","rx","2","fill","#6b7280"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#f59e0b","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none","move-anim",3,"shake","transform","z-index"],[1,"pointer-events-none","move-anim"],[1,"unit-svg-wrapper"],[3,"unit"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow",3,"bg-green-600","bg-amber-600","bg-red-600","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-left-1","opacity-70","[style.z-index]='100'"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"mt-3","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-pink-500","peer-checked:border-pink-500","transition-all"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,i){if(t&1){let r=$e();v(0,"div",2)(1,"div",3),W(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),_(),ie(),v(7,"svg",9)(8,"defs")(9,"radialGradient",10),W(10,"stop",11)(11,"stop",12)(12,"stop",13),_(),v(13,"radialGradient",14),W(14,"stop",15)(15,"stop",16)(16,"stop",17),_(),v(17,"radialGradient",18),W(18,"stop",19)(19,"stop",20)(20,"stop",21),_(),v(21,"linearGradient",22),W(22,"stop",23)(23,"stop",24),_(),v(24,"filter",25),W(25,"feDropShadow",26),_()()(),v(26,"svg",27)(27,"defs")(28,"clipPath",28),W(29,"path",29),_(),v(30,"symbol",30),W(31,"path",31),_()()(),ke(),v(32,"div",32)(33,"button",33),X("click",function(){return ee(r),te(i.goToHub())}),ie(),v(34,"svg",34),W(35,"path",35),_()(),ke(),v(36,"div",36),W(37,"div",37)(38,"div",38),ie(),v(39,"svg",39),W(40,"path",40)(41,"rect",41),_(),ke(),W(42,"div",42)(43,"div",43),_(),v(44,"div",44)(45,"div",45)(46,"h1",46)(47,"span",47),y(48,"Shape"),_(),v(49,"span",48),y(50," Tactics "),_()(),v(51,"div",49),W(52,"div",50)(53,"div",51),_()(),v(54,"div",52)(55,"span",53),y(56),_()()(),W(57,"div",54),_(),v(58,"div",55)(59,"div",56)(60,"button",57),X("click",function(){return ee(r),te(i.gameEngine.resetGame())}),ie(),v(61,"svg",58),W(62,"path",59),_(),ke(),v(63,"span",60),y(64),_()(),W(65,"div",61),v(66,"button",62),X("click",function(){return ee(r),te(i.gameEngine.toggleRules())}),ie(),v(67,"svg",63),W(68,"path",64),_(),ke(),v(69,"span",65),y(70),_()()(),v(71,"div",66)(72,"button",67),X("click",function(){return ee(r),te(i.gameEngine.toggleHighScores())}),ie(),v(73,"svg",68),W(74,"path",69),_(),ke(),v(75,"span",70),y(76),_()(),v(77,"button",71),X("click",function(){return ee(r),te(i.gameEngine.toggleLeaderboard())}),ie(),v(78,"svg",68),W(79,"path",72),_(),ke(),v(80,"span",70),y(81),_()(),v(82,"button",73),X("click",function(){return ee(r),te(i.gameEngine.toggleLog())}),ie(),v(83,"svg",68),W(84,"path",74),_(),ke(),v(85,"span",70),y(86),_()(),v(87,"button",75),X("click",function(){return ee(r),te(i.navigateToFeedback())}),ie(),v(88,"svg",68),W(89,"path",76),_(),ke(),v(90,"span",70),y(91),_()()(),v(92,"div",77)(93,"button",78),X("click",function(){return ee(r),te(i.gameEngine.toggleSettings())}),ie(),v(94,"svg",79),W(95,"path",80)(96,"path",81),_()(),Q(97,xz,9,3,"div",82)(98,Sz,4,1,"button",83),_()(),ke(),v(99,"div",84)(100,"div",85),ie(),v(101,"svg",86),W(102,"rect",87)(103,"circle",88),_(),ke(),v(104,"span",89),y(105),_()(),v(106,"div",85),ie(),v(107,"svg",86),W(108,"path",90)(109,"circle",91),_(),ke(),v(110,"span",92),y(111),_()(),v(112,"div",85),ie(),v(113,"svg",86),W(114,"polygon",93),_(),ke(),v(115,"span",94),y(116),_()(),v(117,"div",85),ie(),v(118,"svg",86),W(119,"circle",95)(120,"path",96),_(),ke(),v(121,"span",97),y(122),_()(),v(123,"div",85),ie(),v(124,"svg",86),W(125,"path",98)(126,"rect",99)(127,"rect",100),_(),ke(),v(128,"span",101),y(129),_()(),v(130,"button",102),X("click",function(){return ee(r),te(i.toggleMobileMenu())}),ie(),v(131,"svg",103),W(132,"path",104),_()()(),ke(),v(133,"div",105)(134,"button",106),X("click",function(){return ee(r),te(i.gameEngine.toggleBuildMode())}),ie(),v(135,"svg",86),W(136,"path",107),_()(),ke(),v(137,"button",106),X("click",function(){return ee(r),te(i.gameEngine.convertWoodToReserve())}),y(138," +1 "),_(),v(139,"button",106),X("click",function(){return ee(r),te(i.gameEngine.maxConvertWoodToReserve())}),y(140),_(),v(141,"label",108)(142,"div",109)(143,"input",110),X("change",function(){return ee(r),te(i.gameEngine.toggleFogDebug())}),_(),v(144,"div",111),W(145,"div",112),_()(),v(146,"span",113),y(147),_()(),v(148,"div",114),y(149),_(),v(150,"button",115),X("click",function(){return ee(r),te(i.gameEngine.endPlayerTurn())}),ie(),v(151,"svg",116),W(152,"path",117)(153,"path",118),_()()(),Q(154,Cz,23,9,"div",119),ke(),v(155,"div",120),W(156,"div",121),v(157,"div",122)(158,"div",123)(159,"span",124),y(160),_(),v(161,"span",125),y(162),_()(),W(163,"div",126),v(164,"div",127)(165,"div",128)(166,"span",129),ie(),v(167,"svg",130),W(168,"rect",87)(169,"circle",131)(170,"circle",132)(171,"rect",133)(172,"circle",134)(173,"circle",135),_()(),ke(),v(174,"span",136),y(175),_()(),v(176,"div",128)(177,"span",129),ie(),v(178,"svg",137),W(179,"path",90)(180,"circle",91),_()(),ke(),v(181,"span",138),y(182),_()(),v(183,"div",139)(184,"span",129)(185,"div",140),ie(),v(186,"svg",141),W(187,"polygon",142)(188,"rect",143)(189,"polygon",144)(190,"rect",145)(191,"polygon",146)(192,"rect",147),v(193,"g",148),W(194,"rect",149)(195,"polygon",150),_(),v(196,"g",151),W(197,"rect",152)(198,"circle",153)(199,"circle",154),_()()()(),ke(),v(200,"span",155),y(201),v(202,"span",156),y(203,"/"),_(),y(204),_()()()(),v(205,"div",157),W(206,"div",158),v(207,"span",159),y(208),_(),v(209,"div",45)(210,"span",160),y(211),_()(),Q(212,Dz,2,3,"div",161),_(),v(213,"div",122)(214,"div",127)(215,"div",128)(216,"span",162),y(217),_(),v(218,"span",129),ie(),v(219,"svg",130),W(220,"rect",87)(221,"circle",131)(222,"circle",132)(223,"rect",133)(224,"circle",134)(225,"circle",135),_()()(),ke(),v(226,"div",128)(227,"span",129),ie(),v(228,"svg",137),W(229,"path",90)(230,"circle",91),_()(),ke(),v(231,"span",138),y(232),_()(),v(233,"div",163)(234,"span",164),y(235),v(236,"span",156),y(237,"/"),_(),y(238),_(),v(239,"span",129)(240,"div",140),ie(),v(241,"svg",141),W(242,"polygon",142)(243,"rect",143)(244,"polygon",144)(245,"rect",145)(246,"polygon",146)(247,"rect",147),v(248,"g",148),W(249,"rect",149)(250,"polygon",165),_(),v(251,"g",151),W(252,"rect",152)(253,"circle",153)(254,"circle",154),_()()()()()(),ke(),W(255,"div",126),v(256,"div",166)(257,"span",167),y(258),_(),v(259,"span",168),y(260,"jaerbi"),_()()()(),Q(261,Rz,11,11,"div",169),v(262,"button",170),X("click",function(){return ee(r),te(i.navigateToRoadmap())}),v(263,"div",171),W(264,"div",172),v(265,"span",173),y(266),_()(),v(267,"div",174),ie(),v(268,"svg",175),W(269,"path",176),_()()(),ke(),v(270,"button",177),X("click",function(){return ee(r),te(i.gameEngine.toggleSupport())}),v(271,"span",129),y(272,"\u2764\uFE0F"),_(),v(273,"span",178),y(274),_()(),Q(275,Nz,1,0,"app-support-community"),Q(276,Pz,1,0,"app-leaderboard-modal"),v(277,"div",179),Q(278,kz,1,0,"app-sandbox"),v(279,"div",180,0)(281,"div",181)(282,"div",182)(283,"span",183),y(284),_()(),Q(285,Oz,3,1,"div",184),Sn(286,FW,2,0,null,null,Rr),_()(),v(288,"div",185)(289,"div",186),W(290,"div",187),v(291,"div",188)(292,"span",189),y(293),_(),v(294,"div",190)(295,"span",191),y(296),_(),v(297,"div",192)(298,"span",129),y(299),_()()(),v(300,"div",193),W(301,"div",194),_()()()(),v(302,"div",195)(303,"div",196)(304,"button",197),X("click",function(){return ee(r),te(i.toggleAutoBattle())}),v(305,"div",198)(306,"span",199),y(307),_(),v(308,"span",200),y(309),_()(),v(310,"div",198),W(311,"span",201),_(),W(312,"div",202),_(),v(313,"button",203),X("click",function(){return ee(r),te(i.gameEngine.toggleBuildMode())}),v(314,"div",204)(315,"span",205),y(316,"+1"),_(),v(317,"div",206),ie(),v(318,"svg",207),W(319,"path",208)(320,"path",209)(321,"path",210)(322,"rect",211),_()()(),ke(),v(323,"div",212)(324,"span"),y(325,"-10"),_(),v(326,"div",213),ie(),v(327,"svg",214),W(328,"rect",215)(329,"circle",216)(330,"circle",217),_()()(),ke(),W(331,"div",202),_(),v(332,"button",218),X("click",function(){return ee(r),te(i.gameEngine.convertWoodToReserve())}),v(333,"div",219)(334,"span",220)(335,"span"),y(336,"20"),_(),v(337,"div",213),ie(),v(338,"svg",214),W(339,"rect",215)(340,"circle",216)(341,"circle",217),_()()(),ke(),v(342,"span",129),y(343,"\u2794"),_(),v(344,"span",221),y(345,"1 \u{1F464}"),_()()(),v(346,"button",222),X("click",function(){return ee(r),te(i.gameEngine.maxConvertWoodToReserve())}),v(347,"div",223)(348,"span",224),y(349),_(),v(350,"span",129),y(351,"\u2794"),_(),v(352,"span",129),y(353,"\u{1F465}++"),_()()()(),v(354,"label",225)(355,"div",109)(356,"input",110),X("change",function(){return ee(r),te(i.gameEngine.toggleFogDebug())}),_(),v(357,"div",111),W(358,"div",112),_()(),v(359,"span",113),y(360),_()(),v(361,"button",226),X("click",function(){return ee(r),te(i.gameEngine.endPlayerTurn())}),v(362,"div",227)(363,"span",224),y(364),_(),ie(),v(365,"svg",116),W(366,"path",117)(367,"path",118),_()()(),ke(),v(368,"div",114),y(369),_()()(),v(370,"div",228),y(371),_(),Q(372,LW,1,0,"app-game-rules"),Q(373,BW,24,5,"div",229),Q(374,GW,34,14,"div",230),Q(375,KW,24,9,"div",231),Q(376,YW,9,2,"div",232),_()}if(t&2){let r;m(56),j(i.settings.version),m(8),V(" ",i.settings.t("RELOAD")," "),m(6),V(" ",i.settings.t("INFO")," "),m(6),j(i.settings.t("RECORDS")),m(5),j(i.settings.t("RANKING")),m(5),j(i.settings.t("SYSTEM_LOG")),m(5),j(i.settings.t("FEEDBACK_MODULE")),m(6),J((r=i.firebase.user$())?97:98,r),m(8),j(i.gameEngine.resources().wood),m(6),j(i.gameEngine.resources().iron),m(5),Mt(" ",i.gameEngine.getForestControl().player,"/",i.gameEngine.getForestControl().total," "),m(6),j(i.gameEngine.turn()),m(7),Mt(" ",i.gameEngine.getForestControl().player," : ",i.gameEngine.getForestControl().ai," "),m(5),Ce("disabled",!i.gameEngine.canBuildThisTurn()),m(3),Ce("disabled",!i.gameEngine.canAddReserveTurn()),m(2),Ce("disabled",!i.gameEngine.canAddReserveTurn()),m(),V(" ",i.settings.t("ALL")," "),m(3),Ce("checked",i.gameEngine.fogDebugDisabled()),m(4),j(i.settings.t("MAP_HACK")),m(2),Mt(" ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),m(5),J(i.isMobileMenuOpen()?154:-1),m(6),V(" ",i.settings.t("COMMANDER")," "),m(2),V(" ",i.settings.t("PLAYER")," "),m(3),Ut("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),m(10),j(i.gameEngine.resources().wood),m(),Ut("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),m(6),j(i.gameEngine.resources().iron),m(),Ut("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),m(18),V(" ",i.gameEngine.getForestControl().player," "),m(3),V(" ",i.gameEngine.getForestControl().total," "),m(4),V(" ",i.settings.t("TURN_CYCLE")," "),m(3),V(" ",i.gameEngine.turn()," "),m(),J(i.gameEngine.monopolyTurnsLeft()>0?212:-1),m(3),Ut("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),m(2),j(i.gameEngine.aiWood()),m(9),Ut("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),m(6),j(i.gameEngine.aiIron()),m(),Ut("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),m(2),V(" ",i.gameEngine.getForestControl().ai," "),m(3),V(" ",i.gameEngine.getForestControl().total," "),m(20),V(" ",i.settings.t("HOSTILE")," "),m(3),J(i.gameEngine.shouldShowEndOverlay()?261:-1),m(5),V(" ",i.settings.t("STRATEGIC_PLAN")," "),m(8),j(i.settings.t("SUPPORT")),m(),J(i.gameEngine.supportOpen()?275:-1),m(),J(i.gameEngine.leaderboardOpen()?276:-1),m(2),J(i.settings.customMode()?278:-1),m(),Ae("shake",i.gameEngine.screenShake())("mood-none",i.gameEngine.currentMood()==="none")("mood-angry",i.gameEngine.currentMood()==="angry")("mood-rage",i.gameEngine.currentMood()==="rage"),m(2),et("grid-template-columns","repeat("+i.gameEngine.gridSize+", minmax("+i.gameEngine.tileMinSizePx+"px, "+i.gameEngine.tileSizePx+"px))")("gap",i.gameEngine.wallThicknessPx+2,"px"),m(3),V(" ",i.gameEngine.baseHealth().player," "),m(),J(i.gameEngine.isVisibleToPlayer(i.gameEngine.gridSize-1,i.gameEngine.gridSize-1)?285:-1),m(),In(i.gameEngine.gridRows),m(4),Ae("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),m(3),j(i.settings.t("RISK")),m(2),Ae("text-lime-300",i.settings.difficulty()==="baby")("text-emerald-300",i.settings.difficulty()==="normal")("text-orange-400",i.settings.difficulty()==="hard")("text-red-500",i.settings.difficulty()==="nightmare"),m(),V(" ",i.settings.t(i.settings.getDifficultyLabel(i.settings.difficulty()))," "),m(3),V(" ",i.settings.difficulty()==="baby"?"\u{1F476}":i.settings.difficulty()==="normal"?"\u{1F920}":i.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),m(2),et("width",i.settings.difficulty()==="baby"?25:i.settings.difficulty()==="normal"?50:i.settings.difficulty()==="hard"?75:100,"%"),Ae("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),m(3),Ae("ring-2",i.isAutoBattleActive())("ring-green-400",i.isAutoBattleActive()),Ce("disabled",i.gameEngine.gameStatus()!=="playing"),m(3),j(i.settings.t("AUTO")),m(2),j(i.settings.t("ENGAGE")),m(2),Ae("bg-green-400",i.isAutoBattleActive())("bg-gray-500",!i.isAutoBattleActive()),m(2),Ae("ring-2",i.gameEngine.buildMode())("ring-blue-400",i.gameEngine.buildMode()),Ce("disabled",i.gameEngine.wallBuiltThisTurn()||!i.gameEngine.canBuildThisTurn()),m(19),Ce("disabled",!i.gameEngine.canAddReserveTurn()),m(14),Ce("disabled",!i.gameEngine.canAddReserveTurn()),m(3),j(i.settings.t("ALL")),m(7),Ce("checked",i.gameEngine.fogDebugDisabled()),m(4),j(i.settings.t("MAP_HACK")),m(4),j(i.settings.t("NEXT_TURN")),m(5),cs(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),m(2),V(" ",i.settings.version," | \xA9\uFE0E Created by jaerbi and just "),m(),J(i.gameEngine.rulesOpen()?372:-1),m(),J(i.gameEngine.logOpen()?373:-1),m(),J(i.gameEngine.settingsOpen()?374:-1),m(),J(i.gameEngine.highScoresOpen()?375:-1),m(),J(i.isProduction?-1:376)}},dependencies:[Pt,g0,xc,m0,y0,v0,BE,va],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}.move-anim[_ngcontent-%COMP%]{transition:transform .15s cubic-bezier(.4,0,.2,1);will-change:transform}"]})};var pO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(he(ss),he(ki))};static \u0275dir=vn({type:n})}return n})(),QW=(()=>{class n extends pO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275dir=vn({type:n,features:[Mr]})}return n})(),gO=new we("");var JW={provide:gO,useExisting:Xo(()=>C0),multi:!0};function XW(){let n=Fi()?Fi().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var ZW=new we(""),C0=(()=>{class n extends pO{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!XW())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(he(ss),he(ki),he(ZW,8))};static \u0275dir=vn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&X("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Bu([JW]),Mr]})}return n})();function Bx(n){return n==null||jx(n)===0}function jx(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var mO=new we(""),yO=new we(""),eq=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Uo=class{static min(e){return tq(e)}static max(e){return nq(e)}static required(e){return iq(e)}static requiredTrue(e){return rq(e)}static email(e){return oq(e)}static minLength(e){return sq(e)}static maxLength(e){return aq(e)}static pattern(e){return lq(e)}static nullValidator(e){return vO()}static compose(e){return SO(e)}static composeAsync(e){return TO(e)}};function tq(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function nq(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function iq(n){return Bx(n.value)?{required:!0}:null}function rq(n){return n.value===!0?null:{required:!0}}function oq(n){return Bx(n.value)||eq.test(n.value)?null:{email:!0}}function sq(n){return e=>{let t=e.value?.length??jx(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function aq(n){return e=>{let t=e.value?.length??jx(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function lq(n){if(!n)return vO;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(Bx(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function vO(n){return null}function _O(n){return n!=null}function EO(n){return as(n)?ln(n):n}function bO(n){let e={};return n.forEach(t=>{e=t!=null?F(F({},e),t):e}),Object.keys(e).length===0?null:e}function wO(n,e){return e.map(t=>t(n))}function cq(n){return!n.validate}function xO(n){return n.map(e=>cq(e)?e:t=>e.validate(t))}function SO(n){if(!n)return null;let e=n.filter(_O);return e.length==0?null:function(t){return bO(wO(t,e))}}function IO(n){return n!=null?SO(xO(n)):null}function TO(n){if(!n)return null;let e=n.filter(_O);return e.length==0?null:function(t){let i=wO(t,e).map(EO);return xy(i).pipe(yt(bO))}}function CO(n){return n!=null?TO(xO(n)):null}function sO(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function DO(n){return n._rawValidators}function AO(n){return n._rawAsyncValidators}function Fx(n){return n?Array.isArray(n)?n:[n]:[]}function b0(n,e){return Array.isArray(n)?n.includes(e):n===e}function aO(n,e){let t=Fx(e);return Fx(n).forEach(r=>{b0(t,r)||t.push(r)}),t}function lO(n,e){return Fx(e).filter(t=>!b0(n,t))}var w0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=IO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=CO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Tc=class extends w0{name;get formDirective(){return null}get path(){return null}},gh=class extends w0{_parent=null;name=null;valueAccessor=null},x0=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var MO=(()=>{class n extends x0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(he(gh,2))};static \u0275dir=vn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Ae("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Mr]})}return n})(),RO=(()=>{class n extends x0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(he(Tc,10))};static \u0275dir=vn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Ae("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Mr]})}return n})();var dh="VALID",E0="INVALID",Sc="PENDING",hh="DISABLED",Rs=class{},S0=class extends Rs{value;source;constructor(e,t){super(),this.value=e,this.source=t}},fh=class extends Rs{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},ph=class extends Rs{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Ic=class extends Rs{status;source;constructor(e,t){super(),this.status=e,this.source=t}},Lx=class extends Rs{source;constructor(e){super(),this.source=e}},mh=class extends Rs{source;constructor(e){super(),this.source=e}};function Hx(n){return(D0(n)?n.validators:n)||null}function uq(n){return Array.isArray(n)?IO(n):n||null}function Gx(n,e){return(D0(e)?e.asyncValidators:n)||null}function dq(n){return Array.isArray(n)?CO(n):n||null}function D0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function NO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new me(1e3,"");if(!i[t])throw new me(1001,"")}function PO(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new me(1002,"")})}var Cc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return un(this.statusReactive)}set status(e){un(()=>this.statusReactive.set(e))}_status=ni(()=>this.statusReactive());statusReactive=$(void 0);get valid(){return this.status===dh}get invalid(){return this.status===E0}get pending(){return this.status==Sc}get disabled(){return this.status===hh}get enabled(){return this.status!==hh}errors;get pristine(){return un(this.pristineReactive)}set pristine(e){un(()=>this.pristineReactive.set(e))}_pristine=ni(()=>this.pristineReactive());pristineReactive=$(!0);get dirty(){return!this.pristine}get touched(){return un(this.touchedReactive)}set touched(e){un(()=>this.touchedReactive.set(e))}_touched=ni(()=>this.touchedReactive());touchedReactive=$(!1);get untouched(){return!this.touched}_events=new jt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(aO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(aO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(lO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(lO(e,this._rawAsyncValidators))}hasValidator(e){return b0(this._rawValidators,e)}hasAsyncValidator(e){return b0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ce(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new ph(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new ph(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ce(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new fh(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new fh(!0,i))}markAsPending(e={}){this.status=Sc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ic(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ce(F({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=hh,this.errors=null,this._forEachChild(r=>{r.disable(ce(F({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new S0(this.value,i)),this._events.next(new Ic(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ce(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=dh,this._forEachChild(i=>{i.enable(ce(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ce(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===dh||this.status===Sc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new S0(this.value,t)),this._events.next(new Ic(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ce(F({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?hh:dh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Sc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=EO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new Ic(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new cn,this.statusChanges=new cn}_calculateStatus(){return this._allControlsDisabled()?hh:this.errors?E0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Sc)?Sc:this._anyControlsHaveStatus(E0)?E0:dh}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new fh(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new ph(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){D0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=uq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=dq(this._rawAsyncValidators)}},Dc=class extends Cc{constructor(e,t,i){super(Hx(t),Gx(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){PO(this,!0,e),Object.keys(e).forEach(i=>{NO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,ce(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new mh(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Vx=class extends Dc{};var kO=new we("",{factory:()=>$x}),$x="always";function hq(n,e){return[...e.path,n]}function cO(n,e,t=$x){zx(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),pq(n,e),mq(n,e),gq(n,e),fq(n,e)}function uO(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),T0(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function I0(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function fq(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function zx(n,e){let t=DO(n);e.validator!==null?n.setValidators(sO(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=AO(n);e.asyncValidator!==null?n.setAsyncValidators(sO(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();I0(e._rawValidators,r),I0(e._rawAsyncValidators,r)}function T0(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=DO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=AO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return I0(e._rawValidators,i),I0(e._rawAsyncValidators,i),t}function pq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&OO(n,e)})}function gq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&OO(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function OO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function mq(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function yq(n,e){n==null,zx(n,e)}function vq(n,e){return T0(n,e)}function _q(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function Eq(n){return Object.getPrototypeOf(n.constructor)===QW}function bq(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function wq(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===C0?t=o:Eq(o)?i=o:r=o}),r||i||t||null}function xq(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function dO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function hO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var qa=class extends Cc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(Hx(t),Gx(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),D0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(hO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new mh(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){dO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){dO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){hO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Sq=n=>n instanceof qa;var FO=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=vn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var Ux=class extends Cc{constructor(e,t,i){super(Hx(t),Gx(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){PO(this,!1,e),e.forEach((i,r)=>{NO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],ce(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new mh(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var Iq=(()=>{class n extends Tc{callSetDisabledState;get submitted(){return un(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=ni(()=>this._submittedReactive());_submittedReactive=$(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(T0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let i=this.form.get(t.path);return cO(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){uO(t.control||null,t,!1),xq(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,i){this.form.get(t.path).setValue(i)}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,bq(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Lx(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(uO(i||null,t),Sq(r)&&(cO(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);yq(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&vq(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){zx(this.form,this),this._oldForm&&T0(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(i){return new(i||n)(he(mO,10),he(yO,10),he(kO,8))};static \u0275dir=vn({type:n,features:[Mr,ao]})}return n})();var LO=new we("");var Tq={provide:gh,useExisting:Xo(()=>Wx)},Wx=(()=>{class n extends gh{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new cn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=wq(this,o)}ngOnChanges(t){this._added||this._setUpControl(),_q(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return hq(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(he(Tc,13),he(mO,10),he(yO,10),he(gO,10),he(LO,8))};static \u0275dir=vn({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Bu([Tq]),Mr,ao]})}return n})();var Cq={provide:Tc,useExisting:Xo(()=>qx)},qx=(()=>{class n extends Iq{form=null;ngSubmit=new cn;get control(){return this.form}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275dir=vn({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&X("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Bu([Cq]),Mr]})}return n})();var Dq=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=co({type:n});static \u0275inj=_r({})}return n})();function fO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var VO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return fO(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Dc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new Vx(r,i)}control(t,i,r){let o={};return this.useNonNullable?(fO(i)?o=i:(o.validators=i,o.asyncValidators=r),new qa(t,ce(F({},o),{nonNullable:!0}))):new qa(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new Ux(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof qa)return t;if(t instanceof Cc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var UO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:LO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:kO,useValue:t.callSetDisabledState??$x}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=co({type:n});static \u0275inj=_r({imports:[Dq]})}return n})();var A0=class n{db;auth;constructor(){let e=wd(p0);this.db=Yd(e),this.auth=uh(e)}async addFeedback(e){let t=ce(F({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:Xd()});await th(si(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=zr(si(this.db,"feedbacks"),Ii("timestamp","desc"),ko(e));return(await Oo(t)).docs.map(r=>r.data())}async getFeedbackPage(e,t){let i=[Ii("timestamp","desc"),ko(e)],r=t?zr(si(this.db,"feedbacks"),Ii("timestamp","desc"),lk(t),ko(e)):zr(si(this.db,"feedbacks"),Ii("timestamp","desc"),ko(e)),o=await Oo(r),s=o.docs.map(l=>l.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),i=zr(si(this.db,"feedbacks"),Po("userId","==",e),Po("timestamp",">=",t)),o=(await Oo(i)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var Kx=()=>[1,2,3,4,5],BO=(n,e)=>e.timestamp;function Rq(n,e){if(n&1){let t=$e();v(0,"button",39),X("click",function(){let r=ee(t).$implicit,o=P(2);return te(o.setRating(r))}),y(1," \u2605 "),_()}if(n&2){let t=e.$implicit,i=P(2);Ae("active",i.form.value.rating>=t)}}function Nq(n,e){if(n&1&&(v(0,"div",36),y(1),_()),n&2){let t=P(2);m(),j(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function Pq(n,e){n&1&&(v(0,"div",37),y(1),_()),n&2&&(m(),j(e))}function kq(n,e){if(n&1){let t=$e();v(0,"div",25)(1,"div",26),W(2,"img",27),_(),v(3,"div",28)(4,"div",29),y(5),_(),v(6,"div",30),y(7),_()()(),v(8,"form",31),X("ngSubmit",function(){ee(t);let r=P();return te(r.submit())}),v(9,"div")(10,"div",32),y(11),_(),v(12,"div",33),Sn(13,Rq,2,2,"button",34,Rr),_()(),v(15,"div")(16,"div",32),y(17),_(),W(18,"textarea",35),Q(19,Nq,2,1,"div",36),Q(20,Pq,2,1,"div",37),_(),v(21,"button",38),y(22),_()()}if(n&2){let t,i=e,r=P();m(2),Ce("src",i.photoURL,er),m(3),j(i.displayName),m(2),j(r.settings.t("OPERATOR_ONLINE")),m(),Ce("formGroup",r.form),m(3),j(r.settings.t("EFFICIENCY_RATING")),m(2),In(pa(16,Kx)),m(4),j(r.settings.t("TACTICAL_NOTE")),m(),Ce("placeholder",gE(r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),m(),J(r.form.controls.text.errors?19:-1),m(),J((t=r.message())?20:-1,t),m(),Ae("cursor-pointer",r.canSubmit)("cursor-not-allowed",!r.canSubmit),Ce("disabled",!r.canSubmit),m(),V(" ",r.settings.t("TRANSMIT_REPORT")," ")}}function Oq(n,e){if(n&1&&(v(0,"div",21),y(1),_()),n&2){let t=P();m(),j(t.settings.t("SYSTEM_LOG"))}}function Fq(n,e){if(n&1&&(v(0,"div",22),y(1),_()),n&2){let t=P();m(),j(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function Lq(n,e){if(n&1&&(v(0,"span"),y(1,"\u2605"),_()),n&2){let t=e.$implicit,i=P().$implicit;Ae("active",i.rating>=t)}}function Vq(n,e){if(n&1&&(v(0,"tr",44)(1,"td",47),W(2,"img",48),v(3,"span"),y(4),_()(),v(5,"td",49)(6,"div",50),Sn(7,Lq,2,2,"span",51,Rr),_()(),v(9,"td",49)(10,"span",52),y(11),_()(),v(12,"td",49)(13,"span",53),y(14),_()()()),n&2){let t=e.$implicit,i=P(2);m(2),Ce("src",t.userPhoto,er),m(2),j(t.userName),m(3),In(pa(4,Kx)),m(4),j(t.text),m(3),j(i.formatDate(t.timestamp))}}function Uq(n,e){if(n&1&&(v(0,"tr")(1,"td",54),y(2),_()()),n&2){let t=P(2);m(2),j(t.settings.t("NO_SIGNALS"))}}function Bq(n,e){if(n&1){let t=$e();v(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),y(5),_(),v(6,"th",43),y(7),_(),v(8,"th",43),y(9),_(),v(10,"th",43),y(11),_()()(),v(12,"tbody"),Sn(13,Vq,15,5,"tr",44,BO,!1,Uq,3,1,"tr"),_()()(),v(16,"div",45)(17,"button",46),X("click",function(){ee(t);let r=P();return te(r.prevPage())}),y(18),_(),v(19,"button",46),X("click",function(){ee(t);let r=P();return te(r.nextPage())}),y(20),_()()}if(n&2){let t=P();m(5),j(t.settings.t("TABLE_OPERATOR")),m(2),j(t.settings.t("TABLE_RATING")),m(2),j(t.settings.t("TABLE_MESSAGE")),m(2),j(t.settings.t("TABLE_DATE")),m(2),In(t.pageItems()),m(5),V(" ",t.settings.t("PREVIOUS")," "),m(2),V(" ",t.settings.t("NEXT")," ")}}function jq(n,e){if(n&1&&(v(0,"span"),y(1,"\u2605"),_()),n&2){let t=e.$implicit,i=P().$implicit;Ae("active",i.rating>=t)}}function Hq(n,e){if(n&1&&(v(0,"div",55)(1,"div",56)(2,"div",57),W(3,"img",58),v(4,"div",59),y(5),_()(),v(6,"div",50),Sn(7,jq,2,2,"span",51,Rr),_()(),v(9,"div",60),y(10),_()()),n&2){let t=e.$implicit;m(3),Ce("src",t.userPhoto,er),m(2),j(t.userName),m(2),In(pa(3,Kx)),m(3),j(t.text)}}function Gq(n,e){if(n&1&&Sn(0,Hq,11,4,"div",55,BO),n&2){let t=P();In(t.recent())}}var M0=class n{constructor(e,t,i,r,o){this.fb=e;this.router=t;this.feedback=i;this.firebase=r;this.settings=o;this.form=new Dc({text:new qa("",{nonNullable:!0,validators:[Uo.required,Uo.minLength(10),Uo.maxLength(500)]}),rating:new qa(5,{nonNullable:!0,validators:[Uo.required,Uo.min(1),Uo.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,l=Number(localStorage.getItem(a)||0);this.disabledUntil.set(l)}this.loadPage(0)}recent=$([]);pageItems=$([]);pageStack=[null];pageIndex=$(0);lastDoc=null;disabledUntil=$(0);message=$(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);if(this.pageItems.set(r.items),this.lastDoc=r.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);this.pageItems.set(r.items),this.lastDoc=r.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:i}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let r=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:r.text||"",rating:Number(r.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(he(VO),he(wi),he(A0),he(Rn),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,i){if(t&1&&(v(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),_(),ie(),v(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),_()()(),ke(),v(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),y(15),_(),v(16,"span",14),y(17),_()(),v(18,"a",15),y(19),_()(),v(20,"div",16)(21,"div",17)(22,"div",18),y(23),_(),Q(24,kq,23,17),_(),v(25,"div",19)(26,"div",20),Q(27,Oq,2,1,"div",21),Q(28,Fq,2,1,"div",22),v(29,"button",23),X("click",function(){return i.isAllShow=!i.isAllShow}),y(30),_()(),v(31,"div",24),Q(32,Bq,21,7),Q(33,Gq,2,0),_()()()()()),t&2){let r;m(15),j(i.settings.t("FEEDBACK_MODULE")),m(2),j(i.settings.t("COMMUNITY_SIGNALS")),m(2),j(i.settings.t("RETURN_TO_MAP")),m(4),j(i.settings.t("DEPLOY_REPORT")),m(),J((r=i.firebase.user$())?24:-1,r),m(3),J(i.isAllShow?-1:27),m(),J(i.isAllShow?28:-1),m(2),V(" ",i.isAllShow?i.settings.t("TOGGLE_BACK"):i.settings.t("VIEW_FULL_ARCHIVE")," "),m(2),J(i.isAllShow?32:-1),m(),J(i.isAllShow?-1:33)}},dependencies:[Pt,UO,FO,C0,MO,RO,qx,Wx,Or],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var R0=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(he(Et))};static \u0275cmp=It({type:n,selectors:[["app-roadmap"]],decls:93,vars:13,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"absolute","top-0","right-0","w-16","h-16","bg-emerald-500/10","blur-2xl","-mr-8","-mt-8"],[1,"card-header","relative","z-10"],[1,"text-[11px]","font-mono","text-emerald-200/50","italic"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","uppercase","tracking-wider","bg-emerald-500/20","text-emerald-400","border","border-emerald-500/40"],[1,"flex","items-start","gap-4","mt-4","relative","z-10"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/60","rotate-45","flex","items-center","justify-center","group-hover:rotate-180","transition-all","duration-700","shadow-[0_0_15px_rgba(16,185,129,0.2)]"],[1,"-rotate-45","group-hover:-rotate-180","transition-all","duration-700","text-xl"],[1,"text-lg","font-bold","text-emerald-50","leading-tight","mb-2","opacity-80","decoration-emerald-500/30","line-through","decoration-2"],[1,"text-sm","text-emerald-100/40","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-emerald-500/10","flex","justify-between","items-center","relative","z-10"],[1,"text-[9px]","uppercase","tracking-widest","text-emerald-500/40","font-bold"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-emerald-500","shadow-[0_0_5px_#10b981]"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,i){t&1&&(v(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),_(),ie(),v(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),_()()(),ke(),W(11,"div",10)(12,"div",11),v(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),W(17,"div",16),v(18,"h1",17),y(19),_()(),v(20,"p",18),y(21,"Future_Ops // Deployment_Schedule"),_()(),v(22,"a",19)(23,"span",20),y(24,"\xAB"),_(),y(25),_()(),v(26,"div",21)(27,"div",22),W(28,"div",23),v(29,"div",24)(30,"span",25),y(31,"REF: PROJECT_VOLUMETRIC"),_(),v(32,"span",26),y(33),_()(),v(34,"div",27)(35,"div",28)(36,"div",29),y(37),_()(),v(38,"div")(39,"h3",30),y(40),_(),v(41,"p",31),y(42),_()()(),v(43,"div",32)(44,"span",33),y(45,"System_Verified"),_(),v(46,"div",34),W(47,"div",35)(48,"div",35)(49,"div",35),_()()(),v(50,"div",22)(51,"div",36)(52,"span",37),y(53,"REF: RESOURCE_IRON"),_(),v(54,"span",26),y(55),_()(),v(56,"div",38)(57,"div",39)(58,"span"),y(59,"\u26D3\uFE0F"),_()(),v(60,"div")(61,"h3",40),y(62),_(),v(63,"p",41),y(64),_()()(),v(65,"div",42)(66,"span",43),y(67,"Priority_Beta"),_(),v(68,"div",34),W(69,"div",44)(70,"div",45)(71,"div",45),_()()(),v(72,"div",46)(73,"div",36)(74,"span",37),y(75,"REF: INFRA_SMITHY"),_(),v(76,"span",26),y(77),_()(),v(78,"div",47)(79,"div",48),W(80,"div",49),v(81,"span",50),y(82,"\u2692\uFE0F"),_()(),v(83,"div")(84,"h3",51),y(85),_(),v(86,"p",52),y(87),_()()()()(),v(88,"div",53)(89,"div",54),y(90,"Community_Intel"),_(),v(91,"p",55),y(92),_()()()()),t&2&&(m(19),V(" ",i.settings.t("STRATEGIC_PLAN")," "),m(6),V(" ",i.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),m(8),V(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),m(4),V(" ",i.settings.currentLang()==="uk"?"\u2714\uFE0F":"\u2705"," "),m(3),V(" ",i.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"," "),m(2),V(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),m(13),V(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),m(7),j(i.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),m(2),V(" ",i.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),m(13),V(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),m(8),j(i.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),m(2),V(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),m(5),V(" ",i.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[Pt,Or],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var N0=class n{constructor(e,t){this.router=e;this.settings=t}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||n)(he(wi),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-landing-page"]],decls:41,vars:7,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden","relative"],[1,"absolute","top-1/4","-left-1/4","w-96","h-96","bg-emerald-500/20","rounded-full","blur-3xl","animate-pulse"],[1,"absolute","bottom-1/4","-right-1/4","w-96","h-96","bg-purple-500/20","rounded-full","blur-3xl","animate-pulse",2,"animation-delay","1ms"],[1,"z-10","text-center","mb-12"],[1,"text-6xl","font-black","tracking-tighter","mb-4","bg-gradient-to-r","from-emerald-400","to-cyan-400","bg-clip-text","text-transparent","drop-shadow-sm"],[1,"text-slate-400","text-lg","max-w-md","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","w-full","max-w-5xl","z-10"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-emerald-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-emerald-400","hover:shadow-[0_0_40px_-10px_rgba(52,211,153,0.3)]","text-left",3,"click"],[1,"absolute","top-0","right-0","p-4","opacity-10","group-hover:opacity-20","transition-opacity"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24"],["d","M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.8L19.5 8 12 11.2 4.5 8 12 4.8zM4 15.5v-5.2l7 3.1v5.2l-7-3.1zm9 3.1v-5.2l7-3.1v5.2l-7 3.1z"],[1,"relative","z-20"],[1,"inline-block","px-3","py-1","bg-emerald-500/10","text-emerald-400","text-xs","font-bold","rounded-full","mb-4","border","border-emerald-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-emerald-50"],[1,"text-slate-400","leading-relaxed","mb-6"],[1,"flex","items-center","text-emerald-400","font-bold","group-hover:translate-x-2","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-purple-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-purple-400","hover:shadow-[0_0_40px_-10px_rgba(168,85,247,0.3)]","text-left",3,"click"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"inline-block","px-3","py-1","bg-purple-500/10","text-purple-400","text-xs","font-bold","rounded-full","mb-4","border","border-purple-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-purple-50"],[1,"flex","items-center","text-purple-400","font-bold","group-hover:translate-x-2","transition-transform"],[1,"absolute","bottom-6","text-slate-500","text-sm","font-medium","uppercase","tracking-widest"]],template:function(t,i){t&1&&(D(0,"div",0),G(1,"div",1)(2,"div",2),D(3,"div",3)(4,"h1",4),y(5),A(),D(6,"p",5),y(7),A()(),D(8,"div",6)(9,"button",7),Ht("click",function(){return i.navigateTo("shape-tactics")}),D(10,"div",8),ie(),D(11,"svg",9),G(12,"path",10),A()(),ke(),D(13,"div",11)(14,"span",12),y(15),A(),D(16,"h2",13),y(17,"Shape Tactics"),A(),D(18,"p",14),y(19),A(),D(20,"div",15),y(21," ENTER PORTAL "),ie(),D(22,"svg",16),G(23,"path",17),A()()()(),ke(),D(24,"button",18),Ht("click",function(){return i.navigateTo("tower-defense")}),D(25,"div",8),ie(),D(26,"svg",9),G(27,"path",19),A()(),ke(),D(28,"div",11)(29,"span",20),y(30),A(),D(31,"h2",21),y(32,"Shape Defense"),A(),D(33,"p",14),y(34),A(),D(35,"div",22),y(36," DEFEND BASE "),ie(),D(37,"svg",16),G(38,"path",17),A()()()()(),ke(),D(39,"footer",23),y(40),A()()),t&2&&(m(5),V(" ",i.settings.currentLang()==="uk"?"\u0406\u0413\u0420\u041E\u0412\u0418\u0419 \u0426\u0415\u041D\u0422\u0420":"GAMING HUB"," "),m(2),V(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043E\u0440\u0442\u0430\u043B, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0441\u0432\u043E\u044E \u043F\u043E\u0434\u043E\u0440\u043E\u0436.":"Select a portal to begin your journey."," "),m(8),V(" ","Live Now"," "),m(4),V(" ",i.settings.t("SHAPE_TACTIC_DESCRIPTION")," "),m(11),V(" ",i.settings.currentLang()==="uk"?"\u0413\u0420\u0410\u0422\u0418 \u0417\u0410\u0420\u0410\u0417":"PLAY NOW"," "),m(4),V(" ",i.settings.t("TOWER_DEFFENCE_DESCRIPTION")," "),m(6),V(" \xA9 2026 Shape Tactics Labs // ",i.settings.version," "))},dependencies:[Pt],styles:["[_nghost-%COMP%]{display:block}"]})};var P0=class n{constructor(e,t){this.ngZone=e;this.firebase=t;this.initGame()}money=$(100);lives=$(20);wave=$(0);isWaveInProgress=$(!1);gameOver=$(!1);gridSize=20;grid=$([]);path=$([]);tileSize=62;enemies=$([]);projectiles=$([]);gameSpeedMultiplier=$(1);nextWaveEnemyType=$("standard");isHardMode=$(!1);enemiesInternal=[];projectilesInternal=[];towersInternal=[];infernoZones=[];enemyIdCounter=1;projectileIdCounter=1;uiTick$=new jt;animationFrameId=null;lastUpdateTime=0;enemiesToSpawn=0;currentWaveEnemyCount=0;spawnTimer=0;spawnInterval=1e3;currentWaveType="standard";towerCosts=[15,50,250,1e3,1300,1700,2e3];tierStats=[{damage:5,range:2,fireInterval:.5},{damage:20,range:2.5,fireInterval:.7},{damage:80,range:3,fireInterval:1},{damage:300,range:3.5,fireInterval:1.2},{damage:80,range:2.5,fireInterval:2},{damage:23,range:3,fireInterval:.3},{damage:60,range:2.5,fireInterval:1.2}];savedResult=!1;gameEndedHard=!1;async saveResultIfLoggedIn(){let e=this.firebase.user$();if(!e)return;let t=this.gridSize===20?"20x20":"10x10",i={userId:e.uid,displayName:e.displayName||"Anonymous",maxWave:this.wave(),totalMoney:this.money(),mapSize:t};try{await this.firebase.saveTowerDefenseScore(i)}catch{}}dispose(){this.stopGameLoop(),this.enemiesInternal=[],this.projectilesInternal=[],this.towersInternal=[],this.infernoZones=[],this.enemiesToSpawn=0,this.currentWaveEnemyCount=0,this.spawnTimer=0,this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!1),this.savedResult=!1,this.gameEndedHard=!1,this.money.set(100),this.lives.set(100),this.wave.set(0);let e=this.grid();if(e&&e.length){let t=e.map(i=>i.map(r=>r.tower?ce(F({},r),{tower:null}):r));this.grid.set(t)}}resetEngine(){this.initializeGame(1)}initGame(){this.initializeGame(1)}resetGame(){this.initializeGame(1)}generateMap(){let e=this.generateRandomPath();this.path.set(e);let t=[];this.towersInternal=[];let i=new Set(e.map(r=>`${r.x},${r.y}`));for(let r=0;r<this.gridSize;r++){let o=[];for(let s=0;s<this.gridSize;s++){let a="void";i.has(`${s},${r}`)?a="path":[{x:s-1,y:r},{x:s+1,y:r},{x:s,y:r-1},{x:s,y:r+1}].some(c=>i.has(`${c.x},${c.y}`))&&(a="buildable"),o.push({x:s,y:r,type:a,tower:null})}t.push(o)}this.grid.set(t)}initializeGame(e){this.gridSize=e===2?20:10,this.gridSize===10?this.tileSize=62:this.gridSize===20?this.tileSize=32:this.tileSize=32,this.dispose(),this.generateMap(),this.nextWaveEnemyType.set(this.determineWaveType(1));let t=this.getGoldMasteryLevel();if(t>=8){let i=(t-7)*20;this.money.set(100+i)}}determineWaveType(e){if(e<=2)return"standard";if(e<=8)return Math.random()<.5?"scout":"standard";let t=Math.random();return t<.2?"tank":t<.41?"scout":"standard"}getGoldMasteryLevel(){let e=this.firebase.masteryProfile(),t=e&&e.upgrades?e.upgrades.gold_mastery:0;return typeof t=="number"?t:0}getGoldKillMultiplier(){let e=this.getGoldMasteryLevel();if(e<=0)return 1;let t=Math.min(e,7),i=Math.max(0,Math.min(e-7,7)),r=Math.max(0,e-14);return 1+(t*.05+i*.1+r*.15)}generateRandomPath(){let e=this.gridSize,t=e*e,i=Math.floor(t*.35),r=Math.floor(t*.4),o=1e3,s=I=>`${I.x},${I.y}`,a=(I,w)=>I>=0&&w>=0&&I<e&&w<e,l=(I,w)=>I+Math.floor(Math.random()*(w-I+1)),c=l(0,e-1),d=l(0,e-1),h={x:0,y:c},f={x:e-1,y:d},g=()=>{let I=[],w=h.x,N=h.y;I.push({x:w,y:N});let M=f.x>w?1:-1;for(let be=0;be<o&&w!==f.x;be++)w+=M,I.push({x:w,y:N});let ae=f.y>N?1:-1;for(let be=0;be<o&&N!==f.y;be++)N+=ae,I.push({x:w,y:N});return I},x=new Set,S=[],R=0,L=(I,w,N)=>{if(!a(I,w))return!1;let M=s({x:I,y:w});if(x.has(M))return!1;let ae=[{x:I+1,y:w},{x:I-1,y:w},{x:I,y:w+1},{x:I,y:w-1}];for(let be of ae){if(!a(be.x,be.y))continue;let de=s(be);if(x.has(de)&&!(be.x===N.x&&be.y===N.y))return!1}return!0},q=F({},h);S.push(q),x.add(s(q));let ye=Math.floor(e/3),_e=Math.floor(2*e/3),xe=Math.floor(e/2),Ie={x:ye,y:l(0,Math.max(0,xe-1))},O={x:_e,y:l(xe,e-1)},T=[Ie,O,f],k=I=>{for(let w=0;w<o&&q.x!==I.x;w++){if(R++,R>o||S.length>=r)return;let N=I.x>q.x?1:-1,M=q.x+N,ae=q.y;if(!L(M,ae,q))break;let be={x:M,y:ae};S.push(be),x.add(s(be)),q=be}for(let w=0;w<o&&q.y!==I.y;w++){if(R++,R>o||S.length>=r)return;let N=I.y>q.y?1:-1,M=q.x,ae=q.y+N;if(!L(M,ae,q))break;let be={x:M,y:ae};S.push(be),x.add(s(be)),q=be}};for(let I=0;I<T.length;I++){if(R++,R>o)return g();k(T[I])}if(S.length<i)for(let I=0;I<o&&S.length<i;I++){if(R++,R>o)return g();let w=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}],N=!1;for(let M=0;M<w.length;M++){let ae=w[M],be=q.x+ae.x,de=q.y+ae.y;if(!L(be,de,q))continue;let Tt={x:be,y:de};S.push(Tt),x.add(s(Tt)),q=Tt,N=!0;break}if(!N)break}return S.length===0?g():S}startWave(){if(this.isWaveInProgress()||this.gameOver())return;this.wave.update(t=>t+1),this.isWaveInProgress.set(!0),this.currentWaveType=this.nextWaveEnemyType(),this.nextWaveEnemyType.set(this.determineWaveType(this.wave()+1));let e=5+this.wave()*2;this.enemiesToSpawn=e,this.currentWaveEnemyCount=e,this.spawnTimer=0,this.startGameLoop()}startGameLoop(){this.stopGameLoop(),this.lastUpdateTime=performance.now(),this.ngZone.runOutsideAngular(()=>{let e=t=>{if(this.gameOver())return;let i=(t-this.lastUpdateTime)/1e3;this.lastUpdateTime=t;let r=Math.min(i,.05);this.updateGame(r),this.enemies.set([...this.enemiesInternal]),this.gameSpeedMultiplier()===1?this.projectiles.set([...this.projectilesInternal]):this.projectiles.set([]),this.uiTick$.next(),this.animationFrameId=requestAnimationFrame(e)};this.animationFrameId=requestAnimationFrame(e)})}stopGameLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateGame(e){if(this.gameEndedHard)return;let t=e*this.gameSpeedMultiplier();if(this.handleSpawning(t),this.updateEnemies(t),this.updateTowers(t),this.updateProjectiles(t),this.lives()<=0&&!this.gameOver()){if(this.enemiesInternal=[],this.projectilesInternal=[],this.enemiesToSpawn=0,this.stopGameLoop(),this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!0)}),!this.savedResult){this.savedResult=!0,this.saveResultIfLoggedIn();let i=this.wave(),r=0;if(i>=5){let o=i*1.5,s=i>20?(i-20)*2:0;r=Math.floor(o+s)}r>0&&this.firebase.awardTowerDefenseXp(r)}this.gameEndedHard=!0;return}if(this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&this.isWaveInProgress()){this.enemiesInternal=[],this.projectilesInternal=[],this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1)});let i=this.getGoldMasteryLevel();if(i>=15){let r=(i-14)*5;this.money.update(o=>o+r)}}}getUpgradeLevel(e,t){let i=this.firebase.masteryProfile();if(!i)return 0;let r=`t${e}_${t}`,o=i.upgrades?.[r];return typeof o=="number"?o:0}getProjectileSpeedMultiplierForTower(e){if(e.type===2){let t=this.getUpgradeLevel(2,"golden");if(t>0)return 1+.2*t}return 1}triggerInfernoChainReaction(e,t){if(this.getUpgradeLevel(5,"golden")<=0)return;let r=Math.floor(t*.5),o=2,s=o*o;for(let l of this.enemiesInternal){let c=e.x-l.position.x,d=e.y-l.position.y;c*c+d*d<=s&&this.applyDamageWithResists(l,r,5)}let a={id:"z"+this.projectileIdCounter++,position:F({},e),radius:o,remaining:.3,dps:0};this.infernoZones.push(a)}applyVenom(e,t){if(e.isSlime)return;let i=Math.min(3,(e.venomStacks??0)+1);e.venomStacks=i,e.venomDuration=4,e.venomTickTimer=0,t.specialActive&&(e.venomSlowActive=!0);let r=Math.max(e.venomBaseDamage??0,t.damage);e.venomBaseDamage=r}applyDamageWithResists(e,t,i){let r=t;(e.isMagma&&i===5||e.isMirror&&i===6||e.isSlime&&i===7)&&(r=Math.floor(r*.1)),e.hp-=r}handleSpawning(e){this.enemiesToSpawn<=0||(this.spawnTimer+=e*1e3,this.spawnTimer>=this.spawnInterval&&(this.spawnTimer=0,this.spawnEnemy(),this.enemiesToSpawn--))}spawnEnemy(){let e=50*Math.pow(1.2,this.wave()),t=.5+this.wave()*.05,i=this.currentWaveEnemyCount||5+this.wave()*2,r=i-this.enemiesToSpawn,o=this.wave()%5===0,s=r===i-1,a=o&&s,l=this.wave()*40%360,c=this.currentWaveType;a&&(c="boss");let d=e,h=t;c==="tank"?(d=e*2,h=t*.5):c==="scout"?(d=e*.4,h=t*2):c==="boss"&&(d=e*4,h=t*.5),this.isHardMode()&&(d*=1.5,h*=1.1);let f={id:"e"+this.enemyIdCounter++,position:F({},this.path()[0]),pathIndex:0,hp:d,maxHp:d,speed:h,progress:0,isBoss:a,hue:l,baseSpeed:t,speedModifier:1,shatterStacks:0,isFrozen:!1,type:c};if(this.wave()>=15){let g=Math.random();g<.2?f.isMagma=!0:g<.4?f.isMirror=!0:g<.6&&(f.isSlime=!0)}this.enemiesInternal.push(f)}updateEnemies(e){for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i];if(r.speedModifier=1,r.isFrozen=!1,r.burnedByInferno=!1,r.stunTime&&r.stunTime>0&&(r.stunTime=Math.max(0,r.stunTime-e)),r.prismVulnerableTime&&r.prismVulnerableTime>0&&(r.prismVulnerableTime=Math.max(0,r.prismVulnerableTime-e)),r.venomDuration&&r.venomDuration>0&&r.venomStacks&&r.venomStacks>0){r.venomDuration=Math.max(0,r.venomDuration-e),r.venomTickTimer=(r.venomTickTimer??0)+e;let o=r.venomBaseDamage??0;for(;r.venomTickTimer>=1&&r.venomDuration>0;){r.venomTickTimer-=1;let s=o*r.venomStacks;this.applyDamageWithResists(r,s,7)}r.venomDuration<=0&&(r.venomStacks=0,r.venomTickTimer=0),r.venomStacks&&r.venomStacks>0&&r.venomSlowActive&&(r.speedModifier*=.8)}}for(let i=this.infernoZones.length-1;i>=0;i--){let r=this.infernoZones[i];r.remaining-=e,r.remaining<=0&&this.infernoZones.splice(i,1)}this.applyFrostAuras();let t=this.tileSize;for(let i of this.infernoZones){let r=i.radius*i.radius;for(let o of this.enemiesInternal){let s=i.position.x-o.position.x,a=i.position.y-o.position.y;s*s+a*a<=r&&i.dps>0&&(o.hp-=i.dps*e,o.burnedByInferno=!0)}}for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i];if(r.stunTime&&r.stunTime>0){let R=this.path(),L=R[r.pathIndex],q=R[r.pathIndex+1]||L,ye=L.x+(q.x-L.x)*r.progress,_e=L.y+(q.y-L.y)*r.progress;r.displayX=(ye+.5)*t,r.displayY=(_e+.5)*t;continue}let o=r.baseSpeed,s=r.type==="tank"?.5:r.type==="scout"?2:r.type==="boss"?.5:1,a=o*s*r.speedModifier;if(r.progress+=a*e,r.progress>=1){if(r.pathIndex++,r.progress=0,r.pathIndex>=this.path().length-1){let R=r.type==="boss"?5:1;this.enemiesInternal.splice(i,1),this.ngZone.run(()=>this.lives.update(L=>Math.max(0,L-R))),this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&(this.currentWaveType="standard");continue}r.position=F({},this.path()[r.pathIndex])}let l=this.path(),c=l[r.pathIndex],d=l[r.pathIndex+1]||c,h=c.x+(d.x-c.x)*r.progress,f=c.y+(d.y-c.y)*r.progress;r.displayX=(h+.5)*t,r.displayY=(f+.5)*t;let x=60,S=1;if(r.type==="tank"?S=1.2:r.type==="scout"?S=.9:r.type==="boss"&&(S=1.6),r.scale=S,r.isFrozen?r.bg=`hsl(190, 80%, ${x}%)`:r.type==="tank"?r.bg="hsl(330, 70%, 60%)":r.type==="scout"?r.bg="hsl(50, 90%, 60%)":r.type==="boss"?r.bg=`hsl(${r.hue}, 90%, 65%)`:r.bg="hsl(200, 70%, 60%)",r.hp<=0){let R=!!r.burnedByInferno,L=F({},r.position),q=r.maxHp;this.enemiesInternal.splice(i,1),R&&this.triggerInfernoChainReaction(L,q);let ye=5+this.wave(),_e=this.getGoldKillMultiplier(),xe=Math.floor(ye*_e);this.isHardMode()&&(xe=Math.floor(xe*.8)),this.ngZone.run(()=>this.money.update(Ie=>Ie+xe))}}}updateTowers(e){if(!(this.enemiesInternal.length===0||this.towersInternal.length===0)){for(let t of this.towersInternal)if(t.cooldown-=e,t.cooldown<=0){let i=this.findTargetForTower(t,this.enemiesInternal);i?(t.targetEnemyId=i.id,this.fireAt(t,i),t.cooldown=t.fireInterval):(t.targetEnemyId=void 0,t.beamTime=0,t.lastBeamTargetId=void 0,t.extraTargetIds=void 0,t.cooldown=0)}}}applyFrostAuras(){if(this.enemiesInternal.length===0)return;let e=this.towersInternal.filter(l=>l.type===1&&l.specialActive);if(e.length===0)return;let t=this.getUpgradeLevel(1,"golden"),o=2*(1+t*.1),s=o*o,a=.7*(1-t*.05);for(let l of this.enemiesInternal){let c=!1;for(let d of e){let h=d.position.x-l.position.x,f=d.position.y-l.position.y;if(h*h+f*f<=s){c=!0;break}}c&&(l.speedModifier=a,l.isFrozen=!0)}}findTargetForTower(e,t){let i=e.range*e.range,r=[];for(let a of t){let l=e.position.x-a.position.x,c=e.position.y-a.position.y,d=l*l+c*c;if(d>i)continue;let h=a.pathIndex??0,f=a.progress??0,g=h+f;r.push({enemy:a,distSq:d,progressScore:g})}if(r.length===0)return null;let o=e.strategy||"first";if(o==="random"){let a=Math.floor(Math.random()*r.length);return r[a].enemy}if(o==="weakest"){let a=r[0];for(let l=1;l<r.length;l++)r[l].enemy.hp<a.enemy.hp&&(a=r[l]);return a.enemy}if(o==="strongest"){let a=r[0];for(let l=1;l<r.length;l++)r[l].enemy.hp>a.enemy.hp&&(a=r[l]);return a.enemy}let s=r[0];for(let a=1;a<r.length;a++)r[a].progressScore>s.progressScore&&(s=r[a]);return s.enemy}pushProjectile(e){this.projectilesInternal.length>=100&&this.projectilesInternal.shift(),this.projectilesInternal.push(e)}fireAt(e,t){if(e.type!==6){let r={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},t.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(r)}let i=e.damage;if(e.specialActive&&e.type===4&&t.hp/t.maxHp<.5){let o=t.isBoss?3:2;i=Math.floor(e.damage*o)}if(e.specialActive&&e.type===3){let r=Math.min(5,t.shatterStacks+1);t.shatterStacks=r;let o=1+r*.2;i=Math.floor(i*o)}if(e.type===6){let r=e.lastBeamTargetId===t.id,o=e.beamTime??0,s=r?o+e.fireInterval:e.fireInterval;e.beamTime=s,e.lastBeamTargetId=t.id;let l=this.getUpgradeLevel(6,"golden")>0?3:1,c=1+Math.min(l,s*.5);i=Math.floor(i*c)}if(t.prismVulnerableTime&&t.prismVulnerableTime>0&&(i=Math.floor(i*1.15)),e.type===5){let s=t.position;for(let a of this.enemiesInternal){let l=s.x-a.position.x,c=s.y-a.position.y;if(l*l+c*c<=2.25){let d=i;a.prismVulnerableTime&&a.prismVulnerableTime>0&&(d=Math.floor(d*1.15)),a.hp-=d,a.burnedByInferno=!0}}if(e.specialActive){let a={id:"z"+this.projectileIdCounter++,position:F({},s),radius:1.5,remaining:4,dps:e.damage*.5};this.infernoZones.push(a)}}else e.type===7?(this.applyVenom(t,e),this.applyDamageWithResists(t,i,e.type)):(e.type!==6||!e.specialActive)&&this.applyDamageWithResists(t,i,e.type);if(e.type===3){let r=this.getUpgradeLevel(3,"golden");if(r>0){let o=.15+r*.05;if(Math.random()<o){let s=(.5+r*.2)*1.2;t.stunTime=Math.max(t.stunTime??0,s)}}}if(e.specialActive&&e.type===2){let r=this.getUpgradeLevel(2,"golden"),o=.25+r*.05,s=1.5+r*.2;if(Math.random()<o){let a=[];for(let l of this.enemiesInternal){if(l.id===t.id||l.hp<=0)continue;let c=t.position.x-l.position.x,d=t.position.y-l.position.y,h=c*c+d*d;h<=9&&a.push({enemy:l,distSq:h})}if(a.length>0){a.sort((c,d)=>c.distSq-d.distSq);let l=Math.min(2,a.length);for(let c=0;c<l;c++){let d=a[c].enemy,h={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},d.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(h);let f=Math.floor(e.damage*s);this.applyDamageWithResists(d,f,e.type)}}}}if(e.specialActive&&e.type===6){let r=this.getUpgradeLevel(6,"golden"),o=e.lastBeamTargetId===t.id,s=e.beamTime??0,a=r>0?3:1,l=1+Math.min(a,s*.5),c=Math.floor(e.damage*l),d=[t];if(o){let f=e.range*e.range,g=[];for(let x of this.enemiesInternal){if(x.id===t.id||x.hp<=0)continue;let S=e.position.x-x.position.x,R=e.position.y-x.position.y,L=S*S+R*R;L<=f&&g.push({enemy:x,distSq:L})}if(g.length>0){g.sort((S,R)=>S.distSq-R.distSq);let x=Math.min(2,g.length);e.extraTargetIds=[];for(let S=0;S<x;S++){let R=g[S].enemy;d.push(R),e.extraTargetIds.push(R.id)}}}let h=r>0;for(let f of d){let g=c;f.prismVulnerableTime&&f.prismVulnerableTime>0&&(g=Math.floor(g*1.15)),this.applyDamageWithResists(f,g,e.type),h&&(f.prismVulnerableTime=Math.max(f.prismVulnerableTime??0,.25))}}if(e.type===4){let r=this.getUpgradeLevel(4,"golden");if(r>0){let o=.1;if(r===2?o=.15:r>=3&&(o=.2),Math.random()<o){let s=null,a=1/0;for(let l of this.enemiesInternal){if(l.id===t.id||l.hp<=0)continue;let c=t.position.x-l.position.x,d=t.position.y-l.position.y,h=Math.sqrt(c*c+d*d);h<=3&&h<a&&(a=h,s=l)}if(s){let l={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},s.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(l);let c=e.damage;if(e.specialActive&&s.hp/s.maxHp<.5){let h=s.isBoss?3:2;c=Math.floor(e.damage*h)}s.prismVulnerableTime&&s.prismVulnerableTime>0&&(c=Math.floor(c*1.15)),this.applyDamageWithResists(s,c,e.type)}}}}}updateProjectiles(e){for(let t=this.projectilesInternal.length-1;t>=0;t--){let i=this.projectilesInternal[t],r=i.speedMultiplier??1;i.progress+=5*r*e,i.progress>=1&&this.projectilesInternal.splice(t,1)}}buyTower(e,t,i){let r=this.towerCosts[i-1];this.money()<r||this.grid.update(o=>{let s=o[t][e];if(s.type==="buildable"&&!s.tower){let a=this.tierStats[i-1],l=this.getUpgradeLevel(i,"damage"),c=this.getUpgradeLevel(i,"range"),d=this.getUpgradeLevel(i,"golden"),h=1+l*.05,f=c*.1;s.tower={id:crypto.randomUUID(),type:i,level:1,position:{x:e,y:t},baseCost:r,invested:r,damage:Math.floor(a.damage*h),range:a.range+f,fireInterval:a.fireInterval,cooldown:0,specialActive:!1,strategy:"first",hasGolden:d>0},this.towersInternal.push(s.tower),this.money.update(g=>g-r)}return[...o]})}upgradeTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level<4){let o=this.getUpgradeCost(r.tower);this.money()>=o&&(r.tower.level++,r.tower.damage=Math.floor(r.tower.damage*1.3),r.tower.range+=.5,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i]})}getUpgradeCost(e){let t=.5;switch(e.level){case 1:t=.5;break;case 2:t=.6;break;case 3:t=.7;break}return Math.floor(e.baseCost*t)}getSpecialCost(e){return e.baseCost*4}buyAbility(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level===4&&!r.tower.specialActive){let o=this.getSpecialCost(r.tower);this.money()>=o&&(r.tower.specialActive=!0,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i.map(o=>[...o])]})}setTowerStrategy(e,t,i){this.grid.update(r=>{let o=r[t];if(!o)return r;let s=o[e];return s&&s.tower&&(s.tower.strategy=i),[...r]})}sellTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower){let o=r.tower.invested??r.tower.baseCost,s=Math.floor(o*.5),a=r.tower.id;r.tower=null,this.money.update(c=>c+s);let l=this.towersInternal.findIndex(c=>c.id===a);l!==-1&&this.towersInternal.splice(l,1)}return[...i]})}getEnemiesRef(){return this.enemiesInternal}getProjectilesRef(){return this.projectilesInternal}getTowersRef(){return this.towersInternal}getInfernoZonesRef(){return this.infernoZones}getPathRef(){return this.path()}getGridRef(){return this.grid()}static \u0275fac=function(t){return new(t||n)(Ne(yn),Ne(Rn))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})};var zq=["gameCanvas"],Wq=(n,e,t)=>({"shape-circle":n,"shape-triangle":e,"shape-square":t});function qq(n,e){if(n&1){let t=$e();Rl(0),v(1,"button",44),X("click",function(){ee(t);let r=Nr(0),o=P(3);return te(o.buyTower(r))}),v(2,"div",45)(3,"span",46),y(4),_(),v(5,"span"),y(6),_()(),v(7,"span",47),y(8),_()()}if(n&2){let t=e.$implicit,i=e.$index,r=P(3),o=Uu(i+1);m(),Ae("bg-slate-700",r.tdEngine.money()>=t)("hover:bg-slate-600",r.tdEngine.money()>=t)("bg-slate-900",r.tdEngine.money()<t),Ce("disabled",r.tdEngine.money()<t),m(3),V("T",o),m(2),Mt("",r.settings.t("TIER")," ",o),m(2),V("$",t)}}function Kq(n,e){if(n&1&&(v(0,"h3",41),y(1),_(),v(2,"div",42),Sn(3,qq,9,12,"button",43,Lu),_()),n&2){let t=P(2);m(),V(" ",t.settings.t("BUY_DEFENDER")," "),m(2),In(t.tdEngine.towerCosts)}}function Yq(n,e){if(n&1){let t=$e();v(0,"button",65),X("click",function(){ee(t);let r=P(3);return te(r.upgradeTower())}),v(1,"span"),y(2),_(),v(3,"span",66),y(4),_()()}if(n&2){let t=P(2),i=P();Ce("disabled",i.tdEngine.money()<i.tdEngine.getUpgradeCost(t.tower)),m(2),j(i.settings.t("UPGRADE")),m(2),V("$",i.tdEngine.getUpgradeCost(t.tower))}}function Qq(n,e){if(n&1&&(v(0,"div",63),y(1),_()),n&2){let t=P(3);m(),V(" ",t.settings.t("MAX_LEVEL")," ")}}function Jq(n,e){if(n&1&&(v(0,"span",66),y(1),_()),n&2){let t=P(3),i=P();m(),V("$",i.tdEngine.getSpecialCost(t.tower))}}function Xq(n,e){if(n&1&&(v(0,"div",69),y(1),_(),v(2,"div",70),y(3),_()),n&2){let t=P(4);m(),V(" ",t.settings.t("FROST_AURA")," "),m(2),V(" ",t.settings.t("FROST_AURA_INFO")," ")}}function Zq(n,e){if(n&1&&(v(0,"div",71),y(1),_(),v(2,"div",70),y(3),_()),n&2){let t=P(4);m(),V(" ",t.settings.t("CHAIN_LIGHTNING")," "),m(2),V(" ",t.settings.t("CHAIN_LIGHTNING_INFO")," ")}}function eK(n,e){if(n&1&&(v(0,"div",72),y(1),_(),v(2,"div",70),y(3),_()),n&2){let t=P(4);m(),V(" ",t.settings.t("SHATTER")," "),m(2),V(" ",t.settings.t("SHATTER_INFO")," ")}}function tK(n,e){if(n&1&&(v(0,"div",73),y(1),_(),v(2,"div",70),y(3),_()),n&2){let t=P(4);m(),V(" ",t.settings.t("FINAL_STRIKE")," "),m(2),V(" ",t.settings.t("FINAL_STRIKE_INFO")," ")}}function nK(n,e){if(n&1&&(v(0,"div",73),y(1),_(),v(2,"div",70),y(3),_()),n&2){let t=P(4);m(),V(" ",t.settings.t("NAPALM_STRIKE")," "),m(2),V(" ",t.settings.t("NAPALM_STRIKE_INFO")," ")}}function iK(n,e){if(n&1&&(v(0,"div",73),y(1),_(),v(2,"div",70),y(3),_()),n&2){let t=P(4);m(),V(" ",t.settings.t("REFRACTION_BEAM")," "),m(2),V(" ",t.settings.t("REFRACTION_BEAM_INFO")," ")}}function rK(n,e){if(n&1&&(v(0,"div",73),y(1),_(),v(2,"div",70),y(3),_()),n&2){let t=P(4);m(),V(" ",t.settings.t("NEUROTOXIN")," "),m(2),V(" ",t.settings.t("NEUROTOXIN_INFO")," ")}}function oK(n,e){if(n&1){let t=$e();v(0,"button",67),X("click",function(){ee(t);let r=P(3);return te(r.buyAbility())}),v(1,"span"),y(2),_(),Q(3,Jq,2,1,"span",66),_(),v(4,"div",68),Q(5,Xq,4,2),Q(6,Zq,4,2),Q(7,eK,4,2),Q(8,tK,4,2),Q(9,nK,4,2),Q(10,iK,4,2),Q(11,rK,4,2),_()}if(n&2){let t=P(2),i=P();Ae("bg-purple-600",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("hover:bg-purple-500",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("bg-slate-700",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),Ce("disabled",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),m(2),V(" ",t.tower.specialActive?i.settings.t("ABILITY_ACTIVE"):i.settings.t("BUY_ABILITY")," "),m(),J(t.tower.specialActive?-1:3),m(2),J(t.tower.type===1?5:-1),m(),J(t.tower.type===2?6:-1),m(),J(t.tower.type===3?7:-1),m(),J(t.tower.type===4?8:-1),m(),J(t.tower.type===5?9:-1),m(),J(t.tower.type===6?10:-1),m(),J(t.tower.type===7?11:-1)}}function sK(n,e){if(n&1){let t=$e();v(0,"h3",48),y(1),_(),v(2,"div",49)(3,"div",50)(4,"span",51),y(5),_(),v(6,"span",52),y(7),_()(),v(8,"div",50)(9,"span",51),y(10),_(),v(11,"span",52),y(12),_()(),v(13,"div",50)(14,"span",51),y(15),_(),v(16,"span",53),y(17),_()(),v(18,"div",50)(19,"span",51),y(20),_(),v(21,"span",54),y(22),_()(),v(23,"div",55)(24,"span",51),y(25),_(),v(26,"span",56),y(27),_()()(),v(28,"div",57)(29,"div",58)(30,"div",59),y(31),_(),v(32,"div",60)(33,"button",61),X("click",function(){ee(t);let r=P(2);return te(r.setTowerStrategy("first"))}),y(34),_(),v(35,"button",61),X("click",function(){ee(t);let r=P(2);return te(r.setTowerStrategy("weakest"))}),y(36),_(),v(37,"button",61),X("click",function(){ee(t);let r=P(2);return te(r.setTowerStrategy("strongest"))}),y(38),_(),v(39,"button",61),X("click",function(){ee(t);let r=P(2);return te(r.setTowerStrategy("random"))}),y(40),_()()(),Q(41,Yq,5,3,"button",62)(42,Qq,2,1,"div",63),v(43,"button",64),X("click",function(){ee(t);let r=P(2);return te(r.sellTower())}),y(44),_(),Q(45,oK,12,16),_()}if(n&2){let t=P(),i=P();m(),V(" ",i.settings.t("DEFENDER_INFO")," "),m(4),j(i.settings.t("TIER")),m(2),j(t.tower.type),m(3),j(i.settings.t("LEVEL")),m(2),V("",t.tower.level," / 4"),m(3),j(i.settings.t("DAMAGE")),m(2),j(t.tower.damage),m(3),j(i.settings.t("RANGE")),m(2),j(t.tower.range),m(3),j(i.settings.t("SPEED")),m(2),j(t.tower.fireInterval),m(4),j(i.settings.t("TARGETING")),m(2),Ae("bg-sky-600",t.tower.strategy==="first"||!t.tower.strategy)("text-white",t.tower.strategy==="first"||!t.tower.strategy),m(),V(" ",i.settings.t("FIRST")," "),m(),Ae("bg-sky-600",t.tower.strategy==="weakest")("text-white",t.tower.strategy==="weakest"),m(),V(" ",i.settings.t("WEAKEST")," "),m(),Ae("bg-sky-600",t.tower.strategy==="strongest")("text-white",t.tower.strategy==="strongest"),m(),V(" ",i.settings.t("STRONGEST")," "),m(),Ae("bg-sky-600",t.tower.strategy==="random")("text-white",t.tower.strategy==="random"),m(),V(" ",i.settings.t("RANDOM")," "),m(),J(t.tower.level<4?41:42),m(3),V(" ",i.settings.t("SELL")," (50% REFUND) "),m(),J(t.tower.level===4?45:-1)}}function aK(n,e){n&1&&Q(0,Kq,5,1)(1,sK,46,35),n&2&&J(e.tower?1:0)}function lK(n,e){if(n&1&&(v(0,"div",36),ie(),v(1,"svg",74),W(2,"path",75),_(),ke(),v(3,"p",76),y(4),W(5,"br"),y(6),_()()),n&2){let t=P();m(4),V(" ",t.settings.t("SELECT_BUILD_TILE")," "),m(2),V(" ",t.settings.t("TO_PLACE_DEFENDER")," ")}}function cK(n,e){n&1&&W(0,"app-support-community")}function uK(n,e){if(n&1){let t=$e();v(0,"div",40)(1,"div",77)(2,"h2",78),y(3),_(),v(4,"p",79),y(5),_(),v(6,"button",80),X("click",function(){ee(t);let r=P();return te(r.onRestart())}),y(7),_()()()}if(n&2){let t=P();m(3),j(t.settings.t("GAME_OVER")),m(2),cs(" ",t.settings.t("YOU_SURVIVED")," ",t.tdEngine.wave()," ",t.settings.t("WAVES")," "),m(2),V(" ",t.settings.t("TRY_AGAIN")," ")}}var k0=class n{constructor(e,t,i,r,o,s){this.tdEngine=e;this.settings=t;this.gameEngine=i;this.firebase=r;this.router=o;this.cdr=s}selectedTile=$(null);mapLevel=$(1);uiSub;gameCanvas;ctx;rafId=null;isBrowser=typeof window<"u"&&typeof document<"u";onKeyDown(e){if(this.tdEngine.isWaveInProgress())return;if(e.key==="Enter"){e.preventDefault(),this.tdEngine.startWave();return}}onKeyUp(e){}ngOnInit(){this.tdEngine.initializeGame(this.mapLevel()),this.cdr.detectChanges(),this.uiSub=this.tdEngine.uiTick$.subscribe(()=>{this.cdr.detectChanges()})}ngAfterViewInit(){this.isBrowser&&(setTimeout(()=>{this.initCanvas(),this.startCanvasLoop(),setTimeout(()=>this.resizeCanvas(),100)},0),window.addEventListener("resize",this.resizeCanvas))}ngOnDestroy(){this.uiSub?.unsubscribe(),this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.isBrowser&&window.removeEventListener("resize",this.resizeCanvas),this.tdEngine.resetEngine()}goBack(){this.tdEngine.resetEngine(),this.router.navigate(["/"])}onRestart(){this.tdEngine.initializeGame(this.mapLevel()),this.selectedTile.set(null)}onTileClick(e){e.type==="buildable"||e.tower?this.selectedTile.set(e):this.selectedTile.set(null)}buyTower(e){let t=this.selectedTile();t&&(this.tdEngine.buyTower(t.x,t.y,e),this.selectedTile.set(null))}upgradeTower(){let e=this.selectedTile();e&&e.tower&&this.tdEngine.upgradeTower(e.x,e.y)}getRangeStyle(){let e=this.selectedTile();if(!e||!e.tower)return{display:"none"};let t=e.tower,i=this.tdEngine.tileSize,r=t.range*2*i;return{left:`${t.position.x*i+i/2}px`,top:`${t.position.y*i+i/2}px`,width:`${r}px`,height:`${r}px`,display:"block"}}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}sellTower(){let e=this.selectedTile();e&&e.tower&&(this.tdEngine.sellTower(e.x,e.y),this.selectedTile.set(null))}setTowerStrategy(e){let t=this.selectedTile();t&&t.tower&&this.tdEngine.setTowerStrategy(t.x,t.y,e)}buyAbility(){let e=this.selectedTile();e&&e.tower&&e.tower.level===4&&!e.tower.specialActive&&this.tdEngine.buyAbility(e.x,e.y)}setSpeed(e){this.tdEngine.gameSpeedMultiplier.set(e)}onMapSizeChange(e){e!==this.mapLevel()&&(this.mapLevel.set(e),this.tdEngine.initializeGame(e),this.selectedTile.set(null),this.isBrowser&&this.resizeCanvas())}setHardMode(e){this.tdEngine.isWaveInProgress()||this.tdEngine.isHardMode.set(e)}onLoginClick(){if(!this.firebase.user$())try{this.firebase.loginWithGoogle()}catch{}}initCanvas=()=>{let e=this.gameCanvas?.nativeElement;e&&(this.ctx=e.getContext("2d"),this.resizeCanvas())};resizeCanvas=()=>{let e=this.gameCanvas?.nativeElement;if(!e)return;let t=this.tdEngine.tileSize,i=this.tdEngine.gridSize;if(!t||!i)return;let r=this.tdEngine.gridSize*t;e.style.width=`${r}px`,e.style.height=`${r}px`;let o=Math.max(1,window.devicePixelRatio||1);e.width=Math.floor(r*o),e.height=Math.floor(r*o);let s=e.getContext("2d");s&&(s.setTransform(o,0,0,o,0,0),this.ctx=s)};startCanvasLoop(){let e=()=>{this.drawFrame(),this.rafId=requestAnimationFrame(e)};this.rafId=requestAnimationFrame(e)}clearCanvas(e,t){e.clearRect(0,0,t,t)}drawFrame(){let e=this.gameCanvas?.nativeElement,t=this.ctx;if(!e||!t)return;let i=this.tdEngine.tileSize,r=this.tdEngine.gridSize*i;this.clearCanvas(t,r),this.drawGrid(t,i),this.drawPathOverlay(t,i),this.drawSelection(t,i),this.drawFrostAuras(t,i),this.drawTowers(t,i),this.drawEnemies(t,i),this.tdEngine.gameSpeedMultiplier()===1&&this.drawProjectiles(t,i),this.drawRangeIndicator(t,i)}drawPathOverlay(e,t){let i=this.tdEngine.getPathRef();if(!i||i.length<2)return;e.save(),e.strokeStyle="rgba(255,255,255,0.3)",e.setLineDash([10,10]),e.lineWidth=2,e.beginPath();for(let q=0;q<i.length;q++){let ye=i[q],_e=ye.x*t+t/2,xe=ye.y*t+t/2;q===0?e.moveTo(_e,xe):e.lineTo(_e,xe)}e.stroke(),e.setLineDash([]);let r=i[0],o=i[i.length-1],s=r.x*t+t/2,a=r.y*t+t/2,l=o.x*t+t/2,c=o.y*t+t/2;e.save(),e.translate(s,a);let d=t*.35;e.lineWidth=2,e.strokeStyle="rgba(56,189,248,0.95)",e.shadowColor="rgba(56,189,248,1)",e.shadowBlur=14,e.beginPath();let f=Math.PI*2*3,g=!0;for(let q=0;q<=f;q+=Math.PI/32){let ye=q/f,_e=d*(.4+.6*ye),xe=Math.cos(q)*_e,Ie=Math.sin(q)*_e;g?(e.moveTo(xe,Ie),g=!1):e.lineTo(xe,Ie)}e.stroke(),e.restore(),e.save(),e.translate(l,c);let x=t*.65,S=t*.7,R=x/2,L=S/2;e.fillStyle="rgba(248,113,113,0.95)",e.strokeStyle="#fecaca",e.lineWidth=2,e.shadowColor="rgba(248,113,113,0.9)",e.shadowBlur=10,e.beginPath(),e.moveTo(0,-L),e.lineTo(R,-L*.1),e.lineTo(R*.8,L),e.lineTo(-R*.8,L),e.lineTo(-R,-L*.2),e.closePath(),e.fill(),e.stroke(),e.restore(),e.restore()}drawGrid(e,t){let i=this.tdEngine.getGridRef();for(let r=0;r<i.length;r++){let o=i[r];for(let s=0;s<o.length;s++){let a=o[s];a.type==="path"?e.fillStyle="#475569":a.type==="buildable"?e.fillStyle="#1e293b":e.fillStyle="rgba(203, 23, 23, 0)",e.fillRect(s*t,r*t,t-2,t-2)}}}drawTowers(e,t){let i=this.tdEngine.getTowersRef(),r=this.tdEngine.getEnemiesRef(),o=this.tdEngine.gameSpeedMultiplier();for(let s of i){let a=s.position.x*t+t/2,l=s.position.y*t+t/2,c=t*.15;if(this.drawTowerShape(e,a,l,s.type,s.level,t),s.specialActive&&(e.save(),e.fillStyle="#00F2FF",e.shadowColor="black",e.shadowBlur=4,e.font=`bold ${Math.floor(t*.3)}px Arial`,e.textAlign="left",e.textBaseline="top",e.fillText("\u2605",a-t/2+c,l-t/2+c),e.restore()),s.specialActive&&s.hasGolden&&(e.save(),e.fillStyle="#FFD700",e.shadowColor="black",e.shadowBlur=4,e.font=`bold ${Math.floor(t*.3)}px Arial`,e.textAlign="right",e.textBaseline="top",e.fillText("\u26A1",a+t/2-c,l-t/2+c),e.restore()),o===1&&s.type===6&&s.targetEnemyId){let d=r.find(h=>h.id===s.targetEnemyId);if(d){let h=d.displayX??(d.position.x+.5)*t,f=d.displayY??(d.position.y+.5)*t;e.save();let g="rgba(56,189,248,0.9)";if(s.hasGolden){let x=e.createLinearGradient(a,l,h,f);x.addColorStop(0,"#22c1c3"),x.addColorStop(.5,"#a855f7"),x.addColorStop(1,"#f97316"),g=x}e.strokeStyle=g,e.lineWidth=2,e.beginPath(),e.moveTo(a,l),e.lineTo(h,f),e.stroke(),e.restore()}if(s.extraTargetIds&&s.extraTargetIds.length)for(let h of s.extraTargetIds){let f=r.find(R=>R.id===h);if(!f)continue;let g=f.displayX??(f.position.x+.5)*t,x=f.displayY??(f.position.y+.5)*t;e.save();let S="rgba(56,189,248,0.7)";if(s.hasGolden){let R=e.createLinearGradient(a,l,g,x);R.addColorStop(0,"#22c1c3"),R.addColorStop(.5,"#a855f7"),R.addColorStop(1,"#f97316"),S=R}e.strokeStyle=S,e.lineWidth=1.5,e.beginPath(),e.moveTo(a,l),e.lineTo(g,x),e.stroke(),e.restore()}}}}drawTowerShape(e,t,i,r,o,s){let a=s*.5,l=a/2,c=r===1?"#0ea5e9":r===2?"#a855f7":r===3?"#f59e0b":r===4?"#ef4444":r===5?"#fb923c":r===6?"#22d3ee":"#84cc16",d=2.5,h=Math.max(1,Math.min(4,o||1));if(e.save(),e.lineWidth=d,e.strokeStyle=c,h>=4&&(e.shadowColor=c,e.shadowBlur=16),e.beginPath(),r===1){let f=a*.5;e.arc(t,i,f,0,Math.PI*2)}else if(r===2){let f=a*.9,g=a*.9;e.moveTo(t,i-f/2),e.lineTo(t-g/2,i+f/2),e.lineTo(t+g/2,i+f/2),e.closePath()}else if(r===3)e.rect(t-l,i-l,a,a);else if(r===4){let f=a*.9,g=a*.9;e.moveTo(t,i-f/2),e.lineTo(t+g/2,i),e.lineTo(t,i+f/2),e.lineTo(t-g/2,i),e.closePath()}else if(r===5){let f=a*.5;for(let g=0;g<5;g++){let x=Math.PI*2*g/5-Math.PI/2,S=t+Math.cos(x)*f,R=i+Math.sin(x)*f;g===0?e.moveTo(S,R):e.lineTo(S,R)}e.closePath()}else if(r===6){let f=a*.5;for(let g=0;g<6;g++){let x=Math.PI/3*g-Math.PI/2,S=t+Math.cos(x)*f,R=i+Math.sin(x)*f;g===0?e.moveTo(S,R):e.lineTo(S,R)}e.closePath()}else if(r===7){let f=a*.5,g=.35;e.moveTo(t-f*g,i-f),e.lineTo(t+f*g,i-f),e.lineTo(t+f*g,i-f*g),e.lineTo(t+f,i-f*g),e.lineTo(t+f,i+f*g),e.lineTo(t+f*g,i+f*g),e.lineTo(t+f*g,i+f),e.lineTo(t-f*g,i+f),e.lineTo(t-f*g,i+f*g),e.lineTo(t-f,i+f*g),e.lineTo(t-f,i-f*g),e.lineTo(t-f*g,i-f*g),e.closePath()}if(h>=2&&(e.fillStyle=c,e.globalAlpha=h===2?.7:.9,e.fill(),e.globalAlpha=1),e.stroke(),h>=3){e.beginPath();let f=a*.18;e.arc(t,i,f,0,Math.PI*2),e.fillStyle="#0f172a",e.fill()}if(h>=4){e.beginPath();let f=a*.75;e.arc(t,i,f,0,Math.PI*2),e.setLineDash([2,4]),e.strokeStyle=c,e.globalAlpha=.5,e.stroke(),e.setLineDash([])}e.restore()}drawFrostAuras(e,t){let i=this.tdEngine.getTowersRef();for(let r of i)if(r.type===1&&r.specialActive){let o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=2*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.05)",e.fill(),e.lineWidth=1,e.strokeStyle="rgba(56, 189, 248, 0.1)",e.stroke()}}drawEnemies(e,t){let i=this.tdEngine.getEnemiesRef(),r=this.tdEngine.gameSpeedMultiplier()>1;for(let o of i){let a=(o.scale??1)*(t*.65),l=a/2,c=o.displayX??(o.position.x+.5)*t,d=o.displayY??(o.position.y+.5)*t;e.fillStyle=o.bg||(o.isFrozen?"#7dd3fc":"#ef4444");let h="transparent",f=r?"transparent":e.fillStyle,g=r?0:10,x=2;if(o.isMagma?(h="#f97316",f="#f97316",g=r?0:15,x=3):o.isMirror?(h="#f0f9ff",f="#0ea5e9",g=r?0:15,x=3):o.isSlime&&(h="#22c55e",f="#22c55e",g=r?0:15,x=3),e.shadowColor=f,e.shadowBlur=g,e.strokeStyle=h,e.lineWidth=x,e.beginPath(),o.type==="tank")e.arc(c,d,l,0,Math.PI*2);else if(o.type==="scout")e.moveTo(c,d-l),e.lineTo(c-l,d+l),e.lineTo(c+l,d+l),e.closePath();else if(o.type==="boss"){for(let R=0;R<6;R++){let L=Math.PI*2*R/6-Math.PI/2,q=c+l*Math.cos(L),ye=d+l*Math.sin(L);R===0?e.moveTo(q,ye):e.lineTo(q,ye)}e.closePath()}else e.rect(c-l,d-l,a,a);e.fill(),h!=="transparent"&&e.stroke(),e.shadowBlur=0}for(let o of i){let s=(o.isBoss?1.5:1)*(t*.65),a=s/2,l=o.displayX??(o.position.x+.5)*t,c=o.displayY??(o.position.y+.5)*t,d=s,h=4;e.fillStyle="#0f172a",e.fillRect(l-a,c-a-10,d,h),e.fillStyle="#10b981";let f=Math.max(0,Math.min(1,o.hp/o.maxHp));e.fillRect(l-a,c-a-10,d*f,h)}}drawSelection(e,t){let i=this.selectedTile();if(!i)return;let r=i.x*t,o=i.y*t;e.save(),e.lineWidth=3,e.strokeStyle="rgba(56, 189, 248, 0.95)",e.shadowColor="rgba(56, 189, 248, 0.9)",e.shadowBlur=14,e.strokeRect(r+1.5,o+1.5,t-3,t-3),e.restore()}drawProjectiles(e,t){if(this.tdEngine.gameSpeedMultiplier()>=2)return;let r=this.tdEngine.getProjectilesRef();e.fillStyle="#fbbf24";for(let s of r){let a=s.from.x+(s.to.x-s.from.x)*s.progress,l=s.from.y+(s.to.y-s.from.y)*s.progress;e.beginPath(),e.arc(a*t+t/2,l*t+t/2,3,0,Math.PI*2),e.fill()}let o=this.tdEngine.getInfernoZonesRef();for(let s of o){if(s.dps<=0)continue;let a=s.position.x*t+t/2,l=s.position.y*t+t/2,c=s.radius*t;e.save(),e.beginPath(),e.arc(a,l,c,0,Math.PI*2),e.fillStyle="rgba(248, 113, 113, 0.15)",e.fill(),e.lineWidth=1,e.strokeStyle="rgba(248, 113, 113, 0.4)",e.setLineDash([4,4]),e.stroke(),e.restore()}}drawRangeIndicator(e,t){let i=this.selectedTile();if(!i||!i.tower)return;let r=i.tower,o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=r.range*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.12)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56, 189, 248, 0.4)",e.stroke()}onCanvasClick(e){let t=this.gameCanvas?.nativeElement;if(!t)return;let i=t.getBoundingClientRect(),r=e.clientX-i.left,o=e.clientY-i.top,s=this.tdEngine.tileSize,a=Math.floor(r/s),l=Math.floor(o/s),c=this.tdEngine.getGridRef();l>=0&&l<c.length&&a>=0&&a<c[0].length&&this.onTileClick(c[l][a])}static \u0275fac=function(t){return new(t||n)(he(P0),he(Et),he(Gn),he(Rn),he(wi),he(ma))};static \u0275cmp=It({type:n,selectors:[["app-tower-defense"]],viewQuery:function(t,i){if(t&1&&Dl(zq,5),t&2){let r;Al(r=Ml())&&(i.gameCanvas=r.first)}},hostBindings:function(t,i){t&1&&X("keydown",function(o){return i.onKeyDown(o)},fa)("keyup",function(o){return i.onKeyUp(o)},fa)},decls:72,vars:79,consts:[["gameCanvas",""],[1,"flex","flex-col","h-full","p-4","overflow-hidden"],[1,"relative"],[1,"hud-overlay"],[1,"flex","items-center","justify-between","mb-4","bg-slate-800","p-3","rounded-lg","border","border-slate-700"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors",3,"click"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-4","py-2","bg-amber-600","hover:bg-amber-500","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"flex","flex-col","items-center","gap-1","font-black","tracking-wide"],[1,"flex","items-baseline","gap-6"],[1,"text-emerald-400","text-lg","font-mono"],[1,"text-rose-400","text-lg","font-mono"],[1,"text-sky-400","text-lg","font-mono"],[1,"flex","items-center","gap-4","text-xs"],[1,"flex","items-center","gap-1"],[1,"text-slate-400","mr-1"],[1,"px-2","py-0.5","rounded","border","text-[10px]","font-bold",3,"click"],[1,"cursor-pointer","bg-rose-600","hover:bg-rose-500","text-white","text-xs","font-bold","px-3","py-2","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-3","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-4","py-2","rounded","text-sm","font-black","transition-all",3,"click","disabled"],[1,"relative","flex","gap-4","flex-1","min-h-0"],[1,"flex","items-center","gap-2","text-xs","font-bold","text-rose-400","absolute","top-2","left-2","z-5"],["type","checkbox",1,"accent-rose-500",3,"change","checked"],[1,"flex","items-center","gap-2","px-3","py-2","rounded","bg-white/5","border","border-white/10","absolute","bottom-2","left-2","z-5"],[1,"text-xs","text-slate-300"],[1,"text-xs","font-bold","text-slate-100","capitalize"],[1,"shape-preview",3,"ngClass"],[1,"absolute","bottom-2","right-70","z-5","cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"text-[14px]","font-bold","uppercase","tracking-tighter"],[1,"flex-1","relative","bg-slate-900","rounded-lg","overflow-auto","border","flex","items-center","justify-center","p-4","min-h-[400px]"],[1,"block","rounded","transition-opacity","duration-300",3,"click"],[1,"w-64","flex","flex-col","gap-4"],[1,"flex-1","bg-slate-800","rounded-lg","border","border-slate-700","p-4","overflow-y-auto"],[1,"h-full","flex","flex-col","items-center","justify-center","text-center","text-slate-500"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-5","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg"],[1,"text-lg","mobile-actions-hide-text"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-slate-950/70","backdrop-blur-sm","z-[200]"],[1,"text-sm","font-bold","text-slate-400","mb-4","uppercase","tracking-wider"],[1,"flex","flex-col","gap-3"],[1,"shop-btn","flex","justify-between","items-center","cursor-pointer",3,"disabled","bg-slate-700","hover:bg-slate-600","bg-slate-900"],[1,"shop-btn","flex","justify-between","items-center","cursor-pointer",3,"click","disabled"],[1,"flex","items-center","gap-2"],[1,"text-xs","bg-slate-600","px-1.5","rounded"],[1,"text-emerald-400","font-mono"],[1,"text-sm","font-bold","text-slate-400","mb-2","uppercase","tracking-wider"],[1,"bg-slate-900","rounded","p-3","mb-4"],[1,"flex","justify-between","mb-1"],[1,"text-xs","text-slate-500"],[1,"text-xs","font-bold"],[1,"text-xs","font-bold","text-rose-400"],[1,"text-xs","font-bold","text-sky-400"],[1,"flex","justify-between"],[1,"text-xs","font-bold","text-lime-400"],[1,"flex","flex-col","gap-2"],[1,"bg-slate-900","rounded","p-3","mb-2"],[1,"text-xs","text-slate-500","mb-1"],[1,"flex","flex-wrap","gap-1"],[1,"px-2","py-1","text-[10px]","rounded-full","border","border-slate-600",3,"click"],[1,"cursor-pointer","w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"disabled"],[1,"w-full","py-3","bg-slate-900","text-slate-500","rounded","text-center","font-bold","border","border-slate-700"],[1,"cursor-pointer","w-full","py-3","bg-rose-700","hover:bg-rose-600","rounded","font-bold","transition-all","flex","justify-center","items-center","text-sm",3,"click"],[1,"cursor-pointer","w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"font-mono"],[1,"cursor-pointer","w-full","py-3","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"mt-4","pt-4","border-t","border-white/10","space-y-2"],[1,"text-blue-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-gray-400","text-sm","leading-relaxed"],[1,"text-yellow-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-red-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-purple-400","font-bold","tracking-wide","uppercase","text-sm"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mb-2","opacity-20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"],[1,"text-sm"],[1,"bg-slate-900","border","border-slate-700","rounded-lg","px-8","py-6","text-center","shadow-xl"],[1,"text-2xl","font-black","text-rose-400","mb-2"],[1,"text-slate-300","mb-4"],[1,"bg-emerald-600","hover:bg-emerald-500","text-white","font-bold","px-6","py-2","rounded",3,"click"]],template:function(t,i){if(t&1){let r=$e();v(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"button",6),X("click",function(){return ee(r),te(i.goBack())}),y(6),_(),v(7,"button",7),X("click",function(){return ee(r),te(i.router.navigate(["/tower-defense-leaderboard"]))}),y(8),_(),v(9,"button",8),X("click",function(){return ee(r),te(i.router.navigate(["/masteries"]))}),y(10),_()(),v(11,"div",9)(12,"div",10)(13,"div",11),y(14),_(),v(15,"div",12),y(16),_(),v(17,"div",13),y(18),_()(),v(19,"div",14)(20,"div",15)(21,"span",16),y(22,"Speed:"),_(),v(23,"button",17),X("click",function(){return ee(r),te(i.setSpeed(1))}),y(24," 1x "),_(),v(25,"button",17),X("click",function(){return ee(r),te(i.setSpeed(2))}),y(26," 2x "),_(),v(27,"button",17),X("click",function(){return ee(r),te(i.setSpeed(4))}),y(28," 4x "),_()(),v(29,"div",15)(30,"span",16),y(31,"Map Size:"),_(),v(32,"button",17),X("click",function(){return ee(r),te(i.onMapSizeChange(1))}),y(33," Small (10x10) "),_(),v(34,"button",17),X("click",function(){return ee(r),te(i.onMapSizeChange(2))}),y(35," Large (20x20) "),_()()()(),v(36,"div",5)(37,"button",18),X("click",function(){return ee(r),te(i.onRestart())}),y(38),_(),v(39,"button",19),X("click",function(){return ee(r),te(i.onLoginClick())}),y(40),_(),v(41,"button",20),X("click",function(){return ee(r),te(i.tdEngine.startWave())}),y(42),_()()()()(),v(43,"div",21)(44,"label",22)(45,"input",23),X("change",function(s){return ee(r),te(i.setHardMode(s.target.checked))}),_(),y(46," Hard Mode "),_(),v(47,"div",24)(48,"span",25),y(49,"Next:"),_(),v(50,"span",26),y(51),_(),W(52,"span",27),_(),v(53,"button",28),X("click",function(){return ee(r),te(i.navigateToFeedback())}),ie(),v(54,"svg",29),W(55,"path",30),_(),ke(),v(56,"span",31),y(57),_()(),v(58,"div",32)(59,"canvas",33,0),X("click",function(s){return ee(r),te(i.onCanvasClick(s))}),_()(),v(61,"div",34)(62,"div",35),Q(63,aK,2,1)(64,lK,7,2,"div",36),_()(),v(65,"button",37),X("click",function(){return ee(r),te(i.gameEngine.toggleSupport())}),v(66,"span",38),y(67,"\u2764\uFE0F"),_(),v(68,"span",39),y(69),_()(),Q(70,cK,1,0,"app-support-community"),_(),Q(71,uK,8,5,"div",40),_()}if(t&2){let r,o;m(6),V(" ",i.settings.t("EXIT_GAME")," "),m(2),V(" ",i.settings.t("RANKING")," "),m(2),V(" ",i.settings.t("MASTERIES")," "),m(4),Mt("",i.settings.t("MONEY"),": $",i.tdEngine.money()),m(2),Mt("",i.settings.t("LIVES"),": ",i.tdEngine.lives()),m(2),Mt("",i.settings.t("WAVE"),": ",i.tdEngine.wave()),m(5),Ae("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===1)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===1)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==1)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==1),m(2),Ae("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===2)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===2)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==2)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==2),m(2),Ae("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===4)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===4)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==4)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==4),m(5),Ae("bg-slate-200",i.mapLevel()===1)("text-slate-900",i.mapLevel()===1)("bg-slate-800",i.mapLevel()!==1)("text-slate-300",i.mapLevel()!==1),m(2),Ae("bg-slate-200",i.mapLevel()===2)("text-slate-900",i.mapLevel()===2)("bg-slate-800",i.mapLevel()!==2)("text-slate-300",i.mapLevel()!==2),m(4),V(" ",i.settings.t("RESTART_GAME")," "),m(2),V(" ",i.firebase.user$()?((r=i.firebase.user$())==null?null:r.displayName)||"Account":"Login to Save Score"," "),m(),Ae("bg-sky-600",!i.tdEngine.isWaveInProgress())("hover:bg-sky-500",!i.tdEngine.isWaveInProgress())("bg-slate-700",i.tdEngine.isWaveInProgress())("text-slate-500",i.tdEngine.isWaveInProgress()),Ce("disabled",i.tdEngine.isWaveInProgress()),m(),V(" ",i.tdEngine.isWaveInProgress()?i.settings.t("WAVE_IN_PROGRESS"):i.settings.t("START_WAVE")," "),m(3),Ce("checked",i.tdEngine.isHardMode()),m(6),j(i.tdEngine.nextWaveEnemyType()),m(),et("background",i.tdEngine.nextWaveEnemyType()==="tank"?"hsl(330,70%,60%)":i.tdEngine.nextWaveEnemyType()==="scout"?"hsl(50,90%,60%)":"hsl(200,70%,60%)"),Ce("ngClass",mE(75,Wq,i.tdEngine.nextWaveEnemyType()==="tank",i.tdEngine.nextWaveEnemyType()==="scout",i.tdEngine.nextWaveEnemyType()==="standard")),m(5),j(i.settings.t("FEEDBACK_MODULE")),m(),Ae("border-rose-600",i.tdEngine.isHardMode())("shadow-[0_0_25px_rgba(248,113,113,0",i.tdEngine.isHardMode()),m(5),J((o=i.selectedTile())?63:64,o),m(6),j(i.settings.t("SUPPORT")),m(),J(i.gameEngine.supportOpen()?70:-1),m(),J(i.tdEngine.gameOver()?71:-1)}},dependencies:[Pt,Yu,xc],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"[_nghost-%COMP%]{display:block;height:100vh;background:#0f172a;color:#fff}.td-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,60px);grid-template-rows:repeat(10,60px);gap:2px;background:#1e293b;border:4px solid #334155;border-radius:8px;position:relative}.td-tile[_ngcontent-%COMP%]{position:relative;width:60px;height:60px;transition:all .2s;overflow:hidden}.tile-path[_ngcontent-%COMP%]{background:#475569}.tile-buildable[_ngcontent-%COMP%]{background:#1e293b;cursor:pointer}.tile-buildable[_ngcontent-%COMP%]:hover{background:#334155}.tile-void[_ngcontent-%COMP%]{opacity:.1}.range-indicator[_ngcontent-%COMP%]{position:absolute;background:#38bdf826;border:2px solid rgba(56,189,248,.5);border-radius:50%;pointer-events:none;z-index:50;transform:translate(-50%,-50%);transition:all .2s ease-out}.frost-aura-visual[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:248px;height:248px;transform:translate(-50%,-50%);border-radius:50%;background:#00ffff1a;border:1px solid rgba(0,255,255,.3);pointer-events:none;z-index:5;box-shadow:0 0 15px #0ff3}.enemy[_ngcontent-%COMP%]{position:absolute;width:40px;height:40px;background:#ef4444;border-radius:50%;z-index:10;box-shadow:0 0 10px #ef4444;display:flex;align-items:center;justify-content:center}.enemy-fast[_ngcontent-%COMP%]{box-shadow:none}.projectile[_ngcontent-%COMP%]{position:absolute;width:6px;height:6px;background:#fbbf24;border-radius:50%;z-index:20;box-shadow:0 0 5px #fbbf24}.shop-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.25rem;font-weight:700;transition:all .2s}.shop-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.shape-preview[_ngcontent-%COMP%]{width:18px;height:18px;display:inline-block;background:#fff3}.shape-square[_ngcontent-%COMP%]{border-radius:4px}.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.shape-triangle[_ngcontent-%COMP%]{clip-path:polygon(50% 0%,0% 100%,100% 100%)}.shape-hexagon[_ngcontent-%COMP%]{clip-path:polygon(25% 5%,75% 5%,100% 50%,75% 95%,25% 95%,0% 50%)}"],changeDetection:0})};function dK(n,e){n&1&&(v(0,"div",8)(1,"span",9),W(2,"span",10),v(3,"span"),y(4,"Loading leaderboard..."),_()()())}function hK(n,e){if(n&1&&(v(0,"tr",16)(1,"td",17),y(2),_(),v(3,"td",18),y(4),_(),v(5,"td",19),y(6),_(),v(7,"td",17),y(8),_(),v(9,"td",17),y(10),_(),v(11,"td",20),y(12),Oi(13,"date"),Oi(14,"date"),_()()),n&2){let t=e.$implicit,i=e.index;m(2),j(i+1),m(2),V(" ",t.displayName||"Anonymous"," "),m(2),V(" ",t.maxWave," "),m(2),V(" ",t.mapSize||"10x10"," "),m(2),V(" ",t.userTotalXp??0," "),m(2),V(" ",t.timestamp!=null&&t.timestamp.toDate?nr(13,6,t.timestamp.toDate(),"mediumDate"):nr(14,9,t.timestamp,"mediumDate")," ")}}function fK(n,e){n&1&&(v(0,"tr")(1,"td",21),y(2," No runs recorded yet. Finish a game while logged in to appear here. "),_()())}function pK(n,e){if(n&1&&(v(0,"div",22)(1,"div",23),y(2," Your Personal Best "),_(),v(3,"table",11)(4,"tbody")(5,"tr",16)(6,"td",24),y(7," Your Best "),_(),v(8,"td",18),y(9),_(),v(10,"td",19),y(11),_(),v(12,"td",17),y(13),_(),v(14,"td",17),y(15),_(),v(16,"td",20),y(17),Oi(18,"date"),Oi(19,"date"),_()()()()()),n&2){let t=e.ngIf;m(9),V(" ",t.displayName||"You"," "),m(2),V(" ",t.maxWave," "),m(2),V(" ",t.mapSize||"10x10"," "),m(2),V(" ",t.userTotalXp??0," "),m(2),V(" ",t.timestamp!=null&&t.timestamp.toDate?nr(18,5,t.timestamp.toDate(),"mediumDate"):nr(19,8,t.timestamp,"mediumDate")," ")}}function gK(n,e){if(n&1&&(v(0,"div")(1,"table",11)(2,"thead")(3,"tr",12)(4,"th",13),y(5,"Rank"),_(),v(6,"th",13),y(7,"Name"),_(),v(8,"th",13),y(9,"Wave"),_(),v(10,"th",13),y(11,"Map"),_(),v(12,"th",13),y(13,"Mastery XP"),_(),v(14,"th",13),y(15,"Date"),_()()(),v(16,"tbody"),zt(17,hK,15,12,"tr",14)(18,fK,3,0,"tr",7),_()(),zt(19,pK,20,11,"div",15),_()),n&2){let t=P();m(17),Ce("ngForOf",t.scores()),m(),Ce("ngIf",t.scores().length===0),m(),Ce("ngIf",t.best())}}var O0=class n{constructor(e,t){this.firebase=e;this.settings=t}loading=$(!0);scores=$([]);best=$(null);ngOnInit(){this.loadScores()}async loadScores(){this.loading.set(!0);try{let e=await this.firebase.getTopTowerDefenseScores(10);this.scores.set(e??[]),await this.loadPersonalBest()}catch{this.scores.set([]),this.best.set(null)}finally{this.loading.set(!1)}}async loadPersonalBest(){let e=this.firebase.user$();if(!e){this.best.set(null);return}let t=await this.firebase.getUserBestTowerDefenseScore(e.uid);console.log("entry: ",t),this.best.set(t??null)}static \u0275fac=function(t){return new(t||n)(he(Rn),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-tower-defense-leaderboard"]],decls:11,vars:3,consts:[[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center","py-10","px-4"],[1,"w-full","max-w-3xl","bg-slate-800","border","border-slate-700","rounded-lg","shadow-xl","p-6"],["routerLink","/tower-defense",1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors"],[1,"flex","items-center","justify-between","mb-4","mt-4"],[1,"text-2xl","font-black","tracking-wide"],[1,"mb-4","text-sm","text-slate-300"],["class","min-h-[80px] flex items-center justify-center",4,"ngIf"],[4,"ngIf"],[1,"min-h-[80px]","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-slate-300"],[1,"w-4","h-4","border-2","border-slate-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-slate-300"],[1,"text-left","py-2","px-2","border-b","border-slate-700"],["class","text-white",4,"ngFor","ngForOf"],["class","mt-6 pt-4 border-t border-slate-700",4,"ngIf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-sky-300"],[1,"py-2","px-2","border-b","border-slate-800"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-emerald-400"],[1,"py-2","px-2","border-b","border-slate-800","text-slate-300"],["colspan","6",1,"py-8","text-center","text-slate-400","italic"],[1,"mt-6","pt-4","border-t","border-slate-700"],[1,"text-xs","font-semibold","text-slate-400","mb-2"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-amber-300"]],template:function(t,i){t&1&&(v(0,"div",0)(1,"div",1)(2,"a",2),y(3),_(),v(4,"div",3)(5,"h1",4),y(6,"Tower Defense Leaderboard"),_()(),v(7,"div",5),y(8," Top 10 runs ranked by highest wave reached. "),_(),zt(9,dK,5,0,"div",6)(10,gK,20,3,"div",7),_()()),t&2&&(m(3),j(i.settings.t("RETURN_TO_MAP")),m(6),Ce("ngIf",i.loading()),m(),Ce("ngIf",!i.loading()))},dependencies:[Pt,hs,ya,Or,va],encapsulation:2})};function mK(n,e){if(n&1&&(v(0,"div",22),W(1,"span",23),v(2,"span",24),y(3),_()()),n&2){let t=P(2);m(3),V(" ",t.settings.t("SAVED")," ")}}function yK(n,e){if(n&1&&(v(0,"div",16)(1,"div",17)(2,"span",18),y(3),_(),v(4,"span",19),y(5),_()(),v(6,"div",17)(7,"span",18),y(8),_(),v(9,"span",20),y(10),_()(),zt(11,mK,4,1,"div",21),_()),n&2){let t,i=P();m(3),j(i.settings.t("TOTAL_XP")),m(2),j((t=i.profile())==null?null:t.totalXp),m(3),j(i.settings.t("AVAILABLE")),m(2),j(i.availablePoints()),m(),Ce("ngIf",i.isSaved()&&!i.saving())}}function vK(n,e){if(n&1&&(v(0,"div",25),y(1),_()),n&2){let t=P();m(),V(" ",t.settings.t("LOG_IN_MASTERY_MSG")," ")}}function _K(n,e){if(n&1){let t=$e();v(0,"div",26)(1,"div",27)(2,"span",28),y(3,"\u{1F512}"),_()(),v(4,"p",29),y(5),_(),v(6,"button",30),X("click",function(){ee(t);let r=P();return te(r.login())}),y(7),_()()}if(n&2){let t=P();m(5),j(t.settings.t("NEED_LOG_IN")),m(2),V(" ",t.settings.t("LOGIN_GOOGLE")," ")}}function EK(n,e){if(n&1&&(v(0,"span",76),y(1),_()),n&2){let t=P().$implicit,i=P(2);m(),Mt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"damage")," XP ")}}function bK(n,e){if(n&1&&(v(0,"span",77),y(1),_()),n&2){let t=P(3);m(),V(" ",t.settings.t("MAXED")," ")}}function wK(n,e){if(n&1&&(v(0,"span",76),y(1),_()),n&2){let t=P().$implicit,i=P(2);m(),Mt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"range")," XP ")}}function xK(n,e){if(n&1&&(v(0,"span",77),y(1),_()),n&2){let t=P(3);m(),V(" ",t.settings.t("MAXED")," ")}}function SK(n,e){if(n&1&&(v(0,"div",78)(1,"div",79),y(2),_()()),n&2){let t=P(3);m(2),V(" \u{1F512} ",t.settings.t("REQUIRES_5_POINTS")," ")}}function IK(n,e){if(n&1&&(v(0,"span",80),y(1),_()),n&2){let t=P().$implicit,i=P(2);m(),Mt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"golden")," XP ")}}function TK(n,e){if(n&1&&(v(0,"span",77),y(1),_()),n&2){let t=P(3);m(),V(" ",t.settings.t("MAXED")," ")}}function CK(n,e){if(n&1){let t=$e();v(0,"div",53)(1,"div",54)(2,"div",55)(3,"div",56),y(4),_(),W(5,"div",57),_(),v(6,"h3",58),y(7),_(),v(8,"div",59)(9,"div",60)(10,"div",61)(11,"div",62),y(12),_(),v(13,"div",63),y(14),_()(),v(15,"div",16)(16,"div",40)(17,"span",41),y(18),_(),zt(19,EK,2,2,"span",64)(20,bK,2,1,"ng-template",null,2,uo),_(),v(22,"button",65),X("click",function(){let r=ee(t).$implicit,o=P(2);return te(o.increaseBasic(r.id,"damage"))}),y(23," + "),_()()(),v(24,"div",60)(25,"div",61)(26,"div",62),y(27),_(),v(28,"div",63),y(29),_()(),v(30,"div",16)(31,"div",40)(32,"span",41),y(33),_(),zt(34,wK,2,2,"span",64)(35,xK,2,1,"ng-template",null,3,uo),_(),v(37,"button",65),X("click",function(){let r=ee(t).$implicit,o=P(2);return te(o.increaseBasic(r.id,"range"))}),y(38," + "),_()()()()(),v(39,"div",66)(40,"div",67)(41,"div",61)(42,"div",68),y(43),_(),v(44,"div",69),y(45),_(),zt(46,SK,3,1,"div",70),_(),v(47,"div",71)(48,"div",72)(49,"span",73),y(50),_(),zt(51,IK,2,2,"span",74)(52,TK,2,1,"ng-template",null,4,uo),_(),v(54,"button",75),X("click",function(){let r=ee(t).$implicit,o=P(2);return te(o.increaseGolden(r.id))}),y(55," + "),_()()()()()}if(n&2){let t=e.$implicit,i=tr(21),r=tr(36),o=tr(53),s=P(2);m(4),Mt(" ",s.settings.t("TIER")," ",t.id," "),m(),Ce("ngClass",t.color.replace("text","bg")),m(),Ce("ngClass",t.color),m(),V(" ",s.settings.t(t.nameKey)," "),m(5),j(s.settings.t("DAMAGE")),m(2),V("+5% ",s.settings.t("PER_LEVEL")),m(4),V(" ",s.getUpgradeLevel(t.id,"damage")," / 20 "),m(),Ce("ngIf",s.getUpgradeLevel(t.id,"damage")<20)("ngIfElse",i),m(3),Ae("bg-emerald-500",s.canIncreaseBasic(t.id,"damage"))("border-emerald-400",s.canIncreaseBasic(t.id,"damage"))("text-slate-900",s.canIncreaseBasic(t.id,"damage"))("hover:scale-110",s.canIncreaseBasic(t.id,"damage")),Ce("disabled",!s.canIncreaseBasic(t.id,"damage")),m(5),j(s.settings.t("RANGE")),m(2),V("+0.1 ",s.settings.t("PER_LEVEL")),m(4),V(" ",s.getUpgradeLevel(t.id,"range")," / 20 "),m(),Ce("ngIf",s.getUpgradeLevel(t.id,"range")<20)("ngIfElse",r),m(3),Ae("bg-emerald-500",s.canIncreaseBasic(t.id,"range"))("border-emerald-400",s.canIncreaseBasic(t.id,"range"))("text-slate-900",s.canIncreaseBasic(t.id,"range"))("hover:scale-110",s.canIncreaseBasic(t.id,"range")),Ce("disabled",!s.canIncreaseBasic(t.id,"range")),m(6),V(" ",s.settings.t(t.goldenTitleKey)," "),m(2),V(" ",s.settings.t(t.goldenDescriptionKey)," "),m(),Ce("ngIf",!s.canUnlockGolden(t.id)),m(4),V(" ",s.getUpgradeLevel(t.id,"golden")," / 3 "),m(),Ce("ngIf",s.getUpgradeLevel(t.id,"golden")<3)("ngIfElse",o),m(3),Ae("bg-amber-500",s.canIncreaseGolden(t.id))("border-amber-400",s.canIncreaseGolden(t.id))("text-slate-950",s.canIncreaseGolden(t.id))("hover:scale-110",s.canIncreaseGolden(t.id)),Ce("disabled",!s.canIncreaseGolden(t.id))}}function DK(n,e){n&1&&W(0,"span",51)}function AK(n,e){if(n&1){let t=$e();v(0,"div",31)(1,"div",16),W(2,"div",32),v(3,"p",33),y(4),_(),W(5,"div",32),_(),v(6,"div",34),zt(7,CK,56,48,"div",35),_(),v(8,"div",36)(9,"div",37)(10,"div")(11,"div",38),y(12),_(),v(13,"div",39),y(14),_()(),v(15,"div",16)(16,"div",40)(17,"span",41),y(18),_()(),v(19,"button",42),X("click",function(){ee(t);let r=P();return te(r.increaseGold())}),y(20," + "),_()()(),v(21,"div",43),y(22),_()()(),v(23,"div",44)(24,"div",45)(25,"span",46),y(26,"\u2139\uFE0F"),_(),v(27,"p",47),y(28),_()(),v(29,"div",48)(30,"button",49),X("click",function(){ee(t);let r=P();return te(r.save())}),v(31,"span",50),Q(32,DK,1,0,"span",51),y(33),_(),W(34,"div",52),_()()()}if(n&2){let t=P();m(4),j(t.settings.t("MASTERIES_SUBTITLE")),m(3),Ce("ngForOf",t.tiers),m(5),V(" ",t.settings.t("GOLD_MASTERY")," "),m(2),Mt(" ",t.settings.t("COST"),": ",t.getGoldNextLevelCost()," XP "),m(4),V(" ",t.getGoldMasteryLevel()," / 20 "),m(),Ae("bg-emerald-500",t.canIncreaseGold())("border-emerald-400",t.canIncreaseGold())("text-slate-900",t.canIncreaseGold())("hover:scale-110",t.canIncreaseGold()),Ce("disabled",!t.canIncreaseGold()),m(3),V(" ",t.settings.t("GOLD_MASTERY_INFO")," "),m(6),j(t.settings.t("LOCAL_STORAGE_MSG")),m(2),Ae("bg-emerald-600",t.profile()&&!t.saving())("text-white",t.profile()&&!t.saving())("shadow-[0_0_30px_rgba(16,185,129,0",t.profile()&&!t.saving())("bg-slate-700",!t.profile()||t.saving()),Ce("disabled",!t.profile()||t.saving()||t.isSaved()),m(2),J(t.saving()?32:-1),m(),V(" ",t.saving()?t.settings.t("SAVING"):t.settings.t("SAVE_CHANGES")," ")}}var F0=class n{constructor(e,t){this.firebase=e;this.settings=t}static BASIC_COST_MULTIPLIER=5;static GOLDEN_COST=150;static GOLDEN_MAX_LEVEL=3;static GOLDEN_LEVEL_COSTS={1:50,2:150,3:400};tiers=[{id:1,nameKey:"T1_NAME",color:"text-sky-400",goldenTitleKey:"T1_GOLDEN_TITLE",goldenDescriptionKey:"T1_GOLDEN_DESC"},{id:2,nameKey:"T2_NAME",color:"text-purple-400",goldenTitleKey:"T2_GOLDEN_TITLE",goldenDescriptionKey:"T2_GOLDEN_DESC"},{id:3,nameKey:"T3_NAME",color:"text-amber-400",goldenTitleKey:"T3_GOLDEN_TITLE",goldenDescriptionKey:"T3_GOLDEN_DESC"},{id:4,nameKey:"T4_NAME",color:"text-rose-400",goldenTitleKey:"T4_GOLDEN_TITLE",goldenDescriptionKey:"T4_GOLDEN_DESC"},{id:5,nameKey:"T5_NAME",color:"text-orange-400",goldenTitleKey:"T5_GOLDEN_TITLE",goldenDescriptionKey:"T5_GOLDEN_DESC"},{id:6,nameKey:"T6_NAME",color:"text-cyan-400",goldenTitleKey:"T6_GOLDEN_TITLE",goldenDescriptionKey:"T6_GOLDEN_DESC"},{id:7,nameKey:"T7_NAME",color:"text-lime-400",goldenTitleKey:"T7_GOLDEN_TITLE",goldenDescriptionKey:"T7_GOLDEN_DESC"}];saving=$(!1);isSaved=$(!1);ngOnInit(){}user(){return this.firebase.user$()}profile(){return this.firebase.masteryProfile()}availablePoints(){let e=this.firebase.masteryProfile();if(!e)return 0;let t=e.totalXp-e.usedPoints;return t>0?t:0}keyFor(e,t){return`t${e}_${t}`}getUpgradeLevel(e,t){let i=this.firebase.masteryProfile();if(!i)return 0;let r=this.keyFor(e,t),o=i.upgrades?.[r];return typeof o=="number"?o:0}getNextLevelCost(e,t){let i=this.getUpgradeLevel(e,t);if(t==="golden"){let r=i+1;return r>n.GOLDEN_MAX_LEVEL?0:n.GOLDEN_LEVEL_COSTS[r]??0}return i>=20?0:(i+1)*n.BASIC_COST_MULTIPLIER}canIncreaseBasic(e,t){if(this.getUpgradeLevel(e,t)>=20)return!1;let r=this.getNextLevelCost(e,t);return r<=0||!this.profile()||this.availablePoints()<r?!1:!!this.profile()}getGoldMasteryLevel(){let e=this.firebase.masteryProfile();if(!e||!e.upgrades)return 0;let t=e.upgrades.gold_mastery;return typeof t=="number"?t:0}getGoldNextLevelCost(){let e=this.getGoldMasteryLevel();return e>=20?0:(e+1)*n.BASIC_COST_MULTIPLIER}canIncreaseGold(){if(this.getGoldMasteryLevel()>=20||!this.profile())return!1;let t=this.getGoldNextLevelCost();return!(t<=0||this.availablePoints()<t)}increaseGold(){if(!this.canIncreaseGold())return;let e=this.getGoldNextLevelCost();e<=0||(this.updateProfile(t=>{let r=(typeof t.upgrades?.gold_mastery=="number"?t.upgrades.gold_mastery:0)+1,o=ce(F({},t.upgrades),{gold_mastery:r});return ce(F({},t),{usedPoints:t.usedPoints+e,upgrades:o})}),this.isSaved.set(!1))}updateProfile(e){let t=this.firebase.masteryProfile();if(!t)return;let i=e(t);this.firebase.setMasteryProfile(i)}increaseBasic(e,t){if(!this.canIncreaseBasic(e,t))return;let i=this.getNextLevelCost(e,t);i<=0||(this.updateProfile(r=>{let o=this.keyFor(e,t),s=r.upgrades?.[o]??0,a=ce(F({},r.upgrades),{[o]:s+1});return ce(F({},r),{usedPoints:r.usedPoints+i,upgrades:a})}),this.isSaved.set(!1))}canUnlockGolden(e){let t=this.getUpgradeLevel(e,"damage"),i=this.getUpgradeLevel(e,"range");return t+i>=15}canIncreaseGolden(e){if(!this.profile()||!this.canUnlockGolden(e)||this.getUpgradeLevel(e,"golden")>=n.GOLDEN_MAX_LEVEL)return!1;let i=this.getNextLevelCost(e,"golden");return!(this.availablePoints()<i)}increaseGolden(e){if(!this.canIncreaseGolden(e))return;let t=this.getNextLevelCost(e,"golden");t<=0||(this.updateProfile(i=>{let r=this.keyFor(e,"golden"),o=i.upgrades?.[r]??0,s=ce(F({},i.upgrades),{[r]:o+1});return ce(F({},i),{usedPoints:i.usedPoints+t,upgrades:s})}),this.isSaved.set(!1))}async save(){if(this.profile()){this.saving.set(!0);try{await this.firebase.saveTowerDefenseMasteries()}catch{}finally{this.saving.set(!1),this.isSaved.set(!0)}}}login(){this.firebase.loginWithGoogle()}static \u0275fac=function(t){return new(t||n)(he(Rn),he(Et))};static \u0275cmp=It({type:n,selectors:[["app-masteries"]],decls:18,vars:6,consts:[["noProfile",""],["loggedInBlock",""],["dmgMaxed",""],["rangeMaxed",""],["goldenMaxed",""],[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center"],[1,"min-h-screen","bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))]","from-slate-800","via-slate-900","to-black","text-white","flex","flex-col","items-center","py-4","px-4","selection:bg-sky-500/30"],[1,"w-full","max-w-6xl","bg-slate-800/50","backdrop-blur-md","border","border-slate-700/50","rounded-2xl","shadow-2xl","overflow-hidden"],[1,"p-6","border-b","border-slate-700/50","bg-slate-900/40","flex","flex-col","md:flex-row","items-center","justify-between","gap-6"],[1,"flex","items-center","gap-4"],["routerLink","/tower-defense",1,"group","flex","items-center","gap-2","px-5","py-2.5","bg-slate-700/50","hover:bg-slate-600","rounded-xl","text-sm","font-bold","transition-all","border","border-slate-600/50","hover:border-sky-500/50","shadow-lg"],[1,"group-hover:-translate-x-1","transition-transform"],[1,"text-3xl","font-black","tracking-tighter","uppercase","italic","text-transparent","bg-clip-text","bg-gradient-to-r","from-white","to-slate-400"],["class","flex items-center gap-3",4,"ngIf","ngIfElse"],[1,"p-8"],["class","flex flex-col items-center justify-center py-20 text-center",4,"ngIf","ngIfElse"],[1,"flex","items-center","gap-3"],[1,"flex","flex-col","items-end","px-4","py-2","bg-black/30","rounded-xl","border","border-slate-700/50"],[1,"text-[10px]","uppercase","font-bold","text-slate-500"],[1,"font-mono","text-lg","text-emerald-400","leading-none"],[1,"font-mono","text-lg","text-sky-400","leading-none"],["class","flex items-center gap-2 px-3 py-1 bg-emerald-500/10 rounded-xl border border-emerald-500/30",4,"ngIf"],[1,"flex","items-center","gap-2","px-3","py-1","bg-emerald-500/10","rounded-xl","border","border-emerald-500/30"],[1,"w-2","h-2","rounded-full","bg-emerald-400","animate-pulse"],[1,"text-[10px]","font-bold","uppercase","tracking-wide","text-emerald-300"],[1,"px-6","py-2","bg-rose-500/10","border","border-rose-500/20","rounded-xl","text-rose-400","text-xs","animate-pulse"],[1,"flex","flex-col","items-center","justify-center","py-20","text-center"],[1,"w-20","h-20","bg-slate-700/30","rounded-full","flex","items-center","justify-center","mb-6","border","border-slate-600"],[1,"text-4xl"],[1,"text-slate-400","max-w-md","mb-8","leading-relaxed"],[1,"px-8","py-4","bg-sky-600","hover:bg-sky-500","hover:scale-105","active:scale-95","rounded-2xl","text-base","font-black","transition-all","shadow-[0_0_20px_rgba(14,165,233,0.4)]",3,"click"],[1,"space-y-8"],[1,"h-px","flex-1","bg-gradient-to-r","from-transparent","via-slate-600","to-transparent"],[1,"text-sm","font-medium","text-slate-400","tracking-wide"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-6"],["class","group relative bg-slate-900/40 rounded-3xl border border-slate-700/50 p-1 transition-all hover:border-slate-500/50 hover:bg-slate-900/60 shadow-xl",4,"ngFor","ngForOf"],[1,"bg-slate-900/70","border","border-amber-500/30","rounded-2xl","px-4","py-3","w-full","md:w-auto"],[1,"flex","items-center","justify-between","gap-4"],[1,"text-xs","font-black","uppercase","tracking-wider","text-amber-400"],[1,"text-[11px]","text-slate-300"],[1,"flex","flex-col","items-end","gap-1"],[1,"font-mono","text-xs","text-emerald-400","bg-emerald-500/10","px-2","py-1","rounded","border","border-emerald-500/20"],[1,"w-9","h-9","rounded-xl","flex","items-center","justify-center","text-xl","font-bold","transition-all","border","shadow-lg","disabled:opacity-20","disabled:grayscale",3,"click","disabled"],[1,"mt-2","text-[11px]","text-slate-400"],[1,"flex","flex-col","md:flex-row","items-center","justify-between","mt-12","pt-8","border-t","border-slate-700/50","gap-6"],[1,"flex","items-center","gap-3","text-slate-500"],[1,"text-xl"],[1,"text-xs","italic"],[1,"flex","flex-col","items-end","gap-4"],[1,"group","relative","px-10","py-4","rounded-2xl","font-black","uppercase","tracking-widest","transition-all","overflow-hidden","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"relative","z-10","flex","items-center","gap-2"],[1,"w-4","h-4","border-2","border-white/30","border-t-white","rounded-full","animate-spin"],[1,"absolute","inset-0","bg-white/10","translate-y-full","group-hover:translate-y-0","transition-transform"],[1,"group","relative","bg-slate-900/40","rounded-3xl","border","border-slate-700/50","p-1","transition-all","hover:border-slate-500/50","hover:bg-slate-900/60","shadow-xl"],[1,"p-5"],[1,"flex","items-center","justify-between","mb-6"],[1,"px-3","py-1","bg-black/40","rounded-lg","text-[10px]","font-black","uppercase","tracking-widest","text-slate-400","border","border-slate-700/50"],[1,"w-2","h-2","rounded-full","blur-[2px]","animate-pulse",3,"ngClass"],[1,"text-lg","font-black","mb-6","tracking-tight",3,"ngClass"],[1,"space-y-6"],[1,"flex","items-center","justify-between","group/item"],[1,"flex-1"],[1,"text-xs","font-bold","text-white","mb-0.5"],[1,"text-[10px]","text-slate-500"],["class","text-[10px] text-slate-400",4,"ngIf","ngIfElse"],[1,"w-8","h-8","rounded-xl","flex","items-center","justify-center","text-xl","font-bold","transition-all","border","shadow-lg","disabled:opacity-20","disabled:grayscale",3,"click","disabled"],[1,"mt-2","p-5","bg-gradient-to-b","from-amber-500/5","to-amber-500/10","rounded-b-[22px]","border-t","border-amber-500/20"],[1,"flex","items-start","justify-between","gap-4"],[1,"text-xs","font-black","uppercase","tracking-wider","text-amber-400","mb-1"],[1,"text-[11px]","text-slate-300","leading-relaxed","italic"],["class","mt-3 inline-block px-2 py-1 rounded bg-black/40 border border-amber-500/20",4,"ngIf"],[1,"flex","flex-col","items-center","gap-2"],[1,"flex","flex-col","items-center","gap-1"],[1,"font-mono","text-xs","text-amber-400"],["class","text-[10px] text-amber-200",4,"ngIf","ngIfElse"],[1,"w-10","h-10","rounded-2xl","flex","items-center","justify-center","text-2xl","font-black","transition-all","border-2","shadow-[0_0_15px_rgba(245,158,11,0.3)]","disabled:opacity-20","disabled:grayscale","disabled:shadow-none",3,"click","disabled"],[1,"text-[10px]","text-slate-400"],[1,"text-[10px]","text-amber-400","font-bold","uppercase"],[1,"mt-3","inline-block","px-2","py-1","rounded","bg-black/40","border","border-amber-500/20"],[1,"text-[9px]","text-amber-500/80","uppercase","font-bold"],[1,"text-[10px]","text-amber-200"]],template:function(t,i){if(t&1&&(v(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"a",10)(6,"span",11),y(7,"\u2190"),_(),y(8),_(),v(9,"h1",12),y(10),_()(),zt(11,yK,12,5,"div",13)(12,vK,2,1,"ng-template",null,0,uo),_(),v(14,"div",14),zt(15,_K,8,2,"div",15)(16,AK,35,28,"ng-template",null,1,uo),_()()()()),t&2){let r=tr(13),o=tr(17);m(8),V(" ",i.settings.t("BACK_TO_DEFENSE")," "),m(2),V(" ",i.settings.t("MASTERIES")," "),m(),Ce("ngIf",i.profile())("ngIfElse",r),m(4),Ce("ngIf",!i.user())("ngIfElse",o)}},dependencies:[Pt,Yu,hs,ya,Or],encapsulation:2})};var jO=[{path:"",component:N0},{path:"shape-tactics",component:_0},{path:"tower-defense",component:k0},{path:"tower-defense-leaderboard",component:O0},{path:"masteries",component:F0},{path:"feedback",component:M0},{path:"roadmap",component:R0}];var HO={providers:[kv(),Sb(jO),XM(JM())]};var L0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=It({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,i){t&1&&(v(0,"h1",0),y(1,"Turn-Based Strategy"),_(),W(2,"router-outlet"))},dependencies:[gd],encapsulation:2})};QE(L0,HO).catch(n=>console.error(n));
