var WO=Object.defineProperty,qO=Object.defineProperties;var KO=Object.getOwnPropertyDescriptors;var wh=Object.getOwnPropertySymbols;var IS=Object.prototype.hasOwnProperty,TS=Object.prototype.propertyIsEnumerable;var SS=(n,e,t)=>e in n?WO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||={})IS.call(e,t)&&SS(n,t,e[t]);if(wh)for(var t of wh(e))TS.call(e,t)&&SS(n,t,e[t]);return n},ue=(n,e)=>qO(n,KO(e));var $a=(n,e)=>{var t={};for(var i in n)IS.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&wh)for(var i of wh(n))e.indexOf(i)<0&&TS.call(n,i)&&(t[i]=n[i]);return t};var Fn=null,xh=!1,K0=1,YO=null,Qn=Symbol("SIGNAL");function Ue(n){let e=Fn;return Fn=n,e}function Ih(){return Fn}var Fc={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Lc(n){if(xh)throw new Error("");if(Fn===null)return;Fn.consumerOnSignalRead(n);let e=Fn.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Fn.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Fn.producers,t!==void 0&&t.producer===n)){Fn.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Fn&&(!i||JO(r,Fn)))return;let o=Ga(Fn),s={producer:n,consumer:Fn,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Fn.producersTail=s,e!==void 0?e.nextProducer=s:Fn.producers=s,o&&MS(n,s)}function CS(){K0++}function Y0(n){if(!(Ga(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===K0)){if(!n.producerMustRecompute(n)&&!Ch(n)){q0(n);return}n.producerRecomputeValue(n),q0(n)}}function Q0(n){if(n.consumers===void 0)return;let e=xh;xh=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||QO(i)}}finally{xh=e}}function J0(){return Fn?.consumerAllowSignalWrites!==!1}function QO(n){n.dirty=!0,Q0(n),n.consumerMarkedDirty?.(n)}function q0(n){n.dirty=!1,n.lastCleanEpoch=K0}function Vc(n){return n&&DS(n),Ue(n)}function DS(n){n.producersTail=void 0,n.recomputing=!0}function Th(n,e){Ue(e),n&&AS(n)}function AS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Ga(n))do t=Z0(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Ch(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(Y0(t),i!==t.version))return!0}return!1}function Uc(n){if(Ga(n)){let e=n.producers;for(;e!==void 0;)e=Z0(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function MS(n,e){let t=n.consumersTail,i=Ga(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)MS(r.producer,r)}function Z0(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Ga(e)){let o=e.producers;for(;o!==void 0;)o=Z0(o)}return t}function Ga(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function X0(n){YO?.(n)}function JO(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function ey(n,e){return Object.is(n,e)}function Dh(n,e){let t=Object.create(ZO);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(Y0(t),Lc(t),t.value===Sh)throw t.error;return t.value};return i[Qn]=t,X0(t),i}var z0=Symbol("UNSET"),W0=Symbol("COMPUTING"),Sh=Symbol("ERRORED"),ZO=ue(F({},Fc),{value:z0,dirty:!0,error:null,equal:ey,kind:"computed",producerMustRecompute(n){return n.value===z0||n.value===W0},producerRecomputeValue(n){if(n.value===W0)throw new Error("");let e=n.value;n.value=W0;let t=Vc(n),i,r=!1;try{i=n.computation(),Ue(null),r=e!==z0&&e!==Sh&&i!==Sh&&n.equal(e,i)}catch(o){i=Sh,n.error=o}finally{Th(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function XO(){throw new Error}var RS=XO;function PS(n){RS(n)}function ty(n){RS=n}var e4=null;function ny(n,e){let t=Object.create(Ah);t.value=n,e!==void 0&&(t.equal=e);let i=()=>NS(t);return i[Qn]=t,X0(t),[i,s=>Bc(t,s),s=>kS(t,s)]}function NS(n){return Lc(n),n.value}function Bc(n,e){J0()||PS(n),n.equal(n.value,e)||(n.value=e,t4(n))}function kS(n,e){J0()||PS(n),Bc(n,e(n.value))}var Ah=ue(F({},Fc),{equal:ey,value:void 0,kind:"signal"});function t4(n){n.version++,CS(),Q0(n),e4?.(n)}function iy(n){let e=Ue(null);try{return n()}finally{Ue(e)}}function Ke(n){return typeof n=="function"}function za(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Mh=za(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Rs(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var gn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ke(i))try{i()}catch(o){e=o instanceof Mh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{OS(o)}catch(s){e=e??[],s instanceof Mh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Mh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)OS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Rs(t,e)}remove(e){let{_finalizers:t}=this;t&&Rs(t,e),e instanceof n&&e._removeParent(this)}};gn.EMPTY=(()=>{let n=new gn;return n.closed=!0,n})();var ry=gn.EMPTY;function Rh(n){return n instanceof gn||n&&"closed"in n&&Ke(n.remove)&&Ke(n.add)&&Ke(n.unsubscribe)}function OS(n){Ke(n)?n():n.unsubscribe()}var ji={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Wa={setTimeout(n,e,...t){let{delegate:i}=Wa;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Wa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ph(n){Wa.setTimeout(()=>{let{onUnhandledError:e}=ji;if(e)e(n);else throw n})}function jc(){}var FS=oy("C",void 0,void 0);function LS(n){return oy("E",void 0,n)}function VS(n){return oy("N",n,void 0)}function oy(n,e,t){return{kind:n,value:e,error:t}}var Ps=null;function qa(n){if(ji.useDeprecatedSynchronousErrorHandling){let e=!Ps;if(e&&(Ps={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Ps;if(Ps=null,t)throw i}}else n()}function US(n){ji.useDeprecatedSynchronousErrorHandling&&Ps&&(Ps.errorThrown=!0,Ps.error=n)}var Ns=class extends gn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Rh(e)&&e.add(this)):this.destination=r4}static create(e,t,i){return new Ka(e,t,i)}next(e){this.isStopped?ay(VS(e),this):this._next(e)}error(e){this.isStopped?ay(LS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ay(FS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},n4=Function.prototype.bind;function sy(n,e){return n4.call(n,e)}var ly=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Nh(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Nh(i)}else Nh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Nh(t)}}},Ka=class extends Ns{constructor(e,t,i){super();let r;if(Ke(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&ji.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&sy(e.next,o),error:e.error&&sy(e.error,o),complete:e.complete&&sy(e.complete,o)}):r=e}this.destination=new ly(r)}};function Nh(n){ji.useDeprecatedSynchronousErrorHandling?US(n):Ph(n)}function i4(n){throw n}function ay(n,e){let{onStoppedNotification:t}=ji;t&&Wa.setTimeout(()=>t(n,e))}var r4={closed:!0,next:jc,error:i4,complete:jc};var Ya=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Hi(n){return n}function cy(...n){return uy(n)}function uy(n){return n.length===0?Hi:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var ot=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=s4(t)?t:new Ka(t,i,r);return qa(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=BS(i),new i((r,o)=>{let s=new Ka({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Ya](){return this}pipe(...t){return uy(t)(this)}toPromise(t){return t=BS(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function BS(n){var e;return(e=n??ji.Promise)!==null&&e!==void 0?e:Promise}function o4(n){return n&&Ke(n.next)&&Ke(n.error)&&Ke(n.complete)}function s4(n){return n&&n instanceof Ns||o4(n)&&Rh(n)}function a4(n){return Ke(n?.lift)}function ht(n){return e=>{if(a4(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ft(n,e,t,i,r){return new dy(n,e,t,i,r)}var dy=class extends Ns{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var jS=za(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ut=(()=>{class n extends ot{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new kh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new jS}next(t){qa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){qa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){qa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?ry:(this.currentObservers=null,o.push(t),new gn(()=>{this.currentObservers=null,Rs(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new ot;return t.source=this,t}}return n.create=(e,t)=>new kh(e,t),n})(),kh=class extends Ut{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:ry}};var Mn=class extends Ut{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var hy={now(){return(hy.delegate||Date).now()},delegate:void 0};var Oh=class extends gn{constructor(e,t){super()}schedule(e,t=0){return this}};var Hc={setInterval(n,e,...t){let{delegate:i}=Hc;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Hc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Fh=class extends Oh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return Hc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Hc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Rs(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Qa=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};Qa.now=hy.now;var Lh=class extends Qa{constructor(e,t=Qa.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var HS=new Lh(Fh);var Rn=new ot(n=>n.complete());function $S(n){return n&&Ke(n.schedule)}function GS(n){return n[n.length-1]}function Vh(n){return Ke(GS(n))?n.pop():void 0}function Vo(n){return $S(GS(n))?n.pop():void 0}function WS(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(h){s(h)}}function l(d){try{c(i.throw(d))}catch(h){s(h)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function zS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ks(n){return this instanceof ks?(this.v=n,this):new ks(n)}function qS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(g){return function(x){return Promise.resolve(x).then(g,h)}}function a(g,x){i[g]&&(r[g]=function(S){return new Promise(function(N,U){o.push([g,S,N,U])>1||l(g,S)})},x&&(r[g]=x(r[g])))}function l(g,x){try{c(i[g](x))}catch(S){p(o[0][3],S)}}function c(g){g.value instanceof ks?Promise.resolve(g.value.v).then(d,h):p(o[0][2],g)}function d(g){l("next",g)}function h(g){l("throw",g)}function p(g,x){g(x),o.shift(),o.length&&l(o[0][0],o[0][1])}}function KS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof zS=="function"?zS(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var Uh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Bh(n){return Ke(n?.then)}function jh(n){return Ke(n[Ya])}function Hh(n){return Symbol.asyncIterator&&Ke(n?.[Symbol.asyncIterator])}function $h(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function l4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Gh=l4();function zh(n){return Ke(n?.[Gh])}function Wh(n){return qS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield ks(t.read());if(r)return yield ks(void 0);yield yield ks(i)}}finally{t.releaseLock()}})}function qh(n){return Ke(n?.getReader)}function sn(n){if(n instanceof ot)return n;if(n!=null){if(jh(n))return c4(n);if(Uh(n))return u4(n);if(Bh(n))return d4(n);if(Hh(n))return YS(n);if(zh(n))return h4(n);if(qh(n))return f4(n)}throw $h(n)}function c4(n){return new ot(e=>{let t=n[Ya]();if(Ke(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function u4(n){return new ot(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function d4(n){return new ot(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ph)})}function h4(n){return new ot(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function YS(n){return new ot(e=>{p4(n,e).catch(t=>e.error(t))})}function f4(n){return YS(Wh(n))}function p4(n,e){var t,i,r,o;return WS(this,void 0,void 0,function*(){try{for(t=KS(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function Jn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Kh(n,e=0){return ht((t,i)=>{t.subscribe(ft(i,r=>Jn(i,n,()=>i.next(r),e),()=>Jn(i,n,()=>i.complete(),e),r=>Jn(i,n,()=>i.error(r),e)))})}function Yh(n,e=0){return ht((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function QS(n,e){return sn(n).pipe(Yh(e),Kh(e))}function JS(n,e){return sn(n).pipe(Yh(e),Kh(e))}function ZS(n,e){return new ot(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function XS(n,e){return new ot(t=>{let i;return Jn(t,e,()=>{i=n[Gh](),Jn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Ke(i?.return)&&i.return()})}function Qh(n,e){if(!n)throw new Error("Iterable cannot be null");return new ot(t=>{Jn(t,e,()=>{let i=n[Symbol.asyncIterator]();Jn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function eI(n,e){return Qh(Wh(n),e)}function tI(n,e){if(n!=null){if(jh(n))return QS(n,e);if(Uh(n))return ZS(n,e);if(Bh(n))return JS(n,e);if(Hh(n))return Qh(n,e);if(zh(n))return XS(n,e);if(qh(n))return eI(n,e)}throw $h(n)}function an(n,e){return e?tI(n,e):sn(n)}function nt(...n){let e=Vo(n);return an(n,e)}function fy(n,e){let t=Ke(n)?n:()=>n,i=r=>r.error(t());return new ot(e?r=>e.schedule(i,0,r):i)}function Jh(n){return!!n&&(n instanceof ot||Ke(n.lift)&&Ke(n.subscribe))}var Os=za(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function yt(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:g4}=Array;function m4(n,e){return g4(e)?n(...e):n(e)}function Zh(n){return yt(e=>m4(n,e))}var{isArray:y4}=Array,{getPrototypeOf:v4,prototype:_4,keys:E4}=Object;function Xh(n){if(n.length===1){let e=n[0];if(y4(e))return{args:e,keys:null};if(b4(e)){let t=E4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function b4(n){return n&&typeof n=="object"&&v4(n)===_4}function ef(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function $c(...n){let e=Vo(n),t=Vh(n),{args:i,keys:r}=Xh(n);if(i.length===0)return an([],e);let o=new ot(w4(i,e,r?s=>ef(r,s):Hi));return t?o.pipe(Zh(t)):o}function w4(n,e,t=Hi){return i=>{nI(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let l=0;l<r;l++)nI(e,()=>{let c=an(n[l],e),d=!1;c.subscribe(ft(i,h=>{o[l]=h,d||(d=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function nI(n,e,t){n?Jn(t,n,e):e()}function iI(n,e,t,i,r,o,s,a){let l=[],c=0,d=0,h=!1,p=()=>{h&&!l.length&&!c&&e.complete()},g=S=>c<i?x(S):l.push(S),x=S=>{o&&e.next(S),c++;let N=!1;sn(t(S,d++)).subscribe(ft(e,U=>{r?.(U),o?g(U):e.next(U)},()=>{N=!0},void 0,()=>{if(N)try{for(c--;l.length&&c<i;){let U=l.shift();s?Jn(e,s,()=>x(U)):x(U)}p()}catch(U){e.error(U)}}))};return n.subscribe(ft(e,g,()=>{h=!0,p()})),()=>{a?.()}}function $n(n,e,t=1/0){return Ke(e)?$n((i,r)=>yt((o,s)=>e(i,o,r,s))(sn(n(i,r))),t):(typeof e=="number"&&(t=e),ht((i,r)=>iI(i,r,n,t)))}function rI(n=1/0){return $n(Hi,n)}function oI(){return rI(1)}function Uo(...n){return oI()(an(n,Vo(n)))}function Gc(n){return new ot(e=>{sn(n()).subscribe(e)})}function py(...n){let e=Vh(n),{args:t,keys:i}=Xh(n),r=new ot(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let d=0;d<s;d++){let h=!1;sn(t[d]).subscribe(ft(o,p=>{h||(h=!0,c--),a[d]=p},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?ef(i,a):a),o.complete())}))}});return e?r.pipe(Zh(e)):r}function $i(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>n.call(e,o,r++)&&i.next(o)))})}function zc(n){return ht((e,t)=>{let i=null,r=!1,o;i=e.subscribe(ft(t,void 0,void 0,s=>{o=sn(n(s,zc(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function tf(n,e){return Ke(e)?$n(n,e,1):$n(n,1)}function gy(n,e=HS){return ht((t,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let c=o;o=null,i.next(c)}};function l(){let c=s+n,d=e.now();if(d<c){r=this.schedule(void 0,c-d),i.add(r);return}a()}t.subscribe(ft(i,c=>{o=c,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function sI(n){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Gi(n){return n<=0?()=>Rn:ht((e,t)=>{let i=0;e.subscribe(ft(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function aI(n=x4){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function x4(){return new Os}function my(n){return ht((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function qr(n,e){let t=arguments.length>=2;return i=>i.pipe(n?$i((r,o)=>n(r,o,i)):Hi,Gi(1),t?sI(e):aI(()=>new Os))}function nf(n){return n<=0?()=>Rn:ht((e,t)=>{let i=[];e.subscribe(ft(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function yy(n){return $i((e,t)=>n<=t)}function Wc(...n){let e=Vo(n);return ht((t,i)=>{(e?Uo(n,t,e):Uo(n,t)).subscribe(i)})}function Kr(n,e){return ht((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(ft(i,l=>{r?.unsubscribe();let c=0,d=o++;sn(n(l,d)).subscribe(r=ft(i,h=>i.next(e?e(l,h,d,c++):h),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Fs(n){return ht((e,t)=>{sn(n).subscribe(ft(t,()=>t.complete(),jc)),!t.closed&&e.subscribe(t)})}function dr(n,e,t){let i=Ke(n)||e||t?{next:n,error:e,complete:t}:n;return i?ht((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(ft(o,l=>{var c;(c=i.next)===null||c===void 0||c.call(i,l),o.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),o.complete()},l=>{var c;a=!1,(c=i.error)===null||c===void 0||c.call(i,l),o.error(l)},()=>{var l,c;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(c=i.finalize)===null||c===void 0||c.call(i)}))}):Hi}var vy;function rf(){return vy}function hr(n){let e=vy;return vy=n,e}var lI=Symbol("NotFound");function Ja(n){return n===lI||n?.name==="\u0275NotFound"}var cf="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",pe=class extends Error{code;constructor(e,t){super(Jr(e,t)),this.code=e}};function T4(n){return`NG0${Math.abs(n)}`}function Jr(n,e){return`${T4(n)}${e?": "+e:""}`}var pr=globalThis;function vt(n){for(let e in n)if(n[e]===vt)return e;throw Error("")}function fI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Qr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Qr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function uf(n,e){return n?e?`${n} ${e}`:n:e||""}var C4=vt({__forward_ref__:vt});function $o(n){return n.__forward_ref__=$o,n.toString=function(){return Qr(this())},n}function Pn(n){return Ny(n)?n():n}function Ny(n){return typeof n=="function"&&n.hasOwnProperty(C4)&&n.__forward_ref__===$o}function ce(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function gr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Zc(n){return D4(n,df)}function ky(n){return Zc(n)!==null}function D4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function A4(n){let e=n?.[df]??null;return e||null}function Ey(n){return n&&n.hasOwnProperty(sf)?n[sf]:null}var df=vt({\u0275prov:vt}),sf=vt({\u0275inj:vt}),_e=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ce({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Oy(n){return n&&!!n.\u0275providers}var Fy=vt({\u0275cmp:vt}),Ly=vt({\u0275dir:vt}),Vy=vt({\u0275pipe:vt}),Uy=vt({\u0275mod:vt}),Kc=vt({\u0275fac:vt}),js=vt({__NG_ELEMENT_ID__:vt}),cI=vt({__NG_ENV_ID__:vt});function By(n){return ff(n,"@NgModule"),n[Uy]||null}function Zr(n){return ff(n,"@Component"),n[Fy]||null}function hf(n){return ff(n,"@Directive"),n[Ly]||null}function jy(n){return ff(n,"@Pipe"),n[Vy]||null}function ff(n,e){if(n==null)throw new pe(-919,!1)}function zi(n){return typeof n=="string"?n:n==null?"":String(n)}function pI(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():zi(n)}var gI=vt({ngErrorCode:vt}),M4=vt({ngErrorMessage:vt}),R4=vt({ngTokenPath:vt});function Hy(n,e){return mI("",-200,e)}function pf(n,e){throw new pe(-201,!1)}function mI(n,e,t){let i=new pe(e,n);return i[gI]=e,i[M4]=n,t&&(i[R4]=t),i}function P4(n){return n[gI]}var by;function yI(){return by}function Gn(n){let e=by;return by=n,e}function $y(n,e,t){let i=Zc(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;pf(n,"")}var N4={},Ls=N4,k4="__NG_DI_FLAG__",wy=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Vs(t)||0;try{return this.injector.get(e,i&8?null:Ls,i)}catch(r){if(Ja(r))return r;throw r}}};function O4(n,e=0){let t=rf();if(t===void 0)throw new pe(-203,!1);if(t===null)return $y(n,void 0,e);{let i=F4(e),r=t.retrieve(n,i);if(Ja(r)){if(i.optional)return null;throw r}return r}}function De(n,e=0){return(yI()||O4)(Pn(n),e)}function z(n,e){return De(n,Vs(e))}function Vs(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function F4(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function xy(n){let e=[];for(let t=0;t<n.length;t++){let i=Pn(n[t]);if(Array.isArray(i)){if(i.length===0)throw new pe(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],l=L4(a);typeof l=="number"?l===-1?r=a.token:o|=l:r=a}e.push(De(r,o))}else e.push(De(i))}return e}function L4(n){return n[k4]}function Bo(n,e){let t=n.hasOwnProperty(Kc);return t?n[Kc]:null}function vI(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function _I(n){return n.flat(Number.POSITIVE_INFINITY)}function gf(n,e){n.forEach(t=>Array.isArray(t)?gf(t,e):e(t))}function Gy(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Xc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function EI(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function mf(n,e,t){let i=Xa(n,e);return i>=0?n[i|1]=t:(i=~i,EI(n,i,e,t)),i}function yf(n,e){let t=Xa(n,e);if(t>=0)return n[t|1]}function Xa(n,e){return V4(n,e,1)}function V4(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var Go={},zn=[],mr=new _e(""),zy=new _e("",-1),Wy=new _e(""),Yc=class{get(e,t=Ls){if(t===Ls){let r=mI("",-201);throw r.name="\u0275NotFound",r}return t}};function yr(n){return{\u0275providers:n}}function bI(n){return yr([{provide:mr,multi:!0,useValue:n}])}function wI(...n){return{\u0275providers:vf(!0,n),\u0275fromNgModule:!0}}function vf(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return gf(e,s=>{let a=s;af(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&xI(r,o),t}function xI(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];qy(r,o=>{e(o,i)})}}function af(n,e,t,i){if(n=Pn(n),!n)return!1;let r=null,o=Ey(n),s=!o&&Zr(n);if(!o&&!s){let l=n.ngModule;if(o=Ey(l),o)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)af(c,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let c;gf(o.imports,d=>{af(d,e,t,i)&&(c||=[],c.push(d))}),c!==void 0&&xI(c,e)}if(!a){let c=Bo(r)||(()=>new r);e({provide:r,useFactory:c,deps:zn},r),e({provide:Wy,useValue:r,multi:!0},r),e({provide:mr,useValue:()=>De(r),multi:!0},r)}let l=o.providers;if(l!=null&&!a){let c=n;qy(l,d=>{e(d,c)})}}else return!1;return r!==n&&n.providers!==void 0}function qy(n,e){for(let t of n)Oy(t)&&(t=t.\u0275providers),Array.isArray(t)?qy(t,e):e(t)}var U4=vt({provide:String,useValue:vt});function SI(n){return n!==null&&typeof n=="object"&&U4 in n}function B4(n){return!!(n&&n.useExisting)}function j4(n){return!!(n&&n.useFactory)}function Us(n){return typeof n=="function"}function II(n){return!!n.useClass}var eu=new _e(""),of={},uI={},_y;function tu(){return _y===void 0&&(_y=new Yc),_y}var qt=class{},Bs=class extends qt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,Iy(e,s=>this.processProvider(s)),this.records.set(zy,Za(void 0,this)),r.has("environment")&&this.records.set(qt,Za(void 0,this));let o=this.records.get(eu);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Wy,zn,{self:!0}))}retrieve(e,t){let i=Vs(t)||0;try{return this.get(e,Ls,i)}catch(r){if(Ja(r))return r;throw r}}destroy(){qc(this),this._destroyed=!0;let e=Ue(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ue(e)}}onDestroy(e){return qc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){qc(this);let t=hr(this),i=Gn(void 0),r;try{return e()}finally{hr(t),Gn(i)}}get(e,t=Ls,i){if(qc(this),e.hasOwnProperty(cI))return e[cI](this);let r=Vs(i),o,s=hr(this),a=Gn(void 0);try{if(!(r&4)){let c=this.records.get(e);if(c===void 0){let d=W4(e)&&Zc(e);d&&this.injectableDefInScope(d)?c=Za(Sy(e),of):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let l=r&2?tu():this.parent;return t=r&8&&t===Ls?null:t,l.get(e,t)}catch(l){let c=P4(l);throw c===-200||c===-201?new pe(c,null):l}finally{Gn(a),hr(s)}}resolveInjectorInitializers(){let e=Ue(null),t=hr(this),i=Gn(void 0),r;try{let o=this.get(mr,zn,{self:!0});for(let s of o)s()}finally{hr(t),Gn(i),Ue(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Qr(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Pn(e);let t=Us(e)?e:Pn(e&&e.provide),i=$4(e);if(!Us(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Za(void 0,of,!0),r.factory=()=>xy(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Ue(null);try{if(t.value===uI)throw Hy(Qr(e));return t.value===of&&(t.value=uI,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&z4(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ue(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Pn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Sy(n){let e=Zc(n),t=e!==null?e.factory:Bo(n);if(t!==null)return t;if(n instanceof _e)throw new pe(204,!1);if(n instanceof Function)return H4(n);throw new pe(204,!1)}function H4(n){if(n.length>0)throw new pe(204,!1);let t=A4(n);return t!==null?()=>t.factory(n):()=>new n}function $4(n){if(SI(n))return Za(void 0,n.useValue);{let e=Ky(n);return Za(e,of)}}function Ky(n,e,t){let i;if(Us(n)){let r=Pn(n);return Bo(r)||Sy(r)}else if(SI(n))i=()=>Pn(n.useValue);else if(j4(n))i=()=>n.useFactory(...xy(n.deps||[]));else if(B4(n))i=(r,o)=>De(Pn(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Pn(n&&(n.useClass||n.provide));if(G4(n))i=()=>new r(...xy(n.deps));else return Bo(r)||Sy(r)}return i}function qc(n){if(n.destroyed)throw new pe(205,!1)}function Za(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function G4(n){return!!n.deps}function z4(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function W4(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Iy(n,e){for(let t of n)Array.isArray(t)?Iy(t,e):t&&Oy(t)?Iy(t.\u0275providers,e):e(t)}function Nn(n,e){let t;n instanceof Bs?(qc(n),t=n):t=new wy(n);let i,r=hr(t),o=Gn(void 0);try{return e()}finally{hr(r),Gn(o)}}function TI(){return yI()!==void 0||rf()!=null}var qn=0,Ce=1,$e=2,Jt=3,Si=4,Ii=5,Zn=6,el=7,Zt=8,li=9,vr=10,xt=11,tl=12,Yy=13,Hs=14,Kn=15,zo=16,$s=17,_r=18,Xr=19,Qy=20,Yr=21,_f=22,nu=23,ci=24,Gs=25,zs=26,ut=27,CI=1,Wi=6,Er=7,iu=8,Ws=9,$t=10;function ui(n){return Array.isArray(n)&&typeof n[CI]=="object"}function di(n){return Array.isArray(n)&&n[CI]===!0}function Jy(n){return(n.flags&4)!==0}function eo(n){return n.componentOffset>-1}function ru(n){return(n.flags&1)===1}function br(n){return!!n.template}function qs(n){return(n[$e]&512)!==0}function Wo(n){return(n[$e]&256)===256}var Zy="svg",DI="math";function hi(n){for(;Array.isArray(n);)n=n[qn];return n}function Xy(n,e){return hi(e[n])}function Ti(n,e){return hi(e[n.index])}function Ks(n,e){return n.data[e]}function ou(n,e){return n[e]}function su(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Ci(n,e){let t=e[n];return ui(t)?t:t[qn]}function AI(n){return(n[$e]&4)===4}function Ef(n){return(n[$e]&128)===128}function MI(n){return di(n[Jt])}function Di(n,e){return e==null?null:n[e]}function ev(n){n[$s]=0}function tv(n){n[$e]&1024||(n[$e]|=1024,Ef(n)&&nl(n))}function RI(n,e){for(;n>0;)e=e[Hs],n--;return e}function au(n){return!!(n[$e]&9216||n[ci]?.dirty)}function bf(n){n[vr].changeDetectionScheduler?.notify(8),n[$e]&64&&(n[$e]|=1024),au(n)&&nl(n)}function nl(n){n[vr].changeDetectionScheduler?.notify(0);let e=jo(n);for(;e!==null&&!(e[$e]&8192||(e[$e]|=8192,!Ef(e)));)e=jo(e)}function nv(n,e){if(Wo(n))throw new pe(911,!1);n[Yr]===null&&(n[Yr]=[]),n[Yr].push(e)}function PI(n,e){if(n[Yr]===null)return;let t=n[Yr].indexOf(e);t!==-1&&n[Yr].splice(t,1)}function jo(n){let e=n[Jt];return di(e)?e[Jt]:e}function iv(n){return n[el]??=[]}function rv(n){return n.cleanup??=[]}function NI(n,e,t,i){let r=iv(e);r.push(t),n.firstCreatePass&&rv(n).push(i,r.length-1)}var Ye={lFrame:zI(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Ty=!1;function kI(){return Ye.lFrame.elementDepthCount}function OI(){Ye.lFrame.elementDepthCount++}function ov(){Ye.lFrame.elementDepthCount--}function sv(){return Ye.bindingsEnabled}function av(){return Ye.skipHydrationRootTNode!==null}function lv(n){return Ye.skipHydrationRootTNode===n}function FI(n){Ye.skipHydrationRootTNode=n}function cv(){Ye.skipHydrationRootTNode=null}function Be(){return Ye.lFrame.lView}function Xt(){return Ye.lFrame.tView}function re(n){return Ye.lFrame.contextLView=n,n[Zt]}function oe(n){return Ye.lFrame.contextLView=null,n}function Ln(){let n=uv();for(;n!==null&&n.type===64;)n=n.parent;return n}function uv(){return Ye.lFrame.currentTNode}function LI(){let n=Ye.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ys(n,e){let t=Ye.lFrame;t.currentTNode=n,t.isParent=e}function dv(){return Ye.lFrame.isParent}function VI(){Ye.lFrame.isParent=!1}function hv(){return Ye.lFrame.contextLView}function fv(){return Ty}function pv(n){let e=Ty;return Ty=n,e}function lu(){let n=Ye.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function gv(){return Ye.lFrame.bindingIndex}function UI(n){return Ye.lFrame.bindingIndex=n}function Qs(){return Ye.lFrame.bindingIndex++}function cu(n){let e=Ye.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function BI(){return Ye.lFrame.inI18n}function jI(n,e){let t=Ye.lFrame;t.bindingIndex=t.bindingRootIndex=n,wf(e)}function HI(){return Ye.lFrame.currentDirectiveIndex}function wf(n){Ye.lFrame.currentDirectiveIndex=n}function $I(n){let e=Ye.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function mv(){return Ye.lFrame.currentQueryIndex}function xf(n){Ye.lFrame.currentQueryIndex=n}function q4(n){let e=n[Ce];return e.type===2?e.declTNode:e.type===1?n[Ii]:null}function yv(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=q4(o),r===null||(o=o[Hs],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Ye.lFrame=GI();return i.currentTNode=e,i.lView=n,!0}function Sf(n){let e=GI(),t=n[Ce];Ye.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function GI(){let n=Ye.lFrame,e=n===null?null:n.child;return e===null?zI(n):e}function zI(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function WI(){let n=Ye.lFrame;return Ye.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var vv=WI;function If(){let n=WI();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function qI(n){return(Ye.lFrame.contextLView=RI(n,Ye.lFrame.contextLView))[Zt]}function Ai(){return Ye.lFrame.selectedIndex}function qo(n){Ye.lFrame.selectedIndex=n}function _v(){let n=Ye.lFrame;return Ks(n.tView,n.selectedIndex)}function X(){Ye.lFrame.currentNamespace=Zy}function Re(){K4()}function K4(){Ye.lFrame.currentNamespace=null}function Ev(){return Ye.lFrame.currentNamespace}var KI=!0;function Tf(){return KI}function to(n){KI=n}function Cy(n,e=null,t=null,i){let r=bv(n,e,t,i);return r.resolveInjectorInitializers(),r}function bv(n,e=null,t=null,i,r=new Set){let o=[t||zn,wI(n)];return i=i||(typeof n=="object"?void 0:Qr(n)),new Bs(o,e||tu(),i||null,r)}var Wn=class n{static THROW_IF_NOT_FOUND=Ls;static NULL=new Yc;static create(e,t){if(Array.isArray(e))return Cy({name:""},t,e,"");{let i=e.name??"";return Cy({name:i},e.parent,e.providers,i)}}static \u0275prov=ce({token:n,providedIn:"any",factory:()=>De(zy)});static __NG_ELEMENT_ID__=-1},Kt=new _e(""),Xn=(()=>{class n{static __NG_ELEMENT_ID__=Y4;static __NG_ENV_ID__=t=>t}return n})(),Dy=class extends Xn{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Wo(this._lView)}onDestroy(e){let t=this._lView;return nv(t,e),()=>PI(t,e)}};function Y4(){return new Dy(Be())}var YI=!1,QI=new _e(""),wr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Mn(!1);debugTaskTracker=z(QI,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new ot(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=ce({token:n,providedIn:"root",factory:()=>new n})}return n})(),Ay=class extends Ut{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,TI()&&(this.destroyRef=z(Xn,{optional:!0})??void 0,this.pendingTasks=z(wr,{optional:!0})??void 0)}emit(e){let t=Ue(null);try{super.next(e)}finally{Ue(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof gn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},ln=Ay;function lf(...n){}function wv(n){let e,t;function i(){n=lf;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function JI(n){return queueMicrotask(()=>n()),()=>{n=lf}}var xv="isAngularZone",Qc=xv+"_ID",Q4=0,mn=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ln(!1);onMicrotaskEmpty=new ln(!1);onStable=new ln(!1);onError=new ln(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=YI}=e;if(typeof Zone>"u")throw new pe(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,X4(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(xv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new pe(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new pe(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,J4,lf,lf);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},J4={};function Sv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Z4(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){wv(()=>{n.callbackScheduled=!1,My(n),n.isCheckStableRunning=!0,Sv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),My(n)}function X4(n){let e=()=>{Z4(n)},t=Q4++;n._inner=n._inner.fork({name:"angular",properties:{[xv]:!0,[Qc]:t,[Qc+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(eF(l))return i.invokeTask(o,s,a,l);try{return dI(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),hI(n)}},onInvoke:(i,r,o,s,a,l,c)=>{try{return dI(n),i.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!tF(l)&&e(),hI(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,My(n),Sv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function My(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function dI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function hI(n){n._nesting--,Sv(n)}var Jc=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ln;onMicrotaskEmpty=new ln;onStable=new ln;onError=new ln;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function eF(n){return ZI(n,"__ignore_ng_zone__")}function tF(n){return ZI(n,"__scheduler_tick__")}function ZI(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var fr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},fi=new _e("",{factory:()=>{let n=z(mn),e=z(qt),t;return i=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw i}):(t??=e.get(fr),t.handleError(i))})}}}),XI={provide:mr,useValue:()=>{let n=z(fr,{optional:!0})},multi:!0},nF=new _e("",{factory:()=>{let n=z(Kt).defaultView;if(!n)return;let e=z(fi),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),z(Xn).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function Iv(){return yr([bI(()=>{z(nF)})])}function $(n,e){let[t,i,r]=ny(n,e?.equal),o=t,s=o[Qn];return o.set=i,o.update=r,o.asReadonly=eT.bind(o),o}function eT(){let n=this[Qn];if(n.readonlyFn===void 0){let e=()=>this();e[Qn]=n,n.readonlyFn=e}return n.readonlyFn}var Cf=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=iF}return n})();function iF(){return new Cf(Be(),Ln())}var Ho=class{},uu=new _e("",{factory:()=>!0});var Tv=new _e(""),du=(()=>{class n{internalPendingTasks=z(wr);scheduler=z(Ho);errorHandler=z(fi);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=ce({token:n,providedIn:"root",factory:()=>new n})}return n})(),Cv=(()=>{class n{static \u0275prov=ce({token:n,providedIn:"root",factory:()=>new Ry})}return n})(),Ry=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}},Py=class{[Qn];constructor(e){this[Qn]=e}destroy(){this[Qn].destroy()}};function cn(n){return iy(n)}var Df={JSACTION:"jsaction"};function bu(n){return{toString:n}.toString()}function cF(n){return typeof n=="function"}function UT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Vf=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}},no=(()=>{let n=()=>BT;return n.ngInherit=!0,n})();function BT(n){return n.type.prototype.ngOnChanges&&(n.setInput=dF),uF}function uF(){let n=HT(this),e=n?.current;if(e){let t=n.previous;if(t===Go)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function dF(n,e,t,i,r){let o=this.declaredInputs[i],s=HT(n)||hF(n,{previous:Go,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new Vf(c&&c.currentValue,t,l===Go),UT(n,e,r,t)}var jT="__ngSimpleChanges__";function HT(n){return n[jT]||null}function hF(n,e){return n[jT]=e}var tT=[];var pt=function(n,e=null,t){for(let i=0;i<tT.length;i++){let r=tT[i];r(n,e,t)}},st=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(st||{});function fF(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=BT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function $T(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Rf(n,e,t){GT(n,e,3,t)}function Pf(n,e,t,i){(n[$e]&3)===t&&GT(n,e,t,i)}function Dv(n,e){let t=n[$e];(t&3)===e&&(t&=16383,t+=1,n[$e]=t)}function GT(n,e,t,i){let r=i!==void 0?n[$s]&65535:0,o=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(n[$s]+=65536),(a<o||o==-1)&&(pF(n,t,e,l),n[$s]=(n[$s]&4294901760)+l+2),l++}function nT(n,e){pt(st.LifecycleHookStart,n,e);let t=Ue(null);try{e.call(n)}finally{Ue(t),pt(st.LifecycleHookEnd,n,e)}}function pF(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[$e]>>14<n[$s]>>16&&(n[$e]&3)===e&&(n[$e]+=16384,nT(a,o)):nT(a,o)}var rl=-1,Xs=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function gF(n){return(n.flags&8)!==0}function mF(n){return(n.flags&16)!==0}function yF(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];vF(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function zT(n){return n===3||n===4||n===6}function vF(n){return n.charCodeAt(0)===64}function al(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?iT(n,t,r,null,e[++i]):iT(n,t,r,null,null))}}return n}function iT(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function WT(n){return n!==rl}function Uf(n){return n&32767}function _F(n){return n>>16}function Bf(n,e){let t=_F(n),i=e;for(;t>0;)i=i[Hs],t--;return i}var Hv=!0;function jf(n){let e=Hv;return Hv=n,e}var EF=256,qT=EF-1,KT=5,bF=0,xr={};function wF(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(js)&&(i=t[js]),i==null&&(i=t[js]=bF++);let r=i&qT,o=1<<r;e.data[n+(r>>KT)]|=o}function Hf(n,e){let t=YT(n,e);if(t!==-1)return t;let i=e[Ce];i.firstCreatePass&&(n.injectorIndex=e.length,Av(i.data,n),Av(e,null),Av(i.blueprint,null));let r=y_(n,e),o=n.injectorIndex;if(WT(r)){let s=Uf(r),a=Bf(r,e),l=a[Ce].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=r,o}function Av(n,e){n.push(0,0,0,0,0,0,0,0,e)}function YT(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function y_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=eC(r),i===null)return rl;if(t++,r=r[Hs],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return rl}function $v(n,e,t){wF(n,e,t)}function xF(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(zT(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function QT(n,e,t){if(t&8||n!==void 0)return n;pf(e,"NodeInjector")}function JT(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[li],o=Gn(void 0);try{return r?r.get(e,i,t&8):$y(e,i,t&8)}finally{Gn(o)}}return QT(i,e,t)}function ZT(n,e,t,i=0,r){if(n!==null){if(e[$e]&2048&&!(i&2)){let s=CF(n,e,t,i,xr);if(s!==xr)return s}let o=XT(n,e,t,i,xr);if(o!==xr)return o}return JT(e,t,i,r)}function XT(n,e,t,i,r){let o=IF(t);if(typeof o=="function"){if(!yv(e,n,i))return i&1?QT(r,t,i):JT(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))pf(t);else return s}finally{vv()}}else if(typeof o=="number"){let s=null,a=YT(n,e),l=rl,c=i&1?e[Kn][Ii]:null;for((a===-1||i&4)&&(l=a===-1?y_(n,e):e[a+8],l===rl||!oT(i,!1)?a=-1:(s=e[Ce],a=Uf(l),e=Bf(l,e)));a!==-1;){let d=e[Ce];if(rT(o,a,d.data)){let h=SF(a,e,t,s,i,c);if(h!==xr)return h}l=e[a+8],l!==rl&&oT(i,e[Ce].data[a+8]===c)&&rT(o,a,e)?(s=d,a=Uf(l),e=Bf(l,e)):a=-1}}return r}function SF(n,e,t,i,r,o){let s=e[Ce],a=s.data[n+8],l=i==null?eo(a)&&Hv:i!=s&&(a.type&3)!==0,c=r&1&&o===a,d=Nf(a,s,t,l,c);return d!==null?gu(e,s,d,a,r):xr}function Nf(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,d=o>>20,h=i?a:a+d,p=r?a+d:c;for(let g=h;g<p;g++){let x=s[g];if(g<l&&t===x||g>=l&&x.type===t)return g}if(r){let g=s[l];if(g&&br(g)&&g.type===t)return l}return null}function gu(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof Xs){let a=o;if(a.resolving){let g=pI(s[t]);throw Hy(g)}let l=jf(a.canSeeViewProviders);a.resolving=!0;let c=s[t].type||s[t],d,h=a.injectImpl?Gn(a.injectImpl):null,p=yv(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&fF(t,s[t],e)}finally{h!==null&&Gn(h),jf(l),a.resolving=!1,vv()}}return o}function IF(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(js)?n[js]:void 0;return typeof e=="number"?e>=0?e&qT:TF:e}function rT(n,e,t){let i=1<<n;return!!(t[e+(n>>KT)]&i)}function oT(n,e){return!(n&2)&&!(n&1&&e)}var Zs=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return ZT(this._tNode,this._lView,e,Vs(i),t)}};function TF(){return new Zs(Ln(),Be())}function ra(n){return bu(()=>{let e=n.prototype.constructor,t=e[Kc]||Gv(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[Kc]||Gv(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Gv(n){return Ny(n)?()=>{let e=Gv(Pn(n));return e&&e()}:Bo(n)}function CF(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[$e]&2048&&!qs(s);){let a=XT(o,s,t,i|2,xr);if(a!==xr)return a;let l=o.parent;if(!l){let c=s[Qy];if(c){let d=c.get(t,xr,i);if(d!==xr)return d}l=eC(s),s=s[Hs]}o=l}return r}function eC(n){let e=n[Ce],t=e.type;return t===2?e.declTNode:t===1?n[Ii]:null}function wu(n){return xF(Ln(),n)}function DF(){return hl(Ln(),Be())}function hl(n,e){return new Qi(Ti(n,e))}var Qi=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=DF}return n})();function AF(n){return n instanceof Qi?n.nativeElement:n}function MF(){return this._results[Symbol.iterator]()}var $f=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Ut}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=_I(e);(this._changesDetected=!vI(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=MF},tC="ngSkipHydration",RF="ngskiphydration";function nC(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let i=e[t];if(typeof i=="number")return!1;if(typeof i=="string"&&i.toLowerCase()===RF)return!0}return!1}function iC(n){return n.hasAttribute(tC)}function Gf(n){return(n.flags&128)===128}function rC(n){if(Gf(n))return!0;let e=n.parent;for(;e;){if(Gf(n)||nC(e))return!0;e=e.parent}return!1}var v_=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(v_||{}),oC=new Map,PF=0;function NF(){return PF++}function kF(n){oC.set(n[Xr],n)}function zv(n){oC.delete(n[Xr])}var sT="__ngContext__";function ll(n,e){ui(e)?(n[sT]=e[Xr],kF(e)):n[sT]=e}function sC(n){return lC(n[tl])}function aC(n){return lC(n[Si])}function lC(n){for(;n!==null&&!di(n);)n=n[Si];return n}var Wv;function __(n){Wv=n}function cC(){if(Wv!==void 0)return Wv;if(typeof document<"u")return document;throw new pe(210,!1)}var Ir=new _e("",{factory:()=>OF}),OF="ng";var sp=new _e(""),Ji=new _e("",{providedIn:"platform",factory:()=>"unknown"});var fl=new _e("",{factory:()=>z(Kt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var pl=(()=>{class n{static \u0275prov=ce({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=FF(z(Kt),z(Ir)),t}});store={};onSerializeCallbacks={};get(t,i){return this.store[t]!==void 0?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function FF(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}var uC="h",dC="b",LF="f",VF="n",hC="e",fC="t",ap="c",E_="x",mu="r",pC="i",gC="n",b_="d";var mC="di",yC="s",vC="p";var xu=new _e(""),_C=!1,w_=new _e("",{factory:()=>_C});var x_=new _e(""),EC=!1,bC=new _e("",{factory:()=>[]}),wC=new _e(""),S_=new _e("",{factory:()=>new Map});var Su="ngb";var xC=(n,e,t)=>{let i=n,r=i.__jsaction_fns??new Map,o=r.get(e)??[];o.push(t),r.set(e,o),i.__jsaction_fns=r},SC=(n,e)=>{let t=n,i=t.getAttribute(Su)??"",r=e.get(i)??new Set;r.has(t)||r.add(t),e.set(i,r)};var IC=n=>{n.removeAttribute(Df.JSACTION),n.removeAttribute(Su),n.__jsaction_fns=void 0},TC=new _e("",{factory:()=>({})});function I_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let i of t)i(n)}var qv=new Map;function CC(n,e){return qv.set(n,e),()=>qv.delete(n)}var aT=!1,DC=(n,e,t,i)=>{};function UF(n,e,t,i){DC(n,e,t,i)}function AC(){aT||(DC=(n,e,t,i)=>{let r=n[li].get(Ir);qv.get(r)?.(e,t,i)},aT=!0)}var lp=new _e("");function cp(n){return(n.flags&32)===32}var BF="__nghData__",T_=BF,jF="__nghDeferData__",MC=jF;var kf="ngh",RC="nghm",PC=()=>null;function HF(n,e,t=!1){let i=n.getAttribute(kf);if(i==null)return null;let[r,o]=i.split("|");if(i=t?o:r,!i)return null;let s=o?`|${o}`:"",a=t?r:s,l={};if(i!==""){let d=e.get(pl,null,{optional:!0});d!==null&&(l=d.get(T_,[])[Number(i)])}let c={data:l,firstChild:n.firstChild??null};return t&&(c.firstChild=n,up(c,0,n.nextSibling)),a?n.setAttribute(kf,a):n.removeAttribute(kf),c}function NC(){PC=HF}function kC(n,e,t=!1){return PC(n,e,t)}function OC(n){let e=n._lView;return e[Ce].type===2?null:(qs(e)&&(e=e[ut]),e)}function $F(n){return n.textContent?.replace(/\s/gm,"")}function GF(n){let e=cC(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=$F(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),i,r=[];for(;i=t.nextNode();)r.push(i);for(let o of r)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function up(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function Kv(n,e){return n.segmentHeads?.[e]??null}function FC(n){return n.get(wC,!1,{optional:!0})}function zF(n,e){let t=n.data,i=t[hC]?.[e]??null;return i===null&&t[ap]?.[e]&&(i=C_(n,e)),i}function LC(n,e){return n.data[ap]?.[e]??null}function C_(n,e){let t=LC(n,e)??[],i=0;for(let r of t)i+=r[mu]*(r[E_]??1);return i}function WF(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[b_];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function VC(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[b_];n.disconnectedNodes=t?new Set(t):null}return!!WF(n)?.has(e)}function dp(n,e){let t=n[Zn];return t!==null&&!av()&&!cp(e)&&!VC(t,e.index-ut)}function qF(n,e){let t=e.get(lp),r=e.get(pl).get(MC,{}),o=!1,s=n,a=null,l=[];for(;!o&&s;){o=t.has(s);let c=t.hydrating.get(s);if(a===null&&c!=null){a=c.promise;break}l.unshift(s),s=r[s][vC]}return{parentBlockPromise:a,hydrationQueue:l}}function Mv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===RC}function lT(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function UC(n){for(let i of n.body.childNodes)if(Mv(i))return;let e=lT(n.body.previousSibling);if(Mv(e))return;let t=lT(n.head.lastChild);if(!Mv(t))throw new pe(-507,!1)}function BC(n,e){let t=n.contentQueries;if(t!==null){let i=Ue(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];xf(o),a.contentQueries(2,e[s],s)}}}finally{Ue(i)}}}function Yv(n,e,t){xf(0);let i=Ue(null);try{e(n,t)}finally{Ue(i)}}function jC(n,e,t){if(Jy(e)){let i=Ue(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ue(i)}}}var Yi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Yi||{});var Af;function KF(){if(Af===void 0&&(Af=null,pr.trustedTypes))try{Af=pr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Af}function cT(n){return KF()?.createScriptURL(n)||n}var zf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${cf})`}};function gl(n){return n instanceof zf?n.changingThisBreaksApplicationSecurity:n}function hp(n,e){let t=HC(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${cf})`)}return t===e}function HC(n){return n instanceof zf&&n.getTypeName()||null}var YF=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function D_(n){return n=String(n),n.match(YF)?n:"unsafe:"+n}var QF=/^>|^->|<!--|-->|--!>|<!-$/g,JF=/(<|>)/g,ZF="\u200B$1\u200B";function XF(n){return n.replace(QF,e=>e.replace(JF,ZF))}function $C(n,e){return n.createText(e)}function e3(n,e,t){n.setValue(e,t)}function GC(n,e){return n.createComment(XF(e))}function A_(n,e,t){return n.createElement(e,t)}function Wf(n,e,t,i,r){n.insertBefore(e,t,i,r)}function zC(n,e,t){n.appendChild(e,t)}function uT(n,e,t,i,r){i!==null?Wf(n,e,t,i,r):zC(n,e,t)}function M_(n,e,t,i){n.removeChild(null,e,t,i)}function WC(n){n.textContent=""}function t3(n,e,t){n.setAttribute(e,"style",t)}function n3(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function qC(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&yF(n,e,i),r!==null&&n3(n,e,r),o!==null&&t3(n,e,o)}var Iu=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Iu||{});function Zi(n){let e=YC();return e?e.sanitize(Iu.URL,n)||"":hp(n,"URL")?gl(n):D_(zi(n))}function KC(n){let e=YC();if(e)return cT(e.sanitize(Iu.RESOURCE_URL,n)||"");if(hp(n,"ResourceURL"))return cT(gl(n));throw new pe(904,!1)}var i3=new Set(["embed","frame","iframe","media","script"]),r3=new Set(["base","link","script"]);function o3(n,e){return e==="src"&&i3.has(n)||e==="href"&&r3.has(n)||e==="xlink:href"&&n==="script"?KC:Zi}function R_(n,e,t){return o3(e,t)(n)}function YC(){let n=Be();return n&&n[vr].sanitizer}function oa(n){return n.ownerDocument.defaultView}function QC(n){return n.ownerDocument.body}function JC(n){return n instanceof Function?n():n}function s3(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var ZC="ng-template";function a3(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&s3(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(P_(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function P_(n){return n.type===4&&n.value!==ZC}function l3(n,e,t){let i=n.type===4&&!t?ZC:n.value;return e===i}function c3(n,e,t){let i=4,r=n.attrs,o=r!==null?h3(r):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!qi(i)&&!qi(l))return!1;if(s&&qi(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!l3(n,l,t)||l===""&&e.length===1){if(qi(i))return!1;s=!0}}else if(i&8){if(r===null||!a3(n,r,l,t)){if(qi(i))return!1;s=!0}}else{let c=e[++a],d=u3(l,r,P_(n),t);if(d===-1){if(qi(i))return!1;s=!0;continue}if(c!==""){let h;if(d>o?h="":h=r[d+1].toLowerCase(),i&2&&c!==h){if(qi(i))return!1;s=!0}}}}return qi(i)||s}function qi(n){return(n&1)===0}function u3(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return f3(e,n)}function d3(n,e,t=!1){for(let i=0;i<e.length;i++)if(c3(n,e[i],t))return!0;return!1}function h3(n){for(let e=0;e<n.length;e++){let t=n[e];if(zT(t))return e}return n.length}function f3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function dT(n,e){return n?":not("+e.trim()+")":e}function p3(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!qi(s)&&(e+=dT(o,r),r=""),i=s,o=o||!qi(i);t++}return r!==""&&(e+=dT(o,r)),e}function g3(n){return n.map(p3).join(",")}function m3(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!qi(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var En={};function N_(n,e,t,i,r,o,s,a,l,c,d){let h=ut+i,p=h+r,g=y3(h,p),x=typeof c=="function"?c():c;return g[Ce]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:x,incompleteFirstPass:!1,ssrId:d}}function y3(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:En);return t}function v3(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=N_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function k_(n,e,t,i,r,o,s,a,l,c,d){let h=e.blueprint.slice();return h[qn]=r,h[$e]=i|4|128|8|64|1024,(c!==null||n&&n[$e]&2048)&&(h[$e]|=2048),ev(h),h[Jt]=h[Hs]=n,h[Zt]=t,h[vr]=s||n&&n[vr],h[xt]=a||n&&n[xt],h[li]=l||n&&n[li]||null,h[Ii]=o,h[Xr]=NF(),h[Zn]=d,h[Qy]=c,h[Kn]=e.type==2?n[Kn]:h,h}function _3(n,e,t){let i=Ti(e,n),r=v3(t),o=n[vr].rendererFactory,s=O_(n,k_(n,r,null,XC(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function XC(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function eD(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function O_(n,e){return n[tl]?n[Yy][Si]=e:n[tl]=e,n[Yy]=e,e}function y(n=1){tD(Xt(),Be(),Ai()+n,!1)}function tD(n,e,t,i){if(!i)if((e[$e]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Rf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Pf(e,o,0,t)}qo(t)}var fp=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(fp||{});function Qv(n,e,t,i){let r=Ue(null);try{let[o,s,a]=n.inputs[t],l=null;(s&fp.SignalBased)!==0&&(l=e[o][Qn]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,l,i,t,o):UT(e,l,o,i)}finally{Ue(r)}}var Sr=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Sr||{}),E3;function F_(n,e){return E3(n,e)}var ea=new Set,pp=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(pp||{}),Qo=new _e(""),hT=new Set;function gi(n){hT.has(n)||(hT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var L_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=ce({token:n,providedIn:"root",factory:()=>new n})}return n})(),nD=[0,1,2,3],iD=(()=>{class n{ngZone=z(mn);scheduler=z(Ho);errorHandler=z(fr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){z(Qo,{optional:!0})}execute(){let t=this.sequences.size>0;t&&pt(st.AfterRenderHooksStart),this.executing=!0;for(let i of nD)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&pt(st.AfterRenderHooksEnd)}register(t){let{view:i}=t;i!==void 0?((i[Gs]??=[]).push(t),nl(i),i[$e]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(pp.AFTER_NEXT_RENDER,t):t()}static \u0275prov=ce({token:n,providedIn:"root",factory:()=>new n})}return n})(),qf=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Gs];e&&(this.view[Gs]=e.filter(t=>t!==this))}};function Tu(n,e){let t=e?.injector??z(Wn);return gi("NgAfterNextRender"),w3(n,t,e,!0)}function b3(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function w3(n,e,t,i){let r=e.get(L_);r.impl??=e.get(iD);let o=e.get(Qo,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Xn):null,a=e.get(Cf,null,{optional:!0}),l=new qf(r.impl,b3(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(l),l}var rD=new _e("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:z(qt)})});function oD(n,e,t){let i=n.get(rD);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function x3(n,e){let t=n.get(rD);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function S3(n,e){for(let[t,i]of e)oD(n,i.animateFns)}function fT(n,e,t,i){let r=n?.[zs]?.enter;e!==null&&r&&r.has(t.index)&&S3(i,r)}function il(n,e,t,i,r,o,s,a){if(r!=null){let l,c=!1;di(r)?l=r:ui(r)&&(c=!0,r=r[qn]);let d=hi(r);n===0&&i!==null?(fT(a,i,o,t),s==null?zC(e,i,d):Wf(e,i,d,s||null,!0)):n===1&&i!==null?(fT(a,i,o,t),Wf(e,i,d,s||null,!0)):n===2?pT(a,o,t,h=>{M_(e,d,c,h)}):n===3&&pT(a,o,t,()=>{e.destroyNode(d)}),l!=null&&L3(e,n,t,l,o,i,s)}}function I3(n,e){sD(n,e),e[qn]=null,e[Ii]=null}function T3(n,e,t,i,r,o){i[qn]=r,i[Ii]=e,mp(n,i,t,1,r,o)}function sD(n,e){e[vr].changeDetectionScheduler?.notify(9),mp(n,e,e[xt],2,null,null)}function C3(n){let e=n[tl];if(!e)return Rv(n[Ce],n);for(;e;){let t=null;if(ui(e))t=e[tl];else{let i=e[$t];i&&(t=i)}if(!t){for(;e&&!e[Si]&&e!==n;)ui(e)&&Rv(e[Ce],e),e=e[Jt];e===null&&(e=n),ui(e)&&Rv(e[Ce],e),t=e&&e[Si]}e=t}}function V_(n,e){let t=n[Ws],i=t.indexOf(e);t.splice(i,1)}function gp(n,e){if(Wo(e))return;let t=e[xt];t.destroyNode&&mp(n,e,t,3,null,null),C3(e)}function Rv(n,e){if(Wo(e))return;let t=Ue(null);try{e[$e]&=-129,e[$e]|=256,e[ci]&&Uc(e[ci]),M3(n,e),A3(n,e),e[Ce].type===1&&e[xt].destroy();let i=e[zo];if(i!==null&&di(e[Jt])){i!==e[Jt]&&V_(i,e);let r=e[_r];r!==null&&r.detachView(n)}zv(e)}finally{Ue(t)}}function pT(n,e,t,i){let r=n?.[zs];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&ea.add(n[Xr]),oD(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let c=s.animateFns[l],{promise:d}=c();a.push(d)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),D3(n,i)}else n&&ea.delete(n[Xr]),i(!1)},r)}function D3(n,e){let t=n[zs]?.running;if(t){t.then(()=>{n[zs].running=void 0,ea.delete(n[Xr]),e(!0)});return}e(!1)}function A3(n,e){let t=n.cleanup,i=e[el];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[el]=null);let r=e[Yr];if(r!==null){e[Yr]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[nu];if(o!==null){e[nu]=null;for(let s of o)s.destroy()}}function M3(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Xs)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],l=o[s+1];pt(st.LifecycleHookStart,a,l);try{l.call(a)}finally{pt(st.LifecycleHookEnd,a,l)}}else{pt(st.LifecycleHookStart,r,o);try{o.call(r)}finally{pt(st.LifecycleHookEnd,r,o)}}}}}function R3(n,e,t){return P3(n,e.parent,t)}function P3(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[qn];if(eo(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Yi.None||r===Yi.Emulated)return null}return Ti(i,t)}function N3(n,e,t){return O3(n,e,t)}function k3(n,e,t){return n.type&40?Ti(n,t):null}var O3=k3,gT;function U_(n,e,t,i){let r=R3(n,i,e),o=e[xt],s=i.parent||e[Ii],a=N3(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)uT(o,r,t[l],a,!1);else uT(o,r,t,a,!1);gT!==void 0&&gT(o,i,e,t,r)}function fu(n,e){if(e!==null){let t=e.type;if(t&3)return Ti(e,n);if(t&4)return Jv(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return fu(n,i);{let r=n[e.index];return di(r)?Jv(-1,r):hi(r)}}else{if(t&128)return fu(n,e.next);if(t&32)return F_(e,n)()||hi(n[e.index]);{let i=aD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=jo(n[Kn]);return fu(r,i)}else return fu(n,e.next)}}}return null}function aD(n,e){if(e!==null){let i=n[Kn][Ii],r=e.projection;return i.projection[r]}return null}function Jv(n,e){let t=$t+n+1;if(t<e.length){let i=e[t],r=i[Ce].firstChild;if(r!==null)return fu(i,r)}return e[Er]}function B_(n,e,t,i,r,o,s){for(;t!=null;){let a=i[li];if(t.type===128){t=t.next;continue}let l=i[t.index],c=t.type;if(s&&e===0&&(l&&ll(hi(l),i),t.flags|=2),!cp(t))if(c&8)B_(n,e,t.child,i,r,o,!1),il(e,n,a,r,l,t,o,i);else if(c&32){let d=F_(t,i),h;for(;h=d();)il(e,n,a,r,h,t,o,i);il(e,n,a,r,l,t,o,i)}else c&16?F3(n,e,i,t,r,o):il(e,n,a,r,l,t,o,i);t=s?t.projectionNext:t.next}}function mp(n,e,t,i,r,o){B_(t,i,n.firstChild,e,r,o,!1)}function F3(n,e,t,i,r,o){let s=t[Kn],l=s[Ii].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];il(e,n,t[li],r,d,i,o,t)}else{let c=l,d=s[Jt];Gf(i)&&(c.flags|=128),B_(n,e,c,d,r,o,!0)}}function L3(n,e,t,i,r,o,s){let a=i[Er],l=hi(i);a!==l&&il(e,n,t,o,a,r,s);for(let c=$t;c<i.length;c++){let d=i[c];mp(d[Ce],d,n,e,o,a)}}function V3(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:Sr.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Sr.Important),n.setStyle(t,i,r,o))}}function lD(n,e,t,i,r){let o=Ai(),s=i&2;try{qo(-1),s&&e.length>ut&&tD(n,e,ut,!1);let a=s?st.TemplateUpdateStart:st.TemplateCreateStart;pt(a,r,t),t(i,r)}finally{qo(o);let a=s?st.TemplateUpdateEnd:st.TemplateCreateEnd;pt(a,r,t)}}function j_(n,e,t){W3(n,e,t),(t.flags&64)===64&&q3(n,e,t)}function yp(n,e,t=Ti){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function U3(n,e,t,i){let o=i.get(w_,_C)||t===Yi.ShadowDom||t===Yi.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return B3(s),s}function B3(n){cD(n)}var cD=()=>null;function j3(n){iC(n)?WC(n):GF(n)}function uD(){cD=j3}function H3(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function $3(n,e,t,i,r,o){let s=e[Ce];if($_(n,s,e,t,i)){eo(n)&&z3(e,n.index);return}n.type&3&&(t=H3(t)),G3(n,e,t,i,r,o)}function G3(n,e,t,i,r,o){if(n.type&3){let s=Ti(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function z3(n,e){let t=Ci(e,n);t[$e]&16||(t[$e]|=64)}function W3(n,e,t){let i=t.directiveStart,r=t.directiveEnd;eo(t)&&_3(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Hf(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],l=gu(e,n,s,t);if(ll(l,e),o!==null&&J3(e,s-i,l,a,t,o),br(a)){let c=Ci(t.index,e);c[Zt]=gu(e,n,s,t)}}}function q3(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=HI();try{qo(o);for(let a=i;a<r;a++){let l=n.data[a],c=e[a];wf(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&K3(l,c)}}finally{qo(-1),wf(s)}}function K3(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function dD(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];d3(e,o.selectors,!1)&&(i??=[],br(o)?i.unshift(o):i.push(o))}return i}function Y3(n,e,t,i,r,o){let s=Ti(n,e);Q3(e[xt],s,o,n.value,t,i,r)}function Q3(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?zi(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function J3(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];Qv(i,t,l,c)}}function hD(n,e,t,i,r){let o=ut+t,s=e[Ce],a=r(s,e,n,i,t);e[o]=a,Ys(n,!0);let l=n.type===2;return l?(qC(e[xt],a,n),(kI()===0||ru(n))&&ll(a,e),OI()):ll(a,e),Tf()&&(!l||!cp(n))&&U_(s,e,a,n),n}function fD(n){let e=n;return dv()?VI():(e=e.parent,Ys(e,!1)),e}function H_(n,e){let t=n[li];if(!t)return;let i;try{i=t.get(fi,null)}catch{i=null}i?.(e)}function $_(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],d=s[l+1],h=e.data[c];Qv(h,t[c],d,r),a=!0}if(o)for(let l of o){let c=t[l],d=e.data[l];Qv(d,c,i,r),a=!0}return a}function Z3(n,e){let t=Ci(e,n),i=t[Ce];X3(i,t);let r=t[qn];r!==null&&t[Zn]===null&&(t[Zn]=kC(r,t[li])),pt(st.ComponentStart);try{G_(i,t,t[Zt])}finally{pt(st.ComponentEnd,t[Zt])}}function X3(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function G_(n,e,t){Sf(e);try{let i=n.viewQuery;i!==null&&Yv(1,i,t);let r=n.template;r!==null&&lD(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[_r]?.finishViewCreation(n),n.staticContentQueries&&BC(n,e),n.staticViewQueries&&Yv(2,n.viewQuery,t);let o=n.components;o!==null&&eL(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[$e]&=-5,If()}}function eL(n,e){for(let t=0;t<e.length;t++)Z3(n,e[t])}function Cu(n,e,t,i){let r=Ue(null);try{let o=e.tView,a=n[$e]&4096?4096:16,l=k_(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),c=n[e.index];l[zo]=c;let d=n[_r];return d!==null&&(l[_r]=d.createEmbeddedView(o)),G_(o,l,t),l}finally{Ue(r)}}function cl(n,e){return!e||e.firstChild===null||Gf(n)}function yu(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(hi(o)),di(o)&&pD(o,i);let s=t.type;if(s&8)yu(n,e,t.child,i);else if(s&32){let a=F_(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=aD(e,t);if(Array.isArray(a))i.push(...a);else{let l=jo(e[Kn]);yu(l[Ce],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function pD(n,e){for(let t=$t;t<n.length;t++){let i=n[t],r=i[Ce].firstChild;r!==null&&yu(i[Ce],i,r,e)}n[Er]!==n[qn]&&e.push(n[Er])}function gD(n){if(n[Gs]!==null){for(let e of n[Gs])e.impl.addSequence(e);n[Gs].length=0}}var mD=[];function tL(n){return n[ci]??nL(n)}function nL(n){let e=mD.pop()??Object.create(rL);return e.lView=n,e}function iL(n){n.lView[ci]!==n&&(n.lView=null,mD.push(n))}var rL=ue(F({},Fc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{nl(n.lView)},consumerOnSignalRead(){this.lView[ci]=this}});function oL(n){let e=n[ci]??Object.create(sL);return e.lView=n,e}var sL=ue(F({},Fc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=jo(n.lView);for(;e&&!yD(e[Ce]);)e=jo(e);e&&tv(e)},consumerOnSignalRead(){this.lView[ci]=this}});function yD(n){return n.type!==2}function vD(n){if(n[nu]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[nu])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[$e]&8192)}}var aL=100;function _D(n,e=0){let i=n[vr].rendererFactory,r=!1;r||i.begin?.();try{lL(n,e)}finally{r||i.end?.()}}function lL(n,e){let t=fv();try{pv(!0),Zv(n,e);let i=0;for(;au(n);){if(i===aL)throw new pe(103,!1);i++,Zv(n,1)}}finally{pv(t)}}function cL(n,e,t,i){if(Wo(e))return;let r=e[$e],o=!1,s=!1;Sf(e);let a=!0,l=null,c=null;o||(yD(n)?(c=tL(e),l=Vc(c)):Ih()===null?(a=!1,c=oL(e),l=Vc(c)):e[ci]&&(Uc(e[ci]),e[ci]=null));try{ev(e),UI(n.bindingStartIndex),t!==null&&lD(n,e,t,2,i);let d=(r&3)===3;if(!o)if(d){let g=n.preOrderCheckHooks;g!==null&&Rf(e,g,null)}else{let g=n.preOrderHooks;g!==null&&Pf(e,g,0,null),Dv(e,0)}if(s||uL(e),vD(e),ED(e,0),n.contentQueries!==null&&BC(n,e),!o)if(d){let g=n.contentCheckHooks;g!==null&&Rf(e,g)}else{let g=n.contentHooks;g!==null&&Pf(e,g,1),Dv(e,1)}hL(n,e);let h=n.components;h!==null&&wD(e,h,0);let p=n.viewQuery;if(p!==null&&Yv(2,p,i),!o)if(d){let g=n.viewCheckHooks;g!==null&&Rf(e,g)}else{let g=n.viewHooks;g!==null&&Pf(e,g,2),Dv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[_f]){for(let g of e[_f])g();e[_f]=null}o||(gD(e),e[$e]&=-73)}catch(d){throw o||nl(e),d}finally{c!==null&&(Th(c,l),a&&iL(c)),If()}}function ED(n,e){for(let t=sC(n);t!==null;t=aC(t))for(let i=$t;i<t.length;i++){let r=t[i];bD(r,e)}}function uL(n){for(let e=sC(n);e!==null;e=aC(e)){if(!(e[$e]&2))continue;let t=e[Ws];for(let i=0;i<t.length;i++){let r=t[i];tv(r)}}}function dL(n,e,t){pt(st.ComponentStart);let i=Ci(e,n);try{bD(i,t)}finally{pt(st.ComponentEnd,i[Zt])}}function bD(n,e){Ef(n)&&Zv(n,e)}function Zv(n,e){let i=n[Ce],r=n[$e],o=n[ci],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&Ch(o)),s||=!1,o&&(o.dirty=!1),n[$e]&=-9217,s)cL(i,n,i.template,n[Zt]);else if(r&8192){let a=Ue(null);try{vD(n),ED(n,1);let l=i.components;l!==null&&wD(n,l,1),gD(n)}finally{Ue(a)}}}function wD(n,e,t){for(let i=0;i<e.length;i++)dL(n,e[i],t)}function hL(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)qo(~r);else{let o=r,s=t[++i],a=t[++i];jI(s,o);let l=e[o];pt(st.HostBindingsUpdateStart,l);try{a(2,l)}finally{pt(st.HostBindingsUpdateEnd,l)}}}}finally{qo(-1)}}function vp(n,e){let t=fv()?64:1088;for(n[vr].changeDetectionScheduler?.notify(e);n;){n[$e]|=t;let i=jo(n);if(qs(n)&&!i)return n;n=i}return null}function xD(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function SD(n,e){let t=$t+e;if(t<n.length)return n[t]}function Du(n,e,t,i=!0){let r=e[Ce];if(fL(r,e,n,t),i){let s=Jv(t,n),a=e[xt],l=a.parentNode(n[Er]);l!==null&&T3(r,n[Ii],a,e,l,s)}let o=e[Zn];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function z_(n,e){let t=vu(n,e);return t!==void 0&&gp(t[Ce],t),t}function vu(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t];if(i){let r=i[zo];r!==null&&r!==n&&V_(r,i),e>0&&(n[t-1][Si]=i[Si]);let o=Xc(n,$t+e);I3(i[Ce],i);let s=o[_r];s!==null&&s.detachView(o[Ce]),i[Jt]=null,i[Si]=null,i[$e]&=-129}return i}function fL(n,e,t,i){let r=$t+i,o=t.length;i>0&&(t[r-1][Si]=e),i<o-$t?(e[Si]=t[r],Gy(t,$t+i,e)):(t.push(e),e[Si]=null),e[Jt]=t;let s=e[zo];s!==null&&t!==s&&ID(s,e);let a=e[_r];a!==null&&a.insertView(n),bf(e),e[$e]|=128}function ID(n,e){let t=n[Ws],i=e[Jt];if(ui(i))n[$e]|=2;else{let r=i[Jt][Kn];e[Kn]!==r&&(n[$e]|=2)}t===null?n[Ws]=[e]:t.push(e)}var Ko=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Ce];return yu(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Zt]}set context(e){this._lView[Zt]=e}get destroyed(){return Wo(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Jt];if(di(e)){let t=e[iu],i=t?t.indexOf(this):-1;i>-1&&(vu(e,i),Xc(t,i))}this._attachedToViewContainer=!1}gp(this._lView[Ce],this._lView)}onDestroy(e){nv(this._lView,e)}markForCheck(){vp(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[$e]&=-129}reattach(){bf(this._lView),this._lView[$e]|=128}detectChanges(){this._lView[$e]|=1024,_D(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=qs(this._lView),t=this._lView[zo];t!==null&&!e&&V_(t,this._lView),sD(this._lView[Ce],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new pe(902,!1);this._appRef=e;let t=qs(this._lView),i=this._lView[zo];i!==null&&!t&&ID(i,this._lView),bf(this._lView)}};var Yo=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=pL;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Cu(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new Ko(o)}}return n})();function pL(){return _p(Ln(),Be())}function _p(n,e){return n.type&4?new Yo(e,n,hl(n,e)):null}function ml(n,e,t,i,r){let o=n.data[e];if(o===null)o=gL(n,e,t,i,r),BI()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=LI();o.injectorIndex=s===null?-1:s.injectorIndex}return Ys(o,!0),o}function gL(n,e,t,i,r){let o=uv(),s=dv(),a=s?o:o&&o.parent,l=n.data[e]=yL(n,a,t,e,i,r);return mL(n,l,o,s),l}function mL(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function yL(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return av()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var vL=new RegExp(`^(\\d+)*(${dC}|${uC})*(.*)`);function _L(n){let e=n.match(vL),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(let[l,c,d]of o.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(c,h)}return[s,...a]}function EL(n){return!n.prev&&n.parent?.type===8}function Pv(n){return n.index-ut}function bL(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function Ep(n,e,t,i){let r=Pv(i),o=bL(n,r);if(o===void 0){let s=n.data[gC];if(s?.[r])o=xL(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{let a=i.prev===null,l=i.prev??i.parent;if(EL(i)){let c=Pv(i.parent);o=Kv(n,c)}else{let c=Ti(l,t);if(a)o=c.firstChild;else{let d=Pv(l),h=Kv(n,d);if(l.type===2&&h){let g=C_(n,d)+1;o=bp(g,h)}else o=c.nextSibling}}}}return o}function bp(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}function wL(n,e){let t=n;for(let i=0;i<e.length;i+=2){let r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case LF:t=t.firstChild;break;case VF:t=t.nextSibling;break}}return t}function xL(n,e){let[t,...i]=_L(n),r;if(t===uC)r=e[Kn][qn];else if(t===dC)r=QC(e[Kn][qn]);else{let o=Number(t);r=hi(e[o+ut])}return wL(r,i)}var SL=!1;function TD(n){SL=n}function IL(n){let e=n[Zn];if(e){let{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){let r=n[xt];for(let o of i.values())TL(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function TL(n,e,t){for(let i of t.node.cases[t.case]){let r=e.get(i.index-ut);r&&M_(n,r,!1)}}function wp(n){let e=n[Wi]??[],i=n[Jt][xt],r=[];for(let o of e)o.data[mC]!==void 0?r.push(o):CD(o,i);n[Wi]=r}function CL(n){let{lContainer:e}=n,t=e[Wi];if(t===null)return;let r=e[Jt][xt];for(let o of t)CD(o,r)}function CD(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[mu];for(;t<r;){let o=i.nextSibling;M_(e,i,!1),i=o,t++}}}function xp(n){wp(n);let e=n[qn];ui(e)&&Kf(e);for(let t=$t;t<n.length;t++)Kf(n[t])}function Kf(n){IL(n);let e=n[Ce];for(let t=ut;t<e.bindingStartIndex;t++)if(di(n[t])){let i=n[t];xp(i)}else ui(n[t])&&Kf(n[t])}function W_(n){let e=n._views;for(let t of e){let i=OC(t);i!==null&&i[qn]!==null&&(ui(i)?Kf(i):xp(i))}}function DL(n,e,t,i){n!==null&&(t.cleanup(e),xp(n.lContainer),W_(i))}function AL(n,e){let t=[];for(let i of e)for(let r=0;r<(i[E_]??1);r++){let o={data:i,firstChild:null};i[mu]>0&&(o.firstChild=n,n=bp(i[mu],n)),t.push(o)}return[n,t]}var DD=()=>null,AD=()=>null;function MD(){DD=ML,AD=RL}function ML(n,e){return PD(n,e)?n[Wi].shift():(wp(n),null)}function Yf(n,e){return DD(n,e)}function RL(n,e,t){if(e.tView.ssrId===null)return null;let i=Yf(n,e.tView.ssrId);return t[Ce].firstUpdatePass&&i===null&&PL(t,e),i}function RD(n,e,t){return AD(n,e,t)}function PL(n,e){let t=e;for(;t;){if(mT(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(mT(n,t))return;t=t.next}}function PD(n,e){let t=n[Wi];return!e||t===null||t.length===0?!1:t[0].data[pC]===e}function mT(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let i=n[e.index];return di(i)&&PD(i,t)?(wp(i),!0):!1}var ND=class{},Sp=class{},Xv=class{resolveComponentFactory(e){throw new pe(917,!1)}},Au=class{static NULL=new Xv},ta=class{},sa=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>NL()}return n})();function NL(){let n=Be(),e=Ln(),t=Ci(e.index,n);return(ui(t)?t:n)[xt]}var kD=(()=>{class n{static \u0275prov=ce({token:n,providedIn:"root",factory:()=>null})}return n})();var Of={},ol=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,Of,i);return r!==Of||t===Of?r:this.parentInjector.get(e,t,i)}};function Qf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=uf(r,a);else if(o==2){let l=a,c=e[++s];i=uf(i,l+": "+c+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function ge(n,e=0){let t=Be();if(t===null)return De(n,e);let i=Ln();return ZT(i,t,Pn(n),e)}function OD(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,l=null,c=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,l,c]=d.resolveHostDirectives(s);break}FL(n,e,t,a,o,l,c)}o!==null&&i!==null&&kL(t,i,o)}function kL(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new pe(-301,!1);i.push(e[r],o)}}function OL(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function FL(n,e,t,i,r,o,s){let a=i.length,l=null;for(let p=0;p<a;p++){let g=i[p];l===null&&br(g)&&(l=g,OL(n,t,p)),$v(Hf(t,e),n,g.type)}HL(t,n.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let p=0;p<a;p++){let g=i[p];g.providersResolver&&g.providersResolver(g)}let c=!1,d=!1,h=eD(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let p=0;p<a;p++){let g=i[p];if(t.mergedAttrs=al(t.mergedAttrs,g.hostAttrs),VL(n,t,e,h,g),jL(h,g,r),s!==null&&s.has(g)){let[S,N]=s.get(g);t.directiveToIndex.set(g.type,[h,S+t.directiveStart,N+t.directiveStart])}else(o===null||!o.has(g))&&t.directiveToIndex.set(g.type,h);g.contentQueries!==null&&(t.flags|=4),(g.hostBindings!==null||g.hostAttrs!==null||g.hostVars!==0)&&(t.flags|=64);let x=g.type.prototype;!c&&(x.ngOnChanges||x.ngOnInit||x.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!d&&(x.ngOnChanges||x.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}LL(n,t,o)}function LL(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))yT(0,e,r,i),yT(1,e,r,i),_T(e,i,!1);else{let o=t.get(r);vT(0,e,o,i),vT(1,e,o,i),_T(e,i,!0)}}}function yT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),FD(e,o)}}function vT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),FD(e,s)}}function FD(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function _T(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||P_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&r.hasOwnProperty(l)){let c=r[l];for(let d of c)if(d===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let c=o[l];for(let d=0;d<c.length;d+=2)if(c[d]===e){s??=[],s.push(c[d+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function VL(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Bo(r.type,!0)),s=new Xs(o,br(r),ge,null);n.blueprint[i]=s,t[i]=s,UL(n,e,i,eD(n,t,r.hostVars,En),r)}function UL(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;BL(s)!=a&&s.push(a),s.push(t,i,o)}}function BL(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function jL(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;br(e)&&(t[""]=n)}}function HL(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function LD(n,e,t,i,r,o,s,a){let l=e[Ce],c=l.consts,d=Di(c,s),h=ml(l,n,t,i,d);return o&&OD(l,e,h,Di(c,a),r),h.mergedAttrs=al(h.mergedAttrs,h.attrs),h.attrs!==null&&Qf(h,h.attrs,!1),h.mergedAttrs!==null&&Qf(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function VD(n,e){$T(n,e),Jy(e)&&n.queries.elementEnd(e)}function $L(n,e,t,i,r,o){let s=e.consts,a=Di(s,r),l=ml(e,n,t,i,a);if(l.mergedAttrs=al(l.mergedAttrs,l.attrs),o!=null){let c=Di(s,o);l.localNames=[];for(let d=0;d<c.length;d+=2)l.localNames.push(c[d],-1)}return l.attrs!==null&&Qf(l,l.attrs,!1),l.mergedAttrs!==null&&Qf(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function q_(n){return BD(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function UD(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function BD(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function K_(n,e,t){return n[e]=t}function GL(n,e){return n[e]}function Mi(n,e,t){if(t===En)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function Y_(n,e,t,i){let r=Mi(n,e,t);return Mi(n,e+1,i)||r}function zL(n,e,t,i,r){let o=Y_(n,e,t,i);return Mi(n,e+2,r)||o}function Ff(n,e,t){return function i(r){let o=eo(n)?Ci(n.index,e):e;vp(o,5);let s=e[Zt],a=ET(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=ET(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function ET(n,e,t,i){let r=Ue(null);try{return pt(st.OutputStart,e,t),t(i)!==!1}catch(o){return H_(n,o),!1}finally{pt(st.OutputEnd,e,t),Ue(r)}}function jD(n,e,t,i,r,o,s,a){let l=ru(n),c=!1,d=null;if(!i&&l&&(d=qL(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,c=!0}else{let h=Ti(n,t),p=i?i(h):h;UF(t,p,o,a);let g=r.listen(p,o,a);if(!WL(o)){let x=i?S=>i(hi(S[n.index])):n.index;HD(x,e,t,o,a,g,!1)}}return c}function WL(n){return n.startsWith("animation")||n.startsWith("transition")}function qL(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[el],l=r[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function HD(n,e,t,i,r,o,s){let a=e.firstCreatePass?rv(e):null,l=iv(t),c=l.length;l.push(r,o),a&&a.push(i,n,c,(c+1)*(s?-1:1))}function bT(n,e,t,i,r,o){let s=e[t],a=e[Ce],c=a.data[t].outputs[i],h=s[c].subscribe(o);HD(n.index,a,e,r,o,h,!0)}var e_=Symbol("BINDING");var Jf=class extends Au{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Zr(e);return new ul(t,this.ngModule)}};function KL(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&fp.SignalBased)!==0};return r&&(o.transform=r),o})}function YL(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function QL(n,e,t){let i=e instanceof qt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new ol(t,i):t}function JL(n){let e=n.get(ta,null);if(e===null)throw new pe(407,!1);let t=n.get(kD,null),i=n.get(Ho,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function ZL(n,e){let t=$D(n);return A_(e,t,t==="svg"?Zy:t==="math"?DI:null)}function $D(n){return(n.selectors[0][0]||"div").toLowerCase()}var ul=class extends Sp{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=KL(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=YL(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=g3(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){pt(st.DynamicComponentStart);let a=Ue(null);try{let l=this.componentDef,c=XL(i,l,s,o),d=QL(l,r||this.ngModule,e),h=JL(d),p=h.rendererFactory.createRenderer(null,l),g=i?U3(p,i,l.encapsulation,d):ZL(l,p),x=s?.some(wT)||o?.some(U=>typeof U!="function"&&U.bindings.some(wT)),S=k_(null,c,null,512|XC(l),null,null,h,p,d,null,kC(g,d,!0));S[ut]=g,Sf(S);let N=null;try{let U=LD(ut,S,2,"#host",()=>c.directiveRegistry,!0,0);qC(p,g,U),ll(g,S),j_(c,S,U),jC(c,U,S),VD(c,U),t!==void 0&&tV(U,this.ngContentSelectors,t),N=Ci(U.index,S),S[Zt]=N[Zt],G_(c,S,null)}catch(U){throw N!==null&&zv(N),zv(S),U}finally{pt(st.DynamicComponentEnd),If()}return new Zf(this.componentType,S,!!x)}finally{Ue(a)}}};function XL(n,e,t,i){let r=n?["ng-version","21.1.1"]:m3(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[e_].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(i)for(let d=0;d<i.length;d++){let h=i[d];if(typeof h!="function")for(let p of h.bindings){a+=p[e_].requiredVars;let g=d+1;p.create&&(p.targetIdx=g,(o??=[]).push(p)),p.update&&(p.targetIdx=g,(s??=[]).push(p))}}let l=[e];if(i)for(let d of i){let h=typeof d=="function"?d:d.type,p=hf(h);l.push(p)}return N_(0,null,eV(o,s),1,a,l,null,null,null,[r],null)}function eV(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function wT(n){let e=n[e_].kind;return e==="input"||e==="twoWay"}var Zf=class extends ND{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Ks(t[Ce],ut),this.location=hl(this._tNode,t),this.instance=Ci(this._tNode.index,t)[Zt],this.hostView=this.changeDetectorRef=new Ko(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=$_(i,r[Ce],r,e,t);this.previousInputValues.set(e,t);let s=Ci(i.index,r);vp(s,1)}get injector(){return new Zs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function tV(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var io=(()=>{class n{static __NG_ELEMENT_ID__=nV}return n})();function nV(){let n=Ln();return zD(n,Be())}var iV=io,GD=class extends iV{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return hl(this._hostTNode,this._hostLView)}get injector(){return new Zs(this._hostTNode,this._hostLView)}get parentInjector(){let e=y_(this._hostTNode,this._hostLView);if(WT(e)){let t=Bf(e,this._hostLView),i=Uf(e),r=t[Ce].data[i+8];return new Zs(r,t)}else return new Zs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=xT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-$t}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=Yf(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,cl(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let l=e&&!cF(e),c;if(l)c=t;else{let N=t||{};c=N.index,i=N.injector,r=N.projectableNodes,o=N.environmentInjector||N.ngModuleRef,s=N.directives,a=N.bindings}let d=l?e:new ul(Zr(e)),h=i||this.parentInjector;if(!o&&d.ngModule==null){let U=(l?h:this.parentInjector).get(qt,null);U&&(o=U)}let p=Zr(d.componentType??{}),g=Yf(this._lContainer,p?.id??null),x=g?.firstChild??null,S=d.create(h,r,x,o,s,a);return this.insertImpl(S.hostView,c,cl(this._hostTNode,g)),S}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(MI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Jt],c=new GD(l,l[Ii],l[Jt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return Du(s,r,o,i),e.attachToViewContainerRef(),Gy(Nv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=xT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=vu(this._lContainer,t);i&&(Xc(Nv(this._lContainer),t),gp(i[Ce],i))}detach(e){let t=this._adjustIndex(e,-1),i=vu(this._lContainer,t);return i&&Xc(Nv(this._lContainer),t)!=null?new Ko(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function xT(n){return n[iu]}function Nv(n){return n[iu]||(n[iu]=[])}function zD(n,e){let t,i=e[n.index];return di(i)?t=i:(t=xD(i,e,null,n),e[n.index]=t,O_(e,t)),WD(t,e,n,i),new GD(t,n,e)}function rV(n,e){let t=n[xt],i=t.createComment(""),r=Ti(e,n),o=t.parentNode(r);return Wf(t,o,i,t.nextSibling(r),!1),i}var WD=qD,Q_=()=>!1;function oV(n,e,t){return Q_(n,e,t)}function qD(n,e,t,i){if(n[Er])return;let r;t.type&8?r=hi(i):r=rV(e,t),n[Er]=r}function sV(n,e,t){if(n[Er]&&n[Wi])return!0;let i=t[Zn],r=e.index-ut;if(!i||rC(e)||VC(i,r))return!1;let s=Kv(i,r),a=i.data[ap]?.[r],[l,c]=AL(s,a);return n[Er]=l,n[Wi]=c,!0}function aV(n,e,t,i){Q_(n,t,e)||qD(n,e,t,i)}function KD(){WD=aV,Q_=sV}var t_=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},n_=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)J_(e,t).matches!==null&&this.queries[t].setDirty()}},i_=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=gV(e):this.predicate=e}},r_=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},o_=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,lV(t,o)),this.matchTNodeWithReadOption(e,t,Nf(t,e,o,!1,!1))}else i===Yo?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Nf(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Qi||r===io||r===Yo&&t.type&4)this.addMatch(t.index,-2);else{let o=Nf(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function lV(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function cV(n,e){return n.type&11?hl(n,e):n.type&4?_p(n,e):null}function uV(n,e,t,i){return t===-1?cV(e,n):t===-2?dV(n,e,i):gu(n,n[Ce],t,e)}function dV(n,e,t){if(t===Qi)return hl(e,n);if(t===Yo)return _p(e,n);if(t===io)return zD(e,n)}function YD(n,e,t,i){let r=e[_r].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let d=o[c];a.push(uV(e,d,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function s_(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=YD(n,e,r,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)i.push(s[a/2]);else{let c=o[a+1],d=e[-l];for(let h=$t;h<d.length;h++){let p=d[h];p[zo]===p[Jt]&&s_(p[Ce],p,c,i)}if(d[Ws]!==null){let h=d[Ws];for(let p=0;p<h.length;p++){let g=h[p];s_(g[Ce],g,c,i)}}}}}return i}function hV(n,e){return n[_r].queries[e].queryList}function fV(n,e,t){let i=new $f((t&4)===4);return NI(n,e,i,i.destroy),(e[_r]??=new n_).queries.push(new t_(i))-1}function pV(n,e,t){let i=Xt();return i.firstCreatePass&&(mV(i,new i_(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),fV(i,Be(),e)}function gV(n){return n.split(",").map(e=>e.trim())}function mV(n,e,t){n.queries===null&&(n.queries=new r_),n.queries.track(new o_(e,t))}function J_(n,e){return n.queries.getByIndex(e)}function yV(n,e){let t=n[Ce],i=J_(t,e);return i.crossesNgTemplate?s_(t,n,e,[]):YD(t,n,i,e)}var na=class{},Ip=class{};var Xf=class extends na{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Jf(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=By(e);this._bootstrapComponents=JC(o.bootstrap),this._r3Injector=bv(e,t,[{provide:na,useValue:this},{provide:Au,useValue:this.componentFactoryResolver},...i],Qr(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},ep=class extends Ip{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Xf(this.moduleType,e,[])}};var _u=class extends na{injector;componentFactoryResolver=new Jf(this);instance=null;constructor(e){super();let t=new Bs([...e.providers,{provide:na,useValue:this},{provide:Au,useValue:this.componentFactoryResolver}],e.parent||tu(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function yl(n,e,t=null){return new _u({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var vV=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=vf(!1,t.type),r=i.length>0?yl([i],this._injector,""):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ce({token:n,providedIn:"environment",factory:()=>new n(De(qt))})}return n})();function Ct(n){return bu(()=>{let e=QD(n),t=ue(F({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===v_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(vV).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Yi.Emulated,styles:n.styles||zn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&gi("NgStandalone"),JD(t);let i=n.dependencies;return t.directiveDefs=ST(i,_V),t.pipeDefs=ST(i,jy),t.id=wV(t),t})}function _V(n){return Zr(n)||hf(n)}function ro(n){return bu(()=>({type:n.type,bootstrap:n.bootstrap||zn,declarations:n.declarations||zn,imports:n.imports||zn,exports:n.exports||zn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function EV(n,e){if(n==null)return Go;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=fp.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function bV(n){if(n==null)return Go;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function bn(n){return bu(()=>{let e=QD(n);return JD(e),e})}function Tp(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function QD(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Go,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||zn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:EV(n.inputs,e),outputs:bV(n.outputs),debugInfo:null}}function JD(n){n.features?.forEach(e=>e(n))}function ST(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function wV(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function xV(n){return Object.getPrototypeOf(n.prototype).constructor}function Tr(n){let e=xV(n.type),t=!0,i=[n];for(;e;){let r;if(br(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new pe(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=kv(n.inputs),s.declaredInputs=kv(n.declaredInputs),s.outputs=kv(n.outputs);let a=r.hostBindings;a&&DV(n,a);let l=r.viewQuery,c=r.contentQueries;if(l&&TV(n,l),c&&CV(n,c),SV(n,r),fI(n.outputs,r.outputs),br(r)&&r.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Tr&&(t=!1)}}e=Object.getPrototypeOf(e)}IV(i)}function SV(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function IV(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=al(r.hostAttrs,t=al(t,r.hostAttrs))}}function kv(n){return n===Go?{}:n===zn?[]:n}function TV(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function CV(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function DV(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function ZD(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=al(n.mergedAttrs,n.attrs);let d=n.tView=N_(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),Ys(n,!1);let l=XD(t,e,n,i);Tf()&&U_(t,e,l,n),ll(l,e);let c=xD(l,e,l,n);e[i+ut]=c,O_(e,c),oV(c,n,e)}function AV(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,p;return e.firstCreatePass?(p=ml(e,h,4,s||null,a||null),sv()&&OD(e,n,p,Di(e.consts,c),dD),$T(e,p)):p=e.data[h],ZD(p,n,e,t,i,r,o,l),ru(p)&&j_(e,n,p),c!=null&&yp(n,p,d),p}function tp(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,p;if(e.firstCreatePass){if(p=ml(e,h,4,s||null,a||null),c!=null){let g=Di(e.consts,c);p.localNames=[];for(let x=0;x<g.length;x+=2)p.localNames.push(g[x],-1)}}else p=e.data[h];return ZD(p,n,e,t,i,r,o,l),c!=null&&yp(n,p,d),p}function Yn(n,e,t,i,r,o,s,a){let l=Be(),c=Xt(),d=Di(c.consts,o);return AV(l,c,n,e,t,i,r,d,void 0,s,a),Yn}var XD=eA;function eA(n,e,t,i){return to(!0),e[xt].createComment("")}function MV(n,e,t,i){let r=!dp(e,t);to(r);let o=e[Zn]?.data[fC]?.[i]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),r)return eA(n,e);let s=e[Zn],a=Ep(s,n,e,t);up(s,i,a);let l=C_(s,i);return bp(l,a)}function tA(){XD=MV}var pi=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(pi||{}),IT=0,RV=1,un=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(un||{});var PV=0,Mu=1;var NV=4,kV=5;var OV=7,sl=8,FV=9,Z_=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(Z_||{});function Lf(n,e){let t=VV(n),i=e[t];if(i!==null){for(let r of i)r();e[t]=null}}function LV(n){Lf(1,n),Lf(0,n),Lf(2,n)}function VV(n){let e=NV;return n===1?e=kV:n===2&&(e=FV),e}function nA(n){return n+1}function vl(n,e){let t=n[Ce],i=nA(e.index);return n[i]}function Ru(n,e){let t=nA(e.index);return n.data[t]}function UV(n,e,t){let i=e[Ce],r=Ru(i,t);switch(n){case un.Complete:return r.primaryTmplIndex;case un.Loading:return r.loadingTmplIndex;case un.Error:return r.errorTmplIndex;case un.Placeholder:return r.placeholderTmplIndex;default:return null}}function TT(n,e){return e===un.Placeholder?n.placeholderBlockConfig?.[IT]??null:e===un.Loading?n.loadingBlockConfig?.[IT]??null:null}function BV(n){return n.loadingBlockConfig?.[RV]??null}function CT(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let i of e)t.add(i);return n.length===t.size?n:Array.from(t)}function jV(n,e){let t=e.primaryTmplIndex+ut;return Ks(n,t)}var HV=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,i,r,o){if(!this.cachedInjectors.has(t)){let s=r.length>0?yl(r,i,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ce({token:n,providedIn:"environment",factory:()=>new n})}return n})();var iA=new _e("");function Ov(n,e,t){return n.get(HV).getOrCreateInjector(e,n,t,"")}function $V(n,e,t){if(n instanceof ol){let r=n.injector,o=n.parentInjector,s=Ov(o,e,t);return new ol(r,s)}let i=n.get(qt);if(i!==n){let r=Ov(i,e,t);return new ol(n,r)}return Ov(n,e,t)}function Js(n,e,t,i=!1){let r=t[Jt],o=r[Ce];if(Wo(r))return;let s=vl(r,e),a=s[Mu],l=s[OV];if(!(l!==null&&n<l)&&DT(a,n)&&DT(s[PV]??-1,n)){let c=Ru(o,e),h=!i&&!0&&(BV(c)!==null||TT(c,un.Loading)!==null||TT(c,un.Placeholder))?WV:zV;try{h(n,s,t,e,r)}catch(p){H_(r,p)}}}function GV(n,e){let t=n[Wi]?.findIndex(r=>r.data[yC]===e[Mu])??-1;return{dehydratedView:t>-1?n[Wi][t]:null,dehydratedViewIx:t}}function zV(n,e,t,i,r){pt(st.DeferBlockStateStart);let o=UV(n,r,i);if(o!==null){e[Mu]=n;let s=r[Ce],a=o+ut,l=Ks(s,a),c=0;z_(t,c);let d;if(n===un.Complete){let x=Ru(s,i),S=x.providers;S&&S.length>0&&(d=$V(r[li],x,S))}let{dehydratedView:h,dehydratedViewIx:p}=GV(t,e),g=Cu(r,l,null,{injector:d,dehydratedView:h});if(Du(t,g,c,cl(l,h)),vp(g,2),p>-1&&t[Wi]?.splice(p,1),(n===un.Complete||n===un.Error)&&Array.isArray(e[sl])){for(let x of e[sl])x();e[sl]=null}}pt(st.DeferBlockStateEnd)}function DT(n,e){return n<e}function AT(n,e,t){n.loadingPromise.then(()=>{n.loadingState===pi.COMPLETE?Js(un.Complete,e,t):n.loadingState===pi.FAILED&&Js(un.Error,e,t)})}var WV=null;var Cp=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var X_=new _e("");function Jo(n){return!!n&&typeof n.then=="function"}function eE(n){return!!n&&typeof n.subscribe=="function"}var rA=new _e("");var tE=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=z(rA,{optional:!0})??[];injector=z(Wn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Nn(this.injector,r);if(Jo(o))t.push(o);else if(eE(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Zo=new _e("");function oA(){ty(()=>{let n="";throw new pe(600,n)})}function sA(n){return n.isBoundToModule}var qV=10;var ei=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=z(fi);afterRenderManager=z(L_);zonelessEnabled=z(uu);rootEffectScheduler=z(Cv);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Ut;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=z(wr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(yt(t=>!t))}constructor(){z(Qo,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=z(qt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Wn.NULL){return this._injector.get(mn).run(()=>{pt(st.BootstrapComponentStart);let s=t instanceof Sp;if(!this._injector.get(tE).done){let x="";throw new pe(405,x)}let l;s?l=t:l=this._injector.get(Au).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let c=sA(l)?void 0:this._injector.get(na),d=i||l.selector,h=l.create(r,[],d,c),p=h.location.nativeElement,g=h.injector.get(X_,null);return g?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),pu(this.components,h),g?.unregisterApplication(p)}),this._loadComponent(h),pt(st.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){pt(st.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(pp.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw pt(st.ChangeDetectionEnd),new pe(101,!1);let t=Ue(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Ue(t),this.afterTick.next(),pt(st.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ta,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<qV;){pt(st.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{pt(st.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!au(r))continue;let o=i&&!this.zonelessEnabled?0:1;_D(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>au(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;pu(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(Zo,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>pu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new pe(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pu(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function nE(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}function aA(n,e,t){let i=e[li],r=e[Ce];if(n.loadingState!==pi.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=vl(e,t),s=jV(r,n);n.loadingState=pi.IN_PROGRESS,Lf(1,o);let a=n.dependencyResolverFn,l=i.get(du).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(c=>{let d=!1,h=[],p=[];for(let g of c)if(g.status==="fulfilled"){let x=g.value,S=Zr(x)||hf(x);if(S)h.push(S);else{let N=jy(x);N&&p.push(N)}}else{d=!0;break}if(d){if(n.loadingState=pi.FAILED,n.errorTmplIndex===null){let x=new pe(-750,!1);H_(e,x)}}else{n.loadingState=pi.COMPLETE;let g=s.tView;if(h.length>0){g.directiveRegistry=CT(g.directiveRegistry,h);let x=h.map(N=>N.type),S=vf(!1,...x);n.providers=S}p.length>0&&(g.pipeRegistry=CT(g.pipeRegistry,p))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,l()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=pi.COMPLETE,l()}),n.loadingPromise)}function KV(n,e){return e[li].get(iA,null,{optional:!0})?.behavior!==Z_.Manual}function YV(n,e,t){let i=e[Ce],r=e[t.index];if(!KV(n,e))return;let o=vl(e,t),s=Ru(i,t);switch(LV(o),s.loadingState){case pi.NOT_STARTED:Js(un.Loading,t,r),aA(s,e,t),s.loadingState===pi.IN_PROGRESS&&AT(s,t,r);break;case pi.IN_PROGRESS:Js(un.Loading,t,r),AT(s,t,r);break;case pi.COMPLETE:Js(un.Complete,t,r);break;case pi.FAILED:Js(un.Error,t,r);break;default:}}async function lA(n,e,t){let i=n.get(lp);if(i.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=qF(e,n);if(s.length===0)return;o!==null&&s.shift(),ZV(i,s),o!==null&&await o;let a=s[0];i.has(a)?await MT(n,s,t):i.awaitParentBlock(a,async()=>await MT(n,s,t))}async function MT(n,e,t){let i=n.get(lp),r=i.hydrating,o=n.get(wr),s=o.add();for(let l=0;l<e.length;l++){let c=e[l],d=i.get(c);if(d!=null){if(await e5(d),await XV(n),QV(d)){CL(d),RT(e.slice(l),i);break}r.get(c).resolve()}else{JV(l,e,i),RT(e.slice(l),i);break}}let a=e[e.length-1];await r.get(a)?.promise,o.remove(s),t&&t(e),DL(i.get(a),e,i,n.get(ei))}function QV(n){return vl(n.lView,n.tNode)[Mu]===un.Error}function JV(n,e,t){let i=n-1,r=i>-1?t.get(e[i]):null;r&&xp(r.lContainer)}function RT(n,e){let t=e.hydrating;for(let i in n)t.get(i)?.reject();e.cleanup(n)}function ZV(n,e){for(let t of e)n.hydrating.set(t,nE())}function XV(n){return new Promise(e=>Tu(e,{injector:n}))}async function e5(n){let{tNode:e,lView:t}=n,i=vl(t,e);return new Promise(r=>{t5(i,r),YV(2,t,e)})}function t5(n,e){Array.isArray(n[sl])||(n[sl]=[]),n[sl].push(e)}function Ft(n,e,t,i){let r=Be(),o=Qs();if(Mi(r,o,e)){let s=Xt(),a=_v();Y3(a,r,n,e,t,i)}return Ft}var dte=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var a_=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function Fv(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function n5(n,e,t,i){let r,o,s=0,a=n.length-1,l=void 0;if(Array.isArray(e)){Ue(i);let c=e.length-1;for(Ue(null);s<=a&&s<=c;){let d=n.at(s),h=e[s],p=Fv(s,d,s,h,t);if(p!==0){p<0&&n.updateValue(s,h),s++;continue}let g=n.at(a),x=e[c],S=Fv(a,g,c,x,t);if(S!==0){S<0&&n.updateValue(a,x),a--,c--;continue}let N=t(s,d),U=t(a,g),se=t(s,h);if(Object.is(se,U)){let Se=t(c,x);Object.is(Se,N)?(n.swap(s,a),n.updateValue(a,x),c--,a--):n.move(a,s),n.updateValue(s,h),s++;continue}if(r??=new np,o??=NT(n,s,a,t),l_(n,r,s,se))n.updateValue(s,h),s++,a++;else if(o.has(se))r.set(N,n.detach(s)),a--;else{let Se=n.create(s,e[s]);n.attach(s,Se),s++,a++}}for(;s<=c;)PT(n,r,t,s,e[s]),s++}else if(e!=null){Ue(i);let c=e[Symbol.iterator]();Ue(null);let d=c.next();for(;!d.done&&s<=a;){let h=n.at(s),p=d.value,g=Fv(s,h,s,p,t);if(g!==0)g<0&&n.updateValue(s,p),s++,d=c.next();else{r??=new np,o??=NT(n,s,a,t);let x=t(s,p);if(l_(n,r,s,x))n.updateValue(s,p),s++,a++,d=c.next();else if(!o.has(x))n.attach(s,n.create(s,p)),s++,a++,d=c.next();else{let S=t(s,h);r.set(S,n.detach(s)),a--}}}for(;!d.done;)PT(n,r,t,n.length,d.value),d=c.next()}for(;s<=a;)n.destroy(n.detach(a--));r?.forEach(c=>{n.destroy(c)})}function l_(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function PT(n,e,t,i,r){if(l_(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function NT(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var np=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function Q(n,e,t,i,r,o,s,a){gi("NgControlFlow");let l=Be(),c=Xt(),d=Di(c.consts,o);return tp(l,c,n,e,t,i,r,d,256,s,a),iE}function iE(n,e,t,i,r,o,s,a){gi("NgControlFlow");let l=Be(),c=Xt(),d=Di(c.consts,o);return tp(l,c,n,e,t,i,r,d,512,s,a),iE}function J(n,e){gi("NgControlFlow");let t=Be(),i=Qs(),r=t[i]!==En?t[i]:-1,o=r!==-1?ip(t,ut+r):void 0,s=0;if(Mi(t,i,n)){let a=Ue(null);try{if(o!==void 0&&z_(o,s),n!==-1){let l=ut+n,c=ip(t,l),d=h_(t[Ce],l),h=RD(c,d,t),p=Cu(t,d,e,{dehydratedView:h});Du(c,p,s,cl(d,h))}}finally{Ue(a)}}else if(o!==void 0){let a=SD(o,s);a!==void 0&&(a[Zt]=e)}}var c_=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-$t}};function Pu(n){return n}function Cr(n,e){return e}var u_=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function wn(n,e,t,i,r,o,s,a,l,c,d,h,p){gi("NgControlFlow");let g=Be(),x=Xt(),S=l!==void 0,N=Be(),U=a?s.bind(N[Kn][Zt]):s,se=new u_(S,U);N[ut+n]=se,tp(g,x,n+1,e,t,i,r,Di(x.consts,o),256),S&&tp(g,x,n+2,l,c,d,h,Di(x.consts,p),512)}var d_=class extends a_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-$t}at(e){return this.getLView(e)[Zt].$implicit}attach(e,t){let i=t[Zn];this.needsIndexUpdate||=e!==this.length,Du(this.lContainer,t,e,cl(this.templateTNode,i)),i5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,r5(this.lContainer,e),o5(this.lContainer,e)}create(e,t){let i=Yf(this.lContainer,this.templateTNode.tView.ssrId);return Cu(this.hostLView,this.templateTNode,new c_(this.lContainer,t,e),{dehydratedView:i})}destroy(e){gp(e[Ce],e)}updateValue(e,t){this.getLView(e)[Zt].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Zt].$index=e}getLView(e){return s5(this.lContainer,e)}};function xn(n){let e=Ue(null),t=Ai();try{let i=Be(),r=i[Ce],o=i[t],s=t+1,a=ip(i,s);if(o.liveCollection===void 0){let c=h_(r,s);o.liveCollection=new d_(a,i,c)}else o.liveCollection.reset();let l=o.liveCollection;if(n5(l,n,o.trackByFn,e),l.updateIndexes(),o.hasEmptyBlock){let c=Qs(),d=l.length===0;if(Mi(i,c,d)){let h=t+2,p=ip(i,h);if(d){let g=h_(r,h),x=RD(p,g,i),S=Cu(i,g,void 0,{dehydratedView:x});Du(p,S,0,cl(g,x))}else r.firstUpdatePass&&wp(p),z_(p,0)}}}finally{Ue(e)}}function ip(n,e){return n[e]}function i5(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t],r=i?i[zs]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[li];x3(o,r),ea.delete(i[Xr]),r.detachedLeaveAnimationFns=void 0}}function r5(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t],r=i?i[zs]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function o5(n,e){return vu(n,e)}function s5(n,e){return SD(n,e)}function h_(n,e){return Ks(n,e)}function Oe(n,e,t){let i=Be(),r=Qs();if(Mi(i,r,e)){let o=Xt(),s=_v();$3(s,i,n,e,i[xt],t)}return Oe}function f_(n,e,t,i,r){$_(e,n,t,r?"class":"style",i)}function _(n,e,t,i){let r=Be(),o=r[Ce],s=n+ut,a=o.firstCreatePass?LD(s,r,2,e,dD,sv(),t,i):o.data[s];if(hD(a,r,n,e,rE),ru(a)){let l=r[Ce];j_(l,r,a),jC(l,a,r)}return i!=null&&yp(r,a),_}function b(){let n=Xt(),e=Ln(),t=fD(e);return n.firstCreatePass&&VD(n,t),lv(t)&&cv(),ov(),t.classesWithoutHost!=null&&gF(t)&&f_(n,t,Be(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&mF(t)&&f_(n,t,Be(),t.stylesWithoutHost,!1),b}function W(n,e,t,i){return _(n,e,t,i),b(),W}function C(n,e,t,i){let r=Be(),o=r[Ce],s=n+ut,a=o.firstCreatePass?$L(s,o,2,e,t,i):o.data[s];return hD(a,r,n,e,rE),i!=null&&yp(r,a),C}function A(){let n=Ln(),e=fD(n);return lv(e)&&cv(),ov(),A}function j(n,e,t,i){return C(n,e,t,i),A(),j}var rE=(n,e,t,i,r)=>(to(!0),A_(e[xt],i,Ev()));function a5(n,e,t,i,r){let o=!dp(e,t);if(to(o),o)return A_(e[xt],i,Ev());let s=e[Zn],a=Ep(s,n,e,t);return LC(s,r)&&up(s,r,a.nextSibling),s&&(nC(t)||iC(a))&&eo(t)&&(FI(t),WC(a)),a}function cA(){rE=a5}var l5=(n,e,t,i,r)=>(to(!0),GC(e[xt],""));function c5(n,e,t,i,r){let o,s=!dp(e,t);if(to(s),s)return GC(e[xt],"");let a=e[Zn],l=Ep(a,n,e,t),c=zF(a,r);return up(a,r,l),o=bp(c,l),o}function uA(){l5=c5}function Je(){return Be()}var hu=void 0;function u5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var d5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],hu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],hu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",hu,hu,hu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",u5],Lv={};function mi(n){let e=h5(n),t=kT(e);if(t)return t;let i=e.split("-")[0];if(t=kT(i),t)return t;if(i==="en")return d5;throw new pe(701,!1)}function kT(n){return n in Lv||(Lv[n]=pr.ng&&pr.ng.common&&pr.ng.common.locales&&pr.ng.common.locales[n]),Lv[n]}var en=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(en||{});function h5(n){return n.toLowerCase().replace(/_/g,"-")}var Nu="en-US";var f5=Nu;function dA(n){typeof n=="string"&&(f5=n.toLowerCase().replace(/_/g,"-"))}function ne(n,e,t){let i=Be(),r=Xt(),o=Ln();return p5(r,i,i[xt],o,n,e,t),ne}function Bt(n,e,t){let i=Be(),r=Xt(),o=Ln();return(o.type&3||t)&&jD(o,r,i,t,i[xt],n,e,Ff(o,i,e)),Bt}function p5(n,e,t,i,r,o,s){let a=!0,l=null;if((i.type&3||s)&&(l??=Ff(i,e,o),jD(i,n,e,s,t,r,o,l)&&(a=!1)),a){let c=i.outputs?.[r],d=i.hostDirectiveOutputs?.[r];if(d&&d.length)for(let h=0;h<d.length;h+=2){let p=d[h],g=d[h+1];l??=Ff(i,e,o),bT(i,e,p,g,r,l)}if(c&&c.length)for(let h of c)l??=Ff(i,e,o),bT(i,e,h,r,r,l)}}function O(n=1){return qI(n)}function _l(n,e,t){return pV(n,e,t),_l}function El(n){let e=Be(),t=Xt(),i=mv();xf(i+1);let r=J_(t,i);if(n.dirty&&AI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=yV(e,i);n.reset(o,AF),n.notifyOnChanges()}return!0}return!1}function bl(){return hV(Be(),mv())}function ku(n){let e=hv();return ou(e,ut+n)}function Mf(n,e){return n<<17|e<<2}function ia(n){return n>>17&32767}function g5(n){return(n&2)==2}function m5(n,e){return n&131071|e<<17}function p_(n){return n|2}function dl(n){return(n&131068)>>2}function Vv(n,e){return n&-131069|e<<2}function y5(n){return(n&1)===1}function g_(n){return n|1}function v5(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=ia(s),l=dl(s);n[i]=t;let c=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||Xa(h,d)>0)&&(c=!0)}else d=t;if(r)if(l!==0){let p=ia(n[a+1]);n[i+1]=Mf(p,a),p!==0&&(n[p+1]=Vv(n[p+1],i)),n[a+1]=m5(n[a+1],i)}else n[i+1]=Mf(a,0),a!==0&&(n[a+1]=Vv(n[a+1],i)),a=i;else n[i+1]=Mf(l,0),a===0?a=i:n[l+1]=Vv(n[l+1],i),l=i;c&&(n[i+1]=p_(n[i+1])),OT(n,d,i,!0),OT(n,d,i,!1),_5(e,d,n,i,o),s=Mf(a,l),o?e.classBindings=s:e.styleBindings=s}function _5(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Xa(o,e)>=0&&(t[i+1]=g_(t[i+1]))}function OT(n,e,t,i){let r=n[t+1],o=e===null,s=i?ia(r):dl(r),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];E5(l,e)&&(a=!0,n[s+1]=i?g_(c):p_(c)),s=i?ia(c):dl(c)}a&&(n[t+1]=i?p_(r):g_(r))}function E5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Xa(n,e)>=0:!1}var Ki={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function b5(n){return n.substring(Ki.key,Ki.keyEnd)}function w5(n){return x5(n),hA(n,fA(n,0,Ki.textEnd))}function hA(n,e){let t=Ki.textEnd;return t===e?-1:(e=Ki.keyEnd=S5(n,Ki.key=e,t),fA(n,e,t))}function x5(n){Ki.key=0,Ki.keyEnd=0,Ki.value=0,Ki.valueEnd=0,Ki.textEnd=n.length}function fA(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function S5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function it(n,e,t){return pA(n,e,t,!1),it}function Ne(n,e){return pA(n,e,null,!0),Ne}function oE(n){T5(P5,I5,n,!0)}function I5(n,e){for(let t=w5(e);t>=0;t=hA(e,t))mf(n,b5(e),!0)}function pA(n,e,t,i){let r=Be(),o=Xt(),s=cu(2);if(o.firstUpdatePass&&mA(o,n,s,i),e!==En&&Mi(r,s,e)){let a=o.data[Ai()];yA(o,a,r,r[xt],n,r[s+1]=k5(e,t),i,s)}}function T5(n,e,t,i){let r=Xt(),o=cu(2);r.firstUpdatePass&&mA(r,null,o,i);let s=Be();if(t!==En&&Mi(s,o,t)){let a=r.data[Ai()];if(vA(a,i)&&!gA(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=uf(l,t||"")),f_(r,a,s,t,i)}else N5(r,a,s,s[xt],s[o+1],s[o+1]=R5(n,e,t),i,o)}}function gA(n,e){return e>=n.expandoStartIndex}function mA(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Ai()],s=gA(n,t);vA(o,i)&&e===null&&!s&&(e=!1),e=C5(r,o,e,i),v5(r,o,e,t,s,i)}}function C5(n,e,t,i){let r=$I(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Uv(null,n,e,t,i),t=Eu(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Uv(r,n,e,t,i),o===null){let l=D5(n,e,i);l!==void 0&&Array.isArray(l)&&(l=Uv(null,n,e,l[1],i),l=Eu(l,e.attrs,i),A5(n,e,i,l))}else o=M5(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function D5(n,e,t){let i=t?e.classBindings:e.styleBindings;if(dl(i)!==0)return n[ia(i)]}function A5(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[ia(r)]=i}function M5(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=Eu(i,s,t)}return Eu(i,e.attrs,t)}function Uv(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=Eu(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function Eu(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),mf(n,s,t?!0:e[++o]))}return n===void 0?null:n}function R5(n,e,t){if(t==null||t==="")return zn;let i=[],r=gl(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(r instanceof Set)for(let o of r)n(i,o,!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function P5(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&mf(n,i,t)}function N5(n,e,t,i,r,o,s,a){r===En&&(r=zn);let l=0,c=0,d=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;d!==null||h!==null;){let p=l<r.length?r[l+1]:void 0,g=c<o.length?o[c+1]:void 0,x=null,S;d===h?(l+=2,c+=2,p!==g&&(x=h,S=g)):h===null||d!==null&&d<h?(l+=2,x=d):(c+=2,x=h,S=g),x!==null&&yA(n,e,t,i,x,S,s,a),d=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}function yA(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],d=y5(c)?FT(l,e,t,r,dl(c),s):void 0;if(!rp(d)){rp(o)||g5(c)&&(o=FT(l,null,t,r,a,s));let h=Xy(Ai(),t);V3(i,s,h,r,o)}}function FT(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let l=n[r],c=Array.isArray(l),d=c?l[1]:l,h=d===null,p=t[r+1];p===En&&(p=h?zn:void 0);let g=h?yf(p,i):d===i?p:void 0;if(c&&!rp(g)&&(g=yf(l,i)),rp(g)&&(a=g,s))return a;let x=n[r+1];r=s?ia(x):dl(x)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=yf(l,i))}return a}function rp(n){return n!==void 0}function k5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Qr(gl(n)))),n}function vA(n,e){return(n.flags&(e?8:16))!==0}function v(n,e=""){let t=Be(),i=Xt(),r=n+ut,o=i.firstCreatePass?ml(i,r,1,e,null):i.data[r],s=_A(i,t,o,e,n);t[r]=s,Tf()&&U_(i,t,s,o),Ys(o,!1)}var _A=(n,e,t,i,r)=>(to(!0),$C(e[xt],i));function O5(n,e,t,i,r){let o=!dp(e,t);if(to(o),o)return $C(e[xt],i);let s=e[Zn];return Ep(s,n,e,t)}function EA(){_A=O5}function F5(n,e,t,i=""){return Mi(n,Qs(),t)?e+zi(t)+i:En}function L5(n,e,t,i,r,o=""){let s=gv(),a=Y_(n,s,t,r);return cu(2),a?e+zi(t)+i+zi(r)+o:En}function V5(n,e,t,i,r,o,s,a=""){let l=gv(),c=zL(n,l,t,r,s);return cu(3),c?e+zi(t)+i+zi(r)+o+zi(s)+a:En}function q(n){return G("",n),q}function G(n,e,t){let i=Be(),r=F5(i,n,e,t);return r!==En&&sE(i,Ai(),r),G}function tn(n,e,t,i,r){let o=Be(),s=L5(o,n,e,t,i,r);return s!==En&&sE(o,Ai(),s),tn}function Xo(n,e,t,i,r,o,s){let a=Be(),l=V5(a,n,e,t,i,r,o,s);return l!==En&&sE(a,Ai(),l),Xo}function sE(n,e,t){let i=Xy(e,n);e3(n[xt],i,t)}var bA={};function wl(n){gi("NgLet");let e=Xt(),t=Be(),i=n+ut,r=ml(e,i,128,null,null);return Ys(r,!1),su(e,t,i,bA),wl}function Ou(n){let e=Xt(),t=Be(),i=Ai();return su(e,t,i,n),n}function Dr(n){let e=hv(),t=ou(e,ut+n);if(t===bA)throw new pe(314,!1);return t}function aE(n){return Mi(Be(),Qs(),n)?zi(n):En}function LT(n,e,t){let i=Xt();i.firstCreatePass&&wA(e,i.data,i.blueprint,br(n),t)}function wA(n,e,t,i,r){if(n=Pn(n),Array.isArray(n))for(let o=0;o<n.length;o++)wA(n[o],e,t,i,r);else{let o=Xt(),s=Be(),a=Ln(),l=Us(n)?n:Pn(n.provide),c=Ky(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(Us(n)||!n.multi){let g=new Xs(c,r,ge,null),x=jv(l,e,r?d:d+p,h);x===-1?($v(Hf(a,s),o,l),Bv(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)):(t[x]=g,s[x]=g)}else{let g=jv(l,e,d+p,h),x=jv(l,e,d,d+p),S=g>=0&&t[g],N=x>=0&&t[x];if(r&&!N||!r&&!S){$v(Hf(a,s),o,l);let U=j5(r?B5:U5,t.length,r,i,c,n);!r&&N&&(t[x].providerFactory=U),Bv(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(U),s.push(U)}else{let U=xA(t[r?x:g],c,!r&&i);Bv(o,n,g>-1?g:x,U)}!r&&i&&N&&t[x].componentProviders++}}}function Bv(n,e,t,i){let r=Us(e),o=II(e);if(r||o){let l=(o?Pn(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function xA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function jv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function U5(n,e,t,i,r){return m_(this.multi,[])}function B5(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=gu(i,i[Ce],this.providerFactory.index,r);s=l.slice(0,a),m_(o,s);for(let c=a;c<l.length;c++)s.push(l[c])}else s=[],m_(o,s);return s}function m_(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function j5(n,e,t,i,r,o){let s=new Xs(n,t,ge,null);return s.multi=[],s.index=e,s.componentProviders=0,xA(s,r,i&&!t),s}function Fu(n,e){return t=>{t.providersResolver=(i,r)=>LT(i,r?r(n):n,!1),e&&(t.viewProvidersResolver=(i,r)=>LT(i,r?r(e):e,!0))}}function aa(n,e){let t=lu()+n,i=Be();return i[t]===En?K_(i,t,e()):GL(i,t)}function _t(n,e,t,i){return IA(Be(),lu(),n,e,t,i)}function SA(n,e){let t=n[e];return t===En?void 0:t}function H5(n,e,t,i,r,o){let s=e+t;return Mi(n,s,r)?K_(n,s+1,o?i.call(o,r):i(r)):SA(n,s+1)}function IA(n,e,t,i,r,o,s){let a=e+t;return Y_(n,a,r,o)?K_(n,a+2,s?i.call(s,r,o):i(r,o)):SA(n,a+2)}function Ar(n,e){let t=Xt(),i,r=n+ut;t.firstCreatePass?(i=$5(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Bo(i.type,!0)),s,a=Gn(ge);try{let l=jf(!1),c=o();return jf(l),su(t,Be(),r,c),c}finally{Gn(a)}}function $5(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function lE(n,e,t){let i=n+ut,r=Be(),o=ou(r,i);return TA(r,i)?H5(r,lu(),e,o.transform,t,o):o.transform(t)}function oo(n,e,t,i){let r=n+ut,o=Be(),s=ou(o,r);return TA(o,r)?IA(o,lu(),e,s.transform,t,i,s):s.transform(t,i)}function TA(n,e){return n[Ce].data[e].pure}function cE(n,e){return _p(n,e)}var op=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},uE=(()=>{class n{compileModuleSync(t){return new ep(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=By(t),o=JC(r.declarations).reduce((s,a)=>{let l=Zr(a);return l&&s.push(new ul(l)),s},[]);return new op(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var CA=(()=>{class n{applicationErrorHandler=z(fi);appRef=z(ei);taskService=z(wr);ngZone=z(mn);zonelessEnabled=z(uu);tracing=z(Qo,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new gn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Qc):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(z(Tv,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?JI:wv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Qc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.applicationErrorHandler(i)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function DA(){return[{provide:Ho,useExisting:CA},{provide:mn,useClass:Jc},{provide:uu,useValue:!0}]}function G5(){return typeof $localize<"u"&&$localize.locale||Nu}var Lu=new _e("",{factory:()=>z(Lu,{optional:!0,skipSelf:!0})||G5()});function ti(n,e){return Dh(n,e?.equal)}var gE={JSACTION:"__jsaction",OWNER:"__owner"},PA={};function z5(n){return n[gE.JSACTION]}function AA(n,e){n[gE.JSACTION]=e}function W5(n){return PA[n]}function q5(n,e){PA[n]=e}var ke={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},K5=[ke.MOUSEENTER,ke.MOUSELEAVE,"pointerenter","pointerleave"],yte=[ke.CLICK,ke.DBLCLICK,ke.FOCUSIN,ke.FOCUSOUT,ke.KEYDOWN,ke.KEYUP,ke.KEYPRESS,ke.MOUSEOVER,ke.MOUSEOUT,ke.SUBMIT,ke.TOUCHSTART,ke.TOUCHEND,ke.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],Y5=[ke.FOCUS,ke.BLUR,ke.ERROR,ke.LOAD,ke.TOGGLE],mE=n=>Y5.indexOf(n)>=0;function Q5(n){return n===ke.MOUSEENTER?ke.MOUSEOVER:n===ke.MOUSELEAVE?ke.MOUSEOUT:n===ke.POINTERENTER?ke.POINTEROVER:n===ke.POINTERLEAVE?ke.POINTEROUT:n}function J5(n,e,t,i){let r=!1;mE(e)&&(r=!0);let o=typeof i=="boolean"?{capture:r,passive:i}:r;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:r,passive:i}}function Z5(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function X5(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var MA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function eU(n){return n.which===2||n.which==null&&n.button===4}function tU(n){return MA&&n.metaKey||!MA&&n.ctrlKey||eU(n)||n.shiftKey}function nU(n,e,t){let i=n.relatedTarget;return(n.type===ke.MOUSEOVER&&e===ke.MOUSEENTER||n.type===ke.MOUSEOUT&&e===ke.MOUSELEAVE||n.type===ke.POINTEROVER&&e===ke.POINTERENTER||n.type===ke.POINTEROUT&&e===ke.POINTERLEAVE)&&(!i||i!==t&&!t.contains(i))}function iU(n,e){let t={};for(let i in n){if(i==="srcElement"||i==="target")continue;let r=i,o=n[r];typeof o!="function"&&(t[r]=o)}return n.type===ke.MOUSEOVER?t.type=ke.MOUSEENTER:n.type===ke.MOUSEOUT?t.type=ke.MOUSELEAVE:n.type===ke.POINTEROVER?t.type=ke.POINTERENTER:t.type=ke.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var rU=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),Rp=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,i){rU&&(this.element.style.cursor="pointer"),this.handlerInfos.push(J5(this.element,e,t(this.element),i))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)Z5(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},oU={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function es(n){return n.eventType}function yE(n,e){n.eventType=e}function Ap(n){return n.event}function NA(n,e){n.event=e}function kA(n){return n.targetElement}function OA(n,e){n.targetElement=e}function FA(n){return n.eic}function sU(n,e){n.eic=e}function aU(n){return n.timeStamp}function lU(n,e){n.timeStamp=e}function Mp(n){return n.eia}function LA(n,e,t){n.eia=[e,t]}function dE(n){n.eia=void 0}function Dp(n){return n[1]}function cU(n){return n.eirp}function VA(n,e){n.eirp=e}function UA(n){return n.eir}function BA(n,e){n.eir=e}function jA(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function uU(n,e,t,i,r,o,s,a){return{eventType:n,event:e,targetElement:t,eic:i,timeStamp:r,eia:o,eirp:s,eiack:a}}var hE=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return es(this.eventInfo)}setEventType(e){yE(this.eventInfo,e)}getEvent(){return Ap(this.eventInfo)}setEvent(e){NA(this.eventInfo,e)}getTargetElement(){return kA(this.eventInfo)}setTargetElement(e){OA(this.eventInfo,e)}getContainer(){return FA(this.eventInfo)}setContainer(e){sU(this.eventInfo,e)}getTimestamp(){return aU(this.eventInfo)}setTimestamp(e){lU(this.eventInfo,e)}getAction(){let e=Mp(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){dE(this.eventInfo);return}LA(this.eventInfo,e.name,e.element)}getIsReplay(){return cU(this.eventInfo)}setIsReplay(e){VA(this.eventInfo,e)}getResolved(){return UA(this.eventInfo)}setResolved(e){BA(this.eventInfo,e)}clone(){return new n(jA(this.eventInfo))}},dU={},hU=/\s*;\s*/,fU=ke.CLICK,fE=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&es(e)===ke.CLICK&&tU(Ap(e))?yE(e,ke.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){UA(e)||(this.populateAction(e,kA(e)),BA(e,!0))}resolveParentAction(e){let t=Mp(e),i=t&&Dp(t);dE(e);let r=i&&this.getParentNode(i);r&&this.populateAction(e,r)}populateAction(e,t){let i=t;for(;i&&i!==FA(e)&&(i.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(i,e),!Mp(e));)i=this.getParentNode(i);let r=Mp(e);if(r&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(es(e)===ke.MOUSEENTER||es(e)===ke.MOUSELEAVE||es(e)===ke.POINTERENTER||es(e)===ke.POINTERLEAVE)))if(nU(Ap(e),es(e),Dp(r))){let o=iU(Ap(e),Dp(r));NA(e,o),OA(e,Dp(r))}else dE(e)}getParentNode(e){let t=e[gE.OWNER];if(t)return t;let i=e.parentNode;return i?.nodeName==="#document-fragment"?i?.host??null:i}populateActionOnElement(e,t){let i=this.parseActions(e),r=i[es(t)];r!==void 0&&LA(t,r,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,i)}parseActions(e){let t=z5(e);if(!t){let i=e.getAttribute(Df.JSACTION);if(!i)t=dU,AA(e,t);else{if(t=W5(i),!t){t={};let r=i.split(hU);for(let o=0;o<r.length;o++){let s=r[o];if(!s)continue;let a=s.indexOf(oU.EVENT_ACTION_SEPARATOR),l=a!==-1,c=l?s.substr(0,a).trim():fU,d=l?s.substr(a+1).trim():s;t[c]=d}q5(i,t)}AA(e,t)}}return t}addA11yClickSupport(e,t,i){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=i}},HA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(HA||{}),pE=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:i}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=i}dispatch(e){let t=new hE(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let i=t.getAction();if(i&&pU(i.element,t)&&X5(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function pU(n,e){return n.tagName==="A"&&(e.getEventType()===ke.CLICK||e.getEventType()===ke.CLICKMOD)}var $A=Symbol.for("propagationStopped"),vE={REPLAY:101};var gU="`preventDefault` called during event replay.";var mU="`composedPath` called during event replay.",Pp=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new fE({clickModSupport:t}),this.dispatcher=new pE(i=>{this.dispatchToDelegate(i)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&_U(e),yU(e);e.getAction();){if(EU(e),mE(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),vU(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function yU(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),i=()=>{e[$A]=!0,t()};la(e,"stopPropagation",i),la(e,"stopImmediatePropagation",i)}function vU(n){return!!n.getEvent()[$A]}function _U(n){let e=n.getEvent(),t=n.getTargetElement(),i=e.preventDefault.bind(e);la(e,"target",t),la(e,"eventPhase",vE.REPLAY),la(e,"preventDefault",()=>{throw i(),new Error(gU+"")}),la(e,"composedPath",()=>{throw new Error(mU+"")})}function EU(n){let e=n.getEvent(),t=n.getAction()?.element;t&&la(e,"currentTarget",t,{configurable:!0})}function la(n,e,t,{configurable:i=!1}={}){Object.defineProperty(n,e,{value:t,configurable:i})}function GA(n,e){n.ecrd(t=>{e.dispatch(t)},HA.I_AM_THE_JSACTION_FRAMEWORK)}function bU(n){return n?.q??[]}function wU(n){n&&(RA(n.c,n.et,n.h),RA(n.c,n.etc,n.h,!0))}function RA(n,e,t,i){for(let r=0;r<e.length;r++)n.removeEventListener(e[r],t,i)}var xU=!1,zA=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=xU;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,i,r){let o=uU(t,i,i.target,r,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){VA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,i,r){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&K5.indexOf(t)>=0)return;let o=(a,l,c)=>{this.handleEvent(a,l,c)};this.eventHandlers[t]=o;let s=Q5(i||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>l=>{o(t,l,a)},r)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),wU(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let i=0;i<t.length;i++){let r=t[i],o=this.getEventTypesForBrowserEventType(r.eventType);for(let s=0;s<o.length;s++){let a=jA(r);yE(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let i=[];return this.eventHandlers[t]&&i.push(t),this.browserEventTypeToExtraEventTypes[t]&&i.push(...this.browserEventTypeToExtraEventTypes[t]),i}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,i){this.ecrd(t,i)}ecrd(t,i){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let r=0;r<this.queuedEventInfos.length;r++)this.handleEventInfo(this.queuedEventInfos[r]);this.queuedEventInfos=null}}}return n})();function WA(n,e=window){return bU(e._ejsas?.[n])}function _E(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var nM=Symbol("InputSignalNode#UNSET"),JU=ue(F({},Ah),{transformFn:void 0,applyValueToInputSignal(n,e){Bc(n,e)}});function iM(n,e){let t=Object.create(JU);t.value=n,t.transformFn=e?.transform;function i(){if(Lc(t),t.value===nM){let r=null;throw new pe(-950,r)}return t.value}return i[Qn]=t,i}var Op=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>wu(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function qA(n,e){return iM(n,e)}function ZU(n){return iM(nM,n)}var rM=(qA.required=ZU,qA);var EE=new _e(""),XU=new _e("");function Vu(n){return!n.moduleRef}function e6(n){let e=Vu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(mn);return t.run(()=>{Vu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(fi),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Vu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(EE);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(EE);s.add(o),n.moduleRef.onDestroy(()=>{pu(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return n6(i,t,()=>{let o=e.get(wr),s=o.add(),a=e.get(tE);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(Lu,Nu);if(dA(l||Nu),!e.get(XU,!0))return Vu(n)?e.get(ei):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Vu(n)){let d=e.get(ei);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return t6?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var t6;function n6(n,e,t){try{let i=t();return Jo(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var kp=null;function i6(n=[],e){return Wn.create({name:e,providers:[{provide:eu,useValue:"platform"},{provide:EE,useValue:new Set([()=>kp=null])},...n]})}function r6(n=[]){if(kp)return kp;let e=i6(n);return kp=e,oA(),o6(e),e}function o6(n){let e=n.get(sp,null);Nn(n,()=>{e?.forEach(t=>t())})}function oM(){return!1}var Np=new WeakSet,KA="";function YA(n){return n.get(x_,EC)}function sM(){let n=[{provide:x_,useFactory:()=>{let e=!0;{let t=z(Ir);e=!!window._ejsas?.[t]}return e&&gi("NgEventReplay"),e}}];return n.push({provide:mr,useValue:()=>{let e=z(ei),{injector:t}=e;if(!Np.has(e)){let i=z(S_);if(YA(t)){AC();let r=t.get(Ir),o=CC(r,(s,a,l)=>{s.nodeType===Node.ELEMENT_NODE&&(xC(s,a,l),SC(s,i))});e.onDestroy(o)}}},multi:!0},{provide:Zo,useFactory:()=>{let e=z(ei),{injector:t}=e;return()=>{if(!YA(t)||Np.has(e))return;Np.add(e);let i=t.get(Ir);e.onDestroy(()=>{Np.delete(e),_E(i)}),e.whenStable().then(()=>{if(e.destroyed)return;let r=t.get(TC);s6(r,t);let o=t.get(S_);o.get(KA)?.forEach(IC),o.delete(KA);let s=r.instance;FC(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var s6=(n,e)=>{let t=e.get(Ir),i=window._ejsas[t],r=n.instance=new zA(new Rp(i.c));for(let a of i.et)r.addEvent(a);for(let a of i.etc)r.addEvent(a);let o=WA(t);r.replayEarlyEventInfos(o),_E(t);let s=new Pp(a=>{a6(e,a,a.currentTarget)});GA(r,s)};function a6(n,e,t){let i=(t&&t.getAttribute(Su))??"";/d\d+/.test(i)?l6(i,n,e,t):e.eventPhase===vE.REPLAY&&I_(e,t)}function l6(n,e,t,i){let r=e.get(bC);r.push({event:t,currentTarget:i}),lA(e,n,c6(r))}function c6(n){return e=>{let t=new Set(e),i=[];for(let{event:r,currentTarget:o}of n){let s=o.getAttribute(Su);t.has(s)?I_(r,o):i.push({event:r,currentTarget:o})}n.length=0,n.push(...i)}}var QA=!1;var u6=1e4;function d6(){QA||(QA=!0,NC(),cA(),EA(),uA(),tA(),KD(),MD(),uD())}function h6(n){return n.whenStable()}function aM(){let n=[{provide:xu,useFactory:()=>{let e=!0;return e=!!z(pl,{optional:!0})?.get(T_,null),e&&gi("NgHydration"),e}},{provide:mr,useValue:()=>{TD(!1);let e=z(Kt);z(xu)&&(UC(e),d6())},multi:!0}];return n.push({provide:w_,useFactory:()=>z(xu)},{provide:Zo,useFactory:()=>{if(z(xu)){let e=z(ei);return()=>{h6(e).then(()=>{e.destroyed||W_(e)})}}return()=>{}},multi:!0}),yr(n)}var tse=u6-1e3;var ca=(()=>{class n{static __NG_ELEMENT_ID__=f6}return n})();function f6(n){return p6(Ln(),Be(),(n&16)===16)}function p6(n,e,t){if(eo(n)&&!t){let i=Ci(n.index,e);return new Ko(i,i)}else if(n.type&175){let i=e[Kn];return new Ko(i,e)}return null}var bE=class{constructor(){}supports(e){return q_(e)}create(e){return new wE(e)}},g6=(n,e)=>e,wE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||g6}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<JA(i,r,o)?t:i,a=JA(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){let g=p<o.length?o[p]:o[p]=0,x=g+p;d<=x&&x<c&&(o[p]=g+1)}let h=s.previousIndex;o[h]=d-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!q_(e))throw new pe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,UD(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new xE(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Fp),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Fp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},xE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},SE=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},Fp=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new SE,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function JA(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function ZA(){return new IE([new bE])}var IE=(()=>{class n{factories;static \u0275prov=ce({token:n,providedIn:"root",factory:ZA});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=z(n,{optional:!0,skipSelf:!0});return n.create(t,i||ZA())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new pe(901,!1)}}return n})();function lM(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;pt(st.BootstrapApplicationStart);try{let o=r?.injector??r6(i),s=[DA(),XI,...t||[]],a=new _u({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return e6({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{pt(st.BootstrapApplicationEnd)}}function Uu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var cM=null;function Pi(){return cM}function TE(n){cM??=n}var Bu=class{},Lp=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>z(uM),providedIn:"platform"})}return n})();var uM=(()=>{class n extends Lp{_location;_history;_doc=z(Kt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Pi().getBaseHref(this._doc)}onPopState(t){let i=Pi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Pi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function fM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function dM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ts(n){return n&&n[0]!=="?"?`?${n}`:n}var xl=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>z(y6),providedIn:"root"})}return n})(),m6=new _e(""),y6=(()=>{class n extends xl{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??z(Kt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return fM(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+ts(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+ts(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+ts(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(De(Lp),De(m6,8))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Sl=(()=>{class n{_subject=new Ut;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=E6(dM(hM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ts(i))}normalize(t){return n.stripTrailingSlash(_6(this._basePath,hM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ts(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ts(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=ts;static joinWithSlash=fM;static stripTrailingSlash=dM;static \u0275fac=function(i){return new(i||n)(De(xl))};static \u0275prov=ce({token:n,factory:()=>v6(),providedIn:"root"})}return n})();function v6(){return new Sl(De(xl))}function _6(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function hM(n){return n.replace(/\/index.html$/,"")}function E6(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Vn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Vn||{}),St=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(St||{}),ni=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(ni||{}),ao={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function yM(n){return mi(n)[en.LocaleId]}function vM(n,e,t){let i=mi(n),r=[i[en.DayPeriodsFormat],i[en.DayPeriodsStandalone]],o=Ni(r,e);return Ni(o,t)}function _M(n,e,t){let i=mi(n),r=[i[en.DaysFormat],i[en.DaysStandalone]],o=Ni(r,e);return Ni(o,t)}function EM(n,e,t){let i=mi(n),r=[i[en.MonthsFormat],i[en.MonthsStandalone]],o=Ni(r,e);return Ni(o,t)}function bM(n,e){let i=mi(n)[en.Eras];return Ni(i,e)}function ju(n,e){let t=mi(n);return Ni(t[en.DateFormat],e)}function Hu(n,e){let t=mi(n);return Ni(t[en.TimeFormat],e)}function $u(n,e){let i=mi(n)[en.DateTimeFormat];return Ni(i,e)}function Gu(n,e){let t=mi(n),i=t[en.NumberSymbols][e];if(typeof i>"u"){if(e===ao.CurrencyDecimal)return t[en.NumberSymbols][ao.Decimal];if(e===ao.CurrencyGroup)return t[en.NumberSymbols][ao.Group]}return i}function wM(n){if(!n[en.ExtraData])throw new pe(2303,!1)}function xM(n){let e=mi(n);return wM(e),(e[en.ExtraData][2]||[]).map(i=>typeof i=="string"?CE(i):[CE(i[0]),CE(i[1])])}function SM(n,e,t){let i=mi(n);wM(i);let r=[i[en.ExtraData][0],i[en.ExtraData][1]],o=Ni(r,e)||[];return Ni(o,t)||[]}function Ni(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new pe(2304,!1)}function CE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var b6=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Vp={},w6=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function IM(n,e,t,i){let r=R6(n);e=so(t,e)||e;let s=[],a;for(;e;)if(a=w6.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let l=r.getTimezoneOffset();i&&(l=CM(i,l),r=M6(r,i));let c="";return s.forEach(d=>{let h=D6(d);c+=h?h(r,t,l):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function $p(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function so(n,e){let t=yM(n);if(Vp[t]??={},Vp[t][e])return Vp[t][e];let i="";switch(e){case"shortDate":i=ju(n,ni.Short);break;case"mediumDate":i=ju(n,ni.Medium);break;case"longDate":i=ju(n,ni.Long);break;case"fullDate":i=ju(n,ni.Full);break;case"shortTime":i=Hu(n,ni.Short);break;case"mediumTime":i=Hu(n,ni.Medium);break;case"longTime":i=Hu(n,ni.Long);break;case"fullTime":i=Hu(n,ni.Full);break;case"short":let r=so(n,"shortTime"),o=so(n,"shortDate");i=Up($u(n,ni.Short),[r,o]);break;case"medium":let s=so(n,"mediumTime"),a=so(n,"mediumDate");i=Up($u(n,ni.Medium),[s,a]);break;case"long":let l=so(n,"longTime"),c=so(n,"longDate");i=Up($u(n,ni.Long),[l,c]);break;case"full":let d=so(n,"fullTime"),h=so(n,"fullDate");i=Up($u(n,ni.Full),[d,h]);break}return i&&(Vp[t][e]=i),i}function Up(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function Xi(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function x6(n,e){return Xi(n,3).substring(0,e)}function dn(n,e,t=0,i=!1,r=!1){return function(o,s){let a=S6(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return x6(a,e);let l=Gu(s,ao.MinusSign);return Xi(a,e,l,i,r)}}function S6(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new pe(2301,!1)}}function At(n,e,t=Vn.Format,i=!1){return function(r,o){return I6(r,o,n,e,t,i)}}function I6(n,e,t,i,r,o){switch(t){case 2:return EM(e,r,i)[n.getMonth()];case 1:return _M(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let c=xM(e),d=SM(e,r,i),h=c.findIndex(p=>{if(Array.isArray(p)){let[g,x]=p,S=s>=g.hours&&a>=g.minutes,N=s<x.hours||s===x.hours&&a<x.minutes;if(g.hours<x.hours){if(S&&N)return!0}else if(S||N)return!0}else if(p.hours===s&&p.minutes===a)return!0;return!1});if(h!==-1)return d[h]}return vM(e,r,i)[s<12?0:1];case 3:return bM(e,i)[n.getFullYear()<=0?0:1];default:let l=t;throw new pe(2302,!1)}}function Bp(n){return function(e,t,i){let r=-1*i,o=Gu(t,ao.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Xi(s,2,o)+Xi(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+Xi(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+Xi(s,2,o)+":"+Xi(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+Xi(s,2,o)+":"+Xi(Math.abs(r%60),2,o);default:throw new pe(2310,!1)}}}var T6=0,Hp=4;function C6(n){let e=$p(n,T6,1).getDay();return $p(n,0,1+(e<=Hp?Hp:Hp+7)-e)}function TM(n){let e=n.getDay(),t=e===0?-3:Hp-e;return $p(n.getFullYear(),n.getMonth(),n.getDate()+t)}function DE(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=TM(t),s=C6(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Xi(r,n,Gu(i,ao.MinusSign))}}function jp(n,e=!1){return function(t,i){let o=TM(t).getFullYear();return Xi(o,n,Gu(i,ao.MinusSign),e)}}var AE={};function D6(n){if(AE[n])return AE[n];let e;switch(n){case"G":case"GG":case"GGG":e=At(3,St.Abbreviated);break;case"GGGG":e=At(3,St.Wide);break;case"GGGGG":e=At(3,St.Narrow);break;case"y":e=dn(0,1,0,!1,!0);break;case"yy":e=dn(0,2,0,!0,!0);break;case"yyy":e=dn(0,3,0,!1,!0);break;case"yyyy":e=dn(0,4,0,!1,!0);break;case"Y":e=jp(1);break;case"YY":e=jp(2,!0);break;case"YYY":e=jp(3);break;case"YYYY":e=jp(4);break;case"M":case"L":e=dn(1,1,1);break;case"MM":case"LL":e=dn(1,2,1);break;case"MMM":e=At(2,St.Abbreviated);break;case"MMMM":e=At(2,St.Wide);break;case"MMMMM":e=At(2,St.Narrow);break;case"LLL":e=At(2,St.Abbreviated,Vn.Standalone);break;case"LLLL":e=At(2,St.Wide,Vn.Standalone);break;case"LLLLL":e=At(2,St.Narrow,Vn.Standalone);break;case"w":e=DE(1);break;case"ww":e=DE(2);break;case"W":e=DE(1,!0);break;case"d":e=dn(2,1);break;case"dd":e=dn(2,2);break;case"c":case"cc":e=dn(7,1);break;case"ccc":e=At(1,St.Abbreviated,Vn.Standalone);break;case"cccc":e=At(1,St.Wide,Vn.Standalone);break;case"ccccc":e=At(1,St.Narrow,Vn.Standalone);break;case"cccccc":e=At(1,St.Short,Vn.Standalone);break;case"E":case"EE":case"EEE":e=At(1,St.Abbreviated);break;case"EEEE":e=At(1,St.Wide);break;case"EEEEE":e=At(1,St.Narrow);break;case"EEEEEE":e=At(1,St.Short);break;case"a":case"aa":case"aaa":e=At(0,St.Abbreviated);break;case"aaaa":e=At(0,St.Wide);break;case"aaaaa":e=At(0,St.Narrow);break;case"b":case"bb":case"bbb":e=At(0,St.Abbreviated,Vn.Standalone,!0);break;case"bbbb":e=At(0,St.Wide,Vn.Standalone,!0);break;case"bbbbb":e=At(0,St.Narrow,Vn.Standalone,!0);break;case"B":case"BB":case"BBB":e=At(0,St.Abbreviated,Vn.Format,!0);break;case"BBBB":e=At(0,St.Wide,Vn.Format,!0);break;case"BBBBB":e=At(0,St.Narrow,Vn.Format,!0);break;case"h":e=dn(3,1,-12);break;case"hh":e=dn(3,2,-12);break;case"H":e=dn(3,1);break;case"HH":e=dn(3,2);break;case"m":e=dn(4,1);break;case"mm":e=dn(4,2);break;case"s":e=dn(5,1);break;case"ss":e=dn(5,2);break;case"S":e=dn(6,1);break;case"SS":e=dn(6,2);break;case"SSS":e=dn(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Bp(0);break;case"ZZZZZ":e=Bp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Bp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Bp(2);break;default:return null}return AE[n]=e,e}function CM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function A6(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function M6(n,e,t){let r=n.getTimezoneOffset(),o=CM(e,r);return A6(n,-1*(o-r))}function R6(n){if(pM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return $p(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(b6))return P6(i)}let e=new Date(n);if(!pM(e))throw new pe(2311,!1);return e}function P6(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),c=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,c),e}function pM(n){return n instanceof Date&&!isNaN(n.valueOf())}var Gp=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Il=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Gp(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),gM(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);gM(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(ge(io),ge(Yo),ge(IE))};static \u0275dir=bn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function gM(n,e){n.context.$implicit=e.item}var ua=(()=>{class n{_viewContainer;_context=new zp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){mM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){mM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(ge(io),ge(Yo))};static \u0275dir=bn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),zp=class{$implicit=null;ngIf=null};function mM(n,e){if(n&&!n.createEmbeddedView)throw new pe(2020,!1)}function DM(n,e){return new pe(2100,!1)}var N6=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,ME=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw DM(n,t);return t.replace(N6,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=Tp({name:"titlecase",type:n,pure:!0})}return n})();var k6="mediumDate",AM=new _e(""),MM=new _e(""),da=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??k6,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return IM(t,s,o||this.locale,a)}catch(s){throw DM(n,s.message)}}static \u0275fac=function(i){return new(i||n)(ge(Lu,16),ge(AM,24),ge(MM,24))};static \u0275pipe=Tp({name:"date",type:n,pure:!0})}return n})();var jt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ro({type:n});static \u0275inj=gr({})}return n})();function RE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var zu=class{};var PE="browser";function ns(n){return n===PE}var qu=class{_doc;constructor(e){this._doc=e}manager},Wp=(()=>{class n extends qu{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(De(Kt))};static \u0275prov=ce({token:n,factory:n.\u0275fac})}return n})(),Yp=new _e(""),FE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof Wp));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof Wp);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new pe(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(De(Yp),De(mn))};static \u0275prov=ce({token:n,factory:n.\u0275fac})}return n})(),NE="ng-app-id";function RM(n){for(let e of n)e.remove()}function PM(n,e){let t=e.createElement("style");return t.textContent=n,t}function O6(n,e,t,i){let r=n.head?.querySelectorAll(`style[${NE}="${e}"],link[${NE}="${e}"]`);if(r)for(let o of r)o.removeAttribute(NE),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function OE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var LE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,O6(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,PM);i?.forEach(r=>this.addUsage(r,this.external,OE))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(RM(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])RM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,PM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,OE(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(De(Kt),De(Ir),De(fl,8),De(Ji))};static \u0275prov=ce({token:n,factory:n.\u0275fac})}return n})(),kE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},VE=/%COMP%/g;var kM="%COMP%",F6=`_nghost-${kM}`,L6=`_ngcontent-${kM}`,V6=!0,U6=new _e("",{factory:()=>V6});function B6(n){return L6.replace(VE,n)}function j6(n){return F6.replace(VE,n)}function OM(n,e){return e.map(t=>t.replace(VE,n))}var UE=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,r,o,s,a,l=null,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.defaultRenderer=new Ku(t,s,a,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof Kp?r.applyToHost(t):r instanceof Yu&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.tracingService;switch(i.encapsulation){case Yi.Emulated:o=new Kp(l,c,i,this.appId,d,s,a,h);break;case Yi.ShadowDom:return new qp(l,t,i,s,a,this.nonce,h,c);case Yi.ExperimentalIsolatedShadowDom:return new qp(l,t,i,s,a,this.nonce,h);default:o=new Yu(l,c,i,d,s,a,h);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(De(FE),De(LE),De(Ir),De(U6),De(Kt),De(mn),De(fl),De(Qo,8))};static \u0275prov=ce({token:n,factory:n.\u0275fac})}return n})(),Ku=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(kE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(NM(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(NM(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new pe(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=kE[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=kE[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Sr.DashCase|Sr.Important)?e.style.setProperty(t,i,r&Sr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Sr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Pi().getGlobalEventTarget(this.doc,e),!e))throw new pe(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function NM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var qp=class extends Ku{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let c=i.styles;c=OM(i.id,c);for(let h of c){let p=document.createElement("style");s&&p.setAttribute("nonce",s),p.textContent=h,this.shadowRoot.appendChild(p)}let d=i.getExternalStyles?.();if(d)for(let h of d){let p=OE(h,r);s&&p.setAttribute("nonce",s),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Yu=class extends Ku{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let c=i.styles;this.styles=l?OM(l,c):c,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&ea.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Kp=class extends Yu{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l){let c=r+"-"+i.id;super(e,t,i,o,s,a,l,c),this.contentAttr=B6(c),this.hostAttr=j6(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var Qp=class n extends Bu{supportsDOMEvents=!0;static makeCurrent(){TE(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=H6();return t==null?null:$6(t)}resetBaseElement(){Qu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return RE(document.cookie,e)}},Qu=null;function H6(){return Qu=Qu||document.head.querySelector("base"),Qu?Qu.getAttribute("href"):null}function $6(n){return new URL(n,document.baseURI).pathname}var G6=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac})}return n})(),FM=["alt","control","meta","shift"],z6={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},W6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},LM=(()=>{class n extends qu{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Pi().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),FM.forEach(c=>{let d=i.indexOf(c);d>-1&&(i.splice(d,1),s+=c+".")}),s+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=z6[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),FM.forEach(s=>{if(s!==r){let a=W6[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(De(Kt))};static \u0275prov=ce({token:n,factory:n.\u0275fac})}return n})();async function BE(n,e,t){let i=F({rootComponent:n},q6(e,t));return lM(i)}function q6(n,e){return{platformRef:e?.platformRef,appProviders:[...Z6,...n?.providers??[]],platformProviders:J6}}function K6(){Qp.makeCurrent()}function Y6(){return new fr}function Q6(){return __(document),document}var J6=[{provide:Ji,useValue:PE},{provide:sp,useValue:K6,multi:!0},{provide:Kt,useFactory:Q6}];var Z6=[{provide:eu,useValue:"root"},{provide:fr,useFactory:Y6},{provide:Yp,useClass:Wp,multi:!0},{provide:Yp,useClass:LM,multi:!0},UE,LE,FE,{provide:ta,useExisting:UE},{provide:zu,useClass:G6},[]];var Ju=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var X6="text/plain",eB="application/json",Wae=`${eB}, ${X6}, */*`;var HE=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(HE||{}),jE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new Ju,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var Jp=class n extends jE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=HE.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var VM=new _e("");var tB=new _e(""),nB="b",iB="h",rB="s",oB="st",sB="u",aB="rt",$E=new _e(""),lB=["GET","HEAD"];function cB(n,e){let g=z($E),{isCacheActive:t}=g,i=$a(g,["isCacheActive"]),{transferCache:r,method:o}=n;if(!t||r===!1||o==="POST"&&!i.includePostRequests&&!r||o!=="POST"&&!lB.includes(o)||!i.includeRequestsWithAuthHeaders&&uB(n)||i.filter?.(n)===!1)return e(n);let s=z(pl);if(z(tB,{optional:!0}))throw new pe(2803,!1);let l=n.url,c=dB(n,l),d=s.get(c,null),h=i.includeHeaders;if(typeof r=="object"&&r.includeHeaders&&(h=r.includeHeaders),d){let{[nB]:x,[aB]:S,[iB]:N,[rB]:U,[oB]:se,[sB]:Se}=d,xe=x;switch(S){case"arraybuffer":xe=new TextEncoder().encode(x).buffer;break;case"blob":xe=new Blob([x]);break}let Ae=new Ju(N);return nt(new Jp({body:xe,headers:Ae,status:U,statusText:se,url:Se}))}return e(n)}function uB(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function UM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function dB(n,e){let{params:t,method:i,responseType:r}=n,o=UM(t),s=n.serializeBody();s instanceof URLSearchParams?s=UM(s):typeof s!="string"&&(s="");let a=[i,r,e,s,o].join("|"),l=hB(a);return l}function hB(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function BM(n){return[{provide:$E,useFactory:()=>(gi("NgHttpTransferCache"),F({isCacheActive:!0},n))},{provide:VM,useValue:cB,multi:!0},{provide:Zo,multi:!0,useFactory:()=>{let e=z(ei),t=z($E);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var jM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(De(Kt))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Zp=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(Zp||{});function fB(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function HM(){return fB(Zp.EventReplay,sM())}function $M(...n){let e=[],t=new Set;for(let{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);let i=t.has(Zp.HttpTransferCacheOptions);return yr([[],[],aM(),t.has(Zp.NoHttpTransferCache)||i?[]:BM({}),e])}var Ge="primary",cd=Symbol("RouteTitle"),KE=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function pa(n){return new KE(n)}function GE(n,e,t){for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function XM(n,e,t){let i=t.path.split("/"),r=i.indexOf("**");if(r===-1){if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let l={},c=n.slice(0,i.length);return GE(i,c,l)?{consumed:c,posParams:l}:null}if(r!==i.lastIndexOf("**"))return null;let o=i.slice(0,r),s=i.slice(r+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!GE(o,n.slice(0,o.length),a)||!GE(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function rg(n){return new Promise((e,t)=>{n.pipe(qr()).subscribe({next:i=>e(i),error:i=>t(i)})})}function gB(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Mr(n[t],e[t]))return!1;return!0}function Mr(n,e){let t=n?YE(n):void 0,i=e?YE(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!eR(n[r],e[r]))return!1;return!0}function YE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function eR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function mB(n){return n.length>0?n[n.length-1]:null}function ya(n){return Jh(n)?n:Jo(n)?an(Promise.resolve(n)):nt(n)}function tR(n){return Jh(n)?rg(n):Promise.resolve(n)}var yB={exact:iR,subset:rR},nR={exact:vB,subset:_B,ignored:()=>!0};function GM(n,e,t){return yB[t.paths](n.root,e.root,t.matrixParams)&&nR[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function vB(n,e){return Mr(n,e)}function iR(n,e,t){if(!ha(n.segments,e.segments)||!tg(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!iR(n.children[i],e.children[i],t))return!1;return!0}function _B(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>eR(n[t],e[t]))}function rR(n,e,t){return oR(n,e,e.segments,t)}function oR(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!ha(r,t)||e.hasChildren()||!tg(r,t,i))}else if(n.segments.length===t.length){if(!ha(n.segments,t)||!tg(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!rR(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!ha(n.segments,r)||!tg(n.segments,r,i)||!n.children[Ge]?!1:oR(n.children[Ge],e,o,i)}}function tg(n,e,t){return e.every((i,r)=>nR[t](n[r].parameters,i.parameters))}var tr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new gt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=pa(this.queryParams),this._queryParamMap}toString(){return wB.serialize(this)}},gt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ng(this)}},is=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=pa(this.parameters),this._parameterMap}toString(){return aR(this)}};function EB(n,e){return ha(n,e)&&n.every((t,i)=>Mr(t.parameters,e[i].parameters))}function ha(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function bB(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ge&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ge&&(t=t.concat(e(r,i)))}),t}var ud=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>new rs,providedIn:"root"})}return n})(),rs=class{parse(e){let t=new JE(e);return new tr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Zu(e.root,!0)}`,i=IB(e.queryParams),r=typeof e.fragment=="string"?`#${xB(e.fragment)}`:"";return`${t}${i}${r}`}},wB=new rs;function ng(n){return n.segments.map(e=>aR(e)).join("/")}function Zu(n,e){if(!n.hasChildren())return ng(n);if(e){let t=n.children[Ge]?Zu(n.children[Ge],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==Ge&&i.push(`${r}:${Zu(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=bB(n,(i,r)=>r===Ge?[Zu(n.children[Ge],!1)]:[`${r}:${Zu(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ge]!=null?`${ng(n)}/${t[0]}`:`${ng(n)}/(${t.join("//")})`}}function sR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Xp(n){return sR(n).replace(/%3B/gi,";")}function xB(n){return encodeURI(n)}function QE(n){return sR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ig(n){return decodeURIComponent(n)}function zM(n){return ig(n.replace(/\+/g,"%20"))}function aR(n){return`${QE(n.path)}${SB(n.parameters)}`}function SB(n){return Object.entries(n).map(([e,t])=>`;${QE(e)}=${QE(t)}`).join("")}function IB(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Xp(t)}=${Xp(r)}`).join("&"):`${Xp(t)}=${Xp(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var TB=/^[^\/()?;#]+/;function zE(n){let e=n.match(TB);return e?e[0]:""}var CB=/^[^\/()?;=#]+/;function DB(n){let e=n.match(CB);return e?e[0]:""}var AB=/^[^=?&#]+/;function MB(n){let e=n.match(AB);return e?e[0]:""}var RB=/^[^&#]+/;function PB(n){let e=n.match(RB);return e?e[0]:""}var JE=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new gt([],{}):new gt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ge]=new gt(e,t)),i}parseSegment(){let e=zE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new pe(4009,!1);return this.capture(e),new is(ig(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=DB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=zE(this.remaining);r&&(i=r,this.capture(i))}e[ig(t)]=ig(i)}parseQueryParam(e){let t=MB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=PB(this.remaining);s&&(i=s,this.capture(i))}let r=zM(t),o=zM(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=zE(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new pe(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Ge);let s=this.parseChildren();t[o??Ge]=Object.keys(s).length===1&&s[Ge]?s[Ge]:new gt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new pe(4011,!1)}};function lR(n){return n.segments.length>0?new gt([],{[Ge]:n}):n}function cR(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=cR(r);if(i===Ge&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new gt(n.segments,e);return NB(t)}function NB(n){if(n.numberOfChildren===1&&n.children[Ge]){let e=n.children[Ge];return new gt(n.segments.concat(e.segments),e.children)}return n}function os(n){return n instanceof tr}function uR(n,e,t=null,i=null,r=new rs){let o=dR(n);return hR(o,e,t,i,r)}function dR(n){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new gt(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=lR(i);return e??r}function hR(n,e,t,i,r){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return WE(o,o,o,t,i,r);let s=kB(e);if(s.toRoot())return WE(o,o,new gt([],{}),t,i,r);let a=OB(s,o,n),l=a.processChildren?ed(a.segmentGroup,a.index,s.commands):pR(a.segmentGroup,a.index,s.commands);return WE(o,a.segmentGroup,l,t,i,r)}function og(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function id(n){return typeof n=="object"&&n!=null&&n.outlets}function WM(n,e,t){n||="\u0275";let i=new tr;return i.queryParams={[n]:e},t.parse(t.serialize(i)).queryParams[n]}function WE(n,e,t,i,r,o){let s={};for(let[c,d]of Object.entries(i??{}))s[c]=Array.isArray(d)?d.map(h=>WM(c,h,o)):WM(c,d,o);let a;n===e?a=t:a=fR(n,e,t);let l=lR(cR(a));return new tr(l,s,r)}function fR(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=fR(o,e,t)}),new gt(n.segments,i)}var sg=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&og(i[0]))throw new pe(4003,!1);let r=i.find(id);if(r&&r!==mB(i))throw new pe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function kB(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new sg(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new sg(t,e,i)}var Cl=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function OB(n,e,t){if(n.isAbsolute)return new Cl(e,!0,0);if(!t)return new Cl(e,!1,NaN);if(t.parent===null)return new Cl(t,!0,0);let i=og(n.commands[0])?0:1,r=t.segments.length-1+i;return FB(t,r,n.numberOfDoubleDots)}function FB(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new pe(4005,!1);r=i.segments.length}return new Cl(i,!1,r-o)}function LB(n){return id(n[0])?n[0].outlets:{[Ge]:n}}function pR(n,e,t){if(n??=new gt([],{}),n.segments.length===0&&n.hasChildren())return ed(n,e,t);let i=VB(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new gt(n.segments.slice(0,i.pathIndex),{});return o.children[Ge]=new gt(n.segments.slice(i.pathIndex),n.children),ed(o,0,r)}else return i.match&&r.length===0?new gt(n.segments,{}):i.match&&!n.hasChildren()?ZE(n,e,t):i.match?ed(n,0,r):ZE(n,e,t)}function ed(n,e,t){if(t.length===0)return new gt(n.segments,{});{let i=LB(t),r={};if(Object.keys(i).some(o=>o!==Ge)&&n.children[Ge]&&n.numberOfChildren===1&&n.children[Ge].segments.length===0){let o=ed(n.children[Ge],e,t);return new gt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=pR(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new gt(n.segments,r)}}function VB(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(id(a))break;let l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!KM(l,c,s))return o;i+=2}else{if(!KM(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function ZE(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(id(o)){let l=UB(o.outlets);return new gt(i,l)}if(r===0&&og(t[0])){let l=n.segments[e];i.push(new is(l.path,qM(t[0]))),r++;continue}let s=id(o)?o.outlets[Ge]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&og(a)?(i.push(new is(s,qM(a))),r+=2):(i.push(new is(s,{})),r++)}return new gt(i,{})}function UB(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=ZE(new gt([],{}),0,i))}),e}function qM(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function KM(n,e,t){return n==t.path&&Mr(e,t.parameters)}var td="imperative",Sn=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Sn||{}),vi=class{id;url;constructor(e,t){this.id=e,this.url=t}},ga=class extends vi{type=Sn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Rr=class extends vi{urlAfterRedirects;type=Sn.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Un=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Un||{}),rd=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(rd||{}),ki=class extends vi{reason;code;type=Sn.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function gR(n){return n instanceof ki&&(n.code===Un.Redirect||n.code===Un.SupersededByNewNavigation)}var co=class extends vi{reason;code;type=Sn.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},ma=class extends vi{error;target;type=Sn.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Al=class extends vi{urlAfterRedirects;state;type=Sn.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ag=class extends vi{urlAfterRedirects;state;type=Sn.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lg=class extends vi{urlAfterRedirects;state;shouldActivate;type=Sn.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},cg=class extends vi{urlAfterRedirects;state;type=Sn.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ug=class extends vi{urlAfterRedirects;state;type=Sn.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},dg=class{route;type=Sn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},hg=class{route;type=Sn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},fg=class{snapshot;type=Sn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pg=class{snapshot;type=Sn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},gg=class{snapshot;type=Sn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mg=class{snapshot;type=Sn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ml=class{},Rl=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function BB(n){return!(n instanceof Ml)&&!(n instanceof Rl)}var yg=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new kl(this.rootInjector)}},kl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new yg(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(De(qt))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vg=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=XE(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=XE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=eb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return eb(e,this._root).map(t=>t.value)}};function XE(n,e){if(n===e.value)return e;for(let t of e.children){let i=XE(n,t);if(i)return i}return null}function eb(n,e){if(n===e.value)return[e];for(let t of e.children){let i=eb(n,t);if(i.length)return i.unshift(e),i}return[]}var yi=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Tl(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var od=class extends vg{snapshot;constructor(e,t){super(e),this.snapshot=t,lb(this,e)}toString(){return this.snapshot.toString()}};function mR(n,e){let t=jB(n,e),i=new Mn([new is("",{})]),r=new Mn({}),o=new Mn({}),s=new Mn({}),a=new Mn(""),l=new uo(i,r,s,a,o,Ge,n,t.root);return l.snapshot=t.root,new od(new yi(l,[]),t)}function jB(n,e){let t={},i={},r={},s=new fa([],t,r,"",i,Ge,n,null,{},e);return new sd("",new yi(s,[]))}var uo=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(yt(c=>c[cd]))??nt(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(yt(e=>pa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(yt(e=>pa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function _g(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),r?.data),n._resolvedData)}:i={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},r&&vR(r)&&(i.resolve[cd]=r.title),i}var fa=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[cd]}constructor(e,t,i,r,o,s,a,l,c,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=pa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=pa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},sd=class extends vg{url;constructor(e,t){super(t),this.url=e,lb(this,t)}toString(){return yR(this._root)}};function lb(n,e){e.value._routerState=n,e.children.forEach(t=>lb(n,t))}function yR(n){let e=n.children.length>0?` { ${n.children.map(yR).join(", ")} } `:"";return`${n.value}${e}`}function qE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Mr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Mr(e.params,t.params)||n.paramsSubject.next(t.params),gB(e.url,t.url)||n.urlSubject.next(t.url),Mr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function tb(n,e){let t=Mr(n.params,e.params)&&EB(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||tb(n.parent,e.parent))}function vR(n){return typeof n.title=="string"||n.title===null}var _R=new _e(""),dd=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ge;activateEvents=new ln;deactivateEvents=new ln;attachEvents=new ln;detachEvents=new ln;routerOutletData=rM();parentContexts=z(kl);location=z(io);changeDetector=z(ca);inputBinder=z(xg,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new pe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new pe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new pe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new pe(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new nb(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=bn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[no]})}return n})(),nb=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===uo?this.route:e===kl?this.childContexts:e===_R?this.outletData:this.parent.get(e,t)}},xg=new _e("");var cb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Ct({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&W(0,"router-outlet")},dependencies:[dd],encapsulation:2})}return n})();function ub(n){let e=n.children&&n.children.map(ub),t=e?ue(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ge&&(t.component=cb),t}function HB(n,e,t){let i=ad(n,e._root,t?t._root:void 0);return new od(i,e)}function ad(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=$B(n,e,t);return new yi(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>ad(n,a)),s}}let i=GB(e.value),r=e.children.map(o=>ad(n,o));return new yi(i,r)}}function $B(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return ad(n,i,r);return ad(n,i)})}function GB(n){return new uo(new Mn(n.url),new Mn(n.params),new Mn(n.queryParams),new Mn(n.fragment),new Mn(n.data),n.outlet,n.component,n)}var Pl=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},ER="ngNavigationCancelingError";function Eg(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=os(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=bR(!1,Un.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function bR(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[ER]=!0,t.cancellationCode=e,t}function zB(n){return wR(n)&&os(n.url)}function wR(n){return!!n&&n[ER]}var ib=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),qE(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=Tl(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Tl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Tl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=Tl(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new mg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new pg(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(qE(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),qE(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},bg=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Dl=class{component;route;constructor(e,t){this.component=e,this.route=t}};function WB(n,e,t){let i=n._root,r=e?e._root:null;return Xu(i,r,t,[i.value])}function qB(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Ol(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!ky(n)?n:e.get(n):i}function Xu(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=Tl(e);return n.children.forEach(s=>{KB(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>nd(a,t.getContext(s),r)),r}function KB(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=YB(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new bg(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Xu(n,e,a?a.children:null,i,r):Xu(n,e,t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Dl(a.outlet.component,s))}else s&&nd(e,a,r),r.canActivateChecks.push(new bg(i)),o.component?Xu(n,null,a?a.children:null,i,r):Xu(n,null,t,i,r);return r}function YB(n,e,t){if(typeof t=="function")return Nn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!ha(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ha(n.url,e.url)||!Mr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!tb(n,e)||!Mr(n.queryParams,e.queryParams);default:return!tb(n,e)}}function nd(n,e,t){let i=Tl(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?nd(s,e.children.getContext(o),t):nd(s,null,t):nd(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Dl(e.outlet.component,r)):t.canDeactivateChecks.push(new Dl(null,r)):t.canDeactivateChecks.push(new Dl(null,r))}function hd(n){return typeof n=="function"}function QB(n){return typeof n=="boolean"}function JB(n){return n&&hd(n.canLoad)}function ZB(n){return n&&hd(n.canActivate)}function XB(n){return n&&hd(n.canActivateChild)}function e8(n){return n&&hd(n.canDeactivate)}function t8(n){return n&&hd(n.canMatch)}function xR(n){return n instanceof Os||n?.name==="EmptyError"}var eg=Symbol("INITIAL_VALUE");function Nl(){return Kr(n=>$c(n.map(e=>e.pipe(Gi(1),Wc(eg)))).pipe(yt(e=>{for(let t of e)if(t!==!0){if(t===eg)return eg;if(t===!1||n8(t))return t}return!0}),$i(e=>e!==eg),Gi(1)))}function n8(n){return os(n)||n instanceof Pl}function SR(n){return n.aborted?nt(void 0).pipe(Gi(1)):new ot(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function IR(n){return Fs(SR(n))}function i8(n){return $n(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?nt(ue(F({},e),{guardsResult:!0})):r8(o,t,i).pipe($n(s=>s&&QB(s)?o8(t,r,n):nt(s)),yt(s=>ue(F({},e),{guardsResult:s})))})}function r8(n,e,t){return an(n).pipe($n(i=>u8(i.component,i.route,t,e)),qr(i=>i!==!0,!0))}function o8(n,e,t){return an(e).pipe(tf(i=>Uo(a8(i.route.parent,t),s8(i.route,t),c8(n,i.path),l8(n,i.route))),qr(i=>i!==!0,!0))}function s8(n,e){return n!==null&&e&&e(new gg(n)),nt(!0)}function a8(n,e){return n!==null&&e&&e(new fg(n)),nt(!0)}function l8(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return nt(!0);let i=t.map(r=>Gc(()=>{let o=e._environmentInjector,s=Ol(r,o),a=ZB(s)?s.canActivate(e,n):Nn(o,()=>s(e,n));return ya(a).pipe(qr())}));return nt(i).pipe(Nl())}function c8(n,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>qB(o)).filter(o=>o!==null).map(o=>Gc(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,c=Ol(a,l),d=XB(c)?c.canActivateChild(t,n):Nn(l,()=>c(t,n));return ya(d).pipe(qr())});return nt(s).pipe(Nl())}));return nt(r).pipe(Nl())}function u8(n,e,t,i){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return nt(!0);let o=r.map(s=>{let a=e._environmentInjector,l=Ol(s,a),c=e8(l)?l.canDeactivate(n,e,t,i):Nn(a,()=>l(n,e,t,i));return ya(c).pipe(qr())});return nt(o).pipe(Nl())}function d8(n,e,t,i,r){let o=e.canLoad;if(o===void 0||o.length===0)return nt(!0);let s=o.map(a=>{let l=Ol(a,n),c=JB(l)?l.canLoad(e,t):Nn(n,()=>l(e,t)),d=ya(c);return r?d.pipe(IR(r)):d});return nt(s).pipe(Nl(),TR(i))}function TR(n){return cy(dr(e=>{if(typeof e!="boolean")throw Eg(n,e)}),yt(e=>e===!0))}function h8(n,e,t,i,r){let o=e.canMatch;if(!o||o.length===0)return nt(!0);let s=o.map(a=>{let l=Ol(a,n),c=t8(l)?l.canMatch(e,t):Nn(n,()=>l(e,t));return ya(c).pipe(IR(r))});return nt(s).pipe(Nl(),TR(i))}var lo=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},ld=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function f8(n){throw new pe(4e3,!1)}function p8(n){throw bR(!1,Un.GuardRejected)}var rb=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return i;if(r.numberOfChildren>1||!r.children[Ge])throw f8(`${e.redirectTo}`);r=r.children[Ge]}}async applyRedirectCommands(e,t,i,r,o){let s=await g8(t,r,o);if(s instanceof tr)throw new ld(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new ld(a);return a}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new tr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new gt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new pe(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function g8(n,e,t){if(typeof n=="string")return Promise.resolve(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:c,data:d,title:h,paramMap:p,queryParamMap:g}=e;return rg(ya(Nn(t,()=>i({params:c,data:d,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:p,queryParamMap:g}))))}function m8(n,e){return n.providers&&!n._injector&&(n._injector=yl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function er(n){return n.outlet||Ge}function y8(n,e){let t=n.filter(i=>er(i)===e);return t.push(...n.filter(i=>er(i)!==e)),t}var ob={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function v8(n,e,t,i,r,o){let s=CR(n,e,t);return s.matched?(i=m8(e,i),h8(i,e,t,r,o).pipe(yt(a=>a===!0?s:F({},ob)))):nt(s)}function CR(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},ob):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||XM)(t,n,e);if(!r)return F({},ob);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?F(F({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function YM(n,e,t,i){return t.length>0&&b8(n,t,i)?{segmentGroup:new gt(e,E8(i,new gt(t,n.children))),slicedSegments:[]}:t.length===0&&w8(n,t,i)?{segmentGroup:new gt(n.segments,_8(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new gt(n.segments,n.children),slicedSegments:t}}function _8(n,e,t,i){let r={};for(let o of t)if(Sg(n,e,o)&&!i[er(o)]){let s=new gt([],{});r[er(o)]=s}return F(F({},i),r)}function E8(n,e){let t={};t[Ge]=e;for(let i of n)if(i.path===""&&er(i)!==Ge){let r=new gt([],{});t[er(i)]=r}return t}function b8(n,e,t){return t.some(i=>Sg(n,e,i)&&er(i)!==Ge)}function w8(n,e,t){return t.some(i=>Sg(n,e,i))}function Sg(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function x8(n,e,t){return e.length===0&&!n.children[t]}var sb=class{};async function S8(n,e,t,i,r,o,s="emptyOnly",a){return new ab(n,e,t,i,r,s,o,a).recognize()}var I8=31,ab=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new rb(this.urlSerializer,this.urlTree)}noMatchError(e){return new pe(4002,`'${e.segmentGroup}'`)}async recognize(){let e=YM(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),r=new yi(i,t),o=new sd("",r),s=uR(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new fa([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ge,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,Ge,t),rootSnapshot:t}}catch(i){if(i instanceof ld)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof lo?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,r,o){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,o);let s=await this.processSegment(e,t,i,i.segments,r,!0,o);return s instanceof yi?[s]:[]}async processChildren(e,t,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let c=i.children[l],d=y8(t,l),h=await this.processSegmentGroup(e,d,c,l,r);s.push(...h)}let a=DR(s);return T8(a),a}async processSegment(e,t,i,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a)}catch(c){if(c instanceof lo||xR(c))continue;throw c}if(x8(i,r,o))return new sb;throw new lo(i)}async processSegmentAgainstRoute(e,t,i,r,o,s,a,l){if(er(i)!==s&&(s===Ge||!Sg(r,o,i)))throw new lo(r);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,i,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l);throw new lo(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:h,remainingSegments:p}=CR(t,r,o);if(!l)throw new lo(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>I8&&(this.allowRedirects=!1));let g=new fa(o,c,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,QM(r),er(r),r.component??r._loadedComponent??null,r,JM(r),e),x=_g(g,a,this.paramsInheritanceStrategy);if(g.params=Object.freeze(x.params),g.data=Object.freeze(x.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let S=await this.applyRedirects.applyRedirectCommands(d,r.redirectTo,h,g,e),N=await this.applyRedirects.lineralizeSegments(r,S);return this.processSegment(e,i,t,N.concat(p),s,!1,a)}async matchSegmentAgainstRoute(e,t,i,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await rg(v8(t,i,r,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!a?.matched)throw new lo(t);e=i._injector??e;let{routes:l}=await this.getChildConfig(e,i,r),c=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:p}=a,g=new fa(h,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,QM(i),er(i),i.component??i._loadedComponent??null,i,JM(i),e),x=_g(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(x.params),g.data=Object.freeze(x.data);let{segmentGroup:S,slicedSegments:N}=YM(t,h,p,l);if(N.length===0&&S.hasChildren()){let Se=await this.processChildren(c,l,S,g);return new yi(g,Se)}if(l.length===0&&N.length===0)return new yi(g,[]);let U=er(i)===o,se=await this.processSegment(c,l,S,N,U?Ge:o,!0,g);return new yi(g,se instanceof yi?[se]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await rg(d8(e,t,i,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw p8(t)}return{routes:[],injector:e}}};function T8(n){n.sort((e,t)=>e.value.outlet===Ge?-1:t.value.outlet===Ge?1:e.value.outlet.localeCompare(t.value.outlet))}function C8(n){let e=n.value.routeConfig;return e&&e.path===""}function DR(n){let e=[],t=new Set;for(let i of n){if(!C8(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=DR(i.children);e.push(new yi(i.value,r))}return e.filter(i=>!t.has(i))}function QM(n){return n.data||{}}function JM(n){return n.resolve||{}}function D8(n,e,t,i,r,o,s){return $n(async a=>{let{state:l,tree:c}=await S8(n,e,t,i,a.extractedUrl,r,o,s);return ue(F({},a),{targetSnapshot:l,urlAfterRedirects:c})})}function A8(n){return $n(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return nt(e);let r=new Set(i.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of AR(a))o.add(l);let s=0;return an(o).pipe(tf(a=>r.has(a)?M8(a,t,n):(a.data=_g(a,a.parent,n).resolve,nt(void 0))),dr(()=>s++),nf(1),$n(a=>s===o.size?nt(e):Rn))})}function AR(n){let e=n.children.map(t=>AR(t)).flat();return[n,...e]}function M8(n,e,t){let i=n.routeConfig,r=n._resolve;return i?.title!==void 0&&!vR(i)&&(r[cd]=i.title),Gc(()=>(n.data=_g(n,n.parent,t).resolve,R8(r,n,e).pipe(yt(o=>(n._resolvedData=o,n.data=F(F({},n.data),o),null)))))}function R8(n,e,t){let i=YE(n);if(i.length===0)return nt({});let r={};return an(i).pipe($n(o=>P8(n[o],e,t).pipe(qr(),dr(s=>{if(s instanceof Pl)throw Eg(new rs,s);r[o]=s}))),nf(1),yt(()=>r),zc(o=>xR(o)?Rn:fy(o)))}function P8(n,e,t){let i=e._environmentInjector,r=Ol(n,i),o=r.resolve?r.resolve(e,t):Nn(i,()=>r(e,t));return ya(o)}function ZM(n){return Kr(e=>{let t=n(e);return t?an(t).pipe(yt(()=>e)):nt(e)})}var db=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===Ge);return i}getResolvedTitleForRoute(t){return t.data[cd]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>z(MR),providedIn:"root"})}return n})(),MR=(()=>{class n extends db{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(De(jM))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Fl=new _e("",{factory:()=>({})}),fd=new _e(""),RR=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=z(uE);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await tR(Nn(t,()=>i.loadComponent())),s=await kR(NR(o));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s,s}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await PR(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=o.routes,i._loadedInjector=o.injector,i._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function PR(n,e,t,i){let r=await tR(Nn(t,()=>n.loadChildren())),o=await kR(NR(r)),s;o instanceof Ip||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),i&&i(n);let a,l,c=!1,d;return Array.isArray(s)?(l=s,c=!0):(a=s.create(t).injector,d=s,l=a.get(fd,[],{optional:!0,self:!0}).flat()),{routes:l.map(ub),injector:a,factory:d}}function N8(n){return n&&typeof n=="object"&&"default"in n}function NR(n){return N8(n)?n.default:n}async function kR(n){return n}var Ig=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>z(k8),providedIn:"root"})}return n})(),k8=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),OR=new _e("");var O8=()=>{},FR=new _e(""),LR=(()=>{class n{currentNavigation=$(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=$(null);events=new Ut;transitionAbortWithErrorSubject=new Ut;configLoader=z(RR);environmentInjector=z(qt);destroyRef=z(Xn);urlSerializer=z(ud);rootContexts=z(kl);location=z(Sl);inputBindingEnabled=z(xg,{optional:!0})!==null;titleStrategy=z(db);options=z(Fl,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=z(Ig);createViewTransition=z(OR,{optional:!0});navigationErrorHandler=z(FR,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>nt(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new dg(r)),i=r=>this.events.next(new hg(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;cn(()=>{this.transitions?.next(ue(F({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new Mn(null),this.transitions.pipe($i(i=>i!==null),Kr(i=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===i.id;return nt(i).pipe(Kr(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),Rn;this.currentTransition=i;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?ue(F({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload")return this.events.next(new co(a.id,this.urlSerializer.serialize(a.rawUrl),"",rd.IgnoredSameUrlNavigation)),a.resolve(!1),Rn;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return nt(a).pipe(Kr(h=>(this.events.next(new ga(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?Rn:Promise.resolve(h))),D8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),dr(h=>{i.targetSnapshot=h.targetSnapshot,i.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=h.urlAfterRedirects,g));let p=new Al(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:p,source:g,restoredState:x,extras:S}=a,N=new ga(h,this.urlSerializer.serialize(p),g,x);this.events.next(N);let U=mR(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=ue(F({},a),{targetSnapshot:U,urlAfterRedirects:p,extras:ue(F({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(se=>(se.finalUrl=p,se)),nt(i)}else return this.events.next(new co(a.id,this.urlSerializer.serialize(a.extractedUrl),"",rd.IgnoredByUrlHandlingStrategy)),a.resolve(!1),Rn}),yt(a=>{let l=new ag(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=i=ue(F({},a),{guards:WB(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i}),i8(a=>this.events.next(a)),Kr(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw Eg(this.urlSerializer,a.guardsResult);let l=new lg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return Rn;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",Un.GuardRejected),Rn;if(a.guards.canActivateChecks.length===0)return nt(a);let c=new cg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(c),!s())return Rn;let d=!1;return nt(a).pipe(A8(this.paramsInheritanceStrategy),dr({next:()=>{d=!0;let h=new ug(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{d||this.cancelNavigationTransition(a,"",Un.NoDataFromResolver)}}))}),ZM(a=>{let l=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let p=d._environmentInjector;h.push(this.configLoader.loadComponent(p,d.routeConfig).then(g=>{d.component=g}))}for(let p of d.children)h.push(...l(p));return h},c=l(a.targetSnapshot.root);return c.length===0?nt(a):an(Promise.all(c).then(()=>a))}),ZM(()=>this.afterPreactivation()),Kr(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,c=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return c?an(c).pipe(yt(()=>i)):nt(i)}),Gi(1),yt(a=>{let l=HB(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=i=a=ue(F({},a),{targetRouterState:l}),this.currentNavigation.update(c=>(c.targetRouterState=l,c)),this.events.next(new Ml),s()&&(new ib(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,c=>this.events.next(c),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(c=>(c.abort=O8,c)),this.lastSuccessfulNavigation.set(cn(this.currentNavigation)),this.events.next(new Rr(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Fs(SR(o.signal).pipe($i(()=>!r&&!i.targetRouterState),dr(()=>{this.cancelNavigationTransition(i,o.signal.reason+"",Un.Aborted)}))),dr({complete:()=>{r=!0}}),Fs(this.transitionAbortWithErrorSubject.pipe(dr(a=>{throw a}))),my(()=>{o.abort(),r||this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),zc(a=>{if(r=!0,this.destroyed)return i.resolve(!1),Rn;if(wR(a))this.events.next(new ki(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),zB(a)?this.events.next(new Rl(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new ma(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let c=Nn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(c instanceof Pl){let{message:d,cancellationCode:h}=Eg(this.urlSerializer,c);this.events.next(new ki(i.id,this.urlSerializer.serialize(i.extractedUrl),d,h)),this.events.next(new Rl(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(c){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(c)}}return Rn}))}))}cancelNavigationTransition(t,i,r){let o=new ki(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=cn(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function F8(n){return n!==td}var VR=new _e("");var UR=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>z(L8),providedIn:"root"})}return n})(),wg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},L8=(()=>{class n extends wg{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hb=(()=>{class n{urlSerializer=z(ud);options=z(Fl,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=z(Sl);urlHandlingStrategy=z(Ig);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new tr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof tr?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=mR(null,z(qt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:()=>z(V8),providedIn:"root"})}return n})(),V8=(()=>{class n extends hb{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof ga?this.updateStateMemento():t instanceof co?this.commitTransition(i):t instanceof Al?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Ml?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof ki&&!gR(t)?this.restoreHistory(i):t instanceof ma?this.restoreHistory(i,!0):t instanceof Rr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=F(F({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=F(F({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function fb(n,e){n.events.pipe($i(t=>t instanceof Rr||t instanceof ki||t instanceof ma||t instanceof co),yt(t=>t instanceof Rr||t instanceof co?0:(t instanceof ki?t.code===Un.Redirect||t.code===Un.SupersededByNewNavigation:!1)?2:1),$i(t=>t!==2),Gi(1)).subscribe(()=>{e()})}var BR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},jR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},_i=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=z(Cp);stateManager=z(hb);options=z(Fl,{optional:!0})||{};pendingTasks=z(wr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=z(LR);urlSerializer=z(ud);location=z(Sl);urlHandlingStrategy=z(Ig);injector=z(qt);_events=new Ut;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=z(UR);injectorCleanup=z(VR,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=z(fd,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!z(xg,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new gn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=cn(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof ki&&i.code!==Un.Redirect&&i.code!==Un.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Rr)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof Rl){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=F({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||F8(r.source)},s);this.scheduleNavigation(a,td,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}BB(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),td,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=F({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(fi)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return cn(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(ub),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let p=r?r.snapshot:this.routerState.snapshot.root;h=dR(p)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return hR(h,t,d,c??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let r=os(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,td,null,i)}navigate(t,i={skipLocationChange:!1}){return U8(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Jr(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=F({},BR):i===!1?r=F({},jR):r=i,os(t))return GM(this.currentUrlTree,t,r);let o=this.parseUrl(t);return GM(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((h,p)=>{a=h,l=p});let d=this.pendingTasks.add();return fb(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function U8(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new pe(4008,!1)}var ss=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=$(null);get href(){return cn(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Ut;applicationErrorHandler=z(fi);options=z(Fl,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(z(new Op("href"),{optional:!0}));let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area"||!!(typeof customElements=="object"&&customElements.get(l)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Rr&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(os(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l)?.catch(c=>{this.applicationErrorHandler(c)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:os(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(ge(_i),ge(uo),wu("tabindex"),ge(sa),ge(Qi),ge(xl))};static \u0275dir=bn({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&ne("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&Ft("href",r.reactiveHref(),R_)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Uu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Uu],replaceUrl:[2,"replaceUrl","replaceUrl",Uu],routerLink:"routerLink"},features:[no]})}return n})();var H8=new _e("");function pb(n,...e){return yr([{provide:fd,multi:!0,useValue:n},[],{provide:uo,useFactory:$8},{provide:Zo,multi:!0,useFactory:G8},e.map(t=>t.\u0275providers)])}function $8(){return z(_i).routerState.root}function G8(){let n=z(Wn);return e=>{let t=n.get(ei);if(e!==t.components[0])return;let i=n.get(_i),r=n.get(z8);n.get(W8)===1&&i.initialNavigation(),n.get(q8,null,{optional:!0})?.setUpPreloading(),n.get(H8,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var z8=new _e("",{factory:()=>new Ut}),W8=new _e("",{factory:()=>1});var q8=new _e("");function HR(n,e){let i=!e?.manualCleanup?e?.injector?.get(Xn)??z(Xn):null,r=K8(e?.equal),o;e?.requireSync?o=$({kind:0},{equal:r}):o=$({kind:1,value:e?.initialValue},{equal:r});let s,a=n.subscribe({next:l=>o.set({kind:1,value:l}),error:l=>{o.set({kind:2,error:l}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&o().kind===0)throw new pe(601,!1);return s=i?.onDestroy(a.unsubscribe.bind(a)),ti(()=>{let l=o();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:throw new pe(601,!1)}},{equal:e?.equal})}function K8(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var gb;try{gb=typeof Intl<"u"&&Intl.v8BreakIterator}catch{gb=!1}var $R=(()=>{class n{_platformId=z(Ji);isBrowser=this._platformId?ns(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||gb)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function mb(n){return Array.isArray(n)?n:[n]}var GR=new Set,va,WR=(()=>{class n{_platform=z($R);_nonce=z(fl,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Q8}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&Y8(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Y8(n,e){if(!GR.has(n))try{va||(va=document.createElement("style"),e&&va.setAttribute("nonce",e),va.setAttribute("type","text/css"),document.head.appendChild(va)),va.sheet&&(va.sheet.insertRule(`@media ${n} {body{ }}`,0),GR.add(n))}catch(t){console.error(t)}}function Q8(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var yb=(()=>{class n{_mediaMatcher=z(WR);_zone=z(mn);_queries=new Map;_destroySubject=new Ut;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return zR(mb(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=zR(mb(t)).map(s=>this._registerQuery(s).observable),o=$c(r);return o=Uo(o.pipe(Gi(1)),o.pipe(yy(1),gy(0))),o.pipe(yt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),o={observable:new ot(s=>{let a=l=>this._zone.run(()=>s.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Wc(i),yt(({matches:s})=>({query:t,matches:s})),Fs(this._destroySubject)),mql:i};return this._queries.set(t,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function zR(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var Ll=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let r={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return r?r[t-1]:1}getDefenseBonus(e,t){let i=0,r=[];(e.turnsStationary??0)>=3&&(i+=1,r.push("Shield +1"));let o=t.filter(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1);return o.length&&(i+=o.length,r.push(`Support +${o.length}`)),{bonus:i,tags:r}}getAttackLuckModifier(e){let t=Math.random(),r={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:r,tag:`CRIT! +${r}`,isCrit:!0}:t>.8?{delta:-r,tag:`MISS! -${r}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}getWallHitAmount(e){return e===1?34:e===2?51:101}applyDamage(e,t){let i=e.armorHp??0,r=Math.max(0,i-t),o=Math.max(0,t-i),s=Math.max(0,e.points-o),{tier:a,level:l}=this.calculateTierAndLevel(s);return ue(F({},e),{armorHp:r,points:s,tier:a,level:l})}calculateHitChance(e,t){let i=t.tier-e.tier,r=e.level??1,o=0;i<=0?o=100:i===1?o=Math.min(100,50+r*15):i===2?o=Math.min(100,25+r*5):o=Math.min(100,1+r*1);let s=e.hasWeapon&&t.tier>e.tier?10:0,a=t.hasArmor?10:0;return Math.max(1,Math.min(100,o+s-a))}isDiagonalBlocked(e,t,i){let r=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(r===0||o===0)return!1;let s=i(e.x,e.y,e.x+r,e.y),a=i(e.x,e.y,e.x,e.y+o),l=i(t.x-r,t.y,t.x,t.y),c=i(t.x,t.y-o,t.x,t.y);return!!(s||a||l||c)}checkWallAlongPath(e,t,i,r){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),l=Math.sign(s),c=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=c;d++){let h={x:e.x+a*(d-1),y:e.y+l*(d-1)},p={x:e.x+a*d,y:e.y+l*d},g=r(h.x,h.y,p.x,p.y);if(g)return g.owner===i?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:h}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var Cg=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,i){let r=[t,i];for(let o of r){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,i,r){return e.some(o=>o.owner===t&&(o.position.x===i.x&&o.position.y===i.y||o.position.x===r.x&&o.position.y===r.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var Dg=class n{entriesSignal=$([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(i=>[...i,{text:e,color:t,type:"other"}])}addCombat(e,t,i){let r=i?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:r,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var X8={TRY_AGAIN:{en:"TRY AGAIN",uk:"\u0421\u041F\u0420\u041E\u0411\u0423\u0419\u0422\u0415 \u0417\u041D\u041E\u0412\u0423"},WAVES:{en:"waves",uk:"\u0445\u0432\u0438\u043B\u044C"},YOU_SURVIVED:{en:"You survived",uk:"\u0422\u0438 \u0432\u0438\u0436\u0438\u0432"},GAME_OVER:{en:"GAME OVER",uk:"\u0413\u0420\u0410 \u0417\u0410\u041A\u0406\u041D\u0427\u0415\u041D\u0410"},TO_PLACE_DEFENDER:{en:"to place a defender",uk:"\u0449\u043E\u0431 \u0440\u043E\u0437\u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},SELECT_BUILD_TILE:{en:"Select a buildable tile",uk:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u0431\u0443\u0434\u0456\u0432\u043D\u0438\u0446\u0442\u0432\u0430,"},SELL:{en:"SELL",uk:"\u041F\u0420\u041E\u0414\u0410\u0422\u0418"},MAX_LEVEL:{en:"MAX LEVEL",uk:"\u041C\u0410\u041A\u0421 \u0420\u0406\u0412\u0415\u041D\u042C"},UPGRADE:{en:"UPGRADE",uk:"\u041E\u041D\u041E\u0412\u041B\u0415\u041D\u041D\u042F"},RANGE:{en:"Range",uk:"\u0414\u0430\u043B\u044C\u043D\u0456\u0441\u0442\u044C"},DAMAGE:{en:"Damage",uk:"\u041F\u043E\u0448\u043A\u043E\u0434\u0436\u0435\u043D\u043D\u044F"},TIER:{en:"Tier",uk:"\u0420\u0430\u043D\u0433"},LEVEL:{en:"Level",uk:"\u0420\u0456\u0432\u0435\u043D\u044C"},DEFENDER_INFO:{en:"Defender Info",uk:"\u0406\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044F \u043F\u0440\u043E \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},BUY_DEFENDER:{en:"Buy Defender",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},START_WAVE:{en:"START WAVE",uk:"\u041F\u041E\u0427\u0410\u0422\u041E\u041A \u0425\u0412\u0418\u041B\u0406"},WAVE_IN_PROGRESS:{en:"WAVE IN PROGRESS",uk:"\u0425\u0412\u0418\u041B\u042F \u0412 \u041F\u0420\u041E\u0426\u0415\u0421\u0406"},RESTART_GAME:{en:"RESTART GAME",uk:"\u041F\u0415\u0420\u0415\u0417\u0410\u041F\u0423\u0421\u041A \u0413\u0420\u0418"},WAVE:{en:"WAVE",uk:"\u0425\u0412\u0418\u041B\u042F"},LIVES:{en:"LIVES",uk:"\u0416\u0418\u0422\u0422\u042F"},MONEY:{en:"MONEY",uk:"\u0413\u0420\u041E\u0428\u0406"},EXIT_GAME:{en:"EXIT GAME",uk:"\u0412\u0418\u0425\u0406\u0414 \u0417 \u0413\u0420\u0418"},TOWER_DEFFENCE_DESCRIPTION:{en:"A new game is already in development. Stay tuned for a completely different strategy experience. Coming soon to Game Center.",uk:"\u041D\u043E\u0432\u0430 \u0433\u0440\u0430 \u0432\u0436\u0435 \u0440\u043E\u0437\u0440\u043E\u0431\u043B\u044F\u0454\u0442\u044C\u0441\u044F. \u0421\u043B\u0456\u0434\u043A\u0443\u0439\u0442\u0435 \u0437\u0430 \u043E\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044F\u043C\u0438, \u0449\u043E\u0431 \u0434\u0456\u0437\u043D\u0430\u0442\u0438\u0441\u044F \u043F\u0440\u043E \u0437\u043E\u0432\u0441\u0456\u043C \u0456\u043D\u0448\u0438\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u0434\u043E\u0441\u0432\u0456\u0434. \u0421\u043A\u043E\u0440\u043E \u0432 \u0456\u0433\u0440\u043E\u0432\u043E\u043C\u0443 \u0446\u0435\u043D\u0442\u0440\u0456."},SHAPE_TACTIC_DESCRIPTION:{en:"Strategic turn-based combat with AI and merging mechanics. Build your base, manage resources, and conquer the battlefield.",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u043F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0438\u0439 \u0431\u0456\u0439 \u0437\u0456 \u0448\u0442\u0443\u0447\u043D\u0438\u043C \u0456\u043D\u0442\u0435\u043B\u0435\u043A\u0442\u043E\u043C \u0442\u0430 \u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0438\u043C\u0438 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0430\u043C\u0438. \u041F\u043E\u0431\u0443\u0434\u0443\u0439\u0442\u0435 \u0441\u0432\u043E\u044E \u0431\u0430\u0437\u0443, \u043A\u0435\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043C\u0438 \u0442\u0430 \u0437\u0430\u0432\u043E\u0439\u043E\u0432\u0443\u0439\u0442\u0435 \u043F\u043E\u043B\u0435 \u0431\u043E\u044E."},IRON_CYCLE:{en:"Iron Cycle",uk:"\u0426\u0438\u043A\u043B \u0417\u0430\u043B\u0456\u0437\u0430"},NEW_DESIGN_UNIT:{en:"New Evolution",uk:"\u041D\u043E\u0432\u0430 \u0435\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},NEW_UNIT_EVOLUTION:{en:"New Unit Evolution",uk:"\u041D\u043E\u0432\u0430 \u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},T4_4_TILES:{en:"T4: 4 tiles",uk:"T4: 4 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},TURN_3:{en:"Turn 3",uk:"\u0425\u0456\u0434 3"},TURN_4:{en:"Turn 4",uk:"\u0425\u0456\u0434 4"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0414\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},PLUS_2_IRON_PER_TURN:{en:"+2 Iron/turn",uk:"+2 \u0417\u0430\u043B\u0456\u0437\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function KR(n,e){let t=X8[n];return t?t[e]??t.en:n}var Mt=class n{difficultySignal=$("normal");mapSizeSignal=$(10);langSignal=$("uk");customModeSignal=$(!1);version="v.2.1.1";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),i=e%2===0;return t==="baby"?i?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return KR(e,this.langSignal())}customMode(){return this.customModeSignal()}setCustomMode(e){this.customModeSignal.set(e),this.persistSettings()}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let i=["baby","normal","hard","nightmare"],r=[10,20,30],o=["en","uk"],s=t.difficulty&&i.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&r.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),l=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(l),this.customModeSignal.set(!!t.customMode)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal(),customMode:this.customModeSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ag=class n{generateForests(e,t,i){let r=e*e,o=Math.max(1,Math.floor(r*.1)),s=[],a=(l,c)=>{let d=Math.max(Math.abs(l-t.x),Math.abs(c-t.y)),h=Math.max(Math.abs(l-i.x),Math.abs(c-i.y));return d<=3||h<=3};for(;s.length<o;){let l=Math.floor(Math.random()*e),c=Math.floor(Math.random()*e);a(l,c)||s.some(d=>d.x===l&&d.y===c)||s.push({x:l,y:c})}return s}generateMines(e,t,i,r){let o=new Set(r.map(c=>`${c.x},${c.y}`)),s=e===10?4:Math.max(1,Math.floor(e*e*.04)),a=[],l=(c,d)=>{let h=Math.max(Math.abs(c-t.x),Math.abs(d-t.y)),p=Math.max(Math.abs(c-i.x),Math.abs(d-i.y));return h<=3||p<=3};for(;a.length<s;){let c=Math.floor(Math.random()*e),d=Math.floor(Math.random()*e);if(l(c,d))continue;let h=`${c},${d}`;o.has(h)||a.some(p=>p.x===c&&p.y===d)||a.push({x:c,y:d})}return a}computeVisibility(e,t,i,r,o){let s={player:new Set,ai:new Set},a=(d,h)=>d>=0&&d<e&&h>=0&&h<e,l=(d,h,p)=>{a(h,p)&&d.add(`${h},${p}`)},c=(d,h,p)=>{for(let g=-p;g<=p;g++)for(let x=-p;x<=p;x++){let S=h.x+g,N=h.y+x;Math.max(Math.abs(g),Math.abs(x))<=p&&l(d,S,N)}};if(o){for(let d=0;d<e;d++)for(let h=0;h<e;h++)s.player.add(`${d},${h}`),s.ai.add(`${d},${h}`);return s}c(s.player,i,3),c(s.ai,r,3);for(let d of t){let h=d.owner==="player"?s.player:s.ai;c(h,d.position,2)}return s}mergeExplored(e,t){let i=new Set(e);return t.forEach(r=>i.add(r)),i}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var Mg=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let i of t)if(e>=i)return i;return 0}computeWoodGain(e,t){let i=e.filter(r=>r.owner===t).filter(r=>r.position&&r.position.x!==void 0&&r.position.y!==void 0).length;return i>0?i*2:0}applyMonopolyTick(e,t,i){let r=t.length;if(r===0)return{next:{player:0,ai:0}};let o=c=>i.filter(d=>d.owner===c&&t.some(h=>h.x===d.position.x&&h.y===d.position.y)).length,s=o("player"),a=o("ai"),l={player:e.player,ai:e.ai};if(s===r){if(l.player=e.player+1,l.ai=0,l.player>=10)return{next:l,winner:"player"}}else if(a===r){if(l.ai=e.ai+1,l.player=0,l.ai>=10)return{next:l,winner:"ai"}}else l.player=0,l.ai=0;return{next:l}}computeAiReserveDump(e,t,i,r){let o=i,s=[];for(let l=-2;l<=2;l++)for(let c=-2;c<=2;c++){if(l===0&&c===0)continue;let d=t.x+l,h=t.y+c;d<0||d>=e||h<0||h>=e||Math.max(Math.abs(l),Math.abs(c))>2||r(d,h)||s.push({x:d,y:h})}let a=[];for(;o>0&&s.length>0;){let l=this.getHighestAffordableCost(o);if(l<=0)break;let c=this.calculateTierAndLevel(l),d=s.shift();a.push({id:crypto.randomUUID(),position:F({},d),level:c.level,tier:c.tier,points:l,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=l}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var Rg=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(E=>E.owner==="ai"&&!E.hasActed);t=t.filter(E=>!(E.tier<=2&&e.isForest(E.position.x,E.position.y)&&e.isAnchoredGatherer(E.id)));let i=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;i&&(t=t.filter(E=>E.id===i));let r=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:r==="rage"?5e4:r==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),l=e.forestsSignal(),d=l.filter(E=>!e.getUnitAt(E.x,E.y)).filter(E=>e.isVisibleToAi(E.x,E.y)),h=l.filter(E=>!e.isVisibleToAi(E.x,E.y)),p=e.unitsSignal().filter(E=>E.owner==="ai"&&e.isForest(E.position.x,E.position.y)).length,g=e.unitsSignal().filter(E=>E.owner==="ai").length,x=[1,2,3].some(E=>e.unitsSignal().filter(le=>le.owner==="ai"&&le.tier===E&&!e.isForest(le.position.x,le.position.y)).length>=5),S=e.unitsSignal().filter(E=>E.owner==="player"),N=S.some(E=>Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y))<=3),U=S.filter(E=>Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y))<=4),se=U.length>0,xe=U.filter(E=>Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y))<=2).length>0,Ae=S.some(E=>Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y))<=5),Ie=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,k=e.unitsSignal().filter(E=>E.owner==="ai"),I=k.filter(E=>E.tier===3&&!e.isForest(E.position.x,E.position.y)).length,P=k.filter(E=>E.tier===4&&!e.isForest(E.position.x,E.position.y)).length,D=I+P>=5,w=D?"full_rush":se?"defense":Ie?"expansion":"none";if(w!==this.lastPhase){try{console.log(w==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":w==="defense"?"AI Phase: Base Defense Activated":w==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=w}D&&t.sort((E,le)=>{let We=Math.abs(E.position.x-a.x)+Math.abs(E.position.y-a.y),qe=Math.abs(le.position.x-a.x)+Math.abs(le.position.y-a.y);return We-qe});let R=typeof e.aggressionMode=="function"?!!e.aggressionMode():S.filter(E=>e.isForest(E.position.x,E.position.y)).length*2>=t.filter(E=>e.isForest(E.position.x,E.position.y)).length*2,M=l.length>0?l.every(E=>{let le=e.getUnitAt(E.x,E.y);return!!le&&le.owner==="ai"}):!0,me=l.length>0?l.every(E=>!!e.getUnitAt(E.x,E.y)):!1,Le=l.filter(E=>{let le=e.getUnitAt(E.x,E.y);return!!le&&le.owner==="player"}),fe=null,Lt=t.filter(E=>Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y))<=3).length,Qt={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Me=U.length>0?U.reduce((E,le)=>{let We=Math.max(Math.abs(le.position.x-s.x),Math.abs(le.position.y-s.y)),qe=Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y));return We<qe?le:E},U[0]):null,Gt=t.length>0?t.reduce((E,le)=>this.combat.calculateTotalPoints(le)>this.combat.calculateTotalPoints(E)?le:E,t[0]):null,lt=[];if(Me){let E=Me.position.x,le=Me.position.y,We=Math.sign(s.x-E),qe=Math.sign(s.y-le),ae=0,bt=Math.max(10,e.gridSize*2);for(;E!==s.x||le!==s.y;){if(ae++,ae>bt){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(E+=We,le+=qe,!e.inBounds(E,le)||E===s.x&&le===s.y)break;lt.push({x:E,y:le})}}se&&Gt&&Me&&(this.goals.set(Gt.id,{x:Me.position.x,y:Me.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(Gt.id,e.turnSignal()+3));let te=new Map(e.aiUnitTimeNearBase()),ie=new Map(e.unitStutterBanSignal?.()??new Map),Ee=new Map;for(let[E,le]of this.goals.entries())if(le&&e.isForest(le.x,le.y)){let We=`${le.x},${le.y}`;Ee.set(We,(Ee.get(We)||0)+1)}for(let E of t){let le=e.calculateValidMoves(E),We=Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y))<=3,qe=te.get(E.id)||0,ae=this.goals.get(E.id)||null,bt=ae!==null,xi=bt?(()=>{let H=e.getUnitAt(ae.x,ae.y);return!!(H&&H.owner==="ai"&&this.combat.calculateTotalPoints(H)>=this.combat.calculateTotalPoints(E))})():!1,oi=(!bt||xi)&&(!e.isForest(E.position.x,E.position.y)||Ae||E.tier>=3),Ss=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(oi){if(Ss)ae={x:a.x,y:a.y};else if(e.isForest(E.position.x,E.position.y)){let H=S.filter(L=>e.isForest(L.position.x,L.position.y));if(R&&H.length>0){let L=H.reduce((Y,Z)=>{let Te=Math.abs(E.position.x-Z.position.x)+Math.abs(E.position.y-Z.position.y),Ve=Math.abs(E.position.x-Y.position.x)+Math.abs(E.position.y-Y.position.y);return Te<Ve?Z:Y},H[0]);ae={x:L.position.x,y:L.position.y}}else{let L=S.length===0?null:[...S].sort((Z,Te)=>{let Ve=Math.abs(E.position.x-Z.position.x)+Math.abs(E.position.y-Z.position.y),Xe=Math.abs(E.position.x-Te.position.x)+Math.abs(E.position.y-Te.position.y);return Ve-Xe})[0];L?ae={x:L.position.x,y:L.position.y}:d.length>0?ae=d.reduce((Y,Z)=>Math.abs(E.position.x-Z.x)+Math.abs(E.position.y-Z.y)<Math.abs(E.position.x-Y.x)+Math.abs(E.position.y-Y.y)?Z:Y,d[0]):h.length>0?ae=h.reduce((Y,Z)=>Math.abs(E.position.x-Z.x)+Math.abs(E.position.y-Z.y)<Math.abs(E.position.x-Y.x)+Math.abs(E.position.y-Y.y)?Z:Y,h[0]):ae={x:0,y:0}}}else{let H=S.filter(L=>e.isForest(L.position.x,L.position.y)).map(L=>({x:L.position.x,y:L.position.y}));if(H.length>0)ae=H.reduce((Y,Z)=>{let Te=Math.abs(E.position.x-Z.x)+Math.abs(E.position.y-Z.y),Ve=Math.abs(E.position.x-Y.x)+Math.abs(E.position.y-Y.y);return Te<Ve?Z:Y},H[0]);else if(d.length>0){let L=Math.min(...d.map(Z=>Ee.get(`${Z.x},${Z.y}`)||0)),Y=d.filter(Z=>(Ee.get(`${Z.x},${Z.y}`)||0)===L);ae=Y.reduce((Z,Te)=>Math.abs(E.position.x-Te.x)+Math.abs(E.position.y-Te.y)<Math.abs(E.position.x-Z.x)+Math.abs(E.position.y-Z.y)?Te:Z,Y[0])}else if(h.length>0){let L=Math.min(...h.map(Z=>Ee.get(`${Z.x},${Z.y}`)||0)),Y=h.filter(Z=>(Ee.get(`${Z.x},${Z.y}`)||0)===L);ae=Y.reduce((Z,Te)=>Math.abs(E.position.x-Te.x)+Math.abs(E.position.y-Te.y)<Math.abs(E.position.x-Z.x)+Math.abs(E.position.y-Z.y)?Te:Z,Y[0])}else{let L=S.length===0?null:[...S].sort((Z,Te)=>{let Ve=Math.abs(E.position.x-Z.position.x)+Math.abs(E.position.y-Z.position.y),Xe=Math.abs(E.position.x-Te.position.x)+Math.abs(E.position.y-Te.position.y);return Ve-Xe})[0];ae=L?{x:L.position.x,y:L.position.y}:{x:0,y:0}}}this.goals.set(E.id,ae)}Lt>3&&qe>=5&&(ae=Qt);let Hn=e.isForest(E.position.x,E.position.y),xc=Hn&&(E.forestOccupationTurns??0)>0&&!(E.productionActive??!1),Sc=e.unitsSignal().some(H=>H.owner==="ai"&&H.id!==E.id&&H.tier<=2&&Math.max(Math.abs(H.position.x-E.position.x),Math.abs(H.position.y-E.position.y))<=2);if(xc&&!Ae&&E.tier<3){this.goals.set(E.id,{x:E.position.x,y:E.position.y});continue}if(E.tier>=3){let H=l,L=H.length?H.reduce((Z,Te)=>{let Ve=Math.abs(E.position.x-Te.x)+Math.abs(E.position.y-Te.y),Xe=Math.abs(E.position.x-Z.x)+Math.abs(E.position.y-Z.y);return Ve<Xe?Te:Z},H[0]):null;if((E.forestOccupationTurns??0)===0&&!Hn&&L&&(ae={x:L.x,y:L.y},this.goals.set(E.id,ae)),Hn&&Sc){this.goals.set(E.id,{x:a.x,y:a.y});let Z=[{x:E.position.x+1,y:E.position.y},{x:E.position.x-1,y:E.position.y},{x:E.position.x,y:E.position.y+1},{x:E.position.x,y:E.position.y-1}].filter(Ve=>e.inBounds(Ve.x,Ve.y));if(Z.filter(Ve=>!!e.getWallBetween(E.position.x,E.position.y,Ve.x,Ve.y)).length===Z.length){let Ve=Z.reduce((Xe,dt)=>{let wt=Math.abs(dt.x-a.x)+Math.abs(dt.y-a.y),mt=Math.abs(Xe.x-a.x)+Math.abs(Xe.y-a.y);return wt<mt?dt:Xe});fe={unit:E,target:{x:E.position.x,y:E.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:F({},E.position),to:Ve}};continue}}}if(le.some(H=>H.x===a.x&&H.y===a.y)){let H=E.tier===3&&E.level>=2||E.tier>=4?3e5:0,L=5e7+o+H;(fe===null||L>fe.score)&&(fe={unit:E,target:{x:a.x,y:a.y},score:L,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let H=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(L=>e.inBounds(L.x,L.y));for(let L of H){let Y=e.getWallBetween(a.x,a.y,L.x,L.y);if(Y&&Y.owner==="neutral"){if(E.position.x===L.x&&E.position.y===L.y||E.position.x===a.x&&E.position.y===a.y){let Te=E.tier===3&&E.level>=2||E.tier>=4?3e5:0,Ve=2e6+o+Te;(fe===null||Ve>fe.score)&&(fe={unit:E,target:F({},E.position),score:Ve,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:L.x,y:L.y}}})}else if(le.some(Ve=>Ve.x===L.x&&Ve.y===L.y||Ve.x===a.x&&Ve.y===a.y)){let Ve=le.find(mt=>mt.x===L.x&&mt.y===L.y||mt.x===a.x&&mt.y===a.y),Xe=E.tier===3&&E.level>=2||E.tier>=4?3e5:0,dt=18e5+o+Xe;(fe===null||dt>fe.score)&&(fe={unit:E,target:{x:Ve.x,y:Ve.y},score:dt,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(ae){let H=e.getUnitAt(ae.x,ae.y);if(H&&H.owner==="player"&&e.isForest(ae.x,ae.y)){let L=ae.x,Y=ae.y;if(le.some(Te=>Te.x===L&&Te.y===Y)){(fe===null||3e5>fe.score)&&(fe={unit:E,target:{x:L,y:Y},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let Te=d.length>0?d:h;if(Te.length>0)ae=Te.reduce((Xe,dt)=>{let wt=Math.abs(E.position.x-dt.x)+Math.abs(E.position.y-dt.y),mt=Math.abs(E.position.x-Xe.x)+Math.abs(E.position.y-Xe.y);return wt<mt?dt:Xe},Te[0]),this.goals.set(E.id,ae);else continue}}}let Pt=null;if(ae&&e.isForest(ae.x,ae.y)&&!e.getUnitAt(ae.x,ae.y)){let L=[{x:ae.x+1,y:ae.y},{x:ae.x-1,y:ae.y},{x:ae.x,y:ae.y+1},{x:ae.x,y:ae.y-1}].filter(Y=>e.inBounds(Y.x,Y.y)).filter(Y=>{let Z=e.getWallBetween(Y.x,Y.y,ae.x,ae.y);return!!(Z&&Z.owner==="neutral")});L.length>0&&(Pt=L.reduce((Y,Z)=>{let Te=Math.abs(E.position.x-Y.x)+Math.abs(E.position.y-Y.y);return Math.abs(E.position.x-Z.x)+Math.abs(E.position.y-Z.y)+3<Te?Z:Y},L[0]))}let $r=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let H of $r){let L={x:E.position.x+H.x,y:E.position.y+H.y};if(!e.inBounds(L.x,L.y)||!e.isForest(L.x,L.y)||e.getUnitAt(L.x,L.y))continue;let Z=e.getWallBetween(E.position.x,E.position.y,L.x,L.y);if(Z&&(Z.owner==="neutral"||Z.owner==="ai")){let Te=(E.tier>=3?7e6:9e5)+o,Ve=Z.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(fe===null||Te>fe.score)&&(fe={unit:E,target:{x:E.position.x,y:E.position.y},score:Te,type:"wall_attack",reason:Ve,edge:{from:F({},E.position),to:L}})}else if(Z&&Z.owner==="player"){let Ve=[{x:L.x+1,y:L.y},{x:L.x-1,y:L.y},{x:L.x,y:L.y+1},{x:L.x,y:L.y-1}].filter(wt=>e.inBounds(wt.x,wt.y)).filter(wt=>e.getUnitAt(wt.x,wt.y)?!1:!e.getWallBetween(wt.x,wt.y,L.x,L.y)),Xe=Math.abs(E.position.x-L.x)+Math.abs(E.position.y-L.y);if((Ve.length>0?Ve.reduce((wt,mt)=>{let yn=Math.abs(E.position.x-mt.x)+Math.abs(E.position.y-mt.y)+1;return Math.min(wt,yn)},1/0):1/0)-Xe>4){let wt=(E.tier>=3?8e6:E.tier===3&&E.level===1?105e4:85e4)+o;(fe===null||wt>fe.score)&&(fe={unit:E,target:{x:E.position.x,y:E.position.y},score:wt,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:F({},E.position),to:L}})}}}for(let H of $r){let L={x:E.position.x+H.x,y:E.position.y+H.y};if(L.x===a.x&&L.y===a.y){let Y=e.getWallBetween(E.position.x,E.position.y,L.x,L.y);if(Y&&(Y.owner==="neutral"||Y.owner==="player")&&E.tier>=3){let Z=8e6+o;(fe===null||Z>fe.score)&&(fe={unit:E,target:{x:E.position.x,y:E.position.y},score:Z,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:F({},E.position),to:L}})}}}if(ae){let H=Math.sign(ae.x-E.position.x),L=Math.sign(ae.y-E.position.y),Y=E.position.x+(H!==0?H:0),Z=E.position.y+(L!==0?L:0);if(e.inBounds(Y,Z)){let Te=e.getUnitAt(Y,Z);if(Te&&Te.owner==="ai")for(let Ve of $r){let Xe={x:E.position.x+Ve.x,y:E.position.y+Ve.y};if(!e.inBounds(Xe.x,Xe.y))continue;let dt=e.getWallBetween(E.position.x,E.position.y,Xe.x,Xe.y);if(dt&&(dt.owner==="player"||dt.owner==="neutral")){let mt=(dt.owner==="player"?65e4:6e5)+o;(fe===null||mt>fe.score)&&(fe={unit:E,target:{x:E.position.x,y:E.position.y},score:mt,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:F({},E.position),to:Xe}})}}}}if(ae){let H=ae.x-E.position.x,L=ae.y-E.position.y;if(H!==0&&L===0||H===0&&L!==0){let Y=Math.sign(H),Z=Math.sign(L),Te={x:E.position.x+Y,y:E.position.y+Z};if(e.inBounds(Te.x,Te.y)&&e.getWallBetween(E.position.x,E.position.y,Te.x,Te.y)){let Xe=(E.tier>=3?8e6:15e5)+o;(fe===null||Xe>fe.score)&&(fe={unit:E,target:{x:E.position.x,y:E.position.y},score:Xe,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:F({},E.position),to:Te}})}}if(Math.abs(H)>=1&&Math.abs(L)>=1){let Y=Math.sign(H),Z=Math.sign(L),Te={x:E.position.x+Y,y:E.position.y+Z};if(e.inBounds(Te.x,Te.y)&&this.combat.isDiagonalBlocked(E.position,Te,(Xe,dt,wt,mt)=>e.getWallBetween(Xe,dt,wt,mt))){let Xe={x:E.position.x+Y,y:E.position.y},dt={x:E.position.x,y:E.position.y+Z},wt=e.getWallBetween(E.position.x,E.position.y,Xe.x,Xe.y),mt=e.getWallBetween(E.position.x,E.position.y,dt.x,dt.y),yn=null;if(wt?yn={from:F({},E.position),to:Xe}:mt&&(yn={from:F({},E.position),to:dt}),yn){let Po=(E.tier>=3?8e6:15e5)+o;(fe===null||Po>fe.score)&&(fe={unit:E,target:{x:E.position.x,y:E.position.y},score:Po,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:yn})}}}}let A0=d.length===0&&h.length===0&&!Pt;if(qe>=2&&(A0||S.length>0))for(let H of $r){let L={x:E.position.x+H.x,y:E.position.y+H.y};if(!e.inBounds(L.x,L.y))continue;let Y=e.getWallBetween(E.position.x,E.position.y,L.x,L.y);if(Y&&(Y.owner==="neutral"||Y.owner==="player")){let Z=E.tier>=3?8e6:12e5;(fe===null||Z>fe.score)&&(fe={unit:E,target:{x:E.position.x,y:E.position.y},score:Z,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:F({},E.position),to:L}})}}let lr=S.filter(H=>Math.max(Math.abs(H.position.x-E.position.x),Math.abs(H.position.y-E.position.y))===1),Ro=lr.length>0?lr.reduce((H,L)=>this.combat.calculateTotalPoints(L)>this.combat.calculateTotalPoints(H)?L:H,lr[0]):null,Is=lt.length>0&&le.some(H=>lt.some(L=>L.x===H.x&&L.y===H.y));for(let H of le){let L=0,Y="Action",Z=e.getUnitAt(H.x,H.y),Te=be=>[{x:be.x+1,y:be.y},{x:be.x-1,y:be.y},{x:be.x,y:be.y+1},{x:be.x,y:be.y-1}].filter(Dt=>e.inBounds(Dt.x,Dt.y)).filter(Dt=>!e.getUnitAt(Dt.x,Dt.y)).length,Ve=Math.max(Math.abs(E.position.x-s.x),Math.abs(E.position.y-s.y)),Xe=Math.max(Math.abs(H.x-s.x),Math.abs(H.y-s.y)),dt=l.length?Math.min(...l.map(be=>Math.abs(E.position.x-be.x)+Math.abs(E.position.y-be.y))):1/0,wt=l.length?Math.min(...l.map(be=>Math.abs(H.x-be.x)+Math.abs(H.y-be.y))):1/0,mt=l.filter(be=>{let He=e.getUnitAt(be.x,be.y);return!!He&&He.owner==="player"}),yn=mt.length?Math.min(...mt.map(be=>Math.abs(E.position.x-be.x)+Math.abs(E.position.y-be.y))):1/0,Po=mt.length?Math.min(...mt.map(be=>Math.abs(H.x-be.x)+Math.abs(H.y-be.y))):1/0,Ic=new Map(e.unitMoveHistorySignal()).get(E.id),si=Array.isArray(Ic)?Ic:[],Gr=si.length>=2?si[si.length-2]:null,zt=si.length>=3?si[si.length-3]:null,dh=Gr&&H.x===Gr.x&&H.y===Gr.y,zr=Hn&&!e.isForest(H.x,H.y);if(D){let be=Math.abs(E.position.x-a.x)+Math.abs(E.position.y-a.y),He=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);He<be?(L+=5e7,Y="FULL RUSH: Charge Base"):He===be?L+=1e5:L-=5e6,Z&&Z.owner==="player"&&Math.abs(Z.position.x-a.x)+Math.abs(Z.position.y-a.y)<be&&(L+=2e7,Y="FULL RUSH: Clear Path to Base"),Hn&&H.x===E.position.x&&H.y===E.position.y&&p>=3&&(L=-5e6,Y="FULL RUSH: Abandon Forest for Assault")}else if(E.tier>=3&&zr){let be=Math.abs(H.x-a.x)+Math.abs(H.y-a.y)<=2,He=S.some(Vt=>Math.abs(H.x-Vt.position.x)+Math.abs(H.y-Vt.position.y)<=2),Dt=e.unitsSignal().some(Vt=>Vt.owner==="ai"&&Vt.id!==E.id&&Math.max(Math.abs(Vt.position.x-E.position.x),Math.abs(Vt.position.y-E.position.y))<=1);!M&&!(be||He)&&!Dt&&(L-=2e6,Y="Penalty: Leaving forest without replacement")}let Wr=ie.get(E.id),M0=Wr&&Wr.until>e.turnSignal()&&Wr.tiles.has(`${H.x},${H.y}`);if(E.tier===1&&(Gr&&H.x===Gr.x&&H.y===Gr.y||zt&&H.x===zt.x&&H.y===zt.y)&&(L-=25e3,Y="Anti-Loop Penalty"),E.tier<=2&&!Z&&zt&&H.x===zt.x&&H.y===zt.y&&(L=-1e6,Y="Anti-Loop: Stay or different path"),M0&&(L-=3e4,Y="Stutter Ban Penalty"),Hn&&lr.length===0&&!Z&&zr&&!se&&(L=-1e3),Hn&&E.tier<=2&&zr&&lr.length>0&&lr.some(He=>this.combat.calculateTotalPoints(He)>this.combat.calculateTotalPoints(E))&&(L=-1e6,Y="Hold Forest"),D)Hn&&H.x===E.position.x&&H.y===E.position.y&&p>=3&&(L=-5e6,Y="FULL RUSH: Abandon Forest for Assault");else if(!Z&&Hn&&H.x===E.position.x&&H.y===E.position.y){let be=lr.some(Dt=>this.combat.calculateTotalPoints(Dt)>this.combat.calculateTotalPoints(E)),He=M&&E.tier>=3;!be&&!He&&(L=Math.max(L,1e7),Y="Hold: Stay on forest")}if(!Z&&!D){if(e.isForest(H.x,H.y)&&!e.getUnitAt(H.x,H.y)&&(Ss?(L=-1e3,Y="Ignore Forest (Total War)"):E.tier>=3?(L=5e6*(Ie&&!se?3:1),Y="Priority: T3 capture empty forest"):(L=1e6*(Ie&&!se?3:1),Y=p<3?`Priority 0: Capture Forest ${H.x},${H.y}`:`Priority 1: Capture Forest ${H.x},${H.y}`,Ie&&!se&&Math.abs(E.position.x-H.x)+Math.abs(E.position.y-H.y)===1&&(L=Math.max(L,12e6),Y=`Early Capture: Forest ${H.x},${H.y}`))),ae){let be=Math.abs(E.position.x-ae.x)+Math.abs(E.position.y-ae.y),He=Math.abs(H.x-ae.x)+Math.abs(H.y-ae.y);if(He<be&&(L+=5e4*(be-He),Y=d.length>0?`Priority 1: Toward Forest ${ae.x},${ae.y}`:h.length>0?`Priority 7: Toward Fog Forest ${ae.x},${ae.y}`:`Toward Goal ${ae.x},${ae.y}`),g>10||x){let Vt=Math.abs(E.position.x-a.x)+Math.abs(E.position.y-a.y),Nt=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);Nt<Vt&&(L+=15e4*(Vt-Nt),Y="Aggress: Toward Player Base"),Po<yn&&(L+=12e4*(yn-Po),Y="Aggress: Toward Player Forest");let vn=Te(H)-Te(E.position);vn>0&&(L+=5e4*vn,Y="Unblock: Clear path")}if((()=>{let Vt=Math.sign(ae.x-E.position.x),Nt=Math.sign(ae.y-E.position.y),vn=E.position.x+(Vt!==0?Vt:0),kt=E.position.y+(Nt!==0?Nt:0);return e.inBounds(vn,kt)?!!e.getWallBetween(E.position.x,E.position.y,vn,kt):!1})()&&H.x===E.position.x&&H.y===E.position.y){let Nt=e.getWallBetween(E.position.x,E.position.y,E.position.x+Math.sign(ae.x-E.position.x),E.position.y+Math.sign(ae.y-E.position.y))?.owner;E.tier>=3?(L=Math.max(L,8e6+o),Y="Breach: Wall blocks high-priority path"):(L+=(Nt==="ai"?7e5:8e5)+o,Y=Nt==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(Pt){let be=Math.abs(E.position.x-Pt.x)+Math.abs(E.position.y-Pt.y),He=Math.abs(H.x-Pt.x)+Math.abs(H.y-Pt.y);He<be&&(L+=2e5*(be-He),Y="Approach Neutral Wall to Forest"),H.x===Pt.x&&H.y===Pt.y&&(L+=5e5,Y="Position for Wall Breach")}if(H.x===a.x&&H.y===a.y&&(L+=1e4,Y="Attack Base (Override)"),Me){let be=lt.some(kt=>kt.x===H.x&&kt.y===H.y),He=Math.abs(E.position.x-Me.position.x)+Math.abs(E.position.y-Me.position.y),Dt=Math.abs(H.x-Me.position.x)+Math.abs(H.y-Me.position.y),Nt=Math.max(Math.abs(Me.position.x-s.x),Math.abs(Me.position.y-s.y))<=2,vn=H.x===E.position.x&&H.y===E.position.y;if(E.tier>=3&&Me.tier>=3&&Dt===1)L=4e7,Y="DEFENSE: T3 Move to Intercept Threat";else if(be){let kt=Nt?25e5:15e5;L<kt&&(L=kt),L+=Nt?2e4:5e3,Y=Nt?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(Dt<He){let kt=E.id===(Gt?.id??"")?1e6:5e3;L+=kt*(He-Dt),E.tier>=3&&(L+=4e3),Y=E.id===(Gt?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}vn&&Is&&(L-=Nt?5e4:1e4,xe?Y="Penalty: Standing Still With Imminent Base Threat":se&&(Y="Penalty: Standing Still With Base Threat"))}if(E.tier>=3){let be=Math.abs(E.position.x-a.x)+Math.abs(E.position.y-a.y),He=Math.abs(H.x-a.x)+Math.abs(H.y-a.y);He<be&&(L+=2e3*(be-He),Y="Hunter: Toward Base",M&&(L=Math.max(L,4e6),Y="Hunt: Approach Base"))}if(We&&wt<dt&&(L*=10),Xe>Ve&&wt<dt&&(L+=500),Ro&&this.combat.calculateTotalPoints(Ro)>this.combat.calculateTotalPoints(E)){let be=Math.abs(E.position.x-Ro.position.x)+Math.abs(E.position.y-Ro.position.y),He=Math.abs(H.x-Ro.position.x)+Math.abs(H.y-Ro.position.y);He>be&&(L+=75e3*(He-be),Y="Retreat")}}else if(Z.owner==="player"){let be=Math.max(Math.abs(Z.position.x-s.x),Math.abs(Z.position.y-s.y)),He=be<=3,Dt=be<=2,Vt=this.combat.calculateTotalPoints(E),Nt=this.combat.calculateTotalPoints(Z),vn=Vt>Nt,kt=Z.tier>=3,Ts=E.tier>=3;E.tier>=3&&e.isForest(Z.position.x,Z.position.y)&&(L=1e7,Y="Aggression: Liberate forest"),!Hn&&me&&mt.length>0&&e.isForest(Z.position.x,Z.position.y)&&(L=12e6,Y="LIBERATE: Attack player forest"),be<=4&&(E.tier>=3||vn)&&(L=15e6,Y="INTERCEPT: Base Siege"),He?Ts&&kt?(L=5e7,Y="CRITICAL DEFENSE: T3 Intercepts Threat"):vn?(L=2e7,Y="CRITICAL DEFENSE: Eliminate Base Threat",Dt&&(L+=5e6)):kt&&E.tier<=2?(L=0,Y="Ignore: T1 Suicide vs T3 useless"):(L=1e3,Y="DEFENSE: Desperation Attack"):vn?(kt?(L=8e6,Y="COMBAT: Kill High Value Target (T3+)"):(L=4e6,Y="COMBAT: Kill Enemy"),E.tier<Z.tier&&(L+=2e6,Y+=" (Efficient Trade)")):E.tier<=2?(L=0,Y="Ignore: No guaranteed kill"):(L=1e5,Y="COMBAT: Chip Damage"),R&&(L+=5e5),N&&(L+=1e6)}else if(Z.tier===E.tier&&Xe>Ve){let be=this.combat.calculateTotalPoints(E)+this.combat.calculateTotalPoints(Z),{tier:He}=this.combat.calculateTierAndLevel(be);He>E.tier&&!We&&!Hn&&(L=1e3,Y="Merge Up")}let Bi="move";Z&&Z.owner==="player"&&(Bi="attack"),Z&&Z.owner==="ai"&&Z.tier===E.tier&&(Bi="merge"),(g>10||x)&&Bi==="merge"&&(L+=5e6,Y="Anti-Stall: Merge first");let R0=this.interceptUntil.get(E.id)||0;if(E.id===(Gt?.id??"")&&R0>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Me){let be=Math.abs(E.position.x-Me.position.x)+Math.abs(E.position.y-Me.position.y),He=Math.abs(H.x-Me.position.x)+Math.abs(H.y-Me.position.y);He<be&&(L+=5e5*(be-He),Y="DEFENSE: Intercept Lock")}dh&&(L=Math.floor(L*.1),L-=3e5,Y="Penalty: Inertia");let P0=(()=>{let be=si.slice(-6),He=new Set(be.map(Dt=>`${Dt.x},${Dt.y}`));return be.length>=6&&He.size<=3})();if(E.tier===1&&P0){let be=d.length>0?d:h;if(be.length>0){let He=be.reduce((Nt,vn)=>{let kt=Math.abs(E.position.x-vn.x)+Math.abs(E.position.y-vn.y),Ts=Math.abs(E.position.x-Nt.x)+Math.abs(E.position.y-Nt.y);return kt<Ts?vn:Nt},be[0]),Dt=Math.abs(E.position.x-He.x)+Math.abs(E.position.y-He.y),Vt=Math.abs(H.x-He.x)+Math.abs(H.y-He.y);Vt<Dt&&(L+=1e5*(Dt-Vt),Y="Breakout: Toward Forest")}}(E.forestOccupationTurns??0)>0&&(H.x!==E.position.x||H.y!==E.position.y)&&(L-=2e3),(fe===null||L>fe.score)&&(fe={unit:E,target:H,score:L,type:Bi,reason:Y})}}if(!fe)return null;let ve=this.goals.get(fe.unit.id),ye=ve?`Goal: Forest at ${ve.x},${ve.y}`:"Goal: None";return{type:fe.type,unit:fe.unit,target:fe.target,reason:fe.reason,edge:fe.edge}}getWallBuildActions(e){let t=[],i=e.unitsSignal().filter(d=>d.owner==="ai"),r=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,h)=>o.some(p=>p.tile1.x===d.x&&p.tile1.y===d.y&&p.tile2.x===h.x&&p.tile2.y===h.y||p.tile1.x===h.x&&p.tile1.y===h.y&&p.tile2.x===d.x&&p.tile2.y===d.y),l=(d,h)=>Math.abs(d.x-h.x)+Math.abs(d.y-h.y),c=(d,h)=>Math.max(Math.abs(d.x-h.x),Math.abs(d.y-h.y));for(let d of i){if(d.tier>=3)continue;let h=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(S=>e.inBounds(S.x,S.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let S of h)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});continue}let p=r.filter(S=>c(d.position,S.position)<=2);if(p.length===0)continue;let g=p.sort((S,N)=>l(d.position,S.position)-l(d.position,N.position))[0],x=h.sort((S,N)=>l(S,g.position)-l(N,g.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let S of x)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});else if(d.tier===2){let S=0;for(let N of x){if(S>=2)break;!a(d.position,N)&&e.canBuildWallBetween(d.position,N)&&(t.push({from:d.position,to:N}),S++)}}}return t}static \u0275fac=function(t){return new(t||n)(De(Ll),De(Mt))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var YR=()=>{};var ZR=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},ij=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=n[t++],s=n[t++],a=n[t++],l=((r&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63)}}return e.join("")},XR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,a=s?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,d=o>>2,h=(o&3)<<4|a>>4,p=(a&15)<<2|c>>6,g=c&63;l||(g=64,s||(p=64)),i.push(t[d],t[h],t[p],t[g])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ZR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ij(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let c=r<n.length?t[n.charAt(r)]:64;++r;let h=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||a==null||c==null||h==null)throw new _b;let p=o<<2|a>>4;if(i.push(p),c!==64){let g=a<<4&240|c>>2;if(i.push(g),h!==64){let x=c<<6&192|h;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},_b=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},rj=function(n){let e=ZR(n);return XR.encodeByteArray(e,!0)},gd=function(n){return rj(n).replace(/\./g,"")},Ng=function(n){try{return XR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function e2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var oj=()=>e2().__FIREBASE_DEFAULTS__,sj=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},aj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Ng(n[1]);return e&&JSON.parse(e)},kg=()=>{try{return YR()||oj()||sj()||aj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bb=n=>kg()?.emulatorHosts?.[n],t2=n=>{let e=bb(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},wb=()=>kg()?.config,xb=n=>kg()?.[`_${n}`];var Pg=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function as(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Og(n){return(await fetch(n,{credentials:"include"})).ok}function n2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=F({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[gd(JSON.stringify(t)),gd(JSON.stringify(s)),""].join(".")}var pd={};function lj(){let n={prod:[],emulator:[]};for(let e of Object.keys(pd))pd[e]?n.emulator.push(e):n.prod.push(e);return n}function cj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var QR=!1;function Fg(n,e){if(typeof window>"u"||typeof document>"u"||!as(window.location.host)||pd[n]===e||pd[n]||QR)return;pd[n]=e;function t(p){return`__firebase__banner__${p}`}let i="__firebase__banner",o=lj().prod.length>0;function s(){let p=document.getElementById(i);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){let p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{QR=!0,s()},p}function d(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function h(){let p=cj(i),g=t("text"),x=document.getElementById(g)||document.createElement("span"),S=t("learnmore"),N=document.getElementById(S)||document.createElement("a"),U=t("preprendIcon"),se=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){let Se=p.element;a(Se),d(N,S);let xe=c();l(se,U),Se.append(se,x,N,xe),document.body.appendChild(Se)}o?(x.innerText="Preview backend disconnected.",se.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(se.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function i2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function uj(){let n=kg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function r2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function o2(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function s2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a2(){let n=In();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function l2(){return!uj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Sb(){try{return typeof indexedDB=="object"}catch{return!1}}function c2(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var dj="FirebaseError",Ei=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=dj,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ho.prototype.create)}},ho=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?hj(o,i):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new Ei(r,a,i)}};function hj(n,e){return n.replace(fj,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var fj=/\{\$([^}]+)}/g;function u2(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function nr(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(JR(o)&&JR(s)){if(!nr(o,s))return!1}else if(o!==s)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function JR(n){return n!==null&&typeof n=="object"}function Vl(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function d2(n,e){let t=new Eb(n,e);return t.subscribe.bind(t)}var Eb=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");pj(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=vb),r.error===void 0&&(r.error=vb),r.complete===void 0&&(r.complete=vb);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function pj(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vb(){}var oue=14400*1e3;function Tn(n){return n&&n._delegate?n._delegate:n}var Fi=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var _a="[DEFAULT]";var Ib=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Pg;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mj(e))try{this.getOrInitializeService({instanceIdentifier:_a})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=_a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_a){return this.instances.has(e)}getOptions(e=_a){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&s.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:gj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=_a){return this.component?this.component.multipleInstances?e:_a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function gj(n){return n===_a?void 0:n}function mj(n){return n.instantiationMode==="EAGER"}var Lg=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ib(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var yj=[],et=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(et||{}),vj={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},_j=et.INFO,Ej={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},bj=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=Ej[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ls=class{constructor(e){this.name=e,this._logLevel=_j,this._logHandler=bj,this._userLogHandler=null,yj.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}};var wj=(n,e)=>e.some(t=>n instanceof t),h2,f2;function xj(){return h2||(h2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Sj(){return f2||(f2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var p2=new WeakMap,Cb=new WeakMap,g2=new WeakMap,Tb=new WeakMap,Ab=new WeakMap;function Ij(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Pr(n.result)),r()},s=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&p2.set(t,n)}).catch(()=>{}),Ab.set(e,n),e}function Tj(n){if(Cb.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Cb.set(n,e)}var Db={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Cb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||g2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Pr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function m2(n){Db=n(Db)}function Cj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(Vg(this),e,...t);return g2.set(i,e.sort?e.sort():[e]),Pr(i)}:Sj().includes(n)?function(...e){return n.apply(Vg(this),e),Pr(p2.get(this))}:function(...e){return Pr(n.apply(Vg(this),e))}}function Dj(n){return typeof n=="function"?Cj(n):(n instanceof IDBTransaction&&Tj(n),wj(n,xj())?new Proxy(n,Db):n)}function Pr(n){if(n instanceof IDBRequest)return Ij(n);if(Tb.has(n))return Tb.get(n);let e=Dj(n);return e!==n&&(Tb.set(n,e),Ab.set(e,n)),e}var Vg=n=>Ab.get(n);function v2(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),a=Pr(s);return i&&s.addEventListener("upgradeneeded",l=>{i(Pr(s.result),l.oldVersion,l.newVersion,Pr(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var Aj=["get","getKey","getAll","getAllKeys","count"],Mj=["put","add","delete","clear"],Mb=new Map;function y2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Mb.get(e))return Mb.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Mj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Aj.includes(t)))return;let o=async function(s,...a){let l=this.transaction(s,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return Mb.set(e,o),o}m2(n=>ue(F({},n),{get:(e,t,i)=>y2(e,t)||n.get(e,t,i),has:(e,t)=>!!y2(e,t)||n.has(e,t)}));var Pb=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Rj(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function Rj(n){return n.getComponent()?.type==="VERSION"}var Nb="@firebase/app",_2="0.14.7";var fo=new ls("@firebase/app"),Pj="@firebase/app-compat",Nj="@firebase/analytics-compat",kj="@firebase/analytics",Oj="@firebase/app-check-compat",Fj="@firebase/app-check",Lj="@firebase/auth",Vj="@firebase/auth-compat",Uj="@firebase/database",Bj="@firebase/data-connect",jj="@firebase/database-compat",Hj="@firebase/functions",$j="@firebase/functions-compat",Gj="@firebase/installations",zj="@firebase/installations-compat",Wj="@firebase/messaging",qj="@firebase/messaging-compat",Kj="@firebase/performance",Yj="@firebase/performance-compat",Qj="@firebase/remote-config",Jj="@firebase/remote-config-compat",Zj="@firebase/storage",Xj="@firebase/storage-compat",e9="@firebase/firestore",t9="@firebase/ai",n9="@firebase/firestore-compat",i9="firebase",r9="12.8.0";var kb="[DEFAULT]",o9={[Nb]:"fire-core",[Pj]:"fire-core-compat",[kj]:"fire-analytics",[Nj]:"fire-analytics-compat",[Fj]:"fire-app-check",[Oj]:"fire-app-check-compat",[Lj]:"fire-auth",[Vj]:"fire-auth-compat",[Uj]:"fire-rtdb",[Bj]:"fire-data-connect",[jj]:"fire-rtdb-compat",[Hj]:"fire-fn",[$j]:"fire-fn-compat",[Gj]:"fire-iid",[zj]:"fire-iid-compat",[Wj]:"fire-fcm",[qj]:"fire-fcm-compat",[Kj]:"fire-perf",[Yj]:"fire-perf-compat",[Qj]:"fire-rc",[Jj]:"fire-rc-compat",[Zj]:"fire-gcs",[Xj]:"fire-gcs-compat",[e9]:"fire-fst",[n9]:"fire-fst-compat",[t9]:"fire-vertex","fire-js":"fire-js",[i9]:"fire-js-all"};var Ug=new Map,s9=new Map,Ob=new Map;function E2(n,e){try{n.container.addComponent(e)}catch(t){fo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function us(n){let e=n.name;if(Ob.has(e))return fo.debug(`There were multiple attempts to register component ${e}.`),!1;Ob.set(e,n);for(let t of Ug.values())E2(t,n);for(let t of s9.values())E2(t,n);return!0}function yd(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function bi(n){return n==null?!1:n.settings!==void 0}var a9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cs=new ho("app","Firebase",a9);var Fb=class{constructor(e,t,i){this._isDeleted=!1,this._options=F({},e),this._config=F({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cs.create("app-deleted",{appName:this._name})}};var ds=r9;function vd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=F({name:kb,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw cs.create("bad-app-name",{appName:String(r)});if(t||(t=wb()),!t)throw cs.create("no-options");let o=Ug.get(r);if(o){if(nr(t,o.options)&&nr(i,o.config))return o;throw cs.create("duplicate-app",{appName:r})}let s=new Lg(r);for(let l of Ob.values())s.addComponent(l);let a=new Fb(t,i,s);return Ug.set(r,a),a}function Bg(n=kb){let e=Ug.get(n);if(!e&&n===kb&&wb())return vd();if(!e)throw cs.create("no-app",{appName:n});return e}function ir(n,e,t){let i=o9[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let s=[`Unable to register library "${i}" with version "${e}":`];r&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fo.warn(s.join(" "));return}us(new Fi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var l9="firebase-heartbeat-database",c9=1,md="firebase-heartbeat-store",Rb=null;function S2(){return Rb||(Rb=v2(l9,c9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(md)}catch(t){console.warn(t)}}}}).catch(n=>{throw cs.create("idb-open",{originalErrorMessage:n.message})})),Rb}async function u9(n){try{let t=(await S2()).transaction(md),i=await t.objectStore(md).get(I2(n));return await t.done,i}catch(e){if(e instanceof Ei)fo.warn(e.message);else{let t=cs.create("idb-get",{originalErrorMessage:e?.message});fo.warn(t.message)}}}async function b2(n,e){try{let i=(await S2()).transaction(md,"readwrite");await i.objectStore(md).put(e,I2(n)),await i.done}catch(t){if(t instanceof Ei)fo.warn(t.message);else{let i=cs.create("idb-set",{originalErrorMessage:t?.message});fo.warn(i.message)}}}function I2(n){return`${n.name}!${n.options.appId}`}var d9=1024,h9=30,Lb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Vb(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=w2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>h9){let r=p9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=w2(),{heartbeatsToSend:t,unsentEntries:i}=f9(this._heartbeatsCache.heartbeats),r=gd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return fo.warn(e),""}}};function w2(){return new Date().toISOString().substring(0,10)}function f9(n,e=d9){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),x2(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),x2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Vb=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Sb()?c2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await u9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return b2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return b2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function x2(n){return gd(JSON.stringify({version:2,heartbeats:n})).length}function p9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function g9(n){us(new Fi("platform-logger",e=>new Pb(e),"PRIVATE")),us(new Fi("heartbeat",e=>new Lb(e),"PRIVATE")),ir(Nb,_2,n),ir(Nb,_2,"esm2020"),ir("fire-js","")}g9("");var m9="firebase",y9="12.8.0";ir(m9,y9,"app");var T2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},C2={};var po,Ub;(function(){var n;function e(k,I){function P(){}P.prototype=I.prototype,k.F=I.prototype,k.prototype=new P,k.prototype.constructor=k,k.D=function(D,w,R){for(var M=Array(arguments.length-2),me=2;me<arguments.length;me++)M[me-2]=arguments[me];return I.prototype[w].apply(D,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,I,P){P||(P=0);let D=Array(16);if(typeof I=="string")for(var w=0;w<16;++w)D[w]=I.charCodeAt(P++)|I.charCodeAt(P++)<<8|I.charCodeAt(P++)<<16|I.charCodeAt(P++)<<24;else for(w=0;w<16;++w)D[w]=I[P++]|I[P++]<<8|I[P++]<<16|I[P++]<<24;I=k.g[0],P=k.g[1],w=k.g[2];let R=k.g[3],M;M=I+(R^P&(w^R))+D[0]+3614090360&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[1]+3905402710&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[2]+606105819&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[3]+3250441966&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(R^P&(w^R))+D[4]+4118548399&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[5]+1200080426&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[6]+2821735955&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[7]+4249261313&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(R^P&(w^R))+D[8]+1770035416&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[9]+2336552879&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[10]+4294925233&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[11]+2304563134&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(R^P&(w^R))+D[12]+1804603682&4294967295,I=P+(M<<7&4294967295|M>>>25),M=R+(w^I&(P^w))+D[13]+4254626195&4294967295,R=I+(M<<12&4294967295|M>>>20),M=w+(P^R&(I^P))+D[14]+2792965006&4294967295,w=R+(M<<17&4294967295|M>>>15),M=P+(I^w&(R^I))+D[15]+1236535329&4294967295,P=w+(M<<22&4294967295|M>>>10),M=I+(w^R&(P^w))+D[1]+4129170786&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[6]+3225465664&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[11]+643717713&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[0]+3921069994&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(w^R&(P^w))+D[5]+3593408605&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[10]+38016083&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[15]+3634488961&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[4]+3889429448&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(w^R&(P^w))+D[9]+568446438&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[14]+3275163606&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[3]+4107603335&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[8]+1163531501&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(w^R&(P^w))+D[13]+2850285829&4294967295,I=P+(M<<5&4294967295|M>>>27),M=R+(P^w&(I^P))+D[2]+4243563512&4294967295,R=I+(M<<9&4294967295|M>>>23),M=w+(I^P&(R^I))+D[7]+1735328473&4294967295,w=R+(M<<14&4294967295|M>>>18),M=P+(R^I&(w^R))+D[12]+2368359562&4294967295,P=w+(M<<20&4294967295|M>>>12),M=I+(P^w^R)+D[5]+4294588738&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[8]+2272392833&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[11]+1839030562&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[14]+4259657740&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(P^w^R)+D[1]+2763975236&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[4]+1272893353&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[7]+4139469664&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[10]+3200236656&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(P^w^R)+D[13]+681279174&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[0]+3936430074&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[3]+3572445317&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[6]+76029189&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(P^w^R)+D[9]+3654602809&4294967295,I=P+(M<<4&4294967295|M>>>28),M=R+(I^P^w)+D[12]+3873151461&4294967295,R=I+(M<<11&4294967295|M>>>21),M=w+(R^I^P)+D[15]+530742520&4294967295,w=R+(M<<16&4294967295|M>>>16),M=P+(w^R^I)+D[2]+3299628645&4294967295,P=w+(M<<23&4294967295|M>>>9),M=I+(w^(P|~R))+D[0]+4096336452&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[7]+1126891415&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[14]+2878612391&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[5]+4237533241&4294967295,P=w+(M<<21&4294967295|M>>>11),M=I+(w^(P|~R))+D[12]+1700485571&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[3]+2399980690&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[10]+4293915773&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[1]+2240044497&4294967295,P=w+(M<<21&4294967295|M>>>11),M=I+(w^(P|~R))+D[8]+1873313359&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[15]+4264355552&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[6]+2734768916&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[13]+1309151649&4294967295,P=w+(M<<21&4294967295|M>>>11),M=I+(w^(P|~R))+D[4]+4149444226&4294967295,I=P+(M<<6&4294967295|M>>>26),M=R+(P^(I|~w))+D[11]+3174756917&4294967295,R=I+(M<<10&4294967295|M>>>22),M=w+(I^(R|~P))+D[2]+718787259&4294967295,w=R+(M<<15&4294967295|M>>>17),M=P+(R^(w|~I))+D[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(w+(M<<21&4294967295|M>>>11))&4294967295,k.g[2]=k.g[2]+w&4294967295,k.g[3]=k.g[3]+R&4294967295}i.prototype.v=function(k,I){I===void 0&&(I=k.length);let P=I-this.blockSize,D=this.C,w=this.h,R=0;for(;R<I;){if(w==0)for(;R<=P;)r(this,k,R),R+=this.blockSize;if(typeof k=="string"){for(;R<I;)if(D[w++]=k.charCodeAt(R++),w==this.blockSize){r(this,D),w=0;break}}else for(;R<I;)if(D[w++]=k[R++],w==this.blockSize){r(this,D),w=0;break}}this.h=w,this.o+=I},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;I=this.o*8;for(var P=k.length-8;P<k.length;++P)k[P]=I&255,I/=256;for(this.v(k),k=Array(16),I=0,P=0;P<4;++P)for(let D=0;D<32;D+=8)k[I++]=this.g[P]>>>D&255;return k};function o(k,I){var P=a;return Object.prototype.hasOwnProperty.call(P,k)?P[k]:P[k]=I(k)}function s(k,I){this.h=I;let P=[],D=!0;for(let w=k.length-1;w>=0;w--){let R=k[w]|0;D&&R==I||(P[w]=R,D=!1)}this.g=P}var a={};function l(k){return-128<=k&&k<128?o(k,function(I){return new s([I|0],I<0?-1:0)}):new s([k|0],k<0?-1:0)}function c(k){if(isNaN(k)||!isFinite(k))return h;if(k<0)return N(c(-k));let I=[],P=1;for(let D=0;k>=P;D++)I[D]=k/P|0,P*=4294967296;return new s(I,0)}function d(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return N(d(k.substring(1),I));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');let P=c(Math.pow(I,8)),D=h;for(let R=0;R<k.length;R+=8){var w=Math.min(8,k.length-R);let M=parseInt(k.substring(R,R+w),I);w<8?(w=c(Math.pow(I,w)),D=D.j(w).add(c(M))):(D=D.j(P),D=D.add(c(M)))}return D}var h=l(0),p=l(1),g=l(16777216);n=s.prototype,n.m=function(){if(S(this))return-N(this).m();let k=0,I=1;for(let P=0;P<this.g.length;P++){let D=this.i(P);k+=(D>=0?D:4294967296+D)*I,I*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(x(this))return"0";if(S(this))return"-"+N(this).toString(k);let I=c(Math.pow(k,6));var P=this;let D="";for(;;){let w=xe(P,I).g;P=U(P,w.j(I));let R=((P.g.length>0?P.g[0]:P.h)>>>0).toString(k);if(P=w,x(P))return R+D;for(;R.length<6;)R="0"+R;D=R+D}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function x(k){if(k.h!=0)return!1;for(let I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function S(k){return k.h==-1}n.l=function(k){return k=U(this,k),S(k)?-1:x(k)?0:1};function N(k){let I=k.g.length,P=[];for(let D=0;D<I;D++)P[D]=~k.g[D];return new s(P,~k.h).add(p)}n.abs=function(){return S(this)?N(this):this},n.add=function(k){let I=Math.max(this.g.length,k.g.length),P=[],D=0;for(let w=0;w<=I;w++){let R=D+(this.i(w)&65535)+(k.i(w)&65535),M=(R>>>16)+(this.i(w)>>>16)+(k.i(w)>>>16);D=M>>>16,R&=65535,M&=65535,P[w]=M<<16|R}return new s(P,P[P.length-1]&-2147483648?-1:0)};function U(k,I){return k.add(N(I))}n.j=function(k){if(x(this)||x(k))return h;if(S(this))return S(k)?N(this).j(N(k)):N(N(this).j(k));if(S(k))return N(this.j(N(k)));if(this.l(g)<0&&k.l(g)<0)return c(this.m()*k.m());let I=this.g.length+k.g.length,P=[];for(var D=0;D<2*I;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(let w=0;w<k.g.length;w++){let R=this.i(D)>>>16,M=this.i(D)&65535,me=k.i(w)>>>16,Le=k.i(w)&65535;P[2*D+2*w]+=M*Le,se(P,2*D+2*w),P[2*D+2*w+1]+=R*Le,se(P,2*D+2*w+1),P[2*D+2*w+1]+=M*me,se(P,2*D+2*w+1),P[2*D+2*w+2]+=R*me,se(P,2*D+2*w+2)}for(k=0;k<I;k++)P[k]=P[2*k+1]<<16|P[2*k];for(k=I;k<2*I;k++)P[k]=0;return new s(P,0)};function se(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function Se(k,I){this.g=k,this.h=I}function xe(k,I){if(x(I))throw Error("division by zero");if(x(k))return new Se(h,h);if(S(k))return I=xe(N(k),I),new Se(N(I.g),N(I.h));if(S(I))return I=xe(k,N(I)),new Se(N(I.g),I.h);if(k.g.length>30){if(S(k)||S(I))throw Error("slowDivide_ only works with positive integers.");for(var P=p,D=I;D.l(k)<=0;)P=Ae(P),D=Ae(D);var w=Ie(P,1),R=Ie(D,1);for(D=Ie(D,2),P=Ie(P,2);!x(D);){var M=R.add(D);M.l(k)<=0&&(w=w.add(P),R=M),D=Ie(D,1),P=Ie(P,1)}return I=U(k,w.j(I)),new Se(w,I)}for(w=h;k.l(I)>=0;){for(P=Math.max(1,Math.floor(k.m()/I.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),R=c(P),M=R.j(I);S(M)||M.l(k)>0;)P-=D,R=c(P),M=R.j(I);x(R)&&(R=p),w=w.add(R),k=U(k,M)}return new Se(w,k)}n.B=function(k){return xe(this,k).h},n.and=function(k){let I=Math.max(this.g.length,k.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)&k.i(D);return new s(P,this.h&k.h)},n.or=function(k){let I=Math.max(this.g.length,k.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)|k.i(D);return new s(P,this.h|k.h)},n.xor=function(k){let I=Math.max(this.g.length,k.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)^k.i(D);return new s(P,this.h^k.h)};function Ae(k){let I=k.g.length+1,P=[];for(let D=0;D<I;D++)P[D]=k.i(D)<<1|k.i(D-1)>>>31;return new s(P,k.h)}function Ie(k,I){let P=I>>5;I%=32;let D=k.g.length-P,w=[];for(let R=0;R<D;R++)w[R]=I>0?k.i(R+P)>>>I|k.i(R+P+1)<<32-I:k.i(R+P);return new s(w,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Ub=C2.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=d,po=C2.Integer=s}).apply(typeof T2<"u"?T2:typeof self<"u"?self:typeof window<"u"?window:{});var jg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},go={};var Bb,v9,Ul,jb,_d,Hg,Hb,$b,Gb;(function(){var n,e=Object.defineProperty;function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof jg=="object"&&jg];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var i=t(this);function r(u,f){if(f)e:{var m=i;u=u.split(".");for(var T=0;T<u.length-1;T++){var V=u[T];if(!(V in m))break e;m=m[V]}u=u[u.length-1],T=m[u],f=f(T),f!=T&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(u){return u||function(f){var m=[],T;for(T in f)Object.prototype.hasOwnProperty.call(f,T)&&m.push([T,f[T]]);return m}});var o=o||{},s=this||self;function a(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function l(u,f,m){return u.call.apply(u.bind,arguments)}function c(u,f,m){return c=l,c.apply(null,arguments)}function d(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),u.apply(this,T)}}function h(u,f){function m(){}m.prototype=f.prototype,u.Z=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Ob=function(T,V,B){for(var he=Array(arguments.length-2),Ze=2;Ze<arguments.length;Ze++)he[Ze-2]=arguments[Ze];return f.prototype[V].apply(T,he)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function g(u){let f=u.length;if(f>0){let m=Array(f);for(let T=0;T<f;T++)m[T]=u[T];return m}return[]}function x(u,f){for(let T=1;T<arguments.length;T++){let V=arguments[T];var m=typeof V;if(m=m!="object"?m:V?Array.isArray(V)?"array":m:"null",m=="array"||m=="object"&&typeof V.length=="number"){m=u.length||0;let B=V.length||0;u.length=m+B;for(let he=0;he<B;he++)u[m+he]=V[he]}else u.push(V)}}class S{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function N(u){s.setTimeout(()=>{throw u},0)}function U(){var u=k;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class se{constructor(){this.h=this.g=null}add(f,m){let T=Se.get();T.set(f,m),this.h?this.h.next=T:this.g=T,this.h=T}}var Se=new S(()=>new xe,u=>u.reset());class xe{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,Ie=!1,k=new se,I=()=>{let u=Promise.resolve(void 0);Ae=()=>{u.then(P)}};function P(){for(var u;u=U();){try{u.h.call(u.g)}catch(m){N(m)}var f=Se;f.j(u),f.h<100&&(f.h++,u.next=f.g,f.g=u)}Ie=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};s.addEventListener("test",m,f),s.removeEventListener("test",m,f)}catch{}return u})();function M(u){return/^[\s\xa0]*$/.test(u)}function me(u,f){w.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,f)}h(me,w),me.prototype.init=function(u,f){let m=this.type=u.type,T=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget,f||(m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement)),this.relatedTarget=f,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&me.Z.h.call(this)},me.prototype.h=function(){me.Z.h.call(this);let u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Le="closure_listenable_"+(Math.random()*1e6|0),fe=0;function Lt(u,f,m,T,V){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!T,this.ha=V,this.key=++fe,this.da=this.fa=!1}function Qt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Me(u,f,m){for(let T in u)f.call(m,u[T],T,u)}function Gt(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function lt(u){let f={};for(let m in u)f[m]=u[m];return f}let te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(u,f){let m,T;for(let V=1;V<arguments.length;V++){T=arguments[V];for(m in T)u[m]=T[m];for(let B=0;B<te.length;B++)m=te[B],Object.prototype.hasOwnProperty.call(T,m)&&(u[m]=T[m])}}function Ee(u){this.src=u,this.g={},this.h=0}Ee.prototype.add=function(u,f,m,T,V){let B=u.toString();u=this.g[B],u||(u=this.g[B]=[],this.h++);let he=ye(u,f,T,V);return he>-1?(f=u[he],m||(f.fa=!1)):(f=new Lt(f,this.src,B,!!T,V),f.fa=m,u.push(f)),f};function ve(u,f){let m=f.type;if(m in u.g){var T=u.g[m],V=Array.prototype.indexOf.call(T,f,void 0),B;(B=V>=0)&&Array.prototype.splice.call(T,V,1),B&&(Qt(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function ye(u,f,m,T){for(let V=0;V<u.length;++V){let B=u[V];if(!B.da&&B.listener==f&&B.capture==!!m&&B.ha==T)return V}return-1}var E="closure_lm_"+(Math.random()*1e6|0),le={};function We(u,f,m,T,V){if(T&&T.once)return bt(u,f,m,T,V);if(Array.isArray(f)){for(let B=0;B<f.length;B++)We(u,f[B],m,T,V);return null}return m=Sc(m),u&&u[Le]?u.J(f,m,a(T)?!!T.capture:!!T,V):qe(u,f,m,!1,T,V)}function qe(u,f,m,T,V,B){if(!f)throw Error("Invalid event type");let he=a(V)?!!V.capture:!!V,Ze=Hn(u);if(Ze||(u[E]=Ze=new Ee(u)),m=Ze.add(f,m,T,he,B),m.proxy)return m;if(T=ae(),m.proxy=T,T.src=u,T.listener=m,u.addEventListener)R||(V=he),V===void 0&&(V=!1),u.addEventListener(f.toString(),T,V);else if(u.attachEvent)u.attachEvent(Ss(f.toString()),T);else if(u.addListener&&u.removeListener)u.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function ae(){function u(m){return f.call(u.src,u.listener,m)}let f=uh;return u}function bt(u,f,m,T,V){if(Array.isArray(f)){for(let B=0;B<f.length;B++)bt(u,f[B],m,T,V);return null}return m=Sc(m),u&&u[Le]?u.K(f,m,a(T)?!!T.capture:!!T,V):qe(u,f,m,!0,T,V)}function xi(u,f,m,T,V){if(Array.isArray(f))for(var B=0;B<f.length;B++)xi(u,f[B],m,T,V);else T=a(T)?!!T.capture:!!T,m=Sc(m),u&&u[Le]?(u=u.i,B=String(f).toString(),B in u.g&&(f=u.g[B],m=ye(f,m,T,V),m>-1&&(Qt(f[m]),Array.prototype.splice.call(f,m,1),f.length==0&&(delete u.g[B],u.h--)))):u&&(u=Hn(u))&&(f=u.g[f.toString()],u=-1,f&&(u=ye(f,m,T,V)),(m=u>-1?f[u]:null)&&oi(m))}function oi(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[Le])ve(f.i,u);else{var m=u.type,T=u.proxy;f.removeEventListener?f.removeEventListener(m,T,u.capture):f.detachEvent?f.detachEvent(Ss(m),T):f.addListener&&f.removeListener&&f.removeListener(T),(m=Hn(f))?(ve(m,u),m.h==0&&(m.src=null,f[E]=null)):Qt(u)}}}function Ss(u){return u in le?le[u]:le[u]="on"+u}function uh(u,f){if(u.da)u=!0;else{f=new me(f,this);let m=u.listener,T=u.ha||u.src;u.fa&&oi(u),u=m.call(T,f)}return u}function Hn(u){return u=u[E],u instanceof Ee?u:null}var xc="__closure_events_fn_"+(Math.random()*1e9>>>0);function Sc(u){return typeof u=="function"?u:(u[xc]||(u[xc]=function(f){return u.handleEvent(f)}),u[xc])}function An(){D.call(this),this.i=new Ee(this),this.M=this,this.G=null}h(An,D),An.prototype[Le]=!0,An.prototype.removeEventListener=function(u,f,m,T){xi(this,u,f,m,T)};function Pt(u,f){var m,T=u.G;if(T)for(m=[];T;T=T.G)m.push(T);if(u=u.M,T=f.type||f,typeof f=="string")f=new w(f,u);else if(f instanceof w)f.target=f.target||u;else{var V=f;f=new w(T,u),ie(f,V)}V=!0;let B,he;if(m)for(he=m.length-1;he>=0;he--)B=f.g=m[he],V=$r(B,T,!0,f)&&V;if(B=f.g=u,V=$r(B,T,!0,f)&&V,V=$r(B,T,!1,f)&&V,m)for(he=0;he<m.length;he++)B=f.g=m[he],V=$r(B,T,!1,f)&&V}An.prototype.N=function(){if(An.Z.N.call(this),this.i){var u=this.i;for(let f in u.g){let m=u.g[f];for(let T=0;T<m.length;T++)Qt(m[T]);delete u.g[f],u.h--}}this.G=null},An.prototype.J=function(u,f,m,T){return this.i.add(String(u),f,!1,m,T)},An.prototype.K=function(u,f,m,T){return this.i.add(String(u),f,!0,m,T)};function $r(u,f,m,T){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();let V=!0;for(let B=0;B<f.length;++B){let he=f[B];if(he&&!he.da&&he.capture==m){let Ze=he.listener,pn=he.ha||he.src;he.fa&&ve(u.i,he),V=Ze.call(pn,T)!==!1&&V}}return V&&!T.defaultPrevented}function A0(u,f){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=c(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:s.setTimeout(u,f||0)}function lr(u){u.g=A0(()=>{u.g=null,u.i&&(u.i=!1,lr(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class Ro extends D{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:lr(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Is(u){D.call(this),this.h=u,this.g={}}h(Is,D);var H=[];function L(u){Me(u.g,function(f,m){this.g.hasOwnProperty(m)&&oi(f)},u),u.g={}}Is.prototype.N=function(){Is.Z.N.call(this),L(this)},Is.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Y=s.JSON.stringify,Z=s.JSON.parse,Te=class{stringify(u){return s.JSON.stringify(u,void 0)}parse(u){return s.JSON.parse(u,void 0)}};function Ve(){}function Xe(){}var dt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wt(){w.call(this,"d")}h(wt,w);function mt(){w.call(this,"c")}h(mt,w);var yn={},Po=null;function Ba(){return Po=Po||new An}yn.Ia="serverreachability";function Ic(u){w.call(this,yn.Ia,u)}h(Ic,w);function si(u){let f=Ba();Pt(f,new Ic(f))}yn.STAT_EVENT="statevent";function Gr(u,f){w.call(this,yn.STAT_EVENT,u),this.stat=f}h(Gr,w);function zt(u){let f=Ba();Pt(f,new Gr(f,u))}yn.Ja="timingevent";function dh(u,f){w.call(this,yn.Ja,u),this.size=f}h(dh,w);function zr(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){u()},f)}function Wr(){this.g=!0}Wr.prototype.ua=function(){this.g=!1};function M0(u,f,m,T,V,B){u.info(function(){if(u.g)if(B){var he="",Ze=B.split("&");for(let Tt=0;Tt<Ze.length;Tt++){var pn=Ze[Tt].split("=");if(pn.length>1){let _n=pn[0];pn=pn[1];let ur=_n.split("_");he=ur.length>=2&&ur[1]=="type"?he+(_n+"="+pn+"&"):he+(_n+"=redacted&")}}}else he=null;else he=B;return"XMLHTTP REQ ("+T+") [attempt "+V+"]: "+f+`
`+m+`
`+he})}function j1(u,f,m,T,V,B,he){u.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+V+"]: "+f+`
`+m+`
`+B+" "+he})}function Bi(u,f,m,T){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+P0(u,m)+(T?" "+T:"")})}function R0(u,f){u.info(function(){return"TIMEOUT: "+f})}Wr.prototype.info=function(){};function P0(u,f){if(!u.g)return f;if(!f)return null;try{let B=JSON.parse(f);if(B){for(u=0;u<B.length;u++)if(Array.isArray(B[u])){var m=B[u];if(!(m.length<2)){var T=m[1];if(Array.isArray(T)&&!(T.length<1)){var V=T[0];if(V!="noop"&&V!="stop"&&V!="close")for(let he=1;he<T.length;he++)T[he]=""}}}}return Y(B)}catch{return f}}var be={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},He={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Dt;function Vt(){}h(Vt,Ve),Vt.prototype.g=function(){return new XMLHttpRequest},Dt=new Vt;function Nt(u){return encodeURIComponent(String(u))}function vn(u){var f=1;u=u.split(":");let m=[];for(;f>0&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function kt(u,f,m,T){this.j=u,this.i=f,this.l=m,this.S=T||1,this.V=new Is(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ts}function Ts(){this.i=null,this.g="",this.h=!1}var H1={},N0={};function k0(u,f,m){u.M=1,u.A=fh(cr(f)),u.u=m,u.R=!0,$1(u,null)}function $1(u,f){u.F=Date.now(),hh(u),u.B=cr(u.A);var m=u.B,T=u.S;Array.isArray(T)||(T=[String(T)]),nS(m.i,"t",T),u.C=0,m=u.j.L,u.h=new Ts,u.g=ES(u.j,m?f:null,!u.u),u.P>0&&(u.O=new Ro(c(u.Y,u,u.g),u.P)),f=u.V,m=u.g,T=u.ba;var V="readystatechange";Array.isArray(V)||(V&&(H[0]=V.toString()),V=H);for(let B=0;B<V.length;B++){let he=We(m,V[B],T||f.handleEvent,!1,f.h||f);if(!he)break;f.g[he.key]=he}f=u.J?lt(u.J):{},u.u?(u.v||(u.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,f)):(u.v="GET",u.g.ea(u.B,u.v,null,f)),si(),M0(u.i,u.v,u.B,u.l,u.S,u.u)}kt.prototype.ba=function(u){u=u.target;let f=this.O;f&&Oo(u)==3?f.j():this.Y(u)},kt.prototype.Y=function(u){try{if(u==this.g)e:{let Ze=Oo(this.g),pn=this.g.ya(),Tt=this.g.ca();if(!(Ze<3)&&(Ze!=3||this.g&&(this.h.h||this.g.la()||cS(this.g)))){this.K||Ze!=4||pn==7||(pn==8||Tt<=0?si(3):si(2)),O0(this);var f=this.g.ca();this.X=f;var m=AO(this);if(this.o=f==200,j1(this.i,this.v,this.B,this.l,this.S,Ze,f),this.o){if(this.U&&!this.L){t:{if(this.g){var T,V=this.g;if((T=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(T)){var B=T;break t}}B=null}if(u=B)Bi(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,F0(this,u);else{this.o=!1,this.m=3,zt(12),Cs(this),Tc(this);break e}}if(this.R){u=!0;let _n;for(;!this.K&&this.C<m.length;)if(_n=MO(this,m),_n==N0){Ze==4&&(this.m=4,zt(14),u=!1),Bi(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==H1){this.m=4,zt(15),Bi(this.i,this.l,m,"[Invalid Chunk]"),u=!1;break}else Bi(this.i,this.l,_n,null),F0(this,_n);if(G1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||m.length!=0||this.h.h||(this.m=1,zt(16),u=!1),this.o=this.o&&u,!u)Bi(this.i,this.l,m,"[Invalid Chunked Response]"),Cs(this),Tc(this);else if(m.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+m.length),$0(he),he.P=!0,zt(11))}}else Bi(this.i,this.l,m,null),F0(this,m);Ze==4&&Cs(this),this.o&&!this.K&&(Ze==4?mS(this.j,this):(this.o=!1,hh(this)))}else GO(this.g),f==400&&m.indexOf("Unknown SID")>0?(this.m=3,zt(12)):(this.m=0,zt(13)),Cs(this),Tc(this)}}}catch{}};function AO(u){if(!G1(u))return u.g.la();let f=cS(u.g);if(f==="")return"";let m="",T=f.length,V=Oo(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Cs(u),Tc(u),"";u.h.i=new s.TextDecoder}for(let B=0;B<T;B++)u.h.h=!0,m+=u.h.i.decode(f[B],{stream:!(V&&B==T-1)});return f.length=0,u.h.g+=m,u.C=0,u.h.g}function G1(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function MO(u,f){var m=u.C,T=f.indexOf(`
`,m);return T==-1?N0:(m=Number(f.substring(m,T)),isNaN(m)?H1:(T+=1,T+m>f.length?N0:(f=f.slice(T,T+m),u.C=T+m,f)))}kt.prototype.cancel=function(){this.K=!0,Cs(this)};function hh(u){u.T=Date.now()+u.H,z1(u,u.H)}function z1(u,f){if(u.D!=null)throw Error("WatchDog timer not null");u.D=zr(c(u.aa,u),f)}function O0(u){u.D&&(s.clearTimeout(u.D),u.D=null)}kt.prototype.aa=function(){this.D=null;let u=Date.now();u-this.T>=0?(R0(this.i,this.B),this.M!=2&&(si(),zt(17)),Cs(this),this.m=2,Tc(this)):z1(this,this.T-u)};function Tc(u){u.j.I==0||u.K||mS(u.j,u)}function Cs(u){O0(u);var f=u.O;f&&typeof f.dispose=="function"&&f.dispose(),u.O=null,L(u.V),u.g&&(f=u.g,u.g=null,f.abort(),f.dispose())}function F0(u,f){try{var m=u.j;if(m.I!=0&&(m.g==u||L0(m.h,u))){if(!u.L&&L0(m.h,u)&&m.I==3){try{var T=m.Ba.g.parse(f)}catch{T=null}if(Array.isArray(T)&&T.length==3){var V=T;if(V[0]==0){e:if(!m.v){if(m.g)if(m.g.F+3e3<u.F)_h(m),yh(m);else break e;H0(m),zt(18)}}else m.xa=V[1],0<m.xa-m.K&&V[2]<37500&&m.F&&m.A==0&&!m.C&&(m.C=zr(c(m.Va,m),6e3));K1(m.h)<=1&&m.ta&&(m.ta=void 0)}else As(m,11)}else if((u.L||m.g==u)&&_h(m),!M(f))for(V=m.Ba.g.parse(f),f=0;f<V.length;f++){let Tt=V[f],_n=Tt[0];if(!(_n<=m.K))if(m.K=_n,Tt=Tt[1],m.I==2)if(Tt[0]=="c"){m.M=Tt[1],m.ba=Tt[2];let ur=Tt[3];ur!=null&&(m.ka=ur,m.j.info("VER="+m.ka));let Ms=Tt[4];Ms!=null&&(m.za=Ms,m.j.info("SVER="+m.za));let Fo=Tt[5];Fo!=null&&typeof Fo=="number"&&Fo>0&&(T=1.5*Fo,m.O=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;let Lo=u.g;if(Lo){let bh=Lo.g?Lo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bh){var B=T.h;B.g||bh.indexOf("spdy")==-1&&bh.indexOf("quic")==-1&&bh.indexOf("h2")==-1||(B.j=B.l,B.g=new Set,B.h&&(V0(B,B.h),B.h=null))}if(T.G){let G0=Lo.g?Lo.g.getResponseHeader("X-HTTP-Session-Id"):null;G0&&(T.wa=G0,Ot(T.J,T.G,G0))}}m.I=3,m.l&&m.l.ra(),m.aa&&(m.T=Date.now()-u.F,m.j.info("Handshake RTT: "+m.T+"ms")),T=m;var he=u;if(T.na=_S(T,T.L?T.ba:null,T.W),he.L){Y1(T.h,he);var Ze=he,pn=T.O;pn&&(Ze.H=pn),Ze.D&&(O0(Ze),hh(Ze)),T.g=he}else pS(T);m.i.length>0&&vh(m)}else Tt[0]!="stop"&&Tt[0]!="close"||As(m,7);else m.I==3&&(Tt[0]=="stop"||Tt[0]=="close"?Tt[0]=="stop"?As(m,7):j0(m):Tt[0]!="noop"&&m.l&&m.l.qa(Tt),m.A=0)}}si(4)}catch{}}var RO=class{constructor(u,f){this.g=u,this.map=f}};function W1(u){this.l=u||10,s.PerformanceNavigationTiming?(u=s.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function q1(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function K1(u){return u.h?1:u.g?u.g.size:0}function L0(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function V0(u,f){u.g?u.g.add(f):u.h=f}function Y1(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}W1.prototype.cancel=function(){if(this.i=Q1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function Q1(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.G);return f}return g(u.i)}var J1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PO(u,f){if(u){u=u.split("&");for(let m=0;m<u.length;m++){let T=u[m].indexOf("="),V,B=null;T>=0?(V=u[m].substring(0,T),B=u[m].substring(T+1)):V=u[m],f(V,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function No(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;u instanceof No?(this.l=u.l,Cc(this,u.j),this.o=u.o,this.g=u.g,Dc(this,u.u),this.h=u.h,U0(this,iS(u.i)),this.m=u.m):u&&(f=String(u).match(J1))?(this.l=!1,Cc(this,f[1]||"",!0),this.o=Ac(f[2]||""),this.g=Ac(f[3]||"",!0),Dc(this,f[4]),this.h=Ac(f[5]||"",!0),U0(this,f[6]||"",!0),this.m=Ac(f[7]||"")):(this.l=!1,this.i=new Rc(null,this.l))}No.prototype.toString=function(){let u=[];var f=this.j;f&&u.push(Mc(f,Z1,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Mc(f,Z1,!0),"@"),u.push(Nt(m).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.u,m!=null&&u.push(":",String(m))),(m=this.h)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Mc(m,m.charAt(0)=="/"?OO:kO,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Mc(m,LO)),u.join("")},No.prototype.resolve=function(u){let f=cr(this),m=!!u.j;m?Cc(f,u.j):m=!!u.o,m?f.o=u.o:m=!!u.g,m?f.g=u.g:m=u.u!=null;var T=u.h;if(m)Dc(f,u.u);else if(m=!!u.h){if(T.charAt(0)!="/")if(this.g&&!this.h)T="/"+T;else{var V=f.h.lastIndexOf("/");V!=-1&&(T=f.h.slice(0,V+1)+T)}if(V=T,V==".."||V==".")T="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){T=V.lastIndexOf("/",0)==0,V=V.split("/");let B=[];for(let he=0;he<V.length;){let Ze=V[he++];Ze=="."?T&&he==V.length&&B.push(""):Ze==".."?((B.length>1||B.length==1&&B[0]!="")&&B.pop(),T&&he==V.length&&B.push("")):(B.push(Ze),T=!0)}T=B.join("/")}else T=V}return m?f.h=T:m=u.i.toString()!=="",m?U0(f,iS(u.i)):m=!!u.m,m&&(f.m=u.m),f};function cr(u){return new No(u)}function Cc(u,f,m){u.j=m?Ac(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Dc(u,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);u.u=f}else u.u=null}function U0(u,f,m){f instanceof Rc?(u.i=f,VO(u.i,u.l)):(m||(f=Mc(f,FO)),u.i=new Rc(f,u.l))}function Ot(u,f,m){u.i.set(f,m)}function fh(u){return Ot(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function Ac(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Mc(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,NO),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function NO(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Z1=/[#\/\?@]/g,kO=/[#\?:]/g,OO=/[#\?]/g,FO=/[#\?@]/g,LO=/#/g;function Rc(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function Ds(u){u.g||(u.g=new Map,u.h=0,u.i&&PO(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Rc.prototype,n.add=function(u,f){Ds(this),this.i=null,u=ja(this,u);let m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function X1(u,f){Ds(u),f=ja(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function eS(u,f){return Ds(u),f=ja(u,f),u.g.has(f)}n.forEach=function(u,f){Ds(this),this.g.forEach(function(m,T){m.forEach(function(V){u.call(f,V,T,this)},this)},this)};function tS(u,f){Ds(u);let m=[];if(typeof f=="string")eS(u,f)&&(m=m.concat(u.g.get(ja(u,f))));else for(u=Array.from(u.g.values()),f=0;f<u.length;f++)m=m.concat(u[f]);return m}n.set=function(u,f){return Ds(this),this.i=null,u=ja(this,u),eS(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=tS(this,u),u.length>0?String(u[0]):f):f};function nS(u,f,m){X1(u,f),m.length>0&&(u.i=null,u.g.set(ja(u,f),g(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(let T=0;T<f.length;T++){var m=f[T];let V=Nt(m);m=tS(this,m);for(let B=0;B<m.length;B++){let he=V;m[B]!==""&&(he+="="+Nt(m[B])),u.push(he)}}return this.i=u.join("&")};function iS(u){let f=new Rc;return f.i=u.i,u.g&&(f.g=new Map(u.g),f.h=u.h),f}function ja(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function VO(u,f){f&&!u.j&&(Ds(u),u.i=null,u.g.forEach(function(m,T){let V=T.toLowerCase();T!=V&&(X1(this,T),nS(this,V,m))},u)),u.j=f}function UO(u,f){let m=new Wr;if(s.Image){let T=new Image;T.onload=d(ko,m,"TestLoadImage: loaded",!0,f,T),T.onerror=d(ko,m,"TestLoadImage: error",!1,f,T),T.onabort=d(ko,m,"TestLoadImage: abort",!1,f,T),T.ontimeout=d(ko,m,"TestLoadImage: timeout",!1,f,T),s.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=u}else f(!1)}function BO(u,f){let m=new Wr,T=new AbortController,V=setTimeout(()=>{T.abort(),ko(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:T.signal}).then(B=>{clearTimeout(V),B.ok?ko(m,"TestPingServer: ok",!0,f):ko(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),ko(m,"TestPingServer: error",!1,f)})}function ko(u,f,m,T,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),T(m)}catch{}}function jO(){this.g=new Te}function ph(u){this.i=u.Sb||null,this.h=u.ab||!1}h(ph,Ve),ph.prototype.g=function(){return new gh(this.i,this.h)};function gh(u,f){An.call(this),this.H=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(gh,An),n=gh.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=f,this.readyState=1,Nc(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(f.body=u),(this.H||s).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Pc(this)),this.readyState=0},n.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Nc(this)),this.g&&(this.readyState=3,Nc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;rS(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function rS(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}n.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Pc(this):Nc(this),this.readyState==3&&rS(this)}},n.Oa=function(u){this.g&&(this.response=this.responseText=u,Pc(this))},n.Na=function(u){this.g&&(this.response=u,Pc(this))},n.ga=function(){this.g&&Pc(this)};function Pc(u){u.readyState=4,u.l=null,u.j=null,u.B=null,Nc(u)}n.setRequestHeader=function(u,f){this.A.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function Nc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(gh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function oS(u){let f="";return Me(u,function(m,T){f+=T,f+=":",f+=m,f+=`\r
`}),f}function B0(u,f,m){e:{for(T in m){var T=!1;break e}T=!0}T||(m=oS(m),typeof u=="string"?m!=null&&Nt(m):Ot(u,f,m))}function Wt(u){An.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Wt,An);var HO=/^https?$/i,$O=["POST","PUT"];n=Wt.prototype,n.Fa=function(u){this.H=u},n.ea=function(u,f,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Dt.g(),this.g.onreadystatechange=p(c(this.Ca,this));try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(B){sS(this,B);return}if(u=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var V in T)m.set(V,T[V]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(let B of T.keys())m.set(B,T.get(B));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(B=>B.toLowerCase()=="content-type"),V=s.FormData&&u instanceof s.FormData,!(Array.prototype.indexOf.call($O,f,void 0)>=0)||T||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[B,he]of m)this.g.setRequestHeader(B,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(B){sS(this,B)}};function sS(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.o=5,aS(u),mh(u)}function aS(u){u.A||(u.A=!0,Pt(u,"complete"),Pt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,Pt(this,"complete"),Pt(this,"abort"),mh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mh(this,!0)),Wt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?lS(this):this.Xa())},n.Xa=function(){lS(this)};function lS(u){if(u.h&&typeof o<"u"){if(u.v&&Oo(u)==4)setTimeout(u.Ca.bind(u),0);else if(Pt(u,"readystatechange"),Oo(u)==4){u.h=!1;try{let B=u.ca();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var T;if(T=B===0){let he=String(u.D).match(J1)[1]||null;!he&&s.self&&s.self.location&&(he=s.self.location.protocol.slice(0,-1)),T=!HO.test(he?he.toLowerCase():"")}m=T}if(m)Pt(u,"complete"),Pt(u,"success");else{u.o=6;try{var V=Oo(u)>2?u.g.statusText:""}catch{V=""}u.l=V+" ["+u.ca()+"]",aS(u)}}finally{mh(u)}}}}function mh(u,f){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);let m=u.g;u.g=null,f||Pt(u,"ready");try{m.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Oo(u){return u.g?u.g.readyState:0}n.ca=function(){try{return Oo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Z(f)}};function cS(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function GO(u){let f={};u=(u.g&&Oo(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<u.length;T++){if(M(u[T]))continue;var m=vn(u[T]);let V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let B=f[V]||[];f[V]=B,B.push(m)}Gt(f,function(T){return T.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function kc(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function uS(u){this.za=0,this.i=[],this.j=new Wr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=kc("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=kc("baseRetryDelayMs",5e3,u),this.Za=kc("retryDelaySeedMs",1e4,u),this.Ta=kc("forwardChannelMaxRetries",2,u),this.va=kc("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new W1(u&&u.concurrentRequestLimit),this.Ba=new jO,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=uS.prototype,n.ka=8,n.I=1,n.connect=function(u,f,m,T){zt(0),this.W=u,this.H=f||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.J=_S(this,null,this.W),vh(this)};function j0(u){if(dS(u),u.I==3){var f=u.V++,m=cr(u.J);if(Ot(m,"SID",u.M),Ot(m,"RID",f),Ot(m,"TYPE","terminate"),Oc(u,m),f=new kt(u,u.j,f),f.M=2,f.A=fh(cr(m)),m=!1,s.navigator&&s.navigator.sendBeacon)try{m=s.navigator.sendBeacon(f.A.toString(),"")}catch{}!m&&s.Image&&(new Image().src=f.A,m=!0),m||(f.g=ES(f.j,null),f.g.ea(f.A)),f.F=Date.now(),hh(f)}vS(u)}function yh(u){u.g&&($0(u),u.g.cancel(),u.g=null)}function dS(u){yh(u),u.v&&(s.clearTimeout(u.v),u.v=null),_h(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&s.clearTimeout(u.m),u.m=null)}function vh(u){if(!q1(u.h)&&!u.m){u.m=!0;var f=u.Ea;Ae||I(),Ie||(Ae(),Ie=!0),k.add(f,u),u.D=0}}function zO(u,f){return K1(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=f.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=zr(c(u.Ea,u,f),yS(u,u.D)),u.D++,!0)}n.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;let V=new kt(this,this.j,u),B=this.o;if(this.U&&(B?(B=lt(B),ie(B,this.U)):B=this.U),this.u!==null||this.R||(V.J=B,B=null),this.S)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(f+=T,f>4096){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=fS(this,V,f),m=cr(this.J),Ot(m,"RID",u),Ot(m,"CVER",22),this.G&&Ot(m,"X-HTTP-Session-Id",this.G),Oc(this,m),B&&(this.R?f="headers="+Nt(oS(B))+"&"+f:this.u&&B0(m,this.u,B)),V0(this.h,V),this.Ra&&Ot(m,"TYPE","init"),this.S?(Ot(m,"$req",f),Ot(m,"SID","null"),V.U=!0,k0(V,m,null)):k0(V,m,f),this.I=2}}else this.I==3&&(u?hS(this,u):this.i.length==0||q1(this.h)||hS(this))};function hS(u,f){var m;f?m=f.l:m=u.V++;let T=cr(u.J);Ot(T,"SID",u.M),Ot(T,"RID",m),Ot(T,"AID",u.K),Oc(u,T),u.u&&u.o&&B0(T,u.u,u.o),m=new kt(u,u.j,m,u.D+1),u.u===null&&(m.J=u.o),f&&(u.i=f.G.concat(u.i)),f=fS(u,m,1e3),m.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),V0(u.h,m),k0(m,T,f)}function Oc(u,f){u.H&&Me(u.H,function(m,T){Ot(f,T,m)}),u.l&&Me({},function(m,T){Ot(f,T,m)})}function fS(u,f,m){m=Math.min(u.i.length,m);let T=u.l?c(u.l.Ka,u.l,u):null;e:{var V=u.i;let Ze=-1;for(;;){let pn=["count="+m];Ze==-1?m>0?(Ze=V[0].g,pn.push("ofs="+Ze)):Ze=0:pn.push("ofs="+Ze);let Tt=!0;for(let _n=0;_n<m;_n++){var B=V[_n].g;let ur=V[_n].map;if(B-=Ze,B<0)Ze=Math.max(0,V[_n].g-100),Tt=!1;else try{B="req"+B+"_"||"";try{var he=ur instanceof Map?ur:Object.entries(ur);for(let[Ms,Fo]of he){let Lo=Fo;a(Fo)&&(Lo=Y(Fo)),pn.push(B+Ms+"="+encodeURIComponent(Lo))}}catch(Ms){throw pn.push(B+"type="+encodeURIComponent("_badmap")),Ms}}catch{T&&T(ur)}}if(Tt){he=pn.join("&");break e}}he=void 0}return u=u.i.splice(0,m),f.G=u,he}function pS(u){if(!u.g&&!u.v){u.Y=1;var f=u.Da;Ae||I(),Ie||(Ae(),Ie=!0),k.add(f,u),u.A=0}}function H0(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=zr(c(u.Da,u),yS(u,u.A)),u.A++,!0)}n.Da=function(){if(this.v=null,gS(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=zr(c(this.Wa,this),u)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,zt(10),yh(this),gS(this))};function $0(u){u.B!=null&&(s.clearTimeout(u.B),u.B=null)}function gS(u){u.g=new kt(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var f=cr(u.na);Ot(f,"RID","rpc"),Ot(f,"SID",u.M),Ot(f,"AID",u.K),Ot(f,"CI",u.F?"0":"1"),!u.F&&u.ia&&Ot(f,"TO",u.ia),Ot(f,"TYPE","xmlhttp"),Oc(u,f),u.u&&u.o&&B0(f,u.u,u.o),u.O&&(u.g.H=u.O);var m=u.g;u=u.ba,m.M=1,m.A=fh(cr(f)),m.u=null,m.R=!0,$1(m,u)}n.Va=function(){this.C!=null&&(this.C=null,yh(this),H0(this),zt(19))};function _h(u){u.C!=null&&(s.clearTimeout(u.C),u.C=null)}function mS(u,f){var m=null;if(u.g==f){_h(u),$0(u),u.g=null;var T=2}else if(L0(u.h,f))m=f.G,Y1(u.h,f),T=1;else return;if(u.I!=0){if(f.o)if(T==1){m=f.u?f.u.length:0,f=Date.now()-f.F;var V=u.D;T=Ba(),Pt(T,new dh(T,m)),vh(u)}else pS(u);else if(V=f.m,V==3||V==0&&f.X>0||!(T==1&&zO(u,f)||T==2&&H0(u)))switch(m&&m.length>0&&(f=u.h,f.i=f.i.concat(m)),V){case 1:As(u,5);break;case 4:As(u,10);break;case 3:As(u,6);break;default:As(u,2)}}}function yS(u,f){let m=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(m*=2),m*f}function As(u,f){if(u.j.info("Error code "+f),f==2){var m=c(u.bb,u),T=u.Ua;let V=!T;T=new No(T||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Cc(T,"https"),fh(T),V?UO(T.toString(),m):BO(T.toString(),m)}else zt(2);u.I=0,u.l&&u.l.pa(f),vS(u),dS(u)}n.bb=function(u){u?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function vS(u){if(u.I=0,u.ja=[],u.l){let f=Q1(u.h);(f.length!=0||u.i.length!=0)&&(x(u.ja,f),x(u.ja,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.oa()}}function _S(u,f,m){var T=m instanceof No?cr(m):new No(m);if(T.g!="")f&&(T.g=f+"."+T.g),Dc(T,T.u);else{var V=s.location;T=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;let B=new No(null);T&&Cc(B,T),f&&(B.g=f),V&&Dc(B,V),m&&(B.h=m),T=B}return m=u.G,f=u.wa,m&&f&&Ot(T,m,f),Ot(T,"VER",u.ka),Oc(u,T),T}function ES(u,f,m){if(f&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Aa&&!u.ma?new Wt(new ph({ab:m})):new Wt(u.ma),f.Fa(u.L),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bS(){}n=bS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Eh(){}Eh.prototype.g=function(u,f){return new ai(u,f)};function ai(u,f){An.call(this),this.g=new uS(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(u?u["X-WebChannel-Client-Profile"]=f.sa:u={"X-WebChannel-Client-Profile":f.sa}),this.g.U=u,(u=f&&f.Qb)&&!M(u)&&(this.g.u=u),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!M(f)&&(this.g.G=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Ha(this)}h(ai,An),ai.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ai.prototype.close=function(){j0(this.g)},ai.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.v&&(m={},m.__data__=Y(u),u=m);f.i.push(new RO(f.Ya++,u)),f.I==3&&vh(f)},ai.prototype.N=function(){this.g.l=null,delete this.j,j0(this.g),delete this.g,ai.Z.N.call(this)};function wS(u){wt.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}h(wS,wt);function xS(){mt.call(this),this.status=1}h(xS,mt);function Ha(u){this.g=u}h(Ha,bS),Ha.prototype.ra=function(){Pt(this.g,"a")},Ha.prototype.qa=function(u){Pt(this.g,new wS(u))},Ha.prototype.pa=function(u){Pt(this.g,new xS)},Ha.prototype.oa=function(){Pt(this.g,"b")},Eh.prototype.createWebChannel=Eh.prototype.g,ai.prototype.send=ai.prototype.o,ai.prototype.open=ai.prototype.m,ai.prototype.close=ai.prototype.close,Gb=go.createWebChannelTransport=function(){return new Eh},$b=go.getStatEventTarget=function(){return Ba()},Hb=go.Event=yn,Hg=go.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,_d=go.ErrorCode=be,He.COMPLETE="complete",jb=go.EventType=He,Xe.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",An.prototype.listen=An.prototype.J,Ul=go.WebChannel=Xe,v9=go.FetchXmlHttpFactory=ph,Wt.prototype.listenOnce=Wt.prototype.K,Wt.prototype.getLastError=Wt.prototype.Ha,Wt.prototype.getLastErrorCode=Wt.prototype.ya,Wt.prototype.getStatus=Wt.prototype.ca,Wt.prototype.getResponseJson=Wt.prototype.La,Wt.prototype.getResponseText=Wt.prototype.la,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Fa,Bb=go.XhrIo=Wt}).apply(typeof jg<"u"?jg:typeof self<"u"?self:typeof window<"u"?window:{});var Cn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Cn.UNAUTHENTICATED=new Cn(null),Cn.GOOGLE_CREDENTIALS=new Cn("google-credentials-uid"),Cn.FIRST_PARTY=new Cn("first-party-uid"),Cn.MOCK_USER=new Cn("mock-user");var nc="12.8.0";function fP(n){nc=n}var xa=new ls("@firebase/firestore");function Bl(){return xa.logLevel}function we(n,...e){if(xa.logLevel<=et.DEBUG){let t=e.map(Sx);xa.debug(`Firestore (${nc}): ${n}`,...t)}}function vo(n,...e){if(xa.logLevel<=et.ERROR){let t=e.map(Sx);xa.error(`Firestore (${nc}): ${n}`,...t)}}function fs(n,...e){if(xa.logLevel<=et.WARN){let t=e.map(Sx);xa.warn(`Firestore (${nc}): ${n}`,...t)}}function Sx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Fe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,pP(n,i,t)}function pP(n,e,t){let i=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw vo(i),new Error(i)}function Et(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||pP(e,r,i)}function ze(n,e){return n}var K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},de=class extends Ei{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var kr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Yg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Qg=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Cn.UNAUTHENTICATED))}shutdown(){}},Qb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Jg=class{constructor(e){this.t=e,this.currentUser=Cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Et(this.o===void 0,42304);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),o=new kr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new kr,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new kr)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Et(typeof i.accessToken=="string",31837,{l:i}),new Yg(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new Cn(e)}},Jb=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Cn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},Zb=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Jb(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Zg=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Xg=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,bi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Et(this.o===void 0,3512);let i=o=>{o.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,we("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Zg(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Et(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Zg(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function _9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var Sa=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=_9(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}};function rt(n,e){return n<e?-1:n>e?1:0}function Xb(n,e){let t=Math.min(n.length,e.length);for(let i=0;i<t;i++){let r=n.charAt(i),o=e.charAt(i);if(r!==o)return zb(r)===zb(o)?rt(r,o):zb(r)?1:-1}return rt(n.length,e.length)}var E9=55296,b9=57343;function zb(n){let e=n.charCodeAt(0);return e>=E9&&e<=b9}function Wl(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var D2="__name__",em=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&Fe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Fe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return rt(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):Xb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return po.fromString(e.substring(4,e.length-2))}},Rt=class n extends em{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new de(K.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},w9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=class n extends em{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return w9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===D2}static keyField(){return new n([D2])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new de(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new de(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new de(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(s=!s,r++):a!=="."||s?(i+=a,r++):(o(),r++)}if(o(),s)throw new de(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Pe=class n{constructor(e){this.path=e}static fromPath(e){return new n(Rt.fromString(e))}static fromName(e){return new n(Rt.fromString(e).popFirst(5))}static empty(){return new n(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Rt(e.slice()))}};function gP(n,e,t){if(!t)throw new de(K.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function mP(n,e,t,i){if(e===!0&&i===!0)throw new de(K.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function A2(n){if(!Pe.isDocumentKey(n))throw new de(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function M2(n){if(Pe.isDocumentKey(n))throw new de(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function yP(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Fe(12329,{type:typeof n})}function ic(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Vd(n);throw new de(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function vP(n,e){if(e<=0)throw new de(K.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function rn(n,e){let t={typeString:n};return e&&(t.value=e),t}function rc(n,e){if(!yP(n))throw new de(K.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let s=n[i];if(r&&typeof s!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new de(K.INVALID_ARGUMENT,t);return!0}var R2=-62135596800,P2=1e6,on=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*P2);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<R2)throw new de(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/P2}_compareTo(e){return this.seconds===e.seconds?rt(this.nanoseconds,e.nanoseconds):rt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(rc(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-R2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};on._jsonSchemaVersion="firestore/timestamp/1.0",on._jsonSchema={type:rn("string",on._jsonSchemaVersion),seconds:rn("number"),nanoseconds:rn("number")};var Qe=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new on(0,0))}static max(){return new n(new on(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Id=-1,tm=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};tm.UNKNOWN_ID=-1;function x9(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new on(t+1,0):new on(t,i));return new Ia(r,Pe.empty(),e)}function S9(n){return new Ia(n.readTime,n.key,Id)}var Ia=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Qe.min(),Pe.empty(),Id)}static max(){return new n(Qe.max(),Pe.empty(),Id)}};function I9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Pe.comparator(n.documentKey,e.documentKey),t!==0?t:rt(n.largestBatchId,e.largestBatchId))}var T9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ew=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function oc(n){if(n.code!==K.FAILED_PRECONDITION||n.message!==T9)throw n;we("LocalStore","Unexpectedly lost primary lease")}var ee=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(a=>{++r,a.next(()=>{++o,s&&o===r&&t()},l=>i(l))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let c=l;t(e[c]).next(d=>{s[c]=d,++a,a===o&&i(s)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};function C9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sc(n){return n.name==="IndexedDbTransactionError"}var Ix=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Tx=-1;function Dm(n){return n==null}function Td(n){return n===0&&1/n==-1/0}function D9(n){return typeof n=="number"&&Number.isInteger(n)&&!Td(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var _P="";function A9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=N2(e)),e=M9(n.get(t),e);return N2(e)}function M9(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case _P:t+="";break;default:t+=o}}return t}function N2(n){return n+_P+""}var R9="remoteDocuments",EP="owner";var bP="mutationQueues";var wP="mutations";var xP="documentMutations",P9="remoteDocumentsV14";var SP="remoteDocumentGlobal";var IP="targets";var TP="targetDocuments";var CP="targetGlobal",DP="collectionParents";var AP="clientMetadata";var MP="bundles";var RP="namedQueries";var N9="indexConfiguration";var k9="indexState";var O9="indexEntries";var PP="documentOverlays";var F9="globals";var L9=[bP,wP,xP,R9,IP,EP,CP,TP,AP,SP,DP,MP,RP],jue=[...L9,PP],V9=[bP,wP,xP,P9,IP,EP,CP,TP,AP,SP,DP,MP,RP,PP],U9=V9,B9=[...U9,N9,k9,O9];var Hue=[...B9,F9];function k2(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Na(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function NP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Yt=class n{constructor(e,t){this.comparator=e,this.root=t||Or.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Or.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Or.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gl(this.root,e,this.comparator,!0)}},Gl=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Or=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Fe(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Fe(27949);return e+(this.isRed()?0:1)}};Or.EMPTY=null,Or.RED=!0,Or.BLACK=!1;Or.EMPTY=new class{constructor(){this.size=0}get key(){throw Fe(57766)}get value(){throw Fe(16141)}get color(){throw Fe(16727)}get left(){throw Fe(29726)}get right(){throw Fe(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Or(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Dn=class n{constructor(e){this.comparator=e,this.data=new Yt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nm(this.data.getIterator())}getIteratorFrom(e){return new nm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},nm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Nr=class n{constructor(e){this.fields=e,e.sort(ii.comparator)}static empty(){return new n([])}unionWith(e){let t=new Dn(ii.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wl(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var im=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var On=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new im("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};On.EMPTY_BYTE_STRING=new On("");var j9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(n){if(Et(!!n,39018),typeof n=="string"){let e=0,t=j9.exec(n);if(Et(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Eo(n){return typeof n=="string"?On.fromBase64String(n):On.fromUint8Array(n)}var kP="server_timestamp",OP="__type__",FP="__previous_value__",LP="__local_write_time__";function Ud(n){return(n?.mapValue?.fields||{})[OP]?.stringValue===kP}function Am(n){let e=n.mapValue.fields[FP];return Ud(e)?Am(e):e}function Cd(n){let e=_o(n.mapValue.fields[LP].timestampValue);return new on(e.seconds,e.nanos)}var tw=class{constructor(e,t,i,r,o,s,a,l,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=d,this.apiKey=h}},rm="(default)",Dd=class n{constructor(e,t){this.projectId=e,this.database=t||rm}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===rm}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function VP(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new de(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dd(n.options.projectId,e)}var Cx="__type__",UP="__max__",$g={mapValue:{fields:{__type__:{stringValue:UP}}}},Dx="__vector__",ql="value";function ps(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ud(n)?4:jP(n)?9007199254740991:BP(n)?10:11:Fe(28295,{value:n})}function Br(n,e){if(n===e)return!0;let t=ps(n);if(t!==ps(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cd(n).isEqual(Cd(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=_o(r.timestampValue),a=_o(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return Eo(r.bytesValue).isEqual(Eo(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return Ht(r.geoPointValue.latitude)===Ht(o.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return Ht(r.integerValue)===Ht(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=Ht(r.doubleValue),a=Ht(o.doubleValue);return s===a?Td(s)===Td(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Wl(n.arrayValue.values||[],e.arrayValue.values||[],Br);case 10:case 11:return(function(r,o){let s=r.mapValue.fields||{},a=o.mapValue.fields||{};if(k2(s)!==k2(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Br(s[l],a[l])))return!1;return!0})(n,e);default:return Fe(52216,{left:n})}}function Ad(n,e){return(n.values||[]).find(t=>Br(t,e))!==void 0}function Kl(n,e){if(n===e)return 0;let t=ps(n),i=ps(e);if(t!==i)return rt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return rt(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=Ht(o.integerValue||o.doubleValue),l=Ht(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return O2(n.timestampValue,e.timestampValue);case 4:return O2(Cd(n),Cd(e));case 5:return Xb(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=Eo(o),l=Eo(s);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){let d=rt(a[c],l[c]);if(d!==0)return d}return rt(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=rt(Ht(o.latitude),Ht(s.latitude));return a!==0?a:rt(Ht(o.longitude),Ht(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return F2(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},l=s.fields||{},c=a[ql]?.arrayValue,d=l[ql]?.arrayValue,h=rt(c?.values?.length||0,d?.values?.length||0);return h!==0?h:F2(c,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===$g.mapValue&&s===$g.mapValue)return 0;if(o===$g.mapValue)return 1;if(s===$g.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),c=s.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let p=Xb(l[h],d[h]);if(p!==0)return p;let g=Kl(a[l[h]],c[d[h]]);if(g!==0)return g}return rt(l.length,d.length)})(n.mapValue,e.mapValue);default:throw Fe(23264,{he:t})}}function O2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return rt(n,e);let t=_o(n),i=_o(e),r=rt(t.seconds,i.seconds);return r!==0?r:rt(t.nanos,i.nanos)}function F2(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=Kl(t[r],i[r]);if(o)return o}return rt(t.length,i.length)}function Yl(n){return nw(n)}function nw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=_o(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Eo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=nw(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${nw(t.fields[s])}`;return r+"}"})(n.mapValue):Fe(61005,{value:n})}function Wg(n){switch(ps(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Am(n);return e?16+Wg(e):16;case 5:return 2*n.stringValue.length;case 6:return Eo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,o)=>r+Wg(o),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Na(i.fields,(o,s)=>{r+=o.length+Wg(s)}),r})(n.mapValue);default:throw Fe(13486,{value:n})}}function Bd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function iw(n){return!!n&&"integerValue"in n}function Ax(n){return!!n&&"arrayValue"in n}function L2(n){return!!n&&"nullValue"in n}function V2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function qg(n){return!!n&&"mapValue"in n}function BP(n){return(n?.mapValue?.fields||{})[Cx]?.stringValue===Dx}function wd(n){if(n.geoPointValue)return{geoPointValue:F({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:F({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Na(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=wd(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wd(n.arrayValue.values[t]);return e}return F({},n)}function jP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===UP}var Gue={mapValue:{fields:{[Cx]:{stringValue:Dx},[ql]:{arrayValue:{}}}}};var Vi=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!qg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wd(t)}setAll(e){let t=ii.emptyPath(),i={},r=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}s?i[a.lastSegment()]=wd(s):r.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());qg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Br(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];qg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Na(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(wd(this.value))}};function HP(n){let e=[];return Na(n.fields,(t,i)=>{let r=new ii([t]);if(qg(i)){let o=HP(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new Nr(e)}var rr=class n{constructor(e,t,i,r,o,s,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Qe.min(),Qe.min(),Qe.min(),Vi.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Qe.min(),Qe.min(),Vi.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Qe.min(),Qe.min(),Vi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var bo=class{constructor(e,t){this.position=e,this.inclusive=t}};function U2(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=Pe.comparator(Pe.fromName(s.referenceValue),t.key):i=Kl(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function B2(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Br(n.position[t],e.position[t]))return!1;return!0}var gs=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function H9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var om=class{},nn=class n extends om{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new ow(e,t,i):t==="array-contains"?new lw(e,i):t==="in"?new cw(e,i):t==="not-in"?new uw(e,i):t==="array-contains-any"?new dw(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new sw(e,i):new aw(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Kl(t,this.value)):t!==null&&ps(this.value)===ps(t)&&this.matchesComparison(Kl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ui=class n extends om{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return $P(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function $P(n){return n.op==="and"}function GP(n){return $9(n)&&$P(n)}function $9(n){for(let e of n.filters)if(e instanceof Ui)return!1;return!0}function rw(n){if(n instanceof nn)return n.field.canonicalString()+n.op.toString()+Yl(n.value);if(GP(n))return n.filters.map(e=>rw(e)).join(",");{let e=n.filters.map(t=>rw(t)).join(",");return`${n.op}(${e})`}}function zP(n,e){return n instanceof nn?(function(i,r){return r instanceof nn&&i.op===r.op&&i.field.isEqual(r.field)&&Br(i.value,r.value)})(n,e):n instanceof Ui?(function(i,r){return r instanceof Ui&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,a)=>o&&zP(s,r.filters[a]),!0):!1})(n,e):void Fe(19439)}function WP(n){return n instanceof nn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Yl(t.value)}`})(n):n instanceof Ui?(function(t){return t.op.toString()+" {"+t.getFilters().map(WP).join(" ,")+"}"})(n):"Filter"}var ow=class extends nn{constructor(e,t,i){super(e,t,i),this.key=Pe.fromName(i.referenceValue)}matches(e){let t=Pe.comparator(e.key,this.key);return this.matchesComparison(t)}},sw=class extends nn{constructor(e,t){super(e,"in",t),this.keys=qP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},aw=class extends nn{constructor(e,t){super(e,"not-in",t),this.keys=qP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function qP(n,e){return(e.arrayValue?.values||[]).map(t=>Pe.fromName(t.referenceValue))}var lw=class extends nn{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ax(t)&&Ad(t.arrayValue,this.value)}},cw=class extends nn{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ad(this.value.arrayValue,t)}},uw=class extends nn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ad(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ad(this.value.arrayValue,t)}},dw=class extends nn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ax(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Ad(this.value.arrayValue,i))}};var hw=class{constructor(e,t=null,i=[],r=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function j2(n,e=null,t=[],i=[],r=null,o=null,s=null){return new hw(n,e,t,i,r,o,s)}function Mx(n){let e=ze(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>rw(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(o){return o.field.canonicalString()+o.dir})(i)).join(","),Dm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Yl(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Yl(i)).join(",")),e.Te=t}return e.Te}function Rx(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!H9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!zP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!B2(n.startAt,e.startAt)&&B2(n.endAt,e.endAt)}function fw(n){return Pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var wo=class{constructor(e,t=null,i=[],r=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function G9(n,e,t,i,r,o,s,a){return new wo(n,e,t,i,r,o,s,a)}function Px(n){return new wo(n)}function H2(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function z9(n){return Pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Mm(n){return n.collectionGroup!==null}function wa(n){let e=ze(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Dn(ii.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new gs(o,i))}),t.has(ii.keyField().canonicalString())||e.Ie.push(new gs(ii.keyField(),i))}return e.Ie}function Fr(n){let e=ze(n);return e.Ee||(e.Ee=W9(e,wa(n))),e.Ee}function W9(n,e){if(n.limitType==="F")return j2(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new gs(r.field,o)});let t=n.endAt?new bo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new bo(n.startAt.position,n.startAt.inclusive):null;return j2(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Rm(n,e){let t=n.filters.concat([e]);return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function KP(n,e){let t=n.explicitOrderBy.concat([e]);return new wo(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Md(n,e,t){return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function YP(n,e){return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Pm(n,e){return Rx(Fr(n),Fr(e))&&n.limitType===e.limitType}function QP(n){return`${Mx(Fr(n))}|lt:${n.limitType}`}function jl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>WP(r)).join(", ")}]`),Dm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Yl(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Yl(r)).join(",")),`Target(${i})`})(Fr(n))}; limitType=${n.limitType})`}function Nm(n,e){return e.isFoundDocument()&&(function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Pe.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(let o of wa(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(s,a,l){let c=U2(s,a,l);return s.inclusive?c<=0:c<0})(i.startAt,wa(i),r)||i.endAt&&!(function(s,a,l){let c=U2(s,a,l);return s.inclusive?c>=0:c>0})(i.endAt,wa(i),r))})(n,e)}function q9(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function JP(n){return(e,t)=>{let i=!1;for(let r of wa(n)){let o=K9(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function K9(n,e,t){let i=n.field.isKeyField()?Pe.comparator(e.key,t.key):(function(o,s,a){let l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?Kl(l,c):Fe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Fe(19790,{direction:n.dir})}}var xo=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Na(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return NP(this.inner)}size(){return this.innerSize}};var Y9=new Yt(Pe.comparator);function So(){return Y9}var ZP=new Yt(Pe.comparator);function bd(...n){let e=ZP;for(let t of n)e=e.insert(t.key,t);return e}function XP(n){let e=ZP;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ea(){return xd()}function eN(){return xd()}function xd(){return new xo(n=>n.toString(),(n,e)=>n.isEqual(e))}var Q9=new Yt(Pe.comparator),J9=new Dn(Pe.comparator);function tt(...n){let e=J9;for(let t of n)e=e.add(t);return e}var Z9=new Dn(rt);function X9(){return Z9}function Nx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Td(e)?"-0":e}}function tN(n){return{integerValue:""+n}}function e7(n,e){return D9(e)?tN(e):Nx(n,e)}var Ql=class{constructor(){this._=void 0}};function t7(n,e,t){return n instanceof Ta?(function(r,o){let s={fields:{[OP]:{stringValue:kP},[LP]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Ud(o)&&(o=Am(o)),o&&(s.fields[FP]=o),{mapValue:s}})(t,e):n instanceof Ca?iN(n,e):n instanceof Da?rN(n,e):(function(r,o){let s=nN(r,o),a=$2(s)+$2(r.Ae);return iw(s)&&iw(r.Ae)?tN(a):Nx(r.serializer,a)})(n,e)}function n7(n,e,t){return n instanceof Ca?iN(n,e):n instanceof Da?rN(n,e):t}function nN(n,e){return n instanceof Jl?(function(i){return iw(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}var Ta=class extends Ql{},Ca=class extends Ql{constructor(e){super(),this.elements=e}};function iN(n,e){let t=oN(e);for(let i of n.elements)t.some(r=>Br(r,i))||t.push(i);return{arrayValue:{values:t}}}var Da=class extends Ql{constructor(e){super(),this.elements=e}};function rN(n,e){let t=oN(e);for(let i of n.elements)t=t.filter(r=>!Br(r,i));return{arrayValue:{values:t}}}var Jl=class extends Ql{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function $2(n){return Ht(n.integerValue||n.doubleValue)}function oN(n){return Ax(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var pw=class{constructor(e,t){this.field=e,this.transform=t}};function i7(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Ca&&r instanceof Ca||i instanceof Da&&r instanceof Da?Wl(i.elements,r.elements,Br):i instanceof Jl&&r instanceof Jl?Br(i.Ae,r.Ae):i instanceof Ta&&r instanceof Ta})(n.transform,e.transform)}var gw=class{constructor(e,t){this.version=e,this.transformResults=t}},hs=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Kg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Zl=class{};function sN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rd(n.key,hs.none()):new Aa(n.key,n.data,hs.none());{let t=n.data,i=Vi.empty(),r=new Dn(ii.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new Io(n.key,i,new Nr(r.toArray()),hs.none())}}function r7(n,e,t){n instanceof Aa?(function(r,o,s){let a=r.value.clone(),l=z2(r.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Io?(function(r,o,s){if(!Kg(r.precondition,o))return void o.convertToUnknownDocument(s.version);let a=z2(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(aN(r)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):(function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Sd(n,e,t,i){return n instanceof Aa?(function(o,s,a,l){if(!Kg(o.precondition,s))return a;let c=o.value.clone(),d=W2(o.fieldTransforms,l,s);return c.setAll(d),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null})(n,e,t,i):n instanceof Io?(function(o,s,a,l){if(!Kg(o.precondition,s))return a;let c=W2(o.fieldTransforms,l,s),d=s.data;return d.setAll(aN(o)),d.setAll(c),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,i):(function(o,s,a){return Kg(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function o7(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=nN(i.transform,r||null);o!=null&&(t===null&&(t=Vi.empty()),t.set(i.field,o))}return t||null}function G2(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Wl(i,r,(o,s)=>i7(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Aa=class extends Zl{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Io=class extends Zl{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function aN(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function z2(n,e,t){let i=new Map;Et(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,n7(s,a,t[r]))}return i}function W2(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,t7(o,s,e))}return i}var Rd=class extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},mw=class extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var yw=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&r7(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Sd(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Sd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=eN();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(r.key)?null:a;let l=sN(s,a);l!==null&&i.set(r.key,l),s.isValidDocument()||s.convertToNoDocument(Qe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),tt())}isEqual(e){return this.batchId===e.batchId&&Wl(this.mutations,e.mutations,(t,i)=>G2(t,i))&&Wl(this.baseMutations,e.baseMutations,(t,i)=>G2(t,i))}},vw=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Et(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return Q9})(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var _w=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ew=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var hn,ct;function s7(n){switch(n){case K.OK:return Fe(64938);case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0;default:return Fe(15467,{code:n})}}function lN(n){if(n===void 0)return vo("GRPC error has no .code"),K.UNKNOWN;switch(n){case hn.OK:return K.OK;case hn.CANCELLED:return K.CANCELLED;case hn.UNKNOWN:return K.UNKNOWN;case hn.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case hn.INTERNAL:return K.INTERNAL;case hn.UNAVAILABLE:return K.UNAVAILABLE;case hn.UNAUTHENTICATED:return K.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case hn.NOT_FOUND:return K.NOT_FOUND;case hn.ALREADY_EXISTS:return K.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return K.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case hn.ABORTED:return K.ABORTED;case hn.OUT_OF_RANGE:return K.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return K.UNIMPLEMENTED;case hn.DATA_LOSS:return K.DATA_LOSS;default:return Fe(39323,{code:n})}}(ct=hn||(hn={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";var a7=null;function l7(){return new TextEncoder}var c7=new po([4294967295,4294967295],0);function q2(n){let e=l7().encode(n),t=new Ub;return t.update(e),new Uint8Array(t.digest())}function K2(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new po([t,i],0),new po([r,o],0)]}var bw=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ba(`Invalid padding: ${t}`);if(i<0)throw new ba(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ba(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ba(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=po.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(po.fromNumber(i)));return r.compare(c7)===1&&(r=new po([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=q2(e),[i,r]=K2(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);if(!this.we(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=q2(e),[i,r]=K2(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);this.be(s)}}be(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},ba=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var sm=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Pd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Qe.min(),r,new Yt(rt),So(),tt())}},Pd=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,tt(),tt(),tt())}};var zl=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}},am=class{constructor(e,t){this.targetId=e,this.Ce=t}},lm=class{constructor(e,t,i=On.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},cm=class{constructor(){this.ve=0,this.Fe=Y2(),this.Me=On.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=tt(),t=tt(),i=tt();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Fe(38017,{changeType:o})}}),new Pd(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Y2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},ww=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=So(),this.He=Gg(),this.Je=Gg(),this.Ze=new Yt(rt)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Fe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){let o=r.target;if(fw(o))if(i===0){let s=new Pe(o.path);this.et(t,s,rr.newNoDocument(s,Qe.min()))}else Et(i===1,20013,{expectedCount:i});else{let s=this._t(t);if(s!==i){let a=this.ut(e),l=a?this.ct(a,e,s):1;if(l!==0){this.it(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}a7?.lt((function(d,h,p,g,x){let S={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},N=h.unchangedNames;return N&&(S.bloomFilter={applied:x===0,hashCount:N?.hashCount??0,bitmapLength:N?.bits?.bitmap?.length??0,padding:N?.bits?.padding??0,mightContain:U=>g?.mightContain(U)??!1}),S})(s,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,a;try{s=Eo(i).toUint8Array()}catch(l){if(l instanceof im)return fs("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new bw(s,r,o)}catch(l){return fs(l instanceof ba?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){let i=this.Ge.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),r++)}),r}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&fw(a.target)){let l=new Pe(a.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,rr.newNoDocument(l,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let i=tt();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let r=new sm(e,t,this.Ze,this.je,i);return this.je=So(),this.He=Gg(),this.Je=Gg(),this.Ze=new Yt(rt),r}Ye(e,t){if(!this.rt(e))return;let i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new cm,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Dn(rt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Dn(rt),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||we("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new cm),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Gg(){return new Yt(Pe.comparator)}function Y2(){return new Yt(Pe.comparator)}var u7={asc:"ASCENDING",desc:"DESCENDING"},d7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},h7={and:"AND",or:"OR"},xw=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Sw(n,e){return n.useProto3Json||Dm(e)?e:{value:e}}function um(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function f7(n,e){return um(n,e.toTimestamp())}function Lr(n){return Et(!!n,49232),Qe.fromTimestamp((function(t){let i=_o(t);return new on(i.seconds,i.nanos)})(n))}function kx(n,e){return Iw(n,e).canonicalString()}function Iw(n,e){let t=(function(r){return new Rt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function uN(n){let e=Rt.fromString(n);return Et(gN(e),10190,{key:e.toString()}),e}function Tw(n,e){return kx(n.databaseId,e.path)}function Wb(n,e){let t=uN(e);if(t.get(1)!==n.databaseId.projectId)throw new de(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Pe(hN(t))}function dN(n,e){return kx(n.databaseId,e)}function p7(n){let e=uN(n);return e.length===4?Rt.emptyPath():hN(e)}function Cw(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function hN(n){return Et(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Q2(n,e,t){return{name:Tw(n,e),fields:t.value.mapValue.fields}}function g7(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Fe(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(c,d){return c.useProto3Json?(Et(d===void 0||typeof d=="string",58123),On.fromBase64String(d||"")):(Et(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),On.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(c){let d=c.code===void 0?K.UNKNOWN:lN(c.code);return new de(d,c.message||"")})(s);t=new lm(i,r,o,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Wb(n,i.document.name),o=Lr(i.document.updateTime),s=i.document.createTime?Lr(i.document.createTime):Qe.min(),a=new Vi({mapValue:{fields:i.document.fields}}),l=rr.newFoundDocument(r,o,s,a),c=i.targetIds||[],d=i.removedTargetIds||[];t=new zl(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Wb(n,i.document),o=i.readTime?Lr(i.readTime):Qe.min(),s=rr.newNoDocument(r,o),a=i.removedTargetIds||[];t=new zl([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Wb(n,i.document),o=i.removedTargetIds||[];t=new zl([],o,r,null)}else{if(!("filter"in e))return Fe(11601,{Vt:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new Ew(r,o),a=i.targetId;t=new am(a,s)}}return t}function m7(n,e){let t;if(e instanceof Aa)t={update:Q2(n,e.key,e.value)};else if(e instanceof Rd)t={delete:Tw(n,e.key)};else if(e instanceof Io)t={update:Q2(n,e.key,e.data),updateMask:I7(e.fieldMask)};else{if(!(e instanceof mw))return Fe(16599,{dt:e.type});t={verify:Tw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(o,s){let a=s.transform;if(a instanceof Ta)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ca)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Da)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Jl)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw Fe(20930,{transform:s.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:f7(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Fe(27497)})(n,e.precondition)),t}function y7(n,e){return n&&n.length>0?(Et(e!==void 0,14353),n.map(t=>(function(r,o){let s=r.updateTime?Lr(r.updateTime):Lr(o);return s.isEqual(Qe.min())&&(s=Lr(o)),new gw(s,r.transformResults||[])})(t,e))):[]}function v7(n,e){return{documents:[dN(n,e.path)]}}function _7(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=dN(n,r);let o=(function(c){if(c.length!==0)return pN(Ui.create(c,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(c){if(c.length!==0)return c.map(d=>(function(p){return{field:Hl(p.field),direction:w7(p.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Sw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:r}}function E7(n){let e=p7(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){Et(i===1,65062);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let p=fN(h);return p instanceof Ui&&GP(p)?p.getFilters():[p]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(p=>(function(x){return new gs($l(x.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(p))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let p;return p=typeof h=="object"?h.value:h,Dm(p)?null:p})(t.limit));let l=null;t.startAt&&(l=(function(h){let p=!!h.before,g=h.values||[];return new bo(g,p)})(t.startAt));let c=null;return t.endAt&&(c=(function(h){let p=!h.before,g=h.values||[];return new bo(g,p)})(t.endAt)),G9(e,r,s,o,a,"F",l,c)}function b7(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fe(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function fN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=$l(t.unaryFilter.field);return nn.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=$l(t.unaryFilter.field);return nn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=$l(t.unaryFilter.field);return nn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=$l(t.unaryFilter.field);return nn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Fe(61313);default:return Fe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return nn.create($l(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Fe(58110);default:return Fe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ui.create(t.compositeFilter.filters.map(i=>fN(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Fe(1026)}})(t.compositeFilter.op))})(n):Fe(30097,{filter:n})}function w7(n){return u7[n]}function x7(n){return d7[n]}function S7(n){return h7[n]}function Hl(n){return{fieldPath:n.canonicalString()}}function $l(n){return ii.fromServerFormat(n.fieldPath)}function pN(n){return n instanceof nn?(function(t){if(t.op==="=="){if(V2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NAN"}};if(L2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(V2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NOT_NAN"}};if(L2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hl(t.field),op:x7(t.op),value:t.value}}})(n):n instanceof Ui?(function(t){let i=t.getFilters().map(r=>pN(r));return i.length===1?i[0]:{compositeFilter:{op:S7(t.op),filters:i}}})(n):Fe(54877,{filter:n})}function I7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function gN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function mN(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var Nd=class n{constructor(e,t,i,r,o=Qe.min(),s=Qe.min(),a=On.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Dw=class{constructor(e){this.yt=e}};function yN(n){let e=E7({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Md(e,e.limit,"L"):e}var dm=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){let i=Ht(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Td(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=_o(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Eo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?jP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):BP(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):Fe(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let i=e.fields||{};this.Ft(t,55);for(let r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){let i=e.fields||{};this.Ft(t,53);let r=ql,o=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){let i=e.values||[];this.Ft(t,50);for(let r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Pe.fromName(e).path.forEach(i=>{this.Ft(t,60),this.$t(i,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};dm.Wt=new dm;var Aw=class{constructor(){this.Sn=new Mw}addToCollectionParentIndex(e,t){return this.Sn.add(t),ee.resolve()}getCollectionParents(e,t){return ee.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ee.resolve()}deleteFieldIndex(e,t){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,t){return ee.resolve()}getDocumentsMatchingTarget(e,t){return ee.resolve(null)}getIndexType(e,t){return ee.resolve(0)}getFieldIndexes(e,t){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,t){return ee.resolve(Ia.min())}getMinOffsetFromCollectionGroup(e,t){return ee.resolve(Ia.min())}updateCollectionGroup(e,t,i){return ee.resolve()}updateIndexEntries(e,t){return ee.resolve()}},Mw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Dn(Rt.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Dn(Rt.comparator)).toArray()}};var zue=new Uint8Array(0);var J2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vN=41943040,Li=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};Li.DEFAULT_COLLECTION_PERCENTILE=10,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Li.DEFAULT=new Li(vN,Li.DEFAULT_COLLECTION_PERCENTILE,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Li.DISABLED=new Li(-1,0,0);var kd=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var Z2="LruGarbageCollector",T7=1048576;function X2([n,e],[t,i]){let r=rt(n,t);return r===0?rt(e,i):r}var Rw=class{constructor(e){this.Pr=e,this.buffer=new Dn(X2),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();X2(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Pw=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){we(Z2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sc(t)?we(Z2,"Ignoring IndexedDB error during garbage collection: ",t):await oc(t)}await this.Ar(3e5)})}},Nw=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return ee.resolve(Ix.ce);let i=new Rw(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(we("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(J2)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(we("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),J2):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,s,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(we("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,s=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(c=Date.now(),Bl()<=et.DEBUG&&we("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${r} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:h})))}};function C7(n,e){return new Nw(n,e)}var kw=class{constructor(){this.changes=new xo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?ee.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ow=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Fw=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Sd(i.mutation,r,Nr.empty(),on.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,tt()).next(()=>i))}getLocalViewOfDocuments(e,t,i=tt()){let r=Ea();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=bd();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=Ea();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,tt()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,i,r){let o=So(),s=xd(),a=(function(){return xd()})();return t.forEach((l,c)=>{let d=i.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof Io)?o=o.insert(c.key,c):d!==void 0?(s.set(c.key,d.mutation.getFieldMask()),Sd(d.mutation,c,d.mutation.getFieldMask(),on.now())):s.set(c.key,Nr.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,d)=>s.set(c,d)),t.forEach((c,d)=>a.set(c,new Ow(d,s.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){let i=xd(),r=new Yt((s,a)=>s-a),o=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=i.get(l)||Nr.empty();d=a.applyToLocalView(c,d),i.set(l,d);let h=(r.get(a.batchId)||tt()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,h=eN();d.forEach(p=>{if(!o.has(p)){let g=sN(t.get(p),i.get(p));g!==null&&h.set(p,g),o=o.add(p)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return ee.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return z9(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Mm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):ee.resolve(Ea()),a=Id,l=o;return s.next(c=>ee.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?ee.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,tt())).next(d=>({batchId:a,changes:XP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Pe(t)).next(i=>{let r=bd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=bd();return this.indexManager.getCollectionParents(e,o).next(a=>ee.forEach(a,l=>{let c=(function(h,p){return new wo(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,i,r).next(d=>{d.forEach((h,p)=>{s=s.insert(h,p)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((l,c)=>{let d=c.getKey();s.get(d)===null&&(s=s.insert(d,rr.newInvalidDocument(d)))});let a=bd();return s.forEach((l,c)=>{let d=o.get(l);d!==void 0&&Sd(d.mutation,c,Nr.empty(),on.now()),Nm(t,c)&&(a=a.insert(l,c))}),a})}};var Lw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ee.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Lr(r.createTime)}})(t)),ee.resolve()}getNamedQuery(e,t){return ee.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:yN(r.bundledQuery),readTime:Lr(r.readTime)}})(t)),ee.resolve()}};var Vw=class{constructor(){this.overlays=new Yt(Pe.comparator),this.Lr=new Map}getOverlay(e,t){return ee.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Ea();return ee.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.bt(e,t,o)}),ee.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Lr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(i)),ee.resolve()}getOverlaysForCollection(e,t,i){let r=Ea(),o=t.length+1,s=new Pe(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>i&&r.set(l.getKey(),l)}return ee.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Yt((c,d)=>c-d),s=this.overlays.getIterator();for(;s.hasNext();){let c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let d=o.get(c.largestBatchId);d===null&&(d=Ea(),o=o.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}let a=Ea(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=r)););return ee.resolve(a)}bt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new _w(t,i));let o=this.Lr.get(t);o===void 0&&(o=tt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}};var Uw=class{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ee.resolve()}};var Od=class{constructor(){this.kr=new Dn(fn.Kr),this.qr=new Dn(fn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let i=new fn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new fn(e,t))}Qr(e,t){e.forEach(i=>this.removeReference(i,t))}Gr(e){let t=new Pe(new Rt([])),i=new fn(t,e),r=new fn(t,e+1),o=[];return this.qr.forEachInRange([i,r],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new Pe(new Rt([])),i=new fn(t,e),r=new fn(t,e+1),o=tt();return this.qr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new fn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},fn=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Pe.comparator(e.key,t.key)||rt(e.Hr,t.Hr)}static Ur(e,t){return rt(e.Hr,t.Hr)||Pe.comparator(e.key,t.key)}};var Bw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Dn(fn.Kr)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new yw(o,t,i,r);this.mutationQueue.push(s);for(let a of r)this.Jr=this.Jr.add(new fn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ee.resolve(s)}lookupMutationBatch(e,t){return ee.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),o=r<0?0:r;return ee.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?Tx:this.Yn-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new fn(t,0),r=new fn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],s=>{let a=this.Zr(s.Hr);o.push(a)}),ee.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Dn(rt);return t.forEach(r=>{let o=new fn(r,0),s=new fn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{i=i.add(a.Hr)})}),ee.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;Pe.isDocumentKey(o)||(o=o.child(""));let s=new fn(new Pe(o),0),a=new Dn(rt);return this.Jr.forEachWhile(l=>{let c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Hr)),!0)},s),ee.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Et(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ee.forEach(t.mutations,r=>{let o=new fn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Jr=i})}nr(e){}containsKey(e,t){let i=new fn(t,0),r=this.Jr.firstAfterOrEqual(i);return ee.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var jw=class{constructor(e){this.ti=e,this.docs=(function(){return new Yt(Pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return ee.resolve(i?i.document.mutableCopy():rr.newInvalidDocument(t))}getEntries(e,t){let i=So();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():rr.newInvalidDocument(r))}),ee.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=So(),s=t.path,a=new Pe(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||I9(S9(d),i)<=0||(r.has(d.key)||Nm(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return ee.resolve(o)}getAllFromCollectionGroup(e,t,i,r){Fe(9500)}ni(e,t){return ee.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Hw(this)}getSize(e){return ee.resolve(this.size)}},Hw=class extends kw{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)}),ee.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var $w=class{constructor(e){this.persistence=e,this.ri=new xo(t=>Mx(t),Rx),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.ii=0,this.si=new Od,this.targetCount=0,this.oi=kd._r()}forEachTarget(e,t){return this.ri.forEach((i,r)=>t(r)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ee.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new kd(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ee.resolve()}updateTargetData(e,t){return this.lr(t),ee.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),ee.waitFor(o).next(()=>r)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,t){let i=this.ri.get(t)||null;return ee.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ee.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),ee.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ee.resolve()}getMatchingKeysForTargetId(e,t){let i=this.si.jr(t);return ee.resolve(i)}containsKey(e,t){return ee.resolve(this.si.containsKey(t))}};var hm=class{constructor(e,t){this._i={},this.overlays={},this.ai=new Ix(0),this.ui=!1,this.ui=!0,this.ci=new Uw,this.referenceDelegate=e(this),this.li=new $w(this),this.indexManager=new Aw,this.remoteDocumentCache=(function(r){return new jw(r)})(i=>this.referenceDelegate.hi(i)),this.serializer=new Dw(t),this.Pi=new Lw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Vw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new Bw(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){we("MemoryPersistence","Starting transaction:",e);let r=new Gw(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(o=>this.referenceDelegate.Ii(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ei(e,t){return ee.or(Object.values(this._i).map(i=>()=>i.containsKey(e,t)))}},Gw=class extends ew{constructor(e){super(),this.currentSequenceNumber=e}},zw=class n{constructor(e){this.persistence=e,this.Ri=new Od,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw Fe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ee.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ee.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ee.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(r=>this.di.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.di,i=>{let r=Pe.fromPath(i);return this.mi(e,r).next(o=>{o||t.removeEntry(r,Qe.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return ee.or([()=>ee.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},fm=class n{constructor(e,t){this.persistence=e,this.fi=new xo(i=>A9(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=C7(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return ee.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}pr(e){let t=0;return this.mr(e,i=>{t++}).next(()=>t)}mr(e,t){return ee.forEach(this.fi,(i,r)=>this.wr(e,i,r).next(o=>o?ee.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,s=>this.wr(e,s,t).next(a=>{a||(i++,o.removeEntry(s,Qe.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wg(e.data.value)),t}wr(e,t,i){return ee.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.fi.get(t);return ee.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Ww=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=tt(),r=tt();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var qw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Kw=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return l2()?8:C9(In())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new qw;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,i,r){return i.documentReadCount<this.Vs?(Bl()<=et.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",jl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ee.resolve()):(Bl()<=et.DEBUG&&we("QueryEngine","Query:",jl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Bl()<=et.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",jl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fr(t))):ee.resolve())}gs(e,t){if(H2(t))return ee.resolve(null);let i=Fr(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Md(t,null,"F"),i=Fr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=tt(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{let c=this.bs(t,a);return this.Ss(t,c,s,l.readTime)?this.gs(e,Md(t,null,"F")):this.Ds(e,c,t,l)}))})))}ps(e,t,i,r){return H2(t)||r.isEqual(Qe.min())?ee.resolve(null):this.fs.getDocuments(e,i).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,i,r)?ee.resolve(null):(Bl()<=et.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),jl(t)),this.Ds(e,s,t,x9(r,Id)).next(a=>a))})}bs(e,t){let i=new Dn(JP(e));return t.forEach((r,o)=>{Nm(e,o)&&(i=i.add(o))}),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return Bl()<=et.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",jl(t)),this.fs.getDocumentsMatchingQuery(e,t,Ia.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Ox="LocalStore",D7=3e8,Yw=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Yt(rt),this.Fs=new xo(o=>Mx(o),Rx),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Fw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function A7(n,e,t,i){return new Yw(n,e,t,i)}async function _N(n,e){let t=ze(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],a=[],l=tt();for(let c of r){s.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}for(let c of o){a.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Ns:c,removedBatchIds:s,addedBatchIds:a}))})})}function M7(n,e){let t=ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,d){let h=c.batch,p=h.keys(),g=ee.resolve();return p.forEach(x=>{g=g.next(()=>d.getEntry(l,x)).next(S=>{let N=c.docVersions.get(x);Et(N!==null,48541),S.version.compareTo(N)<0&&(h.applyToRemoteDocument(S,c),S.isValidDocument()&&(S.setReadTime(c.commitVersion),d.addEntry(S)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))})(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=tt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function EN(n){let e=ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function R7(n,e){let t=ze(n),i=e.snapshotVersion,r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;let a=[];e.targetChanges.forEach((d,h)=>{let p=r.get(h);if(!p)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,h)));let g=p.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(On.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,i)),r=r.insert(h,g),(function(S,N,U){return S.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=D7?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0})(p,g,d)&&a.push(t.li.updateTargetData(o,g))});let l=So(),c=tt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(P7(o,s,e.documentUpdates).next(d=>{l=d.Bs,c=d.Ls})),!i.isEqual(Qe.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(h=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i));a.push(d)}return ee.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.vs=r,o))}function P7(n,e,t){let i=tt(),r=tt();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=So();return t.forEach((a,l)=>{let c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Qe.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):we(Ox,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Bs:s,Ls:r}})}function N7(n,e){let t=ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Tx),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function k7(n,e){let t=ze(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.li.getTargetData(i,e).next(o=>o?(r=o,ee.resolve(r)):t.li.allocateTargetId(i).next(s=>(r=new Nd(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i})}async function Qw(n,e,t){let i=ze(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r))}catch(s){if(!sc(s))throw s;we(Ox,`Failed to update sequence numbers for target ${e}: ${s}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function eP(n,e,t){let i=ze(n),r=Qe.min(),o=tt();return i.persistence.runTransaction("Execute query","readwrite",s=>(function(l,c,d){let h=ze(l),p=h.Fs.get(d);return p!==void 0?ee.resolve(h.vs.get(p)):h.li.getTargetData(c,d)})(i,s,Fr(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(s,e,t?r:Qe.min(),t?o:tt())).next(a=>(O7(i,q9(e),a),{documents:a,ks:o})))}function O7(n,e,t){let i=n.Ms.get(e)||Qe.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ms.set(e,i)}var pm=class{constructor(){this.activeTargetIds=X9()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Jw=class{constructor(){this.vo=new pm,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new pm,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Zw=class{Mo(e){}shutdown(){}};var tP="ConnectivityMonitor",gm=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){we(tP,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){we(tP,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var zg=null;function Xw(){return zg===null?zg=(function(){return 268435456+Math.round(2147483648*Math.random())})():zg++,"0x"+zg.toString(16)}var qb="RestConnection",F7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},ex=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===rm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){let s=Xw(),a=this.Qo(e,t.toUriEncodedString());we(qb,`Sending RPC '${e}' ${s}:`,a,i);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,r,o);let{host:c}=new URL(a),d=as(c);return this.zo(e,a,l,i,d).then(h=>(we(qb,`Received RPC '${e}' ${s}: `,h),h),h=>{throw fs(qb,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",i),h})}jo(e,t,i,r,o,s){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),i&&i.headers.forEach((r,o)=>e[o]=r)}Qo(e,t){let i=F7[e],r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}};var tx=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Bn="WebChannelConnection",Ed=(n,e,t)=>{n.listen(e,i=>{try{t(i)}catch(r){setTimeout(()=>{throw r},0)}})},mm=class n extends ex{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=$b();Ed(e,Hb.STAT_EVENT,t=>{t.stat===Hg.PROXY?we(Bn,"STAT_EVENT: detected buffering proxy"):t.stat===Hg.NOPROXY&&we(Bn,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,i,r,o){let s=Xw();return new Promise((a,l)=>{let c=new Bb;c.setWithCredentials(!0),c.listenOnce(jb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case _d.NO_ERROR:let h=c.getResponseJson();we(Bn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case _d.TIMEOUT:we(Bn,`RPC '${e}' ${s} timed out`),l(new de(K.DEADLINE_EXCEEDED,"Request time out"));break;case _d.HTTP_ERROR:let p=c.getStatus();if(we(Bn,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let x=g?.error;if(x&&x.status&&x.message){let S=(function(U){let se=U.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(se)>=0?se:K.UNKNOWN})(x.status);l(new de(S,x.message))}else l(new de(K.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new de(K.UNAVAILABLE,"Connection failed."));break;default:Fe(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{we(Bn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);we(Bn,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",d,i,15)})}T_(e,t,i){let r=Xw(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;let c=o.join("");we(Bn,`Creating RPC '${e}' stream ${r}: ${c}`,a);let d=s.createWebChannel(c,a);this.I_(d);let h=!1,p=!1,g=new tx({Ho:x=>{p?we(Bn,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(h||(we(Bn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),we(Bn,`RPC '${e}' stream ${r} sending:`,x),d.send(x))},Jo:()=>d.close()});return Ed(d,Ul.EventType.OPEN,()=>{p||(we(Bn,`RPC '${e}' stream ${r} transport opened.`),g.i_())}),Ed(d,Ul.EventType.CLOSE,()=>{p||(p=!0,we(Bn,`RPC '${e}' stream ${r} transport closed`),g.o_(),this.E_(d))}),Ed(d,Ul.EventType.ERROR,x=>{p||(p=!0,fs(Bn,`RPC '${e}' stream ${r} transport errored. Name:`,x.name,"Message:",x.message),g.o_(new de(K.UNAVAILABLE,"The operation could not be completed")))}),Ed(d,Ul.EventType.MESSAGE,x=>{if(!p){let S=x.data[0];Et(!!S,16349);let N=S,U=N?.error||N[0]?.error;if(U){we(Bn,`RPC '${e}' stream ${r} received error:`,U);let se=U.status,Se=(function(Ie){let k=hn[Ie];if(k!==void 0)return lN(k)})(se),xe=U.message;Se===void 0&&(Se=K.INTERNAL,xe="Unknown error status: "+se+" with message "+U.message),p=!0,g.o_(new de(Se,xe)),d.close()}else we(Bn,`RPC '${e}' stream ${r} received:`,S),g.__(S)}}),n.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Gb()}};function L7(n){return new mm(n)}function Kb(){return typeof document<"u"?document:null}function jd(n){return new xw(n,!0)}mm.c_=!1;var ym=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&we("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var nP="PersistentStream",vm=class{constructor(e,t,i,r,o,s,a,l){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ym(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===K.RESOURCE_EXHAUSTED?(vo(t.toString()),vo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{let r=new de(K.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){let i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return we(nP,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(we(nP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},nx=class extends vm{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=g7(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Qe.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Qe.min():s.readTime?Lr(s.readTime):Qe.min()})(e);return this.listener.J_(t,i)}Z_(e){let t={};t.database=Cw(this.serializer),t.addTarget=(function(o,s){let a,l=s.target;if(a=fw(l)?{documents:v7(o,l)}:{query:_7(o,l).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=cN(o,s.resumeToken);let c=Sw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(Qe.min())>0){a.readTime=um(o,s.snapshotVersion.toTimestamp());let c=Sw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);let i=b7(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){let t={};t.database=Cw(this.serializer),t.removeTarget=e,this.K_(t)}},ix=class extends vm{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=y7(e.writeResults,e.commitTime),i=Lr(e.commitTime);return this.listener.na(i,t)}ra(){let e={};e.database=Cw(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>m7(this.serializer,i))};this.K_(t)}};var rx=class{},ox=class extends rx{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new de(K.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,Iw(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new de(K.UNKNOWN,o.toString())})}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,Iw(t,i),r,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new de(K.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function V7(n,e,t,i){return new ox(n,e,t,i)}var sx=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vo(t),this.aa=!1):we("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Ma="RemoteStore",ax=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{i.enqueueAndForget(async()=>{ka(this)&&(we(Ma,"Restarting streams for network reachability change."),await(async function(l){let c=ze(l);c.Ea.add(4),await Hd(c),c.Va.set("Unknown"),c.Ea.delete(4),await km(c)})(this))})}),this.Va=new sx(i,r)}};async function km(n){if(ka(n))for(let e of n.Ra)await e(!0)}async function Hd(n){for(let e of n.Ra)await e(!1)}function bN(n,e){let t=ze(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ux(t)?Vx(t):ac(t).O_()&&Lx(t,e))}function Fx(n,e){let t=ze(n),i=ac(t);t.Ia.delete(e),i.O_()&&wN(t,e),t.Ia.size===0&&(i.O_()?i.L_():ka(t)&&t.Va.set("Unknown"))}function Lx(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ac(n).Z_(e)}function wN(n,e){n.da.$e(e),ac(n).X_(e)}function Vx(n){n.da=new ww({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ac(n).start(),n.Va.ua()}function Ux(n){return ka(n)&&!ac(n).x_()&&n.Ia.size>0}function ka(n){return ze(n).Ea.size===0}function xN(n){n.da=void 0}async function U7(n){n.Va.set("Online")}async function B7(n){n.Ia.forEach((e,t)=>{Lx(n,e)})}async function j7(n,e){xN(n),Ux(n)?(n.Va.ha(e),Vx(n)):n.Va.set("Unknown")}async function H7(n,e,t){if(n.Va.set("Online"),e instanceof lm&&e.state===2&&e.cause)try{await(async function(r,o){let s=o.cause;for(let a of o.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.da.removeTarget(a))})(n,e)}catch(i){we(Ma,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await _m(n,i)}else if(e instanceof zl?n.da.Xe(e):e instanceof am?n.da.st(e):n.da.tt(e),!t.isEqual(Qe.min()))try{let i=await EN(n.localStore);t.compareTo(i)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.Ia.get(c);d&&o.Ia.set(c,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{let d=o.Ia.get(l);if(!d)return;o.Ia.set(l,d.withResumeToken(On.EMPTY_BYTE_STRING,d.snapshotVersion)),wN(o,l);let h=new Nd(d.target,l,c,d.sequenceNumber);Lx(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){we(Ma,"Failed to raise snapshot:",i),await _m(n,i)}}async function _m(n,e,t){if(!sc(e))throw e;n.Ea.add(1),await Hd(n),n.Va.set("Offline"),t||(t=()=>EN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{we(Ma,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await km(n)})}function SN(n,e){return e().catch(t=>_m(n,t,e))}async function Om(n){let e=ze(n),t=ms(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Tx;for(;$7(e);)try{let r=await N7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,G7(e,r)}catch(r){await _m(e,r)}IN(e)&&TN(e)}function $7(n){return ka(n)&&n.Ta.length<10}function G7(n,e){n.Ta.push(e);let t=ms(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function IN(n){return ka(n)&&!ms(n).x_()&&n.Ta.length>0}function TN(n){ms(n).start()}async function z7(n){ms(n).ra()}async function W7(n){let e=ms(n);for(let t of n.Ta)e.ea(t.mutations)}async function q7(n,e,t){let i=n.Ta.shift(),r=vw.from(i,e,t);await SN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Om(n)}async function K7(n,e){e&&ms(n).Y_&&await(async function(i,r){if((function(s){return s7(s)&&s!==K.ABORTED})(r.code)){let o=i.Ta.shift();ms(i).B_(),await SN(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Om(i)}})(n,e),IN(n)&&TN(n)}async function iP(n,e){let t=ze(n);t.asyncQueue.verifyOperationInProgress(),we(Ma,"RemoteStore received new credentials");let i=ka(t);t.Ea.add(3),await Hd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await km(t)}async function Y7(n,e){let t=ze(n);e?(t.Ea.delete(2),await km(t)):e||(t.Ea.add(2),await Hd(t),t.Va.set("Unknown"))}function ac(n){return n.ma||(n.ma=(function(t,i,r){let o=ze(t);return o.sa(),new nx(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:U7.bind(null,n),Yo:B7.bind(null,n),t_:j7.bind(null,n),J_:H7.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),Ux(n)?Vx(n):n.Va.set("Unknown")):(await n.ma.stop(),xN(n))})),n.ma}function ms(n){return n.fa||(n.fa=(function(t,i,r){let o=ze(t);return o.sa(),new ix(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:z7.bind(null,n),t_:K7.bind(null,n),ta:W7.bind(null,n),na:q7.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Om(n)):(await n.fa.stop(),n.Ta.length>0&&(we(Ma,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var lx=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new kr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,a=new n(e,t,s,r,o);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Bx(n,e){if(vo("AsyncQueue",`${e}: ${n}`),sc(n))return new de(K.UNAVAILABLE,`${e}: ${n}`);throw n}var Fd=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Pe.comparator(t.key,i.key):(t,i)=>Pe.comparator(t.key,i.key),this.keyedMap=bd(),this.sortedSet=new Yt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Em=class{constructor(){this.ga=new Yt(Pe.comparator)}track(e){let t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Fe(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}},Ra=class n{constructor(e,t,i,r,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Fd.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var cx=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},ux=class{constructor(){this.queries=rP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){let r=ze(t),o=r.queries;r.queries=rP(),o.forEach((s,a)=>{for(let l of a.ba)l.onError(i)})})(this,new de(K.ABORTED,"Firestore shutting down"))}};function rP(){return new xo(n=>QP(n),Pm)}async function Q7(n,e){let t=ze(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new cx,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(s){let a=Bx(s,`Initialization of query '${jl(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&jx(t)}async function J7(n,e){let t=ze(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Z7(n,e){let t=ze(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(r)&&(i=!0);s.wa=r}}i&&jx(t)}function X7(n,e,t){let i=ze(n),r=i.queries.get(e);if(r)for(let o of r.ba)o.onError(t);i.queries.delete(e)}function jx(n){n.Ca.forEach(e=>{e.next()})}var dx,oP;(oP=dx||(dx={})).Ma="default",oP.Cache="cache";var hx=class{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ra(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ra.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==dx.Cache}};var bm=class{constructor(e){this.key=e}},wm=class{constructor(e){this.key=e}},fx=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=tt(),this.mutatedKeys=tt(),this.eu=JP(e),this.tu=new Fd(this.eu)}get nu(){return this.Za}ru(e,t){let i=t?t.iu:new Em,r=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{let p=r.get(d),g=Nm(this.query,h)?h:null,x=!!p&&this.mutatedKeys.has(p.key),S=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),N=!1;p&&g?p.data.isEqual(g.data)?x!==S&&(i.track({type:3,doc:g}),N=!0):this.su(p,g)||(i.track({type:2,doc:g}),N=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!p&&g?(i.track({type:0,doc:g}),N=!0):p&&!g&&(i.track({type:1,doc:p}),N=!0,(l||c)&&(a=!0)),N&&(g?(s=s.add(g),o=S?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),i.track({type:1,doc:d})}return{tu:s,iu:i,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,h)=>(function(g,x){let S=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fe(20277,{Vt:N})}};return S(g)-S(x)})(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(i),r=r??!1;let a=t&&!r?this._u():[],l=this.Ya.size===0&&this.current&&!r?1:0,c=l!==this.Xa;return this.Xa=l,s.length!==0||c?{snapshot:new Ra(this.query,e.tu,o,s,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Em,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=tt(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});let t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new wm(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new bm(i))}),t}cu(e){this.Za=e.ks,this.Ya=tt();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ra.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},Hx="SyncEngine",px=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},gx=class{constructor(e){this.key=e,this.hu=!1}},mx=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new xo(a=>QP(a),Pm),this.Iu=new Map,this.Eu=new Set,this.Ru=new Yt(Pe.comparator),this.Au=new Map,this.Vu=new Od,this.du={},this.mu=new Map,this.fu=kd.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function eH(n,e,t=!0){let i=PN(n),r,o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await CN(i,e,t,!0),r}async function tH(n,e){let t=PN(n);await CN(t,e,!0,!1)}async function CN(n,e,t,i){let r=await k7(n.localStore,Fr(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return i&&(a=await nH(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&bN(n.remoteStore,r),a}async function nH(n,e,t,i,r){n.pu=(h,p,g)=>(async function(S,N,U,se){let Se=N.view.ru(U);Se.Ss&&(Se=await eP(S.localStore,N.query,!1).then(({documents:k})=>N.view.ru(k,Se)));let xe=se&&se.targetChanges.get(N.targetId),Ae=se&&se.targetMismatches.get(N.targetId)!=null,Ie=N.view.applyChanges(Se,S.isPrimaryClient,xe,Ae);return aP(S,N.targetId,Ie.au),Ie.snapshot})(n,h,p,g);let o=await eP(n.localStore,e,!0),s=new fx(e,o.ks),a=s.ru(o.documents),l=Pd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),c=s.applyChanges(a,n.isPrimaryClient,l);aP(n,t,c.au);let d=new px(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function iH(n,e,t){let i=ze(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter(s=>!Pm(s,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Qw(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Fx(i.remoteStore,r.targetId),yx(i,r.targetId)}).catch(oc)):(yx(i,r.targetId),await Qw(i.localStore,r.targetId,!0))}async function rH(n,e){let t=ze(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Fx(t.remoteStore,i.targetId))}async function oH(n,e,t){let i=hH(n);try{let r=await(function(s,a){let l=ze(s),c=on.now(),d=a.reduce((g,x)=>g.add(x.key),tt()),h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=So(),S=tt();return l.xs.getEntries(g,d).next(N=>{x=N,x.forEach((U,se)=>{se.isValidDocument()||(S=S.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,x)).next(N=>{h=N;let U=[];for(let se of a){let Se=o7(se,h.get(se.key).overlayedDocument);Se!=null&&U.push(new Io(se.key,Se,HP(Se.value.mapValue),hs.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,U,a)}).next(N=>{p=N;let U=N.applyToLocalDocumentSet(h,S);return l.documentOverlayCache.saveOverlays(g,N.batchId,U)})}).then(()=>({batchId:p.batchId,changes:XP(h)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(s,a,l){let c=s.du[s.currentUser.toKey()];c||(c=new Yt(rt)),c=c.insert(a,l),s.du[s.currentUser.toKey()]=c})(i,r.batchId,t),await $d(i,r.changes),await Om(i.remoteStore)}catch(r){let o=Bx(r,"Failed to persist write");t.reject(o)}}async function DN(n,e){let t=ze(n);try{let i=await R7(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Au.get(o);s&&(Et(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?s.hu=!0:r.modifiedDocuments.size>0?Et(s.hu,14607):r.removedDocuments.size>0&&(Et(s.hu,42227),s.hu=!1))}),await $d(t,i,e)}catch(i){await oc(i)}}function sP(n,e,t){let i=ze(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(s,a){let l=ze(s);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(let p of h.ba)p.va(a)&&(c=!0)}),c&&jx(l)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function sH(n,e,t){let i=ze(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Au.get(e),o=r&&r.key;if(o){let s=new Yt(Pe.comparator);s=s.insert(o,rr.newNoDocument(o,Qe.min()));let a=tt().add(o),l=new sm(Qe.min(),new Map,new Yt(rt),s,a);await DN(i,l),i.Ru=i.Ru.remove(o),i.Au.delete(e),$x(i)}else await Qw(i.localStore,e,!1).then(()=>yx(i,e,t)).catch(oc)}async function aH(n,e){let t=ze(n),i=e.batch.batchId;try{let r=await M7(t.localStore,e);MN(t,i,null),AN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await $d(t,r)}catch(r){await oc(r)}}async function lH(n,e,t){let i=ze(n);try{let r=await(function(s,a){let l=ze(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Et(h!==null,37113),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})})(i.localStore,e);MN(i,e,t),AN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await $d(i,r)}catch(r){await oc(r)}}function AN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function MN(n,e,t){let i=ze(n),r=i.du[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function yx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(i=>{n.Vu.containsKey(i)||RN(n,i)})}function RN(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(Fx(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),$x(n))}function aP(n,e,t){for(let i of t)i instanceof bm?(n.Vu.addReference(i.key,e),cH(n,i)):i instanceof wm?(we(Hx,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||RN(n,i.key)):Fe(19791,{wu:i})}function cH(n,e){let t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(we(Hx,"New document in limbo: "+t),n.Eu.add(i),$x(n))}function $x(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new Pe(Rt.fromString(e)),i=n.fu.next();n.Au.set(i,new gx(t)),n.Ru=n.Ru.insert(t,i),bN(n.remoteStore,new Nd(Fr(Px(t.path)),i,"TargetPurposeLimboResolution",Ix.ce))}}async function $d(n,e,t){let i=ze(n),r=[],o=[],s=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{s.push(i.pu(l,e,t).then(c=>{if((c||t)&&i.isPrimaryClient){let d=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){r.push(c);let d=Ww.Es(l.targetId,c);o.push(d)}}))}),await Promise.all(s),i.Pu.J_(r),await(async function(l,c){let d=ze(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ee.forEach(c,p=>ee.forEach(p.Ts,g=>d.persistence.referenceDelegate.addReference(h,p.targetId,g)).next(()=>ee.forEach(p.Is,g=>d.persistence.referenceDelegate.removeReference(h,p.targetId,g)))))}catch(h){if(!sc(h))throw h;we(Ox,"Failed to update sequence numbers: "+h)}for(let h of c){let p=h.targetId;if(!h.fromCache){let g=d.vs.get(p),x=g.snapshotVersion,S=g.withLastLimboFreeSnapshotVersion(x);d.vs=d.vs.insert(p,S)}}})(i.localStore,o))}async function uH(n,e){let t=ze(n);if(!t.currentUser.isEqual(e)){we(Hx,"User change. New user:",e.toKey());let i=await _N(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(l=>{l.reject(new de(K.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await $d(t,i.Ns)}}function dH(n,e){let t=ze(n),i=t.Au.get(e);if(i&&i.hu)return tt().add(i.key);{let r=tt(),o=t.Iu.get(e);if(!o)return r;for(let s of o){let a=t.Tu.get(s);r=r.unionWith(a.view.nu)}return r}}function PN(n){let e=ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=DN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sH.bind(null,e),e.Pu.J_=Z7.bind(null,e.eventManager),e.Pu.yu=X7.bind(null,e.eventManager),e}function hH(n){let e=ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lH.bind(null,e),e}var Gx=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=jd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return A7(this.persistence,new Kw,t.initialUser,this.serializer)}Cu(t){return new hm(zw.Vi,this.serializer)}Du(t){return new Jw}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),xm=class extends Gx{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Et(this.persistence.referenceDelegate instanceof fm,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new Pw(i,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Li.withCacheSize(this.cacheSizeBytes):Li.DEFAULT;return new hm(i=>fm.Vi(i,t),this.serializer)}};var NN=(()=>{class n{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>sP(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=uH.bind(null,this.syncEngine),await Y7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new ux})()}createDatastore(t){let i=jd(t.databaseInfo.databaseId),r=L7(t.databaseInfo);return V7(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,s,a,l){return new ax(r,o,s,a,l)})(this.localStore,this.datastore,t.asyncQueue,i=>sP(this.syncEngine,i,0),(function(){return gm.v()?new gm:new Zw})())}createSyncEngine(t,i){return(function(o,s,a,l,c,d,h){let p=new mx(o,s,a,l,c,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){let r=ze(i);we(Ma,"RemoteStore shutting down."),r.Ea.add(5),await Hd(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var vx=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vo("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var ys="FirestoreClient",_x=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=Cn.UNAUTHENTICATED,this.clientId=Sa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async s=>{we(ys,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(we(ys,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new kr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Bx(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}};async function Yb(n,e){n.asyncQueue.verifyOperationInProgress(),we(ys,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await _N(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function lP(n,e){n.asyncQueue.verifyOperationInProgress();let t=await fH(n);we(ys,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>iP(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>iP(e.remoteStore,r)),n._onlineComponents=e}async function fH(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){we(ys,"Using user provided OfflineComponentProvider");try{await Yb(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===K.FAILED_PRECONDITION||r.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;fs("Error using user provided cache. Falling back to memory cache: "+t),await Yb(n,new Gx)}}else we(ys,"Using default OfflineComponentProvider"),await Yb(n,new xm(void 0));return n._offlineComponents}async function kN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(we(ys,"Using user provided OnlineComponentProvider"),await lP(n,n._uninitializedComponentsProvider._online)):(we(ys,"Using default OnlineComponentProvider"),await lP(n,new NN))),n._onlineComponents}function pH(n){return kN(n).then(e=>e.syncEngine)}async function gH(n){let e=await kN(n),t=e.eventManager;return t.onListen=eH.bind(null,e.syncEngine),t.onUnlisten=iH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=rH.bind(null,e.syncEngine),t}function ON(n,e,t={}){let i=new kr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new vx({next:p=>{d.Nu(),s.enqueueAndForget(()=>J7(o,h)),p.fromCache&&l.source==="server"?c.reject(new de(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new hx(a,d,{includeMetadataChanges:!0,Ka:!0});return Q7(o,h)})(await gH(n),n.asyncQueue,e,t,i)),i.promise}function FN(n,e){let t=new kr;return n.asyncQueue.enqueueAndForget(async()=>oH(await pH(n),e,t)),t.promise}function LN(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var mH="ComponentProvider",cP=new Map;function yH(n,e,t,i,r){return new tw(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,LN(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}var VN="firestore.googleapis.com",uP=!0,Sm=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new de(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=VN,this.ssl=uP}else this.host=e.host,this.ssl=e.ssl??uP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<T7)throw new de(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=LN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new de(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new de(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new de(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Xl=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sm(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Qg;switch(i.type){case"firstParty":return new Zb(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new de(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=cP.get(t);i&&(we(mH,"Removing Datastore"),cP.delete(t),i.terminate())})(this),Promise.resolve()}};function UN(n,e,t,i={}){n=ic(n,Xl);let r=as(e),o=n._getSettings(),s=ue(F({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;r&&(Og(`https://${a}`),Fg("Firestore",!0)),o.host!==VN&&o.host!==a&&fs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=ue(F({},o),{host:a,ssl:r,emulatorOptions:i});if(!nr(l,s)&&(n._setSettings(l),i.mockUserToken)){let c,d;if(typeof i.mockUserToken=="string")c=i.mockUserToken,d=Cn.MOCK_USER;else{c=n2(i.mockUserToken,n._app?.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new de(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Cn(h)}n._authCredentials=new Qb(new Yg(c,d))}}var or=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},kn=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(rc(t,n._jsonSchema))return new n(e,i||null,new Pe(Rt.fromString(t.referencePath)))}};kn._jsonSchemaVersion="firestore/documentReference/1.0",kn._jsonSchema={type:rn("string",kn._jsonSchemaVersion),referencePath:rn("string")};var mo=class n extends or{constructor(e,t,i){super(e,t,Px(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new Pe(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function wi(n,e,...t){if(n=Tn(n),gP("collection","path",e),n instanceof Xl){let i=Rt.fromString(e,...t);return M2(i),new mo(n,null,i)}{if(!(n instanceof kn||n instanceof mo))throw new de(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Rt.fromString(e,...t));return M2(i),new mo(n.firestore,null,i)}}function zx(n,e,...t){if(n=Tn(n),arguments.length===1&&(e=Sa.newId()),gP("doc","path",e),n instanceof Xl){let i=Rt.fromString(e,...t);return A2(i),new kn(n,null,new Pe(i))}{if(!(n instanceof kn||n instanceof mo))throw new de(K.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Rt.fromString(e,...t));return A2(i),new kn(n.firestore,n instanceof mo?n.converter:null,new Pe(i))}}var dP="AsyncQueue",Im=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ym(this,"async_queue_retry"),this._c=()=>{let i=Kb();i&&we(dP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;let t=Kb();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Kb();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new kr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!sc(e))throw e;we(dP,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,vo("INTERNAL UNHANDLED ERROR: ",hP(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=lx.createAndSchedule(this,e,t,i,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&Fe(47125,{Pc:hP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function hP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Pa=class extends Xl{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Im,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Im(e),this._firestoreClient=void 0,await e}}};function Gd(n,e){let t=typeof n=="object"?n:Bg(),i=typeof n=="string"?n:e||rm,r=yd(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let o=t2("firestore");o&&UN(r,...o)}return r}function Fm(n){if(n._terminated)throw new de(K.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||vH(n),n._firestoreClient}function vH(n){let e=n._freezeSettings(),t=yH(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new _x(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}var Vr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(On.fromBase64String(e))}catch(t){throw new de(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(rc(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Vr._jsonSchemaVersion="firestore/bytes/1.0",Vr._jsonSchema={type:rn("string",Vr._jsonSchemaVersion),bytes:rn("string")};var ec=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ii(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var tc=class{constructor(e){this._methodName=e}};var yo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return rt(this._lat,e._lat)||rt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(rc(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};yo._jsonSchemaVersion="firestore/geoPoint/1.0",yo._jsonSchema={type:rn("string",yo._jsonSchemaVersion),latitude:rn("number"),longitude:rn("number")};var Ur=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(rc(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new de(K.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Ur._jsonSchemaVersion="firestore/vectorValue/1.0",Ur._jsonSchema={type:rn("string",Ur._jsonSchemaVersion),vectorValues:rn("object")};var _H=/^__.*__$/,Ex=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Io(e,this.data,this.fieldMask,t,this.fieldTransforms):new Aa(e,this.data,t,this.fieldTransforms)}};function BN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fe(40011,{dataSource:n})}}var bx=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(F(F({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Tm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(BN(this.dataSource)&&_H.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},wx=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||jd(e)}createContext(e,t,i,r=!1){return new bx({dataSource:e,methodName:t,targetDoc:i,path:ii.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Lm(n){let e=n._freezeSettings(),t=jd(n._databaseId);return new wx(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jN(n,e,t,i,r,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);GN("Data must be an object, but it was:",s,i);let a=HN(i,s),l,c;if(o.merge)l=new Nr(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let p=lc(e,h,t);if(!s.contains(p))throw new de(K.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);bH(d,p)||d.push(p)}l=new Nr(d),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new Ex(new Vi(a),l,c)}var xx=class n extends tc{_toFieldTransform(e){return new pw(e.path,new Ta)}isEqual(e){return e instanceof n}};function Wx(n,e,t,i=!1){return qx(t,n.createContext(i?4:3,e))}function qx(n,e){if($N(n=Tn(n)))return GN("Unsupported field value:",e,n),HN(n,e);if(n instanceof tc)return(function(i,r){if(!BN(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){let o=[],s=0;for(let a of i){let l=qx(a,r.childContextForArray(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Tn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return e7(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=on.fromDate(i);return{timestampValue:um(r.serializer,o)}}if(i instanceof on){let o=new on(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:um(r.serializer,o)}}if(i instanceof yo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Vr)return{bytesValue:cN(r.serializer,i._byteString)};if(i instanceof kn){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:kx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ur)return(function(s,a){let l=s instanceof Ur?s.toArray():s;return{mapValue:{fields:{[Cx]:{stringValue:Dx},[ql]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return Nx(a.serializer,d)})}}}}}})(i,r);if(mN(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Vd(i)}`)})(n,e)}function HN(n,e){let t={};return NP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Na(n,(i,r)=>{let o=qx(r,e.childContextForField(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function $N(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof on||n instanceof yo||n instanceof Vr||n instanceof kn||n instanceof tc||n instanceof Ur||mN(n))}function GN(n,e,t){if(!$N(t)||!yP(t)){let i=Vd(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function lc(n,e,t){if((e=Tn(e))instanceof ec)return e._internalPath;if(typeof e=="string")return zN(n,e);throw Tm("Field path arguments must be of type string or ",n,!1,void 0,t)}var EH=new RegExp("[~\\*/\\[\\]]");function zN(n,e,t){if(e.search(EH)>=0)throw Tm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ec(...e.split("."))._internalPath}catch{throw Tm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Tm(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new de(K.INVALID_ARGUMENT,a+n+l)}function bH(n,e){return n.some(t=>t.isEqual(e))}var Ld=class{convertValue(e,t="none"){switch(ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Eo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Fe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Na(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){let t=e.fields?.[ql].arrayValue?.values?.map(i=>Ht(i.doubleValue));return new Ur(t)}convertGeoPoint(e){return new yo(Ht(e.latitude),Ht(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Am(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Cd(e));default:return null}}convertTimestamp(e){let t=_o(e);return new on(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Rt.fromString(e);Et(gN(i),9688,{name:e});let r=new Dd(i.get(1),i.get(3)),o=new Pe(i.popFirst(5));return r.isEqual(t)||vo(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var Cm=class extends Ld{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,t)}};function zd(){return new xx("serverTimestamp")}var WN="@firebase/firestore",qN="4.10.0";var Wd=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Kx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(lc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Kx=class extends Wd{data(){return super.data()}};function IH(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var qd=class{},fc=class extends qd{};function To(n,e,...t){let i=[];e instanceof qd&&i.push(e),i=i.concat(t),(function(o){let s=o.filter(l=>l instanceof Yx).length,a=o.filter(l=>l instanceof Vm).length;if(s>1||s>0&&a>0)throw new de(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var Vm=class n extends fc{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return JN(e._query,t),new or(e.firestore,e.converter,Rm(e._query,t))}_parse(e){let t=Lm(e.firestore);return(function(o,s,a,l,c,d,h){let p;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new de(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){YN(h,d);let x=[];for(let S of h)x.push(KN(l,o,S));p={arrayValue:{values:x}}}else p=KN(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||YN(h,d),p=Wx(a,s,h,d==="in"||d==="not-in");return nn.create(c,d,p)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function vs(n,e,t){let i=e,r=lc("where",n);return Vm._create(r,i,t)}var Yx=class n extends qd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Ui.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let s=r,a=o.getFlattenedFilters();for(let l of a)JN(s,l),s=Rm(s,l)})(e._query,t),new or(e.firestore,e.converter,Rm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Qx=class n extends fc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(r,o,s){if(r.startAt!==null)throw new de(K.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new de(K.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new gs(o,s)})(e._query,this._field,this._direction);return new or(e.firestore,e.converter,KP(e._query,t))}};function sr(n,e="asc"){let t=e,i=lc("orderBy",n);return Qx._create(i,t)}var Jx=class n extends fc{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new or(e.firestore,e.converter,Md(e._query,this._limit,this._limitType))}};function _s(n){return vP("limit",n),Jx._create("limit",n,"F")}var Zx=class n extends fc{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=TH(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,YP(e._query,t))}};function QN(...n){return Zx._create("startAfter",n,!1)}function TH(n,e,t,i){if(t[0]=Tn(t[0]),t[0]instanceof Wd)return(function(o,s,a,l,c){if(!l)throw new de(K.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of wa(o))if(h.field.isKeyField())d.push(Bd(s,l.key));else{let p=l.data.field(h.field);if(Ud(p))throw new de(K.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let g=h.field.canonicalString();throw new de(K.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(p)}return new bo(d,c)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Lm(n.firestore);return(function(s,a,l,c,d,h){let p=s.explicitOrderBy;if(d.length>p.length)throw new de(K.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let x=0;x<d.length;x++){let S=d[x];if(p[x].field.isKeyField()){if(typeof S!="string")throw new de(K.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof S}`);if(!Mm(s)&&S.indexOf("/")!==-1)throw new de(K.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${S}' contains a slash.`);let N=s.path.child(Rt.fromString(S));if(!Pe.isDocumentKey(N))throw new de(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let U=new Pe(N);g.push(Bd(a,U))}else{let N=Wx(l,c,S);g.push(N)}}return new bo(g,h)})(n._query,n.firestore._databaseId,r,e,t,i)}}function KN(n,e,t){if(typeof(t=Tn(t))=="string"){if(t==="")throw new de(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mm(e)&&t.indexOf("/")!==-1)throw new de(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Rt.fromString(t));if(!Pe.isDocumentKey(i))throw new de(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Bd(n,new Pe(i))}if(t instanceof kn)return Bd(n,t._key);throw new de(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vd(t)}.`)}function YN(n,e){if(!Array.isArray(n)||n.length===0)throw new de(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function JN(n,e){let t=(function(r,o){for(let s of r)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new de(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function CH(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var cc=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},uc=class n extends Wd{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new dc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(lc("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new de(K.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};uc._jsonSchemaVersion="firestore/documentSnapshot/1.0",uc._jsonSchema={type:rn("string",uc._jsonSchemaVersion),bundleSource:rn("string","DocumentSnapshot"),bundleName:rn("string"),bundle:rn("string")};var dc=class extends uc{data(e={}){return super.data(e)}},hc=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new cc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new dc(this._firestore,this._userDataWriter,i.key,i,new cc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{let l=new dc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new dc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),c=-1,d=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:DH(a.type),doc:l,oldIndex:c,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new de(K.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sa.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function DH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fe(61501,{type:n})}}hc._jsonSchemaVersion="firestore/querySnapshot/1.0",hc._jsonSchema={type:rn("string",hc._jsonSchemaVersion),bundleSource:rn("string","QuerySnapshot"),bundleName:rn("string"),bundle:rn("string")};function Es(n){n=ic(n,or);let e=ic(n.firestore,Pa),t=Fm(e),i=new Cm(e);return IH(n._query),ON(t,n._query).then(r=>new hc(e,i,n,r))}function Kd(n,e){let t=ic(n.firestore,Pa),i=zx(n),r=CH(n.converter,e),o=Lm(n.firestore);return AH(t,[jN(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,hs.exists(!1))]).then(()=>i)}function AH(n,e){let t=Fm(n);return FN(t,e)}(function(e,t=!0){fP(ds),us(new Fi("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),a=new Pa(new Jg(i.getProvider("auth-internal")),new Xg(s,i.getProvider("app-check-internal")),VP(s,r),s);return o=F({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),ir(WN,qN,e),ir(WN,qN,"esm2020")})();function hk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var fk=hk,pk=new ho("auth","Firebase",hk());var Gm=new ls("@firebase/auth");function MH(n,...e){Gm.logLevel<=et.WARN&&Gm.warn(`Auth (${ds}): ${n}`,...e)}function Bm(n,...e){Gm.logLevel<=et.ERROR&&Gm.error(`Auth (${ds}): ${n}`,...e)}function Hr(n,...e){throw m1(n,...e)}function ar(n,...e){return m1(n,...e)}function g1(n,e,t){let i=ue(F({},fk()),{[e]:t});return new ho("auth","Firebase",i).create(e,{appName:n.name})}function Oa(n){return g1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function RH(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Hr(n,"argument-error"),g1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function m1(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return pk.create(n,...e)}function je(n,e,...t){if(!n)throw m1(e,...t)}function Co(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Bm(e),new Error(e)}function Ao(n,e){n||Co(e)}function t1(){return typeof self<"u"&&self.location?.href||""}function PH(){return ZN()==="http:"||ZN()==="https:"}function ZN(){return typeof self<"u"&&self.location?.protocol||null}function NH(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PH()||o2()||"connection"in navigator)?navigator.onLine:!0}function kH(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Fa=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ao(t>e,"Short delay should be less than long delay!"),this.isMobile=i2()||s2()}get(){return NH()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function y1(n,e){Ao(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var zm=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Co("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Co("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Co("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var OH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var FH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],LH=new Fa(3e4,6e4);function v1(n,e){return n.tenantId&&!e.tenantId?ue(F({},e),{tenantId:n.tenantId}):e}async function gc(n,e,t,i,r={}){return gk(n,r,async()=>{let o={},s={};i&&(e==="GET"?s=i:o={body:JSON.stringify(i)});let a=Vl(F({key:n.config.apiKey},s)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let c=F({method:e,headers:l},o);return r2()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&as(n.emulatorConfig.host)&&(c.credentials="include"),zm.fetch()(await mk(n,n.config.apiHost,t,a),c)})}async function gk(n,e,t){n._canInitEmulator=!1;let i=F(F({},OH),e);try{let r=new n1(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw Um(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Um(n,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw Um(n,"email-already-in-use",s);if(l==="USER_DISABLED")throw Um(n,"user-disabled",s);let d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw g1(n,d,c);Hr(n,d)}}catch(r){if(r instanceof Ei)throw r;Hr(n,"network-request-failed",{message:String(r)})}}async function VH(n,e,t,i,r={}){let o=await gc(n,e,t,i,r);return"mfaPendingCredential"in o&&Hr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function mk(n,e,t,i){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?y1(n.config,r):`${n.config.apiScheme}://${r}`;return FH.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var n1=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ar(this.auth,"network-request-failed")),LH.get())})}};function Um(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=ar(n,e,i);return r.customData._tokenResponse=t,r}async function UH(n,e){return gc(n,"POST","/v1/accounts:delete",e)}async function Wm(n,e){return gc(n,"POST","/v1/accounts:lookup",e)}function Yd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yk(n,e=!1){let t=Tn(n),i=await t.getIdToken(e),r=_1(i);je(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:Yd(Xx(r.auth_time)),issuedAtTime:Yd(Xx(r.iat)),expirationTime:Yd(Xx(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Xx(n){return Number(n)*1e3}function _1(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Bm("JWT malformed, contained fewer than 3 sections"),null;try{let r=Ng(t);return r?JSON.parse(r):(Bm("Failed to decode base64 JWT payload"),null)}catch(r){return Bm("Caught error parsing JWT payload as JSON",r?.toString()),null}}function XN(n){let e=_1(n);return je(e,"internal-error"),je(typeof e.exp<"u","internal-error"),je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Jd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ei&&BH(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function BH({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var i1=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Zd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yd(this.lastLoginAt),this.creationTime=Yd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function qm(n){let e=n.auth,t=await n.getIdToken(),i=await Jd(n,Wm(e,{idToken:t}));je(i?.users.length,e,"internal-error");let r=i.users[0];n._notifyReloadListener(r);let o=r.providerUserInfo?.length?_k(r.providerUserInfo):[],s=jH(n.providerData,o),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!s?.length,c=a?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Zd(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(n,d)}async function vk(n){let e=Tn(n);await qm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jH(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function _k(n){return n.map(i=>{var r=i,{providerId:e}=r,t=$a(r,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function HH(n,e){let t=await gk(n,{},async()=>{let i=Vl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=await mk(n,r,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return n.emulatorConfig&&as(n.emulatorConfig.host)&&(l.credentials="include"),zm.fetch()(s,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function $H(n,e){return gc(n,"POST","/v2/accounts:revokeToken",v1(n,e))}var Qd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){je(e.idToken,"internal-error"),je(typeof e.idToken<"u","internal-error"),je(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):XN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){je(e.length!==0,"internal-error");let t=XN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:r,expiresIn:o}=await HH(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n;return i&&(je(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(je(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(je(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Co("not implemented")}};function bs(n,e){je(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ws=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:i}=s,r=$a(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new i1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Zd(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await Jd(this,this.stsTokenManager.getToken(this.auth,e));return je(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return yk(this,e)}reload(){return vk(this)}_assign(e){this!==e&&(je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>F({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(ue(F({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await qm(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bi(this.auth.app))return Promise.reject(Oa(this.auth));let e=await this.getIdToken();return await Jd(this,UH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return ue(F({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>F({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:h,emailVerified:p,isAnonymous:g,providerData:x,stsTokenManager:S}=t;je(h&&S,e,"internal-error");let N=Qd.fromJSON(this.name,S);je(typeof h=="string",e,"internal-error"),bs(i,e.name),bs(r,e.name),je(typeof p=="boolean",e,"internal-error"),je(typeof g=="boolean",e,"internal-error"),bs(o,e.name),bs(s,e.name),bs(a,e.name),bs(l,e.name),bs(c,e.name),bs(d,e.name);let U=new n({uid:h,auth:e,email:r,emailVerified:p,displayName:i,isAnonymous:g,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:N,createdAt:c,lastLoginAt:d});return x&&Array.isArray(x)&&(U.providerData=x.map(se=>F({},se))),l&&(U._redirectEventId=l),U}static async _fromIdTokenResponse(e,t,i=!1){let r=new Qd;r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await qm(o),o}static async _fromGetAccountInfoResponse(e,t,i){let r=t.users[0];je(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?_k(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,a=new Qd;a.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Zd(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(l,c),l}};var ek=new Map;function Do(n){Ao(n instanceof Function,"Expected a class definition");let e=ek.get(n);return e?(Ao(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ek.set(n,e),e)}var GH=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,i){this.storage[t]=i}async _get(t){let i=this.storage[t];return i===void 0?null:i}async _remove(t){delete this.storage[t]}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),r1=GH;function jm(n,e,t){return`firebase:${n}:${e}:${t}`}var Km=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=jm(this.userKey,r.apiKey,o),this.fullPersistenceKey=jm("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Wm(this.auth,{idToken:e}).catch(()=>{});return t?ws._fromGetAccountInfoResponse(this.auth,t,e):null}return ws._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new n(Do(r1),e,i);let r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c),o=r[0]||Do(r1),s=jm(i,e.config.apiKey,e.name),a=null;for(let c of t)try{let d=await c._get(s);if(d){let h;if(typeof d=="string"){let p=await Wm(e,{idToken:d}).catch(()=>{});if(!p)break;h=await ws._fromGetAccountInfoResponse(e,p,d)}else h=ws._fromJSON(e,d);c!==o&&(a=h),o=c;break}}catch{}let l=r.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,i):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==o)try{await c._remove(s)}catch{}})),new n(o,e,i))}};function tk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ek(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ik(e))return"Blackberry";if(Tk(e))return"Webos";if(bk(e))return"Safari";if((e.includes("chrome/")||wk(e))&&!e.includes("edge/"))return"Chrome";if(Sk(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Ek(n=In()){return/firefox\//i.test(n)}function bk(n=In()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wk(n=In()){return/crios\//i.test(n)}function xk(n=In()){return/iemobile/i.test(n)}function Sk(n=In()){return/android/i.test(n)}function Ik(n=In()){return/blackberry/i.test(n)}function Tk(n=In()){return/webos/i.test(n)}function E1(n=In()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function zH(n=In()){return E1(n)&&!!window.navigator?.standalone}function WH(){return a2()&&document.documentMode===10}function Ck(n=In()){return E1(n)||Sk(n)||Tk(n)||Ik(n)||/windows phone/i.test(n)||xk(n)}function Dk(n,e=[]){let t;switch(n){case"Browser":t=tk(In());break;case"Worker":t=`${tk(In())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ds}/${i}`}var o1=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=o=>new Promise((s,a)=>{try{let l=e(o);s(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}};async function qH(n,e={}){return gc(n,"GET","/v2/passwordPolicy",v1(n,e))}var KH=6,s1=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??KH,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var a1=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ym(this),this.idTokenSubscription=new Ym(this),this.beforeStateQueue=new o1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Do(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Km.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Wm(this,{idToken:e}),i=await ws._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(bi(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await qm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kH()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(bi(this.app))return Promise.reject(Oa(this));let t=e?Tn(e):null;return t&&je(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return bi(this.app)?Promise.reject(Oa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return bi(this.app)?Promise.reject(Oa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Do(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await qH(this),t=new s1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ho("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await $H(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Do(e)||this._popupRedirectResolver;je(t,this,"argument-error"),this.redirectPersistenceManager=await Km.create(this,[Do(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(je(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{s=!0,l()}}else{let l=e.addObserver(t);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Dk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(bi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&MH(`Error while retrieving App Check token: ${e.error}`),e?.token}};function i0(n){return Tn(n)}var Ym=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=d2(t=>this.observer=t)}get next(){return je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var b1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YH(n){b1=n}function QH(n){return b1.loadJS(n)}function JH(){return b1.gapiScript}function Ak(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Mk(n,e){let t=yd(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(nr(o,e??{}))return r;Hr(r,"already-initialized")}return t.initialize({options:e})}function ZH(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Do);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Rk(n,e,t){let i=i0(n);je(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=Pk(e),{host:s,port:a}=XH(e),l=a===null?"":`:${a}`,c={url:`${o}//${s}${l}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){je(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),je(nr(c,i.config.emulator)&&nr(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,as(s)?(Og(`${o}//${s}${l}`),Fg("Auth",!0)):r||e$()}function Pk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function XH(n){let e=Pk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:nk(i.substr(o.length+1))}}else{let[o,s]=i.split(":");return{host:o,port:nk(s)}}}function nk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function e$(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Xd=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Co("not implemented")}_getIdTokenResponse(e){return Co("not implemented")}_linkToIdToken(e,t){return Co("not implemented")}_getReauthenticationResolver(e){return Co("not implemented")}};async function pc(n,e){return VH(n,"POST","/v1/accounts:signInWithIdp",v1(n,e))}var t$="http://localhost",Qm=class n extends Xd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Hr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=a,o=$a(a,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return pc(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,pc(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,pc(e,t)}buildRequest(){let e={requestUri:t$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vl(t)}return e}};var eh=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Jm=class extends eh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var w1=(()=>{class n extends Jm{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return Qm._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var th=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){let o=await ws._fromIdTokenResponse(e,i,r),s=ik(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);let r=ik(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})}};function ik(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var l1=class n extends Ei{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function Nk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?l1._fromErrorAndOperation(n,o,e,i):o})}async function n$(n,e,t=!1){let i=await Jd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return th._forOperation(n,"link",i)}async function i$(n,e,t=!1){let{auth:i}=n;if(bi(i.app))return Promise.reject(Oa(i));let r="reauthenticate";try{let o=await Jd(n,Nk(i,r,e,n),t);je(o.idToken,i,"internal-error");let s=_1(o.idToken);je(s,i,"internal-error");let{sub:a}=s;return je(n.uid===a,i,"user-mismatch"),th._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&Hr(i,"user-mismatch"),o}}async function r$(n,e,t=!1){if(bi(n.app))return Promise.reject(Oa(n));let i="signIn",r=await Nk(n,i,e),o=await th._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}function kk(n,e,t,i){return Tn(n).onIdTokenChanged(e,t,i)}function Ok(n,e,t){return Tn(n).beforeAuthStateChanged(e,t)}function x1(n,e,t,i){return Tn(n).onAuthStateChanged(e,t,i)}function S1(n){return Tn(n).signOut()}var Zm="__sak";var Xm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Zm,"1"),this.storage.removeItem(Zm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var o$=1e3,s$=10,a$=(()=>{class n extends Xm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ck(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);WH()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,s$):o()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},o$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,i){await super._set(t,i),this.localCache[t]=JSON.stringify(i)}async _get(t){let i=await super._get(t);return this.localCache[t]=JSON.stringify(i),i}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),Fk=a$;var l$=(()=>{class n extends Xm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),I1=l$;function c$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var u$=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let i=t,{eventId:r,eventType:o,data:s}=i.data,a=this.handlersMap[o];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let l=Array.from(a).map(async d=>d(i.origin,s)),c=await c$(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:c})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function T1(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var c1=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{let c=T1("",20);r.port1.start();let d=setTimeout(()=>{l(new Error("unsupported_event"))},i);s={messageChannel:r,onMessage(h){let p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(p.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function jr(){return window}function d$(n){jr().location.href=n}function Lk(){return typeof jr().WorkerGlobalScope<"u"&&typeof jr().importScripts=="function"}async function h$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function f$(){return navigator?.serviceWorker?.controller||null}function p$(){return Lk()?self:null}var Vk="firebaseLocalStorageDb",g$=1,e0="firebaseLocalStorage",Uk="fbase_key",La=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function r0(n,e){return n.transaction([e0],e?"readwrite":"readonly").objectStore(e0)}function m$(){let n=indexedDB.deleteDatabase(Vk);return new La(n).toPromise()}function u1(){let n=indexedDB.open(Vk,g$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(e0,{keyPath:Uk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{let i=n.result;i.objectStoreNames.contains(e0)?e(i):(i.close(),await m$(),e(await u1()))})})}async function rk(n,e,t){let i=r0(n,!0).put({[Uk]:e,value:t});return new La(i).toPromise()}async function y$(n,e){let t=r0(n,!1).get(e),i=await new La(t).toPromise();return i===void 0?null:i.value}function ok(n,e){let t=r0(n,!0).delete(e);return new La(t).toPromise()}var v$=800,_$=3,E$=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await u1(),this.db)}async _withRetries(t){let i=0;for(;;)try{let r=await this._openDb();return await t(r)}catch(r){if(i++>_$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Lk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=u$._getInstance(p$()),this.receiver._subscribe("keyChanged",async(t,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(t,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await h$(),!this.activeServiceWorker)return;this.sender=new c1(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||f$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await u1();return await rk(t,Zm,"1"),await ok(t,Zm),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,i){return this._withPendingWrite(async()=>(await this._withRetries(r=>rk(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)))}async _get(t){let i=await this._withRetries(r=>y$(r,t));return this.localCache[t]=i,i}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ok(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=r0(o,!1).getAll();return new La(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),v$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Bk=E$;var ohe=Ak("rcb"),she=new Fa(3e4,6e4);function jk(n,e){return e?Do(e):(je(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var nh=class extends Xd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return pc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return pc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function b$(n){return r$(n.auth,new nh(n),n.bypassAuthState)}function w$(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),i$(t,new nh(n),n.bypassAuthState)}async function x$(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),n$(t,new nh(n),n.bypassAuthState)}var t0=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return b$;case"linkViaPopup":case"linkViaRedirect":return x$;case"reauthViaPopup":case"reauthViaRedirect":return w$;default:Hr(this.auth,"internal-error")}}resolve(e){Ao(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ao(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var S$=new Fa(2e3,1e4);async function C1(n,e,t){if(bi(n.app))return Promise.reject(ar(n,"operation-not-supported-in-this-environment"));let i=i0(n);RH(n,e,eh);let r=jk(i,t);return new I$(i,"signInViaPopup",e,r).executeNotNull()}var I$=(()=>{class n extends t0{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return je(t,this.auth,"internal-error"),t}async onExecution(){Ao(this.filter.length===1,"Popup operations only handle one event");let t=T1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(ar(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ar(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ar(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,S$.get())};t()}}n.currentPopupAction=null;return n})(),T$="pendingRedirect",Hm=new Map,d1=class extends t0{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Hm.get(this.auth._key());if(!e){try{let i=await C$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Hm.set(this.auth._key(),e)}return this.bypassAuthState||Hm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function C$(n,e){let t=M$(e),i=A$(n);if(!await i._isAvailable())return!1;let r=await i._get(t)==="true";return await i._remove(t),r}function D$(n,e){Hm.set(n._key(),e)}function A$(n){return Do(n._redirectPersistence)}function M$(n){return jm(T$,n.config.apiKey,n.name)}async function R$(n,e,t=!1){if(bi(n.app))return Promise.reject(Oa(n));let i=i0(n),r=jk(i,e),s=await new d1(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}var P$=600*1e3,h1=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!N$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Hk(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ar(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=P$&&this.cachedEventUids.clear(),this.cachedEventUids.has(sk(e))}saveEventToCache(e){this.cachedEventUids.add(sk(e)),this.lastProcessedEventTime=Date.now()}};function sk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Hk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function N$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hk(n);default:return!1}}async function k$(n,e={}){return gc(n,"GET","/v1/projects",e)}var O$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,F$=/^https?/;async function L$(n){if(n.config.emulator)return;let{authorizedDomains:e}=await k$(n);for(let t of e)try{if(V$(t))return}catch{}Hr(n,"unauthorized-domain")}function V$(n){let e=t1(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i}if(!F$.test(t))return!1;if(O$.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var U$=new Fa(3e4,6e4);function ak(){let n=jr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function B$(n){return new Promise((e,t)=>{function i(){ak(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ak(),t(ar(n,"network-request-failed"))},timeout:U$.get()})}if(jr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(jr().gapi?.load)i();else{let r=Ak("iframefcb");return jr()[r]=()=>{gapi.load?i():t(ar(n,"network-request-failed"))},QH(`${JH()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw $m=null,e})}var $m=null;function j$(n){return $m=$m||B$(n),$m}var H$=new Fa(5e3,15e3),$$="__/auth/iframe",G$="emulator/auth/iframe",z$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},W$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q$(n){let e=n.config;je(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?y1(e,G$):`https://${n.config.authDomain}/${$$}`,i={apiKey:e.apiKey,appName:n.name,v:ds},r=W$.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Vl(i).slice(1)}`}async function K$(n){let e=await j$(n),t=jr().gapi;return je(t,n,"internal-error"),e.open({where:document.body,url:q$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:z$,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});let s=ar(n,"network-request-failed"),a=jr().setTimeout(()=>{o(s)},H$.get());function l(){jr().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{o(s)})}))}var Y$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Q$=500,J$=600,Z$="_blank",X$="http://localhost",n0=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function eG(n,e,t,i=Q$,r=J$){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=ue(F({},Y$),{width:i.toString(),height:r.toString(),top:o,left:s}),c=In().toLowerCase();t&&(a=wk(c)?Z$:t),Ek(c)&&(e=e||X$,l.scrollbars="yes");let d=Object.entries(l).reduce((p,[g,x])=>`${p}${g}=${x},`,"");if(zH(c)&&a!=="_self")return tG(e||"",a),new n0(null);let h=window.open(e||"",a,d);je(h,n,"popup-blocked");try{h.focus()}catch{}return new n0(h)}function tG(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var nG="__/auth/handler",iG="emulator/auth/handler",rG=encodeURIComponent("fac");async function lk(n,e,t,i,r,o){je(n.config.authDomain,n,"auth-domain-config-required"),je(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ds,eventId:r};if(e instanceof eh){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",u2(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(o||{}))s[d]=h}if(e instanceof Jm){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let l=await n._getAppCheckToken(),c=l?`#${rG}=${encodeURIComponent(l)}`:"";return`${oG(n)}?${Vl(a).slice(1)}${c}`}function oG({config:n}){return n.emulator?y1(n,iG):`https://${n.authDomain}/${nG}`}var e1="webStorageSupport",f1=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=I1,this._completeRedirectFn=R$,this._overrideRedirectResult=D$}async _openPopup(e,t,i,r){Ao(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await lk(e,t,i,t1(),r);return eG(e,o,T1())}async _openRedirect(e,t,i,r){await this._originValidation(e);let o=await lk(e,t,i,t1(),r);return d$(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Ao(o,"If manager is not set, promise should be"),o)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await K$(e),i=new h1(e);return t.register("authEvent",r=>(je(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(e1,{type:e1},r=>{let o=r?.[0]?.[e1];o!==void 0&&t(!!o),Hr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=L$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ck()||bk()||E1()}},$k=f1;var ck="@firebase/auth",uk="1.12.0";var p1=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function sG(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aG(n){us(new Fi("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=i.options;je(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dk(n)},c=new a1(i,r,o,l);return ZH(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),us(new Fi("auth-internal",e=>{let t=i0(e.getProvider("auth").getImmediate());return(i=>new p1(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ir(ck,uk,sG(n)),ir(ck,uk,"esm2020")}var lG=300,cG=xb("authIdTokenMaxAge")||lG,dk=null,uG=n=>async e=>{let t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>cG)return;let r=t?.token;dk!==r&&(dk=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function ih(n=Bg()){let e=yd(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Mk(n,{popupRedirectResolver:$k,persistence:[Bk,Fk,I1]}),i=xb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=uG(o.toString());Ok(t,s,()=>s(t.currentUser)),kk(t,a=>s(a))}}let r=bb("auth");return r&&Rk(t,`http://${r}`),t}function dG(){return document.getElementsByTagName("head")?.[0]??document}YH({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=ar("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",dG().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aG("Browser");var o0={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var jn=class n{constructor(e){this.platformId=e;let t=vd(o0);try{this.db=Gd(t)}catch(i){console.warn("Firestore init failed (likely SSR)",i)}if(ns(this.platformId))try{this.auth=ih(t),x1(this.auth,i=>{this.user$.set(i)})}catch(i){console.warn("Auth init failed",i)}}db=null;auth=null;user$=$(null);async loginWithGoogle(){if(!(!this.auth||!ns(this.platformId)))try{let e=new w1;await C1(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await S1(this.auth)}async saveHighScore(e){if(this.db)try{await Kd(wi(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,i){if(!this.db)return[];try{let r=To(wi(this.db,"highscores"),vs("difficulty","==",t),vs("mapSize","==",i),sr("victory","desc"),sr("turnsPlayed","asc"),_s(e));return(await Es(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching scores: ",r),[]}}async getUserScores(e){if(!this.db)return[];try{let t=To(wi(this.db,"highscores"),vs("userId","==",e),vs("victory","==",!0),sr("turnsPlayed","asc"));return(await Es(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}async saveTowerDefenseScore(e){if(this.db)try{let t=ue(F({},e),{timestamp:zd()});await Kd(wi(this.db,"towerDefenseLeaderboards"),t)}catch(t){console.error("Error adding TD score: ",t)}}async getTopTowerDefenseScores(e){if(!this.db)return[];try{let t=To(wi(this.db,"towerDefenseLeaderboards"),sr("maxWave","desc"),sr("timestamp","desc"),_s(e));return(await Es(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching TD scores: ",t),[]}}static \u0275fac=function(t){return new(t||n)(De(Ji))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var mc=class n{platformId=z(Ji);nameSignal=$("Player");constructor(){if(ns(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),ns(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let i=(e??"").toString().trim().slice(0,24);return i.length>0?i:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var ri=class n{constructor(e,t,i,r,o,s,a,l,c){this.combat=e;this.build=t;this.log=i;this.settings=r;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=l;this.playerName=c;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}breakpointObserver=z(yb);screenState=HR(this.breakpointObserver.observe("(max-width: 1024px)").pipe(yt(e=>e.matches)),{initialValue:!1});unitsSignal=$([]);turnSignal=$(1);selectedUnitIdSignal=$(null);gameStatusSignal=$("playing");lastMergedUnitIdSignal=$(null);lastRemainderUnitIdSignal=$(null);resourcesSignal=$({wood:0,iron:0});forestsSignal=$([]);minesSignal=$([]);forgeSitesSignal=$([]);forgesSignal=$([]);aiForgesSignal=$([]);baseHealthSignal=$({player:100,ai:100});reservePointsSignal=$({player:0,ai:0});deployTargetsSignal=$([]);baseDeployActiveSignal=$(!1);wallsSignal=$([]);playerVisibilitySignal=$(new Set);aiVisibilitySignal=$(new Set);playerExploredSignal=$(new Set);aiExploredSignal=$(new Set);unitMoveHistorySignal=$(new Map);unitStutterBanSignal=$(new Map);lastAiMovedUnitIdSignal=$(null);aiConsecMovesSignal=$(0);buildModeSignal=$(!1);fogDebugDisabledSignal=$(!1);wallBuiltThisTurnSignal=$(!1);rulesOpenSignal=$(!1);movedThisTurnSignal=$(new Set);hoveredFormationIdSignal=$(null);aiWoodSignal=$(0);aiIronSignal=$(0);logsOpenSignal=$(!1);settingsOpenSignal=$(!1);activeSideSignal=$("ai");lastArrivedUnitIdSignal=$(null);attackerNudgeSignal=$(null);shakenUnitIdSignal=$(null);shakenWallIdSignal=$(null);pulseUnitIdSignal=$(null);screenShakeSignal=$(!1);endOverlaySignal=$(!1);endReasonSignal=$(null);combatOnlySignal=$(!0);forestMonopolySignal=$({player:0,ai:0});hoveredUnitIdSignal=$(null);autoDeployEnabledSignal=$(!1);highScoresOpenSignal=$(!1);leaderboardOpenSignal=$(!1);namePromptOpenSignal=$(!1);pendingScoreSignal=$(null);supportOpenSignal=$(!1);highScoresSignal=$({});playerConvertedThisTurnSignal=$(!1);unitQuadrantBiasSignal=$(new Map);aiUnitTimeNearBaseSignal=$(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=$(!1);wallCooldownSignal=$(new Map);aiQueuedUnitIdSignal=$(null);aiMoodSignal=$("none");rageCaptureCounterSignal=$(0);anchoredGatherersSignal=$(new Set);totalWarModeSignal=$(!1);aiInvalidActionCountSignal=$(0);aiLastRejectedActionKeySignal=$(null);sandboxSpawnPendingSignal=$(null);unitMoveOffsetSignal=$(new Map);movingUnitsSignal=$(new Set);attackingUnitsSignal=$(new Set);reclamationGoalsSignal=$(new Map);mergeIntentSignal=$(new Map);ignoreForgeUntilTurnSignal=$(new Map);playerClaimedTargetsSignal=$(new Set);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();mines=this.minesSignal.asReadonly();forges=this.forgesSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();isMobile=ti(()=>this.screenState());sandboxSpawnPending(){return this.sandboxSpawnPendingSignal()}getMoveOffsetFor(e){return this.unitMoveOffsetSignal().get(e)??null}isUnitMoving(e){return this.movingUnitsSignal().has(e)}isUnitAttacking(e){return this.attackingUnitsSignal().has(e)}getCombinedTransform(e){let t=this.attackerNudgeSignal(),i=this.getMoveOffsetFor(e),r=(t&&t.id===e?t.dx:0)+(i?i.dx:0),o=(t&&t.id===e?t.dy:0)+(i?i.dy:0);return`translate(${r}px, ${o}px)`}aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=ti(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=ti(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?this.isMobile()?4:6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?12:16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(r=>r.owner==="player"&&this.isForest(r.position.x,r.position.y)).length,i=this.unitsSignal().filter(r=>r.owner==="ai"&&this.isForest(r.position.x,r.position.y)).length;return{total:e,player:t,ai:i}}resetGame(){let e=this.settings.difficulty();this.stopAiLoops(),this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0,iron:0}),this.baseHealthSignal.set(this.settings.customMode()?{player:1e3,ai:1e3}:{player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:5,ai:5}):e==="normal"?this.reservePointsSignal.set({player:1,ai:1}):e==="hard"?this.reservePointsSignal.set({player:1,ai:3}):this.reservePointsSignal.set({player:1,ai:5}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"))),this.minesSignal.set(this.map.generateMines(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"),this.forestsSignal())),this.forgeSitesSignal.set([]),this.forgesSignal.set([]),this.aiForgesSignal.set([]);let t=new Set(this.forestsSignal().map(i=>`${i.x},${i.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(i=>i.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(r=>r.x===e.x&&r.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let i=!1,r=!1,o=null;this.unitsSignal.update(p=>{let g=[...p],x=g.findIndex(I=>I.id===e.id);if(x===-1)return p;let S=F({},g[x]),N={x:S.position.x,y:S.position.y},U=t.x-N.x,se=t.y-N.y,Se=Math.sign(U),xe=Math.sign(se),Ae=this.combat.checkWallAlongPath(N,t,S.owner,(I,P,D,w)=>this.getWallBetween(I,P,D,w));if(Ae.hitOwn)return g;if(Ae.hitEnemy){let I=Ae.lastFrom,P=this.getWallBetween(I.x,I.y,t.x,t.y);{let w=P.maxHealth??100,R=this.combat.getWallHitAmount(S.tier),M=Math.max(0,P.health-R);this.wallsSignal.update(Le=>Le.map(fe=>fe.id===P.id?ue(F({},fe),{health:M}):fe).filter(fe=>(fe.health??fe.hitsRemaining??0)>0)),M<=0&&this.registerWallDestroyedEdge(I,t);let me=P.owner==="neutral"?"Neutral":P.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${S.tier} Unit attacked ${me} Wall. Damage: ${R}. Wall HP: ${M}/${w}.`)}this.updateWallFormations(),this.shakenWallIdSignal.set(P.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let D=g.findIndex(w=>w.id===S.id);return D!==-1&&(g[D]=ue(F({},g[D]),{hasActed:!0})),g}let Ie=this.getBasePosition(S.owner==="player"?"ai":"player");if(t.x===Ie.x&&t.y===Ie.y)return this.baseHealthSignal.update(I=>{let P=S.owner==="player"?"ai":"player",D=F({},I);return D[P]=Math.max(0,D[P]-this.calculatePower(S)),D}),g.splice(x,1),g;let k=g.findIndex(I=>I.position.x===t.x&&I.position.y===t.y&&I.id!==S.id);if(k!==-1){let I=g[k],P={x:t.x-Se,y:t.y-xe};if(this.inBounds(P.x,P.y)){if(Se!==0&&xe!==0){if(this.combat.isDiagonalBlocked(P,t,(D,w,R,M)=>this.getWallBetween(D,w,R,M)))return i=!1,g}else if(this.getWallBetween(P.x,P.y,t.x,t.y))return i=!1,g}if(I.owner===S.owner)if(this.shakenUnitIdSignal.set(S.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),I.tier===S.tier){let D=I.tier,w=this.calculateTotalPoints(S)+this.calculateTotalPoints(I),R={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},M=R[D][3];if(w<=M){I.points=w;let Le=this.calculateTierAndLevel(I.points);I.tier=Le.tier,I.level=Le.level;let fe=!!(I.hasWeapon||S.hasWeapon),Lt=!!(I.hasArmor||S.hasArmor),Qt=Lt?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=fe,I.hasArmor=Lt,I.armorHp=Qt,g.splice(x,1)}else{let Le=Math.min(4,D+1),fe=R[Le][0];I.points=fe;let Lt=this.calculateTierAndLevel(I.points);I.tier=Lt.tier,I.level=Lt.level;let Qt=!!(I.hasWeapon||S.hasWeapon),Me=!!(I.hasArmor||S.hasArmor),Gt=Me?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=Qt,I.hasArmor=Me,I.armorHp=Gt;let lt=w-fe;if(lt>0){S.points=lt;let te=this.calculateTierAndLevel(S.points);S.tier=te.tier,S.level=te.level,S.hasWeapon=!1,S.hasArmor=!1,S.armorHp=0,g[x]=S,o=S.id}else g.splice(x,1)}r=!0;let me=new Map(this.mergeIntentSignal());me.delete(S.id),me.delete(I.id),this.mergeIntentSignal.set(me)}else return g;else{{let te=t.x-N.x,ie=t.y-N.y,Ee=Math.abs(te)>=Math.abs(ie),ve=Math.sign(Ee?te:ie),ye=this.wallThicknessPx+2,E=this.tileSizePx+ye,le=Math.round(E*.35),We=Ee?ve*le:0,qe=Ee?0:ve*le,ae=new Set(this.attackingUnitsSignal());ae.add(S.id),this.attackingUnitsSignal.set(ae),this.attackerNudgeSignal.set({id:S.id,dx:We,dy:qe}),setTimeout(()=>{this.attackerNudgeSignal.set({id:S.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let bt=new Set(this.attackingUnitsSignal());bt.delete(S.id),this.attackingUnitsSignal.set(bt)},200)}this.shakenUnitIdSignal.set(I.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let D=this.combat.calculateHitChance(S,I);if(Math.floor(Math.random()*100)+1>D)return this.queueCombatText("DEFLECTED!",t),this.log.addCombat(S.owner,`[Combat] DEFLECTED! T${S.tier} failed to penetrate T${I.tier}. Attacker destroyed.`,!1),g.splice(x,1),g;this.log.addCombat(S.owner,`[Combat] HIT! T${S.tier} breached T${I.tier} armor.`,!1);let R=this.calculateTotalPoints(S)+(S.hasWeapon?20:0),M=this.getAttackLuckModifier(S),me=this.calculateTotalPoints(I),Le=this.combat.getDefenseBonus(I,g),fe=Math.max(0,R+M.delta),Lt=me+Le.bonus,Qt=S.hasWeapon?"Weapon +20":"",Me=[...Le.tags,M.tag??"",Qt].filter(Boolean).join(", ")||"None",Gt=fe-Lt,lt=`[Turn ${this.turnSignal()}] ${S.owner==="player"?"Player":"AI"} T${S.tier}(L${S.level}) attacked ${I.owner==="player"?"Player":"AI"} T${I.tier}(L${I.level}). Power: ${R} vs ${me}. Modifiers: ${Me}. Final: (${R}${M.delta!==0?M.delta>0?`+${M.delta}`:`${M.delta}`:""}${Le.bonus>0?` - ${Le.bonus}`:""}) - ${me} = ${Gt}.`;if(this.log.addCombat(S.owner,lt,!!M.isCrit),fe<Lt&&this.queueCombatText("WEAK!",t),fe>Lt){let te=this.combat.calculateHitChance(I,S),Ee=Math.floor(Math.random()*100)+1<=te,ve=Ee?me:0;if(ve>0){let ye=this.combat.applyDamage(S,ve);S.points=ye.points,S.tier=ye.tier,S.level=ye.level,S.armorHp=ye.armorHp}Ee||this.log.addCombat(S.owner,`[Combat] T${S.tier} armor deflected the counter-attack from T${I.tier}. Final HP: ${S.points}`,!1),g.splice(k,1),M.tag&&this.queueCombatText(M.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(fe<Lt){let te=fe,ie=this.combat.applyDamage(I,te),Ee=F({},ie);return g[k]=Ee,g.splice(x,1),g}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),g.filter(ie=>ie.id!==S.id&&ie.id!==I.id);{let ie=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),ie){let Ee=this.getPointsForTierLevel(S.tier,1);S.points=Ee;let ve=this.calculateTierAndLevel(Ee);S.tier=ve.tier,S.level=ve.level,g.splice(k,1),this.pulseUnitIdSignal.set(S.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let Ee=this.getPointsForTierLevel(I.tier,1),ve=ue(F({},I),{points:Ee}),ye=this.calculateTierAndLevel(Ee);return ve.tier=ye.tier,ve.level=ye.level,g[k]=ve,g.splice(x,1),this.pulseUnitIdSignal.set(ve.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),g}}}}}if(g.find(I=>I.id===S.id)&&o!==S.id){S.position=t,S.turnsStationary=0,S.hasActed=!0;let I=g.findIndex(Le=>Le.id===S.id);I!==-1&&(g[I]=S),S.owner==="ai"&&S.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(S.id,{x:t.x,y:t.y}),S.tier<=2&&this.anchorGatherer(S.id));let P=new Set(this.movedThisTurnSignal());P.add(S.id),this.movedThisTurnSignal.set(P),this.lastArrivedUnitIdSignal.set(S.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let D=new Map(this.unitMoveHistorySignal()),w=D.get(S.id)??[],R={x:N.x,y:N.y},M={x:t.x,y:t.y},me=[...w,R,M].slice(-4);D.set(S.id,me),this.unitMoveHistorySignal.set(D)}return g});let s=t.x-e.position.x,a=t.y-e.position.y,l=this.wallThicknessPx+2,c=this.tileSizePx+l,d={dx:-s*c,dy:-a*c};if(s!==0||a!==0){let p=new Map(this.unitMoveOffsetSignal());p.set(e.id,d),this.unitMoveOffsetSignal.set(p);let g=new Set(this.movingUnitsSignal());g.add(e.id),this.movingUnitsSignal.set(g),setTimeout(()=>{let x=new Map(this.unitMoveOffsetSignal());x.set(e.id,{dx:0,dy:0}),this.unitMoveOffsetSignal.set(x),setTimeout(()=>{let S=new Map(this.unitMoveOffsetSignal());S.delete(e.id),this.unitMoveOffsetSignal.set(S);let N=new Set(this.movingUnitsSignal());N.delete(e.id),this.movingUnitsSignal.set(N)},180)},0)}if(r){let p=this.getUnitAt(t.x,t.y);p&&(this.lastMergedUnitIdSignal.set(p.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(N=>N+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let x=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(x.length>=4&&x[0].x===x[2].x&&x[0].y===x[2].y&&x[1].x===x[3].x&&x[1].y===x[3].y&&(x[0].x!==x[1].x||x[0].y!==x[1].y)){let N=new Map(this.unitStutterBanSignal()),U=new Set([`${x[0].x},${x[0].y}`,`${x[1].x},${x[1].y}`]);N.set(e.id,{tiles:U,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(N);let se={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},xe=(this.getQuadrant(e.position,se)+2)%4,Ae=new Map(this.unitQuadrantBiasSignal());Ae.set(e.id,{quadrant:xe,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(Ae)}}let h=this.selectedUnitIdSignal();h&&!this.unitsSignal().some(p=>p.id===h)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility(),e.owner==="player"&&this.selectNextAvailableUnit()}selectNextAvailableUnit(){let t=this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((i,r)=>{let o=this.isForest(i.position.x,i.position.y)||this.isMine(i.position.x,i.position.y)?1:0,s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0;return o!==s?o-s:0}),this.selectUnit(t[0].id)}selectNextAvailableUnitTab(){let t=this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((r,o)=>{let s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0,a=this.isForest(o.position.x,o.position.y)||this.isMine(o.position.x,o.position.y)?1:0;return s!==a?s-a:r.id.localeCompare(o.id)});let i=this.selectedUnitId();if(!i)this.selectUnit(t[0].id);else{let r=t.findIndex(o=>o.id===i);if(r===-1)this.selectUnit(t[0].id);else{let o=(r+1)%t.length;this.selectUnit(t[o].id)}}}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}effectiveAttack(e){return this.calculateTotalPoints(e)+(e.hasWeapon?20:0)}effectiveDefense(e){return(e.points??0)+(e.armorHp??0)}computeSideEffectivePower(e){let t=this.unitsSignal().filter(r=>r.owner===e),i=0;for(let r of t)i+=this.effectiveAttack(r);return i}getWood(e){return e==="ai"?this.aiWoodSignal():this.resourcesSignal().wood}getIron(e){return e==="ai"?this.aiIronSignal():this.resourcesSignal().iron}getForges(e){return e==="ai"?this.aiForgesSignal():this.forgesSignal()}buyArmorGeneric(e,t){e==="ai"?this.aiBuyArmor(t):this.buyArmor(t)}buyWeaponGeneric(e,t){e==="ai"?this.aiBuyWeapon(t):this.buyWeapon(t)}isUnitInDanger(e){let t=this.getNeighbors(e.position);for(let i of t){let r=this.getUnitAt(i.x,i.y);if(r&&r.owner!==e.owner){let o=this.effectiveAttack(r),s=this.effectiveDefense(e),a=e.hasWeapon?e.tier>=3?20:10:0;if(o>s+a)return!0}}return!1}findSafeMove(e,t){let i=this.getBasePosition("ai");return t.length===0?null:t.reduce((r,o)=>{let s=Math.abs(o.x-i.x)+Math.abs(o.y-i.y),a=Math.abs(r.x-i.x)+Math.abs(r.y-i.y);return s<a?o:r},t[0])}findResourceTarget(e,t){let i=this.forestsSignal(),r=this.minesSignal(),o=this.turnSignal()<=20,s=i.filter(x=>{let S=`${x.x},${x.y}`;if(t.claimedTargets.has(S))return!1;let N=this.getUnitAt(x.x,x.y);return!(N&&N.owner==="ai")}),a=r.filter(x=>{let S=`${x.x},${x.y}`;if(t.claimedTargets.has(S))return!1;let N=this.getUnitAt(x.x,x.y);return!(N&&N.owner==="ai")}),l=s.filter(x=>!this.getUnitAt(x.x,x.y)),c=a.filter(x=>!this.getUnitAt(x.x,x.y));if(o){if(l.length>0)return l.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),l[0];if(c.length>0)return c.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),c[0]}else{let x=[...l,...c];if(x.length>0)return x.sort((S,N)=>{let U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),se=Math.abs(N.x-e.position.x)+Math.abs(N.y-e.position.y);return U-se}),x[0]}let d=s.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&S.owner==="player"}),p=a.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&S.owner==="player"}).filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&e.tier>=S.tier}),g=d.filter(x=>{let S=this.getUnitAt(x.x,x.y);return S&&e.tier>=S.tier});if(o){if(g.length>0)return g.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),g[0];if(p.length>0)return p.sort((x,S)=>{let N=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return N-U}),p[0]}else{let x=[...g,...p];if(x.length>0)return x.sort((S,N)=>{let U=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),se=Math.abs(N.x-e.position.x)+Math.abs(N.y-e.position.y);return U-se}),x[0]}return d.length>0?(d.sort((x,S)=>{let N=this.getUnitAt(x.x,x.y),U=this.getUnitAt(S.x,S.y),se=N?N.tier:99,Se=U?U.tier:99;if(se!==Se)return se-Se;let xe=Math.abs(x.x-e.position.x)+Math.abs(x.y-e.position.y),Ae=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return xe-Ae}),d[0]):null}findDefensiveWallTarget(e){let t=this.getNeighbors(e.position),r=this.unitsSignal().filter(c=>c.owner==="player").filter(c=>Math.abs(c.position.x-e.position.x)+Math.abs(c.position.y-e.position.y)<=5);if(r.length===0)return null;let o=0,s=0;r.forEach(c=>{o+=c.position.x,s+=c.position.y}),o/=r.length,s/=r.length;let a=null,l=-1/0;for(let c of t){if(this.getWallBetween(e.position.x,e.position.y,c.x,c.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(c)||this.isEdgeOnCooldown(e.position,c))continue;let d=c.x-e.position.x,h=c.y-e.position.y,p=o-e.position.x,g=s-e.position.y,x=d*p+h*g;x>l&&(l=x,a=c)}return l>0?a:null}findBlockingWall(e,t){let i=this.bfsPath(e,t,{respectWalls:!1});if(!i||i.length<2)return null;for(let r=0;r<i.length-1;r++){let o=i[r],s=i[r+1],a=this.getWallBetween(o.x,o.y,s.x,s.y);if(a)return{pos:s,wall:a}}return null}findDefensiveWallTargetForOwner(e,t){let i=this.getNeighbors(e.position),r=t==="player"?"ai":"player",s=this.unitsSignal().filter(h=>h.owner===r).filter(h=>Math.abs(h.position.x-e.position.x)+Math.abs(h.position.y-e.position.y)<=5);if(s.length===0)return null;let a=0,l=0;s.forEach(h=>{a+=h.position.x,l+=h.position.y}),a/=s.length,l/=s.length;let c=null,d=-1/0;for(let h of i){if(this.getWallBetween(e.position.x,e.position.y,h.x,h.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(h)||this.isEdgeOnCooldown(e.position,h))continue;let p=h.x-e.position.x,g=h.y-e.position.y,x=a-e.position.x,S=l-e.position.y,N=p*x+g*S;N>d&&(d=N,c=h)}return d>0?c:null}getNextStepTowards(e,t,i,r){if(i.length===0)return null;let o=l=>{let c=Math.abs(l.x-t.x)+Math.abs(l.y-t.y);if(r?.noCohesion&&!r?.antiClump&&!r?.fogBonus)return c*10;let h=this.getNeighbors(l).filter(g=>{let x=this.getUnitAt(g.x,g.y);return x&&x.owner===e.owner}).length,p=c*10;return r?.antiClump?p+=h*3:r?.noCohesion||(p-=h*2),r?.fogBonus&&!this.isVisibleToPlayer(l.x,l.y)&&e.owner==="player"&&(p-=3),p},s=null,a=1/0;for(let l of i){let c=o(l);c<a&&(a=c,s=l)}return s}findPlayerResourceTarget(e){let t=this.turnSignal(),i=this.forestsSignal(),r=this.minesSignal(),o=this.playerClaimedTargetsSignal(),s=g=>`${g.x},${g.y}`,a=g=>!this.getUnitAt(g.x,g.y),l=g=>{let x=this.getUnitAt(g.x,g.y);return!!(x&&x.owner==="player")},c=i.filter(g=>!o.has(s(g))),d=r.filter(g=>!o.has(s(g))),h=(g,x)=>{let S=Math.abs(g.x-e.position.x)+Math.abs(g.y-e.position.y),N=l(g)?100:0,U=t<=15&&x==="forest"?-5:0;return S*10+N+(a(g)?0:20)+U},p=[...c.map(g=>({p:g,t:"forest",s:h(g,"forest")})),...d.map(g=>({p:g,t:"mine",s:h(g,"mine")}))];return p.length===0?null:(p.sort((g,x)=>g.s-x.s),p[0].p)}findCombatTarget(e,t,i){let r=t.priorityTargets.find(c=>Math.max(Math.abs(c.position.x-e.position.x),Math.abs(c.position.y-e.position.y))<=5);if(r&&!this.bfsPath(e.position,r.position,{respectWalls:!0})){let d=this.findBlockingWall(e.position,r.position);if(d)return this.appendLog(`[Obstacle Smash] T${e.tier} targeting wall at (${d.pos.x},${d.pos.y}) blocking path to high-value target`),d.pos}let o=t.priorityTargets.filter(c=>i.some(d=>d.x===c.position.x&&d.y===c.position.y));if(o.length>0){let c=o.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),c[0].position):(o.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),o[0].position)}let s=this.getNeighbors(e.position),a=[];for(let c of s){let d=this.getWallBetween(e.position.x,e.position.y,c.x,c.y);if(!d||d.owner===e.owner)continue;let h=d.maxHealth??100,p=100-(h-100);h>200&&!e.hasWeapon&&(p-=150),e.hasWeapon&&(p+=40),(d.formationSize??1)<=2&&(p+=30),a.push({pos:c,score:p})}if(a.length>0)return a.sort((c,d)=>d.score-c.score),a[0].pos;let l=i.map(c=>{let d=this.getUnitAt(c.x,c.y);return!d||d.owner===e.owner?null:{pos:c,enemy:d}}).filter(Boolean);if(l.length>0){let c=l.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d.enemy));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),c[0].pos):(l.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),l[0].pos)}return null}findFallbackMove(e,t,i){if(t.length===0)return null;let r=Math.abs(e.position.x-i.x)+Math.abs(e.position.y-i.y),o=null,s=1/0;for(let a of t){let l=Math.abs(a.x-i.x)+Math.abs(a.y-i.y);l<s&&(s=l,o=a)}if(!o)return null;if(s>r){let a=this.isUnitInDanger(e),l=!1;if(a&&(l=this.getNeighbors(e.position).some(d=>{let h=this.getUnitAt(d.x,d.y);return!h||h.owner===e.owner?!1:this.effectiveAttack(h)>this.effectiveDefense(e)})),!l)return null}return o}isTileThreatenedByEnemy(e,t){let i=this.getNeighbors(t);for(let r of i){let o=this.getUnitAt(r.x,r.y);if(o&&o.owner!==e.owner&&this.effectiveAttack(o)>=this.effectiveDefense(e))return!0}return!1}getMergePartnerForUnit(e,t){let r=this.reclamationGoalsSignal().get(e.id);if(r&&r.type==="merge"){let c=this.getUnitAt(r.target.x,r.target.y);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let s=this.mergeIntentSignal().get(e.id);if(s){let c=this.unitsSignal().find(d=>d.id===s);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let a=this.unitsSignal().find(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y)&&t.some(d=>d.x===c.position.x&&d.y===c.position.y));if(a)return a;let l=this.unitsSignal().filter(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y));for(let c of l){let d=this.getNextStepTowards(e,c.position,t);if(!d)continue;let h=this.calculateValidMoves(c),p=this.getNextStepTowards(c,e.position,h);if(!p)continue;let g=Math.abs(e.position.x-c.position.x)+Math.abs(e.position.y-c.position.y);if(Math.abs(d.x-p.x)+Math.abs(d.y-p.y)<g)return c}return null}computeHighestTierNeedingUpgrade(){let e=this.unitsSignal().filter(t=>t.owner==="ai"&&t.tier>=2&&(!t.hasArmor||!t.hasWeapon));return e.length===0?0:e.reduce((t,i)=>Math.max(t,i.tier),0)}getNeighbors(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}].filter(t=>this.inBounds(t.x,t.y))}bfsPath(e,t,i){let r=[{pos:e,path:[e]}],o=new Set;o.add(`${e.x},${e.y}`);let s=0;for(;r.length>0&&s<500;){s++;let a=r.shift();if(a.pos.x===t.x&&a.pos.y===t.y)return a.path;let l=this.getNeighbors(a.pos);for(let c of l){let d=`${c.x},${c.y}`;if(!o.has(d)){if(i?.avoidFriendlyUnits){let h=this.getUnitAt(c.x,c.y);if(h&&h.owner==="ai")continue}if(i?.respectWalls&&this.getWallBetween(a.pos.x,a.pos.y,c.x,c.y))continue;o.add(d),r.push({pos:c,path:[...a.path,c]})}}}return null}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=$([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){if(this.settings.customMode()&&this.endReasonSignal()!=="Debug Victory"&&e==="Jaerbi")return;this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let i=this.firebase.user$(),r=ue(F({},t),{playerName:this.playerName.name(),userId:i?.uid,userPhoto:i?.photoURL??void 0});this.firebase.saveHighScore(r),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}aiIron(){return this.aiIronSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;return r?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let i=this.calculateTotalPoints(t),r=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,i-r),atkMax:i+r+(t.hasWeapon?20:0),hp:t.points,support:o}}isUnitHovered(e){return this.hoveredUnitIdSignal()===e}getHitChanceInfo(e){let t=this.selectedUnit();if(!t)return null;let i=this.unitsSignal().find(l=>l.id===e);if(!i||t.owner!=="player"||i.owner===t.owner||!this.isVisibleToPlayer(i.position.x,i.position.y)||!this.validMoves().some(l=>l.x===i.position.x&&l.y===i.position.y))return null;let o=this.combat.calculateHitChance(t,i),s="bg-green-600";o<50?s="bg-red-600":o<100&&(s="bg-amber-600");let a=o<10;return{chance:o,bg:s,icon:a?"\u2620\uFE0F":"\u2694\uFE0F",skull:a}}shouldRenderWall(e,t,i){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return r?(i??r.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}hoverFormationById(e){this.hoveredFormationIdSignal.set(e??null)}isFormationHovered(e){return e?this.hoveredFormationIdSignal()===e:!1}getFormationInfo(e){let t=e??null;if(!t)return null;let i=this.wallsSignal().find(r=>r.formationId===t);return i?{size:i.formationSize??1,bonus:i.bonusHp??0}:null}updateWallFormations(){let e=this.wallsSignal();if(e.length===0)return;let t=new Map,i=new Map;for(let l of e){t.set(l.id,l);let c=`${l.tile1.x},${l.tile1.y}`,d=`${l.tile2.x},${l.tile2.y}`,h=i.get(c)??[];h.push(l.id),i.set(c,h);let p=i.get(d)??[];p.push(l.id),i.set(d,p)}let r=new Set,o=[];for(let l of e){if(r.has(l.id))continue;if(l.owner==="neutral"){o.push([l.id]),r.add(l.id);continue}let c=[l.id];r.add(l.id);let d=[],h=l.owner;for(;c.length>0;){let p=c.shift();d.push(p);let g=t.get(p),x=[`${g.tile1.x},${g.tile1.y}`,`${g.tile2.x},${g.tile2.y}`];for(let S of x){let N=i.get(S)??[];for(let U of N)r.has(U)||t.get(U).owner===h&&(r.add(U),c.push(U))}}o.push(d)}let s=e.map(l=>F({},l)),a=new Map;for(let l=0;l<s.length;l++)a.set(s[l].id,l);for(let l of o){let d=t.get(l[0]).owner==="neutral",h=d?1:l.length,p=d?0:Math.max(0,h*20),g=100+p,x=d?null:l[0];for(let S of l){let N=a.get(S),U=s[N],se=U.maxHealth??100,Se=g-se,xe=U.health;Se>0?xe=U.health+Se:Se<0&&(xe=Math.min(U.health,g)),xe=Math.max(0,Math.min(g,xe)),s[N]=ue(F({},U),{formationId:x??void 0,formationSize:h,maxHealth:g,bonusHp:p,health:xe})}}this.wallsSignal.set(s)}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(i=>i.position.x===e&&i.position.y===t).map(i=>({id:i.id,text:i.text,opacity:i.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let i=this.unitsSignal().find(d=>d.id===e);if(!i)return"";let r=this.combat.getPointsForTierLevel(i.tier,4),o=t.support>0?`+${t.support}`:"+0",s=i.hasWeapon?" | Weapon:+20":"",a=i.armorHp??0,l=i.hasArmor?` | Armor:${a}`:"",c=a>0?`${t.hp} + ${a}`:`${t.hp}`;return`Unit T${i.tier} | HP: ${c}/${r} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}${s}${l}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.endReasonSignal.set("Debug Victory"),this.endOverlaySignal.set(!0);let t=this.getForestControl().player,r={playerName:this.playerName.name(),turnsPlayed:this.turnSignal(),forestsCaptured:t,victoryType:"Annihilation",timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:!0};this.pendingScoreSignal.set(r),this.namePromptOpenSignal.set(!0)}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],i=e.indexOf(this.settings.difficulty()),r=t.indexOf(this.settings.mapSize());i++,i>=e.length&&(i=0,r++,r>=t.length&&(r=0)),this.settings.setDifficulty(e[i]),this.settings.setMapSize(t[r]),this.resetGame()}recordHighScore(e,t){if(this.settings.customMode()){this.endReasonSignal.set("Match Finished (Custom Mode)");return}let i=`${this.settings.difficulty()}|${this.settings.mapSize()}`,r=F({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=r[i]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((h,p)=>h.turns-p.turns).slice(0,3):s.losses=[...s.losses,o].sort((h,p)=>h.turns-p.turns).slice(0,3),r[i]=s,this.highScoresSignal.set(r),this.persistHighScores();let a=this.getForestControl(),l=e==="player wins"?a.player:a.ai,c=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:l,victoryType:c,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"&&(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0))}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let i=crypto.randomUUID(),r={id:i,text:e,position:F({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),r]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===i?ue(F({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==i))},2e3)}calculateValidMoves(e){let t=[],i=e.position,r=c=>c.x>=0&&c.x<this.gridSize&&c.y>=0&&c.y<this.gridSize,o=(c,d)=>{if(!r(d))return"blocked";if(c.x===d.x||c.y===d.y){if(this.getWallBetween(c.x,c.y,d.x,d.y))return"blocked"}else if(this.isDiagonalBlocked(c,d))return"blocked";let h=this.getUnitAt(d.x,d.y);return h?h.owner===e.owner?"ally":"enemy":"empty"},s=(c,d)=>{(d==="empty"||d==="enemy"||this.getUnitAt(c.x,c.y)?.tier===e.tier)&&t.push(c)},a=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],l=[{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}];if(e.tier===1){for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);h!=="blocked"&&s(d,h)}return t}for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===3&&h==="empty"){let p={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,p);g!=="blocked"&&s(p,g)}}for(let c of l){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===4&&h==="empty"){let p={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,p);if(g!=="blocked"&&(s(p,g),g==="empty")){let x={x:i.x+c.x*3,y:i.y+c.y*3},S=o(p,x);S!=="blocked"&&s(x,S)}}}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),l=this.isForest(s.position.x,s.position.y),c=this.isMine(s.position.x,s.position.y),d=l?a?1:(s.forestOccupationTurns??0)+1:0,h=c?a?1:(s.mineOccupationTurns??0)+1:0,p=l?d>=3:!1;return ue(F({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:d,mineOccupationTurns:h,productionActive:p})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let i=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(a=>a.owner===e&&this.isForest(a.position.x,a.position.y)&&(a.productionActive??!1)).length,s=this.unitsSignal().filter(a=>a.owner===e&&this.isMine(a.position.x,a.position.y)&&(a.mineOccupationTurns??0)>=5).length;if(o>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood+o*i(this.settings.difficulty()),iron:a.iron})):this.aiWoodSignal.update(a=>a+o*i(this.settings.difficulty()))),s>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood,iron:a.iron+s*2})):this.aiIronSignal.update(a=>a+s*2)),e==="player"){let a=this.forgeSitesSignal().map(h=>F({},h));for(let h of a)h.turnsLeft=Math.max(0,h.turnsLeft-1);let l=a.filter(h=>h.turnsLeft===0),c=l.map(h=>h.position),d=a.filter(h=>h.turnsLeft>0);if(c.length>0){this.forgesSignal.update(p=>[...p,...c]);let h=l.filter(p=>p.owner==="ai").map(p=>p.position);if(h.length>0){this.aiForgesSignal.update(p=>[...p,...h]);for(let p of h)this.appendLog(`[AI] Forge completed at (${p.x},${p.y}).`)}}this.forgeSitesSignal.set(d)}}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let r=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(r),this.startSideTurn(r),r==="ai"&&this.gameStatus()==="playing"&&(this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10))}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}pauseGame(){this.stopAiLoops()}aiTurnTimeout=null;stopAiLoops(){this.aiTurnTimeout&&(clearTimeout(this.aiTurnTimeout),this.aiTurnTimeout=null),this.isAiThinking=!1}startSideTurn(e){this.unitsSignal.update(t=>t.map(i=>i.owner===e?ue(F({},i),{hasActed:!1}):i)),e==="player"&&(this.selectNextAvailableUnit(),this.playerClaimedTargetsSignal.set(new Set))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;if(r){let s=F({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=F({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai"),t=this.forestsSignal().length+this.minesSignal().length,i=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y))),r=t>0?i.length/t:0;if(r>.5){let D=new Map,w=this.unitsSignal().filter(me=>me.owner==="ai"&&!me.hasActed),R=new Set,M=i.slice().sort((me,Le)=>Le.tier-me.tier);for(let me of M){let Le=Math.min(4,me.tier+1),fe=w.filter(Me=>Me.tier===Le&&!R.has(Me.id)).sort((Me,Gt)=>{let lt=Math.max(Math.abs(Me.position.x-me.position.x),Math.abs(Me.position.y-me.position.y)),te=Math.max(Math.abs(Gt.position.x-me.position.x),Math.abs(Gt.position.y-me.position.y));return lt-te});if(fe.length>0){let Me=fe[0];D.set(Me.id,{target:F({},me.position),type:"hunt"}),R.add(Me.id);continue}let Lt=w.filter(Me=>Me.tier===me.tier&&!R.has(Me.id)),Qt=!1;for(let Me of Lt){let Gt=this.calculateValidMoves(Me),lt=this.unitsSignal().find(te=>te.owner==="ai"&&te.tier===Me.tier&&(te.position.x!==Me.position.x||te.position.y!==Me.position.y)&&Gt.some(ie=>ie.x===te.position.x&&ie.y===te.position.y));if(lt){D.set(Me.id,{target:F({},lt.position),type:"merge"}),R.add(Me.id),Qt=!0;break}}Qt||this.aiSpawnTier(Le,1,new Set)}this.reclamationGoalsSignal.set(D),this.appendLog(`[AI Mode] Reclamation active. Player controls ${(r*100).toFixed(0)}% of resources.`)}else this.reclamationGoalsSignal.set(new Map);let a=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)).length>3;{let D=0,w=50,M=this.baseHealthSignal().ai<50?20:70;for(;this.aiWoodSignal()>M;){if(D++,D>w){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let D=this.forestsSignal().length,w=this.unitsSignal().filter(lt=>lt.owner==="ai"&&this.isForest(lt.position.x,lt.position.y)).length,R=this.unitsSignal().filter(lt=>lt.owner==="player"&&this.isForest(lt.position.x,lt.position.y)).length,M=this.settings.difficulty(),me=D>0?R/D:0,Le="none";R<=w?Le="none":me>=.9||R>=9?Le="rage":R>=w+(M==="baby"?4:M==="normal"?3:M==="hard"?2:1)?Le="angry":Le="none",this.aiMoodSignal.set(Le);let fe=this.turnSignal()%2===0,Lt=this.turnSignal()%5===0,Qt=D>0?w/D:0,Me=this.totalWarModeSignal(),Gt=Qt>=.65;if(!Me&&Gt)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(Gt),Le==="rage"){let lt=M==="baby"?fe?1:2:M==="normal"?fe?3:2:M==="hard"?fe?4:3:4;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+lt}))}else if(Le==="angry"){if(M==="baby")Lt&&this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+1}));else if(fe){let lt=M==="normal"?fe?1:0:M==="hard"?Lt?2:1:2;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+lt}))}}}catch{}if(this.manageInfrastructure(),this.turnSignal()<=10){let D=0,w=this.getPointsForTierLevel(1,1);for(;this.reservePointsSignal().ai>=w&&D<2&&this.aiSpawnTier(1,1,new Set)!==0;)D++,await new Promise(M=>setTimeout(M,60))}await new Promise(D=>setTimeout(D,100));let l=this.unitsSignal().filter(D=>D.owner==="ai"),c=new Map(this.aiUnitTimeNearBaseSignal()),d=new Set(l.map(D=>D.id));for(let D of c.keys())d.has(D)||c.delete(D);for(let D of l)Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3?c.set(D.id,(c.get(D.id)||0)+1):c.set(D.id,0);this.aiUnitTimeNearBaseSignal.set(c);for(let D of l){let w=this.isForest(D.position.x,D.position.y);D.owner==="ai"&&w&&D.tier<=2&&this.anchorGatherer(D.id)}let h=this.unitsSignal().filter(D=>D.owner==="player"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,p=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,g=h>=p;this.aggressionModeSignal.set(g);let N=this.forestsSignal().filter(D=>!this.getUnitAt(D.x,D.y)).filter(D=>this.isVisibleToAi(D.x,D.y)),U=this.unitsSignal().filter(D=>D.owner==="ai");if(this.turnSignal()<=15){let D=this.aiQueuedUnitIdSignal(),w=D?U.find(M=>M.id===D):null;if(!(w&&!this.isForest(w.position.x,w.position.y)&&N.length>0)){let M=U.filter(Le=>Le.tier<=2&&!this.isForest(Le.position.x,Le.position.y)),me=M.length>0&&N.length>0?M.reduce((Le,fe)=>{let Lt=Math.min(...N.map(Me=>Math.abs(fe.position.x-Me.x)+Math.abs(fe.position.y-Me.y))),Qt=Math.min(...N.map(Me=>Math.abs(Le.position.x-Me.x)+Math.abs(Le.position.y-Me.y)));return Lt<Qt?fe:Le},M[0]):null;this.aiQueuedUnitIdSignal.set(me?me.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let D=this.getPointsForTierLevel(3,1),w=this.forestsSignal().length,R=this.unitsSignal().filter(Le=>Le.owner==="ai"&&this.isForest(Le.position.x,Le.position.y)).length,M=w>0?R/w:0;this.reservePointsSignal().ai>=D&&M<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let se=this.unitsSignal().filter(D=>D.owner==="player"&&Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3&&D.tier>=2);if(se.length>0){let D=se.reduce((w,R)=>this.calculateTotalPoints(R)>this.calculateTotalPoints(w)?R:w,se[0]);this.aiDefenseSpawn(D)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let D=this.aiStrategy.getWallBuildActions(this);for(let w of D){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(w.from,w.to)}}else this.tryDefensiveWallsNearForests();let Se=0,xe=10;for(;Se<xe&&this.executeOneFreeAction();)Se++,await new Promise(w=>setTimeout(w,100));this.aiQueuedUnitIdSignal.set(null);let Ae=this.getBasePosition("player"),Ie=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y)||this.isForge(D.position.x,D.position.y)||Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=4)),k={claimedTargets:new Set,priorityTargets:Ie},P=this.unitsSignal().filter(D=>D.owner==="ai"&&!D.hasActed).sort((D,w)=>w.tier-D.tier);for(let D of P){let w=this.unitsSignal().find(te=>te.id===D.id);if(!w||w.hasActed)continue;let R=null,me=this.calculateValidMoves(w).filter(te=>!k.claimedTargets.has(`${te.x},${te.y}`)),Le=Math.max(Math.abs(w.position.x-e.x),Math.abs(w.position.y-e.y)),fe=this.unitsSignal().filter(te=>te.owner==="player"&&Math.max(Math.abs(te.position.x-e.x),Math.abs(te.position.y-e.y))<=3);if(fe.length>0&&!this.isForest(w.position.x,w.position.y)&&Le<=6){let te=fe.reduce((Ee,ve)=>{let ye=Math.max(Math.abs(Ee.position.x-e.x),Math.abs(Ee.position.y-e.y));return Math.max(Math.abs(ve.position.x-e.x),Math.abs(ve.position.y-e.y))<ye?ve:Ee});if(me.some(Ee=>Ee.x===te.position.x&&Ee.y===te.position.y))R={type:"attack",target:te.position,reason:"Base Defense: Eliminate Threat"};else{let Ee=this.getNextStepTowards(w,te.position,me);Ee&&(R={type:"move",target:Ee,reason:"Base Defense: Intercept"})}}if(!R){let te=this.reclamationGoalsSignal().get(w.id);if(te){let ie=te.target,Ee=this.getUnitAt(ie.x,ie.y);if(Ee&&Ee.owner!==w.owner)if(me.some(ye=>ye.x===ie.x&&ye.y===ie.y))R={type:"attack",target:ie,reason:"Reclaim: Attack Occupier"};else{let ye=this.bfsPath(w.position,ie,{respectWalls:!0,avoidFriendlyUnits:!0});if(ye||(ye=this.bfsPath(w.position,ie,{avoidFriendlyUnits:!0})),ye&&ye.length>1){let E=ye[1],le=this.getWallBetween(w.position.x,w.position.y,E.x,E.y),We=this.getUnitAt(E.x,E.y);if(We&&We.owner!==w.owner){let qe=this.effectiveAttack(We)>this.effectiveDefense(w),ae=me.some(bt=>bt.x===E.x&&bt.y===E.y);if(qe&&ae)R={type:"attack",target:E,reason:"Reclaim: Engage Blocker"};else if(le)R={type:"wall_attack",target:E,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,E)){let bt=me.filter(oi=>{let Ss=Math.abs(oi.x-ie.x)+Math.abs(oi.y-ie.y),uh=Math.abs(E.x-ie.x)+Math.abs(E.y-ie.y);return Ss<=uh&&!this.isTileThreatenedByEnemy(w,oi)}),xi=bt.length>0?this.getNextStepTowards(w,ie,bt):null;R=xi?{type:"move",target:xi,reason:"Reclaim: Bypass Threat"}:{type:"move",target:E,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:E,reason:"Reclaim: Pursue Resource"}}else if(le)R={type:"wall_attack",target:E,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,E)){let qe=me.filter(bt=>{let xi=Math.abs(bt.x-ie.x)+Math.abs(bt.y-ie.y),oi=Math.abs(E.x-ie.x)+Math.abs(E.y-ie.y);return xi<=oi&&!this.isTileThreatenedByEnemy(w,bt)}),ae=qe.length>0?this.getNextStepTowards(w,ie,qe):null;R=ae?{type:"move",target:ae,reason:"Reclaim: Bypass Threat"}:{type:"move",target:E,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:E,reason:"Reclaim: Pursue Resource"}}}else if(te.type==="merge")if(me.some(ye=>ye.x===ie.x&&ye.y===ie.y))R={type:"move",target:ie,reason:"Reclaim: Merge to Counter"};else{let ye=this.getNextStepTowards(w,ie,me);ye&&(R=this.getWallBetween(w.position.x,w.position.y,ye.x,ye.y)?{type:"wall_attack",target:ye,reason:"Reclaim: Breach to Merge"}:{type:"move",target:ye,reason:"Reclaim: Approach Ally"})}else{let ve=this.getNextStepTowards(w,ie,me);if(ve){let ye=this.getWallBetween(w.position.x,w.position.y,ve.x,ve.y),E=this.getUnitAt(ve.x,ve.y);if(E&&E.owner!==w.owner){let le=this.effectiveAttack(E)>this.effectiveDefense(w),We=me.some(qe=>qe.x===ve.x&&qe.y===ve.y);if(le&&We)R={type:"attack",target:ve,reason:"Reclaim: Engage Blocker"};else if(ye)R={type:"wall_attack",target:ve,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,ve)){let qe=me.filter(bt=>{let xi=Math.abs(bt.x-ie.x)+Math.abs(bt.y-ie.y),oi=Math.abs(ve.x-ie.x)+Math.abs(ve.y-ie.y);return xi<=oi&&!this.isTileThreatenedByEnemy(w,bt)}),ae=qe.length>0?this.getNextStepTowards(w,ie,qe):null;R=ae?{type:"move",target:ae,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ve,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ve,reason:"Reclaim: Close Distance"}}else if(ye)R={type:"wall_attack",target:ve,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,ve)){let le=me.filter(qe=>{let ae=Math.abs(qe.x-ie.x)+Math.abs(qe.y-ie.y),bt=Math.abs(ve.x-ie.x)+Math.abs(ve.y-ie.y);return ae<=bt&&!this.isTileThreatenedByEnemy(w,qe)}),We=le.length>0?this.getNextStepTowards(w,ie,le):null;R=We?{type:"move",target:We,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ve,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ve,reason:"Reclaim: Close Distance"}}}}}if(this.isForest(w.position.x,w.position.y)){let te=this.calculateValidMoves(w),ie=this.findCombatTarget(w,k,te);if(ie)R={type:"attack",target:ie,reason:"Defense: Defend Forest"};else{if(this.aiWoodSignal()>=50){let Ee=this.findDefensiveWallTarget(w);Ee&&(R={type:"build_wall",target:Ee,reason:"Defense: Fortify Position"})}if(!R&&!this.isUnitInDanger(w)){this.unitsSignal.update(ve=>ve.map(ye=>ye.id===w.id?ue(F({},ye),{hasActed:!0}):ye));continue}}}if(!R&&this.isMine(w.position.x,w.position.y)){let te=this.calculateValidMoves(w),ie=this.findCombatTarget(w,k,te);if(ie)R={type:"attack",target:ie,reason:"Defense: Defend Mine"};else if(!this.isUnitInDanger(w)){this.unitsSignal.update(ve=>ve.map(ye=>ye.id===w.id?ue(F({},ye),{hasActed:!0}):ye));continue}}let Lt=this.forestsSignal().length,Qt=this.unitsSignal().filter(te=>te.owner==="ai"&&this.isForest(te.position.x,te.position.y)).length,Me=Lt>0?Qt/Lt:0,Gt=w.tier>=3||Me>=.7,lt=Math.max(Math.abs(w.position.x-Ae.x),Math.abs(w.position.y-Ae.y));if(!R&&lt<4){if(Gt&&lt<=3){let te=[];me.some(le=>le.x===Ae.x&&le.y===Ae.y)&&te.push({type:"attack",target:Ae,weight:1,reason:"Siege: Strike Base"});let Ee=this.getNeighbors(w.position),ve=lt,ye=!1;for(let le of Ee)this.getWallBetween(w.position.x,w.position.y,le.x,le.y)&&Math.max(Math.abs(le.x-Ae.x),Math.abs(le.y-Ae.y))<ve&&(te.push({type:"wall_attack",target:le,weight:.9,reason:"Siege: Breach (Path to Base)"}),ye=!0);let E=this.getNextStepTowards(w,Ae,me,{noCohesion:!0});if(E){let le=Math.max(Math.abs(E.x-Ae.x),Math.abs(E.y-Ae.y));(!ye||le<ve)&&te.push({type:"move",target:E,weight:.5,reason:"Siege: Advance on Base"})}if(te.length>0){te.sort((We,qe)=>qe.weight-We.weight);let le=te[0];R={type:le.type,target:le.target,reason:le.reason},le.type==="move"&&ye&&this.appendLog(`[AI Debug] Unit at (${w.position.x},${w.position.y}) chose Move over Wall Attack. Weights: wall=0.9, move=${le.weight}`)}}if(!R)if(me.some(ie=>ie.x===Ae.x&&ie.y===Ae.y))R={type:"attack",target:Ae,reason:"Siege: Strike Base"};else{let ie=this.getNextStepTowards(w,Ae,me,{noCohesion:!0});if(ie)this.getWallBetween(w.position.x,w.position.y,ie.x,ie.y)?R={type:"wall_attack",target:ie,reason:"Siege: Breach"}:R={type:"move",target:ie,reason:"Siege: Advance on Base"};else{let Ee=this.bfsPath(w.position,Ae);if(Ee&&Ee.length>1){let ve=Ee[1];this.getWallBetween(w.position.x,w.position.y,ve.x,ve.y)&&(R={type:"wall_attack",target:ve,reason:"Siege: Breaching"})}}}}if(!R){let te=this.aiForgesSignal(),ie=this.unitsSignal().filter(ve=>ve.owner==="player"),Ee=[];for(let ve of te)for(let ye of ie)Math.max(Math.abs(ye.position.x-ve.x),Math.abs(ye.position.y-ve.y))<=3&&Ee.push(ye);if(Ee.length>0){let ve=Ee.reduce((E,le)=>{let We=Math.abs(E.position.x-w.position.x)+Math.abs(E.position.y-w.position.y);return Math.abs(le.position.x-w.position.x)+Math.abs(le.position.y-w.position.y)<We?le:E});if(me.some(E=>E.x===ve.position.x&&E.y===ve.position.y))R={type:"attack",target:ve.position,reason:"Defense: Guard Forge"};else{let E=this.getNextStepTowards(w,ve.position,me);E&&(R=this.getWallBetween(w.position.x,w.position.y,E.x,E.y)?{type:"wall_attack",target:E,reason:"Defense: Breach to Forge"}:{type:"move",target:E,reason:"Defense: Approach Forge Threat"})}}}if(!R&&w.tier>=2&&(!w.hasArmor||!w.hasWeapon)){let te=this.seekUpgrades(w,me);te.type==="move"&&te.target&&(R={type:"move",target:te.target,reason:"Upgrade: Move to Forge"})}if(!R){let te=this.isUnitInDanger(w),ie=this.reclamationGoalsSignal().has(w.id);if(!ie&&te){let Ee=this.findSafeMove(w,me);Ee&&(R={type:"move",target:Ee,reason:"Survival: Evade Threat"})}else if(ie&&te&&this.getNeighbors(w.position).some(ye=>{let E=this.getUnitAt(ye.x,ye.y);return!E||E.owner===w.owner?!1:this.effectiveAttack(E)>this.effectiveDefense(w)+(w.tier>=3?10:0)})){let ye=this.findSafeMove(w,me);ye&&(R={type:"move",target:ye,reason:"Survival: Lethal Evade"})}}if(!R&&w.tier===4){let te=this.unitsSignal().filter(ie=>ie.owner==="player");if(te.length>0){let ie=this.getBasePosition("player"),Ee=te.map(ye=>({u:ye,baseDist:Math.max(Math.abs(ye.position.x-ie.x),Math.abs(ye.position.y-ie.y))})).sort((ye,E)=>ye.u.tier!==E.u.tier?ye.u.tier-E.u.tier:ye.baseDist-E.baseDist)[0].u,ve=this.getNextStepTowards(w,Ee.position,me);ve&&(R={type:"move",target:ve,reason:"T4 Raid: Flank Backline"})}}if(!R){let te=this.computeSideEffectivePower("ai"),ie=this.computeSideEffectivePower("player");if(ie>0&&te>ie*1.2&&!this.isForest(w.position.x,w.position.y)&&parseInt(w.id.slice(-1),16)%2===0){let ye=this.unitsSignal().filter(We=>We.owner==="player"),E=Ae;if(ye.length>0&&(E=ye.reduce((qe,ae)=>{let bt=Math.max(Math.abs(qe.position.x-w.position.x),Math.abs(qe.position.y-w.position.y));return Math.max(Math.abs(ae.position.x-w.position.x),Math.abs(ae.position.y-w.position.y))<bt?ae:qe}).position),Math.max(Math.abs(E.x-w.position.x),Math.abs(E.y-w.position.y))<=1){let We=this.findCombatTarget(w,k,me);We&&(R={type:"attack",target:We,reason:"Siege: Engage Enemy"})}else{let We=this.getNextStepTowards(w,E,me,{noCohesion:!0});if(We)R={type:"move",target:We,reason:"Siege: Advance"};else{let qe=this.bfsPath(w.position,E);if(qe&&qe.length>1){let ae=qe[1];this.getWallBetween(w.position.x,w.position.y,ae.x,ae.y)&&(R={type:"wall_attack",target:ae,reason:"Siege: Breaching"})}}}}if(!R){let ye=this.findResourceTarget(w,k);if(ye){let E=this.bfsPath(w.position,ye,{respectWalls:!0,avoidFriendlyUnits:!0});if(E||(E=this.bfsPath(w.position,ye,{avoidFriendlyUnits:!0})),E&&E.length>1){let le=E[1],We=this.getWallBetween(w.position.x,w.position.y,le.x,le.y);We?We.owner==="ai"&&this.isBaseProtectionEdge(w.position,le)||(R={type:"wall_attack",target:le,reason:"Objective: Breaching Wall"}):me.some(qe=>qe.x===le.x&&qe.y===le.y)&&(R={type:"move",target:le,reason:"Objective: Capture Resource"})}}}}if(!R){let te=this.findCombatTarget(w,k,me);te&&(R={type:"attack",target:te,reason:"Combat: Engage Enemy"})}if(!R&&this.aiWoodSignal()>=10&&this.getNeighbors(w.position).some(Ee=>this.isForest(Ee.x,Ee.y)&&this.getUnitAt(Ee.x,Ee.y)?.owner==="ai")){let Ee=this.findDefensiveWallTarget(w);Ee&&(R={type:"build_wall",target:Ee,reason:"Defense: Fortify Perimeter"})}if(!R){let te=Ae,ie=this.findFallbackMove(w,me,te);ie&&(R={type:"move",target:ie,reason:"Fallback: Advance on Enemy"})}if(R){if(this.appendLog(`[AI Unit ${w.id.substring(0,4)}] Action: ${R.reason} -> Target: (${R.target.x},${R.target.y})`),R.type==="build_wall")this.aiBuildWallBetween(w.position,R.target);else{if(R.type==="move"){let te=this.getUnitAt(R.target.x,R.target.y);if(te&&te.owner==="ai"&&te.tier===w.tier){let ie=new Map(this.mergeIntentSignal());ie.set(w.id,te.id),ie.set(te.id,w.id),this.mergeIntentSignal.set(ie)}}this.executeMove(w,R.target)}k.claimedTargets.add(`${R.target.x},${R.target.y}`)}else this.appendLog(`[AI Unit ${w.id.substring(0,4)}] No valid moves. Passing.`),this.unitsSignal.update(te=>te.map(ie=>ie.id===w.id?ue(F({},ie),{hasActed:!0}):ie));await new Promise(te=>setTimeout(te,60))}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(s=>s.owner==="player"&&Math.max(Math.abs(s.position.x-e.x),Math.abs(s.position.y-e.y))<=3&&s.tier>=2);if(t.length>0){let s=t.reduce((l,c)=>this.calculateTotalPoints(c)>this.calculateTotalPoints(l)?c:l,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(s))return!0}let i=this.unitsSignal().filter(s=>s.owner==="ai").length;if(i<6){let s=this.reservePointsSignal().ai,a=this.getPointsForTierLevel(2,1);if(s>=a&&this.aiSpawnTier(2,1,new Set)>0)return!0}let o=this.baseHealthSignal().ai<50?20:70;if(this.aiWoodSignal()>=o)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;{let s=this.reservePointsSignal().ai,a=this.unitsSignal().filter(l=>l.owner==="ai"&&this.isForest(l.position.x,l.position.y)).length;if(s>25&&a>5&&this.aiSpawnTier(3,1,new Set,!0)>0)return!0}if(t.length===0)try{let s=this.getPointsForTierLevel(3,1),a=this.forestsSignal().length,l=this.unitsSignal().filter(h=>h.owner==="ai"&&this.isForest(h.position.x,h.position.y)).length,c=a>0?l/a:0,d=this.reservePointsSignal().ai;if(i>=6&&d>=s&&c<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),i=[],r=e.position.x,o=e.position.y,s=Math.sign(t.x-r),a=Math.sign(t.y-o);{let p=0,g=Math.max(10,this.gridSize*2);for(;r!==t.x||o!==t.y;){if(p++,p>g){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(r+=s,o+=a,!this.inBounds(r,o)||r===t.x&&o===t.y)break;i.push({x:r,y:o})}}let l=i.reverse().find(p=>!this.getUnitAt(p.x,p.y))||(()=>{for(let p=-1;p<=1;p++)for(let g=-1;g<=1;g++){if(p===0&&g===0)continue;let x=t.x+p,S=t.y+g;if(this.inBounds(x,S)&&!this.getUnitAt(x,S))return{x,y:S}}return null})();if(!l)return!1;{let p=0,g=50;for(;this.aiWoodSignal()>=20;){if(p++,p>g){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let c=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(c);if(d<=0)return!1;let h=this.calculateTierAndLevel(d);return this.unitsSignal().filter(g=>g.owner==="ai"&&g.tier===h.tier&&!this.isForest(g.position.x,g.position.y)).length>=5?!1:(this.unitsSignal.update(p=>[...p,{id:crypto.randomUUID(),position:F({},l),level:h.level,tier:h.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1}]),this.reservePointsSignal.update(p=>({player:p.player,ai:p.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,i,r=!1){let o=this.getBasePosition("ai"),s=[],a=2;for(let N=-a;N<=a;N++)for(let U=-a;U<=a;U++){if(N===0&&U===0)continue;let se=o.x+N,Se=o.y+U;if(!this.inBounds(se,Se)||Math.max(Math.abs(N),Math.abs(U))>a)continue;let xe=`${se},${Se}`;i.has(xe)||this.getUnitAt(se,Se)||s.push({x:se,y:Se})}let l=this.aiForgesSignal(),c=this.aiIronSignal()<40;c&&l.length>0&&s.sort((N,U)=>{let se=l.reduce((xe,Ae)=>Math.min(xe,Math.max(Math.abs(N.x-Ae.x),Math.abs(N.y-Ae.y))),1/0);return l.reduce((xe,Ae)=>Math.min(xe,Math.max(Math.abs(U.x-Ae.x),Math.abs(U.y-Ae.y))),1/0)-se});let d=this.reservePointsSignal().ai,h=this.getPointsForTierLevel(e,1),p=0,g=[],x=N=>this.unitsSignal().filter(U=>U.owner==="ai"&&U.tier===N&&!this.isForest(U.position.x,U.position.y)).length;if(x(e)>=5&&!(r&&e===3))return 0;for(let N of s){if(p>=t||d<h||x(e)>=5)break;let U=this.calculateTierAndLevel(h);g.push({id:crypto.randomUUID(),position:F({},N),level:U.level,tier:U.tier,points:h,owner:"ai",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}),d-=h,p++}if(g.length>0){this.unitsSignal.update(se=>[...se,...g]),this.reservePointsSignal.update(se=>({player:se.player,ai:d})),this.recomputeVisibility();let N=new Map(this.ignoreForgeUntilTurnSignal()),U=this.turnSignal()+(c?2:1);for(let se of g)N.set(se.id,U);this.ignoreForgeUntilTurnSignal.set(N)}return p}aiConvertWoodToReserve(){let e=this.aiWoodSignal(),i=this.baseHealthSignal().ai<50?20:70;e<i||(this.aiWoodSignal.update(r=>r-20),this.reservePointsSignal.update(r=>({player:r.player,ai:r.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(i=>{if(i.some(s=>s.position.x===t.x&&s.position.y===t.y))return i;let o={id:crypto.randomUUID(),position:F({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};return[...i,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),i=2,r=[];for(let c=-i;c<=i;c++)for(let d=-i;d<=i;d++){let h=t.x+c,p=t.y+d;this.inBounds(h,p)&&(c===0&&d===0||Math.max(Math.abs(c),Math.abs(d))>i||r.push({x:h,y:p}))}let o=this.settings.difficulty(),s;o==="baby"?s=[{tier:4,level:1},{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}]:s=[{tier:1,level:1},{tier:1,level:1}];let a=[],l=(c,d)=>this.unitsSignal().some(h=>h.position.x===c&&h.position.y===d)||a.some(h=>h.position.x===c&&h.position.y===d);for(let c of s){let d=r.filter(x=>!l(x.x,x.y));if(d.length===0)break;let h=Math.floor(Math.random()*d.length),p=d[h],g=this.getPointsForTierLevel(c.tier,c.level);a.push({id:crypto.randomUUID(),position:F({},p),level:c.level,tier:c.tier,points:g,owner:e,turnsStationary:0,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0})}a.length>0&&this.unitsSignal.update(c=>[...c,...a])}getUnitAt(e,t){return this.unitsSignal().find(i=>i.position.x===e&&i.position.y===t)}getWallBetween(e,t,i,r){let o={x:e,y:t},s={x:i,y:r};if(!this.areAdjacent(o,s))return;let[a,l]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(c=>c.tile1.x===a.x&&c.tile1.y===a.y&&c.tile2.x===l.x&&c.tile2.y===l.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(i,r,o,s)=>this.getWallBetween(i,r,o,s))}isValidMove(e,t){return this.validMoves().some(i=>i.x===e&&i.y===t)}isForest(e,t){return this.forestsSignal().some(i=>i.x===e&&i.y===t)}isMine(e,t){return this.minesSignal().some(i=>i.x===e&&i.y===t)}isForgeSite(e,t){return this.forgeSitesSignal().some(i=>i.position.x===e&&i.position.y===t)}isForge(e,t){return this.forgesSignal().some(i=>i.x===e&&i.y===t)}getForgeProgress(e,t){let i=this.forgeSitesSignal().find(o=>o.position.x===e&&o.position.y===t);if(!i)return 0;let r=5;return Math.round((r-i.turnsLeft)/r*100)}canBuildForgeAt(e,t){let i=this.getBasePosition("player");if(Math.max(Math.abs(e-i.x),Math.abs(t-i.y))>2||!this.inBounds(e,t)||e===i.x&&t===i.y||this.getUnitAt(e,t)||this.isForest(e,t)||this.isMine(e,t)||this.isForgeSite(e,t)||this.isForge(e,t))return!1;let o=this.resourcesSignal();return o.wood>=40&&o.iron>=20&&this.isPlayerTurn()}buildForgeAt(e){this.canBuildForgeAt(e.x,e.y)&&(this.resourcesSignal.update(t=>({wood:t.wood-40,iron:t.iron-20})),this.forgeSitesSignal.update(t=>[...t,{position:F({},e),owner:"player",turnsLeft:5}]))}buyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy weapon without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ue(F({},s),{hasWeapon:!0}):s)))}buyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy armor without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ue(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[Forge] Player unit equipped Armor (+20 Shield HP)."))}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}aiBuyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy armor without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ue(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[AI] AI unit equipped Heavy Armor (+20 Shield HP)."))}aiBuyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy weapon without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ue(F({},s),{hasWeapon:!0}):s)),this.appendLog("[AI] AI unit forged a Weapon (+20 ATK, +10 hit vs higher tier)."))}manageInfrastructure(){let e=this.aiForgesSignal().length+this.forgeSitesSignal().filter(c=>c.owner==="ai").length;if(e>=2)return;let t=this.aiWoodSignal(),i=this.aiIronSignal(),r=this.aiIronSignal();if(e===0){if(t<40||i<20)return}else if(e<2&&(r<=50||t<40||i<20))return;let o=this.getBasePosition("ai"),s=[];for(let c=-2;c<=2;c++)for(let d=-2;d<=2;d++){let h=o.x+c,p=o.y+d;this.inBounds(h,p)&&(h===o.x&&p===o.y||Math.max(Math.abs(c),Math.abs(d))>2||this.getUnitAt(h,p)||this.isForest(h,p)||this.isMine(h,p)||this.isForgeSite(h,p)||this.isForge(h,p)||s.push({x:h,y:p}))}if(s.length===0)return;let a=Math.floor(Math.random()*s.length),l=s[a];this.aiWoodSignal.update(c=>c-40),this.aiIronSignal.update(c=>c-20),this.forgeSitesSignal.update(c=>[...c,{position:F({},l),owner:"ai",turnsLeft:5}]),this.appendLog(`[AI] Constructing a Forge at (${l.x},${l.y}).`)}seekUpgrades(e,t){if(e.owner!=="ai")return{type:"none"};if(e.tier<2)return{type:"none"};if(e.hasArmor&&e.hasWeapon||this.aiIronSignal()<20)return{type:"none"};let i=this.aiForgesSignal();if(i.length===0)return{type:"none"};let r=this.getMergePartnerForUnit(e,t),o=this.aiIronSignal(),s=o>=100;if(s)this.appendLog(`[AI Wealth Override] T${e.tier} at (${e.position.x},${e.position.y}) bypassing normal checks (iron: ${o})`);else if(o<40){let h=this.computeHighestTierNeedingUpgrade();if(h>0&&e.tier<h)return{type:"none"}}if(!s&&r){let h=!e.hasWeapon&&r.hasWeapon,p=!e.hasArmor&&r.hasArmor;if(h||p){let g=h&&p?"Weapon & Armor":h?"Weapon":"Armor";return this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored ${g} purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) already has it).`),{type:"none"}}}let a=i.reduce((h,p)=>{let g=Math.max(Math.abs(p.x-e.position.x),Math.abs(p.y-e.position.y)),x=Math.max(Math.abs(h.x-e.position.x),Math.abs(h.y-e.position.y));return g<x?p:h},i[0]),c=this.ignoreForgeUntilTurnSignal().get(e.id)??0;if(this.turnSignal()<=c)return{type:"none"};if(e.position.x===a.x&&e.position.y===a.y){let h=this.aiIronSignal();if(r){let p=!1;return!r.hasArmor&&!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal(),p=!0),!r.hasWeapon&&!e.hasWeapon&&h>=20&&(this.aiBuyWeapon(e.id),p=!0),!p&&r.hasArmor&&r.hasWeapon&&this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) fully equipped).`),{type:"none"}}else return!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal()),!e.hasWeapon&&h>=20&&this.aiBuyWeapon(e.id),{type:"none"}}let d=this.getNextStepTowards(e,a,t);return d?{type:"move",target:d}:{type:"none"}}seekUpgradesFor(e,t,i){if(t.owner!==e)return{type:"none"};if(t.tier<2)return{type:"none"};let r=this.getIron(e);if(t.hasArmor&&t.hasWeapon||r<20)return{type:"none"};let o=this.getForges(e);if(o.length===0)return{type:"none"};let s=e==="ai"?this.getMergePartnerForUnit(t,i):this.getMergePartnerForUnit(t,i),a=this.getIron(e),l=e==="ai"&&a>=100;if(l)this.appendLog(`[AI Wealth Override] T${t.tier} at (${t.position.x},${t.position.y}) bypassing normal checks (iron: ${a})`);else if(a<40){let g=this.computeHighestTierNeedingUpgrade();if(g>0&&t.tier<g)return{type:"none"}}if(!l&&s){let g=!t.hasWeapon&&s.hasWeapon,x=!t.hasArmor&&s.hasArmor;if(g||x)return this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored ${g&&x?"Weapon & Armor":g?"Weapon":"Armor"} purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) already has it).`),{type:"none"}}let c=o.reduce((g,x)=>{let S=Math.max(Math.abs(x.x-t.position.x),Math.abs(x.y-t.position.y)),N=Math.max(Math.abs(g.x-t.position.x),Math.abs(g.y-t.position.y));return S<N?x:g},o[0]),h=this.ignoreForgeUntilTurnSignal().get(t.id)??0;if(this.turnSignal()<=h)return{type:"none"};if(t.position.x===c.x&&t.position.y===c.y){let g=this.getIron(e);if(s){let x=!1;return!s.hasArmor&&!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e),x=!0),!s.hasWeapon&&!t.hasWeapon&&g>=20&&(this.buyWeaponGeneric(e,t.id),x=!0),!x&&s.hasArmor&&s.hasWeapon&&this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) fully equipped).`),{type:"none"}}else return!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e)),!t.hasWeapon&&g>=20&&this.buyWeaponGeneric(e,t.id),{type:"none"}}let p=this.getNextStepTowards(t,c,i,void 0);return p?{type:"move",target:p}:{type:"none"}}async executeBotTurn(e){if(this.activeSideSignal()!==e||this.gameStatus()!=="playing")return;let t=e==="ai"?"player":"ai",i=this.getBasePosition(t),r=this.getBasePosition("player"),o=this.getBasePosition("ai"),s=this.forestsSignal().length+this.minesSignal().length,a=this.unitsSignal().filter(p=>p.owner===t&&(this.isForest(p.position.x,p.position.y)||this.isMine(p.position.x,p.position.y)));if((s>0?a.length/s:0)>.5){let p=new Map,g=this.unitsSignal().filter(N=>N.owner===e&&!N.hasActed),x=new Set,S=a.slice().sort((N,U)=>U.tier-N.tier);for(let N of S){let U=Math.min(4,N.tier+1),se=g.filter(xe=>xe.tier===U&&!x.has(xe.id)).sort((xe,Ae)=>{let Ie=Math.max(Math.abs(xe.position.x-N.position.x),Math.abs(xe.position.y-N.position.y)),k=Math.max(Math.abs(Ae.position.x-N.position.x),Math.abs(Ae.position.y-N.position.y));return Ie-k});if(se.length>0){let xe=se[0];p.set(xe.id,{target:F({},N.position),type:"hunt"}),x.add(xe.id);continue}let Se=g.filter(xe=>xe.tier===N.tier&&!x.has(xe.id));for(let xe of Se){let Ae=this.calculateValidMoves(xe),Ie=this.unitsSignal().find(k=>k.owner===e&&k.tier===xe.tier&&(k.position.x!==xe.position.x||k.position.y!==xe.position.y)&&Ae.some(I=>I.x===k.position.x&&I.y===k.position.y));if(Ie){p.set(xe.id,{target:F({},Ie.position),type:"merge"}),x.add(xe.id);break}}}e==="ai"?this.reclamationGoalsSignal.set(p):this.reclamationGoalsSignal.set(p)}else this.reclamationGoalsSignal.set(new Map);let d=this.unitsSignal().filter(p=>p.owner===e&&!p.hasActed),h={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(p=>p.owner===t&&p.tier>=3)};for(let p of d){let g=null,x=this.calculateValidMoves(p),S=this.getForges(e),N=this.unitsSignal().filter(Ie=>Ie.owner===t),U=[];for(let Ie of S)for(let k of N)Math.max(Math.abs(k.position.x-Ie.x),Math.abs(k.position.y-Ie.y))<=3&&U.push(k);if(U.length>0){let Ie=U.reduce((I,P)=>{let D=Math.abs(I.position.x-p.position.x)+Math.abs(I.position.y-p.position.y);return Math.abs(P.position.x-p.position.x)+Math.abs(P.position.y-p.position.y)<D?P:I});if(x.some(I=>I.x===Ie.position.x&&I.y===Ie.position.y))g={type:"attack",target:Ie.position,reason:"Defense: Guard Forge"};else{let I=this.getNextStepTowards(p,Ie.position,x);I&&(g=this.getWallBetween(p.position.x,p.position.y,I.x,I.y)?{type:"wall_attack",target:I,reason:"Defense: Breach to Forge"}:{type:"move",target:I,reason:"Defense: Approach Forge Threat"})}}if(!g&&p.tier>=2&&(!p.hasArmor||!p.hasWeapon)){let Ie=this.seekUpgradesFor(e,p,x);Ie.type==="move"&&Ie.target&&(g={type:"move",target:Ie.target,reason:"Upgrade: Move to Forge"})}let se=this.computeSideEffectivePower(e),Se=this.computeSideEffectivePower(t),Ae=Se>0&&se>Se*1.2&&!this.isForest(p.position.x,p.position.y)&&parseInt(p.id.slice(-1),16)%2===0;if(!g&&Ae){let Ie=this.getBasePosition(t);if(Math.max(Math.abs(Ie.x-p.position.x),Math.abs(Ie.y-p.position.y))<=1){let I=this.findCombatTarget(p,h,x);I&&(g={type:"attack",target:I,reason:"Siege: Engage Enemy"})}else{let I=this.getNextStepTowards(p,Ie,x,{noCohesion:!0});I&&(g={type:"move",target:I,reason:"Siege: Advance"})}}if(!g){let Ie=this.findCombatTarget(p,h,x);Ie&&(g={type:"attack",target:Ie,reason:"Combat: Engage Enemy"})}if(!g&&this.getWood(e)>=10&&this.getNeighbors(p.position).some(I=>this.isForest(I.x,I.y)&&this.getUnitAt(I.x,I.y)?.owner===e)){let I=this.findDefensiveWallTarget(p);I&&(g={type:"build_wall",target:I,reason:"Defense: Fortify Perimeter"})}if(!g){let Ie=t==="ai"?o:r,k=this.findFallbackMove(p,x,Ie);k&&(g={type:"move",target:k,reason:"Fallback: Advance on Enemy"})}g?g.type==="build_wall"?e==="ai"?this.aiBuildWallBetween(p.position,g.target):this.buildWallBetween(p.position,g.target):this.executeMove(p,g.target):this.unitsSignal.update(Ie=>Ie.map(k=>k.id===p.id?ue(F({},k),{hasActed:!0}):k)),await new Promise(Ie=>setTimeout(Ie,60))}e==="player"?this.endTurn():this.endTurn()}playerAutoStep(){if(!this.isPlayerTurn()||this.gameStatus()!=="playing")return!1;let e="player",t="ai",i=this.unitsSignal().find(a=>a.owner===e&&!a.hasActed);if(!i)return!1;let r=this.calculateValidMoves(i),o=this.seekUpgradesFor(e,i,r),s=null;if(o.type==="move"&&o.target&&(s={type:"move",target:o.target,reason:"Upgrade: Move to Forge"}),!s){let a=this.isForest(i.position.x,i.position.y),l=this.isMine(i.position.x,i.position.y),c=this.totalWarMode();if((a||l)&&!c&&!this.getNeighbors(i.position).some(p=>{let g=this.getUnitAt(p.x,p.y);return g&&g.owner===t}))return this.unitsSignal.update(p=>p.map(g=>g.id===i.id?ue(F({},g),{hasActed:!0}):g)),!0}if(!s){let a=this.findPlayerResourceTarget(i);if(a){let l=`${a.x},${a.y}`,c=new Set(this.playerClaimedTargetsSignal());c.add(l),this.playerClaimedTargetsSignal.set(c);let d=this.bfsPath(i.position,a,{respectWalls:!0,avoidFriendlyUnits:!0});if(d||(d=this.bfsPath(i.position,a,{avoidFriendlyUnits:!0})),d&&d.length>1){let h=d[1];this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?s={type:"wall_attack",target:h,reason:"Resource: Breach to Capture"}:r.some(g=>g.x===h.x&&g.y===h.y)&&(s={type:"move",target:h,reason:"Resource: Move to Capture"})}else{let h=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});h&&(s=this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?{type:"wall_attack",target:h,reason:"Resource: Breach"}:{type:"move",target:h,reason:"Resource: Advance"})}}}if(!s){let a={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(c=>c.owner===t&&c.tier>=3)},l=this.findCombatTarget(i,a,r);l&&(s={type:"attack",target:l,reason:"Combat: Engage Enemy"})}if(!s){let a=this.getBasePosition(t),l=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});l&&(s={type:"move",target:l,reason:"Advance"})}return s?(s.type==="build_wall"?this.buildWallBetween(i.position,s.target):s.type==="wall_attack"?this.attackOrDestroyWallBetween(i.position,s.target):this.executeMove(i,s.target),!0):(this.unitsSignal.update(a=>a.map(l=>l.id===i.id?ue(F({},l),{hasActed:!0}):l)),!1)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10)return;if(!this.canBuildWallBetween(e,t)){if(this.isEdgeOnCooldown(e,t)){let a=this.edgeCooldownRemaining(e,t);this.appendLog(`[Build] This area is too unstable to rebuild yet (CD: ${a} turns).`)}return}let r=this.getBestAdjacentPlayerUnit(e,t);if(!r||r.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.updateWallFormations(),this.resourcesSignal.update(a=>({wood:a.wood-10,iron:a.iron})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(l=>l.id===r.id?ue(F({},l),{hasActed:!0}):l))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20,iron:t.iron})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(i=>({wood:i.wood-t*20,iron:i.iron})),this.reservePointsSignal.update(i=>({player:i.player+t,ai:i.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let i=[];for(let r=-2;r<=2;r++)for(let o=-2;o<=2;o++){if(r===0&&o===0)continue;let s=t.x+r,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(r),Math.abs(o))>2)continue;this.getUnitAt(s,a)||i.push({x:s,y:a})}this.deployTargetsSignal.set(i),this.baseDeployActiveSignal.set(!0)}startSandboxSpawn(e,t){this.settings.customMode()&&this.sandboxSpawnPendingSignal.set({owner:e,tier:t})}cancelSandboxSpawn(){this.sandboxSpawnPendingSignal.set(null)}spawnSandboxAt(e){let t=this.sandboxSpawnPendingSignal();if(!t||!this.settings.customMode()||this.getUnitAt(e.x,e.y))return;let i=this.getPointsForTierLevel(t.tier,1),r={id:crypto.randomUUID(),position:F({},e),level:1,tier:t.tier,points:i,owner:t.owner,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};this.unitsSignal.update(o=>[...o,r]),this.sandboxSpawnPendingSignal.set(null),this.recomputeVisibility()}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,l=e.y+s;this.inBounds(a,l)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,l)||t.push({x:a,y:l}))}let i=this.reservePointsSignal().player,r=[];for(let o of t){if(i<=0)break;let s=this.economy.getHighestAffordableCost(i);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(l=>[...l,{id:crypto.randomUUID(),position:F({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}]),i-=s,r.push(o)}r.length>0&&(this.reservePointsSignal.update(o=>({player:i,ai:o.ai})),this.recomputeVisibility())}botEconomyPhase(e){if(this.gameStatus()!=="playing"||e!=="player"||!this.isPlayerTurn())return!1;let t=!1;{let r=this.baseHealthSignal().player<50?20:50,o=0;for(;this.resourcesSignal().wood>=r+20;)this.convertWoodToReserve(),o+=20;o>0&&(this.appendLog(`[Auto-Engage] Player converted ${o} wood to reserves.`),t=!0)}try{let i=this.forgesSignal().length,r=this.forgeSitesSignal().length,o=i+r,s=this.resourcesSignal();if(o<2&&s.iron>=20&&s.wood>=40){let a=this.getBasePosition("player"),l=2,c=!1;for(let d=-l;d<=l&&!c;d++)for(let h=-l;h<=l&&!c;h++){if(d===0&&h===0)continue;let p=a.x+d,g=a.y+h;this.inBounds(p,g)&&(Math.max(Math.abs(d),Math.abs(h))>l||this.canBuildForgeAt(p,g)&&(this.appendLog(`[Auto-Engage] Player building Forge at (${p},${g}).`),this.buildForgeAt({x:p,y:g}),t=!0,c=!0))}}}catch{}if(!this.wallBuiltThisTurnSignal()&&this.resourcesSignal().wood>=10){let r=this.unitsSignal().filter(o=>o.owner==="player"&&this.isForest(o.position.x,o.position.y));for(let o of r){let s=this.findDefensiveWallTargetForOwner(o,"player");if(s){this.buildWallBetween(o.position,s),t=!0;break}}}{let i=this.unitsSignal().length;this.autoDeployFromReserves(),this.unitsSignal().length>i&&(t=!0)}return t}isDeployTarget(e,t){return this.deployTargetsSignal().some(i=>i.x===e&&i.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let i=this.economy.getHighestAffordableCost(t);if(i<=0)return;let r=this.calculateTierAndLevel(i);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:F({},e),level:r.level,tier:r.tier,points:i,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-i,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${r.tier}(L${r.level}) at (${e.x},${e.y}) costing ${i} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[i,r]=this.sortEdgeEndpoints(e,t);return`${i.x},${i.y}|${r.x},${r.y}`}registerWallDestroyedEdge(e,t){let i=this.edgeKey(e,t),r=new Map(this.wallCooldownSignal());r.set(i,this.turnSignal()),this.wallCooldownSignal.set(r)}isEdgeOnCooldown(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);return r===void 0?!1:5-(this.turnSignal()-r)>0}edgeCooldownRemaining(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);if(r===void 0)return 0;let o=5-(this.turnSignal()-r);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,i=!1){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(r.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(r.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(r.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;{let x=t.x-e.x,S=t.y-e.y,N=Math.abs(x)>=Math.abs(S),U=Math.sign(N?x:S),se=this.wallThicknessPx+2,Se=this.tileSizePx+se,xe=Math.round(Se*.35),Ae=N?U*xe:0,Ie=N?0:U*xe,k=new Set(this.attackingUnitsSignal());k.add(s.id),this.attackingUnitsSignal.set(k),this.attackerNudgeSignal.set({id:s.id,dx:Ae,dy:Ie}),setTimeout(()=>{this.attackerNudgeSignal.set({id:s.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let I=new Set(this.attackingUnitsSignal());I.delete(s.id),this.attackingUnitsSignal.set(I)},200)}let a=this.combat.getWallHitAmount(s.tier),[l,c]=this.sortEdgeEndpoints(e,t),d=r.maxHealth??100,h=Math.max(0,r.health-a);this.wallsSignal.update(x=>x.map(S=>S.id===r.id?ue(F({},S),{health:Math.max(0,S.health-a)}):S).filter(S=>S.health>0)),h<=0?(this.registerWallDestroyedEdge(l,c),this.updateWallFormations()):this.updateWallFormations(),this.shakenWallIdSignal.set(r.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let p=o==="player"?"Player":"AI",g=r.owner==="neutral"?"Neutral":r.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${s.tier} Unit attacked ${g} Wall. Damage: ${a}. Wall HP: ${h}/${d}.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(x=>x.map(S=>S.id===s.id?ue(F({},S),{hasActed:!0}):S)),o==="player"&&this.selectNextAvailableUnit()}destroyOwnWallBetween(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i||i.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==i.id));let[r,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(r,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`),this.updateWallFormations()}canDestroyOwnWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||i.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!i||i.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||!this.canActThisTurn()?!1:i.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(i=>i.owner==="player"&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let i=this.getAdjacentPlayerUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="ai"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentAiUnit(e,t){let i=this.getAdjacentAiUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<50)return;let i=this.getBestAdjacentAiUnit(e,t);if(!i||i.hasActed||!this.unitsSignal().filter(l=>l.owner==="player").some(l=>{let c=Math.max(Math.abs(l.position.x-e.x),Math.abs(l.position.y-e.y)),d=Math.max(Math.abs(l.position.x-t.x),Math.abs(l.position.y-t.y));return c<=2||d<=2?l.tier>=i.tier:!1})||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let[s,a]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(l=>[...l,{id:crypto.randomUUID(),tile1:{x:s.x,y:s.y},tile2:{x:a.x,y:a.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(l=>l-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(l=>l.map(c=>c.id===i.id?ue(F({},c),{hasActed:!0}):c)),this.updateWallFormations()}isBaseProtectionEdge(e,t){let i=this.getBasePosition("ai"),r=o=>Math.max(Math.abs(o.x-i.x),Math.abs(o.y-i.y))<=1||o.x===i.x&&o.y===i.y;return r(e)||r(t)}wouldCageElite(e,t){let i=(s,a,l,c)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:l,y:c}),h=this.sortEdgeEndpoints(e,t);return d[0].x===h[0].x&&d[0].y===h[0].y&&d[1].x===h[1].x&&d[1].y===h[1].y},r=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||i(s.x,s.y,a.x,a.y));{let l=Math.sign(a.x-s.x),c=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+l,s.y),h=this.getWallBetween(s.x,s.y,s.x,s.y+c),p=this.getWallBetween(a.x-l,a.y,a.x,a.y),g=this.getWallBetween(a.x,a.y-c,a.x,a.y);return!!(d||h||p||g||i(s.x,s.y,s.x+l,s.y)||i(s.x,s.y,s.x,s.y+c)||i(a.x-l,a.y,a.x,a.y)||i(a.x,a.y-c,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(l=>{let c={x:s.position.x+l.x,y:s.position.y+l.y};return this.inBounds(c.x,c.y)?!r(s.position,c):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(r=>r.owner==="ai"),t=this.unitsSignal().filter(r=>r.owner==="player"),i=this.getBasePosition("ai");for(let r of e){if(!this.isForest(r.position.x,r.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y))<=2);for(let s of o){let a=r.level??this.calculateTierAndLevel(r.points).level,l=s.level??this.calculateTierAndLevel(s.points).level,c=Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y)),d=Math.sign(s.position.x-r.position.x),h=Math.sign(s.position.y-r.position.y);if(Math.abs(d)+Math.abs(h)===2)continue;let p=c===1?{x:r.position.x+d,y:r.position.y+h}:{x:r.position.x+Math.sign(s.position.x-r.position.x),y:r.position.y+Math.sign(s.position.y-r.position.y)};if(!this.inBounds(p.x,p.y))continue;let g=Math.sign(i.x-r.position.x),x=Math.sign(i.y-r.position.y);if((p.x-r.position.x)*g+(p.y-r.position.y)*x>0)continue;let N=r.position,U=p;if(!this.getWallBetween(N.x,N.y,U.x,U.y)&&(l>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(N,U),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${N.x},${N.y})-(${U.x},${U.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let i=e.x<=t.x,r=e.y<=t.y;return i&&r?0:!i&&r?1:i&&!r?2:3}placeNeutralWalls(){let e=(i,r)=>{if(!this.areAdjacent(i,r)||!this.inBounds(i.x,i.y)||!this.inBounds(r.x,r.y)||this.getWallBetween(i.x,i.y,r.x,r.y))return;let[o,s]=this.sortEdgeEndpoints(i,r);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}]),this.updateWallFormations()},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let i of t){let r=[{x:i.x+1,y:i.y},{x:i.x-1,y:i.y},{x:i.x,y:i.y+1},{x:i.x,y:i.y-1}];for(let o of r)this.inBounds(o.x,o.y)&&e(i,o)}for(let i of this.forestsSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}for(let i of this.minesSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}}static \u0275fac=function(t){return new(t||n)(De(Ll),De(Cg),De(Dg),De(Mt),De(Ag),De(Mg),De(Rg),De(jn),De(mc))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};function hG(n,e){n&1&&(X(),j(0,"polygon",127))}function fG(n,e){n&1&&(X(),j(0,"polygon",127))}function pG(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",213),A())}function gG(n,e){n&1&&(X(),j(0,"polygon",127))}function mG(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",213),A())}function yG(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",214)(2,"polygon",215)(3,"polygon",216),A())}var s0=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(ge(ri),ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-game-rules"]],decls:694,vars:76,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","flex-col","justify-between"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"bg-gray-800/60","border","border-blue-500/30","rounded-lg","p-4","shadow-[0_0_15px_rgba(59,130,246,0.1)]"],[1,"text-lg","font-semibold","mb-3","flex","items-center","gap-2"],[1,"text-blue-400"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[45px]","text-center"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[60px]","text-center"],[1,"text-xs","text-gray-400","text-right","italic"],[1,"flex","flex-col","items-center","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","text-white"],[1,"flex","items-center","justify-between","gap-4","border-t","border-white/5","pt-3"],[1,"px-4","py-1","bg-blue-600","border-b-4","border-blue-800","rounded","text-xs","font-mono","text-white","font-bold"],[1,"text-xs","text-blue-300","font-semibold","uppercase","tracking-wider"],[1,"mt-4","p-2","bg-blue-500/10","border","border-blue-500/20","rounded","text-[10px]","text-blue-200/70","leading-tight"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"bg-gray-800/60","border","border-gray-700","rounded-xl","p-6","md:col-span-2","shadow-2xl","backdrop-blur-sm"],[1,"text-xs","uppercase","tracking-widest","text-gray-500","font-bold","mb-6","flex","items-center","gap-2"],[1,"w-8","h-[1px]","bg-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8","items-start"],[1,"space-y-6"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-gray-300","text-sm"],[1,"text-orange-400","font-bold"],[1,"text-blue-400","font-bold"],[1,"p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-xs","text-gray-400","leading-relaxed"],[1,"text-white","font-semibold"],[1,"lg:col-span-2","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-blue-500/50","transition-all","duration-300","flex","items-center","gap-4"],[1,"w-20","h-20","shrink-0"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],["cx","50","cy","50","r","32"],["cx","50","cy","50","r","31","fill","none","stroke","rgba(255,255,255,0.2)","stroke-width","2"],["x","50","y","62","text-anchor","middle","font-size","32","font-weight","800","fill","white"],["transform","translate(18, 5) scale(0.8)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","#60a5fa"],[1,"flex","flex-col"],[1,"text-blue-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"text-gray-300","text-sm","leading-tight"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-red-500/50","transition-all","duration-300","flex","items-center","gap-4"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],["transform","rotate(-45 50 50) translate(40, 10) scale(1.2)"],["x","5","y","0","width","2","height","10","fill","#f87171"],["x","3","y","10","width","6","height","2","fill","#991b1b"],[1,"text-red-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"p-4","bg-gray-800/40","rounded-lg","border","border-gray-700/30"],[1,"text-[10px]","uppercase","tracking-wider","text-gray-500","font-bold","mb-3"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"flex","justify-between","border-b","border-gray-700/50","pb-1"],[1,"text-gray-500"],[1,"text-white"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","#60a5fa","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],[1,"text-lg","font-semibold","mb-1"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","3"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","4"],[1,"mover","triangle","t1-path"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"flex","items-center","gap-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","theme-test-player"],[1,"flex","flex-col","flex-center"],[1,"flex","flex-center","gap-2"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-80"],["points","50,16 86,78 14,78","fill","var(--u-fill)"],["x","49","y","66","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2"],["viewBox","0 0 100 100"],["id","base-circle"],["id","eye"],["id","scan-lvl2"],["id","radar-lvl3"],["id","field-lvl4"],["cx","50","cy","50","r","14","fill","#94a3b8"],["cx","50","cy","50","r","4","fill","#e5e7eb"],["cx","50","cy","50","r","20","fill","none","stroke","#cbd5f5","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","#e5e7eb","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","#f8fafc"],["cx","50","cy","50","r","30","fill","none","stroke","#f1f5f9","stroke-width","1","opacity","0.4"],[1,"unit-svg-wrapper","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-70"],["cx","50","cy","55","r","6","fill","var(--u-core)"],["points","50,5 55,15 45,15","fill","var(--u-stroke)"],["points","92,82 82,78 86,70","fill","var(--u-stroke)"],["points","8,82 18,78 14,70","fill","var(--u-stroke)"],["points","50,2 95,85 5,85","fill","none","stroke","var(--u-core)","stroke-width","2"],["points","50,48 56,52 56,60 50,64 44,60 44,52","fill","var(--u-light)"],["points","50,-2 102,88 -2,88","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","opacity","0.6"],["points","50,-5 54,8 46,8","fill","var(--u-light)"],["points","92,82 88,70 80,78","fill","var(--u-light)"],["points","8,82 20,78 12,70","fill","var(--u-light)"],["id","base-shape"],["id","core"],["id","armor-lvl2"],["id","armor-lvl3"],["id","fortress-lvl4"],["id","fx"],["x","20","y","20","width","60","height","60","rx","6","fill","#2563eb"],["x","46","y","46","width","8","height","8","fill","#93c5fd"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","#60a5fa","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","#93c5fd","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","#bfdbfe"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","#60a5fa","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","#bfdbfe"],["x","78","y","12","width","10","height","10","fill","#bfdbfe"],["x","12","y","78","width","10","height","10","fill","#bfdbfe"],["x","78","y","78","width","10","height","10","fill","#bfdbfe"],["id","base-hex"],["id","links-lvl2"],["id","network-lvl3"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","#10b981"],["cx","50","cy","50","r","4","fill","#6ee7b7"],["x1","50","y1","20","x2","50","y2","40","stroke","#6ee7b7","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","#6ee7b7","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","#6ee7b7","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","#a7f3d0","stroke-width","2"],["cx","50","cy","20","r","3","fill","#34d399"],["cx","80","cy","50","r","3","fill","#34d399"],["cx","50","cy","80","r","3","fill","#34d399"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","#6ee7b7","stroke-width","1.5","stroke-dasharray","4 4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","unit-svg-wrapper-game_rules"],[1,"flex","items-center","gap-6","theme-test-player"],["viewBox","0 0 100 100",1,"w-full","h-full"],["cx","50","cy","50","r","20","fill","var(--u-fill)"],["cx","50","cy","50","r","4","fill","var(--u-light)"],["cx","50","cy","50","r","26","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","var(--u-light)","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","var(--u-light)"],["cx","50","cy","50","r","34","fill","none","stroke","var(--u-light)","stroke-width","1","opacity","0.4"],[1,"flex","items-center","gap-6","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-75"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-110"],["x","20","y","20","width","60","height","60","rx","6","fill","var(--u-dark)"],["x","46","y","46","width","8","height","8","fill","var(--u-core)"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","var(--u-light)"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","var(--u-light)"],["x","78","y","12","width","10","height","10","fill","var(--u-light)"],["x","12","y","78","width","10","height","10","fill","var(--u-light)"],["x","78","y","78","width","10","height","10","fill","var(--u-light)"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","var(--u-emerald)"],["cx","50","cy","50","r","4","fill","var(--u-emerald-stroke)"],["x1","50","y1","20","x2","50","y2","40","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","var(--u-emerald-stroke)","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","2"],["cx","50","cy","20","r","3","fill","var(--u-emerald-stroke)"],["cx","80","cy","50","r","3","fill","var(--u-emerald-stroke)"],["cx","50","cy","80","r","3","fill","var(--u-emerald-stroke)"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 56,10 44,10","fill","var(--u-light)"],["points","99,87 92,74 84,87","fill","var(--u-light)"],["points","1,87 15,87 8,74","fill","var(--u-light)"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),v(5),A(),C(6,"h3",5),v(7),A()(),C(8,"button",6),Bt("click",function(){return i.engine.closeRules()}),v(9," \u2716 "),A()(),C(10,"div",7)(11,"div",8)(12,"div",9),v(13),A(),C(14,"div",10)(15,"div",11)(16,"div",12),v(17,"\u{1F333}"),A(),C(18,"div")(19,"div",13),v(20),A(),C(21,"div",14),v(22),A()()(),C(23,"div",11)(24,"div",12),v(25,"\u{1F3F0}"),A(),C(26,"div")(27,"div",13),v(28),A(),C(29,"div",14),v(30),A()()()()(),C(31,"div",15)(32,"div",16)(33,"div",9),v(34),A(),C(35,"div",17)(36,"div",18)(37,"div",19),v(38," 1 "),A(),C(39,"div",20),v(40,"1\u20134"),A()(),C(41,"div",18)(42,"div",21),v(43," 5 "),A(),C(44,"div",20),v(45,"5\u201320"),A()(),C(46,"div",18)(47,"div",21),v(48,"25"),A(),C(49,"div",20),v(50,"25\u2013100"),A()(),C(51,"div",18)(52,"div",22)(53,"span",23),v(54,"125"),A()(),C(55,"div",20),v(56,"125\u2013500"),A()()()(),C(57,"div",16)(58,"div",24),v(59),A(),C(60,"div",25)(61,"div",26)(62,"div",27),v(63,"2"),A(),C(64,"div",28),v(65,"2"),A(),C(66,"div",29),v(67,"1"),A()()()()(),C(68,"div",30)(69,"div",31)(70,"span",32),v(71,"\u2328\uFE0F"),A(),v(72),A(),C(73,"div",33)(74,"div",34)(75,"div",35)(76,"kbd",36),v(77," Tab "),A(),C(78,"kbd",37),v(79," Space "),A()(),C(80,"div",38),v(81),A()(),C(82,"div",34)(83,"div",39)(84,"kbd",40),v(85,"\u2191"),A(),C(86,"div",35)(87,"kbd",40),v(88,"\u2190"),A(),C(89,"kbd",40),v(90,"\u2193"),A(),C(91,"kbd",40),v(92,"\u2192"),A()()(),C(93,"div",38),v(94),A()(),C(95,"div",41)(96,"kbd",42),v(97," Enter "),A(),C(98,"div",43),v(99),A()()(),C(100,"div",44)(101,"strong"),v(102,"TIP:"),A(),v(103),A()(),C(104,"div",8)(105,"div",9),v(106),A(),C(107,"div",45)(108,"div")(109,"div",46),v(110),A(),C(111,"div",47)(112,"div",48),v(113,"1"),A(),C(114,"div",49),v(115,"1"),A()(),C(116,"div",50),v(117),A()(),C(118,"div")(119,"div",46),v(120),A(),C(121,"div",47)(122,"div",48),v(123,"4"),A(),C(124,"div",51),v(125,"1"),A(),C(126,"span",52),v(127,"CRIT!"),A()(),C(128,"div",50),v(129),A()(),C(130,"div")(131,"div",46),v(132),A(),C(133,"div",47)(134,"div",48),v(135,"1"),A(),C(136,"div",53),v(137,"4"),A(),C(138,"span",54),v(139,"MISS!"),A()(),C(140,"div",50),v(141),A()()()(),C(142,"div",55)(143,"div",56),j(144,"span",57),v(145),A(),C(146,"div",58)(147,"div",59)(148,"div",60)(149,"div",61)(150,"span",62),v(151),A(),C(152,"span",63),v(153,"20%"),A()(),C(154,"div",61)(155,"span",62),v(156),A(),C(157,"span",64),v(158,"20%"),A()(),C(159,"div",65)(160,"p",66)(161,"span",67),v(162,"50%"),A(),v(163),A()()()(),C(164,"div",68)(165,"div",69)(166,"div",70),X(),C(167,"svg",71),j(168,"circle",72)(169,"circle",73),C(170,"text",74),v(171,"1"),A(),C(172,"g",75),j(173,"path",76),A()()(),Re(),C(174,"div",77)(175,"span",78),v(176,"+20 HP Bonus"),A(),C(177,"p",79),v(178),A()()(),C(179,"div",80)(180,"div",70),X(),C(181,"svg",81),j(182,"circle",72)(183,"circle",73),C(184,"text",74),v(185,"1"),A(),C(186,"g",82),j(187,"rect",83)(188,"rect",84),A()()(),Re(),C(189,"div",77)(190,"span",85),v(191,"+20 DMG Bonus"),A(),C(192,"p",79),v(193),A()()()(),C(194,"div",68)(195,"div",86)(196,"p",87),v(197),A(),C(198,"div",88)(199,"div",89)(200,"span",90),v(201,"T1"),A(),C(202,"span",91),v(203,"1"),A()(),C(204,"div",89)(205,"span",90),v(206,"T2"),A(),C(207,"span",91),v(208,"2"),A()(),C(209,"div",89)(210,"span",90),v(211,"T3"),A(),C(212,"span",91),v(213,"4"),A()(),C(214,"div",89)(215,"span",90),v(216,"T4"),A(),C(217,"span",91),v(218,"8"),A()()()(),C(219,"div",80)(220,"div",70),X(),C(221,"svg",81),j(222,"circle",72)(223,"circle",73),C(224,"text",74),v(225,"1"),A(),C(226,"g"),j(227,"path",92)(228,"path",93),A()()(),Re(),C(229,"div",77)(230,"p",79),v(231),A()()()()()(),C(232,"div",16)(233,"div",94),v(234),A(),C(235,"div",95)(236,"div")(237,"div",96),v(238),A(),C(239,"div",97),j(240,"div",98)(241,"div",98)(242,"div",98)(243,"div",98)(244,"div",98)(245,"div",98)(246,"div",99)(247,"div",99)(248,"div",98)(249,"div",98)(250,"div",98)(251,"div",98)(252,"div",98)(253,"div",98)(254,"div",98)(255,"div",98)(256,"div",98)(257,"div",98)(258,"div",98)(259,"div",98)(260,"div",98)(261,"div",98)(262,"div",98)(263,"div",98)(264,"div",98),C(265,"div",100),v(266,"2"),A(),j(267,"div",101),C(268,"div",102),v(269,"\u{1F3F0}"),A()()(),C(270,"div")(271,"div",96),v(272),A(),C(273,"div",103),j(274,"div",98)(275,"div",98)(276,"div",98)(277,"div",98)(278,"div",98)(279,"div",98)(280,"div",99)(281,"div",99)(282,"div",99)(283,"div",98)(284,"div",98)(285,"div",98)(286,"div",98)(287,"div",98)(288,"div",98)(289,"div",98)(290,"div",98)(291,"div",98)(292,"div",98)(293,"div",98)(294,"div",98)(295,"div",98)(296,"div",98)(297,"div",98)(298,"div",98),C(299,"div",104),v(300,"3"),A(),j(301,"div",101),C(302,"div",105),v(303,"\u{1F3F0}"),A()()(),C(304,"div")(305,"div",96),v(306),A(),C(307,"div",106),j(308,"div",98)(309,"div",98)(310,"div",98)(311,"div",98)(312,"div",98)(313,"div",98)(314,"div",99)(315,"div",99)(316,"div",99)(317,"div",99)(318,"div",98)(319,"div",98)(320,"div",98)(321,"div",98)(322,"div",98)(323,"div",98)(324,"div",98)(325,"div",98)(326,"div",98)(327,"div",98)(328,"div",98)(329,"div",98)(330,"div",98)(331,"div",98)(332,"div",98),C(333,"div",107),v(334,"4"),A(),j(335,"div",101),C(336,"div",102),v(337,"\u{1F3F0}"),A()()()()(),C(338,"div",15)(339,"div",16)(340,"div",9),v(341),A(),C(342,"div",17)(343,"div",108)(344,"div",109),v(345,"\u{1F331}"),A(),C(346,"div",110),v(347),A()(),C(348,"div",111),v(349,"\u2192"),A(),C(350,"div",108)(351,"div",109),v(352,"\u{1F33F}"),A(),C(353,"div",110),v(354),A()(),C(355,"div",111),v(356,"\u2192"),A(),C(357,"div",108)(358,"div",109),v(359,"\u{1F333}"),A(),C(360,"div",112),v(361),A()()()(),C(362,"div",16)(363,"div",9),v(364),A(),C(365,"div",113)(366,"div",108)(367,"div",109),v(368,"\u26F0\uFE0F"),A(),C(369,"div",114),v(370),A()(),C(371,"div",111),v(372,"\u2192"),A(),C(373,"div",108)(374,"div",109),v(375,"\u26CF\uFE0F"),A(),C(376,"div",114),v(377),A()(),C(378,"div",111),v(379,"\u2192"),A(),C(380,"div",108)(381,"div",109),v(382,"\u26CF"),A(),C(383,"div",114),v(384),A()(),C(385,"div",111),v(386,"\u2192"),A(),C(387,"div",108)(388,"div",109),v(389,"\u2692"),A(),C(390,"div",114),v(391),A()(),C(392,"div",111),v(393,"\u2192"),A(),C(394,"div",108)(395,"div",109),v(396,"\u{1F9F1}"),A(),C(397,"div",115),v(398),A()()()(),C(399,"div",16)(400,"div",116),v(401),A(),C(402,"div",117)(403,"div",3),j(404,"div",118),C(405,"div",20),v(406),A()(),C(407,"div",3),j(408,"div",119),C(409,"div",20),v(410),A()(),C(411,"div",3),j(412,"div",120),C(413,"div",20),v(414,"Neutral"),A()()()()(),C(415,"div",121)(416,"div",122)(417,"div",9),v(418),A(),C(419,"div",123),X(),C(420,"svg",124)(421,"g"),j(422,"polygon",125),A(),C(423,"text",126),v(424),A()(),C(425,"svg",124)(426,"g"),j(427,"polygon",125),A(),C(428,"text",126),v(429),A(),Q(430,hG,1,0,":svg:polygon",127),A(),C(431,"svg",124)(432,"g"),j(433,"polygon",125),A(),C(434,"text",126),v(435),A(),Q(436,fG,1,0,":svg:polygon",127),Q(437,pG,2,0,":svg:g"),A(),C(438,"svg",124)(439,"g"),j(440,"polygon",125),A(),C(441,"text",126),v(442),A(),Q(443,gG,1,0,":svg:polygon",127),Q(444,mG,2,0,":svg:g"),Q(445,yG,4,0,":svg:g"),A()()()(),Re(),C(446,"div",16)(447,"div",9),v(448),A(),C(449,"div",17),X(),C(450,"svg",128),j(451,"g",129)(452,"g",130)(453,"g",131)(454,"g",132)(455,"g",133),C(456,"g",129),j(457,"circle",134),A(),C(458,"g",130),j(459,"circle",135),A(),C(460,"g",131),j(461,"circle",136),A(),C(462,"g",132),j(463,"line",137)(464,"circle",138),A(),C(465,"g",133),j(466,"circle",139),A()(),Re(),C(467,"div",140),X(),C(468,"svg",141)(469,"g"),j(470,"polygon",125),A(),C(471,"g"),j(472,"circle",142),A(),C(473,"g"),j(474,"polygon",143)(475,"polygon",144)(476,"polygon",145),A(),C(477,"g"),j(478,"polygon",146)(479,"polygon",147),A(),C(480,"g"),j(481,"polygon",148)(482,"polygon",149)(483,"polygon",150)(484,"polygon",151),A()()(),C(485,"svg",128),j(486,"g",152)(487,"g",153)(488,"g",154)(489,"g",155)(490,"g",156)(491,"g",157),C(492,"g",152),j(493,"rect",158),A(),C(494,"g",153),j(495,"rect",159),A(),C(496,"g",154),j(497,"rect",160),A(),C(498,"g",155),j(499,"rect",161)(500,"rect",162),A(),C(501,"g",156),j(502,"rect",163)(503,"rect",164)(504,"rect",165)(505,"rect",166)(506,"rect",167),A()(),C(507,"svg",128),j(508,"g",168)(509,"g",153)(510,"g",169)(511,"g",170)(512,"g",133),C(513,"g",168),j(514,"polygon",171),A(),C(515,"g",153),j(516,"circle",172),A(),C(517,"g",169),j(518,"line",173)(519,"line",174)(520,"line",175),A(),C(521,"g",170),j(522,"polygon",176)(523,"circle",177)(524,"circle",178)(525,"circle",179),A(),C(526,"g",133),j(527,"polygon",180),A()()()(),Re(),C(528,"div",181)(529,"div",9),v(530),A(),C(531,"div",182),X(),C(532,"svg",183)(533,"g"),j(534,"circle",184),A(),C(535,"g"),j(536,"circle",185),A()(),C(537,"svg",183)(538,"g"),j(539,"circle",184),A(),C(540,"g"),j(541,"circle",185),A(),C(542,"g"),j(543,"circle",186),A()(),C(544,"svg",183)(545,"g"),j(546,"circle",184),A(),C(547,"g"),j(548,"circle",185),A(),C(549,"g"),j(550,"circle",186),A(),C(551,"g"),j(552,"line",187)(553,"circle",188),A()(),C(554,"svg",183)(555,"g"),j(556,"circle",184),A(),C(557,"g"),j(558,"circle",185),A(),C(559,"g"),j(560,"circle",186),A(),C(561,"g"),j(562,"line",187)(563,"circle",188),A(),C(564,"g"),j(565,"circle",189),A()()(),Re(),C(566,"div",190),X(),C(567,"svg",191)(568,"g"),j(569,"polygon",125),A(),C(570,"g"),j(571,"circle",142),A()(),C(572,"svg",191)(573,"g"),j(574,"polygon",125),A(),C(575,"g"),j(576,"circle",142),A(),C(577,"g"),j(578,"polygon",143)(579,"polygon",144)(580,"polygon",145),A()(),C(581,"svg",191)(582,"g"),j(583,"polygon",125),A(),C(584,"g"),j(585,"circle",142),A(),C(586,"g"),j(587,"polygon",143)(588,"polygon",144)(589,"polygon",145),A(),C(590,"g"),j(591,"polygon",146)(592,"polygon",147),A()(),C(593,"svg",141)(594,"g"),j(595,"polygon",125),A(),C(596,"g"),j(597,"circle",142),A(),C(598,"g"),j(599,"polygon",143)(600,"polygon",144)(601,"polygon",145),A(),C(602,"g"),j(603,"polygon",146)(604,"polygon",147),A(),C(605,"g"),j(606,"polygon",148)(607,"polygon",149)(608,"polygon",150)(609,"polygon",151),A()()(),Re(),C(610,"div",182),X(),C(611,"svg",192)(612,"g"),j(613,"rect",193),A(),C(614,"g"),j(615,"rect",194),A()(),C(616,"svg",192)(617,"g"),j(618,"rect",193),A(),C(619,"g"),j(620,"rect",194),A(),C(621,"g"),j(622,"rect",195),A()(),C(623,"svg",192)(624,"g"),j(625,"rect",193),A(),C(626,"g"),j(627,"rect",194),A(),C(628,"g"),j(629,"rect",195),A(),C(630,"g"),j(631,"rect",196)(632,"rect",197),A()(),C(633,"svg",192)(634,"g"),j(635,"rect",193),A(),C(636,"g"),j(637,"rect",194),A(),C(638,"g"),j(639,"rect",195),A(),C(640,"g"),j(641,"rect",196)(642,"rect",197),A(),C(643,"g"),j(644,"rect",198)(645,"rect",199)(646,"rect",200)(647,"rect",201)(648,"rect",202),A()()(),Re(),C(649,"div",190),X(),C(650,"svg",183)(651,"g"),j(652,"polygon",203),A(),C(653,"g"),j(654,"circle",204),A()(),C(655,"svg",183)(656,"g"),j(657,"polygon",203),A(),C(658,"g"),j(659,"circle",204),A(),C(660,"g"),j(661,"line",205)(662,"line",206)(663,"line",207),A()(),C(664,"svg",183)(665,"g"),j(666,"polygon",203),A(),C(667,"g"),j(668,"circle",204),A(),C(669,"g"),j(670,"line",205)(671,"line",206)(672,"line",207),A(),C(673,"g"),j(674,"polygon",208)(675,"circle",209)(676,"circle",210)(677,"circle",211),A()(),C(678,"svg",183)(679,"g"),j(680,"polygon",203),A(),C(681,"g"),j(682,"circle",204),A(),C(683,"g"),j(684,"line",205)(685,"line",206)(686,"line",207),A(),C(687,"g"),j(688,"polygon",208)(689,"circle",209)(690,"circle",210)(691,"circle",211),A(),C(692,"g"),j(693,"polygon",212),A()()()()()()()),t&2&&(y(5),q(i.settings.t("GAME_GUIDE")),y(2),q(i.settings.t("TURN_BASED_STRATEGY")),y(6),q(i.settings.t("VICTORY_CONDITIONS")),y(7),q(i.settings.t("MONOPOLY_LABEL")),y(2),q(i.settings.t("MONOPOLY_DESC")),y(6),q(i.settings.t("ANNIHILATION")),y(2),q(i.settings.t("ANNIHILATION_DESC")),y(4),q(i.settings.t("UNIT_EVOLUTION")),y(8),it("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),y(17),q(i.settings.t("EVOLUTION_DESC")),y(13),G(" ",i.settings.currentLang()==="uk"?"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0435 \u0443\u043F\u0440\u0430\u0432\u043B\u0456\u043D\u043D\u044F":"Tactical Controls"," "),y(9),G(" ",i.settings.currentLang()==="uk"?"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0438\u0439 \u0432\u0456\u043B\u044C\u043D\u0438\u0439 \u044E\u043D\u0456\u0442":"Cycle through available units"," "),y(13),G(" ",i.settings.currentLang()==="uk"?"\u0420\u0443\u0445 \u0430\u0431\u043E \u0430\u0442\u0430\u043A\u0430 \u0432\u0438\u0431\u0440\u0430\u043D\u0438\u043C \u044E\u043D\u0456\u0442\u043E\u043C":"Move or attack with selected unit"," "),y(5),G(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0445\u0456\u0434":"End player turn"," "),y(4),G(" ",i.settings.currentLang()==="uk"?"\u041D\u0430 \u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043A\u043E\u0436\u043D\u043E\u0433\u043E \u0445\u043E\u0434\u0443 \u0433\u0440\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u0444\u043E\u043A\u0443\u0441\u0443\u0454\u0442\u044C\u0441\u044F \u043D\u0430 \u043C\u043E\u0431\u0456\u043B\u044C\u043D\u043E\u043C\u0443 \u044E\u043D\u0456\u0442\u0456.":"At turn start, the game auto-focuses on your most mobile unit."," "),y(3),q(i.settings.t("COMBAT_DEEP_DIVE")),y(4),q(i.settings.t("SUCCESSFUL_ATTACK")),y(7),q(i.settings.t("SUCCESSFUL_ATTACK_DESC")),y(3),q(i.settings.t("CRITICAL_HIT")),y(9),q(i.settings.t("CRITICAL_HIT_DESC")),y(3),q(i.settings.t("MISS")),y(9),q(i.settings.t("MISS_DESC")),y(4),G(" ",i.settings.currentLang()==="uk"?"\u0414\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0438":"Extra Mechanics"," "),y(6),G(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043A\u0440\u0438\u0442\u0443":"Crit Chance"," "),y(5),G(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u0443":"Miss Chance"," "),y(7),G(" ",i.settings.currentLang()==="uk"?"\u043F\u0440\u0438 \u0440\u0456\u0432\u043D\u0438\u0445 \u0441\u0438\u043B\u0430\u0445: \u0417\u0430\u0445\u0438\u0441\u0442/\u041D\u0456\u0447\u0438\u044F":"at equal force: Defense/Draw"," "),y(5),Ft("fill","url(#vol-fill-player)"),y(10),G(" ",i.settings.currentLang()==="uk"?"-10% \u0443 \u0432\u043E\u0440\u043E\u0433\u0430 \u0448\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u043D\u0443\u0442\u0438\u0441\u044C":"-10% enemy chance to miss"," "),y(4),Ft("fill","url(#vol-fill-player)"),y(11),G(" ",i.settings.currentLang()==="uk"?"10% \u0448\u0430\u043D\u0441 \u043F\u043E\u043F\u0430\u0441\u0442\u0438 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0443":"10% chance to hit the enemy"," "),y(4),G(" ",i.settings.currentLang()==="uk"?"\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F Tier-\u0440\u0456\u0432\u043D\u0456\u0432":"Tier Values"," "),y(25),Ft("fill","url(#vol-fill-player)"),y(9),G(" ",i.settings.currentLang()==="uk"?"+1 \u0434\u043E \u0430\u0442\u0430\u043A\u0438 \u0432\u0456\u0434 \u0441\u0443\u0441\u0456\u0434\u0441\u0442\u0432\u0430":"+1 to an attack from the neighborhood"," "),y(3),q(i.settings.t("MOVEMENT")),y(4),q(i.settings.t("T1_1_TILE")),y(30),it("left",6,"px")("top",6,"px"),y(4),q(i.settings.t("T3_3_TILES")),y(30),it("right",6,"px")("bottom",6,"px"),y(4),q(i.settings.t("T4_4_TILES")),y(30),it("left",6,"px")("top",6,"px"),y(5),q(i.settings.t("FOREST_CYCLE")),y(6),q(i.settings.t("TURN_1")),y(7),q(i.settings.t("TURN_2")),y(7),q(i.settings.t("PLUS_8_WOOD_PER_TURN")),y(3),q(i.settings.t("IRON_CYCLE")),y(6),q(i.settings.t("TURN_1")),y(7),q(i.settings.t("TURN_2")),y(7),q(i.settings.t("TURN_3")),y(7),q(i.settings.t("TURN_4")),y(7),q(i.settings.t("PLUS_2_IRON_PER_TURN")),y(3),q(i.settings.t("WALL_LEGEND")),y(5),q(i.settings.t("PLAYER")),y(4),q(i.settings.t("AI_FACTION")),y(8),G(" ",i.settings.currentLang()==="uk"?"\u0422\u0440\u0435\u0442\u044F \u0456\u0442\u0435\u0440\u0430\u0446\u0456\u044F \u043E\u0434\u0438\u043D\u0438\u0446\u044C":"Third iteration the units"," "),y(6),G(" ",1," "),y(5),G(" ",2," "),y(),J(430),y(5),G(" ",3," "),y(),J(436),y(),J(437),y(5),G(" ",4," "),y(),J(443),y(),J(444),y(),J(445),y(3),q(i.settings.t("NEW_DESIGN_UNIT")),y(82),q(i.settings.t("NEW_UNIT_EVOLUTION")))},dependencies:[jt],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:60px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:10px;font-size:12px;font-weight:800;color:#fde047;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:10px;font-size:12px;font-weight:800;color:#93c5fd;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}.unit-svg-wrapper-game_rules:hover{transform:scale(1)}
`],encapsulation:2})};var a0=class n{constructor(e){this.gameEngine=e}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(ge(ri))};static \u0275cmp=Ct({type:n,selectors:[["app-support-community"]],decls:51,vars:0,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),v(4,"Support & Community"),A(),C(5,"button",4),Bt("click",function(){return i.gameEngine.closeSupport()}),v(6," \u2716 "),A()(),C(7,"div",5)(8,"div",6)(9,"div",7),v(10,"Donate"),A(),C(11,"div",8),v(12,"Monobank Jar"),A(),C(13,"div",9)(14,"div",10),j(15,"img",11),A(),C(16,"div",12)(17,"div",13),v(18,"send.monobank.ua/jar/2fqGoPhV7G"),A(),C(19,"div",14)(20,"button",15),Bt("click",function(){return i.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(21," Open Link \u{1F4DC} "),A(),C(22,"button",16),Bt("click",function(){return i.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(23," Copy Link \u{1F4CB} "),A()()()(),C(24,"div",17)(25,"div",8),v(26,"Donatello"),A(),C(27,"button",18),Bt("click",function(){return i.openExternalLink("https://donatello.to/jaerbi")}),v(28," Go to Donatello.to \u{1F48E} "),A()(),C(29,"div",19),v(30,"Thank you for supporting the project!"),A()(),C(31,"div",6)(32,"div",7),v(33,"Social & Feedback"),A(),C(34,"div",20)(35,"button",21),Bt("click",function(){return i.openExternalLink("https://discord.gg/c9tCWFtFaG")}),C(36,"span",22),v(37,"\u{1F5E8}\uFE0F"),A(),C(38,"div",23)(39,"div",24),v(40,"Discord Server"),A(),C(41,"div",25),v(42,"Share ideas & feedback"),A()()(),C(43,"button",26),Bt("click",function(){return i.openExternalLink("https://www.youtube.com/@jaerb1")}),C(44,"span",22),v(45,"\u25B6\uFE0F"),A(),C(46,"div",23)(47,"div",24),v(48,"YouTube"),A(),C(49,"div",25),v(50,"Dev logs & gameplay"),A()()()()()()()())},dependencies:[jt],encapsulation:2})};function vG(n,e){if(n&1){let t=Je();_(0,"button",7),ne("click",function(){re(t);let r=O();return oe(r.switchToMyStats())}),v(1," My Statistics "),b()}if(n&2){let t=O();Ne("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function _G(n,e){n&1&&(_(0,"div",15)(1,"span",16),W(2,"span",17),_(3,"span"),v(4,"Loading..."),b()()())}function EG(n,e){if(n&1&&W(0,"img",27),n&2){let t=O().$implicit;Oe("src",t.userPhoto,Zi)}}function bG(n,e){n&1&&(_(0,"div",28),v(1,"\u{1F464}"),b())}function wG(n,e){if(n&1&&(_(0,"tr",22)(1,"td",23),v(2),b(),_(3,"td",24),Yn(4,EG,1,1,"img",25)(5,bG,2,0,"ng-template",null,0,cE),v(7),b(),_(8,"td",23),v(9),b(),_(10,"td",26),v(11),b()()),n&2){let t=e.$implicit,i=e.index,r=ku(6),o=O(3);Ne("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),y(2),q(i+1),y(2),Oe("ngIf",t.userPhoto)("ngIfElse",r),y(3),G(" ",t.playerName," "),y(2),q(t.victoryType),y(2),q(t.turnsPlayed)}}function xG(n,e){if(n&1&&(_(0,"tr")(1,"td",29),v(2),W(3,"br"),_(4,"span",30),v(5,"Be the first to claim victory!"),b()()()),n&2){let t=O(3);y(2),tn(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function SG(n,e){if(n&1&&(_(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),v(5,"Rank"),b(),_(6,"th",20),v(7,"Name"),b(),_(8,"th",20),v(9,"Victory Type"),b(),_(10,"th",20),v(11,"Turns"),b()()(),_(12,"tbody"),Yn(13,wG,12,12,"tr",21)(14,xG,6,2,"tr",9),b()()()),n&2){let t=O(2);y(13),Oe("ngForOf",t.scores()),y(),Oe("ngIf",t.scores().length===0)}}function IG(n,e){if(n&1&&(_(0,"div")(1,"div",11)(2,"span"),v(3,"Top 10 scores for:"),b(),_(4,"span",12),v(5),b(),_(6,"span",13),v(7),b()(),Yn(8,_G,5,0,"div",14)(9,SG,15,2,"div",9),b()),n&2){let t=O();y(5),G(" ",t.settings.difficultyLabel()," "),y(2),G(" ",t.settings.mapSizeLabel()," "),y(),Oe("ngIf",t.loading()),y(),Oe("ngIf",!t.loading())}}function TG(n,e){n&1&&(_(0,"div",15)(1,"span",16),W(2,"span",17),_(3,"span"),v(4,"Loading your stats..."),b()()())}function CG(n,e){n&1&&(_(0,"div",35),v(1," No victories recorded yet. keep playing! "),b())}function DG(n,e){if(n&1&&(_(0,"div",36)(1,"div",37)(2,"span",38),v(3),b(),_(4,"span",39),v(5),b()(),_(6,"div",40)(7,"span",41),v(8,"Best Performance"),b(),_(9,"span",42),v(10),b()(),_(11,"div",43),v(12),Ar(13,"date"),b()()),n&2){let t=e.$implicit;y(3),G(" ",t.difficulty," "),y(2),G(" ",t.mapSize," "),y(5),G("",t.turnsPlayed," Turns"),y(2),tn(" ",t.victoryType," \u2022 ",oo(13,5,t.timestamp,"mediumDate")," ")}}function AG(n,e){if(n&1&&(_(0,"div",32),Yn(1,CG,2,0,"div",33)(2,DG,14,8,"div",34),b()),n&2){let t=O(2);y(),Oe("ngIf",t.myBestScores().length===0),y(),Oe("ngForOf",t.myBestScores())}}function MG(n,e){if(n&1&&(_(0,"div",22),Yn(1,TG,5,0,"div",14)(2,AG,3,2,"div",31),b()),n&2){let t=O();y(),Oe("ngIf",t.loading()),y(),Oe("ngIf",!t.loading())}}var l0=class n{constructor(e,t,i,r){this.firebase=e;this.gameEngine=t;this.playerName=i;this.settings=r;this.fetch()}loading=$(!0);scores=$([]);activeTab=$("top10");myBestScores=$([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),i=await this.firebase.getTopScores(10,e,t);this.scores.set(i??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),i=new Map;t.forEach(r=>{let o=`${r.difficulty}-${r.mapSize}`;(!i.has(o)||r.turnsPlayed<i.get(o).turnsPlayed)&&i.set(o,r)}),this.myBestScores.set(Array.from(i.values()).sort((r,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[r.difficulty];return a!==0?a:r.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(ge(jn),ge(ri),ge(mc),ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,i){t&1&&(_(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),v(4,"Leaderboard"),b(),_(5,"button",5),ne("click",function(){return i.gameEngine.closeLeaderboard()}),v(6," \u2716 "),b()(),_(7,"div",6)(8,"button",7),ne("click",function(){return i.activeTab.set("top10")}),v(9," Top 10 "),b(),Yn(10,vG,2,6,"button",8),b(),Yn(11,IG,10,4,"div",9)(12,MG,3,2,"div",10),b()()),t&2&&(y(8),Ne("text-white",i.activeTab()==="top10")("border-b-2",i.activeTab()==="top10")("border-indigo-500",i.activeTab()==="top10"),y(2),Oe("ngIf",i.firebase.user$()),y(),Oe("ngIf",i.activeTab()==="top10"),y(),Oe("ngIf",i.activeTab()==="mystats"))},dependencies:[jt,Il,ua,da],encapsulation:2})};function RG(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function PG(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function NG(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function kG(n,e){n&1&&(X(),j(0,"circle",7))}function OG(n,e){n&1&&(X(),j(0,"circle",8))}function FG(n,e){n&1&&(X(),j(0,"circle",9))}function LG(n,e){if(n&1&&(X(),C(0,"svg",0),j(1,"circle",2)(2,"circle",3),C(3,"text",4),v(4),A(),Q(5,RG,3,0,":svg:g"),Q(6,PG,4,0,":svg:g",5),Q(7,NG,3,0,":svg:g",6),Q(8,kG,1,0,":svg:circle",7),Q(9,OG,1,0,":svg:circle",8),Q(10,FG,1,0,":svg:circle",9),A()),n&2){let t=O();y(),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),G(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)&&!t.isTower?5:-1),y(),J(t.unit.hasWeapon?6:-1),y(),J(t.unit.hasArmor?7:-1),y(),J(t.unit.level>=2?8:-1),y(),J(t.unit.level>=3?9:-1),y(),J(t.unit.level>=4?10:-1)}}function VG(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function UG(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function BG(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function jG(n,e){n&1&&(X(),j(0,"polygon",21))}function HG(n,e){n&1&&(X(),j(0,"polygon",22))}function $G(n,e){n&1&&(X(),C(0,"g"),j(1,"polygon",23)(2,"polygon",24)(3,"polygon",25),A())}function GG(n,e){if(n&1&&(X(),C(0,"svg",1)(1,"g",17),j(2,"polygon",18)(3,"polygon",19),C(4,"text",20),v(5),A(),Q(6,VG,3,0,":svg:g"),Q(7,UG,4,0,":svg:g",5),Q(8,BG,3,0,":svg:g",6),Q(9,jG,1,0,":svg:polygon",21),Q(10,HG,1,0,":svg:polygon",22),Q(11,$G,4,0,":svg:g"),A()()),n&2){let t=O();y(2),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),G(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)?6:-1),y(),J(t.unit.hasWeapon?7:-1),y(),J(t.unit.hasArmor?8:-1),y(),J(t.unit.level>=2?9:-1),y(),J(t.unit.level>=3?10:-1),y(),J(t.unit.level>=4?11:-1)}}function zG(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function WG(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function qG(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function KG(n,e){n&1&&(X(),j(0,"rect",29))}function YG(n,e){n&1&&(X(),j(0,"rect",30))}function QG(n,e){n&1&&(X(),j(0,"rect",31)(1,"rect",32)(2,"rect",33)(3,"rect",34))}function JG(n,e){if(n&1&&(X(),C(0,"svg",0),j(1,"rect",26)(2,"rect",27),C(3,"text",28),v(4),A(),Q(5,zG,3,0,":svg:g"),Q(6,WG,4,0,":svg:g",5),Q(7,qG,3,0,":svg:g",6),Q(8,KG,1,0,":svg:rect",29),Q(9,YG,1,0,":svg:rect",30),Q(10,QG,4,0),A()),n&2){let t=O();y(),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),G(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),y(),J(t.unit.hasWeapon?6:-1),y(),J(t.unit.hasArmor?7:-1),y(),J(t.unit.level>=2?8:-1),y(),J(t.unit.level>=3?9:-1),y(),J(t.unit.level>=4?10:-1)}}function ZG(n,e){n&1&&(X(),C(0,"g"),j(1,"path",10)(2,"path",11),A())}function XG(n,e){n&1&&(X(),C(0,"g",5),j(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function ez(n,e){n&1&&(X(),C(0,"g",6),j(1,"path",15)(2,"path",16),A())}function tz(n,e){n&1&&(X(),j(0,"polygon",38))}function nz(n,e){n&1&&(X(),j(0,"polygon",39))}function iz(n,e){n&1&&(X(),j(0,"circle",40)(1,"circle",41)(2,"circle",42)(3,"circle",43)(4,"circle",44)(5,"circle",45))}function rz(n,e){if(n&1&&(X(),C(0,"svg",0),j(1,"polygon",35)(2,"polygon",36),C(3,"text",37),v(4),A(),Q(5,ZG,3,0,":svg:g"),Q(6,XG,4,0,":svg:g",5),Q(7,ez,3,0,":svg:g",6),Q(8,tz,1,0,":svg:polygon",38),Q(9,nz,1,0,":svg:polygon",39),Q(10,iz,6,0),A()),n&2){let t=O();y(),Ft("fill","url(#vol-fill-"+t.unit.owner+")"),y(3),G(" ",t.unit.level," "),y(),J(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),y(),J(t.unit.hasWeapon?6:-1),y(),J(t.unit.hasArmor?7:-1),y(),J(t.unit.level>=2?8:-1),y(),J(t.unit.level>=3?9:-1),y(),J(t.unit.level>=4?10:-1)}}var c0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}unit;isTower=!1;static \u0275fac=function(t){return new(t||n)(ge(ri),ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-units"]],inputs:{unit:"unit",isTower:"isTower"},decls:4,vars:1,consts:[["viewBox","0 0 100 100",1,"w-full","h-full"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-95"],["cx","50","cy","50","r","32","filter","url(#soft-shadow)"],["cx","50","cy","50","r","31","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","61","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["transform","rotate(-45 30 14)"],["transform","translate(16, 2)"],["cx","50","cy","50","r","35","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["cx","50","cy","50","r","40","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["cx","50","cy","50","r","28","fill","none","stroke","var(--u-light)","stroke-width","2"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","var(--u-light)","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],["x","5","y","0","width","2","height","10","fill","var(--u-light)"],["points","6,-2 8,2 4,2","fill","var(--u-light)"],["x","3","y","10","width","6","height","2","fill","var(--u-fill)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","var(--u-light)"],["d","M5 3V8M3 5H9","stroke","var(--u-fill)","stroke-width","1.2","stroke-linecap","round","opacity","0.7"],["transform","translate(0, 4)"],["points","50,16 86,78 14,78","filter","url(#soft-shadow)"],["points","50,18 82,74 18,74","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","50","y","68","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2","stroke-linejoin","round"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["points","50,0 56,10 44,10","fill","var(--u-light)","stroke-linejoin","round"],["points","99,87 92,74 84,87","fill","var(--u-light)","stroke-linejoin","round"],["points","1,87 15,87 8,74","fill","var(--u-light)","stroke-linejoin","round"],["x","21","y","21","width","56","height","56","rx","6","filter","url(#soft-shadow)"],["x","23","y","23","width","52","height","52","rx","5","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","60","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["x","18","y","18","width","62","height","62","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","14","y","14","width","70","height","70","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["x","12","y","12","width","8","height","8","fill","var(--u-light)"],["x","78","y","12","width","8","height","8","fill","var(--u-light)"],["x","12","y","78","width","8","height","8","fill","var(--u-light)"],["x","78","y","78","width","8","height","8","fill","var(--u-light)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","filter","url(#soft-shadow)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","fill","none","stroke","var(--u-light)","stroke-width","2","opacity","0.4"],["x","49","y","62","text-anchor","middle","font-size","28","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,17 81,35 81,65 50,83 19,65 19,35","fill","none","stroke","var(--u-core)","stroke-width","1.5","stroke-linejoin","round"],["points","50,12 86,32 86,68 50,88 14,68 14,32","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["cx","50","cy","12","r","3","fill","var(--u-light)"],["cx","86","cy","32","r","3","fill","var(--u-light)"],["cx","86","cy","68","r","3","fill","var(--u-light)"],["cx","50","cy","88","r","3","fill","var(--u-light)"],["cx","14","cy","68","r","3","fill","var(--u-light)"],["cx","14","cy","32","r","3","fill","var(--u-light)"]],template:function(t,i){if(t&1&&Q(0,LG,11,8,":svg:svg",0)(1,GG,12,8,":svg:svg",1)(2,JG,11,8,":svg:svg",0)(3,rz,11,8,":svg:svg",0),t&2){let r;J((r=i.unit.tier)===1?0:r===2?1:r===3?2:r===4?3:-1)}},dependencies:[jt],encapsulation:2})};function oz(n,e){if(n&1){let t=Je();C(0,"div",7)(1,"div",8),v(2),A(),C(3,"button",9),Bt("click",function(){re(t);let r=O();return oe(r.gameEngine.cancelSandboxSpawn())}),v(4),A()()}if(n&2){let t=O();y(2),G(" ",t.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u0438":"Click an empty tile to spawn"," "),y(2),G(" ",t.settings.currentLang()==="uk"?"\u0412\u0456\u0434\u043C\u0456\u043D\u0430":"Cancel"," ")}}var u0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(ge(ri),ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-sandbox"]],decls:24,vars:3,consts:[[1,"absolute","-top-7","left-[-10px]","ml-2","px-3","py-1","rounded-full","bg-pink-600/20","border","border-pink-500/30","text-pink-200","text-[10px]","font-black","uppercase","tracking-widest"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-28","right-[-254px]","min-w-[238px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"mt-2","flex","flex-col","gap-2","w-full","px-2","py-2","rounded-lg","border","border-white/5","bg-white/5"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-pink-200"],[1,"grid","grid-cols-4","gap-2"],[1,"px-2","py-1","rounded","bg-blue-600/20","border","border-blue-500/30","text-blue-100","text-[10px]","cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","bg-red-600/20","border","border-red-500/30","text-red-100","text-[10px]","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-[10px]","text-gray-300"],[1,"px-2","py-1","rounded","bg-gray-700","hover:bg-gray-600","border","border-gray-600","text-white","text-[10px]","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0),v(1),A(),C(2,"div",1)(3,"div",2)(4,"div",3),v(5),A(),C(6,"div",4)(7,"button",5),Bt("click",function(){return i.gameEngine.startSandboxSpawn("player",1)}),v(8," T1 "),A(),C(9,"button",5),Bt("click",function(){return i.gameEngine.startSandboxSpawn("player",2)}),v(10," T2 "),A(),C(11,"button",5),Bt("click",function(){return i.gameEngine.startSandboxSpawn("player",3)}),v(12," T3 "),A(),C(13,"button",5),Bt("click",function(){return i.gameEngine.startSandboxSpawn("player",4)}),v(14," T4 "),A(),C(15,"button",6),Bt("click",function(){return i.gameEngine.startSandboxSpawn("ai",1)}),v(16," T1 "),A(),C(17,"button",6),Bt("click",function(){return i.gameEngine.startSandboxSpawn("ai",2)}),v(18," T2 "),A(),C(19,"button",6),Bt("click",function(){return i.gameEngine.startSandboxSpawn("ai",3)}),v(20," T3 "),A(),C(21,"button",6),Bt("click",function(){return i.gameEngine.startSandboxSpawn("ai",4)}),v(22," T4 "),A()(),Q(23,oz,5,2,"div",7),A()()),t&2&&(y(),G(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox",`
`),y(4),G(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox"," "),y(18),J(i.gameEngine.sandboxSpawnPending()?23:-1))},dependencies:[jt],encapsulation:2})};var sz=["boardContainer"],It=(n,e)=>({x:n,y:e}),az=()=>[10,20,30],lz=(n,e)=>e.id,zk=(n,e)=>e.date;function cz(n,e){if(n&1){let t=Je();_(0,"div",82)(1,"div",233)(2,"span",234),v(3),b(),_(4,"button",235),ne("click",function(){re(t);let r=O();return oe(r.firebase.logout())}),v(5),b()(),_(6,"div",236),W(7,"img",237)(8,"div",238),b()()}if(n&2){let t=O();y(3),G(" ",t.settings.t("VERIFIED")," "),y(2),G(" ",t.settings.t("LOGOUT")," "),y(2),Oe("src",e.photoURL,Zi)}}function uz(n,e){if(n&1){let t=Je();_(0,"button",239),ne("click",function(){re(t);let r=O();return oe(r.firebase.loginWithGoogle())}),W(1,"div",240),_(2,"span",241),v(3),b()()}if(n&2){let t=O();y(3),G(" ",t.settings.t("CONNECT")," ")}}function dz(n,e){if(n&1){let t=Je();_(0,"div",82)(1,"div",233)(2,"span",234),v(3),b(),_(4,"button",235),ne("click",function(){re(t);let r=O(2);return oe(r.firebase.logout())}),v(5),b()(),_(6,"div",236),W(7,"img",237)(8,"div",238),b()(),_(9,"button",197),ne("click",function(){re(t);let r=O(2);return oe(r.toggleAutoBattle())}),_(10,"div",198)(11,"span",199),v(12),b(),_(13,"span",200),v(14),b()(),_(15,"div",198),W(16,"span",201),b(),W(17,"div",202),b()}if(n&2){let t=O(2);y(3),G(" ",t.settings.t("VERIFIED")," "),y(2),G(" ",t.settings.t("LOGOUT")," "),y(2),Oe("src",e.photoURL,Zi),y(2),Ne("ring-2",t.isAutoBattleActive())("ring-green-400",t.isAutoBattleActive()),Oe("disabled",t.gameEngine.gameStatus()!=="playing"),y(3),q(t.settings.t("AUTO")),y(2),q(t.settings.t("ENGAGE")),y(2),Ne("bg-green-400",t.isAutoBattleActive())("bg-gray-500",!t.isAutoBattleActive())}}function hz(n,e){if(n&1){let t=Je();_(0,"button",239),ne("click",function(){re(t);let r=O(2);return oe(r.firebase.loginWithGoogle())}),W(1,"div",240),_(2,"span",241),v(3),b()()}if(n&2){let t=O(2);y(3),G(" ",t.settings.t("CONNECT")," ")}}function fz(n,e){if(n&1){let t=Je();_(0,"div",119)(1,"div",242)(2,"button",243),ne("click",function(){re(t);let r=O();return oe(r.closeMobileMenu())}),X(),_(3,"svg",103),W(4,"path",244),b()(),Re(),_(5,"button",245),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.resetGame())}),v(6),b(),_(7,"button",245),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.toggleRules())}),v(8),b(),_(9,"button",245),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.toggleLeaderboard())}),v(10),b(),_(11,"button",245),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.toggleLog())}),v(12),b(),_(13,"button",245),ne("click",function(){re(t);let r=O();return oe(r.navigateToFeedback())}),v(14),b(),_(15,"button",245),ne("click",function(){re(t);let r=O();return oe(r.navigateToRoadmap())}),v(16),b(),_(17,"button",245),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.toggleSettings())}),v(18),b(),_(19,"button",245),ne("click",function(){re(t);let r=O();return oe(r.navigateToRoadmap())}),v(20),b(),Q(21,dz,18,14)(22,hz,4,1,"button",83),b()()}if(n&2){let t,i=O();y(6),q(i.settings.t("RELOAD")),y(2),q(i.settings.t("INFO")),y(2),q(i.settings.t("RANKING")),y(2),q(i.settings.t("SYSTEM_LOG")),y(2),q(i.settings.t("FEEDBACK_MODULE")),y(2),q(i.settings.t("STRATEGIC_PLAN")),y(2),q(i.settings.t("SETTINGS")),y(2),q(i.settings.t("STRATEGIC_PLAN")),y(),J((t=i.firebase.user$())?21:22,t)}}function pz(n,e){if(n&1&&(_(0,"div",161),v(1),b()),n&2){let t=O();y(),Xo(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function gz(n,e){if(n&1&&(_(0,"div",248),v(1),b()),n&2){let t=O(2);y(),q(t.gameEngine.endReason())}}function mz(n,e){if(n&1){let t=Je();_(0,"div",249)(1,"div",252),v(2),b(),W(3,"input",253,1),_(5,"button",254),ne("click",function(){re(t);let r=ku(4),o=O(2);return oe(o.gameEngine.confirmAndSaveScore(r.value))}),v(6),b()()}if(n&2){let t=O(2);y(2),q(t.settings.t("CONFIRM_NAME")),y(),Oe("value",t.gameEngine.getPlayerName()),y(3),G(" ",t.settings.t("SAVE_SCORE")," ")}}function yz(n,e){if(n&1){let t=Je();_(0,"div",169)(1,"div",246)(2,"h2",247),v(3),Ar(4,"titlecase"),b(),Q(5,gz,2,1,"div",248),Q(6,mz,7,3,"div",249),_(7,"button",250),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.resetGame())}),v(8),b()(),_(9,"button",251),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.toggleLeaderboard())}),v(10),b()()}if(n&2){let t=O();y(2),Ne("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),y(),G(" ",lE(4,9,t.gameEngine.gameStatus()),"! "),y(2),J(t.gameEngine.endReason()?5:-1),y(),J(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),y(2),G(" ",t.settings.t("PLAY_AGAIN")," "),y(2),G(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function vz(n,e){n&1&&W(0,"app-support-community")}function _z(n,e){n&1&&W(0,"app-leaderboard-modal")}function Ez(n,e){n&1&&W(0,"app-sandbox")}function bz(n,e){if(n&1&&(_(0,"div",184)(1,"span",255),v(2),b()()),n&2){let t=O();y(2),G(" ",t.gameEngine.baseHealth().ai," ")}}function wz(n,e){n&1&&(_(0,"span",267),v(1," \u{1F92C} "),b()),n&2&&it("z-index",100)}function xz(n,e){n&1&&(_(0,"span",267),v(1," \u{1F620} "),b()),n&2&&it("z-index",100)}function Sz(n,e){if(n&1&&Q(0,wz,2,2,"span",266)(1,xz,2,2,"span",266),n&2){let t=O(3);J(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function Iz(n,e){n&1&&W(0,"div",259)}function Tz(n,e){if(n&1){let t=Je();_(0,"button",268),ne("click",function(){re(t);let r=O().$implicit,o=O().$implicit,s=O();return oe(s.gameEngine.buildForgeAt({x:r,y:o}))}),v(1," Build Forge "),b()}n&2&&it("z-index",60)}function Cz(n,e){if(n&1&&(_(0,"span",269),v(1),b()),n&2){let t=O().$implicit,i=O().$implicit,r=O();it("z-index",55),y(),G(" ",r.gameEngine.getForgeProgress(t,i),"% ")}}function Dz(n,e){n&1&&(_(0,"span",273),X(),_(1,"svg",274)(2,"g",275),W(3,"rect",276)(4,"rect",277)(5,"path",278)(6,"rect",279)(7,"rect",280),b()()()),n&2&&it("z-index",50)}function Az(n,e){if(n&1){let t=Je();_(0,"button",284),ne("click",function(){re(t),O(3);let r=Dr(5),o=O(2);return oe(o.gameEngine.buyWeapon(r.id))}),v(1," Weapon "),b()}}function Mz(n,e){if(n&1){let t=Je();_(0,"button",285),ne("click",function(){re(t),O(3);let r=Dr(5),o=O(2);return oe(o.gameEngine.buyArmor(r.id))}),v(1," Armor "),b()}}function Rz(n,e){if(n&1&&(_(0,"div",281),Q(1,Az,2,0,"button",282),Q(2,Mz,2,0,"button",283),b()),n&2){O(2);let t=Dr(5),i=O(2);it("z-index",60),y(),J(!t.hasWeapon&&i.gameEngine.resources().iron>=20?1:-1),y(),J(!t.hasArmor&&i.gameEngine.resources().iron>=20?2:-1)}}function Pz(n,e){if(n&1&&(_(0,"span",270),v(1," Forge "),b(),Q(2,Dz,8,2,"span",271),Q(3,Rz,3,4,"div",272)),n&2){let t=O().$implicit,i=Dr(5),r=O().$implicit,o=O();it("z-index",55),Ne("scale-60",i&&i.owner==="player")("scale-50",i&&i.owner==="player")("top-1",!(i&&i.owner==="player"))("left-1",!(i&&i.owner==="player"))("top-0",i&&i.owner==="player")("-right-1",i&&i.owner==="player"),y(2),J(o.gameEngine.isVisibleToPlayer(t,r)?2:-1),y(),J(i&&i.owner==="player"?3:-1)}}function Nz(n,e){n&1&&(X(),_(0,"g",291),W(1,"polygon",294)(2,"polygon",295),b())}function kz(n,e){n&1&&(X(),_(0,"g",296),W(1,"rect",297),b(),_(2,"g",298),W(3,"rect",299)(4,"path",300),b())}function Oz(n,e){if(n&1&&(_(0,"span",286),X(),_(1,"svg",287)(2,"defs")(3,"linearGradient",288),W(4,"stop",289)(5,"stop",290),b()(),Q(6,Nz,3,0,":svg:g",291),_(7,"g"),W(8,"polygon",292)(9,"rect",293),b(),Q(10,kz,5,0),b()()),n&2){O();let t=Dr(5);Ne("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),y(6),J(t?-1:6),y(),Ne("scale-90",t),y(3),J(t?-1:10)}}function Fz(n,e){n&1&&(X(),_(0,"g",304),W(1,"rect",305)(2,"path",306),b())}function Lz(n,e){if(n&1&&(_(0,"span",286),X(),_(1,"svg",287)(2,"g"),W(3,"ellipse",301)(4,"path",302)(5,"circle",303),b(),Q(6,Fz,3,0,":svg:g",304),b()()),n&2){O();let t=Dr(5);Ne("scale-50",t)("opacity-40",t)("-translate-x-4",t)("translate-y-4",t),y(6),J(t?-1:6)}}function Vz(n,e){n&1&&W(0,"div",307),n&2&&it("height",2,"px")}function Uz(n,e){if(n&1&&(_(0,"span",308),v(1),b(),_(2,"span",309),v(3),b()),n&2){let t=O(3);y(),G(" ",t.gameEngine.baseHealth().player," "),y(2),G(" ",t.gameEngine.reservePoints().player," ")}}function Bz(n,e){if(n&1&&(_(0,"span",310),v(1),b(),_(2,"span",311),v(3),b()),n&2){let t=O(4);y(),G(" ",t.gameEngine.baseHealth().ai," "),y(2),G(" ",t.gameEngine.reservePoints().ai," ")}}function jz(n,e){if(n&1&&Q(0,Bz,4,2),n&2){let t=O().$implicit,i=O().$implicit,r=O();J(r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function Hz(n,e){n&1&&(X(),_(0,"svg",317),W(1,"path",318),b())}function $z(n,e){n&1&&(X(),_(0,"svg",317),W(1,"path",319),b())}function Gz(n,e){if(n&1){let t=Je();_(0,"button",316),ne("click",function(r){re(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return oe(o.owner==="player"?l.onDestroyIconClick(r,s,a,s+1,a):l.onAttackIconClick(r,s,a,s+1,a))}),Q(1,Hz,2,0,":svg:svg",317)(2,$z,2,0,":svg:svg",317),b()}if(n&2){let t=O(2),i=O(4);it("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Ne("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),y(),J(t.owner==="player"?1:2)}}function zz(n,e){if(n&1){let t=Je();_(0,"div",314),ne("mouseenter",function(){re(t);let r=O(),o=O(4);return oe(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){re(t);let r=O(5);return oe(r.gameEngine.hoverFormationById(null))}),Q(1,Gz,3,13,"button",315),b()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();it("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","height 0.25s ease-out"),Ne("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ft("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),y(),J(o.gameEngine.canShowAttackIcon(_t(26,It,i,r),_t(29,It,i+1,r))?1:-1)}}function Wz(n,e){if(n&1&&Q(0,zz,2,32,"div",313),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();J(r.gameEngine.shouldRenderWall(_t(1,It,t,i),_t(4,It,t+1,i),e.owner)?0:-1)}}function qz(n,e){if(n&1){let t=Je();_(0,"button",323),ne("click",function(r){re(t);let o=O(3).$implicit,s=O().$implicit,a=O();return oe(a.onBuildIconClick(r,o,s,o+1,s))}),v(1," \u2714 "),b()}if(n&2){let t=O(5);it("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function Kz(n,e){if(n&1&&(_(0,"span",322),v(1),b()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();y(),tn(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,It,t,i),_t(5,It,t+1,i))," ")}}function Yz(n,e){if(n&1&&(_(0,"div",320),Q(1,qz,2,8,"button",321),Q(2,Kz,2,8,"span",322),b()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();it("right",-r.gameEngine.wallThicknessPx-2,"px")("width",r.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Ne("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,It,t,i),_t(19,It,t+1,i)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,It,t,i),_t(25,It,t+1,i))),y(),J(r.gameEngine.canShowBuildIcon(_t(28,It,t,i),_t(31,It,t+1,i))?1:-1),y(),J(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t+1,i))&&r.gameEngine.edgeCooldownRemaining(_t(34,It,t,i),_t(37,It,t+1,i))>0?2:-1)}}function Qz(n,e){if(n&1&&Q(0,Wz,1,7)(1,Yz,3,40,"div",312),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();J((t=o.gameEngine.getWallBetween(i,r,i+1,r))?0:1,t)}}function Jz(n,e){n&1&&(X(),_(0,"svg",317),W(1,"path",318),b())}function Zz(n,e){n&1&&(X(),_(0,"svg",317),W(1,"path",319),b())}function Xz(n,e){if(n&1){let t=Je();_(0,"button",316),ne("click",function(r){re(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return oe(o.owner==="player"?l.onDestroyIconClick(r,s,a,s,a+1):l.onAttackIconClick(r,s,a,s,a+1))}),Q(1,Jz,2,0,":svg:svg",317)(2,Zz,2,0,":svg:svg",317),b()}if(n&2){let t=O(2),i=O(4);it("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Ne("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),y(),J(t.owner==="player"?1:2)}}function eW(n,e){if(n&1){let t=Je();_(0,"div",326),ne("mouseenter",function(){re(t);let r=O(),o=O(4);return oe(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){re(t);let r=O(5);return oe(r.gameEngine.hoverFormationById(null))}),Q(1,Xz,3,13,"button",315),b()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();it("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","width 0.25s ease-out"),Ne("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Ft("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),y(),J(o.gameEngine.canShowAttackIcon(_t(26,It,i,r),_t(29,It,i,r+1))?1:-1)}}function tW(n,e){if(n&1&&Q(0,eW,2,32,"div",325),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();J(r.gameEngine.shouldRenderWall(_t(1,It,t,i),_t(4,It,t,i+1),e.owner)?0:-1)}}function nW(n,e){if(n&1){let t=Je();_(0,"button",330),ne("click",function(r){re(t);let o=O(3).$implicit,s=O().$implicit,a=O();return oe(a.onBuildIconClick(r,o,s,o,s+1))}),v(1," \u2714 "),b()}if(n&2){let t=O(5);it("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function iW(n,e){if(n&1&&(_(0,"span",329),v(1),b()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();y(),tn(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,It,t,i),_t(5,It,t,i+1))," ")}}function rW(n,e){if(n&1&&(_(0,"div",327),Q(1,nW,2,8,"button",328),Q(2,iW,2,8,"span",329),b()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();it("bottom",-r.gameEngine.wallThicknessPx-2,"px")("height",r.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Ne("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,It,t,i),_t(19,It,t,i+1)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,It,t,i),_t(25,It,t,i+1))),y(),J(r.gameEngine.canShowBuildIcon(_t(28,It,t,i),_t(31,It,t,i+1))?1:-1),y(),J(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t,i+1))&&r.gameEngine.edgeCooldownRemaining(_t(34,It,t,i),_t(37,It,t,i+1))>0?2:-1)}}function oW(n,e){if(n&1&&Q(0,tW,1,7)(1,rW,3,40,"div",324),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();J((t=o.gameEngine.getWallBetween(i,r,i,r+1))?0:1,t)}}function sW(n,e){if(n&1&&W(0,"app-units",334),n&2){let t=O(3);Oe("unit",t)}}function aW(n,e){if(n&1&&(_(0,"span",338),v(1),b()),n&2){let t=e;it("z-index",200),Ne("bg-green-600",t.bg==="bg-green-600")("bg-amber-600",t.bg==="bg-amber-600")("bg-red-600",t.bg==="bg-red-600"),y(),G(" ",t.chance,"% ")}}function lW(n,e){n&1&&(_(0,"span",339),v(1," \u{1F333} "),b()),n&2&&it("z-index",100)}function cW(n,e){n&1&&(_(0,"span",340),v(1," \u{1F331} "),b()),n&2&&it("z-index",100)}function uW(n,e){n&1&&(_(0,"span",340),v(1," \u{1F33F} "),b()),n&2&&it("z-index",100)}function dW(n,e){n&1&&(_(0,"span",343),v(1," \u{1F9F1} "),b()),n&2&&it("z-index",100)}function hW(n,e){n&1&&(_(0,"span",342),v(1,"\u26F0\uFE0F"),b())}function fW(n,e){n&1&&(_(0,"span",342),v(1,"\u26CF\uFE0F"),b())}function pW(n,e){n&1&&(_(0,"span",342),v(1,"\u26CF"),b())}function gW(n,e){n&1&&(_(0,"span",342),v(1,"\u2692"),b())}function mW(n,e){if(n&1&&Q(0,dW,2,2,"span",341)(1,hW,2,0,"span",342)(2,fW,2,0,"span",342)(3,pW,2,0,"span",342)(4,gW,2,0,"span",342),n&2){let t=O(3);J((t.mineOccupationTurns??0)>=5?0:(t.mineOccupationTurns??0)===1?1:(t.mineOccupationTurns??0)===2?2:(t.mineOccupationTurns??0)===3?3:(t.mineOccupationTurns??0)>3?4:-1)}}function yW(n,e){if(n&1&&(_(0,"div",332)(1,"div",333),Q(2,sW,1,1,"app-units",334),b(),Q(3,aW,2,9,"span",335),Q(4,lW,2,2,"span",336)(5,cW,2,2,"span",337)(6,uW,2,2,"span",337),Q(7,mW,5,1),b()),n&2){let t,i=O(2),r=O(3);it("transform",r.gameEngine.getCombinedTransform(i.id))("z-index",r.gameEngine.isUnitMoving(i.id)||r.gameEngine.isUnitAttacking(i.id)?200:null),Ne("shake",r.gameEngine.isUnitShaking(i.id)),y(),it("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px"),Ne("theme-player",i.owner==="player")("theme-ai",i.owner==="ai")("fatigued",i.hasActed)("merge-anim",r.gameEngine.lastMergedUnitId()===i.id)("ring",r.gameEngine.selectedUnitId()===i.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===i.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===i.id)("scale-115",r.gameEngine.selectedUnitId()===i.id&&!r.gameEngine.buildMode())("scale-120",r.gameEngine.lastMergedUnitId()===i.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===i.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===i.id)("pulse-glow",r.gameEngine.pulseUnitId()===i.id),Ft("title",r.gameEngine.formatHoverInfo(i.id)),y(),J(i?2:-1),y(),J((t=r.gameEngine.isUnitHovered(i.id)&&r.gameEngine.getHitChanceInfo(i.id))?3:-1,t),y(),J(i.productionActive?4:(i.forestOccupationTurns??0)===1?5:(i.forestOccupationTurns??0)>1?6:-1),y(3),J(r.gameEngine.isMine(i.position.x,i.position.y)?7:-1)}}function vW(n,e){if(n&1&&Q(0,yW,8,41,"div",331),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();J(!(t===0&&i===0)&&!(t===r.gameEngine.gridSize-1&&i===r.gameEngine.gridSize-1)?0:-1)}}function _W(n,e){if(n&1&&Q(0,vW,1,1),n&2){let t=O().$implicit,i=O().$implicit,r=O();J(e.owner==="player"||r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function EW(n,e){if(n&1&&(_(0,"div",344)(1,"span",345),v(2),b()()),n&2){let t=e.$implicit,i=O(3);it("z-index",100)("opacity",t.opacity),y(),Ne("text-xs",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-base",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text))("text-yellow-300",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-yellow-400",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text)),y(),G(" ",t.text," ")}}function bW(n,e){if(n&1){let t=Je();_(0,"div",257),ne("click",function(){let r=re(t).$implicit,o=O().$implicit,s=O();return oe(s.onTileClick(r,o))})("mouseenter",function(){let r=re(t).$implicit,o=O().$implicit,s=O();return oe(s.gameEngine.setHoveredUnit(s.gameEngine.getUnitAt(r,o)&&(s.gameEngine.getUnitAt(r,o).owner==="player"||s.gameEngine.isVisibleToPlayer(r,o))?s.gameEngine.getUnitAt(r,o).id:null))})("mouseleave",function(){re(t);let r=O(2);return oe(r.gameEngine.setHoveredUnit(null))}),_(1,"span",258),v(2),b(),Q(3,Sz,2,1),Q(4,Iz,1,0,"div",259),wl(5),Q(6,Tz,2,2,"button",260),Q(7,Cz,2,3,"span",261),Q(8,Pz,4,16),Q(9,Oz,11,12,"span",262),Q(10,Lz,7,9,"span",263),Q(11,Vz,1,2,"div",264),Q(12,Uz,4,2),Q(13,jz,1,1),Q(14,Qz,2,1),Q(15,oW,2,1),Q(16,_W,1,1),wn(17,EW,3,13,"div",265,lz),b()}if(n&2){let t,i=e.$implicit,r=O().$implicit,o=O();it("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Ne("cursor-pointer",o.gameEngine.isValidMove(i,r))("bg-gray-700",!o.gameEngine.isValidMove(i,r))("border-gray-600",!o.gameEngine.isValidMove(i,r))("bg-blue-900",i===0&&r===0)("bg-red-900",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-4",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-blue-400",i===0&&r===0)("border-red-400",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-2",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-blue-300",i===0&&r===0&&o.gameEngine.baseDeployActive())("ring-red-300",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&i<=2&&r<=2&&(i!==0||r!==0))("forest-area",o.gameEngine.isForest(i,r))("mine-area",o.gameEngine.isMine(i,r))("forge-area",o.gameEngine.isForge(i,r))("bg-amber-900",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(i,r))("border-gray-800",!o.gameEngine.isVisibleToPlayer(i,r))("bg-green-900",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("border-green-500",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("bg-cyan-900",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("border-cyan-500",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("animate-pulse",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("hover:bg-gray-600",!o.gameEngine.isValidMove(i,r))("hover:bg-green-800",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("hover:bg-cyan-800",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r)),Ft("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0456\u0437\u043D\u0430 \u0448\u0430\u0445\u0442\u0430: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +2 \u0437\u0430\u043B\u0456\u0437\u0430 \u0437\u0430 \u0445\u0456\u0434.":"Iron Mine: Requires 5 consecutive turns of occupation to activate. Once active, yields +2 Iron per turn.":null)("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u041B\u0456\u0441\u043E\u043F\u0438\u043B\u044C\u043D\u044F: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 2 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +8 \u0434\u0435\u0440\u0435\u0432\u0438\u043D\u0438 \u0437\u0430 \u0445\u0456\u0434.":"Sawmill: Requires 2 consecutive occupation turns to activate. Once activated, it gives +8 wood per turn.":null),y(2),tn(" ",i,",",r," "),y(),J(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(i,r)?3:-1),y(),J(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(i,r)?4:-1),y(),Ou(o.gameEngine.getUnitAt(i,r)),y(),J(o.gameEngine.buildMode()&&o.gameEngine.canBuildForgeAt(i,r)?6:-1),y(),J(o.gameEngine.isForgeSite(i,r)?7:-1),y(),J(o.gameEngine.isForge(i,r)?8:-1),y(),J(o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?9:-1),y(),J(o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?10:-1),y(),J(o.gameEngine.isForest(i,r)&&o.gameEngine.getUnitAt(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?11:-1),y(),J(i===0&&r===0?12:-1),y(),J(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1?13:-1),y(),J(i<o.gameEngine.gridSize-1?14:-1),y(),J(r<o.gameEngine.gridSize-1?15:-1),y(),J((t=o.gameEngine.getUnitAt(i,r))?16:-1,t),y(),xn(o.gameEngine.getCombatTextEntriesAt(i,r))}}function wW(n,e){if(n&1&&wn(0,bW,19,80,"div",256,Cr),n&2){let t=O();xn(t.gameEngine.gridCols)}}function xW(n,e){n&1&&W(0,"app-game-rules")}function SW(n,e){if(n&1&&(_(0,"div",361),v(1),b()),n&2){let t=O(2);y(),q(t.settings.t("NOT_LOGS_DATA"))}}function IW(n,e){if(n&1&&(_(0,"div",363)(1,"span",364),v(2),b()()),n&2){let t=e.$implicit;it("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Ne("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),y(),oE(t.color),y(),q(t.text)}}function TW(n,e){if(n&1){let t=Je();_(0,"div",229)(1,"button",346),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.toggleLog())}),_(2,"span",347),v(3,"\u2715"),b()(),_(4,"div",348)(5,"div",349)(6,"h3",350),v(7),b(),_(8,"button",351),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.clearLogs())}),X(),_(9,"svg",352),W(10,"path",353),b(),v(11),b()(),Re(),_(12,"label",354)(13,"div",109)(14,"input",355),ne("change",function(){re(t);let r=O();return oe(r.gameEngine.toggleCombatOnly())}),b(),W(15,"div",356),X(),_(16,"svg",357),W(17,"path",358),b()(),Re(),_(18,"span",359),v(19),b()()(),_(20,"div",360),Q(21,SW,2,1,"div",361),wn(22,IW,3,7,"div",362,Pu),b()()}if(n&2){let t=O();y(7),G(" ",t.settings.t("Action_LOG")," "),y(4),G(" ",t.settings.t("CLEAR")," "),y(3),Oe("checked",t.gameEngine.combatOnly()),y(5),G(" ",t.settings.t("COMBAT_ONLY")," "),y(2),J(t.gameEngine.logsFiltered().length===0?21:-1),y(),xn(t.gameEngine.logsFiltered().reverse())}}function CW(n,e){if(n&1){let t=Je();_(0,"button",381),ne("click",function(){let r=re(t).$implicit,o=O(2);return oe(o.onDifficultyChange(r))}),_(1,"span",382),v(2),b(),v(3),b()}if(n&2){let t=e.$implicit,i=O(2);Ne("bg-blue-500/20",i.settings.difficulty()===t)("border-blue-400/40",i.settings.difficulty()===t)("text-blue-200",i.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",i.settings.difficulty()===t)("bg-white/5",i.settings.difficulty()!==t)("border-white/5",i.settings.difficulty()!==t)("text-stone-500",i.settings.difficulty()!==t)("hover:bg-white/10",i.settings.difficulty()!==t),y(),Ne("opacity-100",i.settings.difficulty()===t),y(),G(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),y(),G(" ",i.settings.t(i.settings.getDifficultyLabel(t))," ")}}function DW(n,e){if(n&1){let t=Je();_(0,"button",383),ne("click",function(){let r=re(t).$implicit,o=O(2);return oe(o.onMapSizeChange(r))}),v(1),b()}if(n&2){let t=e.$implicit,i=O(2);Ne("bg-gradient-to-br",i.settings.mapSize()===t)("from-indigo-600",i.settings.mapSize()===t)("to-indigo-800",i.settings.mapSize()===t)("text-white",i.settings.mapSize()===t)("shadow-lg",i.settings.mapSize()===t)("text-stone-500",i.settings.mapSize()!==t)("hover:text-stone-300",i.settings.mapSize()!==t),y(),tn(" ",t,"x",t," ")}}function AW(n,e){if(n&1){let t=Je();_(0,"div",230)(1,"div",365),W(2,"div",366),_(3,"h3",367),v(4),b(),_(5,"button",368),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.toggleSettings())}),v(6," \u2716 "),b()(),_(7,"div",369)(8,"div",190)(9,"label",370),v(10),b(),_(11,"span",371),v(12),b()(),_(13,"div",372),wn(14,CW,4,20,"button",373,Cr),b()(),_(16,"div",369)(17,"label",374),v(18),b(),_(19,"div",375),wn(20,DW,2,16,"button",376,Cr),b()(),_(22,"div",377)(23,"button",378),ne("click",function(){re(t);let r=O();return oe(r.settings.setLang("uk"))}),v(24," UA "),b(),_(25,"button",378),ne("click",function(){re(t);let r=O();return oe(r.settings.setLang("en"))}),v(26," EN "),b()(),_(27,"label",379)(28,"div",109)(29,"input",110),ne("change",function(r){re(t);let o=O();return oe(o.setCustomMode(r.target.checked))}),b(),_(30,"div",380),W(31,"div",112),b()(),_(32,"span",113),v(33,"Custom Mode"),b()()()}if(n&2){let t=O();y(4),q(t.settings.t("SYSTEM_SETTINGS")),y(6),G(" ",t.settings.t("TACTICAL_DIFF")," "),y(2),G(" ",t.settings.t("LEVEL_SELECTION")," "),y(2),xn(t.settings.diffArr),y(4),G(" ",t.settings.t("SECTOR_DIMENSIONS")," "),y(2),xn(aa(13,az)),y(3),Ne("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),y(2),Ne("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en"),y(4),Oe("checked",t.settings.customMode())}}function MW(n,e){if(n&1&&(_(0,"div",392)(1,"span"),v(2),Ar(3,"date"),b(),_(4,"span",396),v(5),b(),_(6,"span",397),v(7),b()()),n&2){let t=e.$implicit,i=O(2);y(2),q(oo(3,4,t.date,"yyyy-MM-dd HH:mm")),y(3),q(t.condition),y(2),tn("",t.turns," ",i.settings.t("TURNS"))}}function RW(n,e){if(n&1&&(_(0,"div",393),v(1),b()),n&2){let t=O(2);y(),q(t.settings.t("NO_RECORDS_YET"))}}function PW(n,e){if(n&1&&(_(0,"div",392)(1,"span"),v(2),Ar(3,"date"),b(),_(4,"span",396),v(5),b(),_(6,"span",397),v(7),b()()),n&2){let t=e.$implicit,i=O(2);y(2),q(oo(3,4,t.date,"yyyy-MM-dd HH:mm")),y(3),q(t.condition),y(2),tn("",t.turns," ",i.settings.t("TURNS"))}}function NW(n,e){if(n&1&&(_(0,"div",393),v(1),b()),n&2){let t=O(2);y(),q(t.settings.t("NO_RECORDS_YET"))}}function kW(n,e){if(n&1){let t=Je();_(0,"div",231)(1,"div",384)(2,"div",385)(3,"h2",386),v(4),b(),_(5,"button",387),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.closeHighScores())}),v(6," \u2716 "),b()(),_(7,"div",388),v(8),b(),_(9,"div",389)(10,"div",390)(11,"h3",391),v(12),b(),wn(13,MW,8,7,"div",392,zk,!1,RW,2,1,"div",393),b(),_(16,"div",390)(17,"h3",394),v(18),b(),wn(19,PW,8,7,"div",392,zk,!1,NW,2,1,"div",393),b()(),_(22,"div",395),v(23),b()()()}if(n&2){let t=O();y(4),q(t.settings.t("HIGH_SCORES")),y(4),Xo(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),y(4),q(t.settings.t("TOP_3_PLAYER")),y(),xn(t.gameEngine.getHighScoresForCurrentCombo().wins),y(5),q(t.settings.t("TOP_3_LOSES_PLAYER")),y(),xn(t.gameEngine.getHighScoresForCurrentCombo().losses),y(4),q(t.settings.t("CHANGE_RECORDS_INFO"))}}function OW(n,e){if(n&1){let t=Je();_(0,"div",232)(1,"div",398),v(2," Debug Mode "),b(),_(3,"button",399),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.debugInstantWin())}),v(4," \u26A1 Instant Win "),b(),_(5,"button",400),ne("click",function(){re(t);let r=O();return oe(r.gameEngine.debugCycleSettings())}),v(6," \u{1F504} Cycle Settings "),b(),_(7,"div",401),v(8),b()()}if(n&2){let t=O();y(8),tn(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var d0=class n{constructor(e,t,i,r){this.gameEngine=e;this.settings=t;this.firebase=i;this.router=r}boardContainer;isAutoBattleActive=$(!1);isMobileMenuOpen=$(!1);lastEconomyProcessedTurn=-1;ngOnInit(){this.gameEngine.resetGame()}ngOnDestroy(){this.isAutoBattleActive.set(!1),this.gameEngine.pauseGame()}goToHub(){this.isAutoBattleActive.set(!1),this.router.navigate(["/"])}get isProduction(){return!oM()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}centerOnSelectedUnit(){let e=this.boardContainer?.nativeElement;if(!e)return;let t=this.gameEngine.selectedUnit();if(!t)return;let i=this.gameEngine.tileSizePx,r=this.gameEngine.wallThicknessPx+2,o=i+r,s=t.position.x*o+i/2,a=t.position.y*o+i/2,l=Math.max(0,Math.min(s-e.clientWidth/2,e.scrollWidth-e.clientWidth)),c=Math.max(0,Math.min(a-e.clientHeight/2,e.scrollHeight-e.clientHeight));e.scrollTo({left:l,top:c,behavior:"smooth"})}activeKeys=new Set;onKeyDown(e){if(this.gameEngine.gameStatus()!=="playing")return;let t=e.key;if(t==="Tab"||t===" "||e.code==="Space"){e.preventDefault(),this.gameEngine.isPlayerTurn()&&this.gameEngine.selectNextAvailableUnitTab();return}if(t==="Enter"){e.preventDefault(),this.gameEngine.endPlayerTurn();return}let i=this.gameEngine.selectedUnit();if(!i||i.hasActed)return;this.activeKeys.add(t);let r=0,o=0;if((this.activeKeys.has("ArrowUp")||this.activeKeys.has("w")||this.activeKeys.has("W"))&&(o-=1),(this.activeKeys.has("ArrowDown")||this.activeKeys.has("s")||this.activeKeys.has("S"))&&(o+=1),(this.activeKeys.has("ArrowLeft")||this.activeKeys.has("a")||this.activeKeys.has("A"))&&(r-=1),(this.activeKeys.has("ArrowRight")||this.activeKeys.has("d")||this.activeKeys.has("D"))&&(r+=1),r===0&&o===0)return;e.preventDefault();let s=this.gameEngine.validMoves(),l=r!==0&&o!==0?i.tier===4?3:1:i.tier>=3||i.tier===2?2:1,c=null;for(let d=1;d<=l;d++){let h=i.position.x+r*d,p=i.position.y+o*d,g={x:h,y:p};if(s.some(x=>x.x===h&&x.y===p))c=g;else break}if(!c){let d={x:i.position.x,y:i.position.y},h={x:i.position.x+r,y:i.position.y+o};if(this.gameEngine.getWallBetween(d.x,d.y,h.x,h.y)){this.gameEngine.attackOrDestroyWallBetween(d,h);return}let g=this.gameEngine.getUnitAt(h.x,h.y);if(g&&g.owner!==i.owner){this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.isValidMove(h.x,h.y)&&this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.moveSelectedUnit(c)}onKeyUp(e){this.activeKeys.delete(e.key)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.settings.customMode()&&this.gameEngine.sandboxSpawnPending()){this.gameEngine.getUnitAt(e,t)||this.gameEngine.spawnSandboxAt({x:e,y:t});return}if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let i=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}let r=this.gameEngine.selectedUnit();if(r){let o=e-r.position.x,s=t-r.position.y;if(Math.abs(o)+Math.abs(s)===1&&this.gameEngine.getWallBetween(r.position.x,r.position.y,e,t)){this.gameEngine.attackOrDestroyWallBetween(r.position,{x:e,y:t});return}}if(i&&i.owner==="player"){this.gameEngine.selectUnit(i.id);return}this.gameEngine.selectUnit(null)}setCustomMode(e){this.settings.setCustomMode(e),this.gameEngine.resetGame()}onEdgeClick(e,t,i,r,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,i,r,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onDestroyIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:i},{x:r,y:o})}onBuildIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onAttackIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(r=>setTimeout(r,250)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.turn();this.lastEconomyProcessedTurn!==e&&(this.gameEngine.botEconomyPhase("player"),this.lastEconomyProcessedTurn=e),this.gameEngine.playerAutoStep()||this.gameEngine.selectUnit(null),this.gameEngine.remainingActions()===0&&(await new Promise(r=>setTimeout(r,1e3)),this.isAutoBattleActive()&&this.gameEngine.isPlayerTurn()&&this.gameEngine.endPlayerTurn())}static \u0275fac=function(t){return new(t||n)(ge(ri),ge(Mt),ge(jn),ge(_i))};static \u0275cmp=Ct({type:n,selectors:[["app-game"]],viewQuery:function(t,i){if(t&1&&_l(sz,5),t&2){let r;El(r=bl())&&(i.boardContainer=r.first)}},hostBindings:function(t,i){t&1&&ne("keydown",function(o){return i.onKeyDown(o)},oa)("keyup",function(o){return i.onKeyUp(o)},oa)},decls:377,vars:124,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],["title","Return to Gaming Hub",1,"cursor-pointer","p-2","bg-slate-800/50","hover:bg-slate-700","border","border-slate-700/50","rounded-lg","transition-all","group/btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-slate-400","group-hover/btn:text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["d","M6 18 L10 12 L14 18 Z","fill","#9ca3af"],["cx","12","cy","10","r","3","fill","#6b7280"],[1,"hud-value","font-mono","text-sm","font-bold","text-slate-300"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-6xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],["width","24","height","24","viewBox","0 0 24 24"],[1,"font-mono","text-lg","font-bold","text-slate-300"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","roadmap","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto","no-select"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"flex","items-center","justify-between","w-full","gap-2","z-10","text-amber-200"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","mine-area","forge-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click","mouseenter","mouseleave"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"z-index"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","-translate-x-4","translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"click"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none"],[1,"absolute","text-[10px]","font-bold","px-1","rounded","bg-yellow-300/80","text-black","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90",3,"z-index"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90"],["viewBox","0 0 128 128",1,"w-full","h-full"],["transform","translate(0,10) scale(1)"],["x","20","y","80","width","88","height","18","rx","4","fill","#6b7280"],["x","30","y","70","width","68","height","12","rx","3","fill","#9ca3af"],["d","M32 40 H96 L86 56 H42 Z","fill","#4b5563"],["x","56","y","30","width","16","height","12","rx","2","fill","#6b7280"],["x","60","y","20","width","8","height","12","rx","2","fill","#9ca3af"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer",3,"click"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer",3,"click"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],["cx","64","cy","96","rx","40","ry","10","fill","#374151"],["d","M32 96 L56 48 L72 80 L96 96 Z","fill","#6b7280","stroke","#4b5563","stroke-width","4"],["cx","58","cy","60","r","6","fill","#9ca3af"],["transform","translate(82, 30) rotate(-20) scale(1.3)"],["width","4","height","30","rx","2","fill","#6b7280"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#f59e0b","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none","move-anim",3,"shake","transform","z-index"],[1,"pointer-events-none","move-anim"],[1,"unit-svg-wrapper"],[3,"unit"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow",3,"bg-green-600","bg-amber-600","bg-red-600","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-left-1","opacity-70","[style.z-index]='100'"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"mt-3","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-pink-500","peer-checked:border-pink-500","transition-all"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,i){if(t&1){let r=Je();_(0,"div",2)(1,"div",3),W(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),b(),X(),_(7,"svg",9)(8,"defs")(9,"radialGradient",10),W(10,"stop",11)(11,"stop",12)(12,"stop",13),b(),_(13,"radialGradient",14),W(14,"stop",15)(15,"stop",16)(16,"stop",17),b(),_(17,"radialGradient",18),W(18,"stop",19)(19,"stop",20)(20,"stop",21),b(),_(21,"linearGradient",22),W(22,"stop",23)(23,"stop",24),b(),_(24,"filter",25),W(25,"feDropShadow",26),b()()(),_(26,"svg",27)(27,"defs")(28,"clipPath",28),W(29,"path",29),b(),_(30,"symbol",30),W(31,"path",31),b()()(),Re(),_(32,"div",32)(33,"button",33),ne("click",function(){return re(r),oe(i.goToHub())}),X(),_(34,"svg",34),W(35,"path",35),b()(),Re(),_(36,"div",36),W(37,"div",37)(38,"div",38),X(),_(39,"svg",39),W(40,"path",40)(41,"rect",41),b(),Re(),W(42,"div",42)(43,"div",43),b(),_(44,"div",44)(45,"div",45)(46,"h1",46)(47,"span",47),v(48,"Shape"),b(),_(49,"span",48),v(50," Tactics "),b()(),_(51,"div",49),W(52,"div",50)(53,"div",51),b()(),_(54,"div",52)(55,"span",53),v(56),b()()(),W(57,"div",54),b(),_(58,"div",55)(59,"div",56)(60,"button",57),ne("click",function(){return re(r),oe(i.gameEngine.resetGame())}),X(),_(61,"svg",58),W(62,"path",59),b(),Re(),_(63,"span",60),v(64),b()(),W(65,"div",61),_(66,"button",62),ne("click",function(){return re(r),oe(i.gameEngine.toggleRules())}),X(),_(67,"svg",63),W(68,"path",64),b(),Re(),_(69,"span",65),v(70),b()()(),_(71,"div",66)(72,"button",67),ne("click",function(){return re(r),oe(i.gameEngine.toggleHighScores())}),X(),_(73,"svg",68),W(74,"path",69),b(),Re(),_(75,"span",70),v(76),b()(),_(77,"button",71),ne("click",function(){return re(r),oe(i.gameEngine.toggleLeaderboard())}),X(),_(78,"svg",68),W(79,"path",72),b(),Re(),_(80,"span",70),v(81),b()(),_(82,"button",73),ne("click",function(){return re(r),oe(i.gameEngine.toggleLog())}),X(),_(83,"svg",68),W(84,"path",74),b(),Re(),_(85,"span",70),v(86),b()(),_(87,"button",75),ne("click",function(){return re(r),oe(i.navigateToFeedback())}),X(),_(88,"svg",68),W(89,"path",76),b(),Re(),_(90,"span",70),v(91),b()()(),_(92,"div",77)(93,"button",78),ne("click",function(){return re(r),oe(i.gameEngine.toggleSettings())}),X(),_(94,"svg",79),W(95,"path",80)(96,"path",81),b()(),Q(97,cz,9,3,"div",82)(98,uz,4,1,"button",83),b()(),Re(),_(99,"div",84)(100,"div",85),X(),_(101,"svg",86),W(102,"rect",87)(103,"circle",88),b(),Re(),_(104,"span",89),v(105),b()(),_(106,"div",85),X(),_(107,"svg",86),W(108,"path",90)(109,"circle",91),b(),Re(),_(110,"span",92),v(111),b()(),_(112,"div",85),X(),_(113,"svg",86),W(114,"polygon",93),b(),Re(),_(115,"span",94),v(116),b()(),_(117,"div",85),X(),_(118,"svg",86),W(119,"circle",95)(120,"path",96),b(),Re(),_(121,"span",97),v(122),b()(),_(123,"div",85),X(),_(124,"svg",86),W(125,"path",98)(126,"rect",99)(127,"rect",100),b(),Re(),_(128,"span",101),v(129),b()(),_(130,"button",102),ne("click",function(){return re(r),oe(i.toggleMobileMenu())}),X(),_(131,"svg",103),W(132,"path",104),b()()(),Re(),_(133,"div",105)(134,"button",106),ne("click",function(){return re(r),oe(i.gameEngine.toggleBuildMode())}),X(),_(135,"svg",86),W(136,"path",107),b()(),Re(),_(137,"button",106),ne("click",function(){return re(r),oe(i.gameEngine.convertWoodToReserve())}),v(138," +1 "),b(),_(139,"button",106),ne("click",function(){return re(r),oe(i.gameEngine.maxConvertWoodToReserve())}),v(140),b(),_(141,"label",108)(142,"div",109)(143,"input",110),ne("change",function(){return re(r),oe(i.gameEngine.toggleFogDebug())}),b(),_(144,"div",111),W(145,"div",112),b()(),_(146,"span",113),v(147),b()(),_(148,"div",114),v(149),b(),_(150,"button",115),ne("click",function(){return re(r),oe(i.gameEngine.endPlayerTurn())}),X(),_(151,"svg",116),W(152,"path",117)(153,"path",118),b()()(),Q(154,fz,23,9,"div",119),Re(),_(155,"div",120),W(156,"div",121),_(157,"div",122)(158,"div",123)(159,"span",124),v(160),b(),_(161,"span",125),v(162),b()(),W(163,"div",126),_(164,"div",127)(165,"div",128)(166,"span",129),X(),_(167,"svg",130),W(168,"rect",87)(169,"circle",131)(170,"circle",132)(171,"rect",133)(172,"circle",134)(173,"circle",135),b()(),Re(),_(174,"span",136),v(175),b()(),_(176,"div",128)(177,"span",129),X(),_(178,"svg",137),W(179,"path",90)(180,"circle",91),b()(),Re(),_(181,"span",138),v(182),b()(),_(183,"div",139)(184,"span",129)(185,"div",140),X(),_(186,"svg",141),W(187,"polygon",142)(188,"rect",143)(189,"polygon",144)(190,"rect",145)(191,"polygon",146)(192,"rect",147),_(193,"g",148),W(194,"rect",149)(195,"polygon",150),b(),_(196,"g",151),W(197,"rect",152)(198,"circle",153)(199,"circle",154),b()()()(),Re(),_(200,"span",155),v(201),_(202,"span",156),v(203,"/"),b(),v(204),b()()()(),_(205,"div",157),W(206,"div",158),_(207,"span",159),v(208),b(),_(209,"div",45)(210,"span",160),v(211),b()(),Q(212,pz,2,3,"div",161),b(),_(213,"div",122)(214,"div",127)(215,"div",128)(216,"span",162),v(217),b(),_(218,"span",129),X(),_(219,"svg",130),W(220,"rect",87)(221,"circle",131)(222,"circle",132)(223,"rect",133)(224,"circle",134)(225,"circle",135),b()()(),Re(),_(226,"div",128)(227,"span",129),X(),_(228,"svg",137),W(229,"path",90)(230,"circle",91),b()(),Re(),_(231,"span",138),v(232),b()(),_(233,"div",163)(234,"span",164),v(235),_(236,"span",156),v(237,"/"),b(),v(238),b(),_(239,"span",129)(240,"div",140),X(),_(241,"svg",141),W(242,"polygon",142)(243,"rect",143)(244,"polygon",144)(245,"rect",145)(246,"polygon",146)(247,"rect",147),_(248,"g",148),W(249,"rect",149)(250,"polygon",165),b(),_(251,"g",151),W(252,"rect",152)(253,"circle",153)(254,"circle",154),b()()()()()(),Re(),W(255,"div",126),_(256,"div",166)(257,"span",167),v(258),b(),_(259,"span",168),v(260,"jaerbi"),b()()()(),Q(261,yz,11,11,"div",169),_(262,"button",170),ne("click",function(){return re(r),oe(i.navigateToRoadmap())}),_(263,"div",171),W(264,"div",172),_(265,"span",173),v(266),b()(),_(267,"div",174),X(),_(268,"svg",175),W(269,"path",176),b()()(),Re(),_(270,"button",177),ne("click",function(){return re(r),oe(i.gameEngine.toggleSupport())}),_(271,"span",129),v(272,"\u2764\uFE0F"),b(),_(273,"span",178),v(274),b()(),Q(275,vz,1,0,"app-support-community"),Q(276,_z,1,0,"app-leaderboard-modal"),_(277,"div",179),Q(278,Ez,1,0,"app-sandbox"),_(279,"div",180,0)(281,"div",181)(282,"div",182)(283,"span",183),v(284),b()(),Q(285,bz,3,1,"div",184),wn(286,wW,2,0,null,null,Cr),b()(),_(288,"div",185)(289,"div",186),W(290,"div",187),_(291,"div",188)(292,"span",189),v(293),b(),_(294,"div",190)(295,"span",191),v(296),b(),_(297,"div",192)(298,"span",129),v(299),b()()(),_(300,"div",193),W(301,"div",194),b()()()(),_(302,"div",195)(303,"div",196)(304,"button",197),ne("click",function(){return re(r),oe(i.toggleAutoBattle())}),_(305,"div",198)(306,"span",199),v(307),b(),_(308,"span",200),v(309),b()(),_(310,"div",198),W(311,"span",201),b(),W(312,"div",202),b(),_(313,"button",203),ne("click",function(){return re(r),oe(i.gameEngine.toggleBuildMode())}),_(314,"div",204)(315,"span",205),v(316,"+1"),b(),_(317,"div",206),X(),_(318,"svg",207),W(319,"path",208)(320,"path",209)(321,"path",210)(322,"rect",211),b()()(),Re(),_(323,"div",212)(324,"span"),v(325,"-10"),b(),_(326,"div",213),X(),_(327,"svg",214),W(328,"rect",215)(329,"circle",216)(330,"circle",217),b()()(),Re(),W(331,"div",202),b(),_(332,"button",218),ne("click",function(){return re(r),oe(i.gameEngine.convertWoodToReserve())}),_(333,"div",219)(334,"span",220)(335,"span"),v(336,"20"),b(),_(337,"div",213),X(),_(338,"svg",214),W(339,"rect",215)(340,"circle",216)(341,"circle",217),b()()(),Re(),_(342,"span",129),v(343,"\u2794"),b(),_(344,"span",221),v(345,"1 \u{1F464}"),b()()(),_(346,"button",222),ne("click",function(){return re(r),oe(i.gameEngine.maxConvertWoodToReserve())}),_(347,"div",223)(348,"span",224),v(349),b(),_(350,"span",129),v(351,"\u2794"),b(),_(352,"span",129),v(353,"\u{1F465}++"),b()()()(),_(354,"label",225)(355,"div",109)(356,"input",110),ne("change",function(){return re(r),oe(i.gameEngine.toggleFogDebug())}),b(),_(357,"div",111),W(358,"div",112),b()(),_(359,"span",113),v(360),b()(),_(361,"button",226),ne("click",function(){return re(r),oe(i.gameEngine.endPlayerTurn())}),_(362,"div",227)(363,"span",224),v(364),b(),X(),_(365,"svg",116),W(366,"path",117)(367,"path",118),b()()(),Re(),_(368,"div",114),v(369),b()()(),_(370,"div",228),v(371),b(),Q(372,xW,1,0,"app-game-rules"),Q(373,TW,24,5,"div",229),Q(374,AW,34,14,"div",230),Q(375,kW,24,9,"div",231),Q(376,OW,9,2,"div",232),b()}if(t&2){let r;y(56),q(i.settings.version),y(8),G(" ",i.settings.t("RELOAD")," "),y(6),G(" ",i.settings.t("INFO")," "),y(6),q(i.settings.t("RECORDS")),y(5),q(i.settings.t("RANKING")),y(5),q(i.settings.t("SYSTEM_LOG")),y(5),q(i.settings.t("FEEDBACK_MODULE")),y(6),J((r=i.firebase.user$())?97:98,r),y(8),q(i.gameEngine.resources().wood),y(6),q(i.gameEngine.resources().iron),y(5),tn(" ",i.gameEngine.getForestControl().player,"/",i.gameEngine.getForestControl().total," "),y(6),q(i.gameEngine.turn()),y(7),tn(" ",i.gameEngine.getForestControl().player," : ",i.gameEngine.getForestControl().ai," "),y(5),Oe("disabled",!i.gameEngine.canBuildThisTurn()),y(3),Oe("disabled",!i.gameEngine.canAddReserveTurn()),y(2),Oe("disabled",!i.gameEngine.canAddReserveTurn()),y(),G(" ",i.settings.t("ALL")," "),y(3),Oe("checked",i.gameEngine.fogDebugDisabled()),y(4),q(i.settings.t("MAP_HACK")),y(2),tn(" ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),y(5),J(i.isMobileMenuOpen()?154:-1),y(6),G(" ",i.settings.t("COMMANDER")," "),y(2),G(" ",i.settings.t("PLAYER")," "),y(3),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),y(10),q(i.gameEngine.resources().wood),y(),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),y(6),q(i.gameEngine.resources().iron),y(),Ft("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),y(18),G(" ",i.gameEngine.getForestControl().player," "),y(3),G(" ",i.gameEngine.getForestControl().total," "),y(4),G(" ",i.settings.t("TURN_CYCLE")," "),y(3),G(" ",i.gameEngine.turn()," "),y(),J(i.gameEngine.monopolyTurnsLeft()>0?212:-1),y(3),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),y(2),q(i.gameEngine.aiWood()),y(9),Ft("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),y(6),q(i.gameEngine.aiIron()),y(),Ft("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),y(2),G(" ",i.gameEngine.getForestControl().ai," "),y(3),G(" ",i.gameEngine.getForestControl().total," "),y(20),G(" ",i.settings.t("HOSTILE")," "),y(3),J(i.gameEngine.shouldShowEndOverlay()?261:-1),y(5),G(" ",i.settings.t("STRATEGIC_PLAN")," "),y(8),q(i.settings.t("SUPPORT")),y(),J(i.gameEngine.supportOpen()?275:-1),y(),J(i.gameEngine.leaderboardOpen()?276:-1),y(2),J(i.settings.customMode()?278:-1),y(),Ne("shake",i.gameEngine.screenShake())("mood-none",i.gameEngine.currentMood()==="none")("mood-angry",i.gameEngine.currentMood()==="angry")("mood-rage",i.gameEngine.currentMood()==="rage"),y(2),it("grid-template-columns","repeat("+i.gameEngine.gridSize+", minmax("+i.gameEngine.tileMinSizePx+"px, "+i.gameEngine.tileSizePx+"px))")("gap",i.gameEngine.wallThicknessPx+2,"px"),y(3),G(" ",i.gameEngine.baseHealth().player," "),y(),J(i.gameEngine.isVisibleToPlayer(i.gameEngine.gridSize-1,i.gameEngine.gridSize-1)?285:-1),y(),xn(i.gameEngine.gridRows),y(4),Ne("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),y(3),q(i.settings.t("RISK")),y(2),Ne("text-lime-300",i.settings.difficulty()==="baby")("text-emerald-300",i.settings.difficulty()==="normal")("text-orange-400",i.settings.difficulty()==="hard")("text-red-500",i.settings.difficulty()==="nightmare"),y(),G(" ",i.settings.t(i.settings.getDifficultyLabel(i.settings.difficulty()))," "),y(3),G(" ",i.settings.difficulty()==="baby"?"\u{1F476}":i.settings.difficulty()==="normal"?"\u{1F920}":i.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),y(2),it("width",i.settings.difficulty()==="baby"?25:i.settings.difficulty()==="normal"?50:i.settings.difficulty()==="hard"?75:100,"%"),Ne("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),y(3),Ne("ring-2",i.isAutoBattleActive())("ring-green-400",i.isAutoBattleActive()),Oe("disabled",i.gameEngine.gameStatus()!=="playing"),y(3),q(i.settings.t("AUTO")),y(2),q(i.settings.t("ENGAGE")),y(2),Ne("bg-green-400",i.isAutoBattleActive())("bg-gray-500",!i.isAutoBattleActive()),y(2),Ne("ring-2",i.gameEngine.buildMode())("ring-blue-400",i.gameEngine.buildMode()),Oe("disabled",i.gameEngine.wallBuiltThisTurn()||!i.gameEngine.canBuildThisTurn()),y(19),Oe("disabled",!i.gameEngine.canAddReserveTurn()),y(14),Oe("disabled",!i.gameEngine.canAddReserveTurn()),y(3),q(i.settings.t("ALL")),y(7),Oe("checked",i.gameEngine.fogDebugDisabled()),y(4),q(i.settings.t("MAP_HACK")),y(4),q(i.settings.t("NEXT_TURN")),y(5),Xo(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),y(2),G(" ",i.settings.version," | \xA9\uFE0E Created by jaerbi and just "),y(),J(i.gameEngine.rulesOpen()?372:-1),y(),J(i.gameEngine.logOpen()?373:-1),y(),J(i.gameEngine.settingsOpen()?374:-1),y(),J(i.gameEngine.highScoresOpen()?375:-1),y(),J(i.isProduction?-1:376)}},dependencies:[jt,s0,a0,l0,c0,u0,ME,da],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}.move-anim[_ngcontent-%COMP%]{transition:transform .15s cubic-bezier(.4,0,.2,1);will-change:transform}"]})};var eO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(ge(sa),ge(Qi))};static \u0275dir=bn({type:n})}return n})(),FW=(()=>{class n extends eO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275dir=bn({type:n,features:[Tr]})}return n})(),tO=new _e("");var LW={provide:tO,useExisting:$o(()=>_0),multi:!0};function VW(){let n=Pi()?Pi().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var UW=new _e(""),_0=(()=>{class n extends eO{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!VW())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(ge(sa),ge(Qi),ge(UW,8))};static \u0275dir=bn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&ne("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Fu([LW]),Tr]})}return n})();function P1(n){return n==null||N1(n)===0}function N1(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var nO=new _e(""),iO=new _e(""),BW=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Mo=class{static min(e){return jW(e)}static max(e){return HW(e)}static required(e){return $W(e)}static requiredTrue(e){return GW(e)}static email(e){return zW(e)}static minLength(e){return WW(e)}static maxLength(e){return qW(e)}static pattern(e){return KW(e)}static nullValidator(e){return rO()}static compose(e){return uO(e)}static composeAsync(e){return hO(e)}};function jW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function HW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function $W(n){return P1(n.value)?{required:!0}:null}function GW(n){return n.value===!0?null:{required:!0}}function zW(n){return P1(n.value)||BW.test(n.value)?null:{email:!0}}function WW(n){return e=>{let t=e.value?.length??N1(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function qW(n){return e=>{let t=e.value?.length??N1(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function KW(n){if(!n)return rO;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(P1(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function rO(n){return null}function oO(n){return n!=null}function sO(n){return Jo(n)?an(n):n}function aO(n){let e={};return n.forEach(t=>{e=t!=null?F(F({},e),t):e}),Object.keys(e).length===0?null:e}function lO(n,e){return e.map(t=>t(n))}function YW(n){return!n.validate}function cO(n){return n.map(e=>YW(e)?e:t=>e.validate(t))}function uO(n){if(!n)return null;let e=n.filter(oO);return e.length==0?null:function(t){return aO(lO(t,e))}}function dO(n){return n!=null?uO(cO(n)):null}function hO(n){if(!n)return null;let e=n.filter(oO);return e.length==0?null:function(t){let i=lO(t,e).map(sO);return py(i).pipe(yt(aO))}}function fO(n){return n!=null?hO(cO(n)):null}function Wk(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function pO(n){return n._rawValidators}function gO(n){return n._rawAsyncValidators}function D1(n){return n?Array.isArray(n)?n:[n]:[]}function f0(n,e){return Array.isArray(n)?n.includes(e):n===e}function qk(n,e){let t=D1(e);return D1(n).forEach(r=>{f0(t,r)||t.push(r)}),t}function Kk(n,e){return D1(e).filter(t=>!f0(n,t))}var p0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=dO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=fO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ec=class extends p0{name;get formDirective(){return null}get path(){return null}},lh=class extends p0{_parent=null;name=null;valueAccessor=null},g0=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var mO=(()=>{class n extends g0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(ge(lh,2))};static \u0275dir=bn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Ne("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Tr]})}return n})(),yO=(()=>{class n extends g0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(ge(Ec,10))};static \u0275dir=bn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Ne("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Tr]})}return n})();var rh="VALID",h0="INVALID",vc="PENDING",oh="DISABLED",xs=class{},m0=class extends xs{value;source;constructor(e,t){super(),this.value=e,this.source=t}},sh=class extends xs{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},ah=class extends xs{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},_c=class extends xs{status;source;constructor(e,t){super(),this.status=e,this.source=t}},A1=class extends xs{source;constructor(e){super(),this.source=e}},ch=class extends xs{source;constructor(e){super(),this.source=e}};function k1(n){return(E0(n)?n.validators:n)||null}function QW(n){return Array.isArray(n)?dO(n):n||null}function O1(n,e){return(E0(e)?e.asyncValidators:n)||null}function JW(n){return Array.isArray(n)?fO(n):n||null}function E0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function vO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new pe(1e3,"");if(!i[t])throw new pe(1001,"")}function _O(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new pe(1002,"")})}var bc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return cn(this.statusReactive)}set status(e){cn(()=>this.statusReactive.set(e))}_status=ti(()=>this.statusReactive());statusReactive=$(void 0);get valid(){return this.status===rh}get invalid(){return this.status===h0}get pending(){return this.status==vc}get disabled(){return this.status===oh}get enabled(){return this.status!==oh}errors;get pristine(){return cn(this.pristineReactive)}set pristine(e){cn(()=>this.pristineReactive.set(e))}_pristine=ti(()=>this.pristineReactive());pristineReactive=$(!0);get dirty(){return!this.pristine}get touched(){return cn(this.touchedReactive)}set touched(e){cn(()=>this.touchedReactive.set(e))}_touched=ti(()=>this.touchedReactive());touchedReactive=$(!1);get untouched(){return!this.touched}_events=new Ut;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(qk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(qk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Kk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Kk(e,this._rawAsyncValidators))}hasValidator(e){return f0(this._rawValidators,e)}hasAsyncValidator(e){return f0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ue(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new ah(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new ah(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ue(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new sh(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new sh(!0,i))}markAsPending(e={}){this.status=vc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new _c(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ue(F({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=oh,this.errors=null,this._forEachChild(r=>{r.disable(ue(F({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new m0(this.value,i)),this._events.next(new _c(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ue(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=rh,this._forEachChild(i=>{i.enable(ue(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ue(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===rh||this.status===vc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new m0(this.value,t)),this._events.next(new _c(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ue(F({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?oh:rh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=vc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=sO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new _c(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new ln,this.statusChanges=new ln}_calculateStatus(){return this._allControlsDisabled()?oh:this.errors?h0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vc)?vc:this._anyControlsHaveStatus(h0)?h0:rh}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new sh(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new ah(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){E0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=QW(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=JW(this._rawAsyncValidators)}},wc=class extends bc{constructor(e,t,i){super(k1(t),O1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){_O(this,!0,e),Object.keys(e).forEach(i=>{vO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,ue(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new ch(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var M1=class extends wc{};var EO=new _e("",{factory:()=>F1}),F1="always";function ZW(n,e){return[...e.path,n]}function Yk(n,e,t=F1){L1(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),eq(n,e),nq(n,e),tq(n,e),XW(n,e)}function Qk(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),v0(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function y0(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function XW(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function L1(n,e){let t=pO(n);e.validator!==null?n.setValidators(Wk(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=gO(n);e.asyncValidator!==null?n.setAsyncValidators(Wk(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();y0(e._rawValidators,r),y0(e._rawAsyncValidators,r)}function v0(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=pO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=gO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return y0(e._rawValidators,i),y0(e._rawAsyncValidators,i),t}function eq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&bO(n,e)})}function tq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&bO(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function bO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function nq(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function iq(n,e){n==null,L1(n,e)}function rq(n,e){return v0(n,e)}function oq(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function sq(n){return Object.getPrototypeOf(n.constructor)===FW}function aq(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function lq(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===_0?t=o:sq(o)?i=o:r=o}),r||i||t||null}function cq(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Jk(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Zk(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Ua=class extends bc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(k1(t),O1(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),E0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Zk(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new ch(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Jk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Jk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Zk(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var uq=n=>n instanceof Ua;var wO=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=bn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var R1=class extends bc{constructor(e,t,i){super(k1(t),O1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){_O(this,!1,e),e.forEach((i,r)=>{vO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],ue(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new ch(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var dq=(()=>{class n extends Ec{callSetDisabledState;get submitted(){return cn(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=ti(()=>this._submittedReactive());_submittedReactive=$(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(v0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let i=this.form.get(t.path);return Yk(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){Qk(t.control||null,t,!1),cq(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,i){this.form.get(t.path).setValue(i)}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,aq(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new A1(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(Qk(i||null,t),uq(r)&&(Yk(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);iq(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&rq(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){L1(this.form,this),this._oldForm&&v0(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(i){return new(i||n)(ge(nO,10),ge(iO,10),ge(EO,8))};static \u0275dir=bn({type:n,features:[Tr,no]})}return n})();var xO=new _e("");var hq={provide:lh,useExisting:$o(()=>V1)},V1=(()=>{class n extends lh{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new ln;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=lq(this,o)}ngOnChanges(t){this._added||this._setUpControl(),oq(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return ZW(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(ge(Ec,13),ge(nO,10),ge(iO,10),ge(tO,10),ge(xO,8))};static \u0275dir=bn({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Fu([hq]),Tr,no]})}return n})();var fq={provide:Ec,useExisting:$o(()=>U1)},U1=(()=>{class n extends dq{form=null;ngSubmit=new ln;get control(){return this.form}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275dir=bn({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&ne("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Fu([fq]),Tr]})}return n})();var pq=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ro({type:n});static \u0275inj=gr({})}return n})();function Xk(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var SO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return Xk(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new wc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new M1(r,i)}control(t,i,r){let o={};return this.useNonNullable?(Xk(i)?o=i:(o.validators=i,o.asyncValidators=r),new Ua(t,ue(F({},o),{nonNullable:!0}))):new Ua(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new R1(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof Ua)return t;if(t instanceof bc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var IO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:xO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:EO,useValue:t.callSetDisabledState??F1}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ro({type:n});static \u0275inj=gr({imports:[pq]})}return n})();var b0=class n{db;auth;constructor(){let e=vd(o0);this.db=Gd(e),this.auth=ih(e)}async addFeedback(e){let t=ue(F({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:zd()});await Kd(wi(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=To(wi(this.db,"feedbacks"),sr("timestamp","desc"),_s(e));return(await Es(t)).docs.map(r=>r.data())}async getFeedbackPage(e,t){let i=[sr("timestamp","desc"),_s(e)],r=t?To(wi(this.db,"feedbacks"),sr("timestamp","desc"),QN(t),_s(e)):To(wi(this.db,"feedbacks"),sr("timestamp","desc"),_s(e)),o=await Es(r),s=o.docs.map(l=>l.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),i=To(wi(this.db,"feedbacks"),vs("userId","==",e),vs("timestamp",">=",t)),o=(await Es(i)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var B1=()=>[1,2,3,4,5],TO=(n,e)=>e.timestamp;function yq(n,e){if(n&1){let t=Je();_(0,"button",39),ne("click",function(){let r=re(t).$implicit,o=O(2);return oe(o.setRating(r))}),v(1," \u2605 "),b()}if(n&2){let t=e.$implicit,i=O(2);Ne("active",i.form.value.rating>=t)}}function vq(n,e){if(n&1&&(_(0,"div",36),v(1),b()),n&2){let t=O(2);y(),q(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function _q(n,e){n&1&&(_(0,"div",37),v(1),b()),n&2&&(y(),q(e))}function Eq(n,e){if(n&1){let t=Je();_(0,"div",25)(1,"div",26),W(2,"img",27),b(),_(3,"div",28)(4,"div",29),v(5),b(),_(6,"div",30),v(7),b()()(),_(8,"form",31),ne("ngSubmit",function(){re(t);let r=O();return oe(r.submit())}),_(9,"div")(10,"div",32),v(11),b(),_(12,"div",33),wn(13,yq,2,2,"button",34,Cr),b()(),_(15,"div")(16,"div",32),v(17),b(),W(18,"textarea",35),Q(19,vq,2,1,"div",36),Q(20,_q,2,1,"div",37),b(),_(21,"button",38),v(22),b()()}if(n&2){let t,i=e,r=O();y(2),Oe("src",i.photoURL,Zi),y(3),q(i.displayName),y(2),q(r.settings.t("OPERATOR_ONLINE")),y(),Oe("formGroup",r.form),y(3),q(r.settings.t("EFFICIENCY_RATING")),y(2),xn(aa(16,B1)),y(4),q(r.settings.t("TACTICAL_NOTE")),y(),Oe("placeholder",aE(r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),y(),J(r.form.controls.text.errors?19:-1),y(),J((t=r.message())?20:-1,t),y(),Ne("cursor-pointer",r.canSubmit)("cursor-not-allowed",!r.canSubmit),Oe("disabled",!r.canSubmit),y(),G(" ",r.settings.t("TRANSMIT_REPORT")," ")}}function bq(n,e){if(n&1&&(_(0,"div",21),v(1),b()),n&2){let t=O();y(),q(t.settings.t("SYSTEM_LOG"))}}function wq(n,e){if(n&1&&(_(0,"div",22),v(1),b()),n&2){let t=O();y(),q(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function xq(n,e){if(n&1&&(_(0,"span"),v(1,"\u2605"),b()),n&2){let t=e.$implicit,i=O().$implicit;Ne("active",i.rating>=t)}}function Sq(n,e){if(n&1&&(_(0,"tr",44)(1,"td",47),W(2,"img",48),_(3,"span"),v(4),b()(),_(5,"td",49)(6,"div",50),wn(7,xq,2,2,"span",51,Cr),b()(),_(9,"td",49)(10,"span",52),v(11),b()(),_(12,"td",49)(13,"span",53),v(14),b()()()),n&2){let t=e.$implicit,i=O(2);y(2),Oe("src",t.userPhoto,Zi),y(2),q(t.userName),y(3),xn(aa(4,B1)),y(4),q(t.text),y(3),q(i.formatDate(t.timestamp))}}function Iq(n,e){if(n&1&&(_(0,"tr")(1,"td",54),v(2),b()()),n&2){let t=O(2);y(2),q(t.settings.t("NO_SIGNALS"))}}function Tq(n,e){if(n&1){let t=Je();_(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),v(5),b(),_(6,"th",43),v(7),b(),_(8,"th",43),v(9),b(),_(10,"th",43),v(11),b()()(),_(12,"tbody"),wn(13,Sq,15,5,"tr",44,TO,!1,Iq,3,1,"tr"),b()()(),_(16,"div",45)(17,"button",46),ne("click",function(){re(t);let r=O();return oe(r.prevPage())}),v(18),b(),_(19,"button",46),ne("click",function(){re(t);let r=O();return oe(r.nextPage())}),v(20),b()()}if(n&2){let t=O();y(5),q(t.settings.t("TABLE_OPERATOR")),y(2),q(t.settings.t("TABLE_RATING")),y(2),q(t.settings.t("TABLE_MESSAGE")),y(2),q(t.settings.t("TABLE_DATE")),y(2),xn(t.pageItems()),y(5),G(" ",t.settings.t("PREVIOUS")," "),y(2),G(" ",t.settings.t("NEXT")," ")}}function Cq(n,e){if(n&1&&(_(0,"span"),v(1,"\u2605"),b()),n&2){let t=e.$implicit,i=O().$implicit;Ne("active",i.rating>=t)}}function Dq(n,e){if(n&1&&(_(0,"div",55)(1,"div",56)(2,"div",57),W(3,"img",58),_(4,"div",59),v(5),b()(),_(6,"div",50),wn(7,Cq,2,2,"span",51,Cr),b()(),_(9,"div",60),v(10),b()()),n&2){let t=e.$implicit;y(3),Oe("src",t.userPhoto,Zi),y(2),q(t.userName),y(2),xn(aa(3,B1)),y(3),q(t.text)}}function Aq(n,e){if(n&1&&wn(0,Dq,11,4,"div",55,TO),n&2){let t=O();xn(t.recent())}}var w0=class n{constructor(e,t,i,r,o){this.fb=e;this.router=t;this.feedback=i;this.firebase=r;this.settings=o;this.form=new wc({text:new Ua("",{nonNullable:!0,validators:[Mo.required,Mo.minLength(10),Mo.maxLength(500)]}),rating:new Ua(5,{nonNullable:!0,validators:[Mo.required,Mo.min(1),Mo.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,l=Number(localStorage.getItem(a)||0);this.disabledUntil.set(l)}this.loadPage(0)}recent=$([]);pageItems=$([]);pageStack=[null];pageIndex=$(0);lastDoc=null;disabledUntil=$(0);message=$(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);if(this.pageItems.set(r.items),this.lastDoc=r.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);this.pageItems.set(r.items),this.lastDoc=r.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:i}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let r=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:r.text||"",rating:Number(r.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(ge(SO),ge(_i),ge(b0),ge(jn),ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,i){if(t&1&&(_(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),b(),X(),_(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),b()()(),Re(),_(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),v(15),b(),_(16,"span",14),v(17),b()(),_(18,"a",15),v(19),b()(),_(20,"div",16)(21,"div",17)(22,"div",18),v(23),b(),Q(24,Eq,23,17),b(),_(25,"div",19)(26,"div",20),Q(27,bq,2,1,"div",21),Q(28,wq,2,1,"div",22),_(29,"button",23),ne("click",function(){return i.isAllShow=!i.isAllShow}),v(30),b()(),_(31,"div",24),Q(32,Tq,21,7),Q(33,Aq,2,0),b()()()()()),t&2){let r;y(15),q(i.settings.t("FEEDBACK_MODULE")),y(2),q(i.settings.t("COMMUNITY_SIGNALS")),y(2),q(i.settings.t("RETURN_TO_MAP")),y(4),q(i.settings.t("DEPLOY_REPORT")),y(),J((r=i.firebase.user$())?24:-1,r),y(3),J(i.isAllShow?-1:27),y(),J(i.isAllShow?28:-1),y(2),G(" ",i.isAllShow?i.settings.t("TOGGLE_BACK"):i.settings.t("VIEW_FULL_ARCHIVE")," "),y(2),J(i.isAllShow?32:-1),y(),J(i.isAllShow?-1:33)}},dependencies:[jt,IO,wO,_0,mO,yO,U1,V1,ss],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var x0=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-roadmap"]],decls:93,vars:13,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"absolute","top-0","right-0","w-16","h-16","bg-emerald-500/10","blur-2xl","-mr-8","-mt-8"],[1,"card-header","relative","z-10"],[1,"text-[11px]","font-mono","text-emerald-200/50","italic"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","uppercase","tracking-wider","bg-emerald-500/20","text-emerald-400","border","border-emerald-500/40"],[1,"flex","items-start","gap-4","mt-4","relative","z-10"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/60","rotate-45","flex","items-center","justify-center","group-hover:rotate-180","transition-all","duration-700","shadow-[0_0_15px_rgba(16,185,129,0.2)]"],[1,"-rotate-45","group-hover:-rotate-180","transition-all","duration-700","text-xl"],[1,"text-lg","font-bold","text-emerald-50","leading-tight","mb-2","opacity-80","decoration-emerald-500/30","line-through","decoration-2"],[1,"text-sm","text-emerald-100/40","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-emerald-500/10","flex","justify-between","items-center","relative","z-10"],[1,"text-[9px]","uppercase","tracking-widest","text-emerald-500/40","font-bold"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-emerald-500","shadow-[0_0_5px_#10b981]"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,i){t&1&&(_(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),b(),X(),_(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),b()()(),Re(),W(11,"div",10)(12,"div",11),_(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),W(17,"div",16),_(18,"h1",17),v(19),b()(),_(20,"p",18),v(21,"Future_Ops // Deployment_Schedule"),b()(),_(22,"a",19)(23,"span",20),v(24,"\xAB"),b(),v(25),b()(),_(26,"div",21)(27,"div",22),W(28,"div",23),_(29,"div",24)(30,"span",25),v(31,"REF: PROJECT_VOLUMETRIC"),b(),_(32,"span",26),v(33),b()(),_(34,"div",27)(35,"div",28)(36,"div",29),v(37),b()(),_(38,"div")(39,"h3",30),v(40),b(),_(41,"p",31),v(42),b()()(),_(43,"div",32)(44,"span",33),v(45,"System_Verified"),b(),_(46,"div",34),W(47,"div",35)(48,"div",35)(49,"div",35),b()()(),_(50,"div",22)(51,"div",36)(52,"span",37),v(53,"REF: RESOURCE_IRON"),b(),_(54,"span",26),v(55),b()(),_(56,"div",38)(57,"div",39)(58,"span"),v(59,"\u26D3\uFE0F"),b()(),_(60,"div")(61,"h3",40),v(62),b(),_(63,"p",41),v(64),b()()(),_(65,"div",42)(66,"span",43),v(67,"Priority_Beta"),b(),_(68,"div",34),W(69,"div",44)(70,"div",45)(71,"div",45),b()()(),_(72,"div",46)(73,"div",36)(74,"span",37),v(75,"REF: INFRA_SMITHY"),b(),_(76,"span",26),v(77),b()(),_(78,"div",47)(79,"div",48),W(80,"div",49),_(81,"span",50),v(82,"\u2692\uFE0F"),b()(),_(83,"div")(84,"h3",51),v(85),b(),_(86,"p",52),v(87),b()()()()(),_(88,"div",53)(89,"div",54),v(90,"Community_Intel"),b(),_(91,"p",55),v(92),b()()()()),t&2&&(y(19),G(" ",i.settings.t("STRATEGIC_PLAN")," "),y(6),G(" ",i.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),y(8),G(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(4),G(" ",i.settings.currentLang()==="uk"?"\u2714\uFE0F":"\u2705"," "),y(3),G(" ",i.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"," "),y(2),G(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),y(13),G(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(7),q(i.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),y(2),G(" ",i.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),y(13),G(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(8),q(i.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),y(2),G(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),y(5),G(" ",i.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[jt,ss],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var S0=class n{constructor(e,t){this.router=e;this.settings=t}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||n)(ge(_i),ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-landing-page"]],decls:41,vars:7,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden","relative"],[1,"absolute","top-1/4","-left-1/4","w-96","h-96","bg-emerald-500/20","rounded-full","blur-3xl","animate-pulse"],[1,"absolute","bottom-1/4","-right-1/4","w-96","h-96","bg-purple-500/20","rounded-full","blur-3xl","animate-pulse",2,"animation-delay","1ms"],[1,"z-10","text-center","mb-12"],[1,"text-6xl","font-black","tracking-tighter","mb-4","bg-gradient-to-r","from-emerald-400","to-cyan-400","bg-clip-text","text-transparent","drop-shadow-sm"],[1,"text-slate-400","text-lg","max-w-md","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","w-full","max-w-5xl","z-10"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-emerald-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-emerald-400","hover:shadow-[0_0_40px_-10px_rgba(52,211,153,0.3)]","text-left",3,"click"],[1,"absolute","top-0","right-0","p-4","opacity-10","group-hover:opacity-20","transition-opacity"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24"],["d","M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.8L19.5 8 12 11.2 4.5 8 12 4.8zM4 15.5v-5.2l7 3.1v5.2l-7-3.1zm9 3.1v-5.2l7-3.1v5.2l-7 3.1z"],[1,"relative","z-20"],[1,"inline-block","px-3","py-1","bg-emerald-500/10","text-emerald-400","text-xs","font-bold","rounded-full","mb-4","border","border-emerald-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-emerald-50"],[1,"text-slate-400","leading-relaxed","mb-6"],[1,"flex","items-center","text-emerald-400","font-bold","group-hover:translate-x-2","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-purple-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-purple-400","hover:shadow-[0_0_40px_-10px_rgba(168,85,247,0.3)]","text-left",3,"click"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"inline-block","px-3","py-1","bg-purple-500/10","text-purple-400","text-xs","font-bold","rounded-full","mb-4","border","border-purple-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-purple-50"],[1,"flex","items-center","text-purple-400","font-bold","group-hover:translate-x-2","transition-transform"],[1,"absolute","bottom-6","text-slate-500","text-sm","font-medium","uppercase","tracking-widest"]],template:function(t,i){t&1&&(C(0,"div",0),j(1,"div",1)(2,"div",2),C(3,"div",3)(4,"h1",4),v(5),A(),C(6,"p",5),v(7),A()(),C(8,"div",6)(9,"button",7),Bt("click",function(){return i.navigateTo("shape-tactics")}),C(10,"div",8),X(),C(11,"svg",9),j(12,"path",10),A()(),Re(),C(13,"div",11)(14,"span",12),v(15),A(),C(16,"h2",13),v(17,"Shape Tactics"),A(),C(18,"p",14),v(19),A(),C(20,"div",15),v(21," ENTER PORTAL "),X(),C(22,"svg",16),j(23,"path",17),A()()()(),Re(),C(24,"button",18),Bt("click",function(){return i.navigateTo("tower-defense")}),C(25,"div",8),X(),C(26,"svg",9),j(27,"path",19),A()(),Re(),C(28,"div",11)(29,"span",20),v(30),A(),C(31,"h2",21),v(32,"Shape Defense"),A(),C(33,"p",14),v(34),A(),C(35,"div",22),v(36," DEFEND BASE "),X(),C(37,"svg",16),j(38,"path",17),A()()()()(),Re(),C(39,"footer",23),v(40),A()()),t&2&&(y(5),G(" ",i.settings.currentLang()==="uk"?"\u0406\u0413\u0420\u041E\u0412\u0418\u0419 \u0426\u0415\u041D\u0422\u0420":"GAMING HUB"," "),y(2),G(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043E\u0440\u0442\u0430\u043B, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0441\u0432\u043E\u044E \u043F\u043E\u0434\u043E\u0440\u043E\u0436.":"Select a portal to begin your journey."," "),y(8),G(" ","Live Now"," "),y(4),G(" ",i.settings.t("SHAPE_TACTIC_DESCRIPTION")," "),y(11),G(" ",i.settings.currentLang()==="uk"?"\u0413\u0420\u0410\u0422\u0418 \u0417\u0410\u0420\u0410\u0417":"PLAY NOW"," "),y(4),G(" ",i.settings.t("TOWER_DEFFENCE_DESCRIPTION")," "),y(6),G(" \xA9 2026 Shape Tactics Labs // ",i.settings.version," "))},dependencies:[jt],styles:["[_nghost-%COMP%]{display:block}"]})};var I0=class n{constructor(e,t){this.ngZone=e;this.firebase=t;this.initGame()}money=$(100);lives=$(20);wave=$(0);isWaveInProgress=$(!1);gameOver=$(!1);gridSize=10;grid=$([]);path=$([]);tileSize=62;enemies=$([]);projectiles=$([]);gameSpeedMultiplier=$(1);enemiesInternal=[];projectilesInternal=[];towersInternal=[];enemyIdCounter=1;projectileIdCounter=1;uiTick$=new Ut;animationFrameId=null;lastUpdateTime=0;lastUiPublishTime=0;enemiesToSpawn=0;currentWaveEnemyCount=0;spawnTimer=0;spawnInterval=1e3;towerCosts=[15,50,250,1500];tierStats=[{damage:5,range:2,fireInterval:.5},{damage:20,range:2.5,fireInterval:1},{damage:80,range:3,fireInterval:2},{damage:300,range:3.5,fireInterval:3}];savedResult=!1;async saveResultIfLoggedIn(){let e=this.firebase.user$();if(!e)return;let t={userId:e.uid,displayName:e.displayName||"Anonymous",maxWave:this.wave(),totalMoney:this.money()};try{await this.firebase.saveTowerDefenseScore(t)}catch{}}dispose(){this.stopGameLoop(),this.enemiesInternal=[],this.projectilesInternal=[],this.towersInternal=[],this.enemiesToSpawn=0,this.currentWaveEnemyCount=0,this.spawnTimer=0,this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!1),this.savedResult=!1,this.money.set(100),this.lives.set(100),this.wave.set(0);let e=this.grid();if(e&&e.length){let t=e.map(i=>i.map(r=>r.tower?ue(F({},r),{tower:null}):r));this.grid.set(t)}}resetEngine(){this.dispose(),this.generateMap()}initGame(){this.dispose(),this.generateMap()}resetGame(){this.initGame()}generateMap(){let e=this.generateRandomPath();this.path.set(e);let t=[];this.towersInternal=[];let i=new Set(e.map(r=>`${r.x},${r.y}`));for(let r=0;r<this.gridSize;r++){let o=[];for(let s=0;s<this.gridSize;s++){let a="void";i.has(`${s},${r}`)?a="path":[{x:s-1,y:r},{x:s+1,y:r},{x:s,y:r-1},{x:s,y:r+1}].some(c=>i.has(`${c.x},${c.y}`))&&(a="buildable"),o.push({x:s,y:r,type:a,tower:null})}t.push(o)}this.grid.set(t)}generateRandomPath(){let e=[{x:0,y:0}],t={x:0,y:0},i={x:9,y:9};for(;t.x!==i.x||t.y!==i.y;){let r=[];t.x<i.x&&r.push({x:t.x+1,y:t.y}),t.y<i.y&&r.push({x:t.x,y:t.y+1});let o;if(r.length>1){let s=e.length>1?e[e.length-2]:null,a=s?t.x-s.x:1,l=s?t.y-s.y:0,c=r.find(d=>d.x-t.x===a&&d.y-t.y===l);c&&Math.random()<.8?o=c:o=r[Math.floor(Math.random()*r.length)]}else o=r[0];e.push(o),t=o}return e}startWave(){if(this.isWaveInProgress()||this.gameOver())return;this.wave.update(t=>t+1),this.isWaveInProgress.set(!0);let e=5+this.wave()*2;this.enemiesToSpawn=e,this.currentWaveEnemyCount=e,this.spawnTimer=0,this.startGameLoop()}startGameLoop(){this.stopGameLoop(),this.lastUpdateTime=performance.now(),this.ngZone.runOutsideAngular(()=>{let e=t=>{if(this.gameOver())return;let i=(t-this.lastUpdateTime)/1e3;this.lastUpdateTime=t;let r=Math.min(i,.05);this.updateGame(r),this.enemies.set([...this.enemiesInternal]),this.gameSpeedMultiplier()===1?this.projectiles.set([...this.projectilesInternal]):this.projectiles.set([]),this.uiTick$.next(),this.animationFrameId=requestAnimationFrame(e)};this.animationFrameId=requestAnimationFrame(e)})}stopGameLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateGame(e){let t=e*this.gameSpeedMultiplier();if(this.handleSpawning(t),this.updateEnemies(t),this.updateTowers(t),this.updateProjectiles(t),this.lives()<=0&&!this.gameOver()){this.enemiesInternal=[],this.projectilesInternal=[],this.enemiesToSpawn=0,this.stopGameLoop(),this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!0)}),this.savedResult||(this.savedResult=!0,this.saveResultIfLoggedIn());return}this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&this.isWaveInProgress()&&(this.enemiesInternal=[],this.projectilesInternal=[],this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1)}))}handleSpawning(e){this.enemiesToSpawn<=0||(this.spawnTimer+=e*1e3,this.spawnTimer>=this.spawnInterval&&(this.spawnTimer=0,this.spawnEnemy(),this.enemiesToSpawn--))}spawnEnemy(){let e=50*Math.pow(1.2,this.wave()),t=.5+this.wave()*.05,i=this.currentWaveEnemyCount||5+this.wave()*2,r=i-this.enemiesToSpawn,o=this.wave()%5===0,s=r===i-1,a=o&&s,l=this.wave()*40%360,c=a?e*3:e,d=a?t*.5:t,h={id:"e"+this.enemyIdCounter++,position:F({},this.path()[0]),pathIndex:0,hp:c,maxHp:c,speed:d,progress:0,isBoss:a,hue:l,baseSpeed:t,speedModifier:1,shatterStacks:0,isFrozen:!1};this.enemiesInternal.push(h)}updateEnemies(e){for(let t=this.enemiesInternal.length-1;t>=0;t--){let i=this.enemiesInternal[t];i.speedModifier=1,i.isFrozen=!1}this.applyFrostAuras();for(let t=this.enemiesInternal.length-1;t>=0;t--){let i=this.enemiesInternal[t],r=i.baseSpeed*i.speedModifier;if(i.progress+=r*e,i.progress>=1){if(i.pathIndex++,i.progress=0,i.pathIndex>=this.path().length-1){this.enemiesInternal.splice(t,1),this.ngZone.run(()=>this.lives.update(p=>Math.max(0,p-1)));continue}i.position=F({},this.path()[i.pathIndex])}let o=this.path(),s=o[i.pathIndex],a=o[i.pathIndex+1]||s,l=s.x+(a.x-s.x)*i.progress,c=s.y+(a.y-s.y)*i.progress;i.displayX=l*62+10,i.displayY=c*62+10;let d=i.shatterStacks??0,h=d>0?Math.min(70,50+d*4):50;i.scale=i.isBoss?1.5:1,i.bg=i.isFrozen?`hsl(190, 80%, ${h}%)`:`hsl(${i.hue}, 70%, ${h}%)`,i.hp<=0&&(this.enemiesInternal.splice(t,1),this.ngZone.run(()=>this.money.update(p=>p+5+this.wave())))}}updateTowers(e){if(!(this.enemiesInternal.length===0||this.towersInternal.length===0)){for(let t of this.towersInternal)if(t.cooldown-=e,t.cooldown<=0){let i=this.findNearestEnemy(t,this.enemiesInternal);i?(this.fireAt(t,i),t.cooldown=t.fireInterval):t.cooldown=0}}}applyFrostAuras(){if(this.enemiesInternal.length===0)return;let e=this.towersInternal.filter(i=>i.type===1&&i.specialActive);if(e.length===0)return;let t=4;for(let i of this.enemiesInternal){let r=!1;for(let o of e){let s=o.position.x-i.position.x,a=o.position.y-i.position.y;if(s*s+a*a<=t){r=!0;break}}r&&(i.speedModifier=.7,i.isFrozen=!0)}}findNearestEnemy(e,t){let i=null,r=e.range*e.range;for(let o of t)if(o.displayX&&o.displayY){let s=e.position.x-(o.displayX-10)/62,a=e.position.y-(o.displayY-10)/62,l=s*s+a*a;l<r&&(r=l,i=o)}return i}pushProjectile(e){this.projectilesInternal.length>=100&&this.projectilesInternal.shift(),this.projectilesInternal.push(e)}fireAt(e,t){let i={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},t.position),progress:0};this.pushProjectile(i);let r=e.damage;if(e.specialActive&&e.type===4&&t.hp/t.maxHp<.15)if(t.isBoss)r=e.damage*3;else{t.hp=0;return}if(e.specialActive&&e.type===3){let o=Math.min(5,t.shatterStacks+1);t.shatterStacks=o;let s=1+o*.1;r=Math.floor(r*s)}if(t.hp-=r,e.specialActive&&e.type===2&&Math.random()<.25){let o=[];for(let a of this.enemiesInternal){if(a.id===t.id)continue;let l=t.position.x-a.position.x,c=t.position.y-a.position.y;if(Math.sqrt(l*l+c*c)<=3&&(o.push(a),o.length>=2))break}let s=Math.floor(e.damage*.5);for(let a of o){let l={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},a.position),progress:0};this.pushProjectile(l),a.hp-=s}}}updateProjectiles(e){for(let t=this.projectilesInternal.length-1;t>=0;t--){let i=this.projectilesInternal[t];i.progress+=5*e,i.progress>=1&&this.projectilesInternal.splice(t,1)}}buyTower(e,t,i){let r=this.towerCosts[i-1];this.money()<r||this.grid.update(o=>{let s=o[t][e];if(s.type==="buildable"&&!s.tower){let a=this.tierStats[i-1];s.tower={id:crypto.randomUUID(),type:i,level:1,position:{x:e,y:t},baseCost:r,invested:r,damage:a.damage,range:a.range,fireInterval:a.fireInterval,cooldown:0,specialActive:!1},this.towersInternal.push(s.tower),this.money.update(l=>l-r)}return[...o]})}upgradeTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level<4){let o=this.getUpgradeCost(r.tower);this.money()>=o&&(r.tower.level++,r.tower.damage=Math.floor(r.tower.damage*1.3),r.tower.range+=.5,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i]})}getUpgradeCost(e){let t=.5;switch(e.level){case 1:t=.5;break;case 2:t=.6;break;case 3:t=.7;break}return Math.floor(e.baseCost*t)}getSpecialCost(e){return e.baseCost*4}buyAbility(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level===4&&!r.tower.specialActive){let o=this.getSpecialCost(r.tower);this.money()>=o&&(r.tower.specialActive=!0,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i.map(o=>[...o])]})}sellTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower){let o=r.tower.invested??r.tower.baseCost,s=Math.floor(o*.5),a=r.tower.id;r.tower=null,this.money.update(c=>c+s);let l=this.towersInternal.findIndex(c=>c.id===a);l!==-1&&this.towersInternal.splice(l,1)}return[...i]})}getEnemiesRef(){return this.enemiesInternal}getProjectilesRef(){return this.projectilesInternal}getTowersRef(){return this.towersInternal}getPathRef(){return this.path()}getGridRef(){return this.grid()}static \u0275fac=function(t){return new(t||n)(De(mn),De(jn))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var Rq=["gameCanvas"];function Pq(n,e){if(n&1){let t=Je();wl(0),_(1,"button",47),ne("click",function(){re(t);let r=Dr(0),o=O(3);return oe(o.buyTower(r))}),_(2,"div",48)(3,"span",49),v(4),b(),_(5,"span"),v(6),b()(),_(7,"span",50),v(8),b()()}if(n&2){let t=e.$implicit,i=e.$index,r=O(3),o=Ou(i+1);y(),Ne("bg-slate-700",r.tdEngine.money()>=t)("hover:bg-slate-600",r.tdEngine.money()>=t)("bg-slate-900",r.tdEngine.money()<t),Oe("disabled",r.tdEngine.money()<t),y(3),G("T",o),y(2),tn("",r.settings.t("TIER")," ",o),y(2),G("$",t)}}function Nq(n,e){if(n&1&&(_(0,"h3",44),v(1),b(),_(2,"div",45),wn(3,Pq,9,12,"button",46,Pu),b()),n&2){let t=O(2);y(),G(" ",t.settings.t("BUY_DEFENDER")," "),y(2),xn(t.tdEngine.towerCosts)}}function kq(n,e){if(n&1){let t=Je();_(0,"button",64),ne("click",function(){re(t);let r=O(3);return oe(r.upgradeTower())}),_(1,"span"),v(2),b(),_(3,"span",65),v(4),b()()}if(n&2){let t=O(2),i=O();Oe("disabled",i.tdEngine.money()<i.tdEngine.getUpgradeCost(t.tower)),y(2),q(i.settings.t("UPGRADE")),y(2),G("$",i.tdEngine.getUpgradeCost(t.tower))}}function Oq(n,e){if(n&1&&(_(0,"div",61),v(1),b()),n&2){let t=O(3);y(),G(" ",t.settings.t("MAX_LEVEL")," ")}}function Fq(n,e){if(n&1&&(_(0,"span",65),v(1),b()),n&2){let t=O(3),i=O();y(),G(" $",i.tdEngine.getSpecialCost(t.tower)," ")}}function Lq(n,e){if(n&1){let t=Je();_(0,"button",66),ne("click",function(){re(t);let r=O(3);return oe(r.buyAbility())}),_(1,"span"),v(2),b(),Yn(3,Fq,2,1,"span",67),b()}if(n&2){let t=O(2),i=O();Ne("bg-purple-600",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("hover:bg-purple-500",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("bg-slate-700",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),Oe("disabled",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),y(2),G(" ",t.tower.specialActive?"Ability Active":"Buy Ability"," "),y(),Oe("ngIf",!t.tower.specialActive)}}function Vq(n,e){if(n&1){let t=Je();_(0,"h3",51),v(1),b(),_(2,"div",52)(3,"div",53)(4,"span",54),v(5),b(),_(6,"span",55),v(7),b()(),_(8,"div",53)(9,"span",54),v(10),b(),_(11,"span",55),v(12),b()(),_(13,"div",53)(14,"span",54),v(15),b(),_(16,"span",56),v(17),b()(),_(18,"div",57)(19,"span",54),v(20),b(),_(21,"span",58),v(22),b()()(),_(23,"div",59),Q(24,kq,5,3,"button",60)(25,Oq,2,1,"div",61),_(26,"button",62),ne("click",function(){re(t);let r=O(2);return oe(r.sellTower())}),v(27),b(),Q(28,Lq,4,9,"button",63),b()}if(n&2){let t=O(),i=O();y(),G(" ",i.settings.t("DEFENDER_INFO")," "),y(4),q(i.settings.t("TIER")),y(2),q(t.tower.type),y(3),q(i.settings.t("LEVEL")),y(2),G("",t.tower.level," / 4"),y(3),q(i.settings.t("DAMAGE")),y(2),q(t.tower.damage),y(3),q(i.settings.t("RANGE")),y(2),q(t.tower.range),y(2),J(t.tower.level<4?24:25),y(3),G(" ",i.settings.t("SELL")," (50% REFUND) "),y(),J(t.tower.level===4?28:-1)}}function Uq(n,e){n&1&&Q(0,Nq,5,1)(1,Vq,29,12),n&2&&J(e.tower?1:0)}function Bq(n,e){if(n&1&&(_(0,"div",42),X(),_(1,"svg",68),W(2,"path",69),b(),Re(),_(3,"p",70),v(4),W(5,"br"),v(6),b()()),n&2){let t=O();y(4),G(" ",t.settings.t("SELECT_BUILD_TILE")," "),y(2),G(" ",t.settings.t("TO_PLACE_DEFENDER")," ")}}function jq(n,e){if(n&1){let t=Je();_(0,"div",43)(1,"div",71)(2,"h2",72),v(3),b(),_(4,"p",73),v(5),b(),_(6,"button",74),ne("click",function(){re(t);let r=O();return oe(r.onRestart())}),v(7),b()()()}if(n&2){let t=O();y(3),q(t.settings.t("GAME_OVER")),y(2),Xo(" ",t.settings.t("YOU_SURVIVED")," ",t.tdEngine.wave()," ",t.settings.t("WAVES")," "),y(2),G(" ",t.settings.t("TRY_AGAIN")," ")}}var T0=class n{constructor(e,t,i,r,o){this.tdEngine=e;this.settings=t;this.firebase=i;this.router=r;this.cdr=o}selectedTile=$(null);uiSub;gameCanvas;ctx;rafId=null;isBrowser=typeof window<"u"&&typeof document<"u";onKeyDown(e){if(this.tdEngine.isWaveInProgress())return;if(e.key==="Enter"){e.preventDefault(),this.tdEngine.startWave();return}}onKeyUp(e){}ngOnInit(){this.tdEngine.resetEngine(),this.uiSub=this.tdEngine.uiTick$.subscribe(()=>{this.cdr.detectChanges()})}ngAfterViewInit(){this.isBrowser&&(this.initCanvas(),this.startCanvasLoop(),window.addEventListener("resize",this.resizeCanvas))}ngOnDestroy(){this.uiSub?.unsubscribe(),this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.isBrowser&&window.removeEventListener("resize",this.resizeCanvas),this.tdEngine.resetEngine()}goBack(){this.tdEngine.resetEngine(),this.router.navigate(["/"])}onRestart(){this.tdEngine.resetGame(),this.selectedTile.set(null)}onTileClick(e){e.type==="buildable"||e.tower?this.selectedTile.set(e):this.selectedTile.set(null)}buyTower(e){let t=this.selectedTile();t&&(this.tdEngine.buyTower(t.x,t.y,e),this.selectedTile.set(null))}upgradeTower(){let e=this.selectedTile();e&&e.tower&&this.tdEngine.upgradeTower(e.x,e.y)}asUnit(e){return ue(F({},e),{owner:"player",points:0,turnsStationary:0,tier:e.type})}getEnemyStyle(e){let t=this.tdEngine.path(),i=t[e.pathIndex],r=t[e.pathIndex+1]||i,o=i.x+(r.x-i.x)*e.progress,s=i.y+(r.y-i.y)*e.progress,a=e.hue??this.tdEngine.wave()*40%360,l=e.isBoss?1.5:1,c=e.shatterStacks??0,d=c>0?Math.min(70,50+c*4):50,h=e.isFrozen?`hsl(190, 80%, ${d}%)`:`hsl(${a}, 70%, ${d}%)`;return{left:`${o*62+10}px`,top:`${s*62+10}px`,transform:`scale(${l})`,background:h}}getProjectileStyle(e){let t=e.from.x+(e.to.x-e.from.x)*e.progress,i=e.from.y+(e.to.y-e.from.y)*e.progress;return{left:`${t*62+28}px`,top:`${i*62+28}px`}}getRangeStyle(){let e=this.selectedTile();if(!e||!e.tower)return{display:"none"};let t=e.tower,i=t.range*2*62;return{left:`${t.position.x*62+30}px`,top:`${t.position.y*62+30}px`,width:`${i}px`,height:`${i}px`,display:"block"}}sellTower(){let e=this.selectedTile();e&&e.tower&&(this.tdEngine.sellTower(e.x,e.y),this.selectedTile.set(null))}buyAbility(){let e=this.selectedTile();e&&e.tower&&e.tower.level===4&&!e.tower.specialActive&&this.tdEngine.buyAbility(e.x,e.y)}setSpeed(e){this.tdEngine.gameSpeedMultiplier.set(e)}onLoginClick(){if(!this.firebase.user$())try{this.firebase.loginWithGoogle()}catch{}}initCanvas=()=>{let e=this.gameCanvas?.nativeElement;e&&(this.ctx=e.getContext("2d"),this.resizeCanvas())};resizeCanvas=()=>{let e=this.gameCanvas?.nativeElement;if(!e)return;let t=this.tdEngine.tileSize,i=this.tdEngine.gridSize*t;e.style.width=`${i}px`,e.style.height=`${i}px`;let r=Math.max(1,window.devicePixelRatio||1);e.width=Math.floor(i*r),e.height=Math.floor(i*r);let o=e.getContext("2d");o&&(o.setTransform(r,0,0,r,0,0),this.ctx=o)};startCanvasLoop(){let e=()=>{this.drawFrame(),this.rafId=requestAnimationFrame(e)};this.rafId=requestAnimationFrame(e)}clearCanvas(e,t){e.clearRect(0,0,t,t)}drawFrame(){let e=this.gameCanvas?.nativeElement,t=this.ctx;if(!e||!t)return;let i=this.tdEngine.tileSize,r=this.tdEngine.gridSize*i;this.clearCanvas(t,r),this.drawGrid(t,i),this.drawFrostAuras(t,i),this.drawTowers(t,i),this.drawEnemies(t,i),this.tdEngine.gameSpeedMultiplier()===1&&this.drawProjectiles(t,i),this.drawRangeIndicator(t,i)}drawGrid(e,t){let i=this.tdEngine.getGridRef();for(let r=0;r<i.length;r++){let o=i[r];for(let s=0;s<o.length;s++){let a=o[s];a.type==="path"?e.fillStyle="#475569":a.type==="buildable"?e.fillStyle="#1e293b":e.fillStyle="rgba(255,255,255,0.06)",e.fillRect(s*t,r*t,t-2,t-2)}}}drawTowers(e,t){let i=this.tdEngine.getTowersRef();for(let r of i){let o=r.position.x*t,s=r.position.y*t;e.fillStyle="#0ea5e9",r.type===2&&(e.fillStyle="#a78bfa"),r.type===3&&(e.fillStyle="#f59e0b"),r.type===4&&(e.fillStyle="#ef4444");let a=6;e.fillRect(o+a,s+a,t-a*2,t-a*2)}}drawFrostAuras(e,t){let i=this.tdEngine.getTowersRef();for(let r of i)if(r.type===1&&r.specialActive){let o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=2*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.15)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56, 189, 248, 0.5)",e.stroke()}}drawEnemies(e,t){let i=this.tdEngine.getEnemiesRef();for(let r of i){let o=(r.isBoss?1.5:1)*(t*.65),s=o/2,a=(r.displayX??r.position.x*t+10)+s-t*.35,l=(r.displayY??r.position.y*t+10)+s-t*.35;e.beginPath(),e.arc(a,l,s,0,Math.PI*2),e.fillStyle=r.bg||(r.isFrozen?"#7dd3fc":"#ef4444"),e.shadowColor=this.tdEngine.gameSpeedMultiplier()>1?"transparent":e.fillStyle,e.shadowBlur=this.tdEngine.gameSpeedMultiplier()>1?0:10,e.fill(),e.shadowBlur=0;let c=o,d=6;e.fillStyle="#0f172a",e.fillRect(a-s,l-s-10,c,d),e.fillStyle="#10b981";let h=Math.max(0,Math.min(1,r.hp/r.maxHp));e.fillRect(a-s,l-s-10,c*h,d)}}drawProjectiles(e,t){let i=this.tdEngine.getProjectilesRef();e.fillStyle="#fbbf24";for(let r of i){let o=r.from.x+(r.to.x-r.from.x)*r.progress,s=r.from.y+(r.to.y-r.from.y)*r.progress;e.beginPath(),e.arc(o*t+t/2,s*t+t/2,3,0,Math.PI*2),e.fill()}}drawRangeIndicator(e,t){let i=this.selectedTile();if(!i||!i.tower)return;let r=i.tower,o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=r.range*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.12)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56, 189, 248, 0.4)",e.stroke()}onCanvasClick(e){let t=this.gameCanvas?.nativeElement;if(!t)return;let i=t.getBoundingClientRect(),r=e.clientX-i.left,o=e.clientY-i.top,s=this.tdEngine.tileSize,a=Math.floor(r/s),l=Math.floor(o/s),c=this.tdEngine.getGridRef();l>=0&&l<c.length&&a>=0&&a<c[0].length&&this.onTileClick(c[l][a])}static \u0275fac=function(t){return new(t||n)(ge(I0),ge(Mt),ge(jn),ge(_i),ge(ca))};static \u0275cmp=Ct({type:n,selectors:[["app-tower-defense"]],viewQuery:function(t,i){if(t&1&&_l(Rq,5),t&2){let r;El(r=bl())&&(i.gameCanvas=r.first)}},hostBindings:function(t,i){t&1&&ne("keydown",function(o){return i.onKeyDown(o)},oa)("keyup",function(o){return i.onKeyUp(o)},oa)},decls:61,vars:46,consts:[["gameCanvas",""],[1,"flex","flex-col","h-full","p-4","overflow-hidden"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],[1,"relative"],[1,"hud-overlay"],[1,"flex","items-center","justify-between","mb-4","bg-slate-800","p-3","rounded-lg","border","border-slate-700"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors",3,"click"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"flex","flex-col","items-center","gap-1","font-black","tracking-wide"],[1,"flex","items-baseline","gap-6"],[1,"text-emerald-400","text-lg","font-mono"],[1,"text-rose-400","text-lg","font-mono"],[1,"text-sky-400","text-lg","font-mono"],[1,"flex","items-center","gap-1","text-xs"],[1,"text-slate-400","mr-1"],[1,"px-2","py-0.5","rounded","border","text-[10px]","font-bold",3,"click"],[1,"px-3","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"bg-rose-600","hover:bg-rose-500","text-white","text-xs","font-bold","px-3","py-2","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-4","py-2","rounded","text-sm","font-black","transition-all",3,"click","disabled"],[1,"flex","gap-4","flex-1","min-h-0"],[1,"flex-1","relative","bg-slate-900","rounded-lg","overflow-hidden","border","border-slate-700","flex","items-center","justify-center","p-4"],[1,"block","rounded",3,"click"],[1,"w-64","flex","flex-col","gap-4"],[1,"flex-1","bg-slate-800","rounded-lg","border","border-slate-700","p-4","overflow-y-auto"],[1,"h-full","flex","flex-col","items-center","justify-center","text-center","text-slate-500"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-slate-950/70","backdrop-blur-sm","z-[200]"],[1,"text-sm","font-bold","text-slate-400","mb-4","uppercase","tracking-wider"],[1,"flex","flex-col","gap-3"],[1,"shop-btn","flex","justify-between","items-center",3,"disabled","bg-slate-700","hover:bg-slate-600","bg-slate-900"],[1,"shop-btn","flex","justify-between","items-center",3,"click","disabled"],[1,"flex","items-center","gap-2"],[1,"text-xs","bg-slate-600","px-1.5","rounded"],[1,"text-emerald-400","font-mono"],[1,"text-sm","font-bold","text-slate-400","mb-2","uppercase","tracking-wider"],[1,"bg-slate-900","rounded","p-3","mb-4"],[1,"flex","justify-between","mb-1"],[1,"text-xs","text-slate-500"],[1,"text-xs","font-bold"],[1,"text-xs","font-bold","text-rose-400"],[1,"flex","justify-between"],[1,"text-xs","font-bold","text-sky-400"],[1,"flex","flex-col","gap-2"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"disabled"],[1,"w-full","py-3","bg-slate-900","text-slate-500","rounded","text-center","font-bold","border","border-slate-700"],[1,"w-full","py-3","bg-rose-700","hover:bg-rose-600","rounded","font-bold","transition-all","flex","justify-center","items-center","text-sm",3,"click"],[1,"w-full","py-3","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"disabled","bg-purple-600","hover:bg-purple-500","bg-slate-700"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"font-mono"],[1,"w-full","py-3","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],["class","font-mono",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mb-2","opacity-20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"],[1,"text-sm"],[1,"bg-slate-900","border","border-slate-700","rounded-lg","px-8","py-6","text-center","shadow-xl"],[1,"text-2xl","font-black","text-rose-400","mb-2"],[1,"text-slate-300","mb-4"],[1,"bg-emerald-600","hover:bg-emerald-500","text-white","font-bold","px-6","py-2","rounded",3,"click"]],template:function(t,i){if(t&1){let r=Je();_(0,"div",1),X(),_(1,"svg",2)(2,"defs")(3,"radialGradient",3),W(4,"stop",4)(5,"stop",5)(6,"stop",6),b(),_(7,"radialGradient",7),W(8,"stop",8)(9,"stop",9)(10,"stop",10),b(),_(11,"radialGradient",11),W(12,"stop",12)(13,"stop",13)(14,"stop",14),b(),_(15,"linearGradient",15),W(16,"stop",16)(17,"stop",17),b(),_(18,"filter",18),W(19,"feDropShadow",19),b()()(),Re(),_(20,"div",20)(21,"div",21)(22,"div",22)(23,"div",23)(24,"button",24),ne("click",function(){return re(r),oe(i.goBack())}),v(25),b(),_(26,"button",25),ne("click",function(){return re(r),oe(i.router.navigate(["/tower-defense-leaderboard"]))}),v(27),b()(),_(28,"div",26)(29,"div",27)(30,"div",28),v(31),b(),_(32,"div",29),v(33),b(),_(34,"div",30),v(35),b()(),_(36,"div",31)(37,"span",32),v(38,"Speed:"),b(),_(39,"button",33),ne("click",function(){return re(r),oe(i.setSpeed(1))}),v(40," 1x "),b(),_(41,"button",33),ne("click",function(){return re(r),oe(i.setSpeed(2))}),v(42," 2x "),b(),_(43,"button",33),ne("click",function(){return re(r),oe(i.setSpeed(4))}),v(44," 4x "),b()()(),_(45,"div",23)(46,"button",34),ne("click",function(){return re(r),oe(i.onLoginClick())}),v(47),b(),_(48,"button",35),ne("click",function(){return re(r),oe(i.onRestart())}),v(49),b(),_(50,"button",36),ne("click",function(){return re(r),oe(i.tdEngine.startWave())}),v(51),b()()()()(),_(52,"div",37)(53,"div",38)(54,"canvas",39,0),ne("click",function(s){return re(r),oe(i.onCanvasClick(s))}),b()(),_(56,"div",40)(57,"div",41),Q(58,Uq,2,1)(59,Bq,7,2,"div",42),b()()(),Q(60,jq,8,5,"div",43),b()}if(t&2){let r,o;y(25),G(" ",i.settings.t("EXIT_GAME")," "),y(2),G(" ",i.settings.t("RANKING")," "),y(4),tn("",i.settings.t("MONEY"),": $",i.tdEngine.money()),y(2),tn("",i.settings.t("LIVES"),": ",i.tdEngine.lives()),y(2),tn("",i.settings.t("WAVE"),": ",i.tdEngine.wave()),y(4),Ne("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===1)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===1)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==1)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==1),y(2),Ne("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===2)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===2)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==2)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==2),y(2),Ne("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===4)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===4)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==4)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==4),y(4),G(" ",i.firebase.user$()?((r=i.firebase.user$())==null?null:r.displayName)||"Account":"Login to Save Score"," "),y(2),G(" ",i.settings.t("RESTART_GAME")," "),y(),Ne("bg-sky-600",!i.tdEngine.isWaveInProgress())("hover:bg-sky-500",!i.tdEngine.isWaveInProgress())("bg-slate-700",i.tdEngine.isWaveInProgress())("text-slate-500",i.tdEngine.isWaveInProgress()),Oe("disabled",i.tdEngine.isWaveInProgress()),y(),G(" ",i.tdEngine.isWaveInProgress()?i.settings.t("WAVE_IN_PROGRESS"):i.settings.t("START_WAVE")," "),y(7),J((o=i.selectedTile())?58:59,o),y(2),J(i.tdEngine.gameOver()?60:-1)}},dependencies:[jt,ua],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"[_nghost-%COMP%]{display:block;height:100vh;background:#0f172a;color:#fff}.td-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,60px);grid-template-rows:repeat(10,60px);gap:2px;background:#1e293b;border:4px solid #334155;border-radius:8px;position:relative}.td-tile[_ngcontent-%COMP%]{position:relative;width:60px;height:60px;transition:all .2s;overflow:hidden}.tile-path[_ngcontent-%COMP%]{background:#475569}.tile-buildable[_ngcontent-%COMP%]{background:#1e293b;cursor:pointer}.tile-buildable[_ngcontent-%COMP%]:hover{background:#334155}.tile-void[_ngcontent-%COMP%]{opacity:.1}.range-indicator[_ngcontent-%COMP%]{position:absolute;background:#38bdf826;border:2px solid rgba(56,189,248,.5);border-radius:50%;pointer-events:none;z-index:50;transform:translate(-50%,-50%);transition:all .2s ease-out}.frost-aura-visual[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:248px;height:248px;transform:translate(-50%,-50%);border-radius:50%;background:#00ffff1a;border:1px solid rgba(0,255,255,.3);pointer-events:none;z-index:5;box-shadow:0 0 15px #0ff3}.enemy[_ngcontent-%COMP%]{position:absolute;width:40px;height:40px;background:#ef4444;border-radius:50%;z-index:10;box-shadow:0 0 10px #ef4444;display:flex;align-items:center;justify-content:center}.enemy-fast[_ngcontent-%COMP%]{box-shadow:none}.projectile[_ngcontent-%COMP%]{position:absolute;width:6px;height:6px;background:#fbbf24;border-radius:50%;z-index:20;box-shadow:0 0 5px #fbbf24}.shop-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.25rem;font-weight:700;transition:all .2s}.shop-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"],changeDetection:0})};function Hq(n,e){n&1&&(_(0,"div",8)(1,"span",9),W(2,"span",10),_(3,"span"),v(4,"Loading leaderboard..."),b()()())}function $q(n,e){if(n&1&&(_(0,"tr",15)(1,"td",16),v(2),b(),_(3,"td",17),v(4),b(),_(5,"td",18),v(6),b(),_(7,"td",19),v(8),Ar(9,"date"),Ar(10,"date"),b()()),n&2){let t=e.$implicit,i=e.index;y(2),q(i+1),y(2),G(" ",t.displayName||"Anonymous"," "),y(2),G(" ",t.maxWave," "),y(2),G(" ",t.timestamp!=null&&t.timestamp.toDate?oo(9,4,t.timestamp.toDate(),"mediumDate"):oo(10,7,t.timestamp,"mediumDate")," ")}}function Gq(n,e){n&1&&(_(0,"tr")(1,"td",20),v(2," No runs recorded yet. Finish a game while logged in to appear here. "),b()())}function zq(n,e){if(n&1&&(_(0,"div")(1,"table",11)(2,"thead")(3,"tr",12)(4,"th",13),v(5,"Rank"),b(),_(6,"th",13),v(7,"Name"),b(),_(8,"th",13),v(9,"Wave"),b(),_(10,"th",13),v(11,"Date"),b()()(),_(12,"tbody"),Yn(13,$q,11,10,"tr",14)(14,Gq,3,0,"tr",7),b()()()),n&2){let t=O();y(13),Oe("ngForOf",t.scores()),y(),Oe("ngIf",t.scores().length===0)}}var C0=class n{constructor(e,t){this.firebase=e;this.settings=t}loading=$(!0);scores=$([]);ngOnInit(){this.loadScores()}async loadScores(){this.loading.set(!0);try{let e=await this.firebase.getTopTowerDefenseScores(10);this.scores.set(e??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||n)(ge(jn),ge(Mt))};static \u0275cmp=Ct({type:n,selectors:[["app-tower-defense-leaderboard"]],decls:11,vars:3,consts:[[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center","py-10","px-4"],[1,"w-full","max-w-3xl","bg-slate-800","border","border-slate-700","rounded-lg","shadow-xl","p-6"],["routerLink","/tower-defense",1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors"],[1,"flex","items-center","justify-between","mb-4","mt-4"],[1,"text-2xl","font-black","tracking-wide"],[1,"mb-4","text-sm","text-slate-300"],["class","min-h-[80px] flex items-center justify-center",4,"ngIf"],[4,"ngIf"],[1,"min-h-[80px]","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-slate-300"],[1,"w-4","h-4","border-2","border-slate-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-slate-300"],[1,"text-left","py-2","px-2","border-b","border-slate-700"],["class","text-white",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-sky-300"],[1,"py-2","px-2","border-b","border-slate-800"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-emerald-400"],[1,"py-2","px-2","border-b","border-slate-800","text-slate-300"],["colspan","4",1,"py-8","text-center","text-slate-400","italic"]],template:function(t,i){t&1&&(_(0,"div",0)(1,"div",1)(2,"a",2),v(3),b(),_(4,"div",3)(5,"h1",4),v(6,"Tower Defense Leaderboard"),b()(),_(7,"div",5),v(8," Top 10 runs ranked by highest wave reached. "),b(),Yn(9,Hq,5,0,"div",6)(10,zq,15,2,"div",7),b()()),t&2&&(y(3),q(i.settings.t("RETURN_TO_MAP")),y(6),Oe("ngIf",i.loading()),y(),Oe("ngIf",!i.loading()))},dependencies:[jt,Il,ua,ss,da],encapsulation:2})};var CO=[{path:"",component:S0},{path:"shape-tactics",component:d0},{path:"tower-defense",component:T0},{path:"tower-defense-leaderboard",component:C0},{path:"feedback",component:w0},{path:"roadmap",component:x0}];var DO={providers:[Iv(),pb(CO),$M(HM())]};var D0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ct({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,i){t&1&&(_(0,"h1",0),v(1,"Turn-Based Strategy"),b(),W(2,"router-outlet"))},dependencies:[dd],encapsulation:2})};BE(D0,DO).catch(n=>console.error(n));
