var E2=Object.defineProperty,b2=Object.defineProperties;var w2=Object.getOwnPropertyDescriptors;var Xd=Object.getOwnPropertySymbols;var oS=Object.prototype.hasOwnProperty,sS=Object.prototype.propertyIsEnumerable;var iS=(n,e,t)=>e in n?E2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||={})oS.call(e,t)&&iS(n,t,e[t]);if(Xd)for(var t of Xd(e))sS.call(e,t)&&iS(n,t,e[t]);return n},le=(n,e)=>b2(n,w2(e));var Ia=(n,e)=>{var t={};for(var r in n)oS.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Xd)for(var r of Xd(n))e.indexOf(r)<0&&sS.call(n,r)&&(t[r]=n[r]);return t};var gn=null,eh=!1,Sy=1,I2=null,Nn=Symbol("SIGNAL");function Se(n){let e=gn;return gn=n,e}function nh(){return gn}var gl={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ml(n){if(eh)throw new Error("");if(gn===null)return;gn.consumerOnSignalRead(n);let e=gn.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=gn.recomputing;if(r&&(t=e!==void 0?e.nextProducer:gn.producers,t!==void 0&&t.producer===n)){gn.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===gn&&(!r||S2(i,gn)))return;let o=Ta(gn),s={producer:n,consumer:gn,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};gn.producersTail=s,e!==void 0?e.nextProducer=s:gn.producers=s,o&&uS(n,s)}function aS(){Sy++}function Cy(n){if(!(Ta(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Sy)){if(!n.producerMustRecompute(n)&&!ih(n)){Ty(n);return}n.producerRecomputeValue(n),Ty(n)}}function Dy(n){if(n.consumers===void 0)return;let e=eh;eh=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||T2(r)}}finally{eh=e}}function xy(){return gn?.consumerAllowSignalWrites!==!1}function T2(n){n.dirty=!0,Dy(n),n.consumerMarkedDirty?.(n)}function Ty(n){n.dirty=!1,n.lastCleanEpoch=Sy}function yl(n){return n&&cS(n),Se(n)}function cS(n){n.producersTail=void 0,n.recomputing=!0}function rh(n,e){Se(e),n&&lS(n)}function lS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Ta(n))do t=Ay(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function ih(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(Cy(t),r!==t.version))return!0}return!1}function vl(n){if(Ta(n)){let e=n.producers;for(;e!==void 0;)e=Ay(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function uS(n,e){let t=n.consumersTail,r=Ta(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)uS(i.producer,i)}function Ay(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!Ta(e)){let o=e.producers;for(;o!==void 0;)o=Ay(o)}return t}function Ta(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function My(n){I2?.(n)}function S2(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function Ry(n,e){return Object.is(n,e)}function oh(n,e){let t=Object.create(C2);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(Cy(t),ml(t),t.value===th)throw t.error;return t.value};return r[Nn]=t,My(t),r}var wy=Symbol("UNSET"),Iy=Symbol("COMPUTING"),th=Symbol("ERRORED"),C2=le(F({},gl),{value:wy,dirty:!0,error:null,equal:Ry,kind:"computed",producerMustRecompute(n){return n.value===wy||n.value===Iy},producerRecomputeValue(n){if(n.value===Iy)throw new Error("");let e=n.value;n.value=Iy;let t=yl(n),r,i=!1;try{r=n.computation(),Se(null),i=e!==wy&&e!==th&&r!==th&&n.equal(e,r)}catch(o){r=th,n.error=o}finally{rh(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function D2(){throw new Error}var dS=D2;function hS(n){dS(n)}function Ny(n){dS=n}var x2=null;function Py(n,e){let t=Object.create(sh);t.value=n,e!==void 0&&(t.equal=e);let r=()=>fS(t);return r[Nn]=t,My(t),[r,s=>_l(t,s),s=>pS(t,s)]}function fS(n){return ml(n),n.value}function _l(n,e){xy()||hS(n),n.equal(n.value,e)||(n.value=e,A2(n))}function pS(n,e){xy()||hS(n),_l(n,e(n.value))}var sh=le(F({},gl),{equal:Ry,value:void 0,kind:"signal"});function A2(n){n.version++,aS(),Dy(n),x2?.(n)}function ky(n){let e=Se(null);try{return n()}finally{Se(e)}}function Pe(n){return typeof n=="function"}function Sa(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ah=Sa(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function El(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var an=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Pe(r))try{r()}catch(o){e=o instanceof ah?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{gS(o)}catch(s){e=e??[],s instanceof ah?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ah(e)}}add(e){var t;if(e&&e!==this)if(this.closed)gS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&El(t,e)}remove(e){let{_finalizers:t}=this;t&&El(t,e),e instanceof n&&e._removeParent(this)}};an.EMPTY=(()=>{let n=new an;return n.closed=!0,n})();var Oy=an.EMPTY;function ch(n){return n instanceof an||n&&"closed"in n&&Pe(n.remove)&&Pe(n.add)&&Pe(n.unsubscribe)}function gS(n){Pe(n)?n():n.unsubscribe()}var Er={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ca={setTimeout(n,e,...t){let{delegate:r}=Ca;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Ca;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function lh(n){Ca.setTimeout(()=>{let{onUnhandledError:e}=Er;if(e)e(n);else throw n})}function bl(){}var mS=Fy("C",void 0,void 0);function yS(n){return Fy("E",void 0,n)}function vS(n){return Fy("N",n,void 0)}function Fy(n,e,t){return{kind:n,value:e,error:t}}var ps=null;function Da(n){if(Er.useDeprecatedSynchronousErrorHandling){let e=!ps;if(e&&(ps={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=ps;if(ps=null,t)throw r}}else n()}function _S(n){Er.useDeprecatedSynchronousErrorHandling&&ps&&(ps.errorThrown=!0,ps.error=n)}var gs=class extends an{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ch(e)&&e.add(this)):this.destination=N2}static create(e,t,r){return new xa(e,t,r)}next(e){this.isStopped?Vy(vS(e),this):this._next(e)}error(e){this.isStopped?Vy(yS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Vy(mS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},M2=Function.prototype.bind;function Ly(n,e){return M2.call(n,e)}var Uy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){uh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){uh(r)}else uh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){uh(t)}}},xa=class extends gs{constructor(e,t,r){super();let i;if(Pe(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Er.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Ly(e.next,o),error:e.error&&Ly(e.error,o),complete:e.complete&&Ly(e.complete,o)}):i=e}this.destination=new Uy(i)}};function uh(n){Er.useDeprecatedSynchronousErrorHandling?_S(n):lh(n)}function R2(n){throw n}function Vy(n,e){let{onStoppedNotification:t}=Er;t&&Ca.setTimeout(()=>t(n,e))}var N2={closed:!0,next:bl,error:R2,complete:bl};var Aa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function br(n){return n}function By(...n){return jy(n)}function jy(n){return n.length===0?br:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Ke=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=k2(t)?t:new xa(t,r,i);return Da(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=ES(r),new r((i,o)=>{let s=new xa({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Aa](){return this}pipe(...t){return jy(t)(this)}toPromise(t){return t=ES(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function ES(n){var e;return(e=n??Er.Promise)!==null&&e!==void 0?e:Promise}function P2(n){return n&&Pe(n.next)&&Pe(n.error)&&Pe(n.complete)}function k2(n){return n&&n instanceof gs||P2(n)&&ch(n)}function O2(n){return Pe(n?.lift)}function et(n){return e=>{if(O2(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function tt(n,e,t,r,i){return new Hy(n,e,t,r,i)}var Hy=class extends gs{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var bS=Sa(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Vt=(()=>{class n extends Ke{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new dh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new bS}next(t){Da(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Da(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Da(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Oy:(this.currentObservers=null,o.push(t),new an(()=>{this.currentObservers=null,El(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new Ke;return t.source=this,t}}return n.create=(e,t)=>new dh(e,t),n})(),dh=class extends Vt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Oy}};var cn=class extends Vt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var ln=new Ke(n=>n.complete());function wS(n){return n&&Pe(n.schedule)}function IS(n){return n[n.length-1]}function hh(n){return Pe(IS(n))?n.pop():void 0}function Io(n){return wS(IS(n))?n.pop():void 0}function SS(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{u(r.next(d))}catch(f){s(f)}}function c(d){try{u(r.throw(d))}catch(f){s(f)}}function u(d){d.done?o(d.value):i(d.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function TS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ms(n){return this instanceof ms?(this.v=n,this):new ms(n)}function CS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(m){return function(S){return Promise.resolve(S).then(m,f)}}function a(m,S){r[m]&&(i[m]=function(M){return new Promise(function(O,P){o.push([m,M,O,P])>1||c(m,M)})},S&&(i[m]=S(i[m])))}function c(m,S){try{u(r[m](S))}catch(M){g(o[0][3],M)}}function u(m){m.value instanceof ms?Promise.resolve(m.value.v).then(d,f):g(o[0][2],m)}function d(m){c("next",m)}function f(m){c("throw",m)}function g(m,S){m(S),o.shift(),o.length&&c(o[0][0],o[0][1])}}function DS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof TS=="function"?TS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(u){o({value:u,done:a})},s)}}var fh=n=>n&&typeof n.length=="number"&&typeof n!="function";function ph(n){return Pe(n?.then)}function gh(n){return Pe(n[Aa])}function mh(n){return Symbol.asyncIterator&&Pe(n?.[Symbol.asyncIterator])}function yh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function F2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var vh=F2();function _h(n){return Pe(n?.[vh])}function Eh(n){return CS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield ms(t.read());if(i)return yield ms(void 0);yield yield ms(r)}}finally{t.releaseLock()}})}function bh(n){return Pe(n?.getReader)}function Ut(n){if(n instanceof Ke)return n;if(n!=null){if(gh(n))return L2(n);if(fh(n))return V2(n);if(ph(n))return U2(n);if(mh(n))return xS(n);if(_h(n))return B2(n);if(bh(n))return j2(n)}throw yh(n)}function L2(n){return new Ke(e=>{let t=n[Aa]();if(Pe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function V2(n){return new Ke(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function U2(n){return new Ke(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,lh)})}function B2(n){return new Ke(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function xS(n){return new Ke(e=>{H2(n,e).catch(t=>e.error(t))})}function j2(n){return xS(Eh(n))}function H2(n,e){var t,r,i,o;return SS(this,void 0,void 0,function*(){try{for(t=DS(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function Pn(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function wh(n,e=0){return et((t,r)=>{t.subscribe(tt(r,i=>Pn(r,n,()=>r.next(i),e),()=>Pn(r,n,()=>r.complete(),e),i=>Pn(r,n,()=>r.error(i),e)))})}function Ih(n,e=0){return et((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function AS(n,e){return Ut(n).pipe(Ih(e),wh(e))}function MS(n,e){return Ut(n).pipe(Ih(e),wh(e))}function RS(n,e){return new Ke(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function NS(n,e){return new Ke(t=>{let r;return Pn(t,e,()=>{r=n[vh](),Pn(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>Pe(r?.return)&&r.return()})}function Th(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ke(t=>{Pn(t,e,()=>{let r=n[Symbol.asyncIterator]();Pn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function PS(n,e){return Th(Eh(n),e)}function kS(n,e){if(n!=null){if(gh(n))return AS(n,e);if(fh(n))return RS(n,e);if(ph(n))return MS(n,e);if(mh(n))return Th(n,e);if(_h(n))return NS(n,e);if(bh(n))return PS(n,e)}throw yh(n)}function Bt(n,e){return e?kS(n,e):Ut(n)}function He(...n){let e=Io(n);return Bt(n,e)}function $y(n,e){let t=Pe(n)?n:()=>n,r=i=>i.error(t());return new Ke(e?i=>e.schedule(r,0,i):r)}function Sh(n){return!!n&&(n instanceof Ke||Pe(n.lift)&&Pe(n.subscribe))}var ys=Sa(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function wt(n,e){return et((t,r)=>{let i=0;t.subscribe(tt(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:$2}=Array;function G2(n,e){return $2(e)?n(...e):n(e)}function Ch(n){return wt(e=>G2(n,e))}var{isArray:z2}=Array,{getPrototypeOf:q2,prototype:W2,keys:K2}=Object;function Dh(n){if(n.length===1){let e=n[0];if(z2(e))return{args:e,keys:null};if(Q2(e)){let t=K2(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function Q2(n){return n&&typeof n=="object"&&q2(n)===W2}function xh(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Gy(...n){let e=Io(n),t=hh(n),{args:r,keys:i}=Dh(n);if(r.length===0)return Bt([],e);let o=new Ke(Y2(r,e,i?s=>xh(i,s):br));return t?o.pipe(Ch(t)):o}function Y2(n,e,t=br){return r=>{OS(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)OS(e,()=>{let u=Bt(n[c],e),d=!1;u.subscribe(tt(r,f=>{o[c]=f,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function OS(n,e,t){n?Pn(t,n,e):e()}function FS(n,e,t,r,i,o,s,a){let c=[],u=0,d=0,f=!1,g=()=>{f&&!c.length&&!u&&e.complete()},m=M=>u<r?S(M):c.push(M),S=M=>{o&&e.next(M),u++;let O=!1;Ut(t(M,d++)).subscribe(tt(e,P=>{i?.(P),o?m(P):e.next(P)},()=>{O=!0},void 0,()=>{if(O)try{for(u--;c.length&&u<r;){let P=c.shift();s?Pn(e,s,()=>S(P)):S(P)}g()}catch(P){e.error(P)}}))};return n.subscribe(tt(e,m,()=>{f=!0,g()})),()=>{a?.()}}function Sn(n,e,t=1/0){return Pe(e)?Sn((r,i)=>wt((o,s)=>e(r,o,i,s))(Ut(n(r,i))),t):(typeof e=="number"&&(t=e),et((r,i)=>FS(r,i,n,t)))}function LS(n=1/0){return Sn(br,n)}function VS(){return LS(1)}function Ma(...n){return VS()(Bt(n,Io(n)))}function wl(n){return new Ke(e=>{Ut(n()).subscribe(e)})}function zy(...n){let e=hh(n),{args:t,keys:r}=Dh(n),i=new Ke(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,u=s;for(let d=0;d<s;d++){let f=!1;Ut(t[d]).subscribe(tt(o,g=>{f||(f=!0,u--),a[d]=g},()=>c--,void 0,()=>{(!c||!f)&&(u||o.next(r?xh(r,a):a),o.complete())}))}});return e?i.pipe(Ch(e)):i}function xi(n,e){return et((t,r)=>{let i=0;t.subscribe(tt(r,o=>n.call(e,o,i++)&&r.next(o)))})}function Il(n){return et((e,t)=>{let r=null,i=!1,o;r=e.subscribe(tt(t,void 0,void 0,s=>{o=Ut(n(s,Il(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function Ah(n,e){return Pe(e)?Sn(n,e,1):Sn(n,1)}function US(n){return et((e,t)=>{let r=!1;e.subscribe(tt(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Ai(n){return n<=0?()=>ln:et((e,t)=>{let r=0;e.subscribe(tt(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function BS(n=J2){return et((e,t)=>{let r=!1;e.subscribe(tt(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function J2(){return new ys}function qy(n){return et((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Mi(n,e){let t=arguments.length>=2;return r=>r.pipe(n?xi((i,o)=>n(i,o,r)):br,Ai(1),t?US(e):BS(()=>new ys))}function Mh(n){return n<=0?()=>ln:et((e,t)=>{let r=[];e.subscribe(tt(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Wy(...n){let e=Io(n);return et((t,r)=>{(e?Ma(n,t,e):Ma(n,t)).subscribe(r)})}function Ri(n,e){return et((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(tt(r,c=>{i?.unsubscribe();let u=0,d=o++;Ut(n(c,d)).subscribe(i=tt(r,f=>r.next(e?e(c,f,d,u++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Tl(n){return et((e,t)=>{Ut(n).subscribe(tt(t,()=>t.complete(),bl)),!t.closed&&e.subscribe(t)})}function $r(n,e,t){let r=Pe(n)||e||t?{next:n,error:e,complete:t}:n;return r?et((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(tt(o,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),o.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):br}var Ky;function Rh(){return Ky}function Gr(n){let e=Ky;return Ky=n,e}var jS=Symbol("NotFound");function Ra(n){return n===jS||n?.name==="\u0275NotFound"}var Fh="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ee=class extends Error{code;constructor(e,t){super(ki(e,t)),this.code=e}};function eF(n){return`NG0${Math.abs(n)}`}function ki(n,e){return`${eF(n)}${e?": "+e:""}`}var qr=globalThis;function nt(n){for(let e in n)if(n[e]===nt)return e;throw Error("")}function qS(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Pi(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Pi).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Lh(n,e){return n?e?`${n} ${e}`:n:e||""}var tF=nt({__forward_ref__:nt});function Do(n){return n.__forward_ref__=Do,n.toString=function(){return Pi(this())},n}function un(n){return l0(n)?n():n}function l0(n){return typeof n=="function"&&n.hasOwnProperty(tF)&&n.__forward_ref__===Do}function te(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Wr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ml(n){return nF(n,Vh)}function u0(n){return Ml(n)!==null}function nF(n,e){return n.hasOwnProperty(e)&&n[e]||null}function rF(n){let e=n?.[Vh]??null;return e||null}function Yy(n){return n&&n.hasOwnProperty(Ph)?n[Ph]:null}var Vh=nt({\u0275prov:nt}),Ph=nt({\u0275inj:nt}),ne=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=te({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function d0(n){return n&&!!n.\u0275providers}var h0=nt({\u0275cmp:nt}),f0=nt({\u0275dir:nt}),p0=nt({\u0275pipe:nt}),g0=nt({\u0275mod:nt}),Cl=nt({\u0275fac:nt}),ws=nt({__NG_ELEMENT_ID__:nt}),HS=nt({__NG_ENV_ID__:nt});function m0(n){return Bh(n,"@NgModule"),n[g0]||null}function Oi(n){return Bh(n,"@Component"),n[h0]||null}function Uh(n){return Bh(n,"@Directive"),n[f0]||null}function y0(n){return Bh(n,"@Pipe"),n[p0]||null}function Bh(n,e){if(n==null)throw new ee(-919,!1)}function wr(n){return typeof n=="string"?n:n==null?"":String(n)}function WS(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():wr(n)}var KS=nt({ngErrorCode:nt}),iF=nt({ngErrorMessage:nt}),oF=nt({ngTokenPath:nt});function v0(n,e){return QS("",-200,e)}function jh(n,e){throw new ee(-201,!1)}function QS(n,e,t){let r=new ee(e,n);return r[KS]=e,r[iF]=n,t&&(r[oF]=t),r}function sF(n){return n[KS]}var Jy;function YS(){return Jy}function Cn(n){let e=Jy;return Jy=n,e}function _0(n,e,t){let r=Ml(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;jh(n,"")}var aF={},vs=aF,cF="__NG_DI_FLAG__",Zy=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=_s(t)||0;try{return this.injector.get(e,r&8?null:vs,r)}catch(i){if(Ra(i))return i;throw i}}};function lF(n,e=0){let t=Rh();if(t===void 0)throw new ee(-203,!1);if(t===null)return _0(n,void 0,e);{let r=uF(e),i=t.retrieve(n,r);if(Ra(i)){if(r.optional)return null;throw i}return i}}function ve(n,e=0){return(YS()||lF)(un(n),e)}function j(n,e){return ve(n,_s(e))}function _s(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function uF(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Xy(n){let e=[];for(let t=0;t<n.length;t++){let r=un(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ee(900,!1);let i,o=0;for(let s=0;s<r.length;s++){let a=r[s],c=dF(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(ve(i,o))}else e.push(ve(r))}return e}function dF(n){return n[cF]}function To(n,e){let t=n.hasOwnProperty(Cl);return t?n[Cl]:null}function JS(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],o=e[r];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}function ZS(n){return n.flat(Number.POSITIVE_INFINITY)}function Hh(n,e){n.forEach(t=>Array.isArray(t)?Hh(t,e):e(t))}function E0(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Rl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function XS(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function $h(n,e,t){let r=Pa(n,e);return r>=0?n[r|1]=t:(r=~r,XS(n,r,e,t)),r}function Gh(n,e){let t=Pa(n,e);if(t>=0)return n[t|1]}function Pa(n,e){return hF(n,e,1)}function hF(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var xo={},Dn=[],Kr=new ne(""),b0=new ne("",-1),w0=new ne(""),Dl=class{get(e,t=vs){if(t===vs){let i=QS("",-201);throw i.name="\u0275NotFound",i}return t}};function Qr(n){return{\u0275providers:n}}function eC(n){return Qr([{provide:Kr,multi:!0,useValue:n}])}function tC(...n){return{\u0275providers:zh(!0,n),\u0275fromNgModule:!0}}function zh(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Hh(e,s=>{let a=s;kh(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&nC(i,o),t}function nC(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];I0(i,o=>{e(o,r)})}}function kh(n,e,t,r){if(n=un(n),!n)return!1;let i=null,o=Yy(n),s=!o&&Oi(n);if(!o&&!s){let c=n.ngModule;if(o=Yy(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let u of c)kh(u,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let u;Hh(o.imports,d=>{kh(d,e,t,r)&&(u||=[],u.push(d))}),u!==void 0&&nC(u,e)}if(!a){let u=To(i)||(()=>new i);e({provide:i,useFactory:u,deps:Dn},i),e({provide:w0,useValue:i,multi:!0},i),e({provide:Kr,useValue:()=>ve(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let u=n;I0(c,d=>{e(d,u)})}}else return!1;return i!==n&&n.providers!==void 0}function I0(n,e){for(let t of n)d0(t)&&(t=t.\u0275providers),Array.isArray(t)?I0(t,e):e(t)}var fF=nt({provide:String,useValue:nt});function rC(n){return n!==null&&typeof n=="object"&&fF in n}function pF(n){return!!(n&&n.useExisting)}function gF(n){return!!(n&&n.useFactory)}function Es(n){return typeof n=="function"}function iC(n){return!!n.useClass}var Nl=new ne(""),Nh={},$S={},Qy;function Pl(){return Qy===void 0&&(Qy=new Dl),Qy}var xt=class{},bs=class extends xt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,t0(e,s=>this.processProvider(s)),this.records.set(b0,Na(void 0,this)),i.has("environment")&&this.records.set(xt,Na(void 0,this));let o=this.records.get(Nl);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(w0,Dn,{self:!0}))}retrieve(e,t){let r=_s(t)||0;try{return this.get(e,vs,r)}catch(i){if(Ra(i))return i;throw i}}destroy(){Sl(this),this._destroyed=!0;let e=Se(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Se(e)}}onDestroy(e){return Sl(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Sl(this);let t=Gr(this),r=Cn(void 0),i;try{return e()}finally{Gr(t),Cn(r)}}get(e,t=vs,r){if(Sl(this),e.hasOwnProperty(HS))return e[HS](this);let i=_s(r),o,s=Gr(this),a=Cn(void 0);try{if(!(i&4)){let u=this.records.get(e);if(u===void 0){let d=EF(e)&&Ml(e);d&&this.injectableDefInScope(d)?u=Na(e0(e),Nh):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u,i)}let c=i&2?Pl():this.parent;return t=i&8&&t===vs?null:t,c.get(e,t)}catch(c){let u=sF(c);throw u===-200||u===-201?new ee(u,null):c}finally{Cn(a),Gr(s)}}resolveInjectorInitializers(){let e=Se(null),t=Gr(this),r=Cn(void 0),i;try{let o=this.get(Kr,Dn,{self:!0});for(let s of o)s()}finally{Gr(t),Cn(r),Se(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Pi(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=un(e);let t=Es(e)?e:un(e&&e.provide),r=yF(e);if(!Es(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Na(void 0,Nh,!0),i.factory=()=>Xy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=Se(null);try{if(t.value===$S)throw v0(Pi(e));return t.value===Nh&&(t.value=$S,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&_F(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Se(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=un(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function e0(n){let e=Ml(n),t=e!==null?e.factory:To(n);if(t!==null)return t;if(n instanceof ne)throw new ee(204,!1);if(n instanceof Function)return mF(n);throw new ee(204,!1)}function mF(n){if(n.length>0)throw new ee(204,!1);let t=rF(n);return t!==null?()=>t.factory(n):()=>new n}function yF(n){if(rC(n))return Na(void 0,n.useValue);{let e=T0(n);return Na(e,Nh)}}function T0(n,e,t){let r;if(Es(n)){let i=un(n);return To(i)||e0(i)}else if(rC(n))r=()=>un(n.useValue);else if(gF(n))r=()=>n.useFactory(...Xy(n.deps||[]));else if(pF(n))r=(i,o)=>ve(un(n.useExisting),o!==void 0&&o&8?8:void 0);else{let i=un(n&&(n.useClass||n.provide));if(vF(n))r=()=>new i(...Xy(n.deps));else return To(i)||e0(i)}return r}function Sl(n){if(n.destroyed)throw new ee(205,!1)}function Na(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function vF(n){return!!n.deps}function _F(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function EF(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function t0(n,e){for(let t of n)Array.isArray(t)?t0(t,e):t&&d0(t)?t0(t.\u0275providers,e):e(t)}function dn(n,e){let t;n instanceof bs?(Sl(n),t=n):t=new Zy(n);let r,i=Gr(t),o=Cn(void 0);try{return e()}finally{Gr(i),Cn(o)}}function oC(){return YS()!==void 0||Rh()!=null}var An=0,he=1,Ae=2,Rt=3,nr=4,rr=5,On=6,ka=7,Nt=8,$n=9,Yr=10,st=11,Oa=12,S0=13,Is=14,Mn=15,Ao=16,Ts=17,Jr=18,Fi=19,C0=20,Ni=21,qh=22,kl=23,Gn=24,Ss=25,Cs=26,Qe=27,sC=1,Ir=6,Zr=7,Ol=8,Ds=9,St=10;function zn(n){return Array.isArray(n)&&typeof n[sC]=="object"}function qn(n){return Array.isArray(n)&&n[sC]===!0}function D0(n){return(n.flags&4)!==0}function Li(n){return n.componentOffset>-1}function Fl(n){return(n.flags&1)===1}function Xr(n){return!!n.template}function xs(n){return(n[Ae]&512)!==0}function Mo(n){return(n[Ae]&256)===256}var x0="svg",aC="math";function Wn(n){for(;Array.isArray(n);)n=n[An];return n}function A0(n,e){return Wn(e[n])}function ir(n,e){return Wn(e[n.index])}function As(n,e){return n.data[e]}function Ll(n,e){return n[e]}function Vl(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function or(n,e){let t=e[n];return zn(t)?t:t[An]}function cC(n){return(n[Ae]&4)===4}function Wh(n){return(n[Ae]&128)===128}function lC(n){return qn(n[Rt])}function sr(n,e){return e==null?null:n[e]}function M0(n){n[Ts]=0}function R0(n){n[Ae]&1024||(n[Ae]|=1024,Wh(n)&&Fa(n))}function uC(n,e){for(;n>0;)e=e[Is],n--;return e}function Ul(n){return!!(n[Ae]&9216||n[Gn]?.dirty)}function Kh(n){n[Yr].changeDetectionScheduler?.notify(8),n[Ae]&64&&(n[Ae]|=1024),Ul(n)&&Fa(n)}function Fa(n){n[Yr].changeDetectionScheduler?.notify(0);let e=So(n);for(;e!==null&&!(e[Ae]&8192||(e[Ae]|=8192,!Wh(e)));)e=So(e)}function N0(n,e){if(Mo(n))throw new ee(911,!1);n[Ni]===null&&(n[Ni]=[]),n[Ni].push(e)}function dC(n,e){if(n[Ni]===null)return;let t=n[Ni].indexOf(e);t!==-1&&n[Ni].splice(t,1)}function So(n){let e=n[Rt];return qn(e)?e[Rt]:e}function P0(n){return n[ka]??=[]}function k0(n){return n.cleanup??=[]}function hC(n,e,t,r){let i=P0(e);i.push(t),n.firstCreatePass&&k0(n).push(r,i.length-1)}var ke={lFrame:TC(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var n0=!1;function fC(){return ke.lFrame.elementDepthCount}function pC(){ke.lFrame.elementDepthCount++}function O0(){ke.lFrame.elementDepthCount--}function F0(){return ke.bindingsEnabled}function L0(){return ke.skipHydrationRootTNode!==null}function V0(n){return ke.skipHydrationRootTNode===n}function gC(n){ke.skipHydrationRootTNode=n}function U0(){ke.skipHydrationRootTNode=null}function Ce(){return ke.lFrame.lView}function Pt(){return ke.lFrame.tView}function fe(n){return ke.lFrame.contextLView=n,n[Nt]}function pe(n){return ke.lFrame.contextLView=null,n}function mn(){let n=B0();for(;n!==null&&n.type===64;)n=n.parent;return n}function B0(){return ke.lFrame.currentTNode}function mC(){let n=ke.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ms(n,e){let t=ke.lFrame;t.currentTNode=n,t.isParent=e}function j0(){return ke.lFrame.isParent}function yC(){ke.lFrame.isParent=!1}function H0(){return ke.lFrame.contextLView}function $0(){return n0}function G0(n){let e=n0;return n0=n,e}function Bl(){let n=ke.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function z0(){return ke.lFrame.bindingIndex}function vC(n){return ke.lFrame.bindingIndex=n}function Rs(){return ke.lFrame.bindingIndex++}function jl(n){let e=ke.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function _C(){return ke.lFrame.inI18n}function EC(n,e){let t=ke.lFrame;t.bindingIndex=t.bindingRootIndex=n,Qh(e)}function bC(){return ke.lFrame.currentDirectiveIndex}function Qh(n){ke.lFrame.currentDirectiveIndex=n}function wC(n){let e=ke.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function q0(){return ke.lFrame.currentQueryIndex}function Yh(n){ke.lFrame.currentQueryIndex=n}function bF(n){let e=n[he];return e.type===2?e.declTNode:e.type===1?n[rr]:null}function W0(n,e,t){if(t&4){let i=e,o=n;for(;i=i.parent,i===null&&!(t&1);)if(i=bF(o),i===null||(o=o[Is],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=ke.lFrame=IC();return r.currentTNode=e,r.lView=n,!0}function Jh(n){let e=IC(),t=n[he];ke.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function IC(){let n=ke.lFrame,e=n===null?null:n.child;return e===null?TC(n):e}function TC(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function SC(){let n=ke.lFrame;return ke.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var K0=SC;function Zh(){let n=SC();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function CC(n){return(ke.lFrame.contextLView=uC(n,ke.lFrame.contextLView))[Nt]}function ar(){return ke.lFrame.selectedIndex}function Ro(n){ke.lFrame.selectedIndex=n}function Q0(){let n=ke.lFrame;return As(n.tView,n.selectedIndex)}function Fe(){ke.lFrame.currentNamespace=x0}function qe(){wF()}function wF(){ke.lFrame.currentNamespace=null}function Y0(){return ke.lFrame.currentNamespace}var DC=!0;function Xh(){return DC}function Vi(n){DC=n}function r0(n,e=null,t=null,r){let i=J0(n,e,t,r);return i.resolveInjectorInitializers(),i}function J0(n,e=null,t=null,r,i=new Set){let o=[t||Dn,tC(n)];return r=r||(typeof n=="object"?void 0:Pi(n)),new bs(o,e||Pl(),r||null,i)}var kn=class n{static THROW_IF_NOT_FOUND=vs;static NULL=new Dl;static create(e,t){if(Array.isArray(e))return r0({name:""},t,e,"");{let r=e.name??"";return r0({name:r},e.parent,e.providers,r)}}static \u0275prov=te({token:n,providedIn:"any",factory:()=>ve(b0)});static __NG_ELEMENT_ID__=-1},At=new ne(""),Tr=(()=>{class n{static __NG_ELEMENT_ID__=IF;static __NG_ENV_ID__=t=>t}return n})(),i0=class extends Tr{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Mo(this._lView)}onDestroy(e){let t=this._lView;return N0(t,e),()=>dC(t,e)}};function IF(){return new i0(Ce())}var xC=!1,AC=new ne(""),ei=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new cn(!1);debugTaskTracker=j(AC,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Ke(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}return n})(),o0=class extends Vt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,oC()&&(this.destroyRef=j(Tr,{optional:!0})??void 0,this.pendingTasks=j(ei,{optional:!0})??void 0)}emit(e){let t=Se(null);try{super.next(e)}finally{Se(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof an&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},jt=o0;function Oh(...n){}function Z0(n){let e,t;function r(){n=Oh;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function MC(n){return queueMicrotask(()=>n()),()=>{n=Oh}}var X0="isAngularZone",xl=X0+"_ID",TF=0,xn=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new jt(!1);onMicrotaskEmpty=new jt(!1);onStable=new jt(!1);onError=new jt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=xC}=e;if(typeof Zone>"u")throw new ee(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,DF(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(X0)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ee(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ee(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,SF,Oh,Oh);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},SF={};function ev(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function CF(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){Z0(()=>{n.callbackScheduled=!1,s0(n),n.isCheckStableRunning=!0,ev(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),s0(n)}function DF(n){let e=()=>{CF(n)},t=TF++;n._inner=n._inner.fork({name:"angular",properties:{[X0]:!0,[xl]:t,[xl+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(xF(c))return r.invokeTask(o,s,a,c);try{return GS(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),zS(n)}},onInvoke:(r,i,o,s,a,c,u)=>{try{return GS(n),r.invoke(o,s,a,c,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!AF(c)&&e(),zS(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,s0(n),ev(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function s0(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function GS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function zS(n){n._nesting--,ev(n)}var Al=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new jt;onMicrotaskEmpty=new jt;onStable=new jt;onError=new jt;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function xF(n){return RC(n,"__ignore_ng_zone__")}function AF(n){return RC(n,"__scheduler_tick__")}function RC(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var zr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},Kn=new ne("",{factory:()=>{let n=j(xn),e=j(xt),t;return r=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw r}):(t??=e.get(zr),t.handleError(r))})}}}),NC={provide:Kr,useValue:()=>{let n=j(zr,{optional:!0})},multi:!0},MF=new ne("",{factory:()=>{let n=j(At).defaultView;if(!n)return;let e=j(Kn),t=o=>{e(o.reason),o.preventDefault()},r=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},i=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",r)};typeof Zone<"u"?Zone.root.run(i):i(),j(Tr).onDestroy(()=>{n.removeEventListener("error",r),n.removeEventListener("unhandledrejection",t)})}});function tv(){return Qr([eC(()=>{j(MF)})])}function W(n,e){let[t,r,i]=Py(n,e?.equal),o=t,s=o[Nn];return o.set=r,o.update=i,o.asReadonly=PC.bind(o),o}function PC(){let n=this[Nn];if(n.readonlyFn===void 0){let e=()=>this();e[Nn]=n,n.readonlyFn=e}return n.readonlyFn}var ef=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=RF}return n})();function RF(){return new ef(Ce(),mn())}var Co=class{},Hl=new ne("",{factory:()=>!0});var nv=new ne(""),tf=(()=>{class n{internalPendingTasks=j(ei);scheduler=j(Co);errorHandler=j(Kn);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}return n})(),rv=(()=>{class n{static \u0275prov=te({token:n,providedIn:"root",factory:()=>new a0})}return n})(),a0=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},c0=class{[Nn];constructor(e){this[Nn]=e}destroy(){this[Nn].destroy()}};function Wt(n){return ky(n)}var nf={JSACTION:"jsaction"};function Zl(n){return{toString:n}.toString()}function LF(n){return typeof n=="function"}function vD(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var ff=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}},Ui=(()=>{let n=()=>_D;return n.ngInherit=!0,n})();function _D(n){return n.type.prototype.ngOnChanges&&(n.setInput=UF),VF}function VF(){let n=bD(this),e=n?.current;if(e){let t=n.previous;if(t===xo)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function UF(n,e,t,r,i){let o=this.declaredInputs[r],s=bD(n)||BF(n,{previous:xo,current:null}),a=s.current||(s.current={}),c=s.previous,u=c[o];a[o]=new ff(u&&u.currentValue,t,c===xo),vD(n,e,i,t)}var ED="__ngSimpleChanges__";function bD(n){return n[ED]||null}function BF(n,e){return n[ED]=e}var kC=[];var Je=function(n,e=null,t){for(let r=0;r<kC.length;r++){let i=kC[r];i(n,e,t)}},ze=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(ze||{});function jF(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=_D(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function wD(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function sf(n,e,t){ID(n,e,3,t)}function af(n,e,t,r){(n[Ae]&3)===t&&ID(n,e,t,r)}function iv(n,e){let t=n[Ae];(t&3)===e&&(t&=16383,t+=1,n[Ae]=t)}function ID(n,e,t,r){let i=r!==void 0?n[Ts]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Ts]+=65536),(a<o||o==-1)&&(HF(n,t,e,c),n[Ts]=(n[Ts]&4294901760)+c+2),c++}function OC(n,e){Je(ze.LifecycleHookStart,n,e);let t=Se(null);try{e.call(n)}finally{Se(t),Je(ze.LifecycleHookEnd,n,e)}}function HF(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[Ae]>>14<n[Ts]>>16&&(n[Ae]&3)===e&&(n[Ae]+=16384,OC(a,o)):OC(a,o)}var Va=-1,ks=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function $F(n){return(n.flags&8)!==0}function GF(n){return(n.flags&16)!==0}function zF(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];qF(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function TD(n){return n===3||n===4||n===6}function qF(n){return n.charCodeAt(0)===64}function ja(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?FC(n,t,i,null,e[++r]):FC(n,t,i,null,null))}}return n}function FC(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function SD(n){return n!==Va}function pf(n){return n&32767}function WF(n){return n>>16}function gf(n,e){let t=WF(n),r=e;for(;t>0;)r=r[Is],t--;return r}var vv=!0;function mf(n){let e=vv;return vv=n,e}var KF=256,CD=KF-1,DD=5,QF=0,ti={};function YF(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(ws)&&(r=t[ws]),r==null&&(r=t[ws]=QF++);let i=r&CD,o=1<<i;e.data[n+(i>>DD)]|=o}function yf(n,e){let t=xD(n,e);if(t!==-1)return t;let r=e[he];r.firstCreatePass&&(n.injectorIndex=e.length,ov(r.data,n),ov(e,null),ov(r.blueprint,null));let i=Wv(n,e),o=n.injectorIndex;if(SD(i)){let s=pf(i),a=gf(i,e),c=a[he].data;for(let u=0;u<8;u++)e[o+u]=a[s+u]|c[s+u]}return e[o+8]=i,o}function ov(n,e){n.push(0,0,0,0,0,0,0,0,e)}function xD(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Wv(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=PD(i),r===null)return Va;if(t++,i=i[Is],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Va}function _v(n,e,t){YF(n,e,t)}function JF(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let o=t[i];if(TD(o))break;if(o===0)i=i+2;else if(typeof o=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(o===e)return t[i+1];i=i+2}}}return null}function AD(n,e,t){if(t&8||n!==void 0)return n;jh(e,"NodeInjector")}function MD(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[$n],o=Cn(void 0);try{return i?i.get(e,r,t&8):_0(e,r,t&8)}finally{Cn(o)}}return AD(r,e,t)}function RD(n,e,t,r=0,i){if(n!==null){if(e[Ae]&2048&&!(r&2)){let s=tL(n,e,t,r,ti);if(s!==ti)return s}let o=ND(n,e,t,r,ti);if(o!==ti)return o}return MD(e,t,r,i)}function ND(n,e,t,r,i){let o=XF(t);if(typeof o=="function"){if(!W0(e,n,r))return r&1?AD(i,t,r):MD(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&8))jh(t);else return s}finally{K0()}}else if(typeof o=="number"){let s=null,a=xD(n,e),c=Va,u=r&1?e[Mn][rr]:null;for((a===-1||r&4)&&(c=a===-1?Wv(n,e):e[a+8],c===Va||!VC(r,!1)?a=-1:(s=e[he],a=pf(c),e=gf(c,e)));a!==-1;){let d=e[he];if(LC(o,a,d.data)){let f=ZF(a,e,t,s,r,u);if(f!==ti)return f}c=e[a+8],c!==Va&&VC(r,e[he].data[a+8]===u)&&LC(o,a,e)?(s=d,a=pf(c),e=gf(c,e)):a=-1}}return i}function ZF(n,e,t,r,i,o){let s=e[he],a=s.data[n+8],c=r==null?Li(a)&&vv:r!=s&&(a.type&3)!==0,u=i&1&&o===a,d=cf(a,s,t,c,u);return d!==null?ql(e,s,d,a,i):ti}function cf(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,u=n.directiveEnd,d=o>>20,f=r?a:a+d,g=i?a+d:u;for(let m=f;m<g;m++){let S=s[m];if(m<c&&t===S||m>=c&&S.type===t)return m}if(i){let m=s[c];if(m&&Xr(m)&&m.type===t)return c}return null}function ql(n,e,t,r,i){let o=n[t],s=e.data;if(o instanceof ks){let a=o;if(a.resolving){let m=WS(s[t]);throw v0(m)}let c=mf(a.canSeeViewProviders);a.resolving=!0;let u=s[t].type||s[t],d,f=a.injectImpl?Cn(a.injectImpl):null,g=W0(n,r,0);try{o=n[t]=a.factory(void 0,i,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&jF(t,s[t],e)}finally{f!==null&&Cn(f),mf(c),a.resolving=!1,K0()}}return o}function XF(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ws)?n[ws]:void 0;return typeof e=="number"?e>=0?e&CD:eL:e}function LC(n,e,t){let r=1<<n;return!!(t[e+(n>>DD)]&r)}function VC(n,e){return!(n&2)&&!(n&1&&e)}var Ps=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return RD(this._tNode,this._lView,e,_s(r),t)}};function eL(){return new Ps(mn(),Ce())}function Us(n){return Zl(()=>{let e=n.prototype.constructor,t=e[Cl]||Ev(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Cl]||Ev(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Ev(n){return l0(n)?()=>{let e=Ev(un(n));return e&&e()}:To(n)}function tL(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[Ae]&2048&&!xs(s);){let a=ND(o,s,t,r|2,ti);if(a!==ti)return a;let c=o.parent;if(!c){let u=s[C0];if(u){let d=u.get(t,ti,r);if(d!==ti)return d}c=PD(s),s=s[Is]}o=c}return i}function PD(n){let e=n[he],t=e.type;return t===2?e.declTNode:t===1?n[rr]:null}function Xl(n){return JF(mn(),n)}function nL(){return qa(mn(),Ce())}function qa(n,e){return new xr(ir(n,e))}var xr=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=nL}return n})();function rL(n){return n instanceof xr?n.nativeElement:n}function iL(){return this._results[Symbol.iterator]()}var vf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Vt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let r=ZS(e);(this._changesDetected=!JS(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=iL},kD="ngSkipHydration",oL="ngskiphydration";function OD(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let r=e[t];if(typeof r=="number")return!1;if(typeof r=="string"&&r.toLowerCase()===oL)return!0}return!1}function FD(n){return n.hasAttribute(kD)}function _f(n){return(n.flags&128)===128}function LD(n){if(_f(n))return!0;let e=n.parent;for(;e;){if(_f(n)||OD(e))return!0;e=e.parent}return!1}var Kv=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(Kv||{}),VD=new Map,sL=0;function aL(){return sL++}function cL(n){VD.set(n[Fi],n)}function bv(n){VD.delete(n[Fi])}var UC="__ngContext__";function Ha(n,e){zn(e)?(n[UC]=e[Fi],cL(e)):n[UC]=e}function UD(n){return jD(n[Oa])}function BD(n){return jD(n[nr])}function jD(n){for(;n!==null&&!qn(n);)n=n[nr];return n}var wv;function Qv(n){wv=n}function HD(){if(wv!==void 0)return wv;if(typeof document<"u")return document;throw new ee(210,!1)}var ri=new ne("",{factory:()=>lL}),lL="ng";var Of=new ne(""),Bi=new ne("",{providedIn:"platform",factory:()=>"unknown"});var Ff=new ne("",{factory:()=>j(At).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Wa=(()=>{class n{static \u0275prov=te({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=uL(j(At),j(ri)),t}});store={};onSerializeCallbacks={};get(t,r){return this.store[t]!==void 0?this.store[t]:r}set(t,r){this.store[t]=r}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,r){this.onSerializeCallbacks[t]=r}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(r){console.warn("Exception in onSerialize callback: ",r)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function uL(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(r){console.warn("Exception while restoring TransferState for app "+e,r)}return{}}var $D="h",GD="b",dL="f",hL="n",zD="e",qD="t",Lf="c",Yv="x",Wl="r",WD="i",KD="n",Jv="d";var QD="di",YD="s",JD="p";var eu=new ne(""),ZD=!1,Zv=new ne("",{factory:()=>ZD});var Xv=new ne(""),XD=!1,ex=new ne("",{factory:()=>[]}),tx=new ne(""),e_=new ne("",{factory:()=>new Map});var tu="ngb";var nx=(n,e,t)=>{let r=n,i=r.__jsaction_fns??new Map,o=i.get(e)??[];o.push(t),i.set(e,o),r.__jsaction_fns=i},rx=(n,e)=>{let t=n,r=t.getAttribute(tu)??"",i=e.get(r)??new Set;i.has(t)||i.add(t),e.set(r,i)};var ix=n=>{n.removeAttribute(nf.JSACTION),n.removeAttribute(tu),n.__jsaction_fns=void 0},ox=new ne("",{factory:()=>({})});function t_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let r of t)r(n)}var Iv=new Map;function sx(n,e){return Iv.set(n,e),()=>Iv.delete(n)}var BC=!1,ax=(n,e,t,r)=>{};function fL(n,e,t,r){ax(n,e,t,r)}function cx(){BC||(ax=(n,e,t,r)=>{let i=n[$n].get(ri);Iv.get(i)?.(e,t,r)},BC=!0)}var Vf=new ne("");function Uf(n){return(n.flags&32)===32}var pL="__nghData__",n_=pL,gL="__nghDeferData__",lx=gL;var lf="ngh",ux="nghm",dx=()=>null;function mL(n,e,t=!1){let r=n.getAttribute(lf);if(r==null)return null;let[i,o]=r.split("|");if(r=t?o:i,!r)return null;let s=o?`|${o}`:"",a=t?i:s,c={};if(r!==""){let d=e.get(Wa,null,{optional:!0});d!==null&&(c=d.get(n_,[])[Number(r)])}let u={data:c,firstChild:n.firstChild??null};return t&&(u.firstChild=n,Bf(u,0,n.nextSibling)),a?n.setAttribute(lf,a):n.removeAttribute(lf),u}function hx(){dx=mL}function fx(n,e,t=!1){return dx(n,e,t)}function px(n){let e=n._lView;return e[he].type===2?null:(xs(e)&&(e=e[Qe]),e)}function yL(n){return n.textContent?.replace(/\s/gm,"")}function vL(n){let e=HD(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=yL(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),r,i=[];for(;r=t.nextNode();)i.push(r);for(let o of i)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function Bf(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function Tv(n,e){return n.segmentHeads?.[e]??null}function gx(n){return n.get(tx,!1,{optional:!0})}function _L(n,e){let t=n.data,r=t[zD]?.[e]??null;return r===null&&t[Lf]?.[e]&&(r=r_(n,e)),r}function mx(n,e){return n.data[Lf]?.[e]??null}function r_(n,e){let t=mx(n,e)??[],r=0;for(let i of t)r+=i[Wl]*(i[Yv]??1);return r}function EL(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[Jv];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function yx(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[Jv];n.disconnectedNodes=t?new Set(t):null}return!!EL(n)?.has(e)}function jf(n,e){let t=n[On];return t!==null&&!L0()&&!Uf(e)&&!yx(t,e.index-Qe)}function bL(n,e){let t=e.get(Vf),i=e.get(Wa).get(lx,{}),o=!1,s=n,a=null,c=[];for(;!o&&s;){o=t.has(s);let u=t.hydrating.get(s);if(a===null&&u!=null){a=u.promise;break}c.unshift(s),s=i[s][JD]}return{parentBlockPromise:a,hydrationQueue:c}}function sv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===ux}function jC(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function vx(n){for(let r of n.body.childNodes)if(sv(r))return;let e=jC(n.body.previousSibling);if(sv(e))return;let t=jC(n.head.lastChild);if(!sv(t))throw new ee(-507,!1)}function _x(n,e){let t=n.contentQueries;if(t!==null){let r=Se(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];Yh(o),a.contentQueries(2,e[s],s)}}}finally{Se(r)}}}function Sv(n,e,t){Yh(0);let r=Se(null);try{e(n,t)}finally{Se(r)}}function Ex(n,e,t){if(D0(e)){let r=Se(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{Se(r)}}}var Dr=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Dr||{});var rf;function wL(){if(rf===void 0&&(rf=null,qr.trustedTypes))try{rf=qr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return rf}function HC(n){return wL()?.createScriptURL(n)||n}var Ef=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Fh})`}};function Ka(n){return n instanceof Ef?n.changingThisBreaksApplicationSecurity:n}function Hf(n,e){let t=bx(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Fh})`)}return t===e}function bx(n){return n instanceof Ef&&n.getTypeName()||null}var IL=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function i_(n){return n=String(n),n.match(IL)?n:"unsafe:"+n}var TL=/^>|^->|<!--|-->|--!>|<!-$/g,SL=/(<|>)/g,CL="\u200B$1\u200B";function DL(n){return n.replace(TL,e=>e.replace(SL,CL))}function wx(n,e){return n.createText(e)}function xL(n,e,t){n.setValue(e,t)}function Ix(n,e){return n.createComment(DL(e))}function o_(n,e,t){return n.createElement(e,t)}function bf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Tx(n,e,t){n.appendChild(e,t)}function $C(n,e,t,r,i){r!==null?bf(n,e,t,r,i):Tx(n,e,t)}function s_(n,e,t,r){n.removeChild(null,e,t,r)}function Sx(n){n.textContent=""}function AL(n,e,t){n.setAttribute(e,"style",t)}function ML(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Cx(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&zF(n,e,r),i!==null&&ML(n,e,i),o!==null&&AL(n,e,o)}var nu=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(nu||{});function ii(n){let e=xx();return e?e.sanitize(nu.URL,n)||"":Hf(n,"URL")?Ka(n):i_(wr(n))}function Dx(n){let e=xx();if(e)return HC(e.sanitize(nu.RESOURCE_URL,n)||"");if(Hf(n,"ResourceURL"))return HC(Ka(n));throw new ee(904,!1)}var RL=new Set(["embed","frame","iframe","media","script"]),NL=new Set(["base","link","script"]);function PL(n,e){return e==="src"&&RL.has(n)||e==="href"&&NL.has(n)||e==="xlink:href"&&n==="script"?Dx:ii}function a_(n,e,t){return PL(e,t)(n)}function xx(){let n=Ce();return n&&n[Yr].sanitizer}function Ax(n){return n.ownerDocument.body}function Mx(n){return n instanceof Function?n():n}function kL(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var Rx="ng-template";function OL(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&kL(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(c_(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function c_(n){return n.type===4&&n.value!==Rx}function FL(n,e,t){let r=n.type===4&&!t?Rx:n.value;return e===r}function LL(n,e,t){let r=4,i=n.attrs,o=i!==null?BL(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Sr(r)&&!Sr(c))return!1;if(s&&Sr(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!FL(n,c,t)||c===""&&e.length===1){if(Sr(r))return!1;s=!0}}else if(r&8){if(i===null||!OL(n,i,c,t)){if(Sr(r))return!1;s=!0}}else{let u=e[++a],d=VL(c,i,c_(n),t);if(d===-1){if(Sr(r))return!1;s=!0;continue}if(u!==""){let f;if(d>o?f="":f=i[d+1].toLowerCase(),r&2&&u!==f){if(Sr(r))return!1;s=!0}}}}return Sr(r)||s}function Sr(n){return(n&1)===0}function VL(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return jL(e,n)}function UL(n,e,t=!1){for(let r=0;r<e.length;r++)if(LL(n,e[r],t))return!0;return!1}function BL(n){for(let e=0;e<n.length;e++){let t=n[e];if(TD(t))return e}return n.length}function jL(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function GC(n,e){return n?":not("+e.trim()+")":e}function HL(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Sr(s)&&(e+=GC(o,i),i=""),r=s,o=o||!Sr(r);t++}return i!==""&&(e+=GC(o,i)),e}function $L(n){return n.map(HL).join(",")}function GL(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Sr(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var Zt={};function l_(n,e,t,r,i,o,s,a,c,u,d){let f=Qe+r,g=f+i,m=zL(f,g),S=typeof u=="function"?u():u;return m[he]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:S,incompleteFirstPass:!1,ssrId:d}}function zL(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Zt);return t}function qL(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=l_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function u_(n,e,t,r,i,o,s,a,c,u,d){let f=e.blueprint.slice();return f[An]=i,f[Ae]=r|4|128|8|64|1024,(u!==null||n&&n[Ae]&2048)&&(f[Ae]|=2048),M0(f),f[Rt]=f[Is]=n,f[Nt]=t,f[Yr]=s||n&&n[Yr],f[st]=a||n&&n[st],f[$n]=c||n&&n[$n]||null,f[rr]=o,f[Fi]=aL(),f[On]=d,f[C0]=u,f[Mn]=e.type==2?n[Mn]:f,f}function WL(n,e,t){let r=ir(e,n),i=qL(t),o=n[Yr].rendererFactory,s=d_(n,u_(n,i,null,Nx(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function Nx(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function Px(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function d_(n,e){return n[Oa]?n[S0][nr]=e:n[Oa]=e,n[S0]=e,e}function w(n=1){kx(Pt(),Ce(),ar()+n,!1)}function kx(n,e,t,r){if(!r)if((e[Ae]&3)===3){let o=n.preOrderCheckHooks;o!==null&&sf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&af(e,o,0,t)}Ro(t)}var $f=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})($f||{});function Cv(n,e,t,r){let i=Se(null);try{let[o,s,a]=n.inputs[t],c=null;(s&$f.SignalBased)!==0&&(c=e[o][Nn]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,o):vD(e,c,o,r)}finally{Se(i)}}var ni=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(ni||{}),KL;function h_(n,e){return KL(n,e)}var Os=new Set,Gf=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Gf||{}),ko=new ne(""),zC=new Set;function Yn(n){zC.has(n)||(zC.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var f_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}return n})(),Ox=[0,1,2,3],Fx=(()=>{class n{ngZone=j(xn);scheduler=j(Co);errorHandler=j(zr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){j(ko,{optional:!0})}execute(){let t=this.sequences.size>0;t&&Je(ze.AfterRenderHooksStart),this.executing=!0;for(let r of Ox)for(let i of this.sequences)if(!(i.erroredOrDestroyed||!i.hooks[r]))try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=i.hooks[r];return o(i.pipelinedValue)},i.snapshot))}catch(o){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&Je(ze.AfterRenderHooksEnd)}register(t){let{view:r}=t;r!==void 0?((r[Ss]??=[]).push(t),Fa(r),r[Ae]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(Gf.AFTER_NEXT_RENDER,t):t()}static \u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}return n})(),wf=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,r,i,o,s=null){this.impl=e,this.hooks=t,this.view=r,this.once=i,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Ss];e&&(this.view[Ss]=e.filter(t=>t!==this))}};function ru(n,e){let t=e?.injector??j(kn);return Yn("NgAfterNextRender"),YL(n,t,e,!0)}function QL(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function YL(n,e,t,r){let i=e.get(f_);i.impl??=e.get(Fx);let o=e.get(ko,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Tr):null,a=e.get(ef,null,{optional:!0}),c=new wf(i.impl,QL(n),a?.view,r,s,o?.snapshot(null));return i.impl.register(c),c}var Lx=new ne("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:j(xt)})});function Vx(n,e,t){let r=n.get(Lx);if(Array.isArray(e))for(let i of e)r.queue.add(i),t?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function JL(n,e){let t=n.get(Lx);if(e.detachedLeaveAnimationFns){for(let r of e.detachedLeaveAnimationFns)t.queue.delete(r);e.detachedLeaveAnimationFns=void 0}}function ZL(n,e){for(let[t,r]of e)Vx(n,r.animateFns)}function qC(n,e,t,r){let i=n?.[Cs]?.enter;e!==null&&i&&i.has(t.index)&&ZL(r,i)}function La(n,e,t,r,i,o,s,a){if(i!=null){let c,u=!1;qn(i)?c=i:zn(i)&&(u=!0,i=i[An]);let d=Wn(i);n===0&&r!==null?(qC(a,r,o,t),s==null?Tx(e,r,d):bf(e,r,d,s||null,!0)):n===1&&r!==null?(qC(a,r,o,t),bf(e,r,d,s||null,!0)):n===2?WC(a,o,t,f=>{s_(e,d,u,f)}):n===3&&WC(a,o,t,()=>{e.destroyNode(d)}),c!=null&&dV(e,n,t,c,o,r,s)}}function XL(n,e){Ux(n,e),e[An]=null,e[rr]=null}function eV(n,e,t,r,i,o){r[An]=i,r[rr]=e,qf(n,r,t,1,i,o)}function Ux(n,e){e[Yr].changeDetectionScheduler?.notify(9),qf(n,e,e[st],2,null,null)}function tV(n){let e=n[Oa];if(!e)return av(n[he],n);for(;e;){let t=null;if(zn(e))t=e[Oa];else{let r=e[St];r&&(t=r)}if(!t){for(;e&&!e[nr]&&e!==n;)zn(e)&&av(e[he],e),e=e[Rt];e===null&&(e=n),zn(e)&&av(e[he],e),t=e&&e[nr]}e=t}}function p_(n,e){let t=n[Ds],r=t.indexOf(e);t.splice(r,1)}function zf(n,e){if(Mo(e))return;let t=e[st];t.destroyNode&&qf(n,e,t,3,null,null),tV(e)}function av(n,e){if(Mo(e))return;let t=Se(null);try{e[Ae]&=-129,e[Ae]|=256,e[Gn]&&vl(e[Gn]),iV(n,e),rV(n,e),e[he].type===1&&e[st].destroy();let r=e[Ao];if(r!==null&&qn(e[Rt])){r!==e[Rt]&&p_(r,e);let i=e[Jr];i!==null&&i.detachView(n)}bv(e)}finally{Se(t)}}function WC(n,e,t,r){let i=n?.[Cs];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);n&&Os.add(n[Fi]),Vx(t,()=>{if(i.leave&&i.leave.has(e.index)){let s=i.leave.get(e.index),a=[];if(s){for(let c=0;c<s.animateFns.length;c++){let u=s.animateFns[c],{promise:d}=u();a.push(d)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(a),nV(n,r)}else n&&Os.delete(n[Fi]),r(!1)},i)}function nV(n,e){let t=n[Cs]?.running;if(t){t.then(()=>{n[Cs].running=void 0,Os.delete(n[Fi]),e(!0)});return}e(!1)}function rV(n,e){let t=n.cleanup,r=e[ka];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[ka]=null);let i=e[Ni];if(i!==null){e[Ni]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[kl];if(o!==null){e[kl]=null;for(let s of o)s.destroy()}}function iV(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ks)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];Je(ze.LifecycleHookStart,a,c);try{c.call(a)}finally{Je(ze.LifecycleHookEnd,a,c)}}else{Je(ze.LifecycleHookStart,i,o);try{o.call(i)}finally{Je(ze.LifecycleHookEnd,i,o)}}}}}function oV(n,e,t){return sV(n,e.parent,t)}function sV(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[An];if(Li(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Dr.None||i===Dr.Emulated)return null}return ir(r,t)}function aV(n,e,t){return lV(n,e,t)}function cV(n,e,t){return n.type&40?ir(n,t):null}var lV=cV,KC;function g_(n,e,t,r){let i=oV(n,r,e),o=e[st],s=r.parent||e[rr],a=aV(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)$C(o,i,t[c],a,!1);else $C(o,i,t,a,!1);KC!==void 0&&KC(o,r,e,t,i)}function Gl(n,e){if(e!==null){let t=e.type;if(t&3)return ir(e,n);if(t&4)return Dv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Gl(n,r);{let i=n[e.index];return qn(i)?Dv(-1,i):Wn(i)}}else{if(t&128)return Gl(n,e.next);if(t&32)return h_(e,n)()||Wn(n[e.index]);{let r=Bx(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=So(n[Mn]);return Gl(i,r)}else return Gl(n,e.next)}}}return null}function Bx(n,e){if(e!==null){let r=n[Mn][rr],i=e.projection;return r.projection[i]}return null}function Dv(n,e){let t=St+n+1;if(t<e.length){let r=e[t],i=r[he].firstChild;if(i!==null)return Gl(r,i)}return e[Zr]}function m_(n,e,t,r,i,o,s){for(;t!=null;){let a=r[$n];if(t.type===128){t=t.next;continue}let c=r[t.index],u=t.type;if(s&&e===0&&(c&&Ha(Wn(c),r),t.flags|=2),!Uf(t))if(u&8)m_(n,e,t.child,r,i,o,!1),La(e,n,a,i,c,t,o,r);else if(u&32){let d=h_(t,r),f;for(;f=d();)La(e,n,a,i,f,t,o,r);La(e,n,a,i,c,t,o,r)}else u&16?uV(n,e,r,t,i,o):La(e,n,a,i,c,t,o,r);t=s?t.projectionNext:t.next}}function qf(n,e,t,r,i,o){m_(t,r,n.firstChild,e,i,o,!1)}function uV(n,e,t,r,i,o){let s=t[Mn],c=s[rr].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];La(e,n,t[$n],i,d,r,o,t)}else{let u=c,d=s[Rt];_f(r)&&(u.flags|=128),m_(n,e,u,d,i,o,!0)}}function dV(n,e,t,r,i,o,s){let a=r[Zr],c=Wn(r);a!==c&&La(e,n,t,o,a,i,s);for(let u=St;u<r.length;u++){let d=r[u];qf(d[he],d,n,e,o,a)}}function hV(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:ni.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=ni.Important),n.setStyle(t,r,i,o))}}function jx(n,e,t,r,i){let o=ar(),s=r&2;try{Ro(-1),s&&e.length>Qe&&kx(n,e,Qe,!1);let a=s?ze.TemplateUpdateStart:ze.TemplateCreateStart;Je(a,i,t),t(r,i)}finally{Ro(o);let a=s?ze.TemplateUpdateEnd:ze.TemplateCreateEnd;Je(a,i,t)}}function y_(n,e,t){EV(n,e,t),(t.flags&64)===64&&bV(n,e,t)}function Wf(n,e,t=ir){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function fV(n,e,t,r){let o=r.get(Zv,ZD)||t===Dr.ShadowDom||t===Dr.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return pV(s),s}function pV(n){Hx(n)}var Hx=()=>null;function gV(n){FD(n)?Sx(n):vL(n)}function $x(){Hx=gV}function mV(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function yV(n,e,t,r,i,o){let s=e[he];if(__(n,s,e,t,r)){Li(n)&&_V(e,n.index);return}n.type&3&&(t=mV(t)),vV(n,e,t,r,i,o)}function vV(n,e,t,r,i,o){if(n.type&3){let s=ir(n,e);r=o!=null?o(r,n.value||"",t):r,i.setProperty(s,t,r)}else n.type&12}function _V(n,e){let t=or(e,n);t[Ae]&16||(t[Ae]|=64)}function EV(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Li(t)&&WL(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||yf(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let a=n.data[s],c=ql(e,n,s,t);if(Ha(c,e),o!==null&&SV(e,s-r,c,a,t,o),Xr(a)){let u=or(t.index,e);u[Nt]=ql(e,n,s,t)}}}function bV(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=bC();try{Ro(o);for(let a=r;a<i;a++){let c=n.data[a],u=e[a];Qh(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&wV(c,u)}}finally{Ro(-1),Qh(s)}}function wV(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function Gx(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];UL(e,o.selectors,!1)&&(r??=[],Xr(o)?r.unshift(o):r.push(o))}return r}function IV(n,e,t,r,i,o){let s=ir(n,e);TV(e[st],s,o,n.value,t,r,i)}function TV(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?wr(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function SV(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let c=s[a],u=s[a+1];Cv(r,t,c,u)}}function zx(n,e,t,r,i){let o=Qe+t,s=e[he],a=i(s,e,n,r,t);e[o]=a,Ms(n,!0);let c=n.type===2;return c?(Cx(e[st],a,n),(fC()===0||Fl(n))&&Ha(a,e),pC()):Ha(a,e),Xh()&&(!c||!Uf(n))&&g_(s,e,a,n),n}function qx(n){let e=n;return j0()?yC():(e=e.parent,Ms(e,!1)),e}function v_(n,e){let t=n[$n];if(!t)return;let r;try{r=t.get(Kn,null)}catch{r=null}r?.(e)}function __(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let c=0;c<s.length;c+=2){let u=s[c],d=s[c+1],f=e.data[u];Cv(f,t[u],d,i),a=!0}if(o)for(let c of o){let u=t[c],d=e.data[c];Cv(d,u,r,i),a=!0}return a}function CV(n,e){let t=or(e,n),r=t[he];DV(r,t);let i=t[An];i!==null&&t[On]===null&&(t[On]=fx(i,t[$n])),Je(ze.ComponentStart);try{E_(r,t,t[Nt])}finally{Je(ze.ComponentEnd,t[Nt])}}function DV(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function E_(n,e,t){Jh(e);try{let r=n.viewQuery;r!==null&&Sv(1,r,t);let i=n.template;i!==null&&jx(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Jr]?.finishViewCreation(n),n.staticContentQueries&&_x(n,e),n.staticViewQueries&&Sv(2,n.viewQuery,t);let o=n.components;o!==null&&xV(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[Ae]&=-5,Zh()}}function xV(n,e){for(let t=0;t<e.length;t++)CV(n,e[t])}function iu(n,e,t,r){let i=Se(null);try{let o=e.tView,a=n[Ae]&4096?4096:16,c=u_(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=n[e.index];c[Ao]=u;let d=n[Jr];return d!==null&&(c[Jr]=d.createEmbeddedView(o)),E_(o,c,t),c}finally{Se(i)}}function $a(n,e){return!e||e.firstChild===null||_f(n)}function Kl(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(Wn(o)),qn(o)&&Wx(o,r);let s=t.type;if(s&8)Kl(n,e,t.child,r);else if(s&32){let a=h_(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=Bx(e,t);if(Array.isArray(a))r.push(...a);else{let c=So(e[Mn]);Kl(c[he],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Wx(n,e){for(let t=St;t<n.length;t++){let r=n[t],i=r[he].firstChild;i!==null&&Kl(r[he],r,i,e)}n[Zr]!==n[An]&&e.push(n[Zr])}function Kx(n){if(n[Ss]!==null){for(let e of n[Ss])e.impl.addSequence(e);n[Ss].length=0}}var Qx=[];function AV(n){return n[Gn]??MV(n)}function MV(n){let e=Qx.pop()??Object.create(NV);return e.lView=n,e}function RV(n){n.lView[Gn]!==n&&(n.lView=null,Qx.push(n))}var NV=le(F({},gl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Fa(n.lView)},consumerOnSignalRead(){this.lView[Gn]=this}});function PV(n){let e=n[Gn]??Object.create(kV);return e.lView=n,e}var kV=le(F({},gl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=So(n.lView);for(;e&&!Yx(e[he]);)e=So(e);e&&R0(e)},consumerOnSignalRead(){this.lView[Gn]=this}});function Yx(n){return n.type!==2}function Jx(n){if(n[kl]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[kl])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[Ae]&8192)}}var OV=100;function Zx(n,e=0){let r=n[Yr].rendererFactory,i=!1;i||r.begin?.();try{FV(n,e)}finally{i||r.end?.()}}function FV(n,e){let t=$0();try{G0(!0),xv(n,e);let r=0;for(;Ul(n);){if(r===OV)throw new ee(103,!1);r++,xv(n,1)}}finally{G0(t)}}function LV(n,e,t,r){if(Mo(e))return;let i=e[Ae],o=!1,s=!1;Jh(e);let a=!0,c=null,u=null;o||(Yx(n)?(u=AV(e),c=yl(u)):nh()===null?(a=!1,u=PV(e),c=yl(u)):e[Gn]&&(vl(e[Gn]),e[Gn]=null));try{M0(e),vC(n.bindingStartIndex),t!==null&&jx(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let m=n.preOrderCheckHooks;m!==null&&sf(e,m,null)}else{let m=n.preOrderHooks;m!==null&&af(e,m,0,null),iv(e,0)}if(s||VV(e),Jx(e),Xx(e,0),n.contentQueries!==null&&_x(n,e),!o)if(d){let m=n.contentCheckHooks;m!==null&&sf(e,m)}else{let m=n.contentHooks;m!==null&&af(e,m,1),iv(e,1)}BV(n,e);let f=n.components;f!==null&&t1(e,f,0);let g=n.viewQuery;if(g!==null&&Sv(2,g,r),!o)if(d){let m=n.viewCheckHooks;m!==null&&sf(e,m)}else{let m=n.viewHooks;m!==null&&af(e,m,2),iv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[qh]){for(let m of e[qh])m();e[qh]=null}o||(Kx(e),e[Ae]&=-73)}catch(d){throw o||Fa(e),d}finally{u!==null&&(rh(u,c),a&&RV(u)),Zh()}}function Xx(n,e){for(let t=UD(n);t!==null;t=BD(t))for(let r=St;r<t.length;r++){let i=t[r];e1(i,e)}}function VV(n){for(let e=UD(n);e!==null;e=BD(e)){if(!(e[Ae]&2))continue;let t=e[Ds];for(let r=0;r<t.length;r++){let i=t[r];R0(i)}}}function UV(n,e,t){Je(ze.ComponentStart);let r=or(e,n);try{e1(r,t)}finally{Je(ze.ComponentEnd,r[Nt])}}function e1(n,e){Wh(n)&&xv(n,e)}function xv(n,e){let r=n[he],i=n[Ae],o=n[Gn],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&ih(o)),s||=!1,o&&(o.dirty=!1),n[Ae]&=-9217,s)LV(r,n,r.template,n[Nt]);else if(i&8192){let a=Se(null);try{Jx(n),Xx(n,1);let c=r.components;c!==null&&t1(n,c,1),Kx(n)}finally{Se(a)}}}function t1(n,e,t){for(let r=0;r<e.length;r++)UV(n,e[r],t)}function BV(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Ro(~i);else{let o=i,s=t[++r],a=t[++r];EC(s,o);let c=e[o];Je(ze.HostBindingsUpdateStart,c);try{a(2,c)}finally{Je(ze.HostBindingsUpdateEnd,c)}}}}finally{Ro(-1)}}function Kf(n,e){let t=$0()?64:1088;for(n[Yr].changeDetectionScheduler?.notify(e);n;){n[Ae]|=t;let r=So(n);if(xs(n)&&!r)return n;n=r}return null}function n1(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function r1(n,e){let t=St+e;if(t<n.length)return n[t]}function ou(n,e,t,r=!0){let i=e[he];if(jV(i,e,n,t),r){let s=Dv(t,n),a=e[st],c=a.parentNode(n[Zr]);c!==null&&eV(i,n[rr],a,e,c,s)}let o=e[On];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function b_(n,e){let t=Ql(n,e);return t!==void 0&&zf(t[he],t),t}function Ql(n,e){if(n.length<=St)return;let t=St+e,r=n[t];if(r){let i=r[Ao];i!==null&&i!==n&&p_(i,r),e>0&&(n[t-1][nr]=r[nr]);let o=Rl(n,St+e);XL(r[he],r);let s=o[Jr];s!==null&&s.detachView(o[he]),r[Rt]=null,r[nr]=null,r[Ae]&=-129}return r}function jV(n,e,t,r){let i=St+r,o=t.length;r>0&&(t[i-1][nr]=e),r<o-St?(e[nr]=t[i],E0(t,St+r,e)):(t.push(e),e[nr]=null),e[Rt]=t;let s=e[Ao];s!==null&&t!==s&&i1(s,e);let a=e[Jr];a!==null&&a.insertView(n),Kh(e),e[Ae]|=128}function i1(n,e){let t=n[Ds],r=e[Rt];if(zn(r))n[Ae]|=2;else{let i=r[Rt][Mn];e[Mn]!==i&&(n[Ae]|=2)}t===null?n[Ds]=[e]:t.push(e)}var No=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[he];return Kl(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Nt]}set context(e){this._lView[Nt]=e}get destroyed(){return Mo(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Rt];if(qn(e)){let t=e[Ol],r=t?t.indexOf(this):-1;r>-1&&(Ql(e,r),Rl(t,r))}this._attachedToViewContainer=!1}zf(this._lView[he],this._lView)}onDestroy(e){N0(this._lView,e)}markForCheck(){Kf(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ae]&=-129}reattach(){Kh(this._lView),this._lView[Ae]|=128}detectChanges(){this._lView[Ae]|=1024,Zx(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=xs(this._lView),t=this._lView[Ao];t!==null&&!e&&p_(t,this._lView),Ux(this._lView[he],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ee(902,!1);this._appRef=e;let t=xs(this._lView),r=this._lView[Ao];r!==null&&!t&&i1(r,this._lView),Kh(this._lView)}};var Po=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=HV;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let o=iu(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new No(o)}}return n})();function HV(){return Qf(mn(),Ce())}function Qf(n,e){return n.type&4?new Po(e,n,qa(n,e)):null}function Qa(n,e,t,r,i){let o=n.data[e];if(o===null)o=$V(n,e,t,r,i),_C()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=mC();o.injectorIndex=s===null?-1:s.injectorIndex}return Ms(o,!0),o}function $V(n,e,t,r,i){let o=B0(),s=j0(),a=s?o:o&&o.parent,c=n.data[e]=zV(n,a,t,e,r,i);return GV(n,c,o,s),c}function GV(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function zV(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return L0()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var qV=new RegExp(`^(\\d+)*(${GD}|${$D})*(.*)`);function WV(n){let e=n.match(qV),[t,r,i,o]=e,s=r?parseInt(r,10):i,a=[];for(let[c,u,d]of o.matchAll(/(f|n)(\d*)/g)){let f=parseInt(d,10)||1;a.push(u,f)}return[s,...a]}function KV(n){return!n.prev&&n.parent?.type===8}function cv(n){return n.index-Qe}function QV(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function Yf(n,e,t,r){let i=cv(r),o=QV(n,i);if(o===void 0){let s=n.data[KD];if(s?.[i])o=JV(s[i],t);else if(e.firstChild===r)o=n.firstChild;else{let a=r.prev===null,c=r.prev??r.parent;if(KV(r)){let u=cv(r.parent);o=Tv(n,u)}else{let u=ir(c,t);if(a)o=u.firstChild;else{let d=cv(c),f=Tv(n,d);if(c.type===2&&f){let m=r_(n,d)+1;o=Jf(m,f)}else o=u.nextSibling}}}}return o}function Jf(n,e){let t=e;for(let r=0;r<n;r++)t=t.nextSibling;return t}function YV(n,e){let t=n;for(let r=0;r<e.length;r+=2){let i=e[r],o=e[r+1];for(let s=0;s<o;s++)switch(i){case dL:t=t.firstChild;break;case hL:t=t.nextSibling;break}}return t}function JV(n,e){let[t,...r]=WV(n),i;if(t===$D)i=e[Mn][An];else if(t===GD)i=Ax(e[Mn][An]);else{let o=Number(t);i=Wn(e[o+Qe])}return YV(i,r)}var ZV=!1;function o1(n){ZV=n}function XV(n){let e=n[On];if(e){let{i18nNodes:t,dehydratedIcuData:r}=e;if(t&&r){let i=n[st];for(let o of r.values())e4(i,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function e4(n,e,t){for(let r of t.node.cases[t.case]){let i=e.get(r.index-Qe);i&&s_(n,i,!1)}}function Zf(n){let e=n[Ir]??[],r=n[Rt][st],i=[];for(let o of e)o.data[QD]!==void 0?i.push(o):s1(o,r);n[Ir]=i}function t4(n){let{lContainer:e}=n,t=e[Ir];if(t===null)return;let i=e[Rt][st];for(let o of t)s1(o,i)}function s1(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[Wl];for(;t<i;){let o=r.nextSibling;s_(e,r,!1),r=o,t++}}}function Xf(n){Zf(n);let e=n[An];zn(e)&&If(e);for(let t=St;t<n.length;t++)If(n[t])}function If(n){XV(n);let e=n[he];for(let t=Qe;t<e.bindingStartIndex;t++)if(qn(n[t])){let r=n[t];Xf(r)}else zn(n[t])&&If(n[t])}function w_(n){let e=n._views;for(let t of e){let r=px(t);r!==null&&r[An]!==null&&(zn(r)?If(r):Xf(r))}}function n4(n,e,t,r){n!==null&&(t.cleanup(e),Xf(n.lContainer),w_(r))}function r4(n,e){let t=[];for(let r of e)for(let i=0;i<(r[Yv]??1);i++){let o={data:r,firstChild:null};r[Wl]>0&&(o.firstChild=n,n=Jf(r[Wl],n)),t.push(o)}return[n,t]}var a1=()=>null,c1=()=>null;function l1(){a1=i4,c1=o4}function i4(n,e){return d1(n,e)?n[Ir].shift():(Zf(n),null)}function Tf(n,e){return a1(n,e)}function o4(n,e,t){if(e.tView.ssrId===null)return null;let r=Tf(n,e.tView.ssrId);return t[he].firstUpdatePass&&r===null&&s4(t,e),r}function u1(n,e,t){return c1(n,e,t)}function s4(n,e){let t=e;for(;t;){if(QC(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(QC(n,t))return;t=t.next}}function d1(n,e){let t=n[Ir];return!e||t===null||t.length===0?!1:t[0].data[WD]===e}function QC(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let r=n[e.index];return qn(r)&&d1(r,t)?(Zf(r),!0):!1}var h1=class{},ep=class{},Av=class{resolveComponentFactory(e){throw new ee(917,!1)}},su=class{static NULL=new Av},Fs=class{},Bs=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>a4()}return n})();function a4(){let n=Ce(),e=mn(),t=or(e.index,n);return(zn(t)?t:n)[st]}var f1=(()=>{class n{static \u0275prov=te({token:n,providedIn:"root",factory:()=>null})}return n})();var uf={},Ua=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,uf,r);return i!==uf||t===uf?i:this.parentInjector.get(e,t,r)}};function Sf(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=Lh(i,a);else if(o==2){let c=a,u=e[++s];r=Lh(r,c+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function ge(n,e=0){let t=Ce();if(t===null)return ve(n,e);let r=mn();return RD(r,t,un(n),e)}function p1(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let a=s,c=null,u=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,c,u]=d.resolveHostDirectives(s);break}u4(n,e,t,a,o,c,u)}o!==null&&r!==null&&c4(t,r,o)}function c4(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new ee(-301,!1);r.push(e[i],o)}}function l4(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function u4(n,e,t,r,i,o,s){let a=r.length,c=null;for(let g=0;g<a;g++){let m=r[g];c===null&&Xr(m)&&(c=m,l4(n,t,g)),_v(yf(t,e),n,m.type)}m4(t,n.data.length,a),c?.viewProvidersResolver&&c.viewProvidersResolver(c);for(let g=0;g<a;g++){let m=r[g];m.providersResolver&&m.providersResolver(m)}let u=!1,d=!1,f=Px(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let g=0;g<a;g++){let m=r[g];if(t.mergedAttrs=ja(t.mergedAttrs,m.hostAttrs),h4(n,t,e,f,m),g4(f,m,i),s!==null&&s.has(m)){let[M,O]=s.get(m);t.directiveToIndex.set(m.type,[f,M+t.directiveStart,O+t.directiveStart])}else(o===null||!o.has(m))&&t.directiveToIndex.set(m.type,f);m.contentQueries!==null&&(t.flags|=4),(m.hostBindings!==null||m.hostAttrs!==null||m.hostVars!==0)&&(t.flags|=64);let S=m.type.prototype;!u&&(S.ngOnChanges||S.ngOnInit||S.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),u=!0),!d&&(S.ngOnChanges||S.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),f++}d4(n,t,o)}function d4(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))YC(0,e,i,r),YC(1,e,i,r),ZC(e,r,!1);else{let o=t.get(i);JC(0,e,o,r),JC(1,e,o,r),ZC(e,r,!0)}}}function YC(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),g1(e,o)}}function JC(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,o),g1(e,s)}}function g1(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function ZC(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||c_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let u=i[c];for(let d of u)if(d===e){s??=[],s.push(c,r[a+1]);break}}else if(t&&o.hasOwnProperty(c)){let u=o[c];for(let d=0;d<u.length;d+=2)if(u[d]===e){s??=[],s.push(u[d+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function h4(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=To(i.type,!0)),s=new ks(o,Xr(i),ge,null);n.blueprint[r]=s,t[r]=s,f4(n,e,r,Px(n,t,i.hostVars,Zt),i)}function f4(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;p4(s)!=a&&s.push(a),s.push(t,r,o)}}function p4(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function g4(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Xr(e)&&(t[""]=n)}}function m4(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function m1(n,e,t,r,i,o,s,a){let c=e[he],u=c.consts,d=sr(u,s),f=Qa(c,n,t,r,d);return o&&p1(c,e,f,sr(u,a),i),f.mergedAttrs=ja(f.mergedAttrs,f.attrs),f.attrs!==null&&Sf(f,f.attrs,!1),f.mergedAttrs!==null&&Sf(f,f.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,f),f}function y1(n,e){wD(n,e),D0(e)&&n.queries.elementEnd(e)}function y4(n,e,t,r,i,o){let s=e.consts,a=sr(s,i),c=Qa(e,n,t,r,a);if(c.mergedAttrs=ja(c.mergedAttrs,c.attrs),o!=null){let u=sr(s,o);c.localNames=[];for(let d=0;d<u.length;d+=2)c.localNames.push(u[d],-1)}return c.attrs!==null&&Sf(c,c.attrs,!1),c.mergedAttrs!==null&&Sf(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function I_(n){return _1(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function v1(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function _1(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function T_(n,e,t){return n[e]=t}function v4(n,e){return n[e]}function cr(n,e,t){if(t===Zt)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function S_(n,e,t,r){let i=cr(n,e,t);return cr(n,e+1,r)||i}function _4(n,e,t,r,i){let o=S_(n,e,t,r);return cr(n,e+2,i)||o}function df(n,e,t){return function r(i){let o=Li(n)?or(n.index,e):e;Kf(o,5);let s=e[Nt],a=XC(e,s,t,i),c=r.__ngNextListenerFn__;for(;c;)a=XC(e,s,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function XC(n,e,t,r){let i=Se(null);try{return Je(ze.OutputStart,e,t),t(r)!==!1}catch(o){return v_(n,o),!1}finally{Je(ze.OutputEnd,e,t),Se(i)}}function E1(n,e,t,r,i,o,s,a){let c=Fl(n),u=!1,d=null;if(!r&&c&&(d=b4(e,t,o,n.index)),d!==null){let f=d.__ngLastListenerFn__||d;f.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,u=!0}else{let f=ir(n,t),g=r?r(f):f;fL(t,g,o,a);let m=i.listen(g,o,a);if(!E4(o)){let S=r?M=>r(Wn(M[n.index])):n.index;b1(S,e,t,o,a,m,!1)}}return u}function E4(n){return n.startsWith("animation")||n.startsWith("transition")}function b4(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[ka],c=i[o+2];return a&&a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function b1(n,e,t,r,i,o,s){let a=e.firstCreatePass?k0(e):null,c=P0(t),u=c.length;c.push(i,o),a&&a.push(r,n,u,(u+1)*(s?-1:1))}function eD(n,e,t,r,i,o){let s=e[t],a=e[he],u=a.data[t].outputs[r],f=s[u].subscribe(o);b1(n.index,a,e,i,o,f,!0)}var Mv=Symbol("BINDING");var Cf=class extends su{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Oi(e);return new Ga(t,this.ngModule)}};function w4(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&$f.SignalBased)!==0};return i&&(o.transform=i),o})}function I4(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function T4(n,e,t){let r=e instanceof xt?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new Ua(t,r):t}function S4(n){let e=n.get(Fs,null);if(e===null)throw new ee(407,!1);let t=n.get(f1,null),r=n.get(Co,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function C4(n,e){let t=w1(n);return o_(e,t,t==="svg"?x0:t==="math"?aC:null)}function w1(n){return(n.selectors[0][0]||"div").toLowerCase()}var Ga=class extends ep{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=w4(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=I4(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=$L(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,o,s){Je(ze.DynamicComponentStart);let a=Se(null);try{let c=this.componentDef,u=D4(r,c,s,o),d=T4(c,i||this.ngModule,e),f=S4(d),g=f.rendererFactory.createRenderer(null,c),m=r?fV(g,r,c.encapsulation,d):C4(c,g),S=s?.some(tD)||o?.some(P=>typeof P!="function"&&P.bindings.some(tD)),M=u_(null,u,null,512|Nx(c),null,null,f,g,d,null,fx(m,d,!0));M[Qe]=m,Jh(M);let O=null;try{let P=m1(Qe,M,2,"#host",()=>u.directiveRegistry,!0,0);Cx(g,m,P),Ha(m,M),y_(u,M,P),Ex(u,P,M),y1(u,P),t!==void 0&&A4(P,this.ngContentSelectors,t),O=or(P.index,M),M[Nt]=O[Nt],E_(u,M,null)}catch(P){throw O!==null&&bv(O),bv(M),P}finally{Je(ze.DynamicComponentEnd),Zh()}return new Df(this.componentType,M,!!S)}finally{Se(a)}}};function D4(n,e,t,r){let i=n?["ng-version","21.1.1"]:GL(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[Mv].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(r)for(let d=0;d<r.length;d++){let f=r[d];if(typeof f!="function")for(let g of f.bindings){a+=g[Mv].requiredVars;let m=d+1;g.create&&(g.targetIdx=m,(o??=[]).push(g)),g.update&&(g.targetIdx=m,(s??=[]).push(g))}}let c=[e];if(r)for(let d of r){let f=typeof d=="function"?d:d.type,g=Uh(f);c.push(g)}return l_(0,null,x4(o,s),1,a,c,null,null,null,[i],null)}function x4(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function tD(n){let e=n[Mv].kind;return e==="input"||e==="twoWay"}var Df=class extends h1{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=As(t[he],Qe),this.location=qa(this._tNode,t),this.instance=or(this._tNode.index,t)[Nt],this.hostView=this.changeDetectorRef=new No(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=__(r,i[he],i,e,t);this.previousInputValues.set(e,t);let s=or(r.index,i);Kf(s,1)}get injector(){return new Ps(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function A4(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var ji=(()=>{class n{static __NG_ELEMENT_ID__=M4}return n})();function M4(){let n=mn();return T1(n,Ce())}var R4=ji,I1=class extends R4{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return qa(this._hostTNode,this._hostLView)}get injector(){return new Ps(this._hostTNode,this._hostLView)}get parentInjector(){let e=Wv(this._hostTNode,this._hostLView);if(SD(e)){let t=gf(e,this._hostLView),r=pf(e),i=t[he].data[r+8];return new Ps(i,t)}else return new Ps(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=nD(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-St}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=Tf(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,$a(this._hostTNode,s)),a}createComponent(e,t,r,i,o,s,a){let c=e&&!LF(e),u;if(c)u=t;else{let O=t||{};u=O.index,r=O.injector,i=O.projectableNodes,o=O.environmentInjector||O.ngModuleRef,s=O.directives,a=O.bindings}let d=c?e:new Ga(Oi(e)),f=r||this.parentInjector;if(!o&&d.ngModule==null){let P=(c?f:this.parentInjector).get(xt,null);P&&(o=P)}let g=Oi(d.componentType??{}),m=Tf(this._lContainer,g?.id??null),S=m?.firstChild??null,M=d.create(f,i,S,o,s,a);return this.insertImpl(M.hostView,u,$a(this._hostTNode,m)),M}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(lC(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Rt],u=new I1(c,c[rr],c[Rt]);u.detach(u.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return ou(s,i,o,r),e.attachToViewContainerRef(),E0(lv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=nD(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Ql(this._lContainer,t);r&&(Rl(lv(this._lContainer),t),zf(r[he],r))}detach(e){let t=this._adjustIndex(e,-1),r=Ql(this._lContainer,t);return r&&Rl(lv(this._lContainer),t)!=null?new No(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function nD(n){return n[Ol]}function lv(n){return n[Ol]||(n[Ol]=[])}function T1(n,e){let t,r=e[n.index];return qn(r)?t=r:(t=n1(r,e,null,n),e[n.index]=t,d_(e,t)),S1(t,e,n,r),new I1(t,n,e)}function N4(n,e){let t=n[st],r=t.createComment(""),i=ir(e,n),o=t.parentNode(i);return bf(t,o,r,t.nextSibling(i),!1),r}var S1=C1,C_=()=>!1;function P4(n,e,t){return C_(n,e,t)}function C1(n,e,t,r){if(n[Zr])return;let i;t.type&8?i=Wn(r):i=N4(e,t),n[Zr]=i}function k4(n,e,t){if(n[Zr]&&n[Ir])return!0;let r=t[On],i=e.index-Qe;if(!r||LD(e)||yx(r,i))return!1;let s=Tv(r,i),a=r.data[Lf]?.[i],[c,u]=r4(s,a);return n[Zr]=c,n[Ir]=u,!0}function O4(n,e,t,r){C_(n,t,e)||C1(n,e,t,r)}function D1(){S1=O4,C_=k4}var Rv=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Nv=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let r=e.contentQueries!==null?e.contentQueries[0]:t.length,i=[];for(let o=0;o<r;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];i.push(a.clone())}return new n(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)D_(e,t).matches!==null&&this.queries[t].setDirty()}},Pv=class{flags;read;predicate;constructor(e,t,r=null){this.flags=t,this.read=r,typeof e=="string"?this.predicate=$4(e):this.predicate=e}},kv=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,o=this.getByIndex(r).embeddedTView(e,i);o&&(o.indexInDeclarationView=r,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Ov=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];this.matchTNodeWithReadOption(e,t,F4(t,o)),this.matchTNodeWithReadOption(e,t,cf(t,e,o,!1,!1))}else r===Po?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,cf(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===xr||i===ji||i===Po&&t.type&4)this.addMatch(t.index,-2);else{let o=cf(t,e,i,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,r)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function F4(n,e){let t=n.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1]}return null}function L4(n,e){return n.type&11?qa(n,e):n.type&4?Qf(n,e):null}function V4(n,e,t,r){return t===-1?L4(e,n):t===-2?U4(n,e,r):ql(n,n[he],t,e)}function U4(n,e,t){if(t===xr)return qa(e,n);if(t===Po)return Qf(e,n);if(t===ji)return T1(e,n)}function x1(n,e,t,r){let i=e[Jr].queries[r];if(i.matches===null){let o=n.data,s=t.matches,a=[];for(let c=0;s!==null&&c<s.length;c+=2){let u=s[c];if(u<0)a.push(null);else{let d=o[u];a.push(V4(e,d,s[c+1],t.metadata.read))}}i.matches=a}return i.matches}function Fv(n,e,t,r){let i=n.queries.getByIndex(t),o=i.matches;if(o!==null){let s=x1(n,e,i,t);for(let a=0;a<o.length;a+=2){let c=o[a];if(c>0)r.push(s[a/2]);else{let u=o[a+1],d=e[-c];for(let f=St;f<d.length;f++){let g=d[f];g[Ao]===g[Rt]&&Fv(g[he],g,u,r)}if(d[Ds]!==null){let f=d[Ds];for(let g=0;g<f.length;g++){let m=f[g];Fv(m[he],m,u,r)}}}}}return r}function B4(n,e){return n[Jr].queries[e].queryList}function j4(n,e,t){let r=new vf((t&4)===4);return hC(n,e,r,r.destroy),(e[Jr]??=new Nv).queries.push(new Rv(r))-1}function H4(n,e,t){let r=Pt();return r.firstCreatePass&&(G4(r,new Pv(n,e,t),-1),(e&2)===2&&(r.staticViewQueries=!0)),j4(r,Ce(),e)}function $4(n){return n.split(",").map(e=>e.trim())}function G4(n,e,t){n.queries===null&&(n.queries=new kv),n.queries.track(new Ov(e,t))}function D_(n,e){return n.queries.getByIndex(e)}function z4(n,e){let t=n[he],r=D_(t,e);return r.crossesNgTemplate?Fv(t,n,e,[]):x1(t,n,r,e)}var Ls=class{},tp=class{};var xf=class extends Ls{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Cf(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=m0(e);this._bootstrapComponents=Mx(o.bootstrap),this._r3Injector=J0(e,t,[{provide:Ls,useValue:this},{provide:su,useValue:this.componentFactoryResolver},...r],Pi(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Af=class extends tp{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new xf(this.moduleType,e,[])}};var Yl=class extends Ls{injector;componentFactoryResolver=new Cf(this);instance=null;constructor(e){super();let t=new bs([...e.providers,{provide:Ls,useValue:this},{provide:su,useValue:this.componentFactoryResolver}],e.parent||Pl(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Ya(n,e,t=null){return new Yl({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var q4=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=zh(!1,t.type),i=r.length>0?Ya([r],this._injector,""):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=te({token:n,providedIn:"environment",factory:()=>new n(ve(xt))})}return n})();function hn(n){return Zl(()=>{let e=A1(n),t=le(F({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Kv.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(q4).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Dr.Emulated,styles:n.styles||Dn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Yn("NgStandalone"),M1(t);let r=n.dependencies;return t.directiveDefs=rD(r,W4),t.pipeDefs=rD(r,y0),t.id=Y4(t),t})}function W4(n){return Oi(n)||Uh(n)}function Hi(n){return Zl(()=>({type:n.type,bootstrap:n.bootstrap||Dn,declarations:n.declarations||Dn,imports:n.imports||Dn,exports:n.exports||Dn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function K4(n,e){if(n==null)return xo;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a,c;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o,c=i[3]||null):(o=i,s=i,a=$f.None,c=null),t[o]=[r,a,c],e[o]=s}return t}function Q4(n){if(n==null)return xo;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Xt(n){return Zl(()=>{let e=A1(n);return M1(e),e})}function np(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function A1(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||xo,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Dn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:K4(n.inputs,e),outputs:Q4(n.outputs),debugInfo:null}}function M1(n){n.features?.forEach(e=>e(n))}function rD(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let o=e(i);o!==null&&r.push(o)}return r}:null}function Y4(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function J4(n){return Object.getPrototypeOf(n.prototype).constructor}function oi(n){let e=J4(n.type),t=!0,r=[n];for(;e;){let i;if(Xr(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ee(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=uv(n.inputs),s.declaredInputs=uv(n.declaredInputs),s.outputs=uv(n.outputs);let a=i.hostBindings;a&&n3(n,a);let c=i.viewQuery,u=i.contentQueries;if(c&&e3(n,c),u&&t3(n,u),Z4(n,i),qS(n.outputs,i.outputs),Xr(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===oi&&(t=!1)}}e=Object.getPrototypeOf(e)}X4(r)}function Z4(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function X4(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=ja(i.hostAttrs,t=ja(t,i.hostAttrs))}}function uv(n){return n===xo?{}:n===Dn?[]:n}function e3(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function t3(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function n3(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function R1(n,e,t,r,i,o,s,a){if(t.firstCreatePass){n.mergedAttrs=ja(n.mergedAttrs,n.attrs);let d=n.tView=l_(2,n,i,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),Ms(n,!1);let c=N1(t,e,n,r);Xh()&&g_(t,e,c,n),Ha(c,e);let u=n1(c,e,c,n);e[r+Qe]=u,d_(e,u),P4(u,n,e)}function r3(n,e,t,r,i,o,s,a,c,u,d){let f=t+Qe,g;return e.firstCreatePass?(g=Qa(e,f,4,s||null,a||null),F0()&&p1(e,n,g,sr(e.consts,u),Gx),wD(e,g)):g=e.data[f],R1(g,n,e,t,r,i,o,c),Fl(g)&&y_(e,n,g),u!=null&&Wf(n,g,d),g}function Mf(n,e,t,r,i,o,s,a,c,u,d){let f=t+Qe,g;if(e.firstCreatePass){if(g=Qa(e,f,4,s||null,a||null),u!=null){let m=sr(e.consts,u);g.localNames=[];for(let S=0;S<m.length;S+=2)g.localNames.push(m[S],-1)}}else g=e.data[f];return R1(g,n,e,t,r,i,o,c),u!=null&&Wf(n,g,d),g}function si(n,e,t,r,i,o,s,a){let c=Ce(),u=Pt(),d=sr(u.consts,o);return r3(c,u,n,e,t,r,i,d,void 0,s,a),si}var N1=P1;function P1(n,e,t,r){return Vi(!0),e[st].createComment("")}function i3(n,e,t,r){let i=!jf(e,t);Vi(i);let o=e[On]?.data[qD]?.[r]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),i)return P1(n,e);let s=e[On],a=Yf(s,n,e,t);Bf(s,r,a);let c=r_(s,r);return Jf(c,a)}function k1(){N1=i3}var Qn=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(Qn||{}),iD=0,o3=1,Ht=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(Ht||{});var s3=0,au=1;var a3=4,c3=5;var l3=7,Ba=8,u3=9,x_=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(x_||{});function hf(n,e){let t=h3(n),r=e[t];if(r!==null){for(let i of r)i();e[t]=null}}function d3(n){hf(1,n),hf(0,n),hf(2,n)}function h3(n){let e=a3;return n===1?e=c3:n===2&&(e=u3),e}function O1(n){return n+1}function Ja(n,e){let t=n[he],r=O1(e.index);return n[r]}function cu(n,e){let t=O1(e.index);return n.data[t]}function f3(n,e,t){let r=e[he],i=cu(r,t);switch(n){case Ht.Complete:return i.primaryTmplIndex;case Ht.Loading:return i.loadingTmplIndex;case Ht.Error:return i.errorTmplIndex;case Ht.Placeholder:return i.placeholderTmplIndex;default:return null}}function oD(n,e){return e===Ht.Placeholder?n.placeholderBlockConfig?.[iD]??null:e===Ht.Loading?n.loadingBlockConfig?.[iD]??null:null}function p3(n){return n.loadingBlockConfig?.[o3]??null}function sD(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let r of e)t.add(r);return n.length===t.size?n:Array.from(t)}function g3(n,e){let t=e.primaryTmplIndex+Qe;return As(n,t)}var m3=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,r,i,o){if(!this.cachedInjectors.has(t)){let s=i.length>0?Ya(i,r,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=te({token:n,providedIn:"environment",factory:()=>new n})}return n})();var F1=new ne("");function dv(n,e,t){return n.get(m3).getOrCreateInjector(e,n,t,"")}function y3(n,e,t){if(n instanceof Ua){let i=n.injector,o=n.parentInjector,s=dv(o,e,t);return new Ua(i,s)}let r=n.get(xt);if(r!==n){let i=dv(r,e,t);return new Ua(n,i)}return dv(n,e,t)}function Ns(n,e,t,r=!1){let i=t[Rt],o=i[he];if(Mo(i))return;let s=Ja(i,e),a=s[au],c=s[l3];if(!(c!==null&&n<c)&&aD(a,n)&&aD(s[s3]??-1,n)){let u=cu(o,e),f=!r&&!0&&(p3(u)!==null||oD(u,Ht.Loading)!==null||oD(u,Ht.Placeholder))?E3:_3;try{f(n,s,t,e,i)}catch(g){v_(i,g)}}}function v3(n,e){let t=n[Ir]?.findIndex(i=>i.data[YD]===e[au])??-1;return{dehydratedView:t>-1?n[Ir][t]:null,dehydratedViewIx:t}}function _3(n,e,t,r,i){Je(ze.DeferBlockStateStart);let o=f3(n,i,r);if(o!==null){e[au]=n;let s=i[he],a=o+Qe,c=As(s,a),u=0;b_(t,u);let d;if(n===Ht.Complete){let S=cu(s,r),M=S.providers;M&&M.length>0&&(d=y3(i[$n],S,M))}let{dehydratedView:f,dehydratedViewIx:g}=v3(t,e),m=iu(i,c,null,{injector:d,dehydratedView:f});if(ou(t,m,u,$a(c,f)),Kf(m,2),g>-1&&t[Ir]?.splice(g,1),(n===Ht.Complete||n===Ht.Error)&&Array.isArray(e[Ba])){for(let S of e[Ba])S();e[Ba]=null}}Je(ze.DeferBlockStateEnd)}function aD(n,e){return n<e}function cD(n,e,t){n.loadingPromise.then(()=>{n.loadingState===Qn.COMPLETE?Ns(Ht.Complete,e,t):n.loadingState===Qn.FAILED&&Ns(Ht.Error,e,t)})}var E3=null;var rp=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var A_=new ne("");function Oo(n){return!!n&&typeof n.then=="function"}function M_(n){return!!n&&typeof n.subscribe=="function"}var L1=new ne("");var R_=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=j(L1,{optional:!0})??[];injector=j(kn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=dn(this.injector,i);if(Oo(o))t.push(o);else if(M_(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Fo=new ne("");function V1(){Ny(()=>{let n="";throw new ee(600,n)})}function U1(n){return n.isBoundToModule}var b3=10;var Fn=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=j(Kn);afterRenderManager=j(f_);zonelessEnabled=j(Hl);rootEffectScheduler=j(rv);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Vt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=j(ei);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(wt(t=>!t))}constructor(){j(ko,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=j(xt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=kn.NULL){return this._injector.get(xn).run(()=>{Je(ze.BootstrapComponentStart);let s=t instanceof ep;if(!this._injector.get(R_).done){let S="";throw new ee(405,S)}let c;s?c=t:c=this._injector.get(su).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let u=U1(c)?void 0:this._injector.get(Ls),d=r||c.selector,f=c.create(i,[],d,u),g=f.location.nativeElement,m=f.injector.get(A_,null);return m?.registerApplication(g),f.onDestroy(()=>{this.detachView(f.hostView),zl(this.components,f),m?.unregisterApplication(g)}),this._loadComponent(f),Je(ze.BootstrapComponentEnd,f),f})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Je(ze.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(Gf.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw Je(ze.ChangeDetectionEnd),new ee(101,!1);let t=Se(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Se(t),this.afterTick.next(),Je(ze.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Fs,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<b3;){Je(ze.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{Je(ze.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!Ul(i))continue;let o=r&&!this.zonelessEnabled?0:1;Zx(i,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Ul(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;zl(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(Fo,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>zl(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ee(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function zl(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function N_(){let n,e;return{promise:new Promise((r,i)=>{n=r,e=i}),resolve:n,reject:e}}function B1(n,e,t){let r=e[$n],i=e[he];if(n.loadingState!==Qn.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=Ja(e,t),s=g3(i,n);n.loadingState=Qn.IN_PROGRESS,hf(1,o);let a=n.dependencyResolverFn,c=r.get(tf).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(u=>{let d=!1,f=[],g=[];for(let m of u)if(m.status==="fulfilled"){let S=m.value,M=Oi(S)||Uh(S);if(M)f.push(M);else{let O=y0(S);O&&g.push(O)}}else{d=!0;break}if(d){if(n.loadingState=Qn.FAILED,n.errorTmplIndex===null){let S=new ee(-750,!1);v_(e,S)}}else{n.loadingState=Qn.COMPLETE;let m=s.tView;if(f.length>0){m.directiveRegistry=sD(m.directiveRegistry,f);let S=f.map(O=>O.type),M=zh(!1,...S);n.providers=M}g.length>0&&(m.pipeRegistry=sD(m.pipeRegistry,g))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,c()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=Qn.COMPLETE,c()}),n.loadingPromise)}function w3(n,e){return e[$n].get(F1,null,{optional:!0})?.behavior!==x_.Manual}function I3(n,e,t){let r=e[he],i=e[t.index];if(!w3(n,e))return;let o=Ja(e,t),s=cu(r,t);switch(d3(o),s.loadingState){case Qn.NOT_STARTED:Ns(Ht.Loading,t,i),B1(s,e,t),s.loadingState===Qn.IN_PROGRESS&&cD(s,t,i);break;case Qn.IN_PROGRESS:Ns(Ht.Loading,t,i),cD(s,t,i);break;case Qn.COMPLETE:Ns(Ht.Complete,t,i);break;case Qn.FAILED:Ns(Ht.Error,t,i);break;default:}}async function j1(n,e,t){let r=n.get(Vf);if(r.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=bL(e,n);if(s.length===0)return;o!==null&&s.shift(),C3(r,s),o!==null&&await o;let a=s[0];r.has(a)?await lD(n,s,t):r.awaitParentBlock(a,async()=>await lD(n,s,t))}async function lD(n,e,t){let r=n.get(Vf),i=r.hydrating,o=n.get(ei),s=o.add();for(let c=0;c<e.length;c++){let u=e[c],d=r.get(u);if(d!=null){if(await x3(d),await D3(n),T3(d)){t4(d),uD(e.slice(c),r);break}i.get(u).resolve()}else{S3(c,e,r),uD(e.slice(c),r);break}}let a=e[e.length-1];await i.get(a)?.promise,o.remove(s),t&&t(e),n4(r.get(a),e,r,n.get(Fn))}function T3(n){return Ja(n.lView,n.tNode)[au]===Ht.Error}function S3(n,e,t){let r=n-1,i=r>-1?t.get(e[r]):null;i&&Xf(i.lContainer)}function uD(n,e){let t=e.hydrating;for(let r in n)t.get(r)?.reject();e.cleanup(n)}function C3(n,e){for(let t of e)n.hydrating.set(t,N_())}function D3(n){return new Promise(e=>ru(e,{injector:n}))}async function x3(n){let{tNode:e,lView:t}=n,r=Ja(t,e);return new Promise(i=>{A3(r,i),I3(2,t,e)})}function A3(n,e){Array.isArray(n[Ba])||(n[Ba]=[]),n[Ba].push(e)}function Lo(n,e,t,r){let i=Ce(),o=Rs();if(cr(i,o,e)){let s=Pt(),a=Q0();IV(a,i,n,e,t,r)}return Lo}var QZ=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var Lv=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),o=this.detach(i);if(i-r>1){let s=this.detach(r);this.attach(r,o),this.attach(i,s)}else this.attach(r,o)}move(e,t){this.attach(t,this.detach(e))}};function hv(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function M3(n,e,t,r){let i,o,s=0,a=n.length-1,c=void 0;if(Array.isArray(e)){Se(r);let u=e.length-1;for(Se(null);s<=a&&s<=u;){let d=n.at(s),f=e[s],g=hv(s,d,s,f,t);if(g!==0){g<0&&n.updateValue(s,f),s++;continue}let m=n.at(a),S=e[u],M=hv(a,m,u,S,t);if(M!==0){M<0&&n.updateValue(a,S),a--,u--;continue}let O=t(s,d),P=t(a,m),q=t(s,f);if(Object.is(q,P)){let $=t(u,S);Object.is($,O)?(n.swap(s,a),n.updateValue(a,S),u--,a--):n.move(a,s),n.updateValue(s,f),s++;continue}if(i??=new Rf,o??=hD(n,s,a,t),Vv(n,i,s,q))n.updateValue(s,f),s++,a++;else if(o.has(q))i.set(O,n.detach(s)),a--;else{let $=n.create(s,e[s]);n.attach(s,$),s++,a++}}for(;s<=u;)dD(n,i,t,s,e[s]),s++}else if(e!=null){Se(r);let u=e[Symbol.iterator]();Se(null);let d=u.next();for(;!d.done&&s<=a;){let f=n.at(s),g=d.value,m=hv(s,f,s,g,t);if(m!==0)m<0&&n.updateValue(s,g),s++,d=u.next();else{i??=new Rf,o??=hD(n,s,a,t);let S=t(s,g);if(Vv(n,i,s,S))n.updateValue(s,g),s++,a++,d=u.next();else if(!o.has(S))n.attach(s,n.create(s,g)),s++,a++,d=u.next();else{let M=t(s,f);i.set(M,n.detach(s)),a--}}}for(;!d.done;)dD(n,i,t,n.length,d.value),d=u.next()}for(;s<=a;)n.destroy(n.detach(a--));i?.forEach(u=>{n.destroy(u)})}function Vv(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function dD(n,e,t,r,i){if(Vv(n,e,r,t(r,i)))n.updateValue(r,i);else{let o=n.create(r,i);n.attach(r,o)}}function hD(n,e,t,r){let i=new Set;for(let o=e;o<=t;o++)i.add(r(o,n.at(o)));return i}var Rf=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function _e(n,e,t,r,i,o,s,a){Yn("NgControlFlow");let c=Ce(),u=Pt(),d=sr(u.consts,o);return Mf(c,u,n,e,t,r,i,d,256,s,a),P_}function P_(n,e,t,r,i,o,s,a){Yn("NgControlFlow");let c=Ce(),u=Pt(),d=sr(u.consts,o);return Mf(c,u,n,e,t,r,i,d,512,s,a),P_}function Ee(n,e){Yn("NgControlFlow");let t=Ce(),r=Rs(),i=t[r]!==Zt?t[r]:-1,o=i!==-1?Nf(t,Qe+i):void 0,s=0;if(cr(t,r,n)){let a=Se(null);try{if(o!==void 0&&b_(o,s),n!==-1){let c=Qe+n,u=Nf(t,c),d=Hv(t[he],c),f=u1(u,d,t),g=iu(t,d,e,{dehydratedView:f});ou(u,g,s,$a(d,f))}}finally{Se(a)}}else if(o!==void 0){let a=r1(o,s);a!==void 0&&(a[Nt]=e)}}var Uv=class{lContainer;$implicit;$index;constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-St}};function k_(n){return n}function ai(n,e){return e}var Bv=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function yn(n,e,t,r,i,o,s,a,c,u,d,f,g){Yn("NgControlFlow");let m=Ce(),S=Pt(),M=c!==void 0,O=Ce(),P=a?s.bind(O[Mn][Nt]):s,q=new Bv(M,P);O[Qe+n]=q,Mf(m,S,n+1,e,t,r,i,sr(S.consts,o),256),M&&Mf(m,S,n+2,c,u,d,f,sr(S.consts,g),512)}var jv=class extends Lv{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r}get length(){return this.lContainer.length-St}at(e){return this.getLView(e)[Nt].$implicit}attach(e,t){let r=t[On];this.needsIndexUpdate||=e!==this.length,ou(this.lContainer,t,e,$a(this.templateTNode,r)),R3(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,N3(this.lContainer,e),P3(this.lContainer,e)}create(e,t){let r=Tf(this.lContainer,this.templateTNode.tView.ssrId);return iu(this.hostLView,this.templateTNode,new Uv(this.lContainer,t,e),{dehydratedView:r})}destroy(e){zf(e[he],e)}updateValue(e,t){this.getLView(e)[Nt].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Nt].$index=e}getLView(e){return k3(this.lContainer,e)}};function vn(n){let e=Se(null),t=ar();try{let r=Ce(),i=r[he],o=r[t],s=t+1,a=Nf(r,s);if(o.liveCollection===void 0){let u=Hv(i,s);o.liveCollection=new jv(a,r,u)}else o.liveCollection.reset();let c=o.liveCollection;if(M3(c,n,o.trackByFn,e),c.updateIndexes(),o.hasEmptyBlock){let u=Rs(),d=c.length===0;if(cr(r,u,d)){let f=t+2,g=Nf(r,f);if(d){let m=Hv(i,f),S=u1(g,m,r),M=iu(r,m,void 0,{dehydratedView:S});ou(g,M,0,$a(m,S))}else i.firstUpdatePass&&Zf(g),b_(g,0)}}}finally{Se(e)}}function Nf(n,e){return n[e]}function R3(n,e){if(n.length<=St)return;let t=St+e,r=n[t],i=r?r[Cs]:void 0;if(r&&i&&i.detachedLeaveAnimationFns&&i.detachedLeaveAnimationFns.length>0){let o=r[$n];JL(o,i),Os.delete(r[Fi]),i.detachedLeaveAnimationFns=void 0}}function N3(n,e){if(n.length<=St)return;let t=St+e,r=n[t],i=r?r[Cs]:void 0;i&&i.leave&&i.leave.size>0&&(i.detachedLeaveAnimationFns=[])}function P3(n,e){return Ql(n,e)}function k3(n,e){return r1(n,e)}function Hv(n,e){return As(n,e)}function $e(n,e,t){let r=Ce(),i=Rs();if(cr(r,i,e)){let o=Pt(),s=Q0();yV(s,r,n,e,r[st],t)}return $e}function $v(n,e,t,r,i){__(e,n,t,i?"class":"style",r)}function v(n,e,t,r){let i=Ce(),o=i[he],s=n+Qe,a=o.firstCreatePass?m1(s,i,2,e,Gx,F0(),t,r):o.data[s];if(zx(a,i,n,e,O_),Fl(a)){let c=i[he];y_(c,i,a),Ex(c,a,i)}return r!=null&&Wf(i,a),v}function E(){let n=Pt(),e=mn(),t=qx(e);return n.firstCreatePass&&y1(n,t),V0(t)&&U0(),O0(),t.classesWithoutHost!=null&&$F(t)&&$v(n,t,Ce(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&GF(t)&&$v(n,t,Ce(),t.stylesWithoutHost,!1),E}function Q(n,e,t,r){return v(n,e,t,r),E(),Q}function Y(n,e,t,r){let i=Ce(),o=i[he],s=n+Qe,a=o.firstCreatePass?y4(s,o,2,e,t,r):o.data[s];return zx(a,i,n,e,O_),r!=null&&Wf(i,a),Y}function J(){let n=mn(),e=qx(n);return V0(e)&&U0(),O0(),J}function lr(n,e,t,r){return Y(n,e,t,r),J(),lr}var O_=(n,e,t,r,i)=>(Vi(!0),o_(e[st],r,Y0()));function O3(n,e,t,r,i){let o=!jf(e,t);if(Vi(o),o)return o_(e[st],r,Y0());let s=e[On],a=Yf(s,n,e,t);return mx(s,i)&&Bf(s,i,a.nextSibling),s&&(OD(t)||FD(a))&&Li(t)&&(gC(t),Sx(a)),a}function H1(){O_=O3}var F3=(n,e,t,r,i)=>(Vi(!0),Ix(e[st],""));function L3(n,e,t,r,i){let o,s=!jf(e,t);if(Vi(s),s)return Ix(e[st],"");let a=e[On],c=Yf(a,n,e,t),u=_L(a,i);return Bf(a,i,c),o=Jf(u,c),o}function $1(){F3=L3}function _t(){return Ce()}var $l=void 0;function V3(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var U3=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],$l,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],$l,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",$l,$l,$l],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",V3],fv={};function Jn(n){let e=B3(n),t=fD(e);if(t)return t;let r=e.split("-")[0];if(t=fD(r),t)return t;if(r==="en")return U3;throw new ee(701,!1)}function fD(n){return n in fv||(fv[n]=qr.ng&&qr.ng.common&&qr.ng.common.locales&&qr.ng.common.locales[n]),fv[n]}var kt=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(kt||{});function B3(n){return n.toLowerCase().replace(/_/g,"-")}var lu="en-US";var j3=lu;function G1(n){typeof n=="string"&&(j3=n.toLowerCase().replace(/_/g,"-"))}function se(n,e,t){let r=Ce(),i=Pt(),o=mn();return H3(i,r,r[st],o,n,e,t),se}function Ar(n,e,t){let r=Ce(),i=Pt(),o=mn();return(o.type&3||t)&&E1(o,i,r,t,r[st],n,e,df(o,r,e)),Ar}function H3(n,e,t,r,i,o,s){let a=!0,c=null;if((r.type&3||s)&&(c??=df(r,e,o),E1(r,n,e,s,t,i,o,c)&&(a=!1)),a){let u=r.outputs?.[i],d=r.hostDirectiveOutputs?.[i];if(d&&d.length)for(let f=0;f<d.length;f+=2){let g=d[f],m=d[f+1];c??=df(r,e,o),eD(r,e,g,m,i,c)}if(u&&u.length)for(let f of u)c??=df(r,e,o),eD(r,e,f,i,i,c)}}function V(n=1){return CC(n)}function ip(n,e,t){return H4(n,e,t),ip}function op(n){let e=Ce(),t=Pt(),r=q0();Yh(r+1);let i=D_(t,r);if(n.dirty&&cC(e)===((i.metadata.flags&2)===2)){if(i.matches===null)n.reset([]);else{let o=z4(e,r);n.reset(o,rL),n.notifyOnChanges()}return!0}return!1}function sp(){return B4(Ce(),q0())}function uu(n){let e=H0();return Ll(e,Qe+n)}function of(n,e){return n<<17|e<<2}function Vs(n){return n>>17&32767}function $3(n){return(n&2)==2}function G3(n,e){return n&131071|e<<17}function Gv(n){return n|2}function za(n){return(n&131068)>>2}function pv(n,e){return n&-131069|e<<2}function z3(n){return(n&1)===1}function zv(n){return n|1}function q3(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=Vs(s),c=za(s);n[r]=t;let u=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||Pa(f,d)>0)&&(u=!0)}else d=t;if(i)if(c!==0){let g=Vs(n[a+1]);n[r+1]=of(g,a),g!==0&&(n[g+1]=pv(n[g+1],r)),n[a+1]=G3(n[a+1],r)}else n[r+1]=of(a,0),a!==0&&(n[a+1]=pv(n[a+1],r)),a=r;else n[r+1]=of(c,0),a===0?a=r:n[c+1]=pv(n[c+1],r),c=r;u&&(n[r+1]=Gv(n[r+1])),pD(n,d,r,!0),pD(n,d,r,!1),W3(e,d,n,r,o),s=of(a,c),o?e.classBindings=s:e.styleBindings=s}function W3(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Pa(o,e)>=0&&(t[r+1]=zv(t[r+1]))}function pD(n,e,t,r){let i=n[t+1],o=e===null,s=r?Vs(i):za(i),a=!1;for(;s!==0&&(a===!1||o);){let c=n[s],u=n[s+1];K3(c,e)&&(a=!0,n[s+1]=r?zv(u):Gv(u)),s=r?Vs(u):za(u)}a&&(n[t+1]=r?Gv(i):zv(i))}function K3(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Pa(n,e)>=0:!1}var Cr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Q3(n){return n.substring(Cr.key,Cr.keyEnd)}function Y3(n){return J3(n),z1(n,q1(n,0,Cr.textEnd))}function z1(n,e){let t=Cr.textEnd;return t===e?-1:(e=Cr.keyEnd=Z3(n,Cr.key=e,t),q1(n,e,t))}function J3(n){Cr.key=0,Cr.keyEnd=0,Cr.value=0,Cr.valueEnd=0,Cr.textEnd=n.length}function q1(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Z3(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function at(n,e,t){return W1(n,e,t,!1),at}function Le(n,e){return W1(n,e,null,!0),Le}function F_(n){eU(sU,X3,n,!0)}function X3(n,e){for(let t=Y3(e);t>=0;t=z1(e,t))$h(n,Q3(e),!0)}function W1(n,e,t,r){let i=Ce(),o=Pt(),s=jl(2);if(o.firstUpdatePass&&Q1(o,n,s,r),e!==Zt&&cr(i,s,e)){let a=o.data[ar()];Y1(o,a,i,i[st],n,i[s+1]=cU(e,t),r,s)}}function eU(n,e,t,r){let i=Pt(),o=jl(2);i.firstUpdatePass&&Q1(i,null,o,r);let s=Ce();if(t!==Zt&&cr(s,o,t)){let a=i.data[ar()];if(J1(a,r)&&!K1(i,o)){let c=r?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(t=Lh(c,t||"")),$v(i,a,s,t,r)}else aU(i,a,s,s[st],s[o+1],s[o+1]=oU(n,e,t),r,o)}}function K1(n,e){return e>=n.expandoStartIndex}function Q1(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[ar()],s=K1(n,t);J1(o,r)&&e===null&&!s&&(e=!1),e=tU(i,o,e,r),q3(i,o,e,t,s,r)}}function tU(n,e,t,r){let i=wC(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=gv(null,n,e,t,r),t=Jl(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=gv(i,n,e,t,r),o===null){let c=nU(n,e,r);c!==void 0&&Array.isArray(c)&&(c=gv(null,n,e,c[1],r),c=Jl(c,e.attrs,r),rU(n,e,r,c))}else o=iU(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function nU(n,e,t){let r=t?e.classBindings:e.styleBindings;if(za(r)!==0)return n[Vs(r)]}function rU(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Vs(i)]=r}function iU(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=Jl(r,s,t)}return Jl(r,e.attrs,t)}function gv(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=Jl(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Jl(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),$h(n,s,t?!0:e[++o]))}return n===void 0?null:n}function oU(n,e,t){if(t==null||t==="")return Dn;let r=[],i=Ka(t);if(Array.isArray(i))for(let o=0;o<i.length;o++)n(r,i[o],!0);else if(i instanceof Set)for(let o of i)n(r,o,!0);else if(typeof i=="object")for(let o in i)i.hasOwnProperty(o)&&n(r,o,i[o]);else typeof i=="string"&&e(r,i);return r}function sU(n,e,t){let r=String(e);r!==""&&!r.includes(" ")&&$h(n,r,t)}function aU(n,e,t,r,i,o,s,a){i===Zt&&(i=Dn);let c=0,u=0,d=0<i.length?i[0]:null,f=0<o.length?o[0]:null;for(;d!==null||f!==null;){let g=c<i.length?i[c+1]:void 0,m=u<o.length?o[u+1]:void 0,S=null,M;d===f?(c+=2,u+=2,g!==m&&(S=f,M=m)):f===null||d!==null&&d<f?(c+=2,S=d):(u+=2,S=f,M=m),S!==null&&Y1(n,e,t,r,S,M,s,a),d=c<i.length?i[c]:null,f=u<o.length?o[u]:null}}function Y1(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let c=n.data,u=c[a+1],d=z3(u)?gD(c,e,t,i,za(u),s):void 0;if(!Pf(d)){Pf(o)||$3(u)&&(o=gD(c,null,t,i,a,s));let f=A0(ar(),t);hV(r,s,f,i,o)}}function gD(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let c=n[i],u=Array.isArray(c),d=u?c[1]:c,f=d===null,g=t[i+1];g===Zt&&(g=f?Dn:void 0);let m=f?Gh(g,r):d===r?g:void 0;if(u&&!Pf(m)&&(m=Gh(c,r)),Pf(m)&&(a=m,s))return a;let S=n[i+1];i=s?Vs(S):za(S)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=Gh(c,r))}return a}function Pf(n){return n!==void 0}function cU(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Pi(Ka(n)))),n}function J1(n,e){return(n.flags&(e?8:16))!==0}function b(n,e=""){let t=Ce(),r=Pt(),i=n+Qe,o=r.firstCreatePass?Qa(r,i,1,e,null):r.data[i],s=Z1(r,t,o,e,n);t[i]=s,Xh()&&g_(r,t,s,o),Ms(o,!1)}var Z1=(n,e,t,r,i)=>(Vi(!0),wx(e[st],r));function lU(n,e,t,r,i){let o=!jf(e,t);if(Vi(o),o)return wx(e[st],r);let s=e[On];return Yf(s,n,e,t)}function X1(){Z1=lU}function uU(n,e,t,r=""){return cr(n,Rs(),t)?e+wr(t)+r:Zt}function dU(n,e,t,r,i,o=""){let s=z0(),a=S_(n,s,t,i);return jl(2),a?e+wr(t)+r+wr(i)+o:Zt}function hU(n,e,t,r,i,o,s,a=""){let c=z0(),u=_4(n,c,t,i,s);return jl(3),u?e+wr(t)+r+wr(i)+o+wr(s)+a:Zt}function z(n){return de("",n),z}function de(n,e,t){let r=Ce(),i=uU(r,n,e,t);return i!==Zt&&L_(r,ar(),i),de}function _n(n,e,t,r,i){let o=Ce(),s=dU(o,n,e,t,r,i);return s!==Zt&&L_(o,ar(),s),_n}function Za(n,e,t,r,i,o,s){let a=Ce(),c=hU(a,n,e,t,r,i,o,s);return c!==Zt&&L_(a,ar(),c),Za}function L_(n,e,t){let r=A0(e,n);xL(n[st],r,t)}var eA={};function ap(n){Yn("NgLet");let e=Pt(),t=Ce(),r=n+Qe,i=Qa(e,r,128,null,null);return Ms(i,!1),Vl(e,t,r,eA),ap}function V_(n){let e=Pt(),t=Ce(),r=ar();return Vl(e,t,r,n),n}function U_(n){let e=H0(),t=Ll(e,Qe+n);if(t===eA)throw new ee(314,!1);return t}function B_(n){return cr(Ce(),Rs(),n)?wr(n):Zt}function mD(n,e,t){let r=Pt();r.firstCreatePass&&tA(e,r.data,r.blueprint,Xr(n),t)}function tA(n,e,t,r,i){if(n=un(n),Array.isArray(n))for(let o=0;o<n.length;o++)tA(n[o],e,t,r,i);else{let o=Pt(),s=Ce(),a=mn(),c=Es(n)?n:un(n.provide),u=T0(n),d=a.providerIndexes&1048575,f=a.directiveStart,g=a.providerIndexes>>20;if(Es(n)||!n.multi){let m=new ks(u,i,ge,null),S=yv(c,e,i?d:d+g,f);S===-1?(_v(yf(a,s),o,c),mv(o,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(m),s.push(m)):(t[S]=m,s[S]=m)}else{let m=yv(c,e,d+g,f),S=yv(c,e,d,d+g),M=m>=0&&t[m],O=S>=0&&t[S];if(i&&!O||!i&&!M){_v(yf(a,s),o,c);let P=gU(i?pU:fU,t.length,i,r,u,n);!i&&O&&(t[S].providerFactory=P),mv(o,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(P),s.push(P)}else{let P=nA(t[i?S:m],u,!i&&r);mv(o,n,m>-1?m:S,P)}!i&&r&&O&&t[S].componentProviders++}}}function mv(n,e,t,r){let i=Es(e),o=iC(e);if(i||o){let c=(o?un(e.useClass):e).prototype.ngOnDestroy;if(c){let u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=u.indexOf(t);d===-1?u.push(t,[r,c]):u[d+1].push(r,c)}else u.push(t,c)}}}function nA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function yv(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function fU(n,e,t,r,i){return qv(this.multi,[])}function pU(n,e,t,r,i){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=ql(r,r[he],this.providerFactory.index,i);s=c.slice(0,a),qv(o,s);for(let u=a;u<c.length;u++)s.push(c[u])}else s=[],qv(o,s);return s}function qv(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function gU(n,e,t,r,i,o){let s=new ks(n,t,ge,null);return s.multi=[],s.index=e,s.componentProviders=0,nA(s,i,r&&!t),s}function du(n,e){return t=>{t.providersResolver=(r,i)=>mD(r,i?i(n):n,!1),e&&(t.viewProvidersResolver=(r,i)=>mD(r,i?i(e):e,!0))}}function js(n,e){let t=Bl()+n,r=Ce();return r[t]===Zt?T_(r,t,e()):v4(r,t)}function rt(n,e,t,r){return iA(Ce(),Bl(),n,e,t,r)}function rA(n,e){let t=n[e];return t===Zt?void 0:t}function mU(n,e,t,r,i,o){let s=e+t;return cr(n,s,i)?T_(n,s+1,o?r.call(o,i):r(i)):rA(n,s+1)}function iA(n,e,t,r,i,o,s){let a=e+t;return S_(n,a,i,o)?T_(n,a+2,s?r.call(s,i,o):r(i,o)):rA(n,a+2)}function Hs(n,e){let t=Pt(),r,i=n+Qe;t.firstCreatePass?(r=yU(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=To(r.type,!0)),s,a=Cn(ge);try{let c=mf(!1),u=o();return mf(c),Vl(t,Ce(),i,u),u}finally{Cn(a)}}function yU(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function j_(n,e,t){let r=n+Qe,i=Ce(),o=Ll(i,r);return oA(i,r)?mU(i,Bl(),e,o.transform,t,o):o.transform(t)}function Xa(n,e,t,r){let i=n+Qe,o=Ce(),s=Ll(o,i);return oA(o,i)?iA(o,Bl(),e,s.transform,t,r,s):s.transform(t,r)}function oA(n,e){return n[he].data[e].pure}function H_(n,e){return Qf(n,e)}var kf=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},$_=(()=>{class n{compileModuleSync(t){return new Af(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=m0(t),o=Mx(i.declarations).reduce((s,a)=>{let c=Oi(a);return c&&s.push(new Ga(c)),s},[]);return new kf(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var sA=(()=>{class n{applicationErrorHandler=j(Kn);appRef=j(Fn);taskService=j(ei);ngZone=j(xn);zonelessEnabled=j(Hl);tracing=j(ko,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new an;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(xl):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(j(nv,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?MC:Z0;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(xl+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.applicationErrorHandler(r)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function aA(){return[{provide:Co,useExisting:sA},{provide:xn,useClass:Al},{provide:Hl,useValue:!0}]}function vU(){return typeof $localize<"u"&&$localize.locale||lu}var hu=new ne("",{factory:()=>j(hu,{optional:!0,skipSelf:!0})||vU()});function Mr(n,e){return oh(n,e?.equal)}var K_={JSACTION:"__jsaction",OWNER:"__owner"},dA={};function _U(n){return n[K_.JSACTION]}function cA(n,e){n[K_.JSACTION]=e}function EU(n){return dA[n]}function bU(n,e){dA[n]=e}var we={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},wU=[we.MOUSEENTER,we.MOUSELEAVE,"pointerenter","pointerleave"],tX=[we.CLICK,we.DBLCLICK,we.FOCUSIN,we.FOCUSOUT,we.KEYDOWN,we.KEYUP,we.KEYPRESS,we.MOUSEOVER,we.MOUSEOUT,we.SUBMIT,we.TOUCHSTART,we.TOUCHEND,we.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],IU=[we.FOCUS,we.BLUR,we.ERROR,we.LOAD,we.TOGGLE],Q_=n=>IU.indexOf(n)>=0;function TU(n){return n===we.MOUSEENTER?we.MOUSEOVER:n===we.MOUSELEAVE?we.MOUSEOUT:n===we.POINTERENTER?we.POINTEROVER:n===we.POINTERLEAVE?we.POINTEROUT:n}function SU(n,e,t,r){let i=!1;Q_(e)&&(i=!0);let o=typeof r=="boolean"?{capture:i,passive:r}:i;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:i,passive:r}}function CU(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function DU(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var lA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function xU(n){return n.which===2||n.which==null&&n.button===4}function AU(n){return lA&&n.metaKey||!lA&&n.ctrlKey||xU(n)||n.shiftKey}function MU(n,e,t){let r=n.relatedTarget;return(n.type===we.MOUSEOVER&&e===we.MOUSEENTER||n.type===we.MOUSEOUT&&e===we.MOUSELEAVE||n.type===we.POINTEROVER&&e===we.POINTERENTER||n.type===we.POINTEROUT&&e===we.POINTERLEAVE)&&(!r||r!==t&&!t.contains(r))}function RU(n,e){let t={};for(let r in n){if(r==="srcElement"||r==="target")continue;let i=r,o=n[i];typeof o!="function"&&(t[i]=o)}return n.type===we.MOUSEOVER?t.type=we.MOUSEENTER:n.type===we.MOUSEOUT?t.type=we.MOUSELEAVE:n.type===we.POINTEROVER?t.type=we.POINTERENTER:t.type=we.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var NU=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),dp=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,r){NU&&(this.element.style.cursor="pointer"),this.handlerInfos.push(SU(this.element,e,t(this.element),r))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)CU(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},PU={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function Vo(n){return n.eventType}function Y_(n,e){n.eventType=e}function lp(n){return n.event}function hA(n,e){n.event=e}function fA(n){return n.targetElement}function pA(n,e){n.targetElement=e}function gA(n){return n.eic}function kU(n,e){n.eic=e}function OU(n){return n.timeStamp}function FU(n,e){n.timeStamp=e}function up(n){return n.eia}function mA(n,e,t){n.eia=[e,t]}function G_(n){n.eia=void 0}function cp(n){return n[1]}function LU(n){return n.eirp}function yA(n,e){n.eirp=e}function vA(n){return n.eir}function _A(n,e){n.eir=e}function EA(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function VU(n,e,t,r,i,o,s,a){return{eventType:n,event:e,targetElement:t,eic:r,timeStamp:i,eia:o,eirp:s,eiack:a}}var z_=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return Vo(this.eventInfo)}setEventType(e){Y_(this.eventInfo,e)}getEvent(){return lp(this.eventInfo)}setEvent(e){hA(this.eventInfo,e)}getTargetElement(){return fA(this.eventInfo)}setTargetElement(e){pA(this.eventInfo,e)}getContainer(){return gA(this.eventInfo)}setContainer(e){kU(this.eventInfo,e)}getTimestamp(){return OU(this.eventInfo)}setTimestamp(e){FU(this.eventInfo,e)}getAction(){let e=up(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){G_(this.eventInfo);return}mA(this.eventInfo,e.name,e.element)}getIsReplay(){return LU(this.eventInfo)}setIsReplay(e){yA(this.eventInfo,e)}getResolved(){return vA(this.eventInfo)}setResolved(e){_A(this.eventInfo,e)}clone(){return new n(EA(this.eventInfo))}},UU={},BU=/\s*;\s*/,jU=we.CLICK,q_=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&Vo(e)===we.CLICK&&AU(lp(e))?Y_(e,we.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){vA(e)||(this.populateAction(e,fA(e)),_A(e,!0))}resolveParentAction(e){let t=up(e),r=t&&cp(t);G_(e);let i=r&&this.getParentNode(r);i&&this.populateAction(e,i)}populateAction(e,t){let r=t;for(;r&&r!==gA(e)&&(r.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(r,e),!up(e));)r=this.getParentNode(r);let i=up(e);if(i&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(Vo(e)===we.MOUSEENTER||Vo(e)===we.MOUSELEAVE||Vo(e)===we.POINTERENTER||Vo(e)===we.POINTERLEAVE)))if(MU(lp(e),Vo(e),cp(i))){let o=RU(lp(e),cp(i));hA(e,o),pA(e,cp(i))}else G_(e)}getParentNode(e){let t=e[K_.OWNER];if(t)return t;let r=e.parentNode;return r?.nodeName==="#document-fragment"?r?.host??null:r}populateActionOnElement(e,t){let r=this.parseActions(e),i=r[Vo(t)];i!==void 0&&mA(t,i,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,r)}parseActions(e){let t=_U(e);if(!t){let r=e.getAttribute(nf.JSACTION);if(!r)t=UU,cA(e,t);else{if(t=EU(r),!t){t={};let i=r.split(BU);for(let o=0;o<i.length;o++){let s=i[o];if(!s)continue;let a=s.indexOf(PU.EVENT_ACTION_SEPARATOR),c=a!==-1,u=c?s.substr(0,a).trim():jU,d=c?s.substr(a+1).trim():s;t[u]=d}bU(r,t)}cA(e,t)}}return t}addA11yClickSupport(e,t,r){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=r}},bA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(bA||{}),W_=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:r}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=r}dispatch(e){let t=new z_(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let r=t.getAction();if(r&&HU(r.element,t)&&DU(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function HU(n,e){return n.tagName==="A"&&(e.getEventType()===we.CLICK||e.getEventType()===we.CLICKMOD)}var wA=Symbol.for("propagationStopped"),J_={REPLAY:101};var $U="`preventDefault` called during event replay.";var GU="`composedPath` called during event replay.",hp=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new q_({clickModSupport:t}),this.dispatcher=new W_(r=>{this.dispatchToDelegate(r)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&WU(e),zU(e);e.getAction();){if(KU(e),Q_(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),qU(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function zU(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),r=()=>{e[wA]=!0,t()};$s(e,"stopPropagation",r),$s(e,"stopImmediatePropagation",r)}function qU(n){return!!n.getEvent()[wA]}function WU(n){let e=n.getEvent(),t=n.getTargetElement(),r=e.preventDefault.bind(e);$s(e,"target",t),$s(e,"eventPhase",J_.REPLAY),$s(e,"preventDefault",()=>{throw r(),new Error($U+"")}),$s(e,"composedPath",()=>{throw new Error(GU+"")})}function KU(n){let e=n.getEvent(),t=n.getAction()?.element;t&&$s(e,"currentTarget",t,{configurable:!0})}function $s(n,e,t,{configurable:r=!1}={}){Object.defineProperty(n,e,{value:t,configurable:r})}function IA(n,e){n.ecrd(t=>{e.dispatch(t)},bA.I_AM_THE_JSACTION_FRAMEWORK)}function QU(n){return n?.q??[]}function YU(n){n&&(uA(n.c,n.et,n.h),uA(n.c,n.etc,n.h,!0))}function uA(n,e,t,r){for(let i=0;i<e.length;i++)n.removeEventListener(e[i],t,r)}var JU=!1,TA=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=JU;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,r,i){let o=VU(t,r,r.target,i,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){yA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,r,i){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&wU.indexOf(t)>=0)return;let o=(a,c,u)=>{this.handleEvent(a,c,u)};this.eventHandlers[t]=o;let s=TU(r||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>c=>{o(t,c,a)},i)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),YU(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let r=0;r<t.length;r++){let i=t[r],o=this.getEventTypesForBrowserEventType(i.eventType);for(let s=0;s<o.length;s++){let a=EA(i);Y_(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let r=[];return this.eventHandlers[t]&&r.push(t),this.browserEventTypeToExtraEventTypes[t]&&r.push(...this.browserEventTypeToExtraEventTypes[t]),r}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,r){this.ecrd(t,r)}ecrd(t,r){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let i=0;i<this.queuedEventInfos.length;i++)this.handleEventInfo(this.queuedEventInfos[i]);this.queuedEventInfos=null}}}return n})();function SA(n,e=window){return QU(e._ejsas?.[n])}function Z_(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var kA=Symbol("InputSignalNode#UNSET"),IB=le(F({},sh),{transformFn:void 0,applyValueToInputSignal(n,e){_l(n,e)}});function OA(n,e){let t=Object.create(IB);t.value=n,t.transformFn=e?.transform;function r(){if(ml(t),t.value===kA){let i=null;throw new ee(-950,i)}return t.value}return r[Nn]=t,r}var gp=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Xl(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function CA(n,e){return OA(n,e)}function TB(n){return OA(kA,n)}var FA=(CA.required=TB,CA);var X_=new ne(""),SB=new ne("");function fu(n){return!n.moduleRef}function CB(n){let e=fu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(xn);return t.run(()=>{fu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(Kn),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),fu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(X_);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(X_);s.add(o),n.moduleRef.onDestroy(()=>{zl(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return xB(r,t,()=>{let o=e.get(ei),s=o.add(),a=e.get(R_);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(hu,lu);if(G1(c||lu),!e.get(SB,!0))return fu(n)?e.get(Fn):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(fu(n)){let d=e.get(Fn);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return DB?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var DB;function xB(n,e,t){try{let r=t();return Oo(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var pp=null;function AB(n=[],e){return kn.create({name:e,providers:[{provide:Nl,useValue:"platform"},{provide:X_,useValue:new Set([()=>pp=null])},...n]})}function MB(n=[]){if(pp)return pp;let e=AB(n);return pp=e,V1(),RB(e),e}function RB(n){let e=n.get(Of,null);dn(n,()=>{e?.forEach(t=>t())})}function LA(){return!1}var fp=new WeakSet,DA="";function xA(n){return n.get(Xv,XD)}function VA(){let n=[{provide:Xv,useFactory:()=>{let e=!0;{let t=j(ri);e=!!window._ejsas?.[t]}return e&&Yn("NgEventReplay"),e}}];return n.push({provide:Kr,useValue:()=>{let e=j(Fn),{injector:t}=e;if(!fp.has(e)){let r=j(e_);if(xA(t)){cx();let i=t.get(ri),o=sx(i,(s,a,c)=>{s.nodeType===Node.ELEMENT_NODE&&(nx(s,a,c),rx(s,r))});e.onDestroy(o)}}},multi:!0},{provide:Fo,useFactory:()=>{let e=j(Fn),{injector:t}=e;return()=>{if(!xA(t)||fp.has(e))return;fp.add(e);let r=t.get(ri);e.onDestroy(()=>{fp.delete(e),Z_(r)}),e.whenStable().then(()=>{if(e.destroyed)return;let i=t.get(ox);NB(i,t);let o=t.get(e_);o.get(DA)?.forEach(ix),o.delete(DA);let s=i.instance;gx(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var NB=(n,e)=>{let t=e.get(ri),r=window._ejsas[t],i=n.instance=new TA(new dp(r.c));for(let a of r.et)i.addEvent(a);for(let a of r.etc)i.addEvent(a);let o=SA(t);i.replayEarlyEventInfos(o),Z_(t);let s=new hp(a=>{PB(e,a,a.currentTarget)});IA(i,s)};function PB(n,e,t){let r=(t&&t.getAttribute(tu))??"";/d\d+/.test(r)?kB(r,n,e,t):e.eventPhase===J_.REPLAY&&t_(e,t)}function kB(n,e,t,r){let i=e.get(ex);i.push({event:t,currentTarget:r}),j1(e,n,OB(i))}function OB(n){return e=>{let t=new Set(e),r=[];for(let{event:i,currentTarget:o}of n){let s=o.getAttribute(tu);t.has(s)?t_(i,o):r.push({event:i,currentTarget:o})}n.length=0,n.push(...r)}}var AA=!1;var FB=1e4;function LB(){AA||(AA=!0,hx(),H1(),X1(),$1(),k1(),D1(),l1(),$x())}function VB(n){return n.whenStable()}function UA(){let n=[{provide:eu,useFactory:()=>{let e=!0;return e=!!j(Wa,{optional:!0})?.get(n_,null),e&&Yn("NgHydration"),e}},{provide:Kr,useValue:()=>{o1(!1);let e=j(At);j(eu)&&(vx(e),LB())},multi:!0}];return n.push({provide:Zv,useFactory:()=>j(eu)},{provide:Fo,useFactory:()=>{if(j(eu)){let e=j(Fn);return()=>{VB(e).then(()=>{e.destroyed||w_(e)})}}return()=>{}},multi:!0}),Qr(n)}var $re=FB-1e3;var pu=(()=>{class n{static __NG_ELEMENT_ID__=UB}return n})();function UB(n){return BB(mn(),Ce(),(n&16)===16)}function BB(n,e,t){if(Li(n)&&!t){let r=or(n.index,e);return new No(r,r)}else if(n.type&175){let r=e[Mn];return new No(r,e)}return null}var eE=class{constructor(){}supports(e){return I_(e)}create(e){return new tE(e)}},jB=(n,e)=>e,tE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||jB}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<MA(r,i,o)?t:r,a=MA(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let u=a-i,d=c-i;if(u!=d){for(let g=0;g<u;g++){let m=g<o.length?o[g]:o[g]=0,S=m+g;d<=S&&S<u&&(o[g]=m+1)}let f=s.previousIndex;o[f]=d-u}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!I_(e))throw new ee(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,v1(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new nE(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new mp),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new mp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},nE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},rE=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},mp=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new rE,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function MA(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function RA(){return new iE([new eE])}var iE=(()=>{class n{factories;static \u0275prov=te({token:n,providedIn:"root",factory:RA});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=j(n,{optional:!0,skipSelf:!0});return n.create(t,r||RA())}}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new ee(901,!1)}}return n})();function BA(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;Je(ze.BootstrapApplicationStart);try{let o=i?.injector??MB(r),s=[aA(),NC,...t||[]],a=new Yl({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return CB({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{Je(ze.BootstrapApplicationEnd)}}function gu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var jA=null;function ur(){return jA}function oE(n){jA??=n}var mu=class{},yp=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>j(HA),providedIn:"platform"})}return n})();var HA=(()=>{class n extends yp{_location;_history;_doc=j(At);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ur().getBaseHref(this._doc)}onPopState(t){let r=ur().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=ur().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function zA(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function $A(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Uo(n){return n&&n[0]!=="?"?`?${n}`:n}var ec=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>j($B),providedIn:"root"})}return n})(),HB=new ne(""),$B=(()=>{class n extends ec{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??j(At).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return zA(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Uo(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Uo(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Uo(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(ve(yp),ve(HB,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),tc=(()=>{class n{_subject=new Vt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=qB($A(GA(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Uo(r))}normalize(t){return n.stripTrailingSlash(zB(this._basePath,GA(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Uo(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Uo(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Uo;static joinWithSlash=zA;static stripTrailingSlash=$A;static \u0275fac=function(r){return new(r||n)(ve(ec))};static \u0275prov=te({token:n,factory:()=>GB(),providedIn:"root"})}return n})();function GB(){return new tc(ve(ec))}function zB(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function GA(n){return n.replace(/\/index.html$/,"")}function qB(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var En=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(En||{}),ct=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(ct||{}),Ln=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(Ln||{}),Gi={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function QA(n){return Jn(n)[kt.LocaleId]}function YA(n,e,t){let r=Jn(n),i=[r[kt.DayPeriodsFormat],r[kt.DayPeriodsStandalone]],o=dr(i,e);return dr(o,t)}function JA(n,e,t){let r=Jn(n),i=[r[kt.DaysFormat],r[kt.DaysStandalone]],o=dr(i,e);return dr(o,t)}function ZA(n,e,t){let r=Jn(n),i=[r[kt.MonthsFormat],r[kt.MonthsStandalone]],o=dr(i,e);return dr(o,t)}function XA(n,e){let r=Jn(n)[kt.Eras];return dr(r,e)}function yu(n,e){let t=Jn(n);return dr(t[kt.DateFormat],e)}function vu(n,e){let t=Jn(n);return dr(t[kt.TimeFormat],e)}function _u(n,e){let r=Jn(n)[kt.DateTimeFormat];return dr(r,e)}function Eu(n,e){let t=Jn(n),r=t[kt.NumberSymbols][e];if(typeof r>"u"){if(e===Gi.CurrencyDecimal)return t[kt.NumberSymbols][Gi.Decimal];if(e===Gi.CurrencyGroup)return t[kt.NumberSymbols][Gi.Group]}return r}function eM(n){if(!n[kt.ExtraData])throw new ee(2303,!1)}function tM(n){let e=Jn(n);return eM(e),(e[kt.ExtraData][2]||[]).map(r=>typeof r=="string"?sE(r):[sE(r[0]),sE(r[1])])}function nM(n,e,t){let r=Jn(n);eM(r);let i=[r[kt.ExtraData][0],r[kt.ExtraData][1]],o=dr(i,e)||[];return dr(o,t)||[]}function dr(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new ee(2304,!1)}function sE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var WB=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,vp={},KB=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function rM(n,e,t,r){let i=rj(n);e=$i(t,e)||e;let s=[],a;for(;e;)if(a=KB.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let c=i.getTimezoneOffset();r&&(c=oM(r,c),i=nj(i,r));let u="";return s.forEach(d=>{let f=ej(d);u+=f?f(i,t,c):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function Ip(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function $i(n,e){let t=QA(n);if(vp[t]??={},vp[t][e])return vp[t][e];let r="";switch(e){case"shortDate":r=yu(n,Ln.Short);break;case"mediumDate":r=yu(n,Ln.Medium);break;case"longDate":r=yu(n,Ln.Long);break;case"fullDate":r=yu(n,Ln.Full);break;case"shortTime":r=vu(n,Ln.Short);break;case"mediumTime":r=vu(n,Ln.Medium);break;case"longTime":r=vu(n,Ln.Long);break;case"fullTime":r=vu(n,Ln.Full);break;case"short":let i=$i(n,"shortTime"),o=$i(n,"shortDate");r=_p(_u(n,Ln.Short),[i,o]);break;case"medium":let s=$i(n,"mediumTime"),a=$i(n,"mediumDate");r=_p(_u(n,Ln.Medium),[s,a]);break;case"long":let c=$i(n,"longTime"),u=$i(n,"longDate");r=_p(_u(n,Ln.Long),[c,u]);break;case"full":let d=$i(n,"fullTime"),f=$i(n,"fullDate");r=_p(_u(n,Ln.Full),[d,f]);break}return r&&(vp[t][e]=r),r}function _p(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function Rr(n,e,t="-",r,i){let o="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return r&&(s=s.slice(s.length-e)),o+s}function QB(n,e){return Rr(n,3).substring(0,e)}function $t(n,e,t=0,r=!1,i=!1){return function(o,s){let a=YB(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return QB(a,e);let c=Eu(s,Gi.MinusSign);return Rr(a,e,c,r,i)}}function YB(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new ee(2301,!1)}}function ft(n,e,t=En.Format,r=!1){return function(i,o){return JB(i,o,n,e,t,r)}}function JB(n,e,t,r,i,o){switch(t){case 2:return ZA(e,i,r)[n.getMonth()];case 1:return JA(e,i,r)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let u=tM(e),d=nM(e,i,r),f=u.findIndex(g=>{if(Array.isArray(g)){let[m,S]=g,M=s>=m.hours&&a>=m.minutes,O=s<S.hours||s===S.hours&&a<S.minutes;if(m.hours<S.hours){if(M&&O)return!0}else if(M||O)return!0}else if(g.hours===s&&g.minutes===a)return!0;return!1});if(f!==-1)return d[f]}return YA(e,i,r)[s<12?0:1];case 3:return XA(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new ee(2302,!1)}}function Ep(n){return function(e,t,r){let i=-1*r,o=Eu(t,Gi.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+Rr(s,2,o)+Rr(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+Rr(s,1,o);case 2:return"GMT"+(i>=0?"+":"")+Rr(s,2,o)+":"+Rr(Math.abs(i%60),2,o);case 3:return r===0?"Z":(i>=0?"+":"")+Rr(s,2,o)+":"+Rr(Math.abs(i%60),2,o);default:throw new ee(2310,!1)}}}var ZB=0,wp=4;function XB(n){let e=Ip(n,ZB,1).getDay();return Ip(n,0,1+(e<=wp?wp:wp+7)-e)}function iM(n){let e=n.getDay(),t=e===0?-3:wp-e;return Ip(n.getFullYear(),n.getMonth(),n.getDate()+t)}function aE(n,e=!1){return function(t,r){let i;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{let o=iM(t),s=XB(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return Rr(i,n,Eu(r,Gi.MinusSign))}}function bp(n,e=!1){return function(t,r){let o=iM(t).getFullYear();return Rr(o,n,Eu(r,Gi.MinusSign),e)}}var cE={};function ej(n){if(cE[n])return cE[n];let e;switch(n){case"G":case"GG":case"GGG":e=ft(3,ct.Abbreviated);break;case"GGGG":e=ft(3,ct.Wide);break;case"GGGGG":e=ft(3,ct.Narrow);break;case"y":e=$t(0,1,0,!1,!0);break;case"yy":e=$t(0,2,0,!0,!0);break;case"yyy":e=$t(0,3,0,!1,!0);break;case"yyyy":e=$t(0,4,0,!1,!0);break;case"Y":e=bp(1);break;case"YY":e=bp(2,!0);break;case"YYY":e=bp(3);break;case"YYYY":e=bp(4);break;case"M":case"L":e=$t(1,1,1);break;case"MM":case"LL":e=$t(1,2,1);break;case"MMM":e=ft(2,ct.Abbreviated);break;case"MMMM":e=ft(2,ct.Wide);break;case"MMMMM":e=ft(2,ct.Narrow);break;case"LLL":e=ft(2,ct.Abbreviated,En.Standalone);break;case"LLLL":e=ft(2,ct.Wide,En.Standalone);break;case"LLLLL":e=ft(2,ct.Narrow,En.Standalone);break;case"w":e=aE(1);break;case"ww":e=aE(2);break;case"W":e=aE(1,!0);break;case"d":e=$t(2,1);break;case"dd":e=$t(2,2);break;case"c":case"cc":e=$t(7,1);break;case"ccc":e=ft(1,ct.Abbreviated,En.Standalone);break;case"cccc":e=ft(1,ct.Wide,En.Standalone);break;case"ccccc":e=ft(1,ct.Narrow,En.Standalone);break;case"cccccc":e=ft(1,ct.Short,En.Standalone);break;case"E":case"EE":case"EEE":e=ft(1,ct.Abbreviated);break;case"EEEE":e=ft(1,ct.Wide);break;case"EEEEE":e=ft(1,ct.Narrow);break;case"EEEEEE":e=ft(1,ct.Short);break;case"a":case"aa":case"aaa":e=ft(0,ct.Abbreviated);break;case"aaaa":e=ft(0,ct.Wide);break;case"aaaaa":e=ft(0,ct.Narrow);break;case"b":case"bb":case"bbb":e=ft(0,ct.Abbreviated,En.Standalone,!0);break;case"bbbb":e=ft(0,ct.Wide,En.Standalone,!0);break;case"bbbbb":e=ft(0,ct.Narrow,En.Standalone,!0);break;case"B":case"BB":case"BBB":e=ft(0,ct.Abbreviated,En.Format,!0);break;case"BBBB":e=ft(0,ct.Wide,En.Format,!0);break;case"BBBBB":e=ft(0,ct.Narrow,En.Format,!0);break;case"h":e=$t(3,1,-12);break;case"hh":e=$t(3,2,-12);break;case"H":e=$t(3,1);break;case"HH":e=$t(3,2);break;case"m":e=$t(4,1);break;case"mm":e=$t(4,2);break;case"s":e=$t(5,1);break;case"ss":e=$t(5,2);break;case"S":e=$t(6,1);break;case"SS":e=$t(6,2);break;case"SSS":e=$t(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Ep(0);break;case"ZZZZZ":e=Ep(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Ep(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Ep(2);break;default:return null}return cE[n]=e,e}function oM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function tj(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function nj(n,e,t){let i=n.getTimezoneOffset(),o=oM(e,i);return tj(n,-1*(o-i))}function rj(n){if(qA(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,o=1,s=1]=n.split("-").map(a=>+a);return Ip(i,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(WB))return ij(r)}let e=new Date(n);if(!qA(e))throw new ee(2311,!1);return e}function ij(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,c,u),e}function qA(n){return n instanceof Date&&!isNaN(n.valueOf())}var Tp=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Cp=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Tp(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),WA(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);WA(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(ge(ji),ge(Po),ge(iE))};static \u0275dir=Xt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function WA(n,e){n.context.$implicit=e.item}var lE=(()=>{class n{_viewContainer;_context=new Sp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){KA(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){KA(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(ge(ji),ge(Po))};static \u0275dir=Xt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Sp=class{$implicit=null;ngIf=null};function KA(n,e){if(n&&!n.createEmbeddedView)throw new ee(2020,!1)}function sM(n,e){return new ee(2100,!1)}var oj=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,uE=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw sM(n,t);return t.replace(oj,r=>r[0].toUpperCase()+r.slice(1).toLowerCase())}static \u0275fac=function(r){return new(r||n)};static \u0275pipe=np({name:"titlecase",type:n,pure:!0})}return n})();var sj="mediumDate",aM=new ne(""),cM=new ne(""),bu=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,o){if(t==null||t===""||t!==t)return null;try{let s=r??this.defaultOptions?.dateFormat??sj,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return rM(t,s,o||this.locale,a)}catch(s){throw sM(n,s.message)}}static \u0275fac=function(r){return new(r||n)(ge(hu,16),ge(aM,24),ge(cM,24))};static \u0275pipe=np({name:"date",type:n,pure:!0})}return n})();var Vn=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Hi({type:n});static \u0275inj=Wr({})}return n})();function dE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var wu=class{};var hE="browser";function nc(n){return n===hE}var Iu=class{_doc;constructor(e){this._doc=e}manager},Dp=(()=>{class n extends Iu{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(ve(At))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),Mp=new ne(""),yE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(s=>{s.manager=this});let i=t.filter(s=>!(s instanceof Dp));this._plugins=i.slice().reverse();let o=t.find(s=>s instanceof Dp);o&&this._plugins.push(o)}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new ee(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(ve(Mp),ve(xn))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),pE="ng-app-id";function lM(n){for(let e of n)e.remove()}function uM(n,e){let t=e.createElement("style");return t.textContent=n,t}function aj(n,e,t,r){let i=n.head?.querySelectorAll(`style[${pE}="${e}"],link[${pE}="${e}"]`);if(i)for(let o of i)o.removeAttribute(pE),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function mE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var vE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,aj(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,uM);r?.forEach(i=>this.addUsage(i,this.external,mE))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(lM(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])lM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,uM(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,mE(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(ve(At),ve(ri),ve(Ff,8),ve(Bi))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),gE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},_E=/%COMP%/g;var hM="%COMP%",cj=`_nghost-${hM}`,lj=`_ngcontent-${hM}`,uj=!0,dj=new ne("",{factory:()=>uj});function hj(n){return lj.replace(_E,n)}function fj(n){return cj.replace(_E,n)}function fM(n,e){return e.map(t=>t.replace(_E,n))}var EE=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,r,i,o,s,a,c=null,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=c,this.tracingService=u,this.defaultRenderer=new Tu(t,s,a,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof Ap?i.applyToHost(t):i instanceof Su&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.tracingService;switch(r.encapsulation){case Dr.Emulated:o=new Ap(c,u,r,this.appId,d,s,a,f);break;case Dr.ShadowDom:return new xp(c,t,r,s,a,this.nonce,f,u);case Dr.ExperimentalIsolatedShadowDom:return new xp(c,t,r,s,a,this.nonce,f);default:o=new Su(c,u,r,d,s,a,f);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(ve(yE),ve(vE),ve(ri),ve(dj),ve(At),ve(xn),ve(Ff),ve(ko,8))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),Tu=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(gE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(dM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(dM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ee(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=gE[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=gE[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(ni.DashCase|ni.Important)?e.style.setProperty(t,r,i&ni.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&ni.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=ur().getGlobalEventTarget(this.doc,e),!e))throw new ee(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function dM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var xp=class extends Tu{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,o,s,a,c){super(e,i,o,a),this.hostEl=t,this.sharedStylesHost=c,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let u=r.styles;u=fM(r.id,u);for(let f of u){let g=document.createElement("style");s&&g.setAttribute("nonce",s),g.textContent=f,this.shadowRoot.appendChild(g)}let d=r.getExternalStyles?.();if(d)for(let f of d){let g=mE(f,i);s&&g.setAttribute("nonce",s),this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Su=class extends Tu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let u=r.styles;this.styles=c?fM(c,u):u,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Os.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Ap=class extends Su{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,c){let u=i+"-"+r.id;super(e,t,r,o,s,a,c,u),this.contentAttr=hj(u),this.hostAttr=fj(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var Rp=class n extends mu{supportsDOMEvents=!0;static makeCurrent(){oE(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=pj();return t==null?null:gj(t)}resetBaseElement(){Cu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return dE(document.cookie,e)}},Cu=null;function pj(){return Cu=Cu||document.head.querySelector("base"),Cu?Cu.getAttribute("href"):null}function gj(n){return new URL(n,document.baseURI).pathname}var mj=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),pM=["alt","control","meta","shift"],yj={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},vj={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},gM=(()=>{class n extends Iu{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ur().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),pM.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),s+=u+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=yj[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),pM.forEach(s=>{if(s!==i){let a=vj[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(ve(At))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})();async function bE(n,e,t){let r=F({rootComponent:n},_j(e,t));return BA(r)}function _j(n,e){return{platformRef:e?.platformRef,appProviders:[...Tj,...n?.providers??[]],platformProviders:Ij}}function Ej(){Rp.makeCurrent()}function bj(){return new zr}function wj(){return Qv(document),document}var Ij=[{provide:Bi,useValue:hE},{provide:Of,useValue:Ej,multi:!0},{provide:At,useFactory:wj}];var Tj=[{provide:Nl,useValue:"root"},{provide:zr,useFactory:bj},{provide:Mp,useClass:Dp,multi:!0},{provide:Mp,useClass:gM,multi:!0},EE,vE,yE,{provide:Fs,useExisting:EE},{provide:wu,useClass:mj},[]];var Du=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),o=t.slice(r+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var Sj="text/plain",Cj="application/json",koe=`${Cj}, ${Sj}, */*`;var IE=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(IE||{}),wE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,r="OK"){this.headers=e.headers||new Du,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var Np=class n extends wE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=IE.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var mM=new ne("");var Dj=new ne(""),xj="b",Aj="h",Mj="s",Rj="st",Nj="u",Pj="rt",TE=new ne(""),kj=["GET","HEAD"];function Oj(n,e){let m=j(TE),{isCacheActive:t}=m,r=Ia(m,["isCacheActive"]),{transferCache:i,method:o}=n;if(!t||i===!1||o==="POST"&&!r.includePostRequests&&!i||o!=="POST"&&!kj.includes(o)||!r.includeRequestsWithAuthHeaders&&Fj(n)||r.filter?.(n)===!1)return e(n);let s=j(Wa);if(j(Dj,{optional:!0}))throw new ee(2803,!1);let c=n.url,u=Lj(n,c),d=s.get(u,null),f=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(f=i.includeHeaders),d){let{[xj]:S,[Pj]:M,[Aj]:O,[Mj]:P,[Rj]:q,[Nj]:$}=d,ae=S;switch(M){case"arraybuffer":ae=new TextEncoder().encode(S).buffer;break;case"blob":ae=new Blob([S]);break}let be=new Du(O);return He(new Np({body:ae,headers:be,status:P,statusText:q,url:$}))}return e(n)}function Fj(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function yM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function Lj(n,e){let{params:t,method:r,responseType:i}=n,o=yM(t),s=n.serializeBody();s instanceof URLSearchParams?s=yM(s):typeof s!="string"&&(s="");let a=[r,i,e,s,o].join("|"),c=Vj(a);return c}function Vj(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function vM(n){return[{provide:TE,useFactory:()=>(Yn("NgHttpTransferCache"),F({isCacheActive:!0},n))},{provide:mM,useValue:Oj,multi:!0},{provide:Fo,multi:!0,useFactory:()=>{let e=j(Fn),t=j(TE);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var _M=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(ve(At))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Pp=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(Pp||{});function Uj(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function EM(){return Uj(Pp.EventReplay,VA())}function bM(...n){let e=[],t=new Set;for(let{\u0275providers:i,\u0275kind:o}of n)t.add(o),i.length&&e.push(i);let r=t.has(Pp.HttpTransferCacheOptions);return Qr([[],[],UA(),t.has(Pp.NoHttpTransferCache)||r?[]:vM({}),e])}var Re="primary",Uu=Symbol("RouteTitle"),AE=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ws(n){return new AE(n)}function SE(n,e,t){for(let r=0;r<n.length;r++){let i=n[r],o=e[r];if(i[0]===":")t[i.substring(1)]=o;else if(i!==o.path)return!1}return!0}function RM(n,e,t){let r=t.path.split("/"),i=r.indexOf("**");if(i===-1){if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let c={},u=n.slice(0,r.length);return SE(r,u,c)?{consumed:u,posParams:c}:null}if(i!==r.lastIndexOf("**"))return null;let o=r.slice(0,i),s=r.slice(i+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!SE(o,n.slice(0,o.length),a)||!SE(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function Up(n){return new Promise((e,t)=>{n.pipe(Mi()).subscribe({next:r=>e(r),error:r=>t(r)})})}function jj(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ci(n[t],e[t]))return!1;return!0}function ci(n,e){let t=n?ME(n):void 0,r=e?ME(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!NM(n[i],e[i]))return!1;return!0}function ME(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function NM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function Hj(n){return n.length>0?n[n.length-1]:null}function Ys(n){return Sh(n)?n:Oo(n)?Bt(Promise.resolve(n)):He(n)}function PM(n){return Sh(n)?Up(n):Promise.resolve(n)}var $j={exact:OM,subset:FM},kM={exact:Gj,subset:zj,ignored:()=>!0};function wM(n,e,t){return $j[t.paths](n.root,e.root,t.matrixParams)&&kM[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Gj(n,e){return ci(n,e)}function OM(n,e,t){if(!zs(n.segments,e.segments)||!Fp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!OM(n.children[r],e.children[r],t))return!1;return!0}function zj(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>NM(n[t],e[t]))}function FM(n,e,t){return LM(n,e,e.segments,t)}function LM(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!zs(i,t)||e.hasChildren()||!Fp(i,t,r))}else if(n.segments.length===t.length){if(!zs(n.segments,t)||!Fp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!FM(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!zs(n.segments,i)||!Fp(n.segments,i,r)||!n.children[Re]?!1:LM(n.children[Re],e,o,r)}}function Fp(n,e,t){return e.every((r,i)=>kM[t](n[i].parameters,r.parameters))}var Pr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Ze([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Ws(this.queryParams),this._queryParamMap}toString(){return Kj.serialize(this)}},Ze=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Lp(this)}},Bo=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ws(this.parameters),this._parameterMap}toString(){return UM(this)}};function qj(n,e){return zs(n,e)&&n.every((t,r)=>ci(t.parameters,e[r].parameters))}function zs(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Wj(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Re&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Re&&(t=t.concat(e(i,r)))}),t}var Bu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>new jo,providedIn:"root"})}return n})(),jo=class{parse(e){let t=new NE(e);return new Pr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${xu(e.root,!0)}`,r=Jj(e.queryParams),i=typeof e.fragment=="string"?`#${Qj(e.fragment)}`:"";return`${t}${r}${i}`}},Kj=new jo;function Lp(n){return n.segments.map(e=>UM(e)).join("/")}function xu(n,e){if(!n.hasChildren())return Lp(n);if(e){let t=n.children[Re]?xu(n.children[Re],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==Re&&r.push(`${i}:${xu(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Wj(n,(r,i)=>i===Re?[xu(n.children[Re],!1)]:[`${i}:${xu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Re]!=null?`${Lp(n)}/${t[0]}`:`${Lp(n)}/(${t.join("//")})`}}function VM(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function kp(n){return VM(n).replace(/%3B/gi,";")}function Qj(n){return encodeURI(n)}function RE(n){return VM(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vp(n){return decodeURIComponent(n)}function IM(n){return Vp(n.replace(/\+/g,"%20"))}function UM(n){return`${RE(n.path)}${Yj(n.parameters)}`}function Yj(n){return Object.entries(n).map(([e,t])=>`;${RE(e)}=${RE(t)}`).join("")}function Jj(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${kp(t)}=${kp(i)}`).join("&"):`${kp(t)}=${kp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Zj=/^[^\/()?;#]+/;function CE(n){let e=n.match(Zj);return e?e[0]:""}var Xj=/^[^\/()?;=#]+/;function e5(n){let e=n.match(Xj);return e?e[0]:""}var t5=/^[^=?&#]+/;function n5(n){let e=n.match(t5);return e?e[0]:""}var r5=/^[^&#]+/;function i5(n){let e=n.match(r5);return e?e[0]:""}var NE=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ze([],{}):new Ze([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Re]=new Ze(e,t)),r}parseSegment(){let e=CE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ee(4009,!1);return this.capture(e),new Bo(Vp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=e5(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=CE(this.remaining);i&&(r=i,this.capture(r))}e[Vp(t)]=Vp(r)}parseQueryParam(e){let t=n5(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=i5(this.remaining);s&&(r=s,this.capture(r))}let i=IM(t),o=IM(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=CE(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ee(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Re);let s=this.parseChildren();t[o??Re]=Object.keys(s).length===1&&s[Re]?s[Re]:new Ze([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ee(4011,!1)}};function BM(n){return n.segments.length>0?new Ze([],{[Re]:n}):n}function jM(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=jM(i);if(r===Re&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new Ze(n.segments,e);return o5(t)}function o5(n){if(n.numberOfChildren===1&&n.children[Re]){let e=n.children[Re];return new Ze(n.segments.concat(e.segments),e.children)}return n}function Ho(n){return n instanceof Pr}function HM(n,e,t=null,r=null,i=new jo){let o=$M(n);return GM(o,e,t,r,i)}function $M(n){let e;function t(o){let s={};for(let c of o.children){let u=t(c);s[c.outlet]=u}let a=new Ze(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=BM(r);return e??i}function GM(n,e,t,r,i){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return DE(o,o,o,t,r,i);let s=s5(e);if(s.toRoot())return DE(o,o,new Ze([],{}),t,r,i);let a=a5(s,o,n),c=a.processChildren?Mu(a.segmentGroup,a.index,s.commands):qM(a.segmentGroup,a.index,s.commands);return DE(o,a.segmentGroup,c,t,r,i)}function Bp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Pu(n){return typeof n=="object"&&n!=null&&n.outlets}function TM(n,e,t){n||="\u0275";let r=new Pr;return r.queryParams={[n]:e},t.parse(t.serialize(r)).queryParams[n]}function DE(n,e,t,r,i,o){let s={};for(let[u,d]of Object.entries(r??{}))s[u]=Array.isArray(d)?d.map(f=>TM(u,f,o)):TM(u,d,o);let a;n===e?a=t:a=zM(n,e,t);let c=BM(jM(a));return new Pr(c,s,i)}function zM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=zM(o,e,t)}),new Ze(n.segments,r)}var jp=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Bp(r[0]))throw new ee(4003,!1);let i=r.find(Pu);if(i&&i!==Hj(r))throw new ee(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function s5(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new jp(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new jp(t,e,r)}var ic=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function a5(n,e,t){if(n.isAbsolute)return new ic(e,!0,0);if(!t)return new ic(e,!1,NaN);if(t.parent===null)return new ic(t,!0,0);let r=Bp(n.commands[0])?0:1,i=t.segments.length-1+r;return c5(t,i,n.numberOfDoubleDots)}function c5(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new ee(4005,!1);i=r.segments.length}return new ic(r,!1,i-o)}function l5(n){return Pu(n[0])?n[0].outlets:{[Re]:n}}function qM(n,e,t){if(n??=new Ze([],{}),n.segments.length===0&&n.hasChildren())return Mu(n,e,t);let r=u5(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new Ze(n.segments.slice(0,r.pathIndex),{});return o.children[Re]=new Ze(n.segments.slice(r.pathIndex),n.children),Mu(o,0,i)}else return r.match&&i.length===0?new Ze(n.segments,{}):r.match&&!n.hasChildren()?PE(n,e,t):r.match?Mu(n,0,i):PE(n,e,t)}function Mu(n,e,t){if(t.length===0)return new Ze(n.segments,{});{let r=l5(t),i={};if(Object.keys(r).some(o=>o!==Re)&&n.children[Re]&&n.numberOfChildren===1&&n.children[Re].segments.length===0){let o=Mu(n.children[Re],e,t);return new Ze(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=qM(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new Ze(n.segments,i)}}function u5(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Pu(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!CM(c,u,s))return o;r+=2}else{if(!CM(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function PE(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Pu(o)){let c=d5(o.outlets);return new Ze(r,c)}if(i===0&&Bp(t[0])){let c=n.segments[e];r.push(new Bo(c.path,SM(t[0]))),i++;continue}let s=Pu(o)?o.outlets[Re]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&Bp(a)?(r.push(new Bo(s,SM(a))),i+=2):(r.push(new Bo(s,{})),i++)}return new Ze(r,{})}function d5(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=PE(new Ze([],{}),0,r))}),e}function SM(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function CM(n,e,t){return n==t.path&&ci(e,t.parameters)}var Ru="imperative",en=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(en||{}),Xn=class{id;url;constructor(e,t){this.id=e,this.url=t}},Ks=class extends Xn{type=en.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},li=class extends Xn{urlAfterRedirects;type=en.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},bn=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(bn||{}),ku=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(ku||{}),hr=class extends Xn{reason;code;type=en.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function WM(n){return n instanceof hr&&(n.code===bn.Redirect||n.code===bn.SupersededByNewNavigation)}var qi=class extends Xn{reason;code;type=en.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Qs=class extends Xn{error;target;type=en.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},sc=class extends Xn{urlAfterRedirects;state;type=en.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hp=class extends Xn{urlAfterRedirects;state;type=en.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$p=class extends Xn{urlAfterRedirects;state;shouldActivate;type=en.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Gp=class extends Xn{urlAfterRedirects;state;type=en.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zp=class extends Xn{urlAfterRedirects;state;type=en.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qp=class{route;type=en.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Wp=class{route;type=en.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Kp=class{snapshot;type=en.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Qp=class{snapshot;type=en.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yp=class{snapshot;type=en.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Jp=class{snapshot;type=en.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var ac=class{},cc=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function h5(n){return!(n instanceof ac)&&!(n instanceof cc)}var Zp=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new dc(this.rootInjector)}},dc=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Zp(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(ve(xt))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Xp=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=kE(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=kE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=OE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return OE(e,this._root).map(t=>t.value)}};function kE(n,e){if(n===e.value)return e;for(let t of e.children){let r=kE(n,t);if(r)return r}return null}function OE(n,e){if(n===e.value)return[e];for(let t of e.children){let r=OE(n,t);if(r.length)return r.unshift(e),r}return[]}var Zn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function rc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ou=class extends Xp{snapshot;constructor(e,t){super(e),this.snapshot=t,$E(this,e)}toString(){return this.snapshot.toString()}};function KM(n,e){let t=f5(n,e),r=new cn([new Bo("",{})]),i=new cn({}),o=new cn({}),s=new cn({}),a=new cn(""),c=new Wi(r,i,s,a,o,Re,n,t.root);return c.snapshot=t.root,new Ou(new Zn(c,[]),t)}function f5(n,e){let t={},r={},i={},s=new qs([],t,i,"",r,Re,n,null,{},e);return new Fu("",new Zn(s,[]))}var Wi=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(wt(u=>u[Uu]))??He(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(wt(e=>Ws(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(wt(e=>Ws(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function eg(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),i?.data),n._resolvedData)}:r={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},i&&YM(i)&&(r.resolve[Uu]=i.title),r}var qs=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[Uu]}constructor(e,t,r,i,o,s,a,c,u,d){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=u,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ws(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ws(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Fu=class extends Xp{url;constructor(e,t){super(t),this.url=e,$E(this,t)}toString(){return QM(this._root)}};function $E(n,e){e.value._routerState=n,e.children.forEach(t=>$E(n,t))}function QM(n){let e=n.children.length>0?` { ${n.children.map(QM).join(", ")} } `:"";return`${n.value}${e}`}function xE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ci(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ci(e.params,t.params)||n.paramsSubject.next(t.params),jj(e.url,t.url)||n.urlSubject.next(t.url),ci(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function FE(n,e){let t=ci(n.params,e.params)&&qj(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||FE(n.parent,e.parent))}function YM(n){return typeof n.title=="string"||n.title===null}var JM=new ne(""),ju=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Re;activateEvents=new jt;deactivateEvents=new jt;attachEvents=new jt;detachEvents=new jt;routerOutletData=FA();parentContexts=j(dc);location=j(ji);changeDetector=j(pu);inputBinder=j(ig,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ee(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ee(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ee(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ee(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new LE(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Xt({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Ui]})}return n})(),LE=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Wi?this.route:e===dc?this.childContexts:e===JM?this.outletData:this.parent.get(e,t)}},ig=new ne("");var GE=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=hn({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Q(0,"router-outlet")},dependencies:[ju],encapsulation:2})}return n})();function zE(n){let e=n.children&&n.children.map(zE),t=e?le(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Re&&(t.component=GE),t}function p5(n,e,t){let r=Lu(n,e._root,t?t._root:void 0);return new Ou(r,e)}function Lu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=g5(n,e,t);return new Zn(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Lu(n,a)),s}}let r=m5(e.value),i=e.children.map(o=>Lu(n,o));return new Zn(r,i)}}function g5(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Lu(n,r,i);return Lu(n,r)})}function m5(n){return new Wi(new cn(n.url),new cn(n.params),new cn(n.queryParams),new cn(n.fragment),new cn(n.data),n.outlet,n.component,n)}var lc=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},ZM="ngNavigationCancelingError";function tg(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ho(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=XM(!1,bn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function XM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[ZM]=!0,t.cancellationCode=e,t}function y5(n){return eR(n)&&Ho(n.url)}function eR(n){return!!n&&n[ZM]}var VE=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),xE(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=rc(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=rc(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=rc(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=rc(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Jp(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Qp(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(xE(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),xE(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},ng=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},oc=class{component;route;constructor(e,t){this.component=e,this.route=t}};function v5(n,e,t){let r=n._root,i=e?e._root:null;return Au(r,i,t,[r.value])}function _5(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function hc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!u0(n)?n:e.get(n):r}function Au(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=rc(e);return n.children.forEach(s=>{E5(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Nu(a,t.getContext(s),i)),i}function E5(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=b5(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new ng(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Au(n,e,a?a.children:null,r,i):Au(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new oc(a.outlet.component,s))}else s&&Nu(e,a,i),i.canActivateChecks.push(new ng(r)),o.component?Au(n,null,a?a.children:null,r,i):Au(n,null,t,r,i);return i}function b5(n,e,t){if(typeof t=="function")return dn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!zs(n.url,e.url);case"pathParamsOrQueryParamsChange":return!zs(n.url,e.url)||!ci(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!FE(n,e)||!ci(n.queryParams,e.queryParams);default:return!FE(n,e)}}function Nu(n,e,t){let r=rc(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Nu(s,e.children.getContext(o),t):Nu(s,null,t):Nu(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new oc(e.outlet.component,i)):t.canDeactivateChecks.push(new oc(null,i)):t.canDeactivateChecks.push(new oc(null,i))}function Hu(n){return typeof n=="function"}function w5(n){return typeof n=="boolean"}function I5(n){return n&&Hu(n.canLoad)}function T5(n){return n&&Hu(n.canActivate)}function S5(n){return n&&Hu(n.canActivateChild)}function C5(n){return n&&Hu(n.canDeactivate)}function D5(n){return n&&Hu(n.canMatch)}function tR(n){return n instanceof ys||n?.name==="EmptyError"}var Op=Symbol("INITIAL_VALUE");function uc(){return Ri(n=>Gy(n.map(e=>e.pipe(Ai(1),Wy(Op)))).pipe(wt(e=>{for(let t of e)if(t!==!0){if(t===Op)return Op;if(t===!1||x5(t))return t}return!0}),xi(e=>e!==Op),Ai(1)))}function x5(n){return Ho(n)||n instanceof lc}function nR(n){return n.aborted?He(void 0).pipe(Ai(1)):new Ke(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function rR(n){return Tl(nR(n))}function A5(n){return Sn(e=>{let{targetSnapshot:t,currentSnapshot:r,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return o.length===0&&i.length===0?He(le(F({},e),{guardsResult:!0})):M5(o,t,r).pipe(Sn(s=>s&&w5(s)?R5(t,i,n):He(s)),wt(s=>le(F({},e),{guardsResult:s})))})}function M5(n,e,t){return Bt(n).pipe(Sn(r=>F5(r.component,r.route,t,e)),Mi(r=>r!==!0,!0))}function R5(n,e,t){return Bt(e).pipe(Ah(r=>Ma(P5(r.route.parent,t),N5(r.route,t),O5(n,r.path),k5(n,r.route))),Mi(r=>r!==!0,!0))}function N5(n,e){return n!==null&&e&&e(new Yp(n)),He(!0)}function P5(n,e){return n!==null&&e&&e(new Kp(n)),He(!0)}function k5(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return He(!0);let r=t.map(i=>wl(()=>{let o=e._environmentInjector,s=hc(i,o),a=T5(s)?s.canActivate(e,n):dn(o,()=>s(e,n));return Ys(a).pipe(Mi())}));return He(r).pipe(uc())}function O5(n,e){let t=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(o=>_5(o)).filter(o=>o!==null).map(o=>wl(()=>{let s=o.guards.map(a=>{let c=o.node._environmentInjector,u=hc(a,c),d=S5(u)?u.canActivateChild(t,n):dn(c,()=>u(t,n));return Ys(d).pipe(Mi())});return He(s).pipe(uc())}));return He(i).pipe(uc())}function F5(n,e,t,r){let i=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!i||i.length===0)return He(!0);let o=i.map(s=>{let a=e._environmentInjector,c=hc(s,a),u=C5(c)?c.canDeactivate(n,e,t,r):dn(a,()=>c(n,e,t,r));return Ys(u).pipe(Mi())});return He(o).pipe(uc())}function L5(n,e,t,r,i){let o=e.canLoad;if(o===void 0||o.length===0)return He(!0);let s=o.map(a=>{let c=hc(a,n),u=I5(c)?c.canLoad(e,t):dn(n,()=>c(e,t)),d=Ys(u);return i?d.pipe(rR(i)):d});return He(s).pipe(uc(),iR(r))}function iR(n){return By($r(e=>{if(typeof e!="boolean")throw tg(n,e)}),wt(e=>e===!0))}function V5(n,e,t,r,i){let o=e.canMatch;if(!o||o.length===0)return He(!0);let s=o.map(a=>{let c=hc(a,n),u=D5(c)?c.canMatch(e,t):dn(n,()=>c(e,t));return Ys(u).pipe(rR(i))});return He(s).pipe(uc(),iR(r))}var zi=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},Vu=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function U5(n){throw new ee(4e3,!1)}function B5(n){throw XM(!1,bn.GuardRejected)}var UE=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return r;if(i.numberOfChildren>1||!i.children[Re])throw U5(`${e.redirectTo}`);i=i.children[Re]}}async applyRedirectCommands(e,t,r,i,o){let s=await j5(t,i,o);if(s instanceof Pr)throw new Vu(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,r);if(s[0]==="/")throw new Vu(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new Pr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new Ze(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ee(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function j5(n,e,t){if(typeof n=="string")return Promise.resolve(n);let r=n,{queryParams:i,fragment:o,routeConfig:s,url:a,outlet:c,params:u,data:d,title:f,paramMap:g,queryParamMap:m}=e;return Up(Ys(dn(t,()=>r({params:u,data:d,queryParams:i,fragment:o,routeConfig:s,url:a,outlet:c,title:f,paramMap:g,queryParamMap:m}))))}function H5(n,e){return n.providers&&!n._injector&&(n._injector=Ya(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Nr(n){return n.outlet||Re}function $5(n,e){let t=n.filter(r=>Nr(r)===e);return t.push(...n.filter(r=>Nr(r)!==e)),t}var BE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function G5(n,e,t,r,i,o){let s=oR(n,e,t);return s.matched?(r=H5(e,r),V5(r,e,t,i,o).pipe(wt(a=>a===!0?s:F({},BE)))):He(s)}function oR(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},BE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||RM)(t,n,e);if(!i)return F({},BE);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?F(F({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function DM(n,e,t,r){return t.length>0&&W5(n,t,r)?{segmentGroup:new Ze(e,q5(r,new Ze(t,n.children))),slicedSegments:[]}:t.length===0&&K5(n,t,r)?{segmentGroup:new Ze(n.segments,z5(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Ze(n.segments,n.children),slicedSegments:t}}function z5(n,e,t,r){let i={};for(let o of t)if(og(n,e,o)&&!r[Nr(o)]){let s=new Ze([],{});i[Nr(o)]=s}return F(F({},r),i)}function q5(n,e){let t={};t[Re]=e;for(let r of n)if(r.path===""&&Nr(r)!==Re){let i=new Ze([],{});t[Nr(r)]=i}return t}function W5(n,e,t){return t.some(r=>og(n,e,r)&&Nr(r)!==Re)}function K5(n,e,t){return t.some(r=>og(n,e,r))}function og(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Q5(n,e,t){return e.length===0&&!n.children[t]}var jE=class{};async function Y5(n,e,t,r,i,o,s="emptyOnly",a){return new HE(n,e,t,r,i,s,o,a).recognize()}var J5=31,HE=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=c,this.applyRedirects=new UE(this.urlSerializer,this.urlTree)}noMatchError(e){return new ee(4002,`'${e.segmentGroup}'`)}async recognize(){let e=DM(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(e),i=new Zn(r,t),o=new Fu("",i),s=HM(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new qs([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Re,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,Re,t),rootSnapshot:t}}catch(r){if(r instanceof Vu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof zi?this.noMatchError(r):r}}async processSegmentGroup(e,t,r,i,o){if(r.segments.length===0&&r.hasChildren())return this.processChildren(e,t,r,o);let s=await this.processSegment(e,t,r,r.segments,i,!0,o);return s instanceof Zn?[s]:[]}async processChildren(e,t,r,i){let o=[];for(let c of Object.keys(r.children))c==="primary"?o.unshift(c):o.push(c);let s=[];for(let c of o){let u=r.children[c],d=$5(t,c),f=await this.processSegmentGroup(e,d,u,c,i);s.push(...f)}let a=sR(s);return Z5(a),a}async processSegment(e,t,r,i,o,s,a){for(let c of t)try{return await this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a)}catch(u){if(u instanceof zi||tR(u))continue;throw u}if(Q5(r,i,o))return new jE;throw new zi(r)}async processSegmentAgainstRoute(e,t,r,i,o,s,a,c){if(Nr(r)!==s&&(s===Re||!og(i,o,r)))throw new zi(i);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,i,r,o,s,c);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c);throw new zi(i)}async expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:u,consumedSegments:d,positionalParamSegments:f,remainingSegments:g}=oR(t,i,o);if(!c)throw new zi(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>J5&&(this.allowRedirects=!1));let m=new qs(o,u,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,xM(i),Nr(i),i.component??i._loadedComponent??null,i,AM(i),e),S=eg(m,a,this.paramsInheritanceStrategy);if(m.params=Object.freeze(S.params),m.data=Object.freeze(S.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let M=await this.applyRedirects.applyRedirectCommands(d,i.redirectTo,f,m,e),O=await this.applyRedirects.lineralizeSegments(i,M);return this.processSegment(e,r,t,O.concat(g),s,!1,a)}async matchSegmentAgainstRoute(e,t,r,i,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await Up(G5(t,r,i,e,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!a?.matched)throw new zi(t);e=r._injector??e;let{routes:c}=await this.getChildConfig(e,r,i),u=r._loadedInjector??e,{parameters:d,consumedSegments:f,remainingSegments:g}=a,m=new qs(f,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,xM(r),Nr(r),r.component??r._loadedComponent??null,r,AM(r),e),S=eg(m,s,this.paramsInheritanceStrategy);m.params=Object.freeze(S.params),m.data=Object.freeze(S.data);let{segmentGroup:M,slicedSegments:O}=DM(t,f,g,c);if(O.length===0&&M.hasChildren()){let $=await this.processChildren(u,c,M,m);return new Zn(m,$)}if(c.length===0&&O.length===0)return new Zn(m,[]);let P=Nr(r)===o,q=await this.processSegment(u,c,M,O,P?Re:o,!0,m);return new Zn(m,q instanceof Zn?[q]:[])}async getChildConfig(e,t,r){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await Up(L5(e,t,r,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw B5(t)}return{routes:[],injector:e}}};function Z5(n){n.sort((e,t)=>e.value.outlet===Re?-1:t.value.outlet===Re?1:e.value.outlet.localeCompare(t.value.outlet))}function X5(n){let e=n.value.routeConfig;return e&&e.path===""}function sR(n){let e=[],t=new Set;for(let r of n){if(!X5(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=sR(r.children);e.push(new Zn(r.value,i))}return e.filter(r=>!t.has(r))}function xM(n){return n.data||{}}function AM(n){return n.resolve||{}}function e6(n,e,t,r,i,o,s){return Sn(async a=>{let{state:c,tree:u}=await Y5(n,e,t,r,a.extractedUrl,i,o,s);return le(F({},a),{targetSnapshot:c,urlAfterRedirects:u})})}function t6(n){return Sn(e=>{let{targetSnapshot:t,guards:{canActivateChecks:r}}=e;if(!r.length)return He(e);let i=new Set(r.map(a=>a.route)),o=new Set;for(let a of i)if(!o.has(a))for(let c of aR(a))o.add(c);let s=0;return Bt(o).pipe(Ah(a=>i.has(a)?n6(a,t,n):(a.data=eg(a,a.parent,n).resolve,He(void 0))),$r(()=>s++),Mh(1),Sn(a=>s===o.size?He(e):ln))})}function aR(n){let e=n.children.map(t=>aR(t)).flat();return[n,...e]}function n6(n,e,t){let r=n.routeConfig,i=n._resolve;return r?.title!==void 0&&!YM(r)&&(i[Uu]=r.title),wl(()=>(n.data=eg(n,n.parent,t).resolve,r6(i,n,e).pipe(wt(o=>(n._resolvedData=o,n.data=F(F({},n.data),o),null)))))}function r6(n,e,t){let r=ME(n);if(r.length===0)return He({});let i={};return Bt(r).pipe(Sn(o=>i6(n[o],e,t).pipe(Mi(),$r(s=>{if(s instanceof lc)throw tg(new jo,s);i[o]=s}))),Mh(1),wt(()=>i),Il(o=>tR(o)?ln:$y(o)))}function i6(n,e,t){let r=e._environmentInjector,i=hc(n,r),o=i.resolve?i.resolve(e,t):dn(r,()=>i(e,t));return Ys(o)}function MM(n){return Ri(e=>{let t=n(e);return t?Bt(t).pipe(wt(()=>e)):He(e)})}var qE=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===Re);return r}getResolvedTitleForRoute(t){return t.data[Uu]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>j(cR),providedIn:"root"})}return n})(),cR=(()=>{class n extends qE{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(ve(_M))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),fc=new ne("",{factory:()=>({})}),$u=new ne(""),lR=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=j($_);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let o=await PM(dn(t,()=>r.loadComponent())),s=await hR(dR(o));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s,s}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let o=await uR(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=o.routes,r._loadedInjector=o.injector,r._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function uR(n,e,t,r){let i=await PM(dn(t,()=>n.loadChildren())),o=await hR(dR(i)),s;o instanceof tp||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),r&&r(n);let a,c,u=!1,d;return Array.isArray(s)?(c=s,u=!0):(a=s.create(t).injector,d=s,c=a.get($u,[],{optional:!0,self:!0}).flat()),{routes:c.map(zE),injector:a,factory:d}}function o6(n){return n&&typeof n=="object"&&"default"in n}function dR(n){return o6(n)?n.default:n}async function hR(n){return n}var sg=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>j(s6),providedIn:"root"})}return n})(),s6=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),fR=new ne("");var a6=()=>{},pR=new ne(""),gR=(()=>{class n{currentNavigation=W(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=W(null);events=new Vt;transitionAbortWithErrorSubject=new Vt;configLoader=j(lR);environmentInjector=j(xt);destroyRef=j(Tr);urlSerializer=j(Bu);rootContexts=j(dc);location=j(tc);inputBindingEnabled=j(ig,{optional:!0})!==null;titleStrategy=j(qE);options=j(fc,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=j(sg);createViewTransition=j(fR,{optional:!0});navigationErrorHandler=j(pR,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>He(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new qp(i)),r=i=>this.events.next(new Wp(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;Wt(()=>{this.transitions?.next(le(F({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new cn(null),this.transitions.pipe(xi(r=>r!==null),Ri(r=>{let i=!1,o=new AbortController,s=()=>!i&&this.currentTransition?.id===r.id;return He(r).pipe(Ri(a=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",bn.SupersededByNewNavigation),ln;this.currentTransition=r;let c=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:c?le(F({},c),{previousNavigation:null}):null,abort:()=>o.abort()});let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&d!=="reload")return this.events.next(new qi(a.id,this.urlSerializer.serialize(a.rawUrl),"",ku.IgnoredSameUrlNavigation)),a.resolve(!1),ln;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return He(a).pipe(Ri(f=>(this.events.next(new Ks(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),f.id!==this.navigationId?ln:Promise.resolve(f))),e6(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),$r(f=>{r.targetSnapshot=f.targetSnapshot,r.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation.update(m=>(m.finalUrl=f.urlAfterRedirects,m));let g=new sc(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(g)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:f,extractedUrl:g,source:m,restoredState:S,extras:M}=a,O=new Ks(f,this.urlSerializer.serialize(g),m,S);this.events.next(O);let P=KM(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=r=le(F({},a),{targetSnapshot:P,urlAfterRedirects:g,extras:le(F({},M),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(q=>(q.finalUrl=g,q)),He(r)}else return this.events.next(new qi(a.id,this.urlSerializer.serialize(a.extractedUrl),"",ku.IgnoredByUrlHandlingStrategy)),a.resolve(!1),ln}),wt(a=>{let c=new Hp(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(c),this.currentTransition=r=le(F({},a),{guards:v5(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),r}),A5(a=>this.events.next(a)),Ri(a=>{if(r.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw tg(this.urlSerializer,a.guardsResult);let c=new $p(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(c),!s())return ln;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",bn.GuardRejected),ln;if(a.guards.canActivateChecks.length===0)return He(a);let u=new Gp(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(u),!s())return ln;let d=!1;return He(a).pipe(t6(this.paramsInheritanceStrategy),$r({next:()=>{d=!0;let f=new zp(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(f)},complete:()=>{d||this.cancelNavigationTransition(a,"",bn.NoDataFromResolver)}}))}),MM(a=>{let c=d=>{let f=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let g=d._environmentInjector;f.push(this.configLoader.loadComponent(g,d.routeConfig).then(m=>{d.component=m}))}for(let g of d.children)f.push(...c(g));return f},u=c(a.targetSnapshot.root);return u.length===0?He(a):Bt(Promise.all(u).then(()=>a))}),MM(()=>this.afterPreactivation()),Ri(()=>{let{currentSnapshot:a,targetSnapshot:c}=r,u=this.createViewTransition?.(this.environmentInjector,a.root,c.root);return u?Bt(u).pipe(wt(()=>r)):He(r)}),Ai(1),wt(a=>{let c=p5(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=r=a=le(F({},a),{targetRouterState:c}),this.currentNavigation.update(u=>(u.targetRouterState=c,u)),this.events.next(new ac),s()&&(new VE(t.routeReuseStrategy,r.targetRouterState,r.currentRouterState,u=>this.events.next(u),this.inputBindingEnabled).activate(this.rootContexts),s()&&(i=!0,this.currentNavigation.update(u=>(u.abort=a6,u)),this.lastSuccessfulNavigation.set(Wt(this.currentNavigation)),this.events.next(new li(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Tl(nR(o.signal).pipe(xi(()=>!i&&!r.targetRouterState),$r(()=>{this.cancelNavigationTransition(r,o.signal.reason+"",bn.Aborted)}))),$r({complete:()=>{i=!0}}),Tl(this.transitionAbortWithErrorSubject.pipe($r(a=>{throw a}))),qy(()=>{o.abort(),i||this.cancelNavigationTransition(r,"",bn.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Il(a=>{if(i=!0,this.destroyed)return r.resolve(!1),ln;if(eR(a))this.events.next(new hr(r.id,this.urlSerializer.serialize(r.extractedUrl),a.message,a.cancellationCode)),y5(a)?this.events.next(new cc(a.url,a.navigationBehaviorOptions)):r.resolve(!1);else{let c=new Qs(r.id,this.urlSerializer.serialize(r.extractedUrl),a,r.targetSnapshot??void 0);try{let u=dn(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(u instanceof lc){let{message:d,cancellationCode:f}=tg(this.urlSerializer,u);this.events.next(new hr(r.id,this.urlSerializer.serialize(r.extractedUrl),d,f)),this.events.next(new cc(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(c),a}catch(u){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(u)}}return ln}))}))}cancelNavigationTransition(t,r,i){let o=new hr(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Wt(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function c6(n){return n!==Ru}var mR=new ne("");var yR=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>j(l6),providedIn:"root"})}return n})(),rg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},l6=(()=>{class n extends rg{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Us(n)))(i||n)}})();static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),WE=(()=>{class n{urlSerializer=j(Bu);options=j(fc,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=j(tc);urlHandlingStrategy=j(sg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Pr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,s=i??o;return s instanceof Pr?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=KM(null,j(xt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>j(u6),providedIn:"root"})}return n})(),u6=(()=>{class n extends WE{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Ks?this.updateStateMemento():t instanceof qi?this.commitTransition(r):t instanceof sc?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof ac?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof hr&&!WM(t)?this.restoreHistory(r):t instanceof Qs?this.restoreHistory(r,!0):t instanceof li&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:o,state:s}=r;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,c=F(F({},s),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=F(F({},s),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Us(n)))(i||n)}})();static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function KE(n,e){n.events.pipe(xi(t=>t instanceof li||t instanceof hr||t instanceof Qs||t instanceof qi),wt(t=>t instanceof li||t instanceof qi?0:(t instanceof hr?t.code===bn.Redirect||t.code===bn.SupersededByNewNavigation:!1)?2:1),xi(t=>t!==2),Ai(1)).subscribe(()=>{e()})}var vR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},_R={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ki=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=j(rp);stateManager=j(WE);options=j(fc,{optional:!0})||{};pendingTasks=j(ei);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=j(gR);urlSerializer=j(Bu);location=j(tc);urlHandlingStrategy=j(sg);injector=j(xt);_events=new Vt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=j(yR);injectorCleanup=j(mR,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=j($u,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!j(ig,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new an;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=Wt(this.navigationTransitions.currentNavigation);if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof hr&&r.code!==bn.Redirect&&r.code!==bn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof li)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(r instanceof cc){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=F({scroll:i.extras.scroll,browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||c6(i.source)},s);this.scheduleNavigation(a,Ru,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}h5(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ru,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=F({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o).catch(c=>{this.disposed||this.injector.get(Kn)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Wt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(zE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let f;try{let g=i?i.snapshot:this.routerState.snapshot.root;f=$M(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),f=this.currentUrlTree.root}return GM(f,t,d,u??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Ho(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Ru,null,r)}navigate(t,r={skipLocationChange:!1}){return d6(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(ki(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=F({},vR):r===!1?i=F({},_R):i=r,Ho(t))return wM(this.currentUrlTree,t,i);let o=this.parseUrl(t);return wM(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,u;s?(a=s.resolve,c=s.reject,u=s.promise):u=new Promise((f,g)=>{a=f,c=g});let d=this.pendingTasks.add();return KE(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(f=>Promise.reject(f))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function d6(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ee(4008,!1)}var pc=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=W(null);get href(){return Wt(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Vt;applicationErrorHandler=j(Kn);options=j(fc,{optional:!0});constructor(t,r,i,o,s,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(j(new gp("href"),{optional:!0}));let c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof li&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Ho(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c)?.catch(u=>{this.applicationErrorHandler(u)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,r){let i=this.renderer,o=this.el.nativeElement;r!==null?i.setAttribute(o,t,r):i.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:Ho(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(ge(Ki),ge(Wi),Xl("tabindex"),ge(Bs),ge(xr),ge(ec))};static \u0275dir=Xt({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){r&1&&se("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),r&2&&Lo("href",i.reactiveHref(),a_)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",gu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",gu],replaceUrl:[2,"replaceUrl","replaceUrl",gu],routerLink:"routerLink"},features:[Ui]})}return n})();var p6=new ne("");function QE(n,...e){return Qr([{provide:$u,multi:!0,useValue:n},[],{provide:Wi,useFactory:g6},{provide:Fo,multi:!0,useFactory:m6},e.map(t=>t.\u0275providers)])}function g6(){return j(Ki).routerState.root}function m6(){let n=j(kn);return e=>{let t=n.get(Fn);if(e!==t.components[0])return;let r=n.get(Ki),i=n.get(y6);n.get(v6)===1&&r.initialNavigation(),n.get(_6,null,{optional:!0})?.setUpPreloading(),n.get(p6,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var y6=new ne("",{factory:()=>new Vt}),v6=new ne("",{factory:()=>1});var _6=new ne("");var gc=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let r=4;r>=1;r--){let i=t[r];for(let o=i.length;o>=1;o--)if(e>=i[o-1])return{tier:r,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let i={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return i?i[t-1]:1}getDefenseBonus(e,t){let r=0,i=[];return(e.turnsStationary??0)>=3&&(r+=1,i.push("Shield +1")),t.some(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1)&&(r+=1,i.push("Support +1")),{bonus:r,tags:i}}getAttackLuckModifier(e){let t=Math.random(),i={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:i,tag:`CRIT! +${i}`,isCrit:!0}:t>.8?{delta:-i,tag:`MISS! -${i}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}isDiagonalBlocked(e,t,r){let i=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(i===0||o===0)return!1;let s=r(e.x,e.y,e.x+i,e.y),a=r(e.x,e.y,e.x,e.y+o),c=r(t.x-i,t.y,t.x,t.y),u=r(t.x,t.y-o,t.x,t.y);return!!(s||a||c||u)}checkWallAlongPath(e,t,r,i){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),c=Math.sign(s),u=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=u;d++){let f={x:e.x+a*(d-1),y:e.y+c*(d-1)},g={x:e.x+a*d,y:e.y+c*d},m=i(f.x,f.y,g.x,g.y);if(m)return m.owner===r?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:f}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var ag=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,r){let i=[t,r];for(let o of i){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,r,i){return e.some(o=>o.owner===t&&(o.position.x===r.x&&o.position.y===r.y||o.position.x===i.x&&o.position.y===i.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var cg=class n{entriesSignal=W([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(r=>[...r,{text:e,color:t,type:"other"}])}addCombat(e,t,r){let i=r?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:i,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var w6={SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0434\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function wR(n,e){let t=w6[n];return t?t[e]??t.en:n}var wn=class n{difficultySignal=W("normal");mapSizeSignal=W(10);langSignal=W("uk");version="v.0.6.0";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),r=e%2===0;return t==="baby"?r?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return wR(e,this.langSignal())}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let r=["baby","normal","hard","nightmare"],i=[10,20,30],o=["en","uk"],s=t.difficulty&&r.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&i.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),c=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(c)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var lg=class n{generateForests(e,t,r){let i=e*e,o=Math.max(1,Math.floor(i*.1)),s=[],a=(c,u)=>{let d=Math.max(Math.abs(c-t.x),Math.abs(u-t.y)),f=Math.max(Math.abs(c-r.x),Math.abs(u-r.y));return d<=3||f<=3};for(;s.length<o;){let c=Math.floor(Math.random()*e),u=Math.floor(Math.random()*e);a(c,u)||s.some(d=>d.x===c&&d.y===u)||s.push({x:c,y:u})}return s}computeVisibility(e,t,r,i,o){let s={player:new Set,ai:new Set},a=(d,f)=>d>=0&&d<e&&f>=0&&f<e,c=(d,f,g)=>{a(f,g)&&d.add(`${f},${g}`)},u=(d,f,g)=>{for(let m=-g;m<=g;m++)for(let S=-g;S<=g;S++){let M=f.x+m,O=f.y+S;Math.max(Math.abs(m),Math.abs(S))<=g&&c(d,M,O)}};if(o){for(let d=0;d<e;d++)for(let f=0;f<e;f++)s.player.add(`${d},${f}`),s.ai.add(`${d},${f}`);return s}u(s.player,r,3),u(s.ai,i,3);for(let d of t){let f=d.owner==="player"?s.player:s.ai;u(f,d.position,2)}return s}mergeExplored(e,t){let r=new Set(e);return t.forEach(i=>r.add(i)),r}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var ug=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let r of t)if(e>=r)return r;return 0}computeWoodGain(e,t){let r=e.filter(i=>i.owner===t).filter(i=>i.position&&i.position.x!==void 0&&i.position.y!==void 0).length;return r>0?r*2:0}applyMonopolyTick(e,t,r){let i=t.length;if(i===0)return{next:{player:0,ai:0}};let o=u=>r.filter(d=>d.owner===u&&t.some(f=>f.x===d.position.x&&f.y===d.position.y)).length,s=o("player"),a=o("ai"),c={player:e.player,ai:e.ai};if(s===i){if(c.player=e.player+1,c.ai=0,c.player>=10)return{next:c,winner:"player"}}else if(a===i){if(c.ai=e.ai+1,c.player=0,c.ai>=10)return{next:c,winner:"ai"}}else c.player=0,c.ai=0;return{next:c}}computeAiReserveDump(e,t,r,i){let o=r,s=[];for(let c=-2;c<=2;c++)for(let u=-2;u<=2;u++){if(c===0&&u===0)continue;let d=t.x+c,f=t.y+u;d<0||d>=e||f<0||f>=e||Math.max(Math.abs(c),Math.abs(u))>2||i(d,f)||s.push({x:d,y:f})}let a=[];for(;o>0&&s.length>0;){let c=this.getHighestAffordableCost(o);if(c<=0)break;let u=this.calculateTierAndLevel(c),d=s.shift();a.push({id:crypto.randomUUID(),position:F({},d),level:u.level,tier:u.tier,points:c,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=c}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let r=4;r>=1;r--){let i=t[r];for(let o=i.length;o>=1;o--)if(e>=i[o-1])return{tier:r,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var dg=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(y=>y.owner==="ai"&&!y.hasActed);t=t.filter(y=>!(y.tier<=2&&e.isForest(y.position.x,y.position.y)&&e.isAnchoredGatherer(y.id)));let r=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;r&&(t=t.filter(y=>y.id===r));let i=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:i==="rage"?5e4:i==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),c=e.forestsSignal(),d=c.filter(y=>!e.getUnitAt(y.x,y.y)).filter(y=>e.isVisibleToAi(y.x,y.y)),f=c.filter(y=>!e.isVisibleToAi(y.x,y.y)),g=e.unitsSignal().filter(y=>y.owner==="ai"&&e.isForest(y.position.x,y.position.y)).length,m=e.unitsSignal().filter(y=>y.owner==="ai").length,S=[1,2,3].some(y=>e.unitsSignal().filter(Me=>Me.owner==="ai"&&Me.tier===y&&!e.isForest(Me.position.x,Me.position.y)).length>=5),M=e.unitsSignal().filter(y=>y.owner==="player"),O=M.some(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=3),P=M.filter(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=4),q=P.length>0,ae=P.filter(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=2).length>0,be=M.some(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=5),re=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,D=e.unitsSignal().filter(y=>y.owner==="ai"),I=D.filter(y=>y.tier===3&&!e.isForest(y.position.x,y.position.y)).length,C=D.filter(y=>y.tier===4&&!e.isForest(y.position.x,y.position.y)).length,x=I+C>=5,A=x?"full_rush":q?"defense":re?"expansion":"none";if(A!==this.lastPhase){try{console.log(A==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":A==="defense"?"AI Phase: Base Defense Activated":A==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=A}x&&t.sort((y,Me)=>{let Rn=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),vr=Math.abs(Me.position.x-a.x)+Math.abs(Me.position.y-a.y);return Rn-vr});let R=typeof e.aggressionMode=="function"?!!e.aggressionMode():M.filter(y=>e.isForest(y.position.x,y.position.y)).length*2>=t.filter(y=>e.isForest(y.position.x,y.position.y)).length*2,T=c.length>0?c.every(y=>{let Me=e.getUnitAt(y.x,y.y);return!!Me&&Me.owner==="ai"}):!0,Tt=c.length>0?c.every(y=>!!e.getUnitAt(y.x,y.y)):!1,Kt=c.filter(y=>{let Me=e.getUnitAt(y.x,y.y);return!!Me&&Me.owner==="player"}),ye=null,Bn=t.filter(y=>Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=3).length,Ii={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Et=P.length>0?P.reduce((y,Me)=>{let Rn=Math.max(Math.abs(Me.position.x-s.x),Math.abs(Me.position.y-s.y)),vr=Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y));return Rn<vr?Me:y},P[0]):null,go=t.length>0?t.reduce((y,Me)=>this.combat.calculateTotalPoints(Me)>this.combat.calculateTotalPoints(y)?Me:y,t[0]):null,os=[];if(Et){let y=Et.position.x,Me=Et.position.y,Rn=Math.sign(s.x-y),vr=Math.sign(s.y-Me),ce=0,as=Math.max(10,e.gridSize*2);for(;y!==s.x||Me!==s.y;){if(ce++,ce>as){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(y+=Rn,Me+=vr,!e.inBounds(y,Me)||y===s.x&&Me===s.y)break;os.push({x:y,y:Me})}}q&&go&&Et&&(this.goals.set(go.id,{x:Et.position.x,y:Et.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(go.id,e.turnSignal()+3));let Vd=new Map(e.aiUnitTimeNearBase()),Ud=new Map(e.unitStutterBanSignal?.()??new Map),yr=new Map;for(let[y,Me]of this.goals.entries())if(Me&&e.isForest(Me.x,Me.y)){let Rn=`${Me.x},${Me.y}`;yr.set(Rn,(yr.get(Rn)||0)+1)}for(let y of t){let Me=e.calculateValidMoves(y),Rn=Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y))<=3,vr=Vd.get(y.id)||0,ce=this.goals.get(y.id)||null,as=ce!==null,jd=as?(()=>{let U=e.getUnitAt(ce.x,ce.y);return!!(U&&U.owner==="ai"&&this.combat.calculateTotalPoints(U)>=this.combat.calculateTotalPoints(y))})():!1,el=(!as||jd)&&(!e.isForest(y.position.x,y.position.y)||be||y.tier>=3),tl=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(el){if(tl)ce={x:a.x,y:a.y};else if(e.isForest(y.position.x,y.position.y)){let U=M.filter(N=>e.isForest(N.position.x,N.position.y));if(R&&U.length>0){let N=U.reduce((H,G)=>{let ue=Math.abs(y.position.x-G.position.x)+Math.abs(y.position.y-G.position.y),Te=Math.abs(y.position.x-H.position.x)+Math.abs(y.position.y-H.position.y);return ue<Te?G:H},U[0]);ce={x:N.position.x,y:N.position.y}}else{let N=M.length===0?null:[...M].sort((G,ue)=>{let Te=Math.abs(y.position.x-G.position.x)+Math.abs(y.position.y-G.position.y),Ue=Math.abs(y.position.x-ue.position.x)+Math.abs(y.position.y-ue.position.y);return Te-Ue})[0];N?ce={x:N.position.x,y:N.position.y}:d.length>0?ce=d.reduce((H,G)=>Math.abs(y.position.x-G.x)+Math.abs(y.position.y-G.y)<Math.abs(y.position.x-H.x)+Math.abs(y.position.y-H.y)?G:H,d[0]):f.length>0?ce=f.reduce((H,G)=>Math.abs(y.position.x-G.x)+Math.abs(y.position.y-G.y)<Math.abs(y.position.x-H.x)+Math.abs(y.position.y-H.y)?G:H,f[0]):ce={x:0,y:0}}}else{let U=M.filter(N=>e.isForest(N.position.x,N.position.y)).map(N=>({x:N.position.x,y:N.position.y}));if(U.length>0)ce=U.reduce((H,G)=>{let ue=Math.abs(y.position.x-G.x)+Math.abs(y.position.y-G.y),Te=Math.abs(y.position.x-H.x)+Math.abs(y.position.y-H.y);return ue<Te?G:H},U[0]);else if(d.length>0){let N=Math.min(...d.map(G=>yr.get(`${G.x},${G.y}`)||0)),H=d.filter(G=>(yr.get(`${G.x},${G.y}`)||0)===N);ce=H.reduce((G,ue)=>Math.abs(y.position.x-ue.x)+Math.abs(y.position.y-ue.y)<Math.abs(y.position.x-G.x)+Math.abs(y.position.y-G.y)?ue:G,H[0])}else if(f.length>0){let N=Math.min(...f.map(G=>yr.get(`${G.x},${G.y}`)||0)),H=f.filter(G=>(yr.get(`${G.x},${G.y}`)||0)===N);ce=H.reduce((G,ue)=>Math.abs(y.position.x-ue.x)+Math.abs(y.position.y-ue.y)<Math.abs(y.position.x-G.x)+Math.abs(y.position.y-G.y)?ue:G,H[0])}else{let N=M.length===0?null:[...M].sort((G,ue)=>{let Te=Math.abs(y.position.x-G.position.x)+Math.abs(y.position.y-G.position.y),Ue=Math.abs(y.position.x-ue.position.x)+Math.abs(y.position.y-ue.position.y);return Te-Ue})[0];ce=N?{x:N.position.x,y:N.position.y}:{x:0,y:0}}}this.goals.set(y.id,ce)}Bn>3&&vr>=5&&(ce=Ii);let Tn=e.isForest(y.position.x,y.position.y),nl=Tn&&(y.forestOccupationTurns??0)>0&&!(y.productionActive??!1),rl=e.unitsSignal().some(U=>U.owner==="ai"&&U.id!==y.id&&U.tier<=2&&Math.max(Math.abs(U.position.x-y.position.x),Math.abs(U.position.y-y.position.y))<=2);if(nl&&!be&&y.tier<3){this.goals.set(y.id,{x:y.position.x,y:y.position.y});continue}if(y.tier>=3){let U=c,N=U.length?U.reduce((G,ue)=>{let Te=Math.abs(y.position.x-ue.x)+Math.abs(y.position.y-ue.y),Ue=Math.abs(y.position.x-G.x)+Math.abs(y.position.y-G.y);return Te<Ue?ue:G},U[0]):null;if((y.forestOccupationTurns??0)===0&&!Tn&&N&&(ce={x:N.x,y:N.y},this.goals.set(y.id,ce)),Tn&&rl){this.goals.set(y.id,{x:a.x,y:a.y});let G=[{x:y.position.x+1,y:y.position.y},{x:y.position.x-1,y:y.position.y},{x:y.position.x,y:y.position.y+1},{x:y.position.x,y:y.position.y-1}].filter(Te=>e.inBounds(Te.x,Te.y));if(G.filter(Te=>!!e.getWallBetween(y.position.x,y.position.y,Te.x,Te.y)).length===G.length){let Te=G.reduce((Ue,Ye)=>{let ot=Math.abs(Ye.x-a.x)+Math.abs(Ye.y-a.y),Xe=Math.abs(Ue.x-a.x)+Math.abs(Ue.y-a.y);return ot<Xe?Ye:Ue});ye={unit:y,target:{x:y.position.x,y:y.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:F({},y.position),to:Te}};continue}}}if(Me.some(U=>U.x===a.x&&U.y===a.y)){let U=y.tier===3&&y.level>=2||y.tier>=4?3e5:0,N=5e7+o+U;(ye===null||N>ye.score)&&(ye={unit:y,target:{x:a.x,y:a.y},score:N,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let U=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(N=>e.inBounds(N.x,N.y));for(let N of U){let H=e.getWallBetween(a.x,a.y,N.x,N.y);if(H&&H.owner==="neutral"){if(y.position.x===N.x&&y.position.y===N.y||y.position.x===a.x&&y.position.y===a.y){let ue=y.tier===3&&y.level>=2||y.tier>=4?3e5:0,Te=2e6+o+ue;(ye===null||Te>ye.score)&&(ye={unit:y,target:F({},y.position),score:Te,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:N.x,y:N.y}}})}else if(Me.some(Te=>Te.x===N.x&&Te.y===N.y||Te.x===a.x&&Te.y===a.y)){let Te=Me.find(Xe=>Xe.x===N.x&&Xe.y===N.y||Xe.x===a.x&&Xe.y===a.y),Ue=y.tier===3&&y.level>=2||y.tier>=4?3e5:0,Ye=18e5+o+Ue;(ye===null||Ye>ye.score)&&(ye={unit:y,target:{x:Te.x,y:Te.y},score:Ye,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(ce){let U=e.getUnitAt(ce.x,ce.y);if(U&&U.owner==="player"&&e.isForest(ce.x,ce.y)){let N=ce.x,H=ce.y;if(Me.some(ue=>ue.x===N&&ue.y===H)){(ye===null||3e5>ye.score)&&(ye={unit:y,target:{x:N,y:H},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let ue=d.length>0?d:f;if(ue.length>0)ce=ue.reduce((Ue,Ye)=>{let ot=Math.abs(y.position.x-Ye.x)+Math.abs(y.position.y-Ye.y),Xe=Math.abs(y.position.x-Ue.x)+Math.abs(y.position.y-Ue.y);return ot<Xe?Ye:Ue},ue[0]),this.goals.set(y.id,ce);else continue}}}let gt=null;if(ce&&e.isForest(ce.x,ce.y)&&!e.getUnitAt(ce.x,ce.y)){let N=[{x:ce.x+1,y:ce.y},{x:ce.x-1,y:ce.y},{x:ce.x,y:ce.y+1},{x:ce.x,y:ce.y-1}].filter(H=>e.inBounds(H.x,H.y)).filter(H=>{let G=e.getWallBetween(H.x,H.y,ce.x,ce.y);return!!(G&&G.owner==="neutral")});N.length>0&&(gt=N.reduce((H,G)=>{let ue=Math.abs(y.position.x-H.x)+Math.abs(y.position.y-H.y);return Math.abs(y.position.x-G.x)+Math.abs(y.position.y-G.y)+3<ue?G:H},N[0]))}let Ti=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let U of Ti){let N={x:y.position.x+U.x,y:y.position.y+U.y};if(!e.inBounds(N.x,N.y)||!e.isForest(N.x,N.y)||e.getUnitAt(N.x,N.y))continue;let G=e.getWallBetween(y.position.x,y.position.y,N.x,N.y);if(G&&(G.owner==="neutral"||G.owner==="ai")){let ue=(y.tier>=3?7e6:9e5)+o,Te=G.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(ye===null||ue>ye.score)&&(ye={unit:y,target:{x:y.position.x,y:y.position.y},score:ue,type:"wall_attack",reason:Te,edge:{from:F({},y.position),to:N}})}else if(G&&G.owner==="player"){let Te=[{x:N.x+1,y:N.y},{x:N.x-1,y:N.y},{x:N.x,y:N.y+1},{x:N.x,y:N.y-1}].filter(ot=>e.inBounds(ot.x,ot.y)).filter(ot=>e.getUnitAt(ot.x,ot.y)?!1:!e.getWallBetween(ot.x,ot.y,N.x,N.y)),Ue=Math.abs(y.position.x-N.x)+Math.abs(y.position.y-N.y);if((Te.length>0?Te.reduce((ot,Xe)=>{let Qt=Math.abs(y.position.x-Xe.x)+Math.abs(y.position.y-Xe.y)+1;return Math.min(ot,Qt)},1/0):1/0)-Ue>4){let ot=(y.tier>=3?8e6:y.tier===3&&y.level===1?105e4:85e4)+o;(ye===null||ot>ye.score)&&(ye={unit:y,target:{x:y.position.x,y:y.position.y},score:ot,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:F({},y.position),to:N}})}}}for(let U of Ti){let N={x:y.position.x+U.x,y:y.position.y+U.y};if(N.x===a.x&&N.y===a.y){let H=e.getWallBetween(y.position.x,y.position.y,N.x,N.y);if(H&&(H.owner==="neutral"||H.owner==="player")&&y.tier>=3){let G=8e6+o;(ye===null||G>ye.score)&&(ye={unit:y,target:{x:y.position.x,y:y.position.y},score:G,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:F({},y.position),to:N}})}}}if(ce){let U=Math.sign(ce.x-y.position.x),N=Math.sign(ce.y-y.position.y),H=y.position.x+(U!==0?U:0),G=y.position.y+(N!==0?N:0);if(e.inBounds(H,G)){let ue=e.getUnitAt(H,G);if(ue&&ue.owner==="ai")for(let Te of Ti){let Ue={x:y.position.x+Te.x,y:y.position.y+Te.y};if(!e.inBounds(Ue.x,Ue.y))continue;let Ye=e.getWallBetween(y.position.x,y.position.y,Ue.x,Ue.y);if(Ye&&(Ye.owner==="player"||Ye.owner==="neutral")){let Xe=(Ye.owner==="player"?65e4:6e5)+o;(ye===null||Xe>ye.score)&&(ye={unit:y,target:{x:y.position.x,y:y.position.y},score:Xe,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:F({},y.position),to:Ue}})}}}}if(ce){let U=ce.x-y.position.x,N=ce.y-y.position.y;if(U!==0&&N===0||U===0&&N!==0){let H=Math.sign(U),G=Math.sign(N),ue={x:y.position.x+H,y:y.position.y+G};if(e.inBounds(ue.x,ue.y)&&e.getWallBetween(y.position.x,y.position.y,ue.x,ue.y)){let Ue=(y.tier>=3?8e6:15e5)+o;(ye===null||Ue>ye.score)&&(ye={unit:y,target:{x:y.position.x,y:y.position.y},score:Ue,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:F({},y.position),to:ue}})}}if(Math.abs(U)>=1&&Math.abs(N)>=1){let H=Math.sign(U),G=Math.sign(N),ue={x:y.position.x+H,y:y.position.y+G};if(e.inBounds(ue.x,ue.y)&&this.combat.isDiagonalBlocked(y.position,ue,(Ue,Ye,ot,Xe)=>e.getWallBetween(Ue,Ye,ot,Xe))){let Ue={x:y.position.x+H,y:y.position.y},Ye={x:y.position.x,y:y.position.y+G},ot=e.getWallBetween(y.position.x,y.position.y,Ue.x,Ue.y),Xe=e.getWallBetween(y.position.x,y.position.y,Ye.x,Ye.y),Qt=null;if(ot?Qt={from:F({},y.position),to:Ue}:Xe&&(Qt={from:F({},y.position),to:Ye}),Qt){let yo=(y.tier>=3?8e6:15e5)+o;(ye===null||yo>ye.score)&&(ye={unit:y,target:{x:y.position.x,y:y.position.y},score:yo,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:Qt})}}}}let sy=d.length===0&&f.length===0&&!gt;if(vr>=2&&(sy||M.length>0))for(let U of Ti){let N={x:y.position.x+U.x,y:y.position.y+U.y};if(!e.inBounds(N.x,N.y))continue;let H=e.getWallBetween(y.position.x,y.position.y,N.x,N.y);if(H&&(H.owner==="neutral"||H.owner==="player")){let G=y.tier>=3?8e6:12e5;(ye===null||G>ye.score)&&(ye={unit:y,target:{x:y.position.x,y:y.position.y},score:G,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:F({},y.position),to:N}})}}let Br=M.filter(U=>Math.max(Math.abs(U.position.x-y.position.x),Math.abs(U.position.y-y.position.y))===1),mo=Br.length>0?Br.reduce((U,N)=>this.combat.calculateTotalPoints(N)>this.combat.calculateTotalPoints(U)?N:U,Br[0]):null,cs=os.length>0&&Me.some(U=>os.some(N=>N.x===U.x&&N.y===U.y));for(let U of Me){let N=0,H="Action",G=e.getUnitAt(U.x,U.y),ue=ie=>[{x:ie.x+1,y:ie.y},{x:ie.x-1,y:ie.y},{x:ie.x,y:ie.y+1},{x:ie.x,y:ie.y-1}].filter(ht=>e.inBounds(ht.x,ht.y)).filter(ht=>!e.getUnitAt(ht.x,ht.y)).length,Te=Math.max(Math.abs(y.position.x-s.x),Math.abs(y.position.y-s.y)),Ue=Math.max(Math.abs(U.x-s.x),Math.abs(U.y-s.y)),Ye=c.length?Math.min(...c.map(ie=>Math.abs(y.position.x-ie.x)+Math.abs(y.position.y-ie.y))):1/0,ot=c.length?Math.min(...c.map(ie=>Math.abs(U.x-ie.x)+Math.abs(U.y-ie.y))):1/0,Xe=c.filter(ie=>{let xe=e.getUnitAt(ie.x,ie.y);return!!xe&&xe.owner==="player"}),Qt=Xe.length?Math.min(...Xe.map(ie=>Math.abs(y.position.x-ie.x)+Math.abs(y.position.y-ie.y))):1/0,yo=Xe.length?Math.min(...Xe.map(ie=>Math.abs(U.x-ie.x)+Math.abs(U.y-ie.y))):1/0,il=new Map(e.unitMoveHistorySignal()).get(y.id),jn=Array.isArray(il)?il:[],Si=jn.length>=2?jn[jn.length-2]:null,Ct=jn.length>=3?jn[jn.length-3]:null,Hd=Si&&U.x===Si.x&&U.y===Si.y,Ci=Tn&&!e.isForest(U.x,U.y);if(x){let ie=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),xe=Math.abs(U.x-a.x)+Math.abs(U.y-a.y);xe<ie?(N+=5e7,H="FULL RUSH: Charge Base"):xe===ie?N+=1e5:N-=5e6,G&&G.owner==="player"&&Math.abs(G.position.x-a.x)+Math.abs(G.position.y-a.y)<ie&&(N+=2e7,H="FULL RUSH: Clear Path to Base"),Tn&&U.x===y.position.x&&U.y===y.position.y&&g>=3&&(N=-5e6,H="FULL RUSH: Abandon Forest for Assault")}else if(y.tier>=3&&Ci){let ie=Math.abs(U.x-a.x)+Math.abs(U.y-a.y)<=2,xe=M.some(bt=>Math.abs(U.x-bt.position.x)+Math.abs(U.y-bt.position.y)<=2),ht=e.unitsSignal().some(bt=>bt.owner==="ai"&&bt.id!==y.id&&Math.max(Math.abs(bt.position.x-y.position.x),Math.abs(bt.position.y-y.position.y))<=1);!T&&!(ie||xe)&&!ht&&(N-=2e6,H="Penalty: Leaving forest without replacement")}let Di=Ud.get(y.id),ay=Di&&Di.until>e.turnSignal()&&Di.tiles.has(`${U.x},${U.y}`);if(y.tier===1&&(Si&&U.x===Si.x&&U.y===Si.y||Ct&&U.x===Ct.x&&U.y===Ct.y)&&(N-=25e3,H="Anti-Loop Penalty"),y.tier<=2&&!G&&Ct&&U.x===Ct.x&&U.y===Ct.y&&(N=-1e6,H="Anti-Loop: Stay or different path"),ay&&(N-=3e4,H="Stutter Ban Penalty"),Tn&&Br.length===0&&!G&&Ci&&!q&&(N=-1e3),Tn&&y.tier<=2&&Ci&&Br.length>0&&Br.some(xe=>this.combat.calculateTotalPoints(xe)>this.combat.calculateTotalPoints(y))&&(N=-1e6,H="Hold Forest"),x)Tn&&U.x===y.position.x&&U.y===y.position.y&&g>=3&&(N=-5e6,H="FULL RUSH: Abandon Forest for Assault");else if(!G&&Tn&&U.x===y.position.x&&U.y===y.position.y){let ie=Br.some(ht=>this.combat.calculateTotalPoints(ht)>this.combat.calculateTotalPoints(y)),xe=T&&y.tier>=3;!ie&&!xe&&(N=Math.max(N,1e7),H="Hold: Stay on forest")}if(!G&&!x){if(e.isForest(U.x,U.y)&&!e.getUnitAt(U.x,U.y)&&(tl?(N=-1e3,H="Ignore Forest (Total War)"):y.tier>=3?(N=5e6*(re&&!q?3:1),H="Priority: T3 capture empty forest"):(N=1e6*(re&&!q?3:1),H=g<3?`Priority 0: Capture Forest ${U.x},${U.y}`:`Priority 1: Capture Forest ${U.x},${U.y}`,re&&!q&&Math.abs(y.position.x-U.x)+Math.abs(y.position.y-U.y)===1&&(N=Math.max(N,12e6),H=`Early Capture: Forest ${U.x},${U.y}`))),ce){let ie=Math.abs(y.position.x-ce.x)+Math.abs(y.position.y-ce.y),xe=Math.abs(U.x-ce.x)+Math.abs(U.y-ce.y);if(xe<ie&&(N+=5e4*(ie-xe),H=d.length>0?`Priority 1: Toward Forest ${ce.x},${ce.y}`:f.length>0?`Priority 7: Toward Fog Forest ${ce.x},${ce.y}`:`Toward Goal ${ce.x},${ce.y}`),m>10||S){let bt=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),mt=Math.abs(U.x-a.x)+Math.abs(U.y-a.y);mt<bt&&(N+=15e4*(bt-mt),H="Aggress: Toward Player Base"),yo<Qt&&(N+=12e4*(Qt-yo),H="Aggress: Toward Player Forest");let Yt=ue(U)-ue(y.position);Yt>0&&(N+=5e4*Yt,H="Unblock: Clear path")}if((()=>{let bt=Math.sign(ce.x-y.position.x),mt=Math.sign(ce.y-y.position.y),Yt=y.position.x+(bt!==0?bt:0),yt=y.position.y+(mt!==0?mt:0);return e.inBounds(Yt,yt)?!!e.getWallBetween(y.position.x,y.position.y,Yt,yt):!1})()&&U.x===y.position.x&&U.y===y.position.y){let mt=e.getWallBetween(y.position.x,y.position.y,y.position.x+Math.sign(ce.x-y.position.x),y.position.y+Math.sign(ce.y-y.position.y))?.owner;y.tier>=3?(N=Math.max(N,8e6+o),H="Breach: Wall blocks high-priority path"):(N+=(mt==="ai"?7e5:8e5)+o,H=mt==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(gt){let ie=Math.abs(y.position.x-gt.x)+Math.abs(y.position.y-gt.y),xe=Math.abs(U.x-gt.x)+Math.abs(U.y-gt.y);xe<ie&&(N+=2e5*(ie-xe),H="Approach Neutral Wall to Forest"),U.x===gt.x&&U.y===gt.y&&(N+=5e5,H="Position for Wall Breach")}if(U.x===a.x&&U.y===a.y&&(N+=1e4,H="Attack Base (Override)"),Et){let ie=os.some(yt=>yt.x===U.x&&yt.y===U.y),xe=Math.abs(y.position.x-Et.position.x)+Math.abs(y.position.y-Et.position.y),ht=Math.abs(U.x-Et.position.x)+Math.abs(U.y-Et.position.y),mt=Math.max(Math.abs(Et.position.x-s.x),Math.abs(Et.position.y-s.y))<=2,Yt=U.x===y.position.x&&U.y===y.position.y;if(y.tier>=3&&Et.tier>=3&&ht===1)N=4e7,H="DEFENSE: T3 Move to Intercept Threat";else if(ie){let yt=mt?25e5:15e5;N<yt&&(N=yt),N+=mt?2e4:5e3,H=mt?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(ht<xe){let yt=y.id===(go?.id??"")?1e6:5e3;N+=yt*(xe-ht),y.tier>=3&&(N+=4e3),H=y.id===(go?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}Yt&&cs&&(N-=mt?5e4:1e4,ae?H="Penalty: Standing Still With Imminent Base Threat":q&&(H="Penalty: Standing Still With Base Threat"))}if(y.tier>=3){let ie=Math.abs(y.position.x-a.x)+Math.abs(y.position.y-a.y),xe=Math.abs(U.x-a.x)+Math.abs(U.y-a.y);xe<ie&&(N+=2e3*(ie-xe),H="Hunter: Toward Base",T&&(N=Math.max(N,4e6),H="Hunt: Approach Base"))}if(Rn&&ot<Ye&&(N*=10),Ue>Te&&ot<Ye&&(N+=500),mo&&this.combat.calculateTotalPoints(mo)>this.combat.calculateTotalPoints(y)){let ie=Math.abs(y.position.x-mo.position.x)+Math.abs(y.position.y-mo.position.y),xe=Math.abs(U.x-mo.position.x)+Math.abs(U.y-mo.position.y);xe>ie&&(N+=75e3*(xe-ie),H="Retreat")}}else if(G.owner==="player"){let ie=Math.max(Math.abs(G.position.x-s.x),Math.abs(G.position.y-s.y)),xe=ie<=3,ht=ie<=2,bt=this.combat.calculateTotalPoints(y),mt=this.combat.calculateTotalPoints(G),Yt=bt>mt,yt=G.tier>=3,ls=y.tier>=3;y.tier>=3&&e.isForest(G.position.x,G.position.y)&&(N=1e7,H="Aggression: Liberate forest"),!Tn&&Tt&&Xe.length>0&&e.isForest(G.position.x,G.position.y)&&(N=12e6,H="LIBERATE: Attack player forest"),ie<=4&&(y.tier>=3||Yt)&&(N=15e6,H="INTERCEPT: Base Siege"),xe?ls&&yt?(N=5e7,H="CRITICAL DEFENSE: T3 Intercepts Threat"):Yt?(N=2e7,H="CRITICAL DEFENSE: Eliminate Base Threat",ht&&(N+=5e6)):yt&&y.tier<=2?(N=0,H="Ignore: T1 Suicide vs T3 useless"):(N=1e3,H="DEFENSE: Desperation Attack"):Yt?(yt?(N=8e6,H="COMBAT: Kill High Value Target (T3+)"):(N=4e6,H="COMBAT: Kill Enemy"),y.tier<G.tier&&(N+=2e6,H+=" (Efficient Trade)")):y.tier<=2?(N=0,H="Ignore: No guaranteed kill"):(N=1e5,H="COMBAT: Chip Damage"),R&&(N+=5e5),O&&(N+=1e6)}else if(G.tier===y.tier&&Ue>Te){let ie=this.combat.calculateTotalPoints(y)+this.combat.calculateTotalPoints(G),{tier:xe}=this.combat.calculateTierAndLevel(ie);xe>y.tier&&!Rn&&!Tn&&(N=1e3,H="Merge Up")}let _r="move";G&&G.owner==="player"&&(_r="attack"),G&&G.owner==="ai"&&G.tier===y.tier&&(_r="merge"),(m>10||S)&&_r==="merge"&&(N+=5e6,H="Anti-Stall: Merge first");let cy=this.interceptUntil.get(y.id)||0;if(y.id===(go?.id??"")&&cy>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Et){let ie=Math.abs(y.position.x-Et.position.x)+Math.abs(y.position.y-Et.position.y),xe=Math.abs(U.x-Et.position.x)+Math.abs(U.y-Et.position.y);xe<ie&&(N+=5e5*(ie-xe),H="DEFENSE: Intercept Lock")}Hd&&(N=Math.floor(N*.1),N-=3e5,H="Penalty: Inertia");let ly=(()=>{let ie=jn.slice(-6),xe=new Set(ie.map(ht=>`${ht.x},${ht.y}`));return ie.length>=6&&xe.size<=3})();if(y.tier===1&&ly){let ie=d.length>0?d:f;if(ie.length>0){let xe=ie.reduce((mt,Yt)=>{let yt=Math.abs(y.position.x-Yt.x)+Math.abs(y.position.y-Yt.y),ls=Math.abs(y.position.x-mt.x)+Math.abs(y.position.y-mt.y);return yt<ls?Yt:mt},ie[0]),ht=Math.abs(y.position.x-xe.x)+Math.abs(y.position.y-xe.y),bt=Math.abs(U.x-xe.x)+Math.abs(U.y-xe.y);bt<ht&&(N+=1e5*(ht-bt),H="Breakout: Toward Forest")}}(y.forestOccupationTurns??0)>0&&(U.x!==y.position.x||U.y!==y.position.y)&&(N-=2e3),(ye===null||N>ye.score)&&(ye={unit:y,target:U,score:N,type:_r,reason:H})}}if(!ye)return null;let ss=this.goals.get(ye.unit.id),Bd=ss?`Goal: Forest at ${ss.x},${ss.y}`:"Goal: None";return{type:ye.type,unit:ye.unit,target:ye.target,reason:ye.reason,edge:ye.edge}}getWallBuildActions(e){let t=[],r=e.unitsSignal().filter(d=>d.owner==="ai"),i=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,f)=>o.some(g=>g.tile1.x===d.x&&g.tile1.y===d.y&&g.tile2.x===f.x&&g.tile2.y===f.y||g.tile1.x===f.x&&g.tile1.y===f.y&&g.tile2.x===d.x&&g.tile2.y===d.y),c=(d,f)=>Math.abs(d.x-f.x)+Math.abs(d.y-f.y),u=(d,f)=>Math.max(Math.abs(d.x-f.x),Math.abs(d.y-f.y));for(let d of r){if(d.tier>=3)continue;let f=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(M=>e.inBounds(M.x,M.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let M of f)!a(d.position,M)&&e.canBuildWallBetween(d.position,M)&&t.push({from:d.position,to:M});continue}let g=i.filter(M=>u(d.position,M.position)<=2);if(g.length===0)continue;let m=g.sort((M,O)=>c(d.position,M.position)-c(d.position,O.position))[0],S=f.sort((M,O)=>c(M,m.position)-c(O,m.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let M of S)!a(d.position,M)&&e.canBuildWallBetween(d.position,M)&&t.push({from:d.position,to:M});else if(d.tier===2){let M=0;for(let O of S){if(M>=2)break;!a(d.position,O)&&e.canBuildWallBetween(d.position,O)&&(t.push({from:d.position,to:O}),M++)}}}return t}static \u0275fac=function(t){return new(t||n)(ve(gc),ve(wn))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var IR=()=>{};var CR=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},C6=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],s=n[t++],a=n[t++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},DR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],s=i+1<n.length,a=s?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,d=o>>2,f=(o&3)<<4|a>>4,g=(a&15)<<2|u>>6,m=u&63;c||(m=64,s||(g=64)),r.push(t[d],t[f],t[g],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(CR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):C6(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let u=i<n.length?t[n.charAt(i)]:64;++i;let f=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||u==null||f==null)throw new JE;let g=o<<2|a>>4;if(r.push(g),u!==64){let m=a<<4&240|u>>2;if(r.push(m),f!==64){let S=u<<6&192|f;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},JE=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},D6=function(n){let e=CR(n);return DR.encodeByteArray(e,!0)},zu=function(n){return D6(n).replace(/\./g,"")},fg=function(n){try{return DR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function xR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var x6=()=>xR().__FIREBASE_DEFAULTS__,A6=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},M6=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&fg(n[1]);return e&&JSON.parse(e)},pg=()=>{try{return IR()||x6()||A6()||M6()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},XE=n=>pg()?.emulatorHosts?.[n],AR=n=>{let e=XE(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},eb=()=>pg()?.config,tb=n=>pg()?.[`_${n}`];var hg=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function $o(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function gg(n){return(await fetch(n,{credentials:"include"})).ok}function MR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=F({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[zu(JSON.stringify(t)),zu(JSON.stringify(s)),""].join(".")}var Gu={};function R6(){let n={prod:[],emulator:[]};for(let e of Object.keys(Gu))Gu[e]?n.emulator.push(e):n.prod.push(e);return n}function N6(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var TR=!1;function mg(n,e){if(typeof window>"u"||typeof document>"u"||!$o(window.location.host)||Gu[n]===e||Gu[n]||TR)return;Gu[n]=e;function t(g){return`__firebase__banner__${g}`}let r="__firebase__banner",o=R6().prod.length>0;function s(){let g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,m){g.setAttribute("width","24"),g.setAttribute("id",m),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){let g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{TR=!0,s()},g}function d(g,m){g.setAttribute("id",m),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){let g=N6(r),m=t("text"),S=document.getElementById(m)||document.createElement("span"),M=t("learnmore"),O=document.getElementById(M)||document.createElement("a"),P=t("preprendIcon"),q=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){let $=g.element;a($),d(O,M);let ae=u();c(q,P),$.append(q,S,O,ae),document.body.appendChild($)}o?(S.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tn())}function P6(){let n=pg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PR(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function kR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function OR(){let n=tn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function FR(){return!P6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nb(){try{return typeof indexedDB=="object"}catch{return!1}}function LR(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var k6="FirebaseError",er=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=k6,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qi.prototype.create)}},Qi=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?O6(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new er(i,a,r)}};function O6(n,e){return n.replace(F6,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var F6=/\{\$([^}]+)}/g;function VR(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function kr(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],s=e[i];if(SR(o)&&SR(s)){if(!kr(o,s))return!1}else if(o!==s)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function SR(n){return n!==null&&typeof n=="object"}function mc(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function UR(n,e){let t=new ZE(n,e);return t.subscribe.bind(t)}var ZE=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");L6(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=YE),i.error===void 0&&(i.error=YE),i.complete===void 0&&(i.complete=YE);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function L6(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function YE(){}var Cae=14400*1e3;function nn(n){return n&&n._delegate?n._delegate:n}var fr=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Zs="[DEFAULT]";var rb=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new hg;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(U6(e))try{this.getOrInitializeService({instanceIdentifier:Zs})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zs){return this.instances.has(e)}getOptions(e=Zs){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:V6(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zs){return this.component?this.component.multipleInstances?e:Zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function V6(n){return n===Zs?void 0:n}function U6(n){return n.instantiationMode==="EAGER"}var yg=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new rb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var B6=[],Be=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Be||{}),j6={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},H6=Be.INFO,$6={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},G6=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=$6[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Go=class{constructor(e){this.name=e,this._logLevel=H6,this._logHandler=G6,this._userLogHandler=null,B6.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?j6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}};var z6=(n,e)=>e.some(t=>n instanceof t),BR,jR;function q6(){return BR||(BR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function W6(){return jR||(jR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var HR=new WeakMap,ob=new WeakMap,$R=new WeakMap,ib=new WeakMap,ab=new WeakMap;function K6(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(ui(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&HR.set(t,n)}).catch(()=>{}),ab.set(e,n),e}function Q6(n){if(ob.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});ob.set(n,e)}var sb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ob.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$R.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ui(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function GR(n){sb=n(sb)}function Y6(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(vg(this),e,...t);return $R.set(r,e.sort?e.sort():[e]),ui(r)}:W6().includes(n)?function(...e){return n.apply(vg(this),e),ui(HR.get(this))}:function(...e){return ui(n.apply(vg(this),e))}}function J6(n){return typeof n=="function"?Y6(n):(n instanceof IDBTransaction&&Q6(n),z6(n,q6())?new Proxy(n,sb):n)}function ui(n){if(n instanceof IDBRequest)return K6(n);if(ib.has(n))return ib.get(n);let e=J6(n);return e!==n&&(ib.set(n,e),ab.set(e,n)),e}var vg=n=>ab.get(n);function qR(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(n,e),a=ui(s);return r&&s.addEventListener("upgradeneeded",c=>{r(ui(s.result),c.oldVersion,c.newVersion,ui(s.transaction),c)}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var Z6=["get","getKey","getAll","getAllKeys","count"],X6=["put","add","delete","clear"],cb=new Map;function zR(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cb.get(e))return cb.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=X6.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Z6.includes(t)))return;let o=async function(s,...a){let c=this.transaction(s,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),i&&c.done]))[0]};return cb.set(e,o),o}GR(n=>le(F({},n),{get:(e,t,r)=>zR(e,t)||n.get(e,t,r),has:(e,t)=>!!zR(e,t)||n.has(e,t)}));var ub=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(e8(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function e8(n){return n.getComponent()?.type==="VERSION"}var db="@firebase/app",WR="0.14.7";var Yi=new Go("@firebase/app"),t8="@firebase/app-compat",n8="@firebase/analytics-compat",r8="@firebase/analytics",i8="@firebase/app-check-compat",o8="@firebase/app-check",s8="@firebase/auth",a8="@firebase/auth-compat",c8="@firebase/database",l8="@firebase/data-connect",u8="@firebase/database-compat",d8="@firebase/functions",h8="@firebase/functions-compat",f8="@firebase/installations",p8="@firebase/installations-compat",g8="@firebase/messaging",m8="@firebase/messaging-compat",y8="@firebase/performance",v8="@firebase/performance-compat",_8="@firebase/remote-config",E8="@firebase/remote-config-compat",b8="@firebase/storage",w8="@firebase/storage-compat",I8="@firebase/firestore",T8="@firebase/ai",S8="@firebase/firestore-compat",C8="firebase",D8="12.8.0";var hb="[DEFAULT]",x8={[db]:"fire-core",[t8]:"fire-core-compat",[r8]:"fire-analytics",[n8]:"fire-analytics-compat",[o8]:"fire-app-check",[i8]:"fire-app-check-compat",[s8]:"fire-auth",[a8]:"fire-auth-compat",[c8]:"fire-rtdb",[l8]:"fire-data-connect",[u8]:"fire-rtdb-compat",[d8]:"fire-fn",[h8]:"fire-fn-compat",[f8]:"fire-iid",[p8]:"fire-iid-compat",[g8]:"fire-fcm",[m8]:"fire-fcm-compat",[y8]:"fire-perf",[v8]:"fire-perf-compat",[_8]:"fire-rc",[E8]:"fire-rc-compat",[b8]:"fire-gcs",[w8]:"fire-gcs-compat",[I8]:"fire-fst",[S8]:"fire-fst-compat",[T8]:"fire-vertex","fire-js":"fire-js",[C8]:"fire-js-all"};var _g=new Map,A8=new Map,fb=new Map;function KR(n,e){try{n.container.addComponent(e)}catch(t){Yi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function qo(n){let e=n.name;if(fb.has(e))return Yi.debug(`There were multiple attempts to register component ${e}.`),!1;fb.set(e,n);for(let t of _g.values())KR(t,n);for(let t of A8.values())KR(t,n);return!0}function Wu(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function tr(n){return n==null?!1:n.settings!==void 0}var M8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zo=new Qi("app","Firebase",M8);var pb=class{constructor(e,t,r){this._isDeleted=!1,this._options=F({},e),this._config=F({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zo.create("app-deleted",{appName:this._name})}};var Wo=D8;function Ku(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=F({name:hb,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw zo.create("bad-app-name",{appName:String(i)});if(t||(t=eb()),!t)throw zo.create("no-options");let o=_g.get(i);if(o){if(kr(t,o.options)&&kr(r,o.config))return o;throw zo.create("duplicate-app",{appName:i})}let s=new yg(i);for(let c of fb.values())s.addComponent(c);let a=new pb(t,r,s);return _g.set(i,a),a}function Eg(n=hb){let e=_g.get(n);if(!e&&n===hb&&eb())return Ku();if(!e)throw zo.create("no-app",{appName:n});return e}function Or(n,e,t){let r=x8[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){let s=[`Unable to register library "${r}" with version "${e}":`];i&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yi.warn(s.join(" "));return}qo(new fr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var R8="firebase-heartbeat-database",N8=1,qu="firebase-heartbeat-store",lb=null;function ZR(){return lb||(lb=qR(R8,N8,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(qu)}catch(t){console.warn(t)}}}}).catch(n=>{throw zo.create("idb-open",{originalErrorMessage:n.message})})),lb}async function P8(n){try{let t=(await ZR()).transaction(qu),r=await t.objectStore(qu).get(XR(n));return await t.done,r}catch(e){if(e instanceof er)Yi.warn(e.message);else{let t=zo.create("idb-get",{originalErrorMessage:e?.message});Yi.warn(t.message)}}}async function QR(n,e){try{let r=(await ZR()).transaction(qu,"readwrite");await r.objectStore(qu).put(e,XR(n)),await r.done}catch(t){if(t instanceof er)Yi.warn(t.message);else{let r=zo.create("idb-set",{originalErrorMessage:t?.message});Yi.warn(r.message)}}}function XR(n){return`${n.name}!${n.options.appId}`}var k8=1024,O8=30,gb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new mb(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=YR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>O8){let i=L8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Yi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=YR(),{heartbeatsToSend:t,unsentEntries:r}=F8(this._heartbeatsCache.heartbeats),i=zu(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Yi.warn(e),""}}};function YR(){return new Date().toISOString().substring(0,10)}function F8(n,e=k8){let t=[],r=n.slice();for(let i of n){let o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),JR(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),JR(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var mb=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nb()?LR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await P8(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return QR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return QR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function JR(n){return zu(JSON.stringify({version:2,heartbeats:n})).length}function L8(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function V8(n){qo(new fr("platform-logger",e=>new ub(e),"PRIVATE")),qo(new fr("heartbeat",e=>new gb(e),"PRIVATE")),Or(db,WR,n),Or(db,WR,"esm2020"),Or("fire-js","")}V8("");var U8="firebase",B8="12.8.0";Or(U8,B8,"app");var eN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tN={};var Ji,yb;(function(){var n;function e(D,I){function C(){}C.prototype=I.prototype,D.F=I.prototype,D.prototype=new C,D.prototype.constructor=D,D.D=function(x,A,R){for(var T=Array(arguments.length-2),Tt=2;Tt<arguments.length;Tt++)T[Tt-2]=arguments[Tt];return I.prototype[A].apply(x,T)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,I,C){C||(C=0);let x=Array(16);if(typeof I=="string")for(var A=0;A<16;++A)x[A]=I.charCodeAt(C++)|I.charCodeAt(C++)<<8|I.charCodeAt(C++)<<16|I.charCodeAt(C++)<<24;else for(A=0;A<16;++A)x[A]=I[C++]|I[C++]<<8|I[C++]<<16|I[C++]<<24;I=D.g[0],C=D.g[1],A=D.g[2];let R=D.g[3],T;T=I+(R^C&(A^R))+x[0]+3614090360&4294967295,I=C+(T<<7&4294967295|T>>>25),T=R+(A^I&(C^A))+x[1]+3905402710&4294967295,R=I+(T<<12&4294967295|T>>>20),T=A+(C^R&(I^C))+x[2]+606105819&4294967295,A=R+(T<<17&4294967295|T>>>15),T=C+(I^A&(R^I))+x[3]+3250441966&4294967295,C=A+(T<<22&4294967295|T>>>10),T=I+(R^C&(A^R))+x[4]+4118548399&4294967295,I=C+(T<<7&4294967295|T>>>25),T=R+(A^I&(C^A))+x[5]+1200080426&4294967295,R=I+(T<<12&4294967295|T>>>20),T=A+(C^R&(I^C))+x[6]+2821735955&4294967295,A=R+(T<<17&4294967295|T>>>15),T=C+(I^A&(R^I))+x[7]+4249261313&4294967295,C=A+(T<<22&4294967295|T>>>10),T=I+(R^C&(A^R))+x[8]+1770035416&4294967295,I=C+(T<<7&4294967295|T>>>25),T=R+(A^I&(C^A))+x[9]+2336552879&4294967295,R=I+(T<<12&4294967295|T>>>20),T=A+(C^R&(I^C))+x[10]+4294925233&4294967295,A=R+(T<<17&4294967295|T>>>15),T=C+(I^A&(R^I))+x[11]+2304563134&4294967295,C=A+(T<<22&4294967295|T>>>10),T=I+(R^C&(A^R))+x[12]+1804603682&4294967295,I=C+(T<<7&4294967295|T>>>25),T=R+(A^I&(C^A))+x[13]+4254626195&4294967295,R=I+(T<<12&4294967295|T>>>20),T=A+(C^R&(I^C))+x[14]+2792965006&4294967295,A=R+(T<<17&4294967295|T>>>15),T=C+(I^A&(R^I))+x[15]+1236535329&4294967295,C=A+(T<<22&4294967295|T>>>10),T=I+(A^R&(C^A))+x[1]+4129170786&4294967295,I=C+(T<<5&4294967295|T>>>27),T=R+(C^A&(I^C))+x[6]+3225465664&4294967295,R=I+(T<<9&4294967295|T>>>23),T=A+(I^C&(R^I))+x[11]+643717713&4294967295,A=R+(T<<14&4294967295|T>>>18),T=C+(R^I&(A^R))+x[0]+3921069994&4294967295,C=A+(T<<20&4294967295|T>>>12),T=I+(A^R&(C^A))+x[5]+3593408605&4294967295,I=C+(T<<5&4294967295|T>>>27),T=R+(C^A&(I^C))+x[10]+38016083&4294967295,R=I+(T<<9&4294967295|T>>>23),T=A+(I^C&(R^I))+x[15]+3634488961&4294967295,A=R+(T<<14&4294967295|T>>>18),T=C+(R^I&(A^R))+x[4]+3889429448&4294967295,C=A+(T<<20&4294967295|T>>>12),T=I+(A^R&(C^A))+x[9]+568446438&4294967295,I=C+(T<<5&4294967295|T>>>27),T=R+(C^A&(I^C))+x[14]+3275163606&4294967295,R=I+(T<<9&4294967295|T>>>23),T=A+(I^C&(R^I))+x[3]+4107603335&4294967295,A=R+(T<<14&4294967295|T>>>18),T=C+(R^I&(A^R))+x[8]+1163531501&4294967295,C=A+(T<<20&4294967295|T>>>12),T=I+(A^R&(C^A))+x[13]+2850285829&4294967295,I=C+(T<<5&4294967295|T>>>27),T=R+(C^A&(I^C))+x[2]+4243563512&4294967295,R=I+(T<<9&4294967295|T>>>23),T=A+(I^C&(R^I))+x[7]+1735328473&4294967295,A=R+(T<<14&4294967295|T>>>18),T=C+(R^I&(A^R))+x[12]+2368359562&4294967295,C=A+(T<<20&4294967295|T>>>12),T=I+(C^A^R)+x[5]+4294588738&4294967295,I=C+(T<<4&4294967295|T>>>28),T=R+(I^C^A)+x[8]+2272392833&4294967295,R=I+(T<<11&4294967295|T>>>21),T=A+(R^I^C)+x[11]+1839030562&4294967295,A=R+(T<<16&4294967295|T>>>16),T=C+(A^R^I)+x[14]+4259657740&4294967295,C=A+(T<<23&4294967295|T>>>9),T=I+(C^A^R)+x[1]+2763975236&4294967295,I=C+(T<<4&4294967295|T>>>28),T=R+(I^C^A)+x[4]+1272893353&4294967295,R=I+(T<<11&4294967295|T>>>21),T=A+(R^I^C)+x[7]+4139469664&4294967295,A=R+(T<<16&4294967295|T>>>16),T=C+(A^R^I)+x[10]+3200236656&4294967295,C=A+(T<<23&4294967295|T>>>9),T=I+(C^A^R)+x[13]+681279174&4294967295,I=C+(T<<4&4294967295|T>>>28),T=R+(I^C^A)+x[0]+3936430074&4294967295,R=I+(T<<11&4294967295|T>>>21),T=A+(R^I^C)+x[3]+3572445317&4294967295,A=R+(T<<16&4294967295|T>>>16),T=C+(A^R^I)+x[6]+76029189&4294967295,C=A+(T<<23&4294967295|T>>>9),T=I+(C^A^R)+x[9]+3654602809&4294967295,I=C+(T<<4&4294967295|T>>>28),T=R+(I^C^A)+x[12]+3873151461&4294967295,R=I+(T<<11&4294967295|T>>>21),T=A+(R^I^C)+x[15]+530742520&4294967295,A=R+(T<<16&4294967295|T>>>16),T=C+(A^R^I)+x[2]+3299628645&4294967295,C=A+(T<<23&4294967295|T>>>9),T=I+(A^(C|~R))+x[0]+4096336452&4294967295,I=C+(T<<6&4294967295|T>>>26),T=R+(C^(I|~A))+x[7]+1126891415&4294967295,R=I+(T<<10&4294967295|T>>>22),T=A+(I^(R|~C))+x[14]+2878612391&4294967295,A=R+(T<<15&4294967295|T>>>17),T=C+(R^(A|~I))+x[5]+4237533241&4294967295,C=A+(T<<21&4294967295|T>>>11),T=I+(A^(C|~R))+x[12]+1700485571&4294967295,I=C+(T<<6&4294967295|T>>>26),T=R+(C^(I|~A))+x[3]+2399980690&4294967295,R=I+(T<<10&4294967295|T>>>22),T=A+(I^(R|~C))+x[10]+4293915773&4294967295,A=R+(T<<15&4294967295|T>>>17),T=C+(R^(A|~I))+x[1]+2240044497&4294967295,C=A+(T<<21&4294967295|T>>>11),T=I+(A^(C|~R))+x[8]+1873313359&4294967295,I=C+(T<<6&4294967295|T>>>26),T=R+(C^(I|~A))+x[15]+4264355552&4294967295,R=I+(T<<10&4294967295|T>>>22),T=A+(I^(R|~C))+x[6]+2734768916&4294967295,A=R+(T<<15&4294967295|T>>>17),T=C+(R^(A|~I))+x[13]+1309151649&4294967295,C=A+(T<<21&4294967295|T>>>11),T=I+(A^(C|~R))+x[4]+4149444226&4294967295,I=C+(T<<6&4294967295|T>>>26),T=R+(C^(I|~A))+x[11]+3174756917&4294967295,R=I+(T<<10&4294967295|T>>>22),T=A+(I^(R|~C))+x[2]+718787259&4294967295,A=R+(T<<15&4294967295|T>>>17),T=C+(R^(A|~I))+x[9]+3951481745&4294967295,D.g[0]=D.g[0]+I&4294967295,D.g[1]=D.g[1]+(A+(T<<21&4294967295|T>>>11))&4294967295,D.g[2]=D.g[2]+A&4294967295,D.g[3]=D.g[3]+R&4294967295}r.prototype.v=function(D,I){I===void 0&&(I=D.length);let C=I-this.blockSize,x=this.C,A=this.h,R=0;for(;R<I;){if(A==0)for(;R<=C;)i(this,D,R),R+=this.blockSize;if(typeof D=="string"){for(;R<I;)if(x[A++]=D.charCodeAt(R++),A==this.blockSize){i(this,x),A=0;break}}else for(;R<I;)if(x[A++]=D[R++],A==this.blockSize){i(this,x),A=0;break}}this.h=A,this.o+=I},r.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var I=1;I<D.length-8;++I)D[I]=0;I=this.o*8;for(var C=D.length-8;C<D.length;++C)D[C]=I&255,I/=256;for(this.v(D),D=Array(16),I=0,C=0;C<4;++C)for(let x=0;x<32;x+=8)D[I++]=this.g[C]>>>x&255;return D};function o(D,I){var C=a;return Object.prototype.hasOwnProperty.call(C,D)?C[D]:C[D]=I(D)}function s(D,I){this.h=I;let C=[],x=!0;for(let A=D.length-1;A>=0;A--){let R=D[A]|0;x&&R==I||(C[A]=R,x=!1)}this.g=C}var a={};function c(D){return-128<=D&&D<128?o(D,function(I){return new s([I|0],I<0?-1:0)}):new s([D|0],D<0?-1:0)}function u(D){if(isNaN(D)||!isFinite(D))return f;if(D<0)return O(u(-D));let I=[],C=1;for(let x=0;D>=C;x++)I[x]=D/C|0,C*=4294967296;return new s(I,0)}function d(D,I){if(D.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(D.charAt(0)=="-")return O(d(D.substring(1),I));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');let C=u(Math.pow(I,8)),x=f;for(let R=0;R<D.length;R+=8){var A=Math.min(8,D.length-R);let T=parseInt(D.substring(R,R+A),I);A<8?(A=u(Math.pow(I,A)),x=x.j(A).add(u(T))):(x=x.j(C),x=x.add(u(T)))}return x}var f=c(0),g=c(1),m=c(16777216);n=s.prototype,n.m=function(){if(M(this))return-O(this).m();let D=0,I=1;for(let C=0;C<this.g.length;C++){let x=this.i(C);D+=(x>=0?x:4294967296+x)*I,I*=4294967296}return D},n.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(S(this))return"0";if(M(this))return"-"+O(this).toString(D);let I=u(Math.pow(D,6));var C=this;let x="";for(;;){let A=ae(C,I).g;C=P(C,A.j(I));let R=((C.g.length>0?C.g[0]:C.h)>>>0).toString(D);if(C=A,S(C))return R+x;for(;R.length<6;)R="0"+R;x=R+x}},n.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function S(D){if(D.h!=0)return!1;for(let I=0;I<D.g.length;I++)if(D.g[I]!=0)return!1;return!0}function M(D){return D.h==-1}n.l=function(D){return D=P(this,D),M(D)?-1:S(D)?0:1};function O(D){let I=D.g.length,C=[];for(let x=0;x<I;x++)C[x]=~D.g[x];return new s(C,~D.h).add(g)}n.abs=function(){return M(this)?O(this):this},n.add=function(D){let I=Math.max(this.g.length,D.g.length),C=[],x=0;for(let A=0;A<=I;A++){let R=x+(this.i(A)&65535)+(D.i(A)&65535),T=(R>>>16)+(this.i(A)>>>16)+(D.i(A)>>>16);x=T>>>16,R&=65535,T&=65535,C[A]=T<<16|R}return new s(C,C[C.length-1]&-2147483648?-1:0)};function P(D,I){return D.add(O(I))}n.j=function(D){if(S(this)||S(D))return f;if(M(this))return M(D)?O(this).j(O(D)):O(O(this).j(D));if(M(D))return O(this.j(O(D)));if(this.l(m)<0&&D.l(m)<0)return u(this.m()*D.m());let I=this.g.length+D.g.length,C=[];for(var x=0;x<2*I;x++)C[x]=0;for(x=0;x<this.g.length;x++)for(let A=0;A<D.g.length;A++){let R=this.i(x)>>>16,T=this.i(x)&65535,Tt=D.i(A)>>>16,Kt=D.i(A)&65535;C[2*x+2*A]+=T*Kt,q(C,2*x+2*A),C[2*x+2*A+1]+=R*Kt,q(C,2*x+2*A+1),C[2*x+2*A+1]+=T*Tt,q(C,2*x+2*A+1),C[2*x+2*A+2]+=R*Tt,q(C,2*x+2*A+2)}for(D=0;D<I;D++)C[D]=C[2*D+1]<<16|C[2*D];for(D=I;D<2*I;D++)C[D]=0;return new s(C,0)};function q(D,I){for(;(D[I]&65535)!=D[I];)D[I+1]+=D[I]>>>16,D[I]&=65535,I++}function $(D,I){this.g=D,this.h=I}function ae(D,I){if(S(I))throw Error("division by zero");if(S(D))return new $(f,f);if(M(D))return I=ae(O(D),I),new $(O(I.g),O(I.h));if(M(I))return I=ae(D,O(I)),new $(O(I.g),I.h);if(D.g.length>30){if(M(D)||M(I))throw Error("slowDivide_ only works with positive integers.");for(var C=g,x=I;x.l(D)<=0;)C=be(C),x=be(x);var A=re(C,1),R=re(x,1);for(x=re(x,2),C=re(C,2);!S(x);){var T=R.add(x);T.l(D)<=0&&(A=A.add(C),R=T),x=re(x,1),C=re(C,1)}return I=P(D,A.j(I)),new $(A,I)}for(A=f;D.l(I)>=0;){for(C=Math.max(1,Math.floor(D.m()/I.m())),x=Math.ceil(Math.log(C)/Math.LN2),x=x<=48?1:Math.pow(2,x-48),R=u(C),T=R.j(I);M(T)||T.l(D)>0;)C-=x,R=u(C),T=R.j(I);S(R)&&(R=g),A=A.add(R),D=P(D,T)}return new $(A,D)}n.B=function(D){return ae(this,D).h},n.and=function(D){let I=Math.max(this.g.length,D.g.length),C=[];for(let x=0;x<I;x++)C[x]=this.i(x)&D.i(x);return new s(C,this.h&D.h)},n.or=function(D){let I=Math.max(this.g.length,D.g.length),C=[];for(let x=0;x<I;x++)C[x]=this.i(x)|D.i(x);return new s(C,this.h|D.h)},n.xor=function(D){let I=Math.max(this.g.length,D.g.length),C=[];for(let x=0;x<I;x++)C[x]=this.i(x)^D.i(x);return new s(C,this.h^D.h)};function be(D){let I=D.g.length+1,C=[];for(let x=0;x<I;x++)C[x]=D.i(x)<<1|D.i(x-1)>>>31;return new s(C,D.h)}function re(D,I){let C=I>>5;I%=32;let x=D.g.length-C,A=[];for(let R=0;R<x;R++)A[R]=I>0?D.i(R+C)>>>I|D.i(R+C+1)<<32-I:D.i(R+C);return new s(A,D.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,yb=tN.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=d,Ji=tN.Integer=s}).apply(typeof eN<"u"?eN:typeof self<"u"?self:typeof window<"u"?window:{});var bg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zi={};var vb,j8,yc,_b,Qu,wg,Eb,bb,wb;(function(){var n,e=Object.defineProperty;function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof bg=="object"&&bg];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(l,h){if(h)e:{var p=r;l=l.split(".");for(var _=0;_<l.length-1;_++){var k=l[_];if(!(k in p))break e;p=p[k]}l=l[l.length-1],_=p[l],h=h(_),h!=_&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}i("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(l){return l||function(h){var p=[],_;for(_ in h)Object.prototype.hasOwnProperty.call(h,_)&&p.push([_,h[_]]);return p}});var o=o||{},s=this||self;function a(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function c(l,h,p){return l.call.apply(l.bind,arguments)}function u(l,h,p){return u=c,u.apply(null,arguments)}function d(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function f(l,h){function p(){}p.prototype=h.prototype,l.Z=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(_,k,L){for(var X=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)X[Ve-2]=arguments[Ve];return h.prototype[k].apply(_,X)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function m(l){let h=l.length;if(h>0){let p=Array(h);for(let _=0;_<h;_++)p[_]=l[_];return p}return[]}function S(l,h){for(let _=1;_<arguments.length;_++){let k=arguments[_];var p=typeof k;if(p=p!="object"?p:k?Array.isArray(k)?"array":p:"null",p=="array"||p=="object"&&typeof k.length=="number"){p=l.length||0;let L=k.length||0;l.length=p+L;for(let X=0;X<L;X++)l[p+X]=k[X]}else l.push(k)}}class M{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function O(l){s.setTimeout(()=>{throw l},0)}function P(){var l=D;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class q{constructor(){this.h=this.g=null}add(h,p){let _=$.get();_.set(h,p),this.h?this.h.next=_:this.g=_,this.h=_}}var $=new M(()=>new ae,l=>l.reset());class ae{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let be,re=!1,D=new q,I=()=>{let l=Promise.resolve(void 0);be=()=>{l.then(C)}};function C(){for(var l;l=P();){try{l.h.call(l.g)}catch(p){O(p)}var h=$;h.j(l),h.h<100&&(h.h++,l.next=h.g,h.g=l)}re=!1}function x(){this.u=this.u,this.C=this.C}x.prototype.u=!1,x.prototype.dispose=function(){this.u||(this.u=!0,this.N())},x.prototype[Symbol.dispose]=function(){this.dispose()},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let p=()=>{};s.addEventListener("test",p,h),s.removeEventListener("test",p,h)}catch{}return l})();function T(l){return/^[\s\xa0]*$/.test(l)}function Tt(l,h){A.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,h)}f(Tt,A),Tt.prototype.init=function(l,h){let p=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget,h||(p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement)),this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&Tt.Z.h.call(this)},Tt.prototype.h=function(){Tt.Z.h.call(this);let l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Kt="closure_listenable_"+(Math.random()*1e6|0),ye=0;function Bn(l,h,p,_,k){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!_,this.ha=k,this.key=++ye,this.da=this.fa=!1}function Ii(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Et(l,h,p){for(let _ in l)h.call(p,l[_],_,l)}function go(l,h){for(let p in l)h.call(void 0,l[p],p,l)}function os(l){let h={};for(let p in l)h[p]=l[p];return h}let Vd="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ud(l,h){let p,_;for(let k=1;k<arguments.length;k++){_=arguments[k];for(p in _)l[p]=_[p];for(let L=0;L<Vd.length;L++)p=Vd[L],Object.prototype.hasOwnProperty.call(_,p)&&(l[p]=_[p])}}function yr(l){this.src=l,this.g={},this.h=0}yr.prototype.add=function(l,h,p,_,k){let L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);let X=Bd(l,h,_,k);return X>-1?(h=l[X],p||(h.fa=!1)):(h=new Bn(h,this.src,L,!!_,k),h.fa=p,l.push(h)),h};function ss(l,h){let p=h.type;if(p in l.g){var _=l.g[p],k=Array.prototype.indexOf.call(_,h,void 0),L;(L=k>=0)&&Array.prototype.splice.call(_,k,1),L&&(Ii(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function Bd(l,h,p,_){for(let k=0;k<l.length;++k){let L=l[k];if(!L.da&&L.listener==h&&L.capture==!!p&&L.ha==_)return k}return-1}var y="closure_lm_"+(Math.random()*1e6|0),Me={};function Rn(l,h,p,_,k){if(_&&_.once)return as(l,h,p,_,k);if(Array.isArray(h)){for(let L=0;L<h.length;L++)Rn(l,h[L],p,_,k);return null}return p=rl(p),l&&l[Kt]?l.J(h,p,a(_)?!!_.capture:!!_,k):vr(l,h,p,!1,_,k)}function vr(l,h,p,_,k,L){if(!h)throw Error("Invalid event type");let X=a(k)?!!k.capture:!!k,Ve=Tn(l);if(Ve||(l[y]=Ve=new yr(l)),p=Ve.add(h,p,_,X,L),p.proxy)return p;if(_=ce(),p.proxy=_,_.src=l,_.listener=p,l.addEventListener)R||(k=X),k===void 0&&(k=!1),l.addEventListener(h.toString(),_,k);else if(l.attachEvent)l.attachEvent(tl(h.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function ce(){function l(p){return h.call(l.src,l.listener,p)}let h=ET;return l}function as(l,h,p,_,k){if(Array.isArray(h)){for(let L=0;L<h.length;L++)as(l,h[L],p,_,k);return null}return p=rl(p),l&&l[Kt]?l.K(h,p,a(_)?!!_.capture:!!_,k):vr(l,h,p,!0,_,k)}function jd(l,h,p,_,k){if(Array.isArray(h))for(var L=0;L<h.length;L++)jd(l,h[L],p,_,k);else _=a(_)?!!_.capture:!!_,p=rl(p),l&&l[Kt]?(l=l.i,L=String(h).toString(),L in l.g&&(h=l.g[L],p=Bd(h,p,_,k),p>-1&&(Ii(h[p]),Array.prototype.splice.call(h,p,1),h.length==0&&(delete l.g[L],l.h--)))):l&&(l=Tn(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Bd(h,p,_,k)),(p=l>-1?h[l]:null)&&el(p))}function el(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Kt])ss(h.i,l);else{var p=l.type,_=l.proxy;h.removeEventListener?h.removeEventListener(p,_,l.capture):h.detachEvent?h.detachEvent(tl(p),_):h.addListener&&h.removeListener&&h.removeListener(_),(p=Tn(h))?(ss(p,l),p.h==0&&(p.src=null,h[y]=null)):Ii(l)}}}function tl(l){return l in Me?Me[l]:Me[l]="on"+l}function ET(l,h){if(l.da)l=!0;else{h=new Tt(h,this);let p=l.listener,_=l.ha||l.src;l.fa&&el(l),l=p.call(_,h)}return l}function Tn(l){return l=l[y],l instanceof yr?l:null}var nl="__closure_events_fn_"+(Math.random()*1e9>>>0);function rl(l){return typeof l=="function"?l:(l[nl]||(l[nl]=function(h){return l.handleEvent(h)}),l[nl])}function sn(){x.call(this),this.i=new yr(this),this.M=this,this.G=null}f(sn,x),sn.prototype[Kt]=!0,sn.prototype.removeEventListener=function(l,h,p,_){jd(this,l,h,p,_)};function gt(l,h){var p,_=l.G;if(_)for(p=[];_;_=_.G)p.push(_);if(l=l.M,_=h.type||h,typeof h=="string")h=new A(h,l);else if(h instanceof A)h.target=h.target||l;else{var k=h;h=new A(_,l),Ud(h,k)}k=!0;let L,X;if(p)for(X=p.length-1;X>=0;X--)L=h.g=p[X],k=Ti(L,_,!0,h)&&k;if(L=h.g=l,k=Ti(L,_,!0,h)&&k,k=Ti(L,_,!1,h)&&k,p)for(X=0;X<p.length;X++)L=h.g=p[X],k=Ti(L,_,!1,h)&&k}sn.prototype.N=function(){if(sn.Z.N.call(this),this.i){var l=this.i;for(let h in l.g){let p=l.g[h];for(let _=0;_<p.length;_++)Ii(p[_]);delete l.g[h],l.h--}}this.G=null},sn.prototype.J=function(l,h,p,_){return this.i.add(String(l),h,!1,p,_)},sn.prototype.K=function(l,h,p,_){return this.i.add(String(l),h,!0,p,_)};function Ti(l,h,p,_){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();let k=!0;for(let L=0;L<h.length;++L){let X=h[L];if(X&&!X.da&&X.capture==p){let Ve=X.listener,qt=X.ha||X.src;X.fa&&ss(l.i,X),k=Ve.call(qt,_)!==!1&&k}}return k&&!_.defaultPrevented}function sy(l,h){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=u(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:s.setTimeout(l,h||0)}function Br(l){l.g=sy(()=>{l.g=null,l.i&&(l.i=!1,Br(l))},l.l);let h=l.h;l.h=null,l.m.apply(null,h)}class mo extends x{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Br(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cs(l){x.call(this),this.h=l,this.g={}}f(cs,x);var U=[];function N(l){Et(l.g,function(h,p){this.g.hasOwnProperty(p)&&el(h)},l),l.g={}}cs.prototype.N=function(){cs.Z.N.call(this),N(this)},cs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var H=s.JSON.stringify,G=s.JSON.parse,ue=class{stringify(l){return s.JSON.stringify(l,void 0)}parse(l){return s.JSON.parse(l,void 0)}};function Te(){}function Ue(){}var Ye={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ot(){A.call(this,"d")}f(ot,A);function Xe(){A.call(this,"c")}f(Xe,A);var Qt={},yo=null;function Ea(){return yo=yo||new sn}Qt.Ia="serverreachability";function il(l){A.call(this,Qt.Ia,l)}f(il,A);function jn(l){let h=Ea();gt(h,new il(h))}Qt.STAT_EVENT="statevent";function Si(l,h){A.call(this,Qt.STAT_EVENT,l),this.stat=h}f(Si,A);function Ct(l){let h=Ea();gt(h,new Si(h,l))}Qt.Ja="timingevent";function Hd(l,h){A.call(this,Qt.Ja,l),this.size=h}f(Hd,A);function Ci(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){l()},h)}function Di(){this.g=!0}Di.prototype.ua=function(){this.g=!1};function ay(l,h,p,_,k,L){l.info(function(){if(l.g)if(L){var X="",Ve=L.split("&");for(let ut=0;ut<Ve.length;ut++){var qt=Ve[ut].split("=");if(qt.length>1){let Jt=qt[0];qt=qt[1];let Hr=Jt.split("_");X=Hr.length>=2&&Hr[1]=="type"?X+(Jt+"="+qt+"&"):X+(Jt+"=redacted&")}}}else X=null;else X=L;return"XMLHTTP REQ ("+_+") [attempt "+k+"]: "+h+`
`+p+`
`+X})}function bT(l,h,p,_,k,L,X){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+k+"]: "+h+`
`+p+`
`+L+" "+X})}function _r(l,h,p,_){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+ly(l,p)+(_?" "+_:"")})}function cy(l,h){l.info(function(){return"TIMEOUT: "+h})}Di.prototype.info=function(){};function ly(l,h){if(!l.g)return h;if(!h)return null;try{let L=JSON.parse(h);if(L){for(l=0;l<L.length;l++)if(Array.isArray(L[l])){var p=L[l];if(!(p.length<2)){var _=p[1];if(Array.isArray(_)&&!(_.length<1)){var k=_[0];if(k!="noop"&&k!="stop"&&k!="close")for(let X=1;X<_.length;X++)_[X]=""}}}}return H(L)}catch{return h}}var ie={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},xe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ht;function bt(){}f(bt,Te),bt.prototype.g=function(){return new XMLHttpRequest},ht=new bt;function mt(l){return encodeURIComponent(String(l))}function Yt(l){var h=1;l=l.split(":");let p=[];for(;h>0&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function yt(l,h,p,_){this.j=l,this.i=h,this.l=p,this.S=_||1,this.V=new cs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ls}function ls(){this.i=null,this.g="",this.h=!1}var wT={},uy={};function dy(l,h,p){l.M=1,l.A=Gd(jr(h)),l.u=p,l.R=!0,IT(l,null)}function IT(l,h){l.F=Date.now(),$d(l),l.B=jr(l.A);var p=l.B,_=l.S;Array.isArray(_)||(_=[String(_)]),FT(p.i,"t",_),l.C=0,p=l.j.L,l.h=new ls,l.g=eS(l.j,p?h:null,!l.u),l.P>0&&(l.O=new mo(u(l.Y,l,l.g),l.P)),h=l.V,p=l.g,_=l.ba;var k="readystatechange";Array.isArray(k)||(k&&(U[0]=k.toString()),k=U);for(let L=0;L<k.length;L++){let X=Rn(p,k[L],_||h.handleEvent,!1,h.h||h);if(!X)break;h.g[X.key]=X}h=l.J?os(l.J):{},l.u?(l.v||(l.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,h)):(l.v="GET",l.g.ea(l.B,l.v,null,h)),jn(),ay(l.i,l.v,l.B,l.l,l.S,l.u)}yt.prototype.ba=function(l){l=l.target;let h=this.O;h&&Eo(l)==3?h.j():this.Y(l)},yt.prototype.Y=function(l){try{if(l==this.g)e:{let Ve=Eo(this.g),qt=this.g.ya(),ut=this.g.ca();if(!(Ve<3)&&(Ve!=3||this.g&&(this.h.h||this.g.la()||$T(this.g)))){this.K||Ve!=4||qt==7||(qt==8||ut<=0?jn(3):jn(2)),hy(this);var h=this.g.ca();this.X=h;var p=r2(this);if(this.o=h==200,bT(this.i,this.v,this.B,this.l,this.S,Ve,h),this.o){if(this.U&&!this.L){t:{if(this.g){var _,k=this.g;if((_=k.g?k.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(_)){var L=_;break t}}L=null}if(l=L)_r(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fy(this,l);else{this.o=!1,this.m=3,Ct(12),us(this),ol(this);break e}}if(this.R){l=!0;let Jt;for(;!this.K&&this.C<p.length;)if(Jt=i2(this,p),Jt==uy){Ve==4&&(this.m=4,Ct(14),l=!1),_r(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==wT){this.m=4,Ct(15),_r(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else _r(this.i,this.l,Jt,null),fy(this,Jt);if(TT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ve!=4||p.length!=0||this.h.h||(this.m=1,Ct(16),l=!1),this.o=this.o&&l,!l)_r(this.i,this.l,p,"[Invalid Chunked Response]"),us(this),ol(this);else if(p.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Ey(X),X.P=!0,Ct(11))}}else _r(this.i,this.l,p,null),fy(this,p);Ve==4&&us(this),this.o&&!this.K&&(Ve==4?YT(this.j,this):(this.o=!1,$d(this)))}else v2(this.g),h==400&&p.indexOf("Unknown SID")>0?(this.m=3,Ct(12)):(this.m=0,Ct(13)),us(this),ol(this)}}}catch{}};function r2(l){if(!TT(l))return l.g.la();let h=$T(l.g);if(h==="")return"";let p="",_=h.length,k=Eo(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return us(l),ol(l),"";l.h.i=new s.TextDecoder}for(let L=0;L<_;L++)l.h.h=!0,p+=l.h.i.decode(h[L],{stream:!(k&&L==_-1)});return h.length=0,l.h.g+=p,l.C=0,l.h.g}function TT(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function i2(l,h){var p=l.C,_=h.indexOf(`
`,p);return _==-1?uy:(p=Number(h.substring(p,_)),isNaN(p)?wT:(_+=1,_+p>h.length?uy:(h=h.slice(_,_+p),l.C=_+p,h)))}yt.prototype.cancel=function(){this.K=!0,us(this)};function $d(l){l.T=Date.now()+l.H,ST(l,l.H)}function ST(l,h){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Ci(u(l.aa,l),h)}function hy(l){l.D&&(s.clearTimeout(l.D),l.D=null)}yt.prototype.aa=function(){this.D=null;let l=Date.now();l-this.T>=0?(cy(this.i,this.B),this.M!=2&&(jn(),Ct(17)),us(this),this.m=2,ol(this)):ST(this,this.T-l)};function ol(l){l.j.I==0||l.K||YT(l.j,l)}function us(l){hy(l);var h=l.O;h&&typeof h.dispose=="function"&&h.dispose(),l.O=null,N(l.V),l.g&&(h=l.g,l.g=null,h.abort(),h.dispose())}function fy(l,h){try{var p=l.j;if(p.I!=0&&(p.g==l||py(p.h,l))){if(!l.L&&py(p.h,l)&&p.I==3){try{var _=p.Ba.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var k=_;if(k[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)Yd(p),Kd(p);else break e;_y(p),Ct(18)}}else p.xa=k[1],0<p.xa-p.K&&k[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=Ci(u(p.Va,p),6e3));xT(p.h)<=1&&p.ta&&(p.ta=void 0)}else hs(p,11)}else if((l.L||p.g==l)&&Yd(p),!T(h))for(k=p.Ba.g.parse(h),h=0;h<k.length;h++){let ut=k[h],Jt=ut[0];if(!(Jt<=p.K))if(p.K=Jt,ut=ut[1],p.I==2)if(ut[0]=="c"){p.M=ut[1],p.ba=ut[2];let Hr=ut[3];Hr!=null&&(p.ka=Hr,p.j.info("VER="+p.ka));let fs=ut[4];fs!=null&&(p.za=fs,p.j.info("SVER="+p.za));let bo=ut[5];bo!=null&&typeof bo=="number"&&bo>0&&(_=1.5*bo,p.O=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;let wo=l.g;if(wo){let Zd=wo.g?wo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zd){var L=_.h;L.g||Zd.indexOf("spdy")==-1&&Zd.indexOf("quic")==-1&&Zd.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(gy(L,L.h),L.h=null))}if(_.G){let by=wo.g?wo.g.getResponseHeader("X-HTTP-Session-Id"):null;by&&(_.wa=by,vt(_.J,_.G,by))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),_=p;var X=l;if(_.na=XT(_,_.L?_.ba:null,_.W),X.L){AT(_.h,X);var Ve=X,qt=_.O;qt&&(Ve.H=qt),Ve.D&&(hy(Ve),$d(Ve)),_.g=X}else KT(_);p.i.length>0&&Qd(p)}else ut[0]!="stop"&&ut[0]!="close"||hs(p,7);else p.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?hs(p,7):vy(p):ut[0]!="noop"&&p.l&&p.l.qa(ut),p.A=0)}}jn(4)}catch{}}var o2=class{constructor(l,h){this.g=l,this.map=h}};function CT(l){this.l=l||10,s.PerformanceNavigationTiming?(l=s.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function DT(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function xT(l){return l.h?1:l.g?l.g.size:0}function py(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function gy(l,h){l.g?l.g.add(h):l.h=h}function AT(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}CT.prototype.cancel=function(){if(this.i=MT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function MT(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let h=l.i;for(let p of l.g.values())h=h.concat(p.G);return h}return m(l.i)}var RT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function s2(l,h){if(l){l=l.split("&");for(let p=0;p<l.length;p++){let _=l[p].indexOf("="),k,L=null;_>=0?(k=l[p].substring(0,_),L=l[p].substring(_+1)):k=l[p],h(k,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function vo(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;l instanceof vo?(this.l=l.l,sl(this,l.j),this.o=l.o,this.g=l.g,al(this,l.u),this.h=l.h,my(this,LT(l.i)),this.m=l.m):l&&(h=String(l).match(RT))?(this.l=!1,sl(this,h[1]||"",!0),this.o=cl(h[2]||""),this.g=cl(h[3]||"",!0),al(this,h[4]),this.h=cl(h[5]||"",!0),my(this,h[6]||"",!0),this.m=cl(h[7]||"")):(this.l=!1,this.i=new ul(null,this.l))}vo.prototype.toString=function(){let l=[];var h=this.j;h&&l.push(ll(h,NT,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(ll(h,NT,!0),"@"),l.push(mt(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(ll(p,p.charAt(0)=="/"?l2:c2,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",ll(p,d2)),l.join("")},vo.prototype.resolve=function(l){let h=jr(this),p=!!l.j;p?sl(h,l.j):p=!!l.o,p?h.o=l.o:p=!!l.g,p?h.g=l.g:p=l.u!=null;var _=l.h;if(p)al(h,l.u);else if(p=!!l.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var k=h.h.lastIndexOf("/");k!=-1&&(_=h.h.slice(0,k+1)+_)}if(k=_,k==".."||k==".")_="";else if(k.indexOf("./")!=-1||k.indexOf("/.")!=-1){_=k.lastIndexOf("/",0)==0,k=k.split("/");let L=[];for(let X=0;X<k.length;){let Ve=k[X++];Ve=="."?_&&X==k.length&&L.push(""):Ve==".."?((L.length>1||L.length==1&&L[0]!="")&&L.pop(),_&&X==k.length&&L.push("")):(L.push(Ve),_=!0)}_=L.join("/")}else _=k}return p?h.h=_:p=l.i.toString()!=="",p?my(h,LT(l.i)):p=!!l.m,p&&(h.m=l.m),h};function jr(l){return new vo(l)}function sl(l,h,p){l.j=p?cl(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function al(l,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);l.u=h}else l.u=null}function my(l,h,p){h instanceof ul?(l.i=h,h2(l.i,l.l)):(p||(h=ll(h,u2)),l.i=new ul(h,l.l))}function vt(l,h,p){l.i.set(h,p)}function Gd(l){return vt(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function cl(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ll(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,a2),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function a2(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var NT=/[#\/\?@]/g,c2=/[#\?:]/g,l2=/[#\?]/g,u2=/[#\?@]/g,d2=/#/g;function ul(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function ds(l){l.g||(l.g=new Map,l.h=0,l.i&&s2(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=ul.prototype,n.add=function(l,h){ds(this),this.i=null,l=ba(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function PT(l,h){ds(l),h=ba(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function kT(l,h){return ds(l),h=ba(l,h),l.g.has(h)}n.forEach=function(l,h){ds(this),this.g.forEach(function(p,_){p.forEach(function(k){l.call(h,k,_,this)},this)},this)};function OT(l,h){ds(l);let p=[];if(typeof h=="string")kT(l,h)&&(p=p.concat(l.g.get(ba(l,h))));else for(l=Array.from(l.g.values()),h=0;h<l.length;h++)p=p.concat(l[h]);return p}n.set=function(l,h){return ds(this),this.i=null,l=ba(this,l),kT(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=OT(this,l),l.length>0?String(l[0]):h):h};function FT(l,h,p){PT(l,h),p.length>0&&(l.i=null,l.g.set(ba(l,h),m(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],h=Array.from(this.g.keys());for(let _=0;_<h.length;_++){var p=h[_];let k=mt(p);p=OT(this,p);for(let L=0;L<p.length;L++){let X=k;p[L]!==""&&(X+="="+mt(p[L])),l.push(X)}}return this.i=l.join("&")};function LT(l){let h=new ul;return h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),h}function ba(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function h2(l,h){h&&!l.j&&(ds(l),l.i=null,l.g.forEach(function(p,_){let k=_.toLowerCase();_!=k&&(PT(this,_),FT(this,k,p))},l)),l.j=h}function f2(l,h){let p=new Di;if(s.Image){let _=new Image;_.onload=d(_o,p,"TestLoadImage: loaded",!0,h,_),_.onerror=d(_o,p,"TestLoadImage: error",!1,h,_),_.onabort=d(_o,p,"TestLoadImage: abort",!1,h,_),_.ontimeout=d(_o,p,"TestLoadImage: timeout",!1,h,_),s.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else h(!1)}function p2(l,h){let p=new Di,_=new AbortController,k=setTimeout(()=>{_.abort(),_o(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:_.signal}).then(L=>{clearTimeout(k),L.ok?_o(p,"TestPingServer: ok",!0,h):_o(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(k),_o(p,"TestPingServer: error",!1,h)})}function _o(l,h,p,_,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),_(p)}catch{}}function g2(){this.g=new ue}function zd(l){this.i=l.Sb||null,this.h=l.ab||!1}f(zd,Te),zd.prototype.g=function(){return new qd(this.i,this.h)};function qd(l,h){sn.call(this),this.H=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(qd,sn),n=qd.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=h,this.readyState=1,hl(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(h.body=l),(this.H||s).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,dl(this)),this.readyState=0},n.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,hl(this)),this.g&&(this.readyState=3,hl(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;VT(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function VT(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}n.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?dl(this):hl(this),this.readyState==3&&VT(this)}},n.Oa=function(l){this.g&&(this.response=this.responseText=l,dl(this))},n.Na=function(l){this.g&&(this.response=l,dl(this))},n.ga=function(){this.g&&dl(this)};function dl(l){l.readyState=4,l.l=null,l.j=null,l.B=null,hl(l)}n.setRequestHeader=function(l,h){this.A.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function hl(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(qd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function UT(l){let h="";return Et(l,function(p,_){h+=_,h+=":",h+=p,h+=`\r
`}),h}function yy(l,h,p){e:{for(_ in p){var _=!1;break e}_=!0}_||(p=UT(p),typeof l=="string"?p!=null&&mt(p):vt(l,h,p))}function Dt(l){sn.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Dt,sn);var m2=/^https?$/i,y2=["POST","PUT"];n=Dt.prototype,n.Fa=function(l){this.H=l},n.ea=function(l,h,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ht.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(L){BT(this,L);return}if(l=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var k in _)p.set(k,_[k]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(let L of _.keys())p.set(L,_.get(L));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find(L=>L.toLowerCase()=="content-type"),k=s.FormData&&l instanceof s.FormData,!(Array.prototype.indexOf.call(y2,h,void 0)>=0)||_||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[L,X]of p)this.g.setRequestHeader(L,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(L){BT(this,L)}};function BT(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.o=5,jT(l),Wd(l)}function jT(l){l.A||(l.A=!0,gt(l,"complete"),gt(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,gt(this,"complete"),gt(this,"abort"),Wd(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wd(this,!0)),Dt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?HT(this):this.Xa())},n.Xa=function(){HT(this)};function HT(l){if(l.h&&typeof o<"u"){if(l.v&&Eo(l)==4)setTimeout(l.Ca.bind(l),0);else if(gt(l,"readystatechange"),Eo(l)==4){l.h=!1;try{let L=l.ca();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var _;if(_=L===0){let X=String(l.D).match(RT)[1]||null;!X&&s.self&&s.self.location&&(X=s.self.location.protocol.slice(0,-1)),_=!m2.test(X?X.toLowerCase():"")}p=_}if(p)gt(l,"complete"),gt(l,"success");else{l.o=6;try{var k=Eo(l)>2?l.g.statusText:""}catch{k=""}l.l=k+" ["+l.ca()+"]",jT(l)}}finally{Wd(l)}}}}function Wd(l,h){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);let p=l.g;l.g=null,h||gt(l,"ready");try{p.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Eo(l){return l.g?l.g.readyState:0}n.ca=function(){try{return Eo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),G(h)}};function $T(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function v2(l){let h={};l=(l.g&&Eo(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(T(l[_]))continue;var p=Yt(l[_]);let k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let L=h[k]||[];h[k]=L,L.push(p)}go(h,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function fl(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function GT(l){this.za=0,this.i=[],this.j=new Di,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=fl("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=fl("baseRetryDelayMs",5e3,l),this.Za=fl("retryDelaySeedMs",1e4,l),this.Ta=fl("forwardChannelMaxRetries",2,l),this.va=fl("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new CT(l&&l.concurrentRequestLimit),this.Ba=new g2,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=GT.prototype,n.ka=8,n.I=1,n.connect=function(l,h,p,_){Ct(0),this.W=l,this.H=h||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.J=XT(this,null,this.W),Qd(this)};function vy(l){if(zT(l),l.I==3){var h=l.V++,p=jr(l.J);if(vt(p,"SID",l.M),vt(p,"RID",h),vt(p,"TYPE","terminate"),pl(l,p),h=new yt(l,l.j,h),h.M=2,h.A=Gd(jr(p)),p=!1,s.navigator&&s.navigator.sendBeacon)try{p=s.navigator.sendBeacon(h.A.toString(),"")}catch{}!p&&s.Image&&(new Image().src=h.A,p=!0),p||(h.g=eS(h.j,null),h.g.ea(h.A)),h.F=Date.now(),$d(h)}ZT(l)}function Kd(l){l.g&&(Ey(l),l.g.cancel(),l.g=null)}function zT(l){Kd(l),l.v&&(s.clearTimeout(l.v),l.v=null),Yd(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&s.clearTimeout(l.m),l.m=null)}function Qd(l){if(!DT(l.h)&&!l.m){l.m=!0;var h=l.Ea;be||I(),re||(be(),re=!0),D.add(h,l),l.D=0}}function _2(l,h){return xT(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=h.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Ci(u(l.Ea,l,h),JT(l,l.D)),l.D++,!0)}n.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;let k=new yt(this,this.j,l),L=this.o;if(this.U&&(L?(L=os(L),Ud(L,this.U)):L=this.U),this.u!==null||this.R||(k.J=L,L=null),this.S)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,h>4096){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=WT(this,k,h),p=jr(this.J),vt(p,"RID",l),vt(p,"CVER",22),this.G&&vt(p,"X-HTTP-Session-Id",this.G),pl(this,p),L&&(this.R?h="headers="+mt(UT(L))+"&"+h:this.u&&yy(p,this.u,L)),gy(this.h,k),this.Ra&&vt(p,"TYPE","init"),this.S?(vt(p,"$req",h),vt(p,"SID","null"),k.U=!0,dy(k,p,null)):dy(k,p,h),this.I=2}}else this.I==3&&(l?qT(this,l):this.i.length==0||DT(this.h)||qT(this))};function qT(l,h){var p;h?p=h.l:p=l.V++;let _=jr(l.J);vt(_,"SID",l.M),vt(_,"RID",p),vt(_,"AID",l.K),pl(l,_),l.u&&l.o&&yy(_,l.u,l.o),p=new yt(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),h&&(l.i=h.G.concat(l.i)),h=WT(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),gy(l.h,p),dy(p,_,h)}function pl(l,h){l.H&&Et(l.H,function(p,_){vt(h,_,p)}),l.l&&Et({},function(p,_){vt(h,_,p)})}function WT(l,h,p){p=Math.min(l.i.length,p);let _=l.l?u(l.l.Ka,l.l,l):null;e:{var k=l.i;let Ve=-1;for(;;){let qt=["count="+p];Ve==-1?p>0?(Ve=k[0].g,qt.push("ofs="+Ve)):Ve=0:qt.push("ofs="+Ve);let ut=!0;for(let Jt=0;Jt<p;Jt++){var L=k[Jt].g;let Hr=k[Jt].map;if(L-=Ve,L<0)Ve=Math.max(0,k[Jt].g-100),ut=!1;else try{L="req"+L+"_"||"";try{var X=Hr instanceof Map?Hr:Object.entries(Hr);for(let[fs,bo]of X){let wo=bo;a(bo)&&(wo=H(bo)),qt.push(L+fs+"="+encodeURIComponent(wo))}}catch(fs){throw qt.push(L+"type="+encodeURIComponent("_badmap")),fs}}catch{_&&_(Hr)}}if(ut){X=qt.join("&");break e}}X=void 0}return l=l.i.splice(0,p),h.G=l,X}function KT(l){if(!l.g&&!l.v){l.Y=1;var h=l.Da;be||I(),re||(be(),re=!0),D.add(h,l),l.A=0}}function _y(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Ci(u(l.Da,l),JT(l,l.A)),l.A++,!0)}n.Da=function(){if(this.v=null,QT(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Ci(u(this.Wa,this),l)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ct(10),Kd(this),QT(this))};function Ey(l){l.B!=null&&(s.clearTimeout(l.B),l.B=null)}function QT(l){l.g=new yt(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var h=jr(l.na);vt(h,"RID","rpc"),vt(h,"SID",l.M),vt(h,"AID",l.K),vt(h,"CI",l.F?"0":"1"),!l.F&&l.ia&&vt(h,"TO",l.ia),vt(h,"TYPE","xmlhttp"),pl(l,h),l.u&&l.o&&yy(h,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=Gd(jr(h)),p.u=null,p.R=!0,IT(p,l)}n.Va=function(){this.C!=null&&(this.C=null,Kd(this),_y(this),Ct(19))};function Yd(l){l.C!=null&&(s.clearTimeout(l.C),l.C=null)}function YT(l,h){var p=null;if(l.g==h){Yd(l),Ey(l),l.g=null;var _=2}else if(py(l.h,h))p=h.G,AT(l.h,h),_=1;else return;if(l.I!=0){if(h.o)if(_==1){p=h.u?h.u.length:0,h=Date.now()-h.F;var k=l.D;_=Ea(),gt(_,new Hd(_,p)),Qd(l)}else KT(l);else if(k=h.m,k==3||k==0&&h.X>0||!(_==1&&_2(l,h)||_==2&&_y(l)))switch(p&&p.length>0&&(h=l.h,h.i=h.i.concat(p)),k){case 1:hs(l,5);break;case 4:hs(l,10);break;case 3:hs(l,6);break;default:hs(l,2)}}}function JT(l,h){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*h}function hs(l,h){if(l.j.info("Error code "+h),h==2){var p=u(l.bb,l),_=l.Ua;let k=!_;_=new vo(_||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||sl(_,"https"),Gd(_),k?f2(_.toString(),p):p2(_.toString(),p)}else Ct(2);l.I=0,l.l&&l.l.pa(h),ZT(l),zT(l)}n.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Ct(2)):(this.j.info("Failed to ping google.com"),Ct(1))};function ZT(l){if(l.I=0,l.ja=[],l.l){let h=MT(l.h);(h.length!=0||l.i.length!=0)&&(S(l.ja,h),S(l.ja,l.i),l.h.i.length=0,m(l.i),l.i.length=0),l.l.oa()}}function XT(l,h,p){var _=p instanceof vo?jr(p):new vo(p);if(_.g!="")h&&(_.g=h+"."+_.g),al(_,_.u);else{var k=s.location;_=k.protocol,h=h?h+"."+k.hostname:k.hostname,k=+k.port;let L=new vo(null);_&&sl(L,_),h&&(L.g=h),k&&al(L,k),p&&(L.h=p),_=L}return p=l.G,h=l.wa,p&&h&&vt(_,p,h),vt(_,"VER",l.ka),pl(l,_),_}function eS(l,h,p){if(h&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Aa&&!l.ma?new Dt(new zd({ab:p})):new Dt(l.ma),h.Fa(l.L),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function tS(){}n=tS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Jd(){}Jd.prototype.g=function(l,h){return new Hn(l,h)};function Hn(l,h){sn.call(this),this.g=new GT(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(l?l["X-WebChannel-Client-Profile"]=h.sa:l={"X-WebChannel-Client-Profile":h.sa}),this.g.U=l,(l=h&&h.Qb)&&!T(l)&&(this.g.u=l),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!T(h)&&(this.g.G=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new wa(this)}f(Hn,sn),Hn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){vy(this.g)},Hn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=H(l),l=p);h.i.push(new o2(h.Ya++,l)),h.I==3&&Qd(h)},Hn.prototype.N=function(){this.g.l=null,delete this.j,vy(this.g),delete this.g,Hn.Z.N.call(this)};function nS(l){ot.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(let p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}f(nS,ot);function rS(){Xe.call(this),this.status=1}f(rS,Xe);function wa(l){this.g=l}f(wa,tS),wa.prototype.ra=function(){gt(this.g,"a")},wa.prototype.qa=function(l){gt(this.g,new nS(l))},wa.prototype.pa=function(l){gt(this.g,new rS)},wa.prototype.oa=function(){gt(this.g,"b")},Jd.prototype.createWebChannel=Jd.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,wb=Zi.createWebChannelTransport=function(){return new Jd},bb=Zi.getStatEventTarget=function(){return Ea()},Eb=Zi.Event=Qt,wg=Zi.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ie.NO_ERROR=0,ie.TIMEOUT=8,ie.HTTP_ERROR=6,Qu=Zi.ErrorCode=ie,xe.COMPLETE="complete",_b=Zi.EventType=xe,Ue.EventType=Ye,Ye.OPEN="a",Ye.CLOSE="b",Ye.ERROR="c",Ye.MESSAGE="d",sn.prototype.listen=sn.prototype.J,yc=Zi.WebChannel=Ue,j8=Zi.FetchXmlHttpFactory=zd,Dt.prototype.listenOnce=Dt.prototype.K,Dt.prototype.getLastError=Dt.prototype.Ha,Dt.prototype.getLastErrorCode=Dt.prototype.ya,Dt.prototype.getStatus=Dt.prototype.ca,Dt.prototype.getResponseJson=Dt.prototype.La,Dt.prototype.getResponseText=Dt.prototype.la,Dt.prototype.send=Dt.prototype.ea,Dt.prototype.setWithCredentials=Dt.prototype.Fa,vb=Zi.XhrIo=Dt}).apply(typeof bg<"u"?bg:typeof self<"u"?self:typeof window<"u"?window:{});var rn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};rn.UNAUTHENTICATED=new rn(null),rn.GOOGLE_CREDENTIALS=new rn("google-credentials-uid"),rn.FIRST_PARTY=new rn("first-party-uid"),rn.MOCK_USER=new rn("mock-user");var kc="12.8.0";function jN(n){kc=n}var na=new Go("@firebase/firestore");function vc(){return na.logLevel}function oe(n,...e){if(na.logLevel<=Be.DEBUG){let t=e.map(nI);na.debug(`Firestore (${kc}): ${n}`,...t)}}function to(n,...e){if(na.logLevel<=Be.ERROR){let t=e.map(nI);na.error(`Firestore (${kc}): ${n}`,...t)}}function Qo(n,...e){if(na.logLevel<=Be.WARN){let t=e.map(nI);na.warn(`Firestore (${kc}): ${n}`,...t)}}function nI(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ie(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,HN(n,r,t)}function HN(n,e,t){let r=`FIRESTORE (${kc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw to(r),new Error(r)}function it(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||HN(e,i,r)}function Ne(n,e){return n}var B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Z=class extends er{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var hi=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ag=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Mg=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(rn.UNAUTHENTICATED))}shutdown(){}},xb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Rg=class{constructor(e){this.t=e,this.currentUser=rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){it(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new hi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new hi,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new hi)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(it(typeof r.accessToken=="string",31837,{l:r}),new Ag(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return it(e===null||typeof e=="string",2055,{h:e}),new rn(e)}},Ab=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=rn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},Mb=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Ab(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(rn.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Ng=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Pg=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){it(this.o===void 0,3512);let r=o=>{o.error!=null&&oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,oe("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ng(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(it(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Ng(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function H8(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var ra=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=H8(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function Ge(n,e){return n<e?-1:n>e?1:0}function Rb(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),o=e.charAt(r);if(i!==o)return Ib(i)===Ib(o)?Ge(i,o):Ib(i)?1:-1}return Ge(n.length,e.length)}var $8=55296,G8=57343;function Ib(n){let e=n.charCodeAt(0);return e>=$8&&e<=G8}function Tc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var nN="__name__",kg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ie(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ie(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Ge(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Rb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ji.fromString(e.substring(4,e.length-2))}},pt=class n extends kg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new Z(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},z8=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Un=class n extends kg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return z8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nN}static keyField(){return new n([nN])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new Z(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new Z(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Z(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Z(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var me=class n{constructor(e){this.path=e}static fromPath(e){return new n(pt.fromString(e))}static fromName(e){return new n(pt.fromString(e).popFirst(5))}static empty(){return new n(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pt(e.slice()))}};function $N(n,e,t){if(!t)throw new Z(B.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function GN(n,e,t,r){if(e===!0&&r===!0)throw new Z(B.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function rN(n){if(!me.isDocumentKey(n))throw new Z(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function iN(n){if(me.isDocumentKey(n))throw new Z(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function zN(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function pd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ie(12329,{type:typeof n})}function Oc(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Z(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=pd(n);throw new Z(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function qN(n,e){if(e<=0)throw new Z(B.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Ft(n,e){let t={typeString:n};return e&&(t.value=e),t}function Fc(n,e){if(!zN(n))throw new Z(B.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new Z(B.INVALID_ARGUMENT,t);return!0}var oN=-62135596800,sN=1e6,Lt=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*sN);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oN)throw new Z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sN}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Fc(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-oN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Lt._jsonSchemaVersion="firestore/timestamp/1.0",Lt._jsonSchema={type:Ft("string",Lt._jsonSchemaVersion),seconds:Ft("number"),nanoseconds:Ft("number")};var Oe=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Lt(0,0))}static max(){return new n(new Lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var td=-1,Og=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Og.UNKNOWN_ID=-1;function q8(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Oe.fromTimestamp(r===1e9?new Lt(t+1,0):new Lt(t,r));return new ia(i,me.empty(),e)}function W8(n){return new ia(n.readTime,n.key,td)}var ia=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Oe.min(),me.empty(),td)}static max(){return new n(Oe.max(),me.empty(),td)}};function K8(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=me.comparator(n.documentKey,e.documentKey),t!==0?t:Ge(n.largestBatchId,e.largestBatchId))}var Q8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Nb=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Lc(n){if(n.code!==B.FAILED_PRECONDITION||n.message!==Q8)throw n;oe("LocalStore","Unexpectedly lost primary lease")}var K=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let u=c;t(e[u]).next(d=>{s[u]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function Y8(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vc(n){return n.name==="IndexedDbTransactionError"}var rI=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),iI=-1;function cm(n){return n==null}function nd(n){return n===0&&1/n==-1/0}function J8(n){return typeof n=="number"&&Number.isInteger(n)&&!nd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var WN="";function Z8(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=aN(e)),e=X8(n.get(t),e);return aN(e)}function X8(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case WN:t+="";break;default:t+=o}}return t}function aN(n){return n+WN+""}var eH="remoteDocuments",KN="owner";var QN="mutationQueues";var YN="mutations";var JN="documentMutations",tH="remoteDocumentsV14";var ZN="remoteDocumentGlobal";var XN="targets";var eP="targetDocuments";var tP="targetGlobal",nP="collectionParents";var rP="clientMetadata";var iP="bundles";var oP="namedQueries";var nH="indexConfiguration";var rH="indexState";var iH="indexEntries";var sP="documentOverlays";var oH="globals";var sH=[QN,YN,JN,eH,XN,KN,tP,eP,rP,ZN,nP,iP,oP],cce=[...sH,sP],aH=[QN,YN,JN,tH,XN,KN,tP,eP,rP,ZN,nP,iP,oP,sP],cH=aH,lH=[...cH,nH,rH,iH];var lce=[...lH,oH];function cN(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ha(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Mt=class n{constructor(e,t){this.comparator=e,this.root=t||fi.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fi.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wc(this.root,e,this.comparator,!1)}getReverseIterator(){return new wc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wc(this.root,e,this.comparator,!0)}},wc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},fi=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ie(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Ie(27949);return e+(this.isRed()?0:1)}};fi.EMPTY=null,fi.RED=!0,fi.BLACK=!1;fi.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie(57766)}get value(){throw Ie(16141)}get color(){throw Ie(16727)}get left(){throw Ie(29726)}get right(){throw Ie(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new fi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var on=class n{constructor(e){this.comparator=e,this.data=new Mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Fg(this.data.getIterator())}getIteratorFrom(e){return new Fg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Fg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var di=class n{constructor(e){this.fields=e,e.sort(Un.comparator)}static empty(){return new n([])}unionWith(e){let t=new on(Un.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Tc(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Lg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var pn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Lg("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};pn.EMPTY_BYTE_STRING=new pn("");var uH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function no(n){if(it(!!n,39018),typeof n=="string"){let e=0,t=uH.exec(n);if(it(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:It(n.seconds),nanos:It(n.nanos)}}function It(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ro(n){return typeof n=="string"?pn.fromBase64String(n):pn.fromUint8Array(n)}var cP="server_timestamp",lP="__type__",uP="__previous_value__",dP="__local_write_time__";function gd(n){return(n?.mapValue?.fields||{})[lP]?.stringValue===cP}function lm(n){let e=n.mapValue.fields[uP];return gd(e)?lm(e):e}function rd(n){let e=no(n.mapValue.fields[dP].timestampValue);return new Lt(e.seconds,e.nanos)}var Pb=class{constructor(e,t,r,i,o,s,a,c,u,d,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d,this.apiKey=f}},Vg="(default)",id=class n{constructor(e,t){this.projectId=e,this.database=t||Vg}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Vg}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function hP(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Z(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new id(n.options.projectId,e)}var oI="__type__",fP="__max__",Ig={mapValue:{fields:{__type__:{stringValue:fP}}}},sI="__vector__",Sc="value";function Yo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?gd(n)?4:gP(n)?9007199254740991:pP(n)?10:11:Ie(28295,{value:n})}function vi(n,e){if(n===e)return!0;let t=Yo(n);if(t!==Yo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return rd(n).isEqual(rd(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=no(i.timestampValue),a=no(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return ro(i.bytesValue).isEqual(ro(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return It(i.geoPointValue.latitude)===It(o.geoPointValue.latitude)&&It(i.geoPointValue.longitude)===It(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return It(i.integerValue)===It(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=It(i.doubleValue),a=It(o.doubleValue);return s===a?nd(s)===nd(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Tc(n.arrayValue.values||[],e.arrayValue.values||[],vi);case 10:case 11:return(function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(cN(s)!==cN(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!vi(s[c],a[c])))return!1;return!0})(n,e);default:return Ie(52216,{left:n})}}function od(n,e){return(n.values||[]).find(t=>vi(t,e))!==void 0}function Cc(n,e){if(n===e)return 0;let t=Yo(n),r=Yo(e);if(t!==r)return Ge(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ge(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=It(o.integerValue||o.doubleValue),c=It(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return lN(n.timestampValue,e.timestampValue);case 4:return lN(rd(n),rd(e));case 5:return Rb(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=ro(o),c=ro(s);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),c=s.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=Ge(a[u],c[u]);if(d!==0)return d}return Ge(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=Ge(It(o.latitude),It(s.latitude));return a!==0?a:Ge(It(o.longitude),It(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return uN(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},c=s.fields||{},u=a[Sc]?.arrayValue,d=c[Sc]?.arrayValue,f=Ge(u?.values?.length||0,d?.values?.length||0);return f!==0?f:uN(u,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===Ig.mapValue&&s===Ig.mapValue)return 0;if(o===Ig.mapValue)return 1;if(s===Ig.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),u=s.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){let g=Rb(c[f],d[f]);if(g!==0)return g;let m=Cc(a[c[f]],u[d[f]]);if(m!==0)return m}return Ge(c.length,d.length)})(n.mapValue,e.mapValue);default:throw Ie(23264,{he:t})}}function lN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ge(n,e);let t=no(n),r=no(e),i=Ge(t.seconds,r.seconds);return i!==0?i:Ge(t.nanos,r.nanos)}function uN(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Cc(t[i],r[i]);if(o)return o}return Ge(t.length,r.length)}function Dc(n){return kb(n)}function kb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=no(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ro(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return me.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=kb(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${kb(t.fields[s])}`;return i+"}"})(n.mapValue):Ie(61005,{value:n})}function Cg(n){switch(Yo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=lm(n);return e?16+Cg(e):16;case 5:return 2*n.stringValue.length;case 6:return ro(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,o)=>i+Cg(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ha(r.fields,(o,s)=>{i+=o.length+Cg(s)}),i})(n.mapValue);default:throw Ie(13486,{value:n})}}function md(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ob(n){return!!n&&"integerValue"in n}function aI(n){return!!n&&"arrayValue"in n}function dN(n){return!!n&&"nullValue"in n}function hN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Dg(n){return!!n&&"mapValue"in n}function pP(n){return(n?.mapValue?.fields||{})[oI]?.stringValue===sI}function Zu(n){if(n.geoPointValue)return{geoPointValue:F({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:F({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ha(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Zu(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Zu(n.arrayValue.values[t]);return e}return F({},n)}function gP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===fP}var dce={mapValue:{fields:{[oI]:{stringValue:sI},[Sc]:{arrayValue:{}}}}};var gr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Dg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zu(t)}setAll(e){let t=Un.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=Zu(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Dg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return vi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Dg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ha(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Zu(this.value))}};function mP(n){let e=[];return ha(n.fields,(t,r)=>{let i=new Un([t]);if(Dg(r)){let o=mP(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new di(e)}var Fr=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Oe.min(),Oe.min(),Oe.min(),gr.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Oe.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Oe.min(),Oe.min(),gr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Oe.min(),Oe.min(),gr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var io=class{constructor(e,t){this.position=e,this.inclusive=t}};function fN(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=me.comparator(me.fromName(s.referenceValue),t.key):r=Cc(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function pN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!vi(n.position[t],e.position[t]))return!1;return!0}var Jo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function dH(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ug=class{},Ot=class n extends Ug{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Lb(e,t,r):t==="array-contains"?new Bb(e,r):t==="in"?new jb(e,r):t==="not-in"?new Hb(e,r):t==="array-contains-any"?new $b(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Vb(e,r):new Ub(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Cc(t,this.value)):t!==null&&Yo(this.value)===Yo(t)&&this.matchesComparison(Cc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},mr=class n extends Ug{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return yP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function yP(n){return n.op==="and"}function vP(n){return hH(n)&&yP(n)}function hH(n){for(let e of n.filters)if(e instanceof mr)return!1;return!0}function Fb(n){if(n instanceof Ot)return n.field.canonicalString()+n.op.toString()+Dc(n.value);if(vP(n))return n.filters.map(e=>Fb(e)).join(",");{let e=n.filters.map(t=>Fb(t)).join(",");return`${n.op}(${e})`}}function _P(n,e){return n instanceof Ot?(function(r,i){return i instanceof Ot&&r.op===i.op&&r.field.isEqual(i.field)&&vi(r.value,i.value)})(n,e):n instanceof mr?(function(r,i){return i instanceof mr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&_P(s,i.filters[a]),!0):!1})(n,e):void Ie(19439)}function EP(n){return n instanceof Ot?(function(t){return`${t.field.canonicalString()} ${t.op} ${Dc(t.value)}`})(n):n instanceof mr?(function(t){return t.op.toString()+" {"+t.getFilters().map(EP).join(" ,")+"}"})(n):"Filter"}var Lb=class extends Ot{constructor(e,t,r){super(e,t,r),this.key=me.fromName(r.referenceValue)}matches(e){let t=me.comparator(e.key,this.key);return this.matchesComparison(t)}},Vb=class extends Ot{constructor(e,t){super(e,"in",t),this.keys=bP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Ub=class extends Ot{constructor(e,t){super(e,"not-in",t),this.keys=bP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function bP(n,e){return(e.arrayValue?.values||[]).map(t=>me.fromName(t.referenceValue))}var Bb=class extends Ot{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return aI(t)&&od(t.arrayValue,this.value)}},jb=class extends Ot{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&od(this.value.arrayValue,t)}},Hb=class extends Ot{constructor(e,t){super(e,"not-in",t)}matches(e){if(od(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!od(this.value.arrayValue,t)}},$b=class extends Ot{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!aI(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>od(this.value.arrayValue,r))}};var Gb=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function gN(n,e=null,t=[],r=[],i=null,o=null,s=null){return new Gb(n,e,t,r,i,o,s)}function cI(n){let e=Ne(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Fb(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),cm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Dc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Dc(r)).join(",")),e.Te=t}return e.Te}function lI(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!dH(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_P(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pN(n.startAt,e.startAt)&&pN(n.endAt,e.endAt)}function zb(n){return me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var oo=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function fH(n,e,t,r,i,o,s,a){return new oo(n,e,t,r,i,o,s,a)}function uI(n){return new oo(n)}function mN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pH(n){return me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function um(n){return n.collectionGroup!==null}function ta(n){let e=Ne(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new on(Un.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Jo(o,r))}),t.has(Un.keyField().canonicalString())||e.Ie.push(new Jo(Un.keyField(),r))}return e.Ie}function pi(n){let e=Ne(n);return e.Ee||(e.Ee=gH(e,ta(n))),e.Ee}function gH(n,e){if(n.limitType==="F")return gN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Jo(i.field,o)});let t=n.endAt?new io(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new io(n.startAt.position,n.startAt.inclusive):null;return gN(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function dm(n,e){let t=n.filters.concat([e]);return new oo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function wP(n,e){let t=n.explicitOrderBy.concat([e]);return new oo(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function sd(n,e,t){return new oo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function IP(n,e){return new oo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function hm(n,e){return lI(pi(n),pi(e))&&n.limitType===e.limitType}function TP(n){return`${cI(pi(n))}|lt:${n.limitType}`}function _c(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>EP(i)).join(", ")}]`),cm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Dc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Dc(i)).join(",")),`Target(${r})`})(pi(n))}; limitType=${n.limitType})`}function fm(n,e){return e.isFoundDocument()&&(function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):me.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(let o of ta(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(s,a,c){let u=fN(s,a,c);return s.inclusive?u<=0:u<0})(r.startAt,ta(r),i)||r.endAt&&!(function(s,a,c){let u=fN(s,a,c);return s.inclusive?u>=0:u>0})(r.endAt,ta(r),i))})(n,e)}function mH(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function SP(n){return(e,t)=>{let r=!1;for(let i of ta(n)){let o=yH(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function yH(n,e,t){let r=n.field.isKeyField()?me.comparator(e.key,t.key):(function(o,s,a){let c=s.data.field(o),u=a.data.field(o);return c!==null&&u!==null?Cc(c,u):Ie(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ie(19790,{direction:n.dir})}}var so=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ha(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return aP(this.inner)}size(){return this.innerSize}};var vH=new Mt(me.comparator);function ao(){return vH}var CP=new Mt(me.comparator);function Ju(...n){let e=CP;for(let t of n)e=e.insert(t.key,t);return e}function DP(n){let e=CP;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Xs(){return Xu()}function xP(){return Xu()}function Xu(){return new so(n=>n.toString(),(n,e)=>n.isEqual(e))}var _H=new Mt(me.comparator),EH=new on(me.comparator);function je(...n){let e=EH;for(let t of n)e=e.add(t);return e}var bH=new on(Ge);function wH(){return bH}function dI(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nd(e)?"-0":e}}function AP(n){return{integerValue:""+n}}function IH(n,e){return J8(e)?AP(e):dI(n,e)}var xc=class{constructor(){this._=void 0}};function TH(n,e,t){return n instanceof oa?(function(i,o){let s={fields:{[lP]:{stringValue:cP},[dP]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&gd(o)&&(o=lm(o)),o&&(s.fields[uP]=o),{mapValue:s}})(t,e):n instanceof sa?RP(n,e):n instanceof aa?NP(n,e):(function(i,o){let s=MP(i,o),a=yN(s)+yN(i.Ae);return Ob(s)&&Ob(i.Ae)?AP(a):dI(i.serializer,a)})(n,e)}function SH(n,e,t){return n instanceof sa?RP(n,e):n instanceof aa?NP(n,e):t}function MP(n,e){return n instanceof Ac?(function(r){return Ob(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var oa=class extends xc{},sa=class extends xc{constructor(e){super(),this.elements=e}};function RP(n,e){let t=PP(e);for(let r of n.elements)t.some(i=>vi(i,r))||t.push(r);return{arrayValue:{values:t}}}var aa=class extends xc{constructor(e){super(),this.elements=e}};function NP(n,e){let t=PP(e);for(let r of n.elements)t=t.filter(i=>!vi(i,r));return{arrayValue:{values:t}}}var Ac=class extends xc{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function yN(n){return It(n.integerValue||n.doubleValue)}function PP(n){return aI(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var qb=class{constructor(e,t){this.field=e,this.transform=t}};function CH(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof sa&&i instanceof sa||r instanceof aa&&i instanceof aa?Tc(r.elements,i.elements,vi):r instanceof Ac&&i instanceof Ac?vi(r.Ae,i.Ae):r instanceof oa&&i instanceof oa})(n.transform,e.transform)}var Wb=class{constructor(e,t){this.version=e,this.transformResults=t}},Ko=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function xg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Mc=class{};function kP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ad(n.key,Ko.none()):new ca(n.key,n.data,Ko.none());{let t=n.data,r=gr.empty(),i=new on(Un.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new co(n.key,r,new di(i.toArray()),Ko.none())}}function DH(n,e,t){n instanceof ca?(function(i,o,s){let a=i.value.clone(),c=_N(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof co?(function(i,o,s){if(!xg(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=_N(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(OP(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()})(n,e,t):(function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function ed(n,e,t,r){return n instanceof ca?(function(o,s,a,c){if(!xg(o.precondition,s))return a;let u=o.value.clone(),d=EN(o.fieldTransforms,c,s);return u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null})(n,e,t,r):n instanceof co?(function(o,s,a,c){if(!xg(o.precondition,s))return a;let u=EN(o.fieldTransforms,c,s),d=s.data;return d.setAll(OP(o)),d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))})(n,e,t,r):(function(o,s,a){return xg(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function xH(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=MP(r.transform,i||null);o!=null&&(t===null&&(t=gr.empty()),t.set(r.field,o))}return t||null}function vN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Tc(r,i,(o,s)=>CH(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var ca=class extends Mc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},co=class extends Mc{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function OP(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function _N(n,e,t){let r=new Map;it(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,SH(s,a,t[i]))}return r}function EN(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,TH(o,s,e))}return r}var ad=class extends Mc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Kb=class extends Mc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Qb=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&DH(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ed(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ed(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=xP();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=kP(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(Oe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),je())}isEqual(e){return this.batchId===e.batchId&&Tc(this.mutations,e.mutations,(t,r)=>vN(t,r))&&Tc(this.baseMutations,e.baseMutations,(t,r)=>vN(t,r))}},Yb=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){it(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return _H})(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var Jb=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Zb=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Gt,We;function AH(n){switch(n){case B.OK:return Ie(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return Ie(15467,{code:n})}}function FP(n){if(n===void 0)return to("GRPC error has no .code"),B.UNKNOWN;switch(n){case Gt.OK:return B.OK;case Gt.CANCELLED:return B.CANCELLED;case Gt.UNKNOWN:return B.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return B.INTERNAL;case Gt.UNAVAILABLE:return B.UNAVAILABLE;case Gt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Gt.NOT_FOUND:return B.NOT_FOUND;case Gt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Gt.ABORTED:return B.ABORTED;case Gt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Gt.DATA_LOSS:return B.DATA_LOSS;default:return Ie(39323,{code:n})}}(We=Gt||(Gt={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";var MH=null;function RH(){return new TextEncoder}var NH=new Ji([4294967295,4294967295],0);function bN(n){let e=RH().encode(n),t=new yb;return t.update(e),new Uint8Array(t.digest())}function wN(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ji([t,r],0),new Ji([i,o],0)]}var Xb=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ea(`Invalid padding: ${t}`);if(r<0)throw new ea(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ea(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ea(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ji.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Ji.fromNumber(r)));return i.compare(NH)===1&&(i=new Ji([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=bN(e),[r,i]=wN(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(r,i,o);if(!this.we(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=bN(e),[r,i]=wN(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(r,i,o);this.be(s)}}be(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ea=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Bg=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,cd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Oe.min(),i,new Mt(Ge),ao(),je())}},cd=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,je(),je(),je())}};var Ic=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}},jg=class{constructor(e,t){this.targetId=e,this.Ce=t}},Hg=class{constructor(e,t,r=pn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},$g=class{constructor(){this.ve=0,this.Fe=IN(),this.Me=pn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=je(),t=je(),r=je();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ie(38017,{changeType:o})}}),new cd(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=IN()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,it(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},ew=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=ao(),this.He=Tg(),this.Je=Tg(),this.Ze=new Mt(Ge)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ie(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let o=i.target;if(zb(o))if(r===0){let s=new me(o.path);this.et(t,s,Fr.newNoDocument(s,Oe.min()))}else it(r===1,20013,{expectedCount:r});else{let s=this._t(t);if(s!==r){let a=this.ut(e),c=a?this.ct(a,e,s):1;if(c!==0){this.it(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,u)}MH?.lt((function(d,f,g,m,S){let M={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},O=f.unchangedNames;return O&&(M.bloomFilter={applied:S===0,hashCount:O?.hashCount??0,bitmapLength:O?.bits?.bitmap?.length??0,padding:O?.bits?.padding??0,mightContain:P=>m?.mightContain(P)??!1}),M})(s,e.Ce,this.Ge.ht(),a,c))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=ro(r).toUint8Array()}catch(c){if(c instanceof Lg)return Qo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Xb(s,i,o)}catch(c){return Qo(c instanceof ea?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&zb(a.target)){let c=new me(a.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,Fr.newNoDocument(c,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let r=je();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let i=new Bg(e,t,this.Ze,this.je,r);return this.je=ao(),this.He=Tg(),this.Je=Tg(),this.Ze=new Mt(Ge),i}Ye(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new $g,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new on(Ge),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new on(Ge),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new $g),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Tg(){return new Mt(me.comparator)}function IN(){return new Mt(me.comparator)}var PH={asc:"ASCENDING",desc:"DESCENDING"},kH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OH={and:"AND",or:"OR"},tw=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function nw(n,e){return n.useProto3Json||cm(e)?e:{value:e}}function Gg(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function LP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function FH(n,e){return Gg(n,e.toTimestamp())}function gi(n){return it(!!n,49232),Oe.fromTimestamp((function(t){let r=no(t);return new Lt(r.seconds,r.nanos)})(n))}function hI(n,e){return rw(n,e).canonicalString()}function rw(n,e){let t=(function(i){return new pt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function VP(n){let e=pt.fromString(n);return it($P(e),10190,{key:e.toString()}),e}function iw(n,e){return hI(n.databaseId,e.path)}function Tb(n,e){let t=VP(e);if(t.get(1)!==n.databaseId.projectId)throw new Z(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Z(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new me(BP(t))}function UP(n,e){return hI(n.databaseId,e)}function LH(n){let e=VP(n);return e.length===4?pt.emptyPath():BP(e)}function ow(n){return new pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function BP(n){return it(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function TN(n,e,t){return{name:iw(n,e),fields:t.value.mapValue.fields}}function VH(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ie(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(u,d){return u.useProto3Json?(it(d===void 0||typeof d=="string",58123),pn.fromBase64String(d||"")):(it(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),pn.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(u){let d=u.code===void 0?B.UNKNOWN:FP(u.code);return new Z(d,u.message||"")})(s);t=new Hg(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Tb(n,r.document.name),o=gi(r.document.updateTime),s=r.document.createTime?gi(r.document.createTime):Oe.min(),a=new gr({mapValue:{fields:r.document.fields}}),c=Fr.newFoundDocument(i,o,s,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Ic(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Tb(n,r.document),o=r.readTime?gi(r.readTime):Oe.min(),s=Fr.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Ic([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Tb(n,r.document),o=r.removedTargetIds||[];t=new Ic([],o,i,null)}else{if(!("filter"in e))return Ie(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Zb(i,o),a=r.targetId;t=new jg(a,s)}}return t}function UH(n,e){let t;if(e instanceof ca)t={update:TN(n,e.key,e.value)};else if(e instanceof ad)t={delete:iw(n,e.key)};else if(e instanceof co)t={update:TN(n,e.key,e.data),updateMask:KH(e.fieldMask)};else{if(!(e instanceof Kb))return Ie(16599,{dt:e.type});t={verify:iw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,s){let a=s.transform;if(a instanceof oa)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof sa)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof aa)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ac)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw Ie(20930,{transform:s.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:FH(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ie(27497)})(n,e.precondition)),t}function BH(n,e){return n&&n.length>0?(it(e!==void 0,14353),n.map(t=>(function(i,o){let s=i.updateTime?gi(i.updateTime):gi(o);return s.isEqual(Oe.min())&&(s=gi(o)),new Wb(s,i.transformResults||[])})(t,e))):[]}function jH(n,e){return{documents:[UP(n,e.path)]}}function HH(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=UP(n,i);let o=(function(u){if(u.length!==0)return HP(mr.create(u,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(u){if(u.length!==0)return u.map(d=>(function(g){return{field:Ec(g.field),direction:zH(g.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=nw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:i}}function $H(n){let e=LH(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){it(r===1,65062);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(f){let g=jP(f);return g instanceof mr&&vP(g)?g.getFilters():[g]})(t.where));let s=[];t.orderBy&&(s=(function(f){return f.map(g=>(function(S){return new Jo(bc(S.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(g))})(t.orderBy));let a=null;t.limit&&(a=(function(f){let g;return g=typeof f=="object"?f.value:f,cm(g)?null:g})(t.limit));let c=null;t.startAt&&(c=(function(f){let g=!!f.before,m=f.values||[];return new io(m,g)})(t.startAt));let u=null;return t.endAt&&(u=(function(f){let g=!f.before,m=f.values||[];return new io(m,g)})(t.endAt)),fH(e,i,s,o,a,"F",c,u)}function GH(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function jP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=bc(t.unaryFilter.field);return Ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=bc(t.unaryFilter.field);return Ot.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=bc(t.unaryFilter.field);return Ot.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=bc(t.unaryFilter.field);return Ot.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ie(61313);default:return Ie(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ot.create(bc(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ie(58110);default:return Ie(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return mr.create(t.compositeFilter.filters.map(r=>jP(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ie(1026)}})(t.compositeFilter.op))})(n):Ie(30097,{filter:n})}function zH(n){return PH[n]}function qH(n){return kH[n]}function WH(n){return OH[n]}function Ec(n){return{fieldPath:n.canonicalString()}}function bc(n){return Un.fromServerFormat(n.fieldPath)}function HP(n){return n instanceof Ot?(function(t){if(t.op==="=="){if(hN(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NAN"}};if(dN(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(hN(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NOT_NAN"}};if(dN(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ec(t.field),op:qH(t.op),value:t.value}}})(n):n instanceof mr?(function(t){let r=t.getFilters().map(i=>HP(i));return r.length===1?r[0]:{compositeFilter:{op:WH(t.op),filters:r}}})(n):Ie(54877,{filter:n})}function KH(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function $P(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function GP(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var ld=class n{constructor(e,t,r,i,o=Oe.min(),s=Oe.min(),a=pn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var sw=class{constructor(e){this.yt=e}};function zP(n){let e=$H({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?sd(e,e.limit,"L"):e}var zg=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(It(e.integerValue));else if("doubleValue"in e){let r=It(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),nd(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=no(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ro(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?gP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):pP(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):Ie(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=Sc,o=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(It(o)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),me.fromName(e).path.forEach(r=>{this.Ft(t,60),this.$t(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};zg.Wt=new zg;var aw=class{constructor(){this.Sn=new cw}addToCollectionParentIndex(e,t){return this.Sn.add(t),K.resolve()}getCollectionParents(e,t){return K.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return K.resolve()}deleteFieldIndex(e,t){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,t){return K.resolve()}getDocumentsMatchingTarget(e,t){return K.resolve(null)}getIndexType(e,t){return K.resolve(0)}getFieldIndexes(e,t){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,t){return K.resolve(ia.min())}getMinOffsetFromCollectionGroup(e,t){return K.resolve(ia.min())}updateCollectionGroup(e,t,r){return K.resolve()}updateIndexEntries(e,t){return K.resolve()}},cw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new on(pt.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new on(pt.comparator)).toArray()}};var hce=new Uint8Array(0);var SN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qP=41943040,pr=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};pr.DEFAULT_COLLECTION_PERCENTILE=10,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pr.DEFAULT=new pr(qP,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pr.DISABLED=new pr(-1,0,0);var ud=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var CN="LruGarbageCollector",QH=1048576;function DN([n,e],[t,r]){let i=Ge(n,t);return i===0?Ge(e,r):i}var lw=class{constructor(e){this.Pr=e,this.buffer=new on(DN),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();DN(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},uw=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){oe(CN,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vc(t)?oe(CN,"Ignoring IndexedDB error during garbage collection: ",t):await Lc(t)}await this.Ar(3e5)})}},dw=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return K.resolve(rI.ce);let r=new lw(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.mr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(oe("LruGarbageCollector","Garbage collection skipped; disabled"),K.resolve(SN)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),SN):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,o,s,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,s=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(o=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),vc()<=Be.DEBUG&&oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),K.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:f})))}};function YH(n,e){return new dw(n,e)}var hw=class{constructor(){this.changes=new so(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?K.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var fw=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var pw=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ed(r.mutation,i,di.empty(),Lt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,je()).next(()=>r))}getLocalViewOfDocuments(e,t,r=je()){let i=Xs();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Ju();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Xs();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,je()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=ao(),s=Xu(),a=(function(){return Xu()})();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof co)?o=o.insert(u.key,u):d!==void 0?(s.set(u.key,d.mutation.getFieldMask()),ed(d.mutation,u,d.mutation.getFieldMask(),Lt.now())):s.set(u.key,di.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,d)=>s.set(u,d)),t.forEach((u,d)=>a.set(u,new fw(d,s.get(u)??null))),a))}recalculateAndSaveOverlays(e,t){let r=Xu(),i=new Mt((s,a)=>s-a),o=je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||di.empty();d=a.applyToLocalView(u,d),r.set(c,d);let f=(i.get(a.batchId)||je()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,f=xP();d.forEach(g=>{if(!o.has(g)){let m=kP(t.get(g),r.get(g));m!==null&&f.set(g,m),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,f))}return K.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return pH(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):um(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):K.resolve(Xs()),a=td,c=o;return s.next(u=>K.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(d)?K.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,je())).next(d=>({batchId:a,changes:DP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new me(t)).next(r=>{let i=Ju();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Ju();return this.indexManager.getCollectionParents(e,o).next(a=>K.forEach(a,c=>{let u=(function(f,g){return new oo(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,g)=>{s=s.insert(f,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,u)=>{let d=u.getKey();s.get(d)===null&&(s=s.insert(d,Fr.newInvalidDocument(d)))});let a=Ju();return s.forEach((c,u)=>{let d=o.get(c);d!==void 0&&ed(d.mutation,u,di.empty(),Lt.now()),fm(t,u)&&(a=a.insert(c,u))}),a})}};var gw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return K.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:gi(i.createTime)}})(t)),K.resolve()}getNamedQuery(e,t){return K.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:zP(i.bundledQuery),readTime:gi(i.readTime)}})(t)),K.resolve()}};var mw=class{constructor(){this.overlays=new Mt(me.comparator),this.Lr=new Map}getOverlay(e,t){return K.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Xs();return K.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.bt(e,t,o)}),K.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Lr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(r)),K.resolve()}getOverlaysForCollection(e,t,r){let i=Xs(),o=t.length+1,s=new me(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return K.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Mt((u,d)=>u-d),s=this.overlays.getIterator();for(;s.hasNext();){let u=s.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=o.get(u.largestBatchId);d===null&&(d=Xs(),o=o.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=Xs(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return K.resolve(a)}bt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Jb(t,r));let o=this.Lr.get(t);o===void 0&&(o=je(),this.Lr.set(t,o)),this.Lr.set(t,o.add(r.key))}};var yw=class{constructor(){this.sessionToken=pn.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,K.resolve()}};var dd=class{constructor(){this.kr=new on(zt.Kr),this.qr=new on(zt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new zt(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new zt(e,t))}Qr(e,t){e.forEach(r=>this.removeReference(r,t))}Gr(e){let t=new me(new pt([])),r=new zt(t,e),i=new zt(t,e+1),o=[];return this.qr.forEachInRange([r,i],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new me(new pt([])),r=new zt(t,e),i=new zt(t,e+1),o=je();return this.qr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new zt(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},zt=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return me.comparator(e.key,t.key)||Ge(e.Hr,t.Hr)}static Ur(e,t){return Ge(e.Hr,t.Hr)||me.comparator(e.key,t.key)}};var vw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new on(zt.Kr)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Qb(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.Jr=this.Jr.add(new zt(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return K.resolve(s)}lookupMutationBatch(e,t){return K.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),o=i<0?0:i;return K.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?iI:this.Yn-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new zt(t,0),i=new zt(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([r,i],s=>{let a=this.Zr(s.Hr);o.push(a)}),K.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new on(Ge);return t.forEach(i=>{let o=new zt(i,0),s=new zt(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{r=r.add(a.Hr)})}),K.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;me.isDocumentKey(o)||(o=o.child(""));let s=new zt(new me(o),0),a=new on(Ge);return this.Jr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.Hr)),!0)},s),K.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){it(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return K.forEach(t.mutations,i=>{let o=new zt(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){let r=new zt(t,0),i=this.Jr.firstAfterOrEqual(r);return K.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var _w=class{constructor(e){this.ti=e,this.docs=(function(){return new Mt(me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return K.resolve(r?r.document.mutableCopy():Fr.newInvalidDocument(t))}getEntries(e,t){let r=ao();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Fr.newInvalidDocument(i))}),K.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=ao(),s=t.path,a=new me(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||K8(W8(d),r)<=0||(i.has(d.key)||fm(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return K.resolve(o)}getAllFromCollectionGroup(e,t,r,i){Ie(9500)}ni(e,t){return K.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Ew(this)}getSize(e){return K.resolve(this.size)}},Ew=class extends hw{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)}),K.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var bw=class{constructor(e){this.persistence=e,this.ri=new so(t=>cI(t),lI),this.lastRemoteSnapshotVersion=Oe.min(),this.highestTargetId=0,this.ii=0,this.si=new dd,this.targetCount=0,this.oi=ud._r()}forEachTarget(e,t){return this.ri.forEach((r,i)=>t(i)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),K.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new ud(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,K.resolve()}updateTargetData(e,t){return this.lr(t),K.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),K.waitFor(o).next(()=>i)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return K.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),K.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),K.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),K.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return K.resolve(r)}containsKey(e,t){return K.resolve(this.si.containsKey(t))}};var qg=class{constructor(e,t){this._i={},this.overlays={},this.ai=new rI(0),this.ui=!1,this.ui=!0,this.ci=new yw,this.referenceDelegate=e(this),this.li=new bw(this),this.indexManager=new aw,this.remoteDocumentCache=(function(i){return new _w(i)})(r=>this.referenceDelegate.hi(r)),this.serializer=new sw(t),this.Pi=new gw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new mw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new vw(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){oe("MemoryPersistence","Starting transaction:",e);let i=new ww(this.ai.next());return this.referenceDelegate.Ti(),r(i).next(o=>this.referenceDelegate.Ii(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,t){return K.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}},ww=class extends Nb{constructor(e){super(),this.currentSequenceNumber=e}},Iw=class n{constructor(e){this.persistence=e,this.Ri=new dd,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw Ie(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),K.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),K.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.di.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.di,r=>{let i=me.fromPath(r);return this.mi(e,i).next(o=>{o||t.removeEntry(i,Oe.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return K.or([()=>K.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Wg=class n{constructor(e,t){this.persistence=e,this.fi=new so(r=>Z8(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=YH(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return K.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}pr(e){let t=0;return this.mr(e,r=>{t++}).next(()=>t)}mr(e,t){return K.forEach(this.fi,(r,i)=>this.wr(e,r,i).next(o=>o?K.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ni(e,s=>this.wr(e,s,t).next(a=>{a||(r++,o.removeEntry(s,Oe.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),K.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),K.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),K.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),K.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Cg(e.data.value)),t}wr(e,t,r){return K.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.fi.get(t);return K.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Tw=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=je(),i=je();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Sw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Cw=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return FR()?8:Y8(tn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new Sw;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,r,i){return r.documentReadCount<this.Vs?(vc()<=Be.DEBUG&&oe("QueryEngine","SDK will not create cache indexes for query:",_c(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),K.resolve()):(vc()<=Be.DEBUG&&oe("QueryEngine","Query:",_c(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(vc()<=Be.DEBUG&&oe("QueryEngine","The SDK decides to create cache indexes for query:",_c(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pi(t))):K.resolve())}gs(e,t){if(mN(t))return K.resolve(null);let r=pi(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=sd(t,null,"F"),r=pi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=je(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.bs(t,a);return this.Ss(t,u,s,c.readTime)?this.gs(e,sd(t,null,"F")):this.Ds(e,u,t,c)}))})))}ps(e,t,r,i){return mN(t)||i.isEqual(Oe.min())?K.resolve(null):this.fs.getDocuments(e,r).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,r,i)?K.resolve(null):(vc()<=Be.DEBUG&&oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_c(t)),this.Ds(e,s,t,q8(i,td)).next(a=>a))})}bs(e,t){let r=new on(SP(e));return t.forEach((i,o)=>{fm(e,o)&&(r=r.add(o))}),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ys(e,t,r){return vc()<=Be.DEBUG&&oe("QueryEngine","Using full collection scan to execute query:",_c(t)),this.fs.getDocumentsMatchingQuery(e,t,ia.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var fI="LocalStore",JH=3e8,Dw=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new Mt(Ge),this.Fs=new so(o=>cI(o),lI),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function ZH(n,e,t,r){return new Dw(n,e,t,r)}async function WP(n,e){let t=Ne(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Os(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=je();for(let u of i){s.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of o){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({Ns:u,removedBatchIds:s,addedBatchIds:a}))})})}function XH(n,e){let t=Ne(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,c,u,d){let f=u.batch,g=f.keys(),m=K.resolve();return g.forEach(S=>{m=m.next(()=>d.getEntry(c,S)).next(M=>{let O=u.docVersions.get(S);it(O!==null,48541),M.version.compareTo(O)<0&&(f.applyToRemoteDocument(M,u),M.isValidDocument()&&(M.setReadTime(u.commitVersion),d.addEntry(M)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(c,f))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=je();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function KP(n){let e=Ne(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function e$(n,e){let t=Ne(n),r=e.snapshotVersion,i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;let a=[];e.targetChanges.forEach((d,f)=>{let g=i.get(f);if(!g)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,f).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,f)));let m=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(pn.EMPTY_BYTE_STRING,Oe.min()).withLastLimboFreeSnapshotVersion(Oe.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(f,m),(function(M,O,P){return M.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=JH?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(g,m,d)&&a.push(t.li.updateTargetData(o,m))});let c=ao(),u=je();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(t$(o,s,e.documentUpdates).next(d=>{c=d.Bs,u=d.Ls})),!r.isEqual(Oe.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(f=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return K.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(t.vs=i,o))}function t$(n,e,t){let r=je(),i=je();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=ao();return t.forEach((a,c)=>{let u=o.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Oe.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):oe(fI,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Bs:s,Ls:i}})}function n$(n,e){let t=Ne(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=iI),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function r$(n,e){let t=Ne(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.li.getTargetData(r,e).next(o=>o?(i=o,K.resolve(i)):t.li.allocateTargetId(r).next(s=>(i=new ld(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r})}async function xw(n,e,t){let r=Ne(n),i=r.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Vc(s))throw s;oe(fI,`Failed to update sequence numbers for target ${e}: ${s}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function xN(n,e,t){let r=Ne(n),i=Oe.min(),o=je();return r.persistence.runTransaction("Execute query","readwrite",s=>(function(c,u,d){let f=Ne(c),g=f.Fs.get(d);return g!==void 0?K.resolve(f.vs.get(g)):f.li.getTargetData(u,d)})(r,s,pi(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(s,e,t?i:Oe.min(),t?o:je())).next(a=>(i$(r,mH(e),a),{documents:a,ks:o})))}function i$(n,e,t){let r=n.Ms.get(e)||Oe.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.Ms.set(e,r)}var Kg=class{constructor(){this.activeTargetIds=wH()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Aw=class{constructor(){this.vo=new Kg,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Kg,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Mw=class{Mo(e){}shutdown(){}};var AN="ConnectivityMonitor",Qg=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){oe(AN,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){oe(AN,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Sg=null;function Rw(){return Sg===null?Sg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Sg++,"0x"+Sg.toString(16)}var Sb="RestConnection",o$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},Nw=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===Vg?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){let s=Rw(),a=this.Qo(e,t.toUriEncodedString());oe(Sb,`Sending RPC '${e}' ${s}:`,a,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,i,o);let{host:u}=new URL(a),d=$o(u);return this.zo(e,a,c,r,d).then(f=>(oe(Sb,`Received RPC '${e}' ${s}: `,f),f),f=>{throw Qo(Sb,`RPC '${e}' ${s} failed with error: `,f,"url: ",a,"request:",r),f})}jo(e,t,r,i,o,s){return this.Wo(e,t,r,i,o)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+kc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}Qo(e,t){let r=o$[e],i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}};var Pw=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var In="WebChannelConnection",Yu=(n,e,t)=>{n.listen(e,r=>{try{t(r)}catch(i){setTimeout(()=>{throw i},0)}})},Yg=class n extends Nw{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=bb();Yu(e,Eb.STAT_EVENT,t=>{t.stat===wg.PROXY?oe(In,"STAT_EVENT: detected buffering proxy"):t.stat===wg.NOPROXY&&oe(In,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,r,i,o){let s=Rw();return new Promise((a,c)=>{let u=new vb;u.setWithCredentials(!0),u.listenOnce(_b.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Qu.NO_ERROR:let f=u.getResponseJson();oe(In,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case Qu.TIMEOUT:oe(In,`RPC '${e}' ${s} timed out`),c(new Z(B.DEADLINE_EXCEEDED,"Request time out"));break;case Qu.HTTP_ERROR:let g=u.getStatus();if(oe(In,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);let S=m?.error;if(S&&S.status&&S.message){let M=(function(P){let q=P.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(q)>=0?q:B.UNKNOWN})(S.status);c(new Z(M,S.message))}else c(new Z(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Z(B.UNAVAILABLE,"Connection failed."));break;default:Ie(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{oe(In,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);oe(In,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",d,r,15)})}T_(e,t,r){let i=Rw(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;let u=o.join("");oe(In,`Creating RPC '${e}' stream ${i}: ${u}`,a);let d=s.createWebChannel(u,a);this.I_(d);let f=!1,g=!1,m=new Pw({Ho:S=>{g?oe(In,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(f||(oe(In,`Opening RPC '${e}' stream ${i} transport.`),d.open(),f=!0),oe(In,`RPC '${e}' stream ${i} sending:`,S),d.send(S))},Jo:()=>d.close()});return Yu(d,yc.EventType.OPEN,()=>{g||(oe(In,`RPC '${e}' stream ${i} transport opened.`),m.i_())}),Yu(d,yc.EventType.CLOSE,()=>{g||(g=!0,oe(In,`RPC '${e}' stream ${i} transport closed`),m.o_(),this.E_(d))}),Yu(d,yc.EventType.ERROR,S=>{g||(g=!0,Qo(In,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),m.o_(new Z(B.UNAVAILABLE,"The operation could not be completed")))}),Yu(d,yc.EventType.MESSAGE,S=>{if(!g){let M=S.data[0];it(!!M,16349);let O=M,P=O?.error||O[0]?.error;if(P){oe(In,`RPC '${e}' stream ${i} received error:`,P);let q=P.status,$=(function(re){let D=Gt[re];if(D!==void 0)return FP(D)})(q),ae=P.message;$===void 0&&($=B.INTERNAL,ae="Unknown error status: "+q+" with message "+P.message),g=!0,m.o_(new Z($,ae)),d.close()}else oe(In,`RPC '${e}' stream ${i} received:`,M),m.__(M)}}),n.u_(),setTimeout(()=>{m.s_()},0),m}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return wb()}};function s$(n){return new Yg(n)}function Cb(){return typeof document<"u"?document:null}function yd(n){return new tw(n,!0)}Yg.c_=!1;var Jg=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var MN="PersistentStream",Zg=class{constructor(e,t,r,i,o,s,a,c){this.Ci=e,this.b_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Jg(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===B.RESOURCE_EXHAUSTED?(to(t.toString()),to("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new Z(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.H_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return oe(MN,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(oe(MN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},kw=class extends Zg{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=VH(this.serializer,e),r=(function(o){if(!("targetChange"in o))return Oe.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Oe.min():s.readTime?gi(s.readTime):Oe.min()})(e);return this.listener.J_(t,r)}Z_(e){let t={};t.database=ow(this.serializer),t.addTarget=(function(o,s){let a,c=s.target;if(a=zb(c)?{documents:jH(o,c)}:{query:HH(o,c).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=LP(o,s.resumeToken);let u=nw(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(Oe.min())>0){a.readTime=Gg(o,s.snapshotVersion.toTimestamp());let u=nw(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a})(this.serializer,e);let r=GH(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){let t={};t.database=ow(this.serializer),t.removeTarget=e,this.K_(t)}},Ow=class extends Zg{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return it(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,it(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){it(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=BH(e.writeResults,e.commitTime),r=gi(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=ow(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>UH(this.serializer,r))};this.K_(t)}};var Fw=class{},Lw=class extends Fw{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Z(B.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,rw(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Z(B.UNKNOWN,o.toString())})}jo(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,rw(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Z(B.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function a$(n,e,t,r){return new Lw(n,e,t,r)}var Vw=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(to(t),this.aa=!1):oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var la="RemoteStore",Uw=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{r.enqueueAndForget(async()=>{fa(this)&&(oe(la,"Restarting streams for network reachability change."),await(async function(c){let u=Ne(c);u.Ea.add(4),await vd(u),u.Va.set("Unknown"),u.Ea.delete(4),await pm(u)})(this))})}),this.Va=new Vw(r,i)}};async function pm(n){if(fa(n))for(let e of n.Ra)await e(!0)}async function vd(n){for(let e of n.Ra)await e(!1)}function QP(n,e){let t=Ne(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),yI(t)?mI(t):Uc(t).O_()&&gI(t,e))}function pI(n,e){let t=Ne(n),r=Uc(t);t.Ia.delete(e),r.O_()&&YP(t,e),t.Ia.size===0&&(r.O_()?r.L_():fa(t)&&t.Va.set("Unknown"))}function gI(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Oe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Uc(n).Z_(e)}function YP(n,e){n.da.$e(e),Uc(n).X_(e)}function mI(n){n.da=new ew({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Uc(n).start(),n.Va.ua()}function yI(n){return fa(n)&&!Uc(n).x_()&&n.Ia.size>0}function fa(n){return Ne(n).Ea.size===0}function JP(n){n.da=void 0}async function c$(n){n.Va.set("Online")}async function l$(n){n.Ia.forEach((e,t)=>{gI(n,e)})}async function u$(n,e){JP(n),yI(n)?(n.Va.ha(e),mI(n)):n.Va.set("Unknown")}async function d$(n,e,t){if(n.Va.set("Online"),e instanceof Hg&&e.state===2&&e.cause)try{await(async function(i,o){let s=o.cause;for(let a of o.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.Ia.delete(a),i.da.removeTarget(a))})(n,e)}catch(r){oe(la,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Xg(n,r)}else if(e instanceof Ic?n.da.Xe(e):e instanceof jg?n.da.st(e):n.da.tt(e),!t.isEqual(Oe.min()))try{let r=await KP(n.localStore);t.compareTo(r)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=o.Ia.get(u);d&&o.Ia.set(u,d.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,u)=>{let d=o.Ia.get(c);if(!d)return;o.Ia.set(c,d.withResumeToken(pn.EMPTY_BYTE_STRING,d.snapshotVersion)),YP(o,c);let f=new ld(d.target,c,u,d.sequenceNumber);gI(o,f)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){oe(la,"Failed to raise snapshot:",r),await Xg(n,r)}}async function Xg(n,e,t){if(!Vc(e))throw e;n.Ea.add(1),await vd(n),n.Va.set("Offline"),t||(t=()=>KP(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{oe(la,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await pm(n)})}function ZP(n,e){return e().catch(t=>Xg(n,t,e))}async function gm(n){let e=Ne(n),t=Zo(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:iI;for(;h$(e);)try{let i=await n$(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,f$(e,i)}catch(i){await Xg(e,i)}XP(e)&&ek(e)}function h$(n){return fa(n)&&n.Ta.length<10}function f$(n,e){n.Ta.push(e);let t=Zo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function XP(n){return fa(n)&&!Zo(n).x_()&&n.Ta.length>0}function ek(n){Zo(n).start()}async function p$(n){Zo(n).ra()}async function g$(n){let e=Zo(n);for(let t of n.Ta)e.ea(t.mutations)}async function m$(n,e,t){let r=n.Ta.shift(),i=Yb.from(r,e,t);await ZP(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await gm(n)}async function y$(n,e){e&&Zo(n).Y_&&await(async function(r,i){if((function(s){return AH(s)&&s!==B.ABORTED})(i.code)){let o=r.Ta.shift();Zo(r).B_(),await ZP(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await gm(r)}})(n,e),XP(n)&&ek(n)}async function RN(n,e){let t=Ne(n);t.asyncQueue.verifyOperationInProgress(),oe(la,"RemoteStore received new credentials");let r=fa(t);t.Ea.add(3),await vd(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await pm(t)}async function v$(n,e){let t=Ne(n);e?(t.Ea.delete(2),await pm(t)):e||(t.Ea.add(2),await vd(t),t.Va.set("Unknown"))}function Uc(n){return n.ma||(n.ma=(function(t,r,i){let o=Ne(t);return o.sa(),new kw(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:c$.bind(null,n),Yo:l$.bind(null,n),t_:u$.bind(null,n),J_:d$.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),yI(n)?mI(n):n.Va.set("Unknown")):(await n.ma.stop(),JP(n))})),n.ma}function Zo(n){return n.fa||(n.fa=(function(t,r,i){let o=Ne(t);return o.sa(),new Ow(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:p$.bind(null,n),t_:y$.bind(null,n),ta:g$.bind(null,n),na:m$.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await gm(n)):(await n.fa.stop(),n.Ta.length>0&&(oe(la,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var Bw=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new hi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function vI(n,e){if(to("AsyncQueue",`${e}: ${n}`),Vc(n))return new Z(B.UNAVAILABLE,`${e}: ${n}`);throw n}var hd=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||me.comparator(t.key,r.key):(t,r)=>me.comparator(t.key,r.key),this.keyedMap=Ju(),this.sortedSet=new Mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var em=class{constructor(){this.ga=new Mt(me.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ie(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},ua=class n{constructor(e,t,r,i,o,s,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,hd.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var jw=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},Hw=class{constructor(){this.queries=NN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=Ne(t),o=i.queries;i.queries=NN(),o.forEach((s,a)=>{for(let c of a.ba)c.onError(r)})})(this,new Z(B.ABORTED,"Firestore shutting down"))}};function NN(){return new so(n=>TP(n),hm)}async function _$(n,e){let t=Ne(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Sa()&&e.Da()&&(r=2):(o=new jw,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(s){let a=vI(s,`Initialization of query '${_c(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&_I(t)}async function E$(n,e){let t=Ne(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?i=e.Da()?0:1:!o.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function b$(n,e){let t=Ne(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(i)&&(r=!0);s.wa=i}}r&&_I(t)}function w$(n,e,t){let r=Ne(n),i=r.queries.get(e);if(i)for(let o of i.ba)o.onError(t);r.queries.delete(e)}function _I(n){n.Ca.forEach(e=>{e.next()})}var $w,PN;(PN=$w||($w={})).Ma="default",PN.Cache="cache";var Gw=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ua(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ua.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==$w.Cache}};var tm=class{constructor(e){this.key=e}},nm=class{constructor(e){this.key=e}},zw=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=je(),this.mutatedKeys=je(),this.eu=SP(e),this.tu=new hd(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new em,i=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let g=i.get(d),m=fm(this.query,f)?f:null,S=!!g&&this.mutatedKeys.has(g.key),M=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),O=!1;g&&m?g.data.isEqual(m.data)?S!==M&&(r.track({type:3,doc:m}),O=!0):this.su(g,m)||(r.track({type:2,doc:m}),O=!0,(c&&this.eu(m,c)>0||u&&this.eu(m,u)<0)&&(a=!0)):!g&&m?(r.track({type:0,doc:m}),O=!0):g&&!m&&(r.track({type:1,doc:g}),O=!0,(c||u)&&(a=!0)),O&&(m?(s=s.add(m),o=M?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{tu:s,iu:r,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,f)=>(function(m,S){let M=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie(20277,{Vt:O})}};return M(m)-M(S)})(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(r),i=i??!1;let a=t&&!i?this._u():[],c=this.Ya.size===0&&this.current&&!i?1:0,u=c!==this.Xa;return this.Xa=c,s.length!==0||u?{snapshot:new ua(this.query,e.tu,o,s,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new em,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=je(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});let t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new nm(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new tm(r))}),t}cu(e){this.Za=e.ks,this.Ya=je();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ua.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},EI="SyncEngine",qw=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Ww=class{constructor(e){this.key=e,this.hu=!1}},Kw=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new so(a=>TP(a),hm),this.Iu=new Map,this.Eu=new Set,this.Ru=new Mt(me.comparator),this.Au=new Map,this.Vu=new dd,this.du={},this.mu=new Map,this.fu=ud.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function I$(n,e,t=!0){let r=sk(n),i,o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await tk(r,e,t,!0),i}async function T$(n,e){let t=sk(n);await tk(t,e,!0,!1)}async function tk(n,e,t,r){let i=await r$(n.localStore,pi(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=await S$(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&QP(n.remoteStore,i),a}async function S$(n,e,t,r,i){n.pu=(f,g,m)=>(async function(M,O,P,q){let $=O.view.ru(P);$.Ss&&($=await xN(M.localStore,O.query,!1).then(({documents:D})=>O.view.ru(D,$)));let ae=q&&q.targetChanges.get(O.targetId),be=q&&q.targetMismatches.get(O.targetId)!=null,re=O.view.applyChanges($,M.isPrimaryClient,ae,be);return ON(M,O.targetId,re.au),re.snapshot})(n,f,g,m);let o=await xN(n.localStore,e,!0),s=new zw(e,o.ks),a=s.ru(o.documents),c=cd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=s.applyChanges(a,n.isPrimaryClient,c);ON(n,t,u.au);let d=new qw(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function C$(n,e,t){let r=Ne(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter(s=>!hm(s,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xw(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&pI(r.remoteStore,i.targetId),Qw(r,i.targetId)}).catch(Lc)):(Qw(r,i.targetId),await xw(r.localStore,i.targetId,!0))}async function D$(n,e){let t=Ne(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),pI(t.remoteStore,r.targetId))}async function x$(n,e,t){let r=O$(n);try{let i=await(function(s,a){let c=Ne(s),u=Lt.now(),d=a.reduce((m,S)=>m.add(S.key),je()),f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let S=ao(),M=je();return c.xs.getEntries(m,d).next(O=>{S=O,S.forEach((P,q)=>{q.isValidDocument()||(M=M.add(P))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,S)).next(O=>{f=O;let P=[];for(let q of a){let $=xH(q,f.get(q.key).overlayedDocument);$!=null&&P.push(new co(q.key,$,mP($.value.mapValue),Ko.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,P,a)}).next(O=>{g=O;let P=O.applyToLocalDocumentSet(f,M);return c.documentOverlayCache.saveOverlays(m,O.batchId,P)})}).then(()=>({batchId:g.batchId,changes:DP(f)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(s,a,c){let u=s.du[s.currentUser.toKey()];u||(u=new Mt(Ge)),u=u.insert(a,c),s.du[s.currentUser.toKey()]=u})(r,i.batchId,t),await _d(r,i.changes),await gm(r.remoteStore)}catch(i){let o=vI(i,"Failed to persist write");t.reject(o)}}async function nk(n,e){let t=Ne(n);try{let r=await e$(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Au.get(o);s&&(it(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?it(s.hu,14607):i.removedDocuments.size>0&&(it(s.hu,42227),s.hu=!1))}),await _d(t,r,e)}catch(r){await Lc(r)}}function kN(n,e,t){let r=Ne(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(s,a){let c=Ne(s);c.onlineState=a;let u=!1;c.queries.forEach((d,f)=>{for(let g of f.ba)g.va(a)&&(u=!0)}),u&&_I(c)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function A$(n,e,t){let r=Ne(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),o=i&&i.key;if(o){let s=new Mt(me.comparator);s=s.insert(o,Fr.newNoDocument(o,Oe.min()));let a=je().add(o),c=new Bg(Oe.min(),new Map,new Mt(Ge),s,a);await nk(r,c),r.Ru=r.Ru.remove(o),r.Au.delete(e),bI(r)}else await xw(r.localStore,e,!1).then(()=>Qw(r,e,t)).catch(Lc)}async function M$(n,e){let t=Ne(n),r=e.batch.batchId;try{let i=await XH(t.localStore,e);ik(t,r,null),rk(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await _d(t,i)}catch(i){await Lc(i)}}async function R$(n,e,t){let r=Ne(n);try{let i=await(function(s,a){let c=Ne(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>(it(f!==null,37113),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})})(r.localStore,e);ik(r,e,t),rk(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await _d(r,i)}catch(i){await Lc(i)}}function rk(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function ik(n,e,t){let r=Ne(n),i=r.du[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function Qw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(r=>{n.Vu.containsKey(r)||ok(n,r)})}function ok(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(pI(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),bI(n))}function ON(n,e,t){for(let r of t)r instanceof tm?(n.Vu.addReference(r.key,e),N$(n,r)):r instanceof nm?(oe(EI,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||ok(n,r.key)):Ie(19791,{wu:r})}function N$(n,e){let t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(oe(EI,"New document in limbo: "+t),n.Eu.add(r),bI(n))}function bI(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new me(pt.fromString(e)),r=n.fu.next();n.Au.set(r,new Ww(t)),n.Ru=n.Ru.insert(t,r),QP(n.remoteStore,new ld(pi(uI(t.path)),r,"TargetPurposeLimboResolution",rI.ce))}}async function _d(n,e,t){let r=Ne(n),i=[],o=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{s.push(r.pu(c,e,t).then(u=>{if((u||t)&&r.isPrimaryClient){let d=u?!u.fromCache:t?.targetChanges.get(c.targetId)?.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);let d=Tw.Es(c.targetId,u);o.push(d)}}))}),await Promise.all(s),r.Pu.J_(i),await(async function(c,u){let d=Ne(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>K.forEach(u,g=>K.forEach(g.Ts,m=>d.persistence.referenceDelegate.addReference(f,g.targetId,m)).next(()=>K.forEach(g.Is,m=>d.persistence.referenceDelegate.removeReference(f,g.targetId,m)))))}catch(f){if(!Vc(f))throw f;oe(fI,"Failed to update sequence numbers: "+f)}for(let f of u){let g=f.targetId;if(!f.fromCache){let m=d.vs.get(g),S=m.snapshotVersion,M=m.withLastLimboFreeSnapshotVersion(S);d.vs=d.vs.insert(g,M)}}})(r.localStore,o))}async function P$(n,e){let t=Ne(n);if(!t.currentUser.isEqual(e)){oe(EI,"User change. New user:",e.toKey());let r=await WP(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(c=>{c.reject(new Z(B.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await _d(t,r.Ns)}}function k$(n,e){let t=Ne(n),r=t.Au.get(e);if(r&&r.hu)return je().add(r.key);{let i=je(),o=t.Iu.get(e);if(!o)return i;for(let s of o){let a=t.Tu.get(s);i=i.unionWith(a.view.nu)}return i}}function sk(n){let e=Ne(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=nk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=k$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=A$.bind(null,e),e.Pu.J_=b$.bind(null,e.eventManager),e.Pu.yu=w$.bind(null,e.eventManager),e}function O$(n){let e=Ne(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=M$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=R$.bind(null,e),e}var wI=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=yd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return ZH(this.persistence,new Cw,t.initialUser,this.serializer)}Cu(t){return new qg(Iw.Vi,this.serializer)}Du(t){return new Aw}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),rm=class extends wI{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){it(this.persistence.referenceDelegate instanceof Wg,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new uw(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?pr.withCacheSize(this.cacheSizeBytes):pr.DEFAULT;return new qg(r=>Wg.Vi(r,t),this.serializer)}};var ak=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=P$.bind(null,this.syncEngine),await v$(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Hw})()}createDatastore(t){let r=yd(t.databaseInfo.databaseId),i=s$(t.databaseInfo);return a$(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,o,s,a,c){return new Uw(i,o,s,a,c)})(this.localStore,this.datastore,t.asyncQueue,r=>kN(this.syncEngine,r,0),(function(){return Qg.v()?new Qg:new Mw})())}createSyncEngine(t,r){return(function(o,s,a,c,u,d,f){let g=new Kw(o,s,a,c,u,d);return f&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=Ne(r);oe(la,"RemoteStore shutting down."),i.Ea.add(5),await vd(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var Yw=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):to("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Xo="FirestoreClient",Jw=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=rn.UNAUTHENTICATED,this.clientId=ra.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async s=>{oe(Xo,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(oe(Xo,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new hi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=vI(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Db(n,e){n.asyncQueue.verifyOperationInProgress(),oe(Xo,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await WP(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function FN(n,e){n.asyncQueue.verifyOperationInProgress();let t=await F$(n);oe(Xo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>RN(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>RN(e.remoteStore,i)),n._onlineComponents=e}async function F$(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){oe(Xo,"Using user provided OfflineComponentProvider");try{await Db(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Qo("Error using user provided cache. Falling back to memory cache: "+t),await Db(n,new wI)}}else oe(Xo,"Using default OfflineComponentProvider"),await Db(n,new rm(void 0));return n._offlineComponents}async function ck(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(oe(Xo,"Using user provided OnlineComponentProvider"),await FN(n,n._uninitializedComponentsProvider._online)):(oe(Xo,"Using default OnlineComponentProvider"),await FN(n,new ak))),n._onlineComponents}function L$(n){return ck(n).then(e=>e.syncEngine)}async function V$(n){let e=await ck(n),t=e.eventManager;return t.onListen=I$.bind(null,e.syncEngine),t.onUnlisten=C$.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=T$.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=D$.bind(null,e.syncEngine),t}function lk(n,e,t={}){let r=new hi;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,c,u){let d=new Yw({next:g=>{d.Nu(),s.enqueueAndForget(()=>E$(o,f)),g.fromCache&&c.source==="server"?u.reject(new Z(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new Gw(a,d,{includeMetadataChanges:!0,Ka:!0});return _$(o,f)})(await V$(n),n.asyncQueue,e,t,r)),r.promise}function uk(n,e){let t=new hi;return n.asyncQueue.enqueueAndForget(async()=>x$(await L$(n),e,t)),t.promise}function dk(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var U$="ComponentProvider",LN=new Map;function B$(n,e,t,r,i){return new Pb(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,dk(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}var hk="firestore.googleapis.com",VN=!0,im=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Z(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hk,this.ssl=VN}else this.host=e.host,this.ssl=e.ssl??VN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QH)throw new Z(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}GN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dk(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Rc=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new im({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new im(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Mg;switch(r.type){case"firstParty":return new Mb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=LN.get(t);r&&(oe(U$,"Removing Datastore"),LN.delete(t),r.terminate())})(this),Promise.resolve()}};function fk(n,e,t,r={}){n=Oc(n,Rc);let i=$o(e),o=n._getSettings(),s=le(F({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;i&&(gg(`https://${a}`),mg("Firestore",!0)),o.host!==hk&&o.host!==a&&Qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let c=le(F({},o),{host:a,ssl:i,emulatorOptions:r});if(!kr(c,s)&&(n._setSettings(c),r.mockUserToken)){let u,d;if(typeof r.mockUserToken=="string")u=r.mockUserToken,d=rn.MOCK_USER;else{u=MR(r.mockUserToken,n._app?.options.projectId);let f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new Z(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new rn(f)}n._authCredentials=new xb(new Ag(u,d))}}var Lr=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},fn=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Fc(t,n._jsonSchema))return new n(e,r||null,new me(pt.fromString(t.referencePath)))}};fn._jsonSchemaVersion="firestore/documentReference/1.0",fn._jsonSchema={type:Ft("string",fn._jsonSchemaVersion),referencePath:Ft("string")};var Xi=class n extends Lr{constructor(e,t,r){super(e,t,uI(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new fn(this.firestore,null,new me(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Vr(n,e,...t){if(n=nn(n),$N("collection","path",e),n instanceof Rc){let r=pt.fromString(e,...t);return iN(r),new Xi(n,null,r)}{if(!(n instanceof fn||n instanceof Xi))throw new Z(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pt.fromString(e,...t));return iN(r),new Xi(n.firestore,null,r)}}function II(n,e,...t){if(n=nn(n),arguments.length===1&&(e=ra.newId()),$N("doc","path",e),n instanceof Rc){let r=pt.fromString(e,...t);return rN(r),new fn(n,null,new me(r))}{if(!(n instanceof fn||n instanceof Xi))throw new Z(B.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pt.fromString(e,...t));return rN(r),new fn(n.firestore,n instanceof Xi?n.converter:null,new me(r))}}var UN="AsyncQueue",om=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Jg(this,"async_queue_retry"),this._c=()=>{let r=Cb();r&&oe(UN,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=Cb();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Cb();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new hi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Vc(e))throw e;oe(UN,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,to("INTERNAL UNHANDLED ERROR: ",BN(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=Bw.createAndSchedule(this,e,t,r,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&Ie(47125,{Pc:BN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function BN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var da=class extends Rc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new om,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new om(e),this._firestoreClient=void 0,await e}}};function Ed(n,e){let t=typeof n=="object"?n:Eg(),r=typeof n=="string"?n:e||Vg,i=Wu(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=AR("firestore");o&&fk(i,...o)}return i}function mm(n){if(n._terminated)throw new Z(B.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||j$(n),n._firestoreClient}function j$(n){let e=n._freezeSettings(),t=B$(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Jw(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(n._componentsProvider))}var mi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(pn.fromBase64String(e))}catch(t){throw new Z(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Fc(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};mi._jsonSchemaVersion="firestore/bytes/1.0",mi._jsonSchema={type:Ft("string",mi._jsonSchemaVersion),bytes:Ft("string")};var Nc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Z(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Pc=class{constructor(e){this._methodName=e}};var eo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Z(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Z(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Fc(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};eo._jsonSchemaVersion="firestore/geoPoint/1.0",eo._jsonSchema={type:Ft("string",eo._jsonSchemaVersion),latitude:Ft("number"),longitude:Ft("number")};var yi=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Fc(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new Z(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};yi._jsonSchemaVersion="firestore/vectorValue/1.0",yi._jsonSchema={type:Ft("string",yi._jsonSchemaVersion),vectorValues:Ft("object")};var H$=/^__.*__$/,Zw=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new co(e,this.data,this.fieldMask,t,this.fieldTransforms):new ca(e,this.data,t,this.fieldTransforms)}};function pk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie(40011,{dataSource:n})}}var Xw=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(F(F({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return sm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(pk(this.dataSource)&&H$.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},eI=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||yd(e)}createContext(e,t,r,i=!1){return new Xw({dataSource:e,methodName:t,targetDoc:r,path:Un.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ym(n){let e=n._freezeSettings(),t=yd(n._databaseId);return new eI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function gk(n,e,t,r,i,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,i);vk("Data must be an object, but it was:",s,r);let a=mk(r,s),c,u;if(o.merge)c=new di(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let f of o.mergeFields){let g=Bc(e,f,t);if(!s.contains(g))throw new Z(B.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);G$(d,g)||d.push(g)}c=new di(d),u=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=s.fieldTransforms;return new Zw(new gr(a),c,u)}var tI=class n extends Pc{_toFieldTransform(e){return new qb(e.path,new oa)}isEqual(e){return e instanceof n}};function TI(n,e,t,r=!1){return SI(t,n.createContext(r?4:3,e))}function SI(n,e){if(yk(n=nn(n)))return vk("Unsupported field value:",e,n),mk(n,e);if(n instanceof Pc)return(function(r,i){if(!pk(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){let o=[],s=0;for(let a of r){let c=SI(a,i.childContextForArray(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=nn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return IH(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Lt.fromDate(r);return{timestampValue:Gg(i.serializer,o)}}if(r instanceof Lt){let o=new Lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Gg(i.serializer,o)}}if(r instanceof eo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof mi)return{bytesValue:LP(i.serializer,r._byteString)};if(r instanceof fn){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:hI(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof yi)return(function(s,a){let c=s instanceof yi?s.toArray():s;return{mapValue:{fields:{[oI]:{stringValue:sI},[Sc]:{arrayValue:{values:c.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return dI(a.serializer,d)})}}}}}})(r,i);if(GP(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${pd(r)}`)})(n,e)}function mk(n,e){let t={};return aP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ha(n,(r,i)=>{let o=SI(i,e.childContextForField(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function yk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Lt||n instanceof eo||n instanceof mi||n instanceof fn||n instanceof Pc||n instanceof yi||GP(n))}function vk(n,e,t){if(!yk(t)||!zN(t)){let r=pd(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function Bc(n,e,t){if((e=nn(e))instanceof Nc)return e._internalPath;if(typeof e=="string")return _k(n,e);throw sm("Field path arguments must be of type string or ",n,!1,void 0,t)}var $$=new RegExp("[~\\*/\\[\\]]");function _k(n,e,t){if(e.search($$)>=0)throw sm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Nc(...e.split("."))._internalPath}catch{throw sm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function sm(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new Z(B.INVALID_ARGUMENT,a+n+c)}function G$(n,e){return n.some(t=>t.isEqual(e))}var fd=class{convertValue(e,t="none"){switch(Yo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ro(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ha(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){let t=e.fields?.[Sc].arrayValue?.values?.map(r=>It(r.doubleValue));return new yi(t)}convertGeoPoint(e){return new eo(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=lm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(rd(e));default:return null}}convertTimestamp(e){let t=no(e);return new Lt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=pt.fromString(e);it($P(r),9688,{name:e});let i=new id(r.get(1),r.get(3)),o=new me(r.popFirst(5));return i.isEqual(t)||to(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var am=class extends fd{constructor(e){super(),this.firestore=e}convertBytes(e){return new mi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new fn(this.firestore,null,t)}};function CI(){return new tI("serverTimestamp")}var Ek="@firebase/firestore",bk="4.10.0";var bd=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new fn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new DI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(Bc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},DI=class extends bd{data(){return super.data()}};function K$(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Z(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var wd=class{},zc=class extends wd{};function es(n,e,...t){let r=[];e instanceof wd&&r.push(e),r=r.concat(t),(function(o){let s=o.filter(c=>c instanceof xI).length,a=o.filter(c=>c instanceof vm).length;if(s>1||s>0&&a>0)throw new Z(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var vm=class n extends zc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Sk(e._query,t),new Lr(e.firestore,e.converter,dm(e._query,t))}_parse(e){let t=ym(e.firestore);return(function(o,s,a,c,u,d,f){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Z(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Ik(f,d);let S=[];for(let M of f)S.push(wk(c,o,M));g={arrayValue:{values:S}}}else g=wk(c,o,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Ik(f,d),g=TI(a,s,f,d==="in"||d==="not-in");return Ot.create(u,d,g)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function ts(n,e,t){let r=e,i=Bc("where",n);return vm._create(i,r,t)}var xI=class n extends wd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:mr.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)Sk(s,c),s=dm(s,c)})(e._query,t),new Lr(e.firestore,e.converter,dm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var AI=class n extends zc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,o,s){if(i.startAt!==null)throw new Z(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Z(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jo(o,s)})(e._query,this._field,this._direction);return new Lr(e.firestore,e.converter,wP(e._query,t))}};function lo(n,e="asc"){let t=e,r=Bc("orderBy",n);return AI._create(r,t)}var MI=class n extends zc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Lr(e.firestore,e.converter,sd(e._query,this._limit,this._limitType))}};function pa(n){return qN("limit",n),MI._create("limit",n,"F")}var RI=class n extends zc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=Q$(e,this.type,this._docOrFields,this._inclusive);return new Lr(e.firestore,e.converter,IP(e._query,t))}};function Tk(...n){return RI._create("startAfter",n,!1)}function Q$(n,e,t,r){if(t[0]=nn(t[0]),t[0]instanceof bd)return(function(o,s,a,c,u){if(!c)throw new Z(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let f of ta(o))if(f.field.isKeyField())d.push(md(s,c.key));else{let g=c.data.field(f.field);if(gd(g))throw new Z(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let m=f.field.canonicalString();throw new Z(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}d.push(g)}return new io(d,u)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=ym(n.firestore);return(function(s,a,c,u,d,f){let g=s.explicitOrderBy;if(d.length>g.length)throw new Z(B.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let m=[];for(let S=0;S<d.length;S++){let M=d[S];if(g[S].field.isKeyField()){if(typeof M!="string")throw new Z(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof M}`);if(!um(s)&&M.indexOf("/")!==-1)throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${M}' contains a slash.`);let O=s.path.child(pt.fromString(M));if(!me.isDocumentKey(O))throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${O}' is not because it contains an odd number of segments.`);let P=new me(O);m.push(md(a,P))}else{let O=TI(c,u,M);m.push(O)}}return new io(m,f)})(n._query,n.firestore._databaseId,i,e,t,r)}}function wk(n,e,t){if(typeof(t=nn(t))=="string"){if(t==="")throw new Z(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!um(e)&&t.indexOf("/")!==-1)throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(pt.fromString(t));if(!me.isDocumentKey(r))throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return md(n,new me(r))}if(t instanceof fn)return md(n,t._key);throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pd(t)}.`)}function Ik(n,e){if(!Array.isArray(n)||n.length===0)throw new Z(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Sk(n,e){let t=(function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Z(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Y$(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var jc=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Hc=class n extends bd{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new $c(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Bc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Hc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hc._jsonSchema={type:Ft("string",Hc._jsonSchemaVersion),bundleSource:Ft("string","DocumentSnapshot"),bundleName:Ft("string"),bundle:Ft("string")};var $c=class extends Hc{data(e={}){return super.data(e)}},Gc=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new jc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new $c(this._firestore,this._userDataWriter,r.key,r,new jc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Z(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new $c(i._firestore,i._userDataWriter,a.doc.key,a.doc,new jc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new $c(i._firestore,i._userDataWriter,a.doc.key,a.doc,new jc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:J$(a.type),doc:c,oldIndex:u,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ra.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function J$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie(61501,{type:n})}}Gc._jsonSchemaVersion="firestore/querySnapshot/1.0",Gc._jsonSchema={type:Ft("string",Gc._jsonSchemaVersion),bundleSource:Ft("string","QuerySnapshot"),bundleName:Ft("string"),bundle:Ft("string")};function ga(n){n=Oc(n,Lr);let e=Oc(n.firestore,da),t=mm(e),r=new am(e);return K$(n._query),lk(t,n._query).then(i=>new Gc(e,r,n,i))}function _m(n,e){let t=Oc(n.firestore,da),r=II(n),i=Y$(n.converter,e),o=ym(n.firestore);return Z$(t,[gk(o,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ko.exists(!1))]).then(()=>r)}function Z$(n,e){let t=mm(n);return uk(t,e)}(function(e,t=!0){jN(Wo),qo(new fr("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new da(new Rg(r.getProvider("auth-internal")),new Pg(s,r.getProvider("app-check-internal")),hP(s,i),s);return o=F({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Or(Ek,bk,e),Or(Ek,bk,"esm2020")})();function Bk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var jk=Bk,Hk=new Qi("auth","Firebase",Bk());var Sm=new Go("@firebase/auth");function X$(n,...e){Sm.logLevel<=Be.WARN&&Sm.warn(`Auth (${Wo}): ${n}`,...e)}function bm(n,...e){Sm.logLevel<=Be.ERROR&&Sm.error(`Auth (${Wo}): ${n}`,...e)}function Ei(n,...e){throw QI(n,...e)}function Ur(n,...e){return QI(n,...e)}function KI(n,e,t){let r=le(F({},jk()),{[e]:t});return new Qi("auth","Firebase",r).create(e,{appName:n.name})}function ma(n){return KI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function e9(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ei(n,"argument-error"),KI(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function QI(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Hk.create(n,...e)}function De(n,e,...t){if(!n)throw QI(e,...t)}function uo(n){let e="INTERNAL ASSERTION FAILED: "+n;throw bm(e),new Error(e)}function fo(n,e){n||uo(e)}function kI(){return typeof self<"u"&&self.location?.href||""}function t9(){return Ck()==="http:"||Ck()==="https:"}function Ck(){return typeof self<"u"&&self.location?.protocol||null}function n9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(t9()||PR()||"connection"in navigator)?navigator.onLine:!0}function r9(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var ya=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,fo(t>e,"Short delay should be less than long delay!"),this.isMobile=RR()||kR()}get(){return n9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function YI(n,e){fo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Cm=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;uo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;uo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;uo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var i9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var o9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],s9=new ya(3e4,6e4);function JI(n,e){return n.tenantId&&!e.tenantId?le(F({},e),{tenantId:n.tenantId}):e}async function Wc(n,e,t,r,i={}){return $k(n,i,async()=>{let o={},s={};r&&(e==="GET"?s=r:o={body:JSON.stringify(r)});let a=mc(F({key:n.config.apiKey},s)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);let u=F({method:e,headers:c},o);return NR()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&$o(n.emulatorConfig.host)&&(u.credentials="include"),Cm.fetch()(await Gk(n,n.config.apiHost,t,a),u)})}async function $k(n,e,t){n._canInitEmulator=!1;let r=F(F({},i9),e);try{let i=new OI(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw Em(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Em(n,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Em(n,"email-already-in-use",s);if(c==="USER_DISABLED")throw Em(n,"user-disabled",s);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw KI(n,d,u);Ei(n,d)}}catch(i){if(i instanceof er)throw i;Ei(n,"network-request-failed",{message:String(i)})}}async function a9(n,e,t,r,i={}){let o=await Wc(n,e,t,r,i);return"mfaPendingCredential"in o&&Ei(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function Gk(n,e,t,r){let i=`${e}${t}?${r}`,o=n,s=o.config.emulator?YI(n.config,i):`${n.config.apiScheme}://${i}`;return o9.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var OI=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ur(this.auth,"network-request-failed")),s9.get())})}};function Em(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ur(n,e,r);return i.customData._tokenResponse=t,i}async function c9(n,e){return Wc(n,"POST","/v1/accounts:delete",e)}async function Dm(n,e){return Wc(n,"POST","/v1/accounts:lookup",e)}function Id(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zk(n,e=!1){let t=nn(n),r=await t.getIdToken(e),i=ZI(r);De(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:r,authTime:Id(NI(i.auth_time)),issuedAtTime:Id(NI(i.iat)),expirationTime:Id(NI(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function NI(n){return Number(n)*1e3}function ZI(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return bm("JWT malformed, contained fewer than 3 sections"),null;try{let i=fg(t);return i?JSON.parse(i):(bm("Failed to decode base64 JWT payload"),null)}catch(i){return bm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Dk(n){let e=ZI(n);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Sd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof er&&l9(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function l9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var FI=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Cd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Id(this.lastLoginAt),this.creationTime=Id(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function xm(n){let e=n.auth,t=await n.getIdToken(),r=await Sd(n,Dm(e,{idToken:t}));De(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let o=i.providerUserInfo?.length?Wk(i.providerUserInfo):[],s=u9(n.providerData,o),a=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!s?.length,u=a?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Cd(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function qk(n){let e=nn(n);await xm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function u9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Wk(n){return n.map(r=>{var i=r,{providerId:e}=i,t=Ia(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function d9(n,e){let t=await $k(n,{},async()=>{let r=mc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=await Gk(n,i,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return n.emulatorConfig&&$o(n.emulatorConfig.host)&&(c.credentials="include"),Cm.fetch()(s,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function h9(n,e){return Wc(n,"POST","/v2/accounts:revokeToken",JI(n,e))}var Td=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Dk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");let t=Dk(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:o}=await d9(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new n;return r&&(De(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(De(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(De(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return uo("not implemented")}};function ns(n,e){De(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var rs=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:r}=s,i=Ia(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new FI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Cd(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Sd(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return zk(this,e)}reload(){return qk(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>F({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(le(F({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await xm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(tr(this.auth.app))return Promise.reject(ma(this.auth));let e=await this.getIdToken();return await Sd(this,c9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return le(F({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>F({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,c=t._redirectEventId??void 0,u=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:f,emailVerified:g,isAnonymous:m,providerData:S,stsTokenManager:M}=t;De(f&&M,e,"internal-error");let O=Td.fromJSON(this.name,M);De(typeof f=="string",e,"internal-error"),ns(r,e.name),ns(i,e.name),De(typeof g=="boolean",e,"internal-error"),De(typeof m=="boolean",e,"internal-error"),ns(o,e.name),ns(s,e.name),ns(a,e.name),ns(c,e.name),ns(u,e.name),ns(d,e.name);let P=new n({uid:f,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:m,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:O,createdAt:u,lastLoginAt:d});return S&&Array.isArray(S)&&(P.providerData=S.map(q=>F({},q))),c&&(P._redirectEventId=c),P}static async _fromIdTokenResponse(e,t,r=!1){let i=new Td;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await xm(o),o}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];De(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Wk(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new Td;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Cd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c}};var xk=new Map;function ho(n){fo(n instanceof Function,"Expected a class definition");let e=xk.get(n);return e?(fo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xk.set(n,e),e)}var f9=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),LI=f9;function wm(n,e,t){return`firebase:${n}:${e}:${t}`}var Am=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=wm(this.userKey,i.apiKey,o),this.fullPersistenceKey=wm("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Dm(this.auth,{idToken:e}).catch(()=>{});return t?rs._fromGetAccountInfoResponse(this.auth,t,e):null}return rs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(ho(LI),e,r);let i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u),o=i[0]||ho(LI),s=wm(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=await u._get(s);if(d){let f;if(typeof d=="string"){let g=await Dm(e,{idToken:d}).catch(()=>{});if(!g)break;f=await rs._fromGetAccountInfoResponse(e,g,d)}else f=rs._fromJSON(e,d);u!==o&&(a=f),o=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new n(o,e,r):(o=c[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new n(o,e,r))}};function Ak(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Kk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Xk(e))return"Blackberry";if(eO(e))return"Webos";if(Qk(e))return"Safari";if((e.includes("chrome/")||Yk(e))&&!e.includes("edge/"))return"Chrome";if(Zk(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Kk(n=tn()){return/firefox\//i.test(n)}function Qk(n=tn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Yk(n=tn()){return/crios\//i.test(n)}function Jk(n=tn()){return/iemobile/i.test(n)}function Zk(n=tn()){return/android/i.test(n)}function Xk(n=tn()){return/blackberry/i.test(n)}function eO(n=tn()){return/webos/i.test(n)}function XI(n=tn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function p9(n=tn()){return XI(n)&&!!window.navigator?.standalone}function g9(){return OR()&&document.documentMode===10}function tO(n=tn()){return XI(n)||Zk(n)||eO(n)||Xk(n)||/windows phone/i.test(n)||Jk(n)}function nO(n,e=[]){let t;switch(n){case"Browser":t=Ak(tn());break;case"Worker":t=`${Ak(tn())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wo}/${r}`}var VI=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((s,a)=>{try{let c=e(o);s(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function m9(n,e={}){return Wc(n,"GET","/v2/passwordPolicy",JI(n,e))}var y9=6,UI=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??y9,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var BI=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Mm(this),this.idTokenSubscription=new Mm(this),this.beforeStateQueue=new VI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Hk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ho(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Am.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Dm(this,{idToken:e}),r=await rs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(tr(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=r9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(tr(this.app))return Promise.reject(ma(this));let t=e?nn(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return tr(this.app)?Promise.reject(ma(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return tr(this.app)?Promise.reject(ma(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ho(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await m9(this),t=new UI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qi("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await h9(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&ho(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await Am.create(this,[ho(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{s=!0,c()}}else{let c=e.addObserver(t);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=nO(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&X$(`Error while retrieving App Check token: ${e.error}`),e?.token}};function Vm(n){return nn(n)}var Mm=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=UR(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var eT={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function v9(n){eT=n}function _9(n){return eT.loadJS(n)}function E9(){return eT.gapiScript}function rO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function iO(n,e){let t=Wu(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(kr(o,e??{}))return i;Ei(i,"already-initialized")}return t.initialize({options:e})}function b9(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ho);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function oO(n,e,t){let r=Vm(n);De(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=sO(e),{host:s,port:a}=w9(e),c=a===null?"":`:${a}`,u={url:`${o}//${s}${c}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){De(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),De(kr(u,r.config.emulator)&&kr(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,$o(s)?(gg(`${o}//${s}${c}`),mg("Auth",!0)):i||I9()}function sO(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function w9(n){let e=sO(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Mk(r.substr(o.length+1))}}else{let[o,s]=r.split(":");return{host:o,port:Mk(s)}}}function Mk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function I9(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Dd=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return uo("not implemented")}_getIdTokenResponse(e){return uo("not implemented")}_linkToIdToken(e,t){return uo("not implemented")}_getReauthenticationResolver(e){return uo("not implemented")}};async function qc(n,e){return a9(n,"POST","/v1/accounts:signInWithIdp",JI(n,e))}var T9="http://localhost",Rm=class n extends Dd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ei("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=a,o=Ia(a,["providerId","signInMethod"]);if(!r||!i)return null;let s=new n(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return qc(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,qc(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,qc(e,t)}buildRequest(){let e={requestUri:T9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=mc(t)}return e}};var xd=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Nm=class extends xd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var tT=(()=>{class n extends Nm{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Rm._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var Ad=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let o=await rs._fromIdTokenResponse(e,r,i),s=Rk(r);return new n({user:o,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=Rk(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function Rk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var jI=class n extends er{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function aO(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?jI._fromErrorAndOperation(n,o,e,r):o})}async function S9(n,e,t=!1){let r=await Sd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ad._forOperation(n,"link",r)}async function C9(n,e,t=!1){let{auth:r}=n;if(tr(r.app))return Promise.reject(ma(r));let i="reauthenticate";try{let o=await Sd(n,aO(r,i,e,n),t);De(o.idToken,r,"internal-error");let s=ZI(o.idToken);De(s,r,"internal-error");let{sub:a}=s;return De(n.uid===a,r,"user-mismatch"),Ad._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ei(r,"user-mismatch"),o}}async function D9(n,e,t=!1){if(tr(n.app))return Promise.reject(ma(n));let r="signIn",i=await aO(n,r,e),o=await Ad._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}function cO(n,e,t,r){return nn(n).onIdTokenChanged(e,t,r)}function lO(n,e,t){return nn(n).beforeAuthStateChanged(e,t)}function nT(n,e,t,r){return nn(n).onAuthStateChanged(e,t,r)}function rT(n){return nn(n).signOut()}var Pm="__sak";var km=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Pm,"1"),this.storage.removeItem(Pm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var x9=1e3,A9=10,M9=(()=>{class n extends km{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=tO(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);g9()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,A9):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},x9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),uO=M9;var R9=(()=>{class n extends km{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),iT=R9;function N9(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var P9=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:o,data:s}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let c=Array.from(a).map(async d=>d(r.origin,s)),u=await N9(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:u})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function oT(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var HI=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,c)=>{let u=oT("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(f){let g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(g.data.response);break;default:clearTimeout(d),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function _i(){return window}function k9(n){_i().location.href=n}function dO(){return typeof _i().WorkerGlobalScope<"u"&&typeof _i().importScripts=="function"}async function O9(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function F9(){return navigator?.serviceWorker?.controller||null}function L9(){return dO()?self:null}var hO="firebaseLocalStorageDb",V9=1,Om="firebaseLocalStorage",fO="fbase_key",va=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Um(n,e){return n.transaction([Om],e?"readwrite":"readonly").objectStore(Om)}function U9(){let n=indexedDB.deleteDatabase(hO);return new va(n).toPromise()}function $I(){let n=indexedDB.open(hO,V9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Om,{keyPath:fO})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Om)?e(r):(r.close(),await U9(),e(await $I()))})})}async function Nk(n,e,t){let r=Um(n,!0).put({[fO]:e,value:t});return new va(r).toPromise()}async function B9(n,e){let t=Um(n,!1).get(e),r=await new va(t).toPromise();return r===void 0?null:r.value}function Pk(n,e){let t=Um(n,!0).delete(e);return new va(t).toPromise()}var j9=800,H9=3,$9=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $I(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>H9)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=P9._getInstance(L9()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await O9(),!this.activeServiceWorker)return;this.sender=new HI(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||F9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await $I();return await Nk(t,Pm,"1"),await Pk(t,Pm),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>Nk(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>B9(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Pk(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=Um(o,!1).getAll();return new va(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),j9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),pO=$9;var Cle=rO("rcb"),Dle=new ya(3e4,6e4);function gO(n,e){return e?ho(e):(De(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Md=class extends Dd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function G9(n){return D9(n.auth,new Md(n),n.bypassAuthState)}function z9(n){let{auth:e,user:t}=n;return De(t,e,"internal-error"),C9(t,new Md(n),n.bypassAuthState)}async function q9(n){let{auth:e,user:t}=n;return De(t,e,"internal-error"),S9(t,new Md(n),n.bypassAuthState)}var Fm=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return G9;case"linkViaPopup":case"linkViaRedirect":return q9;case"reauthViaPopup":case"reauthViaRedirect":return z9;default:Ei(this.auth,"internal-error")}}resolve(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var W9=new ya(2e3,1e4);async function sT(n,e,t){if(tr(n.app))return Promise.reject(Ur(n,"operation-not-supported-in-this-environment"));let r=Vm(n);e9(n,e,xd);let i=gO(r,t);return new K9(r,"signInViaPopup",e,i).executeNotNull()}var K9=(()=>{class n extends Fm{constructor(t,r,i,o,s){super(t,r,o,s),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return De(t,this.auth,"internal-error"),t}async onExecution(){fo(this.filter.length===1,"Popup operations only handle one event");let t=oT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ur(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ur(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ur(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,W9.get())};t()}}n.currentPopupAction=null;return n})(),Q9="pendingRedirect",Im=new Map,GI=class extends Fm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Im.get(this.auth._key());if(!e){try{let r=await Y9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Im.set(this.auth._key(),e)}return this.bypassAuthState||Im.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function Y9(n,e){let t=X9(e),r=Z9(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function J9(n,e){Im.set(n._key(),e)}function Z9(n){return ho(n._redirectPersistence)}function X9(n){return wm(Q9,n.config.apiKey,n.name)}async function eG(n,e,t=!1){if(tr(n.app))return Promise.reject(ma(n));let r=Vm(n),i=gO(r,e),s=await new GI(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}var tG=600*1e3,zI=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nG(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!mO(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ur(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tG&&this.cachedEventUids.clear(),this.cachedEventUids.has(kk(e))}saveEventToCache(e){this.cachedEventUids.add(kk(e)),this.lastProcessedEventTime=Date.now()}};function kk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function mO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function nG(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mO(n);default:return!1}}async function rG(n,e={}){return Wc(n,"GET","/v1/projects",e)}var iG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oG=/^https?/;async function sG(n){if(n.config.emulator)return;let{authorizedDomains:e}=await rG(n);for(let t of e)try{if(aG(t))return}catch{}Ei(n,"unauthorized-domain")}function aG(n){let e=kI(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!oG.test(t))return!1;if(iG.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var cG=new ya(3e4,6e4);function Ok(){let n=_i().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lG(n){return new Promise((e,t)=>{function r(){Ok(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ok(),t(Ur(n,"network-request-failed"))},timeout:cG.get()})}if(_i().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(_i().gapi?.load)r();else{let i=rO("iframefcb");return _i()[i]=()=>{gapi.load?r():t(Ur(n,"network-request-failed"))},_9(`${E9()}?onload=${i}`).catch(o=>t(o))}}).catch(e=>{throw Tm=null,e})}var Tm=null;function uG(n){return Tm=Tm||lG(n),Tm}var dG=new ya(5e3,15e3),hG="__/auth/iframe",fG="emulator/auth/iframe",pG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mG(n){let e=n.config;De(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?YI(e,fG):`https://${n.config.authDomain}/${hG}`,r={apiKey:e.apiKey,appName:n.name,v:Wo},i=gG.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${mc(r).slice(1)}`}async function yG(n){let e=await uG(n),t=_i().gapi;return De(t,n,"internal-error"),e.open({where:document.body,url:mG(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pG,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});let s=Ur(n,"network-request-failed"),a=_i().setTimeout(()=>{o(s)},dG.get());function c(){_i().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{o(s)})}))}var vG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_G=500,EG=600,bG="_blank",wG="http://localhost",Lm=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function IG(n,e,t,r=_G,i=EG){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=le(F({},vG),{width:r.toString(),height:i.toString(),top:o,left:s}),u=tn().toLowerCase();t&&(a=Yk(u)?bG:t),Kk(u)&&(e=e||wG,c.scrollbars="yes");let d=Object.entries(c).reduce((g,[m,S])=>`${g}${m}=${S},`,"");if(p9(u)&&a!=="_self")return TG(e||"",a),new Lm(null);let f=window.open(e||"",a,d);De(f,n,"popup-blocked");try{f.focus()}catch{}return new Lm(f)}function TG(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var SG="__/auth/handler",CG="emulator/auth/handler",DG=encodeURIComponent("fac");async function Fk(n,e,t,r,i,o){De(n.config.authDomain,n,"auth-domain-config-required"),De(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Wo,eventId:i};if(e instanceof xd){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",VR(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,f]of Object.entries(o||{}))s[d]=f}if(e instanceof Nm){let d=e.getScopes().filter(f=>f!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=await n._getAppCheckToken(),u=c?`#${DG}=${encodeURIComponent(c)}`:"";return`${xG(n)}?${mc(a).slice(1)}${u}`}function xG({config:n}){return n.emulator?YI(n,CG):`https://${n.authDomain}/${SG}`}var PI="webStorageSupport",qI=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=iT,this._completeRedirectFn=eG,this._overrideRedirectResult=J9}async _openPopup(e,t,r,i){fo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await Fk(e,t,r,kI(),i);return IG(e,o,oT())}async _openRedirect(e,t,r,i){await this._originValidation(e);let o=await Fk(e,t,r,kI(),i);return k9(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(fo(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await yG(e),r=new zI(e);return t.register("authEvent",i=>(De(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(PI,{type:PI},i=>{let o=i?.[0]?.[PI];o!==void 0&&t(!!o),Ei(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=sG(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return tO()||Qk()||XI()}},yO=qI;var Lk="@firebase/auth",Vk="1.12.0";var WI=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function AG(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function MG(n){qo(new fr("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;De(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nO(n)},u=new BI(r,i,o,c);return b9(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),qo(new fr("auth-internal",e=>{let t=Vm(e.getProvider("auth").getImmediate());return(r=>new WI(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Or(Lk,Vk,AG(n)),Or(Lk,Vk,"esm2020")}var RG=300,NG=tb("authIdTokenMaxAge")||RG,Uk=null,PG=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>NG)return;let i=t?.token;Uk!==i&&(Uk=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Rd(n=Eg()){let e=Wu(n,"auth");if(e.isInitialized())return e.getImmediate();let t=iO(n,{popupRedirectResolver:yO,persistence:[pO,uO,iT]}),r=tb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let s=PG(o.toString());lO(t,s,()=>s(t.currentUser)),cO(t,a=>s(a))}}let i=XE("auth");return i&&oO(t,`http://${i}`),t}function kG(){return document.getElementsByTagName("head")?.[0]??document}v9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Ur("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",kG().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});MG("Browser");var Bm={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var bi=class n{constructor(e){this.platformId=e;let t=Ku(Bm);try{this.db=Ed(t)}catch(r){console.warn("Firestore init failed (likely SSR)",r)}if(nc(this.platformId))try{this.auth=Rd(t),nT(this.auth,r=>{this.user$.set(r)})}catch(r){console.warn("Auth init failed",r)}}db=null;auth=null;user$=W(null);async loginWithGoogle(){if(!(!this.auth||!nc(this.platformId)))try{let e=new tT;await sT(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await rT(this.auth)}async saveHighScore(e){if(this.db)try{await _m(Vr(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,r){if(!this.db)return[];try{let i=es(Vr(this.db,"highscores"),ts("difficulty","==",t),ts("mapSize","==",r),lo("victory","desc"),lo("turnsPlayed","asc"),pa(e));return(await ga(i)).docs.map(s=>s.data())}catch(i){return console.error("Error fetching scores: ",i),[]}}async getUserScores(e){if(!this.db)return[];try{let t=es(Vr(this.db,"highscores"),ts("userId","==",e),ts("victory","==",!0),lo("turnsPlayed","asc"));return(await ga(t)).docs.map(i=>i.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}static \u0275fac=function(t){return new(t||n)(ve(Bi))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var Kc=class n{platformId=j(Bi);nameSignal=W("Player");constructor(){if(nc(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),nc(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let r=(e??"").toString().trim().slice(0,24);return r.length>0?r:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var wi=class n{constructor(e,t,r,i,o,s,a,c,u){this.combat=e;this.build=t;this.log=r;this.settings=i;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=c;this.playerName=u;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}unitsSignal=W([]);turnSignal=W(1);selectedUnitIdSignal=W(null);gameStatusSignal=W("playing");lastMergedUnitIdSignal=W(null);lastRemainderUnitIdSignal=W(null);resourcesSignal=W({wood:0});forestsSignal=W([]);baseHealthSignal=W({player:100,ai:100});reservePointsSignal=W({player:0,ai:0});deployTargetsSignal=W([]);baseDeployActiveSignal=W(!1);wallsSignal=W([]);playerVisibilitySignal=W(new Set);aiVisibilitySignal=W(new Set);playerExploredSignal=W(new Set);aiExploredSignal=W(new Set);unitMoveHistorySignal=W(new Map);unitStutterBanSignal=W(new Map);lastAiMovedUnitIdSignal=W(null);aiConsecMovesSignal=W(0);buildModeSignal=W(!1);fogDebugDisabledSignal=W(!1);wallBuiltThisTurnSignal=W(!1);rulesOpenSignal=W(!1);movedThisTurnSignal=W(new Set);aiWoodSignal=W(0);logsOpenSignal=W(!1);settingsOpenSignal=W(!1);activeSideSignal=W("ai");lastArrivedUnitIdSignal=W(null);attackerNudgeSignal=W(null);shakenUnitIdSignal=W(null);shakenWallIdSignal=W(null);pulseUnitIdSignal=W(null);screenShakeSignal=W(!1);endOverlaySignal=W(!1);endReasonSignal=W(null);combatOnlySignal=W(!0);forestMonopolySignal=W({player:0,ai:0});hoveredUnitIdSignal=W(null);autoDeployEnabledSignal=W(!1);highScoresOpenSignal=W(!1);leaderboardOpenSignal=W(!1);namePromptOpenSignal=W(!1);pendingScoreSignal=W(null);supportOpenSignal=W(!1);highScoresSignal=W({});playerConvertedThisTurnSignal=W(!1);unitQuadrantBiasSignal=W(new Map);aiUnitTimeNearBaseSignal=W(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=W(!1);wallCooldownSignal=W(new Map);aiQueuedUnitIdSignal=W(null);aiMoodSignal=W("none");rageCaptureCounterSignal=W(0);anchoredGatherersSignal=W(new Set);totalWarModeSignal=W(!1);aiInvalidActionCountSignal=W(0);aiLastRejectedActionKeySignal=W(null);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=Mr(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=Mr(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(i=>i.owner==="player"&&this.isForest(i.position.x,i.position.y)).length,r=this.unitsSignal().filter(i=>i.owner==="ai"&&this.isForest(i.position.x,i.position.y)).length;return{total:e,player:t,ai:r}}resetGame(){let e=this.settings.difficulty();this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0}),this.baseHealthSignal.set({player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:60,ai:20}):e==="normal"?this.reservePointsSignal.set({player:40,ai:40}):e==="hard"?this.reservePointsSignal.set({player:40,ai:80}):this.reservePointsSignal.set({player:40,ai:100}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai")));let t=new Set(this.forestsSignal().map(r=>`${r.x},${r.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(r=>r.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(i=>i.x===e.x&&i.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let r=!1,i=!1,o=null;if(this.unitsSignal.update(a=>{let c=[...a],u=c.findIndex($=>$.id===e.id);if(u===-1)return a;let d=F({},c[u]),f={x:d.position.x,y:d.position.y},g=t.x-f.x,m=t.y-f.y,S=Math.sign(g),M=Math.sign(m),O=this.combat.checkWallAlongPath(f,t,d.owner,($,ae,be,re)=>this.getWallBetween($,ae,be,re));if(O.hitOwn)return c;if(O.hitEnemy){let $=O.lastFrom,ae=this.getWallBetween($.x,$.y,t.x,t.y),be=ae.owner==="neutral"?100:this.combat.getWallHitPercent(d.tier);return this.wallsSignal.update(re=>re.map(D=>D.id===ae.id?le(F({},D),{health:Math.max(0,D.health-be)}):D).filter(D=>(D.health??D.hitsRemaining??0)>0)),this.shakenWallIdSignal.set(ae.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200),this.appendLog(`[Turn ${this.turnSignal()}] ${d.owner==="player"?"Player":"AI"} auto-hit wall between (${$.x},${$.y})-(${t.x},${t.y}) for ${be}% damage.`),c}let P=this.getBasePosition(d.owner==="player"?"ai":"player");if(t.x===P.x&&t.y===P.y)return this.baseHealthSignal.update($=>{let ae=d.owner==="player"?"ai":"player",be=F({},$);return be[ae]=Math.max(0,be[ae]-this.calculatePower(d)),be}),c.splice(u,1),c;let q=c.findIndex($=>$.position.x===t.x&&$.position.y===t.y&&$.id!==d.id);if(q!==-1){let $=c[q],ae={x:t.x-S,y:t.y-M};if(this.inBounds(ae.x,ae.y)){if(S!==0&&M!==0){if(this.combat.isDiagonalBlocked(ae,t,(be,re,D,I)=>this.getWallBetween(be,re,D,I)))return r=!1,c}else if(this.getWallBetween(ae.x,ae.y,t.x,t.y))return r=!1,c}if($.owner===d.owner)if(this.shakenUnitIdSignal.set(d.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),$.tier===d.tier){let be=$.tier,re=this.calculateTotalPoints(d)+this.calculateTotalPoints($),D={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},I=D[be][3];if(re<=I){$.points=re;let C=this.calculateTierAndLevel($.points);$.tier=C.tier,$.level=C.level,c.splice(u,1)}else{let C=Math.min(4,be+1),x=D[C][0];$.points=x;let A=this.calculateTierAndLevel($.points);$.tier=A.tier,$.level=A.level;let R=re-x;if(R>0){d.points=R;let T=this.calculateTierAndLevel(d.points);d.tier=T.tier,d.level=T.level,c[u]=d,o=d.id}else c.splice(u,1)}i=!0}else return c;else{(d.owner==="player"||this.gridSize<=20)&&(this.attackerNudgeSignal.set({id:d.id,dx:S*8,dy:M*8}),setTimeout(()=>this.attackerNudgeSignal.set(null),150)),this.shakenUnitIdSignal.set($.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let be=this.calculateTotalPoints(d),re=this.getAttackLuckModifier(d),D=this.calculateTotalPoints($),I=this.combat.getDefenseBonus($,c),C=Math.max(0,be+re.delta),x=D+I.bonus,A=[...I.tags,re.tag??""].filter(Boolean).join(", ")||"None",R=C-x,T=`[Turn ${this.turnSignal()}] ${d.owner==="player"?"Player":"AI"} T${d.tier}(L${d.level}) attacked ${$.owner==="player"?"Player":"AI"} T${$.tier}(L${$.level}). Power: ${be} vs ${D}. Modifiers: ${A}. Final: (${be}${re.delta!==0?re.delta>0?`+${re.delta}`:`${re.delta}`:""}${I.bonus>0?` - ${I.bonus}`:""}) - ${D} = ${R}.`;if(this.log.addCombat(d.owner,T,!!re.isCrit),C<x&&this.queueCombatText("WEAK!",t),C>x){let Tt=C-x,{tier:Kt,level:ye}=this.calculateTierAndLevel(Tt);d.points=Tt,d.tier=Kt,d.level=ye,c.splice(q,1),re.tag&&this.queueCombatText(re.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(C<x){let Tt=x-C,{tier:Kt,level:ye}=this.calculateTierAndLevel(Tt),Bn=le(F({},$),{points:Tt,tier:Kt,level:ye});return c[q]=Bn,c.splice(u,1),c}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(d.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),c.filter(Kt=>Kt.id!==d.id&&Kt.id!==$.id);{let Kt=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),Kt){let ye=this.getPointsForTierLevel(d.tier,1);d.points=ye;let Bn=this.calculateTierAndLevel(ye);d.tier=Bn.tier,d.level=Bn.level,c.splice(q,1),this.pulseUnitIdSignal.set(d.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(d.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let ye=this.getPointsForTierLevel($.tier,1),Bn=le(F({},$),{points:ye}),Ii=this.calculateTierAndLevel(ye);return Bn.tier=Ii.tier,Bn.level=Ii.level,c[q]=Bn,c.splice(u,1),this.pulseUnitIdSignal.set(Bn.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(d.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),c}}}}}if(c.find($=>$.id===d.id)&&o!==d.id){d.position=t,d.turnsStationary=0,d.hasActed=!0;let $=c.findIndex(x=>x.id===d.id);$!==-1&&(c[$]=d),d.owner==="ai"&&d.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(d.id,{x:t.x,y:t.y}),d.tier<=2&&this.anchorGatherer(d.id));let ae=new Set(this.movedThisTurnSignal());ae.add(d.id),this.movedThisTurnSignal.set(ae),this.lastArrivedUnitIdSignal.set(d.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let be=new Map(this.unitMoveHistorySignal()),re=be.get(d.id)??[],D={x:f.x,y:f.y},I={x:t.x,y:t.y},C=[...re,D,I].slice(-4);be.set(d.id,C),this.unitMoveHistorySignal.set(be)}return c}),i){let a=this.getUnitAt(t.x,t.y);a&&(this.lastMergedUnitIdSignal.set(a.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(f=>f+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let u=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(u.length>=4&&u[0].x===u[2].x&&u[0].y===u[2].y&&u[1].x===u[3].x&&u[1].y===u[3].y&&(u[0].x!==u[1].x||u[0].y!==u[1].y)){let f=new Map(this.unitStutterBanSignal()),g=new Set([`${u[0].x},${u[0].y}`,`${u[1].x},${u[1].y}`]);f.set(e.id,{tiles:g,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(f);let m={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},M=(this.getQuadrant(e.position,m)+2)%4,O=new Map(this.unitQuadrantBiasSignal());O.set(e.id,{quadrant:M,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(O)}}let s=this.selectedUnitIdSignal();s&&!this.unitsSignal().some(a=>a.id===s)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility()}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=W([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let r=this.firebase.user$(),i=le(F({},t),{playerName:this.playerName.name(),userId:r?.uid,userPhoto:r?.photoURL??void 0});this.firebase.saveHighScore(i),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,r=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,i=t/e===1,o=r/e===1;return i?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let r=this.calculateTotalPoints(t),i=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,r-i),atkMax:r+i,hp:t.points,support:o}}shouldRenderWall(e,t,r){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return i?(r??i.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(r=>r.position.x===e&&r.position.y===t).map(r=>({id:r.id,text:r.text,opacity:r.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let r=this.unitsSignal().find(s=>s.id===e);if(!r)return"";let i=this.combat.getPointsForTierLevel(r.tier,4),o=t.support>0?`+${t.support}`:"+0";return`Unit T${r.tier} | HP: ${t.hp}/${i} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.recordHighScore("player wins","destroy")}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],r=e.indexOf(this.settings.difficulty()),i=t.indexOf(this.settings.mapSize());r++,r>=e.length&&(r=0,i++,i>=t.length&&(i=0)),this.settings.setDifficulty(e[r]),this.settings.setMapSize(t[i]),this.resetGame()}recordHighScore(e,t){let r=`${this.settings.difficulty()}|${this.settings.mapSize()}`,i=F({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=i[r]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((f,g)=>f.turns-g.turns).slice(0,3):s.losses=[...s.losses,o].sort((f,g)=>f.turns-g.turns).slice(0,3),i[r]=s,this.highScoresSignal.set(i),this.persistHighScores();let a=this.getForestControl(),c=e==="player wins"?a.player:a.ai,u=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:c,victoryType:u,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"?(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0)):this.firebase.saveHighScore(d)}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let r=crypto.randomUUID(),i={id:r,text:e,position:F({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),i]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===r?le(F({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==r))},2e3)}calculateValidMoves(e){let t=[],r=e.tier>=3?e.tier===4?3:2:1,i=e.tier>=2,o=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}];i&&o.push({x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1});for(let s of o)for(let a=1;a<=r;a++){let c={x:e.position.x+s.x*a,y:e.position.y+s.y*a};if(c.x>=0&&c.x<this.gridSize&&c.y>=0&&c.y<this.gridSize){let u={x:e.position.x+s.x*(a-1),y:e.position.y+s.y*(a-1)};if(s.x!==0&&s.y!==0){if(this.isDiagonalBlocked(u,c))break}else if(this.getWallBetween(u.x,u.y,c.x,c.y))break;let d=this.getUnitAt(c.x,c.y);if(!d)t.push(c);else{d.owner===e.owner?d.tier===e.tier&&t.push(c):t.push(c);break}}else break}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),c=this.isForest(s.position.x,s.position.y),u=c?a?1:(s.forestOccupationTurns??0)+1:0,d=c?u>=3:!1;return le(F({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:u,productionActive:d})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let r=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(s=>s.owner===e&&this.isForest(s.position.x,s.position.y)&&(s.productionActive??!1)).length;o>0&&(e==="player"?this.resourcesSignal.update(s=>({wood:s.wood+o*r(this.settings.difficulty())})):this.aiWoodSignal.update(s=>s+o*r(this.settings.difficulty())))}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let i=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(i),this.startSideTurn(i),i==="ai"&&this.gameStatus()==="playing"&&setTimeout(()=>this.aiTurn(),10)}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}startSideTurn(e){this.unitsSignal.update(t=>t.map(r=>r.owner===e?le(F({},r),{hasActed:!1}):r))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,r=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,i=t/e===1,o=r/e===1;if(i){let s=F({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=F({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai");{let P=0,q=50;for(;this.aiWoodSignal()>30;){if(P++,P>q){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let P=this.forestsSignal().length,q=this.unitsSignal().filter(R=>R.owner==="ai"&&this.isForest(R.position.x,R.position.y)).length,$=this.unitsSignal().filter(R=>R.owner==="player"&&this.isForest(R.position.x,R.position.y)).length,ae=this.settings.difficulty(),be=P>0?$/P:0,re="none";$<=q?re="none":be>=.9||$>=9?re="rage":$>=q+(ae==="baby"?4:ae==="normal"?3:ae==="hard"?2:1)?re="angry":re="none",this.aiMoodSignal.set(re);let D=this.turnSignal()%2===0,I=this.turnSignal()%5===0,C=P>0?q/P:0,x=this.totalWarModeSignal(),A=C>=.65;if(!x&&A)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(A),re==="rage"){let R=ae==="baby"?D?1:2:ae==="normal"?D?3:2:ae==="hard"?D?4:3:4;this.reservePointsSignal.update(T=>({player:T.player,ai:T.ai+R}))}else if(re==="angry"){if(ae==="baby")I&&this.reservePointsSignal.update(T=>({player:T.player,ai:T.ai+1}));else if(D){let R=ae==="normal"?D?1:0:ae==="hard"?I?2:1:2;this.reservePointsSignal.update(T=>({player:T.player,ai:T.ai+R}))}}}catch{}await new Promise(P=>setTimeout(P,100));let t=this.unitsSignal().filter(P=>P.owner==="ai"),r=new Map(this.aiUnitTimeNearBaseSignal()),i=new Set(t.map(P=>P.id));for(let P of r.keys())i.has(P)||r.delete(P);for(let P of t)Math.max(Math.abs(P.position.x-e.x),Math.abs(P.position.y-e.y))<=3?r.set(P.id,(r.get(P.id)||0)+1):r.set(P.id,0);this.aiUnitTimeNearBaseSignal.set(r);for(let P of t){let q=this.isForest(P.position.x,P.position.y);P.owner==="ai"&&q&&P.tier<=2&&this.anchorGatherer(P.id)}let o=this.unitsSignal().filter(P=>P.owner==="player"&&this.isForest(P.position.x,P.position.y)&&(P.productionActive??!1)).length*2,s=this.unitsSignal().filter(P=>P.owner==="ai"&&this.isForest(P.position.x,P.position.y)&&(P.productionActive??!1)).length*2,a=o>=s;this.aggressionModeSignal.set(a);let d=this.forestsSignal().filter(P=>!this.getUnitAt(P.x,P.y)).filter(P=>this.isVisibleToAi(P.x,P.y)),f=this.unitsSignal().filter(P=>P.owner==="ai");if(this.turnSignal()<=15){let P=this.aiQueuedUnitIdSignal(),q=P?f.find(ae=>ae.id===P):null;if(!(q&&!this.isForest(q.position.x,q.position.y)&&d.length>0)){let ae=f.filter(re=>re.tier<=2&&!this.isForest(re.position.x,re.position.y)),be=ae.length>0&&d.length>0?ae.reduce((re,D)=>{let I=Math.min(...d.map(x=>Math.abs(D.position.x-x.x)+Math.abs(D.position.y-x.y))),C=Math.min(...d.map(x=>Math.abs(re.position.x-x.x)+Math.abs(re.position.y-x.y)));return I<C?D:re},ae[0]):null;this.aiQueuedUnitIdSignal.set(be?be.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let P=this.getPointsForTierLevel(3,1),q=this.forestsSignal().length,$=this.unitsSignal().filter(re=>re.owner==="ai"&&this.isForest(re.position.x,re.position.y)).length,ae=q>0?$/q:0;this.reservePointsSignal().ai>=P&&ae<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let g=this.unitsSignal().filter(P=>P.owner==="player"&&Math.max(Math.abs(P.position.x-e.x),Math.abs(P.position.y-e.y))<=3&&P.tier>=2);if(g.length>0){let P=g.reduce((q,$)=>this.calculateTotalPoints($)>this.calculateTotalPoints(q)?$:q,g[0]);this.aiDefenseSpawn(P)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let P=this.aiStrategy.getWallBuildActions(this);for(let q of P){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(q.from,q.to)}}else this.tryDefensiveWallsNearForests();let m=0,S=10;for(;m<S&&this.executeOneFreeAction();)m++,await new Promise(q=>setTimeout(q,100));this.aiQueuedUnitIdSignal.set(null);let M=0,O=Math.max(20,this.gridSize*4);for(;;){let P=this.unitsSignal().filter($=>$.owner==="ai"&&!$.hasActed);if(P.length===0)break;let q=this.aiStrategy.chooseBestEndingAction(this);if(!q){let $=P.find(ae=>this.isForest(ae.position.x,ae.position.y));if($){this.unitsSignal.update(ae=>ae.map(be=>be.id===$.id?le(F({},be),{hasActed:!0}):be)),await new Promise(ae=>setTimeout(ae,30)),M++;continue}break}if(q.type==="wall_attack"&&q.edge){let $=this.getWallBetween(q.edge.from.x,q.edge.from.y,q.edge.to.x,q.edge.to.y);$&&this.isBaseProtectionEdge(q.edge.from,q.edge.to)&&($.owner==="neutral"||$.owner==="ai")||!$?this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Skipped wall attack near base due to protection rule.`):this.attackOrDestroyWallBetween(q.edge.from,q.edge.to,!1)}else this.executeMove(q.unit,q.target);if(await new Promise($=>setTimeout($,60)),M++,M>=O){try{console.warn("[AI] Safety break: max actions reached")}catch{}break}}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(i=>i.owner==="player"&&Math.max(Math.abs(i.position.x-e.x),Math.abs(i.position.y-e.y))<=3&&i.tier>=2);if(t.length>0){let i=t.reduce((s,a)=>this.calculateTotalPoints(a)>this.calculateTotalPoints(s)?a:s,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(i))return!0}let r=this.unitsSignal().filter(i=>i.owner==="ai").length;if(r<6){let i=this.reservePointsSignal().ai,o=this.getPointsForTierLevel(2,1);if(i>=o&&this.aiSpawnTier(2,1,new Set)>0)return!0}if(this.aiWoodSignal()>=30)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;if(t.length===0)try{let i=this.getPointsForTierLevel(3,1),o=this.forestsSignal().length,s=this.unitsSignal().filter(u=>u.owner==="ai"&&this.isForest(u.position.x,u.position.y)).length,a=o>0?s/o:0,c=this.reservePointsSignal().ai;if(r>=6&&c>=i&&a<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),r=[],i=e.position.x,o=e.position.y,s=Math.sign(t.x-i),a=Math.sign(t.y-o);{let g=0,m=Math.max(10,this.gridSize*2);for(;i!==t.x||o!==t.y;){if(g++,g>m){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(i+=s,o+=a,!this.inBounds(i,o)||i===t.x&&o===t.y)break;r.push({x:i,y:o})}}let c=r.reverse().find(g=>!this.getUnitAt(g.x,g.y))||(()=>{for(let g=-1;g<=1;g++)for(let m=-1;m<=1;m++){if(g===0&&m===0)continue;let S=t.x+g,M=t.y+m;if(this.inBounds(S,M)&&!this.getUnitAt(S,M))return{x:S,y:M}}return null})();if(!c)return!1;{let g=0,m=50;for(;this.aiWoodSignal()>=20;){if(g++,g>m){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let u=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(u);if(d<=0)return!1;let f=this.calculateTierAndLevel(d);return this.unitsSignal().filter(m=>m.owner==="ai"&&m.tier===f.tier&&!this.isForest(m.position.x,m.position.y)).length>=5?!1:(this.unitsSignal.update(g=>[...g,{id:crypto.randomUUID(),position:F({},c),level:f.level,tier:f.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}]),this.reservePointsSignal.update(g=>({player:g.player,ai:g.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,r){let i=this.getBasePosition("ai"),o=[],s=2;for(let m=-s;m<=s;m++)for(let S=-s;S<=s;S++){if(m===0&&S===0)continue;let M=i.x+m,O=i.y+S;if(!this.inBounds(M,O)||Math.max(Math.abs(m),Math.abs(S))>s)continue;let P=`${M},${O}`;r.has(P)||this.getUnitAt(M,O)||o.push({x:M,y:O})}let a=this.reservePointsSignal().ai,c=this.getPointsForTierLevel(e,1),u=0,d=[],f=m=>this.unitsSignal().filter(S=>S.owner==="ai"&&S.tier===m&&!this.isForest(S.position.x,S.position.y)).length;if(f(e)>=5)return 0;for(let m of o){if(u>=t||a<c||f(e)>=5)break;let S=this.calculateTierAndLevel(c);d.push({id:crypto.randomUUID(),position:F({},m),level:S.level,tier:S.tier,points:c,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),a-=c,u++}return d.length>0&&(this.unitsSignal.update(m=>[...m,...d]),this.reservePointsSignal.update(m=>({player:m.player,ai:a})),this.recomputeVisibility()),u}aiConvertWoodToReserve(){this.aiWoodSignal()<30||(this.aiWoodSignal.update(t=>t-20),this.reservePointsSignal.update(t=>({player:t.player,ai:t.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(r=>{if(r.some(s=>s.position.x===t.x&&s.position.y===t.y))return r;let o={id:crypto.randomUUID(),position:F({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0};return[...r,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),r=2,i=[];for(let c=-r;c<=r;c++)for(let u=-r;u<=r;u++){let d=t.x+c,f=t.y+u;this.inBounds(d,f)&&(c===0&&u===0||Math.max(Math.abs(c),Math.abs(u))>r||i.push({x:d,y:f}))}let o=[{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}],s=[],a=(c,u)=>this.unitsSignal().some(d=>d.position.x===c&&d.position.y===u)||s.some(d=>d.position.x===c&&d.position.y===u);for(let c of o){let u=i.filter(m=>!a(m.x,m.y));if(u.length===0)break;let d=Math.floor(Math.random()*u.length),f=u[d],g=this.getPointsForTierLevel(c.tier,c.level);s.push({id:crypto.randomUUID(),position:F({},f),level:c.level,tier:c.tier,points:g,owner:e,turnsStationary:0,hasActed:!0})}s.length>0&&this.unitsSignal.update(c=>[...c,...s])}getUnitAt(e,t){return this.unitsSignal().find(r=>r.position.x===e&&r.position.y===t)}getWallBetween(e,t,r,i){let o={x:e,y:t},s={x:r,y:i};if(!this.areAdjacent(o,s))return;let[a,c]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(u=>u.tile1.x===a.x&&u.tile1.y===a.y&&u.tile2.x===c.x&&u.tile2.y===c.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(r,i,o,s)=>this.getWallBetween(r,i,o,s))}isValidMove(e,t){return this.validMoves().some(r=>r.x===e&&r.y===t)}isForest(e,t){return this.forestsSignal().some(r=>r.x===e&&r.y===t)}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10||!this.canBuildWallBetween(e,t))return;let i=this.getBestAdjacentPlayerUnit(e,t);if(!i||i.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.resourcesSignal.update(a=>({wood:a.wood-10})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(c=>c.id===i.id?le(F({},c),{hasActed:!0}):c))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(r=>({wood:r.wood-t*20})),this.reservePointsSignal.update(r=>({player:r.player+t,ai:r.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let r=[];for(let i=-2;i<=2;i++)for(let o=-2;o<=2;o++){if(i===0&&o===0)continue;let s=t.x+i,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(i),Math.abs(o))>2)continue;this.getUnitAt(s,a)||r.push({x:s,y:a})}this.deployTargetsSignal.set(r),this.baseDeployActiveSignal.set(!0)}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,c=e.y+s;this.inBounds(a,c)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,c)||t.push({x:a,y:c}))}let r=this.reservePointsSignal().player,i=[];for(let o of t){if(r<=0)break;let s=this.economy.getHighestAffordableCost(r);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(c=>[...c,{id:crypto.randomUUID(),position:F({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}]),r-=s,i.push(o)}i.length>0&&(this.reservePointsSignal.update(o=>({player:r,ai:o.ai})),this.recomputeVisibility())}isDeployTarget(e,t){return this.deployTargetsSignal().some(r=>r.x===e&&r.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let r=this.economy.getHighestAffordableCost(t);if(r<=0)return;let i=this.calculateTierAndLevel(r);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:F({},e),level:i.level,tier:i.tier,points:r,owner:"player",turnsStationary:0,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-r,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${i.tier}(L${i.level}) at (${e.x},${e.y}) costing ${r} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[r,i]=this.sortEdgeEndpoints(e,t);return`${r.x},${r.y}|${i.x},${i.y}`}registerWallDestroyedEdge(e,t){let r=this.edgeKey(e,t),i=new Map(this.wallCooldownSignal());i.set(r,this.turnSignal()),this.wallCooldownSignal.set(i)}isEdgeOnCooldown(e,t){let r=this.edgeKey(e,t),i=this.wallCooldownSignal().get(r);return i===void 0?!1:5-(this.turnSignal()-i)>0}edgeCooldownRemaining(e,t){let r=this.edgeKey(e,t),i=this.wallCooldownSignal().get(r);if(i===void 0)return 0;let o=5-(this.turnSignal()-i);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,r=!1){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(i.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(i.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(i.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;let a=i.owner==="neutral"?100:this.combat.getWallHitPercent(s.tier),[c,u]=this.sortEdgeEndpoints(e,t),d=Math.max(0,i.health-a);this.wallsSignal.update(m=>m.map(S=>S.id===i.id?le(F({},S),{health:Math.max(0,S.health-a)}):S).filter(S=>S.health>0)),d<=0&&this.registerWallDestroyedEdge(c,u),this.shakenWallIdSignal.set(i.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let f=o==="player"?"Player":"AI",g=i.owner==="neutral"?"Neutral":i.owner==="player"?"Player":"AI";this.appendLog(`[Turn ${this.turnSignal()}] ${f} hit ${g} wall (${e.x},${e.y})-(${t.x},${t.y}) for ${a}% damage.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(m=>m.map(S=>S.id===s.id?le(F({},S),{hasActed:!0}):S))}destroyOwnWallBetween(e,t){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r||r.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==r.id));let[i,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(i,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`)}canDestroyOwnWall(e,t){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return!r||r.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!r||r.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return!r||!this.canActThisTurn()?!1:r.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(r=>r.owner==="player"&&(r.position.x===e.x&&r.position.y===e.y||r.position.x===t.x&&r.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed&&(r.position.x===e.x&&r.position.y===e.y||r.position.x===t.x&&r.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let r=this.getAdjacentPlayerUnits(e,t);return r.length===0?null:r.reduce((i,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(i)?o:i)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(r=>r.owner==="ai"&&!r.hasActed&&(r.position.x===e.x&&r.position.y===e.y||r.position.x===t.x&&r.position.y===t.y))}getBestAdjacentAiUnit(e,t){let r=this.getAdjacentAiUnits(e,t);return r.length===0?null:r.reduce((i,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(i)?o:i)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<10||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let r=this.getBestAdjacentAiUnit(e,t);if(!r||r.hasActed)return;let[i,o]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(s=>[...s,{id:crypto.randomUUID(),tile1:{x:i.x,y:i.y},tile2:{x:o.x,y:o.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(s=>s-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(s=>s.map(a=>a.id===r.id?le(F({},a),{hasActed:!0}):a))}isBaseProtectionEdge(e,t){let r=this.getBasePosition("ai"),i=o=>Math.max(Math.abs(o.x-r.x),Math.abs(o.y-r.y))<=1||o.x===r.x&&o.y===r.y;return i(e)||i(t)}wouldCageElite(e,t){let r=(s,a,c,u)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:c,y:u}),f=this.sortEdgeEndpoints(e,t);return d[0].x===f[0].x&&d[0].y===f[0].y&&d[1].x===f[1].x&&d[1].y===f[1].y},i=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||r(s.x,s.y,a.x,a.y));{let c=Math.sign(a.x-s.x),u=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+c,s.y),f=this.getWallBetween(s.x,s.y,s.x,s.y+u),g=this.getWallBetween(a.x-c,a.y,a.x,a.y),m=this.getWallBetween(a.x,a.y-u,a.x,a.y);return!!(d||f||g||m||r(s.x,s.y,s.x+c,s.y)||r(s.x,s.y,s.x,s.y+u)||r(a.x-c,a.y,a.x,a.y)||r(a.x,a.y-u,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(c=>{let u={x:s.position.x+c.x,y:s.position.y+c.y};return this.inBounds(u.x,u.y)?!i(s.position,u):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(i=>i.owner==="ai"),t=this.unitsSignal().filter(i=>i.owner==="player"),r=this.getBasePosition("ai");for(let i of e){if(!this.isForest(i.position.x,i.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-i.position.x),Math.abs(s.position.y-i.position.y))<=2);for(let s of o){let a=i.level??this.calculateTierAndLevel(i.points).level,c=s.level??this.calculateTierAndLevel(s.points).level,u=Math.max(Math.abs(s.position.x-i.position.x),Math.abs(s.position.y-i.position.y)),d=Math.sign(s.position.x-i.position.x),f=Math.sign(s.position.y-i.position.y);if(Math.abs(d)+Math.abs(f)===2)continue;let g=u===1?{x:i.position.x+d,y:i.position.y+f}:{x:i.position.x+Math.sign(s.position.x-i.position.x),y:i.position.y+Math.sign(s.position.y-i.position.y)};if(!this.inBounds(g.x,g.y))continue;let m=Math.sign(r.x-i.position.x),S=Math.sign(r.y-i.position.y);if((g.x-i.position.x)*m+(g.y-i.position.y)*S>0)continue;let O=i.position,P=g;if(!this.getWallBetween(O.x,O.y,P.x,P.y)&&(c>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(O,P),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${O.x},${O.y})-(${P.x},${P.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let r=e.x<=t.x,i=e.y<=t.y;return r&&i?0:!r&&i?1:r&&!i?2:3}placeNeutralWalls(){let e=(r,i)=>{if(!this.areAdjacent(r,i)||!this.inBounds(r.x,r.y)||!this.inBounds(i.x,i.y)||this.getWallBetween(r.x,r.y,i.x,i.y))return;let[o,s]=this.sortEdgeEndpoints(r,i);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}])},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let r of t){let i=[{x:r.x+1,y:r.y},{x:r.x-1,y:r.y},{x:r.x,y:r.y+1},{x:r.x,y:r.y-1}];for(let o of i)this.inBounds(o.x,o.y)&&e(r,o)}for(let r of this.forestsSignal()){let i={x:r.x+1,y:r.y},o={x:r.x,y:r.y+1},s={x:r.x-1,y:r.y},a={x:r.x,y:r.y-1};this.inBounds(i.x,i.y)&&e(r,i),this.inBounds(o.x,o.y)&&e(r,o),this.inBounds(s.x,s.y)&&e(r,s),this.inBounds(a.x,a.y)&&e(r,a)}}static \u0275fac=function(t){return new(t||n)(ve(gc),ve(ag),ve(cg),ve(wn),ve(lg),ve(ug),ve(dg),ve(bi),ve(Kc))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var $m=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(ge(wi),ge(wn))};static \u0275cmp=hn({type:n,selectors:[["app-game-rules"]],decls:219,vars:37,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-lg","font-semibold","mb-1"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","2"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"flex","flex-col","justify-between"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"]],template:function(t,r){t&1&&(Y(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),b(5),J(),Y(6,"h3",5),b(7),J()(),Y(8,"button",6),Ar("click",function(){return r.engine.closeRules()}),b(9," \u2716 "),J()(),Y(10,"div",7)(11,"div",8)(12,"div",9),b(13),J(),Y(14,"div",10)(15,"div",11)(16,"div",12),b(17,"\u{1F333}"),J(),Y(18,"div")(19,"div",13),b(20),J(),Y(21,"div",14),b(22),J()()(),Y(23,"div",11)(24,"div",12),b(25,"\u{1F3F0}"),J(),Y(26,"div")(27,"div",13),b(28),J(),Y(29,"div",14),b(30),J()()()()(),Y(31,"div",15)(32,"div",9),b(33),J(),Y(34,"div",16)(35,"div",17)(36,"div",18),b(37,"1"),J(),Y(38,"div",19),b(39,"1\u20134"),J()(),Y(40,"div",17)(41,"div",20),b(42,"5"),J(),Y(43,"div",19),b(44,"5\u201320"),J()(),Y(45,"div",17)(46,"div",20),b(47,"25"),J(),Y(48,"div",19),b(49,"25\u2013100"),J()(),Y(50,"div",17)(51,"div",21)(52,"span",22),b(53,"125"),J()(),Y(54,"div",19),b(55,"125\u2013500"),J()()()(),Y(56,"div",15)(57,"div",23),b(58),J(),Y(59,"div",24),b(60),J(),Y(61,"div",25)(62,"div",26)(63,"div",27),b(64,"2"),J(),Y(65,"div",28),b(66,"3"),J(),Y(67,"div",29),b(68,"1"),J()()()(),Y(69,"div",8)(70,"div",9),b(71),J(),Y(72,"div",30)(73,"div")(74,"div",31),b(75),J(),Y(76,"div",32)(77,"div",33),b(78,"1"),J(),Y(79,"div",34),b(80,"1"),J()(),Y(81,"div",35),b(82),J()(),Y(83,"div")(84,"div",31),b(85),J(),Y(86,"div",32)(87,"div",33),b(88,"4"),J(),Y(89,"div",36),b(90,"1"),J(),Y(91,"span",37),b(92,"CRIT!"),J()(),Y(93,"div",35),b(94),J()(),Y(95,"div")(96,"div",31),b(97),J(),Y(98,"div",32)(99,"div",33),b(100,"1"),J(),Y(101,"div",38),b(102,"4"),J(),Y(103,"span",39),b(104,"MISS!"),J()(),Y(105,"div",35),b(106),J()()()(),Y(107,"div",15)(108,"div",23),b(109),J(),Y(110,"div",40)(111,"div")(112,"div",41),b(113),J(),Y(114,"div",42),lr(115,"div",43)(116,"div",43)(117,"div",43)(118,"div",43)(119,"div",43)(120,"div",43)(121,"div",44)(122,"div",44)(123,"div",43)(124,"div",43)(125,"div",43)(126,"div",43)(127,"div",43)(128,"div",43)(129,"div",43)(130,"div",43)(131,"div",43)(132,"div",43)(133,"div",43)(134,"div",43)(135,"div",43)(136,"div",43)(137,"div",43)(138,"div",43)(139,"div",43),Y(140,"div",45),b(141,"2"),J(),lr(142,"div",46),Y(143,"div",47),b(144,"\u{1F3F0}"),J()()(),Y(145,"div")(146,"div",41),b(147),J(),Y(148,"div",48),lr(149,"div",43)(150,"div",43)(151,"div",43)(152,"div",43)(153,"div",43)(154,"div",43)(155,"div",44)(156,"div",44)(157,"div",44)(158,"div",43)(159,"div",43)(160,"div",43)(161,"div",43)(162,"div",43)(163,"div",43)(164,"div",43)(165,"div",43)(166,"div",43)(167,"div",43)(168,"div",43)(169,"div",43)(170,"div",43)(171,"div",43)(172,"div",43)(173,"div",43),Y(174,"div",49),b(175,"3"),J(),lr(176,"div",46),Y(177,"div",50),b(178,"\u{1F3F0}"),J()()()()(),Y(179,"div",51)(180,"div",15)(181,"div",9),b(182),J(),Y(183,"div",16)(184,"div",52)(185,"div",53),b(186,"\u{1F331}"),J(),Y(187,"div",54),b(188),J()(),Y(189,"div",55),b(190,"\u2192"),J(),Y(191,"div",52)(192,"div",53),b(193,"\u{1F33F}"),J(),Y(194,"div",54),b(195),J()(),Y(196,"div",55),b(197,"\u2192"),J(),Y(198,"div",52)(199,"div",53),b(200,"\u{1F333}"),J(),Y(201,"div",56),b(202),J()()()(),Y(203,"div",15)(204,"div",57),b(205),J(),Y(206,"div",58)(207,"div",3),lr(208,"div",59),Y(209,"div",19),b(210),J()(),Y(211,"div",3),lr(212,"div",60),Y(213,"div",19),b(214),J()(),Y(215,"div",3),lr(216,"div",61),Y(217,"div",19),b(218,"Neutral"),J()()()()()()()()),t&2&&(w(5),z(r.settings.t("GAME_GUIDE")),w(2),z(r.settings.t("TURN_BASED_STRATEGY")),w(6),z(r.settings.t("VICTORY_CONDITIONS")),w(7),z(r.settings.t("MONOPOLY_LABEL")),w(2),z(r.settings.t("MONOPOLY_DESC")),w(6),z(r.settings.t("ANNIHILATION")),w(2),z(r.settings.t("ANNIHILATION_DESC")),w(3),z(r.settings.t("UNIT_EVOLUTION")),w(8),at("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),w(17),z(r.settings.t("EVOLUTION")),w(2),z(r.settings.t("EVOLUTION_DESC")),w(11),z(r.settings.t("COMBAT_DEEP_DIVE")),w(4),z(r.settings.t("SUCCESSFUL_ATTACK")),w(7),z(r.settings.t("SUCCESSFUL_ATTACK_DESC")),w(3),z(r.settings.t("CRITICAL_HIT")),w(9),z(r.settings.t("CRITICAL_HIT_DESC")),w(3),z(r.settings.t("MISS")),w(9),z(r.settings.t("MISS_DESC")),w(3),z(r.settings.t("MOVEMENT")),w(4),z(r.settings.t("T1_1_TILE")),w(30),at("left",6,"px")("top",6,"px"),w(4),z(r.settings.t("T3_3_TILES")),w(30),at("right",6,"px")("bottom",6,"px"),w(5),z(r.settings.t("FOREST_CYCLE")),w(6),z(r.settings.t("TURN_1")),w(7),z(r.settings.t("TURN_2")),w(7),z(r.settings.t("PLUS_8_WOOD_PER_TURN")),w(3),z(r.settings.t("WALL_LEGEND")),w(5),z(r.settings.t("PLAYER")),w(4),z(r.settings.t("AI_FACTION")))},dependencies:[Vn],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:100px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:16px;font-size:12px;font-weight:800;color:#fde047;animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:16px;font-size:12px;font-weight:800;color:#93c5fd;animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}
`],encapsulation:2})};var Gm=class n{constructor(e){this.gameEngine=e}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(ge(wi))};static \u0275cmp=hn({type:n,selectors:[["app-support-community"]],decls:51,vars:0,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,r){t&1&&(Y(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),b(4,"Support & Community"),J(),Y(5,"button",4),Ar("click",function(){return r.gameEngine.closeSupport()}),b(6," \u2716 "),J()(),Y(7,"div",5)(8,"div",6)(9,"div",7),b(10,"Donate"),J(),Y(11,"div",8),b(12,"Monobank Jar"),J(),Y(13,"div",9)(14,"div",10),lr(15,"img",11),J(),Y(16,"div",12)(17,"div",13),b(18,"send.monobank.ua/jar/2fqGoPhV7G"),J(),Y(19,"div",14)(20,"button",15),Ar("click",function(){return r.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),b(21," Open Link \u{1F4DC} "),J(),Y(22,"button",16),Ar("click",function(){return r.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),b(23," Copy Link \u{1F4CB} "),J()()()(),Y(24,"div",17)(25,"div",8),b(26,"Donatello"),J(),Y(27,"button",18),Ar("click",function(){return r.openExternalLink("https://donatello.to/jaerbi")}),b(28," Go to Donatello.to \u{1F48E} "),J()(),Y(29,"div",19),b(30,"Thank you for supporting the project!"),J()(),Y(31,"div",6)(32,"div",7),b(33,"Social & Feedback"),J(),Y(34,"div",20)(35,"button",21),Ar("click",function(){return r.openExternalLink("https://discord.gg/c9tCWFtFaG")}),Y(36,"span",22),b(37,"\u{1F5E8}\uFE0F"),J(),Y(38,"div",23)(39,"div",24),b(40,"Discord Server"),J(),Y(41,"div",25),b(42,"Share ideas & feedback"),J()()(),Y(43,"button",26),Ar("click",function(){return r.openExternalLink("https://www.youtube.com/@jaerb1")}),Y(44,"span",22),b(45,"\u25B6\uFE0F"),J(),Y(46,"div",23)(47,"div",24),b(48,"YouTube"),J(),Y(49,"div",25),b(50,"Dev logs & gameplay"),J()()()()()()()())},dependencies:[Vn],encapsulation:2})};function OG(n,e){if(n&1){let t=_t();v(0,"button",7),se("click",function(){fe(t);let i=V();return pe(i.switchToMyStats())}),b(1," My Statistics "),E()}if(n&2){let t=V();Le("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function FG(n,e){n&1&&(v(0,"div",15)(1,"span",16),Q(2,"span",17),v(3,"span"),b(4,"Loading..."),E()()())}function LG(n,e){if(n&1&&Q(0,"img",27),n&2){let t=V().$implicit;$e("src",t.userPhoto,ii)}}function VG(n,e){n&1&&(v(0,"div",28),b(1,"\u{1F464}"),E())}function UG(n,e){if(n&1&&(v(0,"tr",22)(1,"td",23),b(2),E(),v(3,"td",24),si(4,LG,1,1,"img",25)(5,VG,2,0,"ng-template",null,0,H_),b(7),E(),v(8,"td",23),b(9),E(),v(10,"td",26),b(11),E()()),n&2){let t=e.$implicit,r=e.index,i=uu(6),o=V(3);Le("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),w(2),z(r+1),w(2),$e("ngIf",t.userPhoto)("ngIfElse",i),w(3),de(" ",t.playerName," "),w(2),z(t.victoryType),w(2),z(t.turnsPlayed)}}function BG(n,e){if(n&1&&(v(0,"tr")(1,"td",29),b(2),Q(3,"br"),v(4,"span",30),b(5,"Be the first to claim victory!"),E()()()),n&2){let t=V(3);w(2),_n(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function jG(n,e){if(n&1&&(v(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),b(5,"Rank"),E(),v(6,"th",20),b(7,"Name"),E(),v(8,"th",20),b(9,"Victory Type"),E(),v(10,"th",20),b(11,"Turns"),E()()(),v(12,"tbody"),si(13,UG,12,12,"tr",21)(14,BG,6,2,"tr",9),E()()()),n&2){let t=V(2);w(13),$e("ngForOf",t.scores()),w(),$e("ngIf",t.scores().length===0)}}function HG(n,e){if(n&1&&(v(0,"div")(1,"div",11)(2,"span"),b(3,"Top 10 scores for:"),E(),v(4,"span",12),b(5),E(),v(6,"span",13),b(7),E()(),si(8,FG,5,0,"div",14)(9,jG,15,2,"div",9),E()),n&2){let t=V();w(5),de(" ",t.settings.difficultyLabel()," "),w(2),de(" ",t.settings.mapSizeLabel()," "),w(),$e("ngIf",t.loading()),w(),$e("ngIf",!t.loading())}}function $G(n,e){n&1&&(v(0,"div",15)(1,"span",16),Q(2,"span",17),v(3,"span"),b(4,"Loading your stats..."),E()()())}function GG(n,e){n&1&&(v(0,"div",35),b(1," No victories recorded yet. keep playing! "),E())}function zG(n,e){if(n&1&&(v(0,"div",36)(1,"div",37)(2,"span",38),b(3),E(),v(4,"span",39),b(5),E()(),v(6,"div",40)(7,"span",41),b(8,"Best Performance"),E(),v(9,"span",42),b(10),E()(),v(11,"div",43),b(12),Hs(13,"date"),E()()),n&2){let t=e.$implicit;w(3),de(" ",t.difficulty," "),w(2),de(" ",t.mapSize," "),w(5),de("",t.turnsPlayed," Turns"),w(2),_n(" ",t.victoryType," \u2022 ",Xa(13,5,t.timestamp,"mediumDate")," ")}}function qG(n,e){if(n&1&&(v(0,"div",32),si(1,GG,2,0,"div",33)(2,zG,14,8,"div",34),E()),n&2){let t=V(2);w(),$e("ngIf",t.myBestScores().length===0),w(),$e("ngForOf",t.myBestScores())}}function WG(n,e){if(n&1&&(v(0,"div",22),si(1,$G,5,0,"div",14)(2,qG,3,2,"div",31),E()),n&2){let t=V();w(),$e("ngIf",t.loading()),w(),$e("ngIf",!t.loading())}}var zm=class n{constructor(e,t,r,i){this.firebase=e;this.gameEngine=t;this.playerName=r;this.settings=i;this.fetch()}loading=W(!0);scores=W([]);activeTab=W("top10");myBestScores=W([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),r=await this.firebase.getTopScores(10,e,t);this.scores.set(r??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),r=new Map;t.forEach(i=>{let o=`${i.difficulty}-${i.mapSize}`;(!r.has(o)||i.turnsPlayed<r.get(o).turnsPlayed)&&r.set(o,i)}),this.myBestScores.set(Array.from(r.values()).sort((i,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[i.difficulty];return a!==0?a:i.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(ge(bi),ge(wi),ge(Kc),ge(wn))};static \u0275cmp=hn({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,r){t&1&&(v(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),b(4,"Leaderboard"),E(),v(5,"button",5),se("click",function(){return r.gameEngine.closeLeaderboard()}),b(6," \u2716 "),E()(),v(7,"div",6)(8,"button",7),se("click",function(){return r.activeTab.set("top10")}),b(9," Top 10 "),E(),si(10,OG,2,6,"button",8),E(),si(11,HG,10,4,"div",9)(12,WG,3,2,"div",10),E()()),t&2&&(w(8),Le("text-white",r.activeTab()==="top10")("border-b-2",r.activeTab()==="top10")("border-indigo-500",r.activeTab()==="top10"),w(2),$e("ngIf",r.firebase.user$()),w(),$e("ngIf",r.activeTab()==="top10"),w(),$e("ngIf",r.activeTab()==="mystats"))},dependencies:[Vn,Cp,lE,bu],encapsulation:2})};var KG=["boardContainer"],lt=(n,e)=>({x:n,y:e}),QG=()=>[10,20,30],YG=(n,e)=>e.id,_O=(n,e)=>e.date;function JG(n,e){if(n&1){let t=_t();v(0,"div",61)(1,"div",206)(2,"span",207),b(3),E(),v(4,"button",208),se("click",function(){fe(t);let i=V();return pe(i.firebase.logout())}),b(5),E()(),v(6,"div",209),Q(7,"img",210)(8,"div",211),E()()}if(n&2){let t=V();w(3),de(" ",t.settings.t("VERIFIED")," "),w(2),de(" ",t.settings.t("LOGOUT")," "),w(2),$e("src",e.photoURL,ii)}}function ZG(n,e){if(n&1){let t=_t();v(0,"button",212),se("click",function(){fe(t);let i=V();return pe(i.firebase.loginWithGoogle())}),Q(1,"div",213),v(2,"span",214),b(3),E()()}if(n&2){let t=V();w(3),de(" ",t.settings.t("CONNECT")," ")}}function XG(n,e){if(n&1){let t=_t();v(0,"div",95)(1,"div",215)(2,"button",216),se("click",function(){fe(t);let i=V();return pe(i.closeMobileMenu())}),Fe(),v(3,"svg",79),Q(4,"path",217),E()(),qe(),v(5,"button",218),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.toggleRules())}),b(6),E(),v(7,"button",218),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.toggleLeaderboard())}),b(8),E(),v(9,"button",218),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.toggleLog())}),b(10),E(),v(11,"button",218),se("click",function(){fe(t);let i=V();return pe(i.navigateToFeedback())}),b(12),E(),v(13,"button",218),se("click",function(){fe(t);let i=V();return pe(i.navigateToRoadmap())}),b(14),E(),v(15,"button",218),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.resetGame())}),b(16),E(),v(17,"button",218),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.toggleSettings())}),b(18),E()()()}if(n&2){let t=V();w(6),z(t.settings.t("INFO")),w(2),z(t.settings.t("RANKING")),w(2),z(t.settings.t("SYSTEM_LOG")),w(2),z(t.settings.t("FEEDBACK_MODULE")),w(2),z(t.settings.t("STRATEGIC_PLAN")),w(2),z(t.settings.t("RELOAD")),w(2),z(t.settings.t("SETTINGS"))}}function ez(n,e){if(n&1&&(v(0,"div",135),b(1),E()),n&2){let t=V();w(),Za(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function tz(n,e){if(n&1&&(v(0,"div",221),b(1),E()),n&2){let t=V(2);w(),z(t.gameEngine.endReason())}}function nz(n,e){if(n&1){let t=_t();v(0,"div",222)(1,"div",225),b(2),E(),Q(3,"input",226,1),v(5,"button",227),se("click",function(){fe(t);let i=uu(4),o=V(2);return pe(o.gameEngine.confirmAndSaveScore(i.value))}),b(6),E()()}if(n&2){let t=V(2);w(2),z(t.settings.t("CONFIRM_NAME")),w(),$e("value",t.gameEngine.getPlayerName()),w(3),de(" ",t.settings.t("SAVE_SCORE")," ")}}function rz(n,e){if(n&1){let t=_t();v(0,"div",143)(1,"div",219)(2,"h2",220),b(3),Hs(4,"titlecase"),E(),_e(5,tz,2,1,"div",221),_e(6,nz,7,3,"div",222),v(7,"button",223),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.resetGame())}),b(8),E()(),v(9,"button",224),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.toggleLeaderboard())}),b(10),E()()}if(n&2){let t=V();w(2),Le("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),w(),de(" ",j_(4,9,t.gameEngine.gameStatus()),"! "),w(2),Ee(t.gameEngine.endReason()?5:-1),w(),Ee(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),w(2),de(" ",t.settings.t("PLAY_AGAIN")," "),w(2),de(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function iz(n,e){n&1&&Q(0,"app-support-community")}function oz(n,e){n&1&&Q(0,"app-leaderboard-modal")}function sz(n,e){if(n&1&&(v(0,"div",158)(1,"span",228),b(2),E()()),n&2){let t=V();w(2),de(" ",t.gameEngine.baseHealth().ai," ")}}function az(n,e){n&1&&(v(0,"span",237),b(1," \u{1F92C} "),E()),n&2&&at("z-index",100)}function cz(n,e){n&1&&(v(0,"span",237),b(1," \u{1F620} "),E()),n&2&&at("z-index",100)}function lz(n,e){if(n&1&&_e(0,az,2,2,"span",236)(1,cz,2,2,"span",236),n&2){let t=V(3);Ee(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function uz(n,e){n&1&&Q(0,"div",232)}function dz(n,e){n&1&&(Fe(),v(0,"g",243),Q(1,"polygon",246)(2,"polygon",247),E())}function hz(n,e){n&1&&(Fe(),v(0,"g",248),Q(1,"rect",249),E(),v(2,"g",250),Q(3,"rect",251)(4,"path",252),E())}function fz(n,e){if(n&1&&(v(0,"span",238),Fe(),v(1,"svg",239)(2,"defs")(3,"linearGradient",240),Q(4,"stop",241)(5,"stop",242),E()(),_e(6,dz,3,0,":svg:g",243),v(7,"g"),Q(8,"polygon",244)(9,"rect",245),E(),_e(10,hz,5,0),E()()),n&2){V();let t=U_(5);Le("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),w(6),Ee(t?-1:6),w(),Le("scale-90",t),w(3),Ee(t?-1:10)}}function pz(n,e){n&1&&Q(0,"div",253),n&2&&at("height",2,"px")}function gz(n,e){if(n&1&&(v(0,"span",254),b(1),E(),v(2,"span",255),b(3),E()),n&2){let t=V(3);w(),de(" ",t.gameEngine.baseHealth().player," "),w(2),de(" ",t.gameEngine.reservePoints().player," ")}}function mz(n,e){if(n&1&&(v(0,"span",256),b(1),E(),v(2,"span",257),b(3),E()),n&2){let t=V(4);w(),de(" ",t.gameEngine.baseHealth().ai," "),w(2),de(" ",t.gameEngine.reservePoints().ai," ")}}function yz(n,e){if(n&1&&_e(0,mz,4,2),n&2){let t=V().$implicit,r=V().$implicit,i=V();Ee(i.gameEngine.isVisibleToPlayer(t,r)?0:-1)}}function vz(n,e){n&1&&(Fe(),v(0,"svg",263),Q(1,"path",264),E())}function _z(n,e){n&1&&(Fe(),v(0,"svg",263),Q(1,"path",265),E())}function Ez(n,e){if(n&1){let t=_t();v(0,"button",262),se("click",function(i){fe(t);let o=V(2),s=V(2).$implicit,a=V().$implicit,c=V();return pe(o.owner==="player"?c.onDestroyIconClick(i,s,a,s+1,a):c.onAttackIconClick(i,s,a,s+1,a))}),_e(1,vz,2,0,":svg:svg",263)(2,_z,2,0,":svg:svg",263),E()}if(n&2){let t=V(2),r=V(4);at("width",r.gameEngine.iconSizePx,"px")("height",r.gameEngine.iconSizePx,"px")("z-index",45),Le("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),w(),Ee(t.owner==="player"?1:2)}}function bz(n,e){if(n&1&&(v(0,"div",260),_e(1,Ez,3,13,"button",261),E()),n&2){let t=V(),r=V(2).$implicit,i=V().$implicit,o=V();at("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health,"%")("z-index",40)("transition","height 0.25s ease-out"),Le("bg-lime-400",t.owner==="player")("bg-red-400",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id)),w(),Ee(o.gameEngine.canShowAttackIcon(rt(19,lt,r,i),rt(22,lt,r+1,i))?1:-1)}}function wz(n,e){if(n&1&&_e(0,bz,2,25,"div",259),n&2){let t=V(2).$implicit,r=V().$implicit,i=V();Ee(i.gameEngine.shouldRenderWall(rt(1,lt,t,r),rt(4,lt,t+1,r),e.owner)?0:-1)}}function Iz(n,e){if(n&1){let t=_t();v(0,"button",268),se("click",function(i){fe(t);let o=V(3).$implicit,s=V().$implicit,a=V();return pe(a.onBuildIconClick(i,o,s,o+1,s))}),b(1," \u2714 "),E()}if(n&2){let t=V(5);at("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function Tz(n,e){if(n&1&&(v(0,"span",267),b(1),E()),n&2){let t=V(3).$implicit,r=V().$implicit,i=V();w(),_n(" ",i.settings.t("CD"),": ",i.gameEngine.edgeCooldownRemaining(rt(2,lt,t,r),rt(5,lt,t+1,r))," ")}}function Sz(n,e){if(n&1&&(v(0,"div",260),_e(1,Iz,2,8,"button",266),_e(2,Tz,2,8,"span",267),E()),n&2){let t=V(2).$implicit,r=V().$implicit,i=V();at("right",-i.gameEngine.wallThicknessPx-2,"px")("width",i.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Le("bg-lime-700",i.gameEngine.buildMode()&&i.gameEngine.canBuildWallBetween(rt(16,lt,t,r),rt(19,lt,t+1,r)))("bg-transparent",!i.gameEngine.buildMode()||!i.gameEngine.canBuildWallBetween(rt(22,lt,t,r),rt(25,lt,t+1,r))),w(),Ee(i.gameEngine.canShowBuildIcon(rt(28,lt,t,r),rt(31,lt,t+1,r))?1:-1),w(),Ee((i.gameEngine.isVisibleToPlayer(t,r)||i.gameEngine.isVisibleToPlayer(t+1,r))&&i.gameEngine.edgeCooldownRemaining(rt(34,lt,t,r),rt(37,lt,t+1,r))>0?2:-1)}}function Cz(n,e){if(n&1&&_e(0,wz,1,7)(1,Sz,3,40,"div",258),n&2){let t,r=V().$implicit,i=V().$implicit,o=V();Ee((t=o.gameEngine.getWallBetween(r,i,r+1,i))?0:1,t)}}function Dz(n,e){n&1&&(Fe(),v(0,"svg",263),Q(1,"path",264),E())}function xz(n,e){n&1&&(Fe(),v(0,"svg",263),Q(1,"path",265),E())}function Az(n,e){if(n&1){let t=_t();v(0,"button",262),se("click",function(i){fe(t);let o=V(2),s=V(2).$implicit,a=V().$implicit,c=V();return pe(o.owner==="player"?c.onDestroyIconClick(i,s,a,s,a+1):c.onAttackIconClick(i,s,a,s,a+1))}),_e(1,Dz,2,0,":svg:svg",263)(2,xz,2,0,":svg:svg",263),E()}if(n&2){let t=V(2),r=V(4);at("width",r.gameEngine.iconSizePx,"px")("height",r.gameEngine.iconSizePx,"px")("z-index",45),Le("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),w(),Ee(t.owner==="player"?1:2)}}function Mz(n,e){if(n&1&&(v(0,"div",271),_e(1,Az,3,13,"button",261),E()),n&2){let t=V(),r=V(2).$implicit,i=V().$implicit,o=V();at("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health,"%")("z-index",40)("transition","width 0.25s ease-out"),Le("bg-lime-400",t.owner==="player")("bg-red-400",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id)),w(),Ee(o.gameEngine.canShowAttackIcon(rt(19,lt,r,i),rt(22,lt,r,i+1))?1:-1)}}function Rz(n,e){if(n&1&&_e(0,Mz,2,25,"div",270),n&2){let t=V(2).$implicit,r=V().$implicit,i=V();Ee(i.gameEngine.shouldRenderWall(rt(1,lt,t,r),rt(4,lt,t,r+1),e.owner)?0:-1)}}function Nz(n,e){if(n&1){let t=_t();v(0,"button",274),se("click",function(i){fe(t);let o=V(3).$implicit,s=V().$implicit,a=V();return pe(a.onBuildIconClick(i,o,s,o,s+1))}),b(1," \u2714 "),E()}if(n&2){let t=V(5);at("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function Pz(n,e){if(n&1&&(v(0,"span",273),b(1),E()),n&2){let t=V(3).$implicit,r=V().$implicit,i=V();w(),_n(" ",i.settings.t("CD"),": ",i.gameEngine.edgeCooldownRemaining(rt(2,lt,t,r),rt(5,lt,t,r+1))," ")}}function kz(n,e){if(n&1&&(v(0,"div",271),_e(1,Nz,2,8,"button",272),_e(2,Pz,2,8,"span",273),E()),n&2){let t=V(2).$implicit,r=V().$implicit,i=V();at("bottom",-i.gameEngine.wallThicknessPx-2,"px")("height",i.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Le("bg-lime-700",i.gameEngine.buildMode()&&i.gameEngine.canBuildWallBetween(rt(16,lt,t,r),rt(19,lt,t,r+1)))("bg-transparent",!i.gameEngine.buildMode()||!i.gameEngine.canBuildWallBetween(rt(22,lt,t,r),rt(25,lt,t,r+1))),w(),Ee(i.gameEngine.canShowBuildIcon(rt(28,lt,t,r),rt(31,lt,t,r+1))?1:-1),w(),Ee((i.gameEngine.isVisibleToPlayer(t,r)||i.gameEngine.isVisibleToPlayer(t,r+1))&&i.gameEngine.edgeCooldownRemaining(rt(34,lt,t,r),rt(37,lt,t,r+1))>0?2:-1)}}function Oz(n,e){if(n&1&&_e(0,Rz,1,7)(1,kz,3,40,"div",269),n&2){let t,r=V().$implicit,i=V().$implicit,o=V();Ee((t=o.gameEngine.getWallBetween(r,i,r,i+1))?0:1,t)}}function Fz(n,e){n&1&&(Fe(),v(0,"svg",278),Q(1,"use",282),E())}function Lz(n,e){if(n&1&&(v(0,"span",283),b(1," \u{1F6E1} "),E()),n&2){let t=V(6);at("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("font-size",t.gameEngine.iconSizePx-2>8?t.gameEngine.iconSizePx-2:8,"px")("z-index",100)}}function Vz(n,e){n&1&&(v(0,"span",284),b(1," \u{1F333} "),E()),n&2&&at("z-index",100)}function Uz(n,e){n&1&&(v(0,"span",285),b(1," \u{1F331} "),E()),n&2&&at("z-index",100)}function Bz(n,e){n&1&&(v(0,"span",285),b(1," \u{1F33F} "),E()),n&2&&at("z-index",100)}function jz(n,e){if(n&1&&(v(0,"div",276)(1,"div",277),_e(2,Fz,2,0,":svg:svg",278),v(3,"span"),b(4),E()(),_e(5,Lz,2,8,"span",279),_e(6,Vz,2,2,"span",280)(7,Uz,2,2,"span",281)(8,Bz,2,2,"span",281),E()),n&2){let t=V(2),r=V(3);at("transition","transform 150ms ease-out")("transform",r.gameEngine.getNudgeFor(t.id)?"translate("+r.gameEngine.getNudgeFor(t.id).dx+"px,"+r.gameEngine.getNudgeFor(t.id).dy+"px)":"translate(0,0)"),Le("unit-container-player-unit-tier-2",t.owner==="player"&&t.tier===2)("unit-container-ai-unit-tier-2",t.owner==="ai"&&t.tier===2)("shake",r.gameEngine.isUnitShaking(t.id)),w(),at("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px")("aspect-ratio","1 / 1"),Le("unit-player",t.owner==="player")("unit-ai",t.owner==="ai")("text-white",!0)("unit-tier-1",t.tier===1)("unit-tier-2",t.tier===2)("unit-tier-3",t.tier===3)("unit-tier-4",t.tier===4)("scale-85",t.tier===4)("ring-4",r.gameEngine.selectedUnitId()===t.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===t.id)("ring-offset-2",r.gameEngine.selectedUnitId()===t.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===t.id)("opacity-50",t.hasActed)("grayscale",t.hasActed)("scale-110",r.gameEngine.selectedUnitId()===t.id&&t.tier!==4&&!r.gameEngine.buildMode())("scale-90",r.gameEngine.selectedUnitId()===t.id&&t.tier===4&&!r.gameEngine.buildMode())("scale-125",r.gameEngine.lastMergedUnitId()===t.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===t.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===t.id)("pulse-glow",r.gameEngine.pulseUnitId()===t.id),Lo("title",r.gameEngine.formatHoverInfo(t.id)),w(),Ee(t.tier===2?2:-1),w(),Le("-rotate-45",t.tier===4),w(),z(t.level),w(),Ee(r.gameEngine.hasDefenseBonus(t)?5:-1),w(),Ee(t.productionActive?6:(t.forestOccupationTurns??0)===1?7:(t.forestOccupationTurns??0)>1?8:-1)}}function Hz(n,e){if(n&1&&_e(0,jz,9,65,"div",275),n&2){let t=V(2).$implicit,r=V().$implicit,i=V();Ee(!(t===0&&r===0)&&!(t===i.gameEngine.gridSize-1&&r===i.gameEngine.gridSize-1)?0:-1)}}function $z(n,e){if(n&1&&_e(0,Hz,1,1),n&2){let t=V().$implicit,r=V().$implicit,i=V();Ee(e.owner==="player"||i.gameEngine.isVisibleToPlayer(t,r)?0:-1)}}function Gz(n,e){if(n&1&&(v(0,"div",286)(1,"span",287),b(2),E()()),n&2){let t=e.$implicit,r=V(3);at("z-index",100)("opacity",t.opacity),w(),Le("text-xs",!r.gameEngine.isLuckyText(t.text)&&!r.gameEngine.isDrawText(t.text))("text-base",r.gameEngine.isLuckyText(t.text)||r.gameEngine.isDrawText(t.text))("text-yellow-300",!r.gameEngine.isLuckyText(t.text)&&!r.gameEngine.isDrawText(t.text))("text-yellow-400",r.gameEngine.isLuckyText(t.text)||r.gameEngine.isDrawText(t.text)),w(),de(" ",t.text," ")}}function zz(n,e){if(n&1){let t=_t();v(0,"div",230),se("click",function(){let i=fe(t).$implicit,o=V().$implicit,s=V();return pe(s.onTileClick(i,o))}),v(1,"span",231),b(2),E(),_e(3,lz,2,1),_e(4,uz,1,0,"div",232),ap(5),_e(6,fz,11,12,"span",233),_e(7,pz,1,2,"div",234),_e(8,gz,4,2),_e(9,yz,1,1),_e(10,Cz,2,1),_e(11,Oz,2,1),_e(12,$z,1,1),yn(13,Gz,3,13,"div",235,YG),E()}if(n&2){let t,r=e.$implicit,i=V().$implicit,o=V();at("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Le("cursor-pointer",o.gameEngine.isValidMove(r,i))("bg-gray-700",!o.gameEngine.isValidMove(r,i))("border-gray-600",!o.gameEngine.isValidMove(r,i))("bg-blue-900",r===0&&i===0)("bg-red-900",r===o.gameEngine.gridSize-1&&i===o.gameEngine.gridSize-1)("border-4",r===0&&i===0||r===o.gameEngine.gridSize-1&&i===o.gameEngine.gridSize-1)("border-blue-400",r===0&&i===0)("border-red-400",r===o.gameEngine.gridSize-1&&i===o.gameEngine.gridSize-1)("ring-2",r===0&&i===0||r===o.gameEngine.gridSize-1&&i===o.gameEngine.gridSize-1)("ring-blue-300",r===0&&i===0&&o.gameEngine.baseDeployActive())("ring-red-300",r===o.gameEngine.gridSize-1&&i===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&r<=2&&i<=2&&(r!==0||i!==0))("forest-area",o.gameEngine.isForest(r,i))("bg-amber-900",o.gameEngine.isDeployTarget(r,i)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(r,i)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(r,i))("border-gray-800",!o.gameEngine.isVisibleToPlayer(r,i))("bg-green-900",o.gameEngine.isValidMove(r,i)&&!o.gameEngine.getUnitAt(r,i))("border-green-500",o.gameEngine.isValidMove(r,i)&&!o.gameEngine.getUnitAt(r,i))("bg-cyan-900",o.gameEngine.isValidMove(r,i)&&o.gameEngine.getUnitAt(r,i))("border-cyan-500",o.gameEngine.isValidMove(r,i)&&o.gameEngine.getUnitAt(r,i))("animate-pulse",o.gameEngine.isValidMove(r,i)&&o.gameEngine.getUnitAt(r,i))("hover:bg-gray-600",!o.gameEngine.isValidMove(r,i))("hover:bg-green-800",o.gameEngine.isValidMove(r,i)&&!o.gameEngine.getUnitAt(r,i))("hover:bg-cyan-800",o.gameEngine.isValidMove(r,i)&&o.gameEngine.getUnitAt(r,i)),Lo("title",o.gameEngine.getUnitAt(r,i)&&(o.gameEngine.getUnitAt(r,i).owner==="player"||o.gameEngine.isVisibleToPlayer(r,i))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(r,i).id):null),w(2),_n(" ",r,",",i," "),w(),Ee(r===o.gameEngine.gridSize-1&&i===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(r,i)?3:-1),w(),Ee(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(r,i)?4:-1),w(),V_(o.gameEngine.getUnitAt(r,i)),w(),Ee(o.gameEngine.isForest(r,i)&&o.gameEngine.isVisibleToPlayer(r,i)?6:-1),w(),Ee(o.gameEngine.isForest(r,i)&&o.gameEngine.getUnitAt(r,i)&&o.gameEngine.isVisibleToPlayer(r,i)?7:-1),w(),Ee(r===0&&i===0?8:-1),w(),Ee(r===o.gameEngine.gridSize-1&&i===o.gameEngine.gridSize-1?9:-1),w(),Ee(r<o.gameEngine.gridSize-1?10:-1),w(),Ee(i<o.gameEngine.gridSize-1?11:-1),w(),Ee((t=o.gameEngine.getUnitAt(r,i))?12:-1,t),w(),vn(o.gameEngine.getCombatTextEntriesAt(r,i))}}function qz(n,e){if(n&1&&yn(0,zz,15,71,"div",229,ai),n&2){let t=V();vn(t.gameEngine.gridCols)}}function Wz(n,e){n&1&&Q(0,"app-game-rules")}function Kz(n,e){if(n&1&&(v(0,"div",303),b(1),E()),n&2){let t=V(2);w(),z(t.settings.t("NOT_LOGS_DATA"))}}function Qz(n,e){if(n&1&&(v(0,"div",305)(1,"span",306),b(2),E()()),n&2){let t=e.$implicit;at("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Le("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),w(),F_(t.color),w(),z(t.text)}}function Yz(n,e){if(n&1){let t=_t();v(0,"div",202)(1,"button",288),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.toggleLog())}),v(2,"span",289),b(3,"\u2715"),E()(),v(4,"div",290)(5,"div",291)(6,"h3",292),b(7),E(),v(8,"button",293),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.clearLogs())}),Fe(),v(9,"svg",294),Q(10,"path",295),E(),b(11),E()(),qe(),v(12,"label",296)(13,"div",85)(14,"input",297),se("change",function(){fe(t);let i=V();return pe(i.gameEngine.toggleCombatOnly())}),E(),Q(15,"div",298),Fe(),v(16,"svg",299),Q(17,"path",300),E()(),qe(),v(18,"span",301),b(19),E()()(),v(20,"div",302),_e(21,Kz,2,1,"div",303),yn(22,Qz,3,7,"div",304,k_),E()()}if(n&2){let t=V();w(7),de(" ",t.settings.t("Action_LOG")," "),w(4),de(" ",t.settings.t("CLEAR")," "),w(3),$e("checked",t.gameEngine.combatOnly()),w(5),de(" ",t.settings.t("COMBAT_ONLY")," "),w(2),Ee(t.gameEngine.logsFiltered().length===0?21:-1),w(),vn(t.gameEngine.logsFiltered().reverse())}}function Jz(n,e){if(n&1){let t=_t();v(0,"button",321),se("click",function(){let i=fe(t).$implicit,o=V(2);return pe(o.onDifficultyChange(i))}),v(1,"span",322),b(2),E(),b(3),E()}if(n&2){let t=e.$implicit,r=V(2);Le("bg-blue-500/20",r.settings.difficulty()===t)("border-blue-400/40",r.settings.difficulty()===t)("text-blue-200",r.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",r.settings.difficulty()===t)("bg-white/5",r.settings.difficulty()!==t)("border-white/5",r.settings.difficulty()!==t)("text-stone-500",r.settings.difficulty()!==t)("hover:bg-white/10",r.settings.difficulty()!==t),w(),Le("opacity-100",r.settings.difficulty()===t),w(),de(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),w(),de(" ",r.settings.t(r.settings.getDifficultyLabel(t))," ")}}function Zz(n,e){if(n&1){let t=_t();v(0,"button",323),se("click",function(){let i=fe(t).$implicit,o=V(2);return pe(o.onMapSizeChange(i))}),b(1),E()}if(n&2){let t=e.$implicit,r=V(2);Le("bg-gradient-to-br",r.settings.mapSize()===t)("from-indigo-600",r.settings.mapSize()===t)("to-indigo-800",r.settings.mapSize()===t)("text-white",r.settings.mapSize()===t)("shadow-lg",r.settings.mapSize()===t)("text-stone-500",r.settings.mapSize()!==t)("hover:text-stone-300",r.settings.mapSize()!==t),w(),_n(" ",t,"x",t," ")}}function Xz(n,e){if(n&1){let t=_t();v(0,"div",203)(1,"div",307),Q(2,"div",308),v(3,"h3",309),b(4),E(),v(5,"button",310),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.toggleSettings())}),b(6," \u2716 "),E()(),v(7,"div",311)(8,"div",164)(9,"label",312),b(10),E(),v(11,"span",313),b(12),E()(),v(13,"div",314),yn(14,Jz,4,20,"button",315,ai),E()(),v(16,"div",311)(17,"label",316),b(18),E(),v(19,"div",317),yn(20,Zz,2,16,"button",318,ai),E()(),v(22,"div",319)(23,"button",320),se("click",function(){fe(t);let i=V();return pe(i.settings.setLang("uk"))}),b(24," UA "),E(),v(25,"button",320),se("click",function(){fe(t);let i=V();return pe(i.settings.setLang("en"))}),b(26," EN "),E()()()}if(n&2){let t=V();w(4),z(t.settings.t("SYSTEM_SETTINGS")),w(6),de(" ",t.settings.t("TACTICAL_DIFF")," "),w(2),de(" ",t.settings.t("LEVEL_SELECTION")," "),w(2),vn(t.settings.diffArr),w(4),de(" ",t.settings.t("SECTOR_DIMENSIONS")," "),w(2),vn(js(12,QG)),w(3),Le("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),w(2),Le("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en")}}function e7(n,e){if(n&1&&(v(0,"div",332)(1,"span"),b(2),Hs(3,"date"),E(),v(4,"span",336),b(5),E(),v(6,"span",337),b(7),E()()),n&2){let t=e.$implicit,r=V(2);w(2),z(Xa(3,4,t.date,"yyyy-MM-dd HH:mm")),w(3),z(t.condition),w(2),_n("",t.turns," ",r.settings.t("TURNS"))}}function t7(n,e){if(n&1&&(v(0,"div",333),b(1),E()),n&2){let t=V(2);w(),z(t.settings.t("NO_RECORDS_YET"))}}function n7(n,e){if(n&1&&(v(0,"div",332)(1,"span"),b(2),Hs(3,"date"),E(),v(4,"span",336),b(5),E(),v(6,"span",337),b(7),E()()),n&2){let t=e.$implicit,r=V(2);w(2),z(Xa(3,4,t.date,"yyyy-MM-dd HH:mm")),w(3),z(t.condition),w(2),_n("",t.turns," ",r.settings.t("TURNS"))}}function r7(n,e){if(n&1&&(v(0,"div",333),b(1),E()),n&2){let t=V(2);w(),z(t.settings.t("NO_RECORDS_YET"))}}function i7(n,e){if(n&1){let t=_t();v(0,"div",204)(1,"div",324)(2,"div",325)(3,"h2",326),b(4),E(),v(5,"button",327),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.closeHighScores())}),b(6," \u2716 "),E()(),v(7,"div",328),b(8),E(),v(9,"div",329)(10,"div",330)(11,"h3",331),b(12),E(),yn(13,e7,8,7,"div",332,_O,!1,t7,2,1,"div",333),E(),v(16,"div",330)(17,"h3",334),b(18),E(),yn(19,n7,8,7,"div",332,_O,!1,r7,2,1,"div",333),E()(),v(22,"div",335),b(23),E()()()}if(n&2){let t=V();w(4),z(t.settings.t("HIGH_SCORES")),w(4),Za(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),w(4),z(t.settings.t("TOP_3_PLAYER")),w(),vn(t.gameEngine.getHighScoresForCurrentCombo().wins),w(5),z(t.settings.t("TOP_3_LOSES_PLAYER")),w(),vn(t.gameEngine.getHighScoresForCurrentCombo().losses),w(4),z(t.settings.t("CHANGE_RECORDS_INFO"))}}function o7(n,e){if(n&1){let t=_t();v(0,"div",205)(1,"div",338),b(2," Debug Mode "),E(),v(3,"button",339),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.debugInstantWin())}),b(4," \u26A1 Instant Win "),E(),v(5,"button",340),se("click",function(){fe(t);let i=V();return pe(i.gameEngine.debugCycleSettings())}),b(6," \u{1F504} Cycle Settings "),E(),v(7,"div",341),b(8),E()()}if(n&2){let t=V();w(8),_n(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var qm=class n{constructor(e,t,r,i){this.gameEngine=e;this.settings=t;this.firebase=r;this.router=i}boardContainer;isAutoBattleActive=W(!1);isMobileMenuOpen=W(!1);get isProduction(){return!LA()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let r=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}if(r&&r.owner==="player"){this.gameEngine.selectUnit(r.id);return}this.gameEngine.selectUnit(null)}onEdgeClick(e,t,r,i,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,r,i,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:r},{x:i,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:r},{x:i,y:o})}onDestroyIconClick(e,t,r,i,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:r},{x:i,y:o})}onBuildIconClick(e,t,r,i,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:r},{x:i,y:o})}onAttackIconClick(e,t,r,i,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:r},{x:i,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(f=>setTimeout(f,500)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.units?this.gameEngine.units():[],t=this.gameEngine.getBasePosition("ai"),r={x:Math.floor(this.gameEngine.gridSize/2),y:Math.floor(this.gameEngine.gridSize/2)},i=e.filter(f=>f.owner==="ai"),o=(f,g)=>Math.abs(f.x-g.x)+Math.abs(f.y-g.y),s=-1/0,a=null,c=null,u=1/0,d=!1;for(let f of e){if(f.owner!=="player")continue;this.gameEngine.selectUnit(f.id);let g=this.gameEngine.validMoves();if(g.length!==0)for(let m of g){let S=0,M=this.gameEngine.getUnitAt(m.x,m.y),O=m.x===t.x&&m.y===t.y,P=!!(M&&M.owner==="ai")||O;if(P)S+=100;else{let $=t,ae=o(m,t);for(let re of i){let D=o(m,re.position);D<ae&&(ae=D,$=re.position)}let be=o(f.position,$);if(ae<be&&(S+=50),i.length===0){let re=o(m,r),D=o(f.position,r),I=o(m,t),C=o(f.position,t);(re<D||I<C)&&(S+=20)}}let q=P?0:Math.min(...i.map($=>o(m,$.position)),o(m,t));(S>s||S===s&&q<u)&&(s=S,a=f.id,c=m,u=q,d=P)}}if(a&&c){if(this.gameEngine.selectUnit(a),d)try{console.log("[AUTO_ENGAGE][\u0410\u0412\u0422\u041E\u041F\u0406\u041B\u041E\u0422] \u0426\u0456\u043B\u044C \u0437\u0430\u0445\u043E\u043F\u043B\u0435\u043D\u0430. \u041F\u043E\u0447\u0438\u043D\u0430\u044E \u0430\u0442\u0430\u043A\u0443...")}catch{}this.gameEngine.moveSelectedUnit(c)}else this.gameEngine.selectUnit(null)}static \u0275fac=function(t){return new(t||n)(ge(wi),ge(wn),ge(bi),ge(Ki))};static \u0275cmp=hn({type:n,selectors:[["app-game"]],viewQuery:function(t,r){if(t&1&&ip(KG,5),t&2){let i;op(i=sp())&&(r.boardContainer=i.first)}},decls:331,vars:114,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden","no-select"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-400","bg-red-400","bg-gray-300","shake"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-400","bg-red-400","bg-gray-300","shake"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[10px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none",3,"transition","unit-container-player-unit-tier-2","unit-container-ai-unit-tier-2","transform","shake"],[1,"pointer-events-none"],[1,"flex","items-center","justify-center","font-bold","unit-base","unit-base"],[1,"absolute","top-0","left-0","w-full","h-full","pointer-events-none",2,"z-index","10"],[1,"absolute","-top-1","-right-1","rounded-full","bg-blue-200","text-blue-900","flex","items-center","justify-center",3,"width","height","fontSize","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],["href","#triangle-border","x","0","y","0","width","100%","height","100%"],[1,"absolute","-top-1","-right-1","rounded-full","bg-blue-200","text-blue-900","flex","items-center","justify-center"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,r){if(t&1){let i=_t();v(0,"div",2)(1,"div",3),Q(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),E(),Fe(),v(7,"svg",9)(8,"defs")(9,"clipPath",10),Q(10,"path",11),E(),v(11,"symbol",12),Q(12,"path",13),E()()(),qe(),v(13,"div",14)(14,"div",15),Q(15,"div",16)(16,"div",17),Fe(),v(17,"svg",18),Q(18,"path",19)(19,"rect",20),E(),qe(),Q(20,"div",21)(21,"div",22),E(),v(22,"div",23)(23,"div",24)(24,"h1",25)(25,"span",26),b(26,"Shape"),E(),v(27,"span",27),b(28," Tactics "),E()(),v(29,"div",28),Q(30,"div",29)(31,"div",30),E()(),v(32,"div",31)(33,"span",32),b(34),E()()(),Q(35,"div",33),E(),v(36,"div",34)(37,"div",35)(38,"button",36),se("click",function(){return fe(i),pe(r.gameEngine.resetGame())}),Fe(),v(39,"svg",37),Q(40,"path",38),E(),qe(),v(41,"span",39),b(42),E()(),Q(43,"div",40),v(44,"button",41),se("click",function(){return fe(i),pe(r.gameEngine.toggleRules())}),Fe(),v(45,"svg",42),Q(46,"path",43),E(),qe(),v(47,"span",44),b(48),E()()(),v(49,"div",45)(50,"button",46),se("click",function(){return fe(i),pe(r.gameEngine.toggleHighScores())}),Fe(),v(51,"svg",47),Q(52,"path",48),E(),qe(),v(53,"span",49),b(54),E()(),v(55,"button",50),se("click",function(){return fe(i),pe(r.gameEngine.toggleLeaderboard())}),Fe(),v(56,"svg",47),Q(57,"path",51),E(),qe(),v(58,"span",49),b(59),E()(),v(60,"button",52),se("click",function(){return fe(i),pe(r.gameEngine.toggleLog())}),Fe(),v(61,"svg",47),Q(62,"path",53),E(),qe(),v(63,"span",49),b(64),E()(),v(65,"button",54),se("click",function(){return fe(i),pe(r.navigateToFeedback())}),Fe(),v(66,"svg",47),Q(67,"path",55),E(),qe(),v(68,"span",49),b(69),E()()(),v(70,"div",56)(71,"button",57),se("click",function(){return fe(i),pe(r.gameEngine.toggleSettings())}),Fe(),v(72,"svg",58),Q(73,"path",59)(74,"path",60),E()(),_e(75,JG,9,3,"div",61)(76,ZG,4,1,"button",62),E()(),qe(),v(77,"div",63)(78,"div",64),Fe(),v(79,"svg",65),Q(80,"rect",66)(81,"circle",67),E(),qe(),v(82,"span",68),b(83),E()(),v(84,"div",64),Fe(),v(85,"svg",65),Q(86,"polygon",69),E(),qe(),v(87,"span",70),b(88),E()(),v(89,"div",64),Fe(),v(90,"svg",65),Q(91,"circle",71)(92,"path",72),E(),qe(),v(93,"span",73),b(94),E()(),v(95,"div",64),Fe(),v(96,"svg",65),Q(97,"path",74)(98,"rect",75)(99,"rect",76),E(),qe(),v(100,"span",77),b(101),E()(),v(102,"button",78),se("click",function(){return fe(i),pe(r.toggleMobileMenu())}),Fe(),v(103,"svg",79),Q(104,"path",80),E()()(),qe(),v(105,"div",81)(106,"button",82),se("click",function(){return fe(i),pe(r.gameEngine.toggleBuildMode())}),Fe(),v(107,"svg",65),Q(108,"path",83),E()(),qe(),v(109,"button",82),se("click",function(){return fe(i),pe(r.gameEngine.convertWoodToReserve())}),b(110," +1 "),E(),v(111,"button",82),se("click",function(){return fe(i),pe(r.gameEngine.maxConvertWoodToReserve())}),b(112),E(),v(113,"label",84)(114,"div",85)(115,"input",86),se("change",function(){return fe(i),pe(r.gameEngine.toggleFogDebug())}),E(),v(116,"div",87),Q(117,"div",88),E()(),v(118,"span",89),b(119),E()(),v(120,"div",90),b(121),E(),v(122,"button",91),se("click",function(){return fe(i),pe(r.gameEngine.endPlayerTurn())}),Fe(),v(123,"svg",92),Q(124,"path",93)(125,"path",94),E()()(),_e(126,XG,19,7,"div",95),qe(),v(127,"div",96),Q(128,"div",97),v(129,"div",98)(130,"div",99)(131,"span",100),b(132),E(),v(133,"span",101),b(134),E()(),Q(135,"div",102),v(136,"div",103)(137,"div",104)(138,"span",105),Fe(),v(139,"svg",106),Q(140,"rect",66)(141,"circle",107)(142,"circle",108)(143,"rect",109)(144,"circle",110)(145,"circle",111),E()(),qe(),v(146,"span",112),b(147),E()(),v(148,"div",113)(149,"span",105)(150,"div",114),Fe(),v(151,"svg",115),Q(152,"polygon",116)(153,"rect",117)(154,"polygon",118)(155,"rect",119)(156,"polygon",120)(157,"rect",121),v(158,"g",122),Q(159,"rect",123)(160,"polygon",124),E(),v(161,"g",125),Q(162,"rect",126)(163,"circle",127)(164,"circle",128),E()()()(),qe(),v(165,"span",129),b(166),v(167,"span",130),b(168,"/"),E(),b(169),E()()()(),v(170,"div",131),Q(171,"div",132),v(172,"span",133),b(173),E(),v(174,"div",24)(175,"span",134),b(176),E()(),_e(177,ez,2,3,"div",135),E(),v(178,"div",98)(179,"div",103)(180,"div",104)(181,"span",136),b(182),E(),v(183,"span",105),Fe(),v(184,"svg",106),Q(185,"rect",66)(186,"circle",107)(187,"circle",108)(188,"rect",109)(189,"circle",110)(190,"circle",111),E()()(),qe(),v(191,"div",137)(192,"span",138),b(193),v(194,"span",130),b(195,"/"),E(),b(196),E(),v(197,"span",105)(198,"div",114),Fe(),v(199,"svg",115),Q(200,"polygon",116)(201,"rect",117)(202,"polygon",118)(203,"rect",119)(204,"polygon",120)(205,"rect",121),v(206,"g",122),Q(207,"rect",123)(208,"polygon",139),E(),v(209,"g",125),Q(210,"rect",126)(211,"circle",127)(212,"circle",128),E()()()()()(),qe(),Q(213,"div",102),v(214,"div",140)(215,"span",141),b(216),E(),v(217,"span",142),b(218,"jaerbi"),E()()()(),_e(219,rz,11,11,"div",143),v(220,"button",144),se("click",function(){return fe(i),pe(r.navigateToRoadmap())}),v(221,"div",145),Q(222,"div",146),v(223,"span",147),b(224),E()(),v(225,"div",148),Fe(),v(226,"svg",149),Q(227,"path",150),E()()(),qe(),v(228,"button",151),se("click",function(){return fe(i),pe(r.gameEngine.toggleSupport())}),v(229,"span",105),b(230,"\u2764\uFE0F"),E(),v(231,"span",152),b(232),E()(),_e(233,iz,1,0,"app-support-community"),_e(234,oz,1,0,"app-leaderboard-modal"),v(235,"div",153)(236,"div",154,0)(238,"div",155)(239,"div",156)(240,"span",157),b(241),E()(),_e(242,sz,3,1,"div",158),yn(243,qz,2,0,null,null,ai),E()(),v(245,"div",159)(246,"div",160),Q(247,"div",161),v(248,"div",162)(249,"span",163),b(250),E(),v(251,"div",164)(252,"span",165),b(253),E(),v(254,"div",166)(255,"span",105),b(256),E()()(),v(257,"div",167),Q(258,"div",168),E()()()(),v(259,"div",169)(260,"div",170)(261,"button",171),se("click",function(){return fe(i),pe(r.toggleAutoBattle())}),v(262,"div",172)(263,"span",173),b(264),E(),v(265,"span",174),b(266),E()(),v(267,"div",172),Q(268,"span",175),E(),Q(269,"div",176),E(),v(270,"button",177),se("click",function(){return fe(i),pe(r.gameEngine.toggleBuildMode())}),v(271,"div",178)(272,"span",179),b(273,"+1"),E(),v(274,"div",180),Fe(),v(275,"svg",181),Q(276,"path",182)(277,"path",183)(278,"path",184)(279,"rect",185),E()()(),qe(),v(280,"div",186)(281,"span"),b(282,"-10"),E(),v(283,"div",187),Fe(),v(284,"svg",188),Q(285,"rect",189)(286,"circle",190)(287,"circle",191),E()()(),qe(),Q(288,"div",176),E(),v(289,"button",192),se("click",function(){return fe(i),pe(r.gameEngine.convertWoodToReserve())}),v(290,"div",193)(291,"span",194)(292,"span"),b(293,"20"),E(),v(294,"div",187),Fe(),v(295,"svg",188),Q(296,"rect",189)(297,"circle",190)(298,"circle",191),E()()(),qe(),v(299,"span",105),b(300,"\u2794"),E(),v(301,"span",195),b(302,"1 \u{1F464}"),E()()(),v(303,"button",196),se("click",function(){return fe(i),pe(r.gameEngine.maxConvertWoodToReserve())}),v(304,"div",197)(305,"span",198),b(306),E(),v(307,"span",105),b(308,"\u2794"),E(),v(309,"span",105),b(310,"\u{1F465}++"),E()()()(),v(311,"label",199)(312,"div",85)(313,"input",86),se("change",function(){return fe(i),pe(r.gameEngine.toggleFogDebug())}),E(),v(314,"div",87),Q(315,"div",88),E()(),v(316,"span",89),b(317),E()(),v(318,"button",200),se("click",function(){return fe(i),pe(r.gameEngine.endPlayerTurn())}),v(319,"div",197)(320,"span",198),b(321),E()()(),v(322,"div",90),b(323),E()()(),v(324,"div",201),b(325),E(),_e(326,Wz,1,0,"app-game-rules"),_e(327,Yz,24,5,"div",202),_e(328,Xz,27,13,"div",203),_e(329,i7,24,9,"div",204),_e(330,o7,9,2,"div",205),E()}if(t&2){let i;w(34),z(r.settings.version),w(8),de(" ",r.settings.t("RELOAD")," "),w(6),de(" ",r.settings.t("INFO")," "),w(6),z(r.settings.t("RECORDS")),w(5),z(r.settings.t("RANKING")),w(5),z(r.settings.t("SYSTEM_LOG")),w(5),z(r.settings.t("FEEDBACK_MODULE")),w(6),Ee((i=r.firebase.user$())?75:76,i),w(8),z(r.gameEngine.resources().wood),w(5),_n(" ",r.gameEngine.getForestControl().player,"/",r.gameEngine.getForestControl().total," "),w(6),z(r.gameEngine.turn()),w(7),_n(" ",r.gameEngine.getForestControl().player," : ",r.gameEngine.getForestControl().ai," "),w(5),$e("disabled",!r.gameEngine.canBuildThisTurn()),w(3),$e("disabled",!r.gameEngine.canAddReserveTurn()),w(2),$e("disabled",!r.gameEngine.canAddReserveTurn()),w(),de(" ",r.settings.t("ALL")," "),w(3),$e("checked",r.gameEngine.fogDebugDisabled()),w(4),z(r.settings.t("MAP_HACK")),w(2),_n(" ",r.gameEngine.remainingActions(),"/",r.gameEngine.totalPlayerUnits()," "),w(5),Ee(r.isMobileMenuOpen()?126:-1),w(6),de(" ",r.settings.t("COMMANDER")," "),w(2),de(" ",r.settings.t("PLAYER")," "),w(13),z(r.gameEngine.resources().wood),w(19),de(" ",r.gameEngine.getForestControl().player," "),w(3),de(" ",r.gameEngine.getForestControl().total," "),w(4),de(" ",r.settings.t("TURN_CYCLE")," "),w(3),de(" ",r.gameEngine.turn()," "),w(),Ee(r.gameEngine.monopolyTurnsLeft()>0?177:-1),w(5),z(r.gameEngine.aiWood()),w(11),de(" ",r.gameEngine.getForestControl().ai," "),w(3),de(" ",r.gameEngine.getForestControl().total," "),w(20),de(" ",r.settings.t("HOSTILE")," "),w(3),Ee(r.gameEngine.shouldShowEndOverlay()?219:-1),w(5),de(" ",r.settings.t("STRATEGIC_PLAN")," "),w(8),z(r.settings.t("SUPPORT")),w(),Ee(r.gameEngine.supportOpen()?233:-1),w(),Ee(r.gameEngine.leaderboardOpen()?234:-1),w(2),Le("shake",r.gameEngine.screenShake())("mood-none",r.gameEngine.currentMood()==="none")("mood-angry",r.gameEngine.currentMood()==="angry")("mood-rage",r.gameEngine.currentMood()==="rage"),w(2),at("grid-template-columns","repeat("+r.gameEngine.gridSize+", minmax("+r.gameEngine.tileMinSizePx+"px, "+r.gameEngine.tileSizePx+"px))")("gap",r.gameEngine.wallThicknessPx+2,"px"),w(3),de(" ",r.gameEngine.baseHealth().player," "),w(),Ee(r.gameEngine.isVisibleToPlayer(r.gameEngine.gridSize-1,r.gameEngine.gridSize-1)?242:-1),w(),vn(r.gameEngine.gridRows),w(4),Le("bg-lime-400",r.settings.difficulty()==="baby")("bg-emerald-400",r.settings.difficulty()==="normal")("bg-orange-500",r.settings.difficulty()==="hard")("bg-red-600",r.settings.difficulty()==="nightmare"),w(3),z(r.settings.t("RISK")),w(2),Le("text-lime-300",r.settings.difficulty()==="baby")("text-emerald-300",r.settings.difficulty()==="normal")("text-orange-400",r.settings.difficulty()==="hard")("text-red-500",r.settings.difficulty()==="nightmare"),w(),de(" ",r.settings.t(r.settings.getDifficultyLabel(r.settings.difficulty()))," "),w(3),de(" ",r.settings.difficulty()==="baby"?"\u{1F476}":r.settings.difficulty()==="normal"?"\u{1F920}":r.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),w(2),at("width",r.settings.difficulty()==="baby"?25:r.settings.difficulty()==="normal"?50:r.settings.difficulty()==="hard"?75:100,"%"),Le("bg-lime-400",r.settings.difficulty()==="baby")("bg-emerald-400",r.settings.difficulty()==="normal")("bg-orange-500",r.settings.difficulty()==="hard")("bg-red-600",r.settings.difficulty()==="nightmare"),w(3),Le("ring-2",r.isAutoBattleActive())("ring-green-400",r.isAutoBattleActive()),$e("disabled",r.gameEngine.gameStatus()!=="playing"),w(3),z(r.settings.t("AUTO")),w(2),z(r.settings.t("ENGAGE")),w(2),Le("bg-green-400",r.isAutoBattleActive())("bg-gray-500",!r.isAutoBattleActive()),w(2),Le("ring-2",r.gameEngine.buildMode())("ring-blue-400",r.gameEngine.buildMode()),$e("disabled",r.gameEngine.wallBuiltThisTurn()||!r.gameEngine.canBuildThisTurn()),w(19),$e("disabled",!r.gameEngine.canAddReserveTurn()),w(14),$e("disabled",!r.gameEngine.canAddReserveTurn()),w(3),z(r.settings.t("ALL")),w(7),$e("checked",r.gameEngine.fogDebugDisabled()),w(4),z(r.settings.t("MAP_HACK")),w(4),z(r.settings.t("NEXT_TURN")),w(2),Za(" ",r.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",r.gameEngine.remainingActions(),"/",r.gameEngine.totalPlayerUnits()," "),w(2),de(" ",r.settings.version," | \xA9\uFE0E Created by jaerbi and just "),w(),Ee(r.gameEngine.rulesOpen()?326:-1),w(),Ee(r.gameEngine.logOpen()?327:-1),w(),Ee(r.gameEngine.settingsOpen()?328:-1),w(),Ee(r.gameEngine.highScoresOpen()?329:-1),w(),Ee(r.isProduction?-1:330)}},dependencies:[Vn,$m,Gm,zm,uE,bu],styles:['.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.victory-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_victoryPulse 1.2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_victoryPulse{0%{transform:scale(1);filter:brightness(1)}50%{transform:scale(1.03);filter:brightness(1.15)}to{transform:scale(1);filter:brightness(1)}}.unit-container-player-unit-tier-2[_ngcontent-%COMP%]{display:flex;align-items:center;filter:drop-shadow(0 0 6px rgba(59,130,246,.7))}.unit-container-ai-unit-tier-2[_ngcontent-%COMP%]{display:flex;align-items:center;filter:drop-shadow(0 0 6px rgba(239,68,68,.7))}.unit-base[_ngcontent-%COMP%]{transition:all .2s cubic-bezier(.4,0,.2,1);box-shadow:inset 0 1px 3px #fff9}.unit-base[_ngcontent-%COMP%]:hover{transform:scale(1.1);filter:brightness(1.2) contrast(1.1);z-index:50}.unit-player[_ngcontent-%COMP%]{background:radial-gradient(circle at 30% 30%,#60a5fa,#1e40af);filter:drop-shadow(0 0 6px rgba(59,130,246,.7))}.unit-player[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 10px rgba(59,130,246,1)) brightness(1.2)}.unit-ai[_ngcontent-%COMP%]{background:radial-gradient(circle at 30% 30%,#f87171,#991b1b);filter:drop-shadow(0 0 6px rgba(239,68,68,.7))}.unit-ai[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 10px rgba(239,68,68,1)) brightness(1.2)}.unit-tier-1[_ngcontent-%COMP%]{border-radius:9999px}.unit-tier-2[_ngcontent-%COMP%]{clip-path:url(#soft-triangle);position:relative;overflow:hidden}.unit-tier-2[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,rgba(255,255,255,.5) 0%,transparent 50%);pointer-events:none}.unit-tier-3[_ngcontent-%COMP%]{border-radius:20%}.unit-tier-4[_ngcontent-%COMP%]{border-radius:20%;transform:rotate(45deg) scale(.85)}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.wall-obsidian[_ngcontent-%COMP%]{background:linear-gradient(135deg,#282832cc,#0a0a0fe6)!important;border:1px solid rgba(255,255,255,.15);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);box-shadow:inset 0 0 10px #000c}.floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle)}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent)}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle)}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent)}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:sticky;top:42px;z-index:1}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{right:0;bottom:6px;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}',"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}"]})};var xO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(ge(Bs),ge(xr))};static \u0275dir=Xt({type:n})}return n})(),s7=(()=>{class n extends xO{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Us(n)))(i||n)}})();static \u0275dir=Xt({type:n,features:[oi]})}return n})(),AO=new ne("");var a7={provide:AO,useExisting:Do(()=>ey),multi:!0};function c7(){let n=ur()?ur().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var l7=new ne(""),ey=(()=>{class n extends xO{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!c7())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(ge(Bs),ge(xr),ge(l7,8))};static \u0275dir=Xt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&se("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[du([a7]),oi]})}return n})();function dT(n){return n==null||hT(n)===0}function hT(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var MO=new ne(""),RO=new ne(""),u7=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,po=class{static min(e){return d7(e)}static max(e){return h7(e)}static required(e){return f7(e)}static requiredTrue(e){return p7(e)}static email(e){return g7(e)}static minLength(e){return m7(e)}static maxLength(e){return y7(e)}static pattern(e){return v7(e)}static nullValidator(e){return NO()}static compose(e){return VO(e)}static composeAsync(e){return BO(e)}};function d7(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function h7(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function f7(n){return dT(n.value)?{required:!0}:null}function p7(n){return n.value===!0?null:{required:!0}}function g7(n){return dT(n.value)||u7.test(n.value)?null:{email:!0}}function m7(n){return e=>{let t=e.value?.length??hT(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function y7(n){return e=>{let t=e.value?.length??hT(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function v7(n){if(!n)return NO;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(dT(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function NO(n){return null}function PO(n){return n!=null}function kO(n){return Oo(n)?Bt(n):n}function OO(n){let e={};return n.forEach(t=>{e=t!=null?F(F({},e),t):e}),Object.keys(e).length===0?null:e}function FO(n,e){return e.map(t=>t(n))}function _7(n){return!n.validate}function LO(n){return n.map(e=>_7(e)?e:t=>e.validate(t))}function VO(n){if(!n)return null;let e=n.filter(PO);return e.length==0?null:function(t){return OO(FO(t,e))}}function UO(n){return n!=null?VO(LO(n)):null}function BO(n){if(!n)return null;let e=n.filter(PO);return e.length==0?null:function(t){let r=FO(t,e).map(kO);return zy(r).pipe(wt(OO))}}function jO(n){return n!=null?BO(LO(n)):null}function EO(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function HO(n){return n._rawValidators}function $O(n){return n._rawAsyncValidators}function aT(n){return n?Array.isArray(n)?n:[n]:[]}function Km(n,e){return Array.isArray(n)?n.includes(e):n===e}function bO(n,e){let t=aT(e);return aT(n).forEach(i=>{Km(t,i)||t.push(i)}),t}function wO(n,e){return aT(e).filter(t=>!Km(n,t))}var Qm=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=UO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=jO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Jc=class extends Qm{name;get formDirective(){return null}get path(){return null}},Fd=class extends Qm{_parent=null;name=null;valueAccessor=null},Ym=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var GO=(()=>{class n extends Ym{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(ge(Fd,2))};static \u0275dir=Xt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Le("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[oi]})}return n})(),zO=(()=>{class n extends Ym{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(ge(Jc,10))};static \u0275dir=Xt({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Le("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[oi]})}return n})();var Nd="VALID",Wm="INVALID",Qc="PENDING",Pd="DISABLED",is=class{},Jm=class extends is{value;source;constructor(e,t){super(),this.value=e,this.source=t}},kd=class extends is{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Od=class extends is{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Yc=class extends is{status;source;constructor(e,t){super(),this.status=e,this.source=t}},cT=class extends is{source;constructor(e){super(),this.source=e}},Ld=class extends is{source;constructor(e){super(),this.source=e}};function fT(n){return(ty(n)?n.validators:n)||null}function E7(n){return Array.isArray(n)?UO(n):n||null}function pT(n,e){return(ty(e)?e.asyncValidators:n)||null}function b7(n){return Array.isArray(n)?jO(n):n||null}function ty(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function qO(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new ee(1e3,"");if(!r[t])throw new ee(1001,"")}function WO(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new ee(1002,"")})}var Zc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Wt(this.statusReactive)}set status(e){Wt(()=>this.statusReactive.set(e))}_status=Mr(()=>this.statusReactive());statusReactive=W(void 0);get valid(){return this.status===Nd}get invalid(){return this.status===Wm}get pending(){return this.status==Qc}get disabled(){return this.status===Pd}get enabled(){return this.status!==Pd}errors;get pristine(){return Wt(this.pristineReactive)}set pristine(e){Wt(()=>this.pristineReactive.set(e))}_pristine=Mr(()=>this.pristineReactive());pristineReactive=W(!0);get dirty(){return!this.pristine}get touched(){return Wt(this.touchedReactive)}set touched(e){Wt(()=>this.touchedReactive.set(e))}_touched=Mr(()=>this.touchedReactive());touchedReactive=W(!1);get untouched(){return!this.touched}_events=new Vt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(bO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(bO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(wO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(wO(e,this._rawAsyncValidators))}hasValidator(e){return Km(this._rawValidators,e)}hasAsyncValidator(e){return Km(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(le(F({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Od(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Od(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(le(F({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new kd(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new kd(!0,r))}markAsPending(e={}){this.status=Qc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Yc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(le(F({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Pd,this.errors=null,this._forEachChild(i=>{i.disable(le(F({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Jm(this.value,r)),this._events.next(new Yc(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(le(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Nd,this._forEachChild(r=>{r.enable(le(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(le(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Nd||this.status===Qc)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Jm(this.value,t)),this._events.next(new Yc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(le(F({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Pd:Nd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Qc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=kO(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Yc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new jt,this.statusChanges=new jt}_calculateStatus(){return this._allControlsDisabled()?Pd:this.errors?Wm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Qc)?Qc:this._anyControlsHaveStatus(Wm)?Wm:Nd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new kd(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Od(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ty(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=E7(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=b7(this._rawAsyncValidators)}},Xc=class extends Zc{constructor(e,t,r){super(fT(t),pT(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){WO(this,!0,e),Object.keys(e).forEach(r=>{qO(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,le(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Ld(this))}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var lT=class extends Xc{};var KO=new ne("",{factory:()=>gT}),gT="always";function w7(n,e){return[...e.path,n]}function IO(n,e,t=gT){mT(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),T7(n,e),C7(n,e),S7(n,e),I7(n,e)}function TO(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Xm(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Zm(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function I7(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function mT(n,e){let t=HO(n);e.validator!==null?n.setValidators(EO(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=$O(n);e.asyncValidator!==null?n.setAsyncValidators(EO(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Zm(e._rawValidators,i),Zm(e._rawAsyncValidators,i)}function Xm(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=HO(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.validator);o.length!==i.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let i=$O(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(t=!0,n.setAsyncValidators(o))}}}let r=()=>{};return Zm(e._rawValidators,r),Zm(e._rawAsyncValidators,r),t}function T7(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&QO(n,e)})}function S7(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&QO(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function QO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function C7(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function D7(n,e){n==null,mT(n,e)}function x7(n,e){return Xm(n,e)}function A7(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function M7(n){return Object.getPrototypeOf(n.constructor)===s7}function R7(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function N7(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===ey?t=o:M7(o)?r=o:i=o}),i||r||t||null}function P7(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function SO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function CO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var _a=class extends Zc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(fT(t),pT(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ty(t)&&(t.nonNullable||t.initialValueIsDefault)&&(CO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Ld(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){SO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){SO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){CO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var k7=n=>n instanceof _a;var YO=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=Xt({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var uT=class extends Zc{constructor(e,t,r){super(fT(t),pT(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(r=>{this.controls.push(r),this._registerControl(r)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){WO(this,!1,e),e.forEach((r,i)=>{qO(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],le(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Ld(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var O7=(()=>{class n extends Jc{callSetDisabledState;get submitted(){return Wt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=Mr(()=>this._submittedReactive());_submittedReactive=W(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(Xm(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let r=this.form.get(t.path);return IO(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){TO(t.control||null,t,!1),P7(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,r){this.form.get(t.path).setValue(r)}onReset(){this.resetForm()}resetForm(t=void 0,r={}){this.form.reset(t,r),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,R7(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new cT(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(TO(r||null,t),k7(i)&&(IO(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);D7(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&x7(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){mT(this.form,this),this._oldForm&&Xm(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(r){return new(r||n)(ge(MO,10),ge(RO,10),ge(KO,8))};static \u0275dir=Xt({type:n,features:[oi,Ui]})}return n})();var JO=new ne("");var F7={provide:Fd,useExisting:Do(()=>yT)},yT=(()=>{class n extends Fd{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new jt;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=N7(this,o)}ngOnChanges(t){this._added||this._setUpControl(),A7(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return w7(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(ge(Jc,13),ge(MO,10),ge(RO,10),ge(AO,10),ge(JO,8))};static \u0275dir=Xt({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[du([F7]),oi,Ui]})}return n})();var L7={provide:Jc,useExisting:Do(()=>vT)},vT=(()=>{class n extends O7{form=null;ngSubmit=new jt;get control(){return this.form}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Us(n)))(i||n)}})();static \u0275dir=Xt({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&se("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[du([L7]),oi]})}return n})();var V7=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Hi({type:n});static \u0275inj=Wr({})}return n})();function DO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var ZO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),o={};return DO(r)?o=r:r!==null&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new Xc(i,o)}record(t,r=null){let i=this._reduceControls(t);return new lT(i,r)}control(t,r,i){let o={};return this.useNonNullable?(DO(r)?o=r:(o.validators=r,o.asyncValidators=i),new _a(t,le(F({},o),{nonNullable:!0}))):new _a(t,r,i)}array(t,r,i){let o=t.map(s=>this._createControl(s));return new uT(o,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof _a)return t;if(t instanceof Zc)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(r,i,o)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var XO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:JO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:KO,useValue:t.callSetDisabledState??gT}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Hi({type:n});static \u0275inj=Wr({imports:[V7]})}return n})();var ny=class n{db;auth;constructor(){let e=Ku(Bm);this.db=Ed(e),this.auth=Rd(e)}async addFeedback(e){let t=le(F({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:CI()});await _m(Vr(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=es(Vr(this.db,"feedbacks"),lo("timestamp","desc"),pa(e));return(await ga(t)).docs.map(i=>i.data())}async getFeedbackPage(e,t){let r=[lo("timestamp","desc"),pa(e)],i=t?es(Vr(this.db,"feedbacks"),lo("timestamp","desc"),Tk(t),pa(e)):es(Vr(this.db,"feedbacks"),lo("timestamp","desc"),pa(e)),o=await ga(i),s=o.docs.map(c=>c.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),r=es(Vr(this.db,"feedbacks"),ts("userId","==",e),ts("timestamp",">=",t)),o=(await ga(r)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})};var _T=()=>[1,2,3,4,5],e2=(n,e)=>e.timestamp;function j7(n,e){if(n&1){let t=_t();v(0,"button",39),se("click",function(){let i=fe(t).$implicit,o=V(2);return pe(o.setRating(i))}),b(1," \u2605 "),E()}if(n&2){let t=e.$implicit,r=V(2);Le("active",r.form.value.rating>=t)}}function H7(n,e){if(n&1&&(v(0,"div",36),b(1),E()),n&2){let t=V(2);w(),z(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function $7(n,e){n&1&&(v(0,"div",37),b(1),E()),n&2&&(w(),z(e))}function G7(n,e){if(n&1){let t=_t();v(0,"div",25)(1,"div",26),Q(2,"img",27),E(),v(3,"div",28)(4,"div",29),b(5),E(),v(6,"div",30),b(7),E()()(),v(8,"form",31),se("ngSubmit",function(){fe(t);let i=V();return pe(i.submit())}),v(9,"div")(10,"div",32),b(11),E(),v(12,"div",33),yn(13,j7,2,2,"button",34,ai),E()(),v(15,"div")(16,"div",32),b(17),E(),Q(18,"textarea",35),_e(19,H7,2,1,"div",36),_e(20,$7,2,1,"div",37),E(),v(21,"button",38),b(22),E()()}if(n&2){let t,r=e,i=V();w(2),$e("src",r.photoURL,ii),w(3),z(r.displayName),w(2),z(i.settings.t("OPERATOR_ONLINE")),w(),$e("formGroup",i.form),w(3),z(i.settings.t("EFFICIENCY_RATING")),w(2),vn(js(16,_T)),w(4),z(i.settings.t("TACTICAL_NOTE")),w(),$e("placeholder",B_(i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),w(),Ee(i.form.controls.text.errors?19:-1),w(),Ee((t=i.message())?20:-1,t),w(),Le("cursor-pointer",i.canSubmit)("cursor-not-allowed",!i.canSubmit),$e("disabled",!i.canSubmit),w(),de(" ",i.settings.t("TRANSMIT_REPORT")," ")}}function z7(n,e){if(n&1&&(v(0,"div",21),b(1),E()),n&2){let t=V();w(),z(t.settings.t("SYSTEM_LOG"))}}function q7(n,e){if(n&1&&(v(0,"div",22),b(1),E()),n&2){let t=V();w(),z(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function W7(n,e){if(n&1&&(v(0,"span"),b(1,"\u2605"),E()),n&2){let t=e.$implicit,r=V().$implicit;Le("active",r.rating>=t)}}function K7(n,e){if(n&1&&(v(0,"tr",44)(1,"td",47),Q(2,"img",48),v(3,"span"),b(4),E()(),v(5,"td",49)(6,"div",50),yn(7,W7,2,2,"span",51,ai),E()(),v(9,"td",49)(10,"span",52),b(11),E()(),v(12,"td",49)(13,"span",53),b(14),E()()()),n&2){let t=e.$implicit,r=V(2);w(2),$e("src",t.userPhoto,ii),w(2),z(t.userName),w(3),vn(js(4,_T)),w(4),z(t.text),w(3),z(r.formatDate(t.timestamp))}}function Q7(n,e){if(n&1&&(v(0,"tr")(1,"td",54),b(2),E()()),n&2){let t=V(2);w(2),z(t.settings.t("NO_SIGNALS"))}}function Y7(n,e){if(n&1){let t=_t();v(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),b(5),E(),v(6,"th",43),b(7),E(),v(8,"th",43),b(9),E(),v(10,"th",43),b(11),E()()(),v(12,"tbody"),yn(13,K7,15,5,"tr",44,e2,!1,Q7,3,1,"tr"),E()()(),v(16,"div",45)(17,"button",46),se("click",function(){fe(t);let i=V();return pe(i.prevPage())}),b(18),E(),v(19,"button",46),se("click",function(){fe(t);let i=V();return pe(i.nextPage())}),b(20),E()()}if(n&2){let t=V();w(5),z(t.settings.t("TABLE_OPERATOR")),w(2),z(t.settings.t("TABLE_RATING")),w(2),z(t.settings.t("TABLE_MESSAGE")),w(2),z(t.settings.t("TABLE_DATE")),w(2),vn(t.pageItems()),w(5),de(" ",t.settings.t("PREVIOUS")," "),w(2),de(" ",t.settings.t("NEXT")," ")}}function J7(n,e){if(n&1&&(v(0,"span"),b(1,"\u2605"),E()),n&2){let t=e.$implicit,r=V().$implicit;Le("active",r.rating>=t)}}function Z7(n,e){if(n&1&&(v(0,"div",55)(1,"div",56)(2,"div",57),Q(3,"img",58),v(4,"div",59),b(5),E()(),v(6,"div",50),yn(7,J7,2,2,"span",51,ai),E()(),v(9,"div",60),b(10),E()()),n&2){let t=e.$implicit;w(3),$e("src",t.userPhoto,ii),w(2),z(t.userName),w(2),vn(js(3,_T)),w(3),z(t.text)}}function X7(n,e){if(n&1&&yn(0,Z7,11,4,"div",55,e2),n&2){let t=V();vn(t.recent())}}var ry=class n{constructor(e,t,r,i,o){this.fb=e;this.router=t;this.feedback=r;this.firebase=i;this.settings=o;this.form=new Xc({text:new _a("",{nonNullable:!0,validators:[po.required,po.minLength(10),po.maxLength(500)]}),rating:new _a(5,{nonNullable:!0,validators:[po.required,po.min(1),po.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,c=Number(localStorage.getItem(a)||0);this.disabledUntil.set(c)}this.loadPage(0)}recent=W([]);pageItems=W([]);pageStack=[null];pageIndex=W(0);lastDoc=null;disabledUntil=W(0);message=W(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),r=this.pageStack[t]??null,i=await this.feedback.getFeedbackPage(10,r);if(this.pageItems.set(i.items),this.lastDoc=i.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),r=this.pageStack[t]??null,i=await this.feedback.getFeedbackPage(10,r);this.pageItems.set(i.items),this.lastDoc=i.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:r}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let i=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:i.text||"",rating:Number(i.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(ge(ZO),ge(Ki),ge(ny),ge(bi),ge(wn))};static \u0275cmp=hn({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,r){if(t&1&&(v(0,"div",0)(1,"div",1),Q(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),E(),Fe(),v(7,"svg",7)(8,"defs")(9,"clipPath",8),Q(10,"path",9),E()()(),qe(),v(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),b(15),E(),v(16,"span",14),b(17),E()(),v(18,"a",15),b(19),E()(),v(20,"div",16)(21,"div",17)(22,"div",18),b(23),E(),_e(24,G7,23,17),E(),v(25,"div",19)(26,"div",20),_e(27,z7,2,1,"div",21),_e(28,q7,2,1,"div",22),v(29,"button",23),se("click",function(){return r.isAllShow=!r.isAllShow}),b(30),E()(),v(31,"div",24),_e(32,Y7,21,7),_e(33,X7,2,0),E()()()()()),t&2){let i;w(15),z(r.settings.t("FEEDBACK_MODULE")),w(2),z(r.settings.t("COMMUNITY_SIGNALS")),w(2),z(r.settings.t("RETURN_TO_MAP")),w(4),z(r.settings.t("DEPLOY_REPORT")),w(),Ee((i=r.firebase.user$())?24:-1,i),w(3),Ee(r.isAllShow?-1:27),w(),Ee(r.isAllShow?28:-1),w(2),de(" ",r.isAllShow?r.settings.t("TOGGLE_BACK"):r.settings.t("VIEW_FULL_ARCHIVE")," "),w(2),Ee(r.isAllShow?32:-1),w(),Ee(r.isAllShow?-1:33)}},dependencies:[Vn,XO,YO,ey,GO,zO,vT,yT,pc],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var iy=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(ge(wn))};static \u0275cmp=hn({type:n,selectors:[["app-roadmap"]],decls:92,vars:12,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"status-tag","status-planned"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-purple-600/20","border","border-purple-500/40","rotate-45","flex","items-center","justify-center","group-hover:rotate-90","transition-all","duration-500"],[1,"-rotate-45","group-hover:-rotate-90","transition-all","duration-500"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-blue-500"],[1,"w-3","h-1","bg-blue-500/20"],[1,"status-tag","status-concept"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2"],[1,"status-tag","status-research"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,r){t&1&&(v(0,"div",0)(1,"div",1),Q(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),E(),Fe(),v(7,"svg",7)(8,"defs")(9,"clipPath",8),Q(10,"path",9),E()()(),qe(),Q(11,"div",10)(12,"div",11),v(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),Q(17,"div",16),v(18,"h1",17),b(19),E()(),v(20,"p",18),b(21,"Future_Ops // Deployment_Schedule"),E()(),v(22,"a",19)(23,"span",20),b(24,"\xAB"),E(),b(25),E()(),v(26,"div",21)(27,"div",22)(28,"div",23)(29,"span",24),b(30,"REF: PROJECT_VOLUMETRIC"),E(),v(31,"span",25),b(32),E()(),v(33,"div",26)(34,"div",27)(35,"div",28),b(36,"\u{1F4E6}"),E()(),v(37,"div")(38,"h3",29),b(39),E(),v(40,"p",30),b(41),E()()(),v(42,"div",31)(43,"span",32),b(44,"Priority_Alpha"),E(),v(45,"div",33),Q(46,"div",34)(47,"div",34)(48,"div",35),E()()(),v(49,"div",22)(50,"div",23)(51,"span",24),b(52,"REF: RESOURCE_IRON"),E(),v(53,"span",36),b(54),E()(),v(55,"div",26)(56,"div",37)(57,"span"),b(58,"\u26D3\uFE0F"),E()(),v(59,"div")(60,"h3",29),b(61),E(),v(62,"p",30),b(63),E()()(),v(64,"div",31)(65,"span",32),b(66,"Priority_Beta"),E(),v(67,"div",33),Q(68,"div",38)(69,"div",39)(70,"div",39),E()()(),v(71,"div",40)(72,"div",23)(73,"span",24),b(74,"REF: INFRA_SMITHY"),E(),v(75,"span",41),b(76),E()(),v(77,"div",42)(78,"div",43),Q(79,"div",44),v(80,"span",45),b(81,"\u2692\uFE0F"),E()(),v(82,"div")(83,"h3",46),b(84),E(),v(85,"p",47),b(86),E()()()()(),v(87,"div",48)(88,"div",49),b(89,"Community_Intel"),E(),v(90,"p",50),b(91),E()()()()),t&2&&(w(19),de(" ",r.settings.t("STRATEGIC_PLAN")," "),w(6),de(" ",r.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),w(7),z(r.settings.currentLang()==="uk"?"\u0417\u0430\u043F\u043B\u0430\u043D\u043E\u0432\u0430\u043D\u043E":"Planned"),w(7),z(r.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"),w(2),de(" ",r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),w(13),z(r.settings.currentLang()==="uk"?"\u041A\u043E\u043D\u0446\u0435\u043F\u0442":"In Concept"),w(7),z(r.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),w(2),de(" ",r.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),w(13),z(r.settings.currentLang()==="uk"?"\u0414\u043E\u0441\u043B\u0456\u0434\u0436\u0435\u043D\u043D\u044F":"Researching"),w(8),z(r.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),w(2),de(" ",r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),w(5),de(" ",r.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[Vn,pc],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var t2=[{path:"",component:qm},{path:"feedback",component:ry},{path:"roadmap",component:iy}];var n2={providers:[tv(),QE(t2),bM(EM())]};var oy=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=hn({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,r){t&1&&(v(0,"h1",0),b(1,"Turn-Based Strategy"),E(),Q(2,"router-outlet"))},dependencies:[ju],encapsulation:2})};bE(oy,n2).catch(n=>console.error(n));
