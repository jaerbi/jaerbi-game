var s4=Object.defineProperty,a4=Object.defineProperties;var l4=Object.getOwnPropertyDescriptors;var Dh=Object.getOwnPropertySymbols;var NS=Object.prototype.hasOwnProperty,kS=Object.prototype.propertyIsEnumerable;var PS=(n,e,t)=>e in n?s4(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||={})NS.call(e,t)&&PS(n,t,e[t]);if(Dh)for(var t of Dh(e))kS.call(e,t)&&PS(n,t,e[t]);return n},ce=(n,e)=>a4(n,l4(e));var Qa=(n,e)=>{var t={};for(var i in n)NS.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&Dh)for(var i of Dh(n))e.indexOf(i)<0&&kS.call(n,i)&&(t[i]=n[i]);return t};var Vn=null,Ah=!1,iy=1,c4=null,Qn=Symbol("SIGNAL");function Ue(n){let e=Vn;return Vn=n,e}function Rh(){return Vn}var jc={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Hc(n){if(Ah)throw new Error("");if(Vn===null)return;Vn.consumerOnSignalRead(n);let e=Vn.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Vn.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Vn.producers,t!==void 0&&t.producer===n)){Vn.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Vn&&(!i||d4(r,Vn)))return;let o=Ja(Vn),s={producer:n,consumer:Vn,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Vn.producersTail=s,e!==void 0?e.nextProducer=s:Vn.producers=s,o&&VS(n,s)}function OS(){iy++}function ry(n){if(!(Ja(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===iy)){if(!n.producerMustRecompute(n)&&!Nh(n)){ny(n);return}n.producerRecomputeValue(n),ny(n)}}function oy(n){if(n.consumers===void 0)return;let e=Ah;Ah=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||u4(i)}}finally{Ah=e}}function sy(){return Vn?.consumerAllowSignalWrites!==!1}function u4(n){n.dirty=!0,oy(n),n.consumerMarkedDirty?.(n)}function ny(n){n.dirty=!1,n.lastCleanEpoch=iy}function $c(n){return n&&FS(n),Ue(n)}function FS(n){n.producersTail=void 0,n.recomputing=!0}function Ph(n,e){Ue(e),n&&LS(n)}function LS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Ja(n))do t=ay(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Nh(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(ry(t),i!==t.version))return!0}return!1}function Gc(n){if(Ja(n)){let e=n.producers;for(;e!==void 0;)e=ay(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function VS(n,e){let t=n.consumersTail,i=Ja(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)VS(r.producer,r)}function ay(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Ja(e)){let o=e.producers;for(;o!==void 0;)o=ay(o)}return t}function Ja(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function ly(n){c4?.(n)}function d4(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function cy(n,e){return Object.is(n,e)}function kh(n,e){let t=Object.create(h4);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(ry(t),Hc(t),t.value===Mh)throw t.error;return t.value};return i[Qn]=t,ly(t),i}var ey=Symbol("UNSET"),ty=Symbol("COMPUTING"),Mh=Symbol("ERRORED"),h4=ce(F({},jc),{value:ey,dirty:!0,error:null,equal:cy,kind:"computed",producerMustRecompute(n){return n.value===ey||n.value===ty},producerRecomputeValue(n){if(n.value===ty)throw new Error("");let e=n.value;n.value=ty;let t=$c(n),i,r=!1;try{i=n.computation(),Ue(null),r=e!==ey&&e!==Mh&&i!==Mh&&n.equal(e,i)}catch(o){i=Mh,n.error=o}finally{Ph(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function f4(){throw new Error}var US=f4;function BS(n){US(n)}function uy(n){US=n}var p4=null;function dy(n,e){let t=Object.create(Oh);t.value=n,e!==void 0&&(t.equal=e);let i=()=>jS(t);return i[Qn]=t,ly(t),[i,s=>zc(t,s),s=>HS(t,s)]}function jS(n){return Hc(n),n.value}function zc(n,e){sy()||BS(n),n.equal(n.value,e)||(n.value=e,g4(n))}function HS(n,e){sy()||BS(n),zc(n,e(n.value))}var Oh=ce(F({},jc),{equal:cy,value:void 0,kind:"signal"});function g4(n){n.version++,OS(),oy(n),p4?.(n)}function hy(n){let e=Ue(null);try{return n()}finally{Ue(e)}}function Ye(n){return typeof n=="function"}function Za(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Fh=Za(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Us(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var mn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ye(i))try{i()}catch(o){e=o instanceof Fh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{$S(o)}catch(s){e=e??[],s instanceof Fh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Fh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)$S(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Us(t,e)}remove(e){let{_finalizers:t}=this;t&&Us(t,e),e instanceof n&&e._removeParent(this)}};mn.EMPTY=(()=>{let n=new mn;return n.closed=!0,n})();var fy=mn.EMPTY;function Lh(n){return n instanceof mn||n&&"closed"in n&&Ye(n.remove)&&Ye(n.add)&&Ye(n.unsubscribe)}function $S(n){Ye(n)?n():n.unsubscribe()}var Hi={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Xa={setTimeout(n,e,...t){let{delegate:i}=Xa;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Xa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Vh(n){Xa.setTimeout(()=>{let{onUnhandledError:e}=Hi;if(e)e(n);else throw n})}function Wc(){}var GS=py("C",void 0,void 0);function zS(n){return py("E",void 0,n)}function WS(n){return py("N",n,void 0)}function py(n,e,t){return{kind:n,value:e,error:t}}var Bs=null;function el(n){if(Hi.useDeprecatedSynchronousErrorHandling){let e=!Bs;if(e&&(Bs={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Bs;if(Bs=null,t)throw i}}else n()}function qS(n){Hi.useDeprecatedSynchronousErrorHandling&&Bs&&(Bs.errorThrown=!0,Bs.error=n)}var js=class extends mn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Lh(e)&&e.add(this)):this.destination=v4}static create(e,t,i){return new tl(e,t,i)}next(e){this.isStopped?my(WS(e),this):this._next(e)}error(e){this.isStopped?my(zS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?my(GS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},m4=Function.prototype.bind;function gy(n,e){return m4.call(n,e)}var yy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Uh(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Uh(i)}else Uh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Uh(t)}}},tl=class extends js{constructor(e,t,i){super();let r;if(Ye(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&Hi.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&gy(e.next,o),error:e.error&&gy(e.error,o),complete:e.complete&&gy(e.complete,o)}):r=e}this.destination=new yy(r)}};function Uh(n){Hi.useDeprecatedSynchronousErrorHandling?qS(n):Vh(n)}function y4(n){throw n}function my(n,e){let{onStoppedNotification:t}=Hi;t&&Xa.setTimeout(()=>t(n,e))}var v4={closed:!0,next:Wc,error:y4,complete:Wc};var nl=typeof Symbol=="function"&&Symbol.observable||"@@observable";function $i(n){return n}function vy(...n){return _y(n)}function _y(n){return n.length===0?$i:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var st=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=E4(t)?t:new tl(t,i,r);return el(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=KS(i),new i((r,o)=>{let s=new tl({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[nl](){return this}pipe(...t){return _y(t)(this)}toPromise(t){return t=KS(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function KS(n){var e;return(e=n??Hi.Promise)!==null&&e!==void 0?e:Promise}function _4(n){return n&&Ye(n.next)&&Ye(n.error)&&Ye(n.complete)}function E4(n){return n&&n instanceof js||_4(n)&&Lh(n)}function b4(n){return Ye(n?.lift)}function ht(n){return e=>{if(b4(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ft(n,e,t,i,r){return new Ey(n,e,t,i,r)}var Ey=class extends js{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var YS=Za(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var jt=(()=>{class n extends st{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new Bh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new YS}next(t){el(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){el(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){el(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?fy:(this.currentObservers=null,o.push(t),new mn(()=>{this.currentObservers=null,Us(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new st;return t.source=this,t}}return n.create=(e,t)=>new Bh(e,t),n})(),Bh=class extends jt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:fy}};var Nn=class extends jt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var by={now(){return(by.delegate||Date).now()},delegate:void 0};var jh=class extends mn{constructor(e,t){super()}schedule(e,t=0){return this}};var qc={setInterval(n,e,...t){let{delegate:i}=qc;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=qc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Hh=class extends jh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return qc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&qc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Us(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var il=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};il.now=by.now;var $h=class extends il{constructor(e,t=il.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var QS=new $h(Hh);var kn=new st(n=>n.complete());function JS(n){return n&&Ye(n.schedule)}function ZS(n){return n[n.length-1]}function Gh(n){return Ye(ZS(n))?n.pop():void 0}function Go(n){return JS(ZS(n))?n.pop():void 0}function eI(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(h){s(h)}}function l(d){try{c(i.throw(d))}catch(h){s(h)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function XS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hs(n){return this instanceof Hs?(this.v=n,this):new Hs(n)}function tI(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(g){return function(w){return Promise.resolve(w).then(g,h)}}function a(g,w){i[g]&&(r[g]=function(S){return new Promise(function(P,L){o.push([g,S,P,L])>1||l(g,S)})},w&&(r[g]=w(r[g])))}function l(g,w){try{c(i[g](w))}catch(S){f(o[0][3],S)}}function c(g){g.value instanceof Hs?Promise.resolve(g.value.v).then(d,h):f(o[0][2],g)}function d(g){l("next",g)}function h(g){l("throw",g)}function f(g,w){g(w),o.shift(),o.length&&l(o[0][0],o[0][1])}}function nI(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof XS=="function"?XS(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var zh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Wh(n){return Ye(n?.then)}function qh(n){return Ye(n[nl])}function Kh(n){return Symbol.asyncIterator&&Ye(n?.[Symbol.asyncIterator])}function Yh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function w4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Qh=w4();function Jh(n){return Ye(n?.[Qh])}function Zh(n){return tI(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Hs(t.read());if(r)return yield Hs(void 0);yield yield Hs(i)}}finally{t.releaseLock()}})}function Xh(n){return Ye(n?.getReader)}function an(n){if(n instanceof st)return n;if(n!=null){if(qh(n))return x4(n);if(zh(n))return S4(n);if(Wh(n))return I4(n);if(Kh(n))return iI(n);if(Jh(n))return T4(n);if(Xh(n))return C4(n)}throw Yh(n)}function x4(n){return new st(e=>{let t=n[nl]();if(Ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function S4(n){return new st(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function I4(n){return new st(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Vh)})}function T4(n){return new st(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function iI(n){return new st(e=>{D4(n,e).catch(t=>e.error(t))})}function C4(n){return iI(Zh(n))}function D4(n,e){var t,i,r,o;return eI(this,void 0,void 0,function*(){try{for(t=nI(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function Jn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function ef(n,e=0){return ht((t,i)=>{t.subscribe(ft(i,r=>Jn(i,n,()=>i.next(r),e),()=>Jn(i,n,()=>i.complete(),e),r=>Jn(i,n,()=>i.error(r),e)))})}function tf(n,e=0){return ht((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function rI(n,e){return an(n).pipe(tf(e),ef(e))}function oI(n,e){return an(n).pipe(tf(e),ef(e))}function sI(n,e){return new st(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function aI(n,e){return new st(t=>{let i;return Jn(t,e,()=>{i=n[Qh](),Jn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Ye(i?.return)&&i.return()})}function nf(n,e){if(!n)throw new Error("Iterable cannot be null");return new st(t=>{Jn(t,e,()=>{let i=n[Symbol.asyncIterator]();Jn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function lI(n,e){return nf(Zh(n),e)}function cI(n,e){if(n!=null){if(qh(n))return rI(n,e);if(zh(n))return sI(n,e);if(Wh(n))return oI(n,e);if(Kh(n))return nf(n,e);if(Jh(n))return aI(n,e);if(Xh(n))return lI(n,e)}throw Yh(n)}function ln(n,e){return e?cI(n,e):an(n)}function it(...n){let e=Go(n);return ln(n,e)}function wy(n,e){let t=Ye(n)?n:()=>n,i=r=>r.error(t());return new st(e?r=>e.schedule(i,0,r):i)}function rf(n){return!!n&&(n instanceof st||Ye(n.lift)&&Ye(n.subscribe))}var $s=Za(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function yt(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:A4}=Array;function M4(n,e){return A4(e)?n(...e):n(e)}function of(n){return yt(e=>M4(n,e))}var{isArray:R4}=Array,{getPrototypeOf:P4,prototype:N4,keys:k4}=Object;function sf(n){if(n.length===1){let e=n[0];if(R4(e))return{args:e,keys:null};if(O4(e)){let t=k4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function O4(n){return n&&typeof n=="object"&&P4(n)===N4}function af(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Kc(...n){let e=Go(n),t=Gh(n),{args:i,keys:r}=sf(n);if(i.length===0)return ln([],e);let o=new st(F4(i,e,r?s=>af(r,s):$i));return t?o.pipe(of(t)):o}function F4(n,e,t=$i){return i=>{uI(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let l=0;l<r;l++)uI(e,()=>{let c=ln(n[l],e),d=!1;c.subscribe(ft(i,h=>{o[l]=h,d||(d=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function uI(n,e,t){n?Jn(t,n,e):e()}function dI(n,e,t,i,r,o,s,a){let l=[],c=0,d=0,h=!1,f=()=>{h&&!l.length&&!c&&e.complete()},g=S=>c<i?w(S):l.push(S),w=S=>{o&&e.next(S),c++;let P=!1;an(t(S,d++)).subscribe(ft(e,L=>{r?.(L),o?g(L):e.next(L)},()=>{P=!0},void 0,()=>{if(P)try{for(c--;l.length&&c<i;){let L=l.shift();s?Jn(e,s,()=>w(L)):w(L)}f()}catch(L){e.error(L)}}))};return n.subscribe(ft(e,g,()=>{h=!0,f()})),()=>{a?.()}}function Gn(n,e,t=1/0){return Ye(e)?Gn((i,r)=>yt((o,s)=>e(i,o,r,s))(an(n(i,r))),t):(typeof e=="number"&&(t=e),ht((i,r)=>dI(i,r,n,t)))}function hI(n=1/0){return Gn($i,n)}function fI(){return hI(1)}function zo(...n){return fI()(ln(n,Go(n)))}function Yc(n){return new st(e=>{an(n()).subscribe(e)})}function xy(...n){let e=Gh(n),{args:t,keys:i}=sf(n),r=new st(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let d=0;d<s;d++){let h=!1;an(t[d]).subscribe(ft(o,f=>{h||(h=!0,c--),a[d]=f},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?af(i,a):a),o.complete())}))}});return e?r.pipe(of(e)):r}function Gi(n,e){return ht((t,i)=>{let r=0;t.subscribe(ft(i,o=>n.call(e,o,r++)&&i.next(o)))})}function Qc(n){return ht((e,t)=>{let i=null,r=!1,o;i=e.subscribe(ft(t,void 0,void 0,s=>{o=an(n(s,Qc(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function lf(n,e){return Ye(e)?Gn(n,e,1):Gn(n,1)}function Sy(n,e=QS){return ht((t,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let c=o;o=null,i.next(c)}};function l(){let c=s+n,d=e.now();if(d<c){r=this.schedule(void 0,c-d),i.add(r);return}a()}t.subscribe(ft(i,c=>{o=c,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function pI(n){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function zi(n){return n<=0?()=>kn:ht((e,t)=>{let i=0;e.subscribe(ft(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function gI(n=L4){return ht((e,t)=>{let i=!1;e.subscribe(ft(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function L4(){return new $s}function Iy(n){return ht((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Qr(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Gi((r,o)=>n(r,o,i)):$i,zi(1),t?pI(e):gI(()=>new $s))}function cf(n){return n<=0?()=>kn:ht((e,t)=>{let i=[];e.subscribe(ft(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Ty(n){return Gi((e,t)=>n<=t)}function Jc(...n){let e=Go(n);return ht((t,i)=>{(e?zo(n,t,e):zo(n,t)).subscribe(i)})}function Jr(n,e){return ht((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(ft(i,l=>{r?.unsubscribe();let c=0,d=o++;an(n(l,d)).subscribe(r=ft(i,h=>i.next(e?e(l,h,d,c++):h),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Gs(n){return ht((e,t)=>{an(n).subscribe(ft(t,()=>t.complete(),Wc)),!t.closed&&e.subscribe(t)})}function fr(n,e,t){let i=Ye(n)||e||t?{next:n,error:e,complete:t}:n;return i?ht((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(ft(o,l=>{var c;(c=i.next)===null||c===void 0||c.call(i,l),o.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),o.complete()},l=>{var c;a=!1,(c=i.error)===null||c===void 0||c.call(i,l),o.error(l)},()=>{var l,c;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(c=i.finalize)===null||c===void 0||c.call(i)}))}):$i}var Cy;function uf(){return Cy}function pr(n){let e=Cy;return Cy=n,e}var mI=Symbol("NotFound");function rl(n){return n===mI||n?.name==="\u0275NotFound"}var gf="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ge=class extends Error{code;constructor(e,t){super(eo(e,t)),this.code=e}};function B4(n){return`NG0${Math.abs(n)}`}function eo(n,e){return`${B4(n)}${e?": "+e:""}`}var mr=globalThis;function vt(n){for(let e in n)if(n[e]===vt)return e;throw Error("")}function bI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Xr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Xr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function mf(n,e){return n?e?`${n} ${e}`:n:e||""}var j4=vt({__forward_ref__:vt});function Yo(n){return n.__forward_ref__=Yo,n.toString=function(){return Xr(this())},n}function On(n){return Hy(n)?n():n}function Hy(n){return typeof n=="function"&&n.hasOwnProperty(j4)&&n.__forward_ref__===Yo}function de(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function yr(n){return{providers:n.providers||[],imports:n.imports||[]}}function iu(n){return H4(n,yf)}function $y(n){return iu(n)!==null}function H4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function $4(n){let e=n?.[yf]??null;return e||null}function Ay(n){return n&&n.hasOwnProperty(hf)?n[hf]:null}var yf=vt({\u0275prov:vt}),hf=vt({\u0275inj:vt}),Ee=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=de({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Gy(n){return n&&!!n.\u0275providers}var zy=vt({\u0275cmp:vt}),Wy=vt({\u0275dir:vt}),qy=vt({\u0275pipe:vt}),Ky=vt({\u0275mod:vt}),Xc=vt({\u0275fac:vt}),Ys=vt({__NG_ELEMENT_ID__:vt}),yI=vt({__NG_ENV_ID__:vt});function Yy(n){return _f(n,"@NgModule"),n[Ky]||null}function to(n){return _f(n,"@Component"),n[zy]||null}function vf(n){return _f(n,"@Directive"),n[Wy]||null}function Qy(n){return _f(n,"@Pipe"),n[qy]||null}function _f(n,e){if(n==null)throw new ge(-919,!1)}function Wi(n){return typeof n=="string"?n:n==null?"":String(n)}function wI(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Wi(n)}var xI=vt({ngErrorCode:vt}),G4=vt({ngErrorMessage:vt}),z4=vt({ngTokenPath:vt});function Jy(n,e){return SI("",-200,e)}function Ef(n,e){throw new ge(-201,!1)}function SI(n,e,t){let i=new ge(e,n);return i[xI]=e,i[G4]=n,t&&(i[z4]=t),i}function W4(n){return n[xI]}var My;function II(){return My}function zn(n){let e=My;return My=n,e}function Zy(n,e,t){let i=iu(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;Ef(n,"")}var q4={},zs=q4,K4="__NG_DI_FLAG__",Ry=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Ws(t)||0;try{return this.injector.get(e,i&8?null:zs,i)}catch(r){if(rl(r))return r;throw r}}};function Y4(n,e=0){let t=uf();if(t===void 0)throw new ge(-203,!1);if(t===null)return Zy(n,void 0,e);{let i=Q4(e),r=t.retrieve(n,i);if(rl(r)){if(i.optional)return null;throw r}return r}}function Re(n,e=0){return(II()||Y4)(On(n),e)}function q(n,e){return Re(n,Ws(e))}function Ws(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Q4(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Py(n){let e=[];for(let t=0;t<n.length;t++){let i=On(n[t]);if(Array.isArray(i)){if(i.length===0)throw new ge(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],l=J4(a);typeof l=="number"?l===-1?r=a.token:o|=l:r=a}e.push(Re(r,o))}else e.push(Re(i))}return e}function J4(n){return n[K4]}function Wo(n,e){let t=n.hasOwnProperty(Xc);return t?n[Xc]:null}function TI(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function CI(n){return n.flat(Number.POSITIVE_INFINITY)}function bf(n,e){n.forEach(t=>Array.isArray(t)?bf(t,e):e(t))}function Xy(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function ru(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function DI(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function wf(n,e,t){let i=sl(n,e);return i>=0?n[i|1]=t:(i=~i,DI(n,i,e,t)),i}function xf(n,e){let t=sl(n,e);if(t>=0)return n[t|1]}function sl(n,e){return Z4(n,e,1)}function Z4(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var Qo={},Wn=[],vr=new Ee(""),ev=new Ee("",-1),tv=new Ee(""),eu=class{get(e,t=zs){if(t===zs){let r=SI("",-201);throw r.name="\u0275NotFound",r}return t}};function _r(n){return{\u0275providers:n}}function AI(n){return _r([{provide:vr,multi:!0,useValue:n}])}function MI(...n){return{\u0275providers:Sf(!0,n),\u0275fromNgModule:!0}}function Sf(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return bf(e,s=>{let a=s;ff(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&RI(r,o),t}function RI(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];nv(r,o=>{e(o,i)})}}function ff(n,e,t,i){if(n=On(n),!n)return!1;let r=null,o=Ay(n),s=!o&&to(n);if(!o&&!s){let l=n.ngModule;if(o=Ay(l),o)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)ff(c,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let c;bf(o.imports,d=>{ff(d,e,t,i)&&(c||=[],c.push(d))}),c!==void 0&&RI(c,e)}if(!a){let c=Wo(r)||(()=>new r);e({provide:r,useFactory:c,deps:Wn},r),e({provide:tv,useValue:r,multi:!0},r),e({provide:vr,useValue:()=>Re(r),multi:!0},r)}let l=o.providers;if(l!=null&&!a){let c=n;nv(l,d=>{e(d,c)})}}else return!1;return r!==n&&n.providers!==void 0}function nv(n,e){for(let t of n)Gy(t)&&(t=t.\u0275providers),Array.isArray(t)?nv(t,e):e(t)}var X4=vt({provide:String,useValue:vt});function PI(n){return n!==null&&typeof n=="object"&&X4 in n}function eF(n){return!!(n&&n.useExisting)}function tF(n){return!!(n&&n.useFactory)}function qs(n){return typeof n=="function"}function NI(n){return!!n.useClass}var ou=new Ee(""),df={},vI={},Dy;function su(){return Dy===void 0&&(Dy=new eu),Dy}var Kt=class{},Ks=class extends Kt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,ky(e,s=>this.processProvider(s)),this.records.set(ev,ol(void 0,this)),r.has("environment")&&this.records.set(Kt,ol(void 0,this));let o=this.records.get(ou);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(tv,Wn,{self:!0}))}retrieve(e,t){let i=Ws(t)||0;try{return this.get(e,zs,i)}catch(r){if(rl(r))return r;throw r}}destroy(){Zc(this),this._destroyed=!0;let e=Ue(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ue(e)}}onDestroy(e){return Zc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Zc(this);let t=pr(this),i=zn(void 0),r;try{return e()}finally{pr(t),zn(i)}}get(e,t=zs,i){if(Zc(this),e.hasOwnProperty(yI))return e[yI](this);let r=Ws(i),o,s=pr(this),a=zn(void 0);try{if(!(r&4)){let c=this.records.get(e);if(c===void 0){let d=sF(e)&&iu(e);d&&this.injectableDefInScope(d)?c=ol(Ny(e),df):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let l=r&2?su():this.parent;return t=r&8&&t===zs?null:t,l.get(e,t)}catch(l){let c=W4(l);throw c===-200||c===-201?new ge(c,null):l}finally{zn(a),pr(s)}}resolveInjectorInitializers(){let e=Ue(null),t=pr(this),i=zn(void 0),r;try{let o=this.get(vr,Wn,{self:!0});for(let s of o)s()}finally{pr(t),zn(i),Ue(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Xr(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=On(e);let t=qs(e)?e:On(e&&e.provide),i=iF(e);if(!qs(e)&&e.multi===!0){let r=this.records.get(t);r||(r=ol(void 0,df,!0),r.factory=()=>Py(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Ue(null);try{if(t.value===vI)throw Jy(Xr(e));return t.value===df&&(t.value=vI,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&oF(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ue(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=On(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Ny(n){let e=iu(n),t=e!==null?e.factory:Wo(n);if(t!==null)return t;if(n instanceof Ee)throw new ge(204,!1);if(n instanceof Function)return nF(n);throw new ge(204,!1)}function nF(n){if(n.length>0)throw new ge(204,!1);let t=$4(n);return t!==null?()=>t.factory(n):()=>new n}function iF(n){if(PI(n))return ol(void 0,n.useValue);{let e=iv(n);return ol(e,df)}}function iv(n,e,t){let i;if(qs(n)){let r=On(n);return Wo(r)||Ny(r)}else if(PI(n))i=()=>On(n.useValue);else if(tF(n))i=()=>n.useFactory(...Py(n.deps||[]));else if(eF(n))i=(r,o)=>Re(On(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=On(n&&(n.useClass||n.provide));if(rF(n))i=()=>new r(...Py(n.deps));else return Wo(r)||Ny(r)}return i}function Zc(n){if(n.destroyed)throw new ge(205,!1)}function ol(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function rF(n){return!!n.deps}function oF(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function sF(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function ky(n,e){for(let t of n)Array.isArray(t)?ky(t,e):t&&Gy(t)?ky(t.\u0275providers,e):e(t)}function Fn(n,e){let t;n instanceof Ks?(Zc(n),t=n):t=new Ry(n);let i,r=pr(t),o=zn(void 0);try{return e()}finally{pr(r),zn(o)}}function kI(){return II()!==void 0||uf()!=null}var Kn=0,Ae=1,$e=2,Xt=3,Ti=4,Ci=5,Zn=6,al=7,en=8,li=9,Er=10,xt=11,ll=12,rv=13,Qs=14,Yn=15,Jo=16,Js=17,br=18,no=19,ov=20,Zr=21,If=22,au=23,ci=24,Zs=25,Xs=26,ut=27,OI=1,qi=6,wr=7,lu=8,ea=9,Gt=10;function ui(n){return Array.isArray(n)&&typeof n[OI]=="object"}function di(n){return Array.isArray(n)&&n[OI]===!0}function sv(n){return(n.flags&4)!==0}function io(n){return n.componentOffset>-1}function cu(n){return(n.flags&1)===1}function xr(n){return!!n.template}function ta(n){return(n[$e]&512)!==0}function Zo(n){return(n[$e]&256)===256}var av="svg",FI="math";function hi(n){for(;Array.isArray(n);)n=n[Kn];return n}function lv(n,e){return hi(e[n])}function Di(n,e){return hi(e[n.index])}function na(n,e){return n.data[e]}function uu(n,e){return n[e]}function du(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Ai(n,e){let t=e[n];return ui(t)?t:t[Kn]}function LI(n){return(n[$e]&4)===4}function Tf(n){return(n[$e]&128)===128}function VI(n){return di(n[Xt])}function Mi(n,e){return e==null?null:n[e]}function cv(n){n[Js]=0}function uv(n){n[$e]&1024||(n[$e]|=1024,Tf(n)&&cl(n))}function UI(n,e){for(;n>0;)e=e[Qs],n--;return e}function hu(n){return!!(n[$e]&9216||n[ci]?.dirty)}function Cf(n){n[Er].changeDetectionScheduler?.notify(8),n[$e]&64&&(n[$e]|=1024),hu(n)&&cl(n)}function cl(n){n[Er].changeDetectionScheduler?.notify(0);let e=qo(n);for(;e!==null&&!(e[$e]&8192||(e[$e]|=8192,!Tf(e)));)e=qo(e)}function dv(n,e){if(Zo(n))throw new ge(911,!1);n[Zr]===null&&(n[Zr]=[]),n[Zr].push(e)}function BI(n,e){if(n[Zr]===null)return;let t=n[Zr].indexOf(e);t!==-1&&n[Zr].splice(t,1)}function qo(n){let e=n[Xt];return di(e)?e[Xt]:e}function hv(n){return n[al]??=[]}function fv(n){return n.cleanup??=[]}function jI(n,e,t,i){let r=hv(e);r.push(t),n.firstCreatePass&&fv(n).push(i,r.length-1)}var Qe={lFrame:XI(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Oy=!1;function HI(){return Qe.lFrame.elementDepthCount}function $I(){Qe.lFrame.elementDepthCount++}function pv(){Qe.lFrame.elementDepthCount--}function gv(){return Qe.bindingsEnabled}function mv(){return Qe.skipHydrationRootTNode!==null}function yv(n){return Qe.skipHydrationRootTNode===n}function GI(n){Qe.skipHydrationRootTNode=n}function vv(){Qe.skipHydrationRootTNode=null}function Be(){return Qe.lFrame.lView}function tn(){return Qe.lFrame.tView}function ne(n){return Qe.lFrame.contextLView=n,n[en]}function ie(n){return Qe.lFrame.contextLView=null,n}function Un(){let n=_v();for(;n!==null&&n.type===64;)n=n.parent;return n}function _v(){return Qe.lFrame.currentTNode}function zI(){let n=Qe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ia(n,e){let t=Qe.lFrame;t.currentTNode=n,t.isParent=e}function Ev(){return Qe.lFrame.isParent}function WI(){Qe.lFrame.isParent=!1}function bv(){return Qe.lFrame.contextLView}function wv(){return Oy}function xv(n){let e=Oy;return Oy=n,e}function ul(){let n=Qe.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Sv(){return Qe.lFrame.bindingIndex}function qI(n){return Qe.lFrame.bindingIndex=n}function ra(){return Qe.lFrame.bindingIndex++}function fu(n){let e=Qe.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function KI(){return Qe.lFrame.inI18n}function YI(n,e){let t=Qe.lFrame;t.bindingIndex=t.bindingRootIndex=n,Df(e)}function QI(){return Qe.lFrame.currentDirectiveIndex}function Df(n){Qe.lFrame.currentDirectiveIndex=n}function JI(n){let e=Qe.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Iv(){return Qe.lFrame.currentQueryIndex}function Af(n){Qe.lFrame.currentQueryIndex=n}function aF(n){let e=n[Ae];return e.type===2?e.declTNode:e.type===1?n[Ci]:null}function Tv(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=aF(o),r===null||(o=o[Qs],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Qe.lFrame=ZI();return i.currentTNode=e,i.lView=n,!0}function Mf(n){let e=ZI(),t=n[Ae];Qe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function ZI(){let n=Qe.lFrame,e=n===null?null:n.child;return e===null?XI(n):e}function XI(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function eT(){let n=Qe.lFrame;return Qe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Cv=eT;function Rf(){let n=eT();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function tT(n){return(Qe.lFrame.contextLView=UI(n,Qe.lFrame.contextLView))[en]}function Ri(){return Qe.lFrame.selectedIndex}function Xo(n){Qe.lFrame.selectedIndex=n}function Dv(){let n=Qe.lFrame;return na(n.tView,n.selectedIndex)}function ee(){Qe.lFrame.currentNamespace=av}function ke(){lF()}function lF(){Qe.lFrame.currentNamespace=null}function Av(){return Qe.lFrame.currentNamespace}var nT=!0;function Pf(){return nT}function ro(n){nT=n}function Fy(n,e=null,t=null,i){let r=Mv(n,e,t,i);return r.resolveInjectorInitializers(),r}function Mv(n,e=null,t=null,i,r=new Set){let o=[t||Wn,MI(n)];return i=i||(typeof n=="object"?void 0:Xr(n)),new Ks(o,e||su(),i||null,r)}var qn=class n{static THROW_IF_NOT_FOUND=zs;static NULL=new eu;static create(e,t){if(Array.isArray(e))return Fy({name:""},t,e,"");{let i=e.name??"";return Fy({name:i},e.parent,e.providers,i)}}static \u0275prov=de({token:n,providedIn:"any",factory:()=>Re(ev)});static __NG_ELEMENT_ID__=-1},Yt=new Ee(""),Xn=(()=>{class n{static __NG_ELEMENT_ID__=cF;static __NG_ENV_ID__=t=>t}return n})(),Ly=class extends Xn{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Zo(this._lView)}onDestroy(e){let t=this._lView;return dv(t,e),()=>BI(t,e)}};function cF(){return new Ly(Be())}var iT=!1,rT=new Ee(""),Sr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Nn(!1);debugTaskTracker=q(rT,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new st(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=de({token:n,providedIn:"root",factory:()=>new n})}return n})(),Vy=class extends jt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,kI()&&(this.destroyRef=q(Xn,{optional:!0})??void 0,this.pendingTasks=q(Sr,{optional:!0})??void 0)}emit(e){let t=Ue(null);try{super.next(e)}finally{Ue(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof mn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},cn=Vy;function pf(...n){}function Rv(n){let e,t;function i(){n=pf;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function oT(n){return queueMicrotask(()=>n()),()=>{n=pf}}var Pv="isAngularZone",tu=Pv+"_ID",uF=0,yn=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new cn(!1);onMicrotaskEmpty=new cn(!1);onStable=new cn(!1);onError=new cn(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=iT}=e;if(typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,fF(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Pv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ge(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,dF,pf,pf);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},dF={};function Nv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function hF(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){Rv(()=>{n.callbackScheduled=!1,Uy(n),n.isCheckStableRunning=!0,Nv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Uy(n)}function fF(n){let e=()=>{hF(n)},t=uF++;n._inner=n._inner.fork({name:"angular",properties:{[Pv]:!0,[tu]:t,[tu+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(pF(l))return i.invokeTask(o,s,a,l);try{return _I(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),EI(n)}},onInvoke:(i,r,o,s,a,l,c)=>{try{return _I(n),i.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!gF(l)&&e(),EI(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Uy(n),Nv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Uy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function _I(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function EI(n){n._nesting--,Nv(n)}var nu=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new cn;onMicrotaskEmpty=new cn;onStable=new cn;onError=new cn;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function pF(n){return sT(n,"__ignore_ng_zone__")}function gF(n){return sT(n,"__scheduler_tick__")}function sT(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var gr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},fi=new Ee("",{factory:()=>{let n=q(yn),e=q(Kt),t;return i=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw i}):(t??=e.get(gr),t.handleError(i))})}}}),aT={provide:vr,useValue:()=>{let n=q(gr,{optional:!0})},multi:!0},mF=new Ee("",{factory:()=>{let n=q(Yt).defaultView;if(!n)return;let e=q(fi),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),q(Xn).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function kv(){return _r([AI(()=>{q(mF)})])}function $(n,e){let[t,i,r]=dy(n,e?.equal),o=t,s=o[Qn];return o.set=i,o.update=r,o.asReadonly=lT.bind(o),o}function lT(){let n=this[Qn];if(n.readonlyFn===void 0){let e=()=>this();e[Qn]=n,n.readonlyFn=e}return n.readonlyFn}var Nf=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=yF}return n})();function yF(){return new Nf(Be(),Un())}var Ko=class{},pu=new Ee("",{factory:()=>!0});var Ov=new Ee(""),gu=(()=>{class n{internalPendingTasks=q(Sr);scheduler=q(Ko);errorHandler=q(fi);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=de({token:n,providedIn:"root",factory:()=>new n})}return n})(),Fv=(()=>{class n{static \u0275prov=de({token:n,providedIn:"root",factory:()=>new By})}return n})(),By=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}},jy=class{[Qn];constructor(e){this[Qn]=e}destroy(){this[Qn].destroy()}};function un(n){return hy(n)}var kf={JSACTION:"jsaction"};function Iu(n){return{toString:n}.toString()}function xF(n){return typeof n=="function"}function qT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Gf=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}},oo=(()=>{let n=()=>KT;return n.ngInherit=!0,n})();function KT(n){return n.type.prototype.ngOnChanges&&(n.setInput=IF),SF}function SF(){let n=QT(this),e=n?.current;if(e){let t=n.previous;if(t===Qo)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function IF(n,e,t,i,r){let o=this.declaredInputs[i],s=QT(n)||TF(n,{previous:Qo,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new Gf(c&&c.currentValue,t,l===Qo),qT(n,e,r,t)}var YT="__ngSimpleChanges__";function QT(n){return n[YT]||null}function TF(n,e){return n[YT]=e}var cT=[];var pt=function(n,e=null,t){for(let i=0;i<cT.length;i++){let r=cT[i];r(n,e,t)}},at=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(at||{});function CF(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=KT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function JT(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Lf(n,e,t){ZT(n,e,3,t)}function Vf(n,e,t,i){(n[$e]&3)===t&&ZT(n,e,t,i)}function Lv(n,e){let t=n[$e];(t&3)===e&&(t&=16383,t+=1,n[$e]=t)}function ZT(n,e,t,i){let r=i!==void 0?n[Js]&65535:0,o=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(n[Js]+=65536),(a<o||o==-1)&&(DF(n,t,e,l),n[Js]=(n[Js]&4294901760)+l+2),l++}function uT(n,e){pt(at.LifecycleHookStart,n,e);let t=Ue(null);try{e.call(n)}finally{Ue(t),pt(at.LifecycleHookEnd,n,e)}}function DF(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[$e]>>14<n[Js]>>16&&(n[$e]&3)===e&&(n[$e]+=16384,uT(a,o)):uT(a,o)}var hl=-1,aa=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function AF(n){return(n.flags&8)!==0}function MF(n){return(n.flags&16)!==0}function RF(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];PF(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function XT(n){return n===3||n===4||n===6}function PF(n){return n.charCodeAt(0)===64}function gl(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?dT(n,t,r,null,e[++i]):dT(n,t,r,null,null))}}return n}function dT(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function eC(n){return n!==hl}function zf(n){return n&32767}function NF(n){return n>>16}function Wf(n,e){let t=NF(n),i=e;for(;t>0;)i=i[Qs],t--;return i}var Jv=!0;function qf(n){let e=Jv;return Jv=n,e}var kF=256,tC=kF-1,nC=5,OF=0,Ir={};function FF(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ys)&&(i=t[Ys]),i==null&&(i=t[Ys]=OF++);let r=i&tC,o=1<<r;e.data[n+(r>>nC)]|=o}function Kf(n,e){let t=iC(n,e);if(t!==-1)return t;let i=e[Ae];i.firstCreatePass&&(n.injectorIndex=e.length,Vv(i.data,n),Vv(e,null),Vv(i.blueprint,null));let r=T_(n,e),o=n.injectorIndex;if(eC(r)){let s=zf(r),a=Wf(r,e),l=a[Ae].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=r,o}function Vv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function iC(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function T_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=lC(r),i===null)return hl;if(t++,r=r[Qs],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return hl}function Zv(n,e,t){FF(n,e,t)}function LF(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(XT(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function rC(n,e,t){if(t&8||n!==void 0)return n;Ef(e,"NodeInjector")}function oC(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[li],o=zn(void 0);try{return r?r.get(e,i,t&8):Zy(e,i,t&8)}finally{zn(o)}}return rC(i,e,t)}function sC(n,e,t,i=0,r){if(n!==null){if(e[$e]&2048&&!(i&2)){let s=jF(n,e,t,i,Ir);if(s!==Ir)return s}let o=aC(n,e,t,i,Ir);if(o!==Ir)return o}return oC(e,t,i,r)}function aC(n,e,t,i,r){let o=UF(t);if(typeof o=="function"){if(!Tv(e,n,i))return i&1?rC(r,t,i):oC(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))Ef(t);else return s}finally{Cv()}}else if(typeof o=="number"){let s=null,a=iC(n,e),l=hl,c=i&1?e[Yn][Ci]:null;for((a===-1||i&4)&&(l=a===-1?T_(n,e):e[a+8],l===hl||!fT(i,!1)?a=-1:(s=e[Ae],a=zf(l),e=Wf(l,e)));a!==-1;){let d=e[Ae];if(hT(o,a,d.data)){let h=VF(a,e,t,s,i,c);if(h!==Ir)return h}l=e[a+8],l!==hl&&fT(i,e[Ae].data[a+8]===c)&&hT(o,a,e)?(s=d,a=zf(l),e=Wf(l,e)):a=-1}}return r}function VF(n,e,t,i,r,o){let s=e[Ae],a=s.data[n+8],l=i==null?io(a)&&Jv:i!=s&&(a.type&3)!==0,c=r&1&&o===a,d=Uf(a,s,t,l,c);return d!==null?_u(e,s,d,a,r):Ir}function Uf(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,d=o>>20,h=i?a:a+d,f=r?a+d:c;for(let g=h;g<f;g++){let w=s[g];if(g<l&&t===w||g>=l&&w.type===t)return g}if(r){let g=s[l];if(g&&xr(g)&&g.type===t)return l}return null}function _u(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof aa){let a=o;if(a.resolving){let g=wI(s[t]);throw Jy(g)}let l=qf(a.canSeeViewProviders);a.resolving=!0;let c=s[t].type||s[t],d,h=a.injectImpl?zn(a.injectImpl):null,f=Tv(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&CF(t,s[t],e)}finally{h!==null&&zn(h),qf(l),a.resolving=!1,Cv()}}return o}function UF(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Ys)?n[Ys]:void 0;return typeof e=="number"?e>=0?e&tC:BF:e}function hT(n,e,t){let i=1<<n;return!!(t[e+(n>>nC)]&i)}function fT(n,e){return!(n&2)&&!(n&1&&e)}var sa=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return sC(this._tNode,this._lView,e,Ws(i),t)}};function BF(){return new sa(Un(),Be())}function ha(n){return Iu(()=>{let e=n.prototype.constructor,t=e[Xc]||Xv(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[Xc]||Xv(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Xv(n){return Hy(n)?()=>{let e=Xv(On(n));return e&&e()}:Wo(n)}function jF(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[$e]&2048&&!ta(s);){let a=aC(o,s,t,i|2,Ir);if(a!==Ir)return a;let l=o.parent;if(!l){let c=s[ov];if(c){let d=c.get(t,Ir,i);if(d!==Ir)return d}l=lC(s),s=s[Qs]}o=l}return r}function lC(n){let e=n[Ae],t=e.type;return t===2?e.declTNode:t===1?n[Ci]:null}function Tu(n){return LF(Un(),n)}function HF(){return El(Un(),Be())}function El(n,e){return new Ni(Di(n,e))}var Ni=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=HF}return n})();function $F(n){return n instanceof Ni?n.nativeElement:n}function GF(){return this._results[Symbol.iterator]()}var Yf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new jt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=CI(e);(this._changesDetected=!TI(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=GF},cC="ngSkipHydration",zF="ngskiphydration";function uC(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let i=e[t];if(typeof i=="number")return!1;if(typeof i=="string"&&i.toLowerCase()===zF)return!0}return!1}function dC(n){return n.hasAttribute(cC)}function Qf(n){return(n.flags&128)===128}function hC(n){if(Qf(n))return!0;let e=n.parent;for(;e;){if(Qf(n)||uC(e))return!0;e=e.parent}return!1}var C_=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(C_||{}),fC=new Map,WF=0;function qF(){return WF++}function KF(n){fC.set(n[no],n)}function e_(n){fC.delete(n[no])}var pT="__ngContext__";function ml(n,e){ui(e)?(n[pT]=e[no],KF(e)):n[pT]=e}function pC(n){return mC(n[ll])}function gC(n){return mC(n[Ti])}function mC(n){for(;n!==null&&!di(n);)n=n[Ti];return n}var t_;function D_(n){t_=n}function yC(){if(t_!==void 0)return t_;if(typeof document<"u")return document;throw new ge(210,!1)}var Cr=new Ee("",{factory:()=>YF}),YF="ng";var hp=new Ee(""),Ji=new Ee("",{providedIn:"platform",factory:()=>"unknown"});var bl=new Ee("",{factory:()=>q(Yt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var wl=(()=>{class n{static \u0275prov=de({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=QF(q(Yt),q(Cr)),t}});store={};onSerializeCallbacks={};get(t,i){return this.store[t]!==void 0?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function QF(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}var vC="h",_C="b",JF="f",ZF="n",EC="e",bC="t",fp="c",A_="x",Eu="r",wC="i",xC="n",M_="d";var SC="di",IC="s",TC="p";var Cu=new Ee(""),CC=!1,R_=new Ee("",{factory:()=>CC});var P_=new Ee(""),DC=!1,AC=new Ee("",{factory:()=>[]}),MC=new Ee(""),N_=new Ee("",{factory:()=>new Map});var Du="ngb";var RC=(n,e,t)=>{let i=n,r=i.__jsaction_fns??new Map,o=r.get(e)??[];o.push(t),r.set(e,o),i.__jsaction_fns=r},PC=(n,e)=>{let t=n,i=t.getAttribute(Du)??"",r=e.get(i)??new Set;r.has(t)||r.add(t),e.set(i,r)};var NC=n=>{n.removeAttribute(kf.JSACTION),n.removeAttribute(Du),n.__jsaction_fns=void 0},kC=new Ee("",{factory:()=>({})});function k_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let i of t)i(n)}var n_=new Map;function OC(n,e){return n_.set(n,e),()=>n_.delete(n)}var gT=!1,FC=(n,e,t,i)=>{};function XF(n,e,t,i){FC(n,e,t,i)}function LC(){gT||(FC=(n,e,t,i)=>{let r=n[li].get(Cr);n_.get(r)?.(e,t,i)},gT=!0)}var pp=new Ee("");function gp(n){return(n.flags&32)===32}var e3="__nghData__",O_=e3,t3="__nghDeferData__",VC=t3;var Bf="ngh",UC="nghm",BC=()=>null;function n3(n,e,t=!1){let i=n.getAttribute(Bf);if(i==null)return null;let[r,o]=i.split("|");if(i=t?o:r,!i)return null;let s=o?`|${o}`:"",a=t?r:s,l={};if(i!==""){let d=e.get(wl,null,{optional:!0});d!==null&&(l=d.get(O_,[])[Number(i)])}let c={data:l,firstChild:n.firstChild??null};return t&&(c.firstChild=n,mp(c,0,n.nextSibling)),a?n.setAttribute(Bf,a):n.removeAttribute(Bf),c}function jC(){BC=n3}function HC(n,e,t=!1){return BC(n,e,t)}function $C(n){let e=n._lView;return e[Ae].type===2?null:(ta(e)&&(e=e[ut]),e)}function i3(n){return n.textContent?.replace(/\s/gm,"")}function r3(n){let e=yC(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=i3(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),i,r=[];for(;i=t.nextNode();)r.push(i);for(let o of r)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function mp(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function i_(n,e){return n.segmentHeads?.[e]??null}function GC(n){return n.get(MC,!1,{optional:!0})}function o3(n,e){let t=n.data,i=t[EC]?.[e]??null;return i===null&&t[fp]?.[e]&&(i=F_(n,e)),i}function zC(n,e){return n.data[fp]?.[e]??null}function F_(n,e){let t=zC(n,e)??[],i=0;for(let r of t)i+=r[Eu]*(r[A_]??1);return i}function s3(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[M_];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function WC(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[M_];n.disconnectedNodes=t?new Set(t):null}return!!s3(n)?.has(e)}function yp(n,e){let t=n[Zn];return t!==null&&!mv()&&!gp(e)&&!WC(t,e.index-ut)}function a3(n,e){let t=e.get(pp),r=e.get(wl).get(VC,{}),o=!1,s=n,a=null,l=[];for(;!o&&s;){o=t.has(s);let c=t.hydrating.get(s);if(a===null&&c!=null){a=c.promise;break}l.unshift(s),s=r[s][TC]}return{parentBlockPromise:a,hydrationQueue:l}}function Uv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===UC}function mT(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function qC(n){for(let i of n.body.childNodes)if(Uv(i))return;let e=mT(n.body.previousSibling);if(Uv(e))return;let t=mT(n.head.lastChild);if(!Uv(t))throw new ge(-507,!1)}function KC(n,e){let t=n.contentQueries;if(t!==null){let i=Ue(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];Af(o),a.contentQueries(2,e[s],s)}}}finally{Ue(i)}}}function r_(n,e,t){Af(0);let i=Ue(null);try{e(n,t)}finally{Ue(i)}}function YC(n,e,t){if(sv(e)){let i=Ue(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ue(i)}}}var Qi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Qi||{});var Of;function l3(){if(Of===void 0&&(Of=null,mr.trustedTypes))try{Of=mr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Of}function yT(n){return l3()?.createScriptURL(n)||n}var Jf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${gf})`}};function xl(n){return n instanceof Jf?n.changingThisBreaksApplicationSecurity:n}function vp(n,e){let t=QC(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${gf})`)}return t===e}function QC(n){return n instanceof Jf&&n.getTypeName()||null}var c3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function L_(n){return n=String(n),n.match(c3)?n:"unsafe:"+n}var u3=/^>|^->|<!--|-->|--!>|<!-$/g,d3=/(<|>)/g,h3="\u200B$1\u200B";function f3(n){return n.replace(u3,e=>e.replace(d3,h3))}function JC(n,e){return n.createText(e)}function p3(n,e,t){n.setValue(e,t)}function ZC(n,e){return n.createComment(f3(e))}function V_(n,e,t){return n.createElement(e,t)}function Zf(n,e,t,i,r){n.insertBefore(e,t,i,r)}function XC(n,e,t){n.appendChild(e,t)}function vT(n,e,t,i,r){i!==null?Zf(n,e,t,i,r):XC(n,e,t)}function U_(n,e,t,i){n.removeChild(null,e,t,i)}function eD(n){n.textContent=""}function g3(n,e,t){n.setAttribute(e,"style",t)}function m3(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function tD(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&RF(n,e,i),r!==null&&m3(n,e,r),o!==null&&g3(n,e,o)}var Au=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Au||{});function Zi(n){let e=iD();return e?e.sanitize(Au.URL,n)||"":vp(n,"URL")?xl(n):L_(Wi(n))}function nD(n){let e=iD();if(e)return yT(e.sanitize(Au.RESOURCE_URL,n)||"");if(vp(n,"ResourceURL"))return yT(xl(n));throw new ge(904,!1)}var y3=new Set(["embed","frame","iframe","media","script"]),v3=new Set(["base","link","script"]);function _3(n,e){return e==="src"&&y3.has(n)||e==="href"&&v3.has(n)||e==="xlink:href"&&n==="script"?nD:Zi}function B_(n,e,t){return _3(e,t)(n)}function iD(){let n=Be();return n&&n[Er].sanitizer}function fa(n){return n.ownerDocument.defaultView}function rD(n){return n.ownerDocument.body}function oD(n){return n instanceof Function?n():n}function E3(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var sD="ng-template";function b3(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&E3(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(j_(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function j_(n){return n.type===4&&n.value!==sD}function w3(n,e,t){let i=n.type===4&&!t?sD:n.value;return e===i}function x3(n,e,t){let i=4,r=n.attrs,o=r!==null?T3(r):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Ki(i)&&!Ki(l))return!1;if(s&&Ki(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!w3(n,l,t)||l===""&&e.length===1){if(Ki(i))return!1;s=!0}}else if(i&8){if(r===null||!b3(n,r,l,t)){if(Ki(i))return!1;s=!0}}else{let c=e[++a],d=S3(l,r,j_(n),t);if(d===-1){if(Ki(i))return!1;s=!0;continue}if(c!==""){let h;if(d>o?h="":h=r[d+1].toLowerCase(),i&2&&c!==h){if(Ki(i))return!1;s=!0}}}}return Ki(i)||s}function Ki(n){return(n&1)===0}function S3(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return C3(e,n)}function I3(n,e,t=!1){for(let i=0;i<e.length;i++)if(x3(n,e[i],t))return!0;return!1}function T3(n){for(let e=0;e<n.length;e++){let t=n[e];if(XT(t))return e}return n.length}function C3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function _T(n,e){return n?":not("+e.trim()+")":e}function D3(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!Ki(s)&&(e+=_T(o,r),r=""),i=s,o=o||!Ki(i);t++}return r!==""&&(e+=_T(o,r)),e}function A3(n){return n.map(D3).join(",")}function M3(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!Ki(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var xn={};function H_(n,e,t,i,r,o,s,a,l,c,d){let h=ut+i,f=h+r,g=R3(h,f),w=typeof c=="function"?c():c;return g[Ae]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:w,incompleteFirstPass:!1,ssrId:d}}function R3(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:xn);return t}function P3(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=H_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function $_(n,e,t,i,r,o,s,a,l,c,d){let h=e.blueprint.slice();return h[Kn]=r,h[$e]=i|4|128|8|64|1024,(c!==null||n&&n[$e]&2048)&&(h[$e]|=2048),cv(h),h[Xt]=h[Qs]=n,h[en]=t,h[Er]=s||n&&n[Er],h[xt]=a||n&&n[xt],h[li]=l||n&&n[li]||null,h[Ci]=o,h[no]=qF(),h[Zn]=d,h[ov]=c,h[Yn]=e.type==2?n[Yn]:h,h}function N3(n,e,t){let i=Di(e,n),r=P3(t),o=n[Er].rendererFactory,s=G_(n,$_(n,r,null,aD(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function aD(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function lD(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function G_(n,e){return n[ll]?n[rv][Ti]=e:n[ll]=e,n[rv]=e,e}function m(n=1){cD(tn(),Be(),Ri()+n,!1)}function cD(n,e,t,i){if(!i)if((e[$e]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Lf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Vf(e,o,0,t)}Xo(t)}var _p=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(_p||{});function o_(n,e,t,i){let r=Ue(null);try{let[o,s,a]=n.inputs[t],l=null;(s&_p.SignalBased)!==0&&(l=e[o][Qn]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,l,i,t,o):qT(e,l,o,i)}finally{Ue(r)}}var Tr=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Tr||{}),k3;function z_(n,e){return k3(n,e)}var la=new Set,Ep=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Ep||{}),ns=new Ee(""),ET=new Set;function gi(n){ET.has(n)||(ET.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var W_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=de({token:n,providedIn:"root",factory:()=>new n})}return n})(),uD=[0,1,2,3],dD=(()=>{class n{ngZone=q(yn);scheduler=q(Ko);errorHandler=q(gr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){q(ns,{optional:!0})}execute(){let t=this.sequences.size>0;t&&pt(at.AfterRenderHooksStart),this.executing=!0;for(let i of uD)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&pt(at.AfterRenderHooksEnd)}register(t){let{view:i}=t;i!==void 0?((i[Zs]??=[]).push(t),cl(i),i[$e]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(Ep.AFTER_NEXT_RENDER,t):t()}static \u0275prov=de({token:n,providedIn:"root",factory:()=>new n})}return n})(),Xf=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Zs];e&&(this.view[Zs]=e.filter(t=>t!==this))}};function Mu(n,e){let t=e?.injector??q(qn);return gi("NgAfterNextRender"),F3(n,t,e,!0)}function O3(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function F3(n,e,t,i){let r=e.get(W_);r.impl??=e.get(dD);let o=e.get(ns,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Xn):null,a=e.get(Nf,null,{optional:!0}),l=new Xf(r.impl,O3(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(l),l}var hD=new Ee("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:q(Kt)})});function fD(n,e,t){let i=n.get(hD);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function L3(n,e){let t=n.get(hD);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function V3(n,e){for(let[t,i]of e)fD(n,i.animateFns)}function bT(n,e,t,i){let r=n?.[Xs]?.enter;e!==null&&r&&r.has(t.index)&&V3(i,r)}function dl(n,e,t,i,r,o,s,a){if(r!=null){let l,c=!1;di(r)?l=r:ui(r)&&(c=!0,r=r[Kn]);let d=hi(r);n===0&&i!==null?(bT(a,i,o,t),s==null?XC(e,i,d):Zf(e,i,d,s||null,!0)):n===1&&i!==null?(bT(a,i,o,t),Zf(e,i,d,s||null,!0)):n===2?wT(a,o,t,h=>{U_(e,d,c,h)}):n===3&&wT(a,o,t,()=>{e.destroyNode(d)}),l!=null&&J3(e,n,t,l,o,i,s)}}function U3(n,e){pD(n,e),e[Kn]=null,e[Ci]=null}function B3(n,e,t,i,r,o){i[Kn]=r,i[Ci]=e,wp(n,i,t,1,r,o)}function pD(n,e){e[Er].changeDetectionScheduler?.notify(9),wp(n,e,e[xt],2,null,null)}function j3(n){let e=n[ll];if(!e)return Bv(n[Ae],n);for(;e;){let t=null;if(ui(e))t=e[ll];else{let i=e[Gt];i&&(t=i)}if(!t){for(;e&&!e[Ti]&&e!==n;)ui(e)&&Bv(e[Ae],e),e=e[Xt];e===null&&(e=n),ui(e)&&Bv(e[Ae],e),t=e&&e[Ti]}e=t}}function q_(n,e){let t=n[ea],i=t.indexOf(e);t.splice(i,1)}function bp(n,e){if(Zo(e))return;let t=e[xt];t.destroyNode&&wp(n,e,t,3,null,null),j3(e)}function Bv(n,e){if(Zo(e))return;let t=Ue(null);try{e[$e]&=-129,e[$e]|=256,e[ci]&&Gc(e[ci]),G3(n,e),$3(n,e),e[Ae].type===1&&e[xt].destroy();let i=e[Jo];if(i!==null&&di(e[Xt])){i!==e[Xt]&&q_(i,e);let r=e[br];r!==null&&r.detachView(n)}e_(e)}finally{Ue(t)}}function wT(n,e,t,i){let r=n?.[Xs];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&la.add(n[no]),fD(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let c=s.animateFns[l],{promise:d}=c();a.push(d)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),H3(n,i)}else n&&la.delete(n[no]),i(!1)},r)}function H3(n,e){let t=n[Xs]?.running;if(t){t.then(()=>{n[Xs].running=void 0,la.delete(n[no]),e(!0)});return}e(!1)}function $3(n,e){let t=n.cleanup,i=e[al];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[al]=null);let r=e[Zr];if(r!==null){e[Zr]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[au];if(o!==null){e[au]=null;for(let s of o)s.destroy()}}function G3(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof aa)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],l=o[s+1];pt(at.LifecycleHookStart,a,l);try{l.call(a)}finally{pt(at.LifecycleHookEnd,a,l)}}else{pt(at.LifecycleHookStart,r,o);try{o.call(r)}finally{pt(at.LifecycleHookEnd,r,o)}}}}}function z3(n,e,t){return W3(n,e.parent,t)}function W3(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Kn];if(io(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Qi.None||r===Qi.Emulated)return null}return Di(i,t)}function q3(n,e,t){return Y3(n,e,t)}function K3(n,e,t){return n.type&40?Di(n,t):null}var Y3=K3,xT;function K_(n,e,t,i){let r=z3(n,i,e),o=e[xt],s=i.parent||e[Ci],a=q3(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)vT(o,r,t[l],a,!1);else vT(o,r,t,a,!1);xT!==void 0&&xT(o,i,e,t,r)}function yu(n,e){if(e!==null){let t=e.type;if(t&3)return Di(e,n);if(t&4)return s_(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return yu(n,i);{let r=n[e.index];return di(r)?s_(-1,r):hi(r)}}else{if(t&128)return yu(n,e.next);if(t&32)return z_(e,n)()||hi(n[e.index]);{let i=gD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=qo(n[Yn]);return yu(r,i)}else return yu(n,e.next)}}}return null}function gD(n,e){if(e!==null){let i=n[Yn][Ci],r=e.projection;return i.projection[r]}return null}function s_(n,e){let t=Gt+n+1;if(t<e.length){let i=e[t],r=i[Ae].firstChild;if(r!==null)return yu(i,r)}return e[wr]}function Y_(n,e,t,i,r,o,s){for(;t!=null;){let a=i[li];if(t.type===128){t=t.next;continue}let l=i[t.index],c=t.type;if(s&&e===0&&(l&&ml(hi(l),i),t.flags|=2),!gp(t))if(c&8)Y_(n,e,t.child,i,r,o,!1),dl(e,n,a,r,l,t,o,i);else if(c&32){let d=z_(t,i),h;for(;h=d();)dl(e,n,a,r,h,t,o,i);dl(e,n,a,r,l,t,o,i)}else c&16?Q3(n,e,i,t,r,o):dl(e,n,a,r,l,t,o,i);t=s?t.projectionNext:t.next}}function wp(n,e,t,i,r,o){Y_(t,i,n.firstChild,e,r,o,!1)}function Q3(n,e,t,i,r,o){let s=t[Yn],l=s[Ci].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];dl(e,n,t[li],r,d,i,o,t)}else{let c=l,d=s[Xt];Qf(i)&&(c.flags|=128),Y_(n,e,c,d,r,o,!0)}}function J3(n,e,t,i,r,o,s){let a=i[wr],l=hi(i);a!==l&&dl(e,n,t,o,a,r,s);for(let c=Gt;c<i.length;c++){let d=i[c];wp(d[Ae],d,n,e,o,a)}}function Z3(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:Tr.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Tr.Important),n.setStyle(t,i,r,o))}}function mD(n,e,t,i,r){let o=Ri(),s=i&2;try{Xo(-1),s&&e.length>ut&&cD(n,e,ut,!1);let a=s?at.TemplateUpdateStart:at.TemplateCreateStart;pt(a,r,t),t(i,r)}finally{Xo(o);let a=s?at.TemplateUpdateEnd:at.TemplateCreateEnd;pt(a,r,t)}}function Q_(n,e,t){sL(n,e,t),(t.flags&64)===64&&aL(n,e,t)}function xp(n,e,t=Di){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function X3(n,e,t,i){let o=i.get(R_,CC)||t===Qi.ShadowDom||t===Qi.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return eL(s),s}function eL(n){yD(n)}var yD=()=>null;function tL(n){dC(n)?eD(n):r3(n)}function vD(){yD=tL}function nL(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function iL(n,e,t,i,r,o){let s=e[Ae];if(Z_(n,s,e,t,i)){io(n)&&oL(e,n.index);return}n.type&3&&(t=nL(t)),rL(n,e,t,i,r,o)}function rL(n,e,t,i,r,o){if(n.type&3){let s=Di(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function oL(n,e){let t=Ai(e,n);t[$e]&16||(t[$e]|=64)}function sL(n,e,t){let i=t.directiveStart,r=t.directiveEnd;io(t)&&N3(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Kf(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],l=_u(e,n,s,t);if(ml(l,e),o!==null&&dL(e,s-i,l,a,t,o),xr(a)){let c=Ai(t.index,e);c[en]=_u(e,n,s,t)}}}function aL(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=QI();try{Xo(o);for(let a=i;a<r;a++){let l=n.data[a],c=e[a];Df(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&lL(l,c)}}finally{Xo(-1),Df(s)}}function lL(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function _D(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];I3(e,o.selectors,!1)&&(i??=[],xr(o)?i.unshift(o):i.push(o))}return i}function cL(n,e,t,i,r,o){let s=Di(n,e);uL(e[xt],s,o,n.value,t,i,r)}function uL(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?Wi(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function dL(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];o_(i,t,l,c)}}function ED(n,e,t,i,r){let o=ut+t,s=e[Ae],a=r(s,e,n,i,t);e[o]=a,ia(n,!0);let l=n.type===2;return l?(tD(e[xt],a,n),(HI()===0||cu(n))&&ml(a,e),$I()):ml(a,e),Pf()&&(!l||!gp(n))&&K_(s,e,a,n),n}function bD(n){let e=n;return Ev()?WI():(e=e.parent,ia(e,!1)),e}function J_(n,e){let t=n[li];if(!t)return;let i;try{i=t.get(fi,null)}catch{i=null}i?.(e)}function Z_(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],d=s[l+1],h=e.data[c];o_(h,t[c],d,r),a=!0}if(o)for(let l of o){let c=t[l],d=e.data[l];o_(d,c,i,r),a=!0}return a}function hL(n,e){let t=Ai(e,n),i=t[Ae];fL(i,t);let r=t[Kn];r!==null&&t[Zn]===null&&(t[Zn]=HC(r,t[li])),pt(at.ComponentStart);try{X_(i,t,t[en])}finally{pt(at.ComponentEnd,t[en])}}function fL(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function X_(n,e,t){Mf(e);try{let i=n.viewQuery;i!==null&&r_(1,i,t);let r=n.template;r!==null&&mD(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[br]?.finishViewCreation(n),n.staticContentQueries&&KC(n,e),n.staticViewQueries&&r_(2,n.viewQuery,t);let o=n.components;o!==null&&pL(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[$e]&=-5,Rf()}}function pL(n,e){for(let t=0;t<e.length;t++)hL(n,e[t])}function Ru(n,e,t,i){let r=Ue(null);try{let o=e.tView,a=n[$e]&4096?4096:16,l=$_(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),c=n[e.index];l[Jo]=c;let d=n[br];return d!==null&&(l[br]=d.createEmbeddedView(o)),X_(o,l,t),l}finally{Ue(r)}}function yl(n,e){return!e||e.firstChild===null||Qf(n)}function bu(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(hi(o)),di(o)&&wD(o,i);let s=t.type;if(s&8)bu(n,e,t.child,i);else if(s&32){let a=z_(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=gD(e,t);if(Array.isArray(a))i.push(...a);else{let l=qo(e[Yn]);bu(l[Ae],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function wD(n,e){for(let t=Gt;t<n.length;t++){let i=n[t],r=i[Ae].firstChild;r!==null&&bu(i[Ae],i,r,e)}n[wr]!==n[Kn]&&e.push(n[wr])}function xD(n){if(n[Zs]!==null){for(let e of n[Zs])e.impl.addSequence(e);n[Zs].length=0}}var SD=[];function gL(n){return n[ci]??mL(n)}function mL(n){let e=SD.pop()??Object.create(vL);return e.lView=n,e}function yL(n){n.lView[ci]!==n&&(n.lView=null,SD.push(n))}var vL=ce(F({},jc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{cl(n.lView)},consumerOnSignalRead(){this.lView[ci]=this}});function _L(n){let e=n[ci]??Object.create(EL);return e.lView=n,e}var EL=ce(F({},jc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=qo(n.lView);for(;e&&!ID(e[Ae]);)e=qo(e);e&&uv(e)},consumerOnSignalRead(){this.lView[ci]=this}});function ID(n){return n.type!==2}function TD(n){if(n[au]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[au])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[$e]&8192)}}var bL=100;function CD(n,e=0){let i=n[Er].rendererFactory,r=!1;r||i.begin?.();try{wL(n,e)}finally{r||i.end?.()}}function wL(n,e){let t=wv();try{xv(!0),a_(n,e);let i=0;for(;hu(n);){if(i===bL)throw new ge(103,!1);i++,a_(n,1)}}finally{xv(t)}}function xL(n,e,t,i){if(Zo(e))return;let r=e[$e],o=!1,s=!1;Mf(e);let a=!0,l=null,c=null;o||(ID(n)?(c=gL(e),l=$c(c)):Rh()===null?(a=!1,c=_L(e),l=$c(c)):e[ci]&&(Gc(e[ci]),e[ci]=null));try{cv(e),qI(n.bindingStartIndex),t!==null&&mD(n,e,t,2,i);let d=(r&3)===3;if(!o)if(d){let g=n.preOrderCheckHooks;g!==null&&Lf(e,g,null)}else{let g=n.preOrderHooks;g!==null&&Vf(e,g,0,null),Lv(e,0)}if(s||SL(e),TD(e),DD(e,0),n.contentQueries!==null&&KC(n,e),!o)if(d){let g=n.contentCheckHooks;g!==null&&Lf(e,g)}else{let g=n.contentHooks;g!==null&&Vf(e,g,1),Lv(e,1)}TL(n,e);let h=n.components;h!==null&&MD(e,h,0);let f=n.viewQuery;if(f!==null&&r_(2,f,i),!o)if(d){let g=n.viewCheckHooks;g!==null&&Lf(e,g)}else{let g=n.viewHooks;g!==null&&Vf(e,g,2),Lv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[If]){for(let g of e[If])g();e[If]=null}o||(xD(e),e[$e]&=-73)}catch(d){throw o||cl(e),d}finally{c!==null&&(Ph(c,l),a&&yL(c)),Rf()}}function DD(n,e){for(let t=pC(n);t!==null;t=gC(t))for(let i=Gt;i<t.length;i++){let r=t[i];AD(r,e)}}function SL(n){for(let e=pC(n);e!==null;e=gC(e)){if(!(e[$e]&2))continue;let t=e[ea];for(let i=0;i<t.length;i++){let r=t[i];uv(r)}}}function IL(n,e,t){pt(at.ComponentStart);let i=Ai(e,n);try{AD(i,t)}finally{pt(at.ComponentEnd,i[en])}}function AD(n,e){Tf(n)&&a_(n,e)}function a_(n,e){let i=n[Ae],r=n[$e],o=n[ci],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&Nh(o)),s||=!1,o&&(o.dirty=!1),n[$e]&=-9217,s)xL(i,n,i.template,n[en]);else if(r&8192){let a=Ue(null);try{TD(n),DD(n,1);let l=i.components;l!==null&&MD(n,l,1),xD(n)}finally{Ue(a)}}}function MD(n,e,t){for(let i=0;i<e.length;i++)IL(n,e[i],t)}function TL(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)Xo(~r);else{let o=r,s=t[++i],a=t[++i];YI(s,o);let l=e[o];pt(at.HostBindingsUpdateStart,l);try{a(2,l)}finally{pt(at.HostBindingsUpdateEnd,l)}}}}finally{Xo(-1)}}function Sp(n,e){let t=wv()?64:1088;for(n[Er].changeDetectionScheduler?.notify(e);n;){n[$e]|=t;let i=qo(n);if(ta(n)&&!i)return n;n=i}return null}function RD(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function PD(n,e){let t=Gt+e;if(t<n.length)return n[t]}function Pu(n,e,t,i=!0){let r=e[Ae];if(CL(r,e,n,t),i){let s=s_(t,n),a=e[xt],l=a.parentNode(n[wr]);l!==null&&B3(r,n[Ci],a,e,l,s)}let o=e[Zn];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function eE(n,e){let t=wu(n,e);return t!==void 0&&bp(t[Ae],t),t}function wu(n,e){if(n.length<=Gt)return;let t=Gt+e,i=n[t];if(i){let r=i[Jo];r!==null&&r!==n&&q_(r,i),e>0&&(n[t-1][Ti]=i[Ti]);let o=ru(n,Gt+e);U3(i[Ae],i);let s=o[br];s!==null&&s.detachView(o[Ae]),i[Xt]=null,i[Ti]=null,i[$e]&=-129}return i}function CL(n,e,t,i){let r=Gt+i,o=t.length;i>0&&(t[r-1][Ti]=e),i<o-Gt?(e[Ti]=t[r],Xy(t,Gt+i,e)):(t.push(e),e[Ti]=null),e[Xt]=t;let s=e[Jo];s!==null&&t!==s&&ND(s,e);let a=e[br];a!==null&&a.insertView(n),Cf(e),e[$e]|=128}function ND(n,e){let t=n[ea],i=e[Xt];if(ui(i))n[$e]|=2;else{let r=i[Xt][Yn];e[Yn]!==r&&(n[$e]|=2)}t===null?n[ea]=[e]:t.push(e)}var es=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Ae];return bu(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[en]}set context(e){this._lView[en]=e}get destroyed(){return Zo(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Xt];if(di(e)){let t=e[lu],i=t?t.indexOf(this):-1;i>-1&&(wu(e,i),ru(t,i))}this._attachedToViewContainer=!1}bp(this._lView[Ae],this._lView)}onDestroy(e){dv(this._lView,e)}markForCheck(){Sp(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[$e]&=-129}reattach(){Cf(this._lView),this._lView[$e]|=128}detectChanges(){this._lView[$e]|=1024,CD(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=ta(this._lView),t=this._lView[Jo];t!==null&&!e&&q_(t,this._lView),pD(this._lView[Ae],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=e;let t=ta(this._lView),i=this._lView[Jo];i!==null&&!t&&ND(i,this._lView),Cf(this._lView)}};var ts=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=DL;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Ru(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new es(o)}}return n})();function DL(){return Ip(Un(),Be())}function Ip(n,e){return n.type&4?new ts(e,n,El(n,e)):null}function Sl(n,e,t,i,r){let o=n.data[e];if(o===null)o=AL(n,e,t,i,r),KI()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=zI();o.injectorIndex=s===null?-1:s.injectorIndex}return ia(o,!0),o}function AL(n,e,t,i,r){let o=_v(),s=Ev(),a=s?o:o&&o.parent,l=n.data[e]=RL(n,a,t,e,i,r);return ML(n,l,o,s),l}function ML(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function RL(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return mv()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var PL=new RegExp(`^(\\d+)*(${_C}|${vC})*(.*)`);function NL(n){let e=n.match(PL),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(let[l,c,d]of o.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(c,h)}return[s,...a]}function kL(n){return!n.prev&&n.parent?.type===8}function jv(n){return n.index-ut}function OL(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function Tp(n,e,t,i){let r=jv(i),o=OL(n,r);if(o===void 0){let s=n.data[xC];if(s?.[r])o=LL(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{let a=i.prev===null,l=i.prev??i.parent;if(kL(i)){let c=jv(i.parent);o=i_(n,c)}else{let c=Di(l,t);if(a)o=c.firstChild;else{let d=jv(l),h=i_(n,d);if(l.type===2&&h){let g=F_(n,d)+1;o=Cp(g,h)}else o=c.nextSibling}}}}return o}function Cp(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}function FL(n,e){let t=n;for(let i=0;i<e.length;i+=2){let r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case JF:t=t.firstChild;break;case ZF:t=t.nextSibling;break}}return t}function LL(n,e){let[t,...i]=NL(n),r;if(t===vC)r=e[Yn][Kn];else if(t===_C)r=rD(e[Yn][Kn]);else{let o=Number(t);r=hi(e[o+ut])}return FL(r,i)}var VL=!1;function kD(n){VL=n}function UL(n){let e=n[Zn];if(e){let{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){let r=n[xt];for(let o of i.values())BL(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function BL(n,e,t){for(let i of t.node.cases[t.case]){let r=e.get(i.index-ut);r&&U_(n,r,!1)}}function Dp(n){let e=n[qi]??[],i=n[Xt][xt],r=[];for(let o of e)o.data[SC]!==void 0?r.push(o):OD(o,i);n[qi]=r}function jL(n){let{lContainer:e}=n,t=e[qi];if(t===null)return;let r=e[Xt][xt];for(let o of t)OD(o,r)}function OD(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[Eu];for(;t<r;){let o=i.nextSibling;U_(e,i,!1),i=o,t++}}}function Ap(n){Dp(n);let e=n[Kn];ui(e)&&ep(e);for(let t=Gt;t<n.length;t++)ep(n[t])}function ep(n){UL(n);let e=n[Ae];for(let t=ut;t<e.bindingStartIndex;t++)if(di(n[t])){let i=n[t];Ap(i)}else ui(n[t])&&ep(n[t])}function tE(n){let e=n._views;for(let t of e){let i=$C(t);i!==null&&i[Kn]!==null&&(ui(i)?ep(i):Ap(i))}}function HL(n,e,t,i){n!==null&&(t.cleanup(e),Ap(n.lContainer),tE(i))}function $L(n,e){let t=[];for(let i of e)for(let r=0;r<(i[A_]??1);r++){let o={data:i,firstChild:null};i[Eu]>0&&(o.firstChild=n,n=Cp(i[Eu],n)),t.push(o)}return[n,t]}var FD=()=>null,LD=()=>null;function VD(){FD=GL,LD=zL}function GL(n,e){return BD(n,e)?n[qi].shift():(Dp(n),null)}function tp(n,e){return FD(n,e)}function zL(n,e,t){if(e.tView.ssrId===null)return null;let i=tp(n,e.tView.ssrId);return t[Ae].firstUpdatePass&&i===null&&WL(t,e),i}function UD(n,e,t){return LD(n,e,t)}function WL(n,e){let t=e;for(;t;){if(ST(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(ST(n,t))return;t=t.next}}function BD(n,e){let t=n[qi];return!e||t===null||t.length===0?!1:t[0].data[wC]===e}function ST(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let i=n[e.index];return di(i)&&BD(i,t)?(Dp(i),!0):!1}var jD=class{},Mp=class{},l_=class{resolveComponentFactory(e){throw new ge(917,!1)}},Nu=class{static NULL=new l_},ca=class{},is=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>qL()}return n})();function qL(){let n=Be(),e=Un(),t=Ai(e.index,n);return(ui(t)?t:n)[xt]}var HD=(()=>{class n{static \u0275prov=de({token:n,providedIn:"root",factory:()=>null})}return n})();var jf={},fl=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,jf,i);return r!==jf||t===jf?r:this.parentInjector.get(e,t,i)}};function np(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=mf(r,a);else if(o==2){let l=a,c=e[++s];i=mf(i,l+": "+c+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function he(n,e=0){let t=Be();if(t===null)return Re(n,e);let i=Un();return sC(i,t,On(n),e)}function $D(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,l=null,c=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,l,c]=d.resolveHostDirectives(s);break}QL(n,e,t,a,o,l,c)}o!==null&&i!==null&&KL(t,i,o)}function KL(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new ge(-301,!1);i.push(e[r],o)}}function YL(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function QL(n,e,t,i,r,o,s){let a=i.length,l=null;for(let f=0;f<a;f++){let g=i[f];l===null&&xr(g)&&(l=g,YL(n,t,f)),Zv(Kf(t,e),n,g.type)}nV(t,n.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let f=0;f<a;f++){let g=i[f];g.providersResolver&&g.providersResolver(g)}let c=!1,d=!1,h=lD(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let f=0;f<a;f++){let g=i[f];if(t.mergedAttrs=gl(t.mergedAttrs,g.hostAttrs),ZL(n,t,e,h,g),tV(h,g,r),s!==null&&s.has(g)){let[S,P]=s.get(g);t.directiveToIndex.set(g.type,[h,S+t.directiveStart,P+t.directiveStart])}else(o===null||!o.has(g))&&t.directiveToIndex.set(g.type,h);g.contentQueries!==null&&(t.flags|=4),(g.hostBindings!==null||g.hostAttrs!==null||g.hostVars!==0)&&(t.flags|=64);let w=g.type.prototype;!c&&(w.ngOnChanges||w.ngOnInit||w.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!d&&(w.ngOnChanges||w.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}JL(n,t,o)}function JL(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))IT(0,e,r,i),IT(1,e,r,i),CT(e,i,!1);else{let o=t.get(r);TT(0,e,o,i),TT(1,e,o,i),CT(e,i,!0)}}}function IT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),GD(e,o)}}function TT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),GD(e,s)}}function GD(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function CT(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||j_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&r.hasOwnProperty(l)){let c=r[l];for(let d of c)if(d===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let c=o[l];for(let d=0;d<c.length;d+=2)if(c[d]===e){s??=[],s.push(c[d+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function ZL(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Wo(r.type,!0)),s=new aa(o,xr(r),he,null);n.blueprint[i]=s,t[i]=s,XL(n,e,i,lD(n,t,r.hostVars,xn),r)}function XL(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;eV(s)!=a&&s.push(a),s.push(t,i,o)}}function eV(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function tV(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;xr(e)&&(t[""]=n)}}function nV(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function zD(n,e,t,i,r,o,s,a){let l=e[Ae],c=l.consts,d=Mi(c,s),h=Sl(l,n,t,i,d);return o&&$D(l,e,h,Mi(c,a),r),h.mergedAttrs=gl(h.mergedAttrs,h.attrs),h.attrs!==null&&np(h,h.attrs,!1),h.mergedAttrs!==null&&np(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function WD(n,e){JT(n,e),sv(e)&&n.queries.elementEnd(e)}function iV(n,e,t,i,r,o){let s=e.consts,a=Mi(s,r),l=Sl(e,n,t,i,a);if(l.mergedAttrs=gl(l.mergedAttrs,l.attrs),o!=null){let c=Mi(s,o);l.localNames=[];for(let d=0;d<c.length;d+=2)l.localNames.push(c[d],-1)}return l.attrs!==null&&np(l,l.attrs,!1),l.mergedAttrs!==null&&np(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function nE(n){return KD(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function qD(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function KD(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Rp(n,e,t){return n[e]=t}function rV(n,e){return n[e]}function Pi(n,e,t){if(t===xn)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function iE(n,e,t,i){let r=Pi(n,e,t);return Pi(n,e+1,i)||r}function YD(n,e,t,i,r){let o=iE(n,e,t,i);return Pi(n,e+2,r)||o}function Hf(n,e,t){return function i(r){let o=io(n)?Ai(n.index,e):e;Sp(o,5);let s=e[en],a=DT(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=DT(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function DT(n,e,t,i){let r=Ue(null);try{return pt(at.OutputStart,e,t),t(i)!==!1}catch(o){return J_(n,o),!1}finally{pt(at.OutputEnd,e,t),Ue(r)}}function QD(n,e,t,i,r,o,s,a){let l=cu(n),c=!1,d=null;if(!i&&l&&(d=sV(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,c=!0}else{let h=Di(n,t),f=i?i(h):h;XF(t,f,o,a);let g=r.listen(f,o,a);if(!oV(o)){let w=i?S=>i(hi(S[n.index])):n.index;JD(w,e,t,o,a,g,!1)}}return c}function oV(n){return n.startsWith("animation")||n.startsWith("transition")}function sV(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[al],l=r[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function JD(n,e,t,i,r,o,s){let a=e.firstCreatePass?fv(e):null,l=hv(t),c=l.length;l.push(r,o),a&&a.push(i,n,c,(c+1)*(s?-1:1))}function AT(n,e,t,i,r,o){let s=e[t],a=e[Ae],c=a.data[t].outputs[i],h=s[c].subscribe(o);JD(n.index,a,e,r,o,h,!0)}var c_=Symbol("BINDING");var ip=class extends Nu{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=to(e);return new vl(t,this.ngModule)}};function aV(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&_p.SignalBased)!==0};return r&&(o.transform=r),o})}function lV(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function cV(n,e,t){let i=e instanceof Kt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new fl(t,i):t}function uV(n){let e=n.get(ca,null);if(e===null)throw new ge(407,!1);let t=n.get(HD,null),i=n.get(Ko,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function dV(n,e){let t=ZD(n);return V_(e,t,t==="svg"?av:t==="math"?FI:null)}function ZD(n){return(n.selectors[0][0]||"div").toLowerCase()}var vl=class extends Mp{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=aV(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=lV(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=A3(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){pt(at.DynamicComponentStart);let a=Ue(null);try{let l=this.componentDef,c=hV(i,l,s,o),d=cV(l,r||this.ngModule,e),h=uV(d),f=h.rendererFactory.createRenderer(null,l),g=i?X3(f,i,l.encapsulation,d):dV(l,f),w=s?.some(MT)||o?.some(L=>typeof L!="function"&&L.bindings.some(MT)),S=$_(null,c,null,512|aD(l),null,null,h,f,d,null,HC(g,d,!0));S[ut]=g,Mf(S);let P=null;try{let L=zD(ut,S,2,"#host",()=>c.directiveRegistry,!0,0);tD(f,g,L),ml(g,S),Q_(c,S,L),YC(c,L,S),WD(c,L),t!==void 0&&pV(L,this.ngContentSelectors,t),P=Ai(L.index,S),S[en]=P[en],X_(c,S,null)}catch(L){throw P!==null&&e_(P),e_(S),L}finally{pt(at.DynamicComponentEnd),Rf()}return new rp(this.componentType,S,!!w)}finally{Ue(a)}}};function hV(n,e,t,i){let r=n?["ng-version","21.1.1"]:M3(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[c_].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(i)for(let d=0;d<i.length;d++){let h=i[d];if(typeof h!="function")for(let f of h.bindings){a+=f[c_].requiredVars;let g=d+1;f.create&&(f.targetIdx=g,(o??=[]).push(f)),f.update&&(f.targetIdx=g,(s??=[]).push(f))}}let l=[e];if(i)for(let d of i){let h=typeof d=="function"?d:d.type,f=vf(h);l.push(f)}return H_(0,null,fV(o,s),1,a,l,null,null,null,[r],null)}function fV(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function MT(n){let e=n[c_].kind;return e==="input"||e==="twoWay"}var rp=class extends jD{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=na(t[Ae],ut),this.location=El(this._tNode,t),this.instance=Ai(this._tNode.index,t)[en],this.hostView=this.changeDetectorRef=new es(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=Z_(i,r[Ae],r,e,t);this.previousInputValues.set(e,t);let s=Ai(i.index,r);Sp(s,1)}get injector(){return new sa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function pV(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var so=(()=>{class n{static __NG_ELEMENT_ID__=gV}return n})();function gV(){let n=Un();return eA(n,Be())}var mV=so,XD=class extends mV{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return El(this._hostTNode,this._hostLView)}get injector(){return new sa(this._hostTNode,this._hostLView)}get parentInjector(){let e=T_(this._hostTNode,this._hostLView);if(eC(e)){let t=Wf(e,this._hostLView),i=zf(e),r=t[Ae].data[i+8];return new sa(r,t)}else return new sa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=RT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Gt}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=tp(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,yl(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let l=e&&!xF(e),c;if(l)c=t;else{let P=t||{};c=P.index,i=P.injector,r=P.projectableNodes,o=P.environmentInjector||P.ngModuleRef,s=P.directives,a=P.bindings}let d=l?e:new vl(to(e)),h=i||this.parentInjector;if(!o&&d.ngModule==null){let L=(l?h:this.parentInjector).get(Kt,null);L&&(o=L)}let f=to(d.componentType??{}),g=tp(this._lContainer,f?.id??null),w=g?.firstChild??null,S=d.create(h,r,w,o,s,a);return this.insertImpl(S.hostView,c,yl(this._hostTNode,g)),S}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(VI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Xt],c=new XD(l,l[Ci],l[Xt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return Pu(s,r,o,i),e.attachToViewContainerRef(),Xy(Hv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=RT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=wu(this._lContainer,t);i&&(ru(Hv(this._lContainer),t),bp(i[Ae],i))}detach(e){let t=this._adjustIndex(e,-1),i=wu(this._lContainer,t);return i&&ru(Hv(this._lContainer),t)!=null?new es(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function RT(n){return n[lu]}function Hv(n){return n[lu]||(n[lu]=[])}function eA(n,e){let t,i=e[n.index];return di(i)?t=i:(t=RD(i,e,null,n),e[n.index]=t,G_(e,t)),tA(t,e,n,i),new XD(t,n,e)}function yV(n,e){let t=n[xt],i=t.createComment(""),r=Di(e,n),o=t.parentNode(r);return Zf(t,o,i,t.nextSibling(r),!1),i}var tA=nA,rE=()=>!1;function vV(n,e,t){return rE(n,e,t)}function nA(n,e,t,i){if(n[wr])return;let r;t.type&8?r=hi(i):r=yV(e,t),n[wr]=r}function _V(n,e,t){if(n[wr]&&n[qi])return!0;let i=t[Zn],r=e.index-ut;if(!i||hC(e)||WC(i,r))return!1;let s=i_(i,r),a=i.data[fp]?.[r],[l,c]=$L(s,a);return n[wr]=l,n[qi]=c,!0}function EV(n,e,t,i){rE(n,t,e)||nA(n,e,t,i)}function iA(){tA=EV,rE=_V}var u_=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},d_=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)oE(e,t).matches!==null&&this.queries[t].setDirty()}},h_=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=DV(e):this.predicate=e}},f_=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},p_=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,bV(t,o)),this.matchTNodeWithReadOption(e,t,Uf(t,e,o,!1,!1))}else i===ts?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Uf(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Ni||r===so||r===ts&&t.type&4)this.addMatch(t.index,-2);else{let o=Uf(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function bV(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function wV(n,e){return n.type&11?El(n,e):n.type&4?Ip(n,e):null}function xV(n,e,t,i){return t===-1?wV(e,n):t===-2?SV(n,e,i):_u(n,n[Ae],t,e)}function SV(n,e,t){if(t===Ni)return El(e,n);if(t===ts)return Ip(e,n);if(t===so)return eA(e,n)}function rA(n,e,t,i){let r=e[br].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let d=o[c];a.push(xV(e,d,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function g_(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=rA(n,e,r,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)i.push(s[a/2]);else{let c=o[a+1],d=e[-l];for(let h=Gt;h<d.length;h++){let f=d[h];f[Jo]===f[Xt]&&g_(f[Ae],f,c,i)}if(d[ea]!==null){let h=d[ea];for(let f=0;f<h.length;f++){let g=h[f];g_(g[Ae],g,c,i)}}}}}return i}function IV(n,e){return n[br].queries[e].queryList}function TV(n,e,t){let i=new Yf((t&4)===4);return jI(n,e,i,i.destroy),(e[br]??=new d_).queries.push(new u_(i))-1}function CV(n,e,t){let i=tn();return i.firstCreatePass&&(AV(i,new h_(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),TV(i,Be(),e)}function DV(n){return n.split(",").map(e=>e.trim())}function AV(n,e,t){n.queries===null&&(n.queries=new f_),n.queries.track(new p_(e,t))}function oE(n,e){return n.queries.getByIndex(e)}function MV(n,e){let t=n[Ae],i=oE(t,e);return i.crossesNgTemplate?g_(t,n,e,[]):rA(t,n,i,e)}var ua=class{},Pp=class{};var op=class extends ua{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new ip(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=Yy(e);this._bootstrapComponents=oD(o.bootstrap),this._r3Injector=Mv(e,t,[{provide:ua,useValue:this},{provide:Nu,useValue:this.componentFactoryResolver},...i],Xr(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},sp=class extends Pp{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new op(this.moduleType,e,[])}};var xu=class extends ua{injector;componentFactoryResolver=new ip(this);instance=null;constructor(e){super();let t=new Ks([...e.providers,{provide:ua,useValue:this},{provide:Nu,useValue:this.componentFactoryResolver}],e.parent||su(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Il(n,e,t=null){return new xu({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var RV=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=Sf(!1,t.type),r=i.length>0?Il([i],this._injector,""):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=de({token:n,providedIn:"environment",factory:()=>new n(Re(Kt))})}return n})();function St(n){return Iu(()=>{let e=oA(n),t=ce(F({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===C_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(RV).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Qi.Emulated,styles:n.styles||Wn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&gi("NgStandalone"),sA(t);let i=n.dependencies;return t.directiveDefs=PT(i,PV),t.pipeDefs=PT(i,Qy),t.id=OV(t),t})}function PV(n){return to(n)||vf(n)}function ao(n){return Iu(()=>({type:n.type,bootstrap:n.bootstrap||Wn,declarations:n.declarations||Wn,imports:n.imports||Wn,exports:n.exports||Wn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function NV(n,e){if(n==null)return Qo;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=_p.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function kV(n){if(n==null)return Qo;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function vn(n){return Iu(()=>{let e=oA(n);return sA(e),e})}function Np(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function oA(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Qo,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Wn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:NV(n.inputs,e),outputs:kV(n.outputs),debugInfo:null}}function sA(n){n.features?.forEach(e=>e(n))}function PT(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function OV(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function FV(n){return Object.getPrototypeOf(n.prototype).constructor}function Dr(n){let e=FV(n.type),t=!0,i=[n];for(;e;){let r;if(xr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ge(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=$v(n.inputs),s.declaredInputs=$v(n.declaredInputs),s.outputs=$v(n.outputs);let a=r.hostBindings;a&&jV(n,a);let l=r.viewQuery,c=r.contentQueries;if(l&&UV(n,l),c&&BV(n,c),LV(n,r),bI(n.outputs,r.outputs),xr(r)&&r.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Dr&&(t=!1)}}e=Object.getPrototypeOf(e)}VV(i)}function LV(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function VV(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=gl(r.hostAttrs,t=gl(t,r.hostAttrs))}}function $v(n){return n===Qo?{}:n===Wn?[]:n}function UV(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function BV(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function jV(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function aA(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=gl(n.mergedAttrs,n.attrs);let d=n.tView=H_(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),ia(n,!1);let l=lA(t,e,n,i);Pf()&&K_(t,e,l,n),ml(l,e);let c=RD(l,e,l,n);e[i+ut]=c,G_(e,c),vV(c,n,e)}function HV(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,f;return e.firstCreatePass?(f=Sl(e,h,4,s||null,a||null),gv()&&$D(e,n,f,Mi(e.consts,c),_D),JT(e,f)):f=e.data[h],aA(f,n,e,t,i,r,o,l),cu(f)&&Q_(e,n,f),c!=null&&xp(n,f,d),f}function ap(n,e,t,i,r,o,s,a,l,c,d){let h=t+ut,f;if(e.firstCreatePass){if(f=Sl(e,h,4,s||null,a||null),c!=null){let g=Mi(e.consts,c);f.localNames=[];for(let w=0;w<g.length;w+=2)f.localNames.push(g[w],-1)}}else f=e.data[h];return aA(f,n,e,t,i,r,o,l),c!=null&&xp(n,f,d),f}function Qt(n,e,t,i,r,o,s,a){let l=Be(),c=tn(),d=Mi(c.consts,o);return HV(l,c,n,e,t,i,r,d,void 0,s,a),Qt}var lA=cA;function cA(n,e,t,i){return ro(!0),e[xt].createComment("")}function $V(n,e,t,i){let r=!yp(e,t);ro(r);let o=e[Zn]?.data[bC]?.[i]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),r)return cA(n,e);let s=e[Zn],a=Tp(s,n,e,t);mp(s,i,a);let l=F_(s,i);return Cp(l,a)}function uA(){lA=$V}var pi=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(pi||{}),NT=0,GV=1,dn=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(dn||{});var zV=0,ku=1;var WV=4,qV=5;var KV=7,pl=8,YV=9,sE=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(sE||{});function $f(n,e){let t=JV(n),i=e[t];if(i!==null){for(let r of i)r();e[t]=null}}function QV(n){$f(1,n),$f(0,n),$f(2,n)}function JV(n){let e=WV;return n===1?e=qV:n===2&&(e=YV),e}function dA(n){return n+1}function Tl(n,e){let t=n[Ae],i=dA(e.index);return n[i]}function Ou(n,e){let t=dA(e.index);return n.data[t]}function ZV(n,e,t){let i=e[Ae],r=Ou(i,t);switch(n){case dn.Complete:return r.primaryTmplIndex;case dn.Loading:return r.loadingTmplIndex;case dn.Error:return r.errorTmplIndex;case dn.Placeholder:return r.placeholderTmplIndex;default:return null}}function kT(n,e){return e===dn.Placeholder?n.placeholderBlockConfig?.[NT]??null:e===dn.Loading?n.loadingBlockConfig?.[NT]??null:null}function XV(n){return n.loadingBlockConfig?.[GV]??null}function OT(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let i of e)t.add(i);return n.length===t.size?n:Array.from(t)}function e5(n,e){let t=e.primaryTmplIndex+ut;return na(n,t)}var t5=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,i,r,o){if(!this.cachedInjectors.has(t)){let s=r.length>0?Il(r,i,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=de({token:n,providedIn:"environment",factory:()=>new n})}return n})();var hA=new Ee("");function Gv(n,e,t){return n.get(t5).getOrCreateInjector(e,n,t,"")}function n5(n,e,t){if(n instanceof fl){let r=n.injector,o=n.parentInjector,s=Gv(o,e,t);return new fl(r,s)}let i=n.get(Kt);if(i!==n){let r=Gv(i,e,t);return new fl(n,r)}return Gv(n,e,t)}function oa(n,e,t,i=!1){let r=t[Xt],o=r[Ae];if(Zo(r))return;let s=Tl(r,e),a=s[ku],l=s[KV];if(!(l!==null&&n<l)&&FT(a,n)&&FT(s[zV]??-1,n)){let c=Ou(o,e),h=!i&&!0&&(XV(c)!==null||kT(c,dn.Loading)!==null||kT(c,dn.Placeholder))?o5:r5;try{h(n,s,t,e,r)}catch(f){J_(r,f)}}}function i5(n,e){let t=n[qi]?.findIndex(r=>r.data[IC]===e[ku])??-1;return{dehydratedView:t>-1?n[qi][t]:null,dehydratedViewIx:t}}function r5(n,e,t,i,r){pt(at.DeferBlockStateStart);let o=ZV(n,r,i);if(o!==null){e[ku]=n;let s=r[Ae],a=o+ut,l=na(s,a),c=0;eE(t,c);let d;if(n===dn.Complete){let w=Ou(s,i),S=w.providers;S&&S.length>0&&(d=n5(r[li],w,S))}let{dehydratedView:h,dehydratedViewIx:f}=i5(t,e),g=Ru(r,l,null,{injector:d,dehydratedView:h});if(Pu(t,g,c,yl(l,h)),Sp(g,2),f>-1&&t[qi]?.splice(f,1),(n===dn.Complete||n===dn.Error)&&Array.isArray(e[pl])){for(let w of e[pl])w();e[pl]=null}}pt(at.DeferBlockStateEnd)}function FT(n,e){return n<e}function LT(n,e,t){n.loadingPromise.then(()=>{n.loadingState===pi.COMPLETE?oa(dn.Complete,e,t):n.loadingState===pi.FAILED&&oa(dn.Error,e,t)})}var o5=null;var kp=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var aE=new Ee("");function rs(n){return!!n&&typeof n.then=="function"}function lE(n){return!!n&&typeof n.subscribe=="function"}var fA=new Ee("");var cE=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=q(fA,{optional:!0})??[];injector=q(qn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Fn(this.injector,r);if(rs(o))t.push(o);else if(lE(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),os=new Ee("");function pA(){uy(()=>{let n="";throw new ge(600,n)})}function gA(n){return n.isBoundToModule}var s5=10;var ei=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=q(fi);afterRenderManager=q(W_);zonelessEnabled=q(pu);rootEffectScheduler=q(Fv);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new jt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=q(Sr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(yt(t=>!t))}constructor(){q(ns,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=q(Kt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=qn.NULL){return this._injector.get(yn).run(()=>{pt(at.BootstrapComponentStart);let s=t instanceof Mp;if(!this._injector.get(cE).done){let w="";throw new ge(405,w)}let l;s?l=t:l=this._injector.get(Nu).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let c=gA(l)?void 0:this._injector.get(ua),d=i||l.selector,h=l.create(r,[],d,c),f=h.location.nativeElement,g=h.injector.get(aE,null);return g?.registerApplication(f),h.onDestroy(()=>{this.detachView(h.hostView),vu(this.components,h),g?.unregisterApplication(f)}),this._loadComponent(h),pt(at.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){pt(at.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(Ep.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw pt(at.ChangeDetectionEnd),new ge(101,!1);let t=Ue(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Ue(t),this.afterTick.next(),pt(at.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ca,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<s5;){pt(at.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{pt(at.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!hu(r))continue;let o=i&&!this.zonelessEnabled?0:1;CD(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>hu(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;vu(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(os,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>vu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ge(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function vu(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function uE(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}function mA(n,e,t){let i=e[li],r=e[Ae];if(n.loadingState!==pi.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=Tl(e,t),s=e5(r,n);n.loadingState=pi.IN_PROGRESS,$f(1,o);let a=n.dependencyResolverFn,l=i.get(gu).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(c=>{let d=!1,h=[],f=[];for(let g of c)if(g.status==="fulfilled"){let w=g.value,S=to(w)||vf(w);if(S)h.push(S);else{let P=Qy(w);P&&f.push(P)}}else{d=!0;break}if(d){if(n.loadingState=pi.FAILED,n.errorTmplIndex===null){let w=new ge(-750,!1);J_(e,w)}}else{n.loadingState=pi.COMPLETE;let g=s.tView;if(h.length>0){g.directiveRegistry=OT(g.directiveRegistry,h);let w=h.map(P=>P.type),S=Sf(!1,...w);n.providers=S}f.length>0&&(g.pipeRegistry=OT(g.pipeRegistry,f))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,l()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=pi.COMPLETE,l()}),n.loadingPromise)}function a5(n,e){return e[li].get(hA,null,{optional:!0})?.behavior!==sE.Manual}function l5(n,e,t){let i=e[Ae],r=e[t.index];if(!a5(n,e))return;let o=Tl(e,t),s=Ou(i,t);switch(QV(o),s.loadingState){case pi.NOT_STARTED:oa(dn.Loading,t,r),mA(s,e,t),s.loadingState===pi.IN_PROGRESS&&LT(s,t,r);break;case pi.IN_PROGRESS:oa(dn.Loading,t,r),LT(s,t,r);break;case pi.COMPLETE:oa(dn.Complete,t,r);break;case pi.FAILED:oa(dn.Error,t,r);break;default:}}async function yA(n,e,t){let i=n.get(pp);if(i.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=a3(e,n);if(s.length===0)return;o!==null&&s.shift(),d5(i,s),o!==null&&await o;let a=s[0];i.has(a)?await VT(n,s,t):i.awaitParentBlock(a,async()=>await VT(n,s,t))}async function VT(n,e,t){let i=n.get(pp),r=i.hydrating,o=n.get(Sr),s=o.add();for(let l=0;l<e.length;l++){let c=e[l],d=i.get(c);if(d!=null){if(await f5(d),await h5(n),c5(d)){jL(d),UT(e.slice(l),i);break}r.get(c).resolve()}else{u5(l,e,i),UT(e.slice(l),i);break}}let a=e[e.length-1];await r.get(a)?.promise,o.remove(s),t&&t(e),HL(i.get(a),e,i,n.get(ei))}function c5(n){return Tl(n.lView,n.tNode)[ku]===dn.Error}function u5(n,e,t){let i=n-1,r=i>-1?t.get(e[i]):null;r&&Ap(r.lContainer)}function UT(n,e){let t=e.hydrating;for(let i in n)t.get(i)?.reject();e.cleanup(n)}function d5(n,e){for(let t of e)n.hydrating.set(t,uE())}function h5(n){return new Promise(e=>Mu(e,{injector:n}))}async function f5(n){let{tNode:e,lView:t}=n,i=Tl(t,e);return new Promise(r=>{p5(i,r),l5(2,t,e)})}function p5(n,e){Array.isArray(n[pl])||(n[pl]=[]),n[pl].push(e)}function Vt(n,e,t,i){let r=Be(),o=ra();if(Pi(r,o,e)){let s=tn(),a=Dv();cL(a,r,n,e,t,i)}return Vt}var Gte=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var m_=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function zv(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function g5(n,e,t,i){let r,o,s=0,a=n.length-1,l=void 0;if(Array.isArray(e)){Ue(i);let c=e.length-1;for(Ue(null);s<=a&&s<=c;){let d=n.at(s),h=e[s],f=zv(s,d,s,h,t);if(f!==0){f<0&&n.updateValue(s,h),s++;continue}let g=n.at(a),w=e[c],S=zv(a,g,c,w,t);if(S!==0){S<0&&n.updateValue(a,w),a--,c--;continue}let P=t(s,d),L=t(a,g),Z=t(s,h);if(Object.is(Z,L)){let ve=t(c,w);Object.is(ve,P)?(n.swap(s,a),n.updateValue(a,w),c--,a--):n.move(a,s),n.updateValue(s,h),s++;continue}if(r??=new lp,o??=jT(n,s,a,t),y_(n,r,s,Z))n.updateValue(s,h),s++,a++;else if(o.has(Z))r.set(P,n.detach(s)),a--;else{let ve=n.create(s,e[s]);n.attach(s,ve),s++,a++}}for(;s<=c;)BT(n,r,t,s,e[s]),s++}else if(e!=null){Ue(i);let c=e[Symbol.iterator]();Ue(null);let d=c.next();for(;!d.done&&s<=a;){let h=n.at(s),f=d.value,g=zv(s,h,s,f,t);if(g!==0)g<0&&n.updateValue(s,f),s++,d=c.next();else{r??=new lp,o??=jT(n,s,a,t);let w=t(s,f);if(y_(n,r,s,w))n.updateValue(s,f),s++,a++,d=c.next();else if(!o.has(w))n.attach(s,n.create(s,f)),s++,a++,d=c.next();else{let S=t(s,h);r.set(S,n.detach(s)),a--}}}for(;!d.done;)BT(n,r,t,n.length,d.value),d=c.next()}for(;s<=a;)n.destroy(n.detach(a--));r?.forEach(c=>{n.destroy(c)})}function y_(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function BT(n,e,t,i,r){if(y_(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function jT(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var lp=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function Y(n,e,t,i,r,o,s,a){gi("NgControlFlow");let l=Be(),c=tn(),d=Mi(c.consts,o);return ap(l,c,n,e,t,i,r,d,256,s,a),dE}function dE(n,e,t,i,r,o,s,a){gi("NgControlFlow");let l=Be(),c=tn(),d=Mi(c.consts,o);return ap(l,c,n,e,t,i,r,d,512,s,a),dE}function Q(n,e){gi("NgControlFlow");let t=Be(),i=ra(),r=t[i]!==xn?t[i]:-1,o=r!==-1?cp(t,ut+r):void 0,s=0;if(Pi(t,i,n)){let a=Ue(null);try{if(o!==void 0&&eE(o,s),n!==-1){let l=ut+n,c=cp(t,l),d=b_(t[Ae],l),h=UD(c,d,t),f=Ru(t,d,e,{dehydratedView:h});Pu(c,f,s,yl(d,h))}}finally{Ue(a)}}else if(o!==void 0){let a=PD(o,s);a!==void 0&&(a[en]=e)}}var v_=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-Gt}};function Fu(n){return n}function Ar(n,e){return e}var __=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function Sn(n,e,t,i,r,o,s,a,l,c,d,h,f){gi("NgControlFlow");let g=Be(),w=tn(),S=l!==void 0,P=Be(),L=a?s.bind(P[Yn][en]):s,Z=new __(S,L);P[ut+n]=Z,ap(g,w,n+1,e,t,i,r,Mi(w.consts,o),256),S&&ap(g,w,n+2,l,c,d,h,Mi(w.consts,f),512)}var E_=class extends m_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-Gt}at(e){return this.getLView(e)[en].$implicit}attach(e,t){let i=t[Zn];this.needsIndexUpdate||=e!==this.length,Pu(this.lContainer,t,e,yl(this.templateTNode,i)),m5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,y5(this.lContainer,e),v5(this.lContainer,e)}create(e,t){let i=tp(this.lContainer,this.templateTNode.tView.ssrId);return Ru(this.hostLView,this.templateTNode,new v_(this.lContainer,t,e),{dehydratedView:i})}destroy(e){bp(e[Ae],e)}updateValue(e,t){this.getLView(e)[en].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[en].$index=e}getLView(e){return _5(this.lContainer,e)}};function In(n){let e=Ue(null),t=Ri();try{let i=Be(),r=i[Ae],o=i[t],s=t+1,a=cp(i,s);if(o.liveCollection===void 0){let c=b_(r,s);o.liveCollection=new E_(a,i,c)}else o.liveCollection.reset();let l=o.liveCollection;if(g5(l,n,o.trackByFn,e),l.updateIndexes(),o.hasEmptyBlock){let c=ra(),d=l.length===0;if(Pi(i,c,d)){let h=t+2,f=cp(i,h);if(d){let g=b_(r,h),w=UD(f,g,i),S=Ru(i,g,void 0,{dehydratedView:w});Pu(f,S,0,yl(g,w))}else r.firstUpdatePass&&Dp(f),eE(f,0)}}}finally{Ue(e)}}function cp(n,e){return n[e]}function m5(n,e){if(n.length<=Gt)return;let t=Gt+e,i=n[t],r=i?i[Xs]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[li];L3(o,r),la.delete(i[no]),r.detachedLeaveAnimationFns=void 0}}function y5(n,e){if(n.length<=Gt)return;let t=Gt+e,i=n[t],r=i?i[Xs]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function v5(n,e){return wu(n,e)}function _5(n,e){return PD(n,e)}function b_(n,e){return na(n,e)}function Ie(n,e,t){let i=Be(),r=ra();if(Pi(i,r,e)){let o=tn(),s=Dv();iL(s,i,n,e,i[xt],t)}return Ie}function w_(n,e,t,i,r){Z_(e,n,t,r?"class":"style",i)}function v(n,e,t,i){let r=Be(),o=r[Ae],s=n+ut,a=o.firstCreatePass?zD(s,r,2,e,_D,gv(),t,i):o.data[s];if(ED(a,r,n,e,hE),cu(a)){let l=r[Ae];Q_(l,r,a),YC(l,a,r)}return i!=null&&xp(r,a),v}function E(){let n=tn(),e=Un(),t=bD(e);return n.firstCreatePass&&WD(n,t),yv(t)&&vv(),pv(),t.classesWithoutHost!=null&&AF(t)&&w_(n,t,Be(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&MF(t)&&w_(n,t,Be(),t.stylesWithoutHost,!1),E}function W(n,e,t,i){return v(n,e,t,i),E(),W}function C(n,e,t,i){let r=Be(),o=r[Ae],s=n+ut,a=o.firstCreatePass?iV(s,o,2,e,t,i):o.data[s];return ED(a,r,n,e,hE),i!=null&&xp(r,a),C}function A(){let n=Un(),e=bD(n);return yv(e)&&vv(),pv(),A}function H(n,e,t,i){return C(n,e,t,i),A(),H}var hE=(n,e,t,i,r)=>(ro(!0),V_(e[xt],i,Av()));function E5(n,e,t,i,r){let o=!yp(e,t);if(ro(o),o)return V_(e[xt],i,Av());let s=e[Zn],a=Tp(s,n,e,t);return zC(s,r)&&mp(s,r,a.nextSibling),s&&(uC(t)||dC(a))&&io(t)&&(GI(t),eD(a)),a}function vA(){hE=E5}var b5=(n,e,t,i,r)=>(ro(!0),ZC(e[xt],""));function w5(n,e,t,i,r){let o,s=!yp(e,t);if(ro(s),s)return ZC(e[xt],"");let a=e[Zn],l=Tp(a,n,e,t),c=o3(a,r);return mp(a,r,l),o=Cp(c,l),o}function _A(){b5=w5}function Ge(){return Be()}var mu=void 0;function x5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var S5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],mu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],mu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",mu,mu,mu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",x5],Wv={};function mi(n){let e=I5(n),t=HT(e);if(t)return t;let i=e.split("-")[0];if(t=HT(i),t)return t;if(i==="en")return S5;throw new ge(701,!1)}function HT(n){return n in Wv||(Wv[n]=mr.ng&&mr.ng.common&&mr.ng.common.locales&&mr.ng.common.locales[n]),Wv[n]}var nn=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(nn||{});function I5(n){return n.toLowerCase().replace(/_/g,"-")}var Lu="en-US";var T5=Lu;function EA(n){typeof n=="string"&&(T5=n.toLowerCase().replace(/_/g,"-"))}function te(n,e,t){let i=Be(),r=tn(),o=Un();return C5(r,i,i[xt],o,n,e,t),te}function Ht(n,e,t){let i=Be(),r=tn(),o=Un();return(o.type&3||t)&&QD(o,r,i,t,i[xt],n,e,Hf(o,i,e)),Ht}function C5(n,e,t,i,r,o,s){let a=!0,l=null;if((i.type&3||s)&&(l??=Hf(i,e,o),QD(i,n,e,s,t,r,o,l)&&(a=!1)),a){let c=i.outputs?.[r],d=i.hostDirectiveOutputs?.[r];if(d&&d.length)for(let h=0;h<d.length;h+=2){let f=d[h],g=d[h+1];l??=Hf(i,e,o),AT(i,e,f,g,r,l)}if(c&&c.length)for(let h of c)l??=Hf(i,e,o),AT(i,e,h,r,r,l)}}function k(n=1){return tT(n)}function Cl(n,e,t){return CV(n,e,t),Cl}function Dl(n){let e=Be(),t=tn(),i=Iv();Af(i+1);let r=oE(t,i);if(n.dirty&&LI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=MV(e,i);n.reset(o,$F),n.notifyOnChanges()}return!0}return!1}function Al(){return IV(Be(),Iv())}function Xi(n){let e=bv();return uu(e,ut+n)}function Ff(n,e){return n<<17|e<<2}function da(n){return n>>17&32767}function D5(n){return(n&2)==2}function A5(n,e){return n&131071|e<<17}function x_(n){return n|2}function _l(n){return(n&131068)>>2}function qv(n,e){return n&-131069|e<<2}function M5(n){return(n&1)===1}function S_(n){return n|1}function R5(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=da(s),l=_l(s);n[i]=t;let c=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||sl(h,d)>0)&&(c=!0)}else d=t;if(r)if(l!==0){let f=da(n[a+1]);n[i+1]=Ff(f,a),f!==0&&(n[f+1]=qv(n[f+1],i)),n[a+1]=A5(n[a+1],i)}else n[i+1]=Ff(a,0),a!==0&&(n[a+1]=qv(n[a+1],i)),a=i;else n[i+1]=Ff(l,0),a===0?a=i:n[l+1]=qv(n[l+1],i),l=i;c&&(n[i+1]=x_(n[i+1])),$T(n,d,i,!0),$T(n,d,i,!1),P5(e,d,n,i,o),s=Ff(a,l),o?e.classBindings=s:e.styleBindings=s}function P5(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&sl(o,e)>=0&&(t[i+1]=S_(t[i+1]))}function $T(n,e,t,i){let r=n[t+1],o=e===null,s=i?da(r):_l(r),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];N5(l,e)&&(a=!0,n[s+1]=i?S_(c):x_(c)),s=i?da(c):_l(c)}a&&(n[t+1]=i?x_(r):S_(r))}function N5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?sl(n,e)>=0:!1}var Yi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function k5(n){return n.substring(Yi.key,Yi.keyEnd)}function O5(n){return F5(n),bA(n,wA(n,0,Yi.textEnd))}function bA(n,e){let t=Yi.textEnd;return t===e?-1:(e=Yi.keyEnd=L5(n,Yi.key=e,t),wA(n,e,t))}function F5(n){Yi.key=0,Yi.keyEnd=0,Yi.value=0,Yi.valueEnd=0,Yi.textEnd=n.length}function wA(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function L5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function et(n,e,t){return xA(n,e,t,!1),et}function Me(n,e){return xA(n,e,null,!0),Me}function fE(n){U5(z5,V5,n,!0)}function V5(n,e){for(let t=O5(e);t>=0;t=bA(e,t))wf(n,k5(e),!0)}function xA(n,e,t,i){let r=Be(),o=tn(),s=fu(2);if(o.firstUpdatePass&&IA(o,n,s,i),e!==xn&&Pi(r,s,e)){let a=o.data[Ri()];TA(o,a,r,r[xt],n,r[s+1]=q5(e,t),i,s)}}function U5(n,e,t,i){let r=tn(),o=fu(2);r.firstUpdatePass&&IA(r,null,o,i);let s=Be();if(t!==xn&&Pi(s,o,t)){let a=r.data[Ri()];if(CA(a,i)&&!SA(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=mf(l,t||"")),w_(r,a,s,t,i)}else W5(r,a,s,s[xt],s[o+1],s[o+1]=G5(n,e,t),i,o)}}function SA(n,e){return e>=n.expandoStartIndex}function IA(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Ri()],s=SA(n,t);CA(o,i)&&e===null&&!s&&(e=!1),e=B5(r,o,e,i),R5(r,o,e,t,s,i)}}function B5(n,e,t,i){let r=JI(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Kv(null,n,e,t,i),t=Su(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Kv(r,n,e,t,i),o===null){let l=j5(n,e,i);l!==void 0&&Array.isArray(l)&&(l=Kv(null,n,e,l[1],i),l=Su(l,e.attrs,i),H5(n,e,i,l))}else o=$5(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function j5(n,e,t){let i=t?e.classBindings:e.styleBindings;if(_l(i)!==0)return n[da(i)]}function H5(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[da(r)]=i}function $5(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=Su(i,s,t)}return Su(i,e.attrs,t)}function Kv(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=Su(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function Su(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),wf(n,s,t?!0:e[++o]))}return n===void 0?null:n}function G5(n,e,t){if(t==null||t==="")return Wn;let i=[],r=xl(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(r instanceof Set)for(let o of r)n(i,o,!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function z5(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&wf(n,i,t)}function W5(n,e,t,i,r,o,s,a){r===xn&&(r=Wn);let l=0,c=0,d=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;d!==null||h!==null;){let f=l<r.length?r[l+1]:void 0,g=c<o.length?o[c+1]:void 0,w=null,S;d===h?(l+=2,c+=2,f!==g&&(w=h,S=g)):h===null||d!==null&&d<h?(l+=2,w=d):(c+=2,w=h,S=g),w!==null&&TA(n,e,t,i,w,S,s,a),d=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}function TA(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],d=M5(c)?GT(l,e,t,r,_l(c),s):void 0;if(!up(d)){up(o)||D5(c)&&(o=GT(l,null,t,r,a,s));let h=lv(Ri(),t);Z3(i,s,h,r,o)}}function GT(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let l=n[r],c=Array.isArray(l),d=c?l[1]:l,h=d===null,f=t[r+1];f===xn&&(f=h?Wn:void 0);let g=h?xf(f,i):d===i?f:void 0;if(c&&!up(g)&&(g=xf(l,i)),up(g)&&(a=g,s))return a;let w=n[r+1];r=s?da(w):_l(w)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=xf(l,i))}return a}function up(n){return n!==void 0}function q5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Xr(xl(n)))),n}function CA(n,e){return(n.flags&(e?8:16))!==0}function y(n,e=""){let t=Be(),i=tn(),r=n+ut,o=i.firstCreatePass?Sl(i,r,1,e,null):i.data[r],s=DA(i,t,o,e,n);t[r]=s,Pf()&&K_(i,t,s,o),ia(o,!1)}var DA=(n,e,t,i,r)=>(ro(!0),JC(e[xt],i));function K5(n,e,t,i,r){let o=!yp(e,t);if(ro(o),o)return JC(e[xt],i);let s=e[Zn];return Tp(s,n,e,t)}function AA(){DA=K5}function Y5(n,e,t,i=""){return Pi(n,ra(),t)?e+Wi(t)+i:xn}function Q5(n,e,t,i,r,o=""){let s=Sv(),a=iE(n,s,t,r);return fu(2),a?e+Wi(t)+i+Wi(r)+o:xn}function J5(n,e,t,i,r,o,s,a=""){let l=Sv(),c=YD(n,l,t,r,s);return fu(3),c?e+Wi(t)+i+Wi(r)+o+Wi(s)+a:xn}function G(n){return B("",n),G}function B(n,e,t){let i=Be(),r=Y5(i,n,e,t);return r!==xn&&pE(i,Ri(),r),B}function Mt(n,e,t,i,r){let o=Be(),s=Q5(o,n,e,t,i,r);return s!==xn&&pE(o,Ri(),s),Mt}function ss(n,e,t,i,r,o,s){let a=Be(),l=J5(a,n,e,t,i,r,o,s);return l!==xn&&pE(a,Ri(),l),ss}function pE(n,e,t){let i=lv(e,n);p3(n[xt],i,t)}var MA={};function Ml(n){gi("NgLet");let e=tn(),t=Be(),i=n+ut,r=Sl(e,i,128,null,null);return ia(r,!1),du(e,t,i,MA),Ml}function Vu(n){let e=tn(),t=Be(),i=Ri();return du(e,t,i,n),n}function Mr(n){let e=bv(),t=uu(e,ut+n);if(t===MA)throw new ge(314,!1);return t}function gE(n){return Pi(Be(),ra(),n)?Wi(n):xn}function zT(n,e,t){let i=tn();i.firstCreatePass&&RA(e,i.data,i.blueprint,xr(n),t)}function RA(n,e,t,i,r){if(n=On(n),Array.isArray(n))for(let o=0;o<n.length;o++)RA(n[o],e,t,i,r);else{let o=tn(),s=Be(),a=Un(),l=qs(n)?n:On(n.provide),c=iv(n),d=a.providerIndexes&1048575,h=a.directiveStart,f=a.providerIndexes>>20;if(qs(n)||!n.multi){let g=new aa(c,r,he,null),w=Qv(l,e,r?d:d+f,h);w===-1?(Zv(Kf(a,s),o,l),Yv(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)):(t[w]=g,s[w]=g)}else{let g=Qv(l,e,d+f,h),w=Qv(l,e,d,d+f),S=g>=0&&t[g],P=w>=0&&t[w];if(r&&!P||!r&&!S){Zv(Kf(a,s),o,l);let L=eU(r?X5:Z5,t.length,r,i,c,n);!r&&P&&(t[w].providerFactory=L),Yv(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(L),s.push(L)}else{let L=PA(t[r?w:g],c,!r&&i);Yv(o,n,g>-1?g:w,L)}!r&&i&&P&&t[w].componentProviders++}}}function Yv(n,e,t,i){let r=qs(e),o=NI(e);if(r||o){let l=(o?On(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function PA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Qv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function Z5(n,e,t,i,r){return I_(this.multi,[])}function X5(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=_u(i,i[Ae],this.providerFactory.index,r);s=l.slice(0,a),I_(o,s);for(let c=a;c<l.length;c++)s.push(l[c])}else s=[],I_(o,s);return s}function I_(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function eU(n,e,t,i,r,o){let s=new aa(n,t,he,null);return s.multi=[],s.index=e,s.componentProviders=0,PA(s,r,i&&!t),s}function Uu(n,e){return t=>{t.providersResolver=(i,r)=>zT(i,r?r(n):n,!1),e&&(t.viewProvidersResolver=(i,r)=>zT(i,r?r(e):e,!0))}}function pa(n,e){let t=ul()+n,i=Be();return i[t]===xn?Rp(i,t,e()):rV(i,t)}function _t(n,e,t,i){return NA(Be(),ul(),n,e,t,i)}function mE(n,e,t,i,r){return nU(Be(),ul(),n,e,t,i,r)}function yE(n,e){let t=n[e];return t===xn?void 0:t}function tU(n,e,t,i,r,o){let s=e+t;return Pi(n,s,r)?Rp(n,s+1,o?i.call(o,r):i(r)):yE(n,s+1)}function NA(n,e,t,i,r,o,s){let a=e+t;return iE(n,a,r,o)?Rp(n,a+2,s?i.call(s,r,o):i(r,o)):yE(n,a+2)}function nU(n,e,t,i,r,o,s,a){let l=e+t;return YD(n,l,r,o,s)?Rp(n,l+3,a?i.call(a,r,o,s):i(r,o,s)):yE(n,l+3)}function Rr(n,e){let t=tn(),i,r=n+ut;t.firstCreatePass?(i=iU(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Wo(i.type,!0)),s,a=zn(he);try{let l=qf(!1),c=o();return qf(l),du(t,Be(),r,c),c}finally{zn(a)}}function iU(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function vE(n,e,t){let i=n+ut,r=Be(),o=uu(r,i);return kA(r,i)?tU(r,ul(),e,o.transform,t,o):o.transform(t)}function lo(n,e,t,i){let r=n+ut,o=Be(),s=uu(o,r);return kA(o,r)?NA(o,ul(),e,s.transform,t,i,s):s.transform(t,i)}function kA(n,e){return n[Ae].data[e].pure}function co(n,e){return Ip(n,e)}var dp=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},_E=(()=>{class n{compileModuleSync(t){return new sp(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=Yy(t),o=oD(r.declarations).reduce((s,a)=>{let l=to(a);return l&&s.push(new vl(l)),s},[]);return new dp(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var OA=(()=>{class n{applicationErrorHandler=q(fi);appRef=q(ei);taskService=q(Sr);ngZone=q(yn);zonelessEnabled=q(pu);tracing=q(ns,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new mn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(tu):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(q(Ov,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?oT:Rv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(tu+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.applicationErrorHandler(i)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function FA(){return[{provide:Ko,useExisting:OA},{provide:yn,useClass:nu},{provide:pu,useValue:!0}]}function rU(){return typeof $localize<"u"&&$localize.locale||Lu}var Bu=new Ee("",{factory:()=>q(Bu,{optional:!0,skipSelf:!0})||rU()});function ti(n,e){return kh(n,e?.equal)}var SE={JSACTION:"__jsaction",OWNER:"__owner"},BA={};function oU(n){return n[SE.JSACTION]}function LA(n,e){n[SE.JSACTION]=e}function sU(n){return BA[n]}function aU(n,e){BA[n]=e}var Oe={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},lU=[Oe.MOUSEENTER,Oe.MOUSELEAVE,"pointerenter","pointerleave"],Qte=[Oe.CLICK,Oe.DBLCLICK,Oe.FOCUSIN,Oe.FOCUSOUT,Oe.KEYDOWN,Oe.KEYUP,Oe.KEYPRESS,Oe.MOUSEOVER,Oe.MOUSEOUT,Oe.SUBMIT,Oe.TOUCHSTART,Oe.TOUCHEND,Oe.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],cU=[Oe.FOCUS,Oe.BLUR,Oe.ERROR,Oe.LOAD,Oe.TOGGLE],IE=n=>cU.indexOf(n)>=0;function uU(n){return n===Oe.MOUSEENTER?Oe.MOUSEOVER:n===Oe.MOUSELEAVE?Oe.MOUSEOUT:n===Oe.POINTERENTER?Oe.POINTEROVER:n===Oe.POINTERLEAVE?Oe.POINTEROUT:n}function dU(n,e,t,i){let r=!1;IE(e)&&(r=!0);let o=typeof i=="boolean"?{capture:r,passive:i}:r;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:r,passive:i}}function hU(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function fU(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var VA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function pU(n){return n.which===2||n.which==null&&n.button===4}function gU(n){return VA&&n.metaKey||!VA&&n.ctrlKey||pU(n)||n.shiftKey}function mU(n,e,t){let i=n.relatedTarget;return(n.type===Oe.MOUSEOVER&&e===Oe.MOUSEENTER||n.type===Oe.MOUSEOUT&&e===Oe.MOUSELEAVE||n.type===Oe.POINTEROVER&&e===Oe.POINTERENTER||n.type===Oe.POINTEROUT&&e===Oe.POINTERLEAVE)&&(!i||i!==t&&!t.contains(i))}function yU(n,e){let t={};for(let i in n){if(i==="srcElement"||i==="target")continue;let r=i,o=n[r];typeof o!="function"&&(t[r]=o)}return n.type===Oe.MOUSEOVER?t.type=Oe.MOUSEENTER:n.type===Oe.MOUSEOUT?t.type=Oe.MOUSELEAVE:n.type===Oe.POINTEROVER?t.type=Oe.POINTERENTER:t.type=Oe.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var vU=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),Vp=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,i){vU&&(this.element.style.cursor="pointer"),this.handlerInfos.push(dU(this.element,e,t(this.element),i))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)hU(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},_U={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function as(n){return n.eventType}function TE(n,e){n.eventType=e}function Fp(n){return n.event}function jA(n,e){n.event=e}function HA(n){return n.targetElement}function $A(n,e){n.targetElement=e}function GA(n){return n.eic}function EU(n,e){n.eic=e}function bU(n){return n.timeStamp}function wU(n,e){n.timeStamp=e}function Lp(n){return n.eia}function zA(n,e,t){n.eia=[e,t]}function EE(n){n.eia=void 0}function Op(n){return n[1]}function xU(n){return n.eirp}function WA(n,e){n.eirp=e}function qA(n){return n.eir}function KA(n,e){n.eir=e}function YA(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function SU(n,e,t,i,r,o,s,a){return{eventType:n,event:e,targetElement:t,eic:i,timeStamp:r,eia:o,eirp:s,eiack:a}}var bE=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return as(this.eventInfo)}setEventType(e){TE(this.eventInfo,e)}getEvent(){return Fp(this.eventInfo)}setEvent(e){jA(this.eventInfo,e)}getTargetElement(){return HA(this.eventInfo)}setTargetElement(e){$A(this.eventInfo,e)}getContainer(){return GA(this.eventInfo)}setContainer(e){EU(this.eventInfo,e)}getTimestamp(){return bU(this.eventInfo)}setTimestamp(e){wU(this.eventInfo,e)}getAction(){let e=Lp(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){EE(this.eventInfo);return}zA(this.eventInfo,e.name,e.element)}getIsReplay(){return xU(this.eventInfo)}setIsReplay(e){WA(this.eventInfo,e)}getResolved(){return qA(this.eventInfo)}setResolved(e){KA(this.eventInfo,e)}clone(){return new n(YA(this.eventInfo))}},IU={},TU=/\s*;\s*/,CU=Oe.CLICK,wE=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&as(e)===Oe.CLICK&&gU(Fp(e))?TE(e,Oe.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){qA(e)||(this.populateAction(e,HA(e)),KA(e,!0))}resolveParentAction(e){let t=Lp(e),i=t&&Op(t);EE(e);let r=i&&this.getParentNode(i);r&&this.populateAction(e,r)}populateAction(e,t){let i=t;for(;i&&i!==GA(e)&&(i.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(i,e),!Lp(e));)i=this.getParentNode(i);let r=Lp(e);if(r&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(as(e)===Oe.MOUSEENTER||as(e)===Oe.MOUSELEAVE||as(e)===Oe.POINTERENTER||as(e)===Oe.POINTERLEAVE)))if(mU(Fp(e),as(e),Op(r))){let o=yU(Fp(e),Op(r));jA(e,o),$A(e,Op(r))}else EE(e)}getParentNode(e){let t=e[SE.OWNER];if(t)return t;let i=e.parentNode;return i?.nodeName==="#document-fragment"?i?.host??null:i}populateActionOnElement(e,t){let i=this.parseActions(e),r=i[as(t)];r!==void 0&&zA(t,r,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,i)}parseActions(e){let t=oU(e);if(!t){let i=e.getAttribute(kf.JSACTION);if(!i)t=IU,LA(e,t);else{if(t=sU(i),!t){t={};let r=i.split(TU);for(let o=0;o<r.length;o++){let s=r[o];if(!s)continue;let a=s.indexOf(_U.EVENT_ACTION_SEPARATOR),l=a!==-1,c=l?s.substr(0,a).trim():CU,d=l?s.substr(a+1).trim():s;t[c]=d}aU(i,t)}LA(e,t)}}return t}addA11yClickSupport(e,t,i){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=i}},QA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(QA||{}),xE=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:i}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=i}dispatch(e){let t=new bE(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let i=t.getAction();if(i&&DU(i.element,t)&&fU(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function DU(n,e){return n.tagName==="A"&&(e.getEventType()===Oe.CLICK||e.getEventType()===Oe.CLICKMOD)}var JA=Symbol.for("propagationStopped"),CE={REPLAY:101};var AU="`preventDefault` called during event replay.";var MU="`composedPath` called during event replay.",Up=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new wE({clickModSupport:t}),this.dispatcher=new xE(i=>{this.dispatchToDelegate(i)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&NU(e),RU(e);e.getAction();){if(kU(e),IE(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),PU(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function RU(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),i=()=>{e[JA]=!0,t()};ga(e,"stopPropagation",i),ga(e,"stopImmediatePropagation",i)}function PU(n){return!!n.getEvent()[JA]}function NU(n){let e=n.getEvent(),t=n.getTargetElement(),i=e.preventDefault.bind(e);ga(e,"target",t),ga(e,"eventPhase",CE.REPLAY),ga(e,"preventDefault",()=>{throw i(),new Error(AU+"")}),ga(e,"composedPath",()=>{throw new Error(MU+"")})}function kU(n){let e=n.getEvent(),t=n.getAction()?.element;t&&ga(e,"currentTarget",t,{configurable:!0})}function ga(n,e,t,{configurable:i=!1}={}){Object.defineProperty(n,e,{value:t,configurable:i})}function ZA(n,e){n.ecrd(t=>{e.dispatch(t)},QA.I_AM_THE_JSACTION_FRAMEWORK)}function OU(n){return n?.q??[]}function FU(n){n&&(UA(n.c,n.et,n.h),UA(n.c,n.etc,n.h,!0))}function UA(n,e,t,i){for(let r=0;r<e.length;r++)n.removeEventListener(e[r],t,i)}var LU=!1,XA=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=LU;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,i,r){let o=SU(t,i,i.target,r,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){WA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,i,r){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&lU.indexOf(t)>=0)return;let o=(a,l,c)=>{this.handleEvent(a,l,c)};this.eventHandlers[t]=o;let s=uU(i||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>l=>{o(t,l,a)},r)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),FU(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let i=0;i<t.length;i++){let r=t[i],o=this.getEventTypesForBrowserEventType(r.eventType);for(let s=0;s<o.length;s++){let a=YA(r);TE(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let i=[];return this.eventHandlers[t]&&i.push(t),this.browserEventTypeToExtraEventTypes[t]&&i.push(...this.browserEventTypeToExtraEventTypes[t]),i}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,i){this.ecrd(t,i)}ecrd(t,i){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let r=0;r<this.queuedEventInfos.length;r++)this.handleEventInfo(this.queuedEventInfos[r]);this.queuedEventInfos=null}}}return n})();function eM(n,e=window){return OU(e._ejsas?.[n])}function DE(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var uM=Symbol("InputSignalNode#UNSET"),d6=ce(F({},Oh),{transformFn:void 0,applyValueToInputSignal(n,e){zc(n,e)}});function dM(n,e){let t=Object.create(d6);t.value=n,t.transformFn=e?.transform;function i(){if(Hc(t),t.value===uM){let r=null;throw new ge(-950,r)}return t.value}return i[Qn]=t,i}var Hp=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Tu(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function tM(n,e){return dM(n,e)}function h6(n){return dM(uM,n)}var hM=(tM.required=h6,tM);var AE=new Ee(""),f6=new Ee("");function ju(n){return!n.moduleRef}function p6(n){let e=ju(n)?n.r3Injector:n.moduleRef.injector,t=e.get(yn);return t.run(()=>{ju(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(fi),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),ju(n)){let o=()=>e.destroy(),s=n.platformInjector.get(AE);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(AE);s.add(o),n.moduleRef.onDestroy(()=>{vu(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return m6(i,t,()=>{let o=e.get(Sr),s=o.add(),a=e.get(cE);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(Bu,Lu);if(EA(l||Lu),!e.get(f6,!0))return ju(n)?e.get(ei):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(ju(n)){let d=e.get(ei);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return g6?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var g6;function m6(n,e,t){try{let i=t();return rs(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var jp=null;function y6(n=[],e){return qn.create({name:e,providers:[{provide:ou,useValue:"platform"},{provide:AE,useValue:new Set([()=>jp=null])},...n]})}function v6(n=[]){if(jp)return jp;let e=y6(n);return jp=e,pA(),_6(e),e}function _6(n){let e=n.get(hp,null);Fn(n,()=>{e?.forEach(t=>t())})}function fM(){return!1}var Bp=new WeakSet,nM="";function iM(n){return n.get(P_,DC)}function pM(){let n=[{provide:P_,useFactory:()=>{let e=!0;{let t=q(Cr);e=!!window._ejsas?.[t]}return e&&gi("NgEventReplay"),e}}];return n.push({provide:vr,useValue:()=>{let e=q(ei),{injector:t}=e;if(!Bp.has(e)){let i=q(N_);if(iM(t)){LC();let r=t.get(Cr),o=OC(r,(s,a,l)=>{s.nodeType===Node.ELEMENT_NODE&&(RC(s,a,l),PC(s,i))});e.onDestroy(o)}}},multi:!0},{provide:os,useFactory:()=>{let e=q(ei),{injector:t}=e;return()=>{if(!iM(t)||Bp.has(e))return;Bp.add(e);let i=t.get(Cr);e.onDestroy(()=>{Bp.delete(e),DE(i)}),e.whenStable().then(()=>{if(e.destroyed)return;let r=t.get(kC);E6(r,t);let o=t.get(N_);o.get(nM)?.forEach(NC),o.delete(nM);let s=r.instance;GC(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var E6=(n,e)=>{let t=e.get(Cr),i=window._ejsas[t],r=n.instance=new XA(new Vp(i.c));for(let a of i.et)r.addEvent(a);for(let a of i.etc)r.addEvent(a);let o=eM(t);r.replayEarlyEventInfos(o),DE(t);let s=new Up(a=>{b6(e,a,a.currentTarget)});ZA(r,s)};function b6(n,e,t){let i=(t&&t.getAttribute(Du))??"";/d\d+/.test(i)?w6(i,n,e,t):e.eventPhase===CE.REPLAY&&k_(e,t)}function w6(n,e,t,i){let r=e.get(AC);r.push({event:t,currentTarget:i}),yA(e,n,x6(r))}function x6(n){return e=>{let t=new Set(e),i=[];for(let{event:r,currentTarget:o}of n){let s=o.getAttribute(Du);t.has(s)?k_(r,o):i.push({event:r,currentTarget:o})}n.length=0,n.push(...i)}}var rM=!1;var S6=1e4;function I6(){rM||(rM=!0,jC(),vA(),AA(),_A(),uA(),iA(),VD(),vD())}function T6(n){return n.whenStable()}function gM(){let n=[{provide:Cu,useFactory:()=>{let e=!0;return e=!!q(wl,{optional:!0})?.get(O_,null),e&&gi("NgHydration"),e}},{provide:vr,useValue:()=>{kD(!1);let e=q(Yt);q(Cu)&&(qC(e),I6())},multi:!0}];return n.push({provide:R_,useFactory:()=>q(Cu)},{provide:os,useFactory:()=>{if(q(Cu)){let e=q(ei);return()=>{T6(e).then(()=>{e.destroyed||tE(e)})}}return()=>{}},multi:!0}),_r(n)}var Nse=S6-1e3;var ma=(()=>{class n{static __NG_ELEMENT_ID__=C6}return n})();function C6(n){return D6(Un(),Be(),(n&16)===16)}function D6(n,e,t){if(io(n)&&!t){let i=Ai(n.index,e);return new es(i,i)}else if(n.type&175){let i=e[Yn];return new es(i,e)}return null}var ME=class{constructor(){}supports(e){return nE(e)}create(e){return new RE(e)}},A6=(n,e)=>e,RE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||A6}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<oM(i,r,o)?t:i,a=oM(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let c=a-r,d=l-r;if(c!=d){for(let f=0;f<c;f++){let g=f<o.length?o[f]:o[f]=0,w=g+f;d<=w&&w<c&&(o[f]=g+1)}let h=s.previousIndex;o[h]=d-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!nE(e))throw new ge(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,qD(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new PE(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new $p),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new $p),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},PE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},NE=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},$p=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new NE,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function oM(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function sM(){return new kE([new ME])}var kE=(()=>{class n{factories;static \u0275prov=de({token:n,providedIn:"root",factory:sM});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=q(n,{optional:!0,skipSelf:!0});return n.create(t,i||sM())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new ge(901,!1)}}return n})();function mM(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;pt(at.BootstrapApplicationStart);try{let o=r?.injector??v6(i),s=[FA(),aT,...t||[]],a=new xu({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return p6({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{pt(at.BootstrapApplicationEnd)}}function Hu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var yM=null;function ki(){return yM}function OE(n){yM??=n}var $u=class{},Gp=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>q(vM),providedIn:"platform"})}return n})();var vM=(()=>{class n extends Gp{_location;_history;_doc=q(Yt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ki().getBaseHref(this._doc)}onPopState(t){let i=ki().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=ki().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function bM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function _M(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ls(n){return n&&n[0]!=="?"?`?${n}`:n}var Rl=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>q(R6),providedIn:"root"})}return n})(),M6=new Ee(""),R6=(()=>{class n extends Rl{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??q(Yt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return bM(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+ls(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+ls(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+ls(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Re(Gp),Re(M6,8))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pl=(()=>{class n{_subject=new jt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=k6(_M(EM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ls(i))}normalize(t){return n.stripTrailingSlash(N6(this._basePath,EM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ls(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ls(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=ls;static joinWithSlash=bM;static stripTrailingSlash=_M;static \u0275fac=function(i){return new(i||n)(Re(Rl))};static \u0275prov=de({token:n,factory:()=>P6(),providedIn:"root"})}return n})();function P6(){return new Pl(Re(Rl))}function N6(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function EM(n){return n.replace(/\/index.html$/,"")}function k6(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Bn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Bn||{}),It=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(It||{}),ni=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(ni||{}),ho={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function TM(n){return mi(n)[nn.LocaleId]}function CM(n,e,t){let i=mi(n),r=[i[nn.DayPeriodsFormat],i[nn.DayPeriodsStandalone]],o=Oi(r,e);return Oi(o,t)}function DM(n,e,t){let i=mi(n),r=[i[nn.DaysFormat],i[nn.DaysStandalone]],o=Oi(r,e);return Oi(o,t)}function AM(n,e,t){let i=mi(n),r=[i[nn.MonthsFormat],i[nn.MonthsStandalone]],o=Oi(r,e);return Oi(o,t)}function MM(n,e){let i=mi(n)[nn.Eras];return Oi(i,e)}function Gu(n,e){let t=mi(n);return Oi(t[nn.DateFormat],e)}function zu(n,e){let t=mi(n);return Oi(t[nn.TimeFormat],e)}function Wu(n,e){let i=mi(n)[nn.DateTimeFormat];return Oi(i,e)}function qu(n,e){let t=mi(n),i=t[nn.NumberSymbols][e];if(typeof i>"u"){if(e===ho.CurrencyDecimal)return t[nn.NumberSymbols][ho.Decimal];if(e===ho.CurrencyGroup)return t[nn.NumberSymbols][ho.Group]}return i}function RM(n){if(!n[nn.ExtraData])throw new ge(2303,!1)}function PM(n){let e=mi(n);return RM(e),(e[nn.ExtraData][2]||[]).map(i=>typeof i=="string"?FE(i):[FE(i[0]),FE(i[1])])}function NM(n,e,t){let i=mi(n);RM(i);let r=[i[nn.ExtraData][0],i[nn.ExtraData][1]],o=Oi(r,e)||[];return Oi(o,t)||[]}function Oi(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new ge(2304,!1)}function FE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var O6=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,zp={},F6=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function kM(n,e,t,i){let r=z6(n);e=uo(t,e)||e;let s=[],a;for(;e;)if(a=F6.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let l=r.getTimezoneOffset();i&&(l=FM(i,l),r=G6(r,i));let c="";return s.forEach(d=>{let h=H6(d);c+=h?h(r,t,l):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Qp(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function uo(n,e){let t=TM(n);if(zp[t]??={},zp[t][e])return zp[t][e];let i="";switch(e){case"shortDate":i=Gu(n,ni.Short);break;case"mediumDate":i=Gu(n,ni.Medium);break;case"longDate":i=Gu(n,ni.Long);break;case"fullDate":i=Gu(n,ni.Full);break;case"shortTime":i=zu(n,ni.Short);break;case"mediumTime":i=zu(n,ni.Medium);break;case"longTime":i=zu(n,ni.Long);break;case"fullTime":i=zu(n,ni.Full);break;case"short":let r=uo(n,"shortTime"),o=uo(n,"shortDate");i=Wp(Wu(n,ni.Short),[r,o]);break;case"medium":let s=uo(n,"mediumTime"),a=uo(n,"mediumDate");i=Wp(Wu(n,ni.Medium),[s,a]);break;case"long":let l=uo(n,"longTime"),c=uo(n,"longDate");i=Wp(Wu(n,ni.Long),[l,c]);break;case"full":let d=uo(n,"fullTime"),h=uo(n,"fullDate");i=Wp(Wu(n,ni.Full),[d,h]);break}return i&&(zp[t][e]=i),i}function Wp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function er(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function L6(n,e){return er(n,3).substring(0,e)}function hn(n,e,t=0,i=!1,r=!1){return function(o,s){let a=V6(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return L6(a,e);let l=qu(s,ho.MinusSign);return er(a,e,l,i,r)}}function V6(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new ge(2301,!1)}}function Rt(n,e,t=Bn.Format,i=!1){return function(r,o){return U6(r,o,n,e,t,i)}}function U6(n,e,t,i,r,o){switch(t){case 2:return AM(e,r,i)[n.getMonth()];case 1:return DM(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let c=PM(e),d=NM(e,r,i),h=c.findIndex(f=>{if(Array.isArray(f)){let[g,w]=f,S=s>=g.hours&&a>=g.minutes,P=s<w.hours||s===w.hours&&a<w.minutes;if(g.hours<w.hours){if(S&&P)return!0}else if(S||P)return!0}else if(f.hours===s&&f.minutes===a)return!0;return!1});if(h!==-1)return d[h]}return CM(e,r,i)[s<12?0:1];case 3:return MM(e,i)[n.getFullYear()<=0?0:1];default:let l=t;throw new ge(2302,!1)}}function qp(n){return function(e,t,i){let r=-1*i,o=qu(t,ho.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+er(s,2,o)+er(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+er(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+er(s,2,o)+":"+er(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+er(s,2,o)+":"+er(Math.abs(r%60),2,o);default:throw new ge(2310,!1)}}}var B6=0,Yp=4;function j6(n){let e=Qp(n,B6,1).getDay();return Qp(n,0,1+(e<=Yp?Yp:Yp+7)-e)}function OM(n){let e=n.getDay(),t=e===0?-3:Yp-e;return Qp(n.getFullYear(),n.getMonth(),n.getDate()+t)}function LE(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=OM(t),s=j6(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return er(r,n,qu(i,ho.MinusSign))}}function Kp(n,e=!1){return function(t,i){let o=OM(t).getFullYear();return er(o,n,qu(i,ho.MinusSign),e)}}var VE={};function H6(n){if(VE[n])return VE[n];let e;switch(n){case"G":case"GG":case"GGG":e=Rt(3,It.Abbreviated);break;case"GGGG":e=Rt(3,It.Wide);break;case"GGGGG":e=Rt(3,It.Narrow);break;case"y":e=hn(0,1,0,!1,!0);break;case"yy":e=hn(0,2,0,!0,!0);break;case"yyy":e=hn(0,3,0,!1,!0);break;case"yyyy":e=hn(0,4,0,!1,!0);break;case"Y":e=Kp(1);break;case"YY":e=Kp(2,!0);break;case"YYY":e=Kp(3);break;case"YYYY":e=Kp(4);break;case"M":case"L":e=hn(1,1,1);break;case"MM":case"LL":e=hn(1,2,1);break;case"MMM":e=Rt(2,It.Abbreviated);break;case"MMMM":e=Rt(2,It.Wide);break;case"MMMMM":e=Rt(2,It.Narrow);break;case"LLL":e=Rt(2,It.Abbreviated,Bn.Standalone);break;case"LLLL":e=Rt(2,It.Wide,Bn.Standalone);break;case"LLLLL":e=Rt(2,It.Narrow,Bn.Standalone);break;case"w":e=LE(1);break;case"ww":e=LE(2);break;case"W":e=LE(1,!0);break;case"d":e=hn(2,1);break;case"dd":e=hn(2,2);break;case"c":case"cc":e=hn(7,1);break;case"ccc":e=Rt(1,It.Abbreviated,Bn.Standalone);break;case"cccc":e=Rt(1,It.Wide,Bn.Standalone);break;case"ccccc":e=Rt(1,It.Narrow,Bn.Standalone);break;case"cccccc":e=Rt(1,It.Short,Bn.Standalone);break;case"E":case"EE":case"EEE":e=Rt(1,It.Abbreviated);break;case"EEEE":e=Rt(1,It.Wide);break;case"EEEEE":e=Rt(1,It.Narrow);break;case"EEEEEE":e=Rt(1,It.Short);break;case"a":case"aa":case"aaa":e=Rt(0,It.Abbreviated);break;case"aaaa":e=Rt(0,It.Wide);break;case"aaaaa":e=Rt(0,It.Narrow);break;case"b":case"bb":case"bbb":e=Rt(0,It.Abbreviated,Bn.Standalone,!0);break;case"bbbb":e=Rt(0,It.Wide,Bn.Standalone,!0);break;case"bbbbb":e=Rt(0,It.Narrow,Bn.Standalone,!0);break;case"B":case"BB":case"BBB":e=Rt(0,It.Abbreviated,Bn.Format,!0);break;case"BBBB":e=Rt(0,It.Wide,Bn.Format,!0);break;case"BBBBB":e=Rt(0,It.Narrow,Bn.Format,!0);break;case"h":e=hn(3,1,-12);break;case"hh":e=hn(3,2,-12);break;case"H":e=hn(3,1);break;case"HH":e=hn(3,2);break;case"m":e=hn(4,1);break;case"mm":e=hn(4,2);break;case"s":e=hn(5,1);break;case"ss":e=hn(5,2);break;case"S":e=hn(6,1);break;case"SS":e=hn(6,2);break;case"SSS":e=hn(6,3);break;case"Z":case"ZZ":case"ZZZ":e=qp(0);break;case"ZZZZZ":e=qp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=qp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=qp(2);break;default:return null}return VE[n]=e,e}function FM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function $6(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function G6(n,e,t){let r=n.getTimezoneOffset(),o=FM(e,r);return $6(n,-1*(o-r))}function z6(n){if(wM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return Qp(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(O6))return W6(i)}let e=new Date(n);if(!wM(e))throw new ge(2311,!1);return e}function W6(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),c=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,c),e}function wM(n){return n instanceof Date&&!isNaN(n.valueOf())}var UE=/\s+/,xM=[],Ku=(()=>{class n{_ngEl;_renderer;initialClasses=xM;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(UE):xM}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(UE):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(UE).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(he(Ni),he(is))};static \u0275dir=vn({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var Jp=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},cs=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Jp(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),SM(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);SM(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(he(so),he(ts),he(kE))};static \u0275dir=vn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function SM(n,e){n.context.$implicit=e.item}var ya=(()=>{class n{_viewContainer;_context=new Zp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){IM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){IM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(he(so),he(ts))};static \u0275dir=vn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Zp=class{$implicit=null;ngIf=null};function IM(n,e){if(n&&!n.createEmbeddedView)throw new ge(2020,!1)}function LM(n,e){return new ge(2100,!1)}var q6=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,BE=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw LM(n,t);return t.replace(q6,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=Np({name:"titlecase",type:n,pure:!0})}return n})();var K6="mediumDate",VM=new Ee(""),UM=new Ee(""),va=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??K6,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return kM(t,s,o||this.locale,a)}catch(s){throw LM(n,s.message)}}static \u0275fac=function(i){return new(i||n)(he(Bu,16),he(VM,24),he(UM,24))};static \u0275pipe=Np({name:"date",type:n,pure:!0})}return n})();var Pt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ao({type:n});static \u0275inj=yr({})}return n})();function jE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Yu=class{};var HE="browser";function us(n){return n===HE}var Qu=class{_doc;constructor(e){this._doc=e}manager},Xp=(()=>{class n extends Qu{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(Re(Yt))};static \u0275prov=de({token:n,factory:n.\u0275fac})}return n})(),ng=new Ee(""),WE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof Xp));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof Xp);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new ge(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Re(ng),Re(yn))};static \u0275prov=de({token:n,factory:n.\u0275fac})}return n})(),$E="ng-app-id";function BM(n){for(let e of n)e.remove()}function jM(n,e){let t=e.createElement("style");return t.textContent=n,t}function Y6(n,e,t,i){let r=n.head?.querySelectorAll(`style[${$E}="${e}"],link[${$E}="${e}"]`);if(r)for(let o of r)o.removeAttribute($E),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function zE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var qE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,Y6(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,jM);i?.forEach(r=>this.addUsage(r,this.external,zE))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(BM(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])BM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,jM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,zE(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Re(Yt),Re(Cr),Re(bl,8),Re(Ji))};static \u0275prov=de({token:n,factory:n.\u0275fac})}return n})(),GE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},KE=/%COMP%/g;var $M="%COMP%",Q6=`_nghost-${$M}`,J6=`_ngcontent-${$M}`,Z6=!0,X6=new Ee("",{factory:()=>Z6});function eB(n){return J6.replace(KE,n)}function tB(n){return Q6.replace(KE,n)}function GM(n,e){return e.map(t=>t.replace(KE,n))}var YE=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,r,o,s,a,l=null,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.defaultRenderer=new Ju(t,s,a,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof tg?r.applyToHost(t):r instanceof Zu&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.tracingService;switch(i.encapsulation){case Qi.Emulated:o=new tg(l,c,i,this.appId,d,s,a,h);break;case Qi.ShadowDom:return new eg(l,t,i,s,a,this.nonce,h,c);case Qi.ExperimentalIsolatedShadowDom:return new eg(l,t,i,s,a,this.nonce,h);default:o=new Zu(l,c,i,d,s,a,h);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Re(WE),Re(qE),Re(Cr),Re(X6),Re(Yt),Re(yn),Re(bl),Re(ns,8))};static \u0275prov=de({token:n,factory:n.\u0275fac})}return n})(),Ju=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(GE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(HM(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(HM(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new ge(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=GE[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=GE[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Tr.DashCase|Tr.Important)?e.style.setProperty(t,i,r&Tr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Tr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=ki().getGlobalEventTarget(this.doc,e),!e))throw new ge(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function HM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var eg=class extends Ju{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let c=i.styles;c=GM(i.id,c);for(let h of c){let f=document.createElement("style");s&&f.setAttribute("nonce",s),f.textContent=h,this.shadowRoot.appendChild(f)}let d=i.getExternalStyles?.();if(d)for(let h of d){let f=zE(h,r);s&&f.setAttribute("nonce",s),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Zu=class extends Ju{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let c=i.styles;this.styles=l?GM(l,c):c,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&la.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},tg=class extends Zu{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l){let c=r+"-"+i.id;super(e,t,i,o,s,a,l,c),this.contentAttr=eB(c),this.hostAttr=tB(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var ig=class n extends $u{supportsDOMEvents=!0;static makeCurrent(){OE(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=nB();return t==null?null:iB(t)}resetBaseElement(){Xu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return jE(document.cookie,e)}},Xu=null;function nB(){return Xu=Xu||document.head.querySelector("base"),Xu?Xu.getAttribute("href"):null}function iB(n){return new URL(n,document.baseURI).pathname}var rB=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac})}return n})(),zM=["alt","control","meta","shift"],oB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},WM=(()=>{class n extends Qu{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ki().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),zM.forEach(c=>{let d=i.indexOf(c);d>-1&&(i.splice(d,1),s+=c+".")}),s+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=oB[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),zM.forEach(s=>{if(s!==r){let a=sB[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(Re(Yt))};static \u0275prov=de({token:n,factory:n.\u0275fac})}return n})();async function QE(n,e,t){let i=F({rootComponent:n},aB(e,t));return mM(i)}function aB(n,e){return{platformRef:e?.platformRef,appProviders:[...hB,...n?.providers??[]],platformProviders:dB}}function lB(){ig.makeCurrent()}function cB(){return new gr}function uB(){return D_(document),document}var dB=[{provide:Ji,useValue:HE},{provide:hp,useValue:lB,multi:!0},{provide:Yt,useFactory:uB}];var hB=[{provide:ou,useValue:"root"},{provide:gr,useFactory:cB},{provide:ng,useClass:Xp,multi:!0},{provide:ng,useClass:WM,multi:!0},YE,qE,WE,{provide:ca,useExisting:YE},{provide:Yu,useClass:rB},[]];var ed=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var fB="text/plain",pB="application/json",xle=`${pB}, ${fB}, */*`;var ZE=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(ZE||{}),JE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new ed,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var rg=class n extends JE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=ZE.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var qM=new Ee("");var gB=new Ee(""),mB="b",yB="h",vB="s",_B="st",EB="u",bB="rt",XE=new Ee(""),wB=["GET","HEAD"];function xB(n,e){let g=q(XE),{isCacheActive:t}=g,i=Qa(g,["isCacheActive"]),{transferCache:r,method:o}=n;if(!t||r===!1||o==="POST"&&!i.includePostRequests&&!r||o!=="POST"&&!wB.includes(o)||!i.includeRequestsWithAuthHeaders&&SB(n)||i.filter?.(n)===!1)return e(n);let s=q(wl);if(q(gB,{optional:!0}))throw new ge(2803,!1);let l=n.url,c=IB(n,l),d=s.get(c,null),h=i.includeHeaders;if(typeof r=="object"&&r.includeHeaders&&(h=r.includeHeaders),d){let{[mB]:w,[bB]:S,[yB]:P,[vB]:L,[_B]:Z,[EB]:ve}=d,be=w;switch(S){case"arraybuffer":be=new TextEncoder().encode(w).buffer;break;case"blob":be=new Blob([w]);break}let Ce=new ed(P);return it(new rg({body:be,headers:Ce,status:L,statusText:Z,url:ve}))}return e(n)}function SB(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function KM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function IB(n,e){let{params:t,method:i,responseType:r}=n,o=KM(t),s=n.serializeBody();s instanceof URLSearchParams?s=KM(s):typeof s!="string"&&(s="");let a=[i,r,e,s,o].join("|"),l=TB(a);return l}function TB(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function YM(n){return[{provide:XE,useFactory:()=>(gi("NgHttpTransferCache"),F({isCacheActive:!0},n))},{provide:qM,useValue:xB,multi:!0},{provide:os,multi:!0,useFactory:()=>{let e=q(ei),t=q(XE);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var QM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Re(Yt))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var og=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(og||{});function CB(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function JM(){return CB(og.EventReplay,pM())}function ZM(...n){let e=[],t=new Set;for(let{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);let i=t.has(og.HttpTransferCacheOptions);return _r([[],[],gM(),t.has(og.NoHttpTransferCache)||i?[]:YM({}),e])}var ze="primary",hd=Symbol("RouteTitle"),rb=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ba(n){return new rb(n)}function eb(n,e,t){for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function l2(n,e,t){let i=t.path.split("/"),r=i.indexOf("**");if(r===-1){if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let l={},c=n.slice(0,i.length);return eb(i,c,l)?{consumed:c,posParams:l}:null}if(r!==i.lastIndexOf("**"))return null;let o=i.slice(0,r),s=i.slice(r+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!eb(o,n.slice(0,o.length),a)||!eb(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function dg(n){return new Promise((e,t)=>{n.pipe(Qr()).subscribe({next:i=>e(i),error:i=>t(i)})})}function AB(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Pr(n[t],e[t]))return!1;return!0}function Pr(n,e){let t=n?ob(n):void 0,i=e?ob(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!c2(n[r],e[r]))return!1;return!0}function ob(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function c2(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function MB(n){return n.length>0?n[n.length-1]:null}function Sa(n){return rf(n)?n:rs(n)?ln(Promise.resolve(n)):it(n)}function u2(n){return rf(n)?dg(n):Promise.resolve(n)}var RB={exact:h2,subset:f2},d2={exact:PB,subset:NB,ignored:()=>!0};function XM(n,e,t){return RB[t.paths](n.root,e.root,t.matrixParams)&&d2[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function PB(n,e){return Pr(n,e)}function h2(n,e,t){if(!_a(n.segments,e.segments)||!lg(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!h2(n.children[i],e.children[i],t))return!1;return!0}function NB(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>c2(n[t],e[t]))}function f2(n,e,t){return p2(n,e,e.segments,t)}function p2(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!_a(r,t)||e.hasChildren()||!lg(r,t,i))}else if(n.segments.length===t.length){if(!_a(n.segments,t)||!lg(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!f2(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!_a(n.segments,r)||!lg(n.segments,r,i)||!n.children[ze]?!1:p2(n.children[ze],e,o,i)}}function lg(n,e,t){return e.every((i,r)=>d2[t](n[r].parameters,i.parameters))}var nr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new gt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=ba(this.queryParams),this._queryParamMap}toString(){return FB.serialize(this)}},gt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return cg(this)}},ds=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ba(this.parameters),this._parameterMap}toString(){return m2(this)}};function kB(n,e){return _a(n,e)&&n.every((t,i)=>Pr(t.parameters,e[i].parameters))}function _a(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function OB(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===ze&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ze&&(t=t.concat(e(r,i)))}),t}var fd=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>new hs,providedIn:"root"})}return n})(),hs=class{parse(e){let t=new ab(e);return new nr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${td(e.root,!0)}`,i=UB(e.queryParams),r=typeof e.fragment=="string"?`#${LB(e.fragment)}`:"";return`${t}${i}${r}`}},FB=new hs;function cg(n){return n.segments.map(e=>m2(e)).join("/")}function td(n,e){if(!n.hasChildren())return cg(n);if(e){let t=n.children[ze]?td(n.children[ze],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==ze&&i.push(`${r}:${td(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=OB(n,(i,r)=>r===ze?[td(n.children[ze],!1)]:[`${r}:${td(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[ze]!=null?`${cg(n)}/${t[0]}`:`${cg(n)}/(${t.join("//")})`}}function g2(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function sg(n){return g2(n).replace(/%3B/gi,";")}function LB(n){return encodeURI(n)}function sb(n){return g2(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ug(n){return decodeURIComponent(n)}function e2(n){return ug(n.replace(/\+/g,"%20"))}function m2(n){return`${sb(n.path)}${VB(n.parameters)}`}function VB(n){return Object.entries(n).map(([e,t])=>`;${sb(e)}=${sb(t)}`).join("")}function UB(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${sg(t)}=${sg(r)}`).join("&"):`${sg(t)}=${sg(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var BB=/^[^\/()?;#]+/;function tb(n){let e=n.match(BB);return e?e[0]:""}var jB=/^[^\/()?;=#]+/;function HB(n){let e=n.match(jB);return e?e[0]:""}var $B=/^[^=?&#]+/;function GB(n){let e=n.match($B);return e?e[0]:""}var zB=/^[^&#]+/;function WB(n){let e=n.match(zB);return e?e[0]:""}var ab=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new gt([],{}):new gt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[ze]=new gt(e,t)),i}parseSegment(){let e=tb(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(e),new ds(ug(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=HB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=tb(this.remaining);r&&(i=r,this.capture(i))}e[ug(t)]=ug(i)}parseQueryParam(e){let t=GB(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=WB(this.remaining);s&&(i=s,this.capture(i))}let r=e2(t),o=e2(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=tb(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new ge(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ze);let s=this.parseChildren();t[o??ze]=Object.keys(s).length===1&&s[ze]?s[ze]:new gt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ge(4011,!1)}};function y2(n){return n.segments.length>0?new gt([],{[ze]:n}):n}function v2(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=v2(r);if(i===ze&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new gt(n.segments,e);return qB(t)}function qB(n){if(n.numberOfChildren===1&&n.children[ze]){let e=n.children[ze];return new gt(n.segments.concat(e.segments),e.children)}return n}function fs(n){return n instanceof nr}function _2(n,e,t=null,i=null,r=new hs){let o=E2(n);return b2(o,e,t,i,r)}function E2(n){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new gt(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=y2(i);return e??r}function b2(n,e,t,i,r){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return nb(o,o,o,t,i,r);let s=KB(e);if(s.toRoot())return nb(o,o,new gt([],{}),t,i,r);let a=YB(s,o,n),l=a.processChildren?id(a.segmentGroup,a.index,s.commands):x2(a.segmentGroup,a.index,s.commands);return nb(o,a.segmentGroup,l,t,i,r)}function hg(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function sd(n){return typeof n=="object"&&n!=null&&n.outlets}function t2(n,e,t){n||="\u0275";let i=new nr;return i.queryParams={[n]:e},t.parse(t.serialize(i)).queryParams[n]}function nb(n,e,t,i,r,o){let s={};for(let[c,d]of Object.entries(i??{}))s[c]=Array.isArray(d)?d.map(h=>t2(c,h,o)):t2(c,d,o);let a;n===e?a=t:a=w2(n,e,t);let l=y2(v2(a));return new nr(l,s,r)}function w2(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=w2(o,e,t)}),new gt(n.segments,i)}var fg=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&hg(i[0]))throw new ge(4003,!1);let r=i.find(sd);if(r&&r!==MB(i))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function KB(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new fg(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new fg(t,e,i)}var Ol=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function YB(n,e,t){if(n.isAbsolute)return new Ol(e,!0,0);if(!t)return new Ol(e,!1,NaN);if(t.parent===null)return new Ol(t,!0,0);let i=hg(n.commands[0])?0:1,r=t.segments.length-1+i;return QB(t,r,n.numberOfDoubleDots)}function QB(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new ge(4005,!1);r=i.segments.length}return new Ol(i,!1,r-o)}function JB(n){return sd(n[0])?n[0].outlets:{[ze]:n}}function x2(n,e,t){if(n??=new gt([],{}),n.segments.length===0&&n.hasChildren())return id(n,e,t);let i=ZB(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new gt(n.segments.slice(0,i.pathIndex),{});return o.children[ze]=new gt(n.segments.slice(i.pathIndex),n.children),id(o,0,r)}else return i.match&&r.length===0?new gt(n.segments,{}):i.match&&!n.hasChildren()?lb(n,e,t):i.match?id(n,0,r):lb(n,e,t)}function id(n,e,t){if(t.length===0)return new gt(n.segments,{});{let i=JB(t),r={};if(Object.keys(i).some(o=>o!==ze)&&n.children[ze]&&n.numberOfChildren===1&&n.children[ze].segments.length===0){let o=id(n.children[ze],e,t);return new gt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=x2(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new gt(n.segments,r)}}function ZB(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(sd(a))break;let l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!i2(l,c,s))return o;i+=2}else{if(!i2(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function lb(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(sd(o)){let l=XB(o.outlets);return new gt(i,l)}if(r===0&&hg(t[0])){let l=n.segments[e];i.push(new ds(l.path,n2(t[0]))),r++;continue}let s=sd(o)?o.outlets[ze]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&hg(a)?(i.push(new ds(s,n2(a))),r+=2):(i.push(new ds(s,{})),r++)}return new gt(i,{})}function XB(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=lb(new gt([],{}),0,i))}),e}function n2(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function i2(n,e,t){return n==t.path&&Pr(e,t.parameters)}var rd="imperative",Tn=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Tn||{}),_i=class{id;url;constructor(e,t){this.id=e,this.url=t}},wa=class extends _i{type=Tn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Nr=class extends _i{urlAfterRedirects;type=Tn.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},jn=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(jn||{}),ad=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(ad||{}),Fi=class extends _i{reason;code;type=Tn.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function S2(n){return n instanceof Fi&&(n.code===jn.Redirect||n.code===jn.SupersededByNewNavigation)}var po=class extends _i{reason;code;type=Tn.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},xa=class extends _i{error;target;type=Tn.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ll=class extends _i{urlAfterRedirects;state;type=Tn.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pg=class extends _i{urlAfterRedirects;state;type=Tn.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},gg=class extends _i{urlAfterRedirects;state;shouldActivate;type=Tn.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},mg=class extends _i{urlAfterRedirects;state;type=Tn.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yg=class extends _i{urlAfterRedirects;state;type=Tn.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},vg=class{route;type=Tn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},_g=class{route;type=Tn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Eg=class{snapshot;type=Tn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bg=class{snapshot;type=Tn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},wg=class{snapshot;type=Tn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xg=class{snapshot;type=Tn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Vl=class{},Ul=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function e8(n){return!(n instanceof Vl)&&!(n instanceof Ul)}var Sg=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Hl(this.rootInjector)}},Hl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Sg(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Re(Kt))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ig=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=cb(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=cb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=ub(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return ub(e,this._root).map(t=>t.value)}};function cb(n,e){if(n===e.value)return e;for(let t of e.children){let i=cb(n,t);if(i)return i}return null}function ub(n,e){if(n===e.value)return[e];for(let t of e.children){let i=ub(n,t);if(i.length)return i.unshift(e),i}return[]}var vi=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function kl(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var ld=class extends Ig{snapshot;constructor(e,t){super(e),this.snapshot=t,vb(this,e)}toString(){return this.snapshot.toString()}};function I2(n,e){let t=t8(n,e),i=new Nn([new ds("",{})]),r=new Nn({}),o=new Nn({}),s=new Nn({}),a=new Nn(""),l=new go(i,r,s,a,o,ze,n,t.root);return l.snapshot=t.root,new ld(new vi(l,[]),t)}function t8(n,e){let t={},i={},r={},s=new Ea([],t,r,"",i,ze,n,null,{},e);return new cd("",new vi(s,[]))}var go=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(yt(c=>c[hd]))??it(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(yt(e=>ba(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(yt(e=>ba(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Tg(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),r?.data),n._resolvedData)}:i={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},r&&C2(r)&&(i.resolve[hd]=r.title),i}var Ea=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[hd]}constructor(e,t,i,r,o,s,a,l,c,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ba(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ba(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},cd=class extends Ig{url;constructor(e,t){super(t),this.url=e,vb(this,t)}toString(){return T2(this._root)}};function vb(n,e){e.value._routerState=n,e.children.forEach(t=>vb(n,t))}function T2(n){let e=n.children.length>0?` { ${n.children.map(T2).join(", ")} } `:"";return`${n.value}${e}`}function ib(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Pr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Pr(e.params,t.params)||n.paramsSubject.next(t.params),AB(e.url,t.url)||n.urlSubject.next(t.url),Pr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function db(n,e){let t=Pr(n.params,e.params)&&kB(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||db(n.parent,e.parent))}function C2(n){return typeof n.title=="string"||n.title===null}var D2=new Ee(""),pd=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ze;activateEvents=new cn;deactivateEvents=new cn;attachEvents=new cn;detachEvents=new cn;routerOutletData=hM();parentContexts=q(Hl);location=q(so);changeDetector=q(ma);inputBinder=q(Mg,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new hb(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=vn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[oo]})}return n})(),hb=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===go?this.route:e===Hl?this.childContexts:e===D2?this.outletData:this.parent.get(e,t)}},Mg=new Ee("");var _b=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=St({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&W(0,"router-outlet")},dependencies:[pd],encapsulation:2})}return n})();function Eb(n){let e=n.children&&n.children.map(Eb),t=e?ce(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ze&&(t.component=_b),t}function n8(n,e,t){let i=ud(n,e._root,t?t._root:void 0);return new ld(i,e)}function ud(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=i8(n,e,t);return new vi(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>ud(n,a)),s}}let i=r8(e.value),r=e.children.map(o=>ud(n,o));return new vi(i,r)}}function i8(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return ud(n,i,r);return ud(n,i)})}function r8(n){return new go(new Nn(n.url),new Nn(n.params),new Nn(n.queryParams),new Nn(n.fragment),new Nn(n.data),n.outlet,n.component,n)}var Bl=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},A2="ngNavigationCancelingError";function Cg(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=fs(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=M2(!1,jn.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function M2(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[A2]=!0,t.cancellationCode=e,t}function o8(n){return R2(n)&&fs(n.url)}function R2(n){return!!n&&n[A2]}var fb=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),ib(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=kl(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=kl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=kl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=kl(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new xg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new bg(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(ib(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),ib(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},Dg=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Fl=class{component;route;constructor(e,t){this.component=e,this.route=t}};function s8(n,e,t){let i=n._root,r=e?e._root:null;return nd(i,r,t,[i.value])}function a8(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function $l(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!$y(n)?n:e.get(n):i}function nd(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=kl(e);return n.children.forEach(s=>{l8(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>od(a,t.getContext(s),r)),r}function l8(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=c8(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Dg(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?nd(n,e,a?a.children:null,i,r):nd(n,e,t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Fl(a.outlet.component,s))}else s&&od(e,a,r),r.canActivateChecks.push(new Dg(i)),o.component?nd(n,null,a?a.children:null,i,r):nd(n,null,t,i,r);return r}function c8(n,e,t){if(typeof t=="function")return Fn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!_a(n.url,e.url);case"pathParamsOrQueryParamsChange":return!_a(n.url,e.url)||!Pr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!db(n,e)||!Pr(n.queryParams,e.queryParams);default:return!db(n,e)}}function od(n,e,t){let i=kl(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?od(s,e.children.getContext(o),t):od(s,null,t):od(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Fl(e.outlet.component,r)):t.canDeactivateChecks.push(new Fl(null,r)):t.canDeactivateChecks.push(new Fl(null,r))}function gd(n){return typeof n=="function"}function u8(n){return typeof n=="boolean"}function d8(n){return n&&gd(n.canLoad)}function h8(n){return n&&gd(n.canActivate)}function f8(n){return n&&gd(n.canActivateChild)}function p8(n){return n&&gd(n.canDeactivate)}function g8(n){return n&&gd(n.canMatch)}function P2(n){return n instanceof $s||n?.name==="EmptyError"}var ag=Symbol("INITIAL_VALUE");function jl(){return Jr(n=>Kc(n.map(e=>e.pipe(zi(1),Jc(ag)))).pipe(yt(e=>{for(let t of e)if(t!==!0){if(t===ag)return ag;if(t===!1||m8(t))return t}return!0}),Gi(e=>e!==ag),zi(1)))}function m8(n){return fs(n)||n instanceof Bl}function N2(n){return n.aborted?it(void 0).pipe(zi(1)):new st(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function k2(n){return Gs(N2(n))}function y8(n){return Gn(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?it(ce(F({},e),{guardsResult:!0})):v8(o,t,i).pipe(Gn(s=>s&&u8(s)?_8(t,r,n):it(s)),yt(s=>ce(F({},e),{guardsResult:s})))})}function v8(n,e,t){return ln(n).pipe(Gn(i=>S8(i.component,i.route,t,e)),Qr(i=>i!==!0,!0))}function _8(n,e,t){return ln(e).pipe(lf(i=>zo(b8(i.route.parent,t),E8(i.route,t),x8(n,i.path),w8(n,i.route))),Qr(i=>i!==!0,!0))}function E8(n,e){return n!==null&&e&&e(new wg(n)),it(!0)}function b8(n,e){return n!==null&&e&&e(new Eg(n)),it(!0)}function w8(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return it(!0);let i=t.map(r=>Yc(()=>{let o=e._environmentInjector,s=$l(r,o),a=h8(s)?s.canActivate(e,n):Fn(o,()=>s(e,n));return Sa(a).pipe(Qr())}));return it(i).pipe(jl())}function x8(n,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>a8(o)).filter(o=>o!==null).map(o=>Yc(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,c=$l(a,l),d=f8(c)?c.canActivateChild(t,n):Fn(l,()=>c(t,n));return Sa(d).pipe(Qr())});return it(s).pipe(jl())}));return it(r).pipe(jl())}function S8(n,e,t,i){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return it(!0);let o=r.map(s=>{let a=e._environmentInjector,l=$l(s,a),c=p8(l)?l.canDeactivate(n,e,t,i):Fn(a,()=>l(n,e,t,i));return Sa(c).pipe(Qr())});return it(o).pipe(jl())}function I8(n,e,t,i,r){let o=e.canLoad;if(o===void 0||o.length===0)return it(!0);let s=o.map(a=>{let l=$l(a,n),c=d8(l)?l.canLoad(e,t):Fn(n,()=>l(e,t)),d=Sa(c);return r?d.pipe(k2(r)):d});return it(s).pipe(jl(),O2(i))}function O2(n){return vy(fr(e=>{if(typeof e!="boolean")throw Cg(n,e)}),yt(e=>e===!0))}function T8(n,e,t,i,r){let o=e.canMatch;if(!o||o.length===0)return it(!0);let s=o.map(a=>{let l=$l(a,n),c=g8(l)?l.canMatch(e,t):Fn(n,()=>l(e,t));return Sa(c).pipe(k2(r))});return it(s).pipe(jl(),O2(i))}var fo=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},dd=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function C8(n){throw new ge(4e3,!1)}function D8(n){throw M2(!1,jn.GuardRejected)}var pb=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return i;if(r.numberOfChildren>1||!r.children[ze])throw C8(`${e.redirectTo}`);r=r.children[ze]}}async applyRedirectCommands(e,t,i,r,o){let s=await A8(t,r,o);if(s instanceof nr)throw new dd(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new dd(a);return a}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new nr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new gt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new ge(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function A8(n,e,t){if(typeof n=="string")return Promise.resolve(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:c,data:d,title:h,paramMap:f,queryParamMap:g}=e;return dg(Sa(Fn(t,()=>i({params:c,data:d,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:f,queryParamMap:g}))))}function M8(n,e){return n.providers&&!n._injector&&(n._injector=Il(n.providers,e,`Route: ${n.path}`)),n._injector??e}function tr(n){return n.outlet||ze}function R8(n,e){let t=n.filter(i=>tr(i)===e);return t.push(...n.filter(i=>tr(i)!==e)),t}var gb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function P8(n,e,t,i,r,o){let s=F2(n,e,t);return s.matched?(i=M8(e,i),T8(i,e,t,r,o).pipe(yt(a=>a===!0?s:F({},gb)))):it(s)}function F2(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},gb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||l2)(t,n,e);if(!r)return F({},gb);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?F(F({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function r2(n,e,t,i){return t.length>0&&O8(n,t,i)?{segmentGroup:new gt(e,k8(i,new gt(t,n.children))),slicedSegments:[]}:t.length===0&&F8(n,t,i)?{segmentGroup:new gt(n.segments,N8(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new gt(n.segments,n.children),slicedSegments:t}}function N8(n,e,t,i){let r={};for(let o of t)if(Rg(n,e,o)&&!i[tr(o)]){let s=new gt([],{});r[tr(o)]=s}return F(F({},i),r)}function k8(n,e){let t={};t[ze]=e;for(let i of n)if(i.path===""&&tr(i)!==ze){let r=new gt([],{});t[tr(i)]=r}return t}function O8(n,e,t){return t.some(i=>Rg(n,e,i)&&tr(i)!==ze)}function F8(n,e,t){return t.some(i=>Rg(n,e,i))}function Rg(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function L8(n,e,t){return e.length===0&&!n.children[t]}var mb=class{};async function V8(n,e,t,i,r,o,s="emptyOnly",a){return new yb(n,e,t,i,r,s,o,a).recognize()}var U8=31,yb=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new pb(this.urlSerializer,this.urlTree)}noMatchError(e){return new ge(4002,`'${e.segmentGroup}'`)}async recognize(){let e=r2(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),r=new vi(i,t),o=new cd("",r),s=_2(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new Ea([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ze,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,ze,t),rootSnapshot:t}}catch(i){if(i instanceof dd)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof fo?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,r,o){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,o);let s=await this.processSegment(e,t,i,i.segments,r,!0,o);return s instanceof vi?[s]:[]}async processChildren(e,t,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let c=i.children[l],d=R8(t,l),h=await this.processSegmentGroup(e,d,c,l,r);s.push(...h)}let a=L2(s);return B8(a),a}async processSegment(e,t,i,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a)}catch(c){if(c instanceof fo||P2(c))continue;throw c}if(L8(i,r,o))return new mb;throw new fo(i)}async processSegmentAgainstRoute(e,t,i,r,o,s,a,l){if(tr(i)!==s&&(s===ze||!Rg(r,o,i)))throw new fo(r);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,i,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l);throw new fo(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:h,remainingSegments:f}=F2(t,r,o);if(!l)throw new fo(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>U8&&(this.allowRedirects=!1));let g=new Ea(o,c,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,o2(r),tr(r),r.component??r._loadedComponent??null,r,s2(r),e),w=Tg(g,a,this.paramsInheritanceStrategy);if(g.params=Object.freeze(w.params),g.data=Object.freeze(w.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let S=await this.applyRedirects.applyRedirectCommands(d,r.redirectTo,h,g,e),P=await this.applyRedirects.lineralizeSegments(r,S);return this.processSegment(e,i,t,P.concat(f),s,!1,a)}async matchSegmentAgainstRoute(e,t,i,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await dg(P8(t,i,r,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!a?.matched)throw new fo(t);e=i._injector??e;let{routes:l}=await this.getChildConfig(e,i,r),c=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=a,g=new Ea(h,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,o2(i),tr(i),i.component??i._loadedComponent??null,i,s2(i),e),w=Tg(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(w.params),g.data=Object.freeze(w.data);let{segmentGroup:S,slicedSegments:P}=r2(t,h,f,l);if(P.length===0&&S.hasChildren()){let ve=await this.processChildren(c,l,S,g);return new vi(g,ve)}if(l.length===0&&P.length===0)return new vi(g,[]);let L=tr(i)===o,Z=await this.processSegment(c,l,S,P,L?ze:o,!0,g);return new vi(g,Z instanceof vi?[Z]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await dg(I8(e,t,i,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw D8(t)}return{routes:[],injector:e}}};function B8(n){n.sort((e,t)=>e.value.outlet===ze?-1:t.value.outlet===ze?1:e.value.outlet.localeCompare(t.value.outlet))}function j8(n){let e=n.value.routeConfig;return e&&e.path===""}function L2(n){let e=[],t=new Set;for(let i of n){if(!j8(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=L2(i.children);e.push(new vi(i.value,r))}return e.filter(i=>!t.has(i))}function o2(n){return n.data||{}}function s2(n){return n.resolve||{}}function H8(n,e,t,i,r,o,s){return Gn(async a=>{let{state:l,tree:c}=await V8(n,e,t,i,a.extractedUrl,r,o,s);return ce(F({},a),{targetSnapshot:l,urlAfterRedirects:c})})}function $8(n){return Gn(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return it(e);let r=new Set(i.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of V2(a))o.add(l);let s=0;return ln(o).pipe(lf(a=>r.has(a)?G8(a,t,n):(a.data=Tg(a,a.parent,n).resolve,it(void 0))),fr(()=>s++),cf(1),Gn(a=>s===o.size?it(e):kn))})}function V2(n){let e=n.children.map(t=>V2(t)).flat();return[n,...e]}function G8(n,e,t){let i=n.routeConfig,r=n._resolve;return i?.title!==void 0&&!C2(i)&&(r[hd]=i.title),Yc(()=>(n.data=Tg(n,n.parent,t).resolve,z8(r,n,e).pipe(yt(o=>(n._resolvedData=o,n.data=F(F({},n.data),o),null)))))}function z8(n,e,t){let i=ob(n);if(i.length===0)return it({});let r={};return ln(i).pipe(Gn(o=>W8(n[o],e,t).pipe(Qr(),fr(s=>{if(s instanceof Bl)throw Cg(new hs,s);r[o]=s}))),cf(1),yt(()=>r),Qc(o=>P2(o)?kn:wy(o)))}function W8(n,e,t){let i=e._environmentInjector,r=$l(n,i),o=r.resolve?r.resolve(e,t):Fn(i,()=>r(e,t));return Sa(o)}function a2(n){return Jr(e=>{let t=n(e);return t?ln(t).pipe(yt(()=>e)):it(e)})}var bb=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===ze);return i}getResolvedTitleForRoute(t){return t.data[hd]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>q(U2),providedIn:"root"})}return n})(),U2=(()=>{class n extends bb{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Re(QM))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Gl=new Ee("",{factory:()=>({})}),md=new Ee(""),B2=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=q(_E);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await u2(Fn(t,()=>i.loadComponent())),s=await $2(H2(o));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s,s}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await j2(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=o.routes,i._loadedInjector=o.injector,i._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function j2(n,e,t,i){let r=await u2(Fn(t,()=>n.loadChildren())),o=await $2(H2(r)),s;o instanceof Pp||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),i&&i(n);let a,l,c=!1,d;return Array.isArray(s)?(l=s,c=!0):(a=s.create(t).injector,d=s,l=a.get(md,[],{optional:!0,self:!0}).flat()),{routes:l.map(Eb),injector:a,factory:d}}function q8(n){return n&&typeof n=="object"&&"default"in n}function H2(n){return q8(n)?n.default:n}async function $2(n){return n}var Pg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>q(K8),providedIn:"root"})}return n})(),K8=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),G2=new Ee("");var Y8=()=>{},z2=new Ee(""),W2=(()=>{class n{currentNavigation=$(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=$(null);events=new jt;transitionAbortWithErrorSubject=new jt;configLoader=q(B2);environmentInjector=q(Kt);destroyRef=q(Xn);urlSerializer=q(fd);rootContexts=q(Hl);location=q(Pl);inputBindingEnabled=q(Mg,{optional:!0})!==null;titleStrategy=q(bb);options=q(Gl,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=q(Pg);createViewTransition=q(G2,{optional:!0});navigationErrorHandler=q(z2,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>it(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new vg(r)),i=r=>this.events.next(new _g(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;un(()=>{this.transitions?.next(ce(F({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new Nn(null),this.transitions.pipe(Gi(i=>i!==null),Jr(i=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===i.id;return it(i).pipe(Jr(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",jn.SupersededByNewNavigation),kn;this.currentTransition=i;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?ce(F({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload")return this.events.next(new po(a.id,this.urlSerializer.serialize(a.rawUrl),"",ad.IgnoredSameUrlNavigation)),a.resolve(!1),kn;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return it(a).pipe(Jr(h=>(this.events.next(new wa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?kn:Promise.resolve(h))),H8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),fr(h=>{i.targetSnapshot=h.targetSnapshot,i.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=h.urlAfterRedirects,g));let f=new Ll(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:f,source:g,restoredState:w,extras:S}=a,P=new wa(h,this.urlSerializer.serialize(f),g,w);this.events.next(P);let L=I2(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=ce(F({},a),{targetSnapshot:L,urlAfterRedirects:f,extras:ce(F({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(Z=>(Z.finalUrl=f,Z)),it(i)}else return this.events.next(new po(a.id,this.urlSerializer.serialize(a.extractedUrl),"",ad.IgnoredByUrlHandlingStrategy)),a.resolve(!1),kn}),yt(a=>{let l=new pg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=i=ce(F({},a),{guards:s8(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i}),y8(a=>this.events.next(a)),Jr(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw Cg(this.urlSerializer,a.guardsResult);let l=new gg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return kn;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",jn.GuardRejected),kn;if(a.guards.canActivateChecks.length===0)return it(a);let c=new mg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(c),!s())return kn;let d=!1;return it(a).pipe($8(this.paramsInheritanceStrategy),fr({next:()=>{d=!0;let h=new yg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{d||this.cancelNavigationTransition(a,"",jn.NoDataFromResolver)}}))}),a2(a=>{let l=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let f=d._environmentInjector;h.push(this.configLoader.loadComponent(f,d.routeConfig).then(g=>{d.component=g}))}for(let f of d.children)h.push(...l(f));return h},c=l(a.targetSnapshot.root);return c.length===0?it(a):ln(Promise.all(c).then(()=>a))}),a2(()=>this.afterPreactivation()),Jr(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,c=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return c?ln(c).pipe(yt(()=>i)):it(i)}),zi(1),yt(a=>{let l=n8(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=i=a=ce(F({},a),{targetRouterState:l}),this.currentNavigation.update(c=>(c.targetRouterState=l,c)),this.events.next(new Vl),s()&&(new fb(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,c=>this.events.next(c),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(c=>(c.abort=Y8,c)),this.lastSuccessfulNavigation.set(un(this.currentNavigation)),this.events.next(new Nr(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Gs(N2(o.signal).pipe(Gi(()=>!r&&!i.targetRouterState),fr(()=>{this.cancelNavigationTransition(i,o.signal.reason+"",jn.Aborted)}))),fr({complete:()=>{r=!0}}),Gs(this.transitionAbortWithErrorSubject.pipe(fr(a=>{throw a}))),Iy(()=>{o.abort(),r||this.cancelNavigationTransition(i,"",jn.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Qc(a=>{if(r=!0,this.destroyed)return i.resolve(!1),kn;if(R2(a))this.events.next(new Fi(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),o8(a)?this.events.next(new Ul(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new xa(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let c=Fn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(c instanceof Bl){let{message:d,cancellationCode:h}=Cg(this.urlSerializer,c);this.events.next(new Fi(i.id,this.urlSerializer.serialize(i.extractedUrl),d,h)),this.events.next(new Ul(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(c){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(c)}}return kn}))}))}cancelNavigationTransition(t,i,r){let o=new Fi(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=un(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Q8(n){return n!==rd}var q2=new Ee("");var K2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>q(J8),providedIn:"root"})}return n})(),Ag=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},J8=(()=>{class n extends Ag{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wb=(()=>{class n{urlSerializer=q(fd);options=q(Gl,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=q(Pl);urlHandlingStrategy=q(Pg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new nr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof nr?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=I2(null,q(Kt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:()=>q(Z8),providedIn:"root"})}return n})(),Z8=(()=>{class n extends wb{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof wa?this.updateStateMemento():t instanceof po?this.commitTransition(i):t instanceof Ll?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Vl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Fi&&!S2(t)?this.restoreHistory(i):t instanceof xa?this.restoreHistory(i,!0):t instanceof Nr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=F(F({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=F(F({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xb(n,e){n.events.pipe(Gi(t=>t instanceof Nr||t instanceof Fi||t instanceof xa||t instanceof po),yt(t=>t instanceof Nr||t instanceof po?0:(t instanceof Fi?t.code===jn.Redirect||t.code===jn.SupersededByNewNavigation:!1)?2:1),Gi(t=>t!==2),zi(1)).subscribe(()=>{e()})}var Y2={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Q2={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ei=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=q(kp);stateManager=q(wb);options=q(Gl,{optional:!0})||{};pendingTasks=q(Sr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=q(W2);urlSerializer=q(fd);location=q(Pl);urlHandlingStrategy=q(Pg);injector=q(Kt);_events=new jt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=q(K2);injectorCleanup=q(q2,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=q(md,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!q(Mg,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new mn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=un(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Fi&&i.code!==jn.Redirect&&i.code!==jn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Nr)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof Ul){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=F({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Q8(r.source)},s);this.scheduleNavigation(a,rd,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}e8(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),rd,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=F({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(fi)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return un(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Eb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=r?r.snapshot:this.routerState.snapshot.root;h=E2(f)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return b2(h,t,d,c??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let r=fs(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,rd,null,i)}navigate(t,i={skipLocationChange:!1}){return X8(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(eo(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=F({},Y2):i===!1?r=F({},Q2):r=i,fs(t))return XM(this.currentUrlTree,t,r);let o=this.parseUrl(t);return XM(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((h,f)=>{a=h,l=f});let d=this.pendingTasks.add();return xb(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function X8(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ge(4008,!1)}var kr=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=$(null);get href(){return un(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new jt;applicationErrorHandler=q(fi);options=q(Gl,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(q(new Hp("href"),{optional:!0}));let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area"||!!(typeof customElements=="object"&&customElements.get(l)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Nr&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(fs(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l)?.catch(c=>{this.applicationErrorHandler(c)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:fs(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(he(Ei),he(go),Tu("tabindex"),he(is),he(Ni),he(Rl))};static \u0275dir=vn({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&te("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&Vt("href",r.reactiveHref(),B_)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Hu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Hu],replaceUrl:[2,"replaceUrl","replaceUrl",Hu],routerLink:"routerLink"},features:[oo]})}return n})();var nj=new Ee("");function Sb(n,...e){return _r([{provide:md,multi:!0,useValue:n},[],{provide:go,useFactory:ij},{provide:os,multi:!0,useFactory:rj},e.map(t=>t.\u0275providers)])}function ij(){return q(Ei).routerState.root}function rj(){let n=q(qn);return e=>{let t=n.get(ei);if(e!==t.components[0])return;let i=n.get(Ei),r=n.get(oj);n.get(sj)===1&&i.initialNavigation(),n.get(aj,null,{optional:!0})?.setUpPreloading(),n.get(nj,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var oj=new Ee("",{factory:()=>new jt}),sj=new Ee("",{factory:()=>1});var aj=new Ee("");function J2(n,e){let i=!e?.manualCleanup?e?.injector?.get(Xn)??q(Xn):null,r=lj(e?.equal),o;e?.requireSync?o=$({kind:0},{equal:r}):o=$({kind:1,value:e?.initialValue},{equal:r});let s,a=n.subscribe({next:l=>o.set({kind:1,value:l}),error:l=>{o.set({kind:2,error:l}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&o().kind===0)throw new ge(601,!1);return s=i?.onDestroy(a.unsubscribe.bind(a)),ti(()=>{let l=o();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:throw new ge(601,!1)}},{equal:e?.equal})}function lj(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var Ib;try{Ib=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Ib=!1}var Z2=(()=>{class n{_platformId=q(Ji);isBrowser=this._platformId?us(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Ib)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Tb(n){return Array.isArray(n)?n:[n]}var X2=new Set,Ia,tR=(()=>{class n{_platform=q(Z2);_nonce=q(bl,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):uj}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&cj(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cj(n,e){if(!X2.has(n))try{Ia||(Ia=document.createElement("style"),e&&Ia.setAttribute("nonce",e),Ia.setAttribute("type","text/css"),document.head.appendChild(Ia)),Ia.sheet&&(Ia.sheet.insertRule(`@media ${n} {body{ }}`,0),X2.add(n))}catch(t){console.error(t)}}function uj(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var Cb=(()=>{class n{_mediaMatcher=q(tR);_zone=q(yn);_queries=new Map;_destroySubject=new jt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return eR(Tb(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=eR(Tb(t)).map(s=>this._registerQuery(s).observable),o=Kc(r);return o=zo(o.pipe(zi(1)),o.pipe(Ty(1),Sy(0))),o.pipe(yt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),o={observable:new st(s=>{let a=l=>this._zone.run(()=>s.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Jc(i),yt(({matches:s})=>({query:t,matches:s})),Gs(this._destroySubject)),mql:i};return this._queries.set(t,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function eR(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var zl=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let r={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return r?r[t-1]:1}getDefenseBonus(e,t){let i=0,r=[];(e.turnsStationary??0)>=3&&(i+=1,r.push("Shield +1"));let o=t.filter(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1);return o.length&&(i+=o.length,r.push(`Support +${o.length}`)),{bonus:i,tags:r}}getAttackLuckModifier(e){let t=Math.random(),r={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:r,tag:`CRIT! +${r}`,isCrit:!0}:t>.8?{delta:-r,tag:`MISS! -${r}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}getWallHitAmount(e){return e===1?34:e===2?51:101}applyDamage(e,t){let i=e.armorHp??0,r=Math.max(0,i-t),o=Math.max(0,t-i),s=Math.max(0,e.points-o),{tier:a,level:l}=this.calculateTierAndLevel(s);return ce(F({},e),{armorHp:r,points:s,tier:a,level:l})}calculateHitChance(e,t){let i=t.tier-e.tier,r=e.level??1,o=0;i<=0?o=100:i===1?o=Math.min(100,50+r*15):i===2?o=Math.min(100,25+r*5):o=Math.min(100,1+r*1);let s=e.hasWeapon&&t.tier>e.tier?10:0,a=t.hasArmor?10:0;return Math.max(1,Math.min(100,o+s-a))}isDiagonalBlocked(e,t,i){let r=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(r===0||o===0)return!1;let s=i(e.x,e.y,e.x+r,e.y),a=i(e.x,e.y,e.x,e.y+o),l=i(t.x-r,t.y,t.x,t.y),c=i(t.x,t.y-o,t.x,t.y);return!!(s||a||l||c)}checkWallAlongPath(e,t,i,r){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),l=Math.sign(s),c=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=c;d++){let h={x:e.x+a*(d-1),y:e.y+l*(d-1)},f={x:e.x+a*d,y:e.y+l*d},g=r(h.x,h.y,f.x,f.y);if(g)return g.owner===i?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:h}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var kg=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,i){let r=[t,i];for(let o of r){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,i,r){return e.some(o=>o.owner===t&&(o.position.x===i.x&&o.position.y===i.y||o.position.x===r.x&&o.position.y===r.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var Og=class n{entriesSignal=$([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(i=>[...i,{text:e,color:t,type:"other"}])}addCombat(e,t,i){let r=i?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:r,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var fj={MASTERIES:{en:"Masteries",uk:"\u041C\u0430\u0439\u0441\u0442\u0435\u0440\u043D\u0456\u0441\u0442\u044C"},BACK_TO_DEFENSE:{en:"Back to Defense",uk:"\u041D\u0430\u0437\u0430\u0434 \u0434\u043E \u0437\u0430\u0445\u0438\u0441\u0442\u0443"},TOTAL_XP:{en:"XP",uk:"\u0414\u043E\u0441\u0432\u0456\u0434"},SPENT:{en:"Spent",uk:"\u0412\u0438\u0442\u0440\u0430\u0447\u0435\u043D\u043E"},AVAILABLE:{en:"Available",uk:"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E"},LOG_IN_MASTERY_MSG:{en:"Log in to earn and spend Mastery XP.",uk:"\u0423\u0432\u0456\u0439\u0434\u0456\u0442\u044C, \u0449\u043E\u0431 \u0437\u0430\u0440\u043E\u0431\u043B\u044F\u0442\u0438 \u0442\u0430 \u0432\u0438\u0442\u0440\u0430\u0447\u0430\u0442\u0438 \u0434\u043E\u0441\u0432\u0456\u0434 \u043C\u0430\u0439\u0441\u0442\u0435\u0440\u043D\u043E\u0441\u0442\u0456."},NEED_LOG_IN:{en:"You need to be logged in to earn XP and unlock Masteries.",uk:"\u0412\u0430\u043C \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E \u0443\u0432\u0456\u0439\u0442\u0438, \u0449\u043E\u0431 \u0437\u0430\u0440\u043E\u0431\u043B\u044F\u0442\u0438 \u0434\u043E\u0441\u0432\u0456\u0434 \u0442\u0430 \u0432\u0456\u0434\u043A\u0440\u0438\u0432\u0430\u0442\u0438 \u043C\u0430\u0439\u0441\u0442\u0435\u0440\u043D\u0456\u0441\u0442\u044C."},LOGIN_GOOGLE:{en:"Login with Google",uk:"\u0423\u0432\u0456\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Google"},MASTERIES_SUBTITLE:{en:"Spend points to permanently improve each tower tier.",uk:"\u0412\u0438\u0442\u0440\u0430\u0447\u0430\u0439\u0442\u0435 \u043E\u0447\u043A\u0438, \u0449\u043E\u0431 \u043D\u0430\u0437\u0430\u0432\u0436\u0434\u0438 \u043F\u043E\u043A\u0440\u0430\u0449\u0438\u0442\u0438 \u043A\u043E\u0436\u0435\u043D \u0442\u0438\u0440 \u0432\u0435\u0436."},DAMAGE:{en:"Damage",uk:"\u0428\u043A\u043E\u0434\u0430"},RANGE:{en:"Range",uk:"\u0414\u0430\u043B\u044C\u043D\u0456\u0441\u0442\u044C"},PER_LEVEL:{en:"per level",uk:"\u0437\u0430 \u0440\u0456\u0432\u0435\u043D\u044C"},REQUIRES_5_POINTS:{en:"Requires 5 points in tier.",uk:"\u041F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043E\u0447\u043E\u043A \u0432 \u0442\u0438\u0440\u0456"},SAVE_CHANGES:{en:"Save Changes",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u043C\u0456\u043D\u0438"},SAVING:{en:"Saving...",uk:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043D\u044F..."},SAVED:{en:"Saved",uk:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E"},COST:{en:"Cost",uk:"\u0412\u0430\u0440\u0442\u0456\u0441\u0442\u044C"},MAXED:{en:"MAXED",uk:"\u041C\u0410\u041A\u0421"},LOCAL_STORAGE_MSG:{en:"Changes are stored locally until you save.",uk:"\u0417\u043C\u0456\u043D\u0438 \u0437\u0431\u0435\u0440\u0456\u0433\u0430\u044E\u0442\u044C\u0441\u044F \u043B\u043E\u043A\u0430\u043B\u044C\u043D\u043E, \u043F\u043E\u043A\u0438 \u0432\u0438 \u0457\u0445 \u043D\u0435 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u0442\u0435."},T1_NAME:{en:"Tier 1 \u2013 Frost",uk:"\u0422\u0438\u0440 1 \u2013 \u041C\u043E\u0440\u043E\u0437"},T1_GOLDEN_TITLE:{en:"Frost Aura",uk:"\u0410\u0443\u0440\u0430 \u043C\u043E\u0440\u043E\u0437\u0443"},T1_GOLDEN_DESC:{en:"Slow enemies by an extra 10% and increase aura radius.",uk:"\u0423\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u043D\u0430 \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 10% \u0442\u0430 \u0437\u0431\u0456\u043B\u044C\u0448\u0443\u0454 \u0440\u0430\u0434\u0456\u0443\u0441 \u0430\u0443\u0440\u0438."},T2_NAME:{en:"Tier 2 \u2013 Precision",uk:"\u0422\u0438\u0440 2 \u2013 \u0422\u043E\u0447\u043D\u0456\u0441\u0442\u044C"},T2_GOLDEN_TITLE:{en:"Critical Focus",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0435 \u0444\u043E\u043A\u0443\u0441\u0443\u0432\u0430\u043D\u043D\u044F"},T2_GOLDEN_DESC:{en:"+10% chance to deal double damage and faster projectiles.",uk:"+10% \u0448\u0430\u043D\u0441\u0443 \u043D\u0430 \u043F\u043E\u0434\u0432\u0456\u0439\u043D\u0443 \u0448\u043A\u043E\u0434\u0443 \u0442\u0430 \u0448\u0432\u0438\u0434\u0448\u0456 \u0441\u043D\u0430\u0440\u044F\u0434\u0438."},T3_NAME:{en:"Tier 3 \u2013 Impact",uk:"\u0422\u0438\u0440 3 \u2013 \u0423\u0434\u0430\u0440"},T3_GOLDEN_TITLE:{en:"Concussive Blasts",uk:"\u041A\u043E\u043D\u0442\u0443\u0437\u0456\u0439\u043D\u0456 \u0432\u0438\u0431\u0443\u0445\u0438"},T3_GOLDEN_DESC:{en:"Chance to briefly stun enemies and larger explosions.",uk:"\u0428\u0430\u043D\u0441 \u043D\u0430 \u043A\u043E\u0440\u043E\u0442\u043A\u0438\u0439 \u0447\u0430\u0441 \u043F\u0440\u0438\u0433\u043E\u043B\u043E\u043C\u0448\u0438\u0442\u0438 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u0442\u0430 \u0431\u0456\u043B\u044C\u0448\u0456 \u0432\u0438\u0431\u0443\u0445\u0438."},T4_NAME:{en:"Tier 4 \u2013 Storm",uk:"\u0422\u0438\u0440 4 \u2013 \u0428\u0442\u043E\u0440\u043C"},T4_GOLDEN_TITLE:{en:"Chain Lightning",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430"},T4_GOLDEN_DESC:{en:"Attacks can jump to extra enemies with higher frequency.",uk:"\u0410\u0442\u0430\u043A\u0438 \u043C\u043E\u0436\u0443\u0442\u044C \u043F\u0435\u0440\u0435\u0441\u043A\u0430\u043A\u0443\u0432\u0430\u0442\u0438 \u043D\u0430 \u0434\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0438\u0445 \u0432\u043E\u0440\u043E\u0433\u0456\u0432."},FINAL_STRIKE_INFO:{en:"If (Current HP / Max HP) < 0.15: Normal Enemy: Instant Kill. Boss: Deal 300% normal damage (Bosses are resistant to instant death).",uk:"\u042F\u043A\u0449\u043E (\u041F\u043E\u0442\u043E\u0447\u043D\u0456 HP / \u041C\u0430\u043A\u0441. HP) < 0.15: \u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439 \u0432\u043E\u0440\u043E\u0433: \u041C\u0438\u0442\u0442\u0454\u0432\u0435 \u0432\u0431\u0438\u0432\u0441\u0442\u0432\u043E. \u0411\u043E\u0441: \u0417\u0430\u0432\u0434\u0430\u0454 300% \u0437\u0432\u0438\u0447\u0430\u0439\u043D\u043E\u0457 \u0448\u043A\u043E\u0434\u0438 (\u0411\u043E\u0441\u0438 \u0441\u0442\u0456\u0439\u043A\u0456 \u0434\u043E \u043C\u0438\u0442\u0442\u0454\u0432\u043E\u0457 \u0441\u043C\u0435\u0440\u0442\u0456)."},FINAL_STRIKE:{en:"Final Strike",uk:"\u041E\u0441\u0442\u0430\u043D\u043D\u0456\u0439 \u0443\u0434\u0430\u0440"},SHATTER_INFO:{en:"Each hit adds 1 stack (Max 5). Incoming damage is multiplied by (1 + (shatterStacks * 0.10)). (Max +50% damage taken).",uk:"\u041A\u043E\u0436\u0435\u043D \u0443\u0434\u0430\u0440 \u0434\u043E\u0434\u0430\u0454 1 \u0437\u0430\u0440\u044F\u0434 (\u043C\u0430\u043A\u0441\u0438\u043C\u0443\u043C 5). \u0412\u0445\u0456\u0434\u043D\u0430 \u0448\u043A\u043E\u0434\u0430 \u043C\u043D\u043E\u0436\u0438\u0442\u044C\u0441\u044F \u043D\u0430 (1 + (\u0440\u043E\u0437\u0431\u0438\u0442\u0456 \u0437\u0430\u0440\u044F\u0434\u0438 * 0.10)). (\u041C\u0430\u043A\u0441\u0438\u043C\u0443\u043C +50% \u043E\u0442\u0440\u0438\u043C\u0430\u043D\u043E\u0457 \u0448\u043A\u043E\u0434\u0438)."},SHATTER:{en:"Shatter",uk:"\u0420\u043E\u0437\u043A\u043E\u043B\u043E\u0442\u0438"},CHAIN_LIGHTNING_INFO:{en:"25% chance to deal 50% damage to two adjacent targets",uk:"\u0428\u0430\u043D\u0441 25% \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u0434\u0432\u043E\u043C \u0441\u0443\u0441\u0456\u0434\u043D\u0456\u043C \u0446\u0456\u043B\u044F\u043C 50% \u0443\u0440\u043E\u043D\u0443"},CHAIN_LIGHTNING:{en:"Chain Lightning",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430"},FROST_AURA_INFO:{en:"Apply 30% slow to enemies in range.",uk:"\u0423\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u0443 \u0440\u0430\u0434\u0456\u0443\u0441\u0456 \u0434\u0456\u0457 \u043D\u0430 30%."},FROST_AURA:{en:"Frost Aura",uk:"\u041C\u043E\u0440\u043E\u0437\u043D\u0430 \u0430\u0443\u0440\u0430"},BUY_ABILITY:{en:"Buy Ability",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0434\u0456\u0431\u043D\u0456\u0441\u0442\u044C"},ABILITY_ACTIVE:{en:"Ability Active",uk:"\u0410\u043A\u0442\u0438\u0432\u043D\u0430 \u0437\u0434\u0430\u0442\u043D\u0456\u0441\u0442\u044C"},TRY_AGAIN:{en:"TRY AGAIN",uk:"\u0421\u041F\u0420\u041E\u0411\u0423\u0419\u0422\u0415 \u0417\u041D\u041E\u0412\u0423"},WAVES:{en:"waves",uk:"\u0445\u0432\u0438\u043B\u044C"},YOU_SURVIVED:{en:"You survived",uk:"\u0422\u0438 \u0432\u0438\u0436\u0438\u0432"},GAME_OVER:{en:"GAME OVER",uk:"\u0413\u0420\u0410 \u0417\u0410\u041A\u0406\u041D\u0427\u0415\u041D\u0410"},TO_PLACE_DEFENDER:{en:"to place a defender",uk:"\u0449\u043E\u0431 \u0440\u043E\u0437\u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},SELECT_BUILD_TILE:{en:"Select a buildable tile",uk:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u0431\u0443\u0434\u0456\u0432\u043D\u0438\u0446\u0442\u0432\u0430,"},SELL:{en:"SELL",uk:"\u041F\u0420\u041E\u0414\u0410\u0422\u0418"},MAX_LEVEL:{en:"MAX LEVEL",uk:"\u041C\u0410\u041A\u0421 \u0420\u0406\u0412\u0415\u041D\u042C"},UPGRADE:{en:"UPGRADE",uk:"\u041E\u041D\u041E\u0412\u041B\u0415\u041D\u041D\u042F"},TIER:{en:"Tier",uk:"\u0420\u0430\u043D\u0433"},LEVEL:{en:"Level",uk:"\u0420\u0456\u0432\u0435\u043D\u044C"},DEFENDER_INFO:{en:"Defender Info",uk:"\u0406\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044F \u043F\u0440\u043E \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},BUY_DEFENDER:{en:"Buy Defender",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},START_WAVE:{en:"START WAVE",uk:"\u041F\u041E\u0427\u0410\u0422\u041E\u041A \u0425\u0412\u0418\u041B\u0406"},WAVE_IN_PROGRESS:{en:"WAVE IN PROGRESS",uk:"\u0425\u0412\u0418\u041B\u042F \u0412 \u041F\u0420\u041E\u0426\u0415\u0421\u0406"},RESTART_GAME:{en:"RESTART GAME",uk:"\u041F\u0415\u0420\u0415\u0417\u0410\u041F\u0423\u0421\u041A \u0413\u0420\u0418"},WAVE:{en:"WAVE",uk:"\u0425\u0412\u0418\u041B\u042F"},LIVES:{en:"LIVES",uk:"\u0416\u0418\u0422\u0422\u042F"},MONEY:{en:"MONEY",uk:"\u0413\u0420\u041E\u0428\u0406"},EXIT_GAME:{en:"EXIT GAME",uk:"\u0412\u0418\u0425\u0406\u0414 \u0417 \u0413\u0420\u0418"},TOWER_DEFFENCE_DESCRIPTION:{en:"A new game is already in development. Stay tuned for a completely different strategy experience. Coming soon to Game Center.",uk:"\u041D\u043E\u0432\u0430 \u0433\u0440\u0430 \u0432\u0436\u0435 \u0440\u043E\u0437\u0440\u043E\u0431\u043B\u044F\u0454\u0442\u044C\u0441\u044F. \u0421\u043B\u0456\u0434\u043A\u0443\u0439\u0442\u0435 \u0437\u0430 \u043E\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044F\u043C\u0438, \u0449\u043E\u0431 \u0434\u0456\u0437\u043D\u0430\u0442\u0438\u0441\u044F \u043F\u0440\u043E \u0437\u043E\u0432\u0441\u0456\u043C \u0456\u043D\u0448\u0438\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u0434\u043E\u0441\u0432\u0456\u0434. \u0421\u043A\u043E\u0440\u043E \u0432 \u0456\u0433\u0440\u043E\u0432\u043E\u043C\u0443 \u0446\u0435\u043D\u0442\u0440\u0456."},SHAPE_TACTIC_DESCRIPTION:{en:"Strategic turn-based combat with AI and merging mechanics. Build your base, manage resources, and conquer the battlefield.",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u043F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0438\u0439 \u0431\u0456\u0439 \u0437\u0456 \u0448\u0442\u0443\u0447\u043D\u0438\u043C \u0456\u043D\u0442\u0435\u043B\u0435\u043A\u0442\u043E\u043C \u0442\u0430 \u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0438\u043C\u0438 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0430\u043C\u0438. \u041F\u043E\u0431\u0443\u0434\u0443\u0439\u0442\u0435 \u0441\u0432\u043E\u044E \u0431\u0430\u0437\u0443, \u043A\u0435\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043C\u0438 \u0442\u0430 \u0437\u0430\u0432\u043E\u0439\u043E\u0432\u0443\u0439\u0442\u0435 \u043F\u043E\u043B\u0435 \u0431\u043E\u044E."},IRON_CYCLE:{en:"Iron Cycle",uk:"\u0426\u0438\u043A\u043B \u0417\u0430\u043B\u0456\u0437\u0430"},NEW_DESIGN_UNIT:{en:"New Evolution",uk:"\u041D\u043E\u0432\u0430 \u0435\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},NEW_UNIT_EVOLUTION:{en:"New Unit Evolution",uk:"\u041D\u043E\u0432\u0430 \u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},T4_4_TILES:{en:"T4: 4 tiles",uk:"T4: 4 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},TURN_3:{en:"Turn 3",uk:"\u0425\u0456\u0434 3"},TURN_4:{en:"Turn 4",uk:"\u0425\u0456\u0434 4"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0414\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},PLUS_2_IRON_PER_TURN:{en:"+2 Iron/turn",uk:"+2 \u0417\u0430\u043B\u0456\u0437\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function iR(n,e){let t=fj[n];return t?t[e]??t.en:n}var Tt=class n{difficultySignal=$("normal");mapSizeSignal=$(10);langSignal=$("uk");customModeSignal=$(!1);version="v.2.2.3";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),i=e%2===0;return t==="baby"?i?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return iR(e,this.langSignal())}customMode(){return this.customModeSignal()}setCustomMode(e){this.customModeSignal.set(e),this.persistSettings()}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let i=["baby","normal","hard","nightmare"],r=[10,20,30],o=["en","uk"],s=t.difficulty&&i.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&r.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),l=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(l),this.customModeSignal.set(!!t.customMode)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal(),customMode:this.customModeSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var Fg=class n{generateForests(e,t,i){let r=e*e,o=Math.max(1,Math.floor(r*.1)),s=[],a=(l,c)=>{let d=Math.max(Math.abs(l-t.x),Math.abs(c-t.y)),h=Math.max(Math.abs(l-i.x),Math.abs(c-i.y));return d<=3||h<=3};for(;s.length<o;){let l=Math.floor(Math.random()*e),c=Math.floor(Math.random()*e);a(l,c)||s.some(d=>d.x===l&&d.y===c)||s.push({x:l,y:c})}return s}generateMines(e,t,i,r){let o=new Set(r.map(c=>`${c.x},${c.y}`)),s=e===10?4:Math.max(1,Math.floor(e*e*.04)),a=[],l=(c,d)=>{let h=Math.max(Math.abs(c-t.x),Math.abs(d-t.y)),f=Math.max(Math.abs(c-i.x),Math.abs(d-i.y));return h<=3||f<=3};for(;a.length<s;){let c=Math.floor(Math.random()*e),d=Math.floor(Math.random()*e);if(l(c,d))continue;let h=`${c},${d}`;o.has(h)||a.some(f=>f.x===c&&f.y===d)||a.push({x:c,y:d})}return a}computeVisibility(e,t,i,r,o){let s={player:new Set,ai:new Set},a=(d,h)=>d>=0&&d<e&&h>=0&&h<e,l=(d,h,f)=>{a(h,f)&&d.add(`${h},${f}`)},c=(d,h,f)=>{for(let g=-f;g<=f;g++)for(let w=-f;w<=f;w++){let S=h.x+g,P=h.y+w;Math.max(Math.abs(g),Math.abs(w))<=f&&l(d,S,P)}};if(o){for(let d=0;d<e;d++)for(let h=0;h<e;h++)s.player.add(`${d},${h}`),s.ai.add(`${d},${h}`);return s}c(s.player,i,3),c(s.ai,r,3);for(let d of t){let h=d.owner==="player"?s.player:s.ai;c(h,d.position,2)}return s}mergeExplored(e,t){let i=new Set(e);return t.forEach(r=>i.add(r)),i}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var Lg=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let i of t)if(e>=i)return i;return 0}computeWoodGain(e,t){let i=e.filter(r=>r.owner===t).filter(r=>r.position&&r.position.x!==void 0&&r.position.y!==void 0).length;return i>0?i*2:0}applyMonopolyTick(e,t,i){let r=t.length;if(r===0)return{next:{player:0,ai:0}};let o=c=>i.filter(d=>d.owner===c&&t.some(h=>h.x===d.position.x&&h.y===d.position.y)).length,s=o("player"),a=o("ai"),l={player:e.player,ai:e.ai};if(s===r){if(l.player=e.player+1,l.ai=0,l.player>=10)return{next:l,winner:"player"}}else if(a===r){if(l.ai=e.ai+1,l.player=0,l.ai>=10)return{next:l,winner:"ai"}}else l.player=0,l.ai=0;return{next:l}}computeAiReserveDump(e,t,i,r){let o=i,s=[];for(let l=-2;l<=2;l++)for(let c=-2;c<=2;c++){if(l===0&&c===0)continue;let d=t.x+l,h=t.y+c;d<0||d>=e||h<0||h>=e||Math.max(Math.abs(l),Math.abs(c))>2||r(d,h)||s.push({x:d,y:h})}let a=[];for(;o>0&&s.length>0;){let l=this.getHighestAffordableCost(o);if(l<=0)break;let c=this.calculateTierAndLevel(l),d=s.shift();a.push({id:crypto.randomUUID(),position:F({},d),level:c.level,tier:c.tier,points:l,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=l}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vg=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(b=>b.owner==="ai"&&!b.hasActed);t=t.filter(b=>!(b.tier<=2&&e.isForest(b.position.x,b.position.y)&&e.isAnchoredGatherer(b.id)));let i=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;i&&(t=t.filter(b=>b.id===i));let r=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:r==="rage"?5e4:r==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),l=e.forestsSignal(),d=l.filter(b=>!e.getUnitAt(b.x,b.y)).filter(b=>e.isVisibleToAi(b.x,b.y)),h=l.filter(b=>!e.isVisibleToAi(b.x,b.y)),f=e.unitsSignal().filter(b=>b.owner==="ai"&&e.isForest(b.position.x,b.position.y)).length,g=e.unitsSignal().filter(b=>b.owner==="ai").length,w=[1,2,3].some(b=>e.unitsSignal().filter(le=>le.owner==="ai"&&le.tier===b&&!e.isForest(le.position.x,le.position.y)).length>=5),S=e.unitsSignal().filter(b=>b.owner==="player"),P=S.some(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3),L=S.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=4),Z=L.length>0,be=L.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=2).length>0,Ce=S.some(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=5),Te=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,O=e.unitsSignal().filter(b=>b.owner==="ai"),I=O.filter(b=>b.tier===3&&!e.isForest(b.position.x,b.position.y)).length,N=O.filter(b=>b.tier===4&&!e.isForest(b.position.x,b.position.y)).length,D=I+N>=5,x=D?"full_rush":Z?"defense":Te?"expansion":"none";if(x!==this.lastPhase){try{console.log(x==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":x==="defense"?"AI Phase: Base Defense Activated":x==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=x}D&&t.sort((b,le)=>{let qe=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ke=Math.abs(le.position.x-a.x)+Math.abs(le.position.y-a.y);return qe-Ke});let R=typeof e.aggressionMode=="function"?!!e.aggressionMode():S.filter(b=>e.isForest(b.position.x,b.position.y)).length*2>=t.filter(b=>e.isForest(b.position.x,b.position.y)).length*2,M=l.length>0?l.every(b=>{let le=e.getUnitAt(b.x,b.y);return!!le&&le.owner==="ai"}):!0,me=l.length>0?l.every(b=>!!e.getUnitAt(b.x,b.y)):!1,Le=l.filter(b=>{let le=e.getUnitAt(b.x,b.y);return!!le&&le.owner==="player"}),pe=null,Ut=t.filter(b=>Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3).length,Zt={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Pe=L.length>0?L.reduce((b,le)=>{let qe=Math.max(Math.abs(le.position.x-s.x),Math.abs(le.position.y-s.y)),Ke=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y));return qe<Ke?le:b},L[0]):null,zt=t.length>0?t.reduce((b,le)=>this.combat.calculateTotalPoints(le)>this.combat.calculateTotalPoints(b)?le:b,t[0]):null,lt=[];if(Pe){let b=Pe.position.x,le=Pe.position.y,qe=Math.sign(s.x-b),Ke=Math.sign(s.y-le),ae=0,bt=Math.max(10,e.gridSize*2);for(;b!==s.x||le!==s.y;){if(ae++,ae>bt){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(b+=qe,le+=Ke,!e.inBounds(b,le)||b===s.x&&le===s.y)break;lt.push({x:b,y:le})}}Z&&zt&&Pe&&(this.goals.set(zt.id,{x:Pe.position.x,y:Pe.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(zt.id,e.turnSignal()+3));let oe=new Map(e.aiUnitTimeNearBase()),se=new Map(e.unitStutterBanSignal?.()??new Map),we=new Map;for(let[b,le]of this.goals.entries())if(le&&e.isForest(le.x,le.y)){let qe=`${le.x},${le.y}`;we.set(qe,(we.get(qe)||0)+1)}for(let b of t){let le=e.calculateValidMoves(b),qe=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y))<=3,Ke=oe.get(b.id)||0,ae=this.goals.get(b.id)||null,bt=ae!==null,Ii=bt?(()=>{let z=e.getUnitAt(ae.x,ae.y);return!!(z&&z.owner==="ai"&&this.combat.calculateTotalPoints(z)>=this.combat.calculateTotalPoints(b))})():!1,oi=(!bt||Ii)&&(!e.isForest(b.position.x,b.position.y)||Ce||b.tier>=3),Ps=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(oi){if(Ps)ae={x:a.x,y:a.y};else if(e.isForest(b.position.x,b.position.y)){let z=S.filter(V=>e.isForest(V.position.x,V.position.y));if(R&&z.length>0){let V=z.reduce((J,X)=>{let De=Math.abs(b.position.x-X.position.x)+Math.abs(b.position.y-X.position.y),Ve=Math.abs(b.position.x-J.position.x)+Math.abs(b.position.y-J.position.y);return De<Ve?X:J},z[0]);ae={x:V.position.x,y:V.position.y}}else{let V=S.length===0?null:[...S].sort((X,De)=>{let Ve=Math.abs(b.position.x-X.position.x)+Math.abs(b.position.y-X.position.y),Xe=Math.abs(b.position.x-De.position.x)+Math.abs(b.position.y-De.position.y);return Ve-Xe})[0];V?ae={x:V.position.x,y:V.position.y}:d.length>0?ae=d.reduce((J,X)=>Math.abs(b.position.x-X.x)+Math.abs(b.position.y-X.y)<Math.abs(b.position.x-J.x)+Math.abs(b.position.y-J.y)?X:J,d[0]):h.length>0?ae=h.reduce((J,X)=>Math.abs(b.position.x-X.x)+Math.abs(b.position.y-X.y)<Math.abs(b.position.x-J.x)+Math.abs(b.position.y-J.y)?X:J,h[0]):ae={x:0,y:0}}}else{let z=S.filter(V=>e.isForest(V.position.x,V.position.y)).map(V=>({x:V.position.x,y:V.position.y}));if(z.length>0)ae=z.reduce((J,X)=>{let De=Math.abs(b.position.x-X.x)+Math.abs(b.position.y-X.y),Ve=Math.abs(b.position.x-J.x)+Math.abs(b.position.y-J.y);return De<Ve?X:J},z[0]);else if(d.length>0){let V=Math.min(...d.map(X=>we.get(`${X.x},${X.y}`)||0)),J=d.filter(X=>(we.get(`${X.x},${X.y}`)||0)===V);ae=J.reduce((X,De)=>Math.abs(b.position.x-De.x)+Math.abs(b.position.y-De.y)<Math.abs(b.position.x-X.x)+Math.abs(b.position.y-X.y)?De:X,J[0])}else if(h.length>0){let V=Math.min(...h.map(X=>we.get(`${X.x},${X.y}`)||0)),J=h.filter(X=>(we.get(`${X.x},${X.y}`)||0)===V);ae=J.reduce((X,De)=>Math.abs(b.position.x-De.x)+Math.abs(b.position.y-De.y)<Math.abs(b.position.x-X.x)+Math.abs(b.position.y-X.y)?De:X,J[0])}else{let V=S.length===0?null:[...S].sort((X,De)=>{let Ve=Math.abs(b.position.x-X.position.x)+Math.abs(b.position.y-X.position.y),Xe=Math.abs(b.position.x-De.position.x)+Math.abs(b.position.y-De.position.y);return Ve-Xe})[0];ae=V?{x:V.position.x,y:V.position.y}:{x:0,y:0}}}this.goals.set(b.id,ae)}Ut>3&&Ke>=5&&(ae=Zt);let $n=e.isForest(b.position.x,b.position.y),Dc=$n&&(b.forestOccupationTurns??0)>0&&!(b.productionActive??!1),Ac=e.unitsSignal().some(z=>z.owner==="ai"&&z.id!==b.id&&z.tier<=2&&Math.max(Math.abs(z.position.x-b.position.x),Math.abs(z.position.y-b.position.y))<=2);if(Dc&&!Ce&&b.tier<3){this.goals.set(b.id,{x:b.position.x,y:b.position.y});continue}if(b.tier>=3){let z=l,V=z.length?z.reduce((X,De)=>{let Ve=Math.abs(b.position.x-De.x)+Math.abs(b.position.y-De.y),Xe=Math.abs(b.position.x-X.x)+Math.abs(b.position.y-X.y);return Ve<Xe?De:X},z[0]):null;if((b.forestOccupationTurns??0)===0&&!$n&&V&&(ae={x:V.x,y:V.y},this.goals.set(b.id,ae)),$n&&Ac){this.goals.set(b.id,{x:a.x,y:a.y});let X=[{x:b.position.x+1,y:b.position.y},{x:b.position.x-1,y:b.position.y},{x:b.position.x,y:b.position.y+1},{x:b.position.x,y:b.position.y-1}].filter(Ve=>e.inBounds(Ve.x,Ve.y));if(X.filter(Ve=>!!e.getWallBetween(b.position.x,b.position.y,Ve.x,Ve.y)).length===X.length){let Ve=X.reduce((Xe,dt)=>{let wt=Math.abs(dt.x-a.x)+Math.abs(dt.y-a.y),mt=Math.abs(Xe.x-a.x)+Math.abs(Xe.y-a.y);return wt<mt?dt:Xe});pe={unit:b,target:{x:b.position.x,y:b.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:F({},b.position),to:Ve}};continue}}}if(le.some(z=>z.x===a.x&&z.y===a.y)){let z=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,V=5e7+o+z;(pe===null||V>pe.score)&&(pe={unit:b,target:{x:a.x,y:a.y},score:V,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let z=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(V=>e.inBounds(V.x,V.y));for(let V of z){let J=e.getWallBetween(a.x,a.y,V.x,V.y);if(J&&J.owner==="neutral"){if(b.position.x===V.x&&b.position.y===V.y||b.position.x===a.x&&b.position.y===a.y){let De=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,Ve=2e6+o+De;(pe===null||Ve>pe.score)&&(pe={unit:b,target:F({},b.position),score:Ve,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:V.x,y:V.y}}})}else if(le.some(Ve=>Ve.x===V.x&&Ve.y===V.y||Ve.x===a.x&&Ve.y===a.y)){let Ve=le.find(mt=>mt.x===V.x&&mt.y===V.y||mt.x===a.x&&mt.y===a.y),Xe=b.tier===3&&b.level>=2||b.tier>=4?3e5:0,dt=18e5+o+Xe;(pe===null||dt>pe.score)&&(pe={unit:b,target:{x:Ve.x,y:Ve.y},score:dt,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(ae){let z=e.getUnitAt(ae.x,ae.y);if(z&&z.owner==="player"&&e.isForest(ae.x,ae.y)){let V=ae.x,J=ae.y;if(le.some(De=>De.x===V&&De.y===J)){(pe===null||3e5>pe.score)&&(pe={unit:b,target:{x:V,y:J},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let De=d.length>0?d:h;if(De.length>0)ae=De.reduce((Xe,dt)=>{let wt=Math.abs(b.position.x-dt.x)+Math.abs(b.position.y-dt.y),mt=Math.abs(b.position.x-Xe.x)+Math.abs(b.position.y-Xe.y);return wt<mt?dt:Xe},De[0]),this.goals.set(b.id,ae);else continue}}}let kt=null;if(ae&&e.isForest(ae.x,ae.y)&&!e.getUnitAt(ae.x,ae.y)){let V=[{x:ae.x+1,y:ae.y},{x:ae.x-1,y:ae.y},{x:ae.x,y:ae.y+1},{x:ae.x,y:ae.y-1}].filter(J=>e.inBounds(J.x,J.y)).filter(J=>{let X=e.getWallBetween(J.x,J.y,ae.x,ae.y);return!!(X&&X.owner==="neutral")});V.length>0&&(kt=V.reduce((J,X)=>{let De=Math.abs(b.position.x-J.x)+Math.abs(b.position.y-J.y);return Math.abs(b.position.x-X.x)+Math.abs(b.position.y-X.y)+3<De?X:J},V[0]))}let Wr=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let z of Wr){let V={x:b.position.x+z.x,y:b.position.y+z.y};if(!e.inBounds(V.x,V.y)||!e.isForest(V.x,V.y)||e.getUnitAt(V.x,V.y))continue;let X=e.getWallBetween(b.position.x,b.position.y,V.x,V.y);if(X&&(X.owner==="neutral"||X.owner==="ai")){let De=(b.tier>=3?7e6:9e5)+o,Ve=X.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(pe===null||De>pe.score)&&(pe={unit:b,target:{x:b.position.x,y:b.position.y},score:De,type:"wall_attack",reason:Ve,edge:{from:F({},b.position),to:V}})}else if(X&&X.owner==="player"){let Ve=[{x:V.x+1,y:V.y},{x:V.x-1,y:V.y},{x:V.x,y:V.y+1},{x:V.x,y:V.y-1}].filter(wt=>e.inBounds(wt.x,wt.y)).filter(wt=>e.getUnitAt(wt.x,wt.y)?!1:!e.getWallBetween(wt.x,wt.y,V.x,V.y)),Xe=Math.abs(b.position.x-V.x)+Math.abs(b.position.y-V.y);if((Ve.length>0?Ve.reduce((wt,mt)=>{let En=Math.abs(b.position.x-mt.x)+Math.abs(b.position.y-mt.y)+1;return Math.min(wt,En)},1/0):1/0)-Xe>4){let wt=(b.tier>=3?8e6:b.tier===3&&b.level===1?105e4:85e4)+o;(pe===null||wt>pe.score)&&(pe={unit:b,target:{x:b.position.x,y:b.position.y},score:wt,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:F({},b.position),to:V}})}}}for(let z of Wr){let V={x:b.position.x+z.x,y:b.position.y+z.y};if(V.x===a.x&&V.y===a.y){let J=e.getWallBetween(b.position.x,b.position.y,V.x,V.y);if(J&&(J.owner==="neutral"||J.owner==="player")&&b.tier>=3){let X=8e6+o;(pe===null||X>pe.score)&&(pe={unit:b,target:{x:b.position.x,y:b.position.y},score:X,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:F({},b.position),to:V}})}}}if(ae){let z=Math.sign(ae.x-b.position.x),V=Math.sign(ae.y-b.position.y),J=b.position.x+(z!==0?z:0),X=b.position.y+(V!==0?V:0);if(e.inBounds(J,X)){let De=e.getUnitAt(J,X);if(De&&De.owner==="ai")for(let Ve of Wr){let Xe={x:b.position.x+Ve.x,y:b.position.y+Ve.y};if(!e.inBounds(Xe.x,Xe.y))continue;let dt=e.getWallBetween(b.position.x,b.position.y,Xe.x,Xe.y);if(dt&&(dt.owner==="player"||dt.owner==="neutral")){let mt=(dt.owner==="player"?65e4:6e5)+o;(pe===null||mt>pe.score)&&(pe={unit:b,target:{x:b.position.x,y:b.position.y},score:mt,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:F({},b.position),to:Xe}})}}}}if(ae){let z=ae.x-b.position.x,V=ae.y-b.position.y;if(z!==0&&V===0||z===0&&V!==0){let J=Math.sign(z),X=Math.sign(V),De={x:b.position.x+J,y:b.position.y+X};if(e.inBounds(De.x,De.y)&&e.getWallBetween(b.position.x,b.position.y,De.x,De.y)){let Xe=(b.tier>=3?8e6:15e5)+o;(pe===null||Xe>pe.score)&&(pe={unit:b,target:{x:b.position.x,y:b.position.y},score:Xe,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:F({},b.position),to:De}})}}if(Math.abs(z)>=1&&Math.abs(V)>=1){let J=Math.sign(z),X=Math.sign(V),De={x:b.position.x+J,y:b.position.y+X};if(e.inBounds(De.x,De.y)&&this.combat.isDiagonalBlocked(b.position,De,(Xe,dt,wt,mt)=>e.getWallBetween(Xe,dt,wt,mt))){let Xe={x:b.position.x+J,y:b.position.y},dt={x:b.position.x,y:b.position.y+X},wt=e.getWallBetween(b.position.x,b.position.y,Xe.x,Xe.y),mt=e.getWallBetween(b.position.x,b.position.y,dt.x,dt.y),En=null;if(wt?En={from:F({},b.position),to:Xe}:mt&&(En={from:F({},b.position),to:dt}),En){let Vo=(b.tier>=3?8e6:15e5)+o;(pe===null||Vo>pe.score)&&(pe={unit:b,target:{x:b.position.x,y:b.position.y},score:Vo,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:En})}}}}let V0=d.length===0&&h.length===0&&!kt;if(Ke>=2&&(V0||S.length>0))for(let z of Wr){let V={x:b.position.x+z.x,y:b.position.y+z.y};if(!e.inBounds(V.x,V.y))continue;let J=e.getWallBetween(b.position.x,b.position.y,V.x,V.y);if(J&&(J.owner==="neutral"||J.owner==="player")){let X=b.tier>=3?8e6:12e5;(pe===null||X>pe.score)&&(pe={unit:b,target:{x:b.position.x,y:b.position.y},score:X,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:F({},b.position),to:V}})}}let ur=S.filter(z=>Math.max(Math.abs(z.position.x-b.position.x),Math.abs(z.position.y-b.position.y))===1),Lo=ur.length>0?ur.reduce((z,V)=>this.combat.calculateTotalPoints(V)>this.combat.calculateTotalPoints(z)?V:z,ur[0]):null,Ns=lt.length>0&&le.some(z=>lt.some(V=>V.x===z.x&&V.y===z.y));for(let z of le){let V=0,J="Action",X=e.getUnitAt(z.x,z.y),De=xe=>[{x:xe.x+1,y:xe.y},{x:xe.x-1,y:xe.y},{x:xe.x,y:xe.y+1},{x:xe.x,y:xe.y-1}].filter(At=>e.inBounds(At.x,At.y)).filter(At=>!e.getUnitAt(At.x,At.y)).length,Ve=Math.max(Math.abs(b.position.x-s.x),Math.abs(b.position.y-s.y)),Xe=Math.max(Math.abs(z.x-s.x),Math.abs(z.y-s.y)),dt=l.length?Math.min(...l.map(xe=>Math.abs(b.position.x-xe.x)+Math.abs(b.position.y-xe.y))):1/0,wt=l.length?Math.min(...l.map(xe=>Math.abs(z.x-xe.x)+Math.abs(z.y-xe.y))):1/0,mt=l.filter(xe=>{let He=e.getUnitAt(xe.x,xe.y);return!!He&&He.owner==="player"}),En=mt.length?Math.min(...mt.map(xe=>Math.abs(b.position.x-xe.x)+Math.abs(b.position.y-xe.y))):1/0,Vo=mt.length?Math.min(...mt.map(xe=>Math.abs(z.x-xe.x)+Math.abs(z.y-xe.y))):1/0,Mc=new Map(e.unitMoveHistorySignal()).get(b.id),si=Array.isArray(Mc)?Mc:[],qr=si.length>=2?si[si.length-2]:null,Wt=si.length>=3?si[si.length-3]:null,yh=qr&&z.x===qr.x&&z.y===qr.y,Kr=$n&&!e.isForest(z.x,z.y);if(D){let xe=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),He=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);He<xe?(V+=5e7,J="FULL RUSH: Charge Base"):He===xe?V+=1e5:V-=5e6,X&&X.owner==="player"&&Math.abs(X.position.x-a.x)+Math.abs(X.position.y-a.y)<xe&&(V+=2e7,J="FULL RUSH: Clear Path to Base"),$n&&z.x===b.position.x&&z.y===b.position.y&&f>=3&&(V=-5e6,J="FULL RUSH: Abandon Forest for Assault")}else if(b.tier>=3&&Kr){let xe=Math.abs(z.x-a.x)+Math.abs(z.y-a.y)<=2,He=S.some(Bt=>Math.abs(z.x-Bt.position.x)+Math.abs(z.y-Bt.position.y)<=2),At=e.unitsSignal().some(Bt=>Bt.owner==="ai"&&Bt.id!==b.id&&Math.max(Math.abs(Bt.position.x-b.position.x),Math.abs(Bt.position.y-b.position.y))<=1);!M&&!(xe||He)&&!At&&(V-=2e6,J="Penalty: Leaving forest without replacement")}let Yr=se.get(b.id),U0=Yr&&Yr.until>e.turnSignal()&&Yr.tiles.has(`${z.x},${z.y}`);if(b.tier===1&&(qr&&z.x===qr.x&&z.y===qr.y||Wt&&z.x===Wt.x&&z.y===Wt.y)&&(V-=25e3,J="Anti-Loop Penalty"),b.tier<=2&&!X&&Wt&&z.x===Wt.x&&z.y===Wt.y&&(V=-1e6,J="Anti-Loop: Stay or different path"),U0&&(V-=3e4,J="Stutter Ban Penalty"),$n&&ur.length===0&&!X&&Kr&&!Z&&(V=-1e3),$n&&b.tier<=2&&Kr&&ur.length>0&&ur.some(He=>this.combat.calculateTotalPoints(He)>this.combat.calculateTotalPoints(b))&&(V=-1e6,J="Hold Forest"),D)$n&&z.x===b.position.x&&z.y===b.position.y&&f>=3&&(V=-5e6,J="FULL RUSH: Abandon Forest for Assault");else if(!X&&$n&&z.x===b.position.x&&z.y===b.position.y){let xe=ur.some(At=>this.combat.calculateTotalPoints(At)>this.combat.calculateTotalPoints(b)),He=M&&b.tier>=3;!xe&&!He&&(V=Math.max(V,1e7),J="Hold: Stay on forest")}if(!X&&!D){if(e.isForest(z.x,z.y)&&!e.getUnitAt(z.x,z.y)&&(Ps?(V=-1e3,J="Ignore Forest (Total War)"):b.tier>=3?(V=5e6*(Te&&!Z?3:1),J="Priority: T3 capture empty forest"):(V=1e6*(Te&&!Z?3:1),J=f<3?`Priority 0: Capture Forest ${z.x},${z.y}`:`Priority 1: Capture Forest ${z.x},${z.y}`,Te&&!Z&&Math.abs(b.position.x-z.x)+Math.abs(b.position.y-z.y)===1&&(V=Math.max(V,12e6),J=`Early Capture: Forest ${z.x},${z.y}`))),ae){let xe=Math.abs(b.position.x-ae.x)+Math.abs(b.position.y-ae.y),He=Math.abs(z.x-ae.x)+Math.abs(z.y-ae.y);if(He<xe&&(V+=5e4*(xe-He),J=d.length>0?`Priority 1: Toward Forest ${ae.x},${ae.y}`:h.length>0?`Priority 7: Toward Fog Forest ${ae.x},${ae.y}`:`Toward Goal ${ae.x},${ae.y}`),g>10||w){let Bt=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),Ot=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);Ot<Bt&&(V+=15e4*(Bt-Ot),J="Aggress: Toward Player Base"),Vo<En&&(V+=12e4*(En-Vo),J="Aggress: Toward Player Forest");let bn=De(z)-De(b.position);bn>0&&(V+=5e4*bn,J="Unblock: Clear path")}if((()=>{let Bt=Math.sign(ae.x-b.position.x),Ot=Math.sign(ae.y-b.position.y),bn=b.position.x+(Bt!==0?Bt:0),Ft=b.position.y+(Ot!==0?Ot:0);return e.inBounds(bn,Ft)?!!e.getWallBetween(b.position.x,b.position.y,bn,Ft):!1})()&&z.x===b.position.x&&z.y===b.position.y){let Ot=e.getWallBetween(b.position.x,b.position.y,b.position.x+Math.sign(ae.x-b.position.x),b.position.y+Math.sign(ae.y-b.position.y))?.owner;b.tier>=3?(V=Math.max(V,8e6+o),J="Breach: Wall blocks high-priority path"):(V+=(Ot==="ai"?7e5:8e5)+o,J=Ot==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(kt){let xe=Math.abs(b.position.x-kt.x)+Math.abs(b.position.y-kt.y),He=Math.abs(z.x-kt.x)+Math.abs(z.y-kt.y);He<xe&&(V+=2e5*(xe-He),J="Approach Neutral Wall to Forest"),z.x===kt.x&&z.y===kt.y&&(V+=5e5,J="Position for Wall Breach")}if(z.x===a.x&&z.y===a.y&&(V+=1e4,J="Attack Base (Override)"),Pe){let xe=lt.some(Ft=>Ft.x===z.x&&Ft.y===z.y),He=Math.abs(b.position.x-Pe.position.x)+Math.abs(b.position.y-Pe.position.y),At=Math.abs(z.x-Pe.position.x)+Math.abs(z.y-Pe.position.y),Ot=Math.max(Math.abs(Pe.position.x-s.x),Math.abs(Pe.position.y-s.y))<=2,bn=z.x===b.position.x&&z.y===b.position.y;if(b.tier>=3&&Pe.tier>=3&&At===1)V=4e7,J="DEFENSE: T3 Move to Intercept Threat";else if(xe){let Ft=Ot?25e5:15e5;V<Ft&&(V=Ft),V+=Ot?2e4:5e3,J=Ot?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(At<He){let Ft=b.id===(zt?.id??"")?1e6:5e3;V+=Ft*(He-At),b.tier>=3&&(V+=4e3),J=b.id===(zt?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}bn&&Ns&&(V-=Ot?5e4:1e4,be?J="Penalty: Standing Still With Imminent Base Threat":Z&&(J="Penalty: Standing Still With Base Threat"))}if(b.tier>=3){let xe=Math.abs(b.position.x-a.x)+Math.abs(b.position.y-a.y),He=Math.abs(z.x-a.x)+Math.abs(z.y-a.y);He<xe&&(V+=2e3*(xe-He),J="Hunter: Toward Base",M&&(V=Math.max(V,4e6),J="Hunt: Approach Base"))}if(qe&&wt<dt&&(V*=10),Xe>Ve&&wt<dt&&(V+=500),Lo&&this.combat.calculateTotalPoints(Lo)>this.combat.calculateTotalPoints(b)){let xe=Math.abs(b.position.x-Lo.position.x)+Math.abs(b.position.y-Lo.position.y),He=Math.abs(z.x-Lo.position.x)+Math.abs(z.y-Lo.position.y);He>xe&&(V+=75e3*(He-xe),J="Retreat")}}else if(X.owner==="player"){let xe=Math.max(Math.abs(X.position.x-s.x),Math.abs(X.position.y-s.y)),He=xe<=3,At=xe<=2,Bt=this.combat.calculateTotalPoints(b),Ot=this.combat.calculateTotalPoints(X),bn=Bt>Ot,Ft=X.tier>=3,ks=b.tier>=3;b.tier>=3&&e.isForest(X.position.x,X.position.y)&&(V=1e7,J="Aggression: Liberate forest"),!$n&&me&&mt.length>0&&e.isForest(X.position.x,X.position.y)&&(V=12e6,J="LIBERATE: Attack player forest"),xe<=4&&(b.tier>=3||bn)&&(V=15e6,J="INTERCEPT: Base Siege"),He?ks&&Ft?(V=5e7,J="CRITICAL DEFENSE: T3 Intercepts Threat"):bn?(V=2e7,J="CRITICAL DEFENSE: Eliminate Base Threat",At&&(V+=5e6)):Ft&&b.tier<=2?(V=0,J="Ignore: T1 Suicide vs T3 useless"):(V=1e3,J="DEFENSE: Desperation Attack"):bn?(Ft?(V=8e6,J="COMBAT: Kill High Value Target (T3+)"):(V=4e6,J="COMBAT: Kill Enemy"),b.tier<X.tier&&(V+=2e6,J+=" (Efficient Trade)")):b.tier<=2?(V=0,J="Ignore: No guaranteed kill"):(V=1e5,J="COMBAT: Chip Damage"),R&&(V+=5e5),P&&(V+=1e6)}else if(X.tier===b.tier&&Xe>Ve){let xe=this.combat.calculateTotalPoints(b)+this.combat.calculateTotalPoints(X),{tier:He}=this.combat.calculateTierAndLevel(xe);He>b.tier&&!qe&&!$n&&(V=1e3,J="Merge Up")}let ji="move";X&&X.owner==="player"&&(ji="attack"),X&&X.owner==="ai"&&X.tier===b.tier&&(ji="merge"),(g>10||w)&&ji==="merge"&&(V+=5e6,J="Anti-Stall: Merge first");let B0=this.interceptUntil.get(b.id)||0;if(b.id===(zt?.id??"")&&B0>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Pe){let xe=Math.abs(b.position.x-Pe.position.x)+Math.abs(b.position.y-Pe.position.y),He=Math.abs(z.x-Pe.position.x)+Math.abs(z.y-Pe.position.y);He<xe&&(V+=5e5*(xe-He),J="DEFENSE: Intercept Lock")}yh&&(V=Math.floor(V*.1),V-=3e5,J="Penalty: Inertia");let j0=(()=>{let xe=si.slice(-6),He=new Set(xe.map(At=>`${At.x},${At.y}`));return xe.length>=6&&He.size<=3})();if(b.tier===1&&j0){let xe=d.length>0?d:h;if(xe.length>0){let He=xe.reduce((Ot,bn)=>{let Ft=Math.abs(b.position.x-bn.x)+Math.abs(b.position.y-bn.y),ks=Math.abs(b.position.x-Ot.x)+Math.abs(b.position.y-Ot.y);return Ft<ks?bn:Ot},xe[0]),At=Math.abs(b.position.x-He.x)+Math.abs(b.position.y-He.y),Bt=Math.abs(z.x-He.x)+Math.abs(z.y-He.y);Bt<At&&(V+=1e5*(At-Bt),J="Breakout: Toward Forest")}}(b.forestOccupationTurns??0)>0&&(z.x!==b.position.x||z.y!==b.position.y)&&(V-=2e3),(pe===null||V>pe.score)&&(pe={unit:b,target:z,score:V,type:ji,reason:J})}}if(!pe)return null;let _e=this.goals.get(pe.unit.id),ye=_e?`Goal: Forest at ${_e.x},${_e.y}`:"Goal: None";return{type:pe.type,unit:pe.unit,target:pe.target,reason:pe.reason,edge:pe.edge}}getWallBuildActions(e){let t=[],i=e.unitsSignal().filter(d=>d.owner==="ai"),r=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,h)=>o.some(f=>f.tile1.x===d.x&&f.tile1.y===d.y&&f.tile2.x===h.x&&f.tile2.y===h.y||f.tile1.x===h.x&&f.tile1.y===h.y&&f.tile2.x===d.x&&f.tile2.y===d.y),l=(d,h)=>Math.abs(d.x-h.x)+Math.abs(d.y-h.y),c=(d,h)=>Math.max(Math.abs(d.x-h.x),Math.abs(d.y-h.y));for(let d of i){if(d.tier>=3)continue;let h=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(S=>e.inBounds(S.x,S.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let S of h)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});continue}let f=r.filter(S=>c(d.position,S.position)<=2);if(f.length===0)continue;let g=f.sort((S,P)=>l(d.position,S.position)-l(d.position,P.position))[0],w=h.sort((S,P)=>l(S,g.position)-l(P,g.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let S of w)!a(d.position,S)&&e.canBuildWallBetween(d.position,S)&&t.push({from:d.position,to:S});else if(d.tier===2){let S=0;for(let P of w){if(S>=2)break;!a(d.position,P)&&e.canBuildWallBetween(d.position,P)&&(t.push({from:d.position,to:P}),S++)}}}return t}static \u0275fac=function(t){return new(t||n)(Re(zl),Re(Tt))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var rR=()=>{};var aR=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},yj=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=n[t++],s=n[t++],a=n[t++],l=((r&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63)}}return e.join("")},lR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,a=s?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,d=o>>2,h=(o&3)<<4|a>>4,f=(a&15)<<2|c>>6,g=c&63;l||(g=64,s||(f=64)),i.push(t[d],t[h],t[f],t[g])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(aR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yj(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let c=r<n.length?t[n.charAt(r)]:64;++r;let h=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||a==null||c==null||h==null)throw new Ab;let f=o<<2|a>>4;if(i.push(f),c!==64){let g=a<<4&240|c>>2;if(i.push(g),h!==64){let w=c<<6&192|h;i.push(w)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ab=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},vj=function(n){let e=aR(n);return lR.encodeByteArray(e,!0)},vd=function(n){return vj(n).replace(/\./g,"")},Bg=function(n){try{return lR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function cR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var _j=()=>cR().__FIREBASE_DEFAULTS__,Ej=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},bj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Bg(n[1]);return e&&JSON.parse(e)},jg=()=>{try{return rR()||_j()||Ej()||bj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Rb=n=>jg()?.emulatorHosts?.[n],uR=n=>{let e=Rb(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Pb=()=>jg()?.config,Nb=n=>jg()?.[`_${n}`];var Ug=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function ps(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Hg(n){return(await fetch(n,{credentials:"include"})).ok}function dR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=F({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[vd(JSON.stringify(t)),vd(JSON.stringify(s)),""].join(".")}var yd={};function wj(){let n={prod:[],emulator:[]};for(let e of Object.keys(yd))yd[e]?n.emulator.push(e):n.prod.push(e);return n}function xj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var oR=!1;function $g(n,e){if(typeof window>"u"||typeof document>"u"||!ps(window.location.host)||yd[n]===e||yd[n]||oR)return;yd[n]=e;function t(f){return`__firebase__banner__${f}`}let i="__firebase__banner",o=wj().prod.length>0;function s(){let f=document.getElementById(i);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){let f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{oR=!0,s()},f}function d(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){let f=xj(i),g=t("text"),w=document.getElementById(g)||document.createElement("span"),S=t("learnmore"),P=document.getElementById(S)||document.createElement("a"),L=t("preprendIcon"),Z=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){let ve=f.element;a(ve),d(P,S);let be=c();l(Z,L),ve.append(Z,w,P,be),document.body.appendChild(ve)}o?(w.innerText="Preview backend disconnected.",Z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Cn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cn())}function Sj(){let n=jg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pR(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mR(){let n=Cn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function yR(){return!Sj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kb(){try{return typeof indexedDB=="object"}catch{return!1}}function vR(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var Ij="FirebaseError",wi=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Ij,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mo.prototype.create)}},mo=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?Tj(o,i):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new wi(r,a,i)}};function Tj(n,e){return n.replace(Cj,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var Cj=/\{\$([^}]+)}/g;function _R(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ir(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(sR(o)&&sR(s)){if(!ir(o,s))return!1}else if(o!==s)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function sR(n){return n!==null&&typeof n=="object"}function Wl(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ER(n,e){let t=new Mb(n,e);return t.subscribe.bind(t)}var Mb=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Dj(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Db),r.error===void 0&&(r.error=Db),r.complete===void 0&&(r.complete=Db);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Dj(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Db(){}var Fue=14400*1e3;function Dn(n){return n&&n._delegate?n._delegate:n}var Li=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ta="[DEFAULT]";var Ob=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Ug;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Mj(e))try{this.getOrInitializeService({instanceIdentifier:Ta})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=Ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ta){return this.instances.has(e)}getOptions(e=Ta){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&s.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Aj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ta){return this.component?this.component.multipleInstances?e:Ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Aj(n){return n===Ta?void 0:n}function Mj(n){return n.instantiationMode==="EAGER"}var Gg=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ob(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Rj=[],tt=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(tt||{}),Pj={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},Nj=tt.INFO,kj={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},Oj=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=kj[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},gs=class{constructor(e){this.name=e,this._logLevel=Nj,this._logHandler=Oj,this._userLogHandler=null,Rj.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Pj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}};var Fj=(n,e)=>e.some(t=>n instanceof t),bR,wR;function Lj(){return bR||(bR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vj(){return wR||(wR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var xR=new WeakMap,Lb=new WeakMap,SR=new WeakMap,Fb=new WeakMap,Ub=new WeakMap;function Uj(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Or(n.result)),r()},s=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&xR.set(t,n)}).catch(()=>{}),Ub.set(e,n),e}function Bj(n){if(Lb.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Lb.set(n,e)}var Vb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Lb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||SR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Or(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function IR(n){Vb=n(Vb)}function jj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(zg(this),e,...t);return SR.set(i,e.sort?e.sort():[e]),Or(i)}:Vj().includes(n)?function(...e){return n.apply(zg(this),e),Or(xR.get(this))}:function(...e){return Or(n.apply(zg(this),e))}}function Hj(n){return typeof n=="function"?jj(n):(n instanceof IDBTransaction&&Bj(n),Fj(n,Lj())?new Proxy(n,Vb):n)}function Or(n){if(n instanceof IDBRequest)return Uj(n);if(Fb.has(n))return Fb.get(n);let e=Hj(n);return e!==n&&(Fb.set(n,e),Ub.set(e,n)),e}var zg=n=>Ub.get(n);function CR(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),a=Or(s);return i&&s.addEventListener("upgradeneeded",l=>{i(Or(s.result),l.oldVersion,l.newVersion,Or(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var $j=["get","getKey","getAll","getAllKeys","count"],Gj=["put","add","delete","clear"],Bb=new Map;function TR(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Bb.get(e))return Bb.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Gj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||$j.includes(t)))return;let o=async function(s,...a){let l=this.transaction(s,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return Bb.set(e,o),o}IR(n=>ce(F({},n),{get:(e,t,i)=>TR(e,t)||n.get(e,t,i),has:(e,t)=>!!TR(e,t)||n.has(e,t)}));var Hb=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(zj(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function zj(n){return n.getComponent()?.type==="VERSION"}var $b="@firebase/app",DR="0.14.7";var yo=new gs("@firebase/app"),Wj="@firebase/app-compat",qj="@firebase/analytics-compat",Kj="@firebase/analytics",Yj="@firebase/app-check-compat",Qj="@firebase/app-check",Jj="@firebase/auth",Zj="@firebase/auth-compat",Xj="@firebase/database",e9="@firebase/data-connect",t9="@firebase/database-compat",n9="@firebase/functions",i9="@firebase/functions-compat",r9="@firebase/installations",o9="@firebase/installations-compat",s9="@firebase/messaging",a9="@firebase/messaging-compat",l9="@firebase/performance",c9="@firebase/performance-compat",u9="@firebase/remote-config",d9="@firebase/remote-config-compat",h9="@firebase/storage",f9="@firebase/storage-compat",p9="@firebase/firestore",g9="@firebase/ai",m9="@firebase/firestore-compat",y9="firebase",v9="12.8.0";var Gb="[DEFAULT]",_9={[$b]:"fire-core",[Wj]:"fire-core-compat",[Kj]:"fire-analytics",[qj]:"fire-analytics-compat",[Qj]:"fire-app-check",[Yj]:"fire-app-check-compat",[Jj]:"fire-auth",[Zj]:"fire-auth-compat",[Xj]:"fire-rtdb",[e9]:"fire-data-connect",[t9]:"fire-rtdb-compat",[n9]:"fire-fn",[i9]:"fire-fn-compat",[r9]:"fire-iid",[o9]:"fire-iid-compat",[s9]:"fire-fcm",[a9]:"fire-fcm-compat",[l9]:"fire-perf",[c9]:"fire-perf-compat",[u9]:"fire-rc",[d9]:"fire-rc-compat",[h9]:"fire-gcs",[f9]:"fire-gcs-compat",[p9]:"fire-fst",[m9]:"fire-fst-compat",[g9]:"fire-vertex","fire-js":"fire-js",[y9]:"fire-js-all"};var Wg=new Map,E9=new Map,zb=new Map;function AR(n,e){try{n.container.addComponent(e)}catch(t){yo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ys(n){let e=n.name;if(zb.has(e))return yo.debug(`There were multiple attempts to register component ${e}.`),!1;zb.set(e,n);for(let t of Wg.values())AR(t,n);for(let t of E9.values())AR(t,n);return!0}function Ed(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function xi(n){return n==null?!1:n.settings!==void 0}var b9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new mo("app","Firebase",b9);var Wb=class{constructor(e,t,i){this._isDeleted=!1,this._options=F({},e),this._config=F({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Li("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}};var vs=v9;function bd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=F({name:Gb,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw ms.create("bad-app-name",{appName:String(r)});if(t||(t=Pb()),!t)throw ms.create("no-options");let o=Wg.get(r);if(o){if(ir(t,o.options)&&ir(i,o.config))return o;throw ms.create("duplicate-app",{appName:r})}let s=new Gg(r);for(let l of zb.values())s.addComponent(l);let a=new Wb(t,i,s);return Wg.set(r,a),a}function qg(n=Gb){let e=Wg.get(n);if(!e&&n===Gb&&Pb())return bd();if(!e)throw ms.create("no-app",{appName:n});return e}function rr(n,e,t){let i=_9[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let s=[`Unable to register library "${i}" with version "${e}":`];r&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yo.warn(s.join(" "));return}ys(new Li(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var w9="firebase-heartbeat-database",x9=1,_d="firebase-heartbeat-store",jb=null;function NR(){return jb||(jb=CR(w9,x9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_d)}catch(t){console.warn(t)}}}}).catch(n=>{throw ms.create("idb-open",{originalErrorMessage:n.message})})),jb}async function S9(n){try{let t=(await NR()).transaction(_d),i=await t.objectStore(_d).get(kR(n));return await t.done,i}catch(e){if(e instanceof wi)yo.warn(e.message);else{let t=ms.create("idb-get",{originalErrorMessage:e?.message});yo.warn(t.message)}}}async function MR(n,e){try{let i=(await NR()).transaction(_d,"readwrite");await i.objectStore(_d).put(e,kR(n)),await i.done}catch(t){if(t instanceof wi)yo.warn(t.message);else{let i=ms.create("idb-set",{originalErrorMessage:t?.message});yo.warn(i.message)}}}function kR(n){return`${n.name}!${n.options.appId}`}var I9=1024,T9=30,qb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Kb(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=RR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>T9){let r=D9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){yo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=RR(),{heartbeatsToSend:t,unsentEntries:i}=C9(this._heartbeatsCache.heartbeats),r=vd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return yo.warn(e),""}}};function RR(){return new Date().toISOString().substring(0,10)}function C9(n,e=I9){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),PR(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),PR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Kb=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kb()?vR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await S9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return MR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return MR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function PR(n){return vd(JSON.stringify({version:2,heartbeats:n})).length}function D9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function A9(n){ys(new Li("platform-logger",e=>new Hb(e),"PRIVATE")),ys(new Li("heartbeat",e=>new qb(e),"PRIVATE")),rr($b,DR,n),rr($b,DR,"esm2020"),rr("fire-js","")}A9("");var M9="firebase",R9="12.8.0";rr(M9,R9,"app");var OR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},FR={};var vo,Yb;(function(){var n;function e(O,I){function N(){}N.prototype=I.prototype,O.F=I.prototype,O.prototype=new N,O.prototype.constructor=O,O.D=function(D,x,R){for(var M=Array(arguments.length-2),me=2;me<arguments.length;me++)M[me-2]=arguments[me];return I.prototype[x].apply(D,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(O,I,N){N||(N=0);let D=Array(16);if(typeof I=="string")for(var x=0;x<16;++x)D[x]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(x=0;x<16;++x)D[x]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=O.g[0],N=O.g[1],x=O.g[2];let R=O.g[3],M;M=I+(R^N&(x^R))+D[0]+3614090360&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(x^I&(N^x))+D[1]+3905402710&4294967295,R=I+(M<<12&4294967295|M>>>20),M=x+(N^R&(I^N))+D[2]+606105819&4294967295,x=R+(M<<17&4294967295|M>>>15),M=N+(I^x&(R^I))+D[3]+3250441966&4294967295,N=x+(M<<22&4294967295|M>>>10),M=I+(R^N&(x^R))+D[4]+4118548399&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(x^I&(N^x))+D[5]+1200080426&4294967295,R=I+(M<<12&4294967295|M>>>20),M=x+(N^R&(I^N))+D[6]+2821735955&4294967295,x=R+(M<<17&4294967295|M>>>15),M=N+(I^x&(R^I))+D[7]+4249261313&4294967295,N=x+(M<<22&4294967295|M>>>10),M=I+(R^N&(x^R))+D[8]+1770035416&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(x^I&(N^x))+D[9]+2336552879&4294967295,R=I+(M<<12&4294967295|M>>>20),M=x+(N^R&(I^N))+D[10]+4294925233&4294967295,x=R+(M<<17&4294967295|M>>>15),M=N+(I^x&(R^I))+D[11]+2304563134&4294967295,N=x+(M<<22&4294967295|M>>>10),M=I+(R^N&(x^R))+D[12]+1804603682&4294967295,I=N+(M<<7&4294967295|M>>>25),M=R+(x^I&(N^x))+D[13]+4254626195&4294967295,R=I+(M<<12&4294967295|M>>>20),M=x+(N^R&(I^N))+D[14]+2792965006&4294967295,x=R+(M<<17&4294967295|M>>>15),M=N+(I^x&(R^I))+D[15]+1236535329&4294967295,N=x+(M<<22&4294967295|M>>>10),M=I+(x^R&(N^x))+D[1]+4129170786&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^x&(I^N))+D[6]+3225465664&4294967295,R=I+(M<<9&4294967295|M>>>23),M=x+(I^N&(R^I))+D[11]+643717713&4294967295,x=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(x^R))+D[0]+3921069994&4294967295,N=x+(M<<20&4294967295|M>>>12),M=I+(x^R&(N^x))+D[5]+3593408605&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^x&(I^N))+D[10]+38016083&4294967295,R=I+(M<<9&4294967295|M>>>23),M=x+(I^N&(R^I))+D[15]+3634488961&4294967295,x=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(x^R))+D[4]+3889429448&4294967295,N=x+(M<<20&4294967295|M>>>12),M=I+(x^R&(N^x))+D[9]+568446438&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^x&(I^N))+D[14]+3275163606&4294967295,R=I+(M<<9&4294967295|M>>>23),M=x+(I^N&(R^I))+D[3]+4107603335&4294967295,x=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(x^R))+D[8]+1163531501&4294967295,N=x+(M<<20&4294967295|M>>>12),M=I+(x^R&(N^x))+D[13]+2850285829&4294967295,I=N+(M<<5&4294967295|M>>>27),M=R+(N^x&(I^N))+D[2]+4243563512&4294967295,R=I+(M<<9&4294967295|M>>>23),M=x+(I^N&(R^I))+D[7]+1735328473&4294967295,x=R+(M<<14&4294967295|M>>>18),M=N+(R^I&(x^R))+D[12]+2368359562&4294967295,N=x+(M<<20&4294967295|M>>>12),M=I+(N^x^R)+D[5]+4294588738&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^x)+D[8]+2272392833&4294967295,R=I+(M<<11&4294967295|M>>>21),M=x+(R^I^N)+D[11]+1839030562&4294967295,x=R+(M<<16&4294967295|M>>>16),M=N+(x^R^I)+D[14]+4259657740&4294967295,N=x+(M<<23&4294967295|M>>>9),M=I+(N^x^R)+D[1]+2763975236&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^x)+D[4]+1272893353&4294967295,R=I+(M<<11&4294967295|M>>>21),M=x+(R^I^N)+D[7]+4139469664&4294967295,x=R+(M<<16&4294967295|M>>>16),M=N+(x^R^I)+D[10]+3200236656&4294967295,N=x+(M<<23&4294967295|M>>>9),M=I+(N^x^R)+D[13]+681279174&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^x)+D[0]+3936430074&4294967295,R=I+(M<<11&4294967295|M>>>21),M=x+(R^I^N)+D[3]+3572445317&4294967295,x=R+(M<<16&4294967295|M>>>16),M=N+(x^R^I)+D[6]+76029189&4294967295,N=x+(M<<23&4294967295|M>>>9),M=I+(N^x^R)+D[9]+3654602809&4294967295,I=N+(M<<4&4294967295|M>>>28),M=R+(I^N^x)+D[12]+3873151461&4294967295,R=I+(M<<11&4294967295|M>>>21),M=x+(R^I^N)+D[15]+530742520&4294967295,x=R+(M<<16&4294967295|M>>>16),M=N+(x^R^I)+D[2]+3299628645&4294967295,N=x+(M<<23&4294967295|M>>>9),M=I+(x^(N|~R))+D[0]+4096336452&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~x))+D[7]+1126891415&4294967295,R=I+(M<<10&4294967295|M>>>22),M=x+(I^(R|~N))+D[14]+2878612391&4294967295,x=R+(M<<15&4294967295|M>>>17),M=N+(R^(x|~I))+D[5]+4237533241&4294967295,N=x+(M<<21&4294967295|M>>>11),M=I+(x^(N|~R))+D[12]+1700485571&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~x))+D[3]+2399980690&4294967295,R=I+(M<<10&4294967295|M>>>22),M=x+(I^(R|~N))+D[10]+4293915773&4294967295,x=R+(M<<15&4294967295|M>>>17),M=N+(R^(x|~I))+D[1]+2240044497&4294967295,N=x+(M<<21&4294967295|M>>>11),M=I+(x^(N|~R))+D[8]+1873313359&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~x))+D[15]+4264355552&4294967295,R=I+(M<<10&4294967295|M>>>22),M=x+(I^(R|~N))+D[6]+2734768916&4294967295,x=R+(M<<15&4294967295|M>>>17),M=N+(R^(x|~I))+D[13]+1309151649&4294967295,N=x+(M<<21&4294967295|M>>>11),M=I+(x^(N|~R))+D[4]+4149444226&4294967295,I=N+(M<<6&4294967295|M>>>26),M=R+(N^(I|~x))+D[11]+3174756917&4294967295,R=I+(M<<10&4294967295|M>>>22),M=x+(I^(R|~N))+D[2]+718787259&4294967295,x=R+(M<<15&4294967295|M>>>17),M=N+(R^(x|~I))+D[9]+3951481745&4294967295,O.g[0]=O.g[0]+I&4294967295,O.g[1]=O.g[1]+(x+(M<<21&4294967295|M>>>11))&4294967295,O.g[2]=O.g[2]+x&4294967295,O.g[3]=O.g[3]+R&4294967295}i.prototype.v=function(O,I){I===void 0&&(I=O.length);let N=I-this.blockSize,D=this.C,x=this.h,R=0;for(;R<I;){if(x==0)for(;R<=N;)r(this,O,R),R+=this.blockSize;if(typeof O=="string"){for(;R<I;)if(D[x++]=O.charCodeAt(R++),x==this.blockSize){r(this,D),x=0;break}}else for(;R<I;)if(D[x++]=O[R++],x==this.blockSize){r(this,D),x=0;break}}this.h=x,this.o+=I},i.prototype.A=function(){var O=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);O[0]=128;for(var I=1;I<O.length-8;++I)O[I]=0;I=this.o*8;for(var N=O.length-8;N<O.length;++N)O[N]=I&255,I/=256;for(this.v(O),O=Array(16),I=0,N=0;N<4;++N)for(let D=0;D<32;D+=8)O[I++]=this.g[N]>>>D&255;return O};function o(O,I){var N=a;return Object.prototype.hasOwnProperty.call(N,O)?N[O]:N[O]=I(O)}function s(O,I){this.h=I;let N=[],D=!0;for(let x=O.length-1;x>=0;x--){let R=O[x]|0;D&&R==I||(N[x]=R,D=!1)}this.g=N}var a={};function l(O){return-128<=O&&O<128?o(O,function(I){return new s([I|0],I<0?-1:0)}):new s([O|0],O<0?-1:0)}function c(O){if(isNaN(O)||!isFinite(O))return h;if(O<0)return P(c(-O));let I=[],N=1;for(let D=0;O>=N;D++)I[D]=O/N|0,N*=4294967296;return new s(I,0)}function d(O,I){if(O.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(O.charAt(0)=="-")return P(d(O.substring(1),I));if(O.indexOf("-")>=0)throw Error('number format error: interior "-" character');let N=c(Math.pow(I,8)),D=h;for(let R=0;R<O.length;R+=8){var x=Math.min(8,O.length-R);let M=parseInt(O.substring(R,R+x),I);x<8?(x=c(Math.pow(I,x)),D=D.j(x).add(c(M))):(D=D.j(N),D=D.add(c(M)))}return D}var h=l(0),f=l(1),g=l(16777216);n=s.prototype,n.m=function(){if(S(this))return-P(this).m();let O=0,I=1;for(let N=0;N<this.g.length;N++){let D=this.i(N);O+=(D>=0?D:4294967296+D)*I,I*=4294967296}return O},n.toString=function(O){if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(w(this))return"0";if(S(this))return"-"+P(this).toString(O);let I=c(Math.pow(O,6));var N=this;let D="";for(;;){let x=be(N,I).g;N=L(N,x.j(I));let R=((N.g.length>0?N.g[0]:N.h)>>>0).toString(O);if(N=x,w(N))return R+D;for(;R.length<6;)R="0"+R;D=R+D}},n.i=function(O){return O<0?0:O<this.g.length?this.g[O]:this.h};function w(O){if(O.h!=0)return!1;for(let I=0;I<O.g.length;I++)if(O.g[I]!=0)return!1;return!0}function S(O){return O.h==-1}n.l=function(O){return O=L(this,O),S(O)?-1:w(O)?0:1};function P(O){let I=O.g.length,N=[];for(let D=0;D<I;D++)N[D]=~O.g[D];return new s(N,~O.h).add(f)}n.abs=function(){return S(this)?P(this):this},n.add=function(O){let I=Math.max(this.g.length,O.g.length),N=[],D=0;for(let x=0;x<=I;x++){let R=D+(this.i(x)&65535)+(O.i(x)&65535),M=(R>>>16)+(this.i(x)>>>16)+(O.i(x)>>>16);D=M>>>16,R&=65535,M&=65535,N[x]=M<<16|R}return new s(N,N[N.length-1]&-2147483648?-1:0)};function L(O,I){return O.add(P(I))}n.j=function(O){if(w(this)||w(O))return h;if(S(this))return S(O)?P(this).j(P(O)):P(P(this).j(O));if(S(O))return P(this.j(P(O)));if(this.l(g)<0&&O.l(g)<0)return c(this.m()*O.m());let I=this.g.length+O.g.length,N=[];for(var D=0;D<2*I;D++)N[D]=0;for(D=0;D<this.g.length;D++)for(let x=0;x<O.g.length;x++){let R=this.i(D)>>>16,M=this.i(D)&65535,me=O.i(x)>>>16,Le=O.i(x)&65535;N[2*D+2*x]+=M*Le,Z(N,2*D+2*x),N[2*D+2*x+1]+=R*Le,Z(N,2*D+2*x+1),N[2*D+2*x+1]+=M*me,Z(N,2*D+2*x+1),N[2*D+2*x+2]+=R*me,Z(N,2*D+2*x+2)}for(O=0;O<I;O++)N[O]=N[2*O+1]<<16|N[2*O];for(O=I;O<2*I;O++)N[O]=0;return new s(N,0)};function Z(O,I){for(;(O[I]&65535)!=O[I];)O[I+1]+=O[I]>>>16,O[I]&=65535,I++}function ve(O,I){this.g=O,this.h=I}function be(O,I){if(w(I))throw Error("division by zero");if(w(O))return new ve(h,h);if(S(O))return I=be(P(O),I),new ve(P(I.g),P(I.h));if(S(I))return I=be(O,P(I)),new ve(P(I.g),I.h);if(O.g.length>30){if(S(O)||S(I))throw Error("slowDivide_ only works with positive integers.");for(var N=f,D=I;D.l(O)<=0;)N=Ce(N),D=Ce(D);var x=Te(N,1),R=Te(D,1);for(D=Te(D,2),N=Te(N,2);!w(D);){var M=R.add(D);M.l(O)<=0&&(x=x.add(N),R=M),D=Te(D,1),N=Te(N,1)}return I=L(O,x.j(I)),new ve(x,I)}for(x=h;O.l(I)>=0;){for(N=Math.max(1,Math.floor(O.m()/I.m())),D=Math.ceil(Math.log(N)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),R=c(N),M=R.j(I);S(M)||M.l(O)>0;)N-=D,R=c(N),M=R.j(I);w(R)&&(R=f),x=x.add(R),O=L(O,M)}return new ve(x,O)}n.B=function(O){return be(this,O).h},n.and=function(O){let I=Math.max(this.g.length,O.g.length),N=[];for(let D=0;D<I;D++)N[D]=this.i(D)&O.i(D);return new s(N,this.h&O.h)},n.or=function(O){let I=Math.max(this.g.length,O.g.length),N=[];for(let D=0;D<I;D++)N[D]=this.i(D)|O.i(D);return new s(N,this.h|O.h)},n.xor=function(O){let I=Math.max(this.g.length,O.g.length),N=[];for(let D=0;D<I;D++)N[D]=this.i(D)^O.i(D);return new s(N,this.h^O.h)};function Ce(O){let I=O.g.length+1,N=[];for(let D=0;D<I;D++)N[D]=O.i(D)<<1|O.i(D-1)>>>31;return new s(N,O.h)}function Te(O,I){let N=I>>5;I%=32;let D=O.g.length-N,x=[];for(let R=0;R<D;R++)x[R]=I>0?O.i(R+N)>>>I|O.i(R+N+1)<<32-I:O.i(R+N);return new s(x,O.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Yb=FR.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=d,vo=FR.Integer=s}).apply(typeof OR<"u"?OR:typeof self<"u"?self:typeof window<"u"?window:{});var Kg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_o={};var Qb,P9,ql,Jb,wd,Yg,Zb,Xb,ew;(function(){var n,e=Object.defineProperty;function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kg=="object"&&Kg];for(var p=0;p<u.length;++p){var _=u[p];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function r(u,p){if(p)e:{var _=i;u=u.split(".");for(var T=0;T<u.length-1;T++){var U=u[T];if(!(U in _))break e;_=_[U]}u=u[u.length-1],T=_[u],p=p(T),p!=T&&p!=null&&e(_,u,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(u){return u||function(p){var _=[],T;for(T in p)Object.prototype.hasOwnProperty.call(p,T)&&_.push([T,p[T]]);return _}});var o=o||{},s=this||self;function a(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function l(u,p,_){return u.call.apply(u.bind,arguments)}function c(u,p,_){return c=l,c.apply(null,arguments)}function d(u,p){var _=Array.prototype.slice.call(arguments,1);return function(){var T=_.slice();return T.push.apply(T,arguments),u.apply(this,T)}}function h(u,p){function _(){}_.prototype=p.prototype,u.Z=p.prototype,u.prototype=new _,u.prototype.constructor=u,u.Ob=function(T,U,j){for(var fe=Array(arguments.length-2),Ze=2;Ze<arguments.length;Ze++)fe[Ze-2]=arguments[Ze];return p.prototype[U].apply(T,fe)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function g(u){let p=u.length;if(p>0){let _=Array(p);for(let T=0;T<p;T++)_[T]=u[T];return _}return[]}function w(u,p){for(let T=1;T<arguments.length;T++){let U=arguments[T];var _=typeof U;if(_=_!="object"?_:U?Array.isArray(U)?"array":_:"null",_=="array"||_=="object"&&typeof U.length=="number"){_=u.length||0;let j=U.length||0;u.length=_+j;for(let fe=0;fe<j;fe++)u[_+fe]=U[fe]}else u.push(U)}}class S{constructor(p,_){this.i=p,this.j=_,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function P(u){s.setTimeout(()=>{throw u},0)}function L(){var u=O;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Z{constructor(){this.h=this.g=null}add(p,_){let T=ve.get();T.set(p,_),this.h?this.h.next=T:this.g=T,this.h=T}}var ve=new S(()=>new be,u=>u.reset());class be{constructor(){this.next=this.g=this.h=null}set(p,_){this.h=p,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ce,Te=!1,O=new Z,I=()=>{let u=Promise.resolve(void 0);Ce=()=>{u.then(N)}};function N(){for(var u;u=L();){try{u.h.call(u.g)}catch(_){P(_)}var p=ve;p.j(u),p.h<100&&(p.h++,u.next=p.g,p.g=u)}Te=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function x(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}x.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let _=()=>{};s.addEventListener("test",_,p),s.removeEventListener("test",_,p)}catch{}return u})();function M(u){return/^[\s\xa0]*$/.test(u)}function me(u,p){x.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,p)}h(me,x),me.prototype.init=function(u,p){let _=this.type=u.type,T=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget,p||(_=="mouseover"?p=u.fromElement:_=="mouseout"&&(p=u.toElement)),this.relatedTarget=p,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&me.Z.h.call(this)},me.prototype.h=function(){me.Z.h.call(this);let u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Le="closure_listenable_"+(Math.random()*1e6|0),pe=0;function Ut(u,p,_,T,U){this.listener=u,this.proxy=null,this.src=p,this.type=_,this.capture=!!T,this.ha=U,this.key=++pe,this.da=this.fa=!1}function Zt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Pe(u,p,_){for(let T in u)p.call(_,u[T],T,u)}function zt(u,p){for(let _ in u)p.call(void 0,u[_],_,u)}function lt(u){let p={};for(let _ in u)p[_]=u[_];return p}let oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function se(u,p){let _,T;for(let U=1;U<arguments.length;U++){T=arguments[U];for(_ in T)u[_]=T[_];for(let j=0;j<oe.length;j++)_=oe[j],Object.prototype.hasOwnProperty.call(T,_)&&(u[_]=T[_])}}function we(u){this.src=u,this.g={},this.h=0}we.prototype.add=function(u,p,_,T,U){let j=u.toString();u=this.g[j],u||(u=this.g[j]=[],this.h++);let fe=ye(u,p,T,U);return fe>-1?(p=u[fe],_||(p.fa=!1)):(p=new Ut(p,this.src,j,!!T,U),p.fa=_,u.push(p)),p};function _e(u,p){let _=p.type;if(_ in u.g){var T=u.g[_],U=Array.prototype.indexOf.call(T,p,void 0),j;(j=U>=0)&&Array.prototype.splice.call(T,U,1),j&&(Zt(p),u.g[_].length==0&&(delete u.g[_],u.h--))}}function ye(u,p,_,T){for(let U=0;U<u.length;++U){let j=u[U];if(!j.da&&j.listener==p&&j.capture==!!_&&j.ha==T)return U}return-1}var b="closure_lm_"+(Math.random()*1e6|0),le={};function qe(u,p,_,T,U){if(T&&T.once)return bt(u,p,_,T,U);if(Array.isArray(p)){for(let j=0;j<p.length;j++)qe(u,p[j],_,T,U);return null}return _=Ac(_),u&&u[Le]?u.J(p,_,a(T)?!!T.capture:!!T,U):Ke(u,p,_,!1,T,U)}function Ke(u,p,_,T,U,j){if(!p)throw Error("Invalid event type");let fe=a(U)?!!U.capture:!!U,Ze=$n(u);if(Ze||(u[b]=Ze=new we(u)),_=Ze.add(p,_,T,fe,j),_.proxy)return _;if(T=ae(),_.proxy=T,T.src=u,T.listener=_,u.addEventListener)R||(U=fe),U===void 0&&(U=!1),u.addEventListener(p.toString(),T,U);else if(u.attachEvent)u.attachEvent(Ps(p.toString()),T);else if(u.addListener&&u.removeListener)u.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return _}function ae(){function u(_){return p.call(u.src,u.listener,_)}let p=mh;return u}function bt(u,p,_,T,U){if(Array.isArray(p)){for(let j=0;j<p.length;j++)bt(u,p[j],_,T,U);return null}return _=Ac(_),u&&u[Le]?u.K(p,_,a(T)?!!T.capture:!!T,U):Ke(u,p,_,!0,T,U)}function Ii(u,p,_,T,U){if(Array.isArray(p))for(var j=0;j<p.length;j++)Ii(u,p[j],_,T,U);else T=a(T)?!!T.capture:!!T,_=Ac(_),u&&u[Le]?(u=u.i,j=String(p).toString(),j in u.g&&(p=u.g[j],_=ye(p,_,T,U),_>-1&&(Zt(p[_]),Array.prototype.splice.call(p,_,1),p.length==0&&(delete u.g[j],u.h--)))):u&&(u=$n(u))&&(p=u.g[p.toString()],u=-1,p&&(u=ye(p,_,T,U)),(_=u>-1?p[u]:null)&&oi(_))}function oi(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[Le])_e(p.i,u);else{var _=u.type,T=u.proxy;p.removeEventListener?p.removeEventListener(_,T,u.capture):p.detachEvent?p.detachEvent(Ps(_),T):p.addListener&&p.removeListener&&p.removeListener(T),(_=$n(p))?(_e(_,u),_.h==0&&(_.src=null,p[b]=null)):Zt(u)}}}function Ps(u){return u in le?le[u]:le[u]="on"+u}function mh(u,p){if(u.da)u=!0;else{p=new me(p,this);let _=u.listener,T=u.ha||u.src;u.fa&&oi(u),u=_.call(T,p)}return u}function $n(u){return u=u[b],u instanceof we?u:null}var Dc="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ac(u){return typeof u=="function"?u:(u[Dc]||(u[Dc]=function(p){return u.handleEvent(p)}),u[Dc])}function Pn(){D.call(this),this.i=new we(this),this.M=this,this.G=null}h(Pn,D),Pn.prototype[Le]=!0,Pn.prototype.removeEventListener=function(u,p,_,T){Ii(this,u,p,_,T)};function kt(u,p){var _,T=u.G;if(T)for(_=[];T;T=T.G)_.push(T);if(u=u.M,T=p.type||p,typeof p=="string")p=new x(p,u);else if(p instanceof x)p.target=p.target||u;else{var U=p;p=new x(T,u),se(p,U)}U=!0;let j,fe;if(_)for(fe=_.length-1;fe>=0;fe--)j=p.g=_[fe],U=Wr(j,T,!0,p)&&U;if(j=p.g=u,U=Wr(j,T,!0,p)&&U,U=Wr(j,T,!1,p)&&U,_)for(fe=0;fe<_.length;fe++)j=p.g=_[fe],U=Wr(j,T,!1,p)&&U}Pn.prototype.N=function(){if(Pn.Z.N.call(this),this.i){var u=this.i;for(let p in u.g){let _=u.g[p];for(let T=0;T<_.length;T++)Zt(_[T]);delete u.g[p],u.h--}}this.G=null},Pn.prototype.J=function(u,p,_,T){return this.i.add(String(u),p,!1,_,T)},Pn.prototype.K=function(u,p,_,T){return this.i.add(String(u),p,!0,_,T)};function Wr(u,p,_,T){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();let U=!0;for(let j=0;j<p.length;++j){let fe=p[j];if(fe&&!fe.da&&fe.capture==_){let Ze=fe.listener,gn=fe.ha||fe.src;fe.fa&&_e(u.i,fe),U=Ze.call(gn,T)!==!1&&U}}return U&&!T.defaultPrevented}function V0(u,p){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=c(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:s.setTimeout(u,p||0)}function ur(u){u.g=V0(()=>{u.g=null,u.i&&(u.i=!1,ur(u))},u.l);let p=u.h;u.h=null,u.m.apply(null,p)}class Lo extends D{constructor(p,_){super(),this.m=p,this.l=_,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ur(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ns(u){D.call(this),this.h=u,this.g={}}h(Ns,D);var z=[];function V(u){Pe(u.g,function(p,_){this.g.hasOwnProperty(_)&&oi(p)},u),u.g={}}Ns.prototype.N=function(){Ns.Z.N.call(this),V(this)},Ns.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var J=s.JSON.stringify,X=s.JSON.parse,De=class{stringify(u){return s.JSON.stringify(u,void 0)}parse(u){return s.JSON.parse(u,void 0)}};function Ve(){}function Xe(){}var dt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wt(){x.call(this,"d")}h(wt,x);function mt(){x.call(this,"c")}h(mt,x);var En={},Vo=null;function qa(){return Vo=Vo||new Pn}En.Ia="serverreachability";function Mc(u){x.call(this,En.Ia,u)}h(Mc,x);function si(u){let p=qa();kt(p,new Mc(p))}En.STAT_EVENT="statevent";function qr(u,p){x.call(this,En.STAT_EVENT,u),this.stat=p}h(qr,x);function Wt(u){let p=qa();kt(p,new qr(p,u))}En.Ja="timingevent";function yh(u,p){x.call(this,En.Ja,u),this.size=p}h(yh,x);function Kr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){u()},p)}function Yr(){this.g=!0}Yr.prototype.ua=function(){this.g=!1};function U0(u,p,_,T,U,j){u.info(function(){if(u.g)if(j){var fe="",Ze=j.split("&");for(let Dt=0;Dt<Ze.length;Dt++){var gn=Ze[Dt].split("=");if(gn.length>1){let wn=gn[0];gn=gn[1];let hr=wn.split("_");fe=hr.length>=2&&hr[1]=="type"?fe+(wn+"="+gn+"&"):fe+(wn+"=redacted&")}}}else fe=null;else fe=j;return"XMLHTTP REQ ("+T+") [attempt "+U+"]: "+p+`
`+_+`
`+fe})}function Y1(u,p,_,T,U,j,fe){u.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+U+"]: "+p+`
`+_+`
`+j+" "+fe})}function ji(u,p,_,T){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+j0(u,_)+(T?" "+T:"")})}function B0(u,p){u.info(function(){return"TIMEOUT: "+p})}Yr.prototype.info=function(){};function j0(u,p){if(!u.g)return p;if(!p)return null;try{let j=JSON.parse(p);if(j){for(u=0;u<j.length;u++)if(Array.isArray(j[u])){var _=j[u];if(!(_.length<2)){var T=_[1];if(Array.isArray(T)&&!(T.length<1)){var U=T[0];if(U!="noop"&&U!="stop"&&U!="close")for(let fe=1;fe<T.length;fe++)T[fe]=""}}}}return J(j)}catch{return p}}var xe={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},He={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},At;function Bt(){}h(Bt,Ve),Bt.prototype.g=function(){return new XMLHttpRequest},At=new Bt;function Ot(u){return encodeURIComponent(String(u))}function bn(u){var p=1;u=u.split(":");let _=[];for(;p>0&&u.length;)_.push(u.shift()),p--;return u.length&&_.push(u.join(":")),_}function Ft(u,p,_,T){this.j=u,this.i=p,this.l=_,this.S=T||1,this.V=new Ns(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ks}function ks(){this.i=null,this.g="",this.h=!1}var Q1={},H0={};function $0(u,p,_){u.M=1,u.A=_h(dr(p)),u.u=_,u.R=!0,J1(u,null)}function J1(u,p){u.F=Date.now(),vh(u),u.B=dr(u.A);var _=u.B,T=u.S;Array.isArray(T)||(T=[String(T)]),uS(_.i,"t",T),u.C=0,_=u.j.L,u.h=new ks,u.g=DS(u.j,_?p:null,!u.u),u.P>0&&(u.O=new Lo(c(u.Y,u,u.g),u.P)),p=u.V,_=u.g,T=u.ba;var U="readystatechange";Array.isArray(U)||(U&&(z[0]=U.toString()),U=z);for(let j=0;j<U.length;j++){let fe=qe(_,U[j],T||p.handleEvent,!1,p.h||p);if(!fe)break;p.g[fe.key]=fe}p=u.J?lt(u.J):{},u.u?(u.v||(u.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,p)):(u.v="GET",u.g.ea(u.B,u.v,null,p)),si(),U0(u.i,u.v,u.B,u.l,u.S,u.u)}Ft.prototype.ba=function(u){u=u.target;let p=this.O;p&&jo(u)==3?p.j():this.Y(u)},Ft.prototype.Y=function(u){try{if(u==this.g)e:{let Ze=jo(this.g),gn=this.g.ya(),Dt=this.g.ca();if(!(Ze<3)&&(Ze!=3||this.g&&(this.h.h||this.g.la()||yS(this.g)))){this.K||Ze!=4||gn==7||(gn==8||Dt<=0?si(3):si(2)),G0(this);var p=this.g.ca();this.X=p;var _=$O(this);if(this.o=p==200,Y1(this.i,this.v,this.B,this.l,this.S,Ze,p),this.o){if(this.U&&!this.L){t:{if(this.g){var T,U=this.g;if((T=U.g?U.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(T)){var j=T;break t}}j=null}if(u=j)ji(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,z0(this,u);else{this.o=!1,this.m=3,Wt(12),Os(this),Rc(this);break e}}if(this.R){u=!0;let wn;for(;!this.K&&this.C<_.length;)if(wn=GO(this,_),wn==H0){Ze==4&&(this.m=4,Wt(14),u=!1),ji(this.i,this.l,null,"[Incomplete Response]");break}else if(wn==Q1){this.m=4,Wt(15),ji(this.i,this.l,_,"[Invalid Chunk]"),u=!1;break}else ji(this.i,this.l,wn,null),z0(this,wn);if(Z1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||_.length!=0||this.h.h||(this.m=1,Wt(16),u=!1),this.o=this.o&&u,!u)ji(this.i,this.l,_,"[Invalid Chunked Response]"),Os(this),Rc(this);else if(_.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),Z0(fe),fe.P=!0,Wt(11))}}else ji(this.i,this.l,_,null),z0(this,_);Ze==4&&Os(this),this.o&&!this.K&&(Ze==4?SS(this.j,this):(this.o=!1,vh(this)))}else r4(this.g),p==400&&_.indexOf("Unknown SID")>0?(this.m=3,Wt(12)):(this.m=0,Wt(13)),Os(this),Rc(this)}}}catch{}};function $O(u){if(!Z1(u))return u.g.la();let p=yS(u.g);if(p==="")return"";let _="",T=p.length,U=jo(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Os(u),Rc(u),"";u.h.i=new s.TextDecoder}for(let j=0;j<T;j++)u.h.h=!0,_+=u.h.i.decode(p[j],{stream:!(U&&j==T-1)});return p.length=0,u.h.g+=_,u.C=0,u.h.g}function Z1(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function GO(u,p){var _=u.C,T=p.indexOf(`
`,_);return T==-1?H0:(_=Number(p.substring(_,T)),isNaN(_)?Q1:(T+=1,T+_>p.length?H0:(p=p.slice(T,T+_),u.C=T+_,p)))}Ft.prototype.cancel=function(){this.K=!0,Os(this)};function vh(u){u.T=Date.now()+u.H,X1(u,u.H)}function X1(u,p){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Kr(c(u.aa,u),p)}function G0(u){u.D&&(s.clearTimeout(u.D),u.D=null)}Ft.prototype.aa=function(){this.D=null;let u=Date.now();u-this.T>=0?(B0(this.i,this.B),this.M!=2&&(si(),Wt(17)),Os(this),this.m=2,Rc(this)):X1(this,this.T-u)};function Rc(u){u.j.I==0||u.K||SS(u.j,u)}function Os(u){G0(u);var p=u.O;p&&typeof p.dispose=="function"&&p.dispose(),u.O=null,V(u.V),u.g&&(p=u.g,u.g=null,p.abort(),p.dispose())}function z0(u,p){try{var _=u.j;if(_.I!=0&&(_.g==u||W0(_.h,u))){if(!u.L&&W0(_.h,u)&&_.I==3){try{var T=_.Ba.g.parse(p)}catch{T=null}if(Array.isArray(T)&&T.length==3){var U=T;if(U[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<u.F)Ih(_),xh(_);else break e;J0(_),Wt(18)}}else _.xa=U[1],0<_.xa-_.K&&U[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Kr(c(_.Va,_),6e3));nS(_.h)<=1&&_.ta&&(_.ta=void 0)}else Ls(_,11)}else if((u.L||_.g==u)&&Ih(_),!M(p))for(U=_.Ba.g.parse(p),p=0;p<U.length;p++){let Dt=U[p],wn=Dt[0];if(!(wn<=_.K))if(_.K=wn,Dt=Dt[1],_.I==2)if(Dt[0]=="c"){_.M=Dt[1],_.ba=Dt[2];let hr=Dt[3];hr!=null&&(_.ka=hr,_.j.info("VER="+_.ka));let Vs=Dt[4];Vs!=null&&(_.za=Vs,_.j.info("SVER="+_.za));let Ho=Dt[5];Ho!=null&&typeof Ho=="number"&&Ho>0&&(T=1.5*Ho,_.O=T,_.j.info("backChannelRequestTimeoutMs_="+T)),T=_;let $o=u.g;if($o){let Ch=$o.g?$o.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ch){var j=T.h;j.g||Ch.indexOf("spdy")==-1&&Ch.indexOf("quic")==-1&&Ch.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(q0(j,j.h),j.h=null))}if(T.G){let X0=$o.g?$o.g.getResponseHeader("X-HTTP-Session-Id"):null;X0&&(T.wa=X0,Lt(T.J,T.G,X0))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-u.F,_.j.info("Handshake RTT: "+_.T+"ms")),T=_;var fe=u;if(T.na=CS(T,T.L?T.ba:null,T.W),fe.L){iS(T.h,fe);var Ze=fe,gn=T.O;gn&&(Ze.H=gn),Ze.D&&(G0(Ze),vh(Ze)),T.g=fe}else wS(T);_.i.length>0&&Sh(_)}else Dt[0]!="stop"&&Dt[0]!="close"||Ls(_,7);else _.I==3&&(Dt[0]=="stop"||Dt[0]=="close"?Dt[0]=="stop"?Ls(_,7):Q0(_):Dt[0]!="noop"&&_.l&&_.l.qa(Dt),_.A=0)}}si(4)}catch{}}var zO=class{constructor(u,p){this.g=u,this.map=p}};function eS(u){this.l=u||10,s.PerformanceNavigationTiming?(u=s.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function tS(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function nS(u){return u.h?1:u.g?u.g.size:0}function W0(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function q0(u,p){u.g?u.g.add(p):u.h=p}function iS(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}eS.prototype.cancel=function(){if(this.i=rS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function rS(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let p=u.i;for(let _ of u.g.values())p=p.concat(_.G);return p}return g(u.i)}var oS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function WO(u,p){if(u){u=u.split("&");for(let _=0;_<u.length;_++){let T=u[_].indexOf("="),U,j=null;T>=0?(U=u[_].substring(0,T),j=u[_].substring(T+1)):U=u[_],p(U,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Uo(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;u instanceof Uo?(this.l=u.l,Pc(this,u.j),this.o=u.o,this.g=u.g,Nc(this,u.u),this.h=u.h,K0(this,dS(u.i)),this.m=u.m):u&&(p=String(u).match(oS))?(this.l=!1,Pc(this,p[1]||"",!0),this.o=kc(p[2]||""),this.g=kc(p[3]||"",!0),Nc(this,p[4]),this.h=kc(p[5]||"",!0),K0(this,p[6]||"",!0),this.m=kc(p[7]||"")):(this.l=!1,this.i=new Fc(null,this.l))}Uo.prototype.toString=function(){let u=[];var p=this.j;p&&u.push(Oc(p,sS,!0),":");var _=this.g;return(_||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Oc(p,sS,!0),"@"),u.push(Ot(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&u.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Oc(_,_.charAt(0)=="/"?YO:KO,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Oc(_,JO)),u.join("")},Uo.prototype.resolve=function(u){let p=dr(this),_=!!u.j;_?Pc(p,u.j):_=!!u.o,_?p.o=u.o:_=!!u.g,_?p.g=u.g:_=u.u!=null;var T=u.h;if(_)Nc(p,u.u);else if(_=!!u.h){if(T.charAt(0)!="/")if(this.g&&!this.h)T="/"+T;else{var U=p.h.lastIndexOf("/");U!=-1&&(T=p.h.slice(0,U+1)+T)}if(U=T,U==".."||U==".")T="";else if(U.indexOf("./")!=-1||U.indexOf("/.")!=-1){T=U.lastIndexOf("/",0)==0,U=U.split("/");let j=[];for(let fe=0;fe<U.length;){let Ze=U[fe++];Ze=="."?T&&fe==U.length&&j.push(""):Ze==".."?((j.length>1||j.length==1&&j[0]!="")&&j.pop(),T&&fe==U.length&&j.push("")):(j.push(Ze),T=!0)}T=j.join("/")}else T=U}return _?p.h=T:_=u.i.toString()!=="",_?K0(p,dS(u.i)):_=!!u.m,_&&(p.m=u.m),p};function dr(u){return new Uo(u)}function Pc(u,p,_){u.j=_?kc(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Nc(u,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);u.u=p}else u.u=null}function K0(u,p,_){p instanceof Fc?(u.i=p,ZO(u.i,u.l)):(_||(p=Oc(p,QO)),u.i=new Fc(p,u.l))}function Lt(u,p,_){u.i.set(p,_)}function _h(u){return Lt(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function kc(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Oc(u,p,_){return typeof u=="string"?(u=encodeURI(u).replace(p,qO),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function qO(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var sS=/[#\/\?@]/g,KO=/[#\?:]/g,YO=/[#\?]/g,QO=/[#\?@]/g,JO=/#/g;function Fc(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Fs(u){u.g||(u.g=new Map,u.h=0,u.i&&WO(u.i,function(p,_){u.add(decodeURIComponent(p.replace(/\+/g," ")),_)}))}n=Fc.prototype,n.add=function(u,p){Fs(this),this.i=null,u=Ka(this,u);let _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(p),this.h+=1,this};function aS(u,p){Fs(u),p=Ka(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function lS(u,p){return Fs(u),p=Ka(u,p),u.g.has(p)}n.forEach=function(u,p){Fs(this),this.g.forEach(function(_,T){_.forEach(function(U){u.call(p,U,T,this)},this)},this)};function cS(u,p){Fs(u);let _=[];if(typeof p=="string")lS(u,p)&&(_=_.concat(u.g.get(Ka(u,p))));else for(u=Array.from(u.g.values()),p=0;p<u.length;p++)_=_.concat(u[p]);return _}n.set=function(u,p){return Fs(this),this.i=null,u=Ka(this,u),lS(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=cS(this,u),u.length>0?String(u[0]):p):p};function uS(u,p,_){aS(u,p),_.length>0&&(u.i=null,u.g.set(Ka(u,p),g(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],p=Array.from(this.g.keys());for(let T=0;T<p.length;T++){var _=p[T];let U=Ot(_);_=cS(this,_);for(let j=0;j<_.length;j++){let fe=U;_[j]!==""&&(fe+="="+Ot(_[j])),u.push(fe)}}return this.i=u.join("&")};function dS(u){let p=new Fc;return p.i=u.i,u.g&&(p.g=new Map(u.g),p.h=u.h),p}function Ka(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function ZO(u,p){p&&!u.j&&(Fs(u),u.i=null,u.g.forEach(function(_,T){let U=T.toLowerCase();T!=U&&(aS(this,T),uS(this,U,_))},u)),u.j=p}function XO(u,p){let _=new Yr;if(s.Image){let T=new Image;T.onload=d(Bo,_,"TestLoadImage: loaded",!0,p,T),T.onerror=d(Bo,_,"TestLoadImage: error",!1,p,T),T.onabort=d(Bo,_,"TestLoadImage: abort",!1,p,T),T.ontimeout=d(Bo,_,"TestLoadImage: timeout",!1,p,T),s.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=u}else p(!1)}function e4(u,p){let _=new Yr,T=new AbortController,U=setTimeout(()=>{T.abort(),Bo(_,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:T.signal}).then(j=>{clearTimeout(U),j.ok?Bo(_,"TestPingServer: ok",!0,p):Bo(_,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(U),Bo(_,"TestPingServer: error",!1,p)})}function Bo(u,p,_,T,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),T(_)}catch{}}function t4(){this.g=new De}function Eh(u){this.i=u.Sb||null,this.h=u.ab||!1}h(Eh,Ve),Eh.prototype.g=function(){return new bh(this.i,this.h)};function bh(u,p){Pn.call(this),this.H=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(bh,Pn),n=bh.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=p,this.readyState=1,Vc(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(p.body=u),(this.H||s).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Lc(this)),this.readyState=0},n.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Vc(this)),this.g&&(this.readyState=3,Vc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;hS(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function hS(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}n.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Lc(this):Vc(this),this.readyState==3&&hS(this)}},n.Oa=function(u){this.g&&(this.response=this.responseText=u,Lc(this))},n.Na=function(u){this.g&&(this.response=u,Lc(this))},n.ga=function(){this.g&&Lc(this)};function Lc(u){u.readyState=4,u.l=null,u.j=null,u.B=null,Vc(u)}n.setRequestHeader=function(u,p){this.A.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],p=this.h.entries();for(var _=p.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=p.next();return u.join(`\r
`)};function Vc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(bh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function fS(u){let p="";return Pe(u,function(_,T){p+=T,p+=":",p+=_,p+=`\r
`}),p}function Y0(u,p,_){e:{for(T in _){var T=!1;break e}T=!0}T||(_=fS(_),typeof u=="string"?_!=null&&Ot(_):Lt(u,p,_))}function qt(u){Pn.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(qt,Pn);var n4=/^https?$/i,i4=["POST","PUT"];n=qt.prototype,n.Fa=function(u){this.H=u},n.ea=function(u,p,_,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():At.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(j){pS(this,j);return}if(u=_||"",_=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var U in T)_.set(U,T[U]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(let j of T.keys())_.set(j,T.get(j));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(_.keys()).find(j=>j.toLowerCase()=="content-type"),U=s.FormData&&u instanceof s.FormData,!(Array.prototype.indexOf.call(i4,p,void 0)>=0)||T||U||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[j,fe]of _)this.g.setRequestHeader(j,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(j){pS(this,j)}};function pS(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.o=5,gS(u),wh(u)}function gS(u){u.A||(u.A=!0,kt(u,"complete"),kt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,kt(this,"complete"),kt(this,"abort"),wh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),wh(this,!0)),qt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?mS(this):this.Xa())},n.Xa=function(){mS(this)};function mS(u){if(u.h&&typeof o<"u"){if(u.v&&jo(u)==4)setTimeout(u.Ca.bind(u),0);else if(kt(u,"readystatechange"),jo(u)==4){u.h=!1;try{let j=u.ca();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var _;if(!(_=p)){var T;if(T=j===0){let fe=String(u.D).match(oS)[1]||null;!fe&&s.self&&s.self.location&&(fe=s.self.location.protocol.slice(0,-1)),T=!n4.test(fe?fe.toLowerCase():"")}_=T}if(_)kt(u,"complete"),kt(u,"success");else{u.o=6;try{var U=jo(u)>2?u.g.statusText:""}catch{U=""}u.l=U+" ["+u.ca()+"]",gS(u)}}finally{wh(u)}}}}function wh(u,p){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);let _=u.g;u.g=null,p||kt(u,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function jo(u){return u.g?u.g.readyState:0}n.ca=function(){try{return jo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),X(p)}};function yS(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function r4(u){let p={};u=(u.g&&jo(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<u.length;T++){if(M(u[T]))continue;var _=bn(u[T]);let U=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();let j=p[U]||[];p[U]=j,j.push(_)}zt(p,function(T){return T.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Uc(u,p,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||p}function vS(u){this.za=0,this.i=[],this.j=new Yr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Uc("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Uc("baseRetryDelayMs",5e3,u),this.Za=Uc("retryDelaySeedMs",1e4,u),this.Ta=Uc("forwardChannelMaxRetries",2,u),this.va=Uc("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new eS(u&&u.concurrentRequestLimit),this.Ba=new t4,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=vS.prototype,n.ka=8,n.I=1,n.connect=function(u,p,_,T){Wt(0),this.W=u,this.H=p||{},_&&T!==void 0&&(this.H.OSID=_,this.H.OAID=T),this.F=this.X,this.J=CS(this,null,this.W),Sh(this)};function Q0(u){if(_S(u),u.I==3){var p=u.V++,_=dr(u.J);if(Lt(_,"SID",u.M),Lt(_,"RID",p),Lt(_,"TYPE","terminate"),Bc(u,_),p=new Ft(u,u.j,p),p.M=2,p.A=_h(dr(_)),_=!1,s.navigator&&s.navigator.sendBeacon)try{_=s.navigator.sendBeacon(p.A.toString(),"")}catch{}!_&&s.Image&&(new Image().src=p.A,_=!0),_||(p.g=DS(p.j,null),p.g.ea(p.A)),p.F=Date.now(),vh(p)}TS(u)}function xh(u){u.g&&(Z0(u),u.g.cancel(),u.g=null)}function _S(u){xh(u),u.v&&(s.clearTimeout(u.v),u.v=null),Ih(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&s.clearTimeout(u.m),u.m=null)}function Sh(u){if(!tS(u.h)&&!u.m){u.m=!0;var p=u.Ea;Ce||I(),Te||(Ce(),Te=!0),O.add(p,u),u.D=0}}function o4(u,p){return nS(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=p.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Kr(c(u.Ea,u,p),IS(u,u.D)),u.D++,!0)}n.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;let U=new Ft(this,this.j,u),j=this.o;if(this.U&&(j?(j=lt(j),se(j,this.U)):j=this.U),this.u!==null||this.R||(U.J=j,j=null),this.S)e:{for(var p=0,_=0;_<this.i.length;_++){t:{var T=this.i[_];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(p+=T,p>4096){p=_;break e}if(p===4096||_===this.i.length-1){p=_+1;break e}}p=1e3}else p=1e3;p=bS(this,U,p),_=dr(this.J),Lt(_,"RID",u),Lt(_,"CVER",22),this.G&&Lt(_,"X-HTTP-Session-Id",this.G),Bc(this,_),j&&(this.R?p="headers="+Ot(fS(j))+"&"+p:this.u&&Y0(_,this.u,j)),q0(this.h,U),this.Ra&&Lt(_,"TYPE","init"),this.S?(Lt(_,"$req",p),Lt(_,"SID","null"),U.U=!0,$0(U,_,null)):$0(U,_,p),this.I=2}}else this.I==3&&(u?ES(this,u):this.i.length==0||tS(this.h)||ES(this))};function ES(u,p){var _;p?_=p.l:_=u.V++;let T=dr(u.J);Lt(T,"SID",u.M),Lt(T,"RID",_),Lt(T,"AID",u.K),Bc(u,T),u.u&&u.o&&Y0(T,u.u,u.o),_=new Ft(u,u.j,_,u.D+1),u.u===null&&(_.J=u.o),p&&(u.i=p.G.concat(u.i)),p=bS(u,_,1e3),_.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),q0(u.h,_),$0(_,T,p)}function Bc(u,p){u.H&&Pe(u.H,function(_,T){Lt(p,T,_)}),u.l&&Pe({},function(_,T){Lt(p,T,_)})}function bS(u,p,_){_=Math.min(u.i.length,_);let T=u.l?c(u.l.Ka,u.l,u):null;e:{var U=u.i;let Ze=-1;for(;;){let gn=["count="+_];Ze==-1?_>0?(Ze=U[0].g,gn.push("ofs="+Ze)):Ze=0:gn.push("ofs="+Ze);let Dt=!0;for(let wn=0;wn<_;wn++){var j=U[wn].g;let hr=U[wn].map;if(j-=Ze,j<0)Ze=Math.max(0,U[wn].g-100),Dt=!1;else try{j="req"+j+"_"||"";try{var fe=hr instanceof Map?hr:Object.entries(hr);for(let[Vs,Ho]of fe){let $o=Ho;a(Ho)&&($o=J(Ho)),gn.push(j+Vs+"="+encodeURIComponent($o))}}catch(Vs){throw gn.push(j+"type="+encodeURIComponent("_badmap")),Vs}}catch{T&&T(hr)}}if(Dt){fe=gn.join("&");break e}}fe=void 0}return u=u.i.splice(0,_),p.G=u,fe}function wS(u){if(!u.g&&!u.v){u.Y=1;var p=u.Da;Ce||I(),Te||(Ce(),Te=!0),O.add(p,u),u.A=0}}function J0(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Kr(c(u.Da,u),IS(u,u.A)),u.A++,!0)}n.Da=function(){if(this.v=null,xS(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Kr(c(this.Wa,this),u)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Wt(10),xh(this),xS(this))};function Z0(u){u.B!=null&&(s.clearTimeout(u.B),u.B=null)}function xS(u){u.g=new Ft(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var p=dr(u.na);Lt(p,"RID","rpc"),Lt(p,"SID",u.M),Lt(p,"AID",u.K),Lt(p,"CI",u.F?"0":"1"),!u.F&&u.ia&&Lt(p,"TO",u.ia),Lt(p,"TYPE","xmlhttp"),Bc(u,p),u.u&&u.o&&Y0(p,u.u,u.o),u.O&&(u.g.H=u.O);var _=u.g;u=u.ba,_.M=1,_.A=_h(dr(p)),_.u=null,_.R=!0,J1(_,u)}n.Va=function(){this.C!=null&&(this.C=null,xh(this),J0(this),Wt(19))};function Ih(u){u.C!=null&&(s.clearTimeout(u.C),u.C=null)}function SS(u,p){var _=null;if(u.g==p){Ih(u),Z0(u),u.g=null;var T=2}else if(W0(u.h,p))_=p.G,iS(u.h,p),T=1;else return;if(u.I!=0){if(p.o)if(T==1){_=p.u?p.u.length:0,p=Date.now()-p.F;var U=u.D;T=qa(),kt(T,new yh(T,_)),Sh(u)}else wS(u);else if(U=p.m,U==3||U==0&&p.X>0||!(T==1&&o4(u,p)||T==2&&J0(u)))switch(_&&_.length>0&&(p=u.h,p.i=p.i.concat(_)),U){case 1:Ls(u,5);break;case 4:Ls(u,10);break;case 3:Ls(u,6);break;default:Ls(u,2)}}}function IS(u,p){let _=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(_*=2),_*p}function Ls(u,p){if(u.j.info("Error code "+p),p==2){var _=c(u.bb,u),T=u.Ua;let U=!T;T=new Uo(T||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Pc(T,"https"),_h(T),U?XO(T.toString(),_):e4(T.toString(),_)}else Wt(2);u.I=0,u.l&&u.l.pa(p),TS(u),_S(u)}n.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Wt(2)):(this.j.info("Failed to ping google.com"),Wt(1))};function TS(u){if(u.I=0,u.ja=[],u.l){let p=rS(u.h);(p.length!=0||u.i.length!=0)&&(w(u.ja,p),w(u.ja,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.oa()}}function CS(u,p,_){var T=_ instanceof Uo?dr(_):new Uo(_);if(T.g!="")p&&(T.g=p+"."+T.g),Nc(T,T.u);else{var U=s.location;T=U.protocol,p=p?p+"."+U.hostname:U.hostname,U=+U.port;let j=new Uo(null);T&&Pc(j,T),p&&(j.g=p),U&&Nc(j,U),_&&(j.h=_),T=j}return _=u.G,p=u.wa,_&&p&&Lt(T,_,p),Lt(T,"VER",u.ka),Bc(u,T),T}function DS(u,p,_){if(p&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Aa&&!u.ma?new qt(new Eh({ab:_})):new qt(u.ma),p.Fa(u.L),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function AS(){}n=AS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Th(){}Th.prototype.g=function(u,p){return new ai(u,p)};function ai(u,p){Pn.call(this),this.g=new vS(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(u?u["X-WebChannel-Client-Profile"]=p.sa:u={"X-WebChannel-Client-Profile":p.sa}),this.g.U=u,(u=p&&p.Qb)&&!M(u)&&(this.g.u=u),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!M(p)&&(this.g.G=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ya(this)}h(ai,Pn),ai.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ai.prototype.close=function(){Q0(this.g)},ai.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.v&&(_={},_.__data__=J(u),u=_);p.i.push(new zO(p.Ya++,u)),p.I==3&&Sh(p)},ai.prototype.N=function(){this.g.l=null,delete this.j,Q0(this.g),delete this.g,ai.Z.N.call(this)};function MS(u){wt.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(let _ in p){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}h(MS,wt);function RS(){mt.call(this),this.status=1}h(RS,mt);function Ya(u){this.g=u}h(Ya,AS),Ya.prototype.ra=function(){kt(this.g,"a")},Ya.prototype.qa=function(u){kt(this.g,new MS(u))},Ya.prototype.pa=function(u){kt(this.g,new RS)},Ya.prototype.oa=function(){kt(this.g,"b")},Th.prototype.createWebChannel=Th.prototype.g,ai.prototype.send=ai.prototype.o,ai.prototype.open=ai.prototype.m,ai.prototype.close=ai.prototype.close,ew=_o.createWebChannelTransport=function(){return new Th},Xb=_o.getStatEventTarget=function(){return qa()},Zb=_o.Event=En,Yg=_o.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},xe.NO_ERROR=0,xe.TIMEOUT=8,xe.HTTP_ERROR=6,wd=_o.ErrorCode=xe,He.COMPLETE="complete",Jb=_o.EventType=He,Xe.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",Pn.prototype.listen=Pn.prototype.J,ql=_o.WebChannel=Xe,P9=_o.FetchXmlHttpFactory=Eh,qt.prototype.listenOnce=qt.prototype.K,qt.prototype.getLastError=qt.prototype.Ha,qt.prototype.getLastErrorCode=qt.prototype.ya,qt.prototype.getStatus=qt.prototype.ca,qt.prototype.getResponseJson=qt.prototype.La,qt.prototype.getResponseText=qt.prototype.la,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Fa,Qb=_o.XhrIo=qt}).apply(typeof Kg<"u"?Kg:typeof self<"u"?self:typeof window<"u"?window:{});var An=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");var uc="12.8.0";function wP(n){uc=n}var Ma=new gs("@firebase/firestore");function Kl(){return Ma.logLevel}function Se(n,...e){if(Ma.logLevel<=tt.DEBUG){let t=e.map(Px);Ma.debug(`Firestore (${uc}): ${n}`,...t)}}function xo(n,...e){if(Ma.logLevel<=tt.ERROR){let t=e.map(Px);Ma.error(`Firestore (${uc}): ${n}`,...t)}}function _s(n,...e){if(Ma.logLevel<=tt.WARN){let t=e.map(Px);Ma.warn(`Firestore (${uc}): ${n}`,...t)}}function Px(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Fe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,xP(n,i,t)}function xP(n,e,t){let i=`FIRESTORE (${uc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw xo(i),new Error(i)}function Et(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||xP(e,r,i)}function We(n,e){return n}var K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ue=class extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var or=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var nm=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},im=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(An.UNAUTHENTICATED))}shutdown(){}},sw=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},rm=class{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Et(this.o===void 0,42304);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),o=new or;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new or,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new or)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Et(typeof i.accessToken=="string",31837,{l:i}),new nm(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new An(e)}},aw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=An.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},lw=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new aw(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(An.FIRST_PARTY))}shutdown(){}invalidateToken(){}},om=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},sm=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Et(this.o===void 0,3512);let i=o=>{o.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,Se("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new om(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Et(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new om(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function N9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var Ra=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=N9(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}};function ot(n,e){return n<e?-1:n>e?1:0}function cw(n,e){let t=Math.min(n.length,e.length);for(let i=0;i<t;i++){let r=n.charAt(i),o=e.charAt(i);if(r!==o)return tw(r)===tw(o)?ot(r,o):tw(r)?1:-1}return ot(n.length,e.length)}var k9=55296,O9=57343;function tw(n){let e=n.charCodeAt(0);return e>=k9&&e<=O9}function ec(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var LR="__name__",am=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&Fe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Fe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return ot(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):cw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return vo.fromString(e.substring(4,e.length-2))}},Nt=class n extends am{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new ue(K.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},F9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=class n extends am{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return F9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===LR}static keyField(){return new n([LR])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new ue(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new ue(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ue(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(s=!s,r++):a!=="."||s?(i+=a,r++):(o(),r++)}if(o(),s)throw new ue(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Ne=class n{constructor(e){this.path=e}static fromPath(e){return new n(Nt.fromString(e))}static fromName(e){return new n(Nt.fromString(e).popFirst(5))}static empty(){return new n(Nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Nt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Nt(e.slice()))}};function SP(n,e,t){if(!t)throw new ue(K.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function IP(n,e,t,i){if(e===!0&&i===!0)throw new ue(K.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function VR(n){if(!Ne.isDocumentKey(n))throw new ue(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function UR(n){if(Ne.isDocumentKey(n))throw new ue(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function TP(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Hd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Fe(12329,{type:typeof n})}function $r(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Hd(n);throw new ue(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function CP(n,e){if(e<=0)throw new ue(K.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function on(n,e){let t={typeString:n};return e&&(t.value=e),t}function dc(n,e){if(!TP(n))throw new ue(K.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let s=n[i];if(r&&typeof s!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new ue(K.INVALID_ARGUMENT,t);return!0}var BR=-62135596800,jR=1e6,sn=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*jR);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<BR)throw new ue(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jR}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(dc(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-BR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};sn._jsonSchemaVersion="firestore/timestamp/1.0",sn._jsonSchema={type:on("string",sn._jsonSchemaVersion),seconds:on("number"),nanoseconds:on("number")};var Je=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new sn(0,0))}static max(){return new n(new sn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Dd=-1,lm=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};lm.UNKNOWN_ID=-1;function L9(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Je.fromTimestamp(i===1e9?new sn(t+1,0):new sn(t,i));return new Pa(r,Ne.empty(),e)}function V9(n){return new Pa(n.readTime,n.key,Dd)}var Pa=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Je.min(),Ne.empty(),Dd)}static max(){return new n(Je.max(),Ne.empty(),Dd)}};function U9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ne.comparator(n.documentKey,e.documentKey),t!==0?t:ot(n.largestBatchId,e.largestBatchId))}var B9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",uw=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function hc(n){if(n.code!==K.FAILED_PRECONDITION||n.message!==B9)throw n;Se("LocalStore","Unexpectedly lost primary lease")}var re=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(a=>{++r,a.next(()=>{++o,s&&o===r&&t()},l=>i(l))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let c=l;t(e[c]).next(d=>{s[c]=d,++a,a===o&&i(s)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};function j9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function fc(n){return n.name==="IndexedDbTransactionError"}var Nx=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),kx=-1;function Fm(n){return n==null}function Ad(n){return n===0&&1/n==-1/0}function H9(n){return typeof n=="number"&&Number.isInteger(n)&&!Ad(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var DP="";function $9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=HR(e)),e=G9(n.get(t),e);return HR(e)}function G9(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case DP:t+="";break;default:t+=o}}return t}function HR(n){return n+DP+""}var z9="remoteDocuments",AP="owner";var MP="mutationQueues";var RP="mutations";var PP="documentMutations",W9="remoteDocumentsV14";var NP="remoteDocumentGlobal";var kP="targets";var OP="targetDocuments";var FP="targetGlobal",LP="collectionParents";var VP="clientMetadata";var UP="bundles";var BP="namedQueries";var q9="indexConfiguration";var K9="indexState";var Y9="indexEntries";var jP="documentOverlays";var Q9="globals";var J9=[MP,RP,PP,z9,kP,AP,FP,OP,VP,NP,LP,UP,BP],vde=[...J9,jP],Z9=[MP,RP,PP,W9,kP,AP,FP,OP,VP,NP,LP,UP,BP,jP],X9=Z9,e7=[...X9,q9,K9,Y9];var _de=[...e7,Q9];function $R(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ua(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function HP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Jt=class n{constructor(e,t){this.comparator=e,this.root=t||Lr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Lr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zl(this.root,e,this.comparator,!0)}},Zl=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Lr=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Fe(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Fe(27949);return e+(this.isRed()?0:1)}};Lr.EMPTY=null,Lr.RED=!0,Lr.BLACK=!1;Lr.EMPTY=new class{constructor(){this.size=0}get key(){throw Fe(57766)}get value(){throw Fe(16141)}get color(){throw Fe(16727)}get left(){throw Fe(29726)}get right(){throw Fe(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Lr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Mn=class n{constructor(e){this.comparator=e,this.data=new Jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cm(this.data.getIterator())}getIteratorFrom(e){return new cm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},cm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Fr=class n{constructor(e){this.fields=e,e.sort(ii.comparator)}static empty(){return new n([])}unionWith(e){let t=new Mn(ii.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ec(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var um=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ln=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new um("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ln.EMPTY_BYTE_STRING=new Ln("");var t7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function So(n){if(Et(!!n,39018),typeof n=="string"){let e=0,t=t7.exec(n);if(Et(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$t(n.seconds),nanos:$t(n.nanos)}}function $t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Io(n){return typeof n=="string"?Ln.fromBase64String(n):Ln.fromUint8Array(n)}var $P="server_timestamp",GP="__type__",zP="__previous_value__",WP="__local_write_time__";function $d(n){return(n?.mapValue?.fields||{})[GP]?.stringValue===$P}function Lm(n){let e=n.mapValue.fields[zP];return $d(e)?Lm(e):e}function Md(n){let e=So(n.mapValue.fields[WP].timestampValue);return new sn(e.seconds,e.nanos)}var dw=class{constructor(e,t,i,r,o,s,a,l,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=d,this.apiKey=h}},dm="(default)",Rd=class n{constructor(e,t){this.projectId=e,this.database=t||dm}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===dm}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function qP(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ue(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rd(n.options.projectId,e)}var Ox="__type__",KP="__max__",Qg={mapValue:{fields:{__type__:{stringValue:KP}}}},Fx="__vector__",tc="value";function Es(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?$d(n)?4:QP(n)?9007199254740991:YP(n)?10:11:Fe(28295,{value:n})}function Hr(n,e){if(n===e)return!0;let t=Es(n);if(t!==Es(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Md(n).isEqual(Md(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=So(r.timestampValue),a=So(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return Io(r.bytesValue).isEqual(Io(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return $t(r.geoPointValue.latitude)===$t(o.geoPointValue.latitude)&&$t(r.geoPointValue.longitude)===$t(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return $t(r.integerValue)===$t(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=$t(r.doubleValue),a=$t(o.doubleValue);return s===a?Ad(s)===Ad(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return ec(n.arrayValue.values||[],e.arrayValue.values||[],Hr);case 10:case 11:return(function(r,o){let s=r.mapValue.fields||{},a=o.mapValue.fields||{};if($R(s)!==$R(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Hr(s[l],a[l])))return!1;return!0})(n,e);default:return Fe(52216,{left:n})}}function Pd(n,e){return(n.values||[]).find(t=>Hr(t,e))!==void 0}function nc(n,e){if(n===e)return 0;let t=Es(n),i=Es(e);if(t!==i)return ot(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ot(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=$t(o.integerValue||o.doubleValue),l=$t(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return GR(n.timestampValue,e.timestampValue);case 4:return GR(Md(n),Md(e));case 5:return cw(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=Io(o),l=Io(s);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){let d=ot(a[c],l[c]);if(d!==0)return d}return ot(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=ot($t(o.latitude),$t(s.latitude));return a!==0?a:ot($t(o.longitude),$t(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return zR(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},l=s.fields||{},c=a[tc]?.arrayValue,d=l[tc]?.arrayValue,h=ot(c?.values?.length||0,d?.values?.length||0);return h!==0?h:zR(c,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===Qg.mapValue&&s===Qg.mapValue)return 0;if(o===Qg.mapValue)return 1;if(s===Qg.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),c=s.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let f=cw(l[h],d[h]);if(f!==0)return f;let g=nc(a[l[h]],c[d[h]]);if(g!==0)return g}return ot(l.length,d.length)})(n.mapValue,e.mapValue);default:throw Fe(23264,{he:t})}}function GR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ot(n,e);let t=So(n),i=So(e),r=ot(t.seconds,i.seconds);return r!==0?r:ot(t.nanos,i.nanos)}function zR(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=nc(t[r],i[r]);if(o)return o}return ot(t.length,i.length)}function ic(n){return hw(n)}function hw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=So(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Io(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ne.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=hw(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${hw(t.fields[s])}`;return r+"}"})(n.mapValue):Fe(61005,{value:n})}function Xg(n){switch(Es(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Lm(n);return e?16+Xg(e):16;case 5:return 2*n.stringValue.length;case 6:return Io(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,o)=>r+Xg(o),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ua(i.fields,(o,s)=>{r+=o.length+Xg(s)}),r})(n.mapValue);default:throw Fe(13486,{value:n})}}function Gd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function fw(n){return!!n&&"integerValue"in n}function Lx(n){return!!n&&"arrayValue"in n}function WR(n){return!!n&&"nullValue"in n}function qR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function em(n){return!!n&&"mapValue"in n}function YP(n){return(n?.mapValue?.fields||{})[Ox]?.stringValue===Fx}function Id(n){if(n.geoPointValue)return{geoPointValue:F({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:F({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ua(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Id(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Id(n.arrayValue.values[t]);return e}return F({},n)}function QP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===KP}var bde={mapValue:{fields:{[Ox]:{stringValue:Fx},[tc]:{arrayValue:{}}}}};var Ui=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!em(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Id(t)}setAll(e){let t=ii.emptyPath(),i={},r=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}s?i[a.lastSegment()]=Id(s):r.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());em(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];em(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ua(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(Id(this.value))}};function JP(n){let e=[];return Ua(n.fields,(t,i)=>{let r=new ii([t]);if(em(i)){let o=JP(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new Fr(e)}var sr=class n{constructor(e,t,i,r,o,s,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Je.min(),Je.min(),Je.min(),Ui.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Je.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Je.min(),Je.min(),Ui.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Je.min(),Je.min(),Ui.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ui.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ui.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var To=class{constructor(e,t){this.position=e,this.inclusive=t}};function KR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=Ne.comparator(Ne.fromName(s.referenceValue),t.key):i=nc(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function YR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Hr(n.position[t],e.position[t]))return!1;return!0}var bs=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function n7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var hm=class{},rn=class n extends hm{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new gw(e,t,i):t==="array-contains"?new vw(e,i):t==="in"?new _w(e,i):t==="not-in"?new Ew(e,i):t==="array-contains-any"?new bw(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new mw(e,i):new yw(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(nc(t,this.value)):t!==null&&Es(this.value)===Es(t)&&this.matchesComparison(nc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Bi=class n extends hm{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return ZP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function ZP(n){return n.op==="and"}function XP(n){return i7(n)&&ZP(n)}function i7(n){for(let e of n.filters)if(e instanceof Bi)return!1;return!0}function pw(n){if(n instanceof rn)return n.field.canonicalString()+n.op.toString()+ic(n.value);if(XP(n))return n.filters.map(e=>pw(e)).join(",");{let e=n.filters.map(t=>pw(t)).join(",");return`${n.op}(${e})`}}function eN(n,e){return n instanceof rn?(function(i,r){return r instanceof rn&&i.op===r.op&&i.field.isEqual(r.field)&&Hr(i.value,r.value)})(n,e):n instanceof Bi?(function(i,r){return r instanceof Bi&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,a)=>o&&eN(s,r.filters[a]),!0):!1})(n,e):void Fe(19439)}function tN(n){return n instanceof rn?(function(t){return`${t.field.canonicalString()} ${t.op} ${ic(t.value)}`})(n):n instanceof Bi?(function(t){return t.op.toString()+" {"+t.getFilters().map(tN).join(" ,")+"}"})(n):"Filter"}var gw=class extends rn{constructor(e,t,i){super(e,t,i),this.key=Ne.fromName(i.referenceValue)}matches(e){let t=Ne.comparator(e.key,this.key);return this.matchesComparison(t)}},mw=class extends rn{constructor(e,t){super(e,"in",t),this.keys=nN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},yw=class extends rn{constructor(e,t){super(e,"not-in",t),this.keys=nN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function nN(n,e){return(e.arrayValue?.values||[]).map(t=>Ne.fromName(t.referenceValue))}var vw=class extends rn{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Lx(t)&&Pd(t.arrayValue,this.value)}},_w=class extends rn{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Pd(this.value.arrayValue,t)}},Ew=class extends rn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Pd(this.value.arrayValue,t)}},bw=class extends rn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Lx(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Pd(this.value.arrayValue,i))}};var ww=class{constructor(e,t=null,i=[],r=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function QR(n,e=null,t=[],i=[],r=null,o=null,s=null){return new ww(n,e,t,i,r,o,s)}function Vx(n){let e=We(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>pw(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(o){return o.field.canonicalString()+o.dir})(i)).join(","),Fm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ic(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ic(i)).join(",")),e.Te=t}return e.Te}function Ux(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!n7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!eN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!YR(n.startAt,e.startAt)&&YR(n.endAt,e.endAt)}function xw(n){return Ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Co=class{constructor(e,t=null,i=[],r=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function r7(n,e,t,i,r,o,s,a){return new Co(n,e,t,i,r,o,s,a)}function Vm(n){return new Co(n)}function JR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function o7(n){return Ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Um(n){return n.collectionGroup!==null}function Aa(n){let e=We(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Mn(ii.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new bs(o,i))}),t.has(ii.keyField().canonicalString())||e.Ie.push(new bs(ii.keyField(),i))}return e.Ie}function Vr(n){let e=We(n);return e.Ee||(e.Ee=s7(e,Aa(n))),e.Ee}function s7(n,e){if(n.limitType==="F")return QR(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new bs(r.field,o)});let t=n.endAt?new To(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new To(n.startAt.position,n.startAt.inclusive):null;return QR(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Bm(n,e){let t=n.filters.concat([e]);return new Co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function iN(n,e){let t=n.explicitOrderBy.concat([e]);return new Co(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Nd(n,e,t){return new Co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function rN(n,e){return new Co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function jm(n,e){return Ux(Vr(n),Vr(e))&&n.limitType===e.limitType}function oN(n){return`${Vx(Vr(n))}|lt:${n.limitType}`}function Yl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>tN(r)).join(", ")}]`),Fm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>ic(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>ic(r)).join(",")),`Target(${i})`})(Vr(n))}; limitType=${n.limitType})`}function Hm(n,e){return e.isFoundDocument()&&(function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Ne.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(let o of Aa(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(s,a,l){let c=KR(s,a,l);return s.inclusive?c<=0:c<0})(i.startAt,Aa(i),r)||i.endAt&&!(function(s,a,l){let c=KR(s,a,l);return s.inclusive?c>=0:c>0})(i.endAt,Aa(i),r))})(n,e)}function a7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function sN(n){return(e,t)=>{let i=!1;for(let r of Aa(n)){let o=l7(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function l7(n,e,t){let i=n.field.isKeyField()?Ne.comparator(e.key,t.key):(function(o,s,a){let l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?nc(l,c):Fe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Fe(19790,{direction:n.dir})}}var Do=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ua(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return HP(this.inner)}size(){return this.innerSize}};var c7=new Jt(Ne.comparator);function Ao(){return c7}var aN=new Jt(Ne.comparator);function Sd(...n){let e=aN;for(let t of n)e=e.insert(t.key,t);return e}function lN(n){let e=aN;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ca(){return Td()}function cN(){return Td()}function Td(){return new Do(n=>n.toString(),(n,e)=>n.isEqual(e))}var u7=new Jt(Ne.comparator),d7=new Mn(Ne.comparator);function nt(...n){let e=d7;for(let t of n)e=e.add(t);return e}var h7=new Mn(ot);function f7(){return h7}function Bx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ad(e)?"-0":e}}function uN(n){return{integerValue:""+n}}function p7(n,e){return H9(e)?uN(e):Bx(n,e)}var rc=class{constructor(){this._=void 0}};function g7(n,e,t){return n instanceof Na?(function(r,o){let s={fields:{[GP]:{stringValue:$P},[WP]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&$d(o)&&(o=Lm(o)),o&&(s.fields[zP]=o),{mapValue:s}})(t,e):n instanceof ka?hN(n,e):n instanceof Oa?fN(n,e):(function(r,o){let s=dN(r,o),a=ZR(s)+ZR(r.Ae);return fw(s)&&fw(r.Ae)?uN(a):Bx(r.serializer,a)})(n,e)}function m7(n,e,t){return n instanceof ka?hN(n,e):n instanceof Oa?fN(n,e):t}function dN(n,e){return n instanceof oc?(function(i){return fw(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}var Na=class extends rc{},ka=class extends rc{constructor(e){super(),this.elements=e}};function hN(n,e){let t=pN(e);for(let i of n.elements)t.some(r=>Hr(r,i))||t.push(i);return{arrayValue:{values:t}}}var Oa=class extends rc{constructor(e){super(),this.elements=e}};function fN(n,e){let t=pN(e);for(let i of n.elements)t=t.filter(r=>!Hr(r,i));return{arrayValue:{values:t}}}var oc=class extends rc{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function ZR(n){return $t(n.integerValue||n.doubleValue)}function pN(n){return Lx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Sw=class{constructor(e,t){this.field=e,this.transform=t}};function y7(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof ka&&r instanceof ka||i instanceof Oa&&r instanceof Oa?ec(i.elements,r.elements,Hr):i instanceof oc&&r instanceof oc?Hr(i.Ae,r.Ae):i instanceof Na&&r instanceof Na})(n.transform,e.transform)}var Iw=class{constructor(e,t){this.version=e,this.transformResults=t}},Eo=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function tm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var sc=class{};function gN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new kd(n.key,Eo.none()):new Fa(n.key,n.data,Eo.none());{let t=n.data,i=Ui.empty(),r=new Mn(ii.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new Mo(n.key,i,new Fr(r.toArray()),Eo.none())}}function v7(n,e,t){n instanceof Fa?(function(r,o,s){let a=r.value.clone(),l=eP(r.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Mo?(function(r,o,s){if(!tm(r.precondition,o))return void o.convertToUnknownDocument(s.version);let a=eP(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(mN(r)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):(function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Cd(n,e,t,i){return n instanceof Fa?(function(o,s,a,l){if(!tm(o.precondition,s))return a;let c=o.value.clone(),d=tP(o.fieldTransforms,l,s);return c.setAll(d),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null})(n,e,t,i):n instanceof Mo?(function(o,s,a,l){if(!tm(o.precondition,s))return a;let c=tP(o.fieldTransforms,l,s),d=s.data;return d.setAll(mN(o)),d.setAll(c),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,i):(function(o,s,a){return tm(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function _7(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=dN(i.transform,r||null);o!=null&&(t===null&&(t=Ui.empty()),t.set(i.field,o))}return t||null}function XR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&ec(i,r,(o,s)=>y7(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Fa=class extends sc{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Mo=class extends sc{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function mN(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function eP(n,e,t){let i=new Map;Et(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,m7(s,a,t[r]))}return i}function tP(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,g7(o,s,e))}return i}var kd=class extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Tw=class extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Cw=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&v7(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Cd(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Cd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=cN();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(r.key)?null:a;let l=gN(s,a);l!==null&&i.set(r.key,l),s.isValidDocument()||s.convertToNoDocument(Je.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nt())}isEqual(e){return this.batchId===e.batchId&&ec(this.mutations,e.mutations,(t,i)=>XR(t,i))&&ec(this.baseMutations,e.baseMutations,(t,i)=>XR(t,i))}},Dw=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Et(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return u7})(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var Aw=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Mw=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var fn,ct;function E7(n){switch(n){case K.OK:return Fe(64938);case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0;default:return Fe(15467,{code:n})}}function yN(n){if(n===void 0)return xo("GRPC error has no .code"),K.UNKNOWN;switch(n){case fn.OK:return K.OK;case fn.CANCELLED:return K.CANCELLED;case fn.UNKNOWN:return K.UNKNOWN;case fn.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case fn.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case fn.INTERNAL:return K.INTERNAL;case fn.UNAVAILABLE:return K.UNAVAILABLE;case fn.UNAUTHENTICATED:return K.UNAUTHENTICATED;case fn.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case fn.NOT_FOUND:return K.NOT_FOUND;case fn.ALREADY_EXISTS:return K.ALREADY_EXISTS;case fn.PERMISSION_DENIED:return K.PERMISSION_DENIED;case fn.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case fn.ABORTED:return K.ABORTED;case fn.OUT_OF_RANGE:return K.OUT_OF_RANGE;case fn.UNIMPLEMENTED:return K.UNIMPLEMENTED;case fn.DATA_LOSS:return K.DATA_LOSS;default:return Fe(39323,{code:n})}}(ct=fn||(fn={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";var b7=null;function w7(){return new TextEncoder}var x7=new vo([4294967295,4294967295],0);function nP(n){let e=w7().encode(n),t=new Yb;return t.update(e),new Uint8Array(t.digest())}function iP(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new vo([t,i],0),new vo([r,o],0)]}var Rw=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Da(`Invalid padding: ${t}`);if(i<0)throw new Da(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Da(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Da(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=vo.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(vo.fromNumber(i)));return r.compare(x7)===1&&(r=new vo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=nP(e),[i,r]=iP(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);if(!this.we(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=nP(e),[i,r]=iP(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);this.be(s)}}be(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},Da=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var fm=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Od.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Je.min(),r,new Jt(ot),Ao(),nt())}},Od=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,nt(),nt(),nt())}};var Xl=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}},pm=class{constructor(e,t){this.targetId=e,this.Ce=t}},gm=class{constructor(e,t,i=Ln.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},mm=class{constructor(){this.ve=0,this.Fe=rP(),this.Me=Ln.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),t=nt(),i=nt();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Fe(38017,{changeType:o})}}),new Od(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=rP()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},Pw=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ao(),this.He=Jg(),this.Je=Jg(),this.Ze=new Jt(ot)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Fe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){let o=r.target;if(xw(o))if(i===0){let s=new Ne(o.path);this.et(t,s,sr.newNoDocument(s,Je.min()))}else Et(i===1,20013,{expectedCount:i});else{let s=this._t(t);if(s!==i){let a=this.ut(e),l=a?this.ct(a,e,s):1;if(l!==0){this.it(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}b7?.lt((function(d,h,f,g,w){let S={localCacheCount:d,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},P=h.unchangedNames;return P&&(S.bloomFilter={applied:w===0,hashCount:P?.hashCount??0,bitmapLength:P?.bits?.bitmap?.length??0,padding:P?.bits?.padding??0,mightContain:L=>g?.mightContain(L)??!1}),S})(s,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,a;try{s=Io(i).toUint8Array()}catch(l){if(l instanceof um)return _s("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Rw(s,r,o)}catch(l){return _s(l instanceof Da?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){let i=this.Ge.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),r++)}),r}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&xw(a.target)){let l=new Ne(a.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,sr.newNoDocument(l,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let i=nt();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let r=new fm(e,t,this.Ze,this.je,i);return this.je=Ao(),this.He=Jg(),this.Je=Jg(),this.Ze=new Jt(ot),r}Ye(e,t){if(!this.rt(e))return;let i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new mm,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Mn(ot),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Mn(ot),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||Se("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mm),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Jg(){return new Jt(Ne.comparator)}function rP(){return new Jt(Ne.comparator)}var S7={asc:"ASCENDING",desc:"DESCENDING"},I7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},T7={and:"AND",or:"OR"},Nw=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function kw(n,e){return n.useProto3Json||Fm(e)?e:{value:e}}function ym(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function C7(n,e){return ym(n,e.toTimestamp())}function Ur(n){return Et(!!n,49232),Je.fromTimestamp((function(t){let i=So(t);return new sn(i.seconds,i.nanos)})(n))}function jx(n,e){return Ow(n,e).canonicalString()}function Ow(n,e){let t=(function(r){return new Nt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function _N(n){let e=Nt.fromString(n);return Et(SN(e),10190,{key:e.toString()}),e}function Fw(n,e){return jx(n.databaseId,e.path)}function nw(n,e){let t=_N(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ne(bN(t))}function EN(n,e){return jx(n.databaseId,e)}function D7(n){let e=_N(n);return e.length===4?Nt.emptyPath():bN(e)}function Lw(n){return new Nt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function bN(n){return Et(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function oP(n,e,t){return{name:Fw(n,e),fields:t.value.mapValue.fields}}function A7(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Fe(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(c,d){return c.useProto3Json?(Et(d===void 0||typeof d=="string",58123),Ln.fromBase64String(d||"")):(Et(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ln.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(c){let d=c.code===void 0?K.UNKNOWN:yN(c.code);return new ue(d,c.message||"")})(s);t=new gm(i,r,o,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=nw(n,i.document.name),o=Ur(i.document.updateTime),s=i.document.createTime?Ur(i.document.createTime):Je.min(),a=new Ui({mapValue:{fields:i.document.fields}}),l=sr.newFoundDocument(r,o,s,a),c=i.targetIds||[],d=i.removedTargetIds||[];t=new Xl(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=nw(n,i.document),o=i.readTime?Ur(i.readTime):Je.min(),s=sr.newNoDocument(r,o),a=i.removedTargetIds||[];t=new Xl([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=nw(n,i.document),o=i.removedTargetIds||[];t=new Xl([],o,r,null)}else{if(!("filter"in e))return Fe(11601,{Vt:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new Mw(r,o),a=i.targetId;t=new pm(a,s)}}return t}function M7(n,e){let t;if(e instanceof Fa)t={update:oP(n,e.key,e.value)};else if(e instanceof kd)t={delete:Fw(n,e.key)};else if(e instanceof Mo)t={update:oP(n,e.key,e.data),updateMask:U7(e.fieldMask)};else{if(!(e instanceof Tw))return Fe(16599,{dt:e.type});t={verify:Fw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(o,s){let a=s.transform;if(a instanceof Na)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ka)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Oa)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof oc)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw Fe(20930,{transform:s.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:C7(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Fe(27497)})(n,e.precondition)),t}function R7(n,e){return n&&n.length>0?(Et(e!==void 0,14353),n.map(t=>(function(r,o){let s=r.updateTime?Ur(r.updateTime):Ur(o);return s.isEqual(Je.min())&&(s=Ur(o)),new Iw(s,r.transformResults||[])})(t,e))):[]}function P7(n,e){return{documents:[EN(n,e.path)]}}function N7(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=EN(n,r);let o=(function(c){if(c.length!==0)return xN(Bi.create(c,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(c){if(c.length!==0)return c.map(d=>(function(f){return{field:Ql(f.field),direction:F7(f.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=kw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:r}}function k7(n){let e=D7(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){Et(i===1,65062);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let f=wN(h);return f instanceof Bi&&XP(f)?f.getFilters():[f]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(f=>(function(w){return new bs(Jl(w.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(f))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,Fm(f)?null:f})(t.limit));let l=null;t.startAt&&(l=(function(h){let f=!!h.before,g=h.values||[];return new To(g,f)})(t.startAt));let c=null;return t.endAt&&(c=(function(h){let f=!h.before,g=h.values||[];return new To(g,f)})(t.endAt)),r7(e,r,s,o,a,"F",l,c)}function O7(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fe(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function wN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Jl(t.unaryFilter.field);return rn.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Jl(t.unaryFilter.field);return rn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Jl(t.unaryFilter.field);return rn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Jl(t.unaryFilter.field);return rn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Fe(61313);default:return Fe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return rn.create(Jl(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Fe(58110);default:return Fe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Bi.create(t.compositeFilter.filters.map(i=>wN(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Fe(1026)}})(t.compositeFilter.op))})(n):Fe(30097,{filter:n})}function F7(n){return S7[n]}function L7(n){return I7[n]}function V7(n){return T7[n]}function Ql(n){return{fieldPath:n.canonicalString()}}function Jl(n){return ii.fromServerFormat(n.fieldPath)}function xN(n){return n instanceof rn?(function(t){if(t.op==="=="){if(qR(t.value))return{unaryFilter:{field:Ql(t.field),op:"IS_NAN"}};if(WR(t.value))return{unaryFilter:{field:Ql(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(qR(t.value))return{unaryFilter:{field:Ql(t.field),op:"IS_NOT_NAN"}};if(WR(t.value))return{unaryFilter:{field:Ql(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ql(t.field),op:L7(t.op),value:t.value}}})(n):n instanceof Bi?(function(t){let i=t.getFilters().map(r=>xN(r));return i.length===1?i[0]:{compositeFilter:{op:V7(t.op),filters:i}}})(n):Fe(54877,{filter:n})}function U7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function SN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function IN(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var Fd=class n{constructor(e,t,i,r,o=Je.min(),s=Je.min(),a=Ln.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Vw=class{constructor(e){this.yt=e}};function TN(n){let e=k7({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Nd(e,e.limit,"L"):e}var vm=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt($t(e.integerValue));else if("doubleValue"in e){let i=$t(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Ad(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=So(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Io(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?QP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):YP(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):Fe(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let i=e.fields||{};this.Ft(t,55);for(let r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){let i=e.fields||{};this.Ft(t,53);let r=tc,o=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt($t(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){let i=e.values||[];this.Ft(t,50);for(let r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ne.fromName(e).path.forEach(i=>{this.Ft(t,60),this.$t(i,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};vm.Wt=new vm;var Uw=class{constructor(){this.Sn=new Bw}addToCollectionParentIndex(e,t){return this.Sn.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(Pa.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(Pa.min())}updateCollectionGroup(e,t,i){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}},Bw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Mn(Nt.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Mn(Nt.comparator)).toArray()}};var wde=new Uint8Array(0);var sP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},CN=41943040,Vi=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};Vi.DEFAULT_COLLECTION_PERCENTILE=10,Vi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vi.DEFAULT=new Vi(CN,Vi.DEFAULT_COLLECTION_PERCENTILE,Vi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vi.DISABLED=new Vi(-1,0,0);var Ld=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var aP="LruGarbageCollector",B7=1048576;function lP([n,e],[t,i]){let r=ot(n,t);return r===0?ot(e,i):r}var jw=class{constructor(e){this.Pr=e,this.buffer=new Mn(lP),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();lP(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Hw=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Se(aP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){fc(t)?Se(aP,"Ignoring IndexedDB error during garbage collection: ",t):await hc(t)}await this.Ar(3e5)})}},$w=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return re.resolve(Nx.ce);let i=new jw(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Se("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(sP)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(Se("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sP):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,s,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,s=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(c=Date.now(),Kl()<=tt.DEBUG&&Se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${r} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:h})))}};function j7(n,e){return new $w(n,e)}var Gw=class{constructor(){this.changes=new Do(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,sr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?re.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var zw=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ww=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Cd(i.mutation,r,Fr.empty(),sn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,nt()).next(()=>i))}getLocalViewOfDocuments(e,t,i=nt()){let r=Ca();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=Sd();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=Ca();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,nt()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,i,r){let o=Ao(),s=Td(),a=(function(){return Td()})();return t.forEach((l,c)=>{let d=i.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof Mo)?o=o.insert(c.key,c):d!==void 0?(s.set(c.key,d.mutation.getFieldMask()),Cd(d.mutation,c,d.mutation.getFieldMask(),sn.now())):s.set(c.key,Fr.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,d)=>s.set(c,d)),t.forEach((c,d)=>a.set(c,new zw(d,s.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){let i=Td(),r=new Jt((s,a)=>s-a),o=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=i.get(l)||Fr.empty();d=a.applyToLocalView(c,d),i.set(l,d);let h=(r.get(a.batchId)||nt()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,h=cN();d.forEach(f=>{if(!o.has(f)){let g=gN(t.get(f),i.get(f));g!==null&&h.set(f,g),o=o.add(f)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return re.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return o7(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Um(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):re.resolve(Ca()),a=Dd,l=o;return s.next(c=>re.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?re.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,nt())).next(d=>({batchId:a,changes:lN(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ne(t)).next(i=>{let r=Sd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=Sd();return this.indexManager.getCollectionParents(e,o).next(a=>re.forEach(a,l=>{let c=(function(h,f){return new Co(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,i,r).next(d=>{d.forEach((h,f)=>{s=s.insert(h,f)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((l,c)=>{let d=c.getKey();s.get(d)===null&&(s=s.insert(d,sr.newInvalidDocument(d)))});let a=Sd();return s.forEach((l,c)=>{let d=o.get(l);d!==void 0&&Cd(d.mutation,c,Fr.empty(),sn.now()),Hm(t,c)&&(a=a.insert(l,c))}),a})}};var qw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return re.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Ur(r.createTime)}})(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:TN(r.bundledQuery),readTime:Ur(r.readTime)}})(t)),re.resolve()}};var Kw=class{constructor(){this.overlays=new Jt(Ne.comparator),this.Lr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Ca();return re.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.bt(e,t,o)}),re.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Lr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(i)),re.resolve()}getOverlaysForCollection(e,t,i){let r=Ca(),o=t.length+1,s=new Ne(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>i&&r.set(l.getKey(),l)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Jt((c,d)=>c-d),s=this.overlays.getIterator();for(;s.hasNext();){let c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let d=o.get(c.largestBatchId);d===null&&(d=Ca(),o=o.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}let a=Ca(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=r)););return re.resolve(a)}bt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new Aw(t,i));let o=this.Lr.get(t);o===void 0&&(o=nt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}};var Yw=class{constructor(){this.sessionToken=Ln.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}};var Vd=class{constructor(){this.kr=new Mn(pn.Kr),this.qr=new Mn(pn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let i=new pn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new pn(e,t))}Qr(e,t){e.forEach(i=>this.removeReference(i,t))}Gr(e){let t=new Ne(new Nt([])),i=new pn(t,e),r=new pn(t,e+1),o=[];return this.qr.forEachInRange([i,r],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new Ne(new Nt([])),i=new pn(t,e),r=new pn(t,e+1),o=nt();return this.qr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new pn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},pn=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ne.comparator(e.key,t.key)||ot(e.Hr,t.Hr)}static Ur(e,t){return ot(e.Hr,t.Hr)||Ne.comparator(e.key,t.key)}};var Qw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Mn(pn.Kr)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Cw(o,t,i,r);this.mutationQueue.push(s);for(let a of r)this.Jr=this.Jr.add(new pn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return re.resolve(s)}lookupMutationBatch(e,t){return re.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),o=r<0?0:r;return re.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?kx:this.Yn-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new pn(t,0),r=new pn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],s=>{let a=this.Zr(s.Hr);o.push(a)}),re.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Mn(ot);return t.forEach(r=>{let o=new pn(r,0),s=new pn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{i=i.add(a.Hr)})}),re.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;Ne.isDocumentKey(o)||(o=o.child(""));let s=new pn(new Ne(o),0),a=new Mn(ot);return this.Jr.forEachWhile(l=>{let c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Hr)),!0)},s),re.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Et(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return re.forEach(t.mutations,r=>{let o=new pn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Jr=i})}nr(e){}containsKey(e,t){let i=new pn(t,0),r=this.Jr.firstAfterOrEqual(i);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Jw=class{constructor(e){this.ti=e,this.docs=(function(){return new Jt(Ne.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return re.resolve(i?i.document.mutableCopy():sr.newInvalidDocument(t))}getEntries(e,t){let i=Ao();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():sr.newInvalidDocument(r))}),re.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=Ao(),s=t.path,a=new Ne(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||U9(V9(d),i)<=0||(r.has(d.key)||Hm(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return re.resolve(o)}getAllFromCollectionGroup(e,t,i,r){Fe(9500)}ni(e,t){return re.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Zw(this)}getSize(e){return re.resolve(this.size)}},Zw=class extends Gw{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)}),re.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var Xw=class{constructor(e){this.persistence=e,this.ri=new Do(t=>Vx(t),Ux),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.ii=0,this.si=new Vd,this.targetCount=0,this.oi=Ld._r()}forEachTarget(e,t){return this.ri.forEach((i,r)=>t(r)),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),re.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new Ld(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.lr(t),re.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),re.waitFor(o).next(()=>r)}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){let i=this.ri.get(t)||null;return re.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),re.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),re.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),re.resolve()}getMatchingKeysForTargetId(e,t){let i=this.si.jr(t);return re.resolve(i)}containsKey(e,t){return re.resolve(this.si.containsKey(t))}};var _m=class{constructor(e,t){this._i={},this.overlays={},this.ai=new Nx(0),this.ui=!1,this.ui=!0,this.ci=new Yw,this.referenceDelegate=e(this),this.li=new Xw(this),this.indexManager=new Uw,this.remoteDocumentCache=(function(r){return new Jw(r)})(i=>this.referenceDelegate.hi(i)),this.serializer=new Vw(t),this.Pi=new qw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Kw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new Qw(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Se("MemoryPersistence","Starting transaction:",e);let r=new ex(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(o=>this.referenceDelegate.Ii(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ei(e,t){return re.or(Object.values(this._i).map(i=>()=>i.containsKey(e,t)))}},ex=class extends uw{constructor(e){super(),this.currentSequenceNumber=e}},tx=class n{constructor(e){this.persistence=e,this.Ri=new Vd,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw Fe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),re.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),re.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(r=>this.di.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.di,i=>{let r=Ne.fromPath(i);return this.mi(e,r).next(o=>{o||t.removeEntry(r,Je.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return re.or([()=>re.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Em=class n{constructor(e,t){this.persistence=e,this.fi=new Do(i=>$9(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=j7(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}pr(e){let t=0;return this.mr(e,i=>{t++}).next(()=>t)}mr(e,t){return re.forEach(this.fi,(i,r)=>this.wr(e,i,r).next(o=>o?re.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,s=>this.wr(e,s,t).next(a=>{a||(i++,o.removeEntry(s,Je.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),re.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Xg(e.data.value)),t}wr(e,t,i){return re.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.fi.get(t);return re.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var nx=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=nt(),r=nt();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var ix=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var rx=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return yR()?8:j9(Cn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new ix;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,i,r){return i.documentReadCount<this.Vs?(Kl()<=tt.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",Yl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),re.resolve()):(Kl()<=tt.DEBUG&&Se("QueryEngine","Query:",Yl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Kl()<=tt.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",Yl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vr(t))):re.resolve())}gs(e,t){if(JR(t))return re.resolve(null);let i=Vr(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Nd(t,null,"F"),i=Vr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=nt(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{let c=this.bs(t,a);return this.Ss(t,c,s,l.readTime)?this.gs(e,Nd(t,null,"F")):this.Ds(e,c,t,l)}))})))}ps(e,t,i,r){return JR(t)||r.isEqual(Je.min())?re.resolve(null):this.fs.getDocuments(e,i).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,i,r)?re.resolve(null):(Kl()<=tt.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Yl(t)),this.Ds(e,s,t,L9(r,Dd)).next(a=>a))})}bs(e,t){let i=new Mn(sN(e));return t.forEach((r,o)=>{Hm(e,o)&&(i=i.add(o))}),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return Kl()<=tt.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",Yl(t)),this.fs.getDocumentsMatchingQuery(e,t,Pa.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Hx="LocalStore",H7=3e8,ox=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Jt(ot),this.Fs=new Do(o=>Vx(o),Ux),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ww(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function $7(n,e,t,i){return new ox(n,e,t,i)}async function DN(n,e){let t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],a=[],l=nt();for(let c of r){s.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}for(let c of o){a.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Ns:c,removedBatchIds:s,addedBatchIds:a}))})})}function G7(n,e){let t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,d){let h=c.batch,f=h.keys(),g=re.resolve();return f.forEach(w=>{g=g.next(()=>d.getEntry(l,w)).next(S=>{let P=c.docVersions.get(w);Et(P!==null,48541),S.version.compareTo(P)<0&&(h.applyToRemoteDocument(S,c),S.isValidDocument()&&(S.setReadTime(c.commitVersion),d.addEntry(S)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))})(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=nt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function AN(n){let e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function z7(n,e){let t=We(n),i=e.snapshotVersion,r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;let a=[];e.targetChanges.forEach((d,h)=>{let f=r.get(h);if(!f)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,h)));let g=f.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Ln.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,i)),r=r.insert(h,g),(function(S,P,L){return S.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=H7?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(f,g,d)&&a.push(t.li.updateTargetData(o,g))});let l=Ao(),c=nt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(W7(o,s,e.documentUpdates).next(d=>{l=d.Bs,c=d.Ls})),!i.isEqual(Je.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(h=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i));a.push(d)}return re.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.vs=r,o))}function W7(n,e,t){let i=nt(),r=nt();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=Ao();return t.forEach((a,l)=>{let c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Je.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):Se(Hx,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Bs:s,Ls:r}})}function q7(n,e){let t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=kx),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function K7(n,e){let t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.li.getTargetData(i,e).next(o=>o?(r=o,re.resolve(r)):t.li.allocateTargetId(i).next(s=>(r=new Fd(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i})}async function sx(n,e,t){let i=We(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r))}catch(s){if(!fc(s))throw s;Se(Hx,`Failed to update sequence numbers for target ${e}: ${s}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function cP(n,e,t){let i=We(n),r=Je.min(),o=nt();return i.persistence.runTransaction("Execute query","readwrite",s=>(function(l,c,d){let h=We(l),f=h.Fs.get(d);return f!==void 0?re.resolve(h.vs.get(f)):h.li.getTargetData(c,d)})(i,s,Vr(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(s,e,t?r:Je.min(),t?o:nt())).next(a=>(Y7(i,a7(e),a),{documents:a,ks:o})))}function Y7(n,e,t){let i=n.Ms.get(e)||Je.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ms.set(e,i)}var bm=class{constructor(){this.activeTargetIds=f7()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ax=class{constructor(){this.vo=new bm,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new bm,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var lx=class{Mo(e){}shutdown(){}};var uP="ConnectivityMonitor",wm=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Se(uP,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){Se(uP,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Zg=null;function cx(){return Zg===null?Zg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Zg++,"0x"+Zg.toString(16)}var iw="RestConnection",Q7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},ux=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===dm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){let s=cx(),a=this.Qo(e,t.toUriEncodedString());Se(iw,`Sending RPC '${e}' ${s}:`,a,i);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,r,o);let{host:c}=new URL(a),d=ps(c);return this.zo(e,a,l,i,d).then(h=>(Se(iw,`Received RPC '${e}' ${s}: `,h),h),h=>{throw _s(iw,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",i),h})}jo(e,t,i,r,o,s){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+uc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),i&&i.headers.forEach((r,o)=>e[o]=r)}Qo(e,t){let i=Q7[e],r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}};var dx=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Hn="WebChannelConnection",xd=(n,e,t)=>{n.listen(e,i=>{try{t(i)}catch(r){setTimeout(()=>{throw r},0)}})},xm=class n extends ux{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=Xb();xd(e,Zb.STAT_EVENT,t=>{t.stat===Yg.PROXY?Se(Hn,"STAT_EVENT: detected buffering proxy"):t.stat===Yg.NOPROXY&&Se(Hn,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,i,r,o){let s=cx();return new Promise((a,l)=>{let c=new Qb;c.setWithCredentials(!0),c.listenOnce(Jb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case wd.NO_ERROR:let h=c.getResponseJson();Se(Hn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case wd.TIMEOUT:Se(Hn,`RPC '${e}' ${s} timed out`),l(new ue(K.DEADLINE_EXCEEDED,"Request time out"));break;case wd.HTTP_ERROR:let f=c.getStatus();if(Se(Hn,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let w=g?.error;if(w&&w.status&&w.message){let S=(function(L){let Z=L.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(Z)>=0?Z:K.UNKNOWN})(w.status);l(new ue(S,w.message))}else l(new ue(K.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ue(K.UNAVAILABLE,"Connection failed."));break;default:Fe(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Se(Hn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);Se(Hn,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",d,i,15)})}T_(e,t,i){let r=cx(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;let c=o.join("");Se(Hn,`Creating RPC '${e}' stream ${r}: ${c}`,a);let d=s.createWebChannel(c,a);this.I_(d);let h=!1,f=!1,g=new dx({Ho:w=>{f?Se(Hn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(h||(Se(Hn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),Se(Hn,`RPC '${e}' stream ${r} sending:`,w),d.send(w))},Jo:()=>d.close()});return xd(d,ql.EventType.OPEN,()=>{f||(Se(Hn,`RPC '${e}' stream ${r} transport opened.`),g.i_())}),xd(d,ql.EventType.CLOSE,()=>{f||(f=!0,Se(Hn,`RPC '${e}' stream ${r} transport closed`),g.o_(),this.E_(d))}),xd(d,ql.EventType.ERROR,w=>{f||(f=!0,_s(Hn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),g.o_(new ue(K.UNAVAILABLE,"The operation could not be completed")))}),xd(d,ql.EventType.MESSAGE,w=>{if(!f){let S=w.data[0];Et(!!S,16349);let P=S,L=P?.error||P[0]?.error;if(L){Se(Hn,`RPC '${e}' stream ${r} received error:`,L);let Z=L.status,ve=(function(Te){let O=fn[Te];if(O!==void 0)return yN(O)})(Z),be=L.message;ve===void 0&&(ve=K.INTERNAL,be="Unknown error status: "+Z+" with message "+L.message),f=!0,g.o_(new ue(ve,be)),d.close()}else Se(Hn,`RPC '${e}' stream ${r} received:`,S),g.__(S)}}),n.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return ew()}};function J7(n){return new xm(n)}function rw(){return typeof document<"u"?document:null}function zd(n){return new Nw(n,!0)}xm.c_=!1;var Sm=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&Se("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var dP="PersistentStream",Im=class{constructor(e,t,i,r,o,s,a,l){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Sm(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===K.RESOURCE_EXHAUSTED?(xo(t.toString()),xo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{let r=new ue(K.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){let i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Se(dP,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(Se(dP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},hx=class extends Im{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=A7(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Je.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Je.min():s.readTime?Ur(s.readTime):Je.min()})(e);return this.listener.J_(t,i)}Z_(e){let t={};t.database=Lw(this.serializer),t.addTarget=(function(o,s){let a,l=s.target;if(a=xw(l)?{documents:P7(o,l)}:{query:N7(o,l).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=vN(o,s.resumeToken);let c=kw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(Je.min())>0){a.readTime=ym(o,s.snapshotVersion.toTimestamp());let c=kw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);let i=O7(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){let t={};t.database=Lw(this.serializer),t.removeTarget=e,this.K_(t)}},fx=class extends Im{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=R7(e.writeResults,e.commitTime),i=Ur(e.commitTime);return this.listener.na(i,t)}ra(){let e={};e.database=Lw(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>M7(this.serializer,i))};this.K_(t)}};var px=class{},gx=class extends px{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ue(K.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,Ow(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(K.UNKNOWN,o.toString())})}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,Ow(t,i),r,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ue(K.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function Z7(n,e,t,i){return new gx(n,e,t,i)}var mx=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(xo(t),this.aa=!1):Se("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var La="RemoteStore",yx=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{i.enqueueAndForget(async()=>{Ba(this)&&(Se(La,"Restarting streams for network reachability change."),await(async function(l){let c=We(l);c.Ea.add(4),await Wd(c),c.Va.set("Unknown"),c.Ea.delete(4),await $m(c)})(this))})}),this.Va=new mx(i,r)}};async function $m(n){if(Ba(n))for(let e of n.Ra)await e(!0)}async function Wd(n){for(let e of n.Ra)await e(!1)}function MN(n,e){let t=We(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Wx(t)?zx(t):pc(t).O_()&&Gx(t,e))}function $x(n,e){let t=We(n),i=pc(t);t.Ia.delete(e),i.O_()&&RN(t,e),t.Ia.size===0&&(i.O_()?i.L_():Ba(t)&&t.Va.set("Unknown"))}function Gx(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}pc(n).Z_(e)}function RN(n,e){n.da.$e(e),pc(n).X_(e)}function zx(n){n.da=new Pw({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),pc(n).start(),n.Va.ua()}function Wx(n){return Ba(n)&&!pc(n).x_()&&n.Ia.size>0}function Ba(n){return We(n).Ea.size===0}function PN(n){n.da=void 0}async function X7(n){n.Va.set("Online")}async function eH(n){n.Ia.forEach((e,t)=>{Gx(n,e)})}async function tH(n,e){PN(n),Wx(n)?(n.Va.ha(e),zx(n)):n.Va.set("Unknown")}async function nH(n,e,t){if(n.Va.set("Online"),e instanceof gm&&e.state===2&&e.cause)try{await(async function(r,o){let s=o.cause;for(let a of o.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.da.removeTarget(a))})(n,e)}catch(i){Se(La,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Tm(n,i)}else if(e instanceof Xl?n.da.Xe(e):e instanceof pm?n.da.st(e):n.da.tt(e),!t.isEqual(Je.min()))try{let i=await AN(n.localStore);t.compareTo(i)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.Ia.get(c);d&&o.Ia.set(c,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{let d=o.Ia.get(l);if(!d)return;o.Ia.set(l,d.withResumeToken(Ln.EMPTY_BYTE_STRING,d.snapshotVersion)),RN(o,l);let h=new Fd(d.target,l,c,d.sequenceNumber);Gx(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){Se(La,"Failed to raise snapshot:",i),await Tm(n,i)}}async function Tm(n,e,t){if(!fc(e))throw e;n.Ea.add(1),await Wd(n),n.Va.set("Offline"),t||(t=()=>AN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Se(La,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await $m(n)})}function NN(n,e){return e().catch(t=>Tm(n,t,e))}async function Gm(n){let e=We(n),t=ws(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:kx;for(;iH(e);)try{let r=await q7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,rH(e,r)}catch(r){await Tm(e,r)}kN(e)&&ON(e)}function iH(n){return Ba(n)&&n.Ta.length<10}function rH(n,e){n.Ta.push(e);let t=ws(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function kN(n){return Ba(n)&&!ws(n).x_()&&n.Ta.length>0}function ON(n){ws(n).start()}async function oH(n){ws(n).ra()}async function sH(n){let e=ws(n);for(let t of n.Ta)e.ea(t.mutations)}async function aH(n,e,t){let i=n.Ta.shift(),r=Dw.from(i,e,t);await NN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Gm(n)}async function lH(n,e){e&&ws(n).Y_&&await(async function(i,r){if((function(s){return E7(s)&&s!==K.ABORTED})(r.code)){let o=i.Ta.shift();ws(i).B_(),await NN(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Gm(i)}})(n,e),kN(n)&&ON(n)}async function hP(n,e){let t=We(n);t.asyncQueue.verifyOperationInProgress(),Se(La,"RemoteStore received new credentials");let i=Ba(t);t.Ea.add(3),await Wd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await $m(t)}async function cH(n,e){let t=We(n);e?(t.Ea.delete(2),await $m(t)):e||(t.Ea.add(2),await Wd(t),t.Va.set("Unknown"))}function pc(n){return n.ma||(n.ma=(function(t,i,r){let o=We(t);return o.sa(),new hx(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:X7.bind(null,n),Yo:eH.bind(null,n),t_:tH.bind(null,n),J_:nH.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),Wx(n)?zx(n):n.Va.set("Unknown")):(await n.ma.stop(),PN(n))})),n.ma}function ws(n){return n.fa||(n.fa=(function(t,i,r){let o=We(t);return o.sa(),new fx(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:oH.bind(null,n),t_:lH.bind(null,n),ta:sH.bind(null,n),na:aH.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Gm(n)):(await n.fa.stop(),n.Ta.length>0&&(Se(La,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var vx=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new or,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,a=new n(e,t,s,r,o);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function qx(n,e){if(xo("AsyncQueue",`${e}: ${n}`),fc(n))return new ue(K.UNAVAILABLE,`${e}: ${n}`);throw n}var Ud=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ne.comparator(t.key,i.key):(t,i)=>Ne.comparator(t.key,i.key),this.keyedMap=Sd(),this.sortedSet=new Jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Cm=class{constructor(){this.ga=new Jt(Ne.comparator)}track(e){let t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Fe(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}},Va=class n{constructor(e,t,i,r,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Ud.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var _x=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},Ex=class{constructor(){this.queries=fP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){let r=We(t),o=r.queries;r.queries=fP(),o.forEach((s,a)=>{for(let l of a.ba)l.onError(i)})})(this,new ue(K.ABORTED,"Firestore shutting down"))}};function fP(){return new Do(n=>oN(n),jm)}async function FN(n,e){let t=We(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new _x,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(s){let a=qx(s,`Initialization of query '${Yl(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Kx(t)}async function LN(n,e){let t=We(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function uH(n,e){let t=We(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(r)&&(i=!0);s.wa=r}}i&&Kx(t)}function dH(n,e,t){let i=We(n),r=i.queries.get(e);if(r)for(let o of r.ba)o.onError(t);i.queries.delete(e)}function Kx(n){n.Ca.forEach(e=>{e.next()})}var bx,pP;(pP=bx||(bx={})).Ma="default",pP.Cache="cache";var Dm=class{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Va(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Va.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==bx.Cache}};var Am=class{constructor(e){this.key=e}},Mm=class{constructor(e){this.key=e}},wx=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=nt(),this.mutatedKeys=nt(),this.eu=sN(e),this.tu=new Ud(this.eu)}get nu(){return this.Za}ru(e,t){let i=t?t.iu:new Cm,r=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{let f=r.get(d),g=Hm(this.query,h)?h:null,w=!!f&&this.mutatedKeys.has(f.key),S=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),P=!1;f&&g?f.data.isEqual(g.data)?w!==S&&(i.track({type:3,doc:g}),P=!0):this.su(f,g)||(i.track({type:2,doc:g}),P=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(i.track({type:0,doc:g}),P=!0):f&&!g&&(i.track({type:1,doc:f}),P=!0,(l||c)&&(a=!0)),P&&(g?(s=s.add(g),o=S?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),i.track({type:1,doc:d})}return{tu:s,iu:i,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,h)=>(function(g,w){let S=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fe(20277,{Vt:P})}};return S(g)-S(w)})(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(i),r=r??!1;let a=t&&!r?this._u():[],l=this.Ya.size===0&&this.current&&!r?1:0,c=l!==this.Xa;return this.Xa=l,s.length!==0||c?{snapshot:new Va(this.query,e.tu,o,s,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Cm,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=nt(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});let t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new Mm(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new Am(i))}),t}cu(e){this.Za=e.ks,this.Ya=nt();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Va.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},Yx="SyncEngine",xx=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},Sx=class{constructor(e){this.key=e,this.hu=!1}},Ix=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Do(a=>oN(a),jm),this.Iu=new Map,this.Eu=new Set,this.Ru=new Jt(Ne.comparator),this.Au=new Map,this.Vu=new Vd,this.du={},this.mu=new Map,this.fu=Ld.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function hH(n,e,t=!0){let i=$N(n),r,o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await VN(i,e,t,!0),r}async function fH(n,e){let t=$N(n);await VN(t,e,!0,!1)}async function VN(n,e,t,i){let r=await K7(n.localStore,Vr(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return i&&(a=await pH(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&MN(n.remoteStore,r),a}async function pH(n,e,t,i,r){n.pu=(h,f,g)=>(async function(S,P,L,Z){let ve=P.view.ru(L);ve.Ss&&(ve=await cP(S.localStore,P.query,!1).then(({documents:O})=>P.view.ru(O,ve)));let be=Z&&Z.targetChanges.get(P.targetId),Ce=Z&&Z.targetMismatches.get(P.targetId)!=null,Te=P.view.applyChanges(ve,S.isPrimaryClient,be,Ce);return mP(S,P.targetId,Te.au),Te.snapshot})(n,h,f,g);let o=await cP(n.localStore,e,!0),s=new wx(e,o.ks),a=s.ru(o.documents),l=Od.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),c=s.applyChanges(a,n.isPrimaryClient,l);mP(n,t,c.au);let d=new xx(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function gH(n,e,t){let i=We(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter(s=>!jm(s,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await sx(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&$x(i.remoteStore,r.targetId),Tx(i,r.targetId)}).catch(hc)):(Tx(i,r.targetId),await sx(i.localStore,r.targetId,!0))}async function mH(n,e){let t=We(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),$x(t.remoteStore,i.targetId))}async function yH(n,e,t){let i=SH(n);try{let r=await(function(s,a){let l=We(s),c=sn.now(),d=a.reduce((g,w)=>g.add(w.key),nt()),h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let w=Ao(),S=nt();return l.xs.getEntries(g,d).next(P=>{w=P,w.forEach((L,Z)=>{Z.isValidDocument()||(S=S.add(L))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,w)).next(P=>{h=P;let L=[];for(let Z of a){let ve=_7(Z,h.get(Z.key).overlayedDocument);ve!=null&&L.push(new Mo(Z.key,ve,JP(ve.value.mapValue),Eo.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,L,a)}).next(P=>{f=P;let L=P.applyToLocalDocumentSet(h,S);return l.documentOverlayCache.saveOverlays(g,P.batchId,L)})}).then(()=>({batchId:f.batchId,changes:lN(h)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(s,a,l){let c=s.du[s.currentUser.toKey()];c||(c=new Jt(ot)),c=c.insert(a,l),s.du[s.currentUser.toKey()]=c})(i,r.batchId,t),await qd(i,r.changes),await Gm(i.remoteStore)}catch(r){let o=qx(r,"Failed to persist write");t.reject(o)}}async function UN(n,e){let t=We(n);try{let i=await z7(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Au.get(o);s&&(Et(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?s.hu=!0:r.modifiedDocuments.size>0?Et(s.hu,14607):r.removedDocuments.size>0&&(Et(s.hu,42227),s.hu=!1))}),await qd(t,i,e)}catch(i){await hc(i)}}function gP(n,e,t){let i=We(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(s,a){let l=We(s);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(let f of h.ba)f.va(a)&&(c=!0)}),c&&Kx(l)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function vH(n,e,t){let i=We(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Au.get(e),o=r&&r.key;if(o){let s=new Jt(Ne.comparator);s=s.insert(o,sr.newNoDocument(o,Je.min()));let a=nt().add(o),l=new fm(Je.min(),new Map,new Jt(ot),s,a);await UN(i,l),i.Ru=i.Ru.remove(o),i.Au.delete(e),Qx(i)}else await sx(i.localStore,e,!1).then(()=>Tx(i,e,t)).catch(hc)}async function _H(n,e){let t=We(n),i=e.batch.batchId;try{let r=await G7(t.localStore,e);jN(t,i,null),BN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await qd(t,r)}catch(r){await hc(r)}}async function EH(n,e,t){let i=We(n);try{let r=await(function(s,a){let l=We(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Et(h!==null,37113),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})})(i.localStore,e);jN(i,e,t),BN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await qd(i,r)}catch(r){await hc(r)}}function BN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function jN(n,e,t){let i=We(n),r=i.du[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function Tx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(i=>{n.Vu.containsKey(i)||HN(n,i)})}function HN(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&($x(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Qx(n))}function mP(n,e,t){for(let i of t)i instanceof Am?(n.Vu.addReference(i.key,e),bH(n,i)):i instanceof Mm?(Se(Yx,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||HN(n,i.key)):Fe(19791,{wu:i})}function bH(n,e){let t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Se(Yx,"New document in limbo: "+t),n.Eu.add(i),Qx(n))}function Qx(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new Ne(Nt.fromString(e)),i=n.fu.next();n.Au.set(i,new Sx(t)),n.Ru=n.Ru.insert(t,i),MN(n.remoteStore,new Fd(Vr(Vm(t.path)),i,"TargetPurposeLimboResolution",Nx.ce))}}async function qd(n,e,t){let i=We(n),r=[],o=[],s=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{s.push(i.pu(l,e,t).then(c=>{if((c||t)&&i.isPrimaryClient){let d=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){r.push(c);let d=nx.Es(l.targetId,c);o.push(d)}}))}),await Promise.all(s),i.Pu.J_(r),await(async function(l,c){let d=We(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>re.forEach(c,f=>re.forEach(f.Ts,g=>d.persistence.referenceDelegate.addReference(h,f.targetId,g)).next(()=>re.forEach(f.Is,g=>d.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))}catch(h){if(!fc(h))throw h;Se(Hx,"Failed to update sequence numbers: "+h)}for(let h of c){let f=h.targetId;if(!h.fromCache){let g=d.vs.get(f),w=g.snapshotVersion,S=g.withLastLimboFreeSnapshotVersion(w);d.vs=d.vs.insert(f,S)}}})(i.localStore,o))}async function wH(n,e){let t=We(n);if(!t.currentUser.isEqual(e)){Se(Yx,"User change. New user:",e.toKey());let i=await DN(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(l=>{l.reject(new ue(K.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await qd(t,i.Ns)}}function xH(n,e){let t=We(n),i=t.Au.get(e);if(i&&i.hu)return nt().add(i.key);{let r=nt(),o=t.Iu.get(e);if(!o)return r;for(let s of o){let a=t.Tu.get(s);r=r.unionWith(a.view.nu)}return r}}function $N(n){let e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=UN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vH.bind(null,e),e.Pu.J_=uH.bind(null,e.eventManager),e.Pu.yu=dH.bind(null,e.eventManager),e}function SH(n){let e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_H.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EH.bind(null,e),e}var Jx=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=zd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return $7(this.persistence,new rx,t.initialUser,this.serializer)}Cu(t){return new _m(tx.Vi,this.serializer)}Du(t){return new ax}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Rm=class extends Jx{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Et(this.persistence.referenceDelegate instanceof Em,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new Hw(i,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Vi.withCacheSize(this.cacheSizeBytes):Vi.DEFAULT;return new _m(i=>Em.Vi(i,t),this.serializer)}};var GN=(()=>{class n{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>gP(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=wH.bind(null,this.syncEngine),await cH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Ex})()}createDatastore(t){let i=zd(t.databaseInfo.databaseId),r=J7(t.databaseInfo);return Z7(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,s,a,l){return new yx(r,o,s,a,l)})(this.localStore,this.datastore,t.asyncQueue,i=>gP(this.syncEngine,i,0),(function(){return wm.v()?new wm:new lx})())}createSyncEngine(t,i){return(function(o,s,a,l,c,d,h){let f=new Ix(o,s,a,l,c,d);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){let r=We(i);Se(La,"RemoteStore shutting down."),r.Ea.add(5),await Wd(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var Pm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):xo("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var xs="FirestoreClient",Cx=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=An.UNAUTHENTICATED,this.clientId=Ra.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async s=>{Se(xs,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(Se(xs,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new or;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=qx(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}};async function ow(n,e){n.asyncQueue.verifyOperationInProgress(),Se(xs,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await DN(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function yP(n,e){n.asyncQueue.verifyOperationInProgress();let t=await IH(n);Se(xs,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>hP(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>hP(e.remoteStore,r)),n._onlineComponents=e}async function IH(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Se(xs,"Using user provided OfflineComponentProvider");try{await ow(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===K.FAILED_PRECONDITION||r.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;_s("Error using user provided cache. Falling back to memory cache: "+t),await ow(n,new Jx)}}else Se(xs,"Using default OfflineComponentProvider"),await ow(n,new Rm(void 0));return n._offlineComponents}async function zN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Se(xs,"Using user provided OnlineComponentProvider"),await yP(n,n._uninitializedComponentsProvider._online)):(Se(xs,"Using default OnlineComponentProvider"),await yP(n,new GN))),n._onlineComponents}function TH(n){return zN(n).then(e=>e.syncEngine)}async function WN(n){let e=await zN(n),t=e.eventManager;return t.onListen=hH.bind(null,e.syncEngine),t.onUnlisten=gH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=fH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=mH.bind(null,e.syncEngine),t}function qN(n,e,t={}){let i=new or;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new Pm({next:f=>{d.Nu(),s.enqueueAndForget(()=>LN(o,h));let g=f.docs.has(a);!g&&f.fromCache?c.reject(new ue(K.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new ue(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Dm(Vm(a.path),d,{includeMetadataChanges:!0,Ka:!0});return FN(o,h)})(await WN(n),n.asyncQueue,e,t,i)),i.promise}function KN(n,e,t={}){let i=new or;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new Pm({next:f=>{d.Nu(),s.enqueueAndForget(()=>LN(o,h)),f.fromCache&&l.source==="server"?c.reject(new ue(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Dm(a,d,{includeMetadataChanges:!0,Ka:!0});return FN(o,h)})(await WN(n),n.asyncQueue,e,t,i)),i.promise}function YN(n,e){let t=new or;return n.asyncQueue.enqueueAndForget(async()=>yH(await TH(n),e,t)),t.promise}function QN(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var CH="ComponentProvider",vP=new Map;function DH(n,e,t,i,r){return new dw(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,QN(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}var JN="firestore.googleapis.com",_P=!0,Nm=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ue(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JN,this.ssl=_P}else this.host=e.host,this.ssl=e.ssl??_P;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=CN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<B7)throw new ue(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ue(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ac=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nm(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new im;switch(i.type){case"firstParty":return new lw(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ue(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=vP.get(t);i&&(Se(CH,"Removing Datastore"),vP.delete(t),i.terminate())})(this),Promise.resolve()}};function ZN(n,e,t,i={}){n=$r(n,ac);let r=ps(e),o=n._getSettings(),s=ce(F({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;r&&(Hg(`https://${a}`),$g("Firestore",!0)),o.host!==JN&&o.host!==a&&_s("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=ce(F({},o),{host:a,ssl:r,emulatorOptions:i});if(!ir(l,s)&&(n._setSettings(l),i.mockUserToken)){let c,d;if(typeof i.mockUserToken=="string")c=i.mockUserToken,d=An.MOCK_USER;else{c=dR(i.mockUserToken,n._app?.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new ue(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new An(h)}n._authCredentials=new sw(new nm(c,d))}}var ar=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},_n=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(dc(t,n._jsonSchema))return new n(e,i||null,new Ne(Nt.fromString(t.referencePath)))}};_n._jsonSchemaVersion="firestore/documentReference/1.0",_n._jsonSchema={type:on("string",_n._jsonSchemaVersion),referencePath:on("string")};var bo=class n extends ar{constructor(e,t,i){super(e,t,Vm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new _n(this.firestore,null,new Ne(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Si(n,e,...t){if(n=Dn(n),SP("collection","path",e),n instanceof ac){let i=Nt.fromString(e,...t);return UR(i),new bo(n,null,i)}{if(!(n instanceof _n||n instanceof bo))throw new ue(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Nt.fromString(e,...t));return UR(i),new bo(n.firestore,null,i)}}function Ss(n,e,...t){if(n=Dn(n),arguments.length===1&&(e=Ra.newId()),SP("doc","path",e),n instanceof ac){let i=Nt.fromString(e,...t);return VR(i),new _n(n,null,new Ne(i))}{if(!(n instanceof _n||n instanceof bo))throw new ue(K.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Nt.fromString(e,...t));return VR(i),new _n(n.firestore,n instanceof bo?n.converter:null,new Ne(i))}}var EP="AsyncQueue",km=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Sm(this,"async_queue_retry"),this._c=()=>{let i=rw();i&&Se(EP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;let t=rw();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=rw();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new or;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!fc(e))throw e;Se(EP,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,xo("INTERNAL UNHANDLED ERROR: ",bP(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=vx.createAndSchedule(this,e,t,i,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&Fe(47125,{Pc:bP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function bP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Ro=class extends ac{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new km,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new km(e),this._firestoreClient=void 0,await e}}};function Kd(n,e){let t=typeof n=="object"?n:qg(),i=typeof n=="string"?n:e||dm,r=Ed(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let o=uR("firestore");o&&ZN(r,...o)}return r}function Yd(n){if(n._terminated)throw new ue(K.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AH(n),n._firestoreClient}function AH(n){let e=n._freezeSettings(),t=DH(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Cx(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}var Br=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ln.fromBase64String(e))}catch(t){throw new ue(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(dc(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Br._jsonSchemaVersion="firestore/bytes/1.0",Br._jsonSchema={type:on("string",Br._jsonSchemaVersion),bytes:on("string")};var lc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ii(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var cc=class{constructor(e){this._methodName=e}};var wo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(dc(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};wo._jsonSchemaVersion="firestore/geoPoint/1.0",wo._jsonSchema={type:on("string",wo._jsonSchemaVersion),latitude:on("number"),longitude:on("number")};var jr=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(dc(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new ue(K.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};jr._jsonSchemaVersion="firestore/vectorValue/1.0",jr._jsonSchema={type:on("string",jr._jsonSchemaVersion),vectorValues:on("object")};var MH=/^__.*__$/,Dx=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Mo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fa(e,this.data,t,this.fieldTransforms)}};function XN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fe(40011,{dataSource:n})}}var Ax=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(F(F({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Om(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(XN(this.dataSource)&&MH.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},Mx=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||zd(e)}createContext(e,t,i,r=!1){return new Ax({dataSource:e,methodName:t,targetDoc:i,path:ii.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Qd(n){let e=n._freezeSettings(),t=zd(n._databaseId);return new Mx(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Zx(n,e,t,i,r,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);nk("Data must be an object, but it was:",s,i);let a=ek(i,s),l,c;if(o.merge)l=new Fr(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let f=gc(e,h,t);if(!s.contains(f))throw new ue(K.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);PH(d,f)||d.push(f)}l=new Fr(d),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new Dx(new Ui(a),l,c)}var Rx=class n extends cc{_toFieldTransform(e){return new Sw(e.path,new Na)}isEqual(e){return e instanceof n}};function Xx(n,e,t,i=!1){return e1(t,n.createContext(i?4:3,e))}function e1(n,e){if(tk(n=Dn(n)))return nk("Unsupported field value:",e,n),ek(n,e);if(n instanceof cc)return(function(i,r){if(!XN(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){let o=[],s=0;for(let a of i){let l=e1(a,r.childContextForArray(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Dn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return p7(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=sn.fromDate(i);return{timestampValue:ym(r.serializer,o)}}if(i instanceof sn){let o=new sn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:ym(r.serializer,o)}}if(i instanceof wo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Br)return{bytesValue:vN(r.serializer,i._byteString)};if(i instanceof _n){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:jx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof jr)return(function(s,a){let l=s instanceof jr?s.toArray():s;return{mapValue:{fields:{[Ox]:{stringValue:Fx},[tc]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return Bx(a.serializer,d)})}}}}}})(i,r);if(IN(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Hd(i)}`)})(n,e)}function ek(n,e){let t={};return HP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ua(n,(i,r)=>{let o=e1(r,e.childContextForField(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function tk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof sn||n instanceof wo||n instanceof Br||n instanceof _n||n instanceof cc||n instanceof jr||IN(n))}function nk(n,e,t){if(!tk(t)||!TP(t)){let i=Hd(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function gc(n,e,t){if((e=Dn(e))instanceof lc)return e._internalPath;if(typeof e=="string")return ik(n,e);throw Om("Field path arguments must be of type string or ",n,!1,void 0,t)}var RH=new RegExp("[~\\*/\\[\\]]");function ik(n,e,t){if(e.search(RH)>=0)throw Om(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lc(...e.split("."))._internalPath}catch{throw Om(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Om(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new ue(K.INVALID_ARGUMENT,a+n+l)}function PH(n,e){return n.some(t=>t.isEqual(e))}var Bd=class{convertValue(e,t="none"){switch(Es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Io(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Fe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Ua(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){let t=e.fields?.[tc].arrayValue?.values?.map(i=>$t(i.doubleValue));return new jr(t)}convertGeoPoint(e){return new wo($t(e.latitude),$t(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Lm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Md(e));default:return null}}convertTimestamp(e){let t=So(e);return new sn(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Nt.fromString(e);Et(SN(i),9688,{name:e});let r=new Rd(i.get(1),i.get(3)),o=new Ne(i.popFirst(5));return r.isEqual(t)||xo(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var jd=class extends Bd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Br(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new _n(this.firestore,null,t)}};function Jd(){return new Rx("serverTimestamp")}var rk="@firebase/firestore",ok="4.10.0";var Zd=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new _n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new t1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(gc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},t1=class extends Zd{data(){return super.data()}};function FH(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Xd=class{},vc=class extends Xd{};function Po(n,e,...t){let i=[];e instanceof Xd&&i.push(e),i=i.concat(t),(function(o){let s=o.filter(l=>l instanceof n1).length,a=o.filter(l=>l instanceof zm).length;if(s>1||s>0&&a>0)throw new ue(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var zm=class n extends vc{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return ck(e._query,t),new ar(e.firestore,e.converter,Bm(e._query,t))}_parse(e){let t=Qd(e.firestore);return(function(o,s,a,l,c,d,h){let f;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ue(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ak(h,d);let w=[];for(let S of h)w.push(sk(l,o,S));f={arrayValue:{values:w}}}else f=sk(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ak(h,d),f=Xx(a,s,h,d==="in"||d==="not-in");return rn.create(c,d,f)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Is(n,e,t){let i=e,r=gc("where",n);return zm._create(r,i,t)}var n1=class n extends Xd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Bi.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let s=r,a=o.getFlattenedFilters();for(let l of a)ck(s,l),s=Bm(s,l)})(e._query,t),new ar(e.firestore,e.converter,Bm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var i1=class n extends vc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(r,o,s){if(r.startAt!==null)throw new ue(K.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ue(K.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new bs(o,s)})(e._query,this._field,this._direction);return new ar(e.firestore,e.converter,iN(e._query,t))}};function lr(n,e="asc"){let t=e,i=gc("orderBy",n);return i1._create(i,t)}var r1=class n extends vc{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new ar(e.firestore,e.converter,Nd(e._query,this._limit,this._limitType))}};function Ts(n){return CP("limit",n),r1._create("limit",n,"F")}var o1=class n extends vc{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=LH(e,this.type,this._docOrFields,this._inclusive);return new ar(e.firestore,e.converter,rN(e._query,t))}};function lk(...n){return o1._create("startAfter",n,!1)}function LH(n,e,t,i){if(t[0]=Dn(t[0]),t[0]instanceof Zd)return(function(o,s,a,l,c){if(!l)throw new ue(K.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of Aa(o))if(h.field.isKeyField())d.push(Gd(s,l.key));else{let f=l.data.field(h.field);if($d(f))throw new ue(K.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){let g=h.field.canonicalString();throw new ue(K.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(f)}return new To(d,c)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Qd(n.firestore);return(function(s,a,l,c,d,h){let f=s.explicitOrderBy;if(d.length>f.length)throw new ue(K.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let w=0;w<d.length;w++){let S=d[w];if(f[w].field.isKeyField()){if(typeof S!="string")throw new ue(K.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof S}`);if(!Um(s)&&S.indexOf("/")!==-1)throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${S}' contains a slash.`);let P=s.path.child(Nt.fromString(S));if(!Ne.isDocumentKey(P))throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);let L=new Ne(P);g.push(Gd(a,L))}else{let P=Xx(l,c,S);g.push(P)}}return new To(g,h)})(n._query,n.firestore._databaseId,r,e,t,i)}}function sk(n,e,t){if(typeof(t=Dn(t))=="string"){if(t==="")throw new ue(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Um(e)&&t.indexOf("/")!==-1)throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Nt.fromString(t));if(!Ne.isDocumentKey(i))throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Gd(n,new Ne(i))}if(t instanceof _n)return Gd(n,t._key);throw new ue(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hd(t)}.`)}function ak(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ck(n,e){let t=(function(r,o){for(let s of r)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ue(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function uk(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var ja=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ha=class n extends Zd{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new mc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(gc("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(K.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Ha._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ha._jsonSchema={type:on("string",Ha._jsonSchemaVersion),bundleSource:on("string","DocumentSnapshot"),bundleName:on("string"),bundle:on("string")};var mc=class extends Ha{data(e={}){return super.data(e)}},yc=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ja(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new mc(this._firestore,this._userDataWriter,i.key,i,new ja(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{let l=new mc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new ja(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new mc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new ja(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),c=-1,d=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:VH(a.type),doc:l,oldIndex:c,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(K.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ra.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function VH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fe(61501,{type:n})}}yc._jsonSchemaVersion="firestore/querySnapshot/1.0",yc._jsonSchema={type:on("string",yc._jsonSchemaVersion),bundleSource:on("string","QuerySnapshot"),bundleName:on("string"),bundle:on("string")};function s1(n){n=$r(n,_n);let e=$r(n.firestore,Ro),t=Yd(e);return qN(t,n._key).then(i=>UH(e,n,i))}function Cs(n){n=$r(n,ar);let e=$r(n.firestore,Ro),t=Yd(e),i=new jd(e);return FH(n._query),KN(t,n._query).then(r=>new yc(e,i,n,r))}function Wm(n,e,t){n=$r(n,_n);let i=$r(n.firestore,Ro),r=uk(n.converter,e,t),o=Qd(i);return dk(i,[Zx(o,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Eo.none())])}function eh(n,e){let t=$r(n.firestore,Ro),i=Ss(n),r=uk(n.converter,e),o=Qd(n.firestore);return dk(t,[Zx(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Eo.exists(!1))]).then(()=>i)}function dk(n,e){let t=Yd(n);return YN(t,e)}function UH(n,e,t){let i=t.docs.get(e._key),r=new jd(n);return new Ha(n,r,e._key,i,new ja(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){wP(vs),ys(new Li("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),a=new Ro(new rm(i.getProvider("auth-internal")),new sm(s,i.getProvider("app-check-internal")),qP(s,r),s);return o=F({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),rr(rk,ok,e),rr(rk,ok,"esm2020")})();function Tk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Ck=Tk,Dk=new mo("auth","Firebase",Tk());var Zm=new gs("@firebase/auth");function BH(n,...e){Zm.logLevel<=tt.WARN&&Zm.warn(`Auth (${vs}): ${n}`,...e)}function Km(n,...e){Zm.logLevel<=tt.ERROR&&Zm.error(`Auth (${vs}): ${n}`,...e)}function zr(n,...e){throw S1(n,...e)}function cr(n,...e){return S1(n,...e)}function x1(n,e,t){let i=ce(F({},Ck()),{[e]:t});return new mo("auth","Firebase",i).create(e,{appName:n.name})}function $a(n){return x1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jH(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&zr(n,"argument-error"),x1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function S1(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Dk.create(n,...e)}function je(n,e,...t){if(!n)throw S1(e,...t)}function No(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Km(e),new Error(e)}function Oo(n,e){n||No(e)}function c1(){return typeof self<"u"&&self.location?.href||""}function HH(){return hk()==="http:"||hk()==="https:"}function hk(){return typeof self<"u"&&self.location?.protocol||null}function $H(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HH()||pR()||"connection"in navigator)?navigator.onLine:!0}function GH(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ga=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Oo(t>e,"Short delay should be less than long delay!"),this.isMobile=hR()||gR()}get(){return $H()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function I1(n,e){Oo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Xm=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;No("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;No("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;No("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var zH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var WH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qH=new Ga(3e4,6e4);function T1(n,e){return n.tenantId&&!e.tenantId?ce(F({},e),{tenantId:n.tenantId}):e}async function Ec(n,e,t,i,r={}){return Ak(n,r,async()=>{let o={},s={};i&&(e==="GET"?s=i:o={body:JSON.stringify(i)});let a=Wl(F({key:n.config.apiKey},s)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let c=F({method:e,headers:l},o);return fR()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&ps(n.emulatorConfig.host)&&(c.credentials="include"),Xm.fetch()(await Mk(n,n.config.apiHost,t,a),c)})}async function Ak(n,e,t){n._canInitEmulator=!1;let i=F(F({},zH),e);try{let r=new u1(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw qm(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw qm(n,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw qm(n,"email-already-in-use",s);if(l==="USER_DISABLED")throw qm(n,"user-disabled",s);let d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw x1(n,d,c);zr(n,d)}}catch(r){if(r instanceof wi)throw r;zr(n,"network-request-failed",{message:String(r)})}}async function KH(n,e,t,i,r={}){let o=await Ec(n,e,t,i,r);return"mfaPendingCredential"in o&&zr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function Mk(n,e,t,i){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?I1(n.config,r):`${n.config.apiScheme}://${r}`;return WH.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var u1=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(cr(this.auth,"network-request-failed")),qH.get())})}};function qm(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=cr(n,e,i);return r.customData._tokenResponse=t,r}async function YH(n,e){return Ec(n,"POST","/v1/accounts:delete",e)}async function e0(n,e){return Ec(n,"POST","/v1/accounts:lookup",e)}function th(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Rk(n,e=!1){let t=Dn(n),i=await t.getIdToken(e),r=C1(i);je(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:th(a1(r.auth_time)),issuedAtTime:th(a1(r.iat)),expirationTime:th(a1(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function a1(n){return Number(n)*1e3}function C1(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Km("JWT malformed, contained fewer than 3 sections"),null;try{let r=Bg(t);return r?JSON.parse(r):(Km("Failed to decode base64 JWT payload"),null)}catch(r){return Km("Caught error parsing JWT payload as JSON",r?.toString()),null}}function fk(n){let e=C1(n);return je(e,"internal-error"),je(typeof e.exp<"u","internal-error"),je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ih(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof wi&&QH(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function QH({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var d1=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var rh=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=th(this.lastLoginAt),this.creationTime=th(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function t0(n){let e=n.auth,t=await n.getIdToken(),i=await ih(n,e0(e,{idToken:t}));je(i?.users.length,e,"internal-error");let r=i.users[0];n._notifyReloadListener(r);let o=r.providerUserInfo?.length?Nk(r.providerUserInfo):[],s=JH(n.providerData,o),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!s?.length,c=a?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new rh(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(n,d)}async function Pk(n){let e=Dn(n);await t0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function JH(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Nk(n){return n.map(i=>{var r=i,{providerId:e}=r,t=Qa(r,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function ZH(n,e){let t=await Ak(n,{},async()=>{let i=Wl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=await Mk(n,r,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return n.emulatorConfig&&ps(n.emulatorConfig.host)&&(l.credentials="include"),Xm.fetch()(s,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function XH(n,e){return Ec(n,"POST","/v2/accounts:revokeToken",T1(n,e))}var nh=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){je(e.idToken,"internal-error"),je(typeof e.idToken<"u","internal-error"),je(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){je(e.length!==0,"internal-error");let t=fk(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:r,expiresIn:o}=await ZH(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n;return i&&(je(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(je(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(je(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return No("not implemented")}};function Ds(n,e){je(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var As=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:i}=s,r=Qa(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new d1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new rh(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await ih(this,this.stsTokenManager.getToken(this.auth,e));return je(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Rk(this,e)}reload(){return Pk(this)}_assign(e){this!==e&&(je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>F({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(ce(F({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await t0(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xi(this.auth.app))return Promise.reject($a(this.auth));let e=await this.getIdToken();return await ih(this,YH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return ce(F({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>F({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:g,providerData:w,stsTokenManager:S}=t;je(h&&S,e,"internal-error");let P=nh.fromJSON(this.name,S);je(typeof h=="string",e,"internal-error"),Ds(i,e.name),Ds(r,e.name),je(typeof f=="boolean",e,"internal-error"),je(typeof g=="boolean",e,"internal-error"),Ds(o,e.name),Ds(s,e.name),Ds(a,e.name),Ds(l,e.name),Ds(c,e.name),Ds(d,e.name);let L=new n({uid:h,auth:e,email:r,emailVerified:f,displayName:i,isAnonymous:g,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:P,createdAt:c,lastLoginAt:d});return w&&Array.isArray(w)&&(L.providerData=w.map(Z=>F({},Z))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,i=!1){let r=new nh;r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await t0(o),o}static async _fromGetAccountInfoResponse(e,t,i){let r=t.users[0];je(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?Nk(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,a=new nh;a.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new rh(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(l,c),l}};var pk=new Map;function ko(n){Oo(n instanceof Function,"Expected a class definition");let e=pk.get(n);return e?(Oo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,pk.set(n,e),e)}var e$=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,i){this.storage[t]=i}async _get(t){let i=this.storage[t];return i===void 0?null:i}async _remove(t){delete this.storage[t]}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),h1=e$;function Ym(n,e,t){return`firebase:${n}:${e}:${t}`}var n0=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=Ym(this.userKey,r.apiKey,o),this.fullPersistenceKey=Ym("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await e0(this.auth,{idToken:e}).catch(()=>{});return t?As._fromGetAccountInfoResponse(this.auth,t,e):null}return As._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new n(ko(h1),e,i);let r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c),o=r[0]||ko(h1),s=Ym(i,e.config.apiKey,e.name),a=null;for(let c of t)try{let d=await c._get(s);if(d){let h;if(typeof d=="string"){let f=await e0(e,{idToken:d}).catch(()=>{});if(!f)break;h=await As._fromGetAccountInfoResponse(e,f,d)}else h=As._fromJSON(e,d);c!==o&&(a=h),o=c;break}}catch{}let l=r.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,i):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==o)try{await c._remove(s)}catch{}})),new n(o,e,i))}};function gk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Lk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(kk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Uk(e))return"Blackberry";if(Bk(e))return"Webos";if(Ok(e))return"Safari";if((e.includes("chrome/")||Fk(e))&&!e.includes("edge/"))return"Chrome";if(Vk(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function kk(n=Cn()){return/firefox\//i.test(n)}function Ok(n=Cn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fk(n=Cn()){return/crios\//i.test(n)}function Lk(n=Cn()){return/iemobile/i.test(n)}function Vk(n=Cn()){return/android/i.test(n)}function Uk(n=Cn()){return/blackberry/i.test(n)}function Bk(n=Cn()){return/webos/i.test(n)}function D1(n=Cn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function t$(n=Cn()){return D1(n)&&!!window.navigator?.standalone}function n$(){return mR()&&document.documentMode===10}function jk(n=Cn()){return D1(n)||Vk(n)||Bk(n)||Uk(n)||/windows phone/i.test(n)||Lk(n)}function Hk(n,e=[]){let t;switch(n){case"Browser":t=gk(Cn());break;case"Worker":t=`${gk(Cn())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vs}/${i}`}var f1=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=o=>new Promise((s,a)=>{try{let l=e(o);s(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}};async function i$(n,e={}){return Ec(n,"GET","/v2/passwordPolicy",T1(n,e))}var r$=6,p1=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??r$,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var g1=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new i0(this),this.idTokenSubscription=new i0(this),this.beforeStateQueue=new f1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ko(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await n0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await e0(this,{idToken:e}),i=await As._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xi(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await t0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GH()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xi(this.app))return Promise.reject($a(this));let t=e?Dn(e):null;return t&&je(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xi(this.app)?Promise.reject($a(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xi(this.app)?Promise.reject($a(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ko(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await i$(this),t=new p1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new mo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await XH(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&ko(e)||this._popupRedirectResolver;je(t,this,"argument-error"),this.redirectPersistenceManager=await n0.create(this,[ko(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(je(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{s=!0,l()}}else{let l=e.addObserver(t);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(xi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&BH(`Error while retrieving App Check token: ${e.error}`),e?.token}};function d0(n){return Dn(n)}var i0=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=ER(t=>this.observer=t)}get next(){return je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var A1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function o$(n){A1=n}function s$(n){return A1.loadJS(n)}function a$(){return A1.gapiScript}function $k(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Gk(n,e){let t=Ed(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(ir(o,e??{}))return r;zr(r,"already-initialized")}return t.initialize({options:e})}function l$(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ko);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function zk(n,e,t){let i=d0(n);je(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=Wk(e),{host:s,port:a}=c$(e),l=a===null?"":`:${a}`,c={url:`${o}//${s}${l}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){je(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),je(ir(c,i.config.emulator)&&ir(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,ps(s)?(Hg(`${o}//${s}${l}`),$g("Auth",!0)):r||u$()}function Wk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function c$(n){let e=Wk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:mk(i.substr(o.length+1))}}else{let[o,s]=i.split(":");return{host:o,port:mk(s)}}}function mk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function u$(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var oh=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return No("not implemented")}_getIdTokenResponse(e){return No("not implemented")}_linkToIdToken(e,t){return No("not implemented")}_getReauthenticationResolver(e){return No("not implemented")}};async function _c(n,e){return KH(n,"POST","/v1/accounts:signInWithIdp",T1(n,e))}var d$="http://localhost",r0=class n extends oh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):zr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=a,o=Qa(a,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return _c(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,_c(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,_c(e,t)}buildRequest(){let e={requestUri:d$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Wl(t)}return e}};var sh=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var o0=class extends sh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var M1=(()=>{class n extends o0{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return r0._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var ah=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){let o=await As._fromIdTokenResponse(e,i,r),s=yk(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);let r=yk(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})}};function yk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var m1=class n extends wi{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function qk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?m1._fromErrorAndOperation(n,o,e,i):o})}async function h$(n,e,t=!1){let i=await ih(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ah._forOperation(n,"link",i)}async function f$(n,e,t=!1){let{auth:i}=n;if(xi(i.app))return Promise.reject($a(i));let r="reauthenticate";try{let o=await ih(n,qk(i,r,e,n),t);je(o.idToken,i,"internal-error");let s=C1(o.idToken);je(s,i,"internal-error");let{sub:a}=s;return je(n.uid===a,i,"user-mismatch"),ah._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&zr(i,"user-mismatch"),o}}async function p$(n,e,t=!1){if(xi(n.app))return Promise.reject($a(n));let i="signIn",r=await qk(n,i,e),o=await ah._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}function Kk(n,e,t,i){return Dn(n).onIdTokenChanged(e,t,i)}function Yk(n,e,t){return Dn(n).beforeAuthStateChanged(e,t)}function R1(n,e,t,i){return Dn(n).onAuthStateChanged(e,t,i)}function P1(n){return Dn(n).signOut()}var s0="__sak";var a0=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(s0,"1"),this.storage.removeItem(s0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var g$=1e3,m$=10,y$=(()=>{class n extends a0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);n$()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,m$):o()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},g$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,i){await super._set(t,i),this.localCache[t]=JSON.stringify(i)}async _get(t){let i=await super._get(t);return this.localCache[t]=JSON.stringify(i),i}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),Qk=y$;var v$=(()=>{class n extends a0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),N1=v$;function _$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var E$=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let i=t,{eventId:r,eventType:o,data:s}=i.data,a=this.handlersMap[o];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let l=Array.from(a).map(async d=>d(i.origin,s)),c=await _$(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:c})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function k1(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var y1=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{let c=k1("",20);r.port1.start();let d=setTimeout(()=>{l(new Error("unsupported_event"))},i);s={messageChannel:r,onMessage(h){let f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(f.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function Gr(){return window}function b$(n){Gr().location.href=n}function Jk(){return typeof Gr().WorkerGlobalScope<"u"&&typeof Gr().importScripts=="function"}async function w$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function x$(){return navigator?.serviceWorker?.controller||null}function S$(){return Jk()?self:null}var Zk="firebaseLocalStorageDb",I$=1,l0="firebaseLocalStorage",Xk="fbase_key",za=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function h0(n,e){return n.transaction([l0],e?"readwrite":"readonly").objectStore(l0)}function T$(){let n=indexedDB.deleteDatabase(Zk);return new za(n).toPromise()}function v1(){let n=indexedDB.open(Zk,I$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(l0,{keyPath:Xk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{let i=n.result;i.objectStoreNames.contains(l0)?e(i):(i.close(),await T$(),e(await v1()))})})}async function vk(n,e,t){let i=h0(n,!0).put({[Xk]:e,value:t});return new za(i).toPromise()}async function C$(n,e){let t=h0(n,!1).get(e),i=await new za(t).toPromise();return i===void 0?null:i.value}function _k(n,e){let t=h0(n,!0).delete(e);return new za(t).toPromise()}var D$=800,A$=3,M$=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await v1(),this.db)}async _withRetries(t){let i=0;for(;;)try{let r=await this._openDb();return await t(r)}catch(r){if(i++>A$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Jk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=E$._getInstance(S$()),this.receiver._subscribe("keyChanged",async(t,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(t,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await w$(),!this.activeServiceWorker)return;this.sender=new y1(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||x$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await v1();return await vk(t,s0,"1"),await _k(t,s0),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,i){return this._withPendingWrite(async()=>(await this._withRetries(r=>vk(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)))}async _get(t){let i=await this._withRetries(r=>C$(r,t));return this.localCache[t]=i,i}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(i=>_k(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=h0(o,!1).getAll();return new za(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),D$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),eO=M$;var Ohe=$k("rcb"),Fhe=new Ga(3e4,6e4);function tO(n,e){return e?ko(e):(je(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var lh=class extends oh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _c(e,this._buildIdpRequest())}_linkToIdToken(e,t){return _c(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return _c(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function R$(n){return p$(n.auth,new lh(n),n.bypassAuthState)}function P$(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),f$(t,new lh(n),n.bypassAuthState)}async function N$(n){let{auth:e,user:t}=n;return je(t,e,"internal-error"),h$(t,new lh(n),n.bypassAuthState)}var c0=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return R$;case"linkViaPopup":case"linkViaRedirect":return N$;case"reauthViaPopup":case"reauthViaRedirect":return P$;default:zr(this.auth,"internal-error")}}resolve(e){Oo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Oo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var k$=new Ga(2e3,1e4);async function O1(n,e,t){if(xi(n.app))return Promise.reject(cr(n,"operation-not-supported-in-this-environment"));let i=d0(n);jH(n,e,sh);let r=tO(i,t);return new O$(i,"signInViaPopup",e,r).executeNotNull()}var O$=(()=>{class n extends c0{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return je(t,this.auth,"internal-error"),t}async onExecution(){Oo(this.filter.length===1,"Popup operations only handle one event");let t=k1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(cr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(cr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(cr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,k$.get())};t()}}n.currentPopupAction=null;return n})(),F$="pendingRedirect",Qm=new Map,_1=class extends c0{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Qm.get(this.auth._key());if(!e){try{let i=await L$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Qm.set(this.auth._key(),e)}return this.bypassAuthState||Qm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function L$(n,e){let t=B$(e),i=U$(n);if(!await i._isAvailable())return!1;let r=await i._get(t)==="true";return await i._remove(t),r}function V$(n,e){Qm.set(n._key(),e)}function U$(n){return ko(n._redirectPersistence)}function B$(n){return Ym(F$,n.config.apiKey,n.name)}async function j$(n,e,t=!1){if(xi(n.app))return Promise.reject($a(n));let i=d0(n),r=tO(i,e),s=await new _1(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}var H$=600*1e3,E1=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!nO(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(cr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=H$&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ek(e))}saveEventToCache(e){this.cachedEventUids.add(Ek(e)),this.lastProcessedEventTime=Date.now()}};function Ek(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function nO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function $$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nO(n);default:return!1}}async function G$(n,e={}){return Ec(n,"GET","/v1/projects",e)}var z$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,W$=/^https?/;async function q$(n){if(n.config.emulator)return;let{authorizedDomains:e}=await G$(n);for(let t of e)try{if(K$(t))return}catch{}zr(n,"unauthorized-domain")}function K$(n){let e=c1(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i}if(!W$.test(t))return!1;if(z$.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var Y$=new Ga(3e4,6e4);function bk(){let n=Gr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Q$(n){return new Promise((e,t)=>{function i(){bk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bk(),t(cr(n,"network-request-failed"))},timeout:Y$.get()})}if(Gr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Gr().gapi?.load)i();else{let r=$k("iframefcb");return Gr()[r]=()=>{gapi.load?i():t(cr(n,"network-request-failed"))},s$(`${a$()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw Jm=null,e})}var Jm=null;function J$(n){return Jm=Jm||Q$(n),Jm}var Z$=new Ga(5e3,15e3),X$="__/auth/iframe",eG="emulator/auth/iframe",tG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iG(n){let e=n.config;je(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?I1(e,eG):`https://${n.config.authDomain}/${X$}`,i={apiKey:e.apiKey,appName:n.name,v:vs},r=nG.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Wl(i).slice(1)}`}async function rG(n){let e=await J$(n),t=Gr().gapi;return je(t,n,"internal-error"),e.open({where:document.body,url:iG(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tG,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});let s=cr(n,"network-request-failed"),a=Gr().setTimeout(()=>{o(s)},Z$.get());function l(){Gr().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{o(s)})}))}var oG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sG=500,aG=600,lG="_blank",cG="http://localhost",u0=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function uG(n,e,t,i=sG,r=aG){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=ce(F({},oG),{width:i.toString(),height:r.toString(),top:o,left:s}),c=Cn().toLowerCase();t&&(a=Fk(c)?lG:t),kk(c)&&(e=e||cG,l.scrollbars="yes");let d=Object.entries(l).reduce((f,[g,w])=>`${f}${g}=${w},`,"");if(t$(c)&&a!=="_self")return dG(e||"",a),new u0(null);let h=window.open(e||"",a,d);je(h,n,"popup-blocked");try{h.focus()}catch{}return new u0(h)}function dG(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var hG="__/auth/handler",fG="emulator/auth/handler",pG=encodeURIComponent("fac");async function wk(n,e,t,i,r,o){je(n.config.authDomain,n,"auth-domain-config-required"),je(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:vs,eventId:r};if(e instanceof sh){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",_R(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(o||{}))s[d]=h}if(e instanceof o0){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let l=await n._getAppCheckToken(),c=l?`#${pG}=${encodeURIComponent(l)}`:"";return`${gG(n)}?${Wl(a).slice(1)}${c}`}function gG({config:n}){return n.emulator?I1(n,fG):`https://${n.authDomain}/${hG}`}var l1="webStorageSupport",b1=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=N1,this._completeRedirectFn=j$,this._overrideRedirectResult=V$}async _openPopup(e,t,i,r){Oo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await wk(e,t,i,c1(),r);return uG(e,o,k1())}async _openRedirect(e,t,i,r){await this._originValidation(e);let o=await wk(e,t,i,c1(),r);return b$(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Oo(o,"If manager is not set, promise should be"),o)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await rG(e),i=new E1(e);return t.register("authEvent",r=>(je(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(l1,{type:l1},r=>{let o=r?.[0]?.[l1];o!==void 0&&t(!!o),zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=q$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jk()||Ok()||D1()}},iO=b1;var xk="@firebase/auth",Sk="1.12.0";var w1=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function mG(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yG(n){ys(new Li("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=i.options;je(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hk(n)},c=new g1(i,r,o,l);return l$(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ys(new Li("auth-internal",e=>{let t=d0(e.getProvider("auth").getImmediate());return(i=>new w1(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),rr(xk,Sk,mG(n)),rr(xk,Sk,"esm2020")}var vG=300,_G=Nb("authIdTokenMaxAge")||vG,Ik=null,EG=n=>async e=>{let t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>_G)return;let r=t?.token;Ik!==r&&(Ik=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function ch(n=qg()){let e=Ed(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Gk(n,{popupRedirectResolver:iO,persistence:[eO,Qk,N1]}),i=Nb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=EG(o.toString());Yk(t,s,()=>s(t.currentUser)),Kk(t,a=>s(a))}}let r=Rb("auth");return r&&zk(t,`http://${r}`),t}function bG(){return document.getElementsByTagName("head")?.[0]??document}o$({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=cr("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",bG().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yG("Browser");var f0={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var Rn=class n{constructor(e){this.platformId=e;let t=bd(f0);try{this.db=Kd(t)}catch(i){console.warn("Firestore init failed (likely SSR)",i)}if(us(this.platformId))try{this.auth=ch(t),R1(this.auth,i=>{this.user$.set(i),i?this.loadTowerDefenseMasteries(i.uid):this.masteryProfile.set(null)})}catch(i){console.warn("Auth init failed",i)}}db=null;auth=null;user$=$(null);masteryProfile=$(null);async loginWithGoogle(){if(!(!this.auth||!us(this.platformId)))try{let e=new M1;await O1(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await P1(this.auth)}async saveHighScore(e){if(this.db)try{await eh(Si(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,i){if(!this.db)return[];try{let r=Po(Si(this.db,"highscores"),Is("difficulty","==",t),Is("mapSize","==",i),lr("victory","desc"),lr("turnsPlayed","asc"),Ts(e));return(await Cs(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching scores: ",r),[]}}async getUserScores(e){if(!this.db)return[];try{let t=Po(Si(this.db,"highscores"),Is("userId","==",e),Is("victory","==",!0),lr("turnsPlayed","asc"));return(await Cs(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}async saveTowerDefenseScore(e){if(this.db)try{let t;if(e.userId)try{let r=Ss(this.db,"towerDefenseMasteries",e.userId),o=await s1(r);if(o.exists()){let s=o.data();t=s&&typeof s.totalXp=="number"?s.totalXp:0}}catch{t=void 0}let i=ce(F({},e),{userTotalXp:t,timestamp:Jd()});await eh(Si(this.db,"towerDefenseLeaderboards"),i)}catch(t){console.error("Error adding TD score: ",t)}}async getTopTowerDefenseScores(e){if(!this.db)return[];try{let t=Po(Si(this.db,"towerDefenseLeaderboards"),lr("maxWave","desc"),lr("timestamp","desc"),Ts(e));return(await Cs(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching TD scores: ",t),[]}}async loadTowerDefenseMasteries(e){if(!(!this.db||this.masteryProfile()))try{let i=Ss(this.db,"towerDefenseMasteries",e),r=await s1(i);if(r.exists()){let o=r.data(),s={totalXp:typeof o.totalXp=="number"?o.totalXp:0,usedPoints:typeof o.usedPoints=="number"?o.usedPoints:0,upgrades:o.upgrades&&typeof o.upgrades=="object"?o.upgrades:{}};this.masteryProfile.set(s)}else{let o={totalXp:0,usedPoints:0,upgrades:{}};await Wm(i,F({userId:e},o)),this.masteryProfile.set(o)}}catch(i){console.error("Error loading TD mastery profile: ",i)}}setMasteryProfile(e){this.masteryProfile.set(e)}async saveTowerDefenseMasteries(){if(!this.db)return;let e=this.user$(),t=this.masteryProfile();if(!(!e||!t))try{let i=Ss(this.db,"towerDefenseMasteries",e.uid);await Wm(i,F({userId:e.uid},t),{merge:!0})}catch(i){console.error("Error saving TD mastery profile: ",i)}}async awardTowerDefenseXp(e){if(!this.db||e<=0)return;let t=this.user$();if(t)try{let i=this.masteryProfile()??{totalXp:0,usedPoints:0,upgrades:{}},r={totalXp:i.totalXp+e,usedPoints:i.usedPoints,upgrades:i.upgrades},o=Ss(this.db,"towerDefenseMasteries",t.uid);await Wm(o,F({userId:t.uid},r),{merge:!0}),this.masteryProfile.set(r)}catch(i){console.error("Error awarding TD XP: ",i)}}static \u0275fac=function(t){return new(t||n)(Re(Ji))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var bc=class n{platformId=q(Ji);nameSignal=$("Player");constructor(){if(us(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),us(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let i=(e??"").toString().trim().slice(0,24);return i.length>0?i:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var ri=class n{constructor(e,t,i,r,o,s,a,l,c){this.combat=e;this.build=t;this.log=i;this.settings=r;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=l;this.playerName=c;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}breakpointObserver=q(Cb);screenState=J2(this.breakpointObserver.observe("(max-width: 1024px)").pipe(yt(e=>e.matches)),{initialValue:!1});unitsSignal=$([]);turnSignal=$(1);selectedUnitIdSignal=$(null);gameStatusSignal=$("playing");lastMergedUnitIdSignal=$(null);lastRemainderUnitIdSignal=$(null);resourcesSignal=$({wood:0,iron:0});forestsSignal=$([]);minesSignal=$([]);forgeSitesSignal=$([]);forgesSignal=$([]);aiForgesSignal=$([]);baseHealthSignal=$({player:100,ai:100});reservePointsSignal=$({player:0,ai:0});deployTargetsSignal=$([]);baseDeployActiveSignal=$(!1);wallsSignal=$([]);playerVisibilitySignal=$(new Set);aiVisibilitySignal=$(new Set);playerExploredSignal=$(new Set);aiExploredSignal=$(new Set);unitMoveHistorySignal=$(new Map);unitStutterBanSignal=$(new Map);lastAiMovedUnitIdSignal=$(null);aiConsecMovesSignal=$(0);buildModeSignal=$(!1);fogDebugDisabledSignal=$(!1);wallBuiltThisTurnSignal=$(!1);rulesOpenSignal=$(!1);movedThisTurnSignal=$(new Set);hoveredFormationIdSignal=$(null);aiWoodSignal=$(0);aiIronSignal=$(0);logsOpenSignal=$(!1);settingsOpenSignal=$(!1);activeSideSignal=$("ai");lastArrivedUnitIdSignal=$(null);attackerNudgeSignal=$(null);shakenUnitIdSignal=$(null);shakenWallIdSignal=$(null);pulseUnitIdSignal=$(null);screenShakeSignal=$(!1);endOverlaySignal=$(!1);endReasonSignal=$(null);combatOnlySignal=$(!0);forestMonopolySignal=$({player:0,ai:0});hoveredUnitIdSignal=$(null);autoDeployEnabledSignal=$(!1);highScoresOpenSignal=$(!1);leaderboardOpenSignal=$(!1);namePromptOpenSignal=$(!1);pendingScoreSignal=$(null);supportOpenSignal=$(!1);highScoresSignal=$({});playerConvertedThisTurnSignal=$(!1);unitQuadrantBiasSignal=$(new Map);aiUnitTimeNearBaseSignal=$(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=$(!1);wallCooldownSignal=$(new Map);aiQueuedUnitIdSignal=$(null);aiMoodSignal=$("none");rageCaptureCounterSignal=$(0);anchoredGatherersSignal=$(new Set);totalWarModeSignal=$(!1);aiInvalidActionCountSignal=$(0);aiLastRejectedActionKeySignal=$(null);sandboxSpawnPendingSignal=$(null);unitMoveOffsetSignal=$(new Map);movingUnitsSignal=$(new Set);attackingUnitsSignal=$(new Set);reclamationGoalsSignal=$(new Map);mergeIntentSignal=$(new Map);ignoreForgeUntilTurnSignal=$(new Map);playerClaimedTargetsSignal=$(new Set);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();mines=this.minesSignal.asReadonly();forges=this.forgesSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();isMobile=ti(()=>this.screenState());sandboxSpawnPending(){return this.sandboxSpawnPendingSignal()}getMoveOffsetFor(e){return this.unitMoveOffsetSignal().get(e)??null}isUnitMoving(e){return this.movingUnitsSignal().has(e)}isUnitAttacking(e){return this.attackingUnitsSignal().has(e)}getCombinedTransform(e){let t=this.attackerNudgeSignal(),i=this.getMoveOffsetFor(e),r=(t&&t.id===e?t.dx:0)+(i?i.dx:0),o=(t&&t.id===e?t.dy:0)+(i?i.dy:0);return`translate(${r}px, ${o}px)`}aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=ti(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=ti(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?this.isMobile()?4:6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?12:16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(r=>r.owner==="player"&&this.isForest(r.position.x,r.position.y)).length,i=this.unitsSignal().filter(r=>r.owner==="ai"&&this.isForest(r.position.x,r.position.y)).length;return{total:e,player:t,ai:i}}resetGame(){let e=this.settings.difficulty();this.stopAiLoops(),this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0,iron:0}),this.baseHealthSignal.set(this.settings.customMode()?{player:1e3,ai:1e3}:{player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:5,ai:5}):e==="normal"?this.reservePointsSignal.set({player:1,ai:1}):e==="hard"?this.reservePointsSignal.set({player:1,ai:3}):this.reservePointsSignal.set({player:1,ai:5}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"))),this.minesSignal.set(this.map.generateMines(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"),this.forestsSignal())),this.forgeSitesSignal.set([]),this.forgesSignal.set([]),this.aiForgesSignal.set([]);let t=new Set(this.forestsSignal().map(i=>`${i.x},${i.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(i=>i.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(r=>r.x===e.x&&r.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let i=!1,r=!1,o=null;this.unitsSignal.update(f=>{let g=[...f],w=g.findIndex(I=>I.id===e.id);if(w===-1)return f;let S=F({},g[w]),P={x:S.position.x,y:S.position.y},L=t.x-P.x,Z=t.y-P.y,ve=Math.sign(L),be=Math.sign(Z),Ce=this.combat.checkWallAlongPath(P,t,S.owner,(I,N,D,x)=>this.getWallBetween(I,N,D,x));if(Ce.hitOwn)return g;if(Ce.hitEnemy){let I=Ce.lastFrom,N=this.getWallBetween(I.x,I.y,t.x,t.y);{let x=N.maxHealth??100,R=this.combat.getWallHitAmount(S.tier),M=Math.max(0,N.health-R);this.wallsSignal.update(Le=>Le.map(pe=>pe.id===N.id?ce(F({},pe),{health:M}):pe).filter(pe=>(pe.health??pe.hitsRemaining??0)>0)),M<=0&&this.registerWallDestroyedEdge(I,t);let me=N.owner==="neutral"?"Neutral":N.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${S.tier} Unit attacked ${me} Wall. Damage: ${R}. Wall HP: ${M}/${x}.`)}this.updateWallFormations(),this.shakenWallIdSignal.set(N.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let D=g.findIndex(x=>x.id===S.id);return D!==-1&&(g[D]=ce(F({},g[D]),{hasActed:!0})),g}let Te=this.getBasePosition(S.owner==="player"?"ai":"player");if(t.x===Te.x&&t.y===Te.y)return this.baseHealthSignal.update(I=>{let N=S.owner==="player"?"ai":"player",D=F({},I);return D[N]=Math.max(0,D[N]-this.calculatePower(S)),D}),g.splice(w,1),g;let O=g.findIndex(I=>I.position.x===t.x&&I.position.y===t.y&&I.id!==S.id);if(O!==-1){let I=g[O],N={x:t.x-ve,y:t.y-be};if(this.inBounds(N.x,N.y)){if(ve!==0&&be!==0){if(this.combat.isDiagonalBlocked(N,t,(D,x,R,M)=>this.getWallBetween(D,x,R,M)))return i=!1,g}else if(this.getWallBetween(N.x,N.y,t.x,t.y))return i=!1,g}if(I.owner===S.owner)if(this.shakenUnitIdSignal.set(S.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),I.tier===S.tier){let D=I.tier,x=this.calculateTotalPoints(S)+this.calculateTotalPoints(I),R={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},M=R[D][3];if(x<=M){I.points=x;let Le=this.calculateTierAndLevel(I.points);I.tier=Le.tier,I.level=Le.level;let pe=!!(I.hasWeapon||S.hasWeapon),Ut=!!(I.hasArmor||S.hasArmor),Zt=Ut?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=pe,I.hasArmor=Ut,I.armorHp=Zt,g.splice(w,1)}else{let Le=Math.min(4,D+1),pe=R[Le][0];I.points=pe;let Ut=this.calculateTierAndLevel(I.points);I.tier=Ut.tier,I.level=Ut.level;let Zt=!!(I.hasWeapon||S.hasWeapon),Pe=!!(I.hasArmor||S.hasArmor),zt=Pe?Math.max(I.armorHp??0,S.armorHp??0):0;I.hasWeapon=Zt,I.hasArmor=Pe,I.armorHp=zt;let lt=x-pe;if(lt>0){S.points=lt;let oe=this.calculateTierAndLevel(S.points);S.tier=oe.tier,S.level=oe.level,S.hasWeapon=!1,S.hasArmor=!1,S.armorHp=0,g[w]=S,o=S.id}else g.splice(w,1)}r=!0;let me=new Map(this.mergeIntentSignal());me.delete(S.id),me.delete(I.id),this.mergeIntentSignal.set(me)}else return g;else{{let oe=t.x-P.x,se=t.y-P.y,we=Math.abs(oe)>=Math.abs(se),_e=Math.sign(we?oe:se),ye=this.wallThicknessPx+2,b=this.tileSizePx+ye,le=Math.round(b*.35),qe=we?_e*le:0,Ke=we?0:_e*le,ae=new Set(this.attackingUnitsSignal());ae.add(S.id),this.attackingUnitsSignal.set(ae),this.attackerNudgeSignal.set({id:S.id,dx:qe,dy:Ke}),setTimeout(()=>{this.attackerNudgeSignal.set({id:S.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let bt=new Set(this.attackingUnitsSignal());bt.delete(S.id),this.attackingUnitsSignal.set(bt)},200)}this.shakenUnitIdSignal.set(I.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let D=this.combat.calculateHitChance(S,I);if(Math.floor(Math.random()*100)+1>D)return this.queueCombatText("DEFLECTED!",t),this.log.addCombat(S.owner,`[Combat] DEFLECTED! T${S.tier} failed to penetrate T${I.tier}. Attacker destroyed.`,!1),g.splice(w,1),g;this.log.addCombat(S.owner,`[Combat] HIT! T${S.tier} breached T${I.tier} armor.`,!1);let R=this.calculateTotalPoints(S)+(S.hasWeapon?20:0),M=this.getAttackLuckModifier(S),me=this.calculateTotalPoints(I),Le=this.combat.getDefenseBonus(I,g),pe=Math.max(0,R+M.delta),Ut=me+Le.bonus,Zt=S.hasWeapon?"Weapon +20":"",Pe=[...Le.tags,M.tag??"",Zt].filter(Boolean).join(", ")||"None",zt=pe-Ut,lt=`[Turn ${this.turnSignal()}] ${S.owner==="player"?"Player":"AI"} T${S.tier}(L${S.level}) attacked ${I.owner==="player"?"Player":"AI"} T${I.tier}(L${I.level}). Power: ${R} vs ${me}. Modifiers: ${Pe}. Final: (${R}${M.delta!==0?M.delta>0?`+${M.delta}`:`${M.delta}`:""}${Le.bonus>0?` - ${Le.bonus}`:""}) - ${me} = ${zt}.`;if(this.log.addCombat(S.owner,lt,!!M.isCrit),pe<Ut&&this.queueCombatText("WEAK!",t),pe>Ut){let oe=this.combat.calculateHitChance(I,S),we=Math.floor(Math.random()*100)+1<=oe,_e=we?me:0;if(_e>0){let ye=this.combat.applyDamage(S,_e);S.points=ye.points,S.tier=ye.tier,S.level=ye.level,S.armorHp=ye.armorHp}we||this.log.addCombat(S.owner,`[Combat] T${S.tier} armor deflected the counter-attack from T${I.tier}. Final HP: ${S.points}`,!1),g.splice(O,1),M.tag&&this.queueCombatText(M.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(pe<Ut){let oe=pe,se=this.combat.applyDamage(I,oe),we=F({},se);return g[O]=we,g.splice(w,1),g}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),g.filter(se=>se.id!==S.id&&se.id!==I.id);{let se=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),se){let we=this.getPointsForTierLevel(S.tier,1);S.points=we;let _e=this.calculateTierAndLevel(we);S.tier=_e.tier,S.level=_e.level,g.splice(O,1),this.pulseUnitIdSignal.set(S.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let we=this.getPointsForTierLevel(I.tier,1),_e=ce(F({},I),{points:we}),ye=this.calculateTierAndLevel(we);return _e.tier=ye.tier,_e.level=ye.level,g[O]=_e,g.splice(w,1),this.pulseUnitIdSignal.set(_e.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(S.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),g}}}}}if(g.find(I=>I.id===S.id)&&o!==S.id){S.position=t,S.turnsStationary=0,S.hasActed=!0;let I=g.findIndex(Le=>Le.id===S.id);I!==-1&&(g[I]=S),S.owner==="ai"&&S.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(S.id,{x:t.x,y:t.y}),S.tier<=2&&this.anchorGatherer(S.id));let N=new Set(this.movedThisTurnSignal());N.add(S.id),this.movedThisTurnSignal.set(N),this.lastArrivedUnitIdSignal.set(S.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let D=new Map(this.unitMoveHistorySignal()),x=D.get(S.id)??[],R={x:P.x,y:P.y},M={x:t.x,y:t.y},me=[...x,R,M].slice(-4);D.set(S.id,me),this.unitMoveHistorySignal.set(D)}return g});let s=t.x-e.position.x,a=t.y-e.position.y,l=this.wallThicknessPx+2,c=this.tileSizePx+l,d={dx:-s*c,dy:-a*c};if(s!==0||a!==0){let f=new Map(this.unitMoveOffsetSignal());f.set(e.id,d),this.unitMoveOffsetSignal.set(f);let g=new Set(this.movingUnitsSignal());g.add(e.id),this.movingUnitsSignal.set(g),setTimeout(()=>{let w=new Map(this.unitMoveOffsetSignal());w.set(e.id,{dx:0,dy:0}),this.unitMoveOffsetSignal.set(w),setTimeout(()=>{let S=new Map(this.unitMoveOffsetSignal());S.delete(e.id),this.unitMoveOffsetSignal.set(S);let P=new Set(this.movingUnitsSignal());P.delete(e.id),this.movingUnitsSignal.set(P)},180)},0)}if(r){let f=this.getUnitAt(t.x,t.y);f&&(this.lastMergedUnitIdSignal.set(f.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(P=>P+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let w=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(w.length>=4&&w[0].x===w[2].x&&w[0].y===w[2].y&&w[1].x===w[3].x&&w[1].y===w[3].y&&(w[0].x!==w[1].x||w[0].y!==w[1].y)){let P=new Map(this.unitStutterBanSignal()),L=new Set([`${w[0].x},${w[0].y}`,`${w[1].x},${w[1].y}`]);P.set(e.id,{tiles:L,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(P);let Z={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},be=(this.getQuadrant(e.position,Z)+2)%4,Ce=new Map(this.unitQuadrantBiasSignal());Ce.set(e.id,{quadrant:be,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(Ce)}}let h=this.selectedUnitIdSignal();h&&!this.unitsSignal().some(f=>f.id===h)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility(),e.owner==="player"&&this.selectNextAvailableUnit()}selectNextAvailableUnit(){let t=this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((i,r)=>{let o=this.isForest(i.position.x,i.position.y)||this.isMine(i.position.x,i.position.y)?1:0,s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0;return o!==s?o-s:0}),this.selectUnit(t[0].id)}selectNextAvailableUnitTab(){let t=this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((r,o)=>{let s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0,a=this.isForest(o.position.x,o.position.y)||this.isMine(o.position.x,o.position.y)?1:0;return s!==a?s-a:r.id.localeCompare(o.id)});let i=this.selectedUnitId();if(!i)this.selectUnit(t[0].id);else{let r=t.findIndex(o=>o.id===i);if(r===-1)this.selectUnit(t[0].id);else{let o=(r+1)%t.length;this.selectUnit(t[o].id)}}}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}effectiveAttack(e){return this.calculateTotalPoints(e)+(e.hasWeapon?20:0)}effectiveDefense(e){return(e.points??0)+(e.armorHp??0)}computeSideEffectivePower(e){let t=this.unitsSignal().filter(r=>r.owner===e),i=0;for(let r of t)i+=this.effectiveAttack(r);return i}getWood(e){return e==="ai"?this.aiWoodSignal():this.resourcesSignal().wood}getIron(e){return e==="ai"?this.aiIronSignal():this.resourcesSignal().iron}getForges(e){return e==="ai"?this.aiForgesSignal():this.forgesSignal()}buyArmorGeneric(e,t){e==="ai"?this.aiBuyArmor(t):this.buyArmor(t)}buyWeaponGeneric(e,t){e==="ai"?this.aiBuyWeapon(t):this.buyWeapon(t)}isUnitInDanger(e){let t=this.getNeighbors(e.position);for(let i of t){let r=this.getUnitAt(i.x,i.y);if(r&&r.owner!==e.owner){let o=this.effectiveAttack(r),s=this.effectiveDefense(e),a=e.hasWeapon?e.tier>=3?20:10:0;if(o>s+a)return!0}}return!1}findSafeMove(e,t){let i=this.getBasePosition("ai");return t.length===0?null:t.reduce((r,o)=>{let s=Math.abs(o.x-i.x)+Math.abs(o.y-i.y),a=Math.abs(r.x-i.x)+Math.abs(r.y-i.y);return s<a?o:r},t[0])}findResourceTarget(e,t){let i=this.forestsSignal(),r=this.minesSignal(),o=this.turnSignal()<=20,s=i.filter(w=>{let S=`${w.x},${w.y}`;if(t.claimedTargets.has(S))return!1;let P=this.getUnitAt(w.x,w.y);return!(P&&P.owner==="ai")}),a=r.filter(w=>{let S=`${w.x},${w.y}`;if(t.claimedTargets.has(S))return!1;let P=this.getUnitAt(w.x,w.y);return!(P&&P.owner==="ai")}),l=s.filter(w=>!this.getUnitAt(w.x,w.y)),c=a.filter(w=>!this.getUnitAt(w.x,w.y));if(o){if(l.length>0)return l.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-L}),l[0];if(c.length>0)return c.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-L}),c[0]}else{let w=[...l,...c];if(w.length>0)return w.sort((S,P)=>{let L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),Z=Math.abs(P.x-e.position.x)+Math.abs(P.y-e.position.y);return L-Z}),w[0]}let d=s.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&S.owner==="player"}),f=a.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&S.owner==="player"}).filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&e.tier>=S.tier}),g=d.filter(w=>{let S=this.getUnitAt(w.x,w.y);return S&&e.tier>=S.tier});if(o){if(g.length>0)return g.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-L}),g[0];if(f.length>0)return f.sort((w,S)=>{let P=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return P-L}),f[0]}else{let w=[...g,...f];if(w.length>0)return w.sort((S,P)=>{let L=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),Z=Math.abs(P.x-e.position.x)+Math.abs(P.y-e.position.y);return L-Z}),w[0]}return d.length>0?(d.sort((w,S)=>{let P=this.getUnitAt(w.x,w.y),L=this.getUnitAt(S.x,S.y),Z=P?P.tier:99,ve=L?L.tier:99;if(Z!==ve)return Z-ve;let be=Math.abs(w.x-e.position.x)+Math.abs(w.y-e.position.y),Ce=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y);return be-Ce}),d[0]):null}findDefensiveWallTarget(e){let t=this.getNeighbors(e.position),r=this.unitsSignal().filter(c=>c.owner==="player").filter(c=>Math.abs(c.position.x-e.position.x)+Math.abs(c.position.y-e.position.y)<=5);if(r.length===0)return null;let o=0,s=0;r.forEach(c=>{o+=c.position.x,s+=c.position.y}),o/=r.length,s/=r.length;let a=null,l=-1/0;for(let c of t){if(this.getWallBetween(e.position.x,e.position.y,c.x,c.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(c)||this.isEdgeOnCooldown(e.position,c))continue;let d=c.x-e.position.x,h=c.y-e.position.y,f=o-e.position.x,g=s-e.position.y,w=d*f+h*g;w>l&&(l=w,a=c)}return l>0?a:null}findBlockingWall(e,t){let i=this.bfsPath(e,t,{respectWalls:!1});if(!i||i.length<2)return null;for(let r=0;r<i.length-1;r++){let o=i[r],s=i[r+1],a=this.getWallBetween(o.x,o.y,s.x,s.y);if(a)return{pos:s,wall:a}}return null}findDefensiveWallTargetForOwner(e,t){let i=this.getNeighbors(e.position),r=t==="player"?"ai":"player",s=this.unitsSignal().filter(h=>h.owner===r).filter(h=>Math.abs(h.position.x-e.position.x)+Math.abs(h.position.y-e.position.y)<=5);if(s.length===0)return null;let a=0,l=0;s.forEach(h=>{a+=h.position.x,l+=h.position.y}),a/=s.length,l/=s.length;let c=null,d=-1/0;for(let h of i){if(this.getWallBetween(e.position.x,e.position.y,h.x,h.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(h)||this.isEdgeOnCooldown(e.position,h))continue;let f=h.x-e.position.x,g=h.y-e.position.y,w=a-e.position.x,S=l-e.position.y,P=f*w+g*S;P>d&&(d=P,c=h)}return d>0?c:null}getNextStepTowards(e,t,i,r){if(i.length===0)return null;let o=l=>{let c=Math.abs(l.x-t.x)+Math.abs(l.y-t.y);if(r?.noCohesion&&!r?.antiClump&&!r?.fogBonus)return c*10;let h=this.getNeighbors(l).filter(g=>{let w=this.getUnitAt(g.x,g.y);return w&&w.owner===e.owner}).length,f=c*10;return r?.antiClump?f+=h*3:r?.noCohesion||(f-=h*2),r?.fogBonus&&!this.isVisibleToPlayer(l.x,l.y)&&e.owner==="player"&&(f-=3),f},s=null,a=1/0;for(let l of i){let c=o(l);c<a&&(a=c,s=l)}return s}findPlayerResourceTarget(e){let t=this.turnSignal(),i=this.forestsSignal(),r=this.minesSignal(),o=this.playerClaimedTargetsSignal(),s=g=>`${g.x},${g.y}`,a=g=>!this.getUnitAt(g.x,g.y),l=g=>{let w=this.getUnitAt(g.x,g.y);return!!(w&&w.owner==="player")},c=i.filter(g=>!o.has(s(g))),d=r.filter(g=>!o.has(s(g))),h=(g,w)=>{let S=Math.abs(g.x-e.position.x)+Math.abs(g.y-e.position.y),P=l(g)?100:0,L=t<=15&&w==="forest"?-5:0;return S*10+P+(a(g)?0:20)+L},f=[...c.map(g=>({p:g,t:"forest",s:h(g,"forest")})),...d.map(g=>({p:g,t:"mine",s:h(g,"mine")}))];return f.length===0?null:(f.sort((g,w)=>g.s-w.s),f[0].p)}findCombatTarget(e,t,i){let r=t.priorityTargets.find(c=>Math.max(Math.abs(c.position.x-e.position.x),Math.abs(c.position.y-e.position.y))<=5);if(r&&!this.bfsPath(e.position,r.position,{respectWalls:!0})){let d=this.findBlockingWall(e.position,r.position);if(d)return this.appendLog(`[Obstacle Smash] T${e.tier} targeting wall at (${d.pos.x},${d.pos.y}) blocking path to high-value target`),d.pos}let o=t.priorityTargets.filter(c=>i.some(d=>d.x===c.position.x&&d.y===c.position.y));if(o.length>0){let c=o.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),c[0].position):(o.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),o[0].position)}let s=this.getNeighbors(e.position),a=[];for(let c of s){let d=this.getWallBetween(e.position.x,e.position.y,c.x,c.y);if(!d||d.owner===e.owner)continue;let h=d.maxHealth??100,f=100-(h-100);h>200&&!e.hasWeapon&&(f-=150),e.hasWeapon&&(f+=40),(d.formationSize??1)<=2&&(f+=30),a.push({pos:c,score:f})}if(a.length>0)return a.sort((c,d)=>d.score-c.score),a[0].pos;let l=i.map(c=>{let d=this.getUnitAt(c.x,c.y);return!d||d.owner===e.owner?null:{pos:c,enemy:d}}).filter(Boolean);if(l.length>0){let c=l.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d.enemy));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),c[0].pos):(l.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),l[0].pos)}return null}findFallbackMove(e,t,i){if(t.length===0)return null;let r=Math.abs(e.position.x-i.x)+Math.abs(e.position.y-i.y),o=null,s=1/0;for(let a of t){let l=Math.abs(a.x-i.x)+Math.abs(a.y-i.y);l<s&&(s=l,o=a)}if(!o)return null;if(s>r){let a=this.isUnitInDanger(e),l=!1;if(a&&(l=this.getNeighbors(e.position).some(d=>{let h=this.getUnitAt(d.x,d.y);return!h||h.owner===e.owner?!1:this.effectiveAttack(h)>this.effectiveDefense(e)})),!l)return null}return o}isTileThreatenedByEnemy(e,t){let i=this.getNeighbors(t);for(let r of i){let o=this.getUnitAt(r.x,r.y);if(o&&o.owner!==e.owner&&this.effectiveAttack(o)>=this.effectiveDefense(e))return!0}return!1}getMergePartnerForUnit(e,t){let r=this.reclamationGoalsSignal().get(e.id);if(r&&r.type==="merge"){let c=this.getUnitAt(r.target.x,r.target.y);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let s=this.mergeIntentSignal().get(e.id);if(s){let c=this.unitsSignal().find(d=>d.id===s);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let a=this.unitsSignal().find(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y)&&t.some(d=>d.x===c.position.x&&d.y===c.position.y));if(a)return a;let l=this.unitsSignal().filter(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y));for(let c of l){let d=this.getNextStepTowards(e,c.position,t);if(!d)continue;let h=this.calculateValidMoves(c),f=this.getNextStepTowards(c,e.position,h);if(!f)continue;let g=Math.abs(e.position.x-c.position.x)+Math.abs(e.position.y-c.position.y);if(Math.abs(d.x-f.x)+Math.abs(d.y-f.y)<g)return c}return null}computeHighestTierNeedingUpgrade(){let e=this.unitsSignal().filter(t=>t.owner==="ai"&&t.tier>=2&&(!t.hasArmor||!t.hasWeapon));return e.length===0?0:e.reduce((t,i)=>Math.max(t,i.tier),0)}getNeighbors(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}].filter(t=>this.inBounds(t.x,t.y))}bfsPath(e,t,i){let r=[{pos:e,path:[e]}],o=new Set;o.add(`${e.x},${e.y}`);let s=0;for(;r.length>0&&s<500;){s++;let a=r.shift();if(a.pos.x===t.x&&a.pos.y===t.y)return a.path;let l=this.getNeighbors(a.pos);for(let c of l){let d=`${c.x},${c.y}`;if(!o.has(d)){if(i?.avoidFriendlyUnits){let h=this.getUnitAt(c.x,c.y);if(h&&h.owner==="ai")continue}if(i?.respectWalls&&this.getWallBetween(a.pos.x,a.pos.y,c.x,c.y))continue;o.add(d),r.push({pos:c,path:[...a.path,c]})}}}return null}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=$([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){if(this.settings.customMode()&&this.endReasonSignal()!=="Debug Victory"&&e==="Jaerbi")return;this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let i=this.firebase.user$(),r=ce(F({},t),{playerName:this.playerName.name(),userId:i?.uid,userPhoto:i?.photoURL??void 0});this.firebase.saveHighScore(r),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}aiIron(){return this.aiIronSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;return r?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let i=this.calculateTotalPoints(t),r=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,i-r),atkMax:i+r+(t.hasWeapon?20:0),hp:t.points,support:o}}isUnitHovered(e){return this.hoveredUnitIdSignal()===e}getHitChanceInfo(e){let t=this.selectedUnit();if(!t)return null;let i=this.unitsSignal().find(l=>l.id===e);if(!i||t.owner!=="player"||i.owner===t.owner||!this.isVisibleToPlayer(i.position.x,i.position.y)||!this.validMoves().some(l=>l.x===i.position.x&&l.y===i.position.y))return null;let o=this.combat.calculateHitChance(t,i),s="bg-green-600";o<50?s="bg-red-600":o<100&&(s="bg-amber-600");let a=o<10;return{chance:o,bg:s,icon:a?"\u2620\uFE0F":"\u2694\uFE0F",skull:a}}shouldRenderWall(e,t,i){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return r?(i??r.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}hoverFormationById(e){this.hoveredFormationIdSignal.set(e??null)}isFormationHovered(e){return e?this.hoveredFormationIdSignal()===e:!1}getFormationInfo(e){let t=e??null;if(!t)return null;let i=this.wallsSignal().find(r=>r.formationId===t);return i?{size:i.formationSize??1,bonus:i.bonusHp??0}:null}updateWallFormations(){let e=this.wallsSignal();if(e.length===0)return;let t=new Map,i=new Map;for(let l of e){t.set(l.id,l);let c=`${l.tile1.x},${l.tile1.y}`,d=`${l.tile2.x},${l.tile2.y}`,h=i.get(c)??[];h.push(l.id),i.set(c,h);let f=i.get(d)??[];f.push(l.id),i.set(d,f)}let r=new Set,o=[];for(let l of e){if(r.has(l.id))continue;if(l.owner==="neutral"){o.push([l.id]),r.add(l.id);continue}let c=[l.id];r.add(l.id);let d=[],h=l.owner;for(;c.length>0;){let f=c.shift();d.push(f);let g=t.get(f),w=[`${g.tile1.x},${g.tile1.y}`,`${g.tile2.x},${g.tile2.y}`];for(let S of w){let P=i.get(S)??[];for(let L of P)r.has(L)||t.get(L).owner===h&&(r.add(L),c.push(L))}}o.push(d)}let s=e.map(l=>F({},l)),a=new Map;for(let l=0;l<s.length;l++)a.set(s[l].id,l);for(let l of o){let d=t.get(l[0]).owner==="neutral",h=d?1:l.length,f=d?0:Math.max(0,h*20),g=100+f,w=d?null:l[0];for(let S of l){let P=a.get(S),L=s[P],Z=L.maxHealth??100,ve=g-Z,be=L.health;ve>0?be=L.health+ve:ve<0&&(be=Math.min(L.health,g)),be=Math.max(0,Math.min(g,be)),s[P]=ce(F({},L),{formationId:w??void 0,formationSize:h,maxHealth:g,bonusHp:f,health:be})}}this.wallsSignal.set(s)}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(i=>i.position.x===e&&i.position.y===t).map(i=>({id:i.id,text:i.text,opacity:i.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let i=this.unitsSignal().find(d=>d.id===e);if(!i)return"";let r=this.combat.getPointsForTierLevel(i.tier,4),o=t.support>0?`+${t.support}`:"+0",s=i.hasWeapon?" | Weapon:+20":"",a=i.armorHp??0,l=i.hasArmor?` | Armor:${a}`:"",c=a>0?`${t.hp} + ${a}`:`${t.hp}`;return`Unit T${i.tier} | HP: ${c}/${r} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}${s}${l}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.endReasonSignal.set("Debug Victory"),this.endOverlaySignal.set(!0);let t=this.getForestControl().player,r={playerName:this.playerName.name(),turnsPlayed:this.turnSignal(),forestsCaptured:t,victoryType:"Annihilation",timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:!0};this.pendingScoreSignal.set(r),this.namePromptOpenSignal.set(!0)}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],i=e.indexOf(this.settings.difficulty()),r=t.indexOf(this.settings.mapSize());i++,i>=e.length&&(i=0,r++,r>=t.length&&(r=0)),this.settings.setDifficulty(e[i]),this.settings.setMapSize(t[r]),this.resetGame()}recordHighScore(e,t){if(this.settings.customMode()){this.endReasonSignal.set("Match Finished (Custom Mode)");return}let i=`${this.settings.difficulty()}|${this.settings.mapSize()}`,r=F({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=r[i]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((h,f)=>h.turns-f.turns).slice(0,3):s.losses=[...s.losses,o].sort((h,f)=>h.turns-f.turns).slice(0,3),r[i]=s,this.highScoresSignal.set(r),this.persistHighScores();let a=this.getForestControl(),l=e==="player wins"?a.player:a.ai,c=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:l,victoryType:c,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"&&(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0))}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let i=crypto.randomUUID(),r={id:i,text:e,position:F({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),r]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===i?ce(F({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==i))},2e3)}calculateValidMoves(e){let t=[],i=e.position,r=c=>c.x>=0&&c.x<this.gridSize&&c.y>=0&&c.y<this.gridSize,o=(c,d)=>{if(!r(d))return"blocked";if(c.x===d.x||c.y===d.y){if(this.getWallBetween(c.x,c.y,d.x,d.y))return"blocked"}else if(this.isDiagonalBlocked(c,d))return"blocked";let h=this.getUnitAt(d.x,d.y);return h?h.owner===e.owner?"ally":"enemy":"empty"},s=(c,d)=>{(d==="empty"||d==="enemy"||this.getUnitAt(c.x,c.y)?.tier===e.tier)&&t.push(c)},a=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],l=[{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}];if(e.tier===1){for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);h!=="blocked"&&s(d,h)}return t}for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===3&&h==="empty"){let f={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,f);g!=="blocked"&&s(f,g)}}for(let c of l){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===4&&h==="empty"){let f={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,f);if(g!=="blocked"&&(s(f,g),g==="empty")){let w={x:i.x+c.x*3,y:i.y+c.y*3},S=o(f,w);S!=="blocked"&&s(w,S)}}}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),l=this.isForest(s.position.x,s.position.y),c=this.isMine(s.position.x,s.position.y),d=l?a?1:(s.forestOccupationTurns??0)+1:0,h=c?a?1:(s.mineOccupationTurns??0)+1:0,f=l?d>=3:!1;return ce(F({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:d,mineOccupationTurns:h,productionActive:f})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let i=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(a=>a.owner===e&&this.isForest(a.position.x,a.position.y)&&(a.productionActive??!1)).length,s=this.unitsSignal().filter(a=>a.owner===e&&this.isMine(a.position.x,a.position.y)&&(a.mineOccupationTurns??0)>=5).length;if(o>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood+o*i(this.settings.difficulty()),iron:a.iron})):this.aiWoodSignal.update(a=>a+o*i(this.settings.difficulty()))),s>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood,iron:a.iron+s*2})):this.aiIronSignal.update(a=>a+s*2)),e==="player"){let a=this.forgeSitesSignal().map(h=>F({},h));for(let h of a)h.turnsLeft=Math.max(0,h.turnsLeft-1);let l=a.filter(h=>h.turnsLeft===0),c=l.map(h=>h.position),d=a.filter(h=>h.turnsLeft>0);if(c.length>0){this.forgesSignal.update(f=>[...f,...c]);let h=l.filter(f=>f.owner==="ai").map(f=>f.position);if(h.length>0){this.aiForgesSignal.update(f=>[...f,...h]);for(let f of h)this.appendLog(`[AI] Forge completed at (${f.x},${f.y}).`)}}this.forgeSitesSignal.set(d)}}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let r=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(r),this.startSideTurn(r),r==="ai"&&this.gameStatus()==="playing"&&(this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10))}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}pauseGame(){this.stopAiLoops()}aiTurnTimeout=null;stopAiLoops(){this.aiTurnTimeout&&(clearTimeout(this.aiTurnTimeout),this.aiTurnTimeout=null),this.isAiThinking=!1}startSideTurn(e){this.unitsSignal.update(t=>t.map(i=>i.owner===e?ce(F({},i),{hasActed:!1}):i)),e==="player"&&(this.selectNextAvailableUnit(),this.playerClaimedTargetsSignal.set(new Set))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;if(r){let s=F({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=F({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai"),t=this.forestsSignal().length+this.minesSignal().length,i=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y))),r=t>0?i.length/t:0;if(r>.5){let D=new Map,x=this.unitsSignal().filter(me=>me.owner==="ai"&&!me.hasActed),R=new Set,M=i.slice().sort((me,Le)=>Le.tier-me.tier);for(let me of M){let Le=Math.min(4,me.tier+1),pe=x.filter(Pe=>Pe.tier===Le&&!R.has(Pe.id)).sort((Pe,zt)=>{let lt=Math.max(Math.abs(Pe.position.x-me.position.x),Math.abs(Pe.position.y-me.position.y)),oe=Math.max(Math.abs(zt.position.x-me.position.x),Math.abs(zt.position.y-me.position.y));return lt-oe});if(pe.length>0){let Pe=pe[0];D.set(Pe.id,{target:F({},me.position),type:"hunt"}),R.add(Pe.id);continue}let Ut=x.filter(Pe=>Pe.tier===me.tier&&!R.has(Pe.id)),Zt=!1;for(let Pe of Ut){let zt=this.calculateValidMoves(Pe),lt=this.unitsSignal().find(oe=>oe.owner==="ai"&&oe.tier===Pe.tier&&(oe.position.x!==Pe.position.x||oe.position.y!==Pe.position.y)&&zt.some(se=>se.x===oe.position.x&&se.y===oe.position.y));if(lt){D.set(Pe.id,{target:F({},lt.position),type:"merge"}),R.add(Pe.id),Zt=!0;break}}Zt||this.aiSpawnTier(Le,1,new Set)}this.reclamationGoalsSignal.set(D),this.appendLog(`[AI Mode] Reclamation active. Player controls ${(r*100).toFixed(0)}% of resources.`)}else this.reclamationGoalsSignal.set(new Map);let a=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)).length>3;{let D=0,x=50,M=this.baseHealthSignal().ai<50?20:70;for(;this.aiWoodSignal()>M;){if(D++,D>x){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let D=this.forestsSignal().length,x=this.unitsSignal().filter(lt=>lt.owner==="ai"&&this.isForest(lt.position.x,lt.position.y)).length,R=this.unitsSignal().filter(lt=>lt.owner==="player"&&this.isForest(lt.position.x,lt.position.y)).length,M=this.settings.difficulty(),me=D>0?R/D:0,Le="none";R<=x?Le="none":me>=.9||R>=9?Le="rage":R>=x+(M==="baby"?4:M==="normal"?3:M==="hard"?2:1)?Le="angry":Le="none",this.aiMoodSignal.set(Le);let pe=this.turnSignal()%2===0,Ut=this.turnSignal()%5===0,Zt=D>0?x/D:0,Pe=this.totalWarModeSignal(),zt=Zt>=.65;if(!Pe&&zt)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(zt),Le==="rage"){let lt=M==="baby"?pe?1:2:M==="normal"?pe?3:2:M==="hard"?pe?4:3:4;this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+lt}))}else if(Le==="angry"){if(M==="baby")Ut&&this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+1}));else if(pe){let lt=M==="normal"?pe?1:0:M==="hard"?Ut?2:1:2;this.reservePointsSignal.update(oe=>({player:oe.player,ai:oe.ai+lt}))}}}catch{}if(this.manageInfrastructure(),this.turnSignal()<=10){let D=0,x=this.getPointsForTierLevel(1,1);for(;this.reservePointsSignal().ai>=x&&D<2&&this.aiSpawnTier(1,1,new Set)!==0;)D++,await new Promise(M=>setTimeout(M,60))}await new Promise(D=>setTimeout(D,100));let l=this.unitsSignal().filter(D=>D.owner==="ai"),c=new Map(this.aiUnitTimeNearBaseSignal()),d=new Set(l.map(D=>D.id));for(let D of c.keys())d.has(D)||c.delete(D);for(let D of l)Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3?c.set(D.id,(c.get(D.id)||0)+1):c.set(D.id,0);this.aiUnitTimeNearBaseSignal.set(c);for(let D of l){let x=this.isForest(D.position.x,D.position.y);D.owner==="ai"&&x&&D.tier<=2&&this.anchorGatherer(D.id)}let h=this.unitsSignal().filter(D=>D.owner==="player"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,f=this.unitsSignal().filter(D=>D.owner==="ai"&&this.isForest(D.position.x,D.position.y)&&(D.productionActive??!1)).length*2,g=h>=f;this.aggressionModeSignal.set(g);let P=this.forestsSignal().filter(D=>!this.getUnitAt(D.x,D.y)).filter(D=>this.isVisibleToAi(D.x,D.y)),L=this.unitsSignal().filter(D=>D.owner==="ai");if(this.turnSignal()<=15){let D=this.aiQueuedUnitIdSignal(),x=D?L.find(M=>M.id===D):null;if(!(x&&!this.isForest(x.position.x,x.position.y)&&P.length>0)){let M=L.filter(Le=>Le.tier<=2&&!this.isForest(Le.position.x,Le.position.y)),me=M.length>0&&P.length>0?M.reduce((Le,pe)=>{let Ut=Math.min(...P.map(Pe=>Math.abs(pe.position.x-Pe.x)+Math.abs(pe.position.y-Pe.y))),Zt=Math.min(...P.map(Pe=>Math.abs(Le.position.x-Pe.x)+Math.abs(Le.position.y-Pe.y)));return Ut<Zt?pe:Le},M[0]):null;this.aiQueuedUnitIdSignal.set(me?me.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let D=this.getPointsForTierLevel(3,1),x=this.forestsSignal().length,R=this.unitsSignal().filter(Le=>Le.owner==="ai"&&this.isForest(Le.position.x,Le.position.y)).length,M=x>0?R/x:0;this.reservePointsSignal().ai>=D&&M<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let Z=this.unitsSignal().filter(D=>D.owner==="player"&&Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=3&&D.tier>=2);if(Z.length>0){let D=Z.reduce((x,R)=>this.calculateTotalPoints(R)>this.calculateTotalPoints(x)?R:x,Z[0]);this.aiDefenseSpawn(D)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let D=this.aiStrategy.getWallBuildActions(this);for(let x of D){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(x.from,x.to)}}else this.tryDefensiveWallsNearForests();let ve=0,be=10;for(;ve<be&&this.executeOneFreeAction();)ve++,await new Promise(x=>setTimeout(x,100));this.aiQueuedUnitIdSignal.set(null);let Ce=this.getBasePosition("player"),Te=this.unitsSignal().filter(D=>D.owner==="player"&&(this.isForest(D.position.x,D.position.y)||this.isMine(D.position.x,D.position.y)||this.isForge(D.position.x,D.position.y)||Math.max(Math.abs(D.position.x-e.x),Math.abs(D.position.y-e.y))<=4)),O={claimedTargets:new Set,priorityTargets:Te},N=this.unitsSignal().filter(D=>D.owner==="ai"&&!D.hasActed).sort((D,x)=>x.tier-D.tier);for(let D of N){let x=this.unitsSignal().find(oe=>oe.id===D.id);if(!x||x.hasActed)continue;let R=null,me=this.calculateValidMoves(x).filter(oe=>!O.claimedTargets.has(`${oe.x},${oe.y}`)),Le=Math.max(Math.abs(x.position.x-e.x),Math.abs(x.position.y-e.y)),pe=this.unitsSignal().filter(oe=>oe.owner==="player"&&Math.max(Math.abs(oe.position.x-e.x),Math.abs(oe.position.y-e.y))<=3);if(pe.length>0&&!this.isForest(x.position.x,x.position.y)&&Le<=6){let oe=pe.reduce((we,_e)=>{let ye=Math.max(Math.abs(we.position.x-e.x),Math.abs(we.position.y-e.y));return Math.max(Math.abs(_e.position.x-e.x),Math.abs(_e.position.y-e.y))<ye?_e:we});if(me.some(we=>we.x===oe.position.x&&we.y===oe.position.y))R={type:"attack",target:oe.position,reason:"Base Defense: Eliminate Threat"};else{let we=this.getNextStepTowards(x,oe.position,me);we&&(R={type:"move",target:we,reason:"Base Defense: Intercept"})}}if(!R){let oe=this.reclamationGoalsSignal().get(x.id);if(oe){let se=oe.target,we=this.getUnitAt(se.x,se.y);if(we&&we.owner!==x.owner)if(me.some(ye=>ye.x===se.x&&ye.y===se.y))R={type:"attack",target:se,reason:"Reclaim: Attack Occupier"};else{let ye=this.bfsPath(x.position,se,{respectWalls:!0,avoidFriendlyUnits:!0});if(ye||(ye=this.bfsPath(x.position,se,{avoidFriendlyUnits:!0})),ye&&ye.length>1){let b=ye[1],le=this.getWallBetween(x.position.x,x.position.y,b.x,b.y),qe=this.getUnitAt(b.x,b.y);if(qe&&qe.owner!==x.owner){let Ke=this.effectiveAttack(qe)>this.effectiveDefense(x),ae=me.some(bt=>bt.x===b.x&&bt.y===b.y);if(Ke&&ae)R={type:"attack",target:b,reason:"Reclaim: Engage Blocker"};else if(le)R={type:"wall_attack",target:b,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(x,b)){let bt=me.filter(oi=>{let Ps=Math.abs(oi.x-se.x)+Math.abs(oi.y-se.y),mh=Math.abs(b.x-se.x)+Math.abs(b.y-se.y);return Ps<=mh&&!this.isTileThreatenedByEnemy(x,oi)}),Ii=bt.length>0?this.getNextStepTowards(x,se,bt):null;R=Ii?{type:"move",target:Ii,reason:"Reclaim: Bypass Threat"}:{type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else if(le)R={type:"wall_attack",target:b,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(x,b)){let Ke=me.filter(bt=>{let Ii=Math.abs(bt.x-se.x)+Math.abs(bt.y-se.y),oi=Math.abs(b.x-se.x)+Math.abs(b.y-se.y);return Ii<=oi&&!this.isTileThreatenedByEnemy(x,bt)}),ae=Ke.length>0?this.getNextStepTowards(x,se,Ke):null;R=ae?{type:"move",target:ae,reason:"Reclaim: Bypass Threat"}:{type:"move",target:b,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:b,reason:"Reclaim: Pursue Resource"}}}else if(oe.type==="merge")if(me.some(ye=>ye.x===se.x&&ye.y===se.y))R={type:"move",target:se,reason:"Reclaim: Merge to Counter"};else{let ye=this.getNextStepTowards(x,se,me);ye&&(R=this.getWallBetween(x.position.x,x.position.y,ye.x,ye.y)?{type:"wall_attack",target:ye,reason:"Reclaim: Breach to Merge"}:{type:"move",target:ye,reason:"Reclaim: Approach Ally"})}else{let _e=this.getNextStepTowards(x,se,me);if(_e){let ye=this.getWallBetween(x.position.x,x.position.y,_e.x,_e.y),b=this.getUnitAt(_e.x,_e.y);if(b&&b.owner!==x.owner){let le=this.effectiveAttack(b)>this.effectiveDefense(x),qe=me.some(Ke=>Ke.x===_e.x&&Ke.y===_e.y);if(le&&qe)R={type:"attack",target:_e,reason:"Reclaim: Engage Blocker"};else if(ye)R={type:"wall_attack",target:_e,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(x,_e)){let Ke=me.filter(bt=>{let Ii=Math.abs(bt.x-se.x)+Math.abs(bt.y-se.y),oi=Math.abs(_e.x-se.x)+Math.abs(_e.y-se.y);return Ii<=oi&&!this.isTileThreatenedByEnemy(x,bt)}),ae=Ke.length>0?this.getNextStepTowards(x,se,Ke):null;R=ae?{type:"move",target:ae,reason:"Reclaim: Bypass Threat"}:{type:"move",target:_e,reason:"Reclaim: Close Distance"}}else R={type:"move",target:_e,reason:"Reclaim: Close Distance"}}else if(ye)R={type:"wall_attack",target:_e,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(x,_e)){let le=me.filter(Ke=>{let ae=Math.abs(Ke.x-se.x)+Math.abs(Ke.y-se.y),bt=Math.abs(_e.x-se.x)+Math.abs(_e.y-se.y);return ae<=bt&&!this.isTileThreatenedByEnemy(x,Ke)}),qe=le.length>0?this.getNextStepTowards(x,se,le):null;R=qe?{type:"move",target:qe,reason:"Reclaim: Bypass Threat"}:{type:"move",target:_e,reason:"Reclaim: Close Distance"}}else R={type:"move",target:_e,reason:"Reclaim: Close Distance"}}}}}if(this.isForest(x.position.x,x.position.y)){let oe=this.calculateValidMoves(x),se=this.findCombatTarget(x,O,oe);if(se)R={type:"attack",target:se,reason:"Defense: Defend Forest"};else{if(this.aiWoodSignal()>=50){let we=this.findDefensiveWallTarget(x);we&&(R={type:"build_wall",target:we,reason:"Defense: Fortify Position"})}if(!R&&!this.isUnitInDanger(x)){this.unitsSignal.update(_e=>_e.map(ye=>ye.id===x.id?ce(F({},ye),{hasActed:!0}):ye));continue}}}if(!R&&this.isMine(x.position.x,x.position.y)){let oe=this.calculateValidMoves(x),se=this.findCombatTarget(x,O,oe);if(se)R={type:"attack",target:se,reason:"Defense: Defend Mine"};else if(!this.isUnitInDanger(x)){this.unitsSignal.update(_e=>_e.map(ye=>ye.id===x.id?ce(F({},ye),{hasActed:!0}):ye));continue}}let Ut=this.forestsSignal().length,Zt=this.unitsSignal().filter(oe=>oe.owner==="ai"&&this.isForest(oe.position.x,oe.position.y)).length,Pe=Ut>0?Zt/Ut:0,zt=x.tier>=3||Pe>=.7,lt=Math.max(Math.abs(x.position.x-Ce.x),Math.abs(x.position.y-Ce.y));if(!R&&lt<4){if(zt&&lt<=3){let oe=[];me.some(le=>le.x===Ce.x&&le.y===Ce.y)&&oe.push({type:"attack",target:Ce,weight:1,reason:"Siege: Strike Base"});let we=this.getNeighbors(x.position),_e=lt,ye=!1;for(let le of we)this.getWallBetween(x.position.x,x.position.y,le.x,le.y)&&Math.max(Math.abs(le.x-Ce.x),Math.abs(le.y-Ce.y))<_e&&(oe.push({type:"wall_attack",target:le,weight:.9,reason:"Siege: Breach (Path to Base)"}),ye=!0);let b=this.getNextStepTowards(x,Ce,me,{noCohesion:!0});if(b){let le=Math.max(Math.abs(b.x-Ce.x),Math.abs(b.y-Ce.y));(!ye||le<_e)&&oe.push({type:"move",target:b,weight:.5,reason:"Siege: Advance on Base"})}if(oe.length>0){oe.sort((qe,Ke)=>Ke.weight-qe.weight);let le=oe[0];R={type:le.type,target:le.target,reason:le.reason},le.type==="move"&&ye&&this.appendLog(`[AI Debug] Unit at (${x.position.x},${x.position.y}) chose Move over Wall Attack. Weights: wall=0.9, move=${le.weight}`)}}if(!R)if(me.some(se=>se.x===Ce.x&&se.y===Ce.y))R={type:"attack",target:Ce,reason:"Siege: Strike Base"};else{let se=this.getNextStepTowards(x,Ce,me,{noCohesion:!0});if(se)this.getWallBetween(x.position.x,x.position.y,se.x,se.y)?R={type:"wall_attack",target:se,reason:"Siege: Breach"}:R={type:"move",target:se,reason:"Siege: Advance on Base"};else{let we=this.bfsPath(x.position,Ce);if(we&&we.length>1){let _e=we[1];this.getWallBetween(x.position.x,x.position.y,_e.x,_e.y)&&(R={type:"wall_attack",target:_e,reason:"Siege: Breaching"})}}}}if(!R){let oe=this.aiForgesSignal(),se=this.unitsSignal().filter(_e=>_e.owner==="player"),we=[];for(let _e of oe)for(let ye of se)Math.max(Math.abs(ye.position.x-_e.x),Math.abs(ye.position.y-_e.y))<=3&&we.push(ye);if(we.length>0){let _e=we.reduce((b,le)=>{let qe=Math.abs(b.position.x-x.position.x)+Math.abs(b.position.y-x.position.y);return Math.abs(le.position.x-x.position.x)+Math.abs(le.position.y-x.position.y)<qe?le:b});if(me.some(b=>b.x===_e.position.x&&b.y===_e.position.y))R={type:"attack",target:_e.position,reason:"Defense: Guard Forge"};else{let b=this.getNextStepTowards(x,_e.position,me);b&&(R=this.getWallBetween(x.position.x,x.position.y,b.x,b.y)?{type:"wall_attack",target:b,reason:"Defense: Breach to Forge"}:{type:"move",target:b,reason:"Defense: Approach Forge Threat"})}}}if(!R&&x.tier>=2&&(!x.hasArmor||!x.hasWeapon)){let oe=this.seekUpgrades(x,me);oe.type==="move"&&oe.target&&(R={type:"move",target:oe.target,reason:"Upgrade: Move to Forge"})}if(!R){let oe=this.isUnitInDanger(x),se=this.reclamationGoalsSignal().has(x.id);if(!se&&oe){let we=this.findSafeMove(x,me);we&&(R={type:"move",target:we,reason:"Survival: Evade Threat"})}else if(se&&oe&&this.getNeighbors(x.position).some(ye=>{let b=this.getUnitAt(ye.x,ye.y);return!b||b.owner===x.owner?!1:this.effectiveAttack(b)>this.effectiveDefense(x)+(x.tier>=3?10:0)})){let ye=this.findSafeMove(x,me);ye&&(R={type:"move",target:ye,reason:"Survival: Lethal Evade"})}}if(!R&&x.tier===4){let oe=this.unitsSignal().filter(se=>se.owner==="player");if(oe.length>0){let se=this.getBasePosition("player"),we=oe.map(ye=>({u:ye,baseDist:Math.max(Math.abs(ye.position.x-se.x),Math.abs(ye.position.y-se.y))})).sort((ye,b)=>ye.u.tier!==b.u.tier?ye.u.tier-b.u.tier:ye.baseDist-b.baseDist)[0].u,_e=this.getNextStepTowards(x,we.position,me);_e&&(R={type:"move",target:_e,reason:"T4 Raid: Flank Backline"})}}if(!R){let oe=this.computeSideEffectivePower("ai"),se=this.computeSideEffectivePower("player");if(se>0&&oe>se*1.2&&!this.isForest(x.position.x,x.position.y)&&parseInt(x.id.slice(-1),16)%2===0){let ye=this.unitsSignal().filter(qe=>qe.owner==="player"),b=Ce;if(ye.length>0&&(b=ye.reduce((Ke,ae)=>{let bt=Math.max(Math.abs(Ke.position.x-x.position.x),Math.abs(Ke.position.y-x.position.y));return Math.max(Math.abs(ae.position.x-x.position.x),Math.abs(ae.position.y-x.position.y))<bt?ae:Ke}).position),Math.max(Math.abs(b.x-x.position.x),Math.abs(b.y-x.position.y))<=1){let qe=this.findCombatTarget(x,O,me);qe&&(R={type:"attack",target:qe,reason:"Siege: Engage Enemy"})}else{let qe=this.getNextStepTowards(x,b,me,{noCohesion:!0});if(qe)R={type:"move",target:qe,reason:"Siege: Advance"};else{let Ke=this.bfsPath(x.position,b);if(Ke&&Ke.length>1){let ae=Ke[1];this.getWallBetween(x.position.x,x.position.y,ae.x,ae.y)&&(R={type:"wall_attack",target:ae,reason:"Siege: Breaching"})}}}}if(!R){let ye=this.findResourceTarget(x,O);if(ye){let b=this.bfsPath(x.position,ye,{respectWalls:!0,avoidFriendlyUnits:!0});if(b||(b=this.bfsPath(x.position,ye,{avoidFriendlyUnits:!0})),b&&b.length>1){let le=b[1],qe=this.getWallBetween(x.position.x,x.position.y,le.x,le.y);qe?qe.owner==="ai"&&this.isBaseProtectionEdge(x.position,le)||(R={type:"wall_attack",target:le,reason:"Objective: Breaching Wall"}):me.some(Ke=>Ke.x===le.x&&Ke.y===le.y)&&(R={type:"move",target:le,reason:"Objective: Capture Resource"})}}}}if(!R){let oe=this.findCombatTarget(x,O,me);oe&&(R={type:"attack",target:oe,reason:"Combat: Engage Enemy"})}if(!R&&this.aiWoodSignal()>=10&&this.getNeighbors(x.position).some(we=>this.isForest(we.x,we.y)&&this.getUnitAt(we.x,we.y)?.owner==="ai")){let we=this.findDefensiveWallTarget(x);we&&(R={type:"build_wall",target:we,reason:"Defense: Fortify Perimeter"})}if(!R){let oe=Ce,se=this.findFallbackMove(x,me,oe);se&&(R={type:"move",target:se,reason:"Fallback: Advance on Enemy"})}if(R){if(this.appendLog(`[AI Unit ${x.id.substring(0,4)}] Action: ${R.reason} -> Target: (${R.target.x},${R.target.y})`),R.type==="build_wall")this.aiBuildWallBetween(x.position,R.target);else{if(R.type==="move"){let oe=this.getUnitAt(R.target.x,R.target.y);if(oe&&oe.owner==="ai"&&oe.tier===x.tier){let se=new Map(this.mergeIntentSignal());se.set(x.id,oe.id),se.set(oe.id,x.id),this.mergeIntentSignal.set(se)}}this.executeMove(x,R.target)}O.claimedTargets.add(`${R.target.x},${R.target.y}`)}else this.appendLog(`[AI Unit ${x.id.substring(0,4)}] No valid moves. Passing.`),this.unitsSignal.update(oe=>oe.map(se=>se.id===x.id?ce(F({},se),{hasActed:!0}):se));await new Promise(oe=>setTimeout(oe,60))}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(s=>s.owner==="player"&&Math.max(Math.abs(s.position.x-e.x),Math.abs(s.position.y-e.y))<=3&&s.tier>=2);if(t.length>0){let s=t.reduce((l,c)=>this.calculateTotalPoints(c)>this.calculateTotalPoints(l)?c:l,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(s))return!0}let i=this.unitsSignal().filter(s=>s.owner==="ai").length;if(i<6){let s=this.reservePointsSignal().ai,a=this.getPointsForTierLevel(2,1);if(s>=a&&this.aiSpawnTier(2,1,new Set)>0)return!0}let o=this.baseHealthSignal().ai<50?20:70;if(this.aiWoodSignal()>=o)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;{let s=this.reservePointsSignal().ai,a=this.unitsSignal().filter(l=>l.owner==="ai"&&this.isForest(l.position.x,l.position.y)).length;if(s>25&&a>5&&this.aiSpawnTier(3,1,new Set,!0)>0)return!0}if(t.length===0)try{let s=this.getPointsForTierLevel(3,1),a=this.forestsSignal().length,l=this.unitsSignal().filter(h=>h.owner==="ai"&&this.isForest(h.position.x,h.position.y)).length,c=a>0?l/a:0,d=this.reservePointsSignal().ai;if(i>=6&&d>=s&&c<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),i=[],r=e.position.x,o=e.position.y,s=Math.sign(t.x-r),a=Math.sign(t.y-o);{let f=0,g=Math.max(10,this.gridSize*2);for(;r!==t.x||o!==t.y;){if(f++,f>g){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(r+=s,o+=a,!this.inBounds(r,o)||r===t.x&&o===t.y)break;i.push({x:r,y:o})}}let l=i.reverse().find(f=>!this.getUnitAt(f.x,f.y))||(()=>{for(let f=-1;f<=1;f++)for(let g=-1;g<=1;g++){if(f===0&&g===0)continue;let w=t.x+f,S=t.y+g;if(this.inBounds(w,S)&&!this.getUnitAt(w,S))return{x:w,y:S}}return null})();if(!l)return!1;{let f=0,g=50;for(;this.aiWoodSignal()>=20;){if(f++,f>g){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let c=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(c);if(d<=0)return!1;let h=this.calculateTierAndLevel(d);return this.unitsSignal().filter(g=>g.owner==="ai"&&g.tier===h.tier&&!this.isForest(g.position.x,g.position.y)).length>=5?!1:(this.unitsSignal.update(f=>[...f,{id:crypto.randomUUID(),position:F({},l),level:h.level,tier:h.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1}]),this.reservePointsSignal.update(f=>({player:f.player,ai:f.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,i,r=!1){let o=this.getBasePosition("ai"),s=[],a=2;for(let P=-a;P<=a;P++)for(let L=-a;L<=a;L++){if(P===0&&L===0)continue;let Z=o.x+P,ve=o.y+L;if(!this.inBounds(Z,ve)||Math.max(Math.abs(P),Math.abs(L))>a)continue;let be=`${Z},${ve}`;i.has(be)||this.getUnitAt(Z,ve)||s.push({x:Z,y:ve})}let l=this.aiForgesSignal(),c=this.aiIronSignal()<40;c&&l.length>0&&s.sort((P,L)=>{let Z=l.reduce((be,Ce)=>Math.min(be,Math.max(Math.abs(P.x-Ce.x),Math.abs(P.y-Ce.y))),1/0);return l.reduce((be,Ce)=>Math.min(be,Math.max(Math.abs(L.x-Ce.x),Math.abs(L.y-Ce.y))),1/0)-Z});let d=this.reservePointsSignal().ai,h=this.getPointsForTierLevel(e,1),f=0,g=[],w=P=>this.unitsSignal().filter(L=>L.owner==="ai"&&L.tier===P&&!this.isForest(L.position.x,L.position.y)).length;if(w(e)>=5&&!(r&&e===3))return 0;for(let P of s){if(f>=t||d<h||w(e)>=5)break;let L=this.calculateTierAndLevel(h);g.push({id:crypto.randomUUID(),position:F({},P),level:L.level,tier:L.tier,points:h,owner:"ai",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}),d-=h,f++}if(g.length>0){this.unitsSignal.update(Z=>[...Z,...g]),this.reservePointsSignal.update(Z=>({player:Z.player,ai:d})),this.recomputeVisibility();let P=new Map(this.ignoreForgeUntilTurnSignal()),L=this.turnSignal()+(c?2:1);for(let Z of g)P.set(Z.id,L);this.ignoreForgeUntilTurnSignal.set(P)}return f}aiConvertWoodToReserve(){let e=this.aiWoodSignal(),i=this.baseHealthSignal().ai<50?20:70;e<i||(this.aiWoodSignal.update(r=>r-20),this.reservePointsSignal.update(r=>({player:r.player,ai:r.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(i=>{if(i.some(s=>s.position.x===t.x&&s.position.y===t.y))return i;let o={id:crypto.randomUUID(),position:F({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};return[...i,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),i=2,r=[];for(let c=-i;c<=i;c++)for(let d=-i;d<=i;d++){let h=t.x+c,f=t.y+d;this.inBounds(h,f)&&(c===0&&d===0||Math.max(Math.abs(c),Math.abs(d))>i||r.push({x:h,y:f}))}let o=this.settings.difficulty(),s;o==="baby"?s=[{tier:4,level:1},{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}]:s=[{tier:1,level:1},{tier:1,level:1}];let a=[],l=(c,d)=>this.unitsSignal().some(h=>h.position.x===c&&h.position.y===d)||a.some(h=>h.position.x===c&&h.position.y===d);for(let c of s){let d=r.filter(w=>!l(w.x,w.y));if(d.length===0)break;let h=Math.floor(Math.random()*d.length),f=d[h],g=this.getPointsForTierLevel(c.tier,c.level);a.push({id:crypto.randomUUID(),position:F({},f),level:c.level,tier:c.tier,points:g,owner:e,turnsStationary:0,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0})}a.length>0&&this.unitsSignal.update(c=>[...c,...a])}getUnitAt(e,t){return this.unitsSignal().find(i=>i.position.x===e&&i.position.y===t)}getWallBetween(e,t,i,r){let o={x:e,y:t},s={x:i,y:r};if(!this.areAdjacent(o,s))return;let[a,l]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(c=>c.tile1.x===a.x&&c.tile1.y===a.y&&c.tile2.x===l.x&&c.tile2.y===l.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(i,r,o,s)=>this.getWallBetween(i,r,o,s))}isValidMove(e,t){return this.validMoves().some(i=>i.x===e&&i.y===t)}isForest(e,t){return this.forestsSignal().some(i=>i.x===e&&i.y===t)}isMine(e,t){return this.minesSignal().some(i=>i.x===e&&i.y===t)}isForgeSite(e,t){return this.forgeSitesSignal().some(i=>i.position.x===e&&i.position.y===t)}isForge(e,t){return this.forgesSignal().some(i=>i.x===e&&i.y===t)}getForgeProgress(e,t){let i=this.forgeSitesSignal().find(o=>o.position.x===e&&o.position.y===t);if(!i)return 0;let r=5;return Math.round((r-i.turnsLeft)/r*100)}canBuildForgeAt(e,t){let i=this.getBasePosition("player");if(Math.max(Math.abs(e-i.x),Math.abs(t-i.y))>2||!this.inBounds(e,t)||e===i.x&&t===i.y||this.getUnitAt(e,t)||this.isForest(e,t)||this.isMine(e,t)||this.isForgeSite(e,t)||this.isForge(e,t))return!1;let o=this.resourcesSignal();return o.wood>=40&&o.iron>=20&&this.isPlayerTurn()}buildForgeAt(e){this.canBuildForgeAt(e.x,e.y)&&(this.resourcesSignal.update(t=>({wood:t.wood-40,iron:t.iron-20})),this.forgeSitesSignal.update(t=>[...t,{position:F({},e),owner:"player",turnsLeft:5}]))}buyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy weapon without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasWeapon:!0}):s)))}buyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy armor without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[Forge] Player unit equipped Armor (+20 Shield HP)."))}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}aiBuyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy armor without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[AI] AI unit equipped Heavy Armor (+20 Shield HP)."))}aiBuyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy weapon without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?ce(F({},s),{hasWeapon:!0}):s)),this.appendLog("[AI] AI unit forged a Weapon (+20 ATK, +10 hit vs higher tier)."))}manageInfrastructure(){let e=this.aiForgesSignal().length+this.forgeSitesSignal().filter(c=>c.owner==="ai").length;if(e>=2)return;let t=this.aiWoodSignal(),i=this.aiIronSignal(),r=this.aiIronSignal();if(e===0){if(t<40||i<20)return}else if(e<2&&(r<=50||t<40||i<20))return;let o=this.getBasePosition("ai"),s=[];for(let c=-2;c<=2;c++)for(let d=-2;d<=2;d++){let h=o.x+c,f=o.y+d;this.inBounds(h,f)&&(h===o.x&&f===o.y||Math.max(Math.abs(c),Math.abs(d))>2||this.getUnitAt(h,f)||this.isForest(h,f)||this.isMine(h,f)||this.isForgeSite(h,f)||this.isForge(h,f)||s.push({x:h,y:f}))}if(s.length===0)return;let a=Math.floor(Math.random()*s.length),l=s[a];this.aiWoodSignal.update(c=>c-40),this.aiIronSignal.update(c=>c-20),this.forgeSitesSignal.update(c=>[...c,{position:F({},l),owner:"ai",turnsLeft:5}]),this.appendLog(`[AI] Constructing a Forge at (${l.x},${l.y}).`)}seekUpgrades(e,t){if(e.owner!=="ai")return{type:"none"};if(e.tier<2)return{type:"none"};if(e.hasArmor&&e.hasWeapon||this.aiIronSignal()<20)return{type:"none"};let i=this.aiForgesSignal();if(i.length===0)return{type:"none"};let r=this.getMergePartnerForUnit(e,t),o=this.aiIronSignal(),s=o>=100;if(s)this.appendLog(`[AI Wealth Override] T${e.tier} at (${e.position.x},${e.position.y}) bypassing normal checks (iron: ${o})`);else if(o<40){let h=this.computeHighestTierNeedingUpgrade();if(h>0&&e.tier<h)return{type:"none"}}if(!s&&r){let h=!e.hasWeapon&&r.hasWeapon,f=!e.hasArmor&&r.hasArmor;if(h||f){let g=h&&f?"Weapon & Armor":h?"Weapon":"Armor";return this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored ${g} purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) already has it).`),{type:"none"}}}let a=i.reduce((h,f)=>{let g=Math.max(Math.abs(f.x-e.position.x),Math.abs(f.y-e.position.y)),w=Math.max(Math.abs(h.x-e.position.x),Math.abs(h.y-e.position.y));return g<w?f:h},i[0]),c=this.ignoreForgeUntilTurnSignal().get(e.id)??0;if(this.turnSignal()<=c)return{type:"none"};if(e.position.x===a.x&&e.position.y===a.y){let h=this.aiIronSignal();if(r){let f=!1;return!r.hasArmor&&!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal(),f=!0),!r.hasWeapon&&!e.hasWeapon&&h>=20&&(this.aiBuyWeapon(e.id),f=!0),!f&&r.hasArmor&&r.hasWeapon&&this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) fully equipped).`),{type:"none"}}else return!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal()),!e.hasWeapon&&h>=20&&this.aiBuyWeapon(e.id),{type:"none"}}let d=this.getNextStepTowards(e,a,t);return d?{type:"move",target:d}:{type:"none"}}seekUpgradesFor(e,t,i){if(t.owner!==e)return{type:"none"};if(t.tier<2)return{type:"none"};let r=this.getIron(e);if(t.hasArmor&&t.hasWeapon||r<20)return{type:"none"};let o=this.getForges(e);if(o.length===0)return{type:"none"};let s=e==="ai"?this.getMergePartnerForUnit(t,i):this.getMergePartnerForUnit(t,i),a=this.getIron(e),l=e==="ai"&&a>=100;if(l)this.appendLog(`[AI Wealth Override] T${t.tier} at (${t.position.x},${t.position.y}) bypassing normal checks (iron: ${a})`);else if(a<40){let g=this.computeHighestTierNeedingUpgrade();if(g>0&&t.tier<g)return{type:"none"}}if(!l&&s){let g=!t.hasWeapon&&s.hasWeapon,w=!t.hasArmor&&s.hasArmor;if(g||w)return this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored ${g&&w?"Weapon & Armor":g?"Weapon":"Armor"} purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) already has it).`),{type:"none"}}let c=o.reduce((g,w)=>{let S=Math.max(Math.abs(w.x-t.position.x),Math.abs(w.y-t.position.y)),P=Math.max(Math.abs(g.x-t.position.x),Math.abs(g.y-t.position.y));return S<P?w:g},o[0]),h=this.ignoreForgeUntilTurnSignal().get(t.id)??0;if(this.turnSignal()<=h)return{type:"none"};if(t.position.x===c.x&&t.position.y===c.y){let g=this.getIron(e);if(s){let w=!1;return!s.hasArmor&&!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e),w=!0),!s.hasWeapon&&!t.hasWeapon&&g>=20&&(this.buyWeaponGeneric(e,t.id),w=!0),!w&&s.hasArmor&&s.hasWeapon&&this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) fully equipped).`),{type:"none"}}else return!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e)),!t.hasWeapon&&g>=20&&this.buyWeaponGeneric(e,t.id),{type:"none"}}let f=this.getNextStepTowards(t,c,i,void 0);return f?{type:"move",target:f}:{type:"none"}}async executeBotTurn(e){if(this.activeSideSignal()!==e||this.gameStatus()!=="playing")return;let t=e==="ai"?"player":"ai",i=this.getBasePosition(t),r=this.getBasePosition("player"),o=this.getBasePosition("ai"),s=this.forestsSignal().length+this.minesSignal().length,a=this.unitsSignal().filter(f=>f.owner===t&&(this.isForest(f.position.x,f.position.y)||this.isMine(f.position.x,f.position.y)));if((s>0?a.length/s:0)>.5){let f=new Map,g=this.unitsSignal().filter(P=>P.owner===e&&!P.hasActed),w=new Set,S=a.slice().sort((P,L)=>L.tier-P.tier);for(let P of S){let L=Math.min(4,P.tier+1),Z=g.filter(be=>be.tier===L&&!w.has(be.id)).sort((be,Ce)=>{let Te=Math.max(Math.abs(be.position.x-P.position.x),Math.abs(be.position.y-P.position.y)),O=Math.max(Math.abs(Ce.position.x-P.position.x),Math.abs(Ce.position.y-P.position.y));return Te-O});if(Z.length>0){let be=Z[0];f.set(be.id,{target:F({},P.position),type:"hunt"}),w.add(be.id);continue}let ve=g.filter(be=>be.tier===P.tier&&!w.has(be.id));for(let be of ve){let Ce=this.calculateValidMoves(be),Te=this.unitsSignal().find(O=>O.owner===e&&O.tier===be.tier&&(O.position.x!==be.position.x||O.position.y!==be.position.y)&&Ce.some(I=>I.x===O.position.x&&I.y===O.position.y));if(Te){f.set(be.id,{target:F({},Te.position),type:"merge"}),w.add(be.id);break}}}e==="ai"?this.reclamationGoalsSignal.set(f):this.reclamationGoalsSignal.set(f)}else this.reclamationGoalsSignal.set(new Map);let d=this.unitsSignal().filter(f=>f.owner===e&&!f.hasActed),h={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(f=>f.owner===t&&f.tier>=3)};for(let f of d){let g=null,w=this.calculateValidMoves(f),S=this.getForges(e),P=this.unitsSignal().filter(Te=>Te.owner===t),L=[];for(let Te of S)for(let O of P)Math.max(Math.abs(O.position.x-Te.x),Math.abs(O.position.y-Te.y))<=3&&L.push(O);if(L.length>0){let Te=L.reduce((I,N)=>{let D=Math.abs(I.position.x-f.position.x)+Math.abs(I.position.y-f.position.y);return Math.abs(N.position.x-f.position.x)+Math.abs(N.position.y-f.position.y)<D?N:I});if(w.some(I=>I.x===Te.position.x&&I.y===Te.position.y))g={type:"attack",target:Te.position,reason:"Defense: Guard Forge"};else{let I=this.getNextStepTowards(f,Te.position,w);I&&(g=this.getWallBetween(f.position.x,f.position.y,I.x,I.y)?{type:"wall_attack",target:I,reason:"Defense: Breach to Forge"}:{type:"move",target:I,reason:"Defense: Approach Forge Threat"})}}if(!g&&f.tier>=2&&(!f.hasArmor||!f.hasWeapon)){let Te=this.seekUpgradesFor(e,f,w);Te.type==="move"&&Te.target&&(g={type:"move",target:Te.target,reason:"Upgrade: Move to Forge"})}let Z=this.computeSideEffectivePower(e),ve=this.computeSideEffectivePower(t),Ce=ve>0&&Z>ve*1.2&&!this.isForest(f.position.x,f.position.y)&&parseInt(f.id.slice(-1),16)%2===0;if(!g&&Ce){let Te=this.getBasePosition(t);if(Math.max(Math.abs(Te.x-f.position.x),Math.abs(Te.y-f.position.y))<=1){let I=this.findCombatTarget(f,h,w);I&&(g={type:"attack",target:I,reason:"Siege: Engage Enemy"})}else{let I=this.getNextStepTowards(f,Te,w,{noCohesion:!0});I&&(g={type:"move",target:I,reason:"Siege: Advance"})}}if(!g){let Te=this.findCombatTarget(f,h,w);Te&&(g={type:"attack",target:Te,reason:"Combat: Engage Enemy"})}if(!g&&this.getWood(e)>=10&&this.getNeighbors(f.position).some(I=>this.isForest(I.x,I.y)&&this.getUnitAt(I.x,I.y)?.owner===e)){let I=this.findDefensiveWallTarget(f);I&&(g={type:"build_wall",target:I,reason:"Defense: Fortify Perimeter"})}if(!g){let Te=t==="ai"?o:r,O=this.findFallbackMove(f,w,Te);O&&(g={type:"move",target:O,reason:"Fallback: Advance on Enemy"})}g?g.type==="build_wall"?e==="ai"?this.aiBuildWallBetween(f.position,g.target):this.buildWallBetween(f.position,g.target):this.executeMove(f,g.target):this.unitsSignal.update(Te=>Te.map(O=>O.id===f.id?ce(F({},O),{hasActed:!0}):O)),await new Promise(Te=>setTimeout(Te,60))}e==="player"?this.endTurn():this.endTurn()}playerAutoStep(){if(!this.isPlayerTurn()||this.gameStatus()!=="playing")return!1;let e="player",t="ai",i=this.unitsSignal().find(a=>a.owner===e&&!a.hasActed);if(!i)return!1;let r=this.calculateValidMoves(i),o=this.seekUpgradesFor(e,i,r),s=null;if(o.type==="move"&&o.target&&(s={type:"move",target:o.target,reason:"Upgrade: Move to Forge"}),!s){let a=this.isForest(i.position.x,i.position.y),l=this.isMine(i.position.x,i.position.y),c=this.totalWarMode();if((a||l)&&!c&&!this.getNeighbors(i.position).some(f=>{let g=this.getUnitAt(f.x,f.y);return g&&g.owner===t}))return this.unitsSignal.update(f=>f.map(g=>g.id===i.id?ce(F({},g),{hasActed:!0}):g)),!0}if(!s){let a=this.findPlayerResourceTarget(i);if(a){let l=`${a.x},${a.y}`,c=new Set(this.playerClaimedTargetsSignal());c.add(l),this.playerClaimedTargetsSignal.set(c);let d=this.bfsPath(i.position,a,{respectWalls:!0,avoidFriendlyUnits:!0});if(d||(d=this.bfsPath(i.position,a,{avoidFriendlyUnits:!0})),d&&d.length>1){let h=d[1];this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?s={type:"wall_attack",target:h,reason:"Resource: Breach to Capture"}:r.some(g=>g.x===h.x&&g.y===h.y)&&(s={type:"move",target:h,reason:"Resource: Move to Capture"})}else{let h=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});h&&(s=this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?{type:"wall_attack",target:h,reason:"Resource: Breach"}:{type:"move",target:h,reason:"Resource: Advance"})}}}if(!s){let a={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(c=>c.owner===t&&c.tier>=3)},l=this.findCombatTarget(i,a,r);l&&(s={type:"attack",target:l,reason:"Combat: Engage Enemy"})}if(!s){let a=this.getBasePosition(t),l=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});l&&(s={type:"move",target:l,reason:"Advance"})}return s?(s.type==="build_wall"?this.buildWallBetween(i.position,s.target):s.type==="wall_attack"?this.attackOrDestroyWallBetween(i.position,s.target):this.executeMove(i,s.target),!0):(this.unitsSignal.update(a=>a.map(l=>l.id===i.id?ce(F({},l),{hasActed:!0}):l)),!1)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10)return;if(!this.canBuildWallBetween(e,t)){if(this.isEdgeOnCooldown(e,t)){let a=this.edgeCooldownRemaining(e,t);this.appendLog(`[Build] This area is too unstable to rebuild yet (CD: ${a} turns).`)}return}let r=this.getBestAdjacentPlayerUnit(e,t);if(!r||r.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.updateWallFormations(),this.resourcesSignal.update(a=>({wood:a.wood-10,iron:a.iron})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(l=>l.id===r.id?ce(F({},l),{hasActed:!0}):l))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20,iron:t.iron})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(i=>({wood:i.wood-t*20,iron:i.iron})),this.reservePointsSignal.update(i=>({player:i.player+t,ai:i.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let i=[];for(let r=-2;r<=2;r++)for(let o=-2;o<=2;o++){if(r===0&&o===0)continue;let s=t.x+r,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(r),Math.abs(o))>2)continue;this.getUnitAt(s,a)||i.push({x:s,y:a})}this.deployTargetsSignal.set(i),this.baseDeployActiveSignal.set(!0)}startSandboxSpawn(e,t){this.settings.customMode()&&this.sandboxSpawnPendingSignal.set({owner:e,tier:t})}cancelSandboxSpawn(){this.sandboxSpawnPendingSignal.set(null)}spawnSandboxAt(e){let t=this.sandboxSpawnPendingSignal();if(!t||!this.settings.customMode()||this.getUnitAt(e.x,e.y))return;let i=this.getPointsForTierLevel(t.tier,1),r={id:crypto.randomUUID(),position:F({},e),level:1,tier:t.tier,points:i,owner:t.owner,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};this.unitsSignal.update(o=>[...o,r]),this.sandboxSpawnPendingSignal.set(null),this.recomputeVisibility()}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,l=e.y+s;this.inBounds(a,l)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,l)||t.push({x:a,y:l}))}let i=this.reservePointsSignal().player,r=[];for(let o of t){if(i<=0)break;let s=this.economy.getHighestAffordableCost(i);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(l=>[...l,{id:crypto.randomUUID(),position:F({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}]),i-=s,r.push(o)}r.length>0&&(this.reservePointsSignal.update(o=>({player:i,ai:o.ai})),this.recomputeVisibility())}botEconomyPhase(e){if(this.gameStatus()!=="playing"||e!=="player"||!this.isPlayerTurn())return!1;let t=!1;{let r=this.baseHealthSignal().player<50?20:50,o=0;for(;this.resourcesSignal().wood>=r+20;)this.convertWoodToReserve(),o+=20;o>0&&(this.appendLog(`[Auto-Engage] Player converted ${o} wood to reserves.`),t=!0)}try{let i=this.forgesSignal().length,r=this.forgeSitesSignal().length,o=i+r,s=this.resourcesSignal();if(o<2&&s.iron>=20&&s.wood>=40){let a=this.getBasePosition("player"),l=2,c=!1;for(let d=-l;d<=l&&!c;d++)for(let h=-l;h<=l&&!c;h++){if(d===0&&h===0)continue;let f=a.x+d,g=a.y+h;this.inBounds(f,g)&&(Math.max(Math.abs(d),Math.abs(h))>l||this.canBuildForgeAt(f,g)&&(this.appendLog(`[Auto-Engage] Player building Forge at (${f},${g}).`),this.buildForgeAt({x:f,y:g}),t=!0,c=!0))}}}catch{}if(!this.wallBuiltThisTurnSignal()&&this.resourcesSignal().wood>=10){let r=this.unitsSignal().filter(o=>o.owner==="player"&&this.isForest(o.position.x,o.position.y));for(let o of r){let s=this.findDefensiveWallTargetForOwner(o,"player");if(s){this.buildWallBetween(o.position,s),t=!0;break}}}{let i=this.unitsSignal().length;this.autoDeployFromReserves(),this.unitsSignal().length>i&&(t=!0)}return t}isDeployTarget(e,t){return this.deployTargetsSignal().some(i=>i.x===e&&i.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let i=this.economy.getHighestAffordableCost(t);if(i<=0)return;let r=this.calculateTierAndLevel(i);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:F({},e),level:r.level,tier:r.tier,points:i,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-i,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${r.tier}(L${r.level}) at (${e.x},${e.y}) costing ${i} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[i,r]=this.sortEdgeEndpoints(e,t);return`${i.x},${i.y}|${r.x},${r.y}`}registerWallDestroyedEdge(e,t){let i=this.edgeKey(e,t),r=new Map(this.wallCooldownSignal());r.set(i,this.turnSignal()),this.wallCooldownSignal.set(r)}isEdgeOnCooldown(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);return r===void 0?!1:5-(this.turnSignal()-r)>0}edgeCooldownRemaining(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);if(r===void 0)return 0;let o=5-(this.turnSignal()-r);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,i=!1){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(r.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(r.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(r.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;{let w=t.x-e.x,S=t.y-e.y,P=Math.abs(w)>=Math.abs(S),L=Math.sign(P?w:S),Z=this.wallThicknessPx+2,ve=this.tileSizePx+Z,be=Math.round(ve*.35),Ce=P?L*be:0,Te=P?0:L*be,O=new Set(this.attackingUnitsSignal());O.add(s.id),this.attackingUnitsSignal.set(O),this.attackerNudgeSignal.set({id:s.id,dx:Ce,dy:Te}),setTimeout(()=>{this.attackerNudgeSignal.set({id:s.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let I=new Set(this.attackingUnitsSignal());I.delete(s.id),this.attackingUnitsSignal.set(I)},200)}let a=this.combat.getWallHitAmount(s.tier),[l,c]=this.sortEdgeEndpoints(e,t),d=r.maxHealth??100,h=Math.max(0,r.health-a);this.wallsSignal.update(w=>w.map(S=>S.id===r.id?ce(F({},S),{health:Math.max(0,S.health-a)}):S).filter(S=>S.health>0)),h<=0?(this.registerWallDestroyedEdge(l,c),this.updateWallFormations()):this.updateWallFormations(),this.shakenWallIdSignal.set(r.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let f=o==="player"?"Player":"AI",g=r.owner==="neutral"?"Neutral":r.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${s.tier} Unit attacked ${g} Wall. Damage: ${a}. Wall HP: ${h}/${d}.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(w=>w.map(S=>S.id===s.id?ce(F({},S),{hasActed:!0}):S)),o==="player"&&this.selectNextAvailableUnit()}destroyOwnWallBetween(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i||i.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==i.id));let[r,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(r,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`),this.updateWallFormations()}canDestroyOwnWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||i.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!i||i.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||!this.canActThisTurn()?!1:i.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(i=>i.owner==="player"&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let i=this.getAdjacentPlayerUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="ai"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentAiUnit(e,t){let i=this.getAdjacentAiUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<50)return;let i=this.getBestAdjacentAiUnit(e,t);if(!i||i.hasActed||!this.unitsSignal().filter(l=>l.owner==="player").some(l=>{let c=Math.max(Math.abs(l.position.x-e.x),Math.abs(l.position.y-e.y)),d=Math.max(Math.abs(l.position.x-t.x),Math.abs(l.position.y-t.y));return c<=2||d<=2?l.tier>=i.tier:!1})||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let[s,a]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(l=>[...l,{id:crypto.randomUUID(),tile1:{x:s.x,y:s.y},tile2:{x:a.x,y:a.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(l=>l-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(l=>l.map(c=>c.id===i.id?ce(F({},c),{hasActed:!0}):c)),this.updateWallFormations()}isBaseProtectionEdge(e,t){let i=this.getBasePosition("ai"),r=o=>Math.max(Math.abs(o.x-i.x),Math.abs(o.y-i.y))<=1||o.x===i.x&&o.y===i.y;return r(e)||r(t)}wouldCageElite(e,t){let i=(s,a,l,c)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:l,y:c}),h=this.sortEdgeEndpoints(e,t);return d[0].x===h[0].x&&d[0].y===h[0].y&&d[1].x===h[1].x&&d[1].y===h[1].y},r=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||i(s.x,s.y,a.x,a.y));{let l=Math.sign(a.x-s.x),c=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+l,s.y),h=this.getWallBetween(s.x,s.y,s.x,s.y+c),f=this.getWallBetween(a.x-l,a.y,a.x,a.y),g=this.getWallBetween(a.x,a.y-c,a.x,a.y);return!!(d||h||f||g||i(s.x,s.y,s.x+l,s.y)||i(s.x,s.y,s.x,s.y+c)||i(a.x-l,a.y,a.x,a.y)||i(a.x,a.y-c,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(l=>{let c={x:s.position.x+l.x,y:s.position.y+l.y};return this.inBounds(c.x,c.y)?!r(s.position,c):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(r=>r.owner==="ai"),t=this.unitsSignal().filter(r=>r.owner==="player"),i=this.getBasePosition("ai");for(let r of e){if(!this.isForest(r.position.x,r.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y))<=2);for(let s of o){let a=r.level??this.calculateTierAndLevel(r.points).level,l=s.level??this.calculateTierAndLevel(s.points).level,c=Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y)),d=Math.sign(s.position.x-r.position.x),h=Math.sign(s.position.y-r.position.y);if(Math.abs(d)+Math.abs(h)===2)continue;let f=c===1?{x:r.position.x+d,y:r.position.y+h}:{x:r.position.x+Math.sign(s.position.x-r.position.x),y:r.position.y+Math.sign(s.position.y-r.position.y)};if(!this.inBounds(f.x,f.y))continue;let g=Math.sign(i.x-r.position.x),w=Math.sign(i.y-r.position.y);if((f.x-r.position.x)*g+(f.y-r.position.y)*w>0)continue;let P=r.position,L=f;if(!this.getWallBetween(P.x,P.y,L.x,L.y)&&(l>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(P,L),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${P.x},${P.y})-(${L.x},${L.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let i=e.x<=t.x,r=e.y<=t.y;return i&&r?0:!i&&r?1:i&&!r?2:3}placeNeutralWalls(){let e=(i,r)=>{if(!this.areAdjacent(i,r)||!this.inBounds(i.x,i.y)||!this.inBounds(r.x,r.y)||this.getWallBetween(i.x,i.y,r.x,r.y))return;let[o,s]=this.sortEdgeEndpoints(i,r);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}]),this.updateWallFormations()},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let i of t){let r=[{x:i.x+1,y:i.y},{x:i.x-1,y:i.y},{x:i.x,y:i.y+1},{x:i.x,y:i.y-1}];for(let o of r)this.inBounds(o.x,o.y)&&e(i,o)}for(let i of this.forestsSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}for(let i of this.minesSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}}static \u0275fac=function(t){return new(t||n)(Re(zl),Re(kg),Re(Og),Re(Tt),Re(Fg),Re(Lg),Re(Vg),Re(Rn),Re(bc))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};function wG(n,e){n&1&&(ee(),H(0,"polygon",127))}function xG(n,e){n&1&&(ee(),H(0,"polygon",127))}function SG(n,e){n&1&&(ee(),C(0,"g"),H(1,"polygon",213),A())}function IG(n,e){n&1&&(ee(),H(0,"polygon",127))}function TG(n,e){n&1&&(ee(),C(0,"g"),H(1,"polygon",213),A())}function CG(n,e){n&1&&(ee(),C(0,"g"),H(1,"polygon",214)(2,"polygon",215)(3,"polygon",216),A())}var p0=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(he(ri),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-game-rules"]],decls:694,vars:76,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","flex-col","justify-between"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"bg-gray-800/60","border","border-blue-500/30","rounded-lg","p-4","shadow-[0_0_15px_rgba(59,130,246,0.1)]"],[1,"text-lg","font-semibold","mb-3","flex","items-center","gap-2"],[1,"text-blue-400"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[45px]","text-center"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[60px]","text-center"],[1,"text-xs","text-gray-400","text-right","italic"],[1,"flex","flex-col","items-center","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","text-white"],[1,"flex","items-center","justify-between","gap-4","border-t","border-white/5","pt-3"],[1,"px-4","py-1","bg-blue-600","border-b-4","border-blue-800","rounded","text-xs","font-mono","text-white","font-bold"],[1,"text-xs","text-blue-300","font-semibold","uppercase","tracking-wider"],[1,"mt-4","p-2","bg-blue-500/10","border","border-blue-500/20","rounded","text-[10px]","text-blue-200/70","leading-tight"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"bg-gray-800/60","border","border-gray-700","rounded-xl","p-6","md:col-span-2","shadow-2xl","backdrop-blur-sm"],[1,"text-xs","uppercase","tracking-widest","text-gray-500","font-bold","mb-6","flex","items-center","gap-2"],[1,"w-8","h-[1px]","bg-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8","items-start"],[1,"space-y-6"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-gray-300","text-sm"],[1,"text-orange-400","font-bold"],[1,"text-blue-400","font-bold"],[1,"p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-xs","text-gray-400","leading-relaxed"],[1,"text-white","font-semibold"],[1,"lg:col-span-2","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-blue-500/50","transition-all","duration-300","flex","items-center","gap-4"],[1,"w-20","h-20","shrink-0"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],["cx","50","cy","50","r","32"],["cx","50","cy","50","r","31","fill","none","stroke","rgba(255,255,255,0.2)","stroke-width","2"],["x","50","y","62","text-anchor","middle","font-size","32","font-weight","800","fill","white"],["transform","translate(18, 5) scale(0.8)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","#60a5fa"],[1,"flex","flex-col"],[1,"text-blue-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"text-gray-300","text-sm","leading-tight"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-red-500/50","transition-all","duration-300","flex","items-center","gap-4"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],["transform","rotate(-45 50 50) translate(40, 10) scale(1.2)"],["x","5","y","0","width","2","height","10","fill","#f87171"],["x","3","y","10","width","6","height","2","fill","#991b1b"],[1,"text-red-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"p-4","bg-gray-800/40","rounded-lg","border","border-gray-700/30"],[1,"text-[10px]","uppercase","tracking-wider","text-gray-500","font-bold","mb-3"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"flex","justify-between","border-b","border-gray-700/50","pb-1"],[1,"text-gray-500"],[1,"text-white"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","#60a5fa","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],[1,"text-lg","font-semibold","mb-1"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","3"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","4"],[1,"mover","triangle","t1-path"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"flex","items-center","gap-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","theme-test-player"],[1,"flex","flex-col","flex-center"],[1,"flex","flex-center","gap-2"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-80"],["points","50,16 86,78 14,78","fill","var(--u-fill)"],["x","49","y","66","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2"],["viewBox","0 0 100 100"],["id","base-circle"],["id","eye"],["id","scan-lvl2"],["id","radar-lvl3"],["id","field-lvl4"],["cx","50","cy","50","r","14","fill","#94a3b8"],["cx","50","cy","50","r","4","fill","#e5e7eb"],["cx","50","cy","50","r","20","fill","none","stroke","#cbd5f5","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","#e5e7eb","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","#f8fafc"],["cx","50","cy","50","r","30","fill","none","stroke","#f1f5f9","stroke-width","1","opacity","0.4"],[1,"unit-svg-wrapper","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-70"],["cx","50","cy","55","r","6","fill","var(--u-core)"],["points","50,5 55,15 45,15","fill","var(--u-stroke)"],["points","92,82 82,78 86,70","fill","var(--u-stroke)"],["points","8,82 18,78 14,70","fill","var(--u-stroke)"],["points","50,2 95,85 5,85","fill","none","stroke","var(--u-core)","stroke-width","2"],["points","50,48 56,52 56,60 50,64 44,60 44,52","fill","var(--u-light)"],["points","50,-2 102,88 -2,88","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","opacity","0.6"],["points","50,-5 54,8 46,8","fill","var(--u-light)"],["points","92,82 88,70 80,78","fill","var(--u-light)"],["points","8,82 20,78 12,70","fill","var(--u-light)"],["id","base-shape"],["id","core"],["id","armor-lvl2"],["id","armor-lvl3"],["id","fortress-lvl4"],["id","fx"],["x","20","y","20","width","60","height","60","rx","6","fill","#2563eb"],["x","46","y","46","width","8","height","8","fill","#93c5fd"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","#60a5fa","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","#93c5fd","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","#bfdbfe"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","#60a5fa","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","#bfdbfe"],["x","78","y","12","width","10","height","10","fill","#bfdbfe"],["x","12","y","78","width","10","height","10","fill","#bfdbfe"],["x","78","y","78","width","10","height","10","fill","#bfdbfe"],["id","base-hex"],["id","links-lvl2"],["id","network-lvl3"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","#10b981"],["cx","50","cy","50","r","4","fill","#6ee7b7"],["x1","50","y1","20","x2","50","y2","40","stroke","#6ee7b7","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","#6ee7b7","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","#6ee7b7","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","#a7f3d0","stroke-width","2"],["cx","50","cy","20","r","3","fill","#34d399"],["cx","80","cy","50","r","3","fill","#34d399"],["cx","50","cy","80","r","3","fill","#34d399"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","#6ee7b7","stroke-width","1.5","stroke-dasharray","4 4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","unit-svg-wrapper-game_rules"],[1,"flex","items-center","gap-6","theme-test-player"],["viewBox","0 0 100 100",1,"w-full","h-full"],["cx","50","cy","50","r","20","fill","var(--u-fill)"],["cx","50","cy","50","r","4","fill","var(--u-light)"],["cx","50","cy","50","r","26","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","var(--u-light)","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","var(--u-light)"],["cx","50","cy","50","r","34","fill","none","stroke","var(--u-light)","stroke-width","1","opacity","0.4"],[1,"flex","items-center","gap-6","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-75"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-110"],["x","20","y","20","width","60","height","60","rx","6","fill","var(--u-dark)"],["x","46","y","46","width","8","height","8","fill","var(--u-core)"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","var(--u-light)"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","var(--u-light)"],["x","78","y","12","width","10","height","10","fill","var(--u-light)"],["x","12","y","78","width","10","height","10","fill","var(--u-light)"],["x","78","y","78","width","10","height","10","fill","var(--u-light)"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","var(--u-emerald)"],["cx","50","cy","50","r","4","fill","var(--u-emerald-stroke)"],["x1","50","y1","20","x2","50","y2","40","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","var(--u-emerald-stroke)","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","2"],["cx","50","cy","20","r","3","fill","var(--u-emerald-stroke)"],["cx","80","cy","50","r","3","fill","var(--u-emerald-stroke)"],["cx","50","cy","80","r","3","fill","var(--u-emerald-stroke)"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 56,10 44,10","fill","var(--u-light)"],["points","99,87 92,74 84,87","fill","var(--u-light)"],["points","1,87 15,87 8,74","fill","var(--u-light)"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),y(5),A(),C(6,"h3",5),y(7),A()(),C(8,"button",6),Ht("click",function(){return i.engine.closeRules()}),y(9," \u2716 "),A()(),C(10,"div",7)(11,"div",8)(12,"div",9),y(13),A(),C(14,"div",10)(15,"div",11)(16,"div",12),y(17,"\u{1F333}"),A(),C(18,"div")(19,"div",13),y(20),A(),C(21,"div",14),y(22),A()()(),C(23,"div",11)(24,"div",12),y(25,"\u{1F3F0}"),A(),C(26,"div")(27,"div",13),y(28),A(),C(29,"div",14),y(30),A()()()()(),C(31,"div",15)(32,"div",16)(33,"div",9),y(34),A(),C(35,"div",17)(36,"div",18)(37,"div",19),y(38," 1 "),A(),C(39,"div",20),y(40,"1\u20134"),A()(),C(41,"div",18)(42,"div",21),y(43," 5 "),A(),C(44,"div",20),y(45,"5\u201320"),A()(),C(46,"div",18)(47,"div",21),y(48,"25"),A(),C(49,"div",20),y(50,"25\u2013100"),A()(),C(51,"div",18)(52,"div",22)(53,"span",23),y(54,"125"),A()(),C(55,"div",20),y(56,"125\u2013500"),A()()()(),C(57,"div",16)(58,"div",24),y(59),A(),C(60,"div",25)(61,"div",26)(62,"div",27),y(63,"2"),A(),C(64,"div",28),y(65,"2"),A(),C(66,"div",29),y(67,"1"),A()()()()(),C(68,"div",30)(69,"div",31)(70,"span",32),y(71,"\u2328\uFE0F"),A(),y(72),A(),C(73,"div",33)(74,"div",34)(75,"div",35)(76,"kbd",36),y(77," Tab "),A(),C(78,"kbd",37),y(79," Space "),A()(),C(80,"div",38),y(81),A()(),C(82,"div",34)(83,"div",39)(84,"kbd",40),y(85,"\u2191"),A(),C(86,"div",35)(87,"kbd",40),y(88,"\u2190"),A(),C(89,"kbd",40),y(90,"\u2193"),A(),C(91,"kbd",40),y(92,"\u2192"),A()()(),C(93,"div",38),y(94),A()(),C(95,"div",41)(96,"kbd",42),y(97," Enter "),A(),C(98,"div",43),y(99),A()()(),C(100,"div",44)(101,"strong"),y(102,"TIP:"),A(),y(103),A()(),C(104,"div",8)(105,"div",9),y(106),A(),C(107,"div",45)(108,"div")(109,"div",46),y(110),A(),C(111,"div",47)(112,"div",48),y(113,"1"),A(),C(114,"div",49),y(115,"1"),A()(),C(116,"div",50),y(117),A()(),C(118,"div")(119,"div",46),y(120),A(),C(121,"div",47)(122,"div",48),y(123,"4"),A(),C(124,"div",51),y(125,"1"),A(),C(126,"span",52),y(127,"CRIT!"),A()(),C(128,"div",50),y(129),A()(),C(130,"div")(131,"div",46),y(132),A(),C(133,"div",47)(134,"div",48),y(135,"1"),A(),C(136,"div",53),y(137,"4"),A(),C(138,"span",54),y(139,"MISS!"),A()(),C(140,"div",50),y(141),A()()()(),C(142,"div",55)(143,"div",56),H(144,"span",57),y(145),A(),C(146,"div",58)(147,"div",59)(148,"div",60)(149,"div",61)(150,"span",62),y(151),A(),C(152,"span",63),y(153,"20%"),A()(),C(154,"div",61)(155,"span",62),y(156),A(),C(157,"span",64),y(158,"20%"),A()(),C(159,"div",65)(160,"p",66)(161,"span",67),y(162,"50%"),A(),y(163),A()()()(),C(164,"div",68)(165,"div",69)(166,"div",70),ee(),C(167,"svg",71),H(168,"circle",72)(169,"circle",73),C(170,"text",74),y(171,"1"),A(),C(172,"g",75),H(173,"path",76),A()()(),ke(),C(174,"div",77)(175,"span",78),y(176,"+20 HP Bonus"),A(),C(177,"p",79),y(178),A()()(),C(179,"div",80)(180,"div",70),ee(),C(181,"svg",81),H(182,"circle",72)(183,"circle",73),C(184,"text",74),y(185,"1"),A(),C(186,"g",82),H(187,"rect",83)(188,"rect",84),A()()(),ke(),C(189,"div",77)(190,"span",85),y(191,"+20 DMG Bonus"),A(),C(192,"p",79),y(193),A()()()(),C(194,"div",68)(195,"div",86)(196,"p",87),y(197),A(),C(198,"div",88)(199,"div",89)(200,"span",90),y(201,"T1"),A(),C(202,"span",91),y(203,"1"),A()(),C(204,"div",89)(205,"span",90),y(206,"T2"),A(),C(207,"span",91),y(208,"2"),A()(),C(209,"div",89)(210,"span",90),y(211,"T3"),A(),C(212,"span",91),y(213,"4"),A()(),C(214,"div",89)(215,"span",90),y(216,"T4"),A(),C(217,"span",91),y(218,"8"),A()()()(),C(219,"div",80)(220,"div",70),ee(),C(221,"svg",81),H(222,"circle",72)(223,"circle",73),C(224,"text",74),y(225,"1"),A(),C(226,"g"),H(227,"path",92)(228,"path",93),A()()(),ke(),C(229,"div",77)(230,"p",79),y(231),A()()()()()(),C(232,"div",16)(233,"div",94),y(234),A(),C(235,"div",95)(236,"div")(237,"div",96),y(238),A(),C(239,"div",97),H(240,"div",98)(241,"div",98)(242,"div",98)(243,"div",98)(244,"div",98)(245,"div",98)(246,"div",99)(247,"div",99)(248,"div",98)(249,"div",98)(250,"div",98)(251,"div",98)(252,"div",98)(253,"div",98)(254,"div",98)(255,"div",98)(256,"div",98)(257,"div",98)(258,"div",98)(259,"div",98)(260,"div",98)(261,"div",98)(262,"div",98)(263,"div",98)(264,"div",98),C(265,"div",100),y(266,"2"),A(),H(267,"div",101),C(268,"div",102),y(269,"\u{1F3F0}"),A()()(),C(270,"div")(271,"div",96),y(272),A(),C(273,"div",103),H(274,"div",98)(275,"div",98)(276,"div",98)(277,"div",98)(278,"div",98)(279,"div",98)(280,"div",99)(281,"div",99)(282,"div",99)(283,"div",98)(284,"div",98)(285,"div",98)(286,"div",98)(287,"div",98)(288,"div",98)(289,"div",98)(290,"div",98)(291,"div",98)(292,"div",98)(293,"div",98)(294,"div",98)(295,"div",98)(296,"div",98)(297,"div",98)(298,"div",98),C(299,"div",104),y(300,"3"),A(),H(301,"div",101),C(302,"div",105),y(303,"\u{1F3F0}"),A()()(),C(304,"div")(305,"div",96),y(306),A(),C(307,"div",106),H(308,"div",98)(309,"div",98)(310,"div",98)(311,"div",98)(312,"div",98)(313,"div",98)(314,"div",99)(315,"div",99)(316,"div",99)(317,"div",99)(318,"div",98)(319,"div",98)(320,"div",98)(321,"div",98)(322,"div",98)(323,"div",98)(324,"div",98)(325,"div",98)(326,"div",98)(327,"div",98)(328,"div",98)(329,"div",98)(330,"div",98)(331,"div",98)(332,"div",98),C(333,"div",107),y(334,"4"),A(),H(335,"div",101),C(336,"div",102),y(337,"\u{1F3F0}"),A()()()()(),C(338,"div",15)(339,"div",16)(340,"div",9),y(341),A(),C(342,"div",17)(343,"div",108)(344,"div",109),y(345,"\u{1F331}"),A(),C(346,"div",110),y(347),A()(),C(348,"div",111),y(349,"\u2192"),A(),C(350,"div",108)(351,"div",109),y(352,"\u{1F33F}"),A(),C(353,"div",110),y(354),A()(),C(355,"div",111),y(356,"\u2192"),A(),C(357,"div",108)(358,"div",109),y(359,"\u{1F333}"),A(),C(360,"div",112),y(361),A()()()(),C(362,"div",16)(363,"div",9),y(364),A(),C(365,"div",113)(366,"div",108)(367,"div",109),y(368,"\u26F0\uFE0F"),A(),C(369,"div",114),y(370),A()(),C(371,"div",111),y(372,"\u2192"),A(),C(373,"div",108)(374,"div",109),y(375,"\u26CF\uFE0F"),A(),C(376,"div",114),y(377),A()(),C(378,"div",111),y(379,"\u2192"),A(),C(380,"div",108)(381,"div",109),y(382,"\u26CF"),A(),C(383,"div",114),y(384),A()(),C(385,"div",111),y(386,"\u2192"),A(),C(387,"div",108)(388,"div",109),y(389,"\u2692"),A(),C(390,"div",114),y(391),A()(),C(392,"div",111),y(393,"\u2192"),A(),C(394,"div",108)(395,"div",109),y(396,"\u{1F9F1}"),A(),C(397,"div",115),y(398),A()()()(),C(399,"div",16)(400,"div",116),y(401),A(),C(402,"div",117)(403,"div",3),H(404,"div",118),C(405,"div",20),y(406),A()(),C(407,"div",3),H(408,"div",119),C(409,"div",20),y(410),A()(),C(411,"div",3),H(412,"div",120),C(413,"div",20),y(414,"Neutral"),A()()()()(),C(415,"div",121)(416,"div",122)(417,"div",9),y(418),A(),C(419,"div",123),ee(),C(420,"svg",124)(421,"g"),H(422,"polygon",125),A(),C(423,"text",126),y(424),A()(),C(425,"svg",124)(426,"g"),H(427,"polygon",125),A(),C(428,"text",126),y(429),A(),Y(430,wG,1,0,":svg:polygon",127),A(),C(431,"svg",124)(432,"g"),H(433,"polygon",125),A(),C(434,"text",126),y(435),A(),Y(436,xG,1,0,":svg:polygon",127),Y(437,SG,2,0,":svg:g"),A(),C(438,"svg",124)(439,"g"),H(440,"polygon",125),A(),C(441,"text",126),y(442),A(),Y(443,IG,1,0,":svg:polygon",127),Y(444,TG,2,0,":svg:g"),Y(445,CG,4,0,":svg:g"),A()()()(),ke(),C(446,"div",16)(447,"div",9),y(448),A(),C(449,"div",17),ee(),C(450,"svg",128),H(451,"g",129)(452,"g",130)(453,"g",131)(454,"g",132)(455,"g",133),C(456,"g",129),H(457,"circle",134),A(),C(458,"g",130),H(459,"circle",135),A(),C(460,"g",131),H(461,"circle",136),A(),C(462,"g",132),H(463,"line",137)(464,"circle",138),A(),C(465,"g",133),H(466,"circle",139),A()(),ke(),C(467,"div",140),ee(),C(468,"svg",141)(469,"g"),H(470,"polygon",125),A(),C(471,"g"),H(472,"circle",142),A(),C(473,"g"),H(474,"polygon",143)(475,"polygon",144)(476,"polygon",145),A(),C(477,"g"),H(478,"polygon",146)(479,"polygon",147),A(),C(480,"g"),H(481,"polygon",148)(482,"polygon",149)(483,"polygon",150)(484,"polygon",151),A()()(),C(485,"svg",128),H(486,"g",152)(487,"g",153)(488,"g",154)(489,"g",155)(490,"g",156)(491,"g",157),C(492,"g",152),H(493,"rect",158),A(),C(494,"g",153),H(495,"rect",159),A(),C(496,"g",154),H(497,"rect",160),A(),C(498,"g",155),H(499,"rect",161)(500,"rect",162),A(),C(501,"g",156),H(502,"rect",163)(503,"rect",164)(504,"rect",165)(505,"rect",166)(506,"rect",167),A()(),C(507,"svg",128),H(508,"g",168)(509,"g",153)(510,"g",169)(511,"g",170)(512,"g",133),C(513,"g",168),H(514,"polygon",171),A(),C(515,"g",153),H(516,"circle",172),A(),C(517,"g",169),H(518,"line",173)(519,"line",174)(520,"line",175),A(),C(521,"g",170),H(522,"polygon",176)(523,"circle",177)(524,"circle",178)(525,"circle",179),A(),C(526,"g",133),H(527,"polygon",180),A()()()(),ke(),C(528,"div",181)(529,"div",9),y(530),A(),C(531,"div",182),ee(),C(532,"svg",183)(533,"g"),H(534,"circle",184),A(),C(535,"g"),H(536,"circle",185),A()(),C(537,"svg",183)(538,"g"),H(539,"circle",184),A(),C(540,"g"),H(541,"circle",185),A(),C(542,"g"),H(543,"circle",186),A()(),C(544,"svg",183)(545,"g"),H(546,"circle",184),A(),C(547,"g"),H(548,"circle",185),A(),C(549,"g"),H(550,"circle",186),A(),C(551,"g"),H(552,"line",187)(553,"circle",188),A()(),C(554,"svg",183)(555,"g"),H(556,"circle",184),A(),C(557,"g"),H(558,"circle",185),A(),C(559,"g"),H(560,"circle",186),A(),C(561,"g"),H(562,"line",187)(563,"circle",188),A(),C(564,"g"),H(565,"circle",189),A()()(),ke(),C(566,"div",190),ee(),C(567,"svg",191)(568,"g"),H(569,"polygon",125),A(),C(570,"g"),H(571,"circle",142),A()(),C(572,"svg",191)(573,"g"),H(574,"polygon",125),A(),C(575,"g"),H(576,"circle",142),A(),C(577,"g"),H(578,"polygon",143)(579,"polygon",144)(580,"polygon",145),A()(),C(581,"svg",191)(582,"g"),H(583,"polygon",125),A(),C(584,"g"),H(585,"circle",142),A(),C(586,"g"),H(587,"polygon",143)(588,"polygon",144)(589,"polygon",145),A(),C(590,"g"),H(591,"polygon",146)(592,"polygon",147),A()(),C(593,"svg",141)(594,"g"),H(595,"polygon",125),A(),C(596,"g"),H(597,"circle",142),A(),C(598,"g"),H(599,"polygon",143)(600,"polygon",144)(601,"polygon",145),A(),C(602,"g"),H(603,"polygon",146)(604,"polygon",147),A(),C(605,"g"),H(606,"polygon",148)(607,"polygon",149)(608,"polygon",150)(609,"polygon",151),A()()(),ke(),C(610,"div",182),ee(),C(611,"svg",192)(612,"g"),H(613,"rect",193),A(),C(614,"g"),H(615,"rect",194),A()(),C(616,"svg",192)(617,"g"),H(618,"rect",193),A(),C(619,"g"),H(620,"rect",194),A(),C(621,"g"),H(622,"rect",195),A()(),C(623,"svg",192)(624,"g"),H(625,"rect",193),A(),C(626,"g"),H(627,"rect",194),A(),C(628,"g"),H(629,"rect",195),A(),C(630,"g"),H(631,"rect",196)(632,"rect",197),A()(),C(633,"svg",192)(634,"g"),H(635,"rect",193),A(),C(636,"g"),H(637,"rect",194),A(),C(638,"g"),H(639,"rect",195),A(),C(640,"g"),H(641,"rect",196)(642,"rect",197),A(),C(643,"g"),H(644,"rect",198)(645,"rect",199)(646,"rect",200)(647,"rect",201)(648,"rect",202),A()()(),ke(),C(649,"div",190),ee(),C(650,"svg",183)(651,"g"),H(652,"polygon",203),A(),C(653,"g"),H(654,"circle",204),A()(),C(655,"svg",183)(656,"g"),H(657,"polygon",203),A(),C(658,"g"),H(659,"circle",204),A(),C(660,"g"),H(661,"line",205)(662,"line",206)(663,"line",207),A()(),C(664,"svg",183)(665,"g"),H(666,"polygon",203),A(),C(667,"g"),H(668,"circle",204),A(),C(669,"g"),H(670,"line",205)(671,"line",206)(672,"line",207),A(),C(673,"g"),H(674,"polygon",208)(675,"circle",209)(676,"circle",210)(677,"circle",211),A()(),C(678,"svg",183)(679,"g"),H(680,"polygon",203),A(),C(681,"g"),H(682,"circle",204),A(),C(683,"g"),H(684,"line",205)(685,"line",206)(686,"line",207),A(),C(687,"g"),H(688,"polygon",208)(689,"circle",209)(690,"circle",210)(691,"circle",211),A(),C(692,"g"),H(693,"polygon",212),A()()()()()()()),t&2&&(m(5),G(i.settings.t("GAME_GUIDE")),m(2),G(i.settings.t("TURN_BASED_STRATEGY")),m(6),G(i.settings.t("VICTORY_CONDITIONS")),m(7),G(i.settings.t("MONOPOLY_LABEL")),m(2),G(i.settings.t("MONOPOLY_DESC")),m(6),G(i.settings.t("ANNIHILATION")),m(2),G(i.settings.t("ANNIHILATION_DESC")),m(4),G(i.settings.t("UNIT_EVOLUTION")),m(8),et("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),m(17),G(i.settings.t("EVOLUTION_DESC")),m(13),B(" ",i.settings.currentLang()==="uk"?"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0435 \u0443\u043F\u0440\u0430\u0432\u043B\u0456\u043D\u043D\u044F":"Tactical Controls"," "),m(9),B(" ",i.settings.currentLang()==="uk"?"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0438\u0439 \u0432\u0456\u043B\u044C\u043D\u0438\u0439 \u044E\u043D\u0456\u0442":"Cycle through available units"," "),m(13),B(" ",i.settings.currentLang()==="uk"?"\u0420\u0443\u0445 \u0430\u0431\u043E \u0430\u0442\u0430\u043A\u0430 \u0432\u0438\u0431\u0440\u0430\u043D\u0438\u043C \u044E\u043D\u0456\u0442\u043E\u043C":"Move or attack with selected unit"," "),m(5),B(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0445\u0456\u0434":"End player turn"," "),m(4),B(" ",i.settings.currentLang()==="uk"?"\u041D\u0430 \u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043A\u043E\u0436\u043D\u043E\u0433\u043E \u0445\u043E\u0434\u0443 \u0433\u0440\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u0444\u043E\u043A\u0443\u0441\u0443\u0454\u0442\u044C\u0441\u044F \u043D\u0430 \u043C\u043E\u0431\u0456\u043B\u044C\u043D\u043E\u043C\u0443 \u044E\u043D\u0456\u0442\u0456.":"At turn start, the game auto-focuses on your most mobile unit."," "),m(3),G(i.settings.t("COMBAT_DEEP_DIVE")),m(4),G(i.settings.t("SUCCESSFUL_ATTACK")),m(7),G(i.settings.t("SUCCESSFUL_ATTACK_DESC")),m(3),G(i.settings.t("CRITICAL_HIT")),m(9),G(i.settings.t("CRITICAL_HIT_DESC")),m(3),G(i.settings.t("MISS")),m(9),G(i.settings.t("MISS_DESC")),m(4),B(" ",i.settings.currentLang()==="uk"?"\u0414\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0438":"Extra Mechanics"," "),m(6),B(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043A\u0440\u0438\u0442\u0443":"Crit Chance"," "),m(5),B(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u0443":"Miss Chance"," "),m(7),B(" ",i.settings.currentLang()==="uk"?"\u043F\u0440\u0438 \u0440\u0456\u0432\u043D\u0438\u0445 \u0441\u0438\u043B\u0430\u0445: \u0417\u0430\u0445\u0438\u0441\u0442/\u041D\u0456\u0447\u0438\u044F":"at equal force: Defense/Draw"," "),m(5),Vt("fill","url(#vol-fill-player)"),m(10),B(" ",i.settings.currentLang()==="uk"?"-10% \u0443 \u0432\u043E\u0440\u043E\u0433\u0430 \u0448\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u043D\u0443\u0442\u0438\u0441\u044C":"-10% enemy chance to miss"," "),m(4),Vt("fill","url(#vol-fill-player)"),m(11),B(" ",i.settings.currentLang()==="uk"?"10% \u0448\u0430\u043D\u0441 \u043F\u043E\u043F\u0430\u0441\u0442\u0438 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0443":"10% chance to hit the enemy"," "),m(4),B(" ",i.settings.currentLang()==="uk"?"\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F Tier-\u0440\u0456\u0432\u043D\u0456\u0432":"Tier Values"," "),m(25),Vt("fill","url(#vol-fill-player)"),m(9),B(" ",i.settings.currentLang()==="uk"?"+1 \u0434\u043E \u0430\u0442\u0430\u043A\u0438 \u0432\u0456\u0434 \u0441\u0443\u0441\u0456\u0434\u0441\u0442\u0432\u0430":"+1 to an attack from the neighborhood"," "),m(3),G(i.settings.t("MOVEMENT")),m(4),G(i.settings.t("T1_1_TILE")),m(30),et("left",6,"px")("top",6,"px"),m(4),G(i.settings.t("T3_3_TILES")),m(30),et("right",6,"px")("bottom",6,"px"),m(4),G(i.settings.t("T4_4_TILES")),m(30),et("left",6,"px")("top",6,"px"),m(5),G(i.settings.t("FOREST_CYCLE")),m(6),G(i.settings.t("TURN_1")),m(7),G(i.settings.t("TURN_2")),m(7),G(i.settings.t("PLUS_8_WOOD_PER_TURN")),m(3),G(i.settings.t("IRON_CYCLE")),m(6),G(i.settings.t("TURN_1")),m(7),G(i.settings.t("TURN_2")),m(7),G(i.settings.t("TURN_3")),m(7),G(i.settings.t("TURN_4")),m(7),G(i.settings.t("PLUS_2_IRON_PER_TURN")),m(3),G(i.settings.t("WALL_LEGEND")),m(5),G(i.settings.t("PLAYER")),m(4),G(i.settings.t("AI_FACTION")),m(8),B(" ",i.settings.currentLang()==="uk"?"\u0422\u0440\u0435\u0442\u044F \u0456\u0442\u0435\u0440\u0430\u0446\u0456\u044F \u043E\u0434\u0438\u043D\u0438\u0446\u044C":"Third iteration the units"," "),m(6),B(" ",1," "),m(5),B(" ",2," "),m(),Q(430),m(5),B(" ",3," "),m(),Q(436),m(),Q(437),m(5),B(" ",4," "),m(),Q(443),m(),Q(444),m(),Q(445),m(3),G(i.settings.t("NEW_DESIGN_UNIT")),m(82),G(i.settings.t("NEW_UNIT_EVOLUTION")))},dependencies:[Pt],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:60px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:10px;font-size:12px;font-weight:800;color:#fde047;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:10px;font-size:12px;font-weight:800;color:#93c5fd;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}.unit-svg-wrapper-game_rules:hover{transform:scale(1)}
`],encapsulation:2})};var g0=class n{constructor(e){this.gameEngine=e}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(he(ri))};static \u0275cmp=St({type:n,selectors:[["app-support-community"]],decls:51,vars:0,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),y(4,"Support & Community"),A(),C(5,"button",4),Ht("click",function(){return i.gameEngine.closeSupport()}),y(6," \u2716 "),A()(),C(7,"div",5)(8,"div",6)(9,"div",7),y(10,"Donate"),A(),C(11,"div",8),y(12,"Monobank Jar"),A(),C(13,"div",9)(14,"div",10),H(15,"img",11),A(),C(16,"div",12)(17,"div",13),y(18,"send.monobank.ua/jar/2fqGoPhV7G"),A(),C(19,"div",14)(20,"button",15),Ht("click",function(){return i.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),y(21," Open Link \u{1F4DC} "),A(),C(22,"button",16),Ht("click",function(){return i.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),y(23," Copy Link \u{1F4CB} "),A()()()(),C(24,"div",17)(25,"div",8),y(26,"Donatello"),A(),C(27,"button",18),Ht("click",function(){return i.openExternalLink("https://donatello.to/jaerbi")}),y(28," Go to Donatello.to \u{1F48E} "),A()(),C(29,"div",19),y(30,"Thank you for supporting the project!"),A()(),C(31,"div",6)(32,"div",7),y(33,"Social & Feedback"),A(),C(34,"div",20)(35,"button",21),Ht("click",function(){return i.openExternalLink("https://discord.gg/c9tCWFtFaG")}),C(36,"span",22),y(37,"\u{1F5E8}\uFE0F"),A(),C(38,"div",23)(39,"div",24),y(40,"Discord Server"),A(),C(41,"div",25),y(42,"Share ideas & feedback"),A()()(),C(43,"button",26),Ht("click",function(){return i.openExternalLink("https://www.youtube.com/@jaerb1")}),C(44,"span",22),y(45,"\u25B6\uFE0F"),A(),C(46,"div",23)(47,"div",24),y(48,"YouTube"),A(),C(49,"div",25),y(50,"Dev logs & gameplay"),A()()()()()()()())},dependencies:[Pt],encapsulation:2})};function DG(n,e){if(n&1){let t=Ge();v(0,"button",7),te("click",function(){ne(t);let r=k();return ie(r.switchToMyStats())}),y(1," My Statistics "),E()}if(n&2){let t=k();Me("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function AG(n,e){n&1&&(v(0,"div",15)(1,"span",16),W(2,"span",17),v(3,"span"),y(4,"Loading..."),E()()())}function MG(n,e){if(n&1&&W(0,"img",27),n&2){let t=k().$implicit;Ie("src",t.userPhoto,Zi)}}function RG(n,e){n&1&&(v(0,"div",28),y(1,"\u{1F464}"),E())}function PG(n,e){if(n&1&&(v(0,"tr",22)(1,"td",23),y(2),E(),v(3,"td",24),Qt(4,MG,1,1,"img",25)(5,RG,2,0,"ng-template",null,0,co),y(7),E(),v(8,"td",23),y(9),E(),v(10,"td",26),y(11),E()()),n&2){let t=e.$implicit,i=e.index,r=Xi(6),o=k(3);Me("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),m(2),G(i+1),m(2),Ie("ngIf",t.userPhoto)("ngIfElse",r),m(3),B(" ",t.playerName," "),m(2),G(t.victoryType),m(2),G(t.turnsPlayed)}}function NG(n,e){if(n&1&&(v(0,"tr")(1,"td",29),y(2),W(3,"br"),v(4,"span",30),y(5,"Be the first to claim victory!"),E()()()),n&2){let t=k(3);m(2),Mt(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function kG(n,e){if(n&1&&(v(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),y(5,"Rank"),E(),v(6,"th",20),y(7,"Name"),E(),v(8,"th",20),y(9,"Victory Type"),E(),v(10,"th",20),y(11,"Turns"),E()()(),v(12,"tbody"),Qt(13,PG,12,12,"tr",21)(14,NG,6,2,"tr",9),E()()()),n&2){let t=k(2);m(13),Ie("ngForOf",t.scores()),m(),Ie("ngIf",t.scores().length===0)}}function OG(n,e){if(n&1&&(v(0,"div")(1,"div",11)(2,"span"),y(3,"Top 10 scores for:"),E(),v(4,"span",12),y(5),E(),v(6,"span",13),y(7),E()(),Qt(8,AG,5,0,"div",14)(9,kG,15,2,"div",9),E()),n&2){let t=k();m(5),B(" ",t.settings.difficultyLabel()," "),m(2),B(" ",t.settings.mapSizeLabel()," "),m(),Ie("ngIf",t.loading()),m(),Ie("ngIf",!t.loading())}}function FG(n,e){n&1&&(v(0,"div",15)(1,"span",16),W(2,"span",17),v(3,"span"),y(4,"Loading your stats..."),E()()())}function LG(n,e){n&1&&(v(0,"div",35),y(1," No victories recorded yet. keep playing! "),E())}function VG(n,e){if(n&1&&(v(0,"div",36)(1,"div",37)(2,"span",38),y(3),E(),v(4,"span",39),y(5),E()(),v(6,"div",40)(7,"span",41),y(8,"Best Performance"),E(),v(9,"span",42),y(10),E()(),v(11,"div",43),y(12),Rr(13,"date"),E()()),n&2){let t=e.$implicit;m(3),B(" ",t.difficulty," "),m(2),B(" ",t.mapSize," "),m(5),B("",t.turnsPlayed," Turns"),m(2),Mt(" ",t.victoryType," \u2022 ",lo(13,5,t.timestamp,"mediumDate")," ")}}function UG(n,e){if(n&1&&(v(0,"div",32),Qt(1,LG,2,0,"div",33)(2,VG,14,8,"div",34),E()),n&2){let t=k(2);m(),Ie("ngIf",t.myBestScores().length===0),m(),Ie("ngForOf",t.myBestScores())}}function BG(n,e){if(n&1&&(v(0,"div",22),Qt(1,FG,5,0,"div",14)(2,UG,3,2,"div",31),E()),n&2){let t=k();m(),Ie("ngIf",t.loading()),m(),Ie("ngIf",!t.loading())}}var m0=class n{constructor(e,t,i,r){this.firebase=e;this.gameEngine=t;this.playerName=i;this.settings=r;this.fetch()}loading=$(!0);scores=$([]);activeTab=$("top10");myBestScores=$([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),i=await this.firebase.getTopScores(10,e,t);this.scores.set(i??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),i=new Map;t.forEach(r=>{let o=`${r.difficulty}-${r.mapSize}`;(!i.has(o)||r.turnsPlayed<i.get(o).turnsPlayed)&&i.set(o,r)}),this.myBestScores.set(Array.from(i.values()).sort((r,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[r.difficulty];return a!==0?a:r.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(he(Rn),he(ri),he(bc),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,i){t&1&&(v(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),y(4,"Leaderboard"),E(),v(5,"button",5),te("click",function(){return i.gameEngine.closeLeaderboard()}),y(6," \u2716 "),E()(),v(7,"div",6)(8,"button",7),te("click",function(){return i.activeTab.set("top10")}),y(9," Top 10 "),E(),Qt(10,DG,2,6,"button",8),E(),Qt(11,OG,10,4,"div",9)(12,BG,3,2,"div",10),E()()),t&2&&(m(8),Me("text-white",i.activeTab()==="top10")("border-b-2",i.activeTab()==="top10")("border-indigo-500",i.activeTab()==="top10"),m(2),Ie("ngIf",i.firebase.user$()),m(),Ie("ngIf",i.activeTab()==="top10"),m(),Ie("ngIf",i.activeTab()==="mystats"))},dependencies:[Pt,cs,ya,va],encapsulation:2})};function jG(n,e){if(n&1&&(ee(),C(0,"text",4),y(1),A()),n&2){let t=k(2);m(),B(" ",t.unit.level," ")}}function HG(n,e){n&1&&(ee(),C(0,"g"),H(1,"path",10)(2,"path",11),A())}function $G(n,e){n&1&&(ee(),C(0,"g",5),H(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function GG(n,e){n&1&&(ee(),C(0,"g",6),H(1,"path",15)(2,"path",16),A())}function zG(n,e){n&1&&(ee(),H(0,"circle",7))}function WG(n,e){n&1&&(ee(),H(0,"circle",8))}function qG(n,e){n&1&&(ee(),H(0,"circle",9))}function KG(n,e){if(n&1&&(ee(),C(0,"svg",0),H(1,"circle",2)(2,"circle",3),Y(3,jG,2,1,":svg:text",4),Y(4,HG,3,0,":svg:g"),Y(5,$G,4,0,":svg:g",5),Y(6,GG,3,0,":svg:g",6),Y(7,zG,1,0,":svg:circle",7),Y(8,WG,1,0,":svg:circle",8),Y(9,qG,1,0,":svg:circle",9),A()),n&2){let t=k();m(),Vt("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),Q(t.isTower?-1:3),m(),Q(t.gameEngine.hasDefenseBonus(t.unit)&&!t.isTower?4:-1),m(),Q(t.unit.hasWeapon?5:-1),m(),Q(t.unit.hasArmor?6:-1),m(),Q(t.unit.level>=2?7:-1),m(),Q(t.unit.level>=3?8:-1),m(),Q(t.unit.level>=4?9:-1)}}function YG(n,e){if(n&1&&(ee(),C(0,"text",20),y(1),A()),n&2){let t=k(2);m(),B(" ",t.unit.level," ")}}function QG(n,e){n&1&&(ee(),C(0,"g"),H(1,"path",10)(2,"path",11),A())}function JG(n,e){n&1&&(ee(),C(0,"g",5),H(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function ZG(n,e){n&1&&(ee(),C(0,"g",6),H(1,"path",15)(2,"path",16),A())}function XG(n,e){n&1&&(ee(),H(0,"polygon",21))}function ez(n,e){n&1&&(ee(),H(0,"polygon",22))}function tz(n,e){n&1&&(ee(),C(0,"g"),H(1,"polygon",23)(2,"polygon",24)(3,"polygon",25),A())}function nz(n,e){if(n&1&&(ee(),C(0,"svg",1)(1,"g",17),H(2,"polygon",18)(3,"polygon",19),Y(4,YG,2,1,":svg:text",20),Y(5,QG,3,0,":svg:g"),Y(6,JG,4,0,":svg:g",5),Y(7,ZG,3,0,":svg:g",6),Y(8,XG,1,0,":svg:polygon",21),Y(9,ez,1,0,":svg:polygon",22),Y(10,tz,4,0,":svg:g"),A()()),n&2){let t=k();m(2),Vt("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),Q(t.isTower?-1:4),m(),Q(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),m(),Q(t.unit.hasWeapon?6:-1),m(),Q(t.unit.hasArmor?7:-1),m(),Q(t.unit.level>=2?8:-1),m(),Q(t.unit.level>=3?9:-1),m(),Q(t.unit.level>=4?10:-1)}}function iz(n,e){if(n&1&&(ee(),C(0,"text",28),y(1),A()),n&2){let t=k(2);m(),B(" ",t.unit.level," ")}}function rz(n,e){n&1&&(ee(),C(0,"g"),H(1,"path",10)(2,"path",11),A())}function oz(n,e){n&1&&(ee(),C(0,"g",5),H(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function sz(n,e){n&1&&(ee(),C(0,"g",6),H(1,"path",15)(2,"path",16),A())}function az(n,e){n&1&&(ee(),H(0,"rect",29))}function lz(n,e){n&1&&(ee(),H(0,"rect",30))}function cz(n,e){n&1&&(ee(),H(0,"rect",31)(1,"rect",32)(2,"rect",33)(3,"rect",34))}function uz(n,e){if(n&1&&(ee(),C(0,"svg",0),H(1,"rect",26)(2,"rect",27),Y(3,iz,2,1,":svg:text",28),Y(4,rz,3,0,":svg:g"),Y(5,oz,4,0,":svg:g",5),Y(6,sz,3,0,":svg:g",6),Y(7,az,1,0,":svg:rect",29),Y(8,lz,1,0,":svg:rect",30),Y(9,cz,4,0),A()),n&2){let t=k();m(),Vt("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),Q(t.isTower?-1:3),m(),Q(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),m(),Q(t.unit.hasWeapon?5:-1),m(),Q(t.unit.hasArmor?6:-1),m(),Q(t.unit.level>=2?7:-1),m(),Q(t.unit.level>=3?8:-1),m(),Q(t.unit.level>=4?9:-1)}}function dz(n,e){if(n&1&&(ee(),C(0,"text",37),y(1),A()),n&2){let t=k(2);m(),B(" ",t.unit.level," ")}}function hz(n,e){n&1&&(ee(),C(0,"g"),H(1,"path",10)(2,"path",11),A())}function fz(n,e){n&1&&(ee(),C(0,"g",5),H(1,"rect",12)(2,"polygon",13)(3,"rect",14),A())}function pz(n,e){n&1&&(ee(),C(0,"g",6),H(1,"path",15)(2,"path",16),A())}function gz(n,e){n&1&&(ee(),H(0,"polygon",38))}function mz(n,e){n&1&&(ee(),H(0,"polygon",39))}function yz(n,e){n&1&&(ee(),H(0,"circle",40)(1,"circle",41)(2,"circle",42)(3,"circle",43)(4,"circle",44)(5,"circle",45))}function vz(n,e){if(n&1&&(ee(),C(0,"svg",0),H(1,"polygon",35)(2,"polygon",36),Y(3,dz,2,1,":svg:text",37),Y(4,hz,3,0,":svg:g"),Y(5,fz,4,0,":svg:g",5),Y(6,pz,3,0,":svg:g",6),Y(7,gz,1,0,":svg:polygon",38),Y(8,mz,1,0,":svg:polygon",39),Y(9,yz,6,0),A()),n&2){let t=k();m(),Vt("fill","url(#vol-fill-"+t.unit.owner+")"),m(2),Q(t.isTower?-1:3),m(),Q(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),m(),Q(t.unit.hasWeapon?5:-1),m(),Q(t.unit.hasArmor?6:-1),m(),Q(t.unit.level>=2?7:-1),m(),Q(t.unit.level>=3?8:-1),m(),Q(t.unit.level>=4?9:-1)}}var y0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}unit;isTower=!1;static \u0275fac=function(t){return new(t||n)(he(ri),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-units"]],inputs:{unit:"unit",isTower:"isTower"},decls:4,vars:1,consts:[["viewBox","0 0 100 100",1,"w-full","h-full"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-95"],["cx","50","cy","50","r","32","filter","url(#soft-shadow)"],["cx","50","cy","50","r","31","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","61","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["transform","rotate(-45 30 14)"],["transform","translate(16, 2)"],["cx","50","cy","50","r","35","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["cx","50","cy","50","r","40","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["cx","50","cy","50","r","28","fill","none","stroke","var(--u-light)","stroke-width","2"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","var(--u-light)","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],["x","5","y","0","width","2","height","10","fill","var(--u-light)"],["points","6,-2 8,2 4,2","fill","var(--u-light)"],["x","3","y","10","width","6","height","2","fill","var(--u-fill)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","var(--u-light)"],["d","M5 3V8M3 5H9","stroke","var(--u-fill)","stroke-width","1.2","stroke-linecap","round","opacity","0.7"],["transform","translate(0, 4)"],["points","50,16 86,78 14,78","filter","url(#soft-shadow)"],["points","50,18 82,74 18,74","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","50","y","68","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2","stroke-linejoin","round"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["points","50,0 56,10 44,10","fill","var(--u-light)","stroke-linejoin","round"],["points","99,87 92,74 84,87","fill","var(--u-light)","stroke-linejoin","round"],["points","1,87 15,87 8,74","fill","var(--u-light)","stroke-linejoin","round"],["x","21","y","21","width","56","height","56","rx","6","filter","url(#soft-shadow)"],["x","23","y","23","width","52","height","52","rx","5","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","60","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["x","18","y","18","width","62","height","62","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","14","y","14","width","70","height","70","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["x","12","y","12","width","8","height","8","fill","var(--u-light)"],["x","78","y","12","width","8","height","8","fill","var(--u-light)"],["x","12","y","78","width","8","height","8","fill","var(--u-light)"],["x","78","y","78","width","8","height","8","fill","var(--u-light)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","filter","url(#soft-shadow)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","fill","none","stroke","var(--u-light)","stroke-width","2","opacity","0.4"],["x","49","y","62","text-anchor","middle","font-size","28","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,17 81,35 81,65 50,83 19,65 19,35","fill","none","stroke","var(--u-core)","stroke-width","1.5","stroke-linejoin","round"],["points","50,12 86,32 86,68 50,88 14,68 14,32","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["cx","50","cy","12","r","3","fill","var(--u-light)"],["cx","86","cy","32","r","3","fill","var(--u-light)"],["cx","86","cy","68","r","3","fill","var(--u-light)"],["cx","50","cy","88","r","3","fill","var(--u-light)"],["cx","14","cy","68","r","3","fill","var(--u-light)"],["cx","14","cy","32","r","3","fill","var(--u-light)"]],template:function(t,i){if(t&1&&Y(0,KG,10,8,":svg:svg",0)(1,nz,11,8,":svg:svg",1)(2,uz,10,8,":svg:svg",0)(3,vz,10,8,":svg:svg",0),t&2){let r;Q((r=i.unit.tier)===1?0:r===2?1:r===3?2:r===4?3:-1)}},dependencies:[Pt],encapsulation:2})};function _z(n,e){if(n&1){let t=Ge();C(0,"div",7)(1,"div",8),y(2),A(),C(3,"button",9),Ht("click",function(){ne(t);let r=k();return ie(r.gameEngine.cancelSandboxSpawn())}),y(4),A()()}if(n&2){let t=k();m(2),B(" ",t.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u0438":"Click an empty tile to spawn"," "),m(2),B(" ",t.settings.currentLang()==="uk"?"\u0412\u0456\u0434\u043C\u0456\u043D\u0430":"Cancel"," ")}}var v0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(he(ri),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-sandbox"]],decls:24,vars:3,consts:[[1,"absolute","-top-7","left-[-10px]","ml-2","px-3","py-1","rounded-full","bg-pink-600/20","border","border-pink-500/30","text-pink-200","text-[10px]","font-black","uppercase","tracking-widest"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-28","right-[-254px]","min-w-[238px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"mt-2","flex","flex-col","gap-2","w-full","px-2","py-2","rounded-lg","border","border-white/5","bg-white/5"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-pink-200"],[1,"grid","grid-cols-4","gap-2"],[1,"px-2","py-1","rounded","bg-blue-600/20","border","border-blue-500/30","text-blue-100","text-[10px]","cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","bg-red-600/20","border","border-red-500/30","text-red-100","text-[10px]","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-[10px]","text-gray-300"],[1,"px-2","py-1","rounded","bg-gray-700","hover:bg-gray-600","border","border-gray-600","text-white","text-[10px]","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(C(0,"div",0),y(1),A(),C(2,"div",1)(3,"div",2)(4,"div",3),y(5),A(),C(6,"div",4)(7,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",1)}),y(8," T1 "),A(),C(9,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",2)}),y(10," T2 "),A(),C(11,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",3)}),y(12," T3 "),A(),C(13,"button",5),Ht("click",function(){return i.gameEngine.startSandboxSpawn("player",4)}),y(14," T4 "),A(),C(15,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",1)}),y(16," T1 "),A(),C(17,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",2)}),y(18," T2 "),A(),C(19,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",3)}),y(20," T3 "),A(),C(21,"button",6),Ht("click",function(){return i.gameEngine.startSandboxSpawn("ai",4)}),y(22," T4 "),A()(),Y(23,_z,5,2,"div",7),A()()),t&2&&(m(),B(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox",`
`),m(4),B(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox"," "),m(18),Q(i.gameEngine.sandboxSpawnPending()?23:-1))},dependencies:[Pt],encapsulation:2})};var Ez=["boardContainer"],Ct=(n,e)=>({x:n,y:e}),bz=()=>[10,20,30],wz=(n,e)=>e.id,oO=(n,e)=>e.date;function xz(n,e){if(n&1){let t=Ge();v(0,"div",82)(1,"div",233)(2,"span",234),y(3),E(),v(4,"button",235),te("click",function(){ne(t);let r=k();return ie(r.firebase.logout())}),y(5),E()(),v(6,"div",236),W(7,"img",237)(8,"div",238),E()()}if(n&2){let t=k();m(3),B(" ",t.settings.t("VERIFIED")," "),m(2),B(" ",t.settings.t("LOGOUT")," "),m(2),Ie("src",e.photoURL,Zi)}}function Sz(n,e){if(n&1){let t=Ge();v(0,"button",239),te("click",function(){ne(t);let r=k();return ie(r.firebase.loginWithGoogle())}),W(1,"div",240),v(2,"span",241),y(3),E()()}if(n&2){let t=k();m(3),B(" ",t.settings.t("CONNECT")," ")}}function Iz(n,e){if(n&1){let t=Ge();v(0,"div",82)(1,"div",233)(2,"span",234),y(3),E(),v(4,"button",235),te("click",function(){ne(t);let r=k(2);return ie(r.firebase.logout())}),y(5),E()(),v(6,"div",236),W(7,"img",237)(8,"div",238),E()(),v(9,"button",197),te("click",function(){ne(t);let r=k(2);return ie(r.toggleAutoBattle())}),v(10,"div",198)(11,"span",199),y(12),E(),v(13,"span",200),y(14),E()(),v(15,"div",198),W(16,"span",201),E(),W(17,"div",202),E()}if(n&2){let t=k(2);m(3),B(" ",t.settings.t("VERIFIED")," "),m(2),B(" ",t.settings.t("LOGOUT")," "),m(2),Ie("src",e.photoURL,Zi),m(2),Me("ring-2",t.isAutoBattleActive())("ring-green-400",t.isAutoBattleActive()),Ie("disabled",t.gameEngine.gameStatus()!=="playing"),m(3),G(t.settings.t("AUTO")),m(2),G(t.settings.t("ENGAGE")),m(2),Me("bg-green-400",t.isAutoBattleActive())("bg-gray-500",!t.isAutoBattleActive())}}function Tz(n,e){if(n&1){let t=Ge();v(0,"button",239),te("click",function(){ne(t);let r=k(2);return ie(r.firebase.loginWithGoogle())}),W(1,"div",240),v(2,"span",241),y(3),E()()}if(n&2){let t=k(2);m(3),B(" ",t.settings.t("CONNECT")," ")}}function Cz(n,e){if(n&1){let t=Ge();v(0,"div",119)(1,"div",242)(2,"button",243),te("click",function(){ne(t);let r=k();return ie(r.closeMobileMenu())}),ee(),v(3,"svg",103),W(4,"path",244),E()(),ke(),v(5,"button",245),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.resetGame())}),y(6),E(),v(7,"button",245),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.toggleRules())}),y(8),E(),v(9,"button",245),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.toggleLeaderboard())}),y(10),E(),v(11,"button",245),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.toggleLog())}),y(12),E(),v(13,"button",245),te("click",function(){ne(t);let r=k();return ie(r.navigateToFeedback())}),y(14),E(),v(15,"button",245),te("click",function(){ne(t);let r=k();return ie(r.navigateToRoadmap())}),y(16),E(),v(17,"button",245),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.toggleSettings())}),y(18),E(),v(19,"button",245),te("click",function(){ne(t);let r=k();return ie(r.navigateToRoadmap())}),y(20),E(),Y(21,Iz,18,14)(22,Tz,4,1,"button",83),E()()}if(n&2){let t,i=k();m(6),G(i.settings.t("RELOAD")),m(2),G(i.settings.t("INFO")),m(2),G(i.settings.t("RANKING")),m(2),G(i.settings.t("SYSTEM_LOG")),m(2),G(i.settings.t("FEEDBACK_MODULE")),m(2),G(i.settings.t("STRATEGIC_PLAN")),m(2),G(i.settings.t("SETTINGS")),m(2),G(i.settings.t("STRATEGIC_PLAN")),m(),Q((t=i.firebase.user$())?21:22,t)}}function Dz(n,e){if(n&1&&(v(0,"div",161),y(1),E()),n&2){let t=k();m(),ss(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function Az(n,e){if(n&1&&(v(0,"div",248),y(1),E()),n&2){let t=k(2);m(),G(t.gameEngine.endReason())}}function Mz(n,e){if(n&1){let t=Ge();v(0,"div",249)(1,"div",252),y(2),E(),W(3,"input",253,1),v(5,"button",254),te("click",function(){ne(t);let r=Xi(4),o=k(2);return ie(o.gameEngine.confirmAndSaveScore(r.value))}),y(6),E()()}if(n&2){let t=k(2);m(2),G(t.settings.t("CONFIRM_NAME")),m(),Ie("value",t.gameEngine.getPlayerName()),m(3),B(" ",t.settings.t("SAVE_SCORE")," ")}}function Rz(n,e){if(n&1){let t=Ge();v(0,"div",169)(1,"div",246)(2,"h2",247),y(3),Rr(4,"titlecase"),E(),Y(5,Az,2,1,"div",248),Y(6,Mz,7,3,"div",249),v(7,"button",250),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.resetGame())}),y(8),E()(),v(9,"button",251),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.toggleLeaderboard())}),y(10),E()()}if(n&2){let t=k();m(2),Me("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),m(),B(" ",vE(4,9,t.gameEngine.gameStatus()),"! "),m(2),Q(t.gameEngine.endReason()?5:-1),m(),Q(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),m(2),B(" ",t.settings.t("PLAY_AGAIN")," "),m(2),B(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function Pz(n,e){n&1&&W(0,"app-support-community")}function Nz(n,e){n&1&&W(0,"app-leaderboard-modal")}function kz(n,e){n&1&&W(0,"app-sandbox")}function Oz(n,e){if(n&1&&(v(0,"div",184)(1,"span",255),y(2),E()()),n&2){let t=k();m(2),B(" ",t.gameEngine.baseHealth().ai," ")}}function Fz(n,e){n&1&&(v(0,"span",267),y(1," \u{1F92C} "),E()),n&2&&et("z-index",100)}function Lz(n,e){n&1&&(v(0,"span",267),y(1," \u{1F620} "),E()),n&2&&et("z-index",100)}function Vz(n,e){if(n&1&&Y(0,Fz,2,2,"span",266)(1,Lz,2,2,"span",266),n&2){let t=k(3);Q(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function Uz(n,e){n&1&&W(0,"div",259)}function Bz(n,e){if(n&1){let t=Ge();v(0,"button",268),te("click",function(){ne(t);let r=k().$implicit,o=k().$implicit,s=k();return ie(s.gameEngine.buildForgeAt({x:r,y:o}))}),y(1," Build Forge "),E()}n&2&&et("z-index",60)}function jz(n,e){if(n&1&&(v(0,"span",269),y(1),E()),n&2){let t=k().$implicit,i=k().$implicit,r=k();et("z-index",55),m(),B(" ",r.gameEngine.getForgeProgress(t,i),"% ")}}function Hz(n,e){n&1&&(v(0,"span",273),ee(),v(1,"svg",274)(2,"g",275),W(3,"rect",276)(4,"rect",277)(5,"path",278)(6,"rect",279)(7,"rect",280),E()()()),n&2&&et("z-index",50)}function $z(n,e){if(n&1){let t=Ge();v(0,"button",284),te("click",function(){ne(t),k(3);let r=Mr(5),o=k(2);return ie(o.gameEngine.buyWeapon(r.id))}),y(1," Weapon "),E()}}function Gz(n,e){if(n&1){let t=Ge();v(0,"button",285),te("click",function(){ne(t),k(3);let r=Mr(5),o=k(2);return ie(o.gameEngine.buyArmor(r.id))}),y(1," Armor "),E()}}function zz(n,e){if(n&1&&(v(0,"div",281),Y(1,$z,2,0,"button",282),Y(2,Gz,2,0,"button",283),E()),n&2){k(2);let t=Mr(5),i=k(2);et("z-index",60),m(),Q(!t.hasWeapon&&i.gameEngine.resources().iron>=20?1:-1),m(),Q(!t.hasArmor&&i.gameEngine.resources().iron>=20?2:-1)}}function Wz(n,e){if(n&1&&(v(0,"span",270),y(1," Forge "),E(),Y(2,Hz,8,2,"span",271),Y(3,zz,3,4,"div",272)),n&2){let t=k().$implicit,i=Mr(5),r=k().$implicit,o=k();et("z-index",55),Me("scale-60",i&&i.owner==="player")("scale-50",i&&i.owner==="player")("top-1",!(i&&i.owner==="player"))("left-1",!(i&&i.owner==="player"))("top-0",i&&i.owner==="player")("-right-1",i&&i.owner==="player"),m(2),Q(o.gameEngine.isVisibleToPlayer(t,r)?2:-1),m(),Q(i&&i.owner==="player"?3:-1)}}function qz(n,e){n&1&&(ee(),v(0,"g",291),W(1,"polygon",294)(2,"polygon",295),E())}function Kz(n,e){n&1&&(ee(),v(0,"g",296),W(1,"rect",297),E(),v(2,"g",298),W(3,"rect",299)(4,"path",300),E())}function Yz(n,e){if(n&1&&(v(0,"span",286),ee(),v(1,"svg",287)(2,"defs")(3,"linearGradient",288),W(4,"stop",289)(5,"stop",290),E()(),Y(6,qz,3,0,":svg:g",291),v(7,"g"),W(8,"polygon",292)(9,"rect",293),E(),Y(10,Kz,5,0),E()()),n&2){k();let t=Mr(5);Me("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),m(6),Q(t?-1:6),m(),Me("scale-90",t),m(3),Q(t?-1:10)}}function Qz(n,e){n&1&&(ee(),v(0,"g",304),W(1,"rect",305)(2,"path",306),E())}function Jz(n,e){if(n&1&&(v(0,"span",286),ee(),v(1,"svg",287)(2,"g"),W(3,"ellipse",301)(4,"path",302)(5,"circle",303),E(),Y(6,Qz,3,0,":svg:g",304),E()()),n&2){k();let t=Mr(5);Me("scale-50",t)("opacity-40",t)("-translate-x-4",t)("translate-y-4",t),m(6),Q(t?-1:6)}}function Zz(n,e){n&1&&W(0,"div",307),n&2&&et("height",2,"px")}function Xz(n,e){if(n&1&&(v(0,"span",308),y(1),E(),v(2,"span",309),y(3),E()),n&2){let t=k(3);m(),B(" ",t.gameEngine.baseHealth().player," "),m(2),B(" ",t.gameEngine.reservePoints().player," ")}}function eW(n,e){if(n&1&&(v(0,"span",310),y(1),E(),v(2,"span",311),y(3),E()),n&2){let t=k(4);m(),B(" ",t.gameEngine.baseHealth().ai," "),m(2),B(" ",t.gameEngine.reservePoints().ai," ")}}function tW(n,e){if(n&1&&Y(0,eW,4,2),n&2){let t=k().$implicit,i=k().$implicit,r=k();Q(r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function nW(n,e){n&1&&(ee(),v(0,"svg",317),W(1,"path",318),E())}function iW(n,e){n&1&&(ee(),v(0,"svg",317),W(1,"path",319),E())}function rW(n,e){if(n&1){let t=Ge();v(0,"button",316),te("click",function(r){ne(t);let o=k(2),s=k(2).$implicit,a=k().$implicit,l=k();return ie(o.owner==="player"?l.onDestroyIconClick(r,s,a,s+1,a):l.onAttackIconClick(r,s,a,s+1,a))}),Y(1,nW,2,0,":svg:svg",317)(2,iW,2,0,":svg:svg",317),E()}if(n&2){let t=k(2),i=k(4);et("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Me("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),m(),Q(t.owner==="player"?1:2)}}function oW(n,e){if(n&1){let t=Ge();v(0,"div",314),te("mouseenter",function(){ne(t);let r=k(),o=k(4);return ie(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){ne(t);let r=k(5);return ie(r.gameEngine.hoverFormationById(null))}),Y(1,rW,3,13,"button",315),E()}if(n&2){let t=k(),i=k(2).$implicit,r=k().$implicit,o=k();et("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","height 0.25s ease-out"),Me("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Vt("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),m(),Q(o.gameEngine.canShowAttackIcon(_t(26,Ct,i,r),_t(29,Ct,i+1,r))?1:-1)}}function sW(n,e){if(n&1&&Y(0,oW,2,32,"div",313),n&2){let t=k(2).$implicit,i=k().$implicit,r=k();Q(r.gameEngine.shouldRenderWall(_t(1,Ct,t,i),_t(4,Ct,t+1,i),e.owner)?0:-1)}}function aW(n,e){if(n&1){let t=Ge();v(0,"button",323),te("click",function(r){ne(t);let o=k(3).$implicit,s=k().$implicit,a=k();return ie(a.onBuildIconClick(r,o,s,o+1,s))}),y(1," \u2714 "),E()}if(n&2){let t=k(5);et("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function lW(n,e){if(n&1&&(v(0,"span",322),y(1),E()),n&2){let t=k(3).$implicit,i=k().$implicit,r=k();m(),Mt(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,Ct,t,i),_t(5,Ct,t+1,i))," ")}}function cW(n,e){if(n&1&&(v(0,"div",320),Y(1,aW,2,8,"button",321),Y(2,lW,2,8,"span",322),E()),n&2){let t=k(2).$implicit,i=k().$implicit,r=k();et("right",-r.gameEngine.wallThicknessPx-2,"px")("width",r.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Me("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,Ct,t,i),_t(19,Ct,t+1,i)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,Ct,t,i),_t(25,Ct,t+1,i))),m(),Q(r.gameEngine.canShowBuildIcon(_t(28,Ct,t,i),_t(31,Ct,t+1,i))?1:-1),m(),Q(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t+1,i))&&r.gameEngine.edgeCooldownRemaining(_t(34,Ct,t,i),_t(37,Ct,t+1,i))>0?2:-1)}}function uW(n,e){if(n&1&&Y(0,sW,1,7)(1,cW,3,40,"div",312),n&2){let t,i=k().$implicit,r=k().$implicit,o=k();Q((t=o.gameEngine.getWallBetween(i,r,i+1,r))?0:1,t)}}function dW(n,e){n&1&&(ee(),v(0,"svg",317),W(1,"path",318),E())}function hW(n,e){n&1&&(ee(),v(0,"svg",317),W(1,"path",319),E())}function fW(n,e){if(n&1){let t=Ge();v(0,"button",316),te("click",function(r){ne(t);let o=k(2),s=k(2).$implicit,a=k().$implicit,l=k();return ie(o.owner==="player"?l.onDestroyIconClick(r,s,a,s,a+1):l.onAttackIconClick(r,s,a,s,a+1))}),Y(1,dW,2,0,":svg:svg",317)(2,hW,2,0,":svg:svg",317),E()}if(n&2){let t=k(2),i=k(4);et("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Me("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),m(),Q(t.owner==="player"?1:2)}}function pW(n,e){if(n&1){let t=Ge();v(0,"div",326),te("mouseenter",function(){ne(t);let r=k(),o=k(4);return ie(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){ne(t);let r=k(5);return ie(r.gameEngine.hoverFormationById(null))}),Y(1,fW,3,13,"button",315),E()}if(n&2){let t=k(),i=k(2).$implicit,r=k().$implicit,o=k();et("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","width 0.25s ease-out"),Me("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Vt("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),m(),Q(o.gameEngine.canShowAttackIcon(_t(26,Ct,i,r),_t(29,Ct,i,r+1))?1:-1)}}function gW(n,e){if(n&1&&Y(0,pW,2,32,"div",325),n&2){let t=k(2).$implicit,i=k().$implicit,r=k();Q(r.gameEngine.shouldRenderWall(_t(1,Ct,t,i),_t(4,Ct,t,i+1),e.owner)?0:-1)}}function mW(n,e){if(n&1){let t=Ge();v(0,"button",330),te("click",function(r){ne(t);let o=k(3).$implicit,s=k().$implicit,a=k();return ie(a.onBuildIconClick(r,o,s,o,s+1))}),y(1," \u2714 "),E()}if(n&2){let t=k(5);et("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function yW(n,e){if(n&1&&(v(0,"span",329),y(1),E()),n&2){let t=k(3).$implicit,i=k().$implicit,r=k();m(),Mt(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(_t(2,Ct,t,i),_t(5,Ct,t,i+1))," ")}}function vW(n,e){if(n&1&&(v(0,"div",327),Y(1,mW,2,8,"button",328),Y(2,yW,2,8,"span",329),E()),n&2){let t=k(2).$implicit,i=k().$implicit,r=k();et("bottom",-r.gameEngine.wallThicknessPx-2,"px")("height",r.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Me("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(_t(16,Ct,t,i),_t(19,Ct,t,i+1)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(_t(22,Ct,t,i),_t(25,Ct,t,i+1))),m(),Q(r.gameEngine.canShowBuildIcon(_t(28,Ct,t,i),_t(31,Ct,t,i+1))?1:-1),m(),Q(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t,i+1))&&r.gameEngine.edgeCooldownRemaining(_t(34,Ct,t,i),_t(37,Ct,t,i+1))>0?2:-1)}}function _W(n,e){if(n&1&&Y(0,gW,1,7)(1,vW,3,40,"div",324),n&2){let t,i=k().$implicit,r=k().$implicit,o=k();Q((t=o.gameEngine.getWallBetween(i,r,i,r+1))?0:1,t)}}function EW(n,e){if(n&1&&W(0,"app-units",334),n&2){let t=k(3);Ie("unit",t)}}function bW(n,e){if(n&1&&(v(0,"span",338),y(1),E()),n&2){let t=e;et("z-index",200),Me("bg-green-600",t.bg==="bg-green-600")("bg-amber-600",t.bg==="bg-amber-600")("bg-red-600",t.bg==="bg-red-600"),m(),B(" ",t.chance,"% ")}}function wW(n,e){n&1&&(v(0,"span",339),y(1," \u{1F333} "),E()),n&2&&et("z-index",100)}function xW(n,e){n&1&&(v(0,"span",340),y(1," \u{1F331} "),E()),n&2&&et("z-index",100)}function SW(n,e){n&1&&(v(0,"span",340),y(1," \u{1F33F} "),E()),n&2&&et("z-index",100)}function IW(n,e){n&1&&(v(0,"span",343),y(1," \u{1F9F1} "),E()),n&2&&et("z-index",100)}function TW(n,e){n&1&&(v(0,"span",342),y(1,"\u26F0\uFE0F"),E())}function CW(n,e){n&1&&(v(0,"span",342),y(1,"\u26CF\uFE0F"),E())}function DW(n,e){n&1&&(v(0,"span",342),y(1,"\u26CF"),E())}function AW(n,e){n&1&&(v(0,"span",342),y(1,"\u2692"),E())}function MW(n,e){if(n&1&&Y(0,IW,2,2,"span",341)(1,TW,2,0,"span",342)(2,CW,2,0,"span",342)(3,DW,2,0,"span",342)(4,AW,2,0,"span",342),n&2){let t=k(3);Q((t.mineOccupationTurns??0)>=5?0:(t.mineOccupationTurns??0)===1?1:(t.mineOccupationTurns??0)===2?2:(t.mineOccupationTurns??0)===3?3:(t.mineOccupationTurns??0)>3?4:-1)}}function RW(n,e){if(n&1&&(v(0,"div",332)(1,"div",333),Y(2,EW,1,1,"app-units",334),E(),Y(3,bW,2,9,"span",335),Y(4,wW,2,2,"span",336)(5,xW,2,2,"span",337)(6,SW,2,2,"span",337),Y(7,MW,5,1),E()),n&2){let t,i=k(2),r=k(3);et("transform",r.gameEngine.getCombinedTransform(i.id))("z-index",r.gameEngine.isUnitMoving(i.id)||r.gameEngine.isUnitAttacking(i.id)?200:null),Me("shake",r.gameEngine.isUnitShaking(i.id)),m(),et("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px"),Me("theme-player",i.owner==="player")("theme-ai",i.owner==="ai")("fatigued",i.hasActed)("merge-anim",r.gameEngine.lastMergedUnitId()===i.id)("ring",r.gameEngine.selectedUnitId()===i.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===i.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===i.id)("scale-115",r.gameEngine.selectedUnitId()===i.id&&!r.gameEngine.buildMode())("scale-120",r.gameEngine.lastMergedUnitId()===i.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===i.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===i.id)("pulse-glow",r.gameEngine.pulseUnitId()===i.id),Vt("title",r.gameEngine.formatHoverInfo(i.id)),m(),Q(i?2:-1),m(),Q((t=r.gameEngine.isUnitHovered(i.id)&&r.gameEngine.getHitChanceInfo(i.id))?3:-1,t),m(),Q(i.productionActive?4:(i.forestOccupationTurns??0)===1?5:(i.forestOccupationTurns??0)>1?6:-1),m(3),Q(r.gameEngine.isMine(i.position.x,i.position.y)?7:-1)}}function PW(n,e){if(n&1&&Y(0,RW,8,41,"div",331),n&2){let t=k(2).$implicit,i=k().$implicit,r=k();Q(!(t===0&&i===0)&&!(t===r.gameEngine.gridSize-1&&i===r.gameEngine.gridSize-1)?0:-1)}}function NW(n,e){if(n&1&&Y(0,PW,1,1),n&2){let t=k().$implicit,i=k().$implicit,r=k();Q(e.owner==="player"||r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function kW(n,e){if(n&1&&(v(0,"div",344)(1,"span",345),y(2),E()()),n&2){let t=e.$implicit,i=k(3);et("z-index",100)("opacity",t.opacity),m(),Me("text-xs",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-base",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text))("text-yellow-300",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-yellow-400",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text)),m(),B(" ",t.text," ")}}function OW(n,e){if(n&1){let t=Ge();v(0,"div",257),te("click",function(){let r=ne(t).$implicit,o=k().$implicit,s=k();return ie(s.onTileClick(r,o))})("mouseenter",function(){let r=ne(t).$implicit,o=k().$implicit,s=k();return ie(s.gameEngine.setHoveredUnit(s.gameEngine.getUnitAt(r,o)&&(s.gameEngine.getUnitAt(r,o).owner==="player"||s.gameEngine.isVisibleToPlayer(r,o))?s.gameEngine.getUnitAt(r,o).id:null))})("mouseleave",function(){ne(t);let r=k(2);return ie(r.gameEngine.setHoveredUnit(null))}),v(1,"span",258),y(2),E(),Y(3,Vz,2,1),Y(4,Uz,1,0,"div",259),Ml(5),Y(6,Bz,2,2,"button",260),Y(7,jz,2,3,"span",261),Y(8,Wz,4,16),Y(9,Yz,11,12,"span",262),Y(10,Jz,7,9,"span",263),Y(11,Zz,1,2,"div",264),Y(12,Xz,4,2),Y(13,tW,1,1),Y(14,uW,2,1),Y(15,_W,2,1),Y(16,NW,1,1),Sn(17,kW,3,13,"div",265,wz),E()}if(n&2){let t,i=e.$implicit,r=k().$implicit,o=k();et("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Me("cursor-pointer",o.gameEngine.isValidMove(i,r))("bg-gray-700",!o.gameEngine.isValidMove(i,r))("border-gray-600",!o.gameEngine.isValidMove(i,r))("bg-blue-900",i===0&&r===0)("bg-red-900",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-4",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-blue-400",i===0&&r===0)("border-red-400",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-2",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-blue-300",i===0&&r===0&&o.gameEngine.baseDeployActive())("ring-red-300",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&i<=2&&r<=2&&(i!==0||r!==0))("forest-area",o.gameEngine.isForest(i,r))("mine-area",o.gameEngine.isMine(i,r))("forge-area",o.gameEngine.isForge(i,r))("bg-amber-900",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(i,r))("border-gray-800",!o.gameEngine.isVisibleToPlayer(i,r))("bg-green-900",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("border-green-500",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("bg-cyan-900",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("border-cyan-500",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("animate-pulse",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("hover:bg-gray-600",!o.gameEngine.isValidMove(i,r))("hover:bg-green-800",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("hover:bg-cyan-800",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r)),Vt("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0456\u0437\u043D\u0430 \u0448\u0430\u0445\u0442\u0430: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +2 \u0437\u0430\u043B\u0456\u0437\u0430 \u0437\u0430 \u0445\u0456\u0434.":"Iron Mine: Requires 5 consecutive turns of occupation to activate. Once active, yields +2 Iron per turn.":null)("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u041B\u0456\u0441\u043E\u043F\u0438\u043B\u044C\u043D\u044F: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 2 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +8 \u0434\u0435\u0440\u0435\u0432\u0438\u043D\u0438 \u0437\u0430 \u0445\u0456\u0434.":"Sawmill: Requires 2 consecutive occupation turns to activate. Once activated, it gives +8 wood per turn.":null),m(2),Mt(" ",i,",",r," "),m(),Q(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(i,r)?3:-1),m(),Q(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(i,r)?4:-1),m(),Vu(o.gameEngine.getUnitAt(i,r)),m(),Q(o.gameEngine.buildMode()&&o.gameEngine.canBuildForgeAt(i,r)?6:-1),m(),Q(o.gameEngine.isForgeSite(i,r)?7:-1),m(),Q(o.gameEngine.isForge(i,r)?8:-1),m(),Q(o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?9:-1),m(),Q(o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?10:-1),m(),Q(o.gameEngine.isForest(i,r)&&o.gameEngine.getUnitAt(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?11:-1),m(),Q(i===0&&r===0?12:-1),m(),Q(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1?13:-1),m(),Q(i<o.gameEngine.gridSize-1?14:-1),m(),Q(r<o.gameEngine.gridSize-1?15:-1),m(),Q((t=o.gameEngine.getUnitAt(i,r))?16:-1,t),m(),In(o.gameEngine.getCombatTextEntriesAt(i,r))}}function FW(n,e){if(n&1&&Sn(0,OW,19,80,"div",256,Ar),n&2){let t=k();In(t.gameEngine.gridCols)}}function LW(n,e){n&1&&W(0,"app-game-rules")}function VW(n,e){if(n&1&&(v(0,"div",361),y(1),E()),n&2){let t=k(2);m(),G(t.settings.t("NOT_LOGS_DATA"))}}function UW(n,e){if(n&1&&(v(0,"div",363)(1,"span",364),y(2),E()()),n&2){let t=e.$implicit;et("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Me("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),m(),fE(t.color),m(),G(t.text)}}function BW(n,e){if(n&1){let t=Ge();v(0,"div",229)(1,"button",346),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.toggleLog())}),v(2,"span",347),y(3,"\u2715"),E()(),v(4,"div",348)(5,"div",349)(6,"h3",350),y(7),E(),v(8,"button",351),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.clearLogs())}),ee(),v(9,"svg",352),W(10,"path",353),E(),y(11),E()(),ke(),v(12,"label",354)(13,"div",109)(14,"input",355),te("change",function(){ne(t);let r=k();return ie(r.gameEngine.toggleCombatOnly())}),E(),W(15,"div",356),ee(),v(16,"svg",357),W(17,"path",358),E()(),ke(),v(18,"span",359),y(19),E()()(),v(20,"div",360),Y(21,VW,2,1,"div",361),Sn(22,UW,3,7,"div",362,Fu),E()()}if(n&2){let t=k();m(7),B(" ",t.settings.t("Action_LOG")," "),m(4),B(" ",t.settings.t("CLEAR")," "),m(3),Ie("checked",t.gameEngine.combatOnly()),m(5),B(" ",t.settings.t("COMBAT_ONLY")," "),m(2),Q(t.gameEngine.logsFiltered().length===0?21:-1),m(),In(t.gameEngine.logsFiltered().reverse())}}function jW(n,e){if(n&1){let t=Ge();v(0,"button",381),te("click",function(){let r=ne(t).$implicit,o=k(2);return ie(o.onDifficultyChange(r))}),v(1,"span",382),y(2),E(),y(3),E()}if(n&2){let t=e.$implicit,i=k(2);Me("bg-blue-500/20",i.settings.difficulty()===t)("border-blue-400/40",i.settings.difficulty()===t)("text-blue-200",i.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",i.settings.difficulty()===t)("bg-white/5",i.settings.difficulty()!==t)("border-white/5",i.settings.difficulty()!==t)("text-stone-500",i.settings.difficulty()!==t)("hover:bg-white/10",i.settings.difficulty()!==t),m(),Me("opacity-100",i.settings.difficulty()===t),m(),B(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),m(),B(" ",i.settings.t(i.settings.getDifficultyLabel(t))," ")}}function HW(n,e){if(n&1){let t=Ge();v(0,"button",383),te("click",function(){let r=ne(t).$implicit,o=k(2);return ie(o.onMapSizeChange(r))}),y(1),E()}if(n&2){let t=e.$implicit,i=k(2);Me("bg-gradient-to-br",i.settings.mapSize()===t)("from-indigo-600",i.settings.mapSize()===t)("to-indigo-800",i.settings.mapSize()===t)("text-white",i.settings.mapSize()===t)("shadow-lg",i.settings.mapSize()===t)("text-stone-500",i.settings.mapSize()!==t)("hover:text-stone-300",i.settings.mapSize()!==t),m(),Mt(" ",t,"x",t," ")}}function $W(n,e){if(n&1){let t=Ge();v(0,"div",230)(1,"div",365),W(2,"div",366),v(3,"h3",367),y(4),E(),v(5,"button",368),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.toggleSettings())}),y(6," \u2716 "),E()(),v(7,"div",369)(8,"div",190)(9,"label",370),y(10),E(),v(11,"span",371),y(12),E()(),v(13,"div",372),Sn(14,jW,4,20,"button",373,Ar),E()(),v(16,"div",369)(17,"label",374),y(18),E(),v(19,"div",375),Sn(20,HW,2,16,"button",376,Ar),E()(),v(22,"div",377)(23,"button",378),te("click",function(){ne(t);let r=k();return ie(r.settings.setLang("uk"))}),y(24," UA "),E(),v(25,"button",378),te("click",function(){ne(t);let r=k();return ie(r.settings.setLang("en"))}),y(26," EN "),E()(),v(27,"label",379)(28,"div",109)(29,"input",110),te("change",function(r){ne(t);let o=k();return ie(o.setCustomMode(r.target.checked))}),E(),v(30,"div",380),W(31,"div",112),E()(),v(32,"span",113),y(33,"Custom Mode"),E()()()}if(n&2){let t=k();m(4),G(t.settings.t("SYSTEM_SETTINGS")),m(6),B(" ",t.settings.t("TACTICAL_DIFF")," "),m(2),B(" ",t.settings.t("LEVEL_SELECTION")," "),m(2),In(t.settings.diffArr),m(4),B(" ",t.settings.t("SECTOR_DIMENSIONS")," "),m(2),In(pa(13,bz)),m(3),Me("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),m(2),Me("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en"),m(4),Ie("checked",t.settings.customMode())}}function GW(n,e){if(n&1&&(v(0,"div",392)(1,"span"),y(2),Rr(3,"date"),E(),v(4,"span",396),y(5),E(),v(6,"span",397),y(7),E()()),n&2){let t=e.$implicit,i=k(2);m(2),G(lo(3,4,t.date,"yyyy-MM-dd HH:mm")),m(3),G(t.condition),m(2),Mt("",t.turns," ",i.settings.t("TURNS"))}}function zW(n,e){if(n&1&&(v(0,"div",393),y(1),E()),n&2){let t=k(2);m(),G(t.settings.t("NO_RECORDS_YET"))}}function WW(n,e){if(n&1&&(v(0,"div",392)(1,"span"),y(2),Rr(3,"date"),E(),v(4,"span",396),y(5),E(),v(6,"span",397),y(7),E()()),n&2){let t=e.$implicit,i=k(2);m(2),G(lo(3,4,t.date,"yyyy-MM-dd HH:mm")),m(3),G(t.condition),m(2),Mt("",t.turns," ",i.settings.t("TURNS"))}}function qW(n,e){if(n&1&&(v(0,"div",393),y(1),E()),n&2){let t=k(2);m(),G(t.settings.t("NO_RECORDS_YET"))}}function KW(n,e){if(n&1){let t=Ge();v(0,"div",231)(1,"div",384)(2,"div",385)(3,"h2",386),y(4),E(),v(5,"button",387),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.closeHighScores())}),y(6," \u2716 "),E()(),v(7,"div",388),y(8),E(),v(9,"div",389)(10,"div",390)(11,"h3",391),y(12),E(),Sn(13,GW,8,7,"div",392,oO,!1,zW,2,1,"div",393),E(),v(16,"div",390)(17,"h3",394),y(18),E(),Sn(19,WW,8,7,"div",392,oO,!1,qW,2,1,"div",393),E()(),v(22,"div",395),y(23),E()()()}if(n&2){let t=k();m(4),G(t.settings.t("HIGH_SCORES")),m(4),ss(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),m(4),G(t.settings.t("TOP_3_PLAYER")),m(),In(t.gameEngine.getHighScoresForCurrentCombo().wins),m(5),G(t.settings.t("TOP_3_LOSES_PLAYER")),m(),In(t.gameEngine.getHighScoresForCurrentCombo().losses),m(4),G(t.settings.t("CHANGE_RECORDS_INFO"))}}function YW(n,e){if(n&1){let t=Ge();v(0,"div",232)(1,"div",398),y(2," Debug Mode "),E(),v(3,"button",399),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.debugInstantWin())}),y(4," \u26A1 Instant Win "),E(),v(5,"button",400),te("click",function(){ne(t);let r=k();return ie(r.gameEngine.debugCycleSettings())}),y(6," \u{1F504} Cycle Settings "),E(),v(7,"div",401),y(8),E()()}if(n&2){let t=k();m(8),Mt(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var _0=class n{constructor(e,t,i,r){this.gameEngine=e;this.settings=t;this.firebase=i;this.router=r}boardContainer;isAutoBattleActive=$(!1);isMobileMenuOpen=$(!1);lastEconomyProcessedTurn=-1;ngOnInit(){this.gameEngine.resetGame()}ngOnDestroy(){this.isAutoBattleActive.set(!1),this.gameEngine.pauseGame()}goToHub(){this.isAutoBattleActive.set(!1),this.router.navigate(["/"])}get isProduction(){return!fM()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}centerOnSelectedUnit(){let e=this.boardContainer?.nativeElement;if(!e)return;let t=this.gameEngine.selectedUnit();if(!t)return;let i=this.gameEngine.tileSizePx,r=this.gameEngine.wallThicknessPx+2,o=i+r,s=t.position.x*o+i/2,a=t.position.y*o+i/2,l=Math.max(0,Math.min(s-e.clientWidth/2,e.scrollWidth-e.clientWidth)),c=Math.max(0,Math.min(a-e.clientHeight/2,e.scrollHeight-e.clientHeight));e.scrollTo({left:l,top:c,behavior:"smooth"})}activeKeys=new Set;onKeyDown(e){if(this.gameEngine.gameStatus()!=="playing")return;let t=e.key;if(t==="Tab"||t===" "||e.code==="Space"){e.preventDefault(),this.gameEngine.isPlayerTurn()&&this.gameEngine.selectNextAvailableUnitTab();return}if(t==="Enter"){e.preventDefault(),this.gameEngine.endPlayerTurn();return}let i=this.gameEngine.selectedUnit();if(!i||i.hasActed)return;this.activeKeys.add(t);let r=0,o=0;if((this.activeKeys.has("ArrowUp")||this.activeKeys.has("w")||this.activeKeys.has("W"))&&(o-=1),(this.activeKeys.has("ArrowDown")||this.activeKeys.has("s")||this.activeKeys.has("S"))&&(o+=1),(this.activeKeys.has("ArrowLeft")||this.activeKeys.has("a")||this.activeKeys.has("A"))&&(r-=1),(this.activeKeys.has("ArrowRight")||this.activeKeys.has("d")||this.activeKeys.has("D"))&&(r+=1),r===0&&o===0)return;e.preventDefault();let s=this.gameEngine.validMoves(),l=r!==0&&o!==0?i.tier===4?3:1:i.tier>=3||i.tier===2?2:1,c=null;for(let d=1;d<=l;d++){let h=i.position.x+r*d,f=i.position.y+o*d,g={x:h,y:f};if(s.some(w=>w.x===h&&w.y===f))c=g;else break}if(!c){let d={x:i.position.x,y:i.position.y},h={x:i.position.x+r,y:i.position.y+o};if(this.gameEngine.getWallBetween(d.x,d.y,h.x,h.y)){this.gameEngine.attackOrDestroyWallBetween(d,h);return}let g=this.gameEngine.getUnitAt(h.x,h.y);if(g&&g.owner!==i.owner){this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.isValidMove(h.x,h.y)&&this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.moveSelectedUnit(c)}onKeyUp(e){this.activeKeys.delete(e.key)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.settings.customMode()&&this.gameEngine.sandboxSpawnPending()){this.gameEngine.getUnitAt(e,t)||this.gameEngine.spawnSandboxAt({x:e,y:t});return}if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let i=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}let r=this.gameEngine.selectedUnit();if(r){let o=e-r.position.x,s=t-r.position.y;if(Math.abs(o)+Math.abs(s)===1&&this.gameEngine.getWallBetween(r.position.x,r.position.y,e,t)){this.gameEngine.attackOrDestroyWallBetween(r.position,{x:e,y:t});return}}if(i&&i.owner==="player"){this.gameEngine.selectUnit(i.id);return}this.gameEngine.selectUnit(null)}setCustomMode(e){this.settings.setCustomMode(e),this.gameEngine.resetGame()}onEdgeClick(e,t,i,r,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,i,r,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onDestroyIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:i},{x:r,y:o})}onBuildIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onAttackIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(r=>setTimeout(r,250)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.turn();this.lastEconomyProcessedTurn!==e&&(this.gameEngine.botEconomyPhase("player"),this.lastEconomyProcessedTurn=e),this.gameEngine.playerAutoStep()||this.gameEngine.selectUnit(null),this.gameEngine.remainingActions()===0&&(await new Promise(r=>setTimeout(r,1e3)),this.isAutoBattleActive()&&this.gameEngine.isPlayerTurn()&&this.gameEngine.endPlayerTurn())}static \u0275fac=function(t){return new(t||n)(he(ri),he(Tt),he(Rn),he(Ei))};static \u0275cmp=St({type:n,selectors:[["app-game"]],viewQuery:function(t,i){if(t&1&&Cl(Ez,5),t&2){let r;Dl(r=Al())&&(i.boardContainer=r.first)}},hostBindings:function(t,i){t&1&&te("keydown",function(o){return i.onKeyDown(o)},fa)("keyup",function(o){return i.onKeyUp(o)},fa)},decls:377,vars:124,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],["title","Return to Gaming Hub",1,"cursor-pointer","p-2","bg-slate-800/50","hover:bg-slate-700","border","border-slate-700/50","rounded-lg","transition-all","group/btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-slate-400","group-hover/btn:text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["d","M6 18 L10 12 L14 18 Z","fill","#9ca3af"],["cx","12","cy","10","r","3","fill","#6b7280"],[1,"hud-value","font-mono","text-sm","font-bold","text-slate-300"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-6xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],["width","24","height","24","viewBox","0 0 24 24"],[1,"font-mono","text-lg","font-bold","text-slate-300"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","roadmap","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto","no-select"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"flex","items-center","justify-between","w-full","gap-2","z-10","text-amber-200"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","mine-area","forge-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click","mouseenter","mouseleave"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"z-index"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","-translate-x-4","translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"click"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none"],[1,"absolute","text-[10px]","font-bold","px-1","rounded","bg-yellow-300/80","text-black","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90",3,"z-index"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90"],["viewBox","0 0 128 128",1,"w-full","h-full"],["transform","translate(0,10) scale(1)"],["x","20","y","80","width","88","height","18","rx","4","fill","#6b7280"],["x","30","y","70","width","68","height","12","rx","3","fill","#9ca3af"],["d","M32 40 H96 L86 56 H42 Z","fill","#4b5563"],["x","56","y","30","width","16","height","12","rx","2","fill","#6b7280"],["x","60","y","20","width","8","height","12","rx","2","fill","#9ca3af"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer",3,"click"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer",3,"click"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],["cx","64","cy","96","rx","40","ry","10","fill","#374151"],["d","M32 96 L56 48 L72 80 L96 96 Z","fill","#6b7280","stroke","#4b5563","stroke-width","4"],["cx","58","cy","60","r","6","fill","#9ca3af"],["transform","translate(82, 30) rotate(-20) scale(1.3)"],["width","4","height","30","rx","2","fill","#6b7280"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#f59e0b","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none","move-anim",3,"shake","transform","z-index"],[1,"pointer-events-none","move-anim"],[1,"unit-svg-wrapper"],[3,"unit"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow",3,"bg-green-600","bg-amber-600","bg-red-600","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-left-1","opacity-70","[style.z-index]='100'"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"mt-3","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-pink-500","peer-checked:border-pink-500","transition-all"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,i){if(t&1){let r=Ge();v(0,"div",2)(1,"div",3),W(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),E(),ee(),v(7,"svg",9)(8,"defs")(9,"radialGradient",10),W(10,"stop",11)(11,"stop",12)(12,"stop",13),E(),v(13,"radialGradient",14),W(14,"stop",15)(15,"stop",16)(16,"stop",17),E(),v(17,"radialGradient",18),W(18,"stop",19)(19,"stop",20)(20,"stop",21),E(),v(21,"linearGradient",22),W(22,"stop",23)(23,"stop",24),E(),v(24,"filter",25),W(25,"feDropShadow",26),E()()(),v(26,"svg",27)(27,"defs")(28,"clipPath",28),W(29,"path",29),E(),v(30,"symbol",30),W(31,"path",31),E()()(),ke(),v(32,"div",32)(33,"button",33),te("click",function(){return ne(r),ie(i.goToHub())}),ee(),v(34,"svg",34),W(35,"path",35),E()(),ke(),v(36,"div",36),W(37,"div",37)(38,"div",38),ee(),v(39,"svg",39),W(40,"path",40)(41,"rect",41),E(),ke(),W(42,"div",42)(43,"div",43),E(),v(44,"div",44)(45,"div",45)(46,"h1",46)(47,"span",47),y(48,"Shape"),E(),v(49,"span",48),y(50," Tactics "),E()(),v(51,"div",49),W(52,"div",50)(53,"div",51),E()(),v(54,"div",52)(55,"span",53),y(56),E()()(),W(57,"div",54),E(),v(58,"div",55)(59,"div",56)(60,"button",57),te("click",function(){return ne(r),ie(i.gameEngine.resetGame())}),ee(),v(61,"svg",58),W(62,"path",59),E(),ke(),v(63,"span",60),y(64),E()(),W(65,"div",61),v(66,"button",62),te("click",function(){return ne(r),ie(i.gameEngine.toggleRules())}),ee(),v(67,"svg",63),W(68,"path",64),E(),ke(),v(69,"span",65),y(70),E()()(),v(71,"div",66)(72,"button",67),te("click",function(){return ne(r),ie(i.gameEngine.toggleHighScores())}),ee(),v(73,"svg",68),W(74,"path",69),E(),ke(),v(75,"span",70),y(76),E()(),v(77,"button",71),te("click",function(){return ne(r),ie(i.gameEngine.toggleLeaderboard())}),ee(),v(78,"svg",68),W(79,"path",72),E(),ke(),v(80,"span",70),y(81),E()(),v(82,"button",73),te("click",function(){return ne(r),ie(i.gameEngine.toggleLog())}),ee(),v(83,"svg",68),W(84,"path",74),E(),ke(),v(85,"span",70),y(86),E()(),v(87,"button",75),te("click",function(){return ne(r),ie(i.navigateToFeedback())}),ee(),v(88,"svg",68),W(89,"path",76),E(),ke(),v(90,"span",70),y(91),E()()(),v(92,"div",77)(93,"button",78),te("click",function(){return ne(r),ie(i.gameEngine.toggleSettings())}),ee(),v(94,"svg",79),W(95,"path",80)(96,"path",81),E()(),Y(97,xz,9,3,"div",82)(98,Sz,4,1,"button",83),E()(),ke(),v(99,"div",84)(100,"div",85),ee(),v(101,"svg",86),W(102,"rect",87)(103,"circle",88),E(),ke(),v(104,"span",89),y(105),E()(),v(106,"div",85),ee(),v(107,"svg",86),W(108,"path",90)(109,"circle",91),E(),ke(),v(110,"span",92),y(111),E()(),v(112,"div",85),ee(),v(113,"svg",86),W(114,"polygon",93),E(),ke(),v(115,"span",94),y(116),E()(),v(117,"div",85),ee(),v(118,"svg",86),W(119,"circle",95)(120,"path",96),E(),ke(),v(121,"span",97),y(122),E()(),v(123,"div",85),ee(),v(124,"svg",86),W(125,"path",98)(126,"rect",99)(127,"rect",100),E(),ke(),v(128,"span",101),y(129),E()(),v(130,"button",102),te("click",function(){return ne(r),ie(i.toggleMobileMenu())}),ee(),v(131,"svg",103),W(132,"path",104),E()()(),ke(),v(133,"div",105)(134,"button",106),te("click",function(){return ne(r),ie(i.gameEngine.toggleBuildMode())}),ee(),v(135,"svg",86),W(136,"path",107),E()(),ke(),v(137,"button",106),te("click",function(){return ne(r),ie(i.gameEngine.convertWoodToReserve())}),y(138," +1 "),E(),v(139,"button",106),te("click",function(){return ne(r),ie(i.gameEngine.maxConvertWoodToReserve())}),y(140),E(),v(141,"label",108)(142,"div",109)(143,"input",110),te("change",function(){return ne(r),ie(i.gameEngine.toggleFogDebug())}),E(),v(144,"div",111),W(145,"div",112),E()(),v(146,"span",113),y(147),E()(),v(148,"div",114),y(149),E(),v(150,"button",115),te("click",function(){return ne(r),ie(i.gameEngine.endPlayerTurn())}),ee(),v(151,"svg",116),W(152,"path",117)(153,"path",118),E()()(),Y(154,Cz,23,9,"div",119),ke(),v(155,"div",120),W(156,"div",121),v(157,"div",122)(158,"div",123)(159,"span",124),y(160),E(),v(161,"span",125),y(162),E()(),W(163,"div",126),v(164,"div",127)(165,"div",128)(166,"span",129),ee(),v(167,"svg",130),W(168,"rect",87)(169,"circle",131)(170,"circle",132)(171,"rect",133)(172,"circle",134)(173,"circle",135),E()(),ke(),v(174,"span",136),y(175),E()(),v(176,"div",128)(177,"span",129),ee(),v(178,"svg",137),W(179,"path",90)(180,"circle",91),E()(),ke(),v(181,"span",138),y(182),E()(),v(183,"div",139)(184,"span",129)(185,"div",140),ee(),v(186,"svg",141),W(187,"polygon",142)(188,"rect",143)(189,"polygon",144)(190,"rect",145)(191,"polygon",146)(192,"rect",147),v(193,"g",148),W(194,"rect",149)(195,"polygon",150),E(),v(196,"g",151),W(197,"rect",152)(198,"circle",153)(199,"circle",154),E()()()(),ke(),v(200,"span",155),y(201),v(202,"span",156),y(203,"/"),E(),y(204),E()()()(),v(205,"div",157),W(206,"div",158),v(207,"span",159),y(208),E(),v(209,"div",45)(210,"span",160),y(211),E()(),Y(212,Dz,2,3,"div",161),E(),v(213,"div",122)(214,"div",127)(215,"div",128)(216,"span",162),y(217),E(),v(218,"span",129),ee(),v(219,"svg",130),W(220,"rect",87)(221,"circle",131)(222,"circle",132)(223,"rect",133)(224,"circle",134)(225,"circle",135),E()()(),ke(),v(226,"div",128)(227,"span",129),ee(),v(228,"svg",137),W(229,"path",90)(230,"circle",91),E()(),ke(),v(231,"span",138),y(232),E()(),v(233,"div",163)(234,"span",164),y(235),v(236,"span",156),y(237,"/"),E(),y(238),E(),v(239,"span",129)(240,"div",140),ee(),v(241,"svg",141),W(242,"polygon",142)(243,"rect",143)(244,"polygon",144)(245,"rect",145)(246,"polygon",146)(247,"rect",147),v(248,"g",148),W(249,"rect",149)(250,"polygon",165),E(),v(251,"g",151),W(252,"rect",152)(253,"circle",153)(254,"circle",154),E()()()()()(),ke(),W(255,"div",126),v(256,"div",166)(257,"span",167),y(258),E(),v(259,"span",168),y(260,"jaerbi"),E()()()(),Y(261,Rz,11,11,"div",169),v(262,"button",170),te("click",function(){return ne(r),ie(i.navigateToRoadmap())}),v(263,"div",171),W(264,"div",172),v(265,"span",173),y(266),E()(),v(267,"div",174),ee(),v(268,"svg",175),W(269,"path",176),E()()(),ke(),v(270,"button",177),te("click",function(){return ne(r),ie(i.gameEngine.toggleSupport())}),v(271,"span",129),y(272,"\u2764\uFE0F"),E(),v(273,"span",178),y(274),E()(),Y(275,Pz,1,0,"app-support-community"),Y(276,Nz,1,0,"app-leaderboard-modal"),v(277,"div",179),Y(278,kz,1,0,"app-sandbox"),v(279,"div",180,0)(281,"div",181)(282,"div",182)(283,"span",183),y(284),E()(),Y(285,Oz,3,1,"div",184),Sn(286,FW,2,0,null,null,Ar),E()(),v(288,"div",185)(289,"div",186),W(290,"div",187),v(291,"div",188)(292,"span",189),y(293),E(),v(294,"div",190)(295,"span",191),y(296),E(),v(297,"div",192)(298,"span",129),y(299),E()()(),v(300,"div",193),W(301,"div",194),E()()()(),v(302,"div",195)(303,"div",196)(304,"button",197),te("click",function(){return ne(r),ie(i.toggleAutoBattle())}),v(305,"div",198)(306,"span",199),y(307),E(),v(308,"span",200),y(309),E()(),v(310,"div",198),W(311,"span",201),E(),W(312,"div",202),E(),v(313,"button",203),te("click",function(){return ne(r),ie(i.gameEngine.toggleBuildMode())}),v(314,"div",204)(315,"span",205),y(316,"+1"),E(),v(317,"div",206),ee(),v(318,"svg",207),W(319,"path",208)(320,"path",209)(321,"path",210)(322,"rect",211),E()()(),ke(),v(323,"div",212)(324,"span"),y(325,"-10"),E(),v(326,"div",213),ee(),v(327,"svg",214),W(328,"rect",215)(329,"circle",216)(330,"circle",217),E()()(),ke(),W(331,"div",202),E(),v(332,"button",218),te("click",function(){return ne(r),ie(i.gameEngine.convertWoodToReserve())}),v(333,"div",219)(334,"span",220)(335,"span"),y(336,"20"),E(),v(337,"div",213),ee(),v(338,"svg",214),W(339,"rect",215)(340,"circle",216)(341,"circle",217),E()()(),ke(),v(342,"span",129),y(343,"\u2794"),E(),v(344,"span",221),y(345,"1 \u{1F464}"),E()()(),v(346,"button",222),te("click",function(){return ne(r),ie(i.gameEngine.maxConvertWoodToReserve())}),v(347,"div",223)(348,"span",224),y(349),E(),v(350,"span",129),y(351,"\u2794"),E(),v(352,"span",129),y(353,"\u{1F465}++"),E()()()(),v(354,"label",225)(355,"div",109)(356,"input",110),te("change",function(){return ne(r),ie(i.gameEngine.toggleFogDebug())}),E(),v(357,"div",111),W(358,"div",112),E()(),v(359,"span",113),y(360),E()(),v(361,"button",226),te("click",function(){return ne(r),ie(i.gameEngine.endPlayerTurn())}),v(362,"div",227)(363,"span",224),y(364),E(),ee(),v(365,"svg",116),W(366,"path",117)(367,"path",118),E()()(),ke(),v(368,"div",114),y(369),E()()(),v(370,"div",228),y(371),E(),Y(372,LW,1,0,"app-game-rules"),Y(373,BW,24,5,"div",229),Y(374,$W,34,14,"div",230),Y(375,KW,24,9,"div",231),Y(376,YW,9,2,"div",232),E()}if(t&2){let r;m(56),G(i.settings.version),m(8),B(" ",i.settings.t("RELOAD")," "),m(6),B(" ",i.settings.t("INFO")," "),m(6),G(i.settings.t("RECORDS")),m(5),G(i.settings.t("RANKING")),m(5),G(i.settings.t("SYSTEM_LOG")),m(5),G(i.settings.t("FEEDBACK_MODULE")),m(6),Q((r=i.firebase.user$())?97:98,r),m(8),G(i.gameEngine.resources().wood),m(6),G(i.gameEngine.resources().iron),m(5),Mt(" ",i.gameEngine.getForestControl().player,"/",i.gameEngine.getForestControl().total," "),m(6),G(i.gameEngine.turn()),m(7),Mt(" ",i.gameEngine.getForestControl().player," : ",i.gameEngine.getForestControl().ai," "),m(5),Ie("disabled",!i.gameEngine.canBuildThisTurn()),m(3),Ie("disabled",!i.gameEngine.canAddReserveTurn()),m(2),Ie("disabled",!i.gameEngine.canAddReserveTurn()),m(),B(" ",i.settings.t("ALL")," "),m(3),Ie("checked",i.gameEngine.fogDebugDisabled()),m(4),G(i.settings.t("MAP_HACK")),m(2),Mt(" ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),m(5),Q(i.isMobileMenuOpen()?154:-1),m(6),B(" ",i.settings.t("COMMANDER")," "),m(2),B(" ",i.settings.t("PLAYER")," "),m(3),Vt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),m(10),G(i.gameEngine.resources().wood),m(),Vt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),m(6),G(i.gameEngine.resources().iron),m(),Vt("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),m(18),B(" ",i.gameEngine.getForestControl().player," "),m(3),B(" ",i.gameEngine.getForestControl().total," "),m(4),B(" ",i.settings.t("TURN_CYCLE")," "),m(3),B(" ",i.gameEngine.turn()," "),m(),Q(i.gameEngine.monopolyTurnsLeft()>0?212:-1),m(3),Vt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),m(2),G(i.gameEngine.aiWood()),m(9),Vt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),m(6),G(i.gameEngine.aiIron()),m(),Vt("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),m(2),B(" ",i.gameEngine.getForestControl().ai," "),m(3),B(" ",i.gameEngine.getForestControl().total," "),m(20),B(" ",i.settings.t("HOSTILE")," "),m(3),Q(i.gameEngine.shouldShowEndOverlay()?261:-1),m(5),B(" ",i.settings.t("STRATEGIC_PLAN")," "),m(8),G(i.settings.t("SUPPORT")),m(),Q(i.gameEngine.supportOpen()?275:-1),m(),Q(i.gameEngine.leaderboardOpen()?276:-1),m(2),Q(i.settings.customMode()?278:-1),m(),Me("shake",i.gameEngine.screenShake())("mood-none",i.gameEngine.currentMood()==="none")("mood-angry",i.gameEngine.currentMood()==="angry")("mood-rage",i.gameEngine.currentMood()==="rage"),m(2),et("grid-template-columns","repeat("+i.gameEngine.gridSize+", minmax("+i.gameEngine.tileMinSizePx+"px, "+i.gameEngine.tileSizePx+"px))")("gap",i.gameEngine.wallThicknessPx+2,"px"),m(3),B(" ",i.gameEngine.baseHealth().player," "),m(),Q(i.gameEngine.isVisibleToPlayer(i.gameEngine.gridSize-1,i.gameEngine.gridSize-1)?285:-1),m(),In(i.gameEngine.gridRows),m(4),Me("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),m(3),G(i.settings.t("RISK")),m(2),Me("text-lime-300",i.settings.difficulty()==="baby")("text-emerald-300",i.settings.difficulty()==="normal")("text-orange-400",i.settings.difficulty()==="hard")("text-red-500",i.settings.difficulty()==="nightmare"),m(),B(" ",i.settings.t(i.settings.getDifficultyLabel(i.settings.difficulty()))," "),m(3),B(" ",i.settings.difficulty()==="baby"?"\u{1F476}":i.settings.difficulty()==="normal"?"\u{1F920}":i.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),m(2),et("width",i.settings.difficulty()==="baby"?25:i.settings.difficulty()==="normal"?50:i.settings.difficulty()==="hard"?75:100,"%"),Me("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),m(3),Me("ring-2",i.isAutoBattleActive())("ring-green-400",i.isAutoBattleActive()),Ie("disabled",i.gameEngine.gameStatus()!=="playing"),m(3),G(i.settings.t("AUTO")),m(2),G(i.settings.t("ENGAGE")),m(2),Me("bg-green-400",i.isAutoBattleActive())("bg-gray-500",!i.isAutoBattleActive()),m(2),Me("ring-2",i.gameEngine.buildMode())("ring-blue-400",i.gameEngine.buildMode()),Ie("disabled",i.gameEngine.wallBuiltThisTurn()||!i.gameEngine.canBuildThisTurn()),m(19),Ie("disabled",!i.gameEngine.canAddReserveTurn()),m(14),Ie("disabled",!i.gameEngine.canAddReserveTurn()),m(3),G(i.settings.t("ALL")),m(7),Ie("checked",i.gameEngine.fogDebugDisabled()),m(4),G(i.settings.t("MAP_HACK")),m(4),G(i.settings.t("NEXT_TURN")),m(5),ss(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),m(2),B(" ",i.settings.version," | \xA9\uFE0E Created by jaerbi and just "),m(),Q(i.gameEngine.rulesOpen()?372:-1),m(),Q(i.gameEngine.logOpen()?373:-1),m(),Q(i.gameEngine.settingsOpen()?374:-1),m(),Q(i.gameEngine.highScoresOpen()?375:-1),m(),Q(i.isProduction?-1:376)}},dependencies:[Pt,p0,g0,m0,y0,v0,BE,va],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}.move-anim[_ngcontent-%COMP%]{transition:transform .15s cubic-bezier(.4,0,.2,1);will-change:transform}"]})};var pO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(he(is),he(Ni))};static \u0275dir=vn({type:n})}return n})(),QW=(()=>{class n extends pO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275dir=vn({type:n,features:[Dr]})}return n})(),gO=new Ee("");var JW={provide:gO,useExisting:Yo(()=>C0),multi:!0};function ZW(){let n=ki()?ki().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var XW=new Ee(""),C0=(()=>{class n extends pO{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!ZW())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(he(is),he(Ni),he(XW,8))};static \u0275dir=vn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&te("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Uu([JW]),Dr]})}return n})();function B1(n){return n==null||j1(n)===0}function j1(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var mO=new Ee(""),yO=new Ee(""),eq=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Fo=class{static min(e){return tq(e)}static max(e){return nq(e)}static required(e){return iq(e)}static requiredTrue(e){return rq(e)}static email(e){return oq(e)}static minLength(e){return sq(e)}static maxLength(e){return aq(e)}static pattern(e){return lq(e)}static nullValidator(e){return vO()}static compose(e){return SO(e)}static composeAsync(e){return TO(e)}};function tq(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function nq(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function iq(n){return B1(n.value)?{required:!0}:null}function rq(n){return n.value===!0?null:{required:!0}}function oq(n){return B1(n.value)||eq.test(n.value)?null:{email:!0}}function sq(n){return e=>{let t=e.value?.length??j1(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function aq(n){return e=>{let t=e.value?.length??j1(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function lq(n){if(!n)return vO;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(B1(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function vO(n){return null}function _O(n){return n!=null}function EO(n){return rs(n)?ln(n):n}function bO(n){let e={};return n.forEach(t=>{e=t!=null?F(F({},e),t):e}),Object.keys(e).length===0?null:e}function wO(n,e){return e.map(t=>t(n))}function cq(n){return!n.validate}function xO(n){return n.map(e=>cq(e)?e:t=>e.validate(t))}function SO(n){if(!n)return null;let e=n.filter(_O);return e.length==0?null:function(t){return bO(wO(t,e))}}function IO(n){return n!=null?SO(xO(n)):null}function TO(n){if(!n)return null;let e=n.filter(_O);return e.length==0?null:function(t){let i=wO(t,e).map(EO);return xy(i).pipe(yt(bO))}}function CO(n){return n!=null?TO(xO(n)):null}function sO(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function DO(n){return n._rawValidators}function AO(n){return n._rawAsyncValidators}function F1(n){return n?Array.isArray(n)?n:[n]:[]}function b0(n,e){return Array.isArray(n)?n.includes(e):n===e}function aO(n,e){let t=F1(e);return F1(n).forEach(r=>{b0(t,r)||t.push(r)}),t}function lO(n,e){return F1(e).filter(t=>!b0(n,t))}var w0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=IO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=CO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ic=class extends w0{name;get formDirective(){return null}get path(){return null}},ph=class extends w0{_parent=null;name=null;valueAccessor=null},x0=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var MO=(()=>{class n extends x0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(he(ph,2))};static \u0275dir=vn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Me("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Dr]})}return n})(),RO=(()=>{class n extends x0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(he(Ic,10))};static \u0275dir=vn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Me("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Dr]})}return n})();var uh="VALID",E0="INVALID",xc="PENDING",dh="DISABLED",Rs=class{},S0=class extends Rs{value;source;constructor(e,t){super(),this.value=e,this.source=t}},hh=class extends Rs{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},fh=class extends Rs{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Sc=class extends Rs{status;source;constructor(e,t){super(),this.status=e,this.source=t}},L1=class extends Rs{source;constructor(e){super(),this.source=e}},gh=class extends Rs{source;constructor(e){super(),this.source=e}};function H1(n){return(D0(n)?n.validators:n)||null}function uq(n){return Array.isArray(n)?IO(n):n||null}function $1(n,e){return(D0(e)?e.asyncValidators:n)||null}function dq(n){return Array.isArray(n)?CO(n):n||null}function D0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function PO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new ge(1e3,"");if(!i[t])throw new ge(1001,"")}function NO(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new ge(1002,"")})}var Tc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return un(this.statusReactive)}set status(e){un(()=>this.statusReactive.set(e))}_status=ti(()=>this.statusReactive());statusReactive=$(void 0);get valid(){return this.status===uh}get invalid(){return this.status===E0}get pending(){return this.status==xc}get disabled(){return this.status===dh}get enabled(){return this.status!==dh}errors;get pristine(){return un(this.pristineReactive)}set pristine(e){un(()=>this.pristineReactive.set(e))}_pristine=ti(()=>this.pristineReactive());pristineReactive=$(!0);get dirty(){return!this.pristine}get touched(){return un(this.touchedReactive)}set touched(e){un(()=>this.touchedReactive.set(e))}_touched=ti(()=>this.touchedReactive());touchedReactive=$(!1);get untouched(){return!this.touched}_events=new jt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(aO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(aO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(lO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(lO(e,this._rawAsyncValidators))}hasValidator(e){return b0(this._rawValidators,e)}hasAsyncValidator(e){return b0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ce(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new fh(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new fh(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ce(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new hh(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new hh(!0,i))}markAsPending(e={}){this.status=xc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Sc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ce(F({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=dh,this.errors=null,this._forEachChild(r=>{r.disable(ce(F({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new S0(this.value,i)),this._events.next(new Sc(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ce(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=uh,this._forEachChild(i=>{i.enable(ce(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ce(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===uh||this.status===xc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new S0(this.value,t)),this._events.next(new Sc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ce(F({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?dh:uh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=xc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=EO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new Sc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new cn,this.statusChanges=new cn}_calculateStatus(){return this._allControlsDisabled()?dh:this.errors?E0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xc)?xc:this._anyControlsHaveStatus(E0)?E0:uh}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new hh(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new fh(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){D0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=uq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=dq(this._rawAsyncValidators)}},Cc=class extends Tc{constructor(e,t,i){super(H1(t),$1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){NO(this,!0,e),Object.keys(e).forEach(i=>{PO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,ce(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new gh(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var V1=class extends Cc{};var kO=new Ee("",{factory:()=>G1}),G1="always";function hq(n,e){return[...e.path,n]}function cO(n,e,t=G1){z1(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),pq(n,e),mq(n,e),gq(n,e),fq(n,e)}function uO(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),T0(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function I0(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function fq(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function z1(n,e){let t=DO(n);e.validator!==null?n.setValidators(sO(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=AO(n);e.asyncValidator!==null?n.setAsyncValidators(sO(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();I0(e._rawValidators,r),I0(e._rawAsyncValidators,r)}function T0(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=DO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=AO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return I0(e._rawValidators,i),I0(e._rawAsyncValidators,i),t}function pq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&OO(n,e)})}function gq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&OO(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function OO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function mq(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function yq(n,e){n==null,z1(n,e)}function vq(n,e){return T0(n,e)}function _q(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function Eq(n){return Object.getPrototypeOf(n.constructor)===QW}function bq(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function wq(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===C0?t=o:Eq(o)?i=o:r=o}),r||i||t||null}function xq(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function dO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function hO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Wa=class extends Tc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(H1(t),$1(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),D0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(hO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new gh(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){dO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){dO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){hO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Sq=n=>n instanceof Wa;var FO=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=vn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var U1=class extends Tc{constructor(e,t,i){super(H1(t),$1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){NO(this,!1,e),e.forEach((i,r)=>{PO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],ce(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new gh(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var Iq=(()=>{class n extends Ic{callSetDisabledState;get submitted(){return un(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=ti(()=>this._submittedReactive());_submittedReactive=$(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(T0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let i=this.form.get(t.path);return cO(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){uO(t.control||null,t,!1),xq(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,i){this.form.get(t.path).setValue(i)}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,bq(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new L1(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(uO(i||null,t),Sq(r)&&(cO(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);yq(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&vq(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){z1(this.form,this),this._oldForm&&T0(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(i){return new(i||n)(he(mO,10),he(yO,10),he(kO,8))};static \u0275dir=vn({type:n,features:[Dr,oo]})}return n})();var LO=new Ee("");var Tq={provide:ph,useExisting:Yo(()=>W1)},W1=(()=>{class n extends ph{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new cn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=wq(this,o)}ngOnChanges(t){this._added||this._setUpControl(),_q(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return hq(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(he(Ic,13),he(mO,10),he(yO,10),he(gO,10),he(LO,8))};static \u0275dir=vn({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Uu([Tq]),Dr,oo]})}return n})();var Cq={provide:Ic,useExisting:Yo(()=>q1)},q1=(()=>{class n extends Iq{form=null;ngSubmit=new cn;get control(){return this.form}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ha(n)))(r||n)}})();static \u0275dir=vn({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&te("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Uu([Cq]),Dr]})}return n})();var Dq=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ao({type:n});static \u0275inj=yr({})}return n})();function fO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var VO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return fO(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Cc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new V1(r,i)}control(t,i,r){let o={};return this.useNonNullable?(fO(i)?o=i:(o.validators=i,o.asyncValidators=r),new Wa(t,ce(F({},o),{nonNullable:!0}))):new Wa(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new U1(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof Wa)return t;if(t instanceof Tc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var UO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:LO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:kO,useValue:t.callSetDisabledState??G1}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ao({type:n});static \u0275inj=yr({imports:[Dq]})}return n})();var A0=class n{db;auth;constructor(){let e=bd(f0);this.db=Kd(e),this.auth=ch(e)}async addFeedback(e){let t=ce(F({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:Jd()});await eh(Si(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=Po(Si(this.db,"feedbacks"),lr("timestamp","desc"),Ts(e));return(await Cs(t)).docs.map(r=>r.data())}async getFeedbackPage(e,t){let i=[lr("timestamp","desc"),Ts(e)],r=t?Po(Si(this.db,"feedbacks"),lr("timestamp","desc"),lk(t),Ts(e)):Po(Si(this.db,"feedbacks"),lr("timestamp","desc"),Ts(e)),o=await Cs(r),s=o.docs.map(l=>l.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),i=Po(Si(this.db,"feedbacks"),Is("userId","==",e),Is("timestamp",">=",t)),o=(await Cs(i)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var K1=()=>[1,2,3,4,5],BO=(n,e)=>e.timestamp;function Rq(n,e){if(n&1){let t=Ge();v(0,"button",39),te("click",function(){let r=ne(t).$implicit,o=k(2);return ie(o.setRating(r))}),y(1," \u2605 "),E()}if(n&2){let t=e.$implicit,i=k(2);Me("active",i.form.value.rating>=t)}}function Pq(n,e){if(n&1&&(v(0,"div",36),y(1),E()),n&2){let t=k(2);m(),G(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function Nq(n,e){n&1&&(v(0,"div",37),y(1),E()),n&2&&(m(),G(e))}function kq(n,e){if(n&1){let t=Ge();v(0,"div",25)(1,"div",26),W(2,"img",27),E(),v(3,"div",28)(4,"div",29),y(5),E(),v(6,"div",30),y(7),E()()(),v(8,"form",31),te("ngSubmit",function(){ne(t);let r=k();return ie(r.submit())}),v(9,"div")(10,"div",32),y(11),E(),v(12,"div",33),Sn(13,Rq,2,2,"button",34,Ar),E()(),v(15,"div")(16,"div",32),y(17),E(),W(18,"textarea",35),Y(19,Pq,2,1,"div",36),Y(20,Nq,2,1,"div",37),E(),v(21,"button",38),y(22),E()()}if(n&2){let t,i=e,r=k();m(2),Ie("src",i.photoURL,Zi),m(3),G(i.displayName),m(2),G(r.settings.t("OPERATOR_ONLINE")),m(),Ie("formGroup",r.form),m(3),G(r.settings.t("EFFICIENCY_RATING")),m(2),In(pa(16,K1)),m(4),G(r.settings.t("TACTICAL_NOTE")),m(),Ie("placeholder",gE(r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),m(),Q(r.form.controls.text.errors?19:-1),m(),Q((t=r.message())?20:-1,t),m(),Me("cursor-pointer",r.canSubmit)("cursor-not-allowed",!r.canSubmit),Ie("disabled",!r.canSubmit),m(),B(" ",r.settings.t("TRANSMIT_REPORT")," ")}}function Oq(n,e){if(n&1&&(v(0,"div",21),y(1),E()),n&2){let t=k();m(),G(t.settings.t("SYSTEM_LOG"))}}function Fq(n,e){if(n&1&&(v(0,"div",22),y(1),E()),n&2){let t=k();m(),G(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function Lq(n,e){if(n&1&&(v(0,"span"),y(1,"\u2605"),E()),n&2){let t=e.$implicit,i=k().$implicit;Me("active",i.rating>=t)}}function Vq(n,e){if(n&1&&(v(0,"tr",44)(1,"td",47),W(2,"img",48),v(3,"span"),y(4),E()(),v(5,"td",49)(6,"div",50),Sn(7,Lq,2,2,"span",51,Ar),E()(),v(9,"td",49)(10,"span",52),y(11),E()(),v(12,"td",49)(13,"span",53),y(14),E()()()),n&2){let t=e.$implicit,i=k(2);m(2),Ie("src",t.userPhoto,Zi),m(2),G(t.userName),m(3),In(pa(4,K1)),m(4),G(t.text),m(3),G(i.formatDate(t.timestamp))}}function Uq(n,e){if(n&1&&(v(0,"tr")(1,"td",54),y(2),E()()),n&2){let t=k(2);m(2),G(t.settings.t("NO_SIGNALS"))}}function Bq(n,e){if(n&1){let t=Ge();v(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),y(5),E(),v(6,"th",43),y(7),E(),v(8,"th",43),y(9),E(),v(10,"th",43),y(11),E()()(),v(12,"tbody"),Sn(13,Vq,15,5,"tr",44,BO,!1,Uq,3,1,"tr"),E()()(),v(16,"div",45)(17,"button",46),te("click",function(){ne(t);let r=k();return ie(r.prevPage())}),y(18),E(),v(19,"button",46),te("click",function(){ne(t);let r=k();return ie(r.nextPage())}),y(20),E()()}if(n&2){let t=k();m(5),G(t.settings.t("TABLE_OPERATOR")),m(2),G(t.settings.t("TABLE_RATING")),m(2),G(t.settings.t("TABLE_MESSAGE")),m(2),G(t.settings.t("TABLE_DATE")),m(2),In(t.pageItems()),m(5),B(" ",t.settings.t("PREVIOUS")," "),m(2),B(" ",t.settings.t("NEXT")," ")}}function jq(n,e){if(n&1&&(v(0,"span"),y(1,"\u2605"),E()),n&2){let t=e.$implicit,i=k().$implicit;Me("active",i.rating>=t)}}function Hq(n,e){if(n&1&&(v(0,"div",55)(1,"div",56)(2,"div",57),W(3,"img",58),v(4,"div",59),y(5),E()(),v(6,"div",50),Sn(7,jq,2,2,"span",51,Ar),E()(),v(9,"div",60),y(10),E()()),n&2){let t=e.$implicit;m(3),Ie("src",t.userPhoto,Zi),m(2),G(t.userName),m(2),In(pa(3,K1)),m(3),G(t.text)}}function $q(n,e){if(n&1&&Sn(0,Hq,11,4,"div",55,BO),n&2){let t=k();In(t.recent())}}var M0=class n{constructor(e,t,i,r,o){this.fb=e;this.router=t;this.feedback=i;this.firebase=r;this.settings=o;this.form=new Cc({text:new Wa("",{nonNullable:!0,validators:[Fo.required,Fo.minLength(10),Fo.maxLength(500)]}),rating:new Wa(5,{nonNullable:!0,validators:[Fo.required,Fo.min(1),Fo.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,l=Number(localStorage.getItem(a)||0);this.disabledUntil.set(l)}this.loadPage(0)}recent=$([]);pageItems=$([]);pageStack=[null];pageIndex=$(0);lastDoc=null;disabledUntil=$(0);message=$(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);if(this.pageItems.set(r.items),this.lastDoc=r.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);this.pageItems.set(r.items),this.lastDoc=r.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:i}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let r=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:r.text||"",rating:Number(r.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(he(VO),he(Ei),he(A0),he(Rn),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,i){if(t&1&&(v(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),E(),ee(),v(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),E()()(),ke(),v(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),y(15),E(),v(16,"span",14),y(17),E()(),v(18,"a",15),y(19),E()(),v(20,"div",16)(21,"div",17)(22,"div",18),y(23),E(),Y(24,kq,23,17),E(),v(25,"div",19)(26,"div",20),Y(27,Oq,2,1,"div",21),Y(28,Fq,2,1,"div",22),v(29,"button",23),te("click",function(){return i.isAllShow=!i.isAllShow}),y(30),E()(),v(31,"div",24),Y(32,Bq,21,7),Y(33,$q,2,0),E()()()()()),t&2){let r;m(15),G(i.settings.t("FEEDBACK_MODULE")),m(2),G(i.settings.t("COMMUNITY_SIGNALS")),m(2),G(i.settings.t("RETURN_TO_MAP")),m(4),G(i.settings.t("DEPLOY_REPORT")),m(),Q((r=i.firebase.user$())?24:-1,r),m(3),Q(i.isAllShow?-1:27),m(),Q(i.isAllShow?28:-1),m(2),B(" ",i.isAllShow?i.settings.t("TOGGLE_BACK"):i.settings.t("VIEW_FULL_ARCHIVE")," "),m(2),Q(i.isAllShow?32:-1),m(),Q(i.isAllShow?-1:33)}},dependencies:[Pt,UO,FO,C0,MO,RO,q1,W1,kr],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var R0=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-roadmap"]],decls:93,vars:13,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"absolute","top-0","right-0","w-16","h-16","bg-emerald-500/10","blur-2xl","-mr-8","-mt-8"],[1,"card-header","relative","z-10"],[1,"text-[11px]","font-mono","text-emerald-200/50","italic"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","uppercase","tracking-wider","bg-emerald-500/20","text-emerald-400","border","border-emerald-500/40"],[1,"flex","items-start","gap-4","mt-4","relative","z-10"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/60","rotate-45","flex","items-center","justify-center","group-hover:rotate-180","transition-all","duration-700","shadow-[0_0_15px_rgba(16,185,129,0.2)]"],[1,"-rotate-45","group-hover:-rotate-180","transition-all","duration-700","text-xl"],[1,"text-lg","font-bold","text-emerald-50","leading-tight","mb-2","opacity-80","decoration-emerald-500/30","line-through","decoration-2"],[1,"text-sm","text-emerald-100/40","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-emerald-500/10","flex","justify-between","items-center","relative","z-10"],[1,"text-[9px]","uppercase","tracking-widest","text-emerald-500/40","font-bold"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-emerald-500","shadow-[0_0_5px_#10b981]"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,i){t&1&&(v(0,"div",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),E(),ee(),v(7,"svg",7)(8,"defs")(9,"clipPath",8),W(10,"path",9),E()()(),ke(),W(11,"div",10)(12,"div",11),v(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),W(17,"div",16),v(18,"h1",17),y(19),E()(),v(20,"p",18),y(21,"Future_Ops // Deployment_Schedule"),E()(),v(22,"a",19)(23,"span",20),y(24,"\xAB"),E(),y(25),E()(),v(26,"div",21)(27,"div",22),W(28,"div",23),v(29,"div",24)(30,"span",25),y(31,"REF: PROJECT_VOLUMETRIC"),E(),v(32,"span",26),y(33),E()(),v(34,"div",27)(35,"div",28)(36,"div",29),y(37),E()(),v(38,"div")(39,"h3",30),y(40),E(),v(41,"p",31),y(42),E()()(),v(43,"div",32)(44,"span",33),y(45,"System_Verified"),E(),v(46,"div",34),W(47,"div",35)(48,"div",35)(49,"div",35),E()()(),v(50,"div",22)(51,"div",36)(52,"span",37),y(53,"REF: RESOURCE_IRON"),E(),v(54,"span",26),y(55),E()(),v(56,"div",38)(57,"div",39)(58,"span"),y(59,"\u26D3\uFE0F"),E()(),v(60,"div")(61,"h3",40),y(62),E(),v(63,"p",41),y(64),E()()(),v(65,"div",42)(66,"span",43),y(67,"Priority_Beta"),E(),v(68,"div",34),W(69,"div",44)(70,"div",45)(71,"div",45),E()()(),v(72,"div",46)(73,"div",36)(74,"span",37),y(75,"REF: INFRA_SMITHY"),E(),v(76,"span",26),y(77),E()(),v(78,"div",47)(79,"div",48),W(80,"div",49),v(81,"span",50),y(82,"\u2692\uFE0F"),E()(),v(83,"div")(84,"h3",51),y(85),E(),v(86,"p",52),y(87),E()()()()(),v(88,"div",53)(89,"div",54),y(90,"Community_Intel"),E(),v(91,"p",55),y(92),E()()()()),t&2&&(m(19),B(" ",i.settings.t("STRATEGIC_PLAN")," "),m(6),B(" ",i.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),m(8),B(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),m(4),B(" ",i.settings.currentLang()==="uk"?"\u2714\uFE0F":"\u2705"," "),m(3),B(" ",i.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"," "),m(2),B(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),m(13),B(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),m(7),G(i.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),m(2),B(" ",i.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),m(13),B(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),m(8),G(i.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),m(2),B(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),m(5),B(" ",i.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[Pt,kr],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var P0=class n{constructor(e,t){this.router=e;this.settings=t}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||n)(he(Ei),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-landing-page"]],decls:41,vars:7,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden","relative"],[1,"absolute","top-1/4","-left-1/4","w-96","h-96","bg-emerald-500/20","rounded-full","blur-3xl","animate-pulse"],[1,"absolute","bottom-1/4","-right-1/4","w-96","h-96","bg-purple-500/20","rounded-full","blur-3xl","animate-pulse",2,"animation-delay","1ms"],[1,"z-10","text-center","mb-12"],[1,"text-6xl","font-black","tracking-tighter","mb-4","bg-gradient-to-r","from-emerald-400","to-cyan-400","bg-clip-text","text-transparent","drop-shadow-sm"],[1,"text-slate-400","text-lg","max-w-md","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","w-full","max-w-5xl","z-10"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-emerald-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-emerald-400","hover:shadow-[0_0_40px_-10px_rgba(52,211,153,0.3)]","text-left",3,"click"],[1,"absolute","top-0","right-0","p-4","opacity-10","group-hover:opacity-20","transition-opacity"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24"],["d","M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.8L19.5 8 12 11.2 4.5 8 12 4.8zM4 15.5v-5.2l7 3.1v5.2l-7-3.1zm9 3.1v-5.2l7-3.1v5.2l-7 3.1z"],[1,"relative","z-20"],[1,"inline-block","px-3","py-1","bg-emerald-500/10","text-emerald-400","text-xs","font-bold","rounded-full","mb-4","border","border-emerald-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-emerald-50"],[1,"text-slate-400","leading-relaxed","mb-6"],[1,"flex","items-center","text-emerald-400","font-bold","group-hover:translate-x-2","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-purple-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-purple-400","hover:shadow-[0_0_40px_-10px_rgba(168,85,247,0.3)]","text-left",3,"click"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"inline-block","px-3","py-1","bg-purple-500/10","text-purple-400","text-xs","font-bold","rounded-full","mb-4","border","border-purple-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-purple-50"],[1,"flex","items-center","text-purple-400","font-bold","group-hover:translate-x-2","transition-transform"],[1,"absolute","bottom-6","text-slate-500","text-sm","font-medium","uppercase","tracking-widest"]],template:function(t,i){t&1&&(C(0,"div",0),H(1,"div",1)(2,"div",2),C(3,"div",3)(4,"h1",4),y(5),A(),C(6,"p",5),y(7),A()(),C(8,"div",6)(9,"button",7),Ht("click",function(){return i.navigateTo("shape-tactics")}),C(10,"div",8),ee(),C(11,"svg",9),H(12,"path",10),A()(),ke(),C(13,"div",11)(14,"span",12),y(15),A(),C(16,"h2",13),y(17,"Shape Tactics"),A(),C(18,"p",14),y(19),A(),C(20,"div",15),y(21," ENTER PORTAL "),ee(),C(22,"svg",16),H(23,"path",17),A()()()(),ke(),C(24,"button",18),Ht("click",function(){return i.navigateTo("tower-defense")}),C(25,"div",8),ee(),C(26,"svg",9),H(27,"path",19),A()(),ke(),C(28,"div",11)(29,"span",20),y(30),A(),C(31,"h2",21),y(32,"Shape Defense"),A(),C(33,"p",14),y(34),A(),C(35,"div",22),y(36," DEFEND BASE "),ee(),C(37,"svg",16),H(38,"path",17),A()()()()(),ke(),C(39,"footer",23),y(40),A()()),t&2&&(m(5),B(" ",i.settings.currentLang()==="uk"?"\u0406\u0413\u0420\u041E\u0412\u0418\u0419 \u0426\u0415\u041D\u0422\u0420":"GAMING HUB"," "),m(2),B(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043E\u0440\u0442\u0430\u043B, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0441\u0432\u043E\u044E \u043F\u043E\u0434\u043E\u0440\u043E\u0436.":"Select a portal to begin your journey."," "),m(8),B(" ","Live Now"," "),m(4),B(" ",i.settings.t("SHAPE_TACTIC_DESCRIPTION")," "),m(11),B(" ",i.settings.currentLang()==="uk"?"\u0413\u0420\u0410\u0422\u0418 \u0417\u0410\u0420\u0410\u0417":"PLAY NOW"," "),m(4),B(" ",i.settings.t("TOWER_DEFFENCE_DESCRIPTION")," "),m(6),B(" \xA9 2026 Shape Tactics Labs // ",i.settings.version," "))},dependencies:[Pt],styles:["[_nghost-%COMP%]{display:block}"]})};var N0=class n{constructor(e,t){this.ngZone=e;this.firebase=t;this.initGame()}money=$(100);lives=$(20);wave=$(0);isWaveInProgress=$(!1);gameOver=$(!1);gridSize=10;grid=$([]);path=$([]);tileSize=62;enemies=$([]);projectiles=$([]);gameSpeedMultiplier=$(1);nextWaveEnemyType=$("standard");enemiesInternal=[];projectilesInternal=[];towersInternal=[];enemyIdCounter=1;projectileIdCounter=1;uiTick$=new jt;animationFrameId=null;lastUpdateTime=0;enemiesToSpawn=0;currentWaveEnemyCount=0;spawnTimer=0;spawnInterval=1e3;currentWaveType="standard";towerCosts=[15,50,250,1500];tierStats=[{damage:5,range:2,fireInterval:.5},{damage:20,range:2.5,fireInterval:1},{damage:80,range:3,fireInterval:1.5},{damage:300,range:3.5,fireInterval:2}];savedResult=!1;async saveResultIfLoggedIn(){let e=this.firebase.user$();if(!e)return;let t={userId:e.uid,displayName:e.displayName||"Anonymous",maxWave:this.wave(),totalMoney:this.money()};try{await this.firebase.saveTowerDefenseScore(t)}catch{}}dispose(){this.stopGameLoop(),this.enemiesInternal=[],this.projectilesInternal=[],this.towersInternal=[],this.enemiesToSpawn=0,this.currentWaveEnemyCount=0,this.spawnTimer=0,this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!1),this.savedResult=!1,this.money.set(100),this.lives.set(100),this.wave.set(0);let e=this.grid();if(e&&e.length){let t=e.map(i=>i.map(r=>r.tower?ce(F({},r),{tower:null}):r));this.grid.set(t)}}resetEngine(){this.initializeGame(1)}initGame(){this.initializeGame(1)}resetGame(){this.initializeGame(1)}generateMap(){let e=this.generateRandomPath();this.path.set(e);let t=[];this.towersInternal=[];let i=new Set(e.map(r=>`${r.x},${r.y}`));for(let r=0;r<this.gridSize;r++){let o=[];for(let s=0;s<this.gridSize;s++){let a="void";i.has(`${s},${r}`)?a="path":[{x:s-1,y:r},{x:s+1,y:r},{x:s,y:r-1},{x:s,y:r+1}].some(c=>i.has(`${c.x},${c.y}`))&&(a="buildable"),o.push({x:s,y:r,type:a,tower:null})}t.push(o)}this.grid.set(t)}initializeGame(e){this.gridSize=e===2?20:10,this.dispose(),this.generateMap(),this.nextWaveEnemyType.set(this.determineWaveType(1))}determineWaveType(e){if(e<=3)return"standard";if(e<=8)return Math.random()<.5?"scout":"standard";let t=Math.random();return t<.33?"tank":t<.66?"scout":"standard"}generateRandomPath(){let e=this.gridSize-1,t={x:0,y:0},i={x:e,y:e},r=[t],o=new Set([`${t.x},${t.y}`]),s=f=>`${f.x},${f.y}`,a=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}],l=F({},t),c=this.gridSize*this.gridSize*5,d=(f,g)=>Math.abs(f.x-g.x)+Math.abs(f.y-g.y);for(;(l.x!==i.x||l.y!==i.y)&&c-- >0;){let f=[];for(let L of a){let Z=l.x+L.x,ve=l.y+L.y;if(Z<0||ve<0||Z>e||ve>e)continue;let be=`${Z},${ve}`;o.has(be)||f.push({x:Z,y:ve})}if(f.length===0){if(r.length<=1)break;r.pop(),l=F({},r[r.length-1]);continue}f.sort((L,Z)=>d(L,i)-d(Z,i));let g,w=f[0];if(f.length===1)g=w;else{let L=f.slice(1);Math.random()<.35?g=L[Math.floor(Math.random()*L.length)]:g=w}let S=r[r.length-1],P=r.length>1?r[r.length-2]:null;if(P){let L=S.x-P.x,Z=S.y-P.y,ve=g.x-S.x,be=g.y-S.y;(L!==ve||Z!==be)&&r.length<3&&Math.random()<.5&&(g=w)}r.push(g),o.add(s(g)),l=g}let h=0;for(let f=2;f<r.length;f++){let g=r[f-2],w=r[f-1],S=r[f],P=w.x-g.x,L=w.y-g.y,Z=S.x-w.x,ve=S.y-w.y;(P!==Z||L!==ve)&&h++}if(h<4&&r.length>2)for(let f=2;f<r.length-1&&h<4;f++){let g=r[f-2],w=r[f-1],S=r[f],P=w.x-g.x,L=w.y-g.y,Z=S.x-w.x,ve=S.y-w.y;if(!(P===Z&&L===ve))continue;let Ce=[];for(let O of a){let I=w.x+O.x,N=w.y+O.y;if(I<0||N<0||I>e||N>e)continue;let D=`${I},${N}`;o.has(D)||Ce.push({x:I,y:N})}if(Ce.length===0)continue;let Te=Ce[Math.floor(Math.random()*Ce.length)];r.splice(f,0,Te),o.add(s(Te)),h++}return r}startWave(){if(this.isWaveInProgress()||this.gameOver())return;this.wave.update(t=>t+1),this.isWaveInProgress.set(!0),this.currentWaveType=this.nextWaveEnemyType(),this.nextWaveEnemyType.set(this.determineWaveType(this.wave()+1));let e=5+this.wave()*2;this.enemiesToSpawn=e,this.currentWaveEnemyCount=e,this.spawnTimer=0,this.startGameLoop()}startGameLoop(){this.stopGameLoop(),this.lastUpdateTime=performance.now(),this.ngZone.runOutsideAngular(()=>{let e=t=>{if(this.gameOver())return;let i=(t-this.lastUpdateTime)/1e3;this.lastUpdateTime=t;let r=Math.min(i,.05);this.updateGame(r),this.enemies.set([...this.enemiesInternal]),this.gameSpeedMultiplier()===1?this.projectiles.set([...this.projectilesInternal]):this.projectiles.set([]),this.uiTick$.next(),this.animationFrameId=requestAnimationFrame(e)};this.animationFrameId=requestAnimationFrame(e)})}stopGameLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateGame(e){let t=e*this.gameSpeedMultiplier();if(this.handleSpawning(t),this.updateEnemies(t),this.updateTowers(t),this.updateProjectiles(t),this.lives()<=0&&!this.gameOver()){if(this.enemiesInternal=[],this.projectilesInternal=[],this.enemiesToSpawn=0,this.stopGameLoop(),this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!0)}),!this.savedResult){this.savedResult=!0,this.saveResultIfLoggedIn();let i=this.wave(),r=0;if(i>=5){let o=i*1.5,s=i>20?(i-20)*2:0;r=Math.floor(o+s)}r>0&&this.firebase.awardTowerDefenseXp(r)}return}if(this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&this.isWaveInProgress()){this.enemiesInternal=[],this.projectilesInternal=[],this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1)});let i=this.determineWaveType(this.wave()+1);this.nextWaveEnemyType.set(i)}}getUpgradeLevel(e,t){let i=this.firebase.masteryProfile();if(!i)return 0;let r=`t${e}_${t}`,o=i.upgrades?.[r];return typeof o=="number"?o:0}getProjectileSpeedMultiplierForTower(e){if(e.type===2){let t=this.getUpgradeLevel(2,"golden");if(t>0)return 1+.2*t}return 1}handleSpawning(e){this.enemiesToSpawn<=0||(this.spawnTimer+=e*1e3,this.spawnTimer>=this.spawnInterval&&(this.spawnTimer=0,this.spawnEnemy(),this.enemiesToSpawn--))}spawnEnemy(){let e=50*Math.pow(1.2,this.wave()),t=.5+this.wave()*.05,i=this.currentWaveEnemyCount||5+this.wave()*2,r=i-this.enemiesToSpawn,o=this.wave()%5===0,s=r===i-1,a=o&&s,l=this.wave()*40%360,c=this.currentWaveType;a&&(c="boss");let d=e,h=t;c==="tank"?(d=e*2,h=t*.5):c==="scout"?(d=e*.4,h=t*2):c==="boss"&&(d=e*3,h=t*.5);let f={id:"e"+this.enemyIdCounter++,position:F({},this.path()[0]),pathIndex:0,hp:d,maxHp:d,speed:h,progress:0,isBoss:a,hue:l,baseSpeed:t,speedModifier:1,shatterStacks:0,isFrozen:!1,type:c};this.enemiesInternal.push(f)}updateEnemies(e){for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i];r.speedModifier=1,r.isFrozen=!1,r.stunTime&&r.stunTime>0&&(r.stunTime=Math.max(0,r.stunTime-e))}this.applyFrostAuras();let t=this.tileSize;for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i];if(r.stunTime&&r.stunTime>0){let P=this.path(),L=P[r.pathIndex],Z=P[r.pathIndex+1]||L,ve=L.x+(Z.x-L.x)*r.progress,be=L.y+(Z.y-L.y)*r.progress;r.displayX=(ve+.5)*t,r.displayY=(be+.5)*t;continue}let o=r.baseSpeed,s=r.type==="tank"?.5:r.type==="scout"?2:r.type==="boss"?.5:1,a=o*s*r.speedModifier;if(r.progress+=a*e,r.progress>=1){if(r.pathIndex++,r.progress=0,r.pathIndex>=this.path().length-1){this.enemiesInternal.splice(i,1),this.ngZone.run(()=>this.lives.update(P=>Math.max(0,P-1))),this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&(this.currentWaveType="standard");continue}r.position=F({},this.path()[r.pathIndex])}let l=this.path(),c=l[r.pathIndex],d=l[r.pathIndex+1]||c,h=c.x+(d.x-c.x)*r.progress,f=c.y+(d.y-c.y)*r.progress;r.displayX=(h+.5)*t,r.displayY=(f+.5)*t;let g=r.shatterStacks??0,w=g>0?Math.min(70,50+g*4):50,S=1;r.type==="tank"?S=1.2:r.type==="scout"?S=.9:r.type==="boss"&&(S=1.6),r.scale=S,r.isFrozen?r.bg=`hsl(190, 80%, ${w}%)`:r.type==="tank"?r.bg=`hsl(330, 70%, ${w}%)`:r.type==="scout"?r.bg=`hsl(50, 90%, ${w}%)`:r.type==="boss"?r.bg=`hsl(${r.hue}, 90%, ${Math.min(80,w+10)}%)`:r.bg=`hsl(${r.hue}, 70%, ${w}%)`,r.hp<=0&&(this.enemiesInternal.splice(i,1),this.ngZone.run(()=>this.money.update(P=>P+5+this.wave())))}}updateTowers(e){if(!(this.enemiesInternal.length===0||this.towersInternal.length===0)){for(let t of this.towersInternal)if(t.cooldown-=e,t.cooldown<=0){let i=this.findNearestEnemy(t,this.enemiesInternal);i?(this.fireAt(t,i),t.cooldown=t.fireInterval):t.cooldown=0}}}applyFrostAuras(){if(this.enemiesInternal.length===0)return;let e=this.towersInternal.filter(l=>l.type===1&&l.specialActive);if(e.length===0)return;let t=this.getUpgradeLevel(1,"golden"),i=2,r=t>0?.1:0,o=i+r,s=o*o,a=t>0?.6:.7;for(let l of this.enemiesInternal){let c=!1;for(let d of e){let h=d.position.x-l.position.x,f=d.position.y-l.position.y;if(h*h+f*f<=s){c=!0;break}}c&&(l.speedModifier=a,l.isFrozen=!0)}}findNearestEnemy(e,t){let i=null,r=e.range*e.range;for(let o of t){let s=e.position.x-o.position.x,a=e.position.y-o.position.y,l=s*s+a*a;l<=r&&(r=l,i=o)}return i}pushProjectile(e){this.projectilesInternal.length>=100&&this.projectilesInternal.shift(),this.projectilesInternal.push(e)}fireAt(e,t){let i={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},t.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(i);let r=e.damage;if(e.type===2){let o=this.getUpgradeLevel(2,"golden");if(o>0){let s=.1*o;Math.random()<s&&(r=Math.floor(r*2))}}if(e.specialActive&&e.type===4&&t.hp/t.maxHp<.15)if(t.isBoss)r=e.damage*3;else{t.hp=0;return}if(e.specialActive&&e.type===3){let o=Math.min(5,t.shatterStacks+1);t.shatterStacks=o;let s=1+o*.1;r=Math.floor(r*s)}if(t.hp-=r,e.type===3){let o=this.getUpgradeLevel(3,"golden");if(o>0){let s=.05*o;Math.random()<s&&(t.stunTime=Math.max(t.stunTime??0,.5))}}if(e.specialActive&&e.type===2&&Math.random()<.25){let o=[];for(let a of this.enemiesInternal){if(a.id===t.id)continue;let l=t.position.x-a.position.x,c=t.position.y-a.position.y;if(Math.sqrt(l*l+c*c)<=3&&(o.push(a),o.length>=2))break}let s=Math.floor(e.damage*.5);for(let a of o){let l={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},a.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(l),a.hp-=s}}if(e.type===4&&this.getUpgradeLevel(4,"golden")>0){let s=null,a=1/0;for(let l of this.enemiesInternal){if(l.id===t.id)continue;let c=t.position.x-l.position.x,d=t.position.y-l.position.y,h=Math.sqrt(c*c+d*d);h<=3&&h<a&&(a=h,s=l)}if(s){let l={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},s.position),progress:0,speedMultiplier:this.getProjectileSpeedMultiplierForTower(e)};this.pushProjectile(l);let c=Math.floor(r*.5);s.hp-=c}}}updateProjectiles(e){for(let t=this.projectilesInternal.length-1;t>=0;t--){let i=this.projectilesInternal[t],r=i.speedMultiplier??1;i.progress+=5*r*e,i.progress>=1&&this.projectilesInternal.splice(t,1)}}buyTower(e,t,i){let r=this.towerCosts[i-1];this.money()<r||this.grid.update(o=>{let s=o[t][e];if(s.type==="buildable"&&!s.tower){let a=this.tierStats[i-1],l=this.getUpgradeLevel(i,"damage"),c=this.getUpgradeLevel(i,"range"),d=1+l*.05,h=c*.1;s.tower={id:crypto.randomUUID(),type:i,level:1,position:{x:e,y:t},baseCost:r,invested:r,damage:Math.floor(a.damage*d),range:a.range+h,fireInterval:a.fireInterval,cooldown:0,specialActive:!1},this.towersInternal.push(s.tower),this.money.update(f=>f-r)}return[...o]})}upgradeTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level<4){let o=this.getUpgradeCost(r.tower);this.money()>=o&&(r.tower.level++,r.tower.damage=Math.floor(r.tower.damage*1.3),r.tower.range+=.5,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i]})}getUpgradeCost(e){let t=.5;switch(e.level){case 1:t=.5;break;case 2:t=.6;break;case 3:t=.7;break}return Math.floor(e.baseCost*t)}getSpecialCost(e){return e.baseCost*4}buyAbility(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level===4&&!r.tower.specialActive){let o=this.getSpecialCost(r.tower);this.money()>=o&&(r.tower.specialActive=!0,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i.map(o=>[...o])]})}sellTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower){let o=r.tower.invested??r.tower.baseCost,s=Math.floor(o*.5),a=r.tower.id;r.tower=null,this.money.update(c=>c+s);let l=this.towersInternal.findIndex(c=>c.id===a);l!==-1&&this.towersInternal.splice(l,1)}return[...i]})}getEnemiesRef(){return this.enemiesInternal}getProjectilesRef(){return this.projectilesInternal}getTowersRef(){return this.towersInternal}getPathRef(){return this.path()}getGridRef(){return this.grid()}static \u0275fac=function(t){return new(t||n)(Re(yn),Re(Rn))};static \u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})};var zq=["gameCanvas"],Wq=(n,e,t)=>({"shape-circle":n,"shape-triangle":e,"shape-square":t});function qq(n,e){if(n&1){let t=Ge();Ml(0),v(1,"button",35),te("click",function(){ne(t);let r=Mr(0),o=k(3);return ie(o.buyTower(r))}),v(2,"div",36)(3,"span",37),y(4),E(),v(5,"span"),y(6),E()(),v(7,"span",38),y(8),E()()}if(n&2){let t=e.$implicit,i=e.$index,r=k(3),o=Vu(i+1);m(),Me("bg-slate-700",r.tdEngine.money()>=t)("hover:bg-slate-600",r.tdEngine.money()>=t)("bg-slate-900",r.tdEngine.money()<t),Ie("disabled",r.tdEngine.money()<t),m(3),B("T",o),m(2),Mt("",r.settings.t("TIER")," ",o),m(2),B("$",t)}}function Kq(n,e){if(n&1&&(v(0,"h3",32),y(1),E(),v(2,"div",33),Sn(3,qq,9,12,"button",34,Fu),E()),n&2){let t=k(2);m(),B(" ",t.settings.t("BUY_DEFENDER")," "),m(2),In(t.tdEngine.towerCosts)}}function Yq(n,e){if(n&1){let t=Ge();v(0,"button",51),te("click",function(){ne(t);let r=k(3);return ie(r.upgradeTower())}),v(1,"span"),y(2),E(),v(3,"span",52),y(4),E()()}if(n&2){let t=k(2),i=k();Ie("disabled",i.tdEngine.money()<i.tdEngine.getUpgradeCost(t.tower)),m(2),G(i.settings.t("UPGRADE")),m(2),B("$",i.tdEngine.getUpgradeCost(t.tower))}}function Qq(n,e){if(n&1&&(v(0,"div",49),y(1),E()),n&2){let t=k(3);m(),B(" ",t.settings.t("MAX_LEVEL")," ")}}function Jq(n,e){if(n&1&&(v(0,"span",52),y(1),E()),n&2){let t=k(3),i=k();m(),B("$",i.tdEngine.getSpecialCost(t.tower))}}function Zq(n,e){if(n&1&&(v(0,"div",55),y(1),E(),v(2,"div",56),y(3),E()),n&2){let t=k(4);m(),B(" ",t.settings.t("FROST_AURA")," "),m(2),B(" ",t.settings.t("FROST_AURA_INFO")," ")}}function Xq(n,e){if(n&1&&(v(0,"div",57),y(1),E(),v(2,"div",56),y(3),E()),n&2){let t=k(4);m(),B(" ",t.settings.t("CHAIN_LIGHTNING")," "),m(2),B(" ",t.settings.t("CHAIN_LIGHTNING_INFO")," ")}}function eK(n,e){if(n&1&&(v(0,"div",58),y(1),E(),v(2,"div",56),y(3),E()),n&2){let t=k(4);m(),B(" ",t.settings.t("SHATTER")," "),m(2),B(" ",t.settings.t("SHATTER_INFO")," ")}}function tK(n,e){if(n&1&&(v(0,"div",59),y(1),E(),v(2,"div",56),y(3),E()),n&2){let t=k(4);m(),B(" ",t.settings.t("FINAL_STRIKE")," "),m(2),B(" ",t.settings.t("FINAL_STRIKE_INFO")," ")}}function nK(n,e){if(n&1){let t=Ge();v(0,"button",53),te("click",function(){ne(t);let r=k(3);return ie(r.buyAbility())}),v(1,"span"),y(2),E(),Y(3,Jq,2,1,"span",52),E(),v(4,"div",54),Y(5,Zq,4,2),Y(6,Xq,4,2),Y(7,eK,4,2),Y(8,tK,4,2),E()}if(n&2){let t=k(2),i=k();Me("bg-purple-600",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("hover:bg-purple-500",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("bg-slate-700",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),Ie("disabled",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),m(2),B(" ",t.tower.specialActive?i.settings.t("ABILITY_ACTIVE"):i.settings.t("BUY_ABILITY")," "),m(),Q(t.tower.specialActive?-1:3),m(2),Q(t.tower.type===1?5:-1),m(),Q(t.tower.type===2?6:-1),m(),Q(t.tower.type===3?7:-1),m(),Q(t.tower.type===4?8:-1)}}function iK(n,e){if(n&1){let t=Ge();v(0,"h3",39),y(1),E(),v(2,"div",40)(3,"div",41)(4,"span",42),y(5),E(),v(6,"span",43),y(7),E()(),v(8,"div",41)(9,"span",42),y(10),E(),v(11,"span",43),y(12),E()(),v(13,"div",41)(14,"span",42),y(15),E(),v(16,"span",44),y(17),E()(),v(18,"div",45)(19,"span",42),y(20),E(),v(21,"span",46),y(22),E()()(),v(23,"div",47),Y(24,Yq,5,3,"button",48)(25,Qq,2,1,"div",49),v(26,"button",50),te("click",function(){ne(t);let r=k(2);return ie(r.sellTower())}),y(27),E(),Y(28,nK,9,13),E()}if(n&2){let t=k(),i=k();m(),B(" ",i.settings.t("DEFENDER_INFO")," "),m(4),G(i.settings.t("TIER")),m(2),G(t.tower.type),m(3),G(i.settings.t("LEVEL")),m(2),B("",t.tower.level," / 4"),m(3),G(i.settings.t("DAMAGE")),m(2),G(t.tower.damage),m(3),G(i.settings.t("RANGE")),m(2),G(t.tower.range),m(2),Q(t.tower.level<4?24:25),m(3),B(" ",i.settings.t("SELL")," (50% REFUND) "),m(),Q(t.tower.level===4?28:-1)}}function rK(n,e){n&1&&Y(0,Kq,5,1)(1,iK,29,12),n&2&&Q(e.tower?1:0)}function oK(n,e){if(n&1&&(v(0,"div",30),ee(),v(1,"svg",60),W(2,"path",61),E(),ke(),v(3,"p",62),y(4),W(5,"br"),y(6),E()()),n&2){let t=k();m(4),B(" ",t.settings.t("SELECT_BUILD_TILE")," "),m(2),B(" ",t.settings.t("TO_PLACE_DEFENDER")," ")}}function sK(n,e){if(n&1){let t=Ge();v(0,"div",31)(1,"div",63)(2,"h2",64),y(3),E(),v(4,"p",65),y(5),E(),v(6,"button",66),te("click",function(){ne(t);let r=k();return ie(r.onRestart())}),y(7),E()()()}if(n&2){let t=k();m(3),G(t.settings.t("GAME_OVER")),m(2),ss(" ",t.settings.t("YOU_SURVIVED")," ",t.tdEngine.wave()," ",t.settings.t("WAVES")," "),m(2),B(" ",t.settings.t("TRY_AGAIN")," ")}}var k0=class n{constructor(e,t,i,r,o){this.tdEngine=e;this.settings=t;this.firebase=i;this.router=r;this.cdr=o}selectedTile=$(null);mapLevel=$(1);uiSub;gameCanvas;ctx;rafId=null;isBrowser=typeof window<"u"&&typeof document<"u";onKeyDown(e){if(this.tdEngine.isWaveInProgress())return;if(e.key==="Enter"){e.preventDefault(),this.tdEngine.startWave();return}}onKeyUp(e){}ngOnInit(){this.tdEngine.initializeGame(this.mapLevel()),this.uiSub=this.tdEngine.uiTick$.subscribe(()=>{this.cdr.detectChanges()})}ngAfterViewInit(){this.isBrowser&&(this.initCanvas(),this.startCanvasLoop(),window.addEventListener("resize",this.resizeCanvas))}ngOnDestroy(){this.uiSub?.unsubscribe(),this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.isBrowser&&window.removeEventListener("resize",this.resizeCanvas),this.tdEngine.resetEngine()}goBack(){this.tdEngine.resetEngine(),this.router.navigate(["/"])}onRestart(){this.tdEngine.initializeGame(this.mapLevel()),this.selectedTile.set(null)}onTileClick(e){e.type==="buildable"||e.tower?this.selectedTile.set(e):this.selectedTile.set(null)}buyTower(e){let t=this.selectedTile();t&&(this.tdEngine.buyTower(t.x,t.y,e),this.selectedTile.set(null))}upgradeTower(){let e=this.selectedTile();e&&e.tower&&this.tdEngine.upgradeTower(e.x,e.y)}getRangeStyle(){let e=this.selectedTile();if(!e||!e.tower)return{display:"none"};let t=e.tower,i=t.range*2*62;return{left:`${t.position.x*62+30}px`,top:`${t.position.y*62+30}px`,width:`${i}px`,height:`${i}px`,display:"block"}}sellTower(){let e=this.selectedTile();e&&e.tower&&(this.tdEngine.sellTower(e.x,e.y),this.selectedTile.set(null))}buyAbility(){let e=this.selectedTile();e&&e.tower&&e.tower.level===4&&!e.tower.specialActive&&this.tdEngine.buyAbility(e.x,e.y)}setSpeed(e){this.tdEngine.gameSpeedMultiplier.set(e)}onMapSizeChange(e){e!==this.mapLevel()&&(this.mapLevel.set(e),this.tdEngine.initializeGame(e),this.selectedTile.set(null),this.isBrowser&&this.resizeCanvas())}onLoginClick(){if(!this.firebase.user$())try{this.firebase.loginWithGoogle()}catch{}}initCanvas=()=>{let e=this.gameCanvas?.nativeElement;e&&(this.ctx=e.getContext("2d"),this.resizeCanvas())};resizeCanvas=()=>{let e=this.gameCanvas?.nativeElement;if(!e)return;let t=this.tdEngine.tileSize,i=this.tdEngine.gridSize*t;e.style.width=`${i}px`,e.style.height=`${i}px`;let r=Math.max(1,window.devicePixelRatio||1);e.width=Math.floor(i*r),e.height=Math.floor(i*r);let o=e.getContext("2d");o&&(o.setTransform(r,0,0,r,0,0),this.ctx=o)};startCanvasLoop(){let e=()=>{this.drawFrame(),this.rafId=requestAnimationFrame(e)};this.rafId=requestAnimationFrame(e)}clearCanvas(e,t){e.clearRect(0,0,t,t)}drawFrame(){let e=this.gameCanvas?.nativeElement,t=this.ctx;if(!e||!t)return;let i=this.tdEngine.tileSize,r=this.tdEngine.gridSize*i;this.clearCanvas(t,r),this.drawGrid(t,i),this.drawSelection(t,i),this.drawFrostAuras(t,i),this.drawTowers(t,i),this.drawEnemies(t,i),this.tdEngine.gameSpeedMultiplier()===1&&this.drawProjectiles(t,i),this.drawRangeIndicator(t,i)}drawGrid(e,t){let i=this.tdEngine.getGridRef();for(let r=0;r<i.length;r++){let o=i[r];for(let s=0;s<o.length;s++){let a=o[s];a.type==="path"?e.fillStyle="#475569":a.type==="buildable"?e.fillStyle="#1e293b":e.fillStyle="rgba(255,255,255,0.06)",e.fillRect(s*t,r*t,t-2,t-2)}}}drawTowers(e,t){let i=this.tdEngine.getTowersRef();for(let r of i){let o=r.position.x*t+t/2,s=r.position.y*t+t/2;this.drawTowerShape(e,o,s,r.type,r.level,t)}}drawTowerShape(e,t,i,r,o,s){let a=s*.5,l=a/2,c=r===1?"#0ea5e9":r===2?"#a855f7":r===3?"#f59e0b":"#ef4444",d=2.5,h=Math.max(1,Math.min(4,o||1));if(e.save(),e.lineWidth=d,e.strokeStyle=c,h>=4&&(e.shadowColor=c,e.shadowBlur=16),e.beginPath(),r===1){let f=a*.5;e.arc(t,i,f,0,Math.PI*2)}else if(r===2){let f=a*.9,g=a*.9;e.moveTo(t,i-f/2),e.lineTo(t-g/2,i+f/2),e.lineTo(t+g/2,i+f/2),e.closePath()}else if(r===3)e.rect(t-l,i-l,a,a);else{let f=a*.5;for(let g=0;g<6;g++){let w=Math.PI/3*g-Math.PI/2,S=t+Math.cos(w)*f,P=i+Math.sin(w)*f;g===0?e.moveTo(S,P):e.lineTo(S,P)}e.closePath()}if(h>=2&&(e.fillStyle=c,e.globalAlpha=h===2?.7:.9,e.fill(),e.globalAlpha=1),e.stroke(),h>=3){e.beginPath();let f=a*.18;e.arc(t,i,f,0,Math.PI*2),e.fillStyle="#0f172a",e.fill()}if(h>=4){e.beginPath();let f=a*.7;e.arc(t,i,f,0,Math.PI*2),e.strokeStyle=c,e.globalAlpha=.4,e.stroke()}e.restore()}drawFrostAuras(e,t){let i=this.tdEngine.getTowersRef();for(let r of i)if(r.type===1&&r.specialActive){let o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=2*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.05)",e.fill(),e.lineWidth=1,e.strokeStyle="rgba(56, 189, 248, 0.1)",e.stroke()}}drawEnemies(e,t){let i=this.tdEngine.getEnemiesRef();for(let r of i){let s=(r.scale??1)*(t*.65),a=s/2,l=r.displayX??(r.position.x+.5)*t,c=r.displayY??(r.position.y+.5)*t;if(e.fillStyle=r.bg||(r.isFrozen?"#7dd3fc":"#ef4444"),e.shadowColor=this.tdEngine.gameSpeedMultiplier()>1?"transparent":e.fillStyle,e.shadowBlur=this.tdEngine.gameSpeedMultiplier()>1?0:10,e.beginPath(),r.type==="tank")e.arc(l,c,a,0,Math.PI*2);else if(r.type==="scout")e.moveTo(l,c-a),e.lineTo(l-a,c+a),e.lineTo(l+a,c+a),e.closePath();else if(r.type==="boss"){for(let h=0;h<6;h++){let f=Math.PI*2*h/6-Math.PI/2,g=l+a*Math.cos(f),w=c+a*Math.sin(f);h===0?e.moveTo(g,w):e.lineTo(g,w)}e.closePath()}else e.rect(l-a,c-a,s,s);e.fill(),e.shadowBlur=0}for(let r of i){let o=(r.isBoss?1.5:1)*(t*.65),s=o/2,a=r.displayX??(r.position.x+.5)*t,l=r.displayY??(r.position.y+.5)*t,c=o,d=6;e.fillStyle="#0f172a",e.fillRect(a-s,l-s-10,c,d),e.fillStyle="#10b981";let h=Math.max(0,Math.min(1,r.hp/r.maxHp));e.fillRect(a-s,l-s-10,c*h,d)}}drawSelection(e,t){let i=this.selectedTile();if(!i)return;let r=i.x*t,o=i.y*t;e.save(),e.lineWidth=3,e.strokeStyle="rgba(56, 189, 248, 0.95)",e.shadowColor="rgba(56, 189, 248, 0.9)",e.shadowBlur=14,e.strokeRect(r+1.5,o+1.5,t-3,t-3),e.restore()}drawProjectiles(e,t){let i=this.tdEngine.getProjectilesRef();e.fillStyle="#fbbf24";for(let r of i){let o=r.from.x+(r.to.x-r.from.x)*r.progress,s=r.from.y+(r.to.y-r.from.y)*r.progress;e.beginPath(),e.arc(o*t+t/2,s*t+t/2,3,0,Math.PI*2),e.fill()}}drawRangeIndicator(e,t){let i=this.selectedTile();if(!i||!i.tower)return;let r=i.tower,o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=r.range*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.12)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56, 189, 248, 0.4)",e.stroke()}onCanvasClick(e){let t=this.gameCanvas?.nativeElement;if(!t)return;let i=t.getBoundingClientRect(),r=e.clientX-i.left,o=e.clientY-i.top,s=this.tdEngine.tileSize,a=Math.floor(r/s),l=Math.floor(o/s),c=this.tdEngine.getGridRef();l>=0&&l<c.length&&a>=0&&a<c[0].length&&this.onTileClick(c[l][a])}static \u0275fac=function(t){return new(t||n)(he(N0),he(Tt),he(Rn),he(Ei),he(ma))};static \u0275cmp=St({type:n,selectors:[["app-tower-defense"]],viewQuery:function(t,i){if(t&1&&Cl(zq,5),t&2){let r;Dl(r=Al())&&(i.gameCanvas=r.first)}},hostBindings:function(t,i){t&1&&te("keydown",function(o){return i.onKeyDown(o)},fa)("keyup",function(o){return i.onKeyUp(o)},fa)},decls:58,vars:70,consts:[["gameCanvas",""],[1,"flex","flex-col","h-full","p-4","overflow-hidden"],[1,"relative"],[1,"hud-overlay"],[1,"flex","items-center","justify-between","mb-4","bg-slate-800","p-3","rounded-lg","border","border-slate-700"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors",3,"click"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"flex","flex-col","items-center","gap-1","font-black","tracking-wide"],[1,"flex","items-baseline","gap-6"],[1,"text-emerald-400","text-lg","font-mono"],[1,"text-rose-400","text-lg","font-mono"],[1,"text-sky-400","text-lg","font-mono"],[1,"flex","items-center","gap-4","text-xs"],[1,"flex","items-center","gap-1"],[1,"text-slate-400","mr-1"],[1,"px-2","py-0.5","rounded","border","text-[10px]","font-bold",3,"click"],[1,"px-3","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"px-3","py-2","bg-amber-600","hover:bg-amber-500","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"bg-rose-600","hover:bg-rose-500","text-white","text-xs","font-bold","px-3","py-2","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-4","py-2","rounded","text-sm","font-black","transition-all",3,"click","disabled"],[1,"flex","items-center","gap-2","px-3","py-2","rounded","bg-white/5","border","border-white/10"],[1,"text-xs","text-slate-300"],[1,"text-xs","font-bold","text-slate-100","capitalize"],[1,"shape-preview",3,"ngClass"],[1,"flex","gap-4","flex-1","min-h-0"],[1,"flex-1","relative","bg-slate-900","rounded-lg","overflow-auto","border","border-slate-700","flex","items-center","justify-center","p-4"],[1,"block","rounded",3,"click"],[1,"w-64","flex","flex-col","gap-4"],[1,"flex-1","bg-slate-800","rounded-lg","border","border-slate-700","p-4","overflow-y-auto"],[1,"h-full","flex","flex-col","items-center","justify-center","text-center","text-slate-500"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-slate-950/70","backdrop-blur-sm","z-[200]"],[1,"text-sm","font-bold","text-slate-400","mb-4","uppercase","tracking-wider"],[1,"flex","flex-col","gap-3"],[1,"shop-btn","flex","justify-between","items-center",3,"disabled","bg-slate-700","hover:bg-slate-600","bg-slate-900"],[1,"shop-btn","flex","justify-between","items-center",3,"click","disabled"],[1,"flex","items-center","gap-2"],[1,"text-xs","bg-slate-600","px-1.5","rounded"],[1,"text-emerald-400","font-mono"],[1,"text-sm","font-bold","text-slate-400","mb-2","uppercase","tracking-wider"],[1,"bg-slate-900","rounded","p-3","mb-4"],[1,"flex","justify-between","mb-1"],[1,"text-xs","text-slate-500"],[1,"text-xs","font-bold"],[1,"text-xs","font-bold","text-rose-400"],[1,"flex","justify-between"],[1,"text-xs","font-bold","text-sky-400"],[1,"flex","flex-col","gap-2"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"disabled"],[1,"w-full","py-3","bg-slate-900","text-slate-500","rounded","text-center","font-bold","border","border-slate-700"],[1,"w-full","py-3","bg-rose-700","hover:bg-rose-600","rounded","font-bold","transition-all","flex","justify-center","items-center","text-sm",3,"click"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"font-mono"],[1,"cursor-pointer","w-full","py-3","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"mt-4","pt-4","border-t","border-white/10","space-y-2"],[1,"text-blue-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-gray-400","text-sm","leading-relaxed"],[1,"text-yellow-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-red-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-purple-400","font-bold","tracking-wide","uppercase","text-sm"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mb-2","opacity-20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"],[1,"text-sm"],[1,"bg-slate-900","border","border-slate-700","rounded-lg","px-8","py-6","text-center","shadow-xl"],[1,"text-2xl","font-black","text-rose-400","mb-2"],[1,"text-slate-300","mb-4"],[1,"bg-emerald-600","hover:bg-emerald-500","text-white","font-bold","px-6","py-2","rounded",3,"click"]],template:function(t,i){if(t&1){let r=Ge();v(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"button",6),te("click",function(){return ne(r),ie(i.goBack())}),y(6),E(),v(7,"button",7),te("click",function(){return ne(r),ie(i.router.navigate(["/tower-defense-leaderboard"]))}),y(8),E()(),v(9,"div",8)(10,"div",9)(11,"div",10),y(12),E(),v(13,"div",11),y(14),E(),v(15,"div",12),y(16),E()(),v(17,"div",13)(18,"div",14)(19,"span",15),y(20,"Speed:"),E(),v(21,"button",16),te("click",function(){return ne(r),ie(i.setSpeed(1))}),y(22," 1x "),E(),v(23,"button",16),te("click",function(){return ne(r),ie(i.setSpeed(2))}),y(24," 2x "),E(),v(25,"button",16),te("click",function(){return ne(r),ie(i.setSpeed(4))}),y(26," 4x "),E()(),v(27,"div",14)(28,"span",15),y(29,"Map Size:"),E(),v(30,"button",16),te("click",function(){return ne(r),ie(i.onMapSizeChange(1))}),y(31," Small (10x10) "),E(),v(32,"button",16),te("click",function(){return ne(r),ie(i.onMapSizeChange(2))}),y(33," Large (20x20) "),E()()()(),v(34,"div",5)(35,"button",17),te("click",function(){return ne(r),ie(i.onLoginClick())}),y(36),E(),v(37,"button",18),te("click",function(){return ne(r),ie(i.router.navigate(["/masteries"]))}),y(38," Masteries "),E(),v(39,"button",19),te("click",function(){return ne(r),ie(i.onRestart())}),y(40),E(),v(41,"button",20),te("click",function(){return ne(r),ie(i.tdEngine.startWave())}),y(42),E(),v(43,"div",21)(44,"span",22),y(45,"Next:"),E(),v(46,"span",23),y(47),E(),W(48,"span",24),E()()()()(),v(49,"div",25)(50,"div",26)(51,"canvas",27,0),te("click",function(s){return ne(r),ie(i.onCanvasClick(s))}),E()(),v(53,"div",28)(54,"div",29),Y(55,rK,2,1)(56,oK,7,2,"div",30),E()()(),Y(57,sK,8,5,"div",31),E()}if(t&2){let r,o;m(6),B(" ",i.settings.t("EXIT_GAME")," "),m(2),B(" ",i.settings.t("RANKING")," "),m(4),Mt("",i.settings.t("MONEY"),": $",i.tdEngine.money()),m(2),Mt("",i.settings.t("LIVES"),": ",i.tdEngine.lives()),m(2),Mt("",i.settings.t("WAVE"),": ",i.tdEngine.wave()),m(5),Me("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===1)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===1)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==1)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==1),m(2),Me("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===2)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===2)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==2)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==2),m(2),Me("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===4)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===4)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==4)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==4),m(5),Me("bg-slate-200",i.mapLevel()===1)("text-slate-900",i.mapLevel()===1)("bg-slate-800",i.mapLevel()!==1)("text-slate-300",i.mapLevel()!==1),m(2),Me("bg-slate-200",i.mapLevel()===2)("text-slate-900",i.mapLevel()===2)("bg-slate-800",i.mapLevel()!==2)("text-slate-300",i.mapLevel()!==2),m(4),B(" ",i.firebase.user$()?((r=i.firebase.user$())==null?null:r.displayName)||"Account":"Login to Save Score"," "),m(4),B(" ",i.settings.t("RESTART_GAME")," "),m(),Me("bg-sky-600",!i.tdEngine.isWaveInProgress())("hover:bg-sky-500",!i.tdEngine.isWaveInProgress())("bg-slate-700",i.tdEngine.isWaveInProgress())("text-slate-500",i.tdEngine.isWaveInProgress()),Ie("disabled",i.tdEngine.isWaveInProgress()),m(),B(" ",i.tdEngine.isWaveInProgress()?i.settings.t("WAVE_IN_PROGRESS"):i.settings.t("START_WAVE")," "),m(5),G(i.tdEngine.nextWaveEnemyType()),m(),et("background",i.tdEngine.nextWaveEnemyType()==="tank"?"hsl(330,70%,60%)":i.tdEngine.nextWaveEnemyType()==="scout"?"hsl(50,90%,60%)":"hsl(200,70%,60%)"),Ie("ngClass",mE(66,Wq,i.tdEngine.nextWaveEnemyType()==="tank",i.tdEngine.nextWaveEnemyType()==="scout",i.tdEngine.nextWaveEnemyType()==="standard")),m(7),Q((o=i.selectedTile())?55:56,o),m(2),Q(i.tdEngine.gameOver()?57:-1)}},dependencies:[Pt,Ku],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"[_nghost-%COMP%]{display:block;height:100vh;background:#0f172a;color:#fff}.td-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,60px);grid-template-rows:repeat(10,60px);gap:2px;background:#1e293b;border:4px solid #334155;border-radius:8px;position:relative}.td-tile[_ngcontent-%COMP%]{position:relative;width:60px;height:60px;transition:all .2s;overflow:hidden}.tile-path[_ngcontent-%COMP%]{background:#475569}.tile-buildable[_ngcontent-%COMP%]{background:#1e293b;cursor:pointer}.tile-buildable[_ngcontent-%COMP%]:hover{background:#334155}.tile-void[_ngcontent-%COMP%]{opacity:.1}.range-indicator[_ngcontent-%COMP%]{position:absolute;background:#38bdf826;border:2px solid rgba(56,189,248,.5);border-radius:50%;pointer-events:none;z-index:50;transform:translate(-50%,-50%);transition:all .2s ease-out}.frost-aura-visual[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:248px;height:248px;transform:translate(-50%,-50%);border-radius:50%;background:#00ffff1a;border:1px solid rgba(0,255,255,.3);pointer-events:none;z-index:5;box-shadow:0 0 15px #0ff3}.enemy[_ngcontent-%COMP%]{position:absolute;width:40px;height:40px;background:#ef4444;border-radius:50%;z-index:10;box-shadow:0 0 10px #ef4444;display:flex;align-items:center;justify-content:center}.enemy-fast[_ngcontent-%COMP%]{box-shadow:none}.projectile[_ngcontent-%COMP%]{position:absolute;width:6px;height:6px;background:#fbbf24;border-radius:50%;z-index:20;box-shadow:0 0 5px #fbbf24}.shop-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.25rem;font-weight:700;transition:all .2s}.shop-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.shape-preview[_ngcontent-%COMP%]{width:18px;height:18px;display:inline-block;background:#fff3}.shape-square[_ngcontent-%COMP%]{border-radius:4px}.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.shape-triangle[_ngcontent-%COMP%]{clip-path:polygon(50% 0%,0% 100%,100% 100%)}.shape-hexagon[_ngcontent-%COMP%]{clip-path:polygon(25% 5%,75% 5%,100% 50%,75% 95%,25% 95%,0% 50%)}"],changeDetection:0})};function aK(n,e){n&1&&(v(0,"div",8)(1,"span",9),W(2,"span",10),v(3,"span"),y(4,"Loading leaderboard..."),E()()())}function lK(n,e){if(n&1&&(v(0,"tr",15)(1,"td",16),y(2),E(),v(3,"td",17),y(4),E(),v(5,"td",18),y(6),E(),v(7,"td",16),y(8),E(),v(9,"td",19),y(10),Rr(11,"date"),Rr(12,"date"),E()()),n&2){let t=e.$implicit,i=e.index;m(2),G(i+1),m(2),B(" ",t.displayName||"Anonymous"," "),m(2),B(" ",t.maxWave," "),m(2),B(" ",t.userTotalXp??0," "),m(2),B(" ",t.timestamp!=null&&t.timestamp.toDate?lo(11,5,t.timestamp.toDate(),"mediumDate"):lo(12,8,t.timestamp,"mediumDate")," ")}}function cK(n,e){n&1&&(v(0,"tr")(1,"td",20),y(2," No runs recorded yet. Finish a game while logged in to appear here. "),E()())}function uK(n,e){if(n&1&&(v(0,"div")(1,"table",11)(2,"thead")(3,"tr",12)(4,"th",13),y(5,"Rank"),E(),v(6,"th",13),y(7,"Name"),E(),v(8,"th",13),y(9,"Wave"),E(),v(10,"th",13),y(11,"Mastery XP"),E(),v(12,"th",13),y(13,"Date"),E()()(),v(14,"tbody"),Qt(15,lK,13,11,"tr",14)(16,cK,3,0,"tr",7),E()()()),n&2){let t=k();m(15),Ie("ngForOf",t.scores()),m(),Ie("ngIf",t.scores().length===0)}}var O0=class n{constructor(e,t){this.firebase=e;this.settings=t}loading=$(!0);scores=$([]);ngOnInit(){this.loadScores()}async loadScores(){this.loading.set(!0);try{let e=await this.firebase.getTopTowerDefenseScores(10);this.scores.set(e??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||n)(he(Rn),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-tower-defense-leaderboard"]],decls:11,vars:3,consts:[[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center","py-10","px-4"],[1,"w-full","max-w-3xl","bg-slate-800","border","border-slate-700","rounded-lg","shadow-xl","p-6"],["routerLink","/tower-defense",1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors"],[1,"flex","items-center","justify-between","mb-4","mt-4"],[1,"text-2xl","font-black","tracking-wide"],[1,"mb-4","text-sm","text-slate-300"],["class","min-h-[80px] flex items-center justify-center",4,"ngIf"],[4,"ngIf"],[1,"min-h-[80px]","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-slate-300"],[1,"w-4","h-4","border-2","border-slate-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-slate-300"],[1,"text-left","py-2","px-2","border-b","border-slate-700"],["class","text-white",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-sky-300"],[1,"py-2","px-2","border-b","border-slate-800"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-emerald-400"],[1,"py-2","px-2","border-b","border-slate-800","text-slate-300"],["colspan","5",1,"py-8","text-center","text-slate-400","italic"]],template:function(t,i){t&1&&(v(0,"div",0)(1,"div",1)(2,"a",2),y(3),E(),v(4,"div",3)(5,"h1",4),y(6,"Tower Defense Leaderboard"),E()(),v(7,"div",5),y(8," Top 10 runs ranked by highest wave reached. "),E(),Qt(9,aK,5,0,"div",6)(10,uK,17,2,"div",7),E()()),t&2&&(m(3),G(i.settings.t("RETURN_TO_MAP")),m(6),Ie("ngIf",i.loading()),m(),Ie("ngIf",!i.loading()))},dependencies:[Pt,cs,ya,kr,va],encapsulation:2})};function dK(n,e){if(n&1&&(v(0,"div",22),W(1,"span",23),v(2,"span",24),y(3),E()()),n&2){let t=k(2);m(3),B(" ",t.settings.t("SAVED")," ")}}function hK(n,e){if(n&1&&(v(0,"div",16)(1,"div",17)(2,"span",18),y(3),E(),v(4,"span",19),y(5),E()(),v(6,"div",17)(7,"span",18),y(8),E(),v(9,"span",20),y(10),E()(),Qt(11,dK,4,1,"div",21),E()),n&2){let t,i=k();m(3),G(i.settings.t("TOTAL_XP")),m(2),G((t=i.profile())==null?null:t.totalXp),m(3),G(i.settings.t("AVAILABLE")),m(2),G(i.availablePoints()),m(),Ie("ngIf",i.isSaved()&&!i.saving())}}function fK(n,e){if(n&1&&(v(0,"div",25),y(1),E()),n&2){let t=k();m(),B(" ",t.settings.t("LOG_IN_MASTERY_MSG")," ")}}function pK(n,e){if(n&1){let t=Ge();v(0,"div",26)(1,"div",27)(2,"span",28),y(3,"\u{1F512}"),E()(),v(4,"p",29),y(5),E(),v(6,"button",30),te("click",function(){ne(t);let r=k();return ie(r.login())}),y(7),E()()}if(n&2){let t=k();m(5),G(t.settings.t("NEED_LOG_IN")),m(2),B(" ",t.settings.t("LOGIN_GOOGLE")," ")}}function gK(n,e){if(n&1&&(v(0,"span",69),y(1),E()),n&2){let t=k().$implicit,i=k(2);m(),Mt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"damage")," XP ")}}function mK(n,e){if(n&1&&(v(0,"span",70),y(1),E()),n&2){let t=k(3);m(),B(" ",t.settings.t("MAXED")," ")}}function yK(n,e){if(n&1&&(v(0,"span",69),y(1),E()),n&2){let t=k().$implicit,i=k(2);m(),Mt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"range")," XP ")}}function vK(n,e){if(n&1&&(v(0,"span",70),y(1),E()),n&2){let t=k(3);m(),B(" ",t.settings.t("MAXED")," ")}}function _K(n,e){if(n&1&&(v(0,"div",71)(1,"div",72),y(2),E()()),n&2){let t=k(3);m(2),B(" \u{1F512} ",t.settings.t("REQUIRES_5_POINTS")," ")}}function EK(n,e){if(n&1&&(v(0,"span",73),y(1),E()),n&2){let t=k().$implicit,i=k(2);m(),Mt(" ",i.settings.t("COST"),": ",i.getNextLevelCost(t.id,"golden")," XP ")}}function bK(n,e){if(n&1&&(v(0,"span",70),y(1),E()),n&2){let t=k(3);m(),B(" ",t.settings.t("MAXED")," ")}}function wK(n,e){if(n&1){let t=Ge();v(0,"div",44)(1,"div",45)(2,"div",46)(3,"div",47),y(4),E(),W(5,"div",48),E(),v(6,"h3",49),y(7),E(),v(8,"div",50)(9,"div",51)(10,"div",52)(11,"div",53),y(12),E(),v(13,"div",54),y(14),E()(),v(15,"div",16)(16,"div",55)(17,"span",56),y(18),E(),Qt(19,gK,2,2,"span",57)(20,mK,2,1,"ng-template",null,2,co),E(),v(22,"button",58),te("click",function(){let r=ne(t).$implicit,o=k(2);return ie(o.increaseBasic(r.id,"damage"))}),y(23," + "),E()()(),v(24,"div",51)(25,"div",52)(26,"div",53),y(27),E(),v(28,"div",54),y(29),E()(),v(30,"div",16)(31,"div",55)(32,"span",56),y(33),E(),Qt(34,yK,2,2,"span",57)(35,vK,2,1,"ng-template",null,3,co),E(),v(37,"button",58),te("click",function(){let r=ne(t).$implicit,o=k(2);return ie(o.increaseBasic(r.id,"range"))}),y(38," + "),E()()()()(),v(39,"div",59)(40,"div",60)(41,"div",52)(42,"div",61),y(43),E(),v(44,"div",62),y(45),E(),Qt(46,_K,3,1,"div",63),E(),v(47,"div",64)(48,"div",65)(49,"span",66),y(50),E(),Qt(51,EK,2,2,"span",67)(52,bK,2,1,"ng-template",null,4,co),E(),v(54,"button",68),te("click",function(){let r=ne(t).$implicit,o=k(2);return ie(o.increaseGolden(r.id))}),y(55," + "),E()()()()()}if(n&2){let t=e.$implicit,i=Xi(21),r=Xi(36),o=Xi(53),s=k(2);m(4),Mt(" ",s.settings.t("TIER")," ",t.id," "),m(),Ie("ngClass",t.color.replace("text","bg")),m(),Ie("ngClass",t.color),m(),B(" ",s.settings.t(t.nameKey)," "),m(5),G(s.settings.t("DAMAGE")),m(2),B("+5% ",s.settings.t("PER_LEVEL")),m(4),B(" ",s.getUpgradeLevel(t.id,"damage")," "),m(),Ie("ngIf",s.getUpgradeLevel(t.id,"damage")<10)("ngIfElse",i),m(3),Me("bg-emerald-500",s.canIncreaseBasic(t.id,"damage"))("border-emerald-400",s.canIncreaseBasic(t.id,"damage"))("text-slate-900",s.canIncreaseBasic(t.id,"damage"))("hover:scale-110",s.canIncreaseBasic(t.id,"damage")),Ie("disabled",!s.canIncreaseBasic(t.id,"damage")),m(5),G(s.settings.t("RANGE")),m(2),B("+0.1 ",s.settings.t("PER_LEVEL")),m(4),B(" ",s.getUpgradeLevel(t.id,"range")," "),m(),Ie("ngIf",s.getUpgradeLevel(t.id,"range")<10)("ngIfElse",r),m(3),Me("bg-emerald-500",s.canIncreaseBasic(t.id,"range"))("border-emerald-400",s.canIncreaseBasic(t.id,"range"))("text-slate-900",s.canIncreaseBasic(t.id,"range"))("hover:scale-110",s.canIncreaseBasic(t.id,"range")),Ie("disabled",!s.canIncreaseBasic(t.id,"range")),m(6),B(" ",s.settings.t(t.goldenTitleKey)," "),m(2),B(" ",s.settings.t(t.goldenDescriptionKey)," "),m(),Ie("ngIf",!s.canUnlockGolden(t.id)),m(4),B(" ",s.getUpgradeLevel(t.id,"golden")," / 1 "),m(),Ie("ngIf",s.getUpgradeLevel(t.id,"golden")<1)("ngIfElse",o),m(3),Me("bg-amber-500",s.canIncreaseGolden(t.id))("border-amber-400",s.canIncreaseGolden(t.id))("text-slate-950",s.canIncreaseGolden(t.id))("hover:scale-110",s.canIncreaseGolden(t.id)),Ie("disabled",!s.canIncreaseGolden(t.id))}}function xK(n,e){n&1&&W(0,"span",42)}function SK(n,e){if(n&1){let t=Ge();v(0,"div",31)(1,"div",16),W(2,"div",32),v(3,"p",33),y(4),E(),W(5,"div",32),E(),v(6,"div",34),Qt(7,wK,56,48,"div",35),E()(),v(8,"div",36)(9,"div",37)(10,"span",38),y(11,"\u2139\uFE0F"),E(),v(12,"p",39),y(13),E()(),v(14,"button",40),te("click",function(){ne(t);let r=k();return ie(r.save())}),v(15,"span",41),Y(16,xK,1,0,"span",42),y(17),E(),W(18,"div",43),E()()}if(n&2){let t=k();m(4),G(t.settings.t("MASTERIES_SUBTITLE")),m(3),Ie("ngForOf",t.tiers),m(6),G(t.settings.t("LOCAL_STORAGE_MSG")),m(),Me("bg-emerald-600",t.profile()&&!t.saving())("text-white",t.profile()&&!t.saving())("shadow-[0_0_30px_rgba(16,185,129,0",t.profile()&&!t.saving())("bg-slate-700",!t.profile()||t.saving()),Ie("disabled",!t.profile()||t.saving()||t.isSaved()),m(2),Q(t.saving()?16:-1),m(),B(" ",t.saving()?t.settings.t("SAVING"):t.settings.t("SAVE_CHANGES")," ")}}var F0=class n{constructor(e,t){this.firebase=e;this.settings=t}static BASIC_COST_MULTIPLIER=5;static GOLDEN_COST=150;tiers=[{id:1,nameKey:"T1_NAME",color:"text-sky-400",goldenTitleKey:"T1_GOLDEN_TITLE",goldenDescriptionKey:"T1_GOLDEN_DESC"},{id:2,nameKey:"T2_NAME",color:"text-purple-400",goldenTitleKey:"T2_GOLDEN_TITLE",goldenDescriptionKey:"T2_GOLDEN_DESC"},{id:3,nameKey:"T3_NAME",color:"text-amber-400",goldenTitleKey:"T3_GOLDEN_TITLE",goldenDescriptionKey:"T3_GOLDEN_DESC"},{id:4,nameKey:"T4_NAME",color:"text-rose-400",goldenTitleKey:"T4_GOLDEN_TITLE",goldenDescriptionKey:"T4_GOLDEN_DESC"}];saving=$(!1);isSaved=$(!1);ngOnInit(){}user(){return this.firebase.user$()}profile(){return this.firebase.masteryProfile()}availablePoints(){let e=this.firebase.masteryProfile();if(!e)return 0;let t=e.totalXp-e.usedPoints;return t>0?t:0}keyFor(e,t){return`t${e}_${t}`}getUpgradeLevel(e,t){let i=this.firebase.masteryProfile();if(!i)return 0;let r=this.keyFor(e,t),o=i.upgrades?.[r];return typeof o=="number"?o:0}getNextLevelCost(e,t){if(t==="golden")return n.GOLDEN_COST;let i=this.getUpgradeLevel(e,t);return i>=10?0:(i+1)*n.BASIC_COST_MULTIPLIER}canIncreaseBasic(e,t){if(this.getUpgradeLevel(e,t)>=10)return!1;let r=this.getNextLevelCost(e,t);return r<=0||!this.profile()||this.availablePoints()<r?!1:!!this.profile()}updateProfile(e){let t=this.firebase.masteryProfile();if(!t)return;let i=e(t);this.firebase.setMasteryProfile(i)}increaseBasic(e,t){if(!this.canIncreaseBasic(e,t))return;let i=this.getNextLevelCost(e,t);i<=0||(this.updateProfile(r=>{let o=this.keyFor(e,t),s=r.upgrades?.[o]??0,a=ce(F({},r.upgrades),{[o]:s+1});return ce(F({},r),{usedPoints:r.usedPoints+i,upgrades:a})}),this.isSaved.set(!1))}canUnlockGolden(e){let t=this.getUpgradeLevel(e,"damage"),i=this.getUpgradeLevel(e,"range");return t+i>=5}canIncreaseGolden(e){if(!this.profile()||!this.canUnlockGolden(e)||this.getUpgradeLevel(e,"golden")>=1)return!1;let i=this.getNextLevelCost(e,"golden");return!(this.availablePoints()<i)}increaseGolden(e){if(!this.canIncreaseGolden(e))return;let t=this.getNextLevelCost(e,"golden");t<=0||(this.updateProfile(i=>{let r=this.keyFor(e,"golden"),o=i.upgrades?.[r]??0,s=ce(F({},i.upgrades),{[r]:o+1});return ce(F({},i),{usedPoints:i.usedPoints+t,upgrades:s})}),this.isSaved.set(!1))}async save(){if(this.profile()){this.saving.set(!0);try{await this.firebase.saveTowerDefenseMasteries()}catch{}finally{this.saving.set(!1),this.isSaved.set(!0)}}}login(){this.firebase.loginWithGoogle()}static \u0275fac=function(t){return new(t||n)(he(Rn),he(Tt))};static \u0275cmp=St({type:n,selectors:[["app-masteries"]],decls:18,vars:6,consts:[["noProfile",""],["loggedInBlock",""],["dmgMaxed",""],["rangeMaxed",""],["goldenMaxed",""],[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center"],[1,"min-h-screen","bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))]","from-slate-800","via-slate-900","to-black","text-white","flex","flex-col","items-center","py-4","px-4","selection:bg-sky-500/30"],[1,"w-full","max-w-6xl","bg-slate-800/50","backdrop-blur-md","border","border-slate-700/50","rounded-2xl","shadow-2xl","overflow-hidden"],[1,"p-6","border-b","border-slate-700/50","bg-slate-900/40","flex","flex-col","md:flex-row","items-center","justify-between","gap-6"],[1,"flex","items-center","gap-4"],["routerLink","/tower-defense",1,"group","flex","items-center","gap-2","px-5","py-2.5","bg-slate-700/50","hover:bg-slate-600","rounded-xl","text-sm","font-bold","transition-all","border","border-slate-600/50","hover:border-sky-500/50","shadow-lg"],[1,"group-hover:-translate-x-1","transition-transform"],[1,"text-3xl","font-black","tracking-tighter","uppercase","italic","text-transparent","bg-clip-text","bg-gradient-to-r","from-white","to-slate-400"],["class","flex items-center gap-3",4,"ngIf","ngIfElse"],[1,"p-8"],["class","flex flex-col items-center justify-center py-20 text-center",4,"ngIf","ngIfElse"],[1,"flex","items-center","gap-3"],[1,"flex","flex-col","items-end","px-4","py-2","bg-black/30","rounded-xl","border","border-slate-700/50"],[1,"text-[10px]","uppercase","font-bold","text-slate-500"],[1,"font-mono","text-lg","text-emerald-400","leading-none"],[1,"font-mono","text-lg","text-sky-400","leading-none"],["class","flex items-center gap-2 px-3 py-1 bg-emerald-500/10 rounded-xl border border-emerald-500/30",4,"ngIf"],[1,"flex","items-center","gap-2","px-3","py-1","bg-emerald-500/10","rounded-xl","border","border-emerald-500/30"],[1,"w-2","h-2","rounded-full","bg-emerald-400","animate-pulse"],[1,"text-[10px]","font-bold","uppercase","tracking-wide","text-emerald-300"],[1,"px-6","py-2","bg-rose-500/10","border","border-rose-500/20","rounded-xl","text-rose-400","text-xs","animate-pulse"],[1,"flex","flex-col","items-center","justify-center","py-20","text-center"],[1,"w-20","h-20","bg-slate-700/30","rounded-full","flex","items-center","justify-center","mb-6","border","border-slate-600"],[1,"text-4xl"],[1,"text-slate-400","max-w-md","mb-8","leading-relaxed"],[1,"px-8","py-4","bg-sky-600","hover:bg-sky-500","hover:scale-105","active:scale-95","rounded-2xl","text-base","font-black","transition-all","shadow-[0_0_20px_rgba(14,165,233,0.4)]",3,"click"],[1,"space-y-8"],[1,"h-px","flex-1","bg-gradient-to-r","from-transparent","via-slate-600","to-transparent"],[1,"text-sm","font-medium","text-slate-400","tracking-wide"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-6"],["class","group relative bg-slate-900/40 rounded-3xl border border-slate-700/50 p-1 transition-all hover:border-slate-500/50 hover:bg-slate-900/60 shadow-xl",4,"ngFor","ngForOf"],[1,"flex","flex-col","md:flex-row","items-center","justify-between","mt-12","pt-8","border-t","border-slate-700/50","gap-6"],[1,"flex","items-center","gap-3","text-slate-500"],[1,"text-xl"],[1,"text-xs","italic"],[1,"group","relative","px-10","py-4","rounded-2xl","font-black","uppercase","tracking-widest","transition-all","overflow-hidden","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"relative","z-10","flex","items-center","gap-2"],[1,"w-4","h-4","border-2","border-white/30","border-t-white","rounded-full","animate-spin"],[1,"absolute","inset-0","bg-white/10","translate-y-full","group-hover:translate-y-0","transition-transform"],[1,"group","relative","bg-slate-900/40","rounded-3xl","border","border-slate-700/50","p-1","transition-all","hover:border-slate-500/50","hover:bg-slate-900/60","shadow-xl"],[1,"p-5"],[1,"flex","items-center","justify-between","mb-6"],[1,"px-3","py-1","bg-black/40","rounded-lg","text-[10px]","font-black","uppercase","tracking-widest","text-slate-400","border","border-slate-700/50"],[1,"w-2","h-2","rounded-full","blur-[2px]","animate-pulse",3,"ngClass"],[1,"text-lg","font-black","mb-6","tracking-tight",3,"ngClass"],[1,"space-y-6"],[1,"flex","items-center","justify-between","group/item"],[1,"flex-1"],[1,"text-xs","font-bold","text-white","mb-0.5"],[1,"text-[10px]","text-slate-500"],[1,"flex","flex-col","items-end","gap-1"],[1,"font-mono","text-xs","text-emerald-400","bg-emerald-500/10","px-2","py-1","rounded","border","border-emerald-500/20"],["class","text-[10px] text-slate-400",4,"ngIf","ngIfElse"],[1,"w-8","h-8","rounded-xl","flex","items-center","justify-center","text-xl","font-bold","transition-all","border","shadow-lg","disabled:opacity-20","disabled:grayscale",3,"click","disabled"],[1,"mt-2","p-5","bg-gradient-to-b","from-amber-500/5","to-amber-500/10","rounded-b-[22px]","border-t","border-amber-500/20"],[1,"flex","items-start","justify-between","gap-4"],[1,"text-xs","font-black","uppercase","tracking-wider","text-amber-400","mb-1"],[1,"text-[11px]","text-slate-300","leading-relaxed","italic"],["class","mt-3 inline-block px-2 py-1 rounded bg-black/40 border border-amber-500/20",4,"ngIf"],[1,"flex","flex-col","items-center","gap-2"],[1,"flex","flex-col","items-center","gap-1"],[1,"font-mono","text-xs","text-amber-400"],["class","text-[10px] text-amber-200",4,"ngIf","ngIfElse"],[1,"w-10","h-10","rounded-2xl","flex","items-center","justify-center","text-2xl","font-black","transition-all","border-2","shadow-[0_0_15px_rgba(245,158,11,0.3)]","disabled:opacity-20","disabled:grayscale","disabled:shadow-none",3,"click","disabled"],[1,"text-[10px]","text-slate-400"],[1,"text-[10px]","text-amber-400","font-bold","uppercase"],[1,"mt-3","inline-block","px-2","py-1","rounded","bg-black/40","border","border-amber-500/20"],[1,"text-[9px]","text-amber-500/80","uppercase","font-bold"],[1,"text-[10px]","text-amber-200"]],template:function(t,i){if(t&1&&(v(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"a",10)(6,"span",11),y(7,"\u2190"),E(),y(8),E(),v(9,"h1",12),y(10),E()(),Qt(11,hK,12,5,"div",13)(12,fK,2,1,"ng-template",null,0,co),E(),v(14,"div",14),Qt(15,pK,8,2,"div",15)(16,SK,19,14,"ng-template",null,1,co),E()()()()),t&2){let r=Xi(13),o=Xi(17);m(8),B(" ",i.settings.t("BACK_TO_DEFENSE")," "),m(2),B(" ",i.settings.t("MASTERIES")," "),m(),Ie("ngIf",i.profile())("ngIfElse",r),m(4),Ie("ngIf",!i.user())("ngIfElse",o)}},dependencies:[Pt,Ku,cs,ya,kr],encapsulation:2})};var jO=[{path:"",component:P0},{path:"shape-tactics",component:_0},{path:"tower-defense",component:k0},{path:"tower-defense-leaderboard",component:O0},{path:"masteries",component:F0},{path:"feedback",component:M0},{path:"roadmap",component:R0}];var HO={providers:[kv(),Sb(jO),ZM(JM())]};var L0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=St({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,i){t&1&&(v(0,"h1",0),y(1,"Turn-Based Strategy"),E(),W(2,"router-outlet"))},dependencies:[pd],encapsulation:2})};QE(L0,HO).catch(n=>console.error(n));
