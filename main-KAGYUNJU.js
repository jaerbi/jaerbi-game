var KO=Object.defineProperty,YO=Object.defineProperties;var QO=Object.getOwnPropertyDescriptors;var wh=Object.getOwnPropertySymbols;var TS=Object.prototype.hasOwnProperty,CS=Object.prototype.propertyIsEnumerable;var IS=(n,e,t)=>e in n?KO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||={})TS.call(e,t)&&IS(n,t,e[t]);if(wh)for(var t of wh(e))CS.call(e,t)&&IS(n,t,e[t]);return n},fe=(n,e)=>YO(n,QO(e));var $a=(n,e)=>{var t={};for(var i in n)TS.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&wh)for(var i of wh(n))e.indexOf(i)<0&&CS.call(n,i)&&(t[i]=n[i]);return t};var Fn=null,xh=!1,Q0=1,JO=null,Yn=Symbol("SIGNAL");function Ve(n){let e=Fn;return Fn=n,e}function Ih(){return Fn}var Fc={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Lc(n){if(xh)throw new Error("");if(Fn===null)return;Fn.consumerOnSignalRead(n);let e=Fn.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Fn.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Fn.producers,t!==void 0&&t.producer===n)){Fn.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Fn&&(!i||XO(r,Fn)))return;let o=Ga(Fn),s={producer:n,consumer:Fn,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Fn.producersTail=s,e!==void 0?e.nextProducer=s:Fn.producers=s,o&&RS(n,s)}function DS(){Q0++}function J0(n){if(!(Ga(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Q0)){if(!n.producerMustRecompute(n)&&!Ch(n)){Y0(n);return}n.producerRecomputeValue(n),Y0(n)}}function Z0(n){if(n.consumers===void 0)return;let e=xh;xh=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||ZO(i)}}finally{xh=e}}function X0(){return Fn?.consumerAllowSignalWrites!==!1}function ZO(n){n.dirty=!0,Z0(n),n.consumerMarkedDirty?.(n)}function Y0(n){n.dirty=!1,n.lastCleanEpoch=Q0}function Vc(n){return n&&AS(n),Ve(n)}function AS(n){n.producersTail=void 0,n.recomputing=!0}function Th(n,e){Ve(e),n&&MS(n)}function MS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Ga(n))do t=ey(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Ch(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(J0(t),i!==t.version))return!0}return!1}function Uc(n){if(Ga(n)){let e=n.producers;for(;e!==void 0;)e=ey(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function RS(n,e){let t=n.consumersTail,i=Ga(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)RS(r.producer,r)}function ey(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Ga(e)){let o=e.producers;for(;o!==void 0;)o=ey(o)}return t}function Ga(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function ty(n){JO?.(n)}function XO(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function ny(n,e){return Object.is(n,e)}function Dh(n,e){let t=Object.create(e4);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(J0(t),Lc(t),t.value===Sh)throw t.error;return t.value};return i[Yn]=t,ty(t),i}var q0=Symbol("UNSET"),K0=Symbol("COMPUTING"),Sh=Symbol("ERRORED"),e4=fe(F({},Fc),{value:q0,dirty:!0,error:null,equal:ny,kind:"computed",producerMustRecompute(n){return n.value===q0||n.value===K0},producerRecomputeValue(n){if(n.value===K0)throw new Error("");let e=n.value;n.value=K0;let t=Vc(n),i,r=!1;try{i=n.computation(),Ve(null),r=e!==q0&&e!==Sh&&i!==Sh&&n.equal(e,i)}catch(o){i=Sh,n.error=o}finally{Th(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function t4(){throw new Error}var NS=t4;function PS(n){NS(n)}function iy(n){NS=n}var n4=null;function ry(n,e){let t=Object.create(Ah);t.value=n,e!==void 0&&(t.equal=e);let i=()=>kS(t);return i[Yn]=t,ty(t),[i,s=>Bc(t,s),s=>OS(t,s)]}function kS(n){return Lc(n),n.value}function Bc(n,e){X0()||PS(n),n.equal(n.value,e)||(n.value=e,i4(n))}function OS(n,e){X0()||PS(n),Bc(n,e(n.value))}var Ah=fe(F({},Fc),{equal:ny,value:void 0,kind:"signal"});function i4(n){n.version++,DS(),Z0(n),n4?.(n)}function oy(n){let e=Ve(null);try{return n()}finally{Ve(e)}}function Ke(n){return typeof n=="function"}function za(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Mh=za(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ns(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var gn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ke(i))try{i()}catch(o){e=o instanceof Mh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{FS(o)}catch(s){e=e??[],s instanceof Mh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Mh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)FS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ns(t,e)}remove(e){let{_finalizers:t}=this;t&&Ns(t,e),e instanceof n&&e._removeParent(this)}};gn.EMPTY=(()=>{let n=new gn;return n.closed=!0,n})();var sy=gn.EMPTY;function Rh(n){return n instanceof gn||n&&"closed"in n&&Ke(n.remove)&&Ke(n.add)&&Ke(n.unsubscribe)}function FS(n){Ke(n)?n():n.unsubscribe()}var ji={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Wa={setTimeout(n,e,...t){let{delegate:i}=Wa;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Wa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Nh(n){Wa.setTimeout(()=>{let{onUnhandledError:e}=ji;if(e)e(n);else throw n})}function jc(){}var LS=ay("C",void 0,void 0);function VS(n){return ay("E",void 0,n)}function US(n){return ay("N",n,void 0)}function ay(n,e,t){return{kind:n,value:e,error:t}}var Ps=null;function qa(n){if(ji.useDeprecatedSynchronousErrorHandling){let e=!Ps;if(e&&(Ps={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Ps;if(Ps=null,t)throw i}}else n()}function BS(n){ji.useDeprecatedSynchronousErrorHandling&&Ps&&(Ps.errorThrown=!0,Ps.error=n)}var ks=class extends gn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Rh(e)&&e.add(this)):this.destination=s4}static create(e,t,i){return new Ka(e,t,i)}next(e){this.isStopped?cy(US(e),this):this._next(e)}error(e){this.isStopped?cy(VS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?cy(LS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},r4=Function.prototype.bind;function ly(n,e){return r4.call(n,e)}var uy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Ph(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Ph(i)}else Ph(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ph(t)}}},Ka=class extends ks{constructor(e,t,i){super();let r;if(Ke(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&ji.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&ly(e.next,o),error:e.error&&ly(e.error,o),complete:e.complete&&ly(e.complete,o)}):r=e}this.destination=new uy(r)}};function Ph(n){ji.useDeprecatedSynchronousErrorHandling?BS(n):Nh(n)}function o4(n){throw n}function cy(n,e){let{onStoppedNotification:t}=ji;t&&Wa.setTimeout(()=>t(n,e))}var s4={closed:!0,next:jc,error:o4,complete:jc};var Ya=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Hi(n){return n}function dy(...n){return hy(n)}function hy(n){return n.length===0?Hi:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var st=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=l4(t)?t:new Ka(t,i,r);return qa(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=jS(i),new i((r,o)=>{let s=new Ka({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Ya](){return this}pipe(...t){return hy(t)(this)}toPromise(t){return t=jS(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function jS(n){var e;return(e=n??ji.Promise)!==null&&e!==void 0?e:Promise}function a4(n){return n&&Ke(n.next)&&Ke(n.error)&&Ke(n.complete)}function l4(n){return n&&n instanceof ks||a4(n)&&Rh(n)}function c4(n){return Ke(n?.lift)}function ft(n){return e=>{if(c4(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function pt(n,e,t,i,r){return new fy(n,e,t,i,r)}var fy=class extends ks{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var HS=za(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Bt=(()=>{class n extends st{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new kh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new HS}next(t){qa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){qa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){qa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?sy:(this.currentObservers=null,o.push(t),new gn(()=>{this.currentObservers=null,Ns(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new st;return t.source=this,t}}return n.create=(e,t)=>new kh(e,t),n})(),kh=class extends Bt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:sy}};var Mn=class extends Bt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var py={now(){return(py.delegate||Date).now()},delegate:void 0};var Oh=class extends gn{constructor(e,t){super()}schedule(e,t=0){return this}};var Hc={setInterval(n,e,...t){let{delegate:i}=Hc;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Hc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Fh=class extends Oh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return Hc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Hc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ns(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Qa=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};Qa.now=py.now;var Lh=class extends Qa{constructor(e,t=Qa.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var $S=new Lh(Fh);var Rn=new st(n=>n.complete());function GS(n){return n&&Ke(n.schedule)}function zS(n){return n[n.length-1]}function Vh(n){return Ke(zS(n))?n.pop():void 0}function Vo(n){return GS(zS(n))?n.pop():void 0}function qS(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(h){s(h)}}function l(d){try{c(i.throw(d))}catch(h){s(h)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function WS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Os(n){return this instanceof Os?(this.v=n,this):new Os(n)}function KS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(g){return function(S){return Promise.resolve(S).then(g,h)}}function a(g,S){i[g]&&(r[g]=function(I){return new Promise(function(P,U){o.push([g,I,P,U])>1||l(g,I)})},S&&(r[g]=S(r[g])))}function l(g,S){try{c(i[g](S))}catch(I){p(o[0][3],I)}}function c(g){g.value instanceof Os?Promise.resolve(g.value.v).then(d,h):p(o[0][2],g)}function d(g){l("next",g)}function h(g){l("throw",g)}function p(g,S){g(S),o.shift(),o.length&&l(o[0][0],o[0][1])}}function YS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof WS=="function"?WS(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var Uh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Bh(n){return Ke(n?.then)}function jh(n){return Ke(n[Ya])}function Hh(n){return Symbol.asyncIterator&&Ke(n?.[Symbol.asyncIterator])}function $h(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function u4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Gh=u4();function zh(n){return Ke(n?.[Gh])}function Wh(n){return KS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Os(t.read());if(r)return yield Os(void 0);yield yield Os(i)}}finally{t.releaseLock()}})}function qh(n){return Ke(n?.getReader)}function sn(n){if(n instanceof st)return n;if(n!=null){if(jh(n))return d4(n);if(Uh(n))return h4(n);if(Bh(n))return f4(n);if(Hh(n))return QS(n);if(zh(n))return p4(n);if(qh(n))return g4(n)}throw $h(n)}function d4(n){return new st(e=>{let t=n[Ya]();if(Ke(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function h4(n){return new st(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function f4(n){return new st(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Nh)})}function p4(n){return new st(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function QS(n){return new st(e=>{m4(n,e).catch(t=>e.error(t))})}function g4(n){return QS(Wh(n))}function m4(n,e){var t,i,r,o;return qS(this,void 0,void 0,function*(){try{for(t=YS(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function Qn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Kh(n,e=0){return ft((t,i)=>{t.subscribe(pt(i,r=>Qn(i,n,()=>i.next(r),e),()=>Qn(i,n,()=>i.complete(),e),r=>Qn(i,n,()=>i.error(r),e)))})}function Yh(n,e=0){return ft((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function JS(n,e){return sn(n).pipe(Yh(e),Kh(e))}function ZS(n,e){return sn(n).pipe(Yh(e),Kh(e))}function XS(n,e){return new st(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function eI(n,e){return new st(t=>{let i;return Qn(t,e,()=>{i=n[Gh](),Qn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Ke(i?.return)&&i.return()})}function Qh(n,e){if(!n)throw new Error("Iterable cannot be null");return new st(t=>{Qn(t,e,()=>{let i=n[Symbol.asyncIterator]();Qn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function tI(n,e){return Qh(Wh(n),e)}function nI(n,e){if(n!=null){if(jh(n))return JS(n,e);if(Uh(n))return XS(n,e);if(Bh(n))return ZS(n,e);if(Hh(n))return Qh(n,e);if(zh(n))return eI(n,e);if(qh(n))return tI(n,e)}throw $h(n)}function an(n,e){return e?nI(n,e):sn(n)}function it(...n){let e=Vo(n);return an(n,e)}function gy(n,e){let t=Ke(n)?n:()=>n,i=r=>r.error(t());return new st(e?r=>e.schedule(i,0,r):i)}function Jh(n){return!!n&&(n instanceof st||Ke(n.lift)&&Ke(n.subscribe))}var Fs=za(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function vt(n,e){return ft((t,i)=>{let r=0;t.subscribe(pt(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:y4}=Array;function v4(n,e){return y4(e)?n(...e):n(e)}function Zh(n){return vt(e=>v4(n,e))}var{isArray:_4}=Array,{getPrototypeOf:E4,prototype:b4,keys:w4}=Object;function Xh(n){if(n.length===1){let e=n[0];if(_4(e))return{args:e,keys:null};if(x4(e)){let t=w4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function x4(n){return n&&typeof n=="object"&&E4(n)===b4}function ef(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function $c(...n){let e=Vo(n),t=Vh(n),{args:i,keys:r}=Xh(n);if(i.length===0)return an([],e);let o=new st(S4(i,e,r?s=>ef(r,s):Hi));return t?o.pipe(Zh(t)):o}function S4(n,e,t=Hi){return i=>{iI(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let l=0;l<r;l++)iI(e,()=>{let c=an(n[l],e),d=!1;c.subscribe(pt(i,h=>{o[l]=h,d||(d=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function iI(n,e,t){n?Qn(t,n,e):e()}function rI(n,e,t,i,r,o,s,a){let l=[],c=0,d=0,h=!1,p=()=>{h&&!l.length&&!c&&e.complete()},g=I=>c<i?S(I):l.push(I),S=I=>{o&&e.next(I),c++;let P=!1;sn(t(I,d++)).subscribe(pt(e,U=>{r?.(U),o?g(U):e.next(U)},()=>{P=!0},void 0,()=>{if(P)try{for(c--;l.length&&c<i;){let U=l.shift();s?Qn(e,s,()=>S(U)):S(U)}p()}catch(U){e.error(U)}}))};return n.subscribe(pt(e,g,()=>{h=!0,p()})),()=>{a?.()}}function $n(n,e,t=1/0){return Ke(e)?$n((i,r)=>vt((o,s)=>e(i,o,r,s))(sn(n(i,r))),t):(typeof e=="number"&&(t=e),ft((i,r)=>rI(i,r,n,t)))}function oI(n=1/0){return $n(Hi,n)}function sI(){return oI(1)}function Uo(...n){return sI()(an(n,Vo(n)))}function Gc(n){return new st(e=>{sn(n()).subscribe(e)})}function my(...n){let e=Vh(n),{args:t,keys:i}=Xh(n),r=new st(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let d=0;d<s;d++){let h=!1;sn(t[d]).subscribe(pt(o,p=>{h||(h=!0,c--),a[d]=p},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?ef(i,a):a),o.complete())}))}});return e?r.pipe(Zh(e)):r}function $i(n,e){return ft((t,i)=>{let r=0;t.subscribe(pt(i,o=>n.call(e,o,r++)&&i.next(o)))})}function zc(n){return ft((e,t)=>{let i=null,r=!1,o;i=e.subscribe(pt(t,void 0,void 0,s=>{o=sn(n(s,zc(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function tf(n,e){return Ke(e)?$n(n,e,1):$n(n,1)}function yy(n,e=$S){return ft((t,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let c=o;o=null,i.next(c)}};function l(){let c=s+n,d=e.now();if(d<c){r=this.schedule(void 0,c-d),i.add(r);return}a()}t.subscribe(pt(i,c=>{o=c,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function aI(n){return ft((e,t)=>{let i=!1;e.subscribe(pt(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Gi(n){return n<=0?()=>Rn:ft((e,t)=>{let i=0;e.subscribe(pt(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function lI(n=I4){return ft((e,t)=>{let i=!1;e.subscribe(pt(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function I4(){return new Fs}function vy(n){return ft((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function qr(n,e){let t=arguments.length>=2;return i=>i.pipe(n?$i((r,o)=>n(r,o,i)):Hi,Gi(1),t?aI(e):lI(()=>new Fs))}function nf(n){return n<=0?()=>Rn:ft((e,t)=>{let i=[];e.subscribe(pt(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function _y(n){return $i((e,t)=>n<=t)}function Wc(...n){let e=Vo(n);return ft((t,i)=>{(e?Uo(n,t,e):Uo(n,t)).subscribe(i)})}function Kr(n,e){return ft((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(pt(i,l=>{r?.unsubscribe();let c=0,d=o++;sn(n(l,d)).subscribe(r=pt(i,h=>i.next(e?e(l,h,d,c++):h),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Ls(n){return ft((e,t)=>{sn(n).subscribe(pt(t,()=>t.complete(),jc)),!t.closed&&e.subscribe(t)})}function dr(n,e,t){let i=Ke(n)||e||t?{next:n,error:e,complete:t}:n;return i?ft((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(pt(o,l=>{var c;(c=i.next)===null||c===void 0||c.call(i,l),o.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),o.complete()},l=>{var c;a=!1,(c=i.error)===null||c===void 0||c.call(i,l),o.error(l)},()=>{var l,c;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(c=i.finalize)===null||c===void 0||c.call(i)}))}):Hi}var Ey;function rf(){return Ey}function hr(n){let e=Ey;return Ey=n,e}var cI=Symbol("NotFound");function Ja(n){return n===cI||n?.name==="\u0275NotFound"}var cf="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",pe=class extends Error{code;constructor(e,t){super(Jr(e,t)),this.code=e}};function D4(n){return`NG0${Math.abs(n)}`}function Jr(n,e){return`${D4(n)}${e?": "+e:""}`}var pr=globalThis;function _t(n){for(let e in n)if(n[e]===_t)return e;throw Error("")}function pI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Qr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Qr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function uf(n,e){return n?e?`${n} ${e}`:n:e||""}var A4=_t({__forward_ref__:_t});function $o(n){return n.__forward_ref__=$o,n.toString=function(){return Qr(this())},n}function Nn(n){return Oy(n)?n():n}function Oy(n){return typeof n=="function"&&n.hasOwnProperty(A4)&&n.__forward_ref__===$o}function le(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function gr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Zc(n){return M4(n,df)}function Fy(n){return Zc(n)!==null}function M4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function R4(n){let e=n?.[df]??null;return e||null}function wy(n){return n&&n.hasOwnProperty(sf)?n[sf]:null}var df=_t({\u0275prov:_t}),sf=_t({\u0275inj:_t}),_e=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=le({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Ly(n){return n&&!!n.\u0275providers}var Vy=_t({\u0275cmp:_t}),Uy=_t({\u0275dir:_t}),By=_t({\u0275pipe:_t}),jy=_t({\u0275mod:_t}),Kc=_t({\u0275fac:_t}),Hs=_t({__NG_ELEMENT_ID__:_t}),uI=_t({__NG_ENV_ID__:_t});function Hy(n){return ff(n,"@NgModule"),n[jy]||null}function Zr(n){return ff(n,"@Component"),n[Vy]||null}function hf(n){return ff(n,"@Directive"),n[Uy]||null}function $y(n){return ff(n,"@Pipe"),n[By]||null}function ff(n,e){if(n==null)throw new pe(-919,!1)}function zi(n){return typeof n=="string"?n:n==null?"":String(n)}function gI(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():zi(n)}var mI=_t({ngErrorCode:_t}),N4=_t({ngErrorMessage:_t}),P4=_t({ngTokenPath:_t});function Gy(n,e){return yI("",-200,e)}function pf(n,e){throw new pe(-201,!1)}function yI(n,e,t){let i=new pe(e,n);return i[mI]=e,i[N4]=n,t&&(i[P4]=t),i}function k4(n){return n[mI]}var xy;function vI(){return xy}function Gn(n){let e=xy;return xy=n,e}function zy(n,e,t){let i=Zc(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;pf(n,"")}var O4={},Vs=O4,F4="__NG_DI_FLAG__",Sy=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Us(t)||0;try{return this.injector.get(e,i&8?null:Vs,i)}catch(r){if(Ja(r))return r;throw r}}};function L4(n,e=0){let t=rf();if(t===void 0)throw new pe(-203,!1);if(t===null)return zy(n,void 0,e);{let i=V4(e),r=t.retrieve(n,i);if(Ja(r)){if(i.optional)return null;throw r}return r}}function De(n,e=0){return(vI()||L4)(Nn(n),e)}function z(n,e){return De(n,Us(e))}function Us(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function V4(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Iy(n){let e=[];for(let t=0;t<n.length;t++){let i=Nn(n[t]);if(Array.isArray(i)){if(i.length===0)throw new pe(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],l=U4(a);typeof l=="number"?l===-1?r=a.token:o|=l:r=a}e.push(De(r,o))}else e.push(De(i))}return e}function U4(n){return n[F4]}function Bo(n,e){let t=n.hasOwnProperty(Kc);return t?n[Kc]:null}function _I(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function EI(n){return n.flat(Number.POSITIVE_INFINITY)}function gf(n,e){n.forEach(t=>Array.isArray(t)?gf(t,e):e(t))}function Wy(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Xc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function bI(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function mf(n,e,t){let i=Xa(n,e);return i>=0?n[i|1]=t:(i=~i,bI(n,i,e,t)),i}function yf(n,e){let t=Xa(n,e);if(t>=0)return n[t|1]}function Xa(n,e){return B4(n,e,1)}function B4(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var Go={},zn=[],mr=new _e(""),qy=new _e("",-1),Ky=new _e(""),Yc=class{get(e,t=Vs){if(t===Vs){let r=yI("",-201);throw r.name="\u0275NotFound",r}return t}};function yr(n){return{\u0275providers:n}}function wI(n){return yr([{provide:mr,multi:!0,useValue:n}])}function xI(...n){return{\u0275providers:vf(!0,n),\u0275fromNgModule:!0}}function vf(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return gf(e,s=>{let a=s;af(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&SI(r,o),t}function SI(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];Yy(r,o=>{e(o,i)})}}function af(n,e,t,i){if(n=Nn(n),!n)return!1;let r=null,o=wy(n),s=!o&&Zr(n);if(!o&&!s){let l=n.ngModule;if(o=wy(l),o)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)af(c,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let c;gf(o.imports,d=>{af(d,e,t,i)&&(c||=[],c.push(d))}),c!==void 0&&SI(c,e)}if(!a){let c=Bo(r)||(()=>new r);e({provide:r,useFactory:c,deps:zn},r),e({provide:Ky,useValue:r,multi:!0},r),e({provide:mr,useValue:()=>De(r),multi:!0},r)}let l=o.providers;if(l!=null&&!a){let c=n;Yy(l,d=>{e(d,c)})}}else return!1;return r!==n&&n.providers!==void 0}function Yy(n,e){for(let t of n)Ly(t)&&(t=t.\u0275providers),Array.isArray(t)?Yy(t,e):e(t)}var j4=_t({provide:String,useValue:_t});function II(n){return n!==null&&typeof n=="object"&&j4 in n}function H4(n){return!!(n&&n.useExisting)}function $4(n){return!!(n&&n.useFactory)}function Bs(n){return typeof n=="function"}function TI(n){return!!n.useClass}var eu=new _e(""),of={},dI={},by;function tu(){return by===void 0&&(by=new Yc),by}var qt=class{},js=class extends qt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,Cy(e,s=>this.processProvider(s)),this.records.set(qy,Za(void 0,this)),r.has("environment")&&this.records.set(qt,Za(void 0,this));let o=this.records.get(eu);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Ky,zn,{self:!0}))}retrieve(e,t){let i=Us(t)||0;try{return this.get(e,Vs,i)}catch(r){if(Ja(r))return r;throw r}}destroy(){qc(this),this._destroyed=!0;let e=Ve(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ve(e)}}onDestroy(e){return qc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){qc(this);let t=hr(this),i=Gn(void 0),r;try{return e()}finally{hr(t),Gn(i)}}get(e,t=Vs,i){if(qc(this),e.hasOwnProperty(uI))return e[uI](this);let r=Us(i),o,s=hr(this),a=Gn(void 0);try{if(!(r&4)){let c=this.records.get(e);if(c===void 0){let d=K4(e)&&Zc(e);d&&this.injectableDefInScope(d)?c=Za(Ty(e),of):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let l=r&2?tu():this.parent;return t=r&8&&t===Vs?null:t,l.get(e,t)}catch(l){let c=k4(l);throw c===-200||c===-201?new pe(c,null):l}finally{Gn(a),hr(s)}}resolveInjectorInitializers(){let e=Ve(null),t=hr(this),i=Gn(void 0),r;try{let o=this.get(mr,zn,{self:!0});for(let s of o)s()}finally{hr(t),Gn(i),Ve(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Qr(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Nn(e);let t=Bs(e)?e:Nn(e&&e.provide),i=z4(e);if(!Bs(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Za(void 0,of,!0),r.factory=()=>Iy(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Ve(null);try{if(t.value===dI)throw Gy(Qr(e));return t.value===of&&(t.value=dI,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&q4(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ve(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Nn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Ty(n){let e=Zc(n),t=e!==null?e.factory:Bo(n);if(t!==null)return t;if(n instanceof _e)throw new pe(204,!1);if(n instanceof Function)return G4(n);throw new pe(204,!1)}function G4(n){if(n.length>0)throw new pe(204,!1);let t=R4(n);return t!==null?()=>t.factory(n):()=>new n}function z4(n){if(II(n))return Za(void 0,n.useValue);{let e=Qy(n);return Za(e,of)}}function Qy(n,e,t){let i;if(Bs(n)){let r=Nn(n);return Bo(r)||Ty(r)}else if(II(n))i=()=>Nn(n.useValue);else if($4(n))i=()=>n.useFactory(...Iy(n.deps||[]));else if(H4(n))i=(r,o)=>De(Nn(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Nn(n&&(n.useClass||n.provide));if(W4(n))i=()=>new r(...Iy(n.deps));else return Bo(r)||Ty(r)}return i}function qc(n){if(n.destroyed)throw new pe(205,!1)}function Za(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function W4(n){return!!n.deps}function q4(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function K4(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Cy(n,e){for(let t of n)Array.isArray(t)?Cy(t,e):t&&Ly(t)?Cy(t.\u0275providers,e):e(t)}function Pn(n,e){let t;n instanceof js?(qc(n),t=n):t=new Sy(n);let i,r=hr(t),o=Gn(void 0);try{return e()}finally{hr(r),Gn(o)}}function CI(){return vI()!==void 0||rf()!=null}var qn=0,Ce=1,He=2,Zt=3,Ii=4,Ti=5,Jn=6,el=7,Xt=8,ai=9,vr=10,Et=11,tl=12,Jy=13,$s=14,Kn=15,zo=16,Gs=17,_r=18,Xr=19,Zy=20,Yr=21,_f=22,nu=23,li=24,zs=25,Ws=26,dt=27,DI=1,Wi=6,Er=7,iu=8,qs=9,$t=10;function ci(n){return Array.isArray(n)&&typeof n[DI]=="object"}function ui(n){return Array.isArray(n)&&n[DI]===!0}function Xy(n){return(n.flags&4)!==0}function eo(n){return n.componentOffset>-1}function ru(n){return(n.flags&1)===1}function br(n){return!!n.template}function Ks(n){return(n[He]&512)!==0}function Wo(n){return(n[He]&256)===256}var ev="svg",AI="math";function di(n){for(;Array.isArray(n);)n=n[qn];return n}function tv(n,e){return di(e[n])}function Ci(n,e){return di(e[n.index])}function Ys(n,e){return n.data[e]}function ou(n,e){return n[e]}function su(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Di(n,e){let t=e[n];return ci(t)?t:t[qn]}function MI(n){return(n[He]&4)===4}function Ef(n){return(n[He]&128)===128}function RI(n){return ui(n[Zt])}function Ai(n,e){return e==null?null:n[e]}function nv(n){n[Gs]=0}function iv(n){n[He]&1024||(n[He]|=1024,Ef(n)&&nl(n))}function NI(n,e){for(;n>0;)e=e[$s],n--;return e}function au(n){return!!(n[He]&9216||n[li]?.dirty)}function bf(n){n[vr].changeDetectionScheduler?.notify(8),n[He]&64&&(n[He]|=1024),au(n)&&nl(n)}function nl(n){n[vr].changeDetectionScheduler?.notify(0);let e=jo(n);for(;e!==null&&!(e[He]&8192||(e[He]|=8192,!Ef(e)));)e=jo(e)}function rv(n,e){if(Wo(n))throw new pe(911,!1);n[Yr]===null&&(n[Yr]=[]),n[Yr].push(e)}function PI(n,e){if(n[Yr]===null)return;let t=n[Yr].indexOf(e);t!==-1&&n[Yr].splice(t,1)}function jo(n){let e=n[Zt];return ui(e)?e[Zt]:e}function ov(n){return n[el]??=[]}function sv(n){return n.cleanup??=[]}function kI(n,e,t,i){let r=ov(e);r.push(t),n.firstCreatePass&&sv(n).push(i,r.length-1)}var Ye={lFrame:WI(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Dy=!1;function OI(){return Ye.lFrame.elementDepthCount}function FI(){Ye.lFrame.elementDepthCount++}function av(){Ye.lFrame.elementDepthCount--}function lv(){return Ye.bindingsEnabled}function cv(){return Ye.skipHydrationRootTNode!==null}function uv(n){return Ye.skipHydrationRootTNode===n}function LI(n){Ye.skipHydrationRootTNode=n}function dv(){Ye.skipHydrationRootTNode=null}function Ue(){return Ye.lFrame.lView}function Kt(){return Ye.lFrame.tView}function ie(n){return Ye.lFrame.contextLView=n,n[Xt]}function re(n){return Ye.lFrame.contextLView=null,n}function Ln(){let n=hv();for(;n!==null&&n.type===64;)n=n.parent;return n}function hv(){return Ye.lFrame.currentTNode}function VI(){let n=Ye.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Qs(n,e){let t=Ye.lFrame;t.currentTNode=n,t.isParent=e}function fv(){return Ye.lFrame.isParent}function UI(){Ye.lFrame.isParent=!1}function pv(){return Ye.lFrame.contextLView}function gv(){return Dy}function mv(n){let e=Dy;return Dy=n,e}function lu(){let n=Ye.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function yv(){return Ye.lFrame.bindingIndex}function BI(n){return Ye.lFrame.bindingIndex=n}function qo(){return Ye.lFrame.bindingIndex++}function cu(n){let e=Ye.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function jI(){return Ye.lFrame.inI18n}function HI(n,e){let t=Ye.lFrame;t.bindingIndex=t.bindingRootIndex=n,wf(e)}function $I(){return Ye.lFrame.currentDirectiveIndex}function wf(n){Ye.lFrame.currentDirectiveIndex=n}function GI(n){let e=Ye.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function vv(){return Ye.lFrame.currentQueryIndex}function xf(n){Ye.lFrame.currentQueryIndex=n}function Y4(n){let e=n[Ce];return e.type===2?e.declTNode:e.type===1?n[Ti]:null}function _v(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=Y4(o),r===null||(o=o[$s],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Ye.lFrame=zI();return i.currentTNode=e,i.lView=n,!0}function Sf(n){let e=zI(),t=n[Ce];Ye.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function zI(){let n=Ye.lFrame,e=n===null?null:n.child;return e===null?WI(n):e}function WI(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function qI(){let n=Ye.lFrame;return Ye.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Ev=qI;function If(){let n=qI();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function KI(n){return(Ye.lFrame.contextLView=NI(n,Ye.lFrame.contextLView))[Xt]}function Mi(){return Ye.lFrame.selectedIndex}function Ko(n){Ye.lFrame.selectedIndex=n}function Tf(){let n=Ye.lFrame;return Ys(n.tView,n.selectedIndex)}function X(){Ye.lFrame.currentNamespace=ev}function Ne(){Q4()}function Q4(){Ye.lFrame.currentNamespace=null}function bv(){return Ye.lFrame.currentNamespace}var YI=!0;function Cf(){return YI}function to(n){YI=n}function Ay(n,e=null,t=null,i){let r=wv(n,e,t,i);return r.resolveInjectorInitializers(),r}function wv(n,e=null,t=null,i,r=new Set){let o=[t||zn,xI(n)];return i=i||(typeof n=="object"?void 0:Qr(n)),new js(o,e||tu(),i||null,r)}var Wn=class n{static THROW_IF_NOT_FOUND=Vs;static NULL=new Yc;static create(e,t){if(Array.isArray(e))return Ay({name:""},t,e,"");{let i=e.name??"";return Ay({name:i},e.parent,e.providers,i)}}static \u0275prov=le({token:n,providedIn:"any",factory:()=>De(qy)});static __NG_ELEMENT_ID__=-1},Yt=new _e(""),Zn=(()=>{class n{static __NG_ELEMENT_ID__=J4;static __NG_ENV_ID__=t=>t}return n})(),My=class extends Zn{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Wo(this._lView)}onDestroy(e){let t=this._lView;return rv(t,e),()=>PI(t,e)}};function J4(){return new My(Ue())}var QI=!1,JI=new _e(""),wr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Mn(!1);debugTaskTracker=z(JI,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new st(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),Ry=class extends Bt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,CI()&&(this.destroyRef=z(Zn,{optional:!0})??void 0,this.pendingTasks=z(wr,{optional:!0})??void 0)}emit(e){let t=Ve(null);try{super.next(e)}finally{Ve(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof gn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},ln=Ry;function lf(...n){}function xv(n){let e,t;function i(){n=lf;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function ZI(n){return queueMicrotask(()=>n()),()=>{n=lf}}var Sv="isAngularZone",Qc=Sv+"_ID",Z4=0,mn=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ln(!1);onMicrotaskEmpty=new ln(!1);onStable=new ln(!1);onError=new ln(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=QI}=e;if(typeof Zone>"u")throw new pe(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,tF(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Sv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new pe(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new pe(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,X4,lf,lf);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},X4={};function Iv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function eF(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){xv(()=>{n.callbackScheduled=!1,Ny(n),n.isCheckStableRunning=!0,Iv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Ny(n)}function tF(n){let e=()=>{eF(n)},t=Z4++;n._inner=n._inner.fork({name:"angular",properties:{[Sv]:!0,[Qc]:t,[Qc+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(nF(l))return i.invokeTask(o,s,a,l);try{return hI(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),fI(n)}},onInvoke:(i,r,o,s,a,l,c)=>{try{return hI(n),i.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!iF(l)&&e(),fI(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Ny(n),Iv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Ny(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function hI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function fI(n){n._nesting--,Iv(n)}var Jc=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ln;onMicrotaskEmpty=new ln;onStable=new ln;onError=new ln;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function nF(n){return XI(n,"__ignore_ng_zone__")}function iF(n){return XI(n,"__scheduler_tick__")}function XI(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var fr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},hi=new _e("",{factory:()=>{let n=z(mn),e=z(qt),t;return i=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw i}):(t??=e.get(fr),t.handleError(i))})}}}),eT={provide:mr,useValue:()=>{let n=z(fr,{optional:!0})},multi:!0},rF=new _e("",{factory:()=>{let n=z(Yt).defaultView;if(!n)return;let e=z(hi),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),z(Zn).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function Tv(){return yr([wI(()=>{z(rF)})])}function G(n,e){let[t,i,r]=ry(n,e?.equal),o=t,s=o[Yn];return o.set=i,o.update=r,o.asReadonly=tT.bind(o),o}function tT(){let n=this[Yn];if(n.readonlyFn===void 0){let e=()=>this();e[Yn]=n,n.readonlyFn=e}return n.readonlyFn}var Df=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=oF}return n})();function oF(){return new Df(Ue(),Ln())}var Ho=class{},uu=new _e("",{factory:()=>!0});var Cv=new _e(""),du=(()=>{class n{internalPendingTasks=z(wr);scheduler=z(Ho);errorHandler=z(hi);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),Dv=(()=>{class n{static \u0275prov=le({token:n,providedIn:"root",factory:()=>new Py})}return n})(),Py=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}},ky=class{[Yn];constructor(e){this[Yn]=e}destroy(){this[Yn].destroy()}};function cn(n){return oy(n)}var Af={JSACTION:"jsaction"};function bu(n){return{toString:n}.toString()}function dF(n){return typeof n=="function"}function BT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Uf=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}},no=(()=>{let n=()=>jT;return n.ngInherit=!0,n})();function jT(n){return n.type.prototype.ngOnChanges&&(n.setInput=fF),hF}function hF(){let n=$T(this),e=n?.current;if(e){let t=n.previous;if(t===Go)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function fF(n,e,t,i,r){let o=this.declaredInputs[i],s=$T(n)||pF(n,{previous:Go,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new Uf(c&&c.currentValue,t,l===Go),BT(n,e,r,t)}var HT="__ngSimpleChanges__";function $T(n){return n[HT]||null}function pF(n,e){return n[HT]=e}var nT=[];var gt=function(n,e=null,t){for(let i=0;i<nT.length;i++){let r=nT[i];r(n,e,t)}},at=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(at||{});function gF(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=jT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function GT(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Nf(n,e,t){zT(n,e,3,t)}function Pf(n,e,t,i){(n[He]&3)===t&&zT(n,e,t,i)}function Av(n,e){let t=n[He];(t&3)===e&&(t&=16383,t+=1,n[He]=t)}function zT(n,e,t,i){let r=i!==void 0?n[Gs]&65535:0,o=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(n[Gs]+=65536),(a<o||o==-1)&&(mF(n,t,e,l),n[Gs]=(n[Gs]&4294901760)+l+2),l++}function iT(n,e){gt(at.LifecycleHookStart,n,e);let t=Ve(null);try{e.call(n)}finally{Ve(t),gt(at.LifecycleHookEnd,n,e)}}function mF(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[He]>>14<n[Gs]>>16&&(n[He]&3)===e&&(n[He]+=16384,iT(a,o)):iT(a,o)}var rl=-1,Xs=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function yF(n){return(n.flags&8)!==0}function vF(n){return(n.flags&16)!==0}function _F(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];EF(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function WT(n){return n===3||n===4||n===6}function EF(n){return n.charCodeAt(0)===64}function al(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?rT(n,t,r,null,e[++i]):rT(n,t,r,null,null))}}return n}function rT(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function qT(n){return n!==rl}function Bf(n){return n&32767}function bF(n){return n>>16}function jf(n,e){let t=bF(n),i=e;for(;t>0;)i=i[$s],t--;return i}var $v=!0;function Hf(n){let e=$v;return $v=n,e}var wF=256,KT=wF-1,YT=5,xF=0,xr={};function SF(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Hs)&&(i=t[Hs]),i==null&&(i=t[Hs]=xF++);let r=i&KT,o=1<<r;e.data[n+(r>>YT)]|=o}function $f(n,e){let t=QT(n,e);if(t!==-1)return t;let i=e[Ce];i.firstCreatePass&&(n.injectorIndex=e.length,Mv(i.data,n),Mv(e,null),Mv(i.blueprint,null));let r=v_(n,e),o=n.injectorIndex;if(qT(r)){let s=Bf(r),a=jf(r,e),l=a[Ce].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=r,o}function Mv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function QT(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function v_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=tC(r),i===null)return rl;if(t++,r=r[$s],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return rl}function Gv(n,e,t){SF(n,e,t)}function IF(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(WT(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function JT(n,e,t){if(t&8||n!==void 0)return n;pf(e,"NodeInjector")}function ZT(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[ai],o=Gn(void 0);try{return r?r.get(e,i,t&8):zy(e,i,t&8)}finally{Gn(o)}}return JT(i,e,t)}function XT(n,e,t,i=0,r){if(n!==null){if(e[He]&2048&&!(i&2)){let s=AF(n,e,t,i,xr);if(s!==xr)return s}let o=eC(n,e,t,i,xr);if(o!==xr)return o}return ZT(e,t,i,r)}function eC(n,e,t,i,r){let o=CF(t);if(typeof o=="function"){if(!_v(e,n,i))return i&1?JT(r,t,i):ZT(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))pf(t);else return s}finally{Ev()}}else if(typeof o=="number"){let s=null,a=QT(n,e),l=rl,c=i&1?e[Kn][Ti]:null;for((a===-1||i&4)&&(l=a===-1?v_(n,e):e[a+8],l===rl||!sT(i,!1)?a=-1:(s=e[Ce],a=Bf(l),e=jf(l,e)));a!==-1;){let d=e[Ce];if(oT(o,a,d.data)){let h=TF(a,e,t,s,i,c);if(h!==xr)return h}l=e[a+8],l!==rl&&sT(i,e[Ce].data[a+8]===c)&&oT(o,a,e)?(s=d,a=Bf(l),e=jf(l,e)):a=-1}}return r}function TF(n,e,t,i,r,o){let s=e[Ce],a=s.data[n+8],l=i==null?eo(a)&&$v:i!=s&&(a.type&3)!==0,c=r&1&&o===a,d=kf(a,s,t,l,c);return d!==null?gu(e,s,d,a,r):xr}function kf(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,d=o>>20,h=i?a:a+d,p=r?a+d:c;for(let g=h;g<p;g++){let S=s[g];if(g<l&&t===S||g>=l&&S.type===t)return g}if(r){let g=s[l];if(g&&br(g)&&g.type===t)return l}return null}function gu(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof Xs){let a=o;if(a.resolving){let g=gI(s[t]);throw Gy(g)}let l=Hf(a.canSeeViewProviders);a.resolving=!0;let c=s[t].type||s[t],d,h=a.injectImpl?Gn(a.injectImpl):null,p=_v(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&gF(t,s[t],e)}finally{h!==null&&Gn(h),Hf(l),a.resolving=!1,Ev()}}return o}function CF(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Hs)?n[Hs]:void 0;return typeof e=="number"?e>=0?e&KT:DF:e}function oT(n,e,t){let i=1<<n;return!!(t[e+(n>>YT)]&i)}function sT(n,e){return!(n&2)&&!(n&1&&e)}var Zs=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return XT(this._tNode,this._lView,e,Us(i),t)}};function DF(){return new Zs(Ln(),Ue())}function ra(n){return bu(()=>{let e=n.prototype.constructor,t=e[Kc]||zv(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[Kc]||zv(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function zv(n){return Oy(n)?()=>{let e=zv(Nn(n));return e&&e()}:Bo(n)}function AF(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[He]&2048&&!Ks(s);){let a=eC(o,s,t,i|2,xr);if(a!==xr)return a;let l=o.parent;if(!l){let c=s[Zy];if(c){let d=c.get(t,xr,i);if(d!==xr)return d}l=tC(s),s=s[$s]}o=l}return r}function tC(n){let e=n[Ce],t=e.type;return t===2?e.declTNode:t===1?n[Ti]:null}function wu(n){return IF(Ln(),n)}function MF(){return hl(Ln(),Ue())}function hl(n,e){return new Qi(Ci(n,e))}var Qi=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=MF}return n})();function RF(n){return n instanceof Qi?n.nativeElement:n}function NF(){return this._results[Symbol.iterator]()}var Gf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Bt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=EI(e);(this._changesDetected=!_I(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=NF},nC="ngSkipHydration",PF="ngskiphydration";function iC(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let i=e[t];if(typeof i=="number")return!1;if(typeof i=="string"&&i.toLowerCase()===PF)return!0}return!1}function rC(n){return n.hasAttribute(nC)}function zf(n){return(n.flags&128)===128}function oC(n){if(zf(n))return!0;let e=n.parent;for(;e;){if(zf(n)||iC(e))return!0;e=e.parent}return!1}var __=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(__||{}),sC=new Map,kF=0;function OF(){return kF++}function FF(n){sC.set(n[Xr],n)}function Wv(n){sC.delete(n[Xr])}var aT="__ngContext__";function ll(n,e){ci(e)?(n[aT]=e[Xr],FF(e)):n[aT]=e}function aC(n){return cC(n[tl])}function lC(n){return cC(n[Ii])}function cC(n){for(;n!==null&&!ui(n);)n=n[Ii];return n}var qv;function E_(n){qv=n}function uC(){if(qv!==void 0)return qv;if(typeof document<"u")return document;throw new pe(210,!1)}var Ir=new _e("",{factory:()=>LF}),LF="ng";var ap=new _e(""),Ji=new _e("",{providedIn:"platform",factory:()=>"unknown"});var fl=new _e("",{factory:()=>z(Yt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var pl=(()=>{class n{static \u0275prov=le({token:n,providedIn:"root",factory:()=>{let t=new n;return t.store=VF(z(Yt),z(Ir)),t}});store={};onSerializeCallbacks={};get(t,i){return this.store[t]!==void 0?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function VF(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}var dC="h",hC="b",UF="f",BF="n",fC="e",pC="t",lp="c",b_="x",mu="r",gC="i",mC="n",w_="d";var yC="di",vC="s",_C="p";var xu=new _e(""),EC=!1,x_=new _e("",{factory:()=>EC});var S_=new _e(""),bC=!1,wC=new _e("",{factory:()=>[]}),xC=new _e(""),I_=new _e("",{factory:()=>new Map});var Su="ngb";var SC=(n,e,t)=>{let i=n,r=i.__jsaction_fns??new Map,o=r.get(e)??[];o.push(t),r.set(e,o),i.__jsaction_fns=r},IC=(n,e)=>{let t=n,i=t.getAttribute(Su)??"",r=e.get(i)??new Set;r.has(t)||r.add(t),e.set(i,r)};var TC=n=>{n.removeAttribute(Af.JSACTION),n.removeAttribute(Su),n.__jsaction_fns=void 0},CC=new _e("",{factory:()=>({})});function T_(n,e){let t=e?.__jsaction_fns?.get(n.type);if(!(!t||!e?.isConnected))for(let i of t)i(n)}var Kv=new Map;function DC(n,e){return Kv.set(n,e),()=>Kv.delete(n)}var lT=!1,AC=(n,e,t,i)=>{};function jF(n,e,t,i){AC(n,e,t,i)}function MC(){lT||(AC=(n,e,t,i)=>{let r=n[ai].get(Ir);Kv.get(r)?.(e,t,i)},lT=!0)}var cp=new _e("");function up(n){return(n.flags&32)===32}var HF="__nghData__",C_=HF,$F="__nghDeferData__",RC=$F;var Of="ngh",NC="nghm",PC=()=>null;function GF(n,e,t=!1){let i=n.getAttribute(Of);if(i==null)return null;let[r,o]=i.split("|");if(i=t?o:r,!i)return null;let s=o?`|${o}`:"",a=t?r:s,l={};if(i!==""){let d=e.get(pl,null,{optional:!0});d!==null&&(l=d.get(C_,[])[Number(i)])}let c={data:l,firstChild:n.firstChild??null};return t&&(c.firstChild=n,dp(c,0,n.nextSibling)),a?n.setAttribute(Of,a):n.removeAttribute(Of),c}function kC(){PC=GF}function OC(n,e,t=!1){return PC(n,e,t)}function FC(n){let e=n._lView;return e[Ce].type===2?null:(Ks(e)&&(e=e[dt]),e)}function zF(n){return n.textContent?.replace(/\s/gm,"")}function WF(n){let e=uC(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){let s=zF(o);return s==="ngetn"||s==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),i,r=[];for(;i=t.nextNode();)r.push(i);for(let o of r)o.textContent==="ngetn"?o.replaceWith(e.createTextNode("")):o.remove()}function dp(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function Yv(n,e){return n.segmentHeads?.[e]??null}function LC(n){return n.get(xC,!1,{optional:!0})}function qF(n,e){let t=n.data,i=t[fC]?.[e]??null;return i===null&&t[lp]?.[e]&&(i=D_(n,e)),i}function VC(n,e){return n.data[lp]?.[e]??null}function D_(n,e){let t=VC(n,e)??[],i=0;for(let r of t)i+=r[mu]*(r[b_]??1);return i}function KF(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[w_];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function UC(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[w_];n.disconnectedNodes=t?new Set(t):null}return!!KF(n)?.has(e)}function hp(n,e){let t=n[Jn];return t!==null&&!cv()&&!up(e)&&!UC(t,e.index-dt)}function YF(n,e){let t=e.get(cp),r=e.get(pl).get(RC,{}),o=!1,s=n,a=null,l=[];for(;!o&&s;){o=t.has(s);let c=t.hydrating.get(s);if(a===null&&c!=null){a=c.promise;break}l.unshift(s),s=r[s][_C]}return{parentBlockPromise:a,hydrationQueue:l}}function Rv(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===NC}function cT(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function BC(n){for(let i of n.body.childNodes)if(Rv(i))return;let e=cT(n.body.previousSibling);if(Rv(e))return;let t=cT(n.head.lastChild);if(!Rv(t))throw new pe(-507,!1)}function jC(n,e){let t=n.contentQueries;if(t!==null){let i=Ve(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];xf(o),a.contentQueries(2,e[s],s)}}}finally{Ve(i)}}}function Qv(n,e,t){xf(0);let i=Ve(null);try{e(n,t)}finally{Ve(i)}}function HC(n,e,t){if(Xy(e)){let i=Ve(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ve(i)}}}var Yi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Yi||{});var Mf;function QF(){if(Mf===void 0&&(Mf=null,pr.trustedTypes))try{Mf=pr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Mf}function uT(n){return QF()?.createScriptURL(n)||n}var Wf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${cf})`}};function gl(n){return n instanceof Wf?n.changingThisBreaksApplicationSecurity:n}function fp(n,e){let t=$C(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${cf})`)}return t===e}function $C(n){return n instanceof Wf&&n.getTypeName()||null}var JF=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function A_(n){return n=String(n),n.match(JF)?n:"unsafe:"+n}var ZF=/^>|^->|<!--|-->|--!>|<!-$/g,XF=/(<|>)/g,e3="\u200B$1\u200B";function t3(n){return n.replace(ZF,e=>e.replace(XF,e3))}function GC(n,e){return n.createText(e)}function n3(n,e,t){n.setValue(e,t)}function zC(n,e){return n.createComment(t3(e))}function M_(n,e,t){return n.createElement(e,t)}function qf(n,e,t,i,r){n.insertBefore(e,t,i,r)}function WC(n,e,t){n.appendChild(e,t)}function dT(n,e,t,i,r){i!==null?qf(n,e,t,i,r):WC(n,e,t)}function R_(n,e,t,i){n.removeChild(null,e,t,i)}function qC(n){n.textContent=""}function i3(n,e,t){n.setAttribute(e,"style",t)}function r3(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function KC(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&_F(n,e,i),r!==null&&r3(n,e,r),o!==null&&i3(n,e,o)}var Iu=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Iu||{});function Zi(n){let e=QC();return e?e.sanitize(Iu.URL,n)||"":fp(n,"URL")?gl(n):A_(zi(n))}function YC(n){let e=QC();if(e)return uT(e.sanitize(Iu.RESOURCE_URL,n)||"");if(fp(n,"ResourceURL"))return uT(gl(n));throw new pe(904,!1)}var o3=new Set(["embed","frame","iframe","media","script"]),s3=new Set(["base","link","script"]);function a3(n,e){return e==="src"&&o3.has(n)||e==="href"&&s3.has(n)||e==="xlink:href"&&n==="script"?YC:Zi}function N_(n,e,t){return a3(e,t)(n)}function QC(){let n=Ue();return n&&n[vr].sanitizer}function oa(n){return n.ownerDocument.defaultView}function JC(n){return n.ownerDocument.body}function ZC(n){return n instanceof Function?n():n}function l3(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var XC="ng-template";function c3(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&l3(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(P_(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function P_(n){return n.type===4&&n.value!==XC}function u3(n,e,t){let i=n.type===4&&!t?XC:n.value;return e===i}function d3(n,e,t){let i=4,r=n.attrs,o=r!==null?p3(r):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!qi(i)&&!qi(l))return!1;if(s&&qi(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!u3(n,l,t)||l===""&&e.length===1){if(qi(i))return!1;s=!0}}else if(i&8){if(r===null||!c3(n,r,l,t)){if(qi(i))return!1;s=!0}}else{let c=e[++a],d=h3(l,r,P_(n),t);if(d===-1){if(qi(i))return!1;s=!0;continue}if(c!==""){let h;if(d>o?h="":h=r[d+1].toLowerCase(),i&2&&c!==h){if(qi(i))return!1;s=!0}}}}return qi(i)||s}function qi(n){return(n&1)===0}function h3(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return g3(e,n)}function f3(n,e,t=!1){for(let i=0;i<e.length;i++)if(d3(n,e[i],t))return!0;return!1}function p3(n){for(let e=0;e<n.length;e++){let t=n[e];if(WT(t))return e}return n.length}function g3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function hT(n,e){return n?":not("+e.trim()+")":e}function m3(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!qi(s)&&(e+=hT(o,r),r=""),i=s,o=o||!qi(i);t++}return r!==""&&(e+=hT(o,r)),e}function y3(n){return n.map(m3).join(",")}function v3(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!qi(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var En={};function k_(n,e,t,i,r,o,s,a,l,c,d){let h=dt+i,p=h+r,g=_3(h,p),S=typeof c=="function"?c():c;return g[Ce]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:S,incompleteFirstPass:!1,ssrId:d}}function _3(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:En);return t}function E3(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=k_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function O_(n,e,t,i,r,o,s,a,l,c,d){let h=e.blueprint.slice();return h[qn]=r,h[He]=i|4|128|8|64|1024,(c!==null||n&&n[He]&2048)&&(h[He]|=2048),nv(h),h[Zt]=h[$s]=n,h[Xt]=t,h[vr]=s||n&&n[vr],h[Et]=a||n&&n[Et],h[ai]=l||n&&n[ai]||null,h[Ti]=o,h[Xr]=OF(),h[Jn]=d,h[Zy]=c,h[Kn]=e.type==2?n[Kn]:h,h}function b3(n,e,t){let i=Ci(e,n),r=E3(t),o=n[vr].rendererFactory,s=F_(n,O_(n,r,null,eD(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function eD(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function tD(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function F_(n,e){return n[tl]?n[Jy][Ii]=e:n[tl]=e,n[Jy]=e,e}function y(n=1){nD(Kt(),Ue(),Mi()+n,!1)}function nD(n,e,t,i){if(!i)if((e[He]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Nf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Pf(e,o,0,t)}Ko(t)}var pp=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(pp||{});function Jv(n,e,t,i){let r=Ve(null);try{let[o,s,a]=n.inputs[t],l=null;(s&pp.SignalBased)!==0&&(l=e[o][Yn]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,l,i,t,o):BT(e,l,o,i)}finally{Ve(r)}}var Sr=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Sr||{}),w3;function L_(n,e){return w3(n,e)}var ea=new Set,gp=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(gp||{}),Jo=new _e(""),fT=new Set;function gi(n){fT.has(n)||(fT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var V_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),iD=[0,1,2,3],rD=(()=>{class n{ngZone=z(mn);scheduler=z(Ho);errorHandler=z(fr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){z(Jo,{optional:!0})}execute(){let t=this.sequences.size>0;t&&gt(at.AfterRenderHooksStart),this.executing=!0;for(let i of iD)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&gt(at.AfterRenderHooksEnd)}register(t){let{view:i}=t;i!==void 0?((i[zs]??=[]).push(t),nl(i),i[He]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(gp.AFTER_NEXT_RENDER,t):t()}static \u0275prov=le({token:n,providedIn:"root",factory:()=>new n})}return n})(),Kf=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[zs];e&&(this.view[zs]=e.filter(t=>t!==this))}};function Tu(n,e){let t=e?.injector??z(Wn);return gi("NgAfterNextRender"),S3(n,t,e,!0)}function x3(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function S3(n,e,t,i){let r=e.get(V_);r.impl??=e.get(rD);let o=e.get(Jo,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Zn):null,a=e.get(Df,null,{optional:!0}),l=new Kf(r.impl,x3(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(l),l}var oD=new _e("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:z(qt)})});function sD(n,e,t){let i=n.get(oD);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function I3(n,e){let t=n.get(oD);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function T3(n,e){for(let[t,i]of e)sD(n,i.animateFns)}function pT(n,e,t,i){let r=n?.[Ws]?.enter;e!==null&&r&&r.has(t.index)&&T3(i,r)}function il(n,e,t,i,r,o,s,a){if(r!=null){let l,c=!1;ui(r)?l=r:ci(r)&&(c=!0,r=r[qn]);let d=di(r);n===0&&i!==null?(pT(a,i,o,t),s==null?WC(e,i,d):qf(e,i,d,s||null,!0)):n===1&&i!==null?(pT(a,i,o,t),qf(e,i,d,s||null,!0)):n===2?gT(a,o,t,h=>{R_(e,d,c,h)}):n===3&&gT(a,o,t,()=>{e.destroyNode(d)}),l!=null&&U3(e,n,t,l,o,i,s)}}function C3(n,e){aD(n,e),e[qn]=null,e[Ti]=null}function D3(n,e,t,i,r,o){i[qn]=r,i[Ti]=e,yp(n,i,t,1,r,o)}function aD(n,e){e[vr].changeDetectionScheduler?.notify(9),yp(n,e,e[Et],2,null,null)}function A3(n){let e=n[tl];if(!e)return Nv(n[Ce],n);for(;e;){let t=null;if(ci(e))t=e[tl];else{let i=e[$t];i&&(t=i)}if(!t){for(;e&&!e[Ii]&&e!==n;)ci(e)&&Nv(e[Ce],e),e=e[Zt];e===null&&(e=n),ci(e)&&Nv(e[Ce],e),t=e&&e[Ii]}e=t}}function U_(n,e){let t=n[qs],i=t.indexOf(e);t.splice(i,1)}function mp(n,e){if(Wo(e))return;let t=e[Et];t.destroyNode&&yp(n,e,t,3,null,null),A3(e)}function Nv(n,e){if(Wo(e))return;let t=Ve(null);try{e[He]&=-129,e[He]|=256,e[li]&&Uc(e[li]),N3(n,e),R3(n,e),e[Ce].type===1&&e[Et].destroy();let i=e[zo];if(i!==null&&ui(e[Zt])){i!==e[Zt]&&U_(i,e);let r=e[_r];r!==null&&r.detachView(n)}Wv(e)}finally{Ve(t)}}function gT(n,e,t,i){let r=n?.[Ws];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&ea.add(n[Xr]),sD(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let c=s.animateFns[l],{promise:d}=c();a.push(d)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),M3(n,i)}else n&&ea.delete(n[Xr]),i(!1)},r)}function M3(n,e){let t=n[Ws]?.running;if(t){t.then(()=>{n[Ws].running=void 0,ea.delete(n[Xr]),e(!0)});return}e(!1)}function R3(n,e){let t=n.cleanup,i=e[el];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[el]=null);let r=e[Yr];if(r!==null){e[Yr]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[nu];if(o!==null){e[nu]=null;for(let s of o)s.destroy()}}function N3(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Xs)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],l=o[s+1];gt(at.LifecycleHookStart,a,l);try{l.call(a)}finally{gt(at.LifecycleHookEnd,a,l)}}else{gt(at.LifecycleHookStart,r,o);try{o.call(r)}finally{gt(at.LifecycleHookEnd,r,o)}}}}}function P3(n,e,t){return k3(n,e.parent,t)}function k3(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[qn];if(eo(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Yi.None||r===Yi.Emulated)return null}return Ci(i,t)}function O3(n,e,t){return L3(n,e,t)}function F3(n,e,t){return n.type&40?Ci(n,t):null}var L3=F3,mT;function B_(n,e,t,i){let r=P3(n,i,e),o=e[Et],s=i.parent||e[Ti],a=O3(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)dT(o,r,t[l],a,!1);else dT(o,r,t,a,!1);mT!==void 0&&mT(o,i,e,t,r)}function fu(n,e){if(e!==null){let t=e.type;if(t&3)return Ci(e,n);if(t&4)return Zv(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return fu(n,i);{let r=n[e.index];return ui(r)?Zv(-1,r):di(r)}}else{if(t&128)return fu(n,e.next);if(t&32)return L_(e,n)()||di(n[e.index]);{let i=lD(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=jo(n[Kn]);return fu(r,i)}else return fu(n,e.next)}}}return null}function lD(n,e){if(e!==null){let i=n[Kn][Ti],r=e.projection;return i.projection[r]}return null}function Zv(n,e){let t=$t+n+1;if(t<e.length){let i=e[t],r=i[Ce].firstChild;if(r!==null)return fu(i,r)}return e[Er]}function j_(n,e,t,i,r,o,s){for(;t!=null;){let a=i[ai];if(t.type===128){t=t.next;continue}let l=i[t.index],c=t.type;if(s&&e===0&&(l&&ll(di(l),i),t.flags|=2),!up(t))if(c&8)j_(n,e,t.child,i,r,o,!1),il(e,n,a,r,l,t,o,i);else if(c&32){let d=L_(t,i),h;for(;h=d();)il(e,n,a,r,h,t,o,i);il(e,n,a,r,l,t,o,i)}else c&16?V3(n,e,i,t,r,o):il(e,n,a,r,l,t,o,i);t=s?t.projectionNext:t.next}}function yp(n,e,t,i,r,o){j_(t,i,n.firstChild,e,r,o,!1)}function V3(n,e,t,i,r,o){let s=t[Kn],l=s[Ti].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];il(e,n,t[ai],r,d,i,o,t)}else{let c=l,d=s[Zt];zf(i)&&(c.flags|=128),j_(n,e,c,d,r,o,!0)}}function U3(n,e,t,i,r,o,s){let a=i[Er],l=di(i);a!==l&&il(e,n,t,o,a,r,s);for(let c=$t;c<i.length;c++){let d=i[c];yp(d[Ce],d,n,e,o,a)}}function B3(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:Sr.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Sr.Important),n.setStyle(t,i,r,o))}}function cD(n,e,t,i,r){let o=Mi(),s=i&2;try{Ko(-1),s&&e.length>dt&&nD(n,e,dt,!1);let a=s?at.TemplateUpdateStart:at.TemplateCreateStart;gt(a,r,t),t(i,r)}finally{Ko(o);let a=s?at.TemplateUpdateEnd:at.TemplateCreateEnd;gt(a,r,t)}}function H_(n,e,t){q3(n,e,t),(t.flags&64)===64&&K3(n,e,t)}function vp(n,e,t=Ci){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function j3(n,e,t,i){let o=i.get(x_,EC)||t===Yi.ShadowDom||t===Yi.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return H3(s),s}function H3(n){uD(n)}var uD=()=>null;function $3(n){rC(n)?qC(n):WF(n)}function dD(){uD=$3}function G3(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function z3(n,e,t,i,r,o){let s=e[Ce];if(G_(n,s,e,t,i)){eo(n)&&W3(e,n.index);return}n.type&3&&(t=G3(t)),hD(n,e,t,i,r,o)}function hD(n,e,t,i,r,o){if(n.type&3){let s=Ci(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function W3(n,e){let t=Di(e,n);t[He]&16||(t[He]|=64)}function q3(n,e,t){let i=t.directiveStart,r=t.directiveEnd;eo(t)&&b3(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||$f(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],l=gu(e,n,s,t);if(ll(l,e),o!==null&&Z3(e,s-i,l,a,t,o),br(a)){let c=Di(t.index,e);c[Xt]=gu(e,n,s,t)}}}function K3(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=$I();try{Ko(o);for(let a=i;a<r;a++){let l=n.data[a],c=e[a];wf(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&Y3(l,c)}}finally{Ko(-1),wf(s)}}function Y3(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function fD(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];f3(e,o.selectors,!1)&&(i??=[],br(o)?i.unshift(o):i.push(o))}return i}function Q3(n,e,t,i,r,o){let s=Ci(n,e);J3(e[Et],s,o,n.value,t,i,r)}function J3(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?zi(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function Z3(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];Jv(i,t,l,c)}}function pD(n,e,t,i,r){let o=dt+t,s=e[Ce],a=r(s,e,n,i,t);e[o]=a,Qs(n,!0);let l=n.type===2;return l?(KC(e[Et],a,n),(OI()===0||ru(n))&&ll(a,e),FI()):ll(a,e),Cf()&&(!l||!up(n))&&B_(s,e,a,n),n}function gD(n){let e=n;return fv()?UI():(e=e.parent,Qs(e,!1)),e}function $_(n,e){let t=n[ai];if(!t)return;let i;try{i=t.get(hi,null)}catch{i=null}i?.(e)}function G_(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],d=s[l+1],h=e.data[c];Jv(h,t[c],d,r),a=!0}if(o)for(let l of o){let c=t[l],d=e.data[l];Jv(d,c,i,r),a=!0}return a}function X3(n,e){let t=Di(e,n),i=t[Ce];eL(i,t);let r=t[qn];r!==null&&t[Jn]===null&&(t[Jn]=OC(r,t[ai])),gt(at.ComponentStart);try{z_(i,t,t[Xt])}finally{gt(at.ComponentEnd,t[Xt])}}function eL(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function z_(n,e,t){Sf(e);try{let i=n.viewQuery;i!==null&&Qv(1,i,t);let r=n.template;r!==null&&cD(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[_r]?.finishViewCreation(n),n.staticContentQueries&&jC(n,e),n.staticViewQueries&&Qv(2,n.viewQuery,t);let o=n.components;o!==null&&tL(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[He]&=-5,If()}}function tL(n,e){for(let t=0;t<e.length;t++)X3(n,e[t])}function Cu(n,e,t,i){let r=Ve(null);try{let o=e.tView,a=n[He]&4096?4096:16,l=O_(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),c=n[e.index];l[zo]=c;let d=n[_r];return d!==null&&(l[_r]=d.createEmbeddedView(o)),z_(o,l,t),l}finally{Ve(r)}}function cl(n,e){return!e||e.firstChild===null||zf(n)}function yu(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(di(o)),ui(o)&&mD(o,i);let s=t.type;if(s&8)yu(n,e,t.child,i);else if(s&32){let a=L_(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=lD(e,t);if(Array.isArray(a))i.push(...a);else{let l=jo(e[Kn]);yu(l[Ce],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function mD(n,e){for(let t=$t;t<n.length;t++){let i=n[t],r=i[Ce].firstChild;r!==null&&yu(i[Ce],i,r,e)}n[Er]!==n[qn]&&e.push(n[Er])}function yD(n){if(n[zs]!==null){for(let e of n[zs])e.impl.addSequence(e);n[zs].length=0}}var vD=[];function nL(n){return n[li]??iL(n)}function iL(n){let e=vD.pop()??Object.create(oL);return e.lView=n,e}function rL(n){n.lView[li]!==n&&(n.lView=null,vD.push(n))}var oL=fe(F({},Fc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{nl(n.lView)},consumerOnSignalRead(){this.lView[li]=this}});function sL(n){let e=n[li]??Object.create(aL);return e.lView=n,e}var aL=fe(F({},Fc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=jo(n.lView);for(;e&&!_D(e[Ce]);)e=jo(e);e&&iv(e)},consumerOnSignalRead(){this.lView[li]=this}});function _D(n){return n.type!==2}function ED(n){if(n[nu]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[nu])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[He]&8192)}}var lL=100;function bD(n,e=0){let i=n[vr].rendererFactory,r=!1;r||i.begin?.();try{cL(n,e)}finally{r||i.end?.()}}function cL(n,e){let t=gv();try{mv(!0),Xv(n,e);let i=0;for(;au(n);){if(i===lL)throw new pe(103,!1);i++,Xv(n,1)}}finally{mv(t)}}function uL(n,e,t,i){if(Wo(e))return;let r=e[He],o=!1,s=!1;Sf(e);let a=!0,l=null,c=null;o||(_D(n)?(c=nL(e),l=Vc(c)):Ih()===null?(a=!1,c=sL(e),l=Vc(c)):e[li]&&(Uc(e[li]),e[li]=null));try{nv(e),BI(n.bindingStartIndex),t!==null&&cD(n,e,t,2,i);let d=(r&3)===3;if(!o)if(d){let g=n.preOrderCheckHooks;g!==null&&Nf(e,g,null)}else{let g=n.preOrderHooks;g!==null&&Pf(e,g,0,null),Av(e,0)}if(s||dL(e),ED(e),wD(e,0),n.contentQueries!==null&&jC(n,e),!o)if(d){let g=n.contentCheckHooks;g!==null&&Nf(e,g)}else{let g=n.contentHooks;g!==null&&Pf(e,g,1),Av(e,1)}fL(n,e);let h=n.components;h!==null&&SD(e,h,0);let p=n.viewQuery;if(p!==null&&Qv(2,p,i),!o)if(d){let g=n.viewCheckHooks;g!==null&&Nf(e,g)}else{let g=n.viewHooks;g!==null&&Pf(e,g,2),Av(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[_f]){for(let g of e[_f])g();e[_f]=null}o||(yD(e),e[He]&=-73)}catch(d){throw o||nl(e),d}finally{c!==null&&(Th(c,l),a&&rL(c)),If()}}function wD(n,e){for(let t=aC(n);t!==null;t=lC(t))for(let i=$t;i<t.length;i++){let r=t[i];xD(r,e)}}function dL(n){for(let e=aC(n);e!==null;e=lC(e)){if(!(e[He]&2))continue;let t=e[qs];for(let i=0;i<t.length;i++){let r=t[i];iv(r)}}}function hL(n,e,t){gt(at.ComponentStart);let i=Di(e,n);try{xD(i,t)}finally{gt(at.ComponentEnd,i[Xt])}}function xD(n,e){Ef(n)&&Xv(n,e)}function Xv(n,e){let i=n[Ce],r=n[He],o=n[li],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&Ch(o)),s||=!1,o&&(o.dirty=!1),n[He]&=-9217,s)uL(i,n,i.template,n[Xt]);else if(r&8192){let a=Ve(null);try{ED(n),wD(n,1);let l=i.components;l!==null&&SD(n,l,1),yD(n)}finally{Ve(a)}}}function SD(n,e,t){for(let i=0;i<e.length;i++)hL(n,e[i],t)}function fL(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)Ko(~r);else{let o=r,s=t[++i],a=t[++i];HI(s,o);let l=e[o];gt(at.HostBindingsUpdateStart,l);try{a(2,l)}finally{gt(at.HostBindingsUpdateEnd,l)}}}}finally{Ko(-1)}}function _p(n,e){let t=gv()?64:1088;for(n[vr].changeDetectionScheduler?.notify(e);n;){n[He]|=t;let i=jo(n);if(Ks(n)&&!i)return n;n=i}return null}function ID(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function TD(n,e){let t=$t+e;if(t<n.length)return n[t]}function Du(n,e,t,i=!0){let r=e[Ce];if(pL(r,e,n,t),i){let s=Zv(t,n),a=e[Et],l=a.parentNode(n[Er]);l!==null&&D3(r,n[Ti],a,e,l,s)}let o=e[Jn];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function W_(n,e){let t=vu(n,e);return t!==void 0&&mp(t[Ce],t),t}function vu(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t];if(i){let r=i[zo];r!==null&&r!==n&&U_(r,i),e>0&&(n[t-1][Ii]=i[Ii]);let o=Xc(n,$t+e);C3(i[Ce],i);let s=o[_r];s!==null&&s.detachView(o[Ce]),i[Zt]=null,i[Ii]=null,i[He]&=-129}return i}function pL(n,e,t,i){let r=$t+i,o=t.length;i>0&&(t[r-1][Ii]=e),i<o-$t?(e[Ii]=t[r],Wy(t,$t+i,e)):(t.push(e),e[Ii]=null),e[Zt]=t;let s=e[zo];s!==null&&t!==s&&CD(s,e);let a=e[_r];a!==null&&a.insertView(n),bf(e),e[He]|=128}function CD(n,e){let t=n[qs],i=e[Zt];if(ci(i))n[He]|=2;else{let r=i[Zt][Kn];e[Kn]!==r&&(n[He]|=2)}t===null?n[qs]=[e]:t.push(e)}var Yo=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Ce];return yu(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Xt]}set context(e){this._lView[Xt]=e}get destroyed(){return Wo(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Zt];if(ui(e)){let t=e[iu],i=t?t.indexOf(this):-1;i>-1&&(vu(e,i),Xc(t,i))}this._attachedToViewContainer=!1}mp(this._lView[Ce],this._lView)}onDestroy(e){rv(this._lView,e)}markForCheck(){_p(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[He]&=-129}reattach(){bf(this._lView),this._lView[He]|=128}detectChanges(){this._lView[He]|=1024,bD(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Ks(this._lView),t=this._lView[zo];t!==null&&!e&&U_(t,this._lView),aD(this._lView[Ce],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new pe(902,!1);this._appRef=e;let t=Ks(this._lView),i=this._lView[zo];i!==null&&!t&&CD(i,this._lView),bf(this._lView)}};var Qo=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=gL;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Cu(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new Yo(o)}}return n})();function gL(){return Ep(Ln(),Ue())}function Ep(n,e){return n.type&4?new Qo(e,n,hl(n,e)):null}function ml(n,e,t,i,r){let o=n.data[e];if(o===null)o=mL(n,e,t,i,r),jI()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=VI();o.injectorIndex=s===null?-1:s.injectorIndex}return Qs(o,!0),o}function mL(n,e,t,i,r){let o=hv(),s=fv(),a=s?o:o&&o.parent,l=n.data[e]=vL(n,a,t,e,i,r);return yL(n,l,o,s),l}function yL(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function vL(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return cv()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var _L=new RegExp(`^(\\d+)*(${hC}|${dC})*(.*)`);function EL(n){let e=n.match(_L),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(let[l,c,d]of o.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(c,h)}return[s,...a]}function bL(n){return!n.prev&&n.parent?.type===8}function Pv(n){return n.index-dt}function wL(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function bp(n,e,t,i){let r=Pv(i),o=wL(n,r);if(o===void 0){let s=n.data[mC];if(s?.[r])o=SL(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{let a=i.prev===null,l=i.prev??i.parent;if(bL(i)){let c=Pv(i.parent);o=Yv(n,c)}else{let c=Ci(l,t);if(a)o=c.firstChild;else{let d=Pv(l),h=Yv(n,d);if(l.type===2&&h){let g=D_(n,d)+1;o=wp(g,h)}else o=c.nextSibling}}}}return o}function wp(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}function xL(n,e){let t=n;for(let i=0;i<e.length;i+=2){let r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case UF:t=t.firstChild;break;case BF:t=t.nextSibling;break}}return t}function SL(n,e){let[t,...i]=EL(n),r;if(t===dC)r=e[Kn][qn];else if(t===hC)r=JC(e[Kn][qn]);else{let o=Number(t);r=di(e[o+dt])}return xL(r,i)}var IL=!1;function DD(n){IL=n}function TL(n){let e=n[Jn];if(e){let{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){let r=n[Et];for(let o of i.values())CL(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}function CL(n,e,t){for(let i of t.node.cases[t.case]){let r=e.get(i.index-dt);r&&R_(n,r,!1)}}function xp(n){let e=n[Wi]??[],i=n[Zt][Et],r=[];for(let o of e)o.data[yC]!==void 0?r.push(o):AD(o,i);n[Wi]=r}function DL(n){let{lContainer:e}=n,t=e[Wi];if(t===null)return;let r=e[Zt][Et];for(let o of t)AD(o,r)}function AD(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[mu];for(;t<r;){let o=i.nextSibling;R_(e,i,!1),i=o,t++}}}function Sp(n){xp(n);let e=n[qn];ci(e)&&Yf(e);for(let t=$t;t<n.length;t++)Yf(n[t])}function Yf(n){TL(n);let e=n[Ce];for(let t=dt;t<e.bindingStartIndex;t++)if(ui(n[t])){let i=n[t];Sp(i)}else ci(n[t])&&Yf(n[t])}function q_(n){let e=n._views;for(let t of e){let i=FC(t);i!==null&&i[qn]!==null&&(ci(i)?Yf(i):Sp(i))}}function AL(n,e,t,i){n!==null&&(t.cleanup(e),Sp(n.lContainer),q_(i))}function ML(n,e){let t=[];for(let i of e)for(let r=0;r<(i[b_]??1);r++){let o={data:i,firstChild:null};i[mu]>0&&(o.firstChild=n,n=wp(i[mu],n)),t.push(o)}return[n,t]}var MD=()=>null,RD=()=>null;function ND(){MD=RL,RD=NL}function RL(n,e){return kD(n,e)?n[Wi].shift():(xp(n),null)}function Qf(n,e){return MD(n,e)}function NL(n,e,t){if(e.tView.ssrId===null)return null;let i=Qf(n,e.tView.ssrId);return t[Ce].firstUpdatePass&&i===null&&PL(t,e),i}function PD(n,e,t){return RD(n,e,t)}function PL(n,e){let t=e;for(;t;){if(yT(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(yT(n,t))return;t=t.next}}function kD(n,e){let t=n[Wi];return!e||t===null||t.length===0?!1:t[0].data[gC]===e}function yT(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let i=n[e.index];return ui(i)&&kD(i,t)?(xp(i),!0):!1}var OD=class{},Ip=class{},e_=class{resolveComponentFactory(e){throw new pe(917,!1)}},Au=class{static NULL=new e_},ta=class{},sa=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>kL()}return n})();function kL(){let n=Ue(),e=Ln(),t=Di(e.index,n);return(ci(t)?t:n)[Et]}var FD=(()=>{class n{static \u0275prov=le({token:n,providedIn:"root",factory:()=>null})}return n})();var Ff={},ol=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,Ff,i);return r!==Ff||t===Ff?r:this.parentInjector.get(e,t,i)}};function Jf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=uf(r,a);else if(o==2){let l=a,c=e[++s];i=uf(i,l+": "+c+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function ge(n,e=0){let t=Ue();if(t===null)return De(n,e);let i=Ln();return XT(i,t,Nn(n),e)}function LD(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,l=null,c=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,l,c]=d.resolveHostDirectives(s);break}LL(n,e,t,a,o,l,c)}o!==null&&i!==null&&OL(t,i,o)}function OL(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new pe(-301,!1);i.push(e[r],o)}}function FL(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function LL(n,e,t,i,r,o,s){let a=i.length,l=null;for(let p=0;p<a;p++){let g=i[p];l===null&&br(g)&&(l=g,FL(n,t,p)),Gv($f(t,e),n,g.type)}$L(t,n.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let p=0;p<a;p++){let g=i[p];g.providersResolver&&g.providersResolver(g)}let c=!1,d=!1,h=tD(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let p=0;p<a;p++){let g=i[p];if(t.mergedAttrs=al(t.mergedAttrs,g.hostAttrs),UL(n,t,e,h,g),HL(h,g,r),s!==null&&s.has(g)){let[I,P]=s.get(g);t.directiveToIndex.set(g.type,[h,I+t.directiveStart,P+t.directiveStart])}else(o===null||!o.has(g))&&t.directiveToIndex.set(g.type,h);g.contentQueries!==null&&(t.flags|=4),(g.hostBindings!==null||g.hostAttrs!==null||g.hostVars!==0)&&(t.flags|=64);let S=g.type.prototype;!c&&(S.ngOnChanges||S.ngOnInit||S.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!d&&(S.ngOnChanges||S.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}VL(n,t,o)}function VL(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))vT(0,e,r,i),vT(1,e,r,i),ET(e,i,!1);else{let o=t.get(r);_T(0,e,o,i),_T(1,e,o,i),ET(e,i,!0)}}}function vT(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),VD(e,o)}}function _T(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),VD(e,s)}}function VD(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function ET(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||P_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&r.hasOwnProperty(l)){let c=r[l];for(let d of c)if(d===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let c=o[l];for(let d=0;d<c.length;d+=2)if(c[d]===e){s??=[],s.push(c[d+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function UL(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Bo(r.type,!0)),s=new Xs(o,br(r),ge,null);n.blueprint[i]=s,t[i]=s,BL(n,e,i,tD(n,t,r.hostVars,En),r)}function BL(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;jL(s)!=a&&s.push(a),s.push(t,i,o)}}function jL(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function HL(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;br(e)&&(t[""]=n)}}function $L(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function UD(n,e,t,i,r,o,s,a){let l=e[Ce],c=l.consts,d=Ai(c,s),h=ml(l,n,t,i,d);return o&&LD(l,e,h,Ai(c,a),r),h.mergedAttrs=al(h.mergedAttrs,h.attrs),h.attrs!==null&&Jf(h,h.attrs,!1),h.mergedAttrs!==null&&Jf(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function BD(n,e){GT(n,e),Xy(e)&&n.queries.elementEnd(e)}function GL(n,e,t,i,r,o){let s=e.consts,a=Ai(s,r),l=ml(e,n,t,i,a);if(l.mergedAttrs=al(l.mergedAttrs,l.attrs),o!=null){let c=Ai(s,o);l.localNames=[];for(let d=0;d<c.length;d+=2)l.localNames.push(c[d],-1)}return l.attrs!==null&&Jf(l,l.attrs,!1),l.mergedAttrs!==null&&Jf(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function K_(n){return HD(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function jD(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function HD(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Y_(n,e,t){return n[e]=t}function zL(n,e){return n[e]}function pi(n,e,t){if(t===En)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function Q_(n,e,t,i){let r=pi(n,e,t);return pi(n,e+1,i)||r}function WL(n,e,t,i,r){let o=Q_(n,e,t,i);return pi(n,e+2,r)||o}function Lf(n,e,t){return function i(r){let o=eo(n)?Di(n.index,e):e;_p(o,5);let s=e[Xt],a=bT(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=bT(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function bT(n,e,t,i){let r=Ve(null);try{return gt(at.OutputStart,e,t),t(i)!==!1}catch(o){return $_(n,o),!1}finally{gt(at.OutputEnd,e,t),Ve(r)}}function $D(n,e,t,i,r,o,s,a){let l=ru(n),c=!1,d=null;if(!i&&l&&(d=KL(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,c=!0}else{let h=Ci(n,t),p=i?i(h):h;jF(t,p,o,a);let g=r.listen(p,o,a);if(!qL(o)){let S=i?I=>i(di(I[n.index])):n.index;GD(S,e,t,o,a,g,!1)}}return c}function qL(n){return n.startsWith("animation")||n.startsWith("transition")}function KL(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[el],l=r[o+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function GD(n,e,t,i,r,o,s){let a=e.firstCreatePass?sv(e):null,l=ov(t),c=l.length;l.push(r,o),a&&a.push(i,n,c,(c+1)*(s?-1:1))}function wT(n,e,t,i,r,o){let s=e[t],a=e[Ce],c=a.data[t].outputs[i],h=s[c].subscribe(o);GD(n.index,a,e,r,o,h,!0)}var t_=Symbol("BINDING");var Zf=class extends Au{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Zr(e);return new ul(t,this.ngModule)}};function YL(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&pp.SignalBased)!==0};return r&&(o.transform=r),o})}function QL(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function JL(n,e,t){let i=e instanceof qt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new ol(t,i):t}function ZL(n){let e=n.get(ta,null);if(e===null)throw new pe(407,!1);let t=n.get(FD,null),i=n.get(Ho,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function XL(n,e){let t=zD(n);return M_(e,t,t==="svg"?ev:t==="math"?AI:null)}function zD(n){return(n.selectors[0][0]||"div").toLowerCase()}var ul=class extends Ip{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=YL(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=QL(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=y3(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){gt(at.DynamicComponentStart);let a=Ve(null);try{let l=this.componentDef,c=eV(i,l,s,o),d=JL(l,r||this.ngModule,e),h=ZL(d),p=h.rendererFactory.createRenderer(null,l),g=i?j3(p,i,l.encapsulation,d):XL(l,p),S=s?.some(xT)||o?.some(U=>typeof U!="function"&&U.bindings.some(xT)),I=O_(null,c,null,512|eD(l),null,null,h,p,d,null,OC(g,d,!0));I[dt]=g,Sf(I);let P=null;try{let U=UD(dt,I,2,"#host",()=>c.directiveRegistry,!0,0);KC(p,g,U),ll(g,I),H_(c,I,U),HC(c,U,I),BD(c,U),t!==void 0&&nV(U,this.ngContentSelectors,t),P=Di(U.index,I),I[Xt]=P[Xt],z_(c,I,null)}catch(U){throw P!==null&&Wv(P),Wv(I),U}finally{gt(at.DynamicComponentEnd),If()}return new Xf(this.componentType,I,!!S)}finally{Ve(a)}}};function eV(n,e,t,i){let r=n?["ng-version","21.1.1"]:v3(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[t_].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(i)for(let d=0;d<i.length;d++){let h=i[d];if(typeof h!="function")for(let p of h.bindings){a+=p[t_].requiredVars;let g=d+1;p.create&&(p.targetIdx=g,(o??=[]).push(p)),p.update&&(p.targetIdx=g,(s??=[]).push(p))}}let l=[e];if(i)for(let d of i){let h=typeof d=="function"?d:d.type,p=hf(h);l.push(p)}return k_(0,null,tV(o,s),1,a,l,null,null,null,[r],null)}function tV(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function xT(n){let e=n[t_].kind;return e==="input"||e==="twoWay"}var Xf=class extends OD{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Ys(t[Ce],dt),this.location=hl(this._tNode,t),this.instance=Di(this._tNode.index,t)[Xt],this.hostView=this.changeDetectorRef=new Yo(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=G_(i,r[Ce],r,e,t);this.previousInputValues.set(e,t);let s=Di(i.index,r);_p(s,1)}get injector(){return new Zs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function nV(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var io=(()=>{class n{static __NG_ELEMENT_ID__=iV}return n})();function iV(){let n=Ln();return qD(n,Ue())}var rV=io,WD=class extends rV{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return hl(this._hostTNode,this._hostLView)}get injector(){return new Zs(this._hostTNode,this._hostLView)}get parentInjector(){let e=v_(this._hostTNode,this._hostLView);if(qT(e)){let t=jf(e,this._hostLView),i=Bf(e),r=t[Ce].data[i+8];return new Zs(r,t)}else return new Zs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=ST(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-$t}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=Qf(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,cl(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let l=e&&!dF(e),c;if(l)c=t;else{let P=t||{};c=P.index,i=P.injector,r=P.projectableNodes,o=P.environmentInjector||P.ngModuleRef,s=P.directives,a=P.bindings}let d=l?e:new ul(Zr(e)),h=i||this.parentInjector;if(!o&&d.ngModule==null){let U=(l?h:this.parentInjector).get(qt,null);U&&(o=U)}let p=Zr(d.componentType??{}),g=Qf(this._lContainer,p?.id??null),S=g?.firstChild??null,I=d.create(h,r,S,o,s,a);return this.insertImpl(I.hostView,c,cl(this._hostTNode,g)),I}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(RI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Zt],c=new WD(l,l[Ti],l[Zt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return Du(s,r,o,i),e.attachToViewContainerRef(),Wy(kv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=ST(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=vu(this._lContainer,t);i&&(Xc(kv(this._lContainer),t),mp(i[Ce],i))}detach(e){let t=this._adjustIndex(e,-1),i=vu(this._lContainer,t);return i&&Xc(kv(this._lContainer),t)!=null?new Yo(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function ST(n){return n[iu]}function kv(n){return n[iu]||(n[iu]=[])}function qD(n,e){let t,i=e[n.index];return ui(i)?t=i:(t=ID(i,e,null,n),e[n.index]=t,F_(e,t)),KD(t,e,n,i),new WD(t,n,e)}function oV(n,e){let t=n[Et],i=t.createComment(""),r=Ci(e,n),o=t.parentNode(r);return qf(t,o,i,t.nextSibling(r),!1),i}var KD=YD,J_=()=>!1;function sV(n,e,t){return J_(n,e,t)}function YD(n,e,t,i){if(n[Er])return;let r;t.type&8?r=di(i):r=oV(e,t),n[Er]=r}function aV(n,e,t){if(n[Er]&&n[Wi])return!0;let i=t[Jn],r=e.index-dt;if(!i||oC(e)||UC(i,r))return!1;let s=Yv(i,r),a=i.data[lp]?.[r],[l,c]=ML(s,a);return n[Er]=l,n[Wi]=c,!0}function lV(n,e,t,i){J_(n,t,e)||YD(n,e,t,i)}function QD(){KD=lV,J_=aV}var n_=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},i_=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)Z_(e,t).matches!==null&&this.queries[t].setDirty()}},r_=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=mV(e):this.predicate=e}},o_=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},s_=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,cV(t,o)),this.matchTNodeWithReadOption(e,t,kf(t,e,o,!1,!1))}else i===Qo?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,kf(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Qi||r===io||r===Qo&&t.type&4)this.addMatch(t.index,-2);else{let o=kf(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function cV(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function uV(n,e){return n.type&11?hl(n,e):n.type&4?Ep(n,e):null}function dV(n,e,t,i){return t===-1?uV(e,n):t===-2?hV(n,e,i):gu(n,n[Ce],t,e)}function hV(n,e,t){if(t===Qi)return hl(e,n);if(t===Qo)return Ep(e,n);if(t===io)return qD(e,n)}function JD(n,e,t,i){let r=e[_r].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let d=o[c];a.push(dV(e,d,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function a_(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=JD(n,e,r,t);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)i.push(s[a/2]);else{let c=o[a+1],d=e[-l];for(let h=$t;h<d.length;h++){let p=d[h];p[zo]===p[Zt]&&a_(p[Ce],p,c,i)}if(d[qs]!==null){let h=d[qs];for(let p=0;p<h.length;p++){let g=h[p];a_(g[Ce],g,c,i)}}}}}return i}function fV(n,e){return n[_r].queries[e].queryList}function pV(n,e,t){let i=new Gf((t&4)===4);return kI(n,e,i,i.destroy),(e[_r]??=new i_).queries.push(new n_(i))-1}function gV(n,e,t){let i=Kt();return i.firstCreatePass&&(yV(i,new r_(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),pV(i,Ue(),e)}function mV(n){return n.split(",").map(e=>e.trim())}function yV(n,e,t){n.queries===null&&(n.queries=new o_),n.queries.track(new s_(e,t))}function Z_(n,e){return n.queries.getByIndex(e)}function vV(n,e){let t=n[Ce],i=Z_(t,e);return i.crossesNgTemplate?a_(t,n,e,[]):JD(t,n,i,e)}var na=class{},Tp=class{};var ep=class extends na{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Zf(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=Hy(e);this._bootstrapComponents=ZC(o.bootstrap),this._r3Injector=wv(e,t,[{provide:na,useValue:this},{provide:Au,useValue:this.componentFactoryResolver},...i],Qr(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},tp=class extends Tp{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new ep(this.moduleType,e,[])}};var _u=class extends na{injector;componentFactoryResolver=new Zf(this);instance=null;constructor(e){super();let t=new js([...e.providers,{provide:na,useValue:this},{provide:Au,useValue:this.componentFactoryResolver}],e.parent||tu(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function yl(n,e,t=null){return new _u({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var _V=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=vf(!1,t.type),r=i.length>0?yl([i],this._injector,""):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=le({token:n,providedIn:"environment",factory:()=>new n(De(qt))})}return n})();function Dt(n){return bu(()=>{let e=ZD(n),t=fe(F({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===__.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(_V).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Yi.Emulated,styles:n.styles||zn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&gi("NgStandalone"),XD(t);let i=n.dependencies;return t.directiveDefs=IT(i,EV),t.pipeDefs=IT(i,$y),t.id=xV(t),t})}function EV(n){return Zr(n)||hf(n)}function ro(n){return bu(()=>({type:n.type,bootstrap:n.bootstrap||zn,declarations:n.declarations||zn,imports:n.imports||zn,exports:n.exports||zn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function bV(n,e){if(n==null)return Go;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=pp.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function wV(n){if(n==null)return Go;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function bn(n){return bu(()=>{let e=ZD(n);return XD(e),e})}function Cp(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function ZD(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Go,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||zn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:bV(n.inputs,e),outputs:wV(n.outputs),debugInfo:null}}function XD(n){n.features?.forEach(e=>e(n))}function IT(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function xV(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function SV(n){return Object.getPrototypeOf(n.prototype).constructor}function Tr(n){let e=SV(n.type),t=!0,i=[n];for(;e;){let r;if(br(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new pe(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=Ov(n.inputs),s.declaredInputs=Ov(n.declaredInputs),s.outputs=Ov(n.outputs);let a=r.hostBindings;a&&AV(n,a);let l=r.viewQuery,c=r.contentQueries;if(l&&CV(n,l),c&&DV(n,c),IV(n,r),pI(n.outputs,r.outputs),br(r)&&r.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Tr&&(t=!1)}}e=Object.getPrototypeOf(e)}TV(i)}function IV(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function TV(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=al(r.hostAttrs,t=al(t,r.hostAttrs))}}function Ov(n){return n===Go?{}:n===zn?[]:n}function CV(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function DV(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function AV(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function eA(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=al(n.mergedAttrs,n.attrs);let d=n.tView=k_(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),Qs(n,!1);let l=tA(t,e,n,i);Cf()&&B_(t,e,l,n),ll(l,e);let c=ID(l,e,l,n);e[i+dt]=c,F_(e,c),sV(c,n,e)}function MV(n,e,t,i,r,o,s,a,l,c,d){let h=t+dt,p;return e.firstCreatePass?(p=ml(e,h,4,s||null,a||null),lv()&&LD(e,n,p,Ai(e.consts,c),fD),GT(e,p)):p=e.data[h],eA(p,n,e,t,i,r,o,l),ru(p)&&H_(e,n,p),c!=null&&vp(n,p,d),p}function np(n,e,t,i,r,o,s,a,l,c,d){let h=t+dt,p;if(e.firstCreatePass){if(p=ml(e,h,4,s||null,a||null),c!=null){let g=Ai(e.consts,c);p.localNames=[];for(let S=0;S<g.length;S+=2)p.localNames.push(g[S],-1)}}else p=e.data[h];return eA(p,n,e,t,i,r,o,l),c!=null&&vp(n,p,d),p}function mi(n,e,t,i,r,o,s,a){let l=Ue(),c=Kt(),d=Ai(c.consts,o);return MV(l,c,n,e,t,i,r,d,void 0,s,a),mi}var tA=nA;function nA(n,e,t,i){return to(!0),e[Et].createComment("")}function RV(n,e,t,i){let r=!hp(e,t);to(r);let o=e[Jn]?.data[pC]?.[i]??null;if(o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o),r)return nA(n,e);let s=e[Jn],a=bp(s,n,e,t);dp(s,i,a);let l=D_(s,i);return wp(l,a)}function iA(){tA=RV}var fi=(function(n){return n[n.NOT_STARTED=0]="NOT_STARTED",n[n.IN_PROGRESS=1]="IN_PROGRESS",n[n.COMPLETE=2]="COMPLETE",n[n.FAILED=3]="FAILED",n})(fi||{}),TT=0,NV=1,un=(function(n){return n[n.Placeholder=0]="Placeholder",n[n.Loading=1]="Loading",n[n.Complete=2]="Complete",n[n.Error=3]="Error",n})(un||{});var PV=0,Mu=1;var kV=4,OV=5;var FV=7,sl=8,LV=9,X_=(function(n){return n[n.Manual=0]="Manual",n[n.Playthrough=1]="Playthrough",n})(X_||{});function Vf(n,e){let t=UV(n),i=e[t];if(i!==null){for(let r of i)r();e[t]=null}}function VV(n){Vf(1,n),Vf(0,n),Vf(2,n)}function UV(n){let e=kV;return n===1?e=OV:n===2&&(e=LV),e}function rA(n){return n+1}function vl(n,e){let t=n[Ce],i=rA(e.index);return n[i]}function Ru(n,e){let t=rA(e.index);return n.data[t]}function BV(n,e,t){let i=e[Ce],r=Ru(i,t);switch(n){case un.Complete:return r.primaryTmplIndex;case un.Loading:return r.loadingTmplIndex;case un.Error:return r.errorTmplIndex;case un.Placeholder:return r.placeholderTmplIndex;default:return null}}function CT(n,e){return e===un.Placeholder?n.placeholderBlockConfig?.[TT]??null:e===un.Loading?n.loadingBlockConfig?.[TT]??null:null}function jV(n){return n.loadingBlockConfig?.[NV]??null}function DT(n,e){if(!n||n.length===0)return e;let t=new Set(n);for(let i of e)t.add(i);return n.length===t.size?n:Array.from(t)}function HV(n,e){let t=e.primaryTmplIndex+dt;return Ys(n,t)}var $V=(()=>{class n{cachedInjectors=new Map;getOrCreateInjector(t,i,r,o){if(!this.cachedInjectors.has(t)){let s=r.length>0?yl(r,i,o):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=le({token:n,providedIn:"environment",factory:()=>new n})}return n})();var oA=new _e("");function Fv(n,e,t){return n.get($V).getOrCreateInjector(e,n,t,"")}function GV(n,e,t){if(n instanceof ol){let r=n.injector,o=n.parentInjector,s=Fv(o,e,t);return new ol(r,s)}let i=n.get(qt);if(i!==n){let r=Fv(i,e,t);return new ol(n,r)}return Fv(n,e,t)}function Js(n,e,t,i=!1){let r=t[Zt],o=r[Ce];if(Wo(r))return;let s=vl(r,e),a=s[Mu],l=s[FV];if(!(l!==null&&n<l)&&AT(a,n)&&AT(s[PV]??-1,n)){let c=Ru(o,e),h=!i&&!0&&(jV(c)!==null||CT(c,un.Loading)!==null||CT(c,un.Placeholder))?qV:WV;try{h(n,s,t,e,r)}catch(p){$_(r,p)}}}function zV(n,e){let t=n[Wi]?.findIndex(r=>r.data[vC]===e[Mu])??-1;return{dehydratedView:t>-1?n[Wi][t]:null,dehydratedViewIx:t}}function WV(n,e,t,i,r){gt(at.DeferBlockStateStart);let o=BV(n,r,i);if(o!==null){e[Mu]=n;let s=r[Ce],a=o+dt,l=Ys(s,a),c=0;W_(t,c);let d;if(n===un.Complete){let S=Ru(s,i),I=S.providers;I&&I.length>0&&(d=GV(r[ai],S,I))}let{dehydratedView:h,dehydratedViewIx:p}=zV(t,e),g=Cu(r,l,null,{injector:d,dehydratedView:h});if(Du(t,g,c,cl(l,h)),_p(g,2),p>-1&&t[Wi]?.splice(p,1),(n===un.Complete||n===un.Error)&&Array.isArray(e[sl])){for(let S of e[sl])S();e[sl]=null}}gt(at.DeferBlockStateEnd)}function AT(n,e){return n<e}function MT(n,e,t){n.loadingPromise.then(()=>{n.loadingState===fi.COMPLETE?Js(un.Complete,e,t):n.loadingState===fi.FAILED&&Js(un.Error,e,t)})}var qV=null;var Dp=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var eE=new _e("");function Zo(n){return!!n&&typeof n.then=="function"}function tE(n){return!!n&&typeof n.subscribe=="function"}var sA=new _e("");var nE=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=z(sA,{optional:!0})??[];injector=z(Wn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Pn(this.injector,r);if(Zo(o))t.push(o);else if(tE(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Xo=new _e("");function aA(){iy(()=>{let n="";throw new pe(600,n)})}function lA(n){return n.isBoundToModule}var KV=10;var Xn=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=z(hi);afterRenderManager=z(V_);zonelessEnabled=z(uu);rootEffectScheduler=z(Dv);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Bt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=z(wr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(vt(t=>!t))}constructor(){z(Jo,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=z(qt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Wn.NULL){return this._injector.get(mn).run(()=>{gt(at.BootstrapComponentStart);let s=t instanceof Ip;if(!this._injector.get(nE).done){let S="";throw new pe(405,S)}let l;s?l=t:l=this._injector.get(Au).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let c=lA(l)?void 0:this._injector.get(na),d=i||l.selector,h=l.create(r,[],d,c),p=h.location.nativeElement,g=h.injector.get(eE,null);return g?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),pu(this.components,h),g?.unregisterApplication(p)}),this._loadComponent(h),gt(at.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){gt(at.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(gp.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw gt(at.ChangeDetectionEnd),new pe(101,!1);let t=Ve(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Ve(t),this.afterTick.next(),gt(at.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ta,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<KV;){gt(at.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{gt(at.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!au(r))continue;let o=i&&!this.zonelessEnabled?0:1;bD(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>au(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;pu(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(Xo,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>pu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new pe(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pu(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function iE(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}function cA(n,e,t){let i=e[ai],r=e[Ce];if(n.loadingState!==fi.NOT_STARTED)return n.loadingPromise??Promise.resolve();let o=vl(e,t),s=HV(r,n);n.loadingState=fi.IN_PROGRESS,Vf(1,o);let a=n.dependencyResolverFn,l=i.get(du).add();return a?(n.loadingPromise=Promise.allSettled(a()).then(c=>{let d=!1,h=[],p=[];for(let g of c)if(g.status==="fulfilled"){let S=g.value,I=Zr(S)||hf(S);if(I)h.push(I);else{let P=$y(S);P&&p.push(P)}}else{d=!0;break}if(d){if(n.loadingState=fi.FAILED,n.errorTmplIndex===null){let S=new pe(-750,!1);$_(e,S)}}else{n.loadingState=fi.COMPLETE;let g=s.tView;if(h.length>0){g.directiveRegistry=DT(g.directiveRegistry,h);let S=h.map(P=>P.type),I=vf(!1,...S);n.providers=I}p.length>0&&(g.pipeRegistry=DT(g.pipeRegistry,p))}}),n.loadingPromise.finally(()=>{n.loadingPromise=null,l()})):(n.loadingPromise=Promise.resolve().then(()=>{n.loadingPromise=null,n.loadingState=fi.COMPLETE,l()}),n.loadingPromise)}function YV(n,e){return e[ai].get(oA,null,{optional:!0})?.behavior!==X_.Manual}function QV(n,e,t){let i=e[Ce],r=e[t.index];if(!YV(n,e))return;let o=vl(e,t),s=Ru(i,t);switch(VV(o),s.loadingState){case fi.NOT_STARTED:Js(un.Loading,t,r),cA(s,e,t),s.loadingState===fi.IN_PROGRESS&&MT(s,t,r);break;case fi.IN_PROGRESS:Js(un.Loading,t,r),MT(s,t,r);break;case fi.COMPLETE:Js(un.Complete,t,r);break;case fi.FAILED:Js(un.Error,t,r);break;default:}}async function uA(n,e,t){let i=n.get(cp);if(i.hydrating.has(e))return;let{parentBlockPromise:o,hydrationQueue:s}=YF(e,n);if(s.length===0)return;o!==null&&s.shift(),XV(i,s),o!==null&&await o;let a=s[0];i.has(a)?await RT(n,s,t):i.awaitParentBlock(a,async()=>await RT(n,s,t))}async function RT(n,e,t){let i=n.get(cp),r=i.hydrating,o=n.get(wr),s=o.add();for(let l=0;l<e.length;l++){let c=e[l],d=i.get(c);if(d!=null){if(await t5(d),await e5(n),JV(d)){DL(d),NT(e.slice(l),i);break}r.get(c).resolve()}else{ZV(l,e,i),NT(e.slice(l),i);break}}let a=e[e.length-1];await r.get(a)?.promise,o.remove(s),t&&t(e),AL(i.get(a),e,i,n.get(Xn))}function JV(n){return vl(n.lView,n.tNode)[Mu]===un.Error}function ZV(n,e,t){let i=n-1,r=i>-1?t.get(e[i]):null;r&&Sp(r.lContainer)}function NT(n,e){let t=e.hydrating;for(let i in n)t.get(i)?.reject();e.cleanup(n)}function XV(n,e){for(let t of e)n.hydrating.set(t,iE())}function e5(n){return new Promise(e=>Tu(e,{injector:n}))}async function t5(n){let{tNode:e,lView:t}=n,i=vl(t,e);return new Promise(r=>{n5(i,r),QV(2,t,e)})}function n5(n,e){Array.isArray(n[sl])||(n[sl]=[]),n[sl].push(e)}function Lt(n,e,t,i){let r=Ue(),o=qo();if(pi(r,o,e)){let s=Kt(),a=Tf();Q3(a,r,n,e,t,i)}return Lt}var Ete=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var l_=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function Lv(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function i5(n,e,t,i){let r,o,s=0,a=n.length-1,l=void 0;if(Array.isArray(e)){Ve(i);let c=e.length-1;for(Ve(null);s<=a&&s<=c;){let d=n.at(s),h=e[s],p=Lv(s,d,s,h,t);if(p!==0){p<0&&n.updateValue(s,h),s++;continue}let g=n.at(a),S=e[c],I=Lv(a,g,c,S,t);if(I!==0){I<0&&n.updateValue(a,S),a--,c--;continue}let P=t(s,d),U=t(a,g),oe=t(s,h);if(Object.is(oe,U)){let Se=t(c,S);Object.is(Se,P)?(n.swap(s,a),n.updateValue(a,S),c--,a--):n.move(a,s),n.updateValue(s,h),s++;continue}if(r??=new ip,o??=kT(n,s,a,t),c_(n,r,s,oe))n.updateValue(s,h),s++,a++;else if(o.has(oe))r.set(P,n.detach(s)),a--;else{let Se=n.create(s,e[s]);n.attach(s,Se),s++,a++}}for(;s<=c;)PT(n,r,t,s,e[s]),s++}else if(e!=null){Ve(i);let c=e[Symbol.iterator]();Ve(null);let d=c.next();for(;!d.done&&s<=a;){let h=n.at(s),p=d.value,g=Lv(s,h,s,p,t);if(g!==0)g<0&&n.updateValue(s,p),s++,d=c.next();else{r??=new ip,o??=kT(n,s,a,t);let S=t(s,p);if(c_(n,r,s,S))n.updateValue(s,p),s++,a++,d=c.next();else if(!o.has(S))n.attach(s,n.create(s,p)),s++,a++,d=c.next();else{let I=t(s,h);r.set(I,n.detach(s)),a--}}}for(;!d.done;)PT(n,r,t,n.length,d.value),d=c.next()}for(;s<=a;)n.destroy(n.detach(a--));r?.forEach(c=>{n.destroy(c)})}function c_(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function PT(n,e,t,i,r){if(c_(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function kT(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var ip=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function Y(n,e,t,i,r,o,s,a){gi("NgControlFlow");let l=Ue(),c=Kt(),d=Ai(c.consts,o);return np(l,c,n,e,t,i,r,d,256,s,a),rE}function rE(n,e,t,i,r,o,s,a){gi("NgControlFlow");let l=Ue(),c=Kt(),d=Ai(c.consts,o);return np(l,c,n,e,t,i,r,d,512,s,a),rE}function Q(n,e){gi("NgControlFlow");let t=Ue(),i=qo(),r=t[i]!==En?t[i]:-1,o=r!==-1?rp(t,dt+r):void 0,s=0;if(pi(t,i,n)){let a=Ve(null);try{if(o!==void 0&&W_(o,s),n!==-1){let l=dt+n,c=rp(t,l),d=f_(t[Ce],l),h=PD(c,d,t),p=Cu(t,d,e,{dehydratedView:h});Du(c,p,s,cl(d,h))}}finally{Ve(a)}}else if(o!==void 0){let a=TD(o,s);a!==void 0&&(a[Xt]=e)}}var u_=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-$t}};function Nu(n){return n}function Cr(n,e){return e}var d_=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function wn(n,e,t,i,r,o,s,a,l,c,d,h,p){gi("NgControlFlow");let g=Ue(),S=Kt(),I=l!==void 0,P=Ue(),U=a?s.bind(P[Kn][Xt]):s,oe=new d_(I,U);P[dt+n]=oe,np(g,S,n+1,e,t,i,r,Ai(S.consts,o),256),I&&np(g,S,n+2,l,c,d,h,Ai(S.consts,p),512)}var h_=class extends l_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-$t}at(e){return this.getLView(e)[Xt].$implicit}attach(e,t){let i=t[Jn];this.needsIndexUpdate||=e!==this.length,Du(this.lContainer,t,e,cl(this.templateTNode,i)),r5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,o5(this.lContainer,e),s5(this.lContainer,e)}create(e,t){let i=Qf(this.lContainer,this.templateTNode.tView.ssrId);return Cu(this.hostLView,this.templateTNode,new u_(this.lContainer,t,e),{dehydratedView:i})}destroy(e){mp(e[Ce],e)}updateValue(e,t){this.getLView(e)[Xt].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Xt].$index=e}getLView(e){return a5(this.lContainer,e)}};function xn(n){let e=Ve(null),t=Mi();try{let i=Ue(),r=i[Ce],o=i[t],s=t+1,a=rp(i,s);if(o.liveCollection===void 0){let c=f_(r,s);o.liveCollection=new h_(a,i,c)}else o.liveCollection.reset();let l=o.liveCollection;if(i5(l,n,o.trackByFn,e),l.updateIndexes(),o.hasEmptyBlock){let c=qo(),d=l.length===0;if(pi(i,c,d)){let h=t+2,p=rp(i,h);if(d){let g=f_(r,h),S=PD(p,g,i),I=Cu(i,g,void 0,{dehydratedView:S});Du(p,I,0,cl(g,S))}else r.firstUpdatePass&&xp(p),W_(p,0)}}}finally{Ve(e)}}function rp(n,e){return n[e]}function r5(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t],r=i?i[Ws]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[ai];I3(o,r),ea.delete(i[Xr]),r.detachedLeaveAnimationFns=void 0}}function o5(n,e){if(n.length<=$t)return;let t=$t+e,i=n[t],r=i?i[Ws]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function s5(n,e){return vu(n,e)}function a5(n,e){return TD(n,e)}function f_(n,e){return Ys(n,e)}function $e(n,e,t){let i=Ue(),r=qo();if(pi(i,r,e)){let o=Kt(),s=Tf();z3(s,i,n,e,i[Et],t)}return $e}function p_(n,e,t,i,r){G_(e,n,t,r?"class":"style",i)}function E(n,e,t,i){let r=Ue(),o=r[Ce],s=n+dt,a=o.firstCreatePass?UD(s,r,2,e,fD,lv(),t,i):o.data[s];if(pD(a,r,n,e,oE),ru(a)){let l=r[Ce];H_(l,r,a),HC(l,a,r)}return i!=null&&vp(r,a),E}function x(){let n=Kt(),e=Ln(),t=gD(e);return n.firstCreatePass&&BD(n,t),uv(t)&&dv(),av(),t.classesWithoutHost!=null&&yF(t)&&p_(n,t,Ue(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&vF(t)&&p_(n,t,Ue(),t.stylesWithoutHost,!1),x}function K(n,e,t,i){return E(n,e,t,i),x(),K}function b(n,e,t,i){let r=Ue(),o=r[Ce],s=n+dt,a=o.firstCreatePass?GL(s,o,2,e,t,i):o.data[s];return pD(a,r,n,e,oE),i!=null&&vp(r,a),b}function T(){let n=Ln(),e=gD(n);return uv(e)&&dv(),av(),T}function B(n,e,t,i){return b(n,e,t,i),T(),B}var oE=(n,e,t,i,r)=>(to(!0),M_(e[Et],i,bv()));function l5(n,e,t,i,r){let o=!hp(e,t);if(to(o),o)return M_(e[Et],i,bv());let s=e[Jn],a=bp(s,n,e,t);return VC(s,r)&&dp(s,r,a.nextSibling),s&&(iC(t)||rC(a))&&eo(t)&&(LI(t),qC(a)),a}function dA(){oE=l5}var c5=(n,e,t,i,r)=>(to(!0),zC(e[Et],""));function u5(n,e,t,i,r){let o,s=!hp(e,t);if(to(s),s)return zC(e[Et],"");let a=e[Jn],l=bp(a,n,e,t),c=qF(a,r);return dp(a,r,l),o=wp(c,l),o}function hA(){c5=u5}function Je(){return Ue()}function aa(n,e,t){let i=Ue(),r=qo();if(pi(i,r,e)){let o=Kt(),s=Tf();hD(s,i,n,e,i[Et],t)}return aa}var hu=void 0;function d5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var h5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],hu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],hu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",hu,hu,hu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",d5],Vv={};function yi(n){let e=f5(n),t=OT(e);if(t)return t;let i=e.split("-")[0];if(t=OT(i),t)return t;if(i==="en")return h5;throw new pe(701,!1)}function OT(n){return n in Vv||(Vv[n]=pr.ng&&pr.ng.common&&pr.ng.common.locales&&pr.ng.common.locales[n]),Vv[n]}var en=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(en||{});function f5(n){return n.toLowerCase().replace(/_/g,"-")}var Pu="en-US";var p5=Pu;function fA(n){typeof n=="string"&&(p5=n.toLowerCase().replace(/_/g,"-"))}function ce(n,e,t){let i=Ue(),r=Kt(),o=Ln();return g5(r,i,i[Et],o,n,e,t),ce}function et(n,e,t){let i=Ue(),r=Kt(),o=Ln();return(o.type&3||t)&&$D(o,r,i,t,i[Et],n,e,Lf(o,i,e)),et}function g5(n,e,t,i,r,o,s){let a=!0,l=null;if((i.type&3||s)&&(l??=Lf(i,e,o),$D(i,n,e,s,t,r,o,l)&&(a=!1)),a){let c=i.outputs?.[r],d=i.hostDirectiveOutputs?.[r];if(d&&d.length)for(let h=0;h<d.length;h+=2){let p=d[h],g=d[h+1];l??=Lf(i,e,o),wT(i,e,p,g,r,l)}if(c&&c.length)for(let h of c)l??=Lf(i,e,o),wT(i,e,h,r,r,l)}}function O(n=1){return KI(n)}function _l(n,e,t){return gV(n,e,t),_l}function El(n){let e=Ue(),t=Kt(),i=vv();xf(i+1);let r=Z_(t,i);if(n.dirty&&MI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=vV(e,i);n.reset(o,RF),n.notifyOnChanges()}return!0}return!1}function bl(){return fV(Ue(),vv())}function ku(n){let e=pv();return ou(e,dt+n)}function Rf(n,e){return n<<17|e<<2}function ia(n){return n>>17&32767}function m5(n){return(n&2)==2}function y5(n,e){return n&131071|e<<17}function g_(n){return n|2}function dl(n){return(n&131068)>>2}function Uv(n,e){return n&-131069|e<<2}function v5(n){return(n&1)===1}function m_(n){return n|1}function _5(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=ia(s),l=dl(s);n[i]=t;let c=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||Xa(h,d)>0)&&(c=!0)}else d=t;if(r)if(l!==0){let p=ia(n[a+1]);n[i+1]=Rf(p,a),p!==0&&(n[p+1]=Uv(n[p+1],i)),n[a+1]=y5(n[a+1],i)}else n[i+1]=Rf(a,0),a!==0&&(n[a+1]=Uv(n[a+1],i)),a=i;else n[i+1]=Rf(l,0),a===0?a=i:n[l+1]=Uv(n[l+1],i),l=i;c&&(n[i+1]=g_(n[i+1])),FT(n,d,i,!0),FT(n,d,i,!1),E5(e,d,n,i,o),s=Rf(a,l),o?e.classBindings=s:e.styleBindings=s}function E5(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Xa(o,e)>=0&&(t[i+1]=m_(t[i+1]))}function FT(n,e,t,i){let r=n[t+1],o=e===null,s=i?ia(r):dl(r),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];b5(l,e)&&(a=!0,n[s+1]=i?m_(c):g_(c)),s=i?ia(c):dl(c)}a&&(n[t+1]=i?g_(r):m_(r))}function b5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Xa(n,e)>=0:!1}var Ki={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function w5(n){return n.substring(Ki.key,Ki.keyEnd)}function x5(n){return S5(n),pA(n,gA(n,0,Ki.textEnd))}function pA(n,e){let t=Ki.textEnd;return t===e?-1:(e=Ki.keyEnd=I5(n,Ki.key=e,t),gA(n,e,t))}function S5(n){Ki.key=0,Ki.keyEnd=0,Ki.value=0,Ki.valueEnd=0,Ki.textEnd=n.length}function gA(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function I5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function rt(n,e,t){return mA(n,e,t,!1),rt}function Pe(n,e){return mA(n,e,null,!0),Pe}function sE(n){C5(P5,T5,n,!0)}function T5(n,e){for(let t=x5(e);t>=0;t=pA(e,t))mf(n,w5(e),!0)}function mA(n,e,t,i){let r=Ue(),o=Kt(),s=cu(2);if(o.firstUpdatePass&&vA(o,n,s,i),e!==En&&pi(r,s,e)){let a=o.data[Mi()];_A(o,a,r,r[Et],n,r[s+1]=O5(e,t),i,s)}}function C5(n,e,t,i){let r=Kt(),o=cu(2);r.firstUpdatePass&&vA(r,null,o,i);let s=Ue();if(t!==En&&pi(s,o,t)){let a=r.data[Mi()];if(EA(a,i)&&!yA(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=uf(l,t||"")),p_(r,a,s,t,i)}else k5(r,a,s,s[Et],s[o+1],s[o+1]=N5(n,e,t),i,o)}}function yA(n,e){return e>=n.expandoStartIndex}function vA(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Mi()],s=yA(n,t);EA(o,i)&&e===null&&!s&&(e=!1),e=D5(r,o,e,i),_5(r,o,e,t,s,i)}}function D5(n,e,t,i){let r=GI(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Bv(null,n,e,t,i),t=Eu(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Bv(r,n,e,t,i),o===null){let l=A5(n,e,i);l!==void 0&&Array.isArray(l)&&(l=Bv(null,n,e,l[1],i),l=Eu(l,e.attrs,i),M5(n,e,i,l))}else o=R5(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function A5(n,e,t){let i=t?e.classBindings:e.styleBindings;if(dl(i)!==0)return n[ia(i)]}function M5(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[ia(r)]=i}function R5(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=Eu(i,s,t)}return Eu(i,e.attrs,t)}function Bv(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=Eu(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function Eu(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),mf(n,s,t?!0:e[++o]))}return n===void 0?null:n}function N5(n,e,t){if(t==null||t==="")return zn;let i=[],r=gl(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(r instanceof Set)for(let o of r)n(i,o,!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function P5(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&mf(n,i,t)}function k5(n,e,t,i,r,o,s,a){r===En&&(r=zn);let l=0,c=0,d=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;d!==null||h!==null;){let p=l<r.length?r[l+1]:void 0,g=c<o.length?o[c+1]:void 0,S=null,I;d===h?(l+=2,c+=2,p!==g&&(S=h,I=g)):h===null||d!==null&&d<h?(l+=2,S=d):(c+=2,S=h,I=g),S!==null&&_A(n,e,t,i,S,I,s,a),d=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}function _A(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],d=v5(c)?LT(l,e,t,r,dl(c),s):void 0;if(!op(d)){op(o)||m5(c)&&(o=LT(l,null,t,r,a,s));let h=tv(Mi(),t);B3(i,s,h,r,o)}}function LT(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let l=n[r],c=Array.isArray(l),d=c?l[1]:l,h=d===null,p=t[r+1];p===En&&(p=h?zn:void 0);let g=h?yf(p,i):d===i?p:void 0;if(c&&!op(g)&&(g=yf(l,i)),op(g)&&(a=g,s))return a;let S=n[r+1];r=s?ia(S):dl(S)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=yf(l,i))}return a}function op(n){return n!==void 0}function O5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Qr(gl(n)))),n}function EA(n,e){return(n.flags&(e?8:16))!==0}function v(n,e=""){let t=Ue(),i=Kt(),r=n+dt,o=i.firstCreatePass?ml(i,r,1,e,null):i.data[r],s=bA(i,t,o,e,n);t[r]=s,Cf()&&B_(i,t,s,o),Qs(o,!1)}var bA=(n,e,t,i,r)=>(to(!0),GC(e[Et],i));function F5(n,e,t,i,r){let o=!hp(e,t);if(to(o),o)return GC(e[Et],i);let s=e[Jn];return bp(s,n,e,t)}function wA(){bA=F5}function L5(n,e,t,i=""){return pi(n,qo(),t)?e+zi(t)+i:En}function V5(n,e,t,i,r,o=""){let s=yv(),a=Q_(n,s,t,r);return cu(2),a?e+zi(t)+i+zi(r)+o:En}function U5(n,e,t,i,r,o,s,a=""){let l=yv(),c=WL(n,l,t,r,s);return cu(3),c?e+zi(t)+i+zi(r)+o+zi(s)+a:En}function W(n){return H("",n),W}function H(n,e,t){let i=Ue(),r=L5(i,n,e,t);return r!==En&&aE(i,Mi(),r),H}function tn(n,e,t,i,r){let o=Ue(),s=V5(o,n,e,t,i,r);return s!==En&&aE(o,Mi(),s),tn}function es(n,e,t,i,r,o,s){let a=Ue(),l=U5(a,n,e,t,i,r,o,s);return l!==En&&aE(a,Mi(),l),es}function aE(n,e,t){let i=tv(e,n);n3(n[Et],i,t)}var xA={};function wl(n){gi("NgLet");let e=Kt(),t=Ue(),i=n+dt,r=ml(e,i,128,null,null);return Qs(r,!1),su(e,t,i,xA),wl}function Ou(n){let e=Kt(),t=Ue(),i=Mi();return su(e,t,i,n),n}function Dr(n){let e=pv(),t=ou(e,dt+n);if(t===xA)throw new pe(314,!1);return t}function lE(n){return pi(Ue(),qo(),n)?zi(n):En}function VT(n,e,t){let i=Kt();i.firstCreatePass&&SA(e,i.data,i.blueprint,br(n),t)}function SA(n,e,t,i,r){if(n=Nn(n),Array.isArray(n))for(let o=0;o<n.length;o++)SA(n[o],e,t,i,r);else{let o=Kt(),s=Ue(),a=Ln(),l=Bs(n)?n:Nn(n.provide),c=Qy(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(Bs(n)||!n.multi){let g=new Xs(c,r,ge,null),S=Hv(l,e,r?d:d+p,h);S===-1?(Gv($f(a,s),o,l),jv(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)):(t[S]=g,s[S]=g)}else{let g=Hv(l,e,d+p,h),S=Hv(l,e,d,d+p),I=g>=0&&t[g],P=S>=0&&t[S];if(r&&!P||!r&&!I){Gv($f(a,s),o,l);let U=H5(r?j5:B5,t.length,r,i,c,n);!r&&P&&(t[S].providerFactory=U),jv(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(U),s.push(U)}else{let U=IA(t[r?S:g],c,!r&&i);jv(o,n,g>-1?g:S,U)}!r&&i&&P&&t[S].componentProviders++}}}function jv(n,e,t,i){let r=Bs(e),o=TI(e);if(r||o){let l=(o?Nn(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function IA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Hv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function B5(n,e,t,i,r){return y_(this.multi,[])}function j5(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=gu(i,i[Ce],this.providerFactory.index,r);s=l.slice(0,a),y_(o,s);for(let c=a;c<l.length;c++)s.push(l[c])}else s=[],y_(o,s);return s}function y_(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function H5(n,e,t,i,r,o){let s=new Xs(n,t,ge,null);return s.multi=[],s.index=e,s.componentProviders=0,IA(s,r,i&&!t),s}function Fu(n,e){return t=>{t.providersResolver=(i,r)=>VT(i,r?r(n):n,!1),e&&(t.viewProvidersResolver=(i,r)=>VT(i,r?r(e):e,!0))}}function la(n,e){let t=lu()+n,i=Ue();return i[t]===En?Y_(i,t,e()):zL(i,t)}function bt(n,e,t,i){return CA(Ue(),lu(),n,e,t,i)}function TA(n,e){let t=n[e];return t===En?void 0:t}function $5(n,e,t,i,r,o){let s=e+t;return pi(n,s,r)?Y_(n,s+1,o?i.call(o,r):i(r)):TA(n,s+1)}function CA(n,e,t,i,r,o,s){let a=e+t;return Q_(n,a,r,o)?Y_(n,a+2,s?i.call(s,r,o):i(r,o)):TA(n,a+2)}function Ar(n,e){let t=Kt(),i,r=n+dt;t.firstCreatePass?(i=G5(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Bo(i.type,!0)),s,a=Gn(ge);try{let l=Hf(!1),c=o();return Hf(l),su(t,Ue(),r,c),c}finally{Gn(a)}}function G5(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function cE(n,e,t){let i=n+dt,r=Ue(),o=ou(r,i);return DA(r,i)?$5(r,lu(),e,o.transform,t,o):o.transform(t)}function oo(n,e,t,i){let r=n+dt,o=Ue(),s=ou(o,r);return DA(o,r)?CA(o,lu(),e,s.transform,t,i,s):s.transform(t,i)}function DA(n,e){return n[Ce].data[e].pure}function uE(n,e){return Ep(n,e)}var sp=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},dE=(()=>{class n{compileModuleSync(t){return new tp(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=Hy(t),o=ZC(r.declarations).reduce((s,a)=>{let l=Zr(a);return l&&s.push(new ul(l)),s},[]);return new sp(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var AA=(()=>{class n{applicationErrorHandler=z(hi);appRef=z(Xn);taskService=z(wr);ngZone=z(mn);zonelessEnabled=z(uu);tracing=z(Jo,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new gn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Qc):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(z(Cv,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?ZI:xv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Qc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.applicationErrorHandler(i)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function MA(){return[{provide:Ho,useExisting:AA},{provide:mn,useClass:Jc},{provide:uu,useValue:!0}]}function z5(){return typeof $localize<"u"&&$localize.locale||Pu}var Lu=new _e("",{factory:()=>z(Lu,{optional:!0,skipSelf:!0})||z5()});function ei(n,e){return Dh(n,e?.equal)}var mE={JSACTION:"__jsaction",OWNER:"__owner"},kA={};function W5(n){return n[mE.JSACTION]}function RA(n,e){n[mE.JSACTION]=e}function q5(n){return kA[n]}function K5(n,e){kA[n]=e}var ke={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},Y5=[ke.MOUSEENTER,ke.MOUSELEAVE,"pointerenter","pointerleave"],Tte=[ke.CLICK,ke.DBLCLICK,ke.FOCUSIN,ke.FOCUSOUT,ke.KEYDOWN,ke.KEYUP,ke.KEYPRESS,ke.MOUSEOVER,ke.MOUSEOUT,ke.SUBMIT,ke.TOUCHSTART,ke.TOUCHEND,ke.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],Q5=[ke.FOCUS,ke.BLUR,ke.ERROR,ke.LOAD,ke.TOGGLE],yE=n=>Q5.indexOf(n)>=0;function J5(n){return n===ke.MOUSEENTER?ke.MOUSEOVER:n===ke.MOUSELEAVE?ke.MOUSEOUT:n===ke.POINTERENTER?ke.POINTEROVER:n===ke.POINTERLEAVE?ke.POINTEROUT:n}function Z5(n,e,t,i){let r=!1;yE(e)&&(r=!0);let o=typeof i=="boolean"?{capture:r,passive:i}:r;return n.addEventListener(e,t,o),{eventType:e,handler:t,capture:r,passive:i}}function X5(n,e){if(n.removeEventListener){let t=typeof e.passive=="boolean"?{capture:e.capture}:e.capture;n.removeEventListener(e.eventType,e.handler,t)}else n.detachEvent&&n.detachEvent(`on${e.eventType}`,e.handler)}function eU(n){n.preventDefault?n.preventDefault():n.returnValue=!1}var NA=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);function tU(n){return n.which===2||n.which==null&&n.button===4}function nU(n){return NA&&n.metaKey||!NA&&n.ctrlKey||tU(n)||n.shiftKey}function iU(n,e,t){let i=n.relatedTarget;return(n.type===ke.MOUSEOVER&&e===ke.MOUSEENTER||n.type===ke.MOUSEOUT&&e===ke.MOUSELEAVE||n.type===ke.POINTEROVER&&e===ke.POINTERENTER||n.type===ke.POINTEROUT&&e===ke.POINTERLEAVE)&&(!i||i!==t&&!t.contains(i))}function rU(n,e){let t={};for(let i in n){if(i==="srcElement"||i==="target")continue;let r=i,o=n[r];typeof o!="function"&&(t[r]=o)}return n.type===ke.MOUSEOVER?t.type=ke.MOUSEENTER:n.type===ke.MOUSEOUT?t.type=ke.MOUSELEAVE:n.type===ke.POINTEROVER?t.type=ke.POINTERENTER:t.type=ke.POINTERLEAVE,t.target=t.srcElement=e,t.bubbles=!1,t._originalEvent=n,t}var oU=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent),Np=class{element;handlerInfos=[];constructor(e){this.element=e}addEventListener(e,t,i){oU&&(this.element.style.cursor="pointer"),this.handlerInfos.push(Z5(this.element,e,t(this.element),i))}cleanUp(){for(let e=0;e<this.handlerInfos.length;e++)X5(this.element,this.handlerInfos[e]);this.handlerInfos=[]}},sU={NAMESPACE_ACTION_SEPARATOR:".",EVENT_ACTION_SEPARATOR:":"};function ts(n){return n.eventType}function vE(n,e){n.eventType=e}function Mp(n){return n.event}function OA(n,e){n.event=e}function FA(n){return n.targetElement}function LA(n,e){n.targetElement=e}function VA(n){return n.eic}function aU(n,e){n.eic=e}function lU(n){return n.timeStamp}function cU(n,e){n.timeStamp=e}function Rp(n){return n.eia}function UA(n,e,t){n.eia=[e,t]}function hE(n){n.eia=void 0}function Ap(n){return n[1]}function uU(n){return n.eirp}function BA(n,e){n.eirp=e}function jA(n){return n.eir}function HA(n,e){n.eir=e}function $A(n){return{eventType:n.eventType,event:n.event,targetElement:n.targetElement,eic:n.eic,eia:n.eia,timeStamp:n.timeStamp,eirp:n.eirp,eiack:n.eiack,eir:n.eir}}function dU(n,e,t,i,r,o,s,a){return{eventType:n,event:e,targetElement:t,eic:i,timeStamp:r,eia:o,eirp:s,eiack:a}}var fE=class n{eventInfo;constructor(e){this.eventInfo=e}getEventType(){return ts(this.eventInfo)}setEventType(e){vE(this.eventInfo,e)}getEvent(){return Mp(this.eventInfo)}setEvent(e){OA(this.eventInfo,e)}getTargetElement(){return FA(this.eventInfo)}setTargetElement(e){LA(this.eventInfo,e)}getContainer(){return VA(this.eventInfo)}setContainer(e){aU(this.eventInfo,e)}getTimestamp(){return lU(this.eventInfo)}setTimestamp(e){cU(this.eventInfo,e)}getAction(){let e=Rp(this.eventInfo);if(e)return{name:e[0],element:e[1]}}setAction(e){if(!e){hE(this.eventInfo);return}UA(this.eventInfo,e.name,e.element)}getIsReplay(){return uU(this.eventInfo)}setIsReplay(e){BA(this.eventInfo,e)}getResolved(){return jA(this.eventInfo)}setResolved(e){HA(this.eventInfo,e)}clone(){return new n($A(this.eventInfo))}},hU={},fU=/\s*;\s*/,pU=ke.CLICK,pE=class{a11yClickSupport=!1;clickModSupport=!0;syntheticMouseEventSupport;updateEventInfoForA11yClick=void 0;preventDefaultForA11yClick=void 0;populateClickOnlyAction=void 0;constructor({syntheticMouseEventSupport:e=!1,clickModSupport:t=!0}={}){this.syntheticMouseEventSupport=e,this.clickModSupport=t}resolveEventType(e){this.clickModSupport&&ts(e)===ke.CLICK&&nU(Mp(e))?vE(e,ke.CLICKMOD):this.a11yClickSupport&&this.updateEventInfoForA11yClick(e)}resolveAction(e){jA(e)||(this.populateAction(e,FA(e)),HA(e,!0))}resolveParentAction(e){let t=Rp(e),i=t&&Ap(t);hE(e);let r=i&&this.getParentNode(i);r&&this.populateAction(e,r)}populateAction(e,t){let i=t;for(;i&&i!==VA(e)&&(i.nodeType===Node.ELEMENT_NODE&&this.populateActionOnElement(i,e),!Rp(e));)i=this.getParentNode(i);let r=Rp(e);if(r&&(this.a11yClickSupport&&this.preventDefaultForA11yClick(e),this.syntheticMouseEventSupport&&(ts(e)===ke.MOUSEENTER||ts(e)===ke.MOUSELEAVE||ts(e)===ke.POINTERENTER||ts(e)===ke.POINTERLEAVE)))if(iU(Mp(e),ts(e),Ap(r))){let o=rU(Mp(e),Ap(r));OA(e,o),LA(e,Ap(r))}else hE(e)}getParentNode(e){let t=e[mE.OWNER];if(t)return t;let i=e.parentNode;return i?.nodeName==="#document-fragment"?i?.host??null:i}populateActionOnElement(e,t){let i=this.parseActions(e),r=i[ts(t)];r!==void 0&&UA(t,r,e),this.a11yClickSupport&&this.populateClickOnlyAction(e,t,i)}parseActions(e){let t=W5(e);if(!t){let i=e.getAttribute(Af.JSACTION);if(!i)t=hU,RA(e,t);else{if(t=q5(i),!t){t={};let r=i.split(fU);for(let o=0;o<r.length;o++){let s=r[o];if(!s)continue;let a=s.indexOf(sU.EVENT_ACTION_SEPARATOR),l=a!==-1,c=l?s.substr(0,a).trim():pU,d=l?s.substr(a+1).trim():s;t[c]=d}K5(i,t)}RA(e,t)}}return t}addA11yClickSupport(e,t,i){this.a11yClickSupport=!0,this.updateEventInfoForA11yClick=e,this.preventDefaultForA11yClick=t,this.populateClickOnlyAction=i}},GA=(function(n){return n[n.I_AM_THE_JSACTION_FRAMEWORK=0]="I_AM_THE_JSACTION_FRAMEWORK",n})(GA||{}),gE=class{dispatchDelegate;actionResolver;eventReplayer;eventReplayScheduled=!1;replayEventInfoWrappers=[];constructor(e,{actionResolver:t,eventReplayer:i}={}){this.dispatchDelegate=e,this.actionResolver=t,this.eventReplayer=i}dispatch(e){let t=new fE(e);this.actionResolver?.resolveEventType(e),this.actionResolver?.resolveAction(e);let i=t.getAction();if(i&&gU(i.element,t)&&eU(t.getEvent()),this.eventReplayer&&t.getIsReplay()){this.scheduleEventInfoWrapperReplay(t);return}this.dispatchDelegate(t)}scheduleEventInfoWrapperReplay(e){this.replayEventInfoWrappers.push(e),!this.eventReplayScheduled&&(this.eventReplayScheduled=!0,Promise.resolve().then(()=>{this.eventReplayScheduled=!1,this.eventReplayer(this.replayEventInfoWrappers)}))}};function gU(n,e){return n.tagName==="A"&&(e.getEventType()===ke.CLICK||e.getEventType()===ke.CLICKMOD)}var zA=Symbol.for("propagationStopped"),_E={REPLAY:101};var mU="`preventDefault` called during event replay.";var yU="`composedPath` called during event replay.",Pp=class{dispatchDelegate;clickModSupport;actionResolver;dispatcher;constructor(e,t=!0){this.dispatchDelegate=e,this.clickModSupport=t,this.actionResolver=new pE({clickModSupport:t}),this.dispatcher=new gE(i=>{this.dispatchToDelegate(i)},{actionResolver:this.actionResolver})}dispatch(e){this.dispatcher.dispatch(e)}dispatchToDelegate(e){for(e.getIsReplay()&&EU(e),vU(e);e.getAction();){if(bU(e),yE(e.getEventType())&&e.getAction().element!==e.getTargetElement()||(this.dispatchDelegate(e.getEvent(),e.getAction().name),_U(e)))return;this.actionResolver.resolveParentAction(e.eventInfo)}}};function vU(n){let e=n.getEvent(),t=n.getEvent().stopPropagation.bind(e),i=()=>{e[zA]=!0,t()};ca(e,"stopPropagation",i),ca(e,"stopImmediatePropagation",i)}function _U(n){return!!n.getEvent()[zA]}function EU(n){let e=n.getEvent(),t=n.getTargetElement(),i=e.preventDefault.bind(e);ca(e,"target",t),ca(e,"eventPhase",_E.REPLAY),ca(e,"preventDefault",()=>{throw i(),new Error(mU+"")}),ca(e,"composedPath",()=>{throw new Error(yU+"")})}function bU(n){let e=n.getEvent(),t=n.getAction()?.element;t&&ca(e,"currentTarget",t,{configurable:!0})}function ca(n,e,t,{configurable:i=!1}={}){Object.defineProperty(n,e,{value:t,configurable:i})}function WA(n,e){n.ecrd(t=>{e.dispatch(t)},GA.I_AM_THE_JSACTION_FRAMEWORK)}function wU(n){return n?.q??[]}function xU(n){n&&(PA(n.c,n.et,n.h),PA(n.c,n.etc,n.h,!0))}function PA(n,e,t,i){for(let r=0;r<e.length;r++)n.removeEventListener(e[r],t,i)}var SU=!1,qA=(()=>{class n{static MOUSE_SPECIAL_SUPPORT=SU;containerManager;eventHandlers={};browserEventTypeToExtraEventTypes={};dispatcher=null;queuedEventInfos=[];constructor(t){this.containerManager=t}handleEvent(t,i,r){let o=dU(t,i,i.target,r,Date.now());this.handleEventInfo(o)}handleEventInfo(t){if(!this.dispatcher){BA(t,!0),this.queuedEventInfos?.push(t);return}this.dispatcher(t)}addEvent(t,i,r){if(t in this.eventHandlers||!this.containerManager||!n.MOUSE_SPECIAL_SUPPORT&&Y5.indexOf(t)>=0)return;let o=(a,l,c)=>{this.handleEvent(a,l,c)};this.eventHandlers[t]=o;let s=J5(i||t);if(s!==t){let a=this.browserEventTypeToExtraEventTypes[s]||[];a.push(t),this.browserEventTypeToExtraEventTypes[s]=a}this.containerManager.addEventListener(s,a=>l=>{o(t,l,a)},r)}replayEarlyEvents(t=window._ejsa){t&&(this.replayEarlyEventInfos(t.q),xU(t),delete window._ejsa)}replayEarlyEventInfos(t){for(let i=0;i<t.length;i++){let r=t[i],o=this.getEventTypesForBrowserEventType(r.eventType);for(let s=0;s<o.length;s++){let a=$A(r);vE(a,o[s]),this.handleEventInfo(a)}}}getEventTypesForBrowserEventType(t){let i=[];return this.eventHandlers[t]&&i.push(t),this.browserEventTypeToExtraEventTypes[t]&&i.push(...this.browserEventTypeToExtraEventTypes[t]),i}handler(t){return this.eventHandlers[t]}cleanUp(){this.containerManager?.cleanUp(),this.containerManager=null,this.eventHandlers={},this.browserEventTypeToExtraEventTypes={},this.dispatcher=null,this.queuedEventInfos=[]}registerDispatcher(t,i){this.ecrd(t,i)}ecrd(t,i){if(this.dispatcher=t,this.queuedEventInfos?.length){for(let r=0;r<this.queuedEventInfos.length;r++)this.handleEventInfo(this.queuedEventInfos[r]);this.queuedEventInfos=null}}}return n})();function KA(n,e=window){return wU(e._ejsas?.[n])}function EE(n,e=window){e._ejsas&&(e._ejsas[n]=void 0)}var rM=Symbol("InputSignalNode#UNSET"),ZU=fe(F({},Ah),{transformFn:void 0,applyValueToInputSignal(n,e){Bc(n,e)}});function oM(n,e){let t=Object.create(ZU);t.value=n,t.transformFn=e?.transform;function i(){if(Lc(t),t.value===rM){let r=null;throw new pe(-950,r)}return t.value}return i[Yn]=t,i}var Fp=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>wu(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function YA(n,e){return oM(n,e)}function XU(n){return oM(rM,n)}var sM=(YA.required=XU,YA);var bE=new _e(""),eB=new _e("");function Vu(n){return!n.moduleRef}function tB(n){let e=Vu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(mn);return t.run(()=>{Vu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(hi),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Vu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(bE);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(bE);s.add(o),n.moduleRef.onDestroy(()=>{pu(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return iB(i,t,()=>{let o=e.get(wr),s=o.add(),a=e.get(nE);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(Lu,Pu);if(fA(l||Pu),!e.get(eB,!0))return Vu(n)?e.get(Xn):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Vu(n)){let d=e.get(Xn);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return nB?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{o.remove(s)})})})}var nB;function iB(n,e,t){try{let i=t();return Zo(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Op=null;function rB(n=[],e){return Wn.create({name:e,providers:[{provide:eu,useValue:"platform"},{provide:bE,useValue:new Set([()=>Op=null])},...n]})}function oB(n=[]){if(Op)return Op;let e=rB(n);return Op=e,aA(),sB(e),e}function sB(n){let e=n.get(ap,null);Pn(n,()=>{e?.forEach(t=>t())})}function aM(){return!1}var kp=new WeakSet,QA="";function JA(n){return n.get(S_,bC)}function lM(){let n=[{provide:S_,useFactory:()=>{let e=!0;{let t=z(Ir);e=!!window._ejsas?.[t]}return e&&gi("NgEventReplay"),e}}];return n.push({provide:mr,useValue:()=>{let e=z(Xn),{injector:t}=e;if(!kp.has(e)){let i=z(I_);if(JA(t)){MC();let r=t.get(Ir),o=DC(r,(s,a,l)=>{s.nodeType===Node.ELEMENT_NODE&&(SC(s,a,l),IC(s,i))});e.onDestroy(o)}}},multi:!0},{provide:Xo,useFactory:()=>{let e=z(Xn),{injector:t}=e;return()=>{if(!JA(t)||kp.has(e))return;kp.add(e);let i=t.get(Ir);e.onDestroy(()=>{kp.delete(e),EE(i)}),e.whenStable().then(()=>{if(e.destroyed)return;let r=t.get(CC);aB(r,t);let o=t.get(I_);o.get(QA)?.forEach(TC),o.delete(QA);let s=r.instance;LC(t)?e.onDestroy(()=>s.cleanUp()):s.cleanUp()})}},multi:!0}),n}var aB=(n,e)=>{let t=e.get(Ir),i=window._ejsas[t],r=n.instance=new qA(new Np(i.c));for(let a of i.et)r.addEvent(a);for(let a of i.etc)r.addEvent(a);let o=KA(t);r.replayEarlyEventInfos(o),EE(t);let s=new Pp(a=>{lB(e,a,a.currentTarget)});WA(r,s)};function lB(n,e,t){let i=(t&&t.getAttribute(Su))??"";/d\d+/.test(i)?cB(i,n,e,t):e.eventPhase===_E.REPLAY&&T_(e,t)}function cB(n,e,t,i){let r=e.get(wC);r.push({event:t,currentTarget:i}),uA(e,n,uB(r))}function uB(n){return e=>{let t=new Set(e),i=[];for(let{event:r,currentTarget:o}of n){let s=o.getAttribute(Su);t.has(s)?T_(r,o):i.push({event:r,currentTarget:o})}n.length=0,n.push(...i)}}var ZA=!1;var dB=1e4;function hB(){ZA||(ZA=!0,kC(),dA(),wA(),hA(),iA(),QD(),ND(),dD())}function fB(n){return n.whenStable()}function cM(){let n=[{provide:xu,useFactory:()=>{let e=!0;return e=!!z(pl,{optional:!0})?.get(C_,null),e&&gi("NgHydration"),e}},{provide:mr,useValue:()=>{DD(!1);let e=z(Yt);z(xu)&&(BC(e),hB())},multi:!0}];return n.push({provide:x_,useFactory:()=>z(xu)},{provide:Xo,useFactory:()=>{if(z(xu)){let e=z(Xn);return()=>{fB(e).then(()=>{e.destroyed||q_(e)})}}return()=>{}},multi:!0}),yr(n)}var cse=dB-1e3;var ua=(()=>{class n{static __NG_ELEMENT_ID__=pB}return n})();function pB(n){return gB(Ln(),Ue(),(n&16)===16)}function gB(n,e,t){if(eo(n)&&!t){let i=Di(n.index,e);return new Yo(i,i)}else if(n.type&175){let i=e[Kn];return new Yo(i,e)}return null}var wE=class{constructor(){}supports(e){return K_(e)}create(e){return new xE(e)}},mB=(n,e)=>e,xE=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||mB}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<XA(i,r,o)?t:i,a=XA(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){let g=p<o.length?o[p]:o[p]=0,S=g+p;d<=S&&S<c&&(o[p]=g+1)}let h=s.previousIndex;o[h]=d-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!K_(e))throw new pe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,jD(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new SE(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Lp),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Lp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},SE=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},IE=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},Lp=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new IE,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function XA(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function eM(){return new TE([new wE])}var TE=(()=>{class n{factories;static \u0275prov=le({token:n,providedIn:"root",factory:eM});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=z(n,{optional:!0,skipSelf:!0});return n.create(t,i||eM())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new pe(901,!1)}}return n})();function uM(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;gt(at.BootstrapApplicationStart);try{let o=r?.injector??oB(i),s=[MA(),eT,...t||[]],a=new _u({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return tB({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{gt(at.BootstrapApplicationEnd)}}function Uu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var dM=null;function Ni(){return dM}function CE(n){dM??=n}var Bu=class{},Vp=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>z(hM),providedIn:"platform"})}return n})();var hM=(()=>{class n extends Vp{_location;_history;_doc=z(Yt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ni().getBaseHref(this._doc)}onPopState(t){let i=Ni().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Ni().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function gM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function fM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ns(n){return n&&n[0]!=="?"?`?${n}`:n}var xl=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>z(vB),providedIn:"root"})}return n})(),yB=new _e(""),vB=(()=>{class n extends xl{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??z(Yt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return gM(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+ns(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+ns(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+ns(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(De(Vp),De(yB,8))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Sl=(()=>{class n{_subject=new Bt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=bB(fM(pM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ns(i))}normalize(t){return n.stripTrailingSlash(EB(this._basePath,pM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ns(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ns(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=ns;static joinWithSlash=gM;static stripTrailingSlash=fM;static \u0275fac=function(i){return new(i||n)(De(xl))};static \u0275prov=le({token:n,factory:()=>_B(),providedIn:"root"})}return n})();function _B(){return new Sl(De(xl))}function EB(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function pM(n){return n.replace(/\/index.html$/,"")}function bB(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Vn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Vn||{}),It=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(It||{}),ti=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(ti||{}),ao={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function _M(n){return yi(n)[en.LocaleId]}function EM(n,e,t){let i=yi(n),r=[i[en.DayPeriodsFormat],i[en.DayPeriodsStandalone]],o=Pi(r,e);return Pi(o,t)}function bM(n,e,t){let i=yi(n),r=[i[en.DaysFormat],i[en.DaysStandalone]],o=Pi(r,e);return Pi(o,t)}function wM(n,e,t){let i=yi(n),r=[i[en.MonthsFormat],i[en.MonthsStandalone]],o=Pi(r,e);return Pi(o,t)}function xM(n,e){let i=yi(n)[en.Eras];return Pi(i,e)}function ju(n,e){let t=yi(n);return Pi(t[en.DateFormat],e)}function Hu(n,e){let t=yi(n);return Pi(t[en.TimeFormat],e)}function $u(n,e){let i=yi(n)[en.DateTimeFormat];return Pi(i,e)}function Gu(n,e){let t=yi(n),i=t[en.NumberSymbols][e];if(typeof i>"u"){if(e===ao.CurrencyDecimal)return t[en.NumberSymbols][ao.Decimal];if(e===ao.CurrencyGroup)return t[en.NumberSymbols][ao.Group]}return i}function SM(n){if(!n[en.ExtraData])throw new pe(2303,!1)}function IM(n){let e=yi(n);return SM(e),(e[en.ExtraData][2]||[]).map(i=>typeof i=="string"?DE(i):[DE(i[0]),DE(i[1])])}function TM(n,e,t){let i=yi(n);SM(i);let r=[i[en.ExtraData][0],i[en.ExtraData][1]],o=Pi(r,e)||[];return Pi(o,t)||[]}function Pi(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new pe(2304,!1)}function DE(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var wB=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Up={},xB=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function CM(n,e,t,i){let r=NB(n);e=so(t,e)||e;let s=[],a;for(;e;)if(a=xB.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let l=r.getTimezoneOffset();i&&(l=AM(i,l),r=RB(r,i));let c="";return s.forEach(d=>{let h=AB(d);c+=h?h(r,t,l):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Gp(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function so(n,e){let t=_M(n);if(Up[t]??={},Up[t][e])return Up[t][e];let i="";switch(e){case"shortDate":i=ju(n,ti.Short);break;case"mediumDate":i=ju(n,ti.Medium);break;case"longDate":i=ju(n,ti.Long);break;case"fullDate":i=ju(n,ti.Full);break;case"shortTime":i=Hu(n,ti.Short);break;case"mediumTime":i=Hu(n,ti.Medium);break;case"longTime":i=Hu(n,ti.Long);break;case"fullTime":i=Hu(n,ti.Full);break;case"short":let r=so(n,"shortTime"),o=so(n,"shortDate");i=Bp($u(n,ti.Short),[r,o]);break;case"medium":let s=so(n,"mediumTime"),a=so(n,"mediumDate");i=Bp($u(n,ti.Medium),[s,a]);break;case"long":let l=so(n,"longTime"),c=so(n,"longDate");i=Bp($u(n,ti.Long),[l,c]);break;case"full":let d=so(n,"fullTime"),h=so(n,"fullDate");i=Bp($u(n,ti.Full),[d,h]);break}return i&&(Up[t][e]=i),i}function Bp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function Xi(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function SB(n,e){return Xi(n,3).substring(0,e)}function dn(n,e,t=0,i=!1,r=!1){return function(o,s){let a=IB(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return SB(a,e);let l=Gu(s,ao.MinusSign);return Xi(a,e,l,i,r)}}function IB(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new pe(2301,!1)}}function Mt(n,e,t=Vn.Format,i=!1){return function(r,o){return TB(r,o,n,e,t,i)}}function TB(n,e,t,i,r,o){switch(t){case 2:return wM(e,r,i)[n.getMonth()];case 1:return bM(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let c=IM(e),d=TM(e,r,i),h=c.findIndex(p=>{if(Array.isArray(p)){let[g,S]=p,I=s>=g.hours&&a>=g.minutes,P=s<S.hours||s===S.hours&&a<S.minutes;if(g.hours<S.hours){if(I&&P)return!0}else if(I||P)return!0}else if(p.hours===s&&p.minutes===a)return!0;return!1});if(h!==-1)return d[h]}return EM(e,r,i)[s<12?0:1];case 3:return xM(e,i)[n.getFullYear()<=0?0:1];default:let l=t;throw new pe(2302,!1)}}function jp(n){return function(e,t,i){let r=-1*i,o=Gu(t,ao.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Xi(s,2,o)+Xi(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+Xi(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+Xi(s,2,o)+":"+Xi(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+Xi(s,2,o)+":"+Xi(Math.abs(r%60),2,o);default:throw new pe(2310,!1)}}}var CB=0,$p=4;function DB(n){let e=Gp(n,CB,1).getDay();return Gp(n,0,1+(e<=$p?$p:$p+7)-e)}function DM(n){let e=n.getDay(),t=e===0?-3:$p-e;return Gp(n.getFullYear(),n.getMonth(),n.getDate()+t)}function AE(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=DM(t),s=DB(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Xi(r,n,Gu(i,ao.MinusSign))}}function Hp(n,e=!1){return function(t,i){let o=DM(t).getFullYear();return Xi(o,n,Gu(i,ao.MinusSign),e)}}var ME={};function AB(n){if(ME[n])return ME[n];let e;switch(n){case"G":case"GG":case"GGG":e=Mt(3,It.Abbreviated);break;case"GGGG":e=Mt(3,It.Wide);break;case"GGGGG":e=Mt(3,It.Narrow);break;case"y":e=dn(0,1,0,!1,!0);break;case"yy":e=dn(0,2,0,!0,!0);break;case"yyy":e=dn(0,3,0,!1,!0);break;case"yyyy":e=dn(0,4,0,!1,!0);break;case"Y":e=Hp(1);break;case"YY":e=Hp(2,!0);break;case"YYY":e=Hp(3);break;case"YYYY":e=Hp(4);break;case"M":case"L":e=dn(1,1,1);break;case"MM":case"LL":e=dn(1,2,1);break;case"MMM":e=Mt(2,It.Abbreviated);break;case"MMMM":e=Mt(2,It.Wide);break;case"MMMMM":e=Mt(2,It.Narrow);break;case"LLL":e=Mt(2,It.Abbreviated,Vn.Standalone);break;case"LLLL":e=Mt(2,It.Wide,Vn.Standalone);break;case"LLLLL":e=Mt(2,It.Narrow,Vn.Standalone);break;case"w":e=AE(1);break;case"ww":e=AE(2);break;case"W":e=AE(1,!0);break;case"d":e=dn(2,1);break;case"dd":e=dn(2,2);break;case"c":case"cc":e=dn(7,1);break;case"ccc":e=Mt(1,It.Abbreviated,Vn.Standalone);break;case"cccc":e=Mt(1,It.Wide,Vn.Standalone);break;case"ccccc":e=Mt(1,It.Narrow,Vn.Standalone);break;case"cccccc":e=Mt(1,It.Short,Vn.Standalone);break;case"E":case"EE":case"EEE":e=Mt(1,It.Abbreviated);break;case"EEEE":e=Mt(1,It.Wide);break;case"EEEEE":e=Mt(1,It.Narrow);break;case"EEEEEE":e=Mt(1,It.Short);break;case"a":case"aa":case"aaa":e=Mt(0,It.Abbreviated);break;case"aaaa":e=Mt(0,It.Wide);break;case"aaaaa":e=Mt(0,It.Narrow);break;case"b":case"bb":case"bbb":e=Mt(0,It.Abbreviated,Vn.Standalone,!0);break;case"bbbb":e=Mt(0,It.Wide,Vn.Standalone,!0);break;case"bbbbb":e=Mt(0,It.Narrow,Vn.Standalone,!0);break;case"B":case"BB":case"BBB":e=Mt(0,It.Abbreviated,Vn.Format,!0);break;case"BBBB":e=Mt(0,It.Wide,Vn.Format,!0);break;case"BBBBB":e=Mt(0,It.Narrow,Vn.Format,!0);break;case"h":e=dn(3,1,-12);break;case"hh":e=dn(3,2,-12);break;case"H":e=dn(3,1);break;case"HH":e=dn(3,2);break;case"m":e=dn(4,1);break;case"mm":e=dn(4,2);break;case"s":e=dn(5,1);break;case"ss":e=dn(5,2);break;case"S":e=dn(6,1);break;case"SS":e=dn(6,2);break;case"SSS":e=dn(6,3);break;case"Z":case"ZZ":case"ZZZ":e=jp(0);break;case"ZZZZZ":e=jp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=jp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=jp(2);break;default:return null}return ME[n]=e,e}function AM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function MB(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function RB(n,e,t){let r=n.getTimezoneOffset(),o=AM(e,r);return MB(n,-1*(o-r))}function NB(n){if(mM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return Gp(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(wB))return PB(i)}let e=new Date(n);if(!mM(e))throw new pe(2311,!1);return e}function PB(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),c=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,c),e}function mM(n){return n instanceof Date&&!isNaN(n.valueOf())}var zp=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Il=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new zp(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),yM(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);yM(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(ge(io),ge(Qo),ge(TE))};static \u0275dir=bn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function yM(n,e){n.context.$implicit=e.item}var zu=(()=>{class n{_viewContainer;_context=new Wp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){vM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){vM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(ge(io),ge(Qo))};static \u0275dir=bn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Wp=class{$implicit=null;ngIf=null};function vM(n,e){if(n&&!n.createEmbeddedView)throw new pe(2020,!1)}function MM(n,e){return new pe(2100,!1)}var kB=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,RE=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw MM(n,t);return t.replace(kB,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=Cp({name:"titlecase",type:n,pure:!0})}return n})();var OB="mediumDate",RM=new _e(""),NM=new _e(""),da=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??OB,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return CM(t,s,o||this.locale,a)}catch(s){throw MM(n,s.message)}}static \u0275fac=function(i){return new(i||n)(ge(Lu,16),ge(RM,24),ge(NM,24))};static \u0275pipe=Cp({name:"date",type:n,pure:!0})}return n})();var jt=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ro({type:n});static \u0275inj=gr({})}return n})();function NE(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Wu=class{};var PE="browser";function is(n){return n===PE}var qu=class{_doc;constructor(e){this._doc=e}manager},Kp=(()=>{class n extends qu{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(De(Yt))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),Jp=new _e(""),LE=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof Kp));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof Kp);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new pe(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(De(Jp),De(mn))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),kE="ng-app-id";function PM(n){for(let e of n)e.remove()}function kM(n,e){let t=e.createElement("style");return t.textContent=n,t}function FB(n,e,t,i){let r=n.head?.querySelectorAll(`style[${kE}="${e}"],link[${kE}="${e}"]`);if(r)for(let o of r)o.removeAttribute(kE),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function FE(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var VE=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,FB(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,kM);i?.forEach(r=>this.addUsage(r,this.external,FE))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(PM(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])PM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,kM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,FE(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(De(Yt),De(Ir),De(fl,8),De(Ji))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),OE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},UE=/%COMP%/g;var FM="%COMP%",LB=`_nghost-${FM}`,VB=`_ngcontent-${FM}`,UB=!0,BB=new _e("",{factory:()=>UB});function jB(n){return VB.replace(UE,n)}function HB(n){return LB.replace(UE,n)}function LM(n,e){return e.map(t=>t.replace(UE,n))}var BE=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,r,o,s,a,l=null,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.defaultRenderer=new Ku(t,s,a,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof Qp?r.applyToHost(t):r instanceof Yu&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.tracingService;switch(i.encapsulation){case Yi.Emulated:o=new Qp(l,c,i,this.appId,d,s,a,h);break;case Yi.ShadowDom:return new Yp(l,t,i,s,a,this.nonce,h,c);case Yi.ExperimentalIsolatedShadowDom:return new Yp(l,t,i,s,a,this.nonce,h);default:o=new Yu(l,c,i,d,s,a,h);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(De(LE),De(VE),De(Ir),De(BB),De(Yt),De(mn),De(fl),De(Jo,8))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),Ku=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(OE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(OM(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(OM(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new pe(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=OE[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=OE[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Sr.DashCase|Sr.Important)?e.style.setProperty(t,i,r&Sr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Sr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Ni().getGlobalEventTarget(this.doc,e),!e))throw new pe(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function OM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Yp=class extends Ku{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let c=i.styles;c=LM(i.id,c);for(let h of c){let p=document.createElement("style");s&&p.setAttribute("nonce",s),p.textContent=h,this.shadowRoot.appendChild(p)}let d=i.getExternalStyles?.();if(d)for(let h of d){let p=FE(h,r);s&&p.setAttribute("nonce",s),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Yu=class extends Ku{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let c=i.styles;this.styles=l?LM(l,c):c,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&ea.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Qp=class extends Yu{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l){let c=r+"-"+i.id;super(e,t,i,o,s,a,l,c),this.contentAttr=jB(c),this.hostAttr=HB(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var Zp=class n extends Bu{supportsDOMEvents=!0;static makeCurrent(){CE(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=$B();return t==null?null:GB(t)}resetBaseElement(){Qu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return NE(document.cookie,e)}},Qu=null;function $B(){return Qu=Qu||document.head.querySelector("base"),Qu?Qu.getAttribute("href"):null}function GB(n){return new URL(n,document.baseURI).pathname}var zB=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),VM=["alt","control","meta","shift"],WB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},UM=(()=>{class n extends qu{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ni().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),VM.forEach(c=>{let d=i.indexOf(c);d>-1&&(i.splice(d,1),s+=c+".")}),s+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=WB[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),VM.forEach(s=>{if(s!==r){let a=qB[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(De(Yt))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})();async function jE(n,e,t){let i=F({rootComponent:n},KB(e,t));return uM(i)}function KB(n,e){return{platformRef:e?.platformRef,appProviders:[...XB,...n?.providers??[]],platformProviders:ZB}}function YB(){Zp.makeCurrent()}function QB(){return new fr}function JB(){return E_(document),document}var ZB=[{provide:Ji,useValue:PE},{provide:ap,useValue:YB,multi:!0},{provide:Yt,useFactory:JB}];var XB=[{provide:eu,useValue:"root"},{provide:fr,useFactory:QB},{provide:Jp,useClass:Kp,multi:!0},{provide:Jp,useClass:UM,multi:!0},BE,VE,LE,{provide:ta,useExisting:BE},{provide:Wu,useClass:zB},[]];var Ju=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var e6="text/plain",t6="application/json",ele=`${t6}, ${e6}, */*`;var $E=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})($E||{}),HE=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new Ju,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var Xp=class n extends HE{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=$E.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var BM=new _e("");var n6=new _e(""),i6="b",r6="h",o6="s",s6="st",a6="u",l6="rt",GE=new _e(""),c6=["GET","HEAD"];function u6(n,e){let g=z(GE),{isCacheActive:t}=g,i=$a(g,["isCacheActive"]),{transferCache:r,method:o}=n;if(!t||r===!1||o==="POST"&&!i.includePostRequests&&!r||o!=="POST"&&!c6.includes(o)||!i.includeRequestsWithAuthHeaders&&d6(n)||i.filter?.(n)===!1)return e(n);let s=z(pl);if(z(n6,{optional:!0}))throw new pe(2803,!1);let l=n.url,c=h6(n,l),d=s.get(c,null),h=i.includeHeaders;if(typeof r=="object"&&r.includeHeaders&&(h=r.includeHeaders),d){let{[i6]:S,[l6]:I,[r6]:P,[o6]:U,[s6]:oe,[a6]:Se}=d,xe=S;switch(I){case"arraybuffer":xe=new TextEncoder().encode(S).buffer;break;case"blob":xe=new Blob([S]);break}let Ae=new Ju(P);return it(new Xp({body:xe,headers:Ae,status:U,statusText:oe,url:Se}))}return e(n)}function d6(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function jM(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function h6(n,e){let{params:t,method:i,responseType:r}=n,o=jM(t),s=n.serializeBody();s instanceof URLSearchParams?s=jM(s):typeof s!="string"&&(s="");let a=[i,r,e,s,o].join("|"),l=f6(a);return l}function f6(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function HM(n){return[{provide:GE,useFactory:()=>(gi("NgHttpTransferCache"),F({isCacheActive:!0},n))},{provide:BM,useValue:u6,multi:!0},{provide:Xo,multi:!0,useFactory:()=>{let e=z(Xn),t=z(GE);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var $M=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(De(Yt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var eg=(function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n})(eg||{});function p6(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function GM(){return p6(eg.EventReplay,lM())}function zM(...n){let e=[],t=new Set;for(let{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);let i=t.has(eg.HttpTransferCacheOptions);return yr([[],[],cM(),t.has(eg.NoHttpTransferCache)||i?[]:HM({}),e])}var Ge="primary",cd=Symbol("RouteTitle"),YE=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function pa(n){return new YE(n)}function zE(n,e,t){for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function tR(n,e,t){let i=t.path.split("/"),r=i.indexOf("**");if(r===-1){if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let l={},c=n.slice(0,i.length);return zE(i,c,l)?{consumed:c,posParams:l}:null}if(r!==i.lastIndexOf("**"))return null;let o=i.slice(0,r),s=i.slice(r+1);if(o.length+s.length>n.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!zE(o,n.slice(0,o.length),a)||!zE(s,n.slice(n.length-s.length),a)?null:{consumed:n,posParams:a}}function sg(n){return new Promise((e,t)=>{n.pipe(qr()).subscribe({next:i=>e(i),error:i=>t(i)})})}function m6(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Mr(n[t],e[t]))return!1;return!0}function Mr(n,e){let t=n?QE(n):void 0,i=e?QE(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!nR(n[r],e[r]))return!1;return!0}function QE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function nR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function y6(n){return n.length>0?n[n.length-1]:null}function ya(n){return Jh(n)?n:Zo(n)?an(Promise.resolve(n)):it(n)}function iR(n){return Jh(n)?sg(n):Promise.resolve(n)}var v6={exact:oR,subset:sR},rR={exact:_6,subset:E6,ignored:()=>!0};function WM(n,e,t){return v6[t.paths](n.root,e.root,t.matrixParams)&&rR[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function _6(n,e){return Mr(n,e)}function oR(n,e,t){if(!ha(n.segments,e.segments)||!ig(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!oR(n.children[i],e.children[i],t))return!1;return!0}function E6(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>nR(n[t],e[t]))}function sR(n,e,t){return aR(n,e,e.segments,t)}function aR(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!ha(r,t)||e.hasChildren()||!ig(r,t,i))}else if(n.segments.length===t.length){if(!ha(n.segments,t)||!ig(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!sR(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!ha(n.segments,r)||!ig(n.segments,r,i)||!n.children[Ge]?!1:aR(n.children[Ge],e,o,i)}}function ig(n,e,t){return e.every((i,r)=>rR[t](n[r].parameters,i.parameters))}var tr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new mt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=pa(this.queryParams),this._queryParamMap}toString(){return x6.serialize(this)}},mt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return rg(this)}},rs=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=pa(this.parameters),this._parameterMap}toString(){return cR(this)}};function b6(n,e){return ha(n,e)&&n.every((t,i)=>Mr(t.parameters,e[i].parameters))}function ha(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function w6(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ge&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ge&&(t=t.concat(e(r,i)))}),t}var ud=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>new os,providedIn:"root"})}return n})(),os=class{parse(e){let t=new ZE(e);return new tr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Zu(e.root,!0)}`,i=T6(e.queryParams),r=typeof e.fragment=="string"?`#${S6(e.fragment)}`:"";return`${t}${i}${r}`}},x6=new os;function rg(n){return n.segments.map(e=>cR(e)).join("/")}function Zu(n,e){if(!n.hasChildren())return rg(n);if(e){let t=n.children[Ge]?Zu(n.children[Ge],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==Ge&&i.push(`${r}:${Zu(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=w6(n,(i,r)=>r===Ge?[Zu(n.children[Ge],!1)]:[`${r}:${Zu(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ge]!=null?`${rg(n)}/${t[0]}`:`${rg(n)}/(${t.join("//")})`}}function lR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function tg(n){return lR(n).replace(/%3B/gi,";")}function S6(n){return encodeURI(n)}function JE(n){return lR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function og(n){return decodeURIComponent(n)}function qM(n){return og(n.replace(/\+/g,"%20"))}function cR(n){return`${JE(n.path)}${I6(n.parameters)}`}function I6(n){return Object.entries(n).map(([e,t])=>`;${JE(e)}=${JE(t)}`).join("")}function T6(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${tg(t)}=${tg(r)}`).join("&"):`${tg(t)}=${tg(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var C6=/^[^\/()?;#]+/;function WE(n){let e=n.match(C6);return e?e[0]:""}var D6=/^[^\/()?;=#]+/;function A6(n){let e=n.match(D6);return e?e[0]:""}var M6=/^[^=?&#]+/;function R6(n){let e=n.match(M6);return e?e[0]:""}var N6=/^[^&#]+/;function P6(n){let e=n.match(N6);return e?e[0]:""}var ZE=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new mt([],{}):new mt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ge]=new mt(e,t)),i}parseSegment(){let e=WE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new pe(4009,!1);return this.capture(e),new rs(og(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=A6(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=WE(this.remaining);r&&(i=r,this.capture(i))}e[og(t)]=og(i)}parseQueryParam(e){let t=R6(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=P6(this.remaining);s&&(i=s,this.capture(i))}let r=qM(t),o=qM(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=WE(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new pe(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Ge);let s=this.parseChildren();t[o??Ge]=Object.keys(s).length===1&&s[Ge]?s[Ge]:new mt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new pe(4011,!1)}};function uR(n){return n.segments.length>0?new mt([],{[Ge]:n}):n}function dR(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=dR(r);if(i===Ge&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new mt(n.segments,e);return k6(t)}function k6(n){if(n.numberOfChildren===1&&n.children[Ge]){let e=n.children[Ge];return new mt(n.segments.concat(e.segments),e.children)}return n}function ss(n){return n instanceof tr}function hR(n,e,t=null,i=null,r=new os){let o=fR(n);return pR(o,e,t,i,r)}function fR(n){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new mt(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=uR(i);return e??r}function pR(n,e,t,i,r){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return qE(o,o,o,t,i,r);let s=O6(e);if(s.toRoot())return qE(o,o,new mt([],{}),t,i,r);let a=F6(s,o,n),l=a.processChildren?ed(a.segmentGroup,a.index,s.commands):mR(a.segmentGroup,a.index,s.commands);return qE(o,a.segmentGroup,l,t,i,r)}function ag(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function id(n){return typeof n=="object"&&n!=null&&n.outlets}function KM(n,e,t){n||="\u0275";let i=new tr;return i.queryParams={[n]:e},t.parse(t.serialize(i)).queryParams[n]}function qE(n,e,t,i,r,o){let s={};for(let[c,d]of Object.entries(i??{}))s[c]=Array.isArray(d)?d.map(h=>KM(c,h,o)):KM(c,d,o);let a;n===e?a=t:a=gR(n,e,t);let l=uR(dR(a));return new tr(l,s,r)}function gR(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=gR(o,e,t)}),new mt(n.segments,i)}var lg=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&ag(i[0]))throw new pe(4003,!1);let r=i.find(id);if(r&&r!==y6(i))throw new pe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function O6(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new lg(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new lg(t,e,i)}var Cl=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function F6(n,e,t){if(n.isAbsolute)return new Cl(e,!0,0);if(!t)return new Cl(e,!1,NaN);if(t.parent===null)return new Cl(t,!0,0);let i=ag(n.commands[0])?0:1,r=t.segments.length-1+i;return L6(t,r,n.numberOfDoubleDots)}function L6(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new pe(4005,!1);r=i.segments.length}return new Cl(i,!1,r-o)}function V6(n){return id(n[0])?n[0].outlets:{[Ge]:n}}function mR(n,e,t){if(n??=new mt([],{}),n.segments.length===0&&n.hasChildren())return ed(n,e,t);let i=U6(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new mt(n.segments.slice(0,i.pathIndex),{});return o.children[Ge]=new mt(n.segments.slice(i.pathIndex),n.children),ed(o,0,r)}else return i.match&&r.length===0?new mt(n.segments,{}):i.match&&!n.hasChildren()?XE(n,e,t):i.match?ed(n,0,r):XE(n,e,t)}function ed(n,e,t){if(t.length===0)return new mt(n.segments,{});{let i=V6(t),r={};if(Object.keys(i).some(o=>o!==Ge)&&n.children[Ge]&&n.numberOfChildren===1&&n.children[Ge].segments.length===0){let o=ed(n.children[Ge],e,t);return new mt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=mR(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new mt(n.segments,r)}}function U6(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(id(a))break;let l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!QM(l,c,s))return o;i+=2}else{if(!QM(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function XE(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(id(o)){let l=B6(o.outlets);return new mt(i,l)}if(r===0&&ag(t[0])){let l=n.segments[e];i.push(new rs(l.path,YM(t[0]))),r++;continue}let s=id(o)?o.outlets[Ge]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&ag(a)?(i.push(new rs(s,YM(a))),r+=2):(i.push(new rs(s,{})),r++)}return new mt(i,{})}function B6(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=XE(new mt([],{}),0,i))}),e}function YM(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function QM(n,e,t){return n==t.path&&Mr(e,t.parameters)}var td="imperative",Sn=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Sn||{}),_i=class{id;url;constructor(e,t){this.id=e,this.url=t}},ga=class extends _i{type=Sn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Rr=class extends _i{urlAfterRedirects;type=Sn.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Un=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Un||{}),rd=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(rd||{}),ki=class extends _i{reason;code;type=Sn.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function yR(n){return n instanceof ki&&(n.code===Un.Redirect||n.code===Un.SupersededByNewNavigation)}var co=class extends _i{reason;code;type=Sn.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},ma=class extends _i{error;target;type=Sn.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Al=class extends _i{urlAfterRedirects;state;type=Sn.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cg=class extends _i{urlAfterRedirects;state;type=Sn.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ug=class extends _i{urlAfterRedirects;state;shouldActivate;type=Sn.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},dg=class extends _i{urlAfterRedirects;state;type=Sn.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hg=class extends _i{urlAfterRedirects;state;type=Sn.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fg=class{route;type=Sn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},pg=class{route;type=Sn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},gg=class{snapshot;type=Sn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mg=class{snapshot;type=Sn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yg=class{snapshot;type=Sn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},vg=class{snapshot;type=Sn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ml=class{},Rl=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function j6(n){return!(n instanceof Ml)&&!(n instanceof Rl)}var _g=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new kl(this.rootInjector)}},kl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new _g(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(De(qt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Eg=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=eb(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=eb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=tb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return tb(e,this._root).map(t=>t.value)}};function eb(n,e){if(n===e.value)return e;for(let t of e.children){let i=eb(n,t);if(i)return i}return null}function tb(n,e){if(n===e.value)return[e];for(let t of e.children){let i=tb(n,t);if(i.length)return i.unshift(e),i}return[]}var vi=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Tl(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var od=class extends Eg{snapshot;constructor(e,t){super(e),this.snapshot=t,cb(this,e)}toString(){return this.snapshot.toString()}};function vR(n,e){let t=H6(n,e),i=new Mn([new rs("",{})]),r=new Mn({}),o=new Mn({}),s=new Mn({}),a=new Mn(""),l=new uo(i,r,s,a,o,Ge,n,t.root);return l.snapshot=t.root,new od(new vi(l,[]),t)}function H6(n,e){let t={},i={},r={},s=new fa([],t,r,"",i,Ge,n,null,{},e);return new sd("",new vi(s,[]))}var uo=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(vt(c=>c[cd]))??it(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(vt(e=>pa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(vt(e=>pa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function bg(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),r?.data),n._resolvedData)}:i={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},r&&ER(r)&&(i.resolve[cd]=r.title),i}var fa=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[cd]}constructor(e,t,i,r,o,s,a,l,c,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c,this._environmentInjector=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=pa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=pa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},sd=class extends Eg{url;constructor(e,t){super(t),this.url=e,cb(this,t)}toString(){return _R(this._root)}};function cb(n,e){e.value._routerState=n,e.children.forEach(t=>cb(n,t))}function _R(n){let e=n.children.length>0?` { ${n.children.map(_R).join(", ")} } `:"";return`${n.value}${e}`}function KE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Mr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Mr(e.params,t.params)||n.paramsSubject.next(t.params),m6(e.url,t.url)||n.urlSubject.next(t.url),Mr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function nb(n,e){let t=Mr(n.params,e.params)&&b6(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||nb(n.parent,e.parent))}function ER(n){return typeof n.title=="string"||n.title===null}var bR=new _e(""),dd=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ge;activateEvents=new ln;deactivateEvents=new ln;attachEvents=new ln;detachEvents=new ln;routerOutletData=sM();parentContexts=z(kl);location=z(io);changeDetector=z(ua);inputBinder=z(Ig,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new pe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new pe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new pe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new pe(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new ib(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=bn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[no]})}return n})(),ib=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===uo?this.route:e===kl?this.childContexts:e===bR?this.outletData:this.parent.get(e,t)}},Ig=new _e("");var ub=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Dt({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&K(0,"router-outlet")},dependencies:[dd],encapsulation:2})}return n})();function db(n){let e=n.children&&n.children.map(db),t=e?fe(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ge&&(t.component=ub),t}function $6(n,e,t){let i=ad(n,e._root,t?t._root:void 0);return new od(i,e)}function ad(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=G6(n,e,t);return new vi(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>ad(n,a)),s}}let i=z6(e.value),r=e.children.map(o=>ad(n,o));return new vi(i,r)}}function G6(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return ad(n,i,r);return ad(n,i)})}function z6(n){return new uo(new Mn(n.url),new Mn(n.params),new Mn(n.queryParams),new Mn(n.fragment),new Mn(n.data),n.outlet,n.component,n)}var Nl=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},wR="ngNavigationCancelingError";function wg(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=ss(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=xR(!1,Un.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function xR(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[wR]=!0,t.cancellationCode=e,t}function W6(n){return SR(n)&&ss(n.url)}function SR(n){return!!n&&n[wR]}var rb=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),KE(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=Tl(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Tl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Tl(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=Tl(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new vg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new mg(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(KE(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),KE(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},xg=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Dl=class{component;route;constructor(e,t){this.component=e,this.route=t}};function q6(n,e,t){let i=n._root,r=e?e._root:null;return Xu(i,r,t,[i.value])}function K6(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Ol(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!Fy(n)?n:e.get(n):i}function Xu(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=Tl(e);return n.children.forEach(s=>{Y6(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>nd(a,t.getContext(s),r)),r}function Y6(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=Q6(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new xg(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Xu(n,e,a?a.children:null,i,r):Xu(n,e,t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Dl(a.outlet.component,s))}else s&&nd(e,a,r),r.canActivateChecks.push(new xg(i)),o.component?Xu(n,null,a?a.children:null,i,r):Xu(n,null,t,i,r);return r}function Q6(n,e,t){if(typeof t=="function")return Pn(e._environmentInjector,()=>t(n,e));switch(t){case"pathParamsChange":return!ha(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ha(n.url,e.url)||!Mr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nb(n,e)||!Mr(n.queryParams,e.queryParams);default:return!nb(n,e)}}function nd(n,e,t){let i=Tl(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?nd(s,e.children.getContext(o),t):nd(s,null,t):nd(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Dl(e.outlet.component,r)):t.canDeactivateChecks.push(new Dl(null,r)):t.canDeactivateChecks.push(new Dl(null,r))}function hd(n){return typeof n=="function"}function J6(n){return typeof n=="boolean"}function Z6(n){return n&&hd(n.canLoad)}function X6(n){return n&&hd(n.canActivate)}function e8(n){return n&&hd(n.canActivateChild)}function t8(n){return n&&hd(n.canDeactivate)}function n8(n){return n&&hd(n.canMatch)}function IR(n){return n instanceof Fs||n?.name==="EmptyError"}var ng=Symbol("INITIAL_VALUE");function Pl(){return Kr(n=>$c(n.map(e=>e.pipe(Gi(1),Wc(ng)))).pipe(vt(e=>{for(let t of e)if(t!==!0){if(t===ng)return ng;if(t===!1||i8(t))return t}return!0}),$i(e=>e!==ng),Gi(1)))}function i8(n){return ss(n)||n instanceof Nl}function TR(n){return n.aborted?it(void 0).pipe(Gi(1)):new st(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function CR(n){return Ls(TR(n))}function r8(n){return $n(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?it(fe(F({},e),{guardsResult:!0})):o8(o,t,i).pipe($n(s=>s&&J6(s)?s8(t,r,n):it(s)),vt(s=>fe(F({},e),{guardsResult:s})))})}function o8(n,e,t){return an(n).pipe($n(i=>d8(i.component,i.route,t,e)),qr(i=>i!==!0,!0))}function s8(n,e,t){return an(e).pipe(tf(i=>Uo(l8(i.route.parent,t),a8(i.route,t),u8(n,i.path),c8(n,i.route))),qr(i=>i!==!0,!0))}function a8(n,e){return n!==null&&e&&e(new yg(n)),it(!0)}function l8(n,e){return n!==null&&e&&e(new gg(n)),it(!0)}function c8(n,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return it(!0);let i=t.map(r=>Gc(()=>{let o=e._environmentInjector,s=Ol(r,o),a=X6(s)?s.canActivate(e,n):Pn(o,()=>s(e,n));return ya(a).pipe(qr())}));return it(i).pipe(Pl())}function u8(n,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>K6(o)).filter(o=>o!==null).map(o=>Gc(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,c=Ol(a,l),d=e8(c)?c.canActivateChild(t,n):Pn(l,()=>c(t,n));return ya(d).pipe(qr())});return it(s).pipe(Pl())}));return it(r).pipe(Pl())}function d8(n,e,t,i){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return it(!0);let o=r.map(s=>{let a=e._environmentInjector,l=Ol(s,a),c=t8(l)?l.canDeactivate(n,e,t,i):Pn(a,()=>l(n,e,t,i));return ya(c).pipe(qr())});return it(o).pipe(Pl())}function h8(n,e,t,i,r){let o=e.canLoad;if(o===void 0||o.length===0)return it(!0);let s=o.map(a=>{let l=Ol(a,n),c=Z6(l)?l.canLoad(e,t):Pn(n,()=>l(e,t)),d=ya(c);return r?d.pipe(CR(r)):d});return it(s).pipe(Pl(),DR(i))}function DR(n){return dy(dr(e=>{if(typeof e!="boolean")throw wg(n,e)}),vt(e=>e===!0))}function f8(n,e,t,i,r){let o=e.canMatch;if(!o||o.length===0)return it(!0);let s=o.map(a=>{let l=Ol(a,n),c=n8(l)?l.canMatch(e,t):Pn(n,()=>l(e,t));return ya(c).pipe(CR(r))});return it(s).pipe(Pl(),DR(i))}var lo=class n extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,n.prototype)}},ld=class n extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,n.prototype)}};function p8(n){throw new pe(4e3,!1)}function g8(n){throw xR(!1,Un.GuardRejected)}var ob=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return i;if(r.numberOfChildren>1||!r.children[Ge])throw p8(`${e.redirectTo}`);r=r.children[Ge]}}async applyRedirectCommands(e,t,i,r,o){let s=await m8(t,r,o);if(s instanceof tr)throw new ld(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new ld(a);return a}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new tr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new mt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new pe(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function m8(n,e,t){if(typeof n=="string")return Promise.resolve(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:c,data:d,title:h,paramMap:p,queryParamMap:g}=e;return sg(ya(Pn(t,()=>i({params:c,data:d,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:p,queryParamMap:g}))))}function y8(n,e){return n.providers&&!n._injector&&(n._injector=yl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function er(n){return n.outlet||Ge}function v8(n,e){let t=n.filter(i=>er(i)===e);return t.push(...n.filter(i=>er(i)!==e)),t}var sb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function _8(n,e,t,i,r,o){let s=AR(n,e,t);return s.matched?(i=y8(e,i),f8(i,e,t,r,o).pipe(vt(a=>a===!0?s:F({},sb)))):it(s)}function AR(n,e,t){if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},sb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||tR)(t,n,e);if(!r)return F({},sb);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?F(F({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function JM(n,e,t,i){return t.length>0&&w8(n,t,i)?{segmentGroup:new mt(e,b8(i,new mt(t,n.children))),slicedSegments:[]}:t.length===0&&x8(n,t,i)?{segmentGroup:new mt(n.segments,E8(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new mt(n.segments,n.children),slicedSegments:t}}function E8(n,e,t,i){let r={};for(let o of t)if(Tg(n,e,o)&&!i[er(o)]){let s=new mt([],{});r[er(o)]=s}return F(F({},i),r)}function b8(n,e){let t={};t[Ge]=e;for(let i of n)if(i.path===""&&er(i)!==Ge){let r=new mt([],{});t[er(i)]=r}return t}function w8(n,e,t){return t.some(i=>Tg(n,e,i)&&er(i)!==Ge)}function x8(n,e,t){return t.some(i=>Tg(n,e,i))}function Tg(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function S8(n,e,t){return e.length===0&&!n.children[t]}var ab=class{};async function I8(n,e,t,i,r,o,s="emptyOnly",a){return new lb(n,e,t,i,r,s,o,a).recognize()}var T8=31,lb=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new ob(this.urlSerializer,this.urlTree)}noMatchError(e){return new pe(4002,`'${e.segmentGroup}'`)}async recognize(){let e=JM(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),r=new vi(i,t),o=new sd("",r),s=hR(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new fa([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ge,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,Ge,t),rootSnapshot:t}}catch(i){if(i instanceof ld)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof lo?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,r,o){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,o);let s=await this.processSegment(e,t,i,i.segments,r,!0,o);return s instanceof vi?[s]:[]}async processChildren(e,t,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let c=i.children[l],d=v8(t,l),h=await this.processSegmentGroup(e,d,c,l,r);s.push(...h)}let a=MR(s);return C8(a),a}async processSegment(e,t,i,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a)}catch(c){if(c instanceof lo||IR(c))continue;throw c}if(S8(i,r,o))return new ab;throw new lo(i)}async processSegmentAgainstRoute(e,t,i,r,o,s,a,l){if(er(i)!==s&&(s===Ge||!Tg(r,o,i)))throw new lo(r);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,i,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l);throw new lo(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:h,remainingSegments:p}=AR(t,r,o);if(!l)throw new lo(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>T8&&(this.allowRedirects=!1));let g=new fa(o,c,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,ZM(r),er(r),r.component??r._loadedComponent??null,r,XM(r),e),S=bg(g,a,this.paramsInheritanceStrategy);if(g.params=Object.freeze(S.params),g.data=Object.freeze(S.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let I=await this.applyRedirects.applyRedirectCommands(d,r.redirectTo,h,g,e),P=await this.applyRedirects.lineralizeSegments(r,I);return this.processSegment(e,i,t,P.concat(p),s,!1,a)}async matchSegmentAgainstRoute(e,t,i,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await sg(_8(t,i,r,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!a?.matched)throw new lo(t);e=i._injector??e;let{routes:l}=await this.getChildConfig(e,i,r),c=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:p}=a,g=new fa(h,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,ZM(i),er(i),i.component??i._loadedComponent??null,i,XM(i),e),S=bg(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(S.params),g.data=Object.freeze(S.data);let{segmentGroup:I,slicedSegments:P}=JM(t,h,p,l);if(P.length===0&&I.hasChildren()){let Se=await this.processChildren(c,l,I,g);return new vi(g,Se)}if(l.length===0&&P.length===0)return new vi(g,[]);let U=er(i)===o,oe=await this.processSegment(c,l,I,P,U?Ge:o,!0,g);return new vi(g,oe instanceof vi?[oe]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await sg(h8(e,t,i,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw g8(t)}return{routes:[],injector:e}}};function C8(n){n.sort((e,t)=>e.value.outlet===Ge?-1:t.value.outlet===Ge?1:e.value.outlet.localeCompare(t.value.outlet))}function D8(n){let e=n.value.routeConfig;return e&&e.path===""}function MR(n){let e=[],t=new Set;for(let i of n){if(!D8(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=MR(i.children);e.push(new vi(i.value,r))}return e.filter(i=>!t.has(i))}function ZM(n){return n.data||{}}function XM(n){return n.resolve||{}}function A8(n,e,t,i,r,o,s){return $n(async a=>{let{state:l,tree:c}=await I8(n,e,t,i,a.extractedUrl,r,o,s);return fe(F({},a),{targetSnapshot:l,urlAfterRedirects:c})})}function M8(n){return $n(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return it(e);let r=new Set(i.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of RR(a))o.add(l);let s=0;return an(o).pipe(tf(a=>r.has(a)?R8(a,t,n):(a.data=bg(a,a.parent,n).resolve,it(void 0))),dr(()=>s++),nf(1),$n(a=>s===o.size?it(e):Rn))})}function RR(n){let e=n.children.map(t=>RR(t)).flat();return[n,...e]}function R8(n,e,t){let i=n.routeConfig,r=n._resolve;return i?.title!==void 0&&!ER(i)&&(r[cd]=i.title),Gc(()=>(n.data=bg(n,n.parent,t).resolve,N8(r,n,e).pipe(vt(o=>(n._resolvedData=o,n.data=F(F({},n.data),o),null)))))}function N8(n,e,t){let i=QE(n);if(i.length===0)return it({});let r={};return an(i).pipe($n(o=>P8(n[o],e,t).pipe(qr(),dr(s=>{if(s instanceof Nl)throw wg(new os,s);r[o]=s}))),nf(1),vt(()=>r),zc(o=>IR(o)?Rn:gy(o)))}function P8(n,e,t){let i=e._environmentInjector,r=Ol(n,i),o=r.resolve?r.resolve(e,t):Pn(i,()=>r(e,t));return ya(o)}function eR(n){return Kr(e=>{let t=n(e);return t?an(t).pipe(vt(()=>e)):it(e)})}var hb=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===Ge);return i}getResolvedTitleForRoute(t){return t.data[cd]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>z(NR),providedIn:"root"})}return n})(),NR=(()=>{class n extends hb{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(De($M))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Fl=new _e("",{factory:()=>({})}),fd=new _e(""),PR=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=z(dE);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await iR(Pn(t,()=>i.loadComponent())),s=await FR(OR(o));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s,s}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let r=(async()=>{try{let o=await kR(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=o.routes,i._loadedInjector=o.injector,i._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function kR(n,e,t,i){let r=await iR(Pn(t,()=>n.loadChildren())),o=await FR(OR(r)),s;o instanceof Tp||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),i&&i(n);let a,l,c=!1,d;return Array.isArray(s)?(l=s,c=!0):(a=s.create(t).injector,d=s,l=a.get(fd,[],{optional:!0,self:!0}).flat()),{routes:l.map(db),injector:a,factory:d}}function k8(n){return n&&typeof n=="object"&&"default"in n}function OR(n){return k8(n)?n.default:n}async function FR(n){return n}var Cg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>z(O8),providedIn:"root"})}return n})(),O8=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),LR=new _e("");var F8=()=>{},VR=new _e(""),UR=(()=>{class n{currentNavigation=G(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=G(null);events=new Bt;transitionAbortWithErrorSubject=new Bt;configLoader=z(PR);environmentInjector=z(qt);destroyRef=z(Zn);urlSerializer=z(ud);rootContexts=z(kl);location=z(Sl);inputBindingEnabled=z(Ig,{optional:!0})!==null;titleStrategy=z(hb);options=z(Fl,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=z(Cg);createViewTransition=z(LR,{optional:!0});navigationErrorHandler=z(VR,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>it(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new fg(r)),i=r=>this.events.next(new pg(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;cn(()=>{this.transitions?.next(fe(F({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new Mn(null),this.transitions.pipe($i(i=>i!==null),Kr(i=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===i.id;return it(i).pipe(Kr(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),Rn;this.currentTransition=i;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?fe(F({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload")return this.events.next(new co(a.id,this.urlSerializer.serialize(a.rawUrl),"",rd.IgnoredSameUrlNavigation)),a.resolve(!1),Rn;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return it(a).pipe(Kr(h=>(this.events.next(new ga(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?Rn:Promise.resolve(h))),A8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),dr(h=>{i.targetSnapshot=h.targetSnapshot,i.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=h.urlAfterRedirects,g));let p=new Al(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:p,source:g,restoredState:S,extras:I}=a,P=new ga(h,this.urlSerializer.serialize(p),g,S);this.events.next(P);let U=vR(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=fe(F({},a),{targetSnapshot:U,urlAfterRedirects:p,extras:fe(F({},I),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(oe=>(oe.finalUrl=p,oe)),it(i)}else return this.events.next(new co(a.id,this.urlSerializer.serialize(a.extractedUrl),"",rd.IgnoredByUrlHandlingStrategy)),a.resolve(!1),Rn}),vt(a=>{let l=new cg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=i=fe(F({},a),{guards:q6(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i}),r8(a=>this.events.next(a)),Kr(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw wg(this.urlSerializer,a.guardsResult);let l=new ug(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return Rn;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",Un.GuardRejected),Rn;if(a.guards.canActivateChecks.length===0)return it(a);let c=new dg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(c),!s())return Rn;let d=!1;return it(a).pipe(M8(this.paramsInheritanceStrategy),dr({next:()=>{d=!0;let h=new hg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{d||this.cancelNavigationTransition(a,"",Un.NoDataFromResolver)}}))}),eR(a=>{let l=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let p=d._environmentInjector;h.push(this.configLoader.loadComponent(p,d.routeConfig).then(g=>{d.component=g}))}for(let p of d.children)h.push(...l(p));return h},c=l(a.targetSnapshot.root);return c.length===0?it(a):an(Promise.all(c).then(()=>a))}),eR(()=>this.afterPreactivation()),Kr(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,c=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return c?an(c).pipe(vt(()=>i)):it(i)}),Gi(1),vt(a=>{let l=$6(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=i=a=fe(F({},a),{targetRouterState:l}),this.currentNavigation.update(c=>(c.targetRouterState=l,c)),this.events.next(new Ml),s()&&(new rb(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,c=>this.events.next(c),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(c=>(c.abort=F8,c)),this.lastSuccessfulNavigation.set(cn(this.currentNavigation)),this.events.next(new Rr(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Ls(TR(o.signal).pipe($i(()=>!r&&!i.targetRouterState),dr(()=>{this.cancelNavigationTransition(i,o.signal.reason+"",Un.Aborted)}))),dr({complete:()=>{r=!0}}),Ls(this.transitionAbortWithErrorSubject.pipe(dr(a=>{throw a}))),vy(()=>{o.abort(),r||this.cancelNavigationTransition(i,"",Un.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),zc(a=>{if(r=!0,this.destroyed)return i.resolve(!1),Rn;if(SR(a))this.events.next(new ki(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),W6(a)?this.events.next(new Rl(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new ma(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let c=Pn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(c instanceof Nl){let{message:d,cancellationCode:h}=wg(this.urlSerializer,c);this.events.next(new ki(i.id,this.urlSerializer.serialize(i.extractedUrl),d,h)),this.events.next(new Rl(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(c){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(c)}}return Rn}))}))}cancelNavigationTransition(t,i,r){let o=new ki(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=cn(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function L8(n){return n!==td}var BR=new _e("");var jR=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>z(V8),providedIn:"root"})}return n})(),Sg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},V8=(()=>{class n extends Sg{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),fb=(()=>{class n{urlSerializer=z(ud);options=z(Fl,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=z(Sl);urlHandlingStrategy=z(Cg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new tr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof tr?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=vR(null,z(qt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:()=>z(U8),providedIn:"root"})}return n})(),U8=(()=>{class n extends fb{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof ga?this.updateStateMemento():t instanceof co?this.commitTransition(i):t instanceof Al?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Ml?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof ki&&!yR(t)?this.restoreHistory(i):t instanceof ma?this.restoreHistory(i,!0):t instanceof Rr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=F(F({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=F(F({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pb(n,e){n.events.pipe($i(t=>t instanceof Rr||t instanceof ki||t instanceof ma||t instanceof co),vt(t=>t instanceof Rr||t instanceof co?0:(t instanceof ki?t.code===Un.Redirect||t.code===Un.SupersededByNewNavigation:!1)?2:1),$i(t=>t!==2),Gi(1)).subscribe(()=>{e()})}var HR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},$R={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ei=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=z(Dp);stateManager=z(fb);options=z(Fl,{optional:!0})||{};pendingTasks=z(wr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=z(UR);urlSerializer=z(ud);location=z(Sl);urlHandlingStrategy=z(Cg);injector=z(qt);_events=new Bt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=z(jR);injectorCleanup=z(BR,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=z(fd,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!z(Ig,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new gn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=cn(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof ki&&i.code!==Un.Redirect&&i.code!==Un.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Rr)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof Rl){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=F({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||L8(r.source)},s);this.scheduleNavigation(a,td,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}j6(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),td,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=F({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(hi)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return cn(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(db),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let p=r?r.snapshot:this.routerState.snapshot.root;h=fR(p)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return pR(h,t,d,c??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let r=ss(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,td,null,i)}navigate(t,i={skipLocationChange:!1}){return B8(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Jr(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=F({},HR):i===!1?r=F({},$R):r=i,ss(t))return WM(this.currentUrlTree,t,r);let o=this.parseUrl(t);return WM(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((h,p)=>{a=h,l=p});let d=this.pendingTasks.add();return pb(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function B8(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new pe(4008,!1)}var as=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=G(null);get href(){return cn(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Bt;applicationErrorHandler=z(hi);options=z(Fl,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(z(new Fp("href"),{optional:!0}));let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area"||!!(typeof customElements=="object"&&customElements.get(l)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Rr&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(ss(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l)?.catch(c=>{this.applicationErrorHandler(c)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:ss(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(ge(Ei),ge(uo),wu("tabindex"),ge(sa),ge(Qi),ge(xl))};static \u0275dir=bn({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&ce("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&Lt("href",r.reactiveHref(),N_)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Uu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Uu],replaceUrl:[2,"replaceUrl","replaceUrl",Uu],routerLink:"routerLink"},features:[no]})}return n})();var $8=new _e("");function gb(n,...e){return yr([{provide:fd,multi:!0,useValue:n},[],{provide:uo,useFactory:G8},{provide:Xo,multi:!0,useFactory:z8},e.map(t=>t.\u0275providers)])}function G8(){return z(Ei).routerState.root}function z8(){let n=z(Wn);return e=>{let t=n.get(Xn);if(e!==t.components[0])return;let i=n.get(Ei),r=n.get(W8);n.get(q8)===1&&i.initialNavigation(),n.get(K8,null,{optional:!0})?.setUpPreloading(),n.get($8,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var W8=new _e("",{factory:()=>new Bt}),q8=new _e("",{factory:()=>1});var K8=new _e("");function GR(n,e){let i=!e?.manualCleanup?e?.injector?.get(Zn)??z(Zn):null,r=Y8(e?.equal),o;e?.requireSync?o=G({kind:0},{equal:r}):o=G({kind:1,value:e?.initialValue},{equal:r});let s,a=n.subscribe({next:l=>o.set({kind:1,value:l}),error:l=>{o.set({kind:2,error:l}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&o().kind===0)throw new pe(601,!1);return s=i?.onDestroy(a.unsubscribe.bind(a)),ei(()=>{let l=o();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:throw new pe(601,!1)}},{equal:e?.equal})}function Y8(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var mb;try{mb=typeof Intl<"u"&&Intl.v8BreakIterator}catch{mb=!1}var zR=(()=>{class n{_platformId=z(Ji);isBrowser=this._platformId?is(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||mb)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yb(n){return Array.isArray(n)?n:[n]}var WR=new Set,va,KR=(()=>{class n{_platform=z(zR);_nonce=z(fl,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):J8}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&Q8(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Q8(n,e){if(!WR.has(n))try{va||(va=document.createElement("style"),e&&va.setAttribute("nonce",e),va.setAttribute("type","text/css"),document.head.appendChild(va)),va.sheet&&(va.sheet.insertRule(`@media ${n} {body{ }}`,0),WR.add(n))}catch(t){console.error(t)}}function J8(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var vb=(()=>{class n{_mediaMatcher=z(KR);_zone=z(mn);_queries=new Map;_destroySubject=new Bt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return qR(yb(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=qR(yb(t)).map(s=>this._registerQuery(s).observable),o=$c(r);return o=Uo(o.pipe(Gi(1)),o.pipe(_y(1),yy(0))),o.pipe(vt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),o={observable:new st(s=>{let a=l=>this._zone.run(()=>s.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Wc(i),vt(({matches:s})=>({query:t,matches:s})),Ls(this._destroySubject)),mql:i};return this._queries.set(t,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qR(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var Ll=class n{calculateTotalPoints(e){return e.points}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}getPointsForTierLevel(e,t){let r={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]}[e];return r?r[t-1]:1}getDefenseBonus(e,t){let i=0,r=[];(e.turnsStationary??0)>=3&&(i+=1,r.push("Shield +1"));let o=t.filter(s=>s.owner===e.owner&&s.id!==e.id&&s.tier===e.tier&&Math.max(Math.abs(s.position.x-e.position.x),Math.abs(s.position.y-e.position.y))===1);return o.length&&(i+=o.length,r.push(`Support +${o.length}`)),{bonus:i,tags:r}}getAttackLuckModifier(e){let t=Math.random(),r={1:1,2:2,3:4,4:8}[e.tier]??0;return t<.2?{delta:r,tag:`CRIT! +${r}`,isCrit:!0}:t>.8?{delta:-r,tag:`MISS! -${r}`,isCrit:!1}:{delta:0,isCrit:!1}}getWallHitPercent(e){return e===1?34:e===2?51:100}getWallHitAmount(e){return e===1?34:e===2?51:101}applyDamage(e,t){let i=e.armorHp??0,r=Math.max(0,i-t),o=Math.max(0,t-i),s=Math.max(0,e.points-o),{tier:a,level:l}=this.calculateTierAndLevel(s);return fe(F({},e),{armorHp:r,points:s,tier:a,level:l})}calculateHitChance(e,t){let i=t.tier-e.tier,r=e.level??1,o=0;i<=0?o=100:i===1?o=Math.min(100,50+r*15):i===2?o=Math.min(100,25+r*5):o=Math.min(100,1+r*1);let s=e.hasWeapon&&t.tier>e.tier?10:0,a=t.hasArmor?10:0;return Math.max(1,Math.min(100,o+s-a))}isDiagonalBlocked(e,t,i){let r=Math.sign(t.x-e.x),o=Math.sign(t.y-e.y);if(r===0||o===0)return!1;let s=i(e.x,e.y,e.x+r,e.y),a=i(e.x,e.y,e.x,e.y+o),l=i(t.x-r,t.y,t.x,t.y),c=i(t.x,t.y-o,t.x,t.y);return!!(s||a||l||c)}checkWallAlongPath(e,t,i,r){let o=t.x-e.x,s=t.y-e.y,a=Math.sign(o),l=Math.sign(s),c=Math.max(Math.abs(o),Math.abs(s));for(let d=1;d<=c;d++){let h={x:e.x+a*(d-1),y:e.y+l*(d-1)},p={x:e.x+a*d,y:e.y+l*d},g=r(h.x,h.y,p.x,p.y);if(g)return g.owner===i?{hitOwn:!0,hitEnemy:!1}:{hitOwn:!1,hitEnemy:!0,lastFrom:h}}return{hitOwn:!1,hitEnemy:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ag=class n{areAdjacent(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)===1}sortEdgeEndpoints(e,t){return e.x<t.x||e.x===t.x&&e.y<=t.y?[e,t]:[t,e]}isInNoBuildZone(e,t,i){let r=[t,i];for(let o of r){let s=Math.abs(e.x-o.x),a=Math.abs(e.y-o.y);if(Math.max(s,a)<=2)return!0}return!1}isAnyUnitAdjacentToEdge(e,t,i,r){return e.some(o=>o.owner===t&&(o.position.x===i.x&&o.position.y===i.y||o.position.x===r.x&&o.position.y===r.y))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Mg=class n{entriesSignal=G([]);logs(){return this.entriesSignal()}add(e,t="text-gray-200"){this.entriesSignal.update(i=>[...i,{text:e,color:t,type:"other"}])}addCombat(e,t,i){let r=i?"text-yellow-300":e==="player"?"text-green-400":"text-red-400";this.entriesSignal.update(o=>[...o,{text:t,color:r,type:"combat"}])}clear(){this.entriesSignal.set([])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var ej={FINAL_STRIKE_INFO:{en:"If (Current HP / Max HP) < 0.15: Normal Enemy: Instant Kill. Boss: Deal 300% normal damage (Bosses are resistant to instant death).",uk:"\u042F\u043A\u0449\u043E (\u041F\u043E\u0442\u043E\u0447\u043D\u0456 HP / \u041C\u0430\u043A\u0441. HP) < 0.15: \u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439 \u0432\u043E\u0440\u043E\u0433: \u041C\u0438\u0442\u0442\u0454\u0432\u0435 \u0432\u0431\u0438\u0432\u0441\u0442\u0432\u043E. \u0411\u043E\u0441: \u0417\u0430\u0432\u0434\u0430\u0454 300% \u0437\u0432\u0438\u0447\u0430\u0439\u043D\u043E\u0457 \u0448\u043A\u043E\u0434\u0438 (\u0411\u043E\u0441\u0438 \u0441\u0442\u0456\u0439\u043A\u0456 \u0434\u043E \u043C\u0438\u0442\u0442\u0454\u0432\u043E\u0457 \u0441\u043C\u0435\u0440\u0442\u0456)."},FINAL_STRIKE:{en:"Final Strike",uk:"\u041E\u0441\u0442\u0430\u043D\u043D\u0456\u0439 \u0443\u0434\u0430\u0440"},SHATTER_INFO:{en:"Each hit adds 1 stack (Max 5). Incoming damage is multiplied by (1 + (shatterStacks * 0.10)). (Max +50% damage taken).",uk:"\u041A\u043E\u0436\u0435\u043D \u0443\u0434\u0430\u0440 \u0434\u043E\u0434\u0430\u0454 1 \u0437\u0430\u0440\u044F\u0434 (\u043C\u0430\u043A\u0441\u0438\u043C\u0443\u043C 5). \u0412\u0445\u0456\u0434\u043D\u0430 \u0448\u043A\u043E\u0434\u0430 \u043C\u043D\u043E\u0436\u0438\u0442\u044C\u0441\u044F \u043D\u0430 (1 + (\u0440\u043E\u0437\u0431\u0438\u0442\u0456 \u0437\u0430\u0440\u044F\u0434\u0438 * 0.10)). (\u041C\u0430\u043A\u0441\u0438\u043C\u0443\u043C +50% \u043E\u0442\u0440\u0438\u043C\u0430\u043D\u043E\u0457 \u0448\u043A\u043E\u0434\u0438)."},SHATTER:{en:"Shatter",uk:"\u0420\u043E\u0437\u043A\u043E\u043B\u043E\u0442\u0438"},CHAIN_LIGHTNING_INFO:{en:"25% chance to deal 50% damage to two adjacent targets",uk:"\u0428\u0430\u043D\u0441 25% \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u0434\u0432\u043E\u043C \u0441\u0443\u0441\u0456\u0434\u043D\u0456\u043C \u0446\u0456\u043B\u044F\u043C 50% \u0443\u0440\u043E\u043D\u0443"},CHAIN_LIGHTNING:{en:"Chain Lightning",uk:"\u041B\u0430\u043D\u0446\u044E\u0433\u043E\u0432\u0430 \u0431\u043B\u0438\u0441\u043A\u0430\u0432\u043A\u0430"},FROST_AURA_INFO:{en:"Apply 30% slow to enemies in range.",uk:"\u0423\u043F\u043E\u0432\u0456\u043B\u044C\u043D\u044E\u0454 \u0432\u043E\u0440\u043E\u0433\u0456\u0432 \u0443 \u0440\u0430\u0434\u0456\u0443\u0441\u0456 \u0434\u0456\u0457 \u043D\u0430 30%."},FROST_AURA:{en:"Frost Aura",uk:"\u041C\u043E\u0440\u043E\u0437\u043D\u0430 \u0430\u0443\u0440\u0430"},BUY_ABILITY:{en:"Buy Ability",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0434\u0456\u0431\u043D\u0456\u0441\u0442\u044C"},ABILITY_ACTIVE:{en:"Ability Active",uk:"\u0410\u043A\u0442\u0438\u0432\u043D\u0430 \u0437\u0434\u0430\u0442\u043D\u0456\u0441\u0442\u044C"},TRY_AGAIN:{en:"TRY AGAIN",uk:"\u0421\u041F\u0420\u041E\u0411\u0423\u0419\u0422\u0415 \u0417\u041D\u041E\u0412\u0423"},WAVES:{en:"waves",uk:"\u0445\u0432\u0438\u043B\u044C"},YOU_SURVIVED:{en:"You survived",uk:"\u0422\u0438 \u0432\u0438\u0436\u0438\u0432"},GAME_OVER:{en:"GAME OVER",uk:"\u0413\u0420\u0410 \u0417\u0410\u041A\u0406\u041D\u0427\u0415\u041D\u0410"},TO_PLACE_DEFENDER:{en:"to place a defender",uk:"\u0449\u043E\u0431 \u0440\u043E\u0437\u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},SELECT_BUILD_TILE:{en:"Select a buildable tile",uk:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u0431\u0443\u0434\u0456\u0432\u043D\u0438\u0446\u0442\u0432\u0430,"},SELL:{en:"SELL",uk:"\u041F\u0420\u041E\u0414\u0410\u0422\u0418"},MAX_LEVEL:{en:"MAX LEVEL",uk:"\u041C\u0410\u041A\u0421 \u0420\u0406\u0412\u0415\u041D\u042C"},UPGRADE:{en:"UPGRADE",uk:"\u041E\u041D\u041E\u0412\u041B\u0415\u041D\u041D\u042F"},RANGE:{en:"Range",uk:"\u0414\u0430\u043B\u044C\u043D\u0456\u0441\u0442\u044C"},DAMAGE:{en:"Damage",uk:"\u041F\u043E\u0448\u043A\u043E\u0434\u0436\u0435\u043D\u043D\u044F"},TIER:{en:"Tier",uk:"\u0420\u0430\u043D\u0433"},LEVEL:{en:"Level",uk:"\u0420\u0456\u0432\u0435\u043D\u044C"},DEFENDER_INFO:{en:"Defender Info",uk:"\u0406\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044F \u043F\u0440\u043E \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},BUY_DEFENDER:{en:"Buy Defender",uk:"\u041A\u0443\u043F\u0438\u0442\u0438 \u0417\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430"},START_WAVE:{en:"START WAVE",uk:"\u041F\u041E\u0427\u0410\u0422\u041E\u041A \u0425\u0412\u0418\u041B\u0406"},WAVE_IN_PROGRESS:{en:"WAVE IN PROGRESS",uk:"\u0425\u0412\u0418\u041B\u042F \u0412 \u041F\u0420\u041E\u0426\u0415\u0421\u0406"},RESTART_GAME:{en:"RESTART GAME",uk:"\u041F\u0415\u0420\u0415\u0417\u0410\u041F\u0423\u0421\u041A \u0413\u0420\u0418"},WAVE:{en:"WAVE",uk:"\u0425\u0412\u0418\u041B\u042F"},LIVES:{en:"LIVES",uk:"\u0416\u0418\u0422\u0422\u042F"},MONEY:{en:"MONEY",uk:"\u0413\u0420\u041E\u0428\u0406"},EXIT_GAME:{en:"EXIT GAME",uk:"\u0412\u0418\u0425\u0406\u0414 \u0417 \u0413\u0420\u0418"},TOWER_DEFFENCE_DESCRIPTION:{en:"A new game is already in development. Stay tuned for a completely different strategy experience. Coming soon to Game Center.",uk:"\u041D\u043E\u0432\u0430 \u0433\u0440\u0430 \u0432\u0436\u0435 \u0440\u043E\u0437\u0440\u043E\u0431\u043B\u044F\u0454\u0442\u044C\u0441\u044F. \u0421\u043B\u0456\u0434\u043A\u0443\u0439\u0442\u0435 \u0437\u0430 \u043E\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044F\u043C\u0438, \u0449\u043E\u0431 \u0434\u0456\u0437\u043D\u0430\u0442\u0438\u0441\u044F \u043F\u0440\u043E \u0437\u043E\u0432\u0441\u0456\u043C \u0456\u043D\u0448\u0438\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u0434\u043E\u0441\u0432\u0456\u0434. \u0421\u043A\u043E\u0440\u043E \u0432 \u0456\u0433\u0440\u043E\u0432\u043E\u043C\u0443 \u0446\u0435\u043D\u0442\u0440\u0456."},SHAPE_TACTIC_DESCRIPTION:{en:"Strategic turn-based combat with AI and merging mechanics. Build your base, manage resources, and conquer the battlefield.",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u043F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0438\u0439 \u0431\u0456\u0439 \u0437\u0456 \u0448\u0442\u0443\u0447\u043D\u0438\u043C \u0456\u043D\u0442\u0435\u043B\u0435\u043A\u0442\u043E\u043C \u0442\u0430 \u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0438\u043C\u0438 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0430\u043C\u0438. \u041F\u043E\u0431\u0443\u0434\u0443\u0439\u0442\u0435 \u0441\u0432\u043E\u044E \u0431\u0430\u0437\u0443, \u043A\u0435\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043C\u0438 \u0442\u0430 \u0437\u0430\u0432\u043E\u0439\u043E\u0432\u0443\u0439\u0442\u0435 \u043F\u043E\u043B\u0435 \u0431\u043E\u044E."},IRON_CYCLE:{en:"Iron Cycle",uk:"\u0426\u0438\u043A\u043B \u0417\u0430\u043B\u0456\u0437\u0430"},NEW_DESIGN_UNIT:{en:"New Evolution",uk:"\u041D\u043E\u0432\u0430 \u0435\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},SETTINGS:{en:"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NEXT_TURN:{en:"Next Turn",uk:"\u041A\u0456\u043D\u0435\u0446\u044C \u0445\u043E\u0434\u0443"},CHANGE_RECORDS_INFO:{en:"Change Difficulty or Map Size in Settings to view other boards.",uk:"\u0417\u043C\u0456\u043D\u0456\u0442\u044C \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C \u0430\u0431\u043E \u0440\u043E\u0437\u043C\u0456\u0440 \u043A\u0430\u0440\u0442\u0438 \u0432 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F\u0445, \u0449\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0456\u043D\u0448\u0456 \u0434\u043E\u0448\u043A\u0438."},NO_RECORDS_YET:{en:"No records yet",uk:"\u041F\u043E\u043A\u0438 \u0449\u043E \u043D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"},TURNS:{en:"turns",uk:"\u0445\u043E\u0434\u0456\u0432"},TOP_3_LOSES_PLAYER:{en:"Player Loses (Top 3)",uk:"\u041F\u0440\u043E\u0433\u0440\u0430\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0422\u043E\u043F-3)"},TOP_3_PLAYER:{en:"Player Wins (Top 3)",uk:"\u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438 \u0433\u0440\u0430\u0432\u0446\u0456\u0432 (\u0442\u043E\u043F-3)"},CURRENT:{en:"Current",uk:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439"},HIGH_SCORES:{en:"High Scores",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},SECTOR_DIMENSIONS:{en:"Sector Dimensions",uk:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u043A\u0430\u0440\u0442\u0438"},LEVEL_SELECTION:{en:"Level Selection",uk:"\u0412\u0438\u0431\u0456\u0440 \u0440\u0456\u0432\u043D\u044F"},TACTICAL_DIFF:{en:"Tactical Difficulty",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u043D\u0456\u0441\u0442\u044C"},SYSTEM_SETTINGS:{en:"System Settings",uk:"\u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0456 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F"},NOT_LOGS_DATA:{en:"No logs to display",uk:"\u041D\u0435\u043C\u0430\u0454 \u0437\u0430\u043F\u0438\u0441\u0456\u0432 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},COMBAT_ONLY:{en:"Combat Only",uk:"\u0422\u0456\u043B\u044C\u043A\u0438 \u0431\u043E\u0439\u043E\u0432\u0456 \u0434\u0456\u0457"},CLEAR:{en:"Clear",uk:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u0438"},Action_LOG:{en:"Action Log",uk:"\u0416\u0443\u0440\u043D\u0430\u043B \u0414\u0456\u0439"},MAP_HACK:{en:"Map Hack",uk:"\u041C\u0430\u043F-\u0445\u0430\u043A"},ALL:{en:"ALL",uk:"\u0412\u0421\u0406"},ENGAGE:{en:"ENGAGE",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},AUTO:{en:"AUTO",uk:""},NIGHTMARE:{en:"Nightmare",uk:"C\u0442\u0440\u0430\u0445\u0456\u0442\u0442\u044F"},HARD:{en:"Hard",uk:"\u0414\u0443\u0436\u0438\u0439"},NORMAL:{en:"Normal",uk:"\u0417\u0432\u0438\u0447\u0430\u0439\u043D\u0438\u0439"},BABY:{en:"Baby",uk:"\u041C\u0430\u043B\u044F"},RISK:{en:"Mission Risk",uk:"\u0420\u0438\u0437\u0438\u043A \u041C\u0456\u0441\u0456\u0457"},CD:{en:"CD",uk:"\u0427\u0412"},SUPPORT:{en:"Support",uk:"\u0417\u0430\u0441\u043E\u0431\u0438 \u0434\u043B\u044F \u0406\u0441\u043D\u0443\u0432\u0430\u043D\u043D\u044F"},VIEW_LEADERBOARD:{en:"View Leaderboard",uk:"\u041F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044E \u043B\u0456\u0434\u0435\u0440\u0456\u0432"},SAVE_SCORE:{en:"Save Score",uk:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442"},PLAY_AGAIN:{en:"Play Again",uk:"\u0413\u0440\u0430\u0442\u0438 \u0437\u043D\u043E\u0432\u0443"},CONFIRM_NAME:{en:"Confirm Player Name",uk:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u044C\u0442\u0435 \u0456\u043C'\u044F \u0433\u0440\u0430\u0432\u0446\u044F"},ECONOMIC_DOMINATION_GREETING:{en:"ECONOMIC DOMINATION! Forest majority held for 10 turns.",uk:"\u0415\u041A\u041E\u041D\u041E\u041C\u0406\u0427\u041D\u0410 \u0414\u041E\u041C\u0406\u041D\u0410\u0426\u0406\u042F! \u041B\u0456\u0441\u043E\u0432\u0430 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u0443\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},HOSTILE:{en:"Hostile",uk:"\u041F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A"},LFT:{en:"LFT",uk:"\u0445\u043E\u0434\u0456\u0432"},MONOPOLY:{en:"Monopoly:",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F: \u0437\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044F"},TURN_CYCLE:{en:"Turn Cycle",uk:"\u0426\u0438\u043A\u043B \u0445\u043E\u0434\u0456\u0432"},PLAYER:{en:"Player",uk:"\u0413\u0440\u0430\u0432\u0435\u0446\u044C"},COMMANDER:{en:"Commander",uk:"\u041A\u043E\u043C\u0430\u043D\u0434\u0443\u044E\u0447\u0438\u0439"},CONNECT:{en:"Connect",uk:"\u041F\u0456\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044F"},LOGOUT:{en:"Logout",uk:"\u0412\u0438\u0445\u0456\u0434"},VERIFIED:{en:"Verified User",uk:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043E"},RELOAD:{en:"Reload",uk:"\u0420\u0435\u0441\u0442\u0430\u0440\u0442"},INFO:{en:"Info",uk:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430"},RECORDS:{en:"Records",uk:"\u0420\u0435\u043A\u043E\u0440\u0434\u0438"},RANKING:{en:"Ranking",uk:"\u0420\u0435\u0439\u0442\u0438\u043D\u0433"},SHAPE_TACTICS:{en:"Shape Tactics",uk:"Shape Tactics"},TURN_BASED_STRATEGY:{en:"Turn-Based Strategy",uk:"\u041F\u043E\u043A\u0440\u043E\u043A\u043E\u0432\u0430 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u044F"},FEEDBACK_MODULE:{en:"Feedbacks",uk:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438"},STRATEGIC_PLAN:{en:"Roadmap",uk:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0456\u0447\u043D\u0438\u0439 \u041F\u043B\u0430\u043D"},AUTO_ENGAGE:{en:"Auto Engage",uk:"\u0410\u0432\u0442\u043E\u043F\u0456\u043B\u043E\u0442"},SYSTEM_LOG:{en:"Logbook",uk:"\u0420\u0435\u0454\u0441\u0442\u0440\u0438"},COMMUNITY_SIGNALS:{en:"Community Signals",uk:"\u0421\u0438\u0433\u043D\u0430\u043B\u0438 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},RETURN_TO_MAP:{en:"Return to Map",uk:"\u041F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u0438\u0441\u044C \u0434\u043E \u041C\u0430\u043F\u0438"},DEPLOY_REPORT:{en:"Deploy Report",uk:"\u041D\u0430\u0434\u0456\u0441\u043B\u0430\u0442\u0438 \u0417\u0432\u0456\u0442"},OPERATOR_ONLINE:{en:"OPERATOR ONLINE",uk:"\u041E\u041F\u0415\u0420\u0410\u0422\u041E\u0420 \u041D\u0410 \u0417\u0412\u2019\u042F\u0417\u041A\u0423"},EFFICIENCY_RATING:{en:"Efficiency Rating",uk:"\u041A\u043E\u0435\u0444\u0456\u0446\u0456\u0454\u043D\u0442 \u0415\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0456"},TACTICAL_NOTE:{en:"Tactical Note",uk:"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0430 \u041F\u0440\u0438\u043C\u0456\u0442\u043A\u0430"},TRANSMIT_REPORT:{en:"Transmit Report",uk:"\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u0438 \u0414\u0430\u043D\u0456"},FEEDBACK_VALIDATION_RANGE:{en:"Text must be between 10 and 500 characters.",uk:"\u0422\u0435\u043A\u0441\u0442 \u043C\u0430\u0454 \u043C\u0456\u0441\u0442\u0438\u0442\u0438 \u0432\u0456\u0434 10 \u0434\u043E 500 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432."},FEEDBACK_LIMIT_REACHED:{en:"Daily limit reached: 3 feedbacks per 24 hours.",uk:"\u0414\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u0435\u043D\u043D\u0438\u0439 \u043B\u0456\u043C\u0456\u0442: 3 \u0432\u0456\u0434\u0433\u0443\u043A\u0438 \u0437\u0430 24 \u0433\u043E\u0434\u0438\u043D\u0438."},FEEDBACK_SUBMITTED:{en:"Thanks! Your feedback was submitted.",uk:"\u0414\u044F\u043A\u0443\u0454\u043C\u043E! \u0412\u0430\u0448 \u0432\u0456\u0434\u0433\u0443\u043A \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E."},COMMUNITY_SIGNALS_TABLE:{en:"Community Signals Table",uk:"\u0422\u0430\u0431\u043B\u0438\u0446\u044F \u0421\u0438\u0433\u043D\u0430\u043B\u0456\u0432 \u0421\u043F\u0456\u043B\u044C\u043D\u043E\u0442\u0438"},TOGGLE_BACK:{en:"Back",uk:"\u041D\u0430\u0437\u0430\u0434"},VIEW_FULL_ARCHIVE:{en:"View Full Archive",uk:"\u041F\u043E\u0432\u043D\u0438\u0439 \u0410\u0440\u0445\u0456\u0432"},TABLE_OPERATOR:{en:"Operator",uk:"\u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440"},TABLE_RATING:{en:"Rating",uk:"\u041E\u0446\u0456\u043D\u043A\u0430"},TABLE_MESSAGE:{en:"Message",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F"},TABLE_DATE:{en:"Date",uk:"\u0414\u0430\u0442\u0430"},NO_SIGNALS:{en:"No signals",uk:"\u041D\u0435\u043C\u0430\u0454 \u0441\u0438\u0433\u043D\u0430\u043B\u0456\u0432"},PREVIOUS:{en:"Previous",uk:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044F"},NEXT:{en:"Next",uk:"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0430"},GAME_GUIDE:{en:"Game Guide",uk:"\u041F\u043E\u043B\u044C\u043E\u0432\u0438\u0439 \u0414\u043E\u0432\u0456\u0434\u043D\u0438\u043A"},VICTORY_CONDITIONS:{en:"Victory Conditions",uk:"\u0423\u043C\u043E\u0432\u0438 \u041F\u0435\u0440\u0435\u043C\u043E\u0433\u0438"},MONOPOLY_LABEL:{en:"Monopoly",uk:"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F"},MONOPOLY_DESC:{en:"Hold forest majority for 10 turns.",uk:"\u0423\u0442\u0440\u0438\u043C\u0443\u0439\u0442\u0435 \u0431\u0456\u043B\u044C\u0448\u0456\u0441\u0442\u044C \u043B\u0456\u0441\u0456\u0432 \u043F\u0440\u043E\u0442\u044F\u0433\u043E\u043C 10 \u0445\u043E\u0434\u0456\u0432."},ANNIHILATION:{en:"Annihilation",uk:"\u0417\u043D\u0438\u0449\u0435\u043D\u043D\u044F"},ANNIHILATION_DESC:{en:"Reduce enemy Base HP to 0.",uk:"\u0417\u043C\u0435\u043D\u0448\u0442\u0435 HP \u0431\u0430\u0437\u0438 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A\u0430 \u0434\u043E 0."},UNIT_EVOLUTION:{en:"Unit Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},NEW_UNIT_EVOLUTION:{en:"New Unit Evolution",uk:"\u041D\u043E\u0432\u0430 \u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432"},EVOLUTION:{en:"Evolution",uk:"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F"},EVOLUTION_DESC:{en:"Two T2 merge into a T3.",uk:"\u0414\u0432\u0456 T2 \u0437\u043B\u0438\u0432\u0430\u044E\u0442\u044C\u0441\u044F \u0443 T3."},COMBAT_DEEP_DIVE:{en:"Combat Deep-Dive",uk:"\u0411\u043E\u0439\u043E\u0432\u0438\u0439 \u0410\u043D\u0430\u043B\u0456\u0437"},SUCCESSFUL_ATTACK:{en:"Successful Attack",uk:"\u0423\u0441\u043F\u0456\u0448\u043D\u0430 \u0410\u0442\u0430\u043A\u0430"},SUCCESSFUL_ATTACK_DESC:{en:"Attacker tier \u2265 defender; defender downgraded or destroyed.",uk:"\u0420\u0430\u043D\u0433 \u0430\u0442\u0430\u043A\u0443\u044E\u0447\u043E\u0433\u043E \u2265 \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A\u0430; \u0437\u0430\u0445\u0438\u0441\u043D\u0438\u043A \u043F\u043E\u043D\u0438\u0436\u0443\u0454\u0442\u044C\u0441\u044F \u0430\u0431\u043E \u0437\u043D\u0438\u0449\u0443\u0454\u0442\u044C\u0441\u044F."},CRITICAL_HIT:{en:"Critical Hit",uk:"\u041A\u0440\u0438\u0442\u0438\u0447\u043D\u0438\u0439 \u0423\u0434\u0430\u0440"},CRITICAL_HIT_DESC:{en:"Chance-based bonus (tier-scaled)",uk:"\u0419\u043C\u043E\u0432\u0456\u0440\u043D\u0456\u0441\u043D\u0438\u0439 \u0431\u043E\u043D\u0443\u0441 (\u0437\u0430\u043B\u0435\u0436\u0438\u0442\u044C \u0432\u0456\u0434 \u0440\u0430\u043D\u0433\u0443)"},MISS:{en:"Miss",uk:"\u041F\u0440\u043E\u043C\u0430\u0445"},MISS_DESC:{en:"Attack can MISS; lower effective impact.",uk:"\u0410\u0442\u0430\u043A\u0430 \u043C\u043E\u0436\u0435 \u041F\u0420\u041E\u041C\u0410\u0425\u041D\u0423\u0422\u0418\u0421\u042F; \u0437\u043D\u0438\u0436\u0435\u043D\u0438\u0439 \u0435\u0444\u0435\u043A\u0442."},MOVEMENT:{en:"Movement",uk:"\u041C\u0430\u043D\u0435\u0432\u0440\u0443\u0432\u0430\u043D\u043D\u044F"},T1_1_TILE:{en:"T1: 1 tile",uk:"T1: 1 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0430"},T3_3_TILES:{en:"T3: 3 tiles",uk:"T3: 3 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},T4_4_TILES:{en:"T4: 4 tiles",uk:"T4: 4 \u043A\u043B\u0456\u0442\u0438\u043D\u043A\u0438"},FOREST_CYCLE:{en:"Forest Cycle",uk:"\u0426\u0438\u043A\u043B \u041B\u0456\u0441\u0443"},TURN_1:{en:"Turn 1",uk:"\u0425\u0456\u0434 1"},TURN_2:{en:"Turn 2",uk:"\u0425\u0456\u0434 2"},TURN_3:{en:"Turn 3",uk:"\u0425\u0456\u0434 3"},TURN_4:{en:"Turn 4",uk:"\u0425\u0456\u0434 4"},PLUS_8_WOOD_PER_TURN:{en:"+8 Wood/turn",uk:"+8 \u0414\u0435\u0440\u0435\u0432\u0430/\u0445\u0456\u0434"},PLUS_2_IRON_PER_TURN:{en:"+2 Iron/turn",uk:"+2 \u0417\u0430\u043B\u0456\u0437\u0430/\u0445\u0456\u0434"},WALL_LEGEND:{en:"Wall Legend",uk:"\u041B\u0435\u0433\u0435\u043D\u0434\u0430 \u0421\u0442\u0456\u043D"},AI_FACTION:{en:"AI",uk:"AI"}};function QR(n,e){let t=ej[n];return t?t[e]??t.en:n}var Rt=class n{difficultySignal=G("normal");mapSizeSignal=G(10);langSignal=G("uk");customModeSignal=G(!1);version="v.2.1.3";diffArr=["baby","normal","hard","nightmare"];storageKey="shape_tactics_settings";constructor(){this.loadSettings()}difficulty(){return this.difficultySignal()}setDifficulty(e){this.difficultySignal.set(e),this.persistSettings()}difficultyLabel(){let e=this.difficultySignal();return this.getDifficultyLabel(e)}getDifficultyLabel(e){return e==="baby"?"BABY":e==="normal"?"NORMAL":e==="hard"?"HARD":"NIGHTMARE"}getAiReserveBonus(e){let t=this.difficultySignal(),i=e%2===0;return t==="baby"?i?1:0:t==="normal"?1:t==="hard"?2:3}isHard(){return this.difficultySignal()==="hard"}isNightmare(){return this.difficultySignal()==="nightmare"}mapSize(){return this.mapSizeSignal()}setMapSize(e){this.mapSizeSignal.set(e),this.persistSettings()}mapSizeLabel(){return`${this.mapSizeSignal()}x${this.mapSizeSignal()}`}currentLang(){return this.langSignal()}setLang(e){this.langSignal.set(e),this.persistSettings()}t(e){return QR(e,this.langSignal())}customMode(){return this.customModeSignal()}setCustomMode(e){this.customModeSignal.set(e),this.persistSettings()}loadSettings(){if(!(typeof window>"u"))try{let e=localStorage.getItem(this.storageKey);if(!e)return;let t=JSON.parse(e);if(!t||typeof t!="object")return;let i=["baby","normal","hard","nightmare"],r=[10,20,30],o=["en","uk"],s=t.difficulty&&i.includes(t.difficulty)?t.difficulty:this.difficultySignal(),a=t.gridSize&&r.includes(t.gridSize)?t.gridSize:this.mapSizeSignal(),l=t.language&&o.includes(t.language)?t.language:this.langSignal();this.difficultySignal.set(s),this.mapSizeSignal.set(a),this.langSignal.set(l),this.customModeSignal.set(!!t.customMode)}catch{}}persistSettings(){if(!(typeof window>"u"))try{let e={gridSize:this.mapSizeSignal(),difficulty:this.difficultySignal(),language:this.langSignal(),customMode:this.customModeSignal()};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Rg=class n{generateForests(e,t,i){let r=e*e,o=Math.max(1,Math.floor(r*.1)),s=[],a=(l,c)=>{let d=Math.max(Math.abs(l-t.x),Math.abs(c-t.y)),h=Math.max(Math.abs(l-i.x),Math.abs(c-i.y));return d<=3||h<=3};for(;s.length<o;){let l=Math.floor(Math.random()*e),c=Math.floor(Math.random()*e);a(l,c)||s.some(d=>d.x===l&&d.y===c)||s.push({x:l,y:c})}return s}generateMines(e,t,i,r){let o=new Set(r.map(c=>`${c.x},${c.y}`)),s=e===10?4:Math.max(1,Math.floor(e*e*.04)),a=[],l=(c,d)=>{let h=Math.max(Math.abs(c-t.x),Math.abs(d-t.y)),p=Math.max(Math.abs(c-i.x),Math.abs(d-i.y));return h<=3||p<=3};for(;a.length<s;){let c=Math.floor(Math.random()*e),d=Math.floor(Math.random()*e);if(l(c,d))continue;let h=`${c},${d}`;o.has(h)||a.some(p=>p.x===c&&p.y===d)||a.push({x:c,y:d})}return a}computeVisibility(e,t,i,r,o){let s={player:new Set,ai:new Set},a=(d,h)=>d>=0&&d<e&&h>=0&&h<e,l=(d,h,p)=>{a(h,p)&&d.add(`${h},${p}`)},c=(d,h,p)=>{for(let g=-p;g<=p;g++)for(let S=-p;S<=p;S++){let I=h.x+g,P=h.y+S;Math.max(Math.abs(g),Math.abs(S))<=p&&l(d,I,P)}};if(o){for(let d=0;d<e;d++)for(let h=0;h<e;h++)s.player.add(`${d},${h}`),s.ai.add(`${d},${h}`);return s}c(s.player,i,3),c(s.ai,r,3);for(let d of t){let h=d.owner==="player"?s.player:s.ai;c(h,d.position,2)}return s}mergeExplored(e,t){let i=new Set(e);return t.forEach(r=>i.add(r)),i}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ng=class n{getHighestAffordableCost(e){let t=[500,375,250,125,100,75,50,25,20,15,10,5,4,3,2,1];for(let i of t)if(e>=i)return i;return 0}computeWoodGain(e,t){let i=e.filter(r=>r.owner===t).filter(r=>r.position&&r.position.x!==void 0&&r.position.y!==void 0).length;return i>0?i*2:0}applyMonopolyTick(e,t,i){let r=t.length;if(r===0)return{next:{player:0,ai:0}};let o=c=>i.filter(d=>d.owner===c&&t.some(h=>h.x===d.position.x&&h.y===d.position.y)).length,s=o("player"),a=o("ai"),l={player:e.player,ai:e.ai};if(s===r){if(l.player=e.player+1,l.ai=0,l.player>=10)return{next:l,winner:"player"}}else if(a===r){if(l.ai=e.ai+1,l.player=0,l.ai>=10)return{next:l,winner:"ai"}}else l.player=0,l.ai=0;return{next:l}}computeAiReserveDump(e,t,i,r){let o=i,s=[];for(let l=-2;l<=2;l++)for(let c=-2;c<=2;c++){if(l===0&&c===0)continue;let d=t.x+l,h=t.y+c;d<0||d>=e||h<0||h>=e||Math.max(Math.abs(l),Math.abs(c))>2||r(d,h)||s.push({x:d,y:h})}let a=[];for(;o>0&&s.length>0;){let l=this.getHighestAffordableCost(o);if(l<=0)break;let c=this.calculateTierAndLevel(l),d=s.shift();a.push({id:crypto.randomUUID(),position:F({},d),level:c.level,tier:c.tier,points:l,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0}),o-=l}return{created:a,remaining:o}}calculateTierAndLevel(e){let t={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]};if(e<=0)return{tier:1,level:1};for(let i=4;i>=1;i--){let r=t[i];for(let o=r.length;o>=1;o--)if(e>=r[o-1])return{tier:i,level:o}}return{tier:1,level:1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Pg=class n{constructor(e,t){this.combat=e;this.settings=t}goals=new Map;lastPhase="none";interceptUntil=new Map;setGoal(e,t){this.goals.set(e,t)}pickBestMove(e){let t=this.chooseBestEndingAction(e);return t&&(t.type==="move"||t.type==="attack")?{unit:t.unit,target:t.target,reason:t.reason}:null}chooseBestEndingAction(e){let t=e.unitsSignal().filter(_=>_.owner==="ai"&&!_.hasActed);t=t.filter(_=>!(_.tier<=2&&e.isForest(_.position.x,_.position.y)&&e.isAnchoredGatherer(_.id)));let i=typeof e.queuedUnitId=="function"?e.queuedUnitId():null;i&&(t=t.filter(_=>_.id===i));let r=typeof e.currentMood=="function"?e.currentMood():"none",o=this.settings.difficulty()==="baby"?-1e4:r==="rage"?5e4:r==="angry"?1e4:0;if(t.length===0)return null;let s=e.getBasePosition("ai"),a=e.getBasePosition("player"),l=e.forestsSignal(),d=l.filter(_=>!e.getUnitAt(_.x,_.y)).filter(_=>e.isVisibleToAi(_.x,_.y)),h=l.filter(_=>!e.isVisibleToAi(_.x,_.y)),p=e.unitsSignal().filter(_=>_.owner==="ai"&&e.isForest(_.position.x,_.position.y)).length,g=e.unitsSignal().filter(_=>_.owner==="ai").length,S=[1,2,3].some(_=>e.unitsSignal().filter(ae=>ae.owner==="ai"&&ae.tier===_&&!e.isForest(ae.position.x,ae.position.y)).length>=5),I=e.unitsSignal().filter(_=>_.owner==="player"),P=I.some(_=>Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y))<=3),U=I.filter(_=>Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y))<=4),oe=U.length>0,xe=U.filter(_=>Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y))<=2).length>0,Ae=I.some(_=>Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y))<=5),Ie=typeof e.turnSignal=="function"?e.turnSignal()<=40:!1,k=e.unitsSignal().filter(_=>_.owner==="ai"),C=k.filter(_=>_.tier===3&&!e.isForest(_.position.x,_.position.y)).length,N=k.filter(_=>_.tier===4&&!e.isForest(_.position.x,_.position.y)).length,A=C+N>=5,w=A?"full_rush":oe?"defense":Ie?"expansion":"none";if(w!==this.lastPhase){try{console.log(w==="full_rush"?"AI Phase: FULL RUSH ACTIVATED - Initiating All-Out Assault":w==="defense"?"AI Phase: Base Defense Activated":w==="expansion"?"AI Phase: Expansion":"AI Phase: Normal")}catch{}this.lastPhase=w}A&&t.sort((_,ae)=>{let We=Math.abs(_.position.x-a.x)+Math.abs(_.position.y-a.y),qe=Math.abs(ae.position.x-a.x)+Math.abs(ae.position.y-a.y);return We-qe});let R=typeof e.aggressionMode=="function"?!!e.aggressionMode():I.filter(_=>e.isForest(_.position.x,_.position.y)).length*2>=t.filter(_=>e.isForest(_.position.x,_.position.y)).length*2,M=l.length>0?l.every(_=>{let ae=e.getUnitAt(_.x,_.y);return!!ae&&ae.owner==="ai"}):!0,me=l.length>0?l.every(_=>!!e.getUnitAt(_.x,_.y)):!1,Fe=l.filter(_=>{let ae=e.getUnitAt(_.x,_.y);return!!ae&&ae.owner==="player"}),he=null,Vt=t.filter(_=>Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y))<=3).length,Jt={x:Math.floor(e.gridSize/2),y:Math.floor(e.gridSize/2)},Me=U.length>0?U.reduce((_,ae)=>{let We=Math.max(Math.abs(ae.position.x-s.x),Math.abs(ae.position.y-s.y)),qe=Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y));return We<qe?ae:_},U[0]):null,Gt=t.length>0?t.reduce((_,ae)=>this.combat.calculateTotalPoints(ae)>this.combat.calculateTotalPoints(_)?ae:_,t[0]):null,ct=[];if(Me){let _=Me.position.x,ae=Me.position.y,We=Math.sign(s.x-_),qe=Math.sign(s.y-ae),se=0,xt=Math.max(10,e.gridSize*2);for(;_!==s.x||ae!==s.y;){if(se++,se>xt){try{console.warn("[AI] Path build safety break near base")}catch{}break}if(_+=We,ae+=qe,!e.inBounds(_,ae)||_===s.x&&ae===s.y)break;ct.push({x:_,y:ae})}}oe&&Gt&&Me&&(this.goals.set(Gt.id,{x:Me.position.x,y:Me.position.y}),typeof e.turnSignal=="function"&&this.interceptUntil.set(Gt.id,e.turnSignal()+3));let te=new Map(e.aiUnitTimeNearBase()),ne=new Map(e.unitStutterBanSignal?.()??new Map),Ee=new Map;for(let[_,ae]of this.goals.entries())if(ae&&e.isForest(ae.x,ae.y)){let We=`${ae.x},${ae.y}`;Ee.set(We,(Ee.get(We)||0)+1)}for(let _ of t){let ae=e.calculateValidMoves(_),We=Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y))<=3,qe=te.get(_.id)||0,se=this.goals.get(_.id)||null,xt=se!==null,Si=xt?(()=>{let $=e.getUnitAt(se.x,se.y);return!!($&&$.owner==="ai"&&this.combat.calculateTotalPoints($)>=this.combat.calculateTotalPoints(_))})():!1,ri=(!xt||Si)&&(!e.isForest(_.position.x,_.position.y)||Ae||_.tier>=3),Is=typeof e.totalWarMode=="function"?e.totalWarMode():!1;if(ri){if(Is)se={x:a.x,y:a.y};else if(e.isForest(_.position.x,_.position.y)){let $=I.filter(L=>e.isForest(L.position.x,L.position.y));if(R&&$.length>0){let L=$.reduce((J,Z)=>{let Te=Math.abs(_.position.x-Z.position.x)+Math.abs(_.position.y-Z.position.y),Le=Math.abs(_.position.x-J.position.x)+Math.abs(_.position.y-J.position.y);return Te<Le?Z:J},$[0]);se={x:L.position.x,y:L.position.y}}else{let L=I.length===0?null:[...I].sort((Z,Te)=>{let Le=Math.abs(_.position.x-Z.position.x)+Math.abs(_.position.y-Z.position.y),Xe=Math.abs(_.position.x-Te.position.x)+Math.abs(_.position.y-Te.position.y);return Le-Xe})[0];L?se={x:L.position.x,y:L.position.y}:d.length>0?se=d.reduce((J,Z)=>Math.abs(_.position.x-Z.x)+Math.abs(_.position.y-Z.y)<Math.abs(_.position.x-J.x)+Math.abs(_.position.y-J.y)?Z:J,d[0]):h.length>0?se=h.reduce((J,Z)=>Math.abs(_.position.x-Z.x)+Math.abs(_.position.y-Z.y)<Math.abs(_.position.x-J.x)+Math.abs(_.position.y-J.y)?Z:J,h[0]):se={x:0,y:0}}}else{let $=I.filter(L=>e.isForest(L.position.x,L.position.y)).map(L=>({x:L.position.x,y:L.position.y}));if($.length>0)se=$.reduce((J,Z)=>{let Te=Math.abs(_.position.x-Z.x)+Math.abs(_.position.y-Z.y),Le=Math.abs(_.position.x-J.x)+Math.abs(_.position.y-J.y);return Te<Le?Z:J},$[0]);else if(d.length>0){let L=Math.min(...d.map(Z=>Ee.get(`${Z.x},${Z.y}`)||0)),J=d.filter(Z=>(Ee.get(`${Z.x},${Z.y}`)||0)===L);se=J.reduce((Z,Te)=>Math.abs(_.position.x-Te.x)+Math.abs(_.position.y-Te.y)<Math.abs(_.position.x-Z.x)+Math.abs(_.position.y-Z.y)?Te:Z,J[0])}else if(h.length>0){let L=Math.min(...h.map(Z=>Ee.get(`${Z.x},${Z.y}`)||0)),J=h.filter(Z=>(Ee.get(`${Z.x},${Z.y}`)||0)===L);se=J.reduce((Z,Te)=>Math.abs(_.position.x-Te.x)+Math.abs(_.position.y-Te.y)<Math.abs(_.position.x-Z.x)+Math.abs(_.position.y-Z.y)?Te:Z,J[0])}else{let L=I.length===0?null:[...I].sort((Z,Te)=>{let Le=Math.abs(_.position.x-Z.position.x)+Math.abs(_.position.y-Z.position.y),Xe=Math.abs(_.position.x-Te.position.x)+Math.abs(_.position.y-Te.position.y);return Le-Xe})[0];se=L?{x:L.position.x,y:L.position.y}:{x:0,y:0}}}this.goals.set(_.id,se)}Vt>3&&qe>=5&&(se=Jt);let Hn=e.isForest(_.position.x,_.position.y),xc=Hn&&(_.forestOccupationTurns??0)>0&&!(_.productionActive??!1),Sc=e.unitsSignal().some($=>$.owner==="ai"&&$.id!==_.id&&$.tier<=2&&Math.max(Math.abs($.position.x-_.position.x),Math.abs($.position.y-_.position.y))<=2);if(xc&&!Ae&&_.tier<3){this.goals.set(_.id,{x:_.position.x,y:_.position.y});continue}if(_.tier>=3){let $=l,L=$.length?$.reduce((Z,Te)=>{let Le=Math.abs(_.position.x-Te.x)+Math.abs(_.position.y-Te.y),Xe=Math.abs(_.position.x-Z.x)+Math.abs(_.position.y-Z.y);return Le<Xe?Te:Z},$[0]):null;if((_.forestOccupationTurns??0)===0&&!Hn&&L&&(se={x:L.x,y:L.y},this.goals.set(_.id,se)),Hn&&Sc){this.goals.set(_.id,{x:a.x,y:a.y});let Z=[{x:_.position.x+1,y:_.position.y},{x:_.position.x-1,y:_.position.y},{x:_.position.x,y:_.position.y+1},{x:_.position.x,y:_.position.y-1}].filter(Le=>e.inBounds(Le.x,Le.y));if(Z.filter(Le=>!!e.getWallBetween(_.position.x,_.position.y,Le.x,Le.y)).length===Z.length){let Le=Z.reduce((Xe,ht)=>{let St=Math.abs(ht.x-a.x)+Math.abs(ht.y-a.y),yt=Math.abs(Xe.x-a.x)+Math.abs(Xe.y-a.y);return St<yt?ht:Xe});he={unit:_,target:{x:_.position.x,y:_.position.y},score:22e5,type:"wall_attack",reason:"Siege: Breakthrough (Handover)",edge:{from:F({},_.position),to:Le}};continue}}}if(ae.some($=>$.x===a.x&&$.y===a.y)){let $=_.tier===3&&_.level>=2||_.tier>=4?3e5:0,L=5e7+o+$;(he===null||L>he.score)&&(he={unit:_,target:{x:a.x,y:a.y},score:L,type:"attack",reason:"Siege: Attack Base (WIN)"})}else{let $=[{x:a.x+1,y:a.y},{x:a.x-1,y:a.y},{x:a.x,y:a.y+1},{x:a.x,y:a.y-1}].filter(L=>e.inBounds(L.x,L.y));for(let L of $){let J=e.getWallBetween(a.x,a.y,L.x,L.y);if(J&&J.owner==="neutral"){if(_.position.x===L.x&&_.position.y===L.y||_.position.x===a.x&&_.position.y===a.y){let Te=_.tier===3&&_.level>=2||_.tier>=4?3e5:0,Le=2e6+o+Te;(he===null||Le>he.score)&&(he={unit:_,target:F({},_.position),score:Le,type:"wall_attack",reason:"Siege: Destroy Base Wall",edge:{from:{x:a.x,y:a.y},to:{x:L.x,y:L.y}}})}else if(ae.some(Le=>Le.x===L.x&&Le.y===L.y||Le.x===a.x&&Le.y===a.y)){let Le=ae.find(yt=>yt.x===L.x&&yt.y===L.y||yt.x===a.x&&yt.y===a.y),Xe=_.tier===3&&_.level>=2||_.tier>=4?3e5:0,ht=18e5+o+Xe;(he===null||ht>he.score)&&(he={unit:_,target:{x:Le.x,y:Le.y},score:ht,type:"move",reason:"Siege: Position at Base Wall"})}}}}if(se){let $=e.getUnitAt(se.x,se.y);if($&&$.owner==="player"&&e.isForest(se.x,se.y)){let L=se.x,J=se.y;if(ae.some(Te=>Te.x===L&&Te.y===J)){(he===null||3e5>he.score)&&(he={unit:_,target:{x:L,y:J},score:3e5,type:"attack",reason:"Attack Enemy on Forest"});continue}else{let Te=d.length>0?d:h;if(Te.length>0)se=Te.reduce((Xe,ht)=>{let St=Math.abs(_.position.x-ht.x)+Math.abs(_.position.y-ht.y),yt=Math.abs(_.position.x-Xe.x)+Math.abs(_.position.y-Xe.y);return St<yt?ht:Xe},Te[0]),this.goals.set(_.id,se);else continue}}}let Pt=null;if(se&&e.isForest(se.x,se.y)&&!e.getUnitAt(se.x,se.y)){let L=[{x:se.x+1,y:se.y},{x:se.x-1,y:se.y},{x:se.x,y:se.y+1},{x:se.x,y:se.y-1}].filter(J=>e.inBounds(J.x,J.y)).filter(J=>{let Z=e.getWallBetween(J.x,J.y,se.x,se.y);return!!(Z&&Z.owner==="neutral")});L.length>0&&(Pt=L.reduce((J,Z)=>{let Te=Math.abs(_.position.x-J.x)+Math.abs(_.position.y-J.y);return Math.abs(_.position.x-Z.x)+Math.abs(_.position.y-Z.y)+3<Te?Z:J},L[0]))}let $r=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(let $ of $r){let L={x:_.position.x+$.x,y:_.position.y+$.y};if(!e.inBounds(L.x,L.y)||!e.isForest(L.x,L.y)||e.getUnitAt(L.x,L.y))continue;let Z=e.getWallBetween(_.position.x,_.position.y,L.x,L.y);if(Z&&(Z.owner==="neutral"||Z.owner==="ai")){let Te=(_.tier>=3?7e6:9e5)+o,Le=Z.owner==="ai"?"Sabotage Own Wall to Forest":"Breach Neutral Wall to Forest";(he===null||Te>he.score)&&(he={unit:_,target:{x:_.position.x,y:_.position.y},score:Te,type:"wall_attack",reason:Le,edge:{from:F({},_.position),to:L}})}else if(Z&&Z.owner==="player"){let Le=[{x:L.x+1,y:L.y},{x:L.x-1,y:L.y},{x:L.x,y:L.y+1},{x:L.x,y:L.y-1}].filter(St=>e.inBounds(St.x,St.y)).filter(St=>e.getUnitAt(St.x,St.y)?!1:!e.getWallBetween(St.x,St.y,L.x,L.y)),Xe=Math.abs(_.position.x-L.x)+Math.abs(_.position.y-L.y);if((Le.length>0?Le.reduce((St,yt)=>{let yn=Math.abs(_.position.x-yt.x)+Math.abs(_.position.y-yt.y)+1;return Math.min(St,yn)},1/0):1/0)-Xe>4){let St=(_.tier>=3?8e6:_.tier===3&&_.level===1?105e4:85e4)+o;(he===null||St>he.score)&&(he={unit:_,target:{x:_.position.x,y:_.position.y},score:St,type:"wall_attack",reason:"Attack Player Wall to Forest",edge:{from:F({},_.position),to:L}})}}}for(let $ of $r){let L={x:_.position.x+$.x,y:_.position.y+$.y};if(L.x===a.x&&L.y===a.y){let J=e.getWallBetween(_.position.x,_.position.y,L.x,L.y);if(J&&(J.owner==="neutral"||J.owner==="player")&&_.tier>=3){let Z=8e6+o;(he===null||Z>he.score)&&(he={unit:_,target:{x:_.position.x,y:_.position.y},score:Z,type:"wall_attack",reason:"Breach Wall to Base",edge:{from:F({},_.position),to:L}})}}}if(se){let $=Math.sign(se.x-_.position.x),L=Math.sign(se.y-_.position.y),J=_.position.x+($!==0?$:0),Z=_.position.y+(L!==0?L:0);if(e.inBounds(J,Z)){let Te=e.getUnitAt(J,Z);if(Te&&Te.owner==="ai")for(let Le of $r){let Xe={x:_.position.x+Le.x,y:_.position.y+Le.y};if(!e.inBounds(Xe.x,Xe.y))continue;let ht=e.getWallBetween(_.position.x,_.position.y,Xe.x,Xe.y);if(ht&&(ht.owner==="player"||ht.owner==="neutral")){let yt=(ht.owner==="player"?65e4:6e5)+o;(he===null||yt>he.score)&&(he={unit:_,target:{x:_.position.x,y:_.position.y},score:yt,type:"wall_attack",reason:"Anti-Clustering: Adjacent Wall Attack",edge:{from:F({},_.position),to:Xe}})}}}}if(se){let $=se.x-_.position.x,L=se.y-_.position.y;if($!==0&&L===0||$===0&&L!==0){let J=Math.sign($),Z=Math.sign(L),Te={x:_.position.x+J,y:_.position.y+Z};if(e.inBounds(Te.x,Te.y)&&e.getWallBetween(_.position.x,_.position.y,Te.x,Te.y)){let Xe=(_.tier>=3?8e6:15e5)+o;(he===null||Xe>he.score)&&(he={unit:_,target:{x:_.position.x,y:_.position.y},score:Xe,type:"wall_attack",reason:"Wall Breaker: Unblock Path",edge:{from:F({},_.position),to:Te}})}}if(Math.abs($)>=1&&Math.abs(L)>=1){let J=Math.sign($),Z=Math.sign(L),Te={x:_.position.x+J,y:_.position.y+Z};if(e.inBounds(Te.x,Te.y)&&this.combat.isDiagonalBlocked(_.position,Te,(Xe,ht,St,yt)=>e.getWallBetween(Xe,ht,St,yt))){let Xe={x:_.position.x+J,y:_.position.y},ht={x:_.position.x,y:_.position.y+Z},St=e.getWallBetween(_.position.x,_.position.y,Xe.x,Xe.y),yt=e.getWallBetween(_.position.x,_.position.y,ht.x,ht.y),yn=null;if(St?yn={from:F({},_.position),to:Xe}:yt&&(yn={from:F({},_.position),to:ht}),yn){let No=(_.tier>=3?8e6:15e5)+o;(he===null||No>he.score)&&(he={unit:_,target:{x:_.position.x,y:_.position.y},score:No,type:"wall_attack",reason:"Wall Breaker: Unblock Diagonal Path",edge:yn})}}}}let R0=d.length===0&&h.length===0&&!Pt;if(qe>=2&&(R0||I.length>0))for(let $ of $r){let L={x:_.position.x+$.x,y:_.position.y+$.y};if(!e.inBounds(L.x,L.y))continue;let J=e.getWallBetween(_.position.x,_.position.y,L.x,L.y);if(J&&(J.owner==="neutral"||J.owner==="player")){let Z=_.tier>=3?8e6:12e5;(he===null||Z>he.score)&&(he={unit:_,target:{x:_.position.x,y:_.position.y},score:Z,type:"wall_attack",reason:"Anti-Stagnation: Break Obstacle",edge:{from:F({},_.position),to:L}})}}let lr=I.filter($=>Math.max(Math.abs($.position.x-_.position.x),Math.abs($.position.y-_.position.y))===1),Ro=lr.length>0?lr.reduce(($,L)=>this.combat.calculateTotalPoints(L)>this.combat.calculateTotalPoints($)?L:$,lr[0]):null,Ts=ct.length>0&&ae.some($=>ct.some(L=>L.x===$.x&&L.y===$.y));for(let $ of ae){let L=0,J="Action",Z=e.getUnitAt($.x,$.y),Te=be=>[{x:be.x+1,y:be.y},{x:be.x-1,y:be.y},{x:be.x,y:be.y+1},{x:be.x,y:be.y-1}].filter(At=>e.inBounds(At.x,At.y)).filter(At=>!e.getUnitAt(At.x,At.y)).length,Le=Math.max(Math.abs(_.position.x-s.x),Math.abs(_.position.y-s.y)),Xe=Math.max(Math.abs($.x-s.x),Math.abs($.y-s.y)),ht=l.length?Math.min(...l.map(be=>Math.abs(_.position.x-be.x)+Math.abs(_.position.y-be.y))):1/0,St=l.length?Math.min(...l.map(be=>Math.abs($.x-be.x)+Math.abs($.y-be.y))):1/0,yt=l.filter(be=>{let je=e.getUnitAt(be.x,be.y);return!!je&&je.owner==="player"}),yn=yt.length?Math.min(...yt.map(be=>Math.abs(_.position.x-be.x)+Math.abs(_.position.y-be.y))):1/0,No=yt.length?Math.min(...yt.map(be=>Math.abs($.x-be.x)+Math.abs($.y-be.y))):1/0,Ic=new Map(e.unitMoveHistorySignal()).get(_.id),oi=Array.isArray(Ic)?Ic:[],Gr=oi.length>=2?oi[oi.length-2]:null,zt=oi.length>=3?oi[oi.length-3]:null,dh=Gr&&$.x===Gr.x&&$.y===Gr.y,zr=Hn&&!e.isForest($.x,$.y);if(A){let be=Math.abs(_.position.x-a.x)+Math.abs(_.position.y-a.y),je=Math.abs($.x-a.x)+Math.abs($.y-a.y);je<be?(L+=5e7,J="FULL RUSH: Charge Base"):je===be?L+=1e5:L-=5e6,Z&&Z.owner==="player"&&Math.abs(Z.position.x-a.x)+Math.abs(Z.position.y-a.y)<be&&(L+=2e7,J="FULL RUSH: Clear Path to Base"),Hn&&$.x===_.position.x&&$.y===_.position.y&&p>=3&&(L=-5e6,J="FULL RUSH: Abandon Forest for Assault")}else if(_.tier>=3&&zr){let be=Math.abs($.x-a.x)+Math.abs($.y-a.y)<=2,je=I.some(Ut=>Math.abs($.x-Ut.position.x)+Math.abs($.y-Ut.position.y)<=2),At=e.unitsSignal().some(Ut=>Ut.owner==="ai"&&Ut.id!==_.id&&Math.max(Math.abs(Ut.position.x-_.position.x),Math.abs(Ut.position.y-_.position.y))<=1);!M&&!(be||je)&&!At&&(L-=2e6,J="Penalty: Leaving forest without replacement")}let Wr=ne.get(_.id),N0=Wr&&Wr.until>e.turnSignal()&&Wr.tiles.has(`${$.x},${$.y}`);if(_.tier===1&&(Gr&&$.x===Gr.x&&$.y===Gr.y||zt&&$.x===zt.x&&$.y===zt.y)&&(L-=25e3,J="Anti-Loop Penalty"),_.tier<=2&&!Z&&zt&&$.x===zt.x&&$.y===zt.y&&(L=-1e6,J="Anti-Loop: Stay or different path"),N0&&(L-=3e4,J="Stutter Ban Penalty"),Hn&&lr.length===0&&!Z&&zr&&!oe&&(L=-1e3),Hn&&_.tier<=2&&zr&&lr.length>0&&lr.some(je=>this.combat.calculateTotalPoints(je)>this.combat.calculateTotalPoints(_))&&(L=-1e6,J="Hold Forest"),A)Hn&&$.x===_.position.x&&$.y===_.position.y&&p>=3&&(L=-5e6,J="FULL RUSH: Abandon Forest for Assault");else if(!Z&&Hn&&$.x===_.position.x&&$.y===_.position.y){let be=lr.some(At=>this.combat.calculateTotalPoints(At)>this.combat.calculateTotalPoints(_)),je=M&&_.tier>=3;!be&&!je&&(L=Math.max(L,1e7),J="Hold: Stay on forest")}if(!Z&&!A){if(e.isForest($.x,$.y)&&!e.getUnitAt($.x,$.y)&&(Is?(L=-1e3,J="Ignore Forest (Total War)"):_.tier>=3?(L=5e6*(Ie&&!oe?3:1),J="Priority: T3 capture empty forest"):(L=1e6*(Ie&&!oe?3:1),J=p<3?`Priority 0: Capture Forest ${$.x},${$.y}`:`Priority 1: Capture Forest ${$.x},${$.y}`,Ie&&!oe&&Math.abs(_.position.x-$.x)+Math.abs(_.position.y-$.y)===1&&(L=Math.max(L,12e6),J=`Early Capture: Forest ${$.x},${$.y}`))),se){let be=Math.abs(_.position.x-se.x)+Math.abs(_.position.y-se.y),je=Math.abs($.x-se.x)+Math.abs($.y-se.y);if(je<be&&(L+=5e4*(be-je),J=d.length>0?`Priority 1: Toward Forest ${se.x},${se.y}`:h.length>0?`Priority 7: Toward Fog Forest ${se.x},${se.y}`:`Toward Goal ${se.x},${se.y}`),g>10||S){let Ut=Math.abs(_.position.x-a.x)+Math.abs(_.position.y-a.y),kt=Math.abs($.x-a.x)+Math.abs($.y-a.y);kt<Ut&&(L+=15e4*(Ut-kt),J="Aggress: Toward Player Base"),No<yn&&(L+=12e4*(yn-No),J="Aggress: Toward Player Forest");let vn=Te($)-Te(_.position);vn>0&&(L+=5e4*vn,J="Unblock: Clear path")}if((()=>{let Ut=Math.sign(se.x-_.position.x),kt=Math.sign(se.y-_.position.y),vn=_.position.x+(Ut!==0?Ut:0),Ot=_.position.y+(kt!==0?kt:0);return e.inBounds(vn,Ot)?!!e.getWallBetween(_.position.x,_.position.y,vn,Ot):!1})()&&$.x===_.position.x&&$.y===_.position.y){let kt=e.getWallBetween(_.position.x,_.position.y,_.position.x+Math.sign(se.x-_.position.x),_.position.y+Math.sign(se.y-_.position.y))?.owner;_.tier>=3?(L=Math.max(L,8e6+o),J="Breach: Wall blocks high-priority path"):(L+=(kt==="ai"?7e5:8e5)+o,J=kt==="ai"?"Sabotage: Own Wall Blocks Path":"Siege: Breakthrough")}}if(Pt){let be=Math.abs(_.position.x-Pt.x)+Math.abs(_.position.y-Pt.y),je=Math.abs($.x-Pt.x)+Math.abs($.y-Pt.y);je<be&&(L+=2e5*(be-je),J="Approach Neutral Wall to Forest"),$.x===Pt.x&&$.y===Pt.y&&(L+=5e5,J="Position for Wall Breach")}if($.x===a.x&&$.y===a.y&&(L+=1e4,J="Attack Base (Override)"),Me){let be=ct.some(Ot=>Ot.x===$.x&&Ot.y===$.y),je=Math.abs(_.position.x-Me.position.x)+Math.abs(_.position.y-Me.position.y),At=Math.abs($.x-Me.position.x)+Math.abs($.y-Me.position.y),kt=Math.max(Math.abs(Me.position.x-s.x),Math.abs(Me.position.y-s.y))<=2,vn=$.x===_.position.x&&$.y===_.position.y;if(_.tier>=3&&Me.tier>=3&&At===1)L=4e7,J="DEFENSE: T3 Move to Intercept Threat";else if(be){let Ot=kt?25e5:15e5;L<Ot&&(L=Ot),L+=kt?2e4:5e3,J=kt?"Panic Defense: Block Path To Base":"Defense: Block Path To Base"}else if(At<je){let Ot=_.id===(Gt?.id??"")?1e6:5e3;L+=Ot*(je-At),_.tier>=3&&(L+=4e3),J=_.id===(Gt?.id??"")?"DEFENSE: Strongest Intercept":"Defense: Move Toward Base Threat"}vn&&Ts&&(L-=kt?5e4:1e4,xe?J="Penalty: Standing Still With Imminent Base Threat":oe&&(J="Penalty: Standing Still With Base Threat"))}if(_.tier>=3){let be=Math.abs(_.position.x-a.x)+Math.abs(_.position.y-a.y),je=Math.abs($.x-a.x)+Math.abs($.y-a.y);je<be&&(L+=2e3*(be-je),J="Hunter: Toward Base",M&&(L=Math.max(L,4e6),J="Hunt: Approach Base"))}if(We&&St<ht&&(L*=10),Xe>Le&&St<ht&&(L+=500),Ro&&this.combat.calculateTotalPoints(Ro)>this.combat.calculateTotalPoints(_)){let be=Math.abs(_.position.x-Ro.position.x)+Math.abs(_.position.y-Ro.position.y),je=Math.abs($.x-Ro.position.x)+Math.abs($.y-Ro.position.y);je>be&&(L+=75e3*(je-be),J="Retreat")}}else if(Z.owner==="player"){let be=Math.max(Math.abs(Z.position.x-s.x),Math.abs(Z.position.y-s.y)),je=be<=3,At=be<=2,Ut=this.combat.calculateTotalPoints(_),kt=this.combat.calculateTotalPoints(Z),vn=Ut>kt,Ot=Z.tier>=3,Cs=_.tier>=3;_.tier>=3&&e.isForest(Z.position.x,Z.position.y)&&(L=1e7,J="Aggression: Liberate forest"),!Hn&&me&&yt.length>0&&e.isForest(Z.position.x,Z.position.y)&&(L=12e6,J="LIBERATE: Attack player forest"),be<=4&&(_.tier>=3||vn)&&(L=15e6,J="INTERCEPT: Base Siege"),je?Cs&&Ot?(L=5e7,J="CRITICAL DEFENSE: T3 Intercepts Threat"):vn?(L=2e7,J="CRITICAL DEFENSE: Eliminate Base Threat",At&&(L+=5e6)):Ot&&_.tier<=2?(L=0,J="Ignore: T1 Suicide vs T3 useless"):(L=1e3,J="DEFENSE: Desperation Attack"):vn?(Ot?(L=8e6,J="COMBAT: Kill High Value Target (T3+)"):(L=4e6,J="COMBAT: Kill Enemy"),_.tier<Z.tier&&(L+=2e6,J+=" (Efficient Trade)")):_.tier<=2?(L=0,J="Ignore: No guaranteed kill"):(L=1e5,J="COMBAT: Chip Damage"),R&&(L+=5e5),P&&(L+=1e6)}else if(Z.tier===_.tier&&Xe>Le){let be=this.combat.calculateTotalPoints(_)+this.combat.calculateTotalPoints(Z),{tier:je}=this.combat.calculateTierAndLevel(be);je>_.tier&&!We&&!Hn&&(L=1e3,J="Merge Up")}let Bi="move";Z&&Z.owner==="player"&&(Bi="attack"),Z&&Z.owner==="ai"&&Z.tier===_.tier&&(Bi="merge"),(g>10||S)&&Bi==="merge"&&(L+=5e6,J="Anti-Stall: Merge first");let P0=this.interceptUntil.get(_.id)||0;if(_.id===(Gt?.id??"")&&P0>(typeof e.turnSignal=="function"?e.turnSignal():0)&&Me){let be=Math.abs(_.position.x-Me.position.x)+Math.abs(_.position.y-Me.position.y),je=Math.abs($.x-Me.position.x)+Math.abs($.y-Me.position.y);je<be&&(L+=5e5*(be-je),J="DEFENSE: Intercept Lock")}dh&&(L=Math.floor(L*.1),L-=3e5,J="Penalty: Inertia");let k0=(()=>{let be=oi.slice(-6),je=new Set(be.map(At=>`${At.x},${At.y}`));return be.length>=6&&je.size<=3})();if(_.tier===1&&k0){let be=d.length>0?d:h;if(be.length>0){let je=be.reduce((kt,vn)=>{let Ot=Math.abs(_.position.x-vn.x)+Math.abs(_.position.y-vn.y),Cs=Math.abs(_.position.x-kt.x)+Math.abs(_.position.y-kt.y);return Ot<Cs?vn:kt},be[0]),At=Math.abs(_.position.x-je.x)+Math.abs(_.position.y-je.y),Ut=Math.abs($.x-je.x)+Math.abs($.y-je.y);Ut<At&&(L+=1e5*(At-Ut),J="Breakout: Toward Forest")}}(_.forestOccupationTurns??0)>0&&($.x!==_.position.x||$.y!==_.position.y)&&(L-=2e3),(he===null||L>he.score)&&(he={unit:_,target:$,score:L,type:Bi,reason:J})}}if(!he)return null;let ve=this.goals.get(he.unit.id),ye=ve?`Goal: Forest at ${ve.x},${ve.y}`:"Goal: None";return{type:he.type,unit:he.unit,target:he.target,reason:he.reason,edge:he.edge}}getWallBuildActions(e){let t=[],i=e.unitsSignal().filter(d=>d.owner==="ai"),r=e.unitsSignal().filter(d=>d.owner==="player"),o=e.wallsSignal(),s=typeof e.totalWarMode=="function"?e.totalWarMode():!1,a=(d,h)=>o.some(p=>p.tile1.x===d.x&&p.tile1.y===d.y&&p.tile2.x===h.x&&p.tile2.y===h.y||p.tile1.x===h.x&&p.tile1.y===h.y&&p.tile2.x===d.x&&p.tile2.y===d.y),l=(d,h)=>Math.abs(d.x-h.x)+Math.abs(d.y-h.y),c=(d,h)=>Math.max(Math.abs(d.x-h.x),Math.abs(d.y-h.y));for(let d of i){if(d.tier>=3)continue;let h=[{x:d.position.x+1,y:d.position.y},{x:d.position.x-1,y:d.position.y},{x:d.position.x,y:d.position.y+1},{x:d.position.x,y:d.position.y-1}].filter(I=>e.inBounds(I.x,I.y));if(s&&e.isForest(d.position.x,d.position.y)){for(let I of h)!a(d.position,I)&&e.canBuildWallBetween(d.position,I)&&t.push({from:d.position,to:I});continue}let p=r.filter(I=>c(d.position,I.position)<=2);if(p.length===0)continue;let g=p.sort((I,P)=>l(d.position,I.position)-l(d.position,P.position))[0],S=h.sort((I,P)=>l(I,g.position)-l(P,g.position));if(d.tier===1&&e.isForest(d.position.x,d.position.y))for(let I of S)!a(d.position,I)&&e.canBuildWallBetween(d.position,I)&&t.push({from:d.position,to:I});else if(d.tier===2){let I=0;for(let P of S){if(I>=2)break;!a(d.position,P)&&e.canBuildWallBetween(d.position,P)&&(t.push({from:d.position,to:P}),I++)}}}return t}static \u0275fac=function(t){return new(t||n)(De(Ll),De(Rt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var JR=()=>{};var e2=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},rj=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=n[t++],s=n[t++],a=n[t++],l=((r&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63)}}return e.join("")},t2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,a=s?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,d=o>>2,h=(o&3)<<4|a>>4,p=(a&15)<<2|c>>6,g=c&63;l||(g=64,s||(p=64)),i.push(t[d],t[h],t[p],t[g])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(e2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):rj(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let c=r<n.length?t[n.charAt(r)]:64;++r;let h=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||a==null||c==null||h==null)throw new Eb;let p=o<<2|a>>4;if(i.push(p),c!==64){let g=a<<4&240|c>>2;if(i.push(g),h!==64){let S=c<<6&192|h;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Eb=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},oj=function(n){let e=e2(n);return t2.encodeByteArray(e,!0)},gd=function(n){return oj(n).replace(/\./g,"")},Og=function(n){try{return t2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function n2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var sj=()=>n2().__FIREBASE_DEFAULTS__,aj=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},lj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Og(n[1]);return e&&JSON.parse(e)},Fg=()=>{try{return JR()||sj()||aj()||lj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},wb=n=>Fg()?.emulatorHosts?.[n],i2=n=>{let e=wb(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},xb=()=>Fg()?.config,Sb=n=>Fg()?.[`_${n}`];var kg=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function ls(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Lg(n){return(await fetch(n,{credentials:"include"})).ok}function r2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=F({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[gd(JSON.stringify(t)),gd(JSON.stringify(s)),""].join(".")}var pd={};function cj(){let n={prod:[],emulator:[]};for(let e of Object.keys(pd))pd[e]?n.emulator.push(e):n.prod.push(e);return n}function uj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var ZR=!1;function Vg(n,e){if(typeof window>"u"||typeof document>"u"||!ls(window.location.host)||pd[n]===e||pd[n]||ZR)return;pd[n]=e;function t(p){return`__firebase__banner__${p}`}let i="__firebase__banner",o=cj().prod.length>0;function s(){let p=document.getElementById(i);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){let p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{ZR=!0,s()},p}function d(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function h(){let p=uj(i),g=t("text"),S=document.getElementById(g)||document.createElement("span"),I=t("learnmore"),P=document.getElementById(I)||document.createElement("a"),U=t("preprendIcon"),oe=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){let Se=p.element;a(Se),d(P,I);let xe=c();l(oe,U),Se.append(oe,S,P,xe),document.body.appendChild(Se)}o?(S.innerText="Preview backend disconnected.",oe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(oe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function o2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function dj(){let n=Fg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function s2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function a2(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function l2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function c2(){let n=In();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function u2(){return!dj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ib(){try{return typeof indexedDB=="object"}catch{return!1}}function d2(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var hj="FirebaseError",bi=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=hj,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ho.prototype.create)}},ho=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?fj(o,i):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new bi(r,a,i)}};function fj(n,e){return n.replace(pj,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var pj=/\{\$([^}]+)}/g;function h2(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function nr(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(XR(o)&&XR(s)){if(!nr(o,s))return!1}else if(o!==s)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function XR(n){return n!==null&&typeof n=="object"}function Vl(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function f2(n,e){let t=new bb(n,e);return t.subscribe.bind(t)}var bb=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");gj(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=_b),r.error===void 0&&(r.error=_b),r.complete===void 0&&(r.complete=_b);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function gj(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function _b(){}var fue=14400*1e3;function Tn(n){return n&&n._delegate?n._delegate:n}var Fi=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var _a="[DEFAULT]";var Tb=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new kg;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yj(e))try{this.getOrInitializeService({instanceIdentifier:_a})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=_a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_a){return this.instances.has(e)}getOptions(e=_a){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&s.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:mj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=_a){return this.component?this.component.multipleInstances?e:_a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function mj(n){return n===_a?void 0:n}function yj(n){return n.instantiationMode==="EAGER"}var Ug=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Tb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var vj=[],tt=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(tt||{}),_j={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},Ej=tt.INFO,bj={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},wj=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=bj[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},cs=class{constructor(e){this.name=e,this._logLevel=Ej,this._logHandler=wj,this._userLogHandler=null,vj.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_j[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}};var xj=(n,e)=>e.some(t=>n instanceof t),p2,g2;function Sj(){return p2||(p2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ij(){return g2||(g2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var m2=new WeakMap,Db=new WeakMap,y2=new WeakMap,Cb=new WeakMap,Mb=new WeakMap;function Tj(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Nr(n.result)),r()},s=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&m2.set(t,n)}).catch(()=>{}),Mb.set(e,n),e}function Cj(n){if(Db.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Db.set(n,e)}var Ab={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Db.get(n);if(e==="objectStoreNames")return n.objectStoreNames||y2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Nr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function v2(n){Ab=n(Ab)}function Dj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(Bg(this),e,...t);return y2.set(i,e.sort?e.sort():[e]),Nr(i)}:Ij().includes(n)?function(...e){return n.apply(Bg(this),e),Nr(m2.get(this))}:function(...e){return Nr(n.apply(Bg(this),e))}}function Aj(n){return typeof n=="function"?Dj(n):(n instanceof IDBTransaction&&Cj(n),xj(n,Sj())?new Proxy(n,Ab):n)}function Nr(n){if(n instanceof IDBRequest)return Tj(n);if(Cb.has(n))return Cb.get(n);let e=Aj(n);return e!==n&&(Cb.set(n,e),Mb.set(e,n)),e}var Bg=n=>Mb.get(n);function E2(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),a=Nr(s);return i&&s.addEventListener("upgradeneeded",l=>{i(Nr(s.result),l.oldVersion,l.newVersion,Nr(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var Mj=["get","getKey","getAll","getAllKeys","count"],Rj=["put","add","delete","clear"],Rb=new Map;function _2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Rb.get(e))return Rb.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Rj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Mj.includes(t)))return;let o=async function(s,...a){let l=this.transaction(s,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return Rb.set(e,o),o}v2(n=>fe(F({},n),{get:(e,t,i)=>_2(e,t)||n.get(e,t,i),has:(e,t)=>!!_2(e,t)||n.has(e,t)}));var Pb=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Nj(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function Nj(n){return n.getComponent()?.type==="VERSION"}var kb="@firebase/app",b2="0.14.7";var fo=new cs("@firebase/app"),Pj="@firebase/app-compat",kj="@firebase/analytics-compat",Oj="@firebase/analytics",Fj="@firebase/app-check-compat",Lj="@firebase/app-check",Vj="@firebase/auth",Uj="@firebase/auth-compat",Bj="@firebase/database",jj="@firebase/data-connect",Hj="@firebase/database-compat",$j="@firebase/functions",Gj="@firebase/functions-compat",zj="@firebase/installations",Wj="@firebase/installations-compat",qj="@firebase/messaging",Kj="@firebase/messaging-compat",Yj="@firebase/performance",Qj="@firebase/performance-compat",Jj="@firebase/remote-config",Zj="@firebase/remote-config-compat",Xj="@firebase/storage",e9="@firebase/storage-compat",t9="@firebase/firestore",n9="@firebase/ai",i9="@firebase/firestore-compat",r9="firebase",o9="12.8.0";var Ob="[DEFAULT]",s9={[kb]:"fire-core",[Pj]:"fire-core-compat",[Oj]:"fire-analytics",[kj]:"fire-analytics-compat",[Lj]:"fire-app-check",[Fj]:"fire-app-check-compat",[Vj]:"fire-auth",[Uj]:"fire-auth-compat",[Bj]:"fire-rtdb",[jj]:"fire-data-connect",[Hj]:"fire-rtdb-compat",[$j]:"fire-fn",[Gj]:"fire-fn-compat",[zj]:"fire-iid",[Wj]:"fire-iid-compat",[qj]:"fire-fcm",[Kj]:"fire-fcm-compat",[Yj]:"fire-perf",[Qj]:"fire-perf-compat",[Jj]:"fire-rc",[Zj]:"fire-rc-compat",[Xj]:"fire-gcs",[e9]:"fire-gcs-compat",[t9]:"fire-fst",[i9]:"fire-fst-compat",[n9]:"fire-vertex","fire-js":"fire-js",[r9]:"fire-js-all"};var jg=new Map,a9=new Map,Fb=new Map;function w2(n,e){try{n.container.addComponent(e)}catch(t){fo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ds(n){let e=n.name;if(Fb.has(e))return fo.debug(`There were multiple attempts to register component ${e}.`),!1;Fb.set(e,n);for(let t of jg.values())w2(t,n);for(let t of a9.values())w2(t,n);return!0}function yd(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function wi(n){return n==null?!1:n.settings!==void 0}var l9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},us=new ho("app","Firebase",l9);var Lb=class{constructor(e,t,i){this._isDeleted=!1,this._options=F({},e),this._config=F({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw us.create("app-deleted",{appName:this._name})}};var hs=o9;function vd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=F({name:Ob,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw us.create("bad-app-name",{appName:String(r)});if(t||(t=xb()),!t)throw us.create("no-options");let o=jg.get(r);if(o){if(nr(t,o.options)&&nr(i,o.config))return o;throw us.create("duplicate-app",{appName:r})}let s=new Ug(r);for(let l of Fb.values())s.addComponent(l);let a=new Lb(t,i,s);return jg.set(r,a),a}function Hg(n=Ob){let e=jg.get(n);if(!e&&n===Ob&&xb())return vd();if(!e)throw us.create("no-app",{appName:n});return e}function ir(n,e,t){let i=s9[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let s=[`Unable to register library "${i}" with version "${e}":`];r&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fo.warn(s.join(" "));return}ds(new Fi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var c9="firebase-heartbeat-database",u9=1,md="firebase-heartbeat-store",Nb=null;function T2(){return Nb||(Nb=E2(c9,u9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(md)}catch(t){console.warn(t)}}}}).catch(n=>{throw us.create("idb-open",{originalErrorMessage:n.message})})),Nb}async function d9(n){try{let t=(await T2()).transaction(md),i=await t.objectStore(md).get(C2(n));return await t.done,i}catch(e){if(e instanceof bi)fo.warn(e.message);else{let t=us.create("idb-get",{originalErrorMessage:e?.message});fo.warn(t.message)}}}async function x2(n,e){try{let i=(await T2()).transaction(md,"readwrite");await i.objectStore(md).put(e,C2(n)),await i.done}catch(t){if(t instanceof bi)fo.warn(t.message);else{let i=us.create("idb-set",{originalErrorMessage:t?.message});fo.warn(i.message)}}}function C2(n){return`${n.name}!${n.options.appId}`}var h9=1024,f9=30,Vb=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Ub(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=S2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>f9){let r=g9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=S2(),{heartbeatsToSend:t,unsentEntries:i}=p9(this._heartbeatsCache.heartbeats),r=gd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return fo.warn(e),""}}};function S2(){return new Date().toISOString().substring(0,10)}function p9(n,e=h9){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),I2(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),I2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Ub=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ib()?d2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await d9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return x2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let i=await this.read();return x2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function I2(n){return gd(JSON.stringify({version:2,heartbeats:n})).length}function g9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function m9(n){ds(new Fi("platform-logger",e=>new Pb(e),"PRIVATE")),ds(new Fi("heartbeat",e=>new Vb(e),"PRIVATE")),ir(kb,b2,n),ir(kb,b2,"esm2020"),ir("fire-js","")}m9("");var y9="firebase",v9="12.8.0";ir(y9,v9,"app");var D2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},A2={};var po,Bb;(function(){var n;function e(k,C){function N(){}N.prototype=C.prototype,k.F=C.prototype,k.prototype=new N,k.prototype.constructor=k,k.D=function(A,w,R){for(var M=Array(arguments.length-2),me=2;me<arguments.length;me++)M[me-2]=arguments[me];return C.prototype[w].apply(A,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,C,N){N||(N=0);let A=Array(16);if(typeof C=="string")for(var w=0;w<16;++w)A[w]=C.charCodeAt(N++)|C.charCodeAt(N++)<<8|C.charCodeAt(N++)<<16|C.charCodeAt(N++)<<24;else for(w=0;w<16;++w)A[w]=C[N++]|C[N++]<<8|C[N++]<<16|C[N++]<<24;C=k.g[0],N=k.g[1],w=k.g[2];let R=k.g[3],M;M=C+(R^N&(w^R))+A[0]+3614090360&4294967295,C=N+(M<<7&4294967295|M>>>25),M=R+(w^C&(N^w))+A[1]+3905402710&4294967295,R=C+(M<<12&4294967295|M>>>20),M=w+(N^R&(C^N))+A[2]+606105819&4294967295,w=R+(M<<17&4294967295|M>>>15),M=N+(C^w&(R^C))+A[3]+3250441966&4294967295,N=w+(M<<22&4294967295|M>>>10),M=C+(R^N&(w^R))+A[4]+4118548399&4294967295,C=N+(M<<7&4294967295|M>>>25),M=R+(w^C&(N^w))+A[5]+1200080426&4294967295,R=C+(M<<12&4294967295|M>>>20),M=w+(N^R&(C^N))+A[6]+2821735955&4294967295,w=R+(M<<17&4294967295|M>>>15),M=N+(C^w&(R^C))+A[7]+4249261313&4294967295,N=w+(M<<22&4294967295|M>>>10),M=C+(R^N&(w^R))+A[8]+1770035416&4294967295,C=N+(M<<7&4294967295|M>>>25),M=R+(w^C&(N^w))+A[9]+2336552879&4294967295,R=C+(M<<12&4294967295|M>>>20),M=w+(N^R&(C^N))+A[10]+4294925233&4294967295,w=R+(M<<17&4294967295|M>>>15),M=N+(C^w&(R^C))+A[11]+2304563134&4294967295,N=w+(M<<22&4294967295|M>>>10),M=C+(R^N&(w^R))+A[12]+1804603682&4294967295,C=N+(M<<7&4294967295|M>>>25),M=R+(w^C&(N^w))+A[13]+4254626195&4294967295,R=C+(M<<12&4294967295|M>>>20),M=w+(N^R&(C^N))+A[14]+2792965006&4294967295,w=R+(M<<17&4294967295|M>>>15),M=N+(C^w&(R^C))+A[15]+1236535329&4294967295,N=w+(M<<22&4294967295|M>>>10),M=C+(w^R&(N^w))+A[1]+4129170786&4294967295,C=N+(M<<5&4294967295|M>>>27),M=R+(N^w&(C^N))+A[6]+3225465664&4294967295,R=C+(M<<9&4294967295|M>>>23),M=w+(C^N&(R^C))+A[11]+643717713&4294967295,w=R+(M<<14&4294967295|M>>>18),M=N+(R^C&(w^R))+A[0]+3921069994&4294967295,N=w+(M<<20&4294967295|M>>>12),M=C+(w^R&(N^w))+A[5]+3593408605&4294967295,C=N+(M<<5&4294967295|M>>>27),M=R+(N^w&(C^N))+A[10]+38016083&4294967295,R=C+(M<<9&4294967295|M>>>23),M=w+(C^N&(R^C))+A[15]+3634488961&4294967295,w=R+(M<<14&4294967295|M>>>18),M=N+(R^C&(w^R))+A[4]+3889429448&4294967295,N=w+(M<<20&4294967295|M>>>12),M=C+(w^R&(N^w))+A[9]+568446438&4294967295,C=N+(M<<5&4294967295|M>>>27),M=R+(N^w&(C^N))+A[14]+3275163606&4294967295,R=C+(M<<9&4294967295|M>>>23),M=w+(C^N&(R^C))+A[3]+4107603335&4294967295,w=R+(M<<14&4294967295|M>>>18),M=N+(R^C&(w^R))+A[8]+1163531501&4294967295,N=w+(M<<20&4294967295|M>>>12),M=C+(w^R&(N^w))+A[13]+2850285829&4294967295,C=N+(M<<5&4294967295|M>>>27),M=R+(N^w&(C^N))+A[2]+4243563512&4294967295,R=C+(M<<9&4294967295|M>>>23),M=w+(C^N&(R^C))+A[7]+1735328473&4294967295,w=R+(M<<14&4294967295|M>>>18),M=N+(R^C&(w^R))+A[12]+2368359562&4294967295,N=w+(M<<20&4294967295|M>>>12),M=C+(N^w^R)+A[5]+4294588738&4294967295,C=N+(M<<4&4294967295|M>>>28),M=R+(C^N^w)+A[8]+2272392833&4294967295,R=C+(M<<11&4294967295|M>>>21),M=w+(R^C^N)+A[11]+1839030562&4294967295,w=R+(M<<16&4294967295|M>>>16),M=N+(w^R^C)+A[14]+4259657740&4294967295,N=w+(M<<23&4294967295|M>>>9),M=C+(N^w^R)+A[1]+2763975236&4294967295,C=N+(M<<4&4294967295|M>>>28),M=R+(C^N^w)+A[4]+1272893353&4294967295,R=C+(M<<11&4294967295|M>>>21),M=w+(R^C^N)+A[7]+4139469664&4294967295,w=R+(M<<16&4294967295|M>>>16),M=N+(w^R^C)+A[10]+3200236656&4294967295,N=w+(M<<23&4294967295|M>>>9),M=C+(N^w^R)+A[13]+681279174&4294967295,C=N+(M<<4&4294967295|M>>>28),M=R+(C^N^w)+A[0]+3936430074&4294967295,R=C+(M<<11&4294967295|M>>>21),M=w+(R^C^N)+A[3]+3572445317&4294967295,w=R+(M<<16&4294967295|M>>>16),M=N+(w^R^C)+A[6]+76029189&4294967295,N=w+(M<<23&4294967295|M>>>9),M=C+(N^w^R)+A[9]+3654602809&4294967295,C=N+(M<<4&4294967295|M>>>28),M=R+(C^N^w)+A[12]+3873151461&4294967295,R=C+(M<<11&4294967295|M>>>21),M=w+(R^C^N)+A[15]+530742520&4294967295,w=R+(M<<16&4294967295|M>>>16),M=N+(w^R^C)+A[2]+3299628645&4294967295,N=w+(M<<23&4294967295|M>>>9),M=C+(w^(N|~R))+A[0]+4096336452&4294967295,C=N+(M<<6&4294967295|M>>>26),M=R+(N^(C|~w))+A[7]+1126891415&4294967295,R=C+(M<<10&4294967295|M>>>22),M=w+(C^(R|~N))+A[14]+2878612391&4294967295,w=R+(M<<15&4294967295|M>>>17),M=N+(R^(w|~C))+A[5]+4237533241&4294967295,N=w+(M<<21&4294967295|M>>>11),M=C+(w^(N|~R))+A[12]+1700485571&4294967295,C=N+(M<<6&4294967295|M>>>26),M=R+(N^(C|~w))+A[3]+2399980690&4294967295,R=C+(M<<10&4294967295|M>>>22),M=w+(C^(R|~N))+A[10]+4293915773&4294967295,w=R+(M<<15&4294967295|M>>>17),M=N+(R^(w|~C))+A[1]+2240044497&4294967295,N=w+(M<<21&4294967295|M>>>11),M=C+(w^(N|~R))+A[8]+1873313359&4294967295,C=N+(M<<6&4294967295|M>>>26),M=R+(N^(C|~w))+A[15]+4264355552&4294967295,R=C+(M<<10&4294967295|M>>>22),M=w+(C^(R|~N))+A[6]+2734768916&4294967295,w=R+(M<<15&4294967295|M>>>17),M=N+(R^(w|~C))+A[13]+1309151649&4294967295,N=w+(M<<21&4294967295|M>>>11),M=C+(w^(N|~R))+A[4]+4149444226&4294967295,C=N+(M<<6&4294967295|M>>>26),M=R+(N^(C|~w))+A[11]+3174756917&4294967295,R=C+(M<<10&4294967295|M>>>22),M=w+(C^(R|~N))+A[2]+718787259&4294967295,w=R+(M<<15&4294967295|M>>>17),M=N+(R^(w|~C))+A[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(w+(M<<21&4294967295|M>>>11))&4294967295,k.g[2]=k.g[2]+w&4294967295,k.g[3]=k.g[3]+R&4294967295}i.prototype.v=function(k,C){C===void 0&&(C=k.length);let N=C-this.blockSize,A=this.C,w=this.h,R=0;for(;R<C;){if(w==0)for(;R<=N;)r(this,k,R),R+=this.blockSize;if(typeof k=="string"){for(;R<C;)if(A[w++]=k.charCodeAt(R++),w==this.blockSize){r(this,A),w=0;break}}else for(;R<C;)if(A[w++]=k[R++],w==this.blockSize){r(this,A),w=0;break}}this.h=w,this.o+=C},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;C=this.o*8;for(var N=k.length-8;N<k.length;++N)k[N]=C&255,C/=256;for(this.v(k),k=Array(16),C=0,N=0;N<4;++N)for(let A=0;A<32;A+=8)k[C++]=this.g[N]>>>A&255;return k};function o(k,C){var N=a;return Object.prototype.hasOwnProperty.call(N,k)?N[k]:N[k]=C(k)}function s(k,C){this.h=C;let N=[],A=!0;for(let w=k.length-1;w>=0;w--){let R=k[w]|0;A&&R==C||(N[w]=R,A=!1)}this.g=N}var a={};function l(k){return-128<=k&&k<128?o(k,function(C){return new s([C|0],C<0?-1:0)}):new s([k|0],k<0?-1:0)}function c(k){if(isNaN(k)||!isFinite(k))return h;if(k<0)return P(c(-k));let C=[],N=1;for(let A=0;k>=N;A++)C[A]=k/N|0,N*=4294967296;return new s(C,0)}function d(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return P(d(k.substring(1),C));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');let N=c(Math.pow(C,8)),A=h;for(let R=0;R<k.length;R+=8){var w=Math.min(8,k.length-R);let M=parseInt(k.substring(R,R+w),C);w<8?(w=c(Math.pow(C,w)),A=A.j(w).add(c(M))):(A=A.j(N),A=A.add(c(M)))}return A}var h=l(0),p=l(1),g=l(16777216);n=s.prototype,n.m=function(){if(I(this))return-P(this).m();let k=0,C=1;for(let N=0;N<this.g.length;N++){let A=this.i(N);k+=(A>=0?A:4294967296+A)*C,C*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(S(this))return"0";if(I(this))return"-"+P(this).toString(k);let C=c(Math.pow(k,6));var N=this;let A="";for(;;){let w=xe(N,C).g;N=U(N,w.j(C));let R=((N.g.length>0?N.g[0]:N.h)>>>0).toString(k);if(N=w,S(N))return R+A;for(;R.length<6;)R="0"+R;A=R+A}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function S(k){if(k.h!=0)return!1;for(let C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function I(k){return k.h==-1}n.l=function(k){return k=U(this,k),I(k)?-1:S(k)?0:1};function P(k){let C=k.g.length,N=[];for(let A=0;A<C;A++)N[A]=~k.g[A];return new s(N,~k.h).add(p)}n.abs=function(){return I(this)?P(this):this},n.add=function(k){let C=Math.max(this.g.length,k.g.length),N=[],A=0;for(let w=0;w<=C;w++){let R=A+(this.i(w)&65535)+(k.i(w)&65535),M=(R>>>16)+(this.i(w)>>>16)+(k.i(w)>>>16);A=M>>>16,R&=65535,M&=65535,N[w]=M<<16|R}return new s(N,N[N.length-1]&-2147483648?-1:0)};function U(k,C){return k.add(P(C))}n.j=function(k){if(S(this)||S(k))return h;if(I(this))return I(k)?P(this).j(P(k)):P(P(this).j(k));if(I(k))return P(this.j(P(k)));if(this.l(g)<0&&k.l(g)<0)return c(this.m()*k.m());let C=this.g.length+k.g.length,N=[];for(var A=0;A<2*C;A++)N[A]=0;for(A=0;A<this.g.length;A++)for(let w=0;w<k.g.length;w++){let R=this.i(A)>>>16,M=this.i(A)&65535,me=k.i(w)>>>16,Fe=k.i(w)&65535;N[2*A+2*w]+=M*Fe,oe(N,2*A+2*w),N[2*A+2*w+1]+=R*Fe,oe(N,2*A+2*w+1),N[2*A+2*w+1]+=M*me,oe(N,2*A+2*w+1),N[2*A+2*w+2]+=R*me,oe(N,2*A+2*w+2)}for(k=0;k<C;k++)N[k]=N[2*k+1]<<16|N[2*k];for(k=C;k<2*C;k++)N[k]=0;return new s(N,0)};function oe(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function Se(k,C){this.g=k,this.h=C}function xe(k,C){if(S(C))throw Error("division by zero");if(S(k))return new Se(h,h);if(I(k))return C=xe(P(k),C),new Se(P(C.g),P(C.h));if(I(C))return C=xe(k,P(C)),new Se(P(C.g),C.h);if(k.g.length>30){if(I(k)||I(C))throw Error("slowDivide_ only works with positive integers.");for(var N=p,A=C;A.l(k)<=0;)N=Ae(N),A=Ae(A);var w=Ie(N,1),R=Ie(A,1);for(A=Ie(A,2),N=Ie(N,2);!S(A);){var M=R.add(A);M.l(k)<=0&&(w=w.add(N),R=M),A=Ie(A,1),N=Ie(N,1)}return C=U(k,w.j(C)),new Se(w,C)}for(w=h;k.l(C)>=0;){for(N=Math.max(1,Math.floor(k.m()/C.m())),A=Math.ceil(Math.log(N)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),R=c(N),M=R.j(C);I(M)||M.l(k)>0;)N-=A,R=c(N),M=R.j(C);S(R)&&(R=p),w=w.add(R),k=U(k,M)}return new Se(w,k)}n.B=function(k){return xe(this,k).h},n.and=function(k){let C=Math.max(this.g.length,k.g.length),N=[];for(let A=0;A<C;A++)N[A]=this.i(A)&k.i(A);return new s(N,this.h&k.h)},n.or=function(k){let C=Math.max(this.g.length,k.g.length),N=[];for(let A=0;A<C;A++)N[A]=this.i(A)|k.i(A);return new s(N,this.h|k.h)},n.xor=function(k){let C=Math.max(this.g.length,k.g.length),N=[];for(let A=0;A<C;A++)N[A]=this.i(A)^k.i(A);return new s(N,this.h^k.h)};function Ae(k){let C=k.g.length+1,N=[];for(let A=0;A<C;A++)N[A]=k.i(A)<<1|k.i(A-1)>>>31;return new s(N,k.h)}function Ie(k,C){let N=C>>5;C%=32;let A=k.g.length-N,w=[];for(let R=0;R<A;R++)w[R]=C>0?k.i(R+N)>>>C|k.i(R+N+1)<<32-C:k.i(R+N);return new s(w,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Bb=A2.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=d,po=A2.Integer=s}).apply(typeof D2<"u"?D2:typeof self<"u"?self:typeof window<"u"?window:{});var $g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},go={};var jb,_9,Ul,Hb,_d,Gg,$b,Gb,zb;(function(){var n,e=Object.defineProperty;function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof $g=="object"&&$g];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var i=t(this);function r(u,f){if(f)e:{var m=i;u=u.split(".");for(var D=0;D<u.length-1;D++){var V=u[D];if(!(V in m))break e;m=m[V]}u=u[u.length-1],D=m[u],f=f(D),f!=D&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(u){return u||function(f){var m=[],D;for(D in f)Object.prototype.hasOwnProperty.call(f,D)&&m.push([D,f[D]]);return m}});var o=o||{},s=this||self;function a(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function l(u,f,m){return u.call.apply(u.bind,arguments)}function c(u,f,m){return c=l,c.apply(null,arguments)}function d(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var D=m.slice();return D.push.apply(D,arguments),u.apply(this,D)}}function h(u,f){function m(){}m.prototype=f.prototype,u.Z=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Ob=function(D,V,j){for(var de=Array(arguments.length-2),Ze=2;Ze<arguments.length;Ze++)de[Ze-2]=arguments[Ze];return f.prototype[V].apply(D,de)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function g(u){let f=u.length;if(f>0){let m=Array(f);for(let D=0;D<f;D++)m[D]=u[D];return m}return[]}function S(u,f){for(let D=1;D<arguments.length;D++){let V=arguments[D];var m=typeof V;if(m=m!="object"?m:V?Array.isArray(V)?"array":m:"null",m=="array"||m=="object"&&typeof V.length=="number"){m=u.length||0;let j=V.length||0;u.length=m+j;for(let de=0;de<j;de++)u[m+de]=V[de]}else u.push(V)}}class I{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function P(u){s.setTimeout(()=>{throw u},0)}function U(){var u=k;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class oe{constructor(){this.h=this.g=null}add(f,m){let D=Se.get();D.set(f,m),this.h?this.h.next=D:this.g=D,this.h=D}}var Se=new I(()=>new xe,u=>u.reset());class xe{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,Ie=!1,k=new oe,C=()=>{let u=Promise.resolve(void 0);Ae=()=>{u.then(N)}};function N(){for(var u;u=U();){try{u.h.call(u.g)}catch(m){P(m)}var f=Se;f.j(u),f.h<100&&(f.h++,u.next=f.g,f.g=u)}Ie=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};s.addEventListener("test",m,f),s.removeEventListener("test",m,f)}catch{}return u})();function M(u){return/^[\s\xa0]*$/.test(u)}function me(u,f){w.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,f)}h(me,w),me.prototype.init=function(u,f){let m=this.type=u.type,D=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget,f||(m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement)),this.relatedTarget=f,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&me.Z.h.call(this)},me.prototype.h=function(){me.Z.h.call(this);let u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Fe="closure_listenable_"+(Math.random()*1e6|0),he=0;function Vt(u,f,m,D,V){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!D,this.ha=V,this.key=++he,this.da=this.fa=!1}function Jt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Me(u,f,m){for(let D in u)f.call(m,u[D],D,u)}function Gt(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function ct(u){let f={};for(let m in u)f[m]=u[m];return f}let te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(u,f){let m,D;for(let V=1;V<arguments.length;V++){D=arguments[V];for(m in D)u[m]=D[m];for(let j=0;j<te.length;j++)m=te[j],Object.prototype.hasOwnProperty.call(D,m)&&(u[m]=D[m])}}function Ee(u){this.src=u,this.g={},this.h=0}Ee.prototype.add=function(u,f,m,D,V){let j=u.toString();u=this.g[j],u||(u=this.g[j]=[],this.h++);let de=ye(u,f,D,V);return de>-1?(f=u[de],m||(f.fa=!1)):(f=new Vt(f,this.src,j,!!D,V),f.fa=m,u.push(f)),f};function ve(u,f){let m=f.type;if(m in u.g){var D=u.g[m],V=Array.prototype.indexOf.call(D,f,void 0),j;(j=V>=0)&&Array.prototype.splice.call(D,V,1),j&&(Jt(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function ye(u,f,m,D){for(let V=0;V<u.length;++V){let j=u[V];if(!j.da&&j.listener==f&&j.capture==!!m&&j.ha==D)return V}return-1}var _="closure_lm_"+(Math.random()*1e6|0),ae={};function We(u,f,m,D,V){if(D&&D.once)return xt(u,f,m,D,V);if(Array.isArray(f)){for(let j=0;j<f.length;j++)We(u,f[j],m,D,V);return null}return m=Sc(m),u&&u[Fe]?u.J(f,m,a(D)?!!D.capture:!!D,V):qe(u,f,m,!1,D,V)}function qe(u,f,m,D,V,j){if(!f)throw Error("Invalid event type");let de=a(V)?!!V.capture:!!V,Ze=Hn(u);if(Ze||(u[_]=Ze=new Ee(u)),m=Ze.add(f,m,D,de,j),m.proxy)return m;if(D=se(),m.proxy=D,D.src=u,D.listener=m,u.addEventListener)R||(V=de),V===void 0&&(V=!1),u.addEventListener(f.toString(),D,V);else if(u.attachEvent)u.attachEvent(Is(f.toString()),D);else if(u.addListener&&u.removeListener)u.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return m}function se(){function u(m){return f.call(u.src,u.listener,m)}let f=uh;return u}function xt(u,f,m,D,V){if(Array.isArray(f)){for(let j=0;j<f.length;j++)xt(u,f[j],m,D,V);return null}return m=Sc(m),u&&u[Fe]?u.K(f,m,a(D)?!!D.capture:!!D,V):qe(u,f,m,!0,D,V)}function Si(u,f,m,D,V){if(Array.isArray(f))for(var j=0;j<f.length;j++)Si(u,f[j],m,D,V);else D=a(D)?!!D.capture:!!D,m=Sc(m),u&&u[Fe]?(u=u.i,j=String(f).toString(),j in u.g&&(f=u.g[j],m=ye(f,m,D,V),m>-1&&(Jt(f[m]),Array.prototype.splice.call(f,m,1),f.length==0&&(delete u.g[j],u.h--)))):u&&(u=Hn(u))&&(f=u.g[f.toString()],u=-1,f&&(u=ye(f,m,D,V)),(m=u>-1?f[u]:null)&&ri(m))}function ri(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[Fe])ve(f.i,u);else{var m=u.type,D=u.proxy;f.removeEventListener?f.removeEventListener(m,D,u.capture):f.detachEvent?f.detachEvent(Is(m),D):f.addListener&&f.removeListener&&f.removeListener(D),(m=Hn(f))?(ve(m,u),m.h==0&&(m.src=null,f[_]=null)):Jt(u)}}}function Is(u){return u in ae?ae[u]:ae[u]="on"+u}function uh(u,f){if(u.da)u=!0;else{f=new me(f,this);let m=u.listener,D=u.ha||u.src;u.fa&&ri(u),u=m.call(D,f)}return u}function Hn(u){return u=u[_],u instanceof Ee?u:null}var xc="__closure_events_fn_"+(Math.random()*1e9>>>0);function Sc(u){return typeof u=="function"?u:(u[xc]||(u[xc]=function(f){return u.handleEvent(f)}),u[xc])}function An(){A.call(this),this.i=new Ee(this),this.M=this,this.G=null}h(An,A),An.prototype[Fe]=!0,An.prototype.removeEventListener=function(u,f,m,D){Si(this,u,f,m,D)};function Pt(u,f){var m,D=u.G;if(D)for(m=[];D;D=D.G)m.push(D);if(u=u.M,D=f.type||f,typeof f=="string")f=new w(f,u);else if(f instanceof w)f.target=f.target||u;else{var V=f;f=new w(D,u),ne(f,V)}V=!0;let j,de;if(m)for(de=m.length-1;de>=0;de--)j=f.g=m[de],V=$r(j,D,!0,f)&&V;if(j=f.g=u,V=$r(j,D,!0,f)&&V,V=$r(j,D,!1,f)&&V,m)for(de=0;de<m.length;de++)j=f.g=m[de],V=$r(j,D,!1,f)&&V}An.prototype.N=function(){if(An.Z.N.call(this),this.i){var u=this.i;for(let f in u.g){let m=u.g[f];for(let D=0;D<m.length;D++)Jt(m[D]);delete u.g[f],u.h--}}this.G=null},An.prototype.J=function(u,f,m,D){return this.i.add(String(u),f,!1,m,D)},An.prototype.K=function(u,f,m,D){return this.i.add(String(u),f,!0,m,D)};function $r(u,f,m,D){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();let V=!0;for(let j=0;j<f.length;++j){let de=f[j];if(de&&!de.da&&de.capture==m){let Ze=de.listener,pn=de.ha||de.src;de.fa&&ve(u.i,de),V=Ze.call(pn,D)!==!1&&V}}return V&&!D.defaultPrevented}function R0(u,f){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=c(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:s.setTimeout(u,f||0)}function lr(u){u.g=R0(()=>{u.g=null,u.i&&(u.i=!1,lr(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class Ro extends A{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:lr(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ts(u){A.call(this),this.h=u,this.g={}}h(Ts,A);var $=[];function L(u){Me(u.g,function(f,m){this.g.hasOwnProperty(m)&&ri(f)},u),u.g={}}Ts.prototype.N=function(){Ts.Z.N.call(this),L(this)},Ts.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var J=s.JSON.stringify,Z=s.JSON.parse,Te=class{stringify(u){return s.JSON.stringify(u,void 0)}parse(u){return s.JSON.parse(u,void 0)}};function Le(){}function Xe(){}var ht={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function St(){w.call(this,"d")}h(St,w);function yt(){w.call(this,"c")}h(yt,w);var yn={},No=null;function Ba(){return No=No||new An}yn.Ia="serverreachability";function Ic(u){w.call(this,yn.Ia,u)}h(Ic,w);function oi(u){let f=Ba();Pt(f,new Ic(f))}yn.STAT_EVENT="statevent";function Gr(u,f){w.call(this,yn.STAT_EVENT,u),this.stat=f}h(Gr,w);function zt(u){let f=Ba();Pt(f,new Gr(f,u))}yn.Ja="timingevent";function dh(u,f){w.call(this,yn.Ja,u),this.size=f}h(dh,w);function zr(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){u()},f)}function Wr(){this.g=!0}Wr.prototype.ua=function(){this.g=!1};function N0(u,f,m,D,V,j){u.info(function(){if(u.g)if(j){var de="",Ze=j.split("&");for(let Ct=0;Ct<Ze.length;Ct++){var pn=Ze[Ct].split("=");if(pn.length>1){let _n=pn[0];pn=pn[1];let ur=_n.split("_");de=ur.length>=2&&ur[1]=="type"?de+(_n+"="+pn+"&"):de+(_n+"=redacted&")}}}else de=null;else de=j;return"XMLHTTP REQ ("+D+") [attempt "+V+"]: "+f+`
`+m+`
`+de})}function H1(u,f,m,D,V,j,de){u.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+V+"]: "+f+`
`+m+`
`+j+" "+de})}function Bi(u,f,m,D){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+k0(u,m)+(D?" "+D:"")})}function P0(u,f){u.info(function(){return"TIMEOUT: "+f})}Wr.prototype.info=function(){};function k0(u,f){if(!u.g)return f;if(!f)return null;try{let j=JSON.parse(f);if(j){for(u=0;u<j.length;u++)if(Array.isArray(j[u])){var m=j[u];if(!(m.length<2)){var D=m[1];if(Array.isArray(D)&&!(D.length<1)){var V=D[0];if(V!="noop"&&V!="stop"&&V!="close")for(let de=1;de<D.length;de++)D[de]=""}}}}return J(j)}catch{return f}}var be={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},je={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},At;function Ut(){}h(Ut,Le),Ut.prototype.g=function(){return new XMLHttpRequest},At=new Ut;function kt(u){return encodeURIComponent(String(u))}function vn(u){var f=1;u=u.split(":");let m=[];for(;f>0&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function Ot(u,f,m,D){this.j=u,this.i=f,this.l=m,this.S=D||1,this.V=new Ts(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cs}function Cs(){this.i=null,this.g="",this.h=!1}var $1={},O0={};function F0(u,f,m){u.M=1,u.A=fh(cr(f)),u.u=m,u.R=!0,G1(u,null)}function G1(u,f){u.F=Date.now(),hh(u),u.B=cr(u.A);var m=u.B,D=u.S;Array.isArray(D)||(D=[String(D)]),iS(m.i,"t",D),u.C=0,m=u.j.L,u.h=new Cs,u.g=bS(u.j,m?f:null,!u.u),u.P>0&&(u.O=new Ro(c(u.Y,u,u.g),u.P)),f=u.V,m=u.g,D=u.ba;var V="readystatechange";Array.isArray(V)||(V&&($[0]=V.toString()),V=$);for(let j=0;j<V.length;j++){let de=We(m,V[j],D||f.handleEvent,!1,f.h||f);if(!de)break;f.g[de.key]=de}f=u.J?ct(u.J):{},u.u?(u.v||(u.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,f)):(u.v="GET",u.g.ea(u.B,u.v,null,f)),oi(),N0(u.i,u.v,u.B,u.l,u.S,u.u)}Ot.prototype.ba=function(u){u=u.target;let f=this.O;f&&Oo(u)==3?f.j():this.Y(u)},Ot.prototype.Y=function(u){try{if(u==this.g)e:{let Ze=Oo(this.g),pn=this.g.ya(),Ct=this.g.ca();if(!(Ze<3)&&(Ze!=3||this.g&&(this.h.h||this.g.la()||uS(this.g)))){this.K||Ze!=4||pn==7||(pn==8||Ct<=0?oi(3):oi(2)),L0(this);var f=this.g.ca();this.X=f;var m=RO(this);if(this.o=f==200,H1(this.i,this.v,this.B,this.l,this.S,Ze,f),this.o){if(this.U&&!this.L){t:{if(this.g){var D,V=this.g;if((D=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(D)){var j=D;break t}}j=null}if(u=j)Bi(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,V0(this,u);else{this.o=!1,this.m=3,zt(12),Ds(this),Tc(this);break e}}if(this.R){u=!0;let _n;for(;!this.K&&this.C<m.length;)if(_n=NO(this,m),_n==O0){Ze==4&&(this.m=4,zt(14),u=!1),Bi(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==$1){this.m=4,zt(15),Bi(this.i,this.l,m,"[Invalid Chunk]"),u=!1;break}else Bi(this.i,this.l,_n,null),V0(this,_n);if(z1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||m.length!=0||this.h.h||(this.m=1,zt(16),u=!1),this.o=this.o&&u,!u)Bi(this.i,this.l,m,"[Invalid Chunked Response]"),Ds(this),Tc(this);else if(m.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+m.length),z0(de),de.P=!0,zt(11))}}else Bi(this.i,this.l,m,null),V0(this,m);Ze==4&&Ds(this),this.o&&!this.K&&(Ze==4?yS(this.j,this):(this.o=!1,hh(this)))}else WO(this.g),f==400&&m.indexOf("Unknown SID")>0?(this.m=3,zt(12)):(this.m=0,zt(13)),Ds(this),Tc(this)}}}catch{}};function RO(u){if(!z1(u))return u.g.la();let f=uS(u.g);if(f==="")return"";let m="",D=f.length,V=Oo(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Ds(u),Tc(u),"";u.h.i=new s.TextDecoder}for(let j=0;j<D;j++)u.h.h=!0,m+=u.h.i.decode(f[j],{stream:!(V&&j==D-1)});return f.length=0,u.h.g+=m,u.C=0,u.h.g}function z1(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function NO(u,f){var m=u.C,D=f.indexOf(`
`,m);return D==-1?O0:(m=Number(f.substring(m,D)),isNaN(m)?$1:(D+=1,D+m>f.length?O0:(f=f.slice(D,D+m),u.C=D+m,f)))}Ot.prototype.cancel=function(){this.K=!0,Ds(this)};function hh(u){u.T=Date.now()+u.H,W1(u,u.H)}function W1(u,f){if(u.D!=null)throw Error("WatchDog timer not null");u.D=zr(c(u.aa,u),f)}function L0(u){u.D&&(s.clearTimeout(u.D),u.D=null)}Ot.prototype.aa=function(){this.D=null;let u=Date.now();u-this.T>=0?(P0(this.i,this.B),this.M!=2&&(oi(),zt(17)),Ds(this),this.m=2,Tc(this)):W1(this,this.T-u)};function Tc(u){u.j.I==0||u.K||yS(u.j,u)}function Ds(u){L0(u);var f=u.O;f&&typeof f.dispose=="function"&&f.dispose(),u.O=null,L(u.V),u.g&&(f=u.g,u.g=null,f.abort(),f.dispose())}function V0(u,f){try{var m=u.j;if(m.I!=0&&(m.g==u||U0(m.h,u))){if(!u.L&&U0(m.h,u)&&m.I==3){try{var D=m.Ba.g.parse(f)}catch{D=null}if(Array.isArray(D)&&D.length==3){var V=D;if(V[0]==0){e:if(!m.v){if(m.g)if(m.g.F+3e3<u.F)_h(m),yh(m);else break e;G0(m),zt(18)}}else m.xa=V[1],0<m.xa-m.K&&V[2]<37500&&m.F&&m.A==0&&!m.C&&(m.C=zr(c(m.Va,m),6e3));Y1(m.h)<=1&&m.ta&&(m.ta=void 0)}else Ms(m,11)}else if((u.L||m.g==u)&&_h(m),!M(f))for(V=m.Ba.g.parse(f),f=0;f<V.length;f++){let Ct=V[f],_n=Ct[0];if(!(_n<=m.K))if(m.K=_n,Ct=Ct[1],m.I==2)if(Ct[0]=="c"){m.M=Ct[1],m.ba=Ct[2];let ur=Ct[3];ur!=null&&(m.ka=ur,m.j.info("VER="+m.ka));let Rs=Ct[4];Rs!=null&&(m.za=Rs,m.j.info("SVER="+m.za));let Fo=Ct[5];Fo!=null&&typeof Fo=="number"&&Fo>0&&(D=1.5*Fo,m.O=D,m.j.info("backChannelRequestTimeoutMs_="+D)),D=m;let Lo=u.g;if(Lo){let bh=Lo.g?Lo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bh){var j=D.h;j.g||bh.indexOf("spdy")==-1&&bh.indexOf("quic")==-1&&bh.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(B0(j,j.h),j.h=null))}if(D.G){let W0=Lo.g?Lo.g.getResponseHeader("X-HTTP-Session-Id"):null;W0&&(D.wa=W0,Ft(D.J,D.G,W0))}}m.I=3,m.l&&m.l.ra(),m.aa&&(m.T=Date.now()-u.F,m.j.info("Handshake RTT: "+m.T+"ms")),D=m;var de=u;if(D.na=ES(D,D.L?D.ba:null,D.W),de.L){Q1(D.h,de);var Ze=de,pn=D.O;pn&&(Ze.H=pn),Ze.D&&(L0(Ze),hh(Ze)),D.g=de}else gS(D);m.i.length>0&&vh(m)}else Ct[0]!="stop"&&Ct[0]!="close"||Ms(m,7);else m.I==3&&(Ct[0]=="stop"||Ct[0]=="close"?Ct[0]=="stop"?Ms(m,7):$0(m):Ct[0]!="noop"&&m.l&&m.l.qa(Ct),m.A=0)}}oi(4)}catch{}}var PO=class{constructor(u,f){this.g=u,this.map=f}};function q1(u){this.l=u||10,s.PerformanceNavigationTiming?(u=s.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function K1(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Y1(u){return u.h?1:u.g?u.g.size:0}function U0(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function B0(u,f){u.g?u.g.add(f):u.h=f}function Q1(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}q1.prototype.cancel=function(){if(this.i=J1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function J1(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.G);return f}return g(u.i)}var Z1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function kO(u,f){if(u){u=u.split("&");for(let m=0;m<u.length;m++){let D=u[m].indexOf("="),V,j=null;D>=0?(V=u[m].substring(0,D),j=u[m].substring(D+1)):V=u[m],f(V,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Po(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;u instanceof Po?(this.l=u.l,Cc(this,u.j),this.o=u.o,this.g=u.g,Dc(this,u.u),this.h=u.h,j0(this,rS(u.i)),this.m=u.m):u&&(f=String(u).match(Z1))?(this.l=!1,Cc(this,f[1]||"",!0),this.o=Ac(f[2]||""),this.g=Ac(f[3]||"",!0),Dc(this,f[4]),this.h=Ac(f[5]||"",!0),j0(this,f[6]||"",!0),this.m=Ac(f[7]||"")):(this.l=!1,this.i=new Rc(null,this.l))}Po.prototype.toString=function(){let u=[];var f=this.j;f&&u.push(Mc(f,X1,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Mc(f,X1,!0),"@"),u.push(kt(m).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.u,m!=null&&u.push(":",String(m))),(m=this.h)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Mc(m,m.charAt(0)=="/"?LO:FO,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Mc(m,UO)),u.join("")},Po.prototype.resolve=function(u){let f=cr(this),m=!!u.j;m?Cc(f,u.j):m=!!u.o,m?f.o=u.o:m=!!u.g,m?f.g=u.g:m=u.u!=null;var D=u.h;if(m)Dc(f,u.u);else if(m=!!u.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var V=f.h.lastIndexOf("/");V!=-1&&(D=f.h.slice(0,V+1)+D)}if(V=D,V==".."||V==".")D="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){D=V.lastIndexOf("/",0)==0,V=V.split("/");let j=[];for(let de=0;de<V.length;){let Ze=V[de++];Ze=="."?D&&de==V.length&&j.push(""):Ze==".."?((j.length>1||j.length==1&&j[0]!="")&&j.pop(),D&&de==V.length&&j.push("")):(j.push(Ze),D=!0)}D=j.join("/")}else D=V}return m?f.h=D:m=u.i.toString()!=="",m?j0(f,rS(u.i)):m=!!u.m,m&&(f.m=u.m),f};function cr(u){return new Po(u)}function Cc(u,f,m){u.j=m?Ac(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Dc(u,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);u.u=f}else u.u=null}function j0(u,f,m){f instanceof Rc?(u.i=f,BO(u.i,u.l)):(m||(f=Mc(f,VO)),u.i=new Rc(f,u.l))}function Ft(u,f,m){u.i.set(f,m)}function fh(u){return Ft(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function Ac(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Mc(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,OO),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function OO(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var X1=/[#\/\?@]/g,FO=/[#\?:]/g,LO=/[#\?]/g,VO=/[#\?@]/g,UO=/#/g;function Rc(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function As(u){u.g||(u.g=new Map,u.h=0,u.i&&kO(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Rc.prototype,n.add=function(u,f){As(this),this.i=null,u=ja(this,u);let m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function eS(u,f){As(u),f=ja(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function tS(u,f){return As(u),f=ja(u,f),u.g.has(f)}n.forEach=function(u,f){As(this),this.g.forEach(function(m,D){m.forEach(function(V){u.call(f,V,D,this)},this)},this)};function nS(u,f){As(u);let m=[];if(typeof f=="string")tS(u,f)&&(m=m.concat(u.g.get(ja(u,f))));else for(u=Array.from(u.g.values()),f=0;f<u.length;f++)m=m.concat(u[f]);return m}n.set=function(u,f){return As(this),this.i=null,u=ja(this,u),tS(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=nS(this,u),u.length>0?String(u[0]):f):f};function iS(u,f,m){eS(u,f),m.length>0&&(u.i=null,u.g.set(ja(u,f),g(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(let D=0;D<f.length;D++){var m=f[D];let V=kt(m);m=nS(this,m);for(let j=0;j<m.length;j++){let de=V;m[j]!==""&&(de+="="+kt(m[j])),u.push(de)}}return this.i=u.join("&")};function rS(u){let f=new Rc;return f.i=u.i,u.g&&(f.g=new Map(u.g),f.h=u.h),f}function ja(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function BO(u,f){f&&!u.j&&(As(u),u.i=null,u.g.forEach(function(m,D){let V=D.toLowerCase();D!=V&&(eS(this,D),iS(this,V,m))},u)),u.j=f}function jO(u,f){let m=new Wr;if(s.Image){let D=new Image;D.onload=d(ko,m,"TestLoadImage: loaded",!0,f,D),D.onerror=d(ko,m,"TestLoadImage: error",!1,f,D),D.onabort=d(ko,m,"TestLoadImage: abort",!1,f,D),D.ontimeout=d(ko,m,"TestLoadImage: timeout",!1,f,D),s.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=u}else f(!1)}function HO(u,f){let m=new Wr,D=new AbortController,V=setTimeout(()=>{D.abort(),ko(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:D.signal}).then(j=>{clearTimeout(V),j.ok?ko(m,"TestPingServer: ok",!0,f):ko(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),ko(m,"TestPingServer: error",!1,f)})}function ko(u,f,m,D,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),D(m)}catch{}}function $O(){this.g=new Te}function ph(u){this.i=u.Sb||null,this.h=u.ab||!1}h(ph,Le),ph.prototype.g=function(){return new gh(this.i,this.h)};function gh(u,f){An.call(this),this.H=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(gh,An),n=gh.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=f,this.readyState=1,Pc(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(f.body=u),(this.H||s).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Nc(this)),this.readyState=0},n.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Pc(this)),this.g&&(this.readyState=3,Pc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;oS(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function oS(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}n.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Nc(this):Pc(this),this.readyState==3&&oS(this)}},n.Oa=function(u){this.g&&(this.response=this.responseText=u,Nc(this))},n.Na=function(u){this.g&&(this.response=u,Nc(this))},n.ga=function(){this.g&&Nc(this)};function Nc(u){u.readyState=4,u.l=null,u.j=null,u.B=null,Pc(u)}n.setRequestHeader=function(u,f){this.A.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function Pc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(gh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function sS(u){let f="";return Me(u,function(m,D){f+=D,f+=":",f+=m,f+=`\r
`}),f}function H0(u,f,m){e:{for(D in m){var D=!1;break e}D=!0}D||(m=sS(m),typeof u=="string"?m!=null&&kt(m):Ft(u,f,m))}function Wt(u){An.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Wt,An);var GO=/^https?$/i,zO=["POST","PUT"];n=Wt.prototype,n.Fa=function(u){this.H=u},n.ea=function(u,f,m,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():At.g(),this.g.onreadystatechange=p(c(this.Ca,this));try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(j){aS(this,j);return}if(u=m||"",m=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var V in D)m.set(V,D[V]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(let j of D.keys())m.set(j,D.get(j));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(m.keys()).find(j=>j.toLowerCase()=="content-type"),V=s.FormData&&u instanceof s.FormData,!(Array.prototype.indexOf.call(zO,f,void 0)>=0)||D||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[j,de]of m)this.g.setRequestHeader(j,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(j){aS(this,j)}};function aS(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.o=5,lS(u),mh(u)}function lS(u){u.A||(u.A=!0,Pt(u,"complete"),Pt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,Pt(this,"complete"),Pt(this,"abort"),mh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mh(this,!0)),Wt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?cS(this):this.Xa())},n.Xa=function(){cS(this)};function cS(u){if(u.h&&typeof o<"u"){if(u.v&&Oo(u)==4)setTimeout(u.Ca.bind(u),0);else if(Pt(u,"readystatechange"),Oo(u)==4){u.h=!1;try{let j=u.ca();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var D;if(D=j===0){let de=String(u.D).match(Z1)[1]||null;!de&&s.self&&s.self.location&&(de=s.self.location.protocol.slice(0,-1)),D=!GO.test(de?de.toLowerCase():"")}m=D}if(m)Pt(u,"complete"),Pt(u,"success");else{u.o=6;try{var V=Oo(u)>2?u.g.statusText:""}catch{V=""}u.l=V+" ["+u.ca()+"]",lS(u)}}finally{mh(u)}}}}function mh(u,f){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);let m=u.g;u.g=null,f||Pt(u,"ready");try{m.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Oo(u){return u.g?u.g.readyState:0}n.ca=function(){try{return Oo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Z(f)}};function uS(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function WO(u){let f={};u=(u.g&&Oo(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<u.length;D++){if(M(u[D]))continue;var m=vn(u[D]);let V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let j=f[V]||[];f[V]=j,j.push(m)}Gt(f,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function kc(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function dS(u){this.za=0,this.i=[],this.j=new Wr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=kc("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=kc("baseRetryDelayMs",5e3,u),this.Za=kc("retryDelaySeedMs",1e4,u),this.Ta=kc("forwardChannelMaxRetries",2,u),this.va=kc("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new q1(u&&u.concurrentRequestLimit),this.Ba=new $O,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=dS.prototype,n.ka=8,n.I=1,n.connect=function(u,f,m,D){zt(0),this.W=u,this.H=f||{},m&&D!==void 0&&(this.H.OSID=m,this.H.OAID=D),this.F=this.X,this.J=ES(this,null,this.W),vh(this)};function $0(u){if(hS(u),u.I==3){var f=u.V++,m=cr(u.J);if(Ft(m,"SID",u.M),Ft(m,"RID",f),Ft(m,"TYPE","terminate"),Oc(u,m),f=new Ot(u,u.j,f),f.M=2,f.A=fh(cr(m)),m=!1,s.navigator&&s.navigator.sendBeacon)try{m=s.navigator.sendBeacon(f.A.toString(),"")}catch{}!m&&s.Image&&(new Image().src=f.A,m=!0),m||(f.g=bS(f.j,null),f.g.ea(f.A)),f.F=Date.now(),hh(f)}_S(u)}function yh(u){u.g&&(z0(u),u.g.cancel(),u.g=null)}function hS(u){yh(u),u.v&&(s.clearTimeout(u.v),u.v=null),_h(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&s.clearTimeout(u.m),u.m=null)}function vh(u){if(!K1(u.h)&&!u.m){u.m=!0;var f=u.Ea;Ae||C(),Ie||(Ae(),Ie=!0),k.add(f,u),u.D=0}}function qO(u,f){return Y1(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=f.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=zr(c(u.Ea,u,f),vS(u,u.D)),u.D++,!0)}n.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;let V=new Ot(this,this.j,u),j=this.o;if(this.U&&(j?(j=ct(j),ne(j,this.U)):j=this.U),this.u!==null||this.R||(V.J=j,j=null),this.S)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var D=this.i[m];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(f+=D,f>4096){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=pS(this,V,f),m=cr(this.J),Ft(m,"RID",u),Ft(m,"CVER",22),this.G&&Ft(m,"X-HTTP-Session-Id",this.G),Oc(this,m),j&&(this.R?f="headers="+kt(sS(j))+"&"+f:this.u&&H0(m,this.u,j)),B0(this.h,V),this.Ra&&Ft(m,"TYPE","init"),this.S?(Ft(m,"$req",f),Ft(m,"SID","null"),V.U=!0,F0(V,m,null)):F0(V,m,f),this.I=2}}else this.I==3&&(u?fS(this,u):this.i.length==0||K1(this.h)||fS(this))};function fS(u,f){var m;f?m=f.l:m=u.V++;let D=cr(u.J);Ft(D,"SID",u.M),Ft(D,"RID",m),Ft(D,"AID",u.K),Oc(u,D),u.u&&u.o&&H0(D,u.u,u.o),m=new Ot(u,u.j,m,u.D+1),u.u===null&&(m.J=u.o),f&&(u.i=f.G.concat(u.i)),f=pS(u,m,1e3),m.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),B0(u.h,m),F0(m,D,f)}function Oc(u,f){u.H&&Me(u.H,function(m,D){Ft(f,D,m)}),u.l&&Me({},function(m,D){Ft(f,D,m)})}function pS(u,f,m){m=Math.min(u.i.length,m);let D=u.l?c(u.l.Ka,u.l,u):null;e:{var V=u.i;let Ze=-1;for(;;){let pn=["count="+m];Ze==-1?m>0?(Ze=V[0].g,pn.push("ofs="+Ze)):Ze=0:pn.push("ofs="+Ze);let Ct=!0;for(let _n=0;_n<m;_n++){var j=V[_n].g;let ur=V[_n].map;if(j-=Ze,j<0)Ze=Math.max(0,V[_n].g-100),Ct=!1;else try{j="req"+j+"_"||"";try{var de=ur instanceof Map?ur:Object.entries(ur);for(let[Rs,Fo]of de){let Lo=Fo;a(Fo)&&(Lo=J(Fo)),pn.push(j+Rs+"="+encodeURIComponent(Lo))}}catch(Rs){throw pn.push(j+"type="+encodeURIComponent("_badmap")),Rs}}catch{D&&D(ur)}}if(Ct){de=pn.join("&");break e}}de=void 0}return u=u.i.splice(0,m),f.G=u,de}function gS(u){if(!u.g&&!u.v){u.Y=1;var f=u.Da;Ae||C(),Ie||(Ae(),Ie=!0),k.add(f,u),u.A=0}}function G0(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=zr(c(u.Da,u),vS(u,u.A)),u.A++,!0)}n.Da=function(){if(this.v=null,mS(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=zr(c(this.Wa,this),u)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,zt(10),yh(this),mS(this))};function z0(u){u.B!=null&&(s.clearTimeout(u.B),u.B=null)}function mS(u){u.g=new Ot(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var f=cr(u.na);Ft(f,"RID","rpc"),Ft(f,"SID",u.M),Ft(f,"AID",u.K),Ft(f,"CI",u.F?"0":"1"),!u.F&&u.ia&&Ft(f,"TO",u.ia),Ft(f,"TYPE","xmlhttp"),Oc(u,f),u.u&&u.o&&H0(f,u.u,u.o),u.O&&(u.g.H=u.O);var m=u.g;u=u.ba,m.M=1,m.A=fh(cr(f)),m.u=null,m.R=!0,G1(m,u)}n.Va=function(){this.C!=null&&(this.C=null,yh(this),G0(this),zt(19))};function _h(u){u.C!=null&&(s.clearTimeout(u.C),u.C=null)}function yS(u,f){var m=null;if(u.g==f){_h(u),z0(u),u.g=null;var D=2}else if(U0(u.h,f))m=f.G,Q1(u.h,f),D=1;else return;if(u.I!=0){if(f.o)if(D==1){m=f.u?f.u.length:0,f=Date.now()-f.F;var V=u.D;D=Ba(),Pt(D,new dh(D,m)),vh(u)}else gS(u);else if(V=f.m,V==3||V==0&&f.X>0||!(D==1&&qO(u,f)||D==2&&G0(u)))switch(m&&m.length>0&&(f=u.h,f.i=f.i.concat(m)),V){case 1:Ms(u,5);break;case 4:Ms(u,10);break;case 3:Ms(u,6);break;default:Ms(u,2)}}}function vS(u,f){let m=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(m*=2),m*f}function Ms(u,f){if(u.j.info("Error code "+f),f==2){var m=c(u.bb,u),D=u.Ua;let V=!D;D=new Po(D||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Cc(D,"https"),fh(D),V?jO(D.toString(),m):HO(D.toString(),m)}else zt(2);u.I=0,u.l&&u.l.pa(f),_S(u),hS(u)}n.bb=function(u){u?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function _S(u){if(u.I=0,u.ja=[],u.l){let f=J1(u.h);(f.length!=0||u.i.length!=0)&&(S(u.ja,f),S(u.ja,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.oa()}}function ES(u,f,m){var D=m instanceof Po?cr(m):new Po(m);if(D.g!="")f&&(D.g=f+"."+D.g),Dc(D,D.u);else{var V=s.location;D=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;let j=new Po(null);D&&Cc(j,D),f&&(j.g=f),V&&Dc(j,V),m&&(j.h=m),D=j}return m=u.G,f=u.wa,m&&f&&Ft(D,m,f),Ft(D,"VER",u.ka),Oc(u,D),D}function bS(u,f,m){if(f&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Aa&&!u.ma?new Wt(new ph({ab:m})):new Wt(u.ma),f.Fa(u.L),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function wS(){}n=wS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Eh(){}Eh.prototype.g=function(u,f){return new si(u,f)};function si(u,f){An.call(this),this.g=new dS(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(u?u["X-WebChannel-Client-Profile"]=f.sa:u={"X-WebChannel-Client-Profile":f.sa}),this.g.U=u,(u=f&&f.Qb)&&!M(u)&&(this.g.u=u),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!M(f)&&(this.g.G=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Ha(this)}h(si,An),si.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},si.prototype.close=function(){$0(this.g)},si.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.v&&(m={},m.__data__=J(u),u=m);f.i.push(new PO(f.Ya++,u)),f.I==3&&vh(f)},si.prototype.N=function(){this.g.l=null,delete this.j,$0(this.g),delete this.g,si.Z.N.call(this)};function xS(u){St.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}h(xS,St);function SS(){yt.call(this),this.status=1}h(SS,yt);function Ha(u){this.g=u}h(Ha,wS),Ha.prototype.ra=function(){Pt(this.g,"a")},Ha.prototype.qa=function(u){Pt(this.g,new xS(u))},Ha.prototype.pa=function(u){Pt(this.g,new SS)},Ha.prototype.oa=function(){Pt(this.g,"b")},Eh.prototype.createWebChannel=Eh.prototype.g,si.prototype.send=si.prototype.o,si.prototype.open=si.prototype.m,si.prototype.close=si.prototype.close,zb=go.createWebChannelTransport=function(){return new Eh},Gb=go.getStatEventTarget=function(){return Ba()},$b=go.Event=yn,Gg=go.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,_d=go.ErrorCode=be,je.COMPLETE="complete",Hb=go.EventType=je,Xe.EventType=ht,ht.OPEN="a",ht.CLOSE="b",ht.ERROR="c",ht.MESSAGE="d",An.prototype.listen=An.prototype.J,Ul=go.WebChannel=Xe,_9=go.FetchXmlHttpFactory=ph,Wt.prototype.listenOnce=Wt.prototype.K,Wt.prototype.getLastError=Wt.prototype.Ha,Wt.prototype.getLastErrorCode=Wt.prototype.ya,Wt.prototype.getStatus=Wt.prototype.ca,Wt.prototype.getResponseJson=Wt.prototype.La,Wt.prototype.getResponseText=Wt.prototype.la,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Fa,jb=go.XhrIo=Wt}).apply(typeof $g<"u"?$g:typeof self<"u"?self:typeof window<"u"?window:{});var Cn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Cn.UNAUTHENTICATED=new Cn(null),Cn.GOOGLE_CREDENTIALS=new Cn("google-credentials-uid"),Cn.FIRST_PARTY=new Cn("first-party-uid"),Cn.MOCK_USER=new Cn("mock-user");var nc="12.8.0";function gN(n){nc=n}var xa=new cs("@firebase/firestore");function Bl(){return xa.logLevel}function we(n,...e){if(xa.logLevel<=tt.DEBUG){let t=e.map(Ix);xa.debug(`Firestore (${nc}): ${n}`,...t)}}function vo(n,...e){if(xa.logLevel<=tt.ERROR){let t=e.map(Ix);xa.error(`Firestore (${nc}): ${n}`,...t)}}function ps(n,...e){if(xa.logLevel<=tt.WARN){let t=e.map(Ix);xa.warn(`Firestore (${nc}): ${n}`,...t)}}function Ix(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Oe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,mN(n,i,t)}function mN(n,e,t){let i=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw vo(i),new Error(i)}function wt(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||mN(e,r,i)}function ze(n,e){return n}var q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ue=class extends bi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var kr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Jg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Zg=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Cn.UNAUTHENTICATED))}shutdown(){}},Jb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Xg=class{constructor(e){this.t=e,this.currentUser=Cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){wt(this.o===void 0,42304);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),o=new kr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new kr,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new kr)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(wt(typeof i.accessToken=="string",31837,{l:i}),new Jg(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return wt(e===null||typeof e=="string",2055,{h:e}),new Cn(e)}},Zb=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Cn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},Xb=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Zb(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}},em=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},tm=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){wt(this.o===void 0,3512);let i=o=>{o.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,we("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new em(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(wt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new em(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function E9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var Sa=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=E9(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}};function ot(n,e){return n<e?-1:n>e?1:0}function ew(n,e){let t=Math.min(n.length,e.length);for(let i=0;i<t;i++){let r=n.charAt(i),o=e.charAt(i);if(r!==o)return Wb(r)===Wb(o)?ot(r,o):Wb(r)?1:-1}return ot(n.length,e.length)}var b9=55296,w9=57343;function Wb(n){let e=n.charCodeAt(0);return e>=b9&&e<=w9}function Wl(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var M2="__name__",nm=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&Oe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Oe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return ot(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):ew(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return po.fromString(e.substring(4,e.length-2))}},Nt=class n extends nm{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new ue(q.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},x9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=class n extends nm{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return x9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===M2}static keyField(){return new n([M2])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new ue(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new ue(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ue(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(s=!s,r++):a!=="."||s?(i+=a,r++):(o(),r++)}if(o(),s)throw new ue(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Re=class n{constructor(e){this.path=e}static fromPath(e){return new n(Nt.fromString(e))}static fromName(e){return new n(Nt.fromString(e).popFirst(5))}static empty(){return new n(Nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Nt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Nt(e.slice()))}};function yN(n,e,t){if(!t)throw new ue(q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function vN(n,e,t,i){if(e===!0&&i===!0)throw new ue(q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function R2(n){if(!Re.isDocumentKey(n))throw new ue(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function N2(n){if(Re.isDocumentKey(n))throw new ue(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function _N(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Oe(12329,{type:typeof n})}function ic(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Vd(n);throw new ue(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function EN(n,e){if(e<=0)throw new ue(q.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function rn(n,e){let t={typeString:n};return e&&(t.value=e),t}function rc(n,e){if(!_N(n))throw new ue(q.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let s=n[i];if(r&&typeof s!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new ue(q.INVALID_ARGUMENT,t);return!0}var P2=-62135596800,k2=1e6,on=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*k2);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<P2)throw new ue(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/k2}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(rc(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-P2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};on._jsonSchemaVersion="firestore/timestamp/1.0",on._jsonSchema={type:rn("string",on._jsonSchemaVersion),seconds:rn("number"),nanoseconds:rn("number")};var Qe=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new on(0,0))}static max(){return new n(new on(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Id=-1,im=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};im.UNKNOWN_ID=-1;function S9(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new on(t+1,0):new on(t,i));return new Ia(r,Re.empty(),e)}function I9(n){return new Ia(n.readTime,n.key,Id)}var Ia=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Qe.min(),Re.empty(),Id)}static max(){return new n(Qe.max(),Re.empty(),Id)}};function T9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Re.comparator(n.documentKey,e.documentKey),t!==0?t:ot(n.largestBatchId,e.largestBatchId))}var C9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",tw=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function oc(n){if(n.code!==q.FAILED_PRECONDITION||n.message!==C9)throw n;we("LocalStore","Unexpectedly lost primary lease")}var ee=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(a=>{++r,a.next(()=>{++o,s&&o===r&&t()},l=>i(l))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let c=l;t(e[c]).next(d=>{s[c]=d,++a,a===o&&i(s)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};function D9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sc(n){return n.name==="IndexedDbTransactionError"}var Tx=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Cx=-1;function Mm(n){return n==null}function Td(n){return n===0&&1/n==-1/0}function A9(n){return typeof n=="number"&&Number.isInteger(n)&&!Td(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var bN="";function M9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=O2(e)),e=R9(n.get(t),e);return O2(e)}function R9(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case bN:t+="";break;default:t+=o}}return t}function O2(n){return n+bN+""}var N9="remoteDocuments",wN="owner";var xN="mutationQueues";var SN="mutations";var IN="documentMutations",P9="remoteDocumentsV14";var TN="remoteDocumentGlobal";var CN="targets";var DN="targetDocuments";var AN="targetGlobal",MN="collectionParents";var RN="clientMetadata";var NN="bundles";var PN="namedQueries";var k9="indexConfiguration";var O9="indexState";var F9="indexEntries";var kN="documentOverlays";var L9="globals";var V9=[xN,SN,IN,N9,CN,wN,AN,DN,RN,TN,MN,NN,PN],Yue=[...V9,kN],U9=[xN,SN,IN,P9,CN,wN,AN,DN,RN,TN,MN,NN,PN,kN],B9=U9,j9=[...B9,k9,O9,F9];var Que=[...j9,L9];function F2(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Pa(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ON(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Qt=class n{constructor(e,t){this.comparator=e,this.root=t||Or.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Or.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Or.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gl(this.root,e,this.comparator,!0)}},Gl=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Or=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Oe(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Oe(27949);return e+(this.isRed()?0:1)}};Or.EMPTY=null,Or.RED=!0,Or.BLACK=!1;Or.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe(57766)}get value(){throw Oe(16141)}get color(){throw Oe(16727)}get left(){throw Oe(29726)}get right(){throw Oe(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Or(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Dn=class n{constructor(e){this.comparator=e,this.data=new Qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rm(this.data.getIterator())}getIteratorFrom(e){return new rm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},rm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Pr=class n{constructor(e){this.fields=e,e.sort(ni.comparator)}static empty(){return new n([])}unionWith(e){let t=new Dn(ni.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wl(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var om=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var On=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new om("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};On.EMPTY_BYTE_STRING=new On("");var H9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(n){if(wt(!!n,39018),typeof n=="string"){let e=0,t=H9.exec(n);if(wt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Eo(n){return typeof n=="string"?On.fromBase64String(n):On.fromUint8Array(n)}var FN="server_timestamp",LN="__type__",VN="__previous_value__",UN="__local_write_time__";function Ud(n){return(n?.mapValue?.fields||{})[LN]?.stringValue===FN}function Rm(n){let e=n.mapValue.fields[VN];return Ud(e)?Rm(e):e}function Cd(n){let e=_o(n.mapValue.fields[UN].timestampValue);return new on(e.seconds,e.nanos)}var nw=class{constructor(e,t,i,r,o,s,a,l,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=d,this.apiKey=h}},sm="(default)",Dd=class n{constructor(e,t){this.projectId=e,this.database=t||sm}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===sm}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function BN(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ue(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dd(n.options.projectId,e)}var Dx="__type__",jN="__max__",zg={mapValue:{fields:{__type__:{stringValue:jN}}}},Ax="__vector__",ql="value";function gs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ud(n)?4:$N(n)?9007199254740991:HN(n)?10:11:Oe(28295,{value:n})}function Br(n,e){if(n===e)return!0;let t=gs(n);if(t!==gs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cd(n).isEqual(Cd(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=_o(r.timestampValue),a=_o(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return Eo(r.bytesValue).isEqual(Eo(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return Ht(r.geoPointValue.latitude)===Ht(o.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return Ht(r.integerValue)===Ht(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=Ht(r.doubleValue),a=Ht(o.doubleValue);return s===a?Td(s)===Td(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Wl(n.arrayValue.values||[],e.arrayValue.values||[],Br);case 10:case 11:return(function(r,o){let s=r.mapValue.fields||{},a=o.mapValue.fields||{};if(F2(s)!==F2(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Br(s[l],a[l])))return!1;return!0})(n,e);default:return Oe(52216,{left:n})}}function Ad(n,e){return(n.values||[]).find(t=>Br(t,e))!==void 0}function Kl(n,e){if(n===e)return 0;let t=gs(n),i=gs(e);if(t!==i)return ot(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ot(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=Ht(o.integerValue||o.doubleValue),l=Ht(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return L2(n.timestampValue,e.timestampValue);case 4:return L2(Cd(n),Cd(e));case 5:return ew(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=Eo(o),l=Eo(s);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){let d=ot(a[c],l[c]);if(d!==0)return d}return ot(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=ot(Ht(o.latitude),Ht(s.latitude));return a!==0?a:ot(Ht(o.longitude),Ht(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return V2(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let a=o.fields||{},l=s.fields||{},c=a[ql]?.arrayValue,d=l[ql]?.arrayValue,h=ot(c?.values?.length||0,d?.values?.length||0);return h!==0?h:V2(c,d)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===zg.mapValue&&s===zg.mapValue)return 0;if(o===zg.mapValue)return 1;if(s===zg.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),c=s.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let p=ew(l[h],d[h]);if(p!==0)return p;let g=Kl(a[l[h]],c[d[h]]);if(g!==0)return g}return ot(l.length,d.length)})(n.mapValue,e.mapValue);default:throw Oe(23264,{he:t})}}function L2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ot(n,e);let t=_o(n),i=_o(e),r=ot(t.seconds,i.seconds);return r!==0?r:ot(t.nanos,i.nanos)}function V2(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=Kl(t[r],i[r]);if(o)return o}return ot(t.length,i.length)}function Yl(n){return iw(n)}function iw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=_o(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Eo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Re.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=iw(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${iw(t.fields[s])}`;return r+"}"})(n.mapValue):Oe(61005,{value:n})}function Kg(n){switch(gs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Rm(n);return e?16+Kg(e):16;case 5:return 2*n.stringValue.length;case 6:return Eo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,o)=>r+Kg(o),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Pa(i.fields,(o,s)=>{r+=o.length+Kg(s)}),r})(n.mapValue);default:throw Oe(13486,{value:n})}}function Bd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function rw(n){return!!n&&"integerValue"in n}function Mx(n){return!!n&&"arrayValue"in n}function U2(n){return!!n&&"nullValue"in n}function B2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Yg(n){return!!n&&"mapValue"in n}function HN(n){return(n?.mapValue?.fields||{})[Dx]?.stringValue===Ax}function wd(n){if(n.geoPointValue)return{geoPointValue:F({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:F({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Pa(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=wd(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wd(n.arrayValue.values[t]);return e}return F({},n)}function $N(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===jN}var Zue={mapValue:{fields:{[Dx]:{stringValue:Ax},[ql]:{arrayValue:{}}}}};var Vi=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Yg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wd(t)}setAll(e){let t=ni.emptyPath(),i={},r=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}s?i[a.lastSegment()]=wd(s):r.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());Yg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Br(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Yg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Pa(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(wd(this.value))}};function GN(n){let e=[];return Pa(n.fields,(t,i)=>{let r=new ni([t]);if(Yg(i)){let o=GN(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new Pr(e)}var rr=class n{constructor(e,t,i,r,o,s,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Qe.min(),Qe.min(),Qe.min(),Vi.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Qe.min(),Qe.min(),Vi.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Qe.min(),Qe.min(),Vi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var bo=class{constructor(e,t){this.position=e,this.inclusive=t}};function j2(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=Re.comparator(Re.fromName(s.referenceValue),t.key):i=Kl(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function H2(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Br(n.position[t],e.position[t]))return!1;return!0}var ms=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function $9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var am=class{},nn=class n extends am{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new sw(e,t,i):t==="array-contains"?new cw(e,i):t==="in"?new uw(e,i):t==="not-in"?new dw(e,i):t==="array-contains-any"?new hw(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new aw(e,i):new lw(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Kl(t,this.value)):t!==null&&gs(this.value)===gs(t)&&this.matchesComparison(Kl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ui=class n extends am{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return zN(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function zN(n){return n.op==="and"}function WN(n){return G9(n)&&zN(n)}function G9(n){for(let e of n.filters)if(e instanceof Ui)return!1;return!0}function ow(n){if(n instanceof nn)return n.field.canonicalString()+n.op.toString()+Yl(n.value);if(WN(n))return n.filters.map(e=>ow(e)).join(",");{let e=n.filters.map(t=>ow(t)).join(",");return`${n.op}(${e})`}}function qN(n,e){return n instanceof nn?(function(i,r){return r instanceof nn&&i.op===r.op&&i.field.isEqual(r.field)&&Br(i.value,r.value)})(n,e):n instanceof Ui?(function(i,r){return r instanceof Ui&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,a)=>o&&qN(s,r.filters[a]),!0):!1})(n,e):void Oe(19439)}function KN(n){return n instanceof nn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Yl(t.value)}`})(n):n instanceof Ui?(function(t){return t.op.toString()+" {"+t.getFilters().map(KN).join(" ,")+"}"})(n):"Filter"}var sw=class extends nn{constructor(e,t,i){super(e,t,i),this.key=Re.fromName(i.referenceValue)}matches(e){let t=Re.comparator(e.key,this.key);return this.matchesComparison(t)}},aw=class extends nn{constructor(e,t){super(e,"in",t),this.keys=YN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},lw=class extends nn{constructor(e,t){super(e,"not-in",t),this.keys=YN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function YN(n,e){return(e.arrayValue?.values||[]).map(t=>Re.fromName(t.referenceValue))}var cw=class extends nn{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Mx(t)&&Ad(t.arrayValue,this.value)}},uw=class extends nn{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ad(this.value.arrayValue,t)}},dw=class extends nn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ad(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ad(this.value.arrayValue,t)}},hw=class extends nn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Mx(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Ad(this.value.arrayValue,i))}};var fw=class{constructor(e,t=null,i=[],r=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}};function $2(n,e=null,t=[],i=[],r=null,o=null,s=null){return new fw(n,e,t,i,r,o,s)}function Rx(n){let e=ze(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>ow(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(o){return o.field.canonicalString()+o.dir})(i)).join(","),Mm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Yl(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Yl(i)).join(",")),e.Te=t}return e.Te}function Nx(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!$9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!qN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!H2(n.startAt,e.startAt)&&H2(n.endAt,e.endAt)}function pw(n){return Re.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var wo=class{constructor(e,t=null,i=[],r=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function z9(n,e,t,i,r,o,s,a){return new wo(n,e,t,i,r,o,s,a)}function Px(n){return new wo(n)}function G2(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function W9(n){return Re.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Nm(n){return n.collectionGroup!==null}function wa(n){let e=ze(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Dn(ni.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new ms(o,i))}),t.has(ni.keyField().canonicalString())||e.Ie.push(new ms(ni.keyField(),i))}return e.Ie}function Fr(n){let e=ze(n);return e.Ee||(e.Ee=q9(e,wa(n))),e.Ee}function q9(n,e){if(n.limitType==="F")return $2(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new ms(r.field,o)});let t=n.endAt?new bo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new bo(n.startAt.position,n.startAt.inclusive):null;return $2(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Pm(n,e){let t=n.filters.concat([e]);return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function QN(n,e){let t=n.explicitOrderBy.concat([e]);return new wo(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Md(n,e,t){return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function JN(n,e){return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function km(n,e){return Nx(Fr(n),Fr(e))&&n.limitType===e.limitType}function ZN(n){return`${Rx(Fr(n))}|lt:${n.limitType}`}function jl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>KN(r)).join(", ")}]`),Mm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Yl(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Yl(r)).join(",")),`Target(${i})`})(Fr(n))}; limitType=${n.limitType})`}function Om(n,e){return e.isFoundDocument()&&(function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Re.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(let o of wa(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(s,a,l){let c=j2(s,a,l);return s.inclusive?c<=0:c<0})(i.startAt,wa(i),r)||i.endAt&&!(function(s,a,l){let c=j2(s,a,l);return s.inclusive?c>=0:c>0})(i.endAt,wa(i),r))})(n,e)}function K9(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function XN(n){return(e,t)=>{let i=!1;for(let r of wa(n)){let o=Y9(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function Y9(n,e,t){let i=n.field.isKeyField()?Re.comparator(e.key,t.key):(function(o,s,a){let l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?Kl(l,c):Oe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Oe(19790,{direction:n.dir})}}var xo=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Pa(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return ON(this.inner)}size(){return this.innerSize}};var Q9=new Qt(Re.comparator);function So(){return Q9}var eP=new Qt(Re.comparator);function bd(...n){let e=eP;for(let t of n)e=e.insert(t.key,t);return e}function tP(n){let e=eP;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ea(){return xd()}function nP(){return xd()}function xd(){return new xo(n=>n.toString(),(n,e)=>n.isEqual(e))}var J9=new Qt(Re.comparator),Z9=new Dn(Re.comparator);function nt(...n){let e=Z9;for(let t of n)e=e.add(t);return e}var X9=new Dn(ot);function eH(){return X9}function kx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Td(e)?"-0":e}}function iP(n){return{integerValue:""+n}}function tH(n,e){return A9(e)?iP(e):kx(n,e)}var Ql=class{constructor(){this._=void 0}};function nH(n,e,t){return n instanceof Ta?(function(r,o){let s={fields:{[LN]:{stringValue:FN},[UN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Ud(o)&&(o=Rm(o)),o&&(s.fields[VN]=o),{mapValue:s}})(t,e):n instanceof Ca?oP(n,e):n instanceof Da?sP(n,e):(function(r,o){let s=rP(r,o),a=z2(s)+z2(r.Ae);return rw(s)&&rw(r.Ae)?iP(a):kx(r.serializer,a)})(n,e)}function iH(n,e,t){return n instanceof Ca?oP(n,e):n instanceof Da?sP(n,e):t}function rP(n,e){return n instanceof Jl?(function(i){return rw(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}var Ta=class extends Ql{},Ca=class extends Ql{constructor(e){super(),this.elements=e}};function oP(n,e){let t=aP(e);for(let i of n.elements)t.some(r=>Br(r,i))||t.push(i);return{arrayValue:{values:t}}}var Da=class extends Ql{constructor(e){super(),this.elements=e}};function sP(n,e){let t=aP(e);for(let i of n.elements)t=t.filter(r=>!Br(r,i));return{arrayValue:{values:t}}}var Jl=class extends Ql{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function z2(n){return Ht(n.integerValue||n.doubleValue)}function aP(n){return Mx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var gw=class{constructor(e,t){this.field=e,this.transform=t}};function rH(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Ca&&r instanceof Ca||i instanceof Da&&r instanceof Da?Wl(i.elements,r.elements,Br):i instanceof Jl&&r instanceof Jl?Br(i.Ae,r.Ae):i instanceof Ta&&r instanceof Ta})(n.transform,e.transform)}var mw=class{constructor(e,t){this.version=e,this.transformResults=t}},fs=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Qg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Zl=class{};function lP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rd(n.key,fs.none()):new Aa(n.key,n.data,fs.none());{let t=n.data,i=Vi.empty(),r=new Dn(ni.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new Io(n.key,i,new Pr(r.toArray()),fs.none())}}function oH(n,e,t){n instanceof Aa?(function(r,o,s){let a=r.value.clone(),l=q2(r.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Io?(function(r,o,s){if(!Qg(r.precondition,o))return void o.convertToUnknownDocument(s.version);let a=q2(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(cP(r)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):(function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Sd(n,e,t,i){return n instanceof Aa?(function(o,s,a,l){if(!Qg(o.precondition,s))return a;let c=o.value.clone(),d=K2(o.fieldTransforms,l,s);return c.setAll(d),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null})(n,e,t,i):n instanceof Io?(function(o,s,a,l){if(!Qg(o.precondition,s))return a;let c=K2(o.fieldTransforms,l,s),d=s.data;return d.setAll(cP(o)),d.setAll(c),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,i):(function(o,s,a){return Qg(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function sH(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=rP(i.transform,r||null);o!=null&&(t===null&&(t=Vi.empty()),t.set(i.field,o))}return t||null}function W2(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Wl(i,r,(o,s)=>rH(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Aa=class extends Zl{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Io=class extends Zl{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function cP(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function q2(n,e,t){let i=new Map;wt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,iH(s,a,t[r]))}return i}function K2(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,nH(o,s,e))}return i}var Rd=class extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},yw=class extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var vw=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&oH(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Sd(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Sd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=nP();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(r.key)?null:a;let l=lP(s,a);l!==null&&i.set(r.key,l),s.isValidDocument()||s.convertToNoDocument(Qe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nt())}isEqual(e){return this.batchId===e.batchId&&Wl(this.mutations,e.mutations,(t,i)=>W2(t,i))&&Wl(this.baseMutations,e.baseMutations,(t,i)=>W2(t,i))}},_w=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){wt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return J9})(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var Ew=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var bw=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var hn,ut;function aH(n){switch(n){case q.OK:return Oe(64938);case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0;default:return Oe(15467,{code:n})}}function uP(n){if(n===void 0)return vo("GRPC error has no .code"),q.UNKNOWN;switch(n){case hn.OK:return q.OK;case hn.CANCELLED:return q.CANCELLED;case hn.UNKNOWN:return q.UNKNOWN;case hn.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case hn.INTERNAL:return q.INTERNAL;case hn.UNAVAILABLE:return q.UNAVAILABLE;case hn.UNAUTHENTICATED:return q.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case hn.NOT_FOUND:return q.NOT_FOUND;case hn.ALREADY_EXISTS:return q.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return q.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case hn.ABORTED:return q.ABORTED;case hn.OUT_OF_RANGE:return q.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return q.UNIMPLEMENTED;case hn.DATA_LOSS:return q.DATA_LOSS;default:return Oe(39323,{code:n})}}(ut=hn||(hn={}))[ut.OK=0]="OK",ut[ut.CANCELLED=1]="CANCELLED",ut[ut.UNKNOWN=2]="UNKNOWN",ut[ut.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ut[ut.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ut[ut.NOT_FOUND=5]="NOT_FOUND",ut[ut.ALREADY_EXISTS=6]="ALREADY_EXISTS",ut[ut.PERMISSION_DENIED=7]="PERMISSION_DENIED",ut[ut.UNAUTHENTICATED=16]="UNAUTHENTICATED",ut[ut.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ut[ut.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ut[ut.ABORTED=10]="ABORTED",ut[ut.OUT_OF_RANGE=11]="OUT_OF_RANGE",ut[ut.UNIMPLEMENTED=12]="UNIMPLEMENTED",ut[ut.INTERNAL=13]="INTERNAL",ut[ut.UNAVAILABLE=14]="UNAVAILABLE",ut[ut.DATA_LOSS=15]="DATA_LOSS";var lH=null;function cH(){return new TextEncoder}var uH=new po([4294967295,4294967295],0);function Y2(n){let e=cH().encode(n),t=new Bb;return t.update(e),new Uint8Array(t.digest())}function Q2(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new po([t,i],0),new po([r,o],0)]}var ww=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ba(`Invalid padding: ${t}`);if(i<0)throw new ba(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ba(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ba(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=po.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(po.fromNumber(i)));return r.compare(uH)===1&&(r=new po([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=Y2(e),[i,r]=Q2(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);if(!this.we(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;let t=Y2(e),[i,r]=Q2(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(i,r,o);this.be(s)}}be(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},ba=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var lm=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Nd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Qe.min(),r,new Qt(ot),So(),nt())}},Nd=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,nt(),nt(),nt())}};var zl=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}},cm=class{constructor(e,t){this.targetId=e,this.Ce=t}},um=class{constructor(e,t,i=On.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},dm=class{constructor(){this.ve=0,this.Fe=J2(),this.Me=On.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),t=nt(),i=nt();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Oe(38017,{changeType:o})}}),new Nd(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=J2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,wt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},xw=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=So(),this.He=Wg(),this.Je=Wg(),this.Ze=new Qt(ot)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Oe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){let o=r.target;if(pw(o))if(i===0){let s=new Re(o.path);this.et(t,s,rr.newNoDocument(s,Qe.min()))}else wt(i===1,20013,{expectedCount:i});else{let s=this._t(t);if(s!==i){let a=this.ut(e),l=a?this.ct(a,e,s):1;if(l!==0){this.it(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}lH?.lt((function(d,h,p,g,S){let I={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},P=h.unchangedNames;return P&&(I.bloomFilter={applied:S===0,hashCount:P?.hashCount??0,bitmapLength:P?.bits?.bitmap?.length??0,padding:P?.bits?.padding??0,mightContain:U=>g?.mightContain(U)??!1}),I})(s,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,a;try{s=Eo(i).toUint8Array()}catch(l){if(l instanceof om)return ps("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new ww(s,r,o)}catch(l){return ps(l instanceof ba?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){let i=this.Ge.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),r++)}),r}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let a=this.ot(s);if(a){if(o.current&&pw(a.target)){let l=new Re(a.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,rr.newNoDocument(l,e))}o.Be&&(t.set(s,o.ke()),o.Ke())}});let i=nt();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let r=new lm(e,t,this.Ze,this.je,i);return this.je=So(),this.He=Wg(),this.Je=Wg(),this.Ze=new Qt(ot),r}Ye(e,t){if(!this.rt(e))return;let i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new dm,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Dn(ot),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Dn(ot),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||we("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new dm),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Wg(){return new Qt(Re.comparator)}function J2(){return new Qt(Re.comparator)}var dH={asc:"ASCENDING",desc:"DESCENDING"},hH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fH={and:"AND",or:"OR"},Sw=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Iw(n,e){return n.useProto3Json||Mm(e)?e:{value:e}}function hm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function pH(n,e){return hm(n,e.toTimestamp())}function Lr(n){return wt(!!n,49232),Qe.fromTimestamp((function(t){let i=_o(t);return new on(i.seconds,i.nanos)})(n))}function Ox(n,e){return Tw(n,e).canonicalString()}function Tw(n,e){let t=(function(r){return new Nt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function hP(n){let e=Nt.fromString(n);return wt(yP(e),10190,{key:e.toString()}),e}function Cw(n,e){return Ox(n.databaseId,e.path)}function qb(n,e){let t=hP(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Re(pP(t))}function fP(n,e){return Ox(n.databaseId,e)}function gH(n){let e=hP(n);return e.length===4?Nt.emptyPath():pP(e)}function Dw(n){return new Nt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function pP(n){return wt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Z2(n,e,t){return{name:Cw(n,e),fields:t.value.mapValue.fields}}function mH(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Oe(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(c,d){return c.useProto3Json?(wt(d===void 0||typeof d=="string",58123),On.fromBase64String(d||"")):(wt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),On.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(c){let d=c.code===void 0?q.UNKNOWN:uP(c.code);return new ue(d,c.message||"")})(s);t=new um(i,r,o,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=qb(n,i.document.name),o=Lr(i.document.updateTime),s=i.document.createTime?Lr(i.document.createTime):Qe.min(),a=new Vi({mapValue:{fields:i.document.fields}}),l=rr.newFoundDocument(r,o,s,a),c=i.targetIds||[],d=i.removedTargetIds||[];t=new zl(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=qb(n,i.document),o=i.readTime?Lr(i.readTime):Qe.min(),s=rr.newNoDocument(r,o),a=i.removedTargetIds||[];t=new zl([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=qb(n,i.document),o=i.removedTargetIds||[];t=new zl([],o,r,null)}else{if(!("filter"in e))return Oe(11601,{Vt:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new bw(r,o),a=i.targetId;t=new cm(a,s)}}return t}function yH(n,e){let t;if(e instanceof Aa)t={update:Z2(n,e.key,e.value)};else if(e instanceof Rd)t={delete:Cw(n,e.key)};else if(e instanceof Io)t={update:Z2(n,e.key,e.data),updateMask:TH(e.fieldMask)};else{if(!(e instanceof yw))return Oe(16599,{dt:e.type});t={verify:Cw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(o,s){let a=s.transform;if(a instanceof Ta)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ca)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Da)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Jl)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw Oe(20930,{transform:s.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:pH(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Oe(27497)})(n,e.precondition)),t}function vH(n,e){return n&&n.length>0?(wt(e!==void 0,14353),n.map(t=>(function(r,o){let s=r.updateTime?Lr(r.updateTime):Lr(o);return s.isEqual(Qe.min())&&(s=Lr(o)),new mw(s,r.transformResults||[])})(t,e))):[]}function _H(n,e){return{documents:[fP(n,e.path)]}}function EH(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=fP(n,r);let o=(function(c){if(c.length!==0)return mP(Ui.create(c,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(c){if(c.length!==0)return c.map(d=>(function(p){return{field:Hl(p.field),direction:xH(p.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Iw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:r}}function bH(n){let e=gH(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){wt(i===1,65062);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let p=gP(h);return p instanceof Ui&&WN(p)?p.getFilters():[p]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(p=>(function(S){return new ms($l(S.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(p))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let p;return p=typeof h=="object"?h.value:h,Mm(p)?null:p})(t.limit));let l=null;t.startAt&&(l=(function(h){let p=!!h.before,g=h.values||[];return new bo(g,p)})(t.startAt));let c=null;return t.endAt&&(c=(function(h){let p=!h.before,g=h.values||[];return new bo(g,p)})(t.endAt)),z9(e,r,s,o,a,"F",l,c)}function wH(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function gP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=$l(t.unaryFilter.field);return nn.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=$l(t.unaryFilter.field);return nn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=$l(t.unaryFilter.field);return nn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=$l(t.unaryFilter.field);return nn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Oe(61313);default:return Oe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return nn.create($l(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Oe(58110);default:return Oe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ui.create(t.compositeFilter.filters.map(i=>gP(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Oe(1026)}})(t.compositeFilter.op))})(n):Oe(30097,{filter:n})}function xH(n){return dH[n]}function SH(n){return hH[n]}function IH(n){return fH[n]}function Hl(n){return{fieldPath:n.canonicalString()}}function $l(n){return ni.fromServerFormat(n.fieldPath)}function mP(n){return n instanceof nn?(function(t){if(t.op==="=="){if(B2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NAN"}};if(U2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(B2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NOT_NAN"}};if(U2(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hl(t.field),op:SH(t.op),value:t.value}}})(n):n instanceof Ui?(function(t){let i=t.getFilters().map(r=>mP(r));return i.length===1?i[0]:{compositeFilter:{op:IH(t.op),filters:i}}})(n):Oe(54877,{filter:n})}function TH(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function yP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function vP(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var Pd=class n{constructor(e,t,i,r,o=Qe.min(),s=Qe.min(),a=On.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Aw=class{constructor(e){this.yt=e}};function _P(n){let e=bH({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Md(e,e.limit,"L"):e}var fm=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){let i=Ht(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Td(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=_o(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Eo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?$N(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):HN(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):Oe(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let i=e.fields||{};this.Ft(t,55);for(let r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){let i=e.fields||{};this.Ft(t,53);let r=ql,o=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){let i=e.values||[];this.Ft(t,50);for(let r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Re.fromName(e).path.forEach(i=>{this.Ft(t,60),this.$t(i,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};fm.Wt=new fm;var Mw=class{constructor(){this.Sn=new Rw}addToCollectionParentIndex(e,t){return this.Sn.add(t),ee.resolve()}getCollectionParents(e,t){return ee.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ee.resolve()}deleteFieldIndex(e,t){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,t){return ee.resolve()}getDocumentsMatchingTarget(e,t){return ee.resolve(null)}getIndexType(e,t){return ee.resolve(0)}getFieldIndexes(e,t){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,t){return ee.resolve(Ia.min())}getMinOffsetFromCollectionGroup(e,t){return ee.resolve(Ia.min())}updateCollectionGroup(e,t,i){return ee.resolve()}updateIndexEntries(e,t){return ee.resolve()}},Rw=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Dn(Nt.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Dn(Nt.comparator)).toArray()}};var Xue=new Uint8Array(0);var X2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},EP=41943040,Li=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};Li.DEFAULT_COLLECTION_PERCENTILE=10,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Li.DEFAULT=new Li(EP,Li.DEFAULT_COLLECTION_PERCENTILE,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Li.DISABLED=new Li(-1,0,0);var kd=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var eN="LruGarbageCollector",CH=1048576;function tN([n,e],[t,i]){let r=ot(n,t);return r===0?ot(e,i):r}var Nw=class{constructor(e){this.Pr=e,this.buffer=new Dn(tN),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();tN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Pw=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){we(eN,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sc(t)?we(eN,"Ignoring IndexedDB error during garbage collection: ",t):await oc(t)}await this.Ar(3e5)})}},kw=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return ee.resolve(Tx.ce);let i=new Nw(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(we("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(X2)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(we("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),X2):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,s,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(we("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,s=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(c=Date.now(),Bl()<=tt.DEBUG&&we("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${r} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:h})))}};function DH(n,e){return new kw(n,e)}var Ow=class{constructor(){this.changes=new xo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?ee.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Fw=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Lw=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Sd(i.mutation,r,Pr.empty(),on.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,nt()).next(()=>i))}getLocalViewOfDocuments(e,t,i=nt()){let r=Ea();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=bd();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=Ea();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,nt()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,i,r){let o=So(),s=xd(),a=(function(){return xd()})();return t.forEach((l,c)=>{let d=i.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof Io)?o=o.insert(c.key,c):d!==void 0?(s.set(c.key,d.mutation.getFieldMask()),Sd(d.mutation,c,d.mutation.getFieldMask(),on.now())):s.set(c.key,Pr.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,d)=>s.set(c,d)),t.forEach((c,d)=>a.set(c,new Fw(d,s.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){let i=xd(),r=new Qt((s,a)=>s-a),o=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=i.get(l)||Pr.empty();d=a.applyToLocalView(c,d),i.set(l,d);let h=(r.get(a.batchId)||nt()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,h=nP();d.forEach(p=>{if(!o.has(p)){let g=lP(t.get(p),i.get(p));g!==null&&h.set(p,g),o=o.add(p)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return ee.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return W9(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Nm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):ee.resolve(Ea()),a=Id,l=o;return s.next(c=>ee.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?ee.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,nt())).next(d=>({batchId:a,changes:tP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Re(t)).next(i=>{let r=bd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=bd();return this.indexManager.getCollectionParents(e,o).next(a=>ee.forEach(a,l=>{let c=(function(h,p){return new wo(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,i,r).next(d=>{d.forEach((h,p)=>{s=s.insert(h,p)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((l,c)=>{let d=c.getKey();s.get(d)===null&&(s=s.insert(d,rr.newInvalidDocument(d)))});let a=bd();return s.forEach((l,c)=>{let d=o.get(l);d!==void 0&&Sd(d.mutation,c,Pr.empty(),on.now()),Om(t,c)&&(a=a.insert(l,c))}),a})}};var Vw=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ee.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Lr(r.createTime)}})(t)),ee.resolve()}getNamedQuery(e,t){return ee.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:_P(r.bundledQuery),readTime:Lr(r.readTime)}})(t)),ee.resolve()}};var Uw=class{constructor(){this.overlays=new Qt(Re.comparator),this.Lr=new Map}getOverlay(e,t){return ee.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Ea();return ee.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.bt(e,t,o)}),ee.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Lr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(i)),ee.resolve()}getOverlaysForCollection(e,t,i){let r=Ea(),o=t.length+1,s=new Re(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>i&&r.set(l.getKey(),l)}return ee.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Qt((c,d)=>c-d),s=this.overlays.getIterator();for(;s.hasNext();){let c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let d=o.get(c.largestBatchId);d===null&&(d=Ea(),o=o.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}let a=Ea(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=r)););return ee.resolve(a)}bt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new Ew(t,i));let o=this.Lr.get(t);o===void 0&&(o=nt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}};var Bw=class{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ee.resolve()}};var Od=class{constructor(){this.kr=new Dn(fn.Kr),this.qr=new Dn(fn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let i=new fn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new fn(e,t))}Qr(e,t){e.forEach(i=>this.removeReference(i,t))}Gr(e){let t=new Re(new Nt([])),i=new fn(t,e),r=new fn(t,e+1),o=[];return this.qr.forEachInRange([i,r],s=>{this.Wr(s),o.push(s.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new Re(new Nt([])),i=new fn(t,e),r=new fn(t,e+1),o=nt();return this.qr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new fn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},fn=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Re.comparator(e.key,t.key)||ot(e.Hr,t.Hr)}static Ur(e,t){return ot(e.Hr,t.Hr)||Re.comparator(e.key,t.key)}};var jw=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Dn(fn.Kr)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new vw(o,t,i,r);this.mutationQueue.push(s);for(let a of r)this.Jr=this.Jr.add(new fn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ee.resolve(s)}lookupMutationBatch(e,t){return ee.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),o=r<0?0:r;return ee.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?Cx:this.Yn-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new fn(t,0),r=new fn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],s=>{let a=this.Zr(s.Hr);o.push(a)}),ee.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Dn(ot);return t.forEach(r=>{let o=new fn(r,0),s=new fn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,s],a=>{i=i.add(a.Hr)})}),ee.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;Re.isDocumentKey(o)||(o=o.child(""));let s=new fn(new Re(o),0),a=new Dn(ot);return this.Jr.forEachWhile(l=>{let c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Hr)),!0)},s),ee.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){wt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ee.forEach(t.mutations,r=>{let o=new fn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Jr=i})}nr(e){}containsKey(e,t){let i=new fn(t,0),r=this.Jr.firstAfterOrEqual(i);return ee.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Hw=class{constructor(e){this.ti=e,this.docs=(function(){return new Qt(Re.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return ee.resolve(i?i.document.mutableCopy():rr.newInvalidDocument(t))}getEntries(e,t){let i=So();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():rr.newInvalidDocument(r))}),ee.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=So(),s=t.path,a=new Re(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||T9(I9(d),i)<=0||(r.has(d.key)||Om(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return ee.resolve(o)}getAllFromCollectionGroup(e,t,i,r){Oe(9500)}ni(e,t){return ee.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new $w(this)}getSize(e){return ee.resolve(this.size)}},$w=class extends Ow{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)}),ee.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var Gw=class{constructor(e){this.persistence=e,this.ri=new xo(t=>Rx(t),Nx),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.ii=0,this.si=new Od,this.targetCount=0,this.oi=kd._r()}forEachTarget(e,t){return this.ri.forEach((i,r)=>t(r)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ee.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new kd(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ee.resolve()}updateTargetData(e,t){return this.lr(t),ee.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ri.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),ee.waitFor(o).next(()=>r)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,t){let i=this.ri.get(t)||null;return ee.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ee.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),ee.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ee.resolve()}getMatchingKeysForTargetId(e,t){let i=this.si.jr(t);return ee.resolve(i)}containsKey(e,t){return ee.resolve(this.si.containsKey(t))}};var pm=class{constructor(e,t){this._i={},this.overlays={},this.ai=new Tx(0),this.ui=!1,this.ui=!0,this.ci=new Bw,this.referenceDelegate=e(this),this.li=new Gw(this),this.indexManager=new Mw,this.remoteDocumentCache=(function(r){return new Hw(r)})(i=>this.referenceDelegate.hi(i)),this.serializer=new Aw(t),this.Pi=new Vw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Uw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new jw(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){we("MemoryPersistence","Starting transaction:",e);let r=new zw(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(o=>this.referenceDelegate.Ii(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ei(e,t){return ee.or(Object.values(this._i).map(i=>()=>i.containsKey(e,t)))}},zw=class extends tw{constructor(e){super(),this.currentSequenceNumber=e}},Ww=class n{constructor(e){this.persistence=e,this.Ri=new Od,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw Oe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ee.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ee.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ee.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(r=>this.di.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.di,i=>{let r=Re.fromPath(i);return this.mi(e,r).next(o=>{o||t.removeEntry(r,Qe.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return ee.or([()=>ee.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},gm=class n{constructor(e,t){this.persistence=e,this.fi=new xo(i=>M9(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=DH(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return ee.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}pr(e){let t=0;return this.mr(e,i=>{t++}).next(()=>t)}mr(e,t){return ee.forEach(this.fi,(i,r)=>this.wr(e,i,r).next(o=>o?ee.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,s=>this.wr(e,s,t).next(a=>{a||(i++,o.removeEntry(s,Qe.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ee.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Kg(e.data.value)),t}wr(e,t,i){return ee.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.fi.get(t);return ee.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var qw=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=nt(),r=nt();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var Kw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Yw=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return u2()?8:D9(In())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.gs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ps(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new Kw;return this.ys(e,t,s).next(a=>{if(o.result=a,this.As)return this.ws(e,t,s,a.size)})}).next(()=>o.result)}ws(e,t,i,r){return i.documentReadCount<this.Vs?(Bl()<=tt.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",jl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ee.resolve()):(Bl()<=tt.DEBUG&&we("QueryEngine","Query:",jl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Bl()<=tt.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",jl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fr(t))):ee.resolve())}gs(e,t){if(G2(t))return ee.resolve(null);let i=Fr(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Md(t,null,"F"),i=Fr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=nt(...o);return this.fs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{let c=this.bs(t,a);return this.Ss(t,c,s,l.readTime)?this.gs(e,Md(t,null,"F")):this.Ds(e,c,t,l)}))})))}ps(e,t,i,r){return G2(t)||r.isEqual(Qe.min())?ee.resolve(null):this.fs.getDocuments(e,i).next(o=>{let s=this.bs(t,o);return this.Ss(t,s,i,r)?ee.resolve(null):(Bl()<=tt.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),jl(t)),this.Ds(e,s,t,S9(r,Id)).next(a=>a))})}bs(e,t){let i=new Dn(XN(e));return t.forEach((r,o)=>{Om(e,o)&&(i=i.add(o))}),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return Bl()<=tt.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",jl(t)),this.fs.getDocumentsMatchingQuery(e,t,Ia.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Fx="LocalStore",AH=3e8,Qw=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Qt(ot),this.Fs=new xo(o=>Rx(o),Nx),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function MH(n,e,t,i){return new Qw(n,e,t,i)}async function bP(n,e){let t=ze(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],a=[],l=nt();for(let c of r){s.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}for(let c of o){a.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Ns:c,removedBatchIds:s,addedBatchIds:a}))})})}function RH(n,e){let t=ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,d){let h=c.batch,p=h.keys(),g=ee.resolve();return p.forEach(S=>{g=g.next(()=>d.getEntry(l,S)).next(I=>{let P=c.docVersions.get(S);wt(P!==null,48541),I.version.compareTo(P)<0&&(h.applyToRemoteDocument(I,c),I.isValidDocument()&&(I.setReadTime(c.commitVersion),d.addEntry(I)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))})(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=nt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function wP(n){let e=ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function NH(n,e){let t=ze(n),i=e.snapshotVersion,r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;let a=[];e.targetChanges.forEach((d,h)=>{let p=r.get(h);if(!p)return;a.push(t.li.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.li.addMatchingKeys(o,d.addedDocuments,h)));let g=p.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(On.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,i)),r=r.insert(h,g),(function(I,P,U){return I.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=AH?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0})(p,g,d)&&a.push(t.li.updateTargetData(o,g))});let l=So(),c=nt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(PH(o,s,e.documentUpdates).next(d=>{l=d.Bs,c=d.Ls})),!i.isEqual(Qe.min())){let d=t.li.getLastRemoteSnapshotVersion(o).next(h=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i));a.push(d)}return ee.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.vs=r,o))}function PH(n,e,t){let i=nt(),r=nt();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=So();return t.forEach((a,l)=>{let c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Qe.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):we(Fx,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Bs:s,Ls:r}})}function kH(n,e){let t=ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Cx),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function OH(n,e){let t=ze(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.li.getTargetData(i,e).next(o=>o?(r=o,ee.resolve(r)):t.li.allocateTargetId(i).next(s=>(r=new Pd(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i})}async function Jw(n,e,t){let i=ze(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r))}catch(s){if(!sc(s))throw s;we(Fx,`Failed to update sequence numbers for target ${e}: ${s}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function nN(n,e,t){let i=ze(n),r=Qe.min(),o=nt();return i.persistence.runTransaction("Execute query","readwrite",s=>(function(l,c,d){let h=ze(l),p=h.Fs.get(d);return p!==void 0?ee.resolve(h.vs.get(p)):h.li.getTargetData(c,d)})(i,s,Fr(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(s,e,t?r:Qe.min(),t?o:nt())).next(a=>(FH(i,K9(e),a),{documents:a,ks:o})))}function FH(n,e,t){let i=n.Ms.get(e)||Qe.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ms.set(e,i)}var mm=class{constructor(){this.activeTargetIds=eH()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Zw=class{constructor(){this.vo=new mm,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new mm,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Xw=class{Mo(e){}shutdown(){}};var iN="ConnectivityMonitor",ym=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){we(iN,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){we(iN,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var qg=null;function ex(){return qg===null?qg=(function(){return 268435456+Math.round(2147483648*Math.random())})():qg++,"0x"+qg.toString(16)}var Kb="RestConnection",LH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},tx=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===sm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){let s=ex(),a=this.Qo(e,t.toUriEncodedString());we(Kb,`Sending RPC '${e}' ${s}:`,a,i);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,r,o);let{host:c}=new URL(a),d=ls(c);return this.zo(e,a,l,i,d).then(h=>(we(Kb,`Received RPC '${e}' ${s}: `,h),h),h=>{throw ps(Kb,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",i),h})}jo(e,t,i,r,o,s){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),i&&i.headers.forEach((r,o)=>e[o]=r)}Qo(e,t){let i=LH[e],r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}};var nx=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Bn="WebChannelConnection",Ed=(n,e,t)=>{n.listen(e,i=>{try{t(i)}catch(r){setTimeout(()=>{throw r},0)}})},vm=class n extends tx{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=Gb();Ed(e,$b.STAT_EVENT,t=>{t.stat===Gg.PROXY?we(Bn,"STAT_EVENT: detected buffering proxy"):t.stat===Gg.NOPROXY&&we(Bn,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,i,r,o){let s=ex();return new Promise((a,l)=>{let c=new jb;c.setWithCredentials(!0),c.listenOnce(Hb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case _d.NO_ERROR:let h=c.getResponseJson();we(Bn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case _d.TIMEOUT:we(Bn,`RPC '${e}' ${s} timed out`),l(new ue(q.DEADLINE_EXCEEDED,"Request time out"));break;case _d.HTTP_ERROR:let p=c.getStatus();if(we(Bn,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let S=g?.error;if(S&&S.status&&S.message){let I=(function(U){let oe=U.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(oe)>=0?oe:q.UNKNOWN})(S.status);l(new ue(I,S.message))}else l(new ue(q.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ue(q.UNAVAILABLE,"Connection failed."));break;default:Oe(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{we(Bn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);we(Bn,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",d,i,15)})}T_(e,t,i){let r=ex(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;let c=o.join("");we(Bn,`Creating RPC '${e}' stream ${r}: ${c}`,a);let d=s.createWebChannel(c,a);this.I_(d);let h=!1,p=!1,g=new nx({Ho:S=>{p?we(Bn,`Not sending because RPC '${e}' stream ${r} is closed:`,S):(h||(we(Bn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),we(Bn,`RPC '${e}' stream ${r} sending:`,S),d.send(S))},Jo:()=>d.close()});return Ed(d,Ul.EventType.OPEN,()=>{p||(we(Bn,`RPC '${e}' stream ${r} transport opened.`),g.i_())}),Ed(d,Ul.EventType.CLOSE,()=>{p||(p=!0,we(Bn,`RPC '${e}' stream ${r} transport closed`),g.o_(),this.E_(d))}),Ed(d,Ul.EventType.ERROR,S=>{p||(p=!0,ps(Bn,`RPC '${e}' stream ${r} transport errored. Name:`,S.name,"Message:",S.message),g.o_(new ue(q.UNAVAILABLE,"The operation could not be completed")))}),Ed(d,Ul.EventType.MESSAGE,S=>{if(!p){let I=S.data[0];wt(!!I,16349);let P=I,U=P?.error||P[0]?.error;if(U){we(Bn,`RPC '${e}' stream ${r} received error:`,U);let oe=U.status,Se=(function(Ie){let k=hn[Ie];if(k!==void 0)return uP(k)})(oe),xe=U.message;Se===void 0&&(Se=q.INTERNAL,xe="Unknown error status: "+oe+" with message "+U.message),p=!0,g.o_(new ue(Se,xe)),d.close()}else we(Bn,`RPC '${e}' stream ${r} received:`,I),g.__(I)}}),n.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return zb()}};function VH(n){return new vm(n)}function Yb(){return typeof document<"u"?document:null}function jd(n){return new Sw(n,!0)}vm.c_=!1;var _m=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&we("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var rN="PersistentStream",Em=class{constructor(e,t,i,r,o,s,a,l){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _m(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===q.RESOURCE_EXHAUSTED?(vo(t.toString()),vo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{let r=new ue(q.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){let i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return we(rN,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(we(rN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ix=class extends Em{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=mH(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Qe.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Qe.min():s.readTime?Lr(s.readTime):Qe.min()})(e);return this.listener.J_(t,i)}Z_(e){let t={};t.database=Dw(this.serializer),t.addTarget=(function(o,s){let a,l=s.target;if(a=pw(l)?{documents:_H(o,l)}:{query:EH(o,l).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=dP(o,s.resumeToken);let c=Iw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(Qe.min())>0){a.readTime=hm(o,s.snapshotVersion.toTimestamp());let c=Iw(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);let i=wH(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){let t={};t.database=Dw(this.serializer),t.removeTarget=e,this.K_(t)}},rx=class extends Em{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return wt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,wt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){wt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=vH(e.writeResults,e.commitTime),i=Lr(e.commitTime);return this.listener.na(i,t)}ra(){let e={};e.database=Dw(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>yH(this.serializer,i))};this.K_(t)}};var ox=class{},sx=class extends ox{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ue(q.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,Tw(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(q.UNKNOWN,o.toString())})}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,Tw(t,i),r,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ue(q.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function UH(n,e,t,i){return new sx(n,e,t,i)}var ax=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vo(t),this.aa=!1):we("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Ma="RemoteStore",lx=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(s=>{i.enqueueAndForget(async()=>{ka(this)&&(we(Ma,"Restarting streams for network reachability change."),await(async function(l){let c=ze(l);c.Ea.add(4),await Hd(c),c.Va.set("Unknown"),c.Ea.delete(4),await Fm(c)})(this))})}),this.Va=new ax(i,r)}};async function Fm(n){if(ka(n))for(let e of n.Ra)await e(!0)}async function Hd(n){for(let e of n.Ra)await e(!1)}function xP(n,e){let t=ze(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Bx(t)?Ux(t):ac(t).O_()&&Vx(t,e))}function Lx(n,e){let t=ze(n),i=ac(t);t.Ia.delete(e),i.O_()&&SP(t,e),t.Ia.size===0&&(i.O_()?i.L_():ka(t)&&t.Va.set("Unknown"))}function Vx(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ac(n).Z_(e)}function SP(n,e){n.da.$e(e),ac(n).X_(e)}function Ux(n){n.da=new xw({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ac(n).start(),n.Va.ua()}function Bx(n){return ka(n)&&!ac(n).x_()&&n.Ia.size>0}function ka(n){return ze(n).Ea.size===0}function IP(n){n.da=void 0}async function BH(n){n.Va.set("Online")}async function jH(n){n.Ia.forEach((e,t)=>{Vx(n,e)})}async function HH(n,e){IP(n),Bx(n)?(n.Va.ha(e),Ux(n)):n.Va.set("Unknown")}async function $H(n,e,t){if(n.Va.set("Online"),e instanceof um&&e.state===2&&e.cause)try{await(async function(r,o){let s=o.cause;for(let a of o.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.da.removeTarget(a))})(n,e)}catch(i){we(Ma,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await bm(n,i)}else if(e instanceof zl?n.da.Xe(e):e instanceof cm?n.da.st(e):n.da.tt(e),!t.isEqual(Qe.min()))try{let i=await wP(n.localStore);t.compareTo(i)>=0&&await(function(o,s){let a=o.da.Tt(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.Ia.get(c);d&&o.Ia.set(c,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{let d=o.Ia.get(l);if(!d)return;o.Ia.set(l,d.withResumeToken(On.EMPTY_BYTE_STRING,d.snapshotVersion)),SP(o,l);let h=new Pd(d.target,l,c,d.sequenceNumber);Vx(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){we(Ma,"Failed to raise snapshot:",i),await bm(n,i)}}async function bm(n,e,t){if(!sc(e))throw e;n.Ea.add(1),await Hd(n),n.Va.set("Offline"),t||(t=()=>wP(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{we(Ma,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Fm(n)})}function TP(n,e){return e().catch(t=>bm(n,t,e))}async function Lm(n){let e=ze(n),t=ys(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Cx;for(;GH(e);)try{let r=await kH(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,zH(e,r)}catch(r){await bm(e,r)}CP(e)&&DP(e)}function GH(n){return ka(n)&&n.Ta.length<10}function zH(n,e){n.Ta.push(e);let t=ys(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function CP(n){return ka(n)&&!ys(n).x_()&&n.Ta.length>0}function DP(n){ys(n).start()}async function WH(n){ys(n).ra()}async function qH(n){let e=ys(n);for(let t of n.Ta)e.ea(t.mutations)}async function KH(n,e,t){let i=n.Ta.shift(),r=_w.from(i,e,t);await TP(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Lm(n)}async function YH(n,e){e&&ys(n).Y_&&await(async function(i,r){if((function(s){return aH(s)&&s!==q.ABORTED})(r.code)){let o=i.Ta.shift();ys(i).B_(),await TP(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Lm(i)}})(n,e),CP(n)&&DP(n)}async function oN(n,e){let t=ze(n);t.asyncQueue.verifyOperationInProgress(),we(Ma,"RemoteStore received new credentials");let i=ka(t);t.Ea.add(3),await Hd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Fm(t)}async function QH(n,e){let t=ze(n);e?(t.Ea.delete(2),await Fm(t)):e||(t.Ea.add(2),await Hd(t),t.Va.set("Unknown"))}function ac(n){return n.ma||(n.ma=(function(t,i,r){let o=ze(t);return o.sa(),new ix(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:BH.bind(null,n),Yo:jH.bind(null,n),t_:HH.bind(null,n),J_:$H.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),Bx(n)?Ux(n):n.Va.set("Unknown")):(await n.ma.stop(),IP(n))})),n.ma}function ys(n){return n.fa||(n.fa=(function(t,i,r){let o=ze(t);return o.sa(),new rx(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:WH.bind(null,n),t_:YH.bind(null,n),ta:qH.bind(null,n),na:KH.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Lm(n)):(await n.fa.stop(),n.Ta.length>0&&(we(Ma,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var cx=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new kr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,a=new n(e,t,s,r,o);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function jx(n,e){if(vo("AsyncQueue",`${e}: ${n}`),sc(n))return new ue(q.UNAVAILABLE,`${e}: ${n}`);throw n}var Fd=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Re.comparator(t.key,i.key):(t,i)=>Re.comparator(t.key,i.key),this.keyedMap=bd(),this.sortedSet=new Qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var wm=class{constructor(){this.ga=new Qt(Re.comparator)}track(e){let t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Oe(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}},Ra=class n{constructor(e,t,i,r,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Fd.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&km(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var ux=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},dx=class{constructor(){this.queries=sN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){let r=ze(t),o=r.queries;r.queries=sN(),o.forEach((s,a)=>{for(let l of a.ba)l.onError(i)})})(this,new ue(q.ABORTED,"Firestore shutting down"))}};function sN(){return new xo(n=>ZN(n),km)}async function JH(n,e){let t=ze(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new ux,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(s){let a=jx(s,`Initialization of query '${jl(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Hx(t)}async function ZH(n,e){let t=ze(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.ba.indexOf(e);s>=0&&(o.ba.splice(s,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function XH(n,e){let t=ze(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let a of s.ba)a.Fa(r)&&(i=!0);s.wa=r}}i&&Hx(t)}function e7(n,e,t){let i=ze(n),r=i.queries.get(e);if(r)for(let o of r.ba)o.onError(t);i.queries.delete(e)}function Hx(n){n.Ca.forEach(e=>{e.next()})}var hx,aN;(aN=hx||(hx={})).Ma="default",aN.Cache="cache";var fx=class{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ra(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ra.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hx.Cache}};var xm=class{constructor(e){this.key=e}},Sm=class{constructor(e){this.key=e}},px=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=nt(),this.mutatedKeys=nt(),this.eu=XN(e),this.tu=new Fd(this.eu)}get nu(){return this.Za}ru(e,t){let i=t?t.iu:new wm,r=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{let p=r.get(d),g=Om(this.query,h)?h:null,S=!!p&&this.mutatedKeys.has(p.key),I=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),P=!1;p&&g?p.data.isEqual(g.data)?S!==I&&(i.track({type:3,doc:g}),P=!0):this.su(p,g)||(i.track({type:2,doc:g}),P=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!p&&g?(i.track({type:0,doc:g}),P=!0):p&&!g&&(i.track({type:1,doc:p}),P=!0,(l||c)&&(a=!0)),P&&(g?(s=s.add(g),o=I?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),i.track({type:1,doc:d})}return{tu:s,iu:i,Ss:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((d,h)=>(function(g,S){let I=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe(20277,{Vt:P})}};return I(g)-I(S)})(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(i),r=r??!1;let a=t&&!r?this._u():[],l=this.Ya.size===0&&this.current&&!r?1:0,c=l!==this.Xa;return this.Xa=l,s.length!==0||c?{snapshot:new Ra(this.query,e.tu,o,s,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new wm,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=nt(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});let t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new Sm(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new xm(i))}),t}cu(e){this.Za=e.ks,this.Ya=nt();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ra.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},$x="SyncEngine",gx=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},mx=class{constructor(e){this.key=e,this.hu=!1}},yx=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new xo(a=>ZN(a),km),this.Iu=new Map,this.Eu=new Set,this.Ru=new Qt(Re.comparator),this.Au=new Map,this.Vu=new Od,this.du={},this.mu=new Map,this.fu=kd.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function t7(n,e,t=!0){let i=kP(n),r,o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await AP(i,e,t,!0),r}async function n7(n,e){let t=kP(n);await AP(t,e,!0,!1)}async function AP(n,e,t,i){let r=await OH(n.localStore,Fr(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return i&&(a=await i7(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&xP(n.remoteStore,r),a}async function i7(n,e,t,i,r){n.pu=(h,p,g)=>(async function(I,P,U,oe){let Se=P.view.ru(U);Se.Ss&&(Se=await nN(I.localStore,P.query,!1).then(({documents:k})=>P.view.ru(k,Se)));let xe=oe&&oe.targetChanges.get(P.targetId),Ae=oe&&oe.targetMismatches.get(P.targetId)!=null,Ie=P.view.applyChanges(Se,I.isPrimaryClient,xe,Ae);return cN(I,P.targetId,Ie.au),Ie.snapshot})(n,h,p,g);let o=await nN(n.localStore,e,!0),s=new px(e,o.ks),a=s.ru(o.documents),l=Nd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),c=s.applyChanges(a,n.isPrimaryClient,l);cN(n,t,c.au);let d=new gx(e,t,s);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function r7(n,e,t){let i=ze(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter(s=>!km(s,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Jw(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Lx(i.remoteStore,r.targetId),vx(i,r.targetId)}).catch(oc)):(vx(i,r.targetId),await Jw(i.localStore,r.targetId,!0))}async function o7(n,e){let t=ze(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Lx(t.remoteStore,i.targetId))}async function s7(n,e,t){let i=f7(n);try{let r=await(function(s,a){let l=ze(s),c=on.now(),d=a.reduce((g,S)=>g.add(S.key),nt()),h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let S=So(),I=nt();return l.xs.getEntries(g,d).next(P=>{S=P,S.forEach((U,oe)=>{oe.isValidDocument()||(I=I.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,S)).next(P=>{h=P;let U=[];for(let oe of a){let Se=sH(oe,h.get(oe.key).overlayedDocument);Se!=null&&U.push(new Io(oe.key,Se,GN(Se.value.mapValue),fs.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,U,a)}).next(P=>{p=P;let U=P.applyToLocalDocumentSet(h,I);return l.documentOverlayCache.saveOverlays(g,P.batchId,U)})}).then(()=>({batchId:p.batchId,changes:tP(h)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(s,a,l){let c=s.du[s.currentUser.toKey()];c||(c=new Qt(ot)),c=c.insert(a,l),s.du[s.currentUser.toKey()]=c})(i,r.batchId,t),await $d(i,r.changes),await Lm(i.remoteStore)}catch(r){let o=jx(r,"Failed to persist write");t.reject(o)}}async function MP(n,e){let t=ze(n);try{let i=await NH(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Au.get(o);s&&(wt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?s.hu=!0:r.modifiedDocuments.size>0?wt(s.hu,14607):r.removedDocuments.size>0&&(wt(s.hu,42227),s.hu=!1))}),await $d(t,i,e)}catch(i){await oc(i)}}function lN(n,e,t){let i=ze(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Tu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(s,a){let l=ze(s);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(let p of h.ba)p.va(a)&&(c=!0)}),c&&Hx(l)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function a7(n,e,t){let i=ze(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Au.get(e),o=r&&r.key;if(o){let s=new Qt(Re.comparator);s=s.insert(o,rr.newNoDocument(o,Qe.min()));let a=nt().add(o),l=new lm(Qe.min(),new Map,new Qt(ot),s,a);await MP(i,l),i.Ru=i.Ru.remove(o),i.Au.delete(e),Gx(i)}else await Jw(i.localStore,e,!1).then(()=>vx(i,e,t)).catch(oc)}async function l7(n,e){let t=ze(n),i=e.batch.batchId;try{let r=await RH(t.localStore,e);NP(t,i,null),RP(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await $d(t,r)}catch(r){await oc(r)}}async function c7(n,e,t){let i=ze(n);try{let r=await(function(s,a){let l=ze(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(wt(h!==null,37113),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})})(i.localStore,e);NP(i,e,t),RP(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await $d(i,r)}catch(r){await oc(r)}}function RP(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function NP(n,e,t){let i=ze(n),r=i.du[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function vx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(i=>{n.Vu.containsKey(i)||PP(n,i)})}function PP(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(Lx(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Gx(n))}function cN(n,e,t){for(let i of t)i instanceof xm?(n.Vu.addReference(i.key,e),u7(n,i)):i instanceof Sm?(we($x,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||PP(n,i.key)):Oe(19791,{wu:i})}function u7(n,e){let t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(we($x,"New document in limbo: "+t),n.Eu.add(i),Gx(n))}function Gx(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new Re(Nt.fromString(e)),i=n.fu.next();n.Au.set(i,new mx(t)),n.Ru=n.Ru.insert(t,i),xP(n.remoteStore,new Pd(Fr(Px(t.path)),i,"TargetPurposeLimboResolution",Tx.ce))}}async function $d(n,e,t){let i=ze(n),r=[],o=[],s=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{s.push(i.pu(l,e,t).then(c=>{if((c||t)&&i.isPrimaryClient){let d=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){r.push(c);let d=qw.Es(l.targetId,c);o.push(d)}}))}),await Promise.all(s),i.Pu.J_(r),await(async function(l,c){let d=ze(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ee.forEach(c,p=>ee.forEach(p.Ts,g=>d.persistence.referenceDelegate.addReference(h,p.targetId,g)).next(()=>ee.forEach(p.Is,g=>d.persistence.referenceDelegate.removeReference(h,p.targetId,g)))))}catch(h){if(!sc(h))throw h;we(Fx,"Failed to update sequence numbers: "+h)}for(let h of c){let p=h.targetId;if(!h.fromCache){let g=d.vs.get(p),S=g.snapshotVersion,I=g.withLastLimboFreeSnapshotVersion(S);d.vs=d.vs.insert(p,I)}}})(i.localStore,o))}async function d7(n,e){let t=ze(n);if(!t.currentUser.isEqual(e)){we($x,"User change. New user:",e.toKey());let i=await bP(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(a=>{a.forEach(l=>{l.reject(new ue(q.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await $d(t,i.Ns)}}function h7(n,e){let t=ze(n),i=t.Au.get(e);if(i&&i.hu)return nt().add(i.key);{let r=nt(),o=t.Iu.get(e);if(!o)return r;for(let s of o){let a=t.Tu.get(s);r=r.unionWith(a.view.nu)}return r}}function kP(n){let e=ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=MP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=h7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=a7.bind(null,e),e.Pu.J_=XH.bind(null,e.eventManager),e.Pu.yu=e7.bind(null,e.eventManager),e}function f7(n){let e=ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=l7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=c7.bind(null,e),e}var zx=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=jd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return MH(this.persistence,new Yw,t.initialUser,this.serializer)}Cu(t){return new pm(Ww.Vi,this.serializer)}Du(t){return new Zw}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Im=class extends zx{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){wt(this.persistence.referenceDelegate instanceof gm,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new Pw(i,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Li.withCacheSize(this.cacheSizeBytes):Li.DEFAULT;return new pm(i=>gm.Vi(i,t),this.serializer)}};var OP=(()=>{class n{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>lN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=d7.bind(null,this.syncEngine),await QH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new dx})()}createDatastore(t){let i=jd(t.databaseInfo.databaseId),r=VH(t.databaseInfo);return UH(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,s,a,l){return new lx(r,o,s,a,l)})(this.localStore,this.datastore,t.asyncQueue,i=>lN(this.syncEngine,i,0),(function(){return ym.v()?new ym:new Xw})())}createSyncEngine(t,i){return(function(o,s,a,l,c,d,h){let p=new yx(o,s,a,l,c,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){let r=ze(i);we(Ma,"RemoteStore shutting down."),r.Ea.add(5),await Hd(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var _x=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vo("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var vs="FirestoreClient",Ex=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=Cn.UNAUTHENTICATED,this.clientId=Sa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async s=>{we(vs,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(we(vs,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new kr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=jx(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}};async function Qb(n,e){n.asyncQueue.verifyOperationInProgress(),we(vs,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await bP(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function uN(n,e){n.asyncQueue.verifyOperationInProgress();let t=await p7(n);we(vs,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>oN(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>oN(e.remoteStore,r)),n._onlineComponents=e}async function p7(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){we(vs,"Using user provided OfflineComponentProvider");try{await Qb(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===q.FAILED_PRECONDITION||r.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;ps("Error using user provided cache. Falling back to memory cache: "+t),await Qb(n,new zx)}}else we(vs,"Using default OfflineComponentProvider"),await Qb(n,new Im(void 0));return n._offlineComponents}async function FP(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(we(vs,"Using user provided OnlineComponentProvider"),await uN(n,n._uninitializedComponentsProvider._online)):(we(vs,"Using default OnlineComponentProvider"),await uN(n,new OP))),n._onlineComponents}function g7(n){return FP(n).then(e=>e.syncEngine)}async function m7(n){let e=await FP(n),t=e.eventManager;return t.onListen=t7.bind(null,e.syncEngine),t.onUnlisten=r7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=n7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=o7.bind(null,e.syncEngine),t}function LP(n,e,t={}){let i=new kr;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,a,l,c){let d=new _x({next:p=>{d.Nu(),s.enqueueAndForget(()=>ZH(o,h)),p.fromCache&&l.source==="server"?c.reject(new ue(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new fx(a,d,{includeMetadataChanges:!0,Ka:!0});return JH(o,h)})(await m7(n),n.asyncQueue,e,t,i)),i.promise}function VP(n,e){let t=new kr;return n.asyncQueue.enqueueAndForget(async()=>s7(await g7(n),e,t)),t.promise}function UP(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var y7="ComponentProvider",dN=new Map;function v7(n,e,t,i,r){return new nw(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,UP(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}var BP="firestore.googleapis.com",hN=!0,Tm=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ue(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=BP,this.ssl=hN}else this.host=e.host,this.ssl=e.ssl??hN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=EP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CH)throw new ue(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=UP(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Xl=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tm(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Zg;switch(i.type){case"firstParty":return new Xb(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ue(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=dN.get(t);i&&(we(y7,"Removing Datastore"),dN.delete(t),i.terminate())})(this),Promise.resolve()}};function jP(n,e,t,i={}){n=ic(n,Xl);let r=ls(e),o=n._getSettings(),s=fe(F({},o),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;r&&(Lg(`https://${a}`),Vg("Firestore",!0)),o.host!==BP&&o.host!==a&&ps("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=fe(F({},o),{host:a,ssl:r,emulatorOptions:i});if(!nr(l,s)&&(n._setSettings(l),i.mockUserToken)){let c,d;if(typeof i.mockUserToken=="string")c=i.mockUserToken,d=Cn.MOCK_USER;else{c=r2(i.mockUserToken,n._app?.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new ue(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Cn(h)}n._authCredentials=new Jb(new Jg(c,d))}}var or=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},kn=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(rc(t,n._jsonSchema))return new n(e,i||null,new Re(Nt.fromString(t.referencePath)))}};kn._jsonSchemaVersion="firestore/documentReference/1.0",kn._jsonSchema={type:rn("string",kn._jsonSchemaVersion),referencePath:rn("string")};var mo=class n extends or{constructor(e,t,i){super(e,t,Px(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new Re(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function xi(n,e,...t){if(n=Tn(n),yN("collection","path",e),n instanceof Xl){let i=Nt.fromString(e,...t);return N2(i),new mo(n,null,i)}{if(!(n instanceof kn||n instanceof mo))throw new ue(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Nt.fromString(e,...t));return N2(i),new mo(n.firestore,null,i)}}function Wx(n,e,...t){if(n=Tn(n),arguments.length===1&&(e=Sa.newId()),yN("doc","path",e),n instanceof Xl){let i=Nt.fromString(e,...t);return R2(i),new kn(n,null,new Re(i))}{if(!(n instanceof kn||n instanceof mo))throw new ue(q.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Nt.fromString(e,...t));return R2(i),new kn(n.firestore,n instanceof mo?n.converter:null,new Re(i))}}var fN="AsyncQueue",Cm=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _m(this,"async_queue_retry"),this._c=()=>{let i=Yb();i&&we(fN,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;let t=Yb();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Yb();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new kr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!sc(e))throw e;we(fN,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,vo("INTERNAL UNHANDLED ERROR: ",pN(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=cx.createAndSchedule(this,e,t,i,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&Oe(47125,{Pc:pN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function pN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Na=class extends Xl{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Cm,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Cm(e),this._firestoreClient=void 0,await e}}};function Gd(n,e){let t=typeof n=="object"?n:Hg(),i=typeof n=="string"?n:e||sm,r=yd(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let o=i2("firestore");o&&jP(r,...o)}return r}function Vm(n){if(n._terminated)throw new ue(q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||_7(n),n._firestoreClient}function _7(n){let e=n._freezeSettings(),t=v7(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Ex(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}})(n._componentsProvider))}var Vr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(On.fromBase64String(e))}catch(t){throw new ue(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(rc(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Vr._jsonSchemaVersion="firestore/bytes/1.0",Vr._jsonSchema={type:rn("string",Vr._jsonSchemaVersion),bytes:rn("string")};var ec=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ni(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var tc=class{constructor(e){this._methodName=e}};var yo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(rc(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};yo._jsonSchemaVersion="firestore/geoPoint/1.0",yo._jsonSchema={type:rn("string",yo._jsonSchemaVersion),latitude:rn("number"),longitude:rn("number")};var Ur=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(rc(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new ue(q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Ur._jsonSchemaVersion="firestore/vectorValue/1.0",Ur._jsonSchema={type:rn("string",Ur._jsonSchemaVersion),vectorValues:rn("object")};var E7=/^__.*__$/,bx=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Io(e,this.data,this.fieldMask,t,this.fieldTransforms):new Aa(e,this.data,t,this.fieldTransforms)}};function HP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe(40011,{dataSource:n})}}var wx=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(F(F({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){let t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Dm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(HP(this.dataSource)&&E7.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},xx=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||jd(e)}createContext(e,t,i,r=!1){return new wx({dataSource:e,methodName:t,targetDoc:i,path:ni.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Um(n){let e=n._freezeSettings(),t=jd(n._databaseId);return new xx(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $P(n,e,t,i,r,o={}){let s=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);WP("Data must be an object, but it was:",s,i);let a=GP(i,s),l,c;if(o.merge)l=new Pr(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let p=lc(e,h,t);if(!s.contains(p))throw new ue(q.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);w7(d,p)||d.push(p)}l=new Pr(d),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new bx(new Vi(a),l,c)}var Sx=class n extends tc{_toFieldTransform(e){return new gw(e.path,new Ta)}isEqual(e){return e instanceof n}};function qx(n,e,t,i=!1){return Kx(t,n.createContext(i?4:3,e))}function Kx(n,e){if(zP(n=Tn(n)))return WP("Unsupported field value:",e,n),GP(n,e);if(n instanceof tc)return(function(i,r){if(!HP(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){let o=[],s=0;for(let a of i){let l=Kx(a,r.childContextForArray(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Tn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return tH(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=on.fromDate(i);return{timestampValue:hm(r.serializer,o)}}if(i instanceof on){let o=new on(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:hm(r.serializer,o)}}if(i instanceof yo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Vr)return{bytesValue:dP(r.serializer,i._byteString)};if(i instanceof kn){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.createError(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ox(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ur)return(function(s,a){let l=s instanceof Ur?s.toArray():s;return{mapValue:{fields:{[Dx]:{stringValue:Ax},[ql]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return kx(a.serializer,d)})}}}}}})(i,r);if(vP(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Vd(i)}`)})(n,e)}function GP(n,e){let t={};return ON(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pa(n,(i,r)=>{let o=Kx(r,e.childContextForField(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function zP(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof on||n instanceof yo||n instanceof Vr||n instanceof kn||n instanceof tc||n instanceof Ur||vP(n))}function WP(n,e,t){if(!zP(t)||!_N(t)){let i=Vd(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function lc(n,e,t){if((e=Tn(e))instanceof ec)return e._internalPath;if(typeof e=="string")return qP(n,e);throw Dm("Field path arguments must be of type string or ",n,!1,void 0,t)}var b7=new RegExp("[~\\*/\\[\\]]");function qP(n,e,t){if(e.search(b7)>=0)throw Dm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ec(...e.split("."))._internalPath}catch{throw Dm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Dm(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new ue(q.INVALID_ARGUMENT,a+n+l)}function w7(n,e){return n.some(t=>t.isEqual(e))}var Ld=class{convertValue(e,t="none"){switch(gs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Eo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Oe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Pa(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){let t=e.fields?.[ql].arrayValue?.values?.map(i=>Ht(i.doubleValue));return new Ur(t)}convertGeoPoint(e){return new yo(Ht(e.latitude),Ht(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Rm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Cd(e));default:return null}}convertTimestamp(e){let t=_o(e);return new on(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Nt.fromString(e);wt(yP(i),9688,{name:e});let r=new Dd(i.get(1),i.get(3)),o=new Re(i.popFirst(5));return r.isEqual(t)||vo(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var Am=class extends Ld{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,t)}};function zd(){return new Sx("serverTimestamp")}var KP="@firebase/firestore",YP="4.10.0";var Wd=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Yx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(lc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Yx=class extends Wd{data(){return super.data()}};function T7(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var qd=class{},fc=class extends qd{};function To(n,e,...t){let i=[];e instanceof qd&&i.push(e),i=i.concat(t),(function(o){let s=o.filter(l=>l instanceof Qx).length,a=o.filter(l=>l instanceof Bm).length;if(s>1||s>0&&a>0)throw new ue(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var Bm=class n extends fc{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return XP(e._query,t),new or(e.firestore,e.converter,Pm(e._query,t))}_parse(e){let t=Um(e.firestore);return(function(o,s,a,l,c,d,h){let p;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ue(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){JP(h,d);let S=[];for(let I of h)S.push(QP(l,o,I));p={arrayValue:{values:S}}}else p=QP(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||JP(h,d),p=qx(a,s,h,d==="in"||d==="not-in");return nn.create(c,d,p)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function _s(n,e,t){let i=e,r=lc("where",n);return Bm._create(r,i,t)}var Qx=class n extends qd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Ui.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let s=r,a=o.getFlattenedFilters();for(let l of a)XP(s,l),s=Pm(s,l)})(e._query,t),new or(e.firestore,e.converter,Pm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Jx=class n extends fc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(r,o,s){if(r.startAt!==null)throw new ue(q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ue(q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ms(o,s)})(e._query,this._field,this._direction);return new or(e.firestore,e.converter,QN(e._query,t))}};function sr(n,e="asc"){let t=e,i=lc("orderBy",n);return Jx._create(i,t)}var Zx=class n extends fc{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new or(e.firestore,e.converter,Md(e._query,this._limit,this._limitType))}};function Es(n){return EN("limit",n),Zx._create("limit",n,"F")}var Xx=class n extends fc{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=C7(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,JN(e._query,t))}};function ZP(...n){return Xx._create("startAfter",n,!1)}function C7(n,e,t,i){if(t[0]=Tn(t[0]),t[0]instanceof Wd)return(function(o,s,a,l,c){if(!l)throw new ue(q.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of wa(o))if(h.field.isKeyField())d.push(Bd(s,l.key));else{let p=l.data.field(h.field);if(Ud(p))throw new ue(q.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let g=h.field.canonicalString();throw new ue(q.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(p)}return new bo(d,c)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Um(n.firestore);return(function(s,a,l,c,d,h){let p=s.explicitOrderBy;if(d.length>p.length)throw new ue(q.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let S=0;S<d.length;S++){let I=d[S];if(p[S].field.isKeyField()){if(typeof I!="string")throw new ue(q.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof I}`);if(!Nm(s)&&I.indexOf("/")!==-1)throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${I}' contains a slash.`);let P=s.path.child(Nt.fromString(I));if(!Re.isDocumentKey(P))throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);let U=new Re(P);g.push(Bd(a,U))}else{let P=qx(l,c,I);g.push(P)}}return new bo(g,h)})(n._query,n.firestore._databaseId,r,e,t,i)}}function QP(n,e,t){if(typeof(t=Tn(t))=="string"){if(t==="")throw new ue(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Nm(e)&&t.indexOf("/")!==-1)throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Nt.fromString(t));if(!Re.isDocumentKey(i))throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Bd(n,new Re(i))}if(t instanceof kn)return Bd(n,t._key);throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vd(t)}.`)}function JP(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XP(n,e){let t=(function(r,o){for(let s of r)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ue(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function D7(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var cc=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},uc=class n extends Wd{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new dc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(lc("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};uc._jsonSchemaVersion="firestore/documentSnapshot/1.0",uc._jsonSchema={type:rn("string",uc._jsonSchemaVersion),bundleSource:rn("string","DocumentSnapshot"),bundleName:rn("string"),bundle:rn("string")};var dc=class extends uc{data(e={}){return super.data(e)}},hc=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new cc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new dc(this._firestore,this._userDataWriter,i.key,i,new cc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{let l=new dc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new dc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),c=-1,d=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:A7(a.type),doc:l,oldIndex:c,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sa.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function A7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oe(61501,{type:n})}}hc._jsonSchemaVersion="firestore/querySnapshot/1.0",hc._jsonSchema={type:rn("string",hc._jsonSchemaVersion),bundleSource:rn("string","QuerySnapshot"),bundleName:rn("string"),bundle:rn("string")};function bs(n){n=ic(n,or);let e=ic(n.firestore,Na),t=Vm(e),i=new Am(e);return T7(n._query),LP(t,n._query).then(r=>new hc(e,i,n,r))}function Kd(n,e){let t=ic(n.firestore,Na),i=Wx(n),r=D7(n.converter,e),o=Um(n.firestore);return M7(t,[$P(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,fs.exists(!1))]).then(()=>i)}function M7(n,e){let t=Vm(n);return VP(t,e)}(function(e,t=!0){gN(hs),ds(new Fi("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),a=new Na(new Xg(i.getProvider("auth-internal")),new tm(s,i.getProvider("app-check-internal")),BN(s,r),s);return o=F({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),ir(KP,YP,e),ir(KP,YP,"esm2020")})();function pk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var gk=pk,mk=new ho("auth","Firebase",pk());var Wm=new cs("@firebase/auth");function R7(n,...e){Wm.logLevel<=tt.WARN&&Wm.warn(`Auth (${hs}): ${n}`,...e)}function Hm(n,...e){Wm.logLevel<=tt.ERROR&&Wm.error(`Auth (${hs}): ${n}`,...e)}function Hr(n,...e){throw y1(n,...e)}function ar(n,...e){return y1(n,...e)}function m1(n,e,t){let i=fe(F({},gk()),{[e]:t});return new ho("auth","Firebase",i).create(e,{appName:n.name})}function Oa(n){return m1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function N7(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Hr(n,"argument-error"),m1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function y1(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return mk.create(n,...e)}function Be(n,e,...t){if(!n)throw y1(e,...t)}function Co(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Hm(e),new Error(e)}function Ao(n,e){n||Co(e)}function n1(){return typeof self<"u"&&self.location?.href||""}function P7(){return ek()==="http:"||ek()==="https:"}function ek(){return typeof self<"u"&&self.location?.protocol||null}function k7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(P7()||a2()||"connection"in navigator)?navigator.onLine:!0}function O7(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Fa=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ao(t>e,"Short delay should be less than long delay!"),this.isMobile=o2()||l2()}get(){return k7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function v1(n,e){Ao(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var qm=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Co("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Co("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Co("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var F7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var L7=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],V7=new Fa(3e4,6e4);function _1(n,e){return n.tenantId&&!e.tenantId?fe(F({},e),{tenantId:n.tenantId}):e}async function gc(n,e,t,i,r={}){return yk(n,r,async()=>{let o={},s={};i&&(e==="GET"?s=i:o={body:JSON.stringify(i)});let a=Vl(F({key:n.config.apiKey},s)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let c=F({method:e,headers:l},o);return s2()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&ls(n.emulatorConfig.host)&&(c.credentials="include"),qm.fetch()(await vk(n,n.config.apiHost,t,a),c)})}async function yk(n,e,t){n._canInitEmulator=!1;let i=F(F({},F7),e);try{let r=new i1(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw jm(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw jm(n,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw jm(n,"email-already-in-use",s);if(l==="USER_DISABLED")throw jm(n,"user-disabled",s);let d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw m1(n,d,c);Hr(n,d)}}catch(r){if(r instanceof bi)throw r;Hr(n,"network-request-failed",{message:String(r)})}}async function U7(n,e,t,i,r={}){let o=await gc(n,e,t,i,r);return"mfaPendingCredential"in o&&Hr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function vk(n,e,t,i){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?v1(n.config,r):`${n.config.apiScheme}://${r}`;return L7.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}var i1=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ar(this.auth,"network-request-failed")),V7.get())})}};function jm(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=ar(n,e,i);return r.customData._tokenResponse=t,r}async function B7(n,e){return gc(n,"POST","/v1/accounts:delete",e)}async function Km(n,e){return gc(n,"POST","/v1/accounts:lookup",e)}function Yd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _k(n,e=!1){let t=Tn(n),i=await t.getIdToken(e),r=E1(i);Be(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:Yd(e1(r.auth_time)),issuedAtTime:Yd(e1(r.iat)),expirationTime:Yd(e1(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function e1(n){return Number(n)*1e3}function E1(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Hm("JWT malformed, contained fewer than 3 sections"),null;try{let r=Og(t);return r?JSON.parse(r):(Hm("Failed to decode base64 JWT payload"),null)}catch(r){return Hm("Caught error parsing JWT payload as JSON",r?.toString()),null}}function tk(n){let e=E1(n);return Be(e,"internal-error"),Be(typeof e.exp<"u","internal-error"),Be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Jd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof bi&&j7(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function j7({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var r1=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Zd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yd(this.lastLoginAt),this.creationTime=Yd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Ym(n){let e=n.auth,t=await n.getIdToken(),i=await Jd(n,Km(e,{idToken:t}));Be(i?.users.length,e,"internal-error");let r=i.users[0];n._notifyReloadListener(r);let o=r.providerUserInfo?.length?bk(r.providerUserInfo):[],s=H7(n.providerData,o),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!s?.length,c=a?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Zd(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(n,d)}async function Ek(n){let e=Tn(n);await Ym(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function H7(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function bk(n){return n.map(i=>{var r=i,{providerId:e}=r,t=$a(r,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function $7(n,e){let t=await yk(n,{},async()=>{let i=Vl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=await vk(n,r,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return n.emulatorConfig&&ls(n.emulatorConfig.host)&&(l.credentials="include"),qm.fetch()(s,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function G7(n,e){return gc(n,"POST","/v2/accounts:revokeToken",_1(n,e))}var Qd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Be(e.idToken,"internal-error"),Be(typeof e.idToken<"u","internal-error"),Be(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Be(e.length!==0,"internal-error");let t=tk(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:r,expiresIn:o}=await $7(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n;return i&&(Be(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(Be(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(Be(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Co("not implemented")}};function ws(n,e){Be(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var xs=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:i}=s,r=$a(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new r1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Zd(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await Jd(this,this.stsTokenManager.getToken(this.auth,e));return Be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return _k(this,e)}reload(){return Ek(this)}_assign(e){this!==e&&(Be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>F({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(fe(F({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ym(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wi(this.auth.app))return Promise.reject(Oa(this.auth));let e=await this.getIdToken();return await Jd(this,B7(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return fe(F({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>F({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:h,emailVerified:p,isAnonymous:g,providerData:S,stsTokenManager:I}=t;Be(h&&I,e,"internal-error");let P=Qd.fromJSON(this.name,I);Be(typeof h=="string",e,"internal-error"),ws(i,e.name),ws(r,e.name),Be(typeof p=="boolean",e,"internal-error"),Be(typeof g=="boolean",e,"internal-error"),ws(o,e.name),ws(s,e.name),ws(a,e.name),ws(l,e.name),ws(c,e.name),ws(d,e.name);let U=new n({uid:h,auth:e,email:r,emailVerified:p,displayName:i,isAnonymous:g,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:P,createdAt:c,lastLoginAt:d});return S&&Array.isArray(S)&&(U.providerData=S.map(oe=>F({},oe))),l&&(U._redirectEventId=l),U}static async _fromIdTokenResponse(e,t,i=!1){let r=new Qd;r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Ym(o),o}static async _fromGetAccountInfoResponse(e,t,i){let r=t.users[0];Be(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?bk(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,a=new Qd;a.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Zd(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(l,c),l}};var nk=new Map;function Do(n){Ao(n instanceof Function,"Expected a class definition");let e=nk.get(n);return e?(Ao(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,nk.set(n,e),e)}var z7=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,i){this.storage[t]=i}async _get(t){let i=this.storage[t];return i===void 0?null:i}async _remove(t){delete this.storage[t]}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),o1=z7;function $m(n,e,t){return`firebase:${n}:${e}:${t}`}var Qm=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=$m(this.userKey,r.apiKey,o),this.fullPersistenceKey=$m("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Km(this.auth,{idToken:e}).catch(()=>{});return t?xs._fromGetAccountInfoResponse(this.auth,t,e):null}return xs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new n(Do(o1),e,i);let r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c),o=r[0]||Do(o1),s=$m(i,e.config.apiKey,e.name),a=null;for(let c of t)try{let d=await c._get(s);if(d){let h;if(typeof d=="string"){let p=await Km(e,{idToken:d}).catch(()=>{});if(!p)break;h=await xs._fromGetAccountInfoResponse(e,p,d)}else h=xs._fromJSON(e,d);c!==o&&(a=h),o=c;break}}catch{}let l=r.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,i):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==o)try{await c._remove(s)}catch{}})),new n(o,e,i))}};function ik(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ik(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ck(e))return"Blackberry";if(Dk(e))return"Webos";if(xk(e))return"Safari";if((e.includes("chrome/")||Sk(e))&&!e.includes("edge/"))return"Chrome";if(Tk(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function wk(n=In()){return/firefox\//i.test(n)}function xk(n=In()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Sk(n=In()){return/crios\//i.test(n)}function Ik(n=In()){return/iemobile/i.test(n)}function Tk(n=In()){return/android/i.test(n)}function Ck(n=In()){return/blackberry/i.test(n)}function Dk(n=In()){return/webos/i.test(n)}function b1(n=In()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function W7(n=In()){return b1(n)&&!!window.navigator?.standalone}function q7(){return c2()&&document.documentMode===10}function Ak(n=In()){return b1(n)||Tk(n)||Dk(n)||Ck(n)||/windows phone/i.test(n)||Ik(n)}function Mk(n,e=[]){let t;switch(n){case"Browser":t=ik(In());break;case"Worker":t=`${ik(In())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${hs}/${i}`}var s1=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=o=>new Promise((s,a)=>{try{let l=e(o);s(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}};async function K7(n,e={}){return gc(n,"GET","/v2/passwordPolicy",_1(n,e))}var Y7=6,a1=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Y7,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var l1=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jm(this),this.idTokenSubscription=new Jm(this),this.beforeStateQueue=new s1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Do(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qm.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Km(this,{idToken:e}),i=await xs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(wi(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ym(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=O7()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wi(this.app))return Promise.reject(Oa(this));let t=e?Tn(e):null;return t&&Be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wi(this.app)?Promise.reject(Oa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wi(this.app)?Promise.reject(Oa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Do(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await K7(this),t=new a1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ho("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await G7(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Do(e)||this._popupRedirectResolver;Be(t,this,"argument-error"),this.redirectPersistenceManager=await Qm.create(this,[Do(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Be(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{s=!0,l()}}else{let l=e.addObserver(t);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Mk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(wi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&R7(`Error while retrieving App Check token: ${e.error}`),e?.token}};function o0(n){return Tn(n)}var Jm=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=f2(t=>this.observer=t)}get next(){return Be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var w1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Q7(n){w1=n}function J7(n){return w1.loadJS(n)}function Z7(){return w1.gapiScript}function Rk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Nk(n,e){let t=yd(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(nr(o,e??{}))return r;Hr(r,"already-initialized")}return t.initialize({options:e})}function X7(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Do);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Pk(n,e,t){let i=o0(n);Be(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=kk(e),{host:s,port:a}=e$(e),l=a===null?"":`:${a}`,c={url:`${o}//${s}${l}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Be(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Be(nr(c,i.config.emulator)&&nr(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,ls(s)?(Lg(`${o}//${s}${l}`),Vg("Auth",!0)):r||t$()}function kk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function e$(n){let e=kk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:rk(i.substr(o.length+1))}}else{let[o,s]=i.split(":");return{host:o,port:rk(s)}}}function rk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function t$(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Xd=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Co("not implemented")}_getIdTokenResponse(e){return Co("not implemented")}_linkToIdToken(e,t){return Co("not implemented")}_getReauthenticationResolver(e){return Co("not implemented")}};async function pc(n,e){return U7(n,"POST","/v1/accounts:signInWithIdp",_1(n,e))}var n$="http://localhost",Zm=class n extends Xd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Hr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=a,o=$a(a,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return pc(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,pc(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,pc(e,t)}buildRequest(){let e={requestUri:n$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vl(t)}return e}};var eh=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Xm=class extends eh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var x1=(()=>{class n extends Xm{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return Zm._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var th=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){let o=await xs._fromIdTokenResponse(e,i,r),s=ok(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);let r=ok(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})}};function ok(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var c1=class n extends bi{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function Ok(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?c1._fromErrorAndOperation(n,o,e,i):o})}async function i$(n,e,t=!1){let i=await Jd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return th._forOperation(n,"link",i)}async function r$(n,e,t=!1){let{auth:i}=n;if(wi(i.app))return Promise.reject(Oa(i));let r="reauthenticate";try{let o=await Jd(n,Ok(i,r,e,n),t);Be(o.idToken,i,"internal-error");let s=E1(o.idToken);Be(s,i,"internal-error");let{sub:a}=s;return Be(n.uid===a,i,"user-mismatch"),th._forOperation(n,r,o)}catch(o){throw o?.code==="auth/user-not-found"&&Hr(i,"user-mismatch"),o}}async function o$(n,e,t=!1){if(wi(n.app))return Promise.reject(Oa(n));let i="signIn",r=await Ok(n,i,e),o=await th._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}function Fk(n,e,t,i){return Tn(n).onIdTokenChanged(e,t,i)}function Lk(n,e,t){return Tn(n).beforeAuthStateChanged(e,t)}function S1(n,e,t,i){return Tn(n).onAuthStateChanged(e,t,i)}function I1(n){return Tn(n).signOut()}var e0="__sak";var t0=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(e0,"1"),this.storage.removeItem(e0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var s$=1e3,a$=10,l$=(()=>{class n extends t0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ak(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);q7()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,a$):o()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},s$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,i){await super._set(t,i),this.localCache[t]=JSON.stringify(i)}async _get(t){let i=await super._get(t);return this.localCache[t]=JSON.stringify(i),i}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),Vk=l$;var c$=(()=>{class n extends t0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),T1=c$;function u$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var d$=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let i=t,{eventId:r,eventType:o,data:s}=i.data,a=this.handlersMap[o];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let l=Array.from(a).map(async d=>d(i.origin,s)),c=await u$(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:c})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function C1(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var u1=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{let c=C1("",20);r.port1.start();let d=setTimeout(()=>{l(new Error("unsupported_event"))},i);s={messageChannel:r,onMessage(h){let p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(p.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function jr(){return window}function h$(n){jr().location.href=n}function Uk(){return typeof jr().WorkerGlobalScope<"u"&&typeof jr().importScripts=="function"}async function f$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function p$(){return navigator?.serviceWorker?.controller||null}function g$(){return Uk()?self:null}var Bk="firebaseLocalStorageDb",m$=1,n0="firebaseLocalStorage",jk="fbase_key",La=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function s0(n,e){return n.transaction([n0],e?"readwrite":"readonly").objectStore(n0)}function y$(){let n=indexedDB.deleteDatabase(Bk);return new La(n).toPromise()}function d1(){let n=indexedDB.open(Bk,m$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(n0,{keyPath:jk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{let i=n.result;i.objectStoreNames.contains(n0)?e(i):(i.close(),await y$(),e(await d1()))})})}async function sk(n,e,t){let i=s0(n,!0).put({[jk]:e,value:t});return new La(i).toPromise()}async function v$(n,e){let t=s0(n,!1).get(e),i=await new La(t).toPromise();return i===void 0?null:i.value}function ak(n,e){let t=s0(n,!0).delete(e);return new La(t).toPromise()}var _$=800,E$=3,b$=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await d1(),this.db)}async _withRetries(t){let i=0;for(;;)try{let r=await this._openDb();return await t(r)}catch(r){if(i++>E$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=d$._getInstance(g$()),this.receiver._subscribe("keyChanged",async(t,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(t,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await f$(),!this.activeServiceWorker)return;this.sender=new u1(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||p$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await d1();return await sk(t,e0,"1"),await ak(t,e0),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,i){return this._withPendingWrite(async()=>(await this._withRetries(r=>sk(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)))}async _get(t){let i=await this._withRetries(r=>v$(r,t));return this.localCache[t]=i,i}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ak(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=s0(o,!1).getAll();return new La(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Hk=b$;var fhe=Rk("rcb"),phe=new Fa(3e4,6e4);function $k(n,e){return e?Do(e):(Be(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var nh=class extends Xd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return pc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return pc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function w$(n){return o$(n.auth,new nh(n),n.bypassAuthState)}function x$(n){let{auth:e,user:t}=n;return Be(t,e,"internal-error"),r$(t,new nh(n),n.bypassAuthState)}async function S$(n){let{auth:e,user:t}=n;return Be(t,e,"internal-error"),i$(t,new nh(n),n.bypassAuthState)}var i0=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w$;case"linkViaPopup":case"linkViaRedirect":return S$;case"reauthViaPopup":case"reauthViaRedirect":return x$;default:Hr(this.auth,"internal-error")}}resolve(e){Ao(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ao(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var I$=new Fa(2e3,1e4);async function D1(n,e,t){if(wi(n.app))return Promise.reject(ar(n,"operation-not-supported-in-this-environment"));let i=o0(n);N7(n,e,eh);let r=$k(i,t);return new T$(i,"signInViaPopup",e,r).executeNotNull()}var T$=(()=>{class n extends i0{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return Be(t,this.auth,"internal-error"),t}async onExecution(){Ao(this.filter.length===1,"Popup operations only handle one event");let t=C1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(ar(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ar(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ar(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,I$.get())};t()}}n.currentPopupAction=null;return n})(),C$="pendingRedirect",Gm=new Map,h1=class extends i0{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Gm.get(this.auth._key());if(!e){try{let i=await D$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Gm.set(this.auth._key(),e)}return this.bypassAuthState||Gm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function D$(n,e){let t=R$(e),i=M$(n);if(!await i._isAvailable())return!1;let r=await i._get(t)==="true";return await i._remove(t),r}function A$(n,e){Gm.set(n._key(),e)}function M$(n){return Do(n._redirectPersistence)}function R$(n){return $m(C$,n.config.apiKey,n.name)}async function N$(n,e,t=!1){if(wi(n.app))return Promise.reject(Oa(n));let i=o0(n),r=$k(i,e),s=await new h1(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}var P$=600*1e3,f1=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!k$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Gk(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ar(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=P$&&this.cachedEventUids.clear(),this.cachedEventUids.has(lk(e))}saveEventToCache(e){this.cachedEventUids.add(lk(e)),this.lastProcessedEventTime=Date.now()}};function lk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Gk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function k$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gk(n);default:return!1}}async function O$(n,e={}){return gc(n,"GET","/v1/projects",e)}var F$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,L$=/^https?/;async function V$(n){if(n.config.emulator)return;let{authorizedDomains:e}=await O$(n);for(let t of e)try{if(U$(t))return}catch{}Hr(n,"unauthorized-domain")}function U$(n){let e=n1(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i}if(!L$.test(t))return!1;if(F$.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var B$=new Fa(3e4,6e4);function ck(){let n=jr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function j$(n){return new Promise((e,t)=>{function i(){ck(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ck(),t(ar(n,"network-request-failed"))},timeout:B$.get()})}if(jr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(jr().gapi?.load)i();else{let r=Rk("iframefcb");return jr()[r]=()=>{gapi.load?i():t(ar(n,"network-request-failed"))},J7(`${Z7()}?onload=${r}`).catch(o=>t(o))}}).catch(e=>{throw zm=null,e})}var zm=null;function H$(n){return zm=zm||j$(n),zm}var $$=new Fa(5e3,15e3),G$="__/auth/iframe",z$="emulator/auth/iframe",W$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function K$(n){let e=n.config;Be(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?v1(e,z$):`https://${n.config.authDomain}/${G$}`,i={apiKey:e.apiKey,appName:n.name,v:hs},r=q$.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Vl(i).slice(1)}`}async function Y$(n){let e=await H$(n),t=jr().gapi;return Be(t,n,"internal-error"),e.open({where:document.body,url:K$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:W$,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});let s=ar(n,"network-request-failed"),a=jr().setTimeout(()=>{o(s)},$$.get());function l(){jr().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{o(s)})}))}var Q$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},J$=500,Z$=600,X$="_blank",eG="http://localhost",r0=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function tG(n,e,t,i=J$,r=Z$){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=fe(F({},Q$),{width:i.toString(),height:r.toString(),top:o,left:s}),c=In().toLowerCase();t&&(a=Sk(c)?X$:t),wk(c)&&(e=e||eG,l.scrollbars="yes");let d=Object.entries(l).reduce((p,[g,S])=>`${p}${g}=${S},`,"");if(W7(c)&&a!=="_self")return nG(e||"",a),new r0(null);let h=window.open(e||"",a,d);Be(h,n,"popup-blocked");try{h.focus()}catch{}return new r0(h)}function nG(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var iG="__/auth/handler",rG="emulator/auth/handler",oG=encodeURIComponent("fac");async function uk(n,e,t,i,r,o){Be(n.config.authDomain,n,"auth-domain-config-required"),Be(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:hs,eventId:r};if(e instanceof eh){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",h2(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(o||{}))s[d]=h}if(e instanceof Xm){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let l=await n._getAppCheckToken(),c=l?`#${oG}=${encodeURIComponent(l)}`:"";return`${sG(n)}?${Vl(a).slice(1)}${c}`}function sG({config:n}){return n.emulator?v1(n,rG):`https://${n.authDomain}/${iG}`}var t1="webStorageSupport",p1=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=T1,this._completeRedirectFn=N$,this._overrideRedirectResult=A$}async _openPopup(e,t,i,r){Ao(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await uk(e,t,i,n1(),r);return tG(e,o,C1())}async _openRedirect(e,t,i,r){await this._originValidation(e);let o=await uk(e,t,i,n1(),r);return h$(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Ao(o,"If manager is not set, promise should be"),o)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){let t=await Y$(e),i=new f1(e);return t.register("authEvent",r=>(Be(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(t1,{type:t1},r=>{let o=r?.[0]?.[t1];o!==void 0&&t(!!o),Hr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=V$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ak()||xk()||b1()}},zk=p1;var dk="@firebase/auth",hk="1.12.0";var g1=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function aG(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function lG(n){ds(new Fi("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=i.options;Be(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Mk(n)},c=new l1(i,r,o,l);return X7(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ds(new Fi("auth-internal",e=>{let t=o0(e.getProvider("auth").getImmediate());return(i=>new g1(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ir(dk,hk,aG(n)),ir(dk,hk,"esm2020")}var cG=300,uG=Sb("authIdTokenMaxAge")||cG,fk=null,dG=n=>async e=>{let t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>uG)return;let r=t?.token;fk!==r&&(fk=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function ih(n=Hg()){let e=yd(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Nk(n,{popupRedirectResolver:zk,persistence:[Hk,Vk,T1]}),i=Sb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=dG(o.toString());Lk(t,s,()=>s(t.currentUser)),Fk(t,a=>s(a))}}let r=wb("auth");return r&&Pk(t,`http://${r}`),t}function hG(){return document.getElementsByTagName("head")?.[0]??document}Q7({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=ar("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",hG().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});lG("Browser");var a0={apiKey:"AIzaSyAPqKyCi-hNRpgCq-Bb4N9GLXuVMVb5gRE",authDomain:"shape-tactics.firebaseapp.com",projectId:"shape-tactics",storageBucket:"shape-tactics.firebasestorage.app",messagingSenderId:"730983908831",appId:"1:730983908831:web:471c5b5ba460ca8a56306a",measurementId:"G-HTR0KV73C8"};var jn=class n{constructor(e){this.platformId=e;let t=vd(a0);try{this.db=Gd(t)}catch(i){console.warn("Firestore init failed (likely SSR)",i)}if(is(this.platformId))try{this.auth=ih(t),S1(this.auth,i=>{this.user$.set(i)})}catch(i){console.warn("Auth init failed",i)}}db=null;auth=null;user$=G(null);async loginWithGoogle(){if(!(!this.auth||!is(this.platformId)))try{let e=new x1;await D1(this.auth,e)}catch(e){console.error("Login failed",e)}}async logout(){this.auth&&await I1(this.auth)}async saveHighScore(e){if(this.db)try{await Kd(xi(this.db,"highscores"),e)}catch(t){console.error("Error adding document: ",t)}}async getTopScores(e,t,i){if(!this.db)return[];try{let r=To(xi(this.db,"highscores"),_s("difficulty","==",t),_s("mapSize","==",i),sr("victory","desc"),sr("turnsPlayed","asc"),Es(e));return(await bs(r)).docs.map(s=>s.data())}catch(r){return console.error("Error fetching scores: ",r),[]}}async getUserScores(e){if(!this.db)return[];try{let t=To(xi(this.db,"highscores"),_s("userId","==",e),_s("victory","==",!0),sr("turnsPlayed","asc"));return(await bs(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching user scores: ",t),[]}}async saveTowerDefenseScore(e){if(this.db)try{let t=fe(F({},e),{timestamp:zd()});await Kd(xi(this.db,"towerDefenseLeaderboards"),t)}catch(t){console.error("Error adding TD score: ",t)}}async getTopTowerDefenseScores(e){if(!this.db)return[];try{let t=To(xi(this.db,"towerDefenseLeaderboards"),sr("maxWave","desc"),sr("timestamp","desc"),Es(e));return(await bs(t)).docs.map(r=>r.data())}catch(t){return console.error("Error fetching TD scores: ",t),[]}}static \u0275fac=function(t){return new(t||n)(De(Ji))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var mc=class n{platformId=z(Ji);nameSignal=G("Player");constructor(){if(is(this.platformId))try{let e=localStorage.getItem("playerName");e&&typeof e=="string"&&e.trim().length>0&&this.nameSignal.set(this.normalize(e))}catch{}}name(){return this.nameSignal()}setName(e){let t=this.normalize(e);if(this.nameSignal.set(t),is(this.platformId))try{localStorage.setItem("playerName",t)}catch{}}normalize(e){let i=(e??"").toString().trim().slice(0,24);return i.length>0?i:"Player"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var ii=class n{constructor(e,t,i,r,o,s,a,l,c){this.combat=e;this.build=t;this.log=i;this.settings=r;this.map=o;this.economy=s;this.aiStrategy=a;this.firebase=l;this.playerName=c;this.loadHighScores(),this.resetGame()}get gridSize(){return this.settings.mapSize()}breakpointObserver=z(vb);screenState=GR(this.breakpointObserver.observe("(max-width: 1024px)").pipe(vt(e=>e.matches)),{initialValue:!1});unitsSignal=G([]);turnSignal=G(1);selectedUnitIdSignal=G(null);gameStatusSignal=G("playing");lastMergedUnitIdSignal=G(null);lastRemainderUnitIdSignal=G(null);resourcesSignal=G({wood:0,iron:0});forestsSignal=G([]);minesSignal=G([]);forgeSitesSignal=G([]);forgesSignal=G([]);aiForgesSignal=G([]);baseHealthSignal=G({player:100,ai:100});reservePointsSignal=G({player:0,ai:0});deployTargetsSignal=G([]);baseDeployActiveSignal=G(!1);wallsSignal=G([]);playerVisibilitySignal=G(new Set);aiVisibilitySignal=G(new Set);playerExploredSignal=G(new Set);aiExploredSignal=G(new Set);unitMoveHistorySignal=G(new Map);unitStutterBanSignal=G(new Map);lastAiMovedUnitIdSignal=G(null);aiConsecMovesSignal=G(0);buildModeSignal=G(!1);fogDebugDisabledSignal=G(!1);wallBuiltThisTurnSignal=G(!1);rulesOpenSignal=G(!1);movedThisTurnSignal=G(new Set);hoveredFormationIdSignal=G(null);aiWoodSignal=G(0);aiIronSignal=G(0);logsOpenSignal=G(!1);settingsOpenSignal=G(!1);activeSideSignal=G("ai");lastArrivedUnitIdSignal=G(null);attackerNudgeSignal=G(null);shakenUnitIdSignal=G(null);shakenWallIdSignal=G(null);pulseUnitIdSignal=G(null);screenShakeSignal=G(!1);endOverlaySignal=G(!1);endReasonSignal=G(null);combatOnlySignal=G(!0);forestMonopolySignal=G({player:0,ai:0});hoveredUnitIdSignal=G(null);autoDeployEnabledSignal=G(!1);highScoresOpenSignal=G(!1);leaderboardOpenSignal=G(!1);namePromptOpenSignal=G(!1);pendingScoreSignal=G(null);supportOpenSignal=G(!1);highScoresSignal=G({});playerConvertedThisTurnSignal=G(!1);unitQuadrantBiasSignal=G(new Map);aiUnitTimeNearBaseSignal=G(new Map);aiBatchingActions=!1;isAiThinking=!1;aggressionModeSignal=G(!1);wallCooldownSignal=G(new Map);aiQueuedUnitIdSignal=G(null);aiMoodSignal=G("none");rageCaptureCounterSignal=G(0);anchoredGatherersSignal=G(new Set);totalWarModeSignal=G(!1);aiInvalidActionCountSignal=G(0);aiLastRejectedActionKeySignal=G(null);sandboxSpawnPendingSignal=G(null);unitMoveOffsetSignal=G(new Map);movingUnitsSignal=G(new Set);attackingUnitsSignal=G(new Set);reclamationGoalsSignal=G(new Map);mergeIntentSignal=G(new Map);ignoreForgeUntilTurnSignal=G(new Map);playerClaimedTargetsSignal=G(new Set);units=this.unitsSignal.asReadonly();turn=this.turnSignal.asReadonly();selectedUnitId=this.selectedUnitIdSignal.asReadonly();gameStatus=this.gameStatusSignal.asReadonly();lastMergedUnitId=this.lastMergedUnitIdSignal.asReadonly();lastRemainderUnitId=this.lastRemainderUnitIdSignal.asReadonly();resources=this.resourcesSignal.asReadonly();forests=this.forestsSignal.asReadonly();mines=this.minesSignal.asReadonly();forges=this.forgesSignal.asReadonly();baseHealth=this.baseHealthSignal.asReadonly();reservePoints=this.reservePointsSignal.asReadonly();deployTargets=this.deployTargetsSignal.asReadonly();baseDeployActive=this.baseDeployActiveSignal.asReadonly();walls=this.wallsSignal.asReadonly();playerVisibility=this.playerVisibilitySignal.asReadonly();aiVisibility=this.aiVisibilitySignal.asReadonly();playerExplored=this.playerExploredSignal.asReadonly();aiExplored=this.aiExploredSignal.asReadonly();buildMode=this.buildModeSignal.asReadonly();fogDebugDisabled=this.fogDebugDisabledSignal.asReadonly();wallBuiltThisTurn=this.wallBuiltThisTurnSignal.asReadonly();rulesOpen=this.rulesOpenSignal.asReadonly();lastArrivedUnitId=this.lastArrivedUnitIdSignal.asReadonly();pulseUnitId=this.pulseUnitIdSignal.asReadonly();aiUnitTimeNearBase=this.aiUnitTimeNearBaseSignal.asReadonly();isMobile=ei(()=>this.screenState());sandboxSpawnPending(){return this.sandboxSpawnPendingSignal()}getMoveOffsetFor(e){return this.unitMoveOffsetSignal().get(e)??null}isUnitMoving(e){return this.movingUnitsSignal().has(e)}isUnitAttacking(e){return this.attackingUnitsSignal().has(e)}getCombinedTransform(e){let t=this.attackerNudgeSignal(),i=this.getMoveOffsetFor(e),r=(t&&t.id===e?t.dx:0)+(i?i.dx:0),o=(t&&t.id===e?t.dy:0)+(i?i.dy:0);return`translate(${r}px, ${o}px)`}aggressionMode(){return this.aggressionModeSignal()}totalWarMode(){return this.totalWarModeSignal()}isAnchoredGatherer(e){return this.anchoredGatherersSignal().has(e)}anchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.add(e),this.anchoredGatherersSignal.set(t)}unanchorGatherer(e){let t=new Set(this.anchoredGatherersSignal());t.delete(e),this.anchoredGatherersSignal.set(t)}queuedUnitId(){return this.aiQueuedUnitIdSignal()}currentMood(){return this.aiMoodSignal()}isAngry(){return this.aiMoodSignal()==="angry"}isRage(){return this.aiMoodSignal()==="rage"}selectedUnit=ei(()=>this.unitsSignal().find(e=>e.id===this.selectedUnitIdSignal())||null);validMoves=ei(()=>{let e=this.selectedUnit();return e?e.hasActed?[]:this.calculateValidMoves(e):[]});get gridRows(){return Array.from({length:this.gridSize},(e,t)=>t)}get gridCols(){return Array.from({length:this.gridSize},(e,t)=>t)}get tileSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?48:32}get tileMinSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?48:64:e<=20?40:32}get wallThicknessPx(){let e=this.gridSize;return e<=10?this.isMobile()?4:6:e<=20?4:2}get iconSizePx(){let e=this.gridSize;return e<=10?this.isMobile()?12:16:e<=20?12:8}get tileUnitSizePx(){return Math.round(this.tileSizePx*.75)}getForestControl(){let e=this.forestsSignal().length,t=this.unitsSignal().filter(r=>r.owner==="player"&&this.isForest(r.position.x,r.position.y)).length,i=this.unitsSignal().filter(r=>r.owner==="ai"&&this.isForest(r.position.x,r.position.y)).length;return{total:e,player:t,ai:i}}resetGame(){let e=this.settings.difficulty();this.stopAiLoops(),this.unitsSignal.set([]),this.wallCooldownSignal.set(new Map),this.turnSignal.set(1),this.activeSideSignal.set("ai"),this.selectedUnitIdSignal.set(null),this.gameStatusSignal.set("playing"),this.endOverlaySignal.set(!1),this.endReasonSignal.set(null),this.forestMonopolySignal.set({player:0,ai:0}),this.lastMergedUnitIdSignal.set(null),this.lastRemainderUnitIdSignal.set(null),this.resourcesSignal.set({wood:0,iron:0}),this.baseHealthSignal.set(this.settings.customMode()?{player:1e3,ai:1e3}:{player:100,ai:100}),e==="baby"?this.reservePointsSignal.set({player:5,ai:5}):e==="normal"?this.reservePointsSignal.set({player:1,ai:1}):e==="hard"?this.reservePointsSignal.set({player:1,ai:3}):this.reservePointsSignal.set({player:1,ai:5}),this.deployTargetsSignal.set([]),this.forestsSignal.set(this.map.generateForests(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"))),this.minesSignal.set(this.map.generateMines(this.gridSize,this.getBasePosition("player"),this.getBasePosition("ai"),this.forestsSignal())),this.forgeSitesSignal.set([]),this.forgesSignal.set([]),this.aiForgesSignal.set([]);let t=new Set(this.forestsSignal().map(i=>`${i.x},${i.y}`));this.playerExploredSignal.set(new Set(t)),this.aiExploredSignal.set(new Set(t)),this.wallsSignal.set([]),this.placeNeutralWalls(),this.baseDeployActiveSignal.set(!1),this.buildModeSignal.set(!1),this.fogDebugDisabledSignal.set(!1),this.wallBuiltThisTurnSignal.set(!1),this.spawnStarterArmy("player"),this.spawnStarterArmy("ai"),this.recomputeVisibility(),this.startSideTurn(this.activeSideSignal()),this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10)}selectUnit(e){if(this.gameStatus()!=="playing")return;if(!e){this.selectedUnitIdSignal.set(null);return}let t=this.unitsSignal().find(i=>i.id===e);t&&t.owner==="player"&&this.selectedUnitIdSignal.set(e)}moveSelectedUnit(e){if(this.gameStatus()!=="playing")return;let t=this.selectedUnit();!t||t.hasActed||!this.validMoves().some(r=>r.x===e.x&&r.y===e.y)||this.executeMove(t,e)}executeMove(e,t){if(e.hasActed)return;let i=!1,r=!1,o=null;this.unitsSignal.update(p=>{let g=[...p],S=g.findIndex(C=>C.id===e.id);if(S===-1)return p;let I=F({},g[S]),P={x:I.position.x,y:I.position.y},U=t.x-P.x,oe=t.y-P.y,Se=Math.sign(U),xe=Math.sign(oe),Ae=this.combat.checkWallAlongPath(P,t,I.owner,(C,N,A,w)=>this.getWallBetween(C,N,A,w));if(Ae.hitOwn)return g;if(Ae.hitEnemy){let C=Ae.lastFrom,N=this.getWallBetween(C.x,C.y,t.x,t.y);{let w=N.maxHealth??100,R=this.combat.getWallHitAmount(I.tier),M=Math.max(0,N.health-R);this.wallsSignal.update(Fe=>Fe.map(he=>he.id===N.id?fe(F({},he),{health:M}):he).filter(he=>(he.health??he.hitsRemaining??0)>0)),M<=0&&this.registerWallDestroyedEdge(C,t);let me=N.owner==="neutral"?"Neutral":N.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${I.tier} Unit attacked ${me} Wall. Damage: ${R}. Wall HP: ${M}/${w}.`)}this.updateWallFormations(),this.shakenWallIdSignal.set(N.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let A=g.findIndex(w=>w.id===I.id);return A!==-1&&(g[A]=fe(F({},g[A]),{hasActed:!0})),g}let Ie=this.getBasePosition(I.owner==="player"?"ai":"player");if(t.x===Ie.x&&t.y===Ie.y)return this.baseHealthSignal.update(C=>{let N=I.owner==="player"?"ai":"player",A=F({},C);return A[N]=Math.max(0,A[N]-this.calculatePower(I)),A}),g.splice(S,1),g;let k=g.findIndex(C=>C.position.x===t.x&&C.position.y===t.y&&C.id!==I.id);if(k!==-1){let C=g[k],N={x:t.x-Se,y:t.y-xe};if(this.inBounds(N.x,N.y)){if(Se!==0&&xe!==0){if(this.combat.isDiagonalBlocked(N,t,(A,w,R,M)=>this.getWallBetween(A,w,R,M)))return i=!1,g}else if(this.getWallBetween(N.x,N.y,t.x,t.y))return i=!1,g}if(C.owner===I.owner)if(this.shakenUnitIdSignal.set(I.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),180),C.tier===I.tier){let A=C.tier,w=this.calculateTotalPoints(I)+this.calculateTotalPoints(C),R={1:[1,2,3,4],2:[5,10,15,20],3:[25,50,75,100],4:[125,250,375,500]},M=R[A][3];if(w<=M){C.points=w;let Fe=this.calculateTierAndLevel(C.points);C.tier=Fe.tier,C.level=Fe.level;let he=!!(C.hasWeapon||I.hasWeapon),Vt=!!(C.hasArmor||I.hasArmor),Jt=Vt?Math.max(C.armorHp??0,I.armorHp??0):0;C.hasWeapon=he,C.hasArmor=Vt,C.armorHp=Jt,g.splice(S,1)}else{let Fe=Math.min(4,A+1),he=R[Fe][0];C.points=he;let Vt=this.calculateTierAndLevel(C.points);C.tier=Vt.tier,C.level=Vt.level;let Jt=!!(C.hasWeapon||I.hasWeapon),Me=!!(C.hasArmor||I.hasArmor),Gt=Me?Math.max(C.armorHp??0,I.armorHp??0):0;C.hasWeapon=Jt,C.hasArmor=Me,C.armorHp=Gt;let ct=w-he;if(ct>0){I.points=ct;let te=this.calculateTierAndLevel(I.points);I.tier=te.tier,I.level=te.level,I.hasWeapon=!1,I.hasArmor=!1,I.armorHp=0,g[S]=I,o=I.id}else g.splice(S,1)}r=!0;let me=new Map(this.mergeIntentSignal());me.delete(I.id),me.delete(C.id),this.mergeIntentSignal.set(me)}else return g;else{{let te=t.x-P.x,ne=t.y-P.y,Ee=Math.abs(te)>=Math.abs(ne),ve=Math.sign(Ee?te:ne),ye=this.wallThicknessPx+2,_=this.tileSizePx+ye,ae=Math.round(_*.35),We=Ee?ve*ae:0,qe=Ee?0:ve*ae,se=new Set(this.attackingUnitsSignal());se.add(I.id),this.attackingUnitsSignal.set(se),this.attackerNudgeSignal.set({id:I.id,dx:We,dy:qe}),setTimeout(()=>{this.attackerNudgeSignal.set({id:I.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let xt=new Set(this.attackingUnitsSignal());xt.delete(I.id),this.attackingUnitsSignal.set(xt)},200)}this.shakenUnitIdSignal.set(C.id),setTimeout(()=>this.shakenUnitIdSignal.set(null),200);let A=this.combat.calculateHitChance(I,C);if(Math.floor(Math.random()*100)+1>A)return this.queueCombatText("DEFLECTED!",t),this.log.addCombat(I.owner,`[Combat] DEFLECTED! T${I.tier} failed to penetrate T${C.tier}. Attacker destroyed.`,!1),g.splice(S,1),g;this.log.addCombat(I.owner,`[Combat] HIT! T${I.tier} breached T${C.tier} armor.`,!1);let R=this.calculateTotalPoints(I)+(I.hasWeapon?20:0),M=this.getAttackLuckModifier(I),me=this.calculateTotalPoints(C),Fe=this.combat.getDefenseBonus(C,g),he=Math.max(0,R+M.delta),Vt=me+Fe.bonus,Jt=I.hasWeapon?"Weapon +20":"",Me=[...Fe.tags,M.tag??"",Jt].filter(Boolean).join(", ")||"None",Gt=he-Vt,ct=`[Turn ${this.turnSignal()}] ${I.owner==="player"?"Player":"AI"} T${I.tier}(L${I.level}) attacked ${C.owner==="player"?"Player":"AI"} T${C.tier}(L${C.level}). Power: ${R} vs ${me}. Modifiers: ${Me}. Final: (${R}${M.delta!==0?M.delta>0?`+${M.delta}`:`${M.delta}`:""}${Fe.bonus>0?` - ${Fe.bonus}`:""}) - ${me} = ${Gt}.`;if(this.log.addCombat(I.owner,ct,!!M.isCrit),he<Vt&&this.queueCombatText("WEAK!",t),he>Vt){let te=this.combat.calculateHitChance(C,I),Ee=Math.floor(Math.random()*100)+1<=te,ve=Ee?me:0;if(ve>0){let ye=this.combat.applyDamage(I,ve);I.points=ye.points,I.tier=ye.tier,I.level=ye.level,I.armorHp=ye.armorHp}Ee||this.log.addCombat(I.owner,`[Combat] T${I.tier} armor deflected the counter-attack from T${C.tier}. Final HP: ${I.points}`,!1),g.splice(k,1),M.tag&&this.queueCombatText(M.tag.startsWith("CRIT")?"CRIT!":"MISS!",t)}else if(he<Vt){let te=he,ne=this.combat.applyDamage(C,te),Ee=F({},ne);return g[k]=Ee,g.splice(S,1),g}else{if(Math.random()<.5)return this.queueCombatText("DRAW",t),this.log.addCombat(I.owner,`[Turn ${this.turnSignal()}] Result: DRAW - Both units destroyed.`,!1),g.filter(ne=>ne.id!==I.id&&ne.id!==C.id);{let ne=Math.random()<.5;if(this.queueCombatText("LUCKY! (x1.25)",t),ne){let Ee=this.getPointsForTierLevel(I.tier,1);I.points=Ee;let ve=this.calculateTierAndLevel(Ee);I.tier=ve.tier,I.level=ve.level,g.splice(k,1),this.pulseUnitIdSignal.set(I.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(I.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Attacker survived!`,!1)}else{let Ee=this.getPointsForTierLevel(C.tier,1),ve=fe(F({},C),{points:Ee}),ye=this.calculateTierAndLevel(Ee);return ve.tier=ye.tier,ve.level=ye.level,g[k]=ve,g.splice(S,1),this.pulseUnitIdSignal.set(ve.id),setTimeout(()=>this.pulseUnitIdSignal.set(null),400),this.log.addCombat(I.owner,`[Turn ${this.turnSignal()}] Result: LUCKY (x1.25) - Defender survived!`,!1),this.queueCombatText("LUCKY DEFENSE!",t),g}}}}}if(g.find(C=>C.id===I.id)&&o!==I.id){I.position=t,I.turnsStationary=0,I.hasActed=!0;let C=g.findIndex(Fe=>Fe.id===I.id);C!==-1&&(g[C]=I),I.owner==="ai"&&I.tier<3&&this.isForest(t.x,t.y)&&(this.aiStrategy.setGoal(I.id,{x:t.x,y:t.y}),I.tier<=2&&this.anchorGatherer(I.id));let N=new Set(this.movedThisTurnSignal());N.add(I.id),this.movedThisTurnSignal.set(N),this.lastArrivedUnitIdSignal.set(I.id),setTimeout(()=>this.lastArrivedUnitIdSignal.set(null),250);let A=new Map(this.unitMoveHistorySignal()),w=A.get(I.id)??[],R={x:P.x,y:P.y},M={x:t.x,y:t.y},me=[...w,R,M].slice(-4);A.set(I.id,me),this.unitMoveHistorySignal.set(A)}return g});let s=t.x-e.position.x,a=t.y-e.position.y,l=this.wallThicknessPx+2,c=this.tileSizePx+l,d={dx:-s*c,dy:-a*c};if(s!==0||a!==0){let p=new Map(this.unitMoveOffsetSignal());p.set(e.id,d),this.unitMoveOffsetSignal.set(p);let g=new Set(this.movingUnitsSignal());g.add(e.id),this.movingUnitsSignal.set(g),setTimeout(()=>{let S=new Map(this.unitMoveOffsetSignal());S.set(e.id,{dx:0,dy:0}),this.unitMoveOffsetSignal.set(S),setTimeout(()=>{let I=new Map(this.unitMoveOffsetSignal());I.delete(e.id),this.unitMoveOffsetSignal.set(I);let P=new Set(this.movingUnitsSignal());P.delete(e.id),this.movingUnitsSignal.set(P)},180)},0)}if(r){let p=this.getUnitAt(t.x,t.y);p&&(this.lastMergedUnitIdSignal.set(p.id),setTimeout(()=>this.lastMergedUnitIdSignal.set(null),300)),o&&(this.lastRemainderUnitIdSignal.set(o),setTimeout(()=>this.lastRemainderUnitIdSignal.set(null),300))}if(this.checkBaseDefeat(),this.gameStatus()==="playing"&&e.owner==="ai"){this.lastAiMovedUnitIdSignal()===e.id?this.aiConsecMovesSignal.update(P=>P+1):(this.lastAiMovedUnitIdSignal.set(e.id),this.aiConsecMovesSignal.set(1));let S=new Map(this.unitMoveHistorySignal()).get(e.id)??[];if(S.length>=4&&S[0].x===S[2].x&&S[0].y===S[2].y&&S[1].x===S[3].x&&S[1].y===S[3].y&&(S[0].x!==S[1].x||S[0].y!==S[1].y)){let P=new Map(this.unitStutterBanSignal()),U=new Set([`${S[0].x},${S[0].y}`,`${S[1].x},${S[1].y}`]);P.set(e.id,{tiles:U,until:this.turnSignal()+5}),this.unitStutterBanSignal.set(P);let oe={x:Math.floor(this.gridSize/2),y:Math.floor(this.gridSize/2)},xe=(this.getQuadrant(e.position,oe)+2)%4,Ae=new Map(this.unitQuadrantBiasSignal());Ae.set(e.id,{quadrant:xe,until:this.turnSignal()+5}),this.unitQuadrantBiasSignal.set(Ae)}}let h=this.selectedUnitIdSignal();h&&!this.unitsSignal().some(p=>p.id===h)&&this.selectedUnitIdSignal.set(null),this.recomputeVisibility(),e.owner==="player"&&this.selectNextAvailableUnit()}selectNextAvailableUnit(){let t=this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((i,r)=>{let o=this.isForest(i.position.x,i.position.y)||this.isMine(i.position.x,i.position.y)?1:0,s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0;return o!==s?o-s:0}),this.selectUnit(t[0].id)}selectNextAvailableUnitTab(){let t=this.unitsSignal().filter(r=>r.owner==="player"&&!r.hasActed);if(t.length===0){this.selectUnit(null);return}t.sort((r,o)=>{let s=this.isForest(r.position.x,r.position.y)||this.isMine(r.position.x,r.position.y)?1:0,a=this.isForest(o.position.x,o.position.y)||this.isMine(o.position.x,o.position.y)?1:0;return s!==a?s-a:r.id.localeCompare(o.id)});let i=this.selectedUnitId();if(!i)this.selectUnit(t[0].id);else{let r=t.findIndex(o=>o.id===i);if(r===-1)this.selectUnit(t[0].id);else{let o=(r+1)%t.length;this.selectUnit(t[o].id)}}}calculateTotalPoints(e){return this.combat.calculateTotalPoints(e)}calculateTierAndLevel(e){return this.combat.calculateTierAndLevel(e)}effectiveAttack(e){return this.calculateTotalPoints(e)+(e.hasWeapon?20:0)}effectiveDefense(e){return(e.points??0)+(e.armorHp??0)}computeSideEffectivePower(e){let t=this.unitsSignal().filter(r=>r.owner===e),i=0;for(let r of t)i+=this.effectiveAttack(r);return i}getWood(e){return e==="ai"?this.aiWoodSignal():this.resourcesSignal().wood}getIron(e){return e==="ai"?this.aiIronSignal():this.resourcesSignal().iron}getForges(e){return e==="ai"?this.aiForgesSignal():this.forgesSignal()}buyArmorGeneric(e,t){e==="ai"?this.aiBuyArmor(t):this.buyArmor(t)}buyWeaponGeneric(e,t){e==="ai"?this.aiBuyWeapon(t):this.buyWeapon(t)}isUnitInDanger(e){let t=this.getNeighbors(e.position);for(let i of t){let r=this.getUnitAt(i.x,i.y);if(r&&r.owner!==e.owner){let o=this.effectiveAttack(r),s=this.effectiveDefense(e),a=e.hasWeapon?e.tier>=3?20:10:0;if(o>s+a)return!0}}return!1}findSafeMove(e,t){let i=this.getBasePosition("ai");return t.length===0?null:t.reduce((r,o)=>{let s=Math.abs(o.x-i.x)+Math.abs(o.y-i.y),a=Math.abs(r.x-i.x)+Math.abs(r.y-i.y);return s<a?o:r},t[0])}findResourceTarget(e,t){let i=this.forestsSignal(),r=this.minesSignal(),o=this.turnSignal()<=20,s=i.filter(S=>{let I=`${S.x},${S.y}`;if(t.claimedTargets.has(I))return!1;let P=this.getUnitAt(S.x,S.y);return!(P&&P.owner==="ai")}),a=r.filter(S=>{let I=`${S.x},${S.y}`;if(t.claimedTargets.has(I))return!1;let P=this.getUnitAt(S.x,S.y);return!(P&&P.owner==="ai")}),l=s.filter(S=>!this.getUnitAt(S.x,S.y)),c=a.filter(S=>!this.getUnitAt(S.x,S.y));if(o){if(l.length>0)return l.sort((S,I)=>{let P=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),U=Math.abs(I.x-e.position.x)+Math.abs(I.y-e.position.y);return P-U}),l[0];if(c.length>0)return c.sort((S,I)=>{let P=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),U=Math.abs(I.x-e.position.x)+Math.abs(I.y-e.position.y);return P-U}),c[0]}else{let S=[...l,...c];if(S.length>0)return S.sort((I,P)=>{let U=Math.abs(I.x-e.position.x)+Math.abs(I.y-e.position.y),oe=Math.abs(P.x-e.position.x)+Math.abs(P.y-e.position.y);return U-oe}),S[0]}let d=s.filter(S=>{let I=this.getUnitAt(S.x,S.y);return I&&I.owner==="player"}),p=a.filter(S=>{let I=this.getUnitAt(S.x,S.y);return I&&I.owner==="player"}).filter(S=>{let I=this.getUnitAt(S.x,S.y);return I&&e.tier>=I.tier}),g=d.filter(S=>{let I=this.getUnitAt(S.x,S.y);return I&&e.tier>=I.tier});if(o){if(g.length>0)return g.sort((S,I)=>{let P=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),U=Math.abs(I.x-e.position.x)+Math.abs(I.y-e.position.y);return P-U}),g[0];if(p.length>0)return p.sort((S,I)=>{let P=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),U=Math.abs(I.x-e.position.x)+Math.abs(I.y-e.position.y);return P-U}),p[0]}else{let S=[...g,...p];if(S.length>0)return S.sort((I,P)=>{let U=Math.abs(I.x-e.position.x)+Math.abs(I.y-e.position.y),oe=Math.abs(P.x-e.position.x)+Math.abs(P.y-e.position.y);return U-oe}),S[0]}return d.length>0?(d.sort((S,I)=>{let P=this.getUnitAt(S.x,S.y),U=this.getUnitAt(I.x,I.y),oe=P?P.tier:99,Se=U?U.tier:99;if(oe!==Se)return oe-Se;let xe=Math.abs(S.x-e.position.x)+Math.abs(S.y-e.position.y),Ae=Math.abs(I.x-e.position.x)+Math.abs(I.y-e.position.y);return xe-Ae}),d[0]):null}findDefensiveWallTarget(e){let t=this.getNeighbors(e.position),r=this.unitsSignal().filter(c=>c.owner==="player").filter(c=>Math.abs(c.position.x-e.position.x)+Math.abs(c.position.y-e.position.y)<=5);if(r.length===0)return null;let o=0,s=0;r.forEach(c=>{o+=c.position.x,s+=c.position.y}),o/=r.length,s/=r.length;let a=null,l=-1/0;for(let c of t){if(this.getWallBetween(e.position.x,e.position.y,c.x,c.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(c)||this.isEdgeOnCooldown(e.position,c))continue;let d=c.x-e.position.x,h=c.y-e.position.y,p=o-e.position.x,g=s-e.position.y,S=d*p+h*g;S>l&&(l=S,a=c)}return l>0?a:null}findBlockingWall(e,t){let i=this.bfsPath(e,t,{respectWalls:!1});if(!i||i.length<2)return null;for(let r=0;r<i.length-1;r++){let o=i[r],s=i[r+1],a=this.getWallBetween(o.x,o.y,s.x,s.y);if(a)return{pos:s,wall:a}}return null}findDefensiveWallTargetForOwner(e,t){let i=this.getNeighbors(e.position),r=t==="player"?"ai":"player",s=this.unitsSignal().filter(h=>h.owner===r).filter(h=>Math.abs(h.position.x-e.position.x)+Math.abs(h.position.y-e.position.y)<=5);if(s.length===0)return null;let a=0,l=0;s.forEach(h=>{a+=h.position.x,l+=h.position.y}),a/=s.length,l/=s.length;let c=null,d=-1/0;for(let h of i){if(this.getWallBetween(e.position.x,e.position.y,h.x,h.y)||this.isInNoBuildZone(e.position)||this.isInNoBuildZone(h)||this.isEdgeOnCooldown(e.position,h))continue;let p=h.x-e.position.x,g=h.y-e.position.y,S=a-e.position.x,I=l-e.position.y,P=p*S+g*I;P>d&&(d=P,c=h)}return d>0?c:null}getNextStepTowards(e,t,i,r){if(i.length===0)return null;let o=l=>{let c=Math.abs(l.x-t.x)+Math.abs(l.y-t.y);if(r?.noCohesion&&!r?.antiClump&&!r?.fogBonus)return c*10;let h=this.getNeighbors(l).filter(g=>{let S=this.getUnitAt(g.x,g.y);return S&&S.owner===e.owner}).length,p=c*10;return r?.antiClump?p+=h*3:r?.noCohesion||(p-=h*2),r?.fogBonus&&!this.isVisibleToPlayer(l.x,l.y)&&e.owner==="player"&&(p-=3),p},s=null,a=1/0;for(let l of i){let c=o(l);c<a&&(a=c,s=l)}return s}findPlayerResourceTarget(e){let t=this.turnSignal(),i=this.forestsSignal(),r=this.minesSignal(),o=this.playerClaimedTargetsSignal(),s=g=>`${g.x},${g.y}`,a=g=>!this.getUnitAt(g.x,g.y),l=g=>{let S=this.getUnitAt(g.x,g.y);return!!(S&&S.owner==="player")},c=i.filter(g=>!o.has(s(g))),d=r.filter(g=>!o.has(s(g))),h=(g,S)=>{let I=Math.abs(g.x-e.position.x)+Math.abs(g.y-e.position.y),P=l(g)?100:0,U=t<=15&&S==="forest"?-5:0;return I*10+P+(a(g)?0:20)+U},p=[...c.map(g=>({p:g,t:"forest",s:h(g,"forest")})),...d.map(g=>({p:g,t:"mine",s:h(g,"mine")}))];return p.length===0?null:(p.sort((g,S)=>g.s-S.s),p[0].p)}findCombatTarget(e,t,i){let r=t.priorityTargets.find(c=>Math.max(Math.abs(c.position.x-e.position.x),Math.abs(c.position.y-e.position.y))<=5);if(r&&!this.bfsPath(e.position,r.position,{respectWalls:!0})){let d=this.findBlockingWall(e.position,r.position);if(d)return this.appendLog(`[Obstacle Smash] T${e.tier} targeting wall at (${d.pos.x},${d.pos.y}) blocking path to high-value target`),d.pos}let o=t.priorityTargets.filter(c=>i.some(d=>d.x===c.position.x&&d.y===c.position.y));if(o.length>0){let c=o.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),c[0].position):(o.sort((d,h)=>this.effectiveDefense(d)-this.effectiveDefense(h)),o[0].position)}let s=this.getNeighbors(e.position),a=[];for(let c of s){let d=this.getWallBetween(e.position.x,e.position.y,c.x,c.y);if(!d||d.owner===e.owner)continue;let h=d.maxHealth??100,p=100-(h-100);h>200&&!e.hasWeapon&&(p-=150),e.hasWeapon&&(p+=40),(d.formationSize??1)<=2&&(p+=30),a.push({pos:c,score:p})}if(a.length>0)return a.sort((c,d)=>d.score-c.score),a[0].pos;let l=i.map(c=>{let d=this.getUnitAt(c.x,c.y);return!d||d.owner===e.owner?null:{pos:c,enemy:d}}).filter(Boolean);if(l.length>0){let c=l.filter(d=>this.effectiveAttack(e)>=this.effectiveDefense(d.enemy));return c.length>0?(c.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),c[0].pos):(l.sort((d,h)=>this.effectiveDefense(d.enemy)-this.effectiveDefense(h.enemy)),l[0].pos)}return null}findFallbackMove(e,t,i){if(t.length===0)return null;let r=Math.abs(e.position.x-i.x)+Math.abs(e.position.y-i.y),o=null,s=1/0;for(let a of t){let l=Math.abs(a.x-i.x)+Math.abs(a.y-i.y);l<s&&(s=l,o=a)}if(!o)return null;if(s>r){let a=this.isUnitInDanger(e),l=!1;if(a&&(l=this.getNeighbors(e.position).some(d=>{let h=this.getUnitAt(d.x,d.y);return!h||h.owner===e.owner?!1:this.effectiveAttack(h)>this.effectiveDefense(e)})),!l)return null}return o}isTileThreatenedByEnemy(e,t){let i=this.getNeighbors(t);for(let r of i){let o=this.getUnitAt(r.x,r.y);if(o&&o.owner!==e.owner&&this.effectiveAttack(o)>=this.effectiveDefense(e))return!0}return!1}getMergePartnerForUnit(e,t){let r=this.reclamationGoalsSignal().get(e.id);if(r&&r.type==="merge"){let c=this.getUnitAt(r.target.x,r.target.y);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let s=this.mergeIntentSignal().get(e.id);if(s){let c=this.unitsSignal().find(d=>d.id===s);if(c&&c.owner===e.owner&&c.tier===e.tier)return c}let a=this.unitsSignal().find(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y)&&t.some(d=>d.x===c.position.x&&d.y===c.position.y));if(a)return a;let l=this.unitsSignal().filter(c=>c.owner===e.owner&&c.tier===e.tier&&(c.position.x!==e.position.x||c.position.y!==e.position.y));for(let c of l){let d=this.getNextStepTowards(e,c.position,t);if(!d)continue;let h=this.calculateValidMoves(c),p=this.getNextStepTowards(c,e.position,h);if(!p)continue;let g=Math.abs(e.position.x-c.position.x)+Math.abs(e.position.y-c.position.y);if(Math.abs(d.x-p.x)+Math.abs(d.y-p.y)<g)return c}return null}computeHighestTierNeedingUpgrade(){let e=this.unitsSignal().filter(t=>t.owner==="ai"&&t.tier>=2&&(!t.hasArmor||!t.hasWeapon));return e.length===0?0:e.reduce((t,i)=>Math.max(t,i.tier),0)}getNeighbors(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}].filter(t=>this.inBounds(t.x,t.y))}bfsPath(e,t,i){let r=[{pos:e,path:[e]}],o=new Set;o.add(`${e.x},${e.y}`);let s=0;for(;r.length>0&&s<500;){s++;let a=r.shift();if(a.pos.x===t.x&&a.pos.y===t.y)return a.path;let l=this.getNeighbors(a.pos);for(let c of l){let d=`${c.x},${c.y}`;if(!o.has(d)){if(i?.avoidFriendlyUnits){let h=this.getUnitAt(c.x,c.y);if(h&&h.owner==="ai")continue}if(i?.respectWalls&&this.getWallBetween(a.pos.x,a.pos.y,c.x,c.y))continue;o.add(d),r.push({pos:c,path:[...a.path,c]})}}}return null}getPointsForTierLevel(e,t){return this.combat.getPointsForTierLevel(e,t)}inBounds(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize}recomputeVisibility(){let e=this.map.computeVisibility(this.gridSize,this.unitsSignal(),this.getBasePosition("player"),this.getBasePosition("ai"),this.fogDebugDisabledSignal());this.playerVisibilitySignal.set(e.player),this.aiVisibilitySignal.set(e.ai),this.playerExploredSignal.update(t=>this.map.mergeExplored(t,e.player)),this.aiExploredSignal.update(t=>this.map.mergeExplored(t,e.ai))}isVisibleToPlayer(e,t){return this.fogDebugDisabledSignal()?!0:this.playerVisibilitySignal().has(`${e},${t}`)}isVisibleToAi(e,t){return this.fogDebugDisabledSignal()?!0:this.aiVisibilitySignal().has(`${e},${t}`)}isExploredByPlayer(e,t){return this.playerExploredSignal().has(`${e},${t}`)}isExploredByAi(e,t){return this.aiExploredSignal().has(`${e},${t}`)}calculatePower(e){return this.calculateTotalPoints(e)}checkBaseDefeat(){let e=this.baseHealthSignal();if(e.ai<=0){this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("ai");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("player wins","destroy")}else if(e.player<=0){this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3);let t=this.getBasePosition("player");this.queueCombatText("\u{1F4A5}",t),this.settings.customMode()?this.endReasonSignal.set("Match Finished (Custom Mode)"):this.recordHighScore("jaerbi wins","destroy")}}getDefenseBonus(e){return this.combat.getDefenseBonus(e,this.unitsSignal()).bonus}combatTextsSignal=G([]);combatTexts=this.combatTextsSignal.asReadonly();defenseBonus(e){return this.getDefenseBonus(e)}hasDefenseBonus(e){return this.getDefenseBonus(e)>0}getNudgeFor(e){let t=this.attackerNudgeSignal();return t&&t.id===e?{dx:t.dx,dy:t.dy}:null}isUnitShaking(e){return this.shakenUnitIdSignal()===e}isWallShaking(e){return this.shakenWallIdSignal()===e}screenShake(){return this.screenShakeSignal()}shouldShowEndOverlay(){return this.endOverlaySignal()}endReason(){return this.endReasonSignal()}highScoresOpen(){return this.highScoresOpenSignal()}supportOpen(){return this.supportOpenSignal()}toggleHighScores(){this.highScoresOpenSignal.update(e=>!e)}closeHighScores(){this.highScoresOpenSignal.set(!1)}toggleLeaderboard(){this.leaderboardOpenSignal.update(e=>!e)}closeLeaderboard(){this.leaderboardOpenSignal.set(!1)}toggleSupport(){this.supportOpenSignal.update(e=>!e)}closeSupport(){this.supportOpenSignal.set(!1)}copySupportLink(e){try{typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(e)}catch{}}getHighScoresForCurrentCombo(){let e=`${this.settings.difficulty()}|${this.settings.mapSize()}`;return this.highScoresSignal()[e]??{wins:[],losses:[]}}isLuckyText(e){return e.startsWith("LUCKY")}isDrawText(e){return e==="DRAW"}toggleCombatOnly(){this.combatOnlySignal.update(e=>!e)}combatOnly(){return this.combatOnlySignal()}leaderboardOpen(){return this.leaderboardOpenSignal()}isNamePromptOpen(){return this.namePromptOpenSignal()}getPlayerName(){let e=this.firebase.user$();return e?.displayName?e.displayName:this.playerName.name()}confirmAndSaveScore(e){if(this.settings.customMode()&&this.endReasonSignal()!=="Debug Victory"&&e==="Jaerbi")return;this.playerName.setName(e);let t=this.pendingScoreSignal();if(t){let i=this.firebase.user$(),r=fe(F({},t),{playerName:this.playerName.name(),userId:i?.uid,userPhoto:i?.photoURL??void 0});this.firebase.saveHighScore(r),this.pendingScoreSignal.set(null),this.namePromptOpenSignal.set(!1)}}logsFiltered(){return this.log.logs().filter(e=>!this.combatOnlySignal()||e.type==="combat")}aiWood(){return this.aiWoodSignal()}aiIron(){return this.aiIronSignal()}monopolyCounter(){return this.forestMonopolySignal()}monopolyTurnsLeft(){let e=this.forestsSignal().length;if(e===0)return 0;let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;return r?Math.max(0,10-this.forestMonopolySignal().player):o?Math.max(0,10-this.forestMonopolySignal().ai):0}getLuckDeltaForTier(e){return{1:1,2:2,3:4,4:8}[e]??0}setHoveredUnit(e){this.hoveredUnitIdSignal.set(e)}getHoverInfo(e){let t=this.unitsSignal().find(s=>s.id===e);if(!t)return null;let i=this.calculateTotalPoints(t),r=this.getLuckDeltaForTier(t.tier),o=this.getDefenseBonus(t);return{atkMin:Math.max(0,i-r),atkMax:i+r+(t.hasWeapon?20:0),hp:t.points,support:o}}isUnitHovered(e){return this.hoveredUnitIdSignal()===e}getHitChanceInfo(e){let t=this.selectedUnit();if(!t)return null;let i=this.unitsSignal().find(l=>l.id===e);if(!i||t.owner!=="player"||i.owner===t.owner||!this.isVisibleToPlayer(i.position.x,i.position.y)||!this.validMoves().some(l=>l.x===i.position.x&&l.y===i.position.y))return null;let o=this.combat.calculateHitChance(t,i),s="bg-green-600";o<50?s="bg-red-600":o<100&&(s="bg-amber-600");let a=o<10;return{chance:o,bg:s,icon:a?"\u2620\uFE0F":"\u2694\uFE0F",skull:a}}shouldRenderWall(e,t,i){let r=this.getWallBetween(e.x,e.y,t.x,t.y);return r?(i??r.owner)==="player"||this.fogDebugDisabledSignal()?!0:this.isVisibleToPlayer(e.x,e.y)||this.isVisibleToPlayer(t.x,t.y):!1}hoverFormationById(e){this.hoveredFormationIdSignal.set(e??null)}isFormationHovered(e){return e?this.hoveredFormationIdSignal()===e:!1}getFormationInfo(e){let t=e??null;if(!t)return null;let i=this.wallsSignal().find(r=>r.formationId===t);return i?{size:i.formationSize??1,bonus:i.bonusHp??0}:null}updateWallFormations(){let e=this.wallsSignal();if(e.length===0)return;let t=new Map,i=new Map;for(let l of e){t.set(l.id,l);let c=`${l.tile1.x},${l.tile1.y}`,d=`${l.tile2.x},${l.tile2.y}`,h=i.get(c)??[];h.push(l.id),i.set(c,h);let p=i.get(d)??[];p.push(l.id),i.set(d,p)}let r=new Set,o=[];for(let l of e){if(r.has(l.id))continue;if(l.owner==="neutral"){o.push([l.id]),r.add(l.id);continue}let c=[l.id];r.add(l.id);let d=[],h=l.owner;for(;c.length>0;){let p=c.shift();d.push(p);let g=t.get(p),S=[`${g.tile1.x},${g.tile1.y}`,`${g.tile2.x},${g.tile2.y}`];for(let I of S){let P=i.get(I)??[];for(let U of P)r.has(U)||t.get(U).owner===h&&(r.add(U),c.push(U))}}o.push(d)}let s=e.map(l=>F({},l)),a=new Map;for(let l=0;l<s.length;l++)a.set(s[l].id,l);for(let l of o){let d=t.get(l[0]).owner==="neutral",h=d?1:l.length,p=d?0:Math.max(0,h*20),g=100+p,S=d?null:l[0];for(let I of l){let P=a.get(I),U=s[P],oe=U.maxHealth??100,Se=g-oe,xe=U.health;Se>0?xe=U.health+Se:Se<0&&(xe=Math.min(U.health,g)),xe=Math.max(0,Math.min(g,xe)),s[P]=fe(F({},U),{formationId:S??void 0,formationSize:h,maxHealth:g,bonusHp:p,health:xe})}}this.wallsSignal.set(s)}getCombatTextEntriesAt(e,t){return this.combatTextsSignal().filter(i=>i.position.x===e&&i.position.y===t).map(i=>({id:i.id,text:i.text,opacity:i.opacity}))}formatHoverInfo(e){let t=this.getHoverInfo(e);if(!t)return"";let i=this.unitsSignal().find(d=>d.id===e);if(!i)return"";let r=this.combat.getPointsForTierLevel(i.tier,4),o=t.support>0?`+${t.support}`:"+0",s=i.hasWeapon?" | Weapon:+20":"",a=i.armorHp??0,l=i.hasArmor?` | Armor:${a}`:"",c=a>0?`${t.hp} + ${a}`:`${t.hp}`;return`Unit T${i.tier} | HP: ${c}/${r} | ATK: ${t.atkMin}-${t.atkMax} | DEF: ${o}${s}${l}`}loadHighScores(){if(!(typeof window>"u"))try{let e=localStorage.getItem("highScores");if(e){let t=JSON.parse(e);t&&typeof t=="object"&&this.highScoresSignal.set(t)}}catch{}}persistHighScores(){if(!(typeof window>"u"))try{localStorage.setItem("highScores",JSON.stringify(this.highScoresSignal()))}catch{}}debugInstantWin(){this.turnSignal.set(Math.floor(Math.random()*10)+5),this.gameStatusSignal.set("player wins"),this.endReasonSignal.set("Debug Victory"),this.endOverlaySignal.set(!0);let t=this.getForestControl().player,r={playerName:this.playerName.name(),turnsPlayed:this.turnSignal(),forestsCaptured:t,victoryType:"Annihilation",timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:!0};this.pendingScoreSignal.set(r),this.namePromptOpenSignal.set(!0)}debugCycleSettings(){let e=["baby","normal","hard","nightmare"],t=[10,20,30],i=e.indexOf(this.settings.difficulty()),r=t.indexOf(this.settings.mapSize());i++,i>=e.length&&(i=0,r++,r>=t.length&&(r=0)),this.settings.setDifficulty(e[i]),this.settings.setMapSize(t[r]),this.resetGame()}recordHighScore(e,t){if(this.settings.customMode()){this.endReasonSignal.set("Match Finished (Custom Mode)");return}let i=`${this.settings.difficulty()}|${this.settings.mapSize()}`,r=F({},this.highScoresSignal()),o={turns:this.turnSignal(),date:Date.now(),condition:t},s=r[i]??{wins:[],losses:[]};e==="player wins"?s.wins=[...s.wins,o].sort((h,p)=>h.turns-p.turns).slice(0,3):s.losses=[...s.losses,o].sort((h,p)=>h.turns-p.turns).slice(0,3),r[i]=s,this.highScoresSignal.set(r),this.persistHighScores();let a=this.getForestControl(),l=e==="player wins"?a.player:a.ai,c=t==="monopoly"?"Monopoly":"Annihilation",d={playerName:e==="player wins"?this.playerName.name():"Jaerbi",turnsPlayed:this.turnSignal(),forestsCaptured:l,victoryType:c,timestamp:Date.now(),difficulty:this.settings.difficulty(),mapSize:this.settings.mapSize(),victory:e==="player wins"};e==="player wins"&&(this.pendingScoreSignal.set(d),this.namePromptOpenSignal.set(!0))}getAttackLuckModifier(e){return this.combat.getAttackLuckModifier(e)}queueCombatText(e,t){let i=crypto.randomUUID(),r={id:i,text:e,position:F({},t),opacity:1};this.combatTextsSignal.update(o=>[...o.filter(s=>!(s.position.x===t.x&&s.position.y===t.y)),r]),setTimeout(()=>{this.combatTextsSignal.update(o=>o.map(s=>s.id===i?fe(F({},s),{opacity:0}):s))},1500),setTimeout(()=>{this.combatTextsSignal.update(o=>o.filter(s=>s.id!==i))},2e3)}calculateValidMoves(e){let t=[],i=e.position,r=c=>c.x>=0&&c.x<this.gridSize&&c.y>=0&&c.y<this.gridSize,o=(c,d)=>{if(!r(d))return"blocked";if(c.x===d.x||c.y===d.y){if(this.getWallBetween(c.x,c.y,d.x,d.y))return"blocked"}else if(this.isDiagonalBlocked(c,d))return"blocked";let h=this.getUnitAt(d.x,d.y);return h?h.owner===e.owner?"ally":"enemy":"empty"},s=(c,d)=>{(d==="empty"||d==="enemy"||this.getUnitAt(c.x,c.y)?.tier===e.tier)&&t.push(c)},a=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],l=[{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}];if(e.tier===1){for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);h!=="blocked"&&s(d,h)}return t}for(let c of a){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===3&&h==="empty"){let p={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,p);g!=="blocked"&&s(p,g)}}for(let c of l){let d={x:i.x+c.x,y:i.y+c.y},h=o(i,d);if(h!=="blocked"&&s(d,h),e.tier===4&&h==="empty"){let p={x:i.x+c.x*2,y:i.y+c.y*2},g=o(d,p);if(g!=="blocked"&&(s(p,g),g==="empty")){let S={x:i.x+c.x*3,y:i.y+c.y*3},I=o(p,S);I!=="blocked"&&s(S,I)}}}return t}endTurn(){let e=this.activeSideSignal(),t=new Set(this.movedThisTurnSignal());this.unitsSignal.update(o=>o.map(s=>{if(s.owner!==e)return s;let a=t.has(s.id),l=this.isForest(s.position.x,s.position.y),c=this.isMine(s.position.x,s.position.y),d=l?a?1:(s.forestOccupationTurns??0)+1:0,h=c?a?1:(s.mineOccupationTurns??0)+1:0,p=l?d>=3:!1;return fe(F({},s),{turnsStationary:a?0:(s.turnsStationary??0)+1,forestOccupationTurns:d,mineOccupationTurns:h,productionActive:p})})),this.movedThisTurnSignal.set(new Set),this.wallBuiltThisTurnSignal.set(!1);let i=o=>{let s=0;return o==="baby"?s=10:o==="normal"?s=8:o==="hard"?s=5:s=3,s};if(this.gameStatus()==="playing"){let o=this.unitsSignal().filter(a=>a.owner===e&&this.isForest(a.position.x,a.position.y)&&(a.productionActive??!1)).length,s=this.unitsSignal().filter(a=>a.owner===e&&this.isMine(a.position.x,a.position.y)&&(a.mineOccupationTurns??0)>=5).length;if(o>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood+o*i(this.settings.difficulty()),iron:a.iron})):this.aiWoodSignal.update(a=>a+o*i(this.settings.difficulty()))),s>0&&(e==="player"?this.resourcesSignal.update(a=>({wood:a.wood,iron:a.iron+s*2})):this.aiIronSignal.update(a=>a+s*2)),e==="player"){let a=this.forgeSitesSignal().map(h=>F({},h));for(let h of a)h.turnsLeft=Math.max(0,h.turnsLeft-1);let l=a.filter(h=>h.turnsLeft===0),c=l.map(h=>h.position),d=a.filter(h=>h.turnsLeft>0);if(c.length>0){this.forgesSignal.update(p=>[...p,...c]);let h=l.filter(p=>p.owner==="ai").map(p=>p.position);if(h.length>0){this.aiForgesSignal.update(p=>[...p,...h]);for(let p of h)this.appendLog(`[AI] Forge completed at (${p.x},${p.y}).`)}}this.forgeSitesSignal.set(d)}}this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),e==="player"&&this.gameStatus()==="playing"&&this.updateForestMonopoly();let r=e==="player"?"ai":"player";if(e==="player"){this.turnSignal.update(s=>s+1);let o=this.settings.getAiReserveBonus(this.turnSignal());this.reservePointsSignal.update(s=>({player:s.player+1,ai:s.ai+o}))}else this.autoDeployEnabledSignal()&&this.playerConvertedThisTurnSignal()&&this.reservePointsSignal().player>0&&(this.autoDeployFromReserves(),this.playerConvertedThisTurnSignal.set(!1));this.activeSideSignal.set(r),this.startSideTurn(r),r==="ai"&&this.gameStatus()==="playing"&&(this.aiTurnTimeout=setTimeout(()=>this.aiTurn(),10))}endPlayerTurn(){this.activeSideSignal()!=="player"||this.gameStatus()!=="playing"||this.endTurn()}pauseGame(){this.stopAiLoops()}aiTurnTimeout=null;stopAiLoops(){this.aiTurnTimeout&&(clearTimeout(this.aiTurnTimeout),this.aiTurnTimeout=null),this.isAiThinking=!1}startSideTurn(e){this.unitsSignal.update(t=>t.map(i=>i.owner===e?fe(F({},i),{hasActed:!1}):i)),e==="player"&&(this.selectNextAvailableUnit(),this.playerClaimedTargetsSignal.set(new Set))}updateForestMonopoly(){let e=this.forestsSignal().length;if(e===0){this.forestMonopolySignal.set({player:0,ai:0});return}let t=this.unitsSignal().filter(s=>s.owner==="player"&&this.isForest(s.position.x,s.position.y)).length,i=this.unitsSignal().filter(s=>s.owner==="ai"&&this.isForest(s.position.x,s.position.y)).length,r=t/e===1,o=i/e===1;if(r){let s=F({},this.forestMonopolySignal());s.player=s.player+1,s.ai=0,this.forestMonopolySignal.set(s),s.player>=10&&(this.gameStatusSignal.set("player wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("player wins","monopoly"))}else if(o){let s=F({},this.forestMonopolySignal());s.ai=s.ai+1,s.player=0,this.forestMonopolySignal.set(s),s.ai>=10&&(this.gameStatusSignal.set("jaerbi wins"),this.screenShakeSignal.set(!0),this.endReasonSignal.set(this.settings.t("ECONOMIC_DOMINATION_GREETING")),setTimeout(()=>{this.screenShakeSignal.set(!1),this.endOverlaySignal.set(!0)},1e3),this.recordHighScore("jaerbi wins","monopoly"))}else this.forestMonopolySignal.set({player:0,ai:0})}async aiTurn(){if(this.activeSideSignal()!=="ai"||this.gameStatus()!=="playing"||this.isAiThinking)return;this.isAiThinking=!0,this.aiBatchingActions=!0;let e=this.getBasePosition("ai"),t=this.forestsSignal().length+this.minesSignal().length,i=this.unitsSignal().filter(A=>A.owner==="player"&&(this.isForest(A.position.x,A.position.y)||this.isMine(A.position.x,A.position.y))),r=t>0?i.length/t:0;if(r>.5){let A=new Map,w=this.unitsSignal().filter(me=>me.owner==="ai"&&!me.hasActed),R=new Set,M=i.slice().sort((me,Fe)=>Fe.tier-me.tier);for(let me of M){let Fe=Math.min(4,me.tier+1),he=w.filter(Me=>Me.tier===Fe&&!R.has(Me.id)).sort((Me,Gt)=>{let ct=Math.max(Math.abs(Me.position.x-me.position.x),Math.abs(Me.position.y-me.position.y)),te=Math.max(Math.abs(Gt.position.x-me.position.x),Math.abs(Gt.position.y-me.position.y));return ct-te});if(he.length>0){let Me=he[0];A.set(Me.id,{target:F({},me.position),type:"hunt"}),R.add(Me.id);continue}let Vt=w.filter(Me=>Me.tier===me.tier&&!R.has(Me.id)),Jt=!1;for(let Me of Vt){let Gt=this.calculateValidMoves(Me),ct=this.unitsSignal().find(te=>te.owner==="ai"&&te.tier===Me.tier&&(te.position.x!==Me.position.x||te.position.y!==Me.position.y)&&Gt.some(ne=>ne.x===te.position.x&&ne.y===te.position.y));if(ct){A.set(Me.id,{target:F({},ct.position),type:"merge"}),R.add(Me.id),Jt=!0;break}}Jt||this.aiSpawnTier(Fe,1,new Set)}this.reclamationGoalsSignal.set(A),this.appendLog(`[AI Mode] Reclamation active. Player controls ${(r*100).toFixed(0)}% of resources.`)}else this.reclamationGoalsSignal.set(new Map);let a=this.unitsSignal().filter(A=>A.owner==="ai"&&this.isForest(A.position.x,A.position.y)).length>3;{let A=0,w=50,M=this.baseHealthSignal().ai<50?20:70;for(;this.aiWoodSignal()>M;){if(A++,A>w){try{console.warn("[AI] Economy convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}try{let A=this.forestsSignal().length,w=this.unitsSignal().filter(ct=>ct.owner==="ai"&&this.isForest(ct.position.x,ct.position.y)).length,R=this.unitsSignal().filter(ct=>ct.owner==="player"&&this.isForest(ct.position.x,ct.position.y)).length,M=this.settings.difficulty(),me=A>0?R/A:0,Fe="none";R<=w?Fe="none":me>=.9||R>=9?Fe="rage":R>=w+(M==="baby"?4:M==="normal"?3:M==="hard"?2:1)?Fe="angry":Fe="none",this.aiMoodSignal.set(Fe);let he=this.turnSignal()%2===0,Vt=this.turnSignal()%5===0,Jt=A>0?w/A:0,Me=this.totalWarModeSignal(),Gt=Jt>=.65;if(!Me&&Gt)try{console.log("[AI MODE] TOTAL_WAR_MODE engaged")}catch{}if(this.totalWarModeSignal.set(Gt),Fe==="rage"){let ct=M==="baby"?he?1:2:M==="normal"?he?3:2:M==="hard"?he?4:3:4;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+ct}))}else if(Fe==="angry"){if(M==="baby")Vt&&this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+1}));else if(he){let ct=M==="normal"?he?1:0:M==="hard"?Vt?2:1:2;this.reservePointsSignal.update(te=>({player:te.player,ai:te.ai+ct}))}}}catch{}if(this.manageInfrastructure(),this.turnSignal()<=10){let A=0,w=this.getPointsForTierLevel(1,1);for(;this.reservePointsSignal().ai>=w&&A<2&&this.aiSpawnTier(1,1,new Set)!==0;)A++,await new Promise(M=>setTimeout(M,60))}await new Promise(A=>setTimeout(A,100));let l=this.unitsSignal().filter(A=>A.owner==="ai"),c=new Map(this.aiUnitTimeNearBaseSignal()),d=new Set(l.map(A=>A.id));for(let A of c.keys())d.has(A)||c.delete(A);for(let A of l)Math.max(Math.abs(A.position.x-e.x),Math.abs(A.position.y-e.y))<=3?c.set(A.id,(c.get(A.id)||0)+1):c.set(A.id,0);this.aiUnitTimeNearBaseSignal.set(c);for(let A of l){let w=this.isForest(A.position.x,A.position.y);A.owner==="ai"&&w&&A.tier<=2&&this.anchorGatherer(A.id)}let h=this.unitsSignal().filter(A=>A.owner==="player"&&this.isForest(A.position.x,A.position.y)&&(A.productionActive??!1)).length*2,p=this.unitsSignal().filter(A=>A.owner==="ai"&&this.isForest(A.position.x,A.position.y)&&(A.productionActive??!1)).length*2,g=h>=p;this.aggressionModeSignal.set(g);let P=this.forestsSignal().filter(A=>!this.getUnitAt(A.x,A.y)).filter(A=>this.isVisibleToAi(A.x,A.y)),U=this.unitsSignal().filter(A=>A.owner==="ai");if(this.turnSignal()<=15){let A=this.aiQueuedUnitIdSignal(),w=A?U.find(M=>M.id===A):null;if(!(w&&!this.isForest(w.position.x,w.position.y)&&P.length>0)){let M=U.filter(Fe=>Fe.tier<=2&&!this.isForest(Fe.position.x,Fe.position.y)),me=M.length>0&&P.length>0?M.reduce((Fe,he)=>{let Vt=Math.min(...P.map(Me=>Math.abs(he.position.x-Me.x)+Math.abs(he.position.y-Me.y))),Jt=Math.min(...P.map(Me=>Math.abs(Fe.position.x-Me.x)+Math.abs(Fe.position.y-Me.y)));return Vt<Jt?he:Fe},M[0]):null;this.aiQueuedUnitIdSignal.set(me?me.id:null)}}else this.aiQueuedUnitIdSignal.set(null);try{let A=this.getPointsForTierLevel(3,1),w=this.forestsSignal().length,R=this.unitsSignal().filter(Fe=>Fe.owner==="ai"&&this.isForest(Fe.position.x,Fe.position.y)).length,M=w>0?R/w:0;this.reservePointsSignal().ai>=A&&M<=.6&&this.aiSpawnTier(3,1,new Set)}catch{}let oe=this.unitsSignal().filter(A=>A.owner==="player"&&Math.max(Math.abs(A.position.x-e.x),Math.abs(A.position.y-e.y))<=3&&A.tier>=2);if(oe.length>0){let A=oe.reduce((w,R)=>this.calculateTotalPoints(R)>this.calculateTotalPoints(w)?R:w,oe[0]);this.aiDefenseSpawn(A)}if(!this.wallBuiltThisTurnSignal())if(this.totalWarModeSignal()){let A=this.aiStrategy.getWallBuildActions(this);for(let w of A){if(this.wallBuiltThisTurnSignal())break;this.aiBuildWallBetween(w.from,w.to)}}else this.tryDefensiveWallsNearForests();let Se=0,xe=10;for(;Se<xe&&this.executeOneFreeAction();)Se++,await new Promise(w=>setTimeout(w,100));this.aiQueuedUnitIdSignal.set(null);let Ae=this.getBasePosition("player"),Ie=this.unitsSignal().filter(A=>A.owner==="player"&&(this.isForest(A.position.x,A.position.y)||this.isMine(A.position.x,A.position.y)||this.isForge(A.position.x,A.position.y)||Math.max(Math.abs(A.position.x-e.x),Math.abs(A.position.y-e.y))<=4)),k={claimedTargets:new Set,priorityTargets:Ie},N=this.unitsSignal().filter(A=>A.owner==="ai"&&!A.hasActed).sort((A,w)=>w.tier-A.tier);for(let A of N){let w=this.unitsSignal().find(te=>te.id===A.id);if(!w||w.hasActed)continue;let R=null,me=this.calculateValidMoves(w).filter(te=>!k.claimedTargets.has(`${te.x},${te.y}`)),Fe=Math.max(Math.abs(w.position.x-e.x),Math.abs(w.position.y-e.y)),he=this.unitsSignal().filter(te=>te.owner==="player"&&Math.max(Math.abs(te.position.x-e.x),Math.abs(te.position.y-e.y))<=3);if(he.length>0&&!this.isForest(w.position.x,w.position.y)&&Fe<=6){let te=he.reduce((Ee,ve)=>{let ye=Math.max(Math.abs(Ee.position.x-e.x),Math.abs(Ee.position.y-e.y));return Math.max(Math.abs(ve.position.x-e.x),Math.abs(ve.position.y-e.y))<ye?ve:Ee});if(me.some(Ee=>Ee.x===te.position.x&&Ee.y===te.position.y))R={type:"attack",target:te.position,reason:"Base Defense: Eliminate Threat"};else{let Ee=this.getNextStepTowards(w,te.position,me);Ee&&(R={type:"move",target:Ee,reason:"Base Defense: Intercept"})}}if(!R){let te=this.reclamationGoalsSignal().get(w.id);if(te){let ne=te.target,Ee=this.getUnitAt(ne.x,ne.y);if(Ee&&Ee.owner!==w.owner)if(me.some(ye=>ye.x===ne.x&&ye.y===ne.y))R={type:"attack",target:ne,reason:"Reclaim: Attack Occupier"};else{let ye=this.bfsPath(w.position,ne,{respectWalls:!0,avoidFriendlyUnits:!0});if(ye||(ye=this.bfsPath(w.position,ne,{avoidFriendlyUnits:!0})),ye&&ye.length>1){let _=ye[1],ae=this.getWallBetween(w.position.x,w.position.y,_.x,_.y),We=this.getUnitAt(_.x,_.y);if(We&&We.owner!==w.owner){let qe=this.effectiveAttack(We)>this.effectiveDefense(w),se=me.some(xt=>xt.x===_.x&&xt.y===_.y);if(qe&&se)R={type:"attack",target:_,reason:"Reclaim: Engage Blocker"};else if(ae)R={type:"wall_attack",target:_,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,_)){let xt=me.filter(ri=>{let Is=Math.abs(ri.x-ne.x)+Math.abs(ri.y-ne.y),uh=Math.abs(_.x-ne.x)+Math.abs(_.y-ne.y);return Is<=uh&&!this.isTileThreatenedByEnemy(w,ri)}),Si=xt.length>0?this.getNextStepTowards(w,ne,xt):null;R=Si?{type:"move",target:Si,reason:"Reclaim: Bypass Threat"}:{type:"move",target:_,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:_,reason:"Reclaim: Pursue Resource"}}else if(ae)R={type:"wall_attack",target:_,reason:"Reclaim: Breach Blocker"};else if(this.isTileThreatenedByEnemy(w,_)){let qe=me.filter(xt=>{let Si=Math.abs(xt.x-ne.x)+Math.abs(xt.y-ne.y),ri=Math.abs(_.x-ne.x)+Math.abs(_.y-ne.y);return Si<=ri&&!this.isTileThreatenedByEnemy(w,xt)}),se=qe.length>0?this.getNextStepTowards(w,ne,qe):null;R=se?{type:"move",target:se,reason:"Reclaim: Bypass Threat"}:{type:"move",target:_,reason:"Reclaim: Pursue Resource"}}else R={type:"move",target:_,reason:"Reclaim: Pursue Resource"}}}else if(te.type==="merge")if(me.some(ye=>ye.x===ne.x&&ye.y===ne.y))R={type:"move",target:ne,reason:"Reclaim: Merge to Counter"};else{let ye=this.getNextStepTowards(w,ne,me);ye&&(R=this.getWallBetween(w.position.x,w.position.y,ye.x,ye.y)?{type:"wall_attack",target:ye,reason:"Reclaim: Breach to Merge"}:{type:"move",target:ye,reason:"Reclaim: Approach Ally"})}else{let ve=this.getNextStepTowards(w,ne,me);if(ve){let ye=this.getWallBetween(w.position.x,w.position.y,ve.x,ve.y),_=this.getUnitAt(ve.x,ve.y);if(_&&_.owner!==w.owner){let ae=this.effectiveAttack(_)>this.effectiveDefense(w),We=me.some(qe=>qe.x===ve.x&&qe.y===ve.y);if(ae&&We)R={type:"attack",target:ve,reason:"Reclaim: Engage Blocker"};else if(ye)R={type:"wall_attack",target:ve,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,ve)){let qe=me.filter(xt=>{let Si=Math.abs(xt.x-ne.x)+Math.abs(xt.y-ne.y),ri=Math.abs(ve.x-ne.x)+Math.abs(ve.y-ne.y);return Si<=ri&&!this.isTileThreatenedByEnemy(w,xt)}),se=qe.length>0?this.getNextStepTowards(w,ne,qe):null;R=se?{type:"move",target:se,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ve,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ve,reason:"Reclaim: Close Distance"}}else if(ye)R={type:"wall_attack",target:ve,reason:"Reclaim: Breach Path"};else if(this.isTileThreatenedByEnemy(w,ve)){let ae=me.filter(qe=>{let se=Math.abs(qe.x-ne.x)+Math.abs(qe.y-ne.y),xt=Math.abs(ve.x-ne.x)+Math.abs(ve.y-ne.y);return se<=xt&&!this.isTileThreatenedByEnemy(w,qe)}),We=ae.length>0?this.getNextStepTowards(w,ne,ae):null;R=We?{type:"move",target:We,reason:"Reclaim: Bypass Threat"}:{type:"move",target:ve,reason:"Reclaim: Close Distance"}}else R={type:"move",target:ve,reason:"Reclaim: Close Distance"}}}}}if(this.isForest(w.position.x,w.position.y)){let te=this.calculateValidMoves(w),ne=this.findCombatTarget(w,k,te);if(ne)R={type:"attack",target:ne,reason:"Defense: Defend Forest"};else{if(this.aiWoodSignal()>=50){let Ee=this.findDefensiveWallTarget(w);Ee&&(R={type:"build_wall",target:Ee,reason:"Defense: Fortify Position"})}if(!R&&!this.isUnitInDanger(w)){this.unitsSignal.update(ve=>ve.map(ye=>ye.id===w.id?fe(F({},ye),{hasActed:!0}):ye));continue}}}if(!R&&this.isMine(w.position.x,w.position.y)){let te=this.calculateValidMoves(w),ne=this.findCombatTarget(w,k,te);if(ne)R={type:"attack",target:ne,reason:"Defense: Defend Mine"};else if(!this.isUnitInDanger(w)){this.unitsSignal.update(ve=>ve.map(ye=>ye.id===w.id?fe(F({},ye),{hasActed:!0}):ye));continue}}let Vt=this.forestsSignal().length,Jt=this.unitsSignal().filter(te=>te.owner==="ai"&&this.isForest(te.position.x,te.position.y)).length,Me=Vt>0?Jt/Vt:0,Gt=w.tier>=3||Me>=.7,ct=Math.max(Math.abs(w.position.x-Ae.x),Math.abs(w.position.y-Ae.y));if(!R&&ct<4){if(Gt&&ct<=3){let te=[];me.some(ae=>ae.x===Ae.x&&ae.y===Ae.y)&&te.push({type:"attack",target:Ae,weight:1,reason:"Siege: Strike Base"});let Ee=this.getNeighbors(w.position),ve=ct,ye=!1;for(let ae of Ee)this.getWallBetween(w.position.x,w.position.y,ae.x,ae.y)&&Math.max(Math.abs(ae.x-Ae.x),Math.abs(ae.y-Ae.y))<ve&&(te.push({type:"wall_attack",target:ae,weight:.9,reason:"Siege: Breach (Path to Base)"}),ye=!0);let _=this.getNextStepTowards(w,Ae,me,{noCohesion:!0});if(_){let ae=Math.max(Math.abs(_.x-Ae.x),Math.abs(_.y-Ae.y));(!ye||ae<ve)&&te.push({type:"move",target:_,weight:.5,reason:"Siege: Advance on Base"})}if(te.length>0){te.sort((We,qe)=>qe.weight-We.weight);let ae=te[0];R={type:ae.type,target:ae.target,reason:ae.reason},ae.type==="move"&&ye&&this.appendLog(`[AI Debug] Unit at (${w.position.x},${w.position.y}) chose Move over Wall Attack. Weights: wall=0.9, move=${ae.weight}`)}}if(!R)if(me.some(ne=>ne.x===Ae.x&&ne.y===Ae.y))R={type:"attack",target:Ae,reason:"Siege: Strike Base"};else{let ne=this.getNextStepTowards(w,Ae,me,{noCohesion:!0});if(ne)this.getWallBetween(w.position.x,w.position.y,ne.x,ne.y)?R={type:"wall_attack",target:ne,reason:"Siege: Breach"}:R={type:"move",target:ne,reason:"Siege: Advance on Base"};else{let Ee=this.bfsPath(w.position,Ae);if(Ee&&Ee.length>1){let ve=Ee[1];this.getWallBetween(w.position.x,w.position.y,ve.x,ve.y)&&(R={type:"wall_attack",target:ve,reason:"Siege: Breaching"})}}}}if(!R){let te=this.aiForgesSignal(),ne=this.unitsSignal().filter(ve=>ve.owner==="player"),Ee=[];for(let ve of te)for(let ye of ne)Math.max(Math.abs(ye.position.x-ve.x),Math.abs(ye.position.y-ve.y))<=3&&Ee.push(ye);if(Ee.length>0){let ve=Ee.reduce((_,ae)=>{let We=Math.abs(_.position.x-w.position.x)+Math.abs(_.position.y-w.position.y);return Math.abs(ae.position.x-w.position.x)+Math.abs(ae.position.y-w.position.y)<We?ae:_});if(me.some(_=>_.x===ve.position.x&&_.y===ve.position.y))R={type:"attack",target:ve.position,reason:"Defense: Guard Forge"};else{let _=this.getNextStepTowards(w,ve.position,me);_&&(R=this.getWallBetween(w.position.x,w.position.y,_.x,_.y)?{type:"wall_attack",target:_,reason:"Defense: Breach to Forge"}:{type:"move",target:_,reason:"Defense: Approach Forge Threat"})}}}if(!R&&w.tier>=2&&(!w.hasArmor||!w.hasWeapon)){let te=this.seekUpgrades(w,me);te.type==="move"&&te.target&&(R={type:"move",target:te.target,reason:"Upgrade: Move to Forge"})}if(!R){let te=this.isUnitInDanger(w),ne=this.reclamationGoalsSignal().has(w.id);if(!ne&&te){let Ee=this.findSafeMove(w,me);Ee&&(R={type:"move",target:Ee,reason:"Survival: Evade Threat"})}else if(ne&&te&&this.getNeighbors(w.position).some(ye=>{let _=this.getUnitAt(ye.x,ye.y);return!_||_.owner===w.owner?!1:this.effectiveAttack(_)>this.effectiveDefense(w)+(w.tier>=3?10:0)})){let ye=this.findSafeMove(w,me);ye&&(R={type:"move",target:ye,reason:"Survival: Lethal Evade"})}}if(!R&&w.tier===4){let te=this.unitsSignal().filter(ne=>ne.owner==="player");if(te.length>0){let ne=this.getBasePosition("player"),Ee=te.map(ye=>({u:ye,baseDist:Math.max(Math.abs(ye.position.x-ne.x),Math.abs(ye.position.y-ne.y))})).sort((ye,_)=>ye.u.tier!==_.u.tier?ye.u.tier-_.u.tier:ye.baseDist-_.baseDist)[0].u,ve=this.getNextStepTowards(w,Ee.position,me);ve&&(R={type:"move",target:ve,reason:"T4 Raid: Flank Backline"})}}if(!R){let te=this.computeSideEffectivePower("ai"),ne=this.computeSideEffectivePower("player");if(ne>0&&te>ne*1.2&&!this.isForest(w.position.x,w.position.y)&&parseInt(w.id.slice(-1),16)%2===0){let ye=this.unitsSignal().filter(We=>We.owner==="player"),_=Ae;if(ye.length>0&&(_=ye.reduce((qe,se)=>{let xt=Math.max(Math.abs(qe.position.x-w.position.x),Math.abs(qe.position.y-w.position.y));return Math.max(Math.abs(se.position.x-w.position.x),Math.abs(se.position.y-w.position.y))<xt?se:qe}).position),Math.max(Math.abs(_.x-w.position.x),Math.abs(_.y-w.position.y))<=1){let We=this.findCombatTarget(w,k,me);We&&(R={type:"attack",target:We,reason:"Siege: Engage Enemy"})}else{let We=this.getNextStepTowards(w,_,me,{noCohesion:!0});if(We)R={type:"move",target:We,reason:"Siege: Advance"};else{let qe=this.bfsPath(w.position,_);if(qe&&qe.length>1){let se=qe[1];this.getWallBetween(w.position.x,w.position.y,se.x,se.y)&&(R={type:"wall_attack",target:se,reason:"Siege: Breaching"})}}}}if(!R){let ye=this.findResourceTarget(w,k);if(ye){let _=this.bfsPath(w.position,ye,{respectWalls:!0,avoidFriendlyUnits:!0});if(_||(_=this.bfsPath(w.position,ye,{avoidFriendlyUnits:!0})),_&&_.length>1){let ae=_[1],We=this.getWallBetween(w.position.x,w.position.y,ae.x,ae.y);We?We.owner==="ai"&&this.isBaseProtectionEdge(w.position,ae)||(R={type:"wall_attack",target:ae,reason:"Objective: Breaching Wall"}):me.some(qe=>qe.x===ae.x&&qe.y===ae.y)&&(R={type:"move",target:ae,reason:"Objective: Capture Resource"})}}}}if(!R){let te=this.findCombatTarget(w,k,me);te&&(R={type:"attack",target:te,reason:"Combat: Engage Enemy"})}if(!R&&this.aiWoodSignal()>=10&&this.getNeighbors(w.position).some(Ee=>this.isForest(Ee.x,Ee.y)&&this.getUnitAt(Ee.x,Ee.y)?.owner==="ai")){let Ee=this.findDefensiveWallTarget(w);Ee&&(R={type:"build_wall",target:Ee,reason:"Defense: Fortify Perimeter"})}if(!R){let te=Ae,ne=this.findFallbackMove(w,me,te);ne&&(R={type:"move",target:ne,reason:"Fallback: Advance on Enemy"})}if(R){if(this.appendLog(`[AI Unit ${w.id.substring(0,4)}] Action: ${R.reason} -> Target: (${R.target.x},${R.target.y})`),R.type==="build_wall")this.aiBuildWallBetween(w.position,R.target);else{if(R.type==="move"){let te=this.getUnitAt(R.target.x,R.target.y);if(te&&te.owner==="ai"&&te.tier===w.tier){let ne=new Map(this.mergeIntentSignal());ne.set(w.id,te.id),ne.set(te.id,w.id),this.mergeIntentSignal.set(ne)}}this.executeMove(w,R.target)}k.claimedTargets.add(`${R.target.x},${R.target.y}`)}else this.appendLog(`[AI Unit ${w.id.substring(0,4)}] No valid moves. Passing.`),this.unitsSignal.update(te=>te.map(ne=>ne.id===w.id?fe(F({},ne),{hasActed:!0}):ne));await new Promise(te=>setTimeout(te,60))}this.endTurn(),this.isAiThinking=!1,this.aiBatchingActions=!1}executeOneFreeAction(){let e=this.getBasePosition("ai"),t=this.unitsSignal().filter(s=>s.owner==="player"&&Math.max(Math.abs(s.position.x-e.x),Math.abs(s.position.y-e.y))<=3&&s.tier>=2);if(t.length>0){let s=t.reduce((l,c)=>this.calculateTotalPoints(c)>this.calculateTotalPoints(l)?c:l,t[0]);if(this.reservePointsSignal().ai>=1&&this.aiDefenseSpawn(s))return!0}let i=this.unitsSignal().filter(s=>s.owner==="ai").length;if(i<6){let s=this.reservePointsSignal().ai,a=this.getPointsForTierLevel(2,1);if(s>=a&&this.aiSpawnTier(2,1,new Set)>0)return!0}let o=this.baseHealthSignal().ai<50?20:70;if(this.aiWoodSignal()>=o)return this.aiConvertWoodToReserve(),!0;if(this.reservePointsSignal().ai>=40&&this.aiSpawnTier(2,1,new Set)>0)return!0;{let s=this.reservePointsSignal().ai,a=this.unitsSignal().filter(l=>l.owner==="ai"&&this.isForest(l.position.x,l.position.y)).length;if(s>25&&a>5&&this.aiSpawnTier(3,1,new Set,!0)>0)return!0}if(t.length===0)try{let s=this.getPointsForTierLevel(3,1),a=this.forestsSignal().length,l=this.unitsSignal().filter(h=>h.owner==="ai"&&this.isForest(h.position.x,h.position.y)).length,c=a>0?l/a:0,d=this.reservePointsSignal().ai;if(i>=6&&d>=s&&c<=.6&&this.aiSpawnTier(3,1,new Set)>0)return!0}catch{}return!1}aiDefenseSpawn(e){let t=this.getBasePosition("ai"),i=[],r=e.position.x,o=e.position.y,s=Math.sign(t.x-r),a=Math.sign(t.y-o);{let p=0,g=Math.max(10,this.gridSize*2);for(;r!==t.x||o!==t.y;){if(p++,p>g){try{console.warn("[AI] Defense path safety break near base")}catch{}break}if(r+=s,o+=a,!this.inBounds(r,o)||r===t.x&&o===t.y)break;i.push({x:r,y:o})}}let l=i.reverse().find(p=>!this.getUnitAt(p.x,p.y))||(()=>{for(let p=-1;p<=1;p++)for(let g=-1;g<=1;g++){if(p===0&&g===0)continue;let S=t.x+p,I=t.y+g;if(this.inBounds(S,I)&&!this.getUnitAt(S,I))return{x:S,y:I}}return null})();if(!l)return!1;{let p=0,g=50;for(;this.aiWoodSignal()>=20;){if(p++,p>g){try{console.warn("[AI] Defense convert safety break")}catch{}break}this.aiConvertWoodToReserve()}}let c=this.reservePointsSignal().ai,d=this.economy.getHighestAffordableCost(c);if(d<=0)return!1;let h=this.calculateTierAndLevel(d);return this.unitsSignal().filter(g=>g.owner==="ai"&&g.tier===h.tier&&!this.isForest(g.position.x,g.position.y)).length>=5?!1:(this.unitsSignal.update(p=>[...p,{id:crypto.randomUUID(),position:F({},l),level:h.level,tier:h.tier,points:d,owner:"ai",turnsStationary:0,forestOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1}]),this.reservePointsSignal.update(p=>({player:p.player,ai:p.ai-d})),this.recomputeVisibility(),!0)}aiSpawnTier(e,t,i,r=!1){let o=this.getBasePosition("ai"),s=[],a=2;for(let P=-a;P<=a;P++)for(let U=-a;U<=a;U++){if(P===0&&U===0)continue;let oe=o.x+P,Se=o.y+U;if(!this.inBounds(oe,Se)||Math.max(Math.abs(P),Math.abs(U))>a)continue;let xe=`${oe},${Se}`;i.has(xe)||this.getUnitAt(oe,Se)||s.push({x:oe,y:Se})}let l=this.aiForgesSignal(),c=this.aiIronSignal()<40;c&&l.length>0&&s.sort((P,U)=>{let oe=l.reduce((xe,Ae)=>Math.min(xe,Math.max(Math.abs(P.x-Ae.x),Math.abs(P.y-Ae.y))),1/0);return l.reduce((xe,Ae)=>Math.min(xe,Math.max(Math.abs(U.x-Ae.x),Math.abs(U.y-Ae.y))),1/0)-oe});let d=this.reservePointsSignal().ai,h=this.getPointsForTierLevel(e,1),p=0,g=[],S=P=>this.unitsSignal().filter(U=>U.owner==="ai"&&U.tier===P&&!this.isForest(U.position.x,U.position.y)).length;if(S(e)>=5&&!(r&&e===3))return 0;for(let P of s){if(p>=t||d<h||S(e)>=5)break;let U=this.calculateTierAndLevel(h);g.push({id:crypto.randomUUID(),position:F({},P),level:U.level,tier:U.tier,points:h,owner:"ai",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}),d-=h,p++}if(g.length>0){this.unitsSignal.update(oe=>[...oe,...g]),this.reservePointsSignal.update(oe=>({player:oe.player,ai:d})),this.recomputeVisibility();let P=new Map(this.ignoreForgeUntilTurnSignal()),U=this.turnSignal()+(c?2:1);for(let oe of g)P.set(oe.id,U);this.ignoreForgeUntilTurnSignal.set(P)}return p}aiConvertWoodToReserve(){let e=this.aiWoodSignal(),i=this.baseHealthSignal().ai<50?20:70;e<i||(this.aiWoodSignal.update(r=>r-20),this.reservePointsSignal.update(r=>({player:r.player,ai:r.ai+1})))}spawnUnit(e){let t=this.getBasePosition(e);this.unitsSignal.update(i=>{if(i.some(s=>s.position.x===t.x&&s.position.y===t.y))return i;let o={id:crypto.randomUUID(),position:F({},t),level:1,tier:1,points:1,owner:e,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};return[...i,o]})}spawnStarterArmy(e){let t=this.getBasePosition(e),i=2,r=[];for(let c=-i;c<=i;c++)for(let d=-i;d<=i;d++){let h=t.x+c,p=t.y+d;this.inBounds(h,p)&&(c===0&&d===0||Math.max(Math.abs(c),Math.abs(d))>i||r.push({x:h,y:p}))}let o=this.settings.difficulty(),s;o==="baby"?s=[{tier:4,level:1},{tier:3,level:1},{tier:2,level:1},{tier:1,level:1}]:s=[{tier:1,level:1},{tier:1,level:1}];let a=[],l=(c,d)=>this.unitsSignal().some(h=>h.position.x===c&&h.position.y===d)||a.some(h=>h.position.x===c&&h.position.y===d);for(let c of s){let d=r.filter(S=>!l(S.x,S.y));if(d.length===0)break;let h=Math.floor(Math.random()*d.length),p=d[h],g=this.getPointsForTierLevel(c.tier,c.level);a.push({id:crypto.randomUUID(),position:F({},p),level:c.level,tier:c.tier,points:g,owner:e,turnsStationary:0,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0})}a.length>0&&this.unitsSignal.update(c=>[...c,...a])}getUnitAt(e,t){return this.unitsSignal().find(i=>i.position.x===e&&i.position.y===t)}getWallBetween(e,t,i,r){let o={x:e,y:t},s={x:i,y:r};if(!this.areAdjacent(o,s))return;let[a,l]=this.sortEdgeEndpoints(o,s);return this.wallsSignal().find(c=>c.tile1.x===a.x&&c.tile1.y===a.y&&c.tile2.x===l.x&&c.tile2.y===l.y)}isDiagonalBlocked(e,t){return this.combat.isDiagonalBlocked(e,t,(i,r,o,s)=>this.getWallBetween(i,r,o,s))}isValidMove(e,t){return this.validMoves().some(i=>i.x===e&&i.y===t)}isForest(e,t){return this.forestsSignal().some(i=>i.x===e&&i.y===t)}isMine(e,t){return this.minesSignal().some(i=>i.x===e&&i.y===t)}isForgeSite(e,t){return this.forgeSitesSignal().some(i=>i.position.x===e&&i.position.y===t)}isForge(e,t){return this.forgesSignal().some(i=>i.x===e&&i.y===t)}getForgeProgress(e,t){let i=this.forgeSitesSignal().find(o=>o.position.x===e&&o.position.y===t);if(!i)return 0;let r=5;return Math.round((r-i.turnsLeft)/r*100)}canBuildForgeAt(e,t){let i=this.getBasePosition("player");if(Math.max(Math.abs(e-i.x),Math.abs(t-i.y))>2||!this.inBounds(e,t)||e===i.x&&t===i.y||this.getUnitAt(e,t)||this.isForest(e,t)||this.isMine(e,t)||this.isForgeSite(e,t)||this.isForge(e,t))return!1;let o=this.resourcesSignal();return o.wood>=40&&o.iron>=20&&this.isPlayerTurn()}buildForgeAt(e){this.canBuildForgeAt(e.x,e.y)&&(this.resourcesSignal.update(t=>({wood:t.wood-40,iron:t.iron-20})),this.forgeSitesSignal.update(t=>[...t,{position:F({},e),owner:"player",turnsLeft:5}]))}buyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy weapon without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?fe(F({},s),{hasWeapon:!0}):s)))}buyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="player");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] Unit ${e} tried to buy armor without being on a forge`);return}this.resourcesSignal().iron<20||(this.resourcesSignal.update(o=>({wood:o.wood,iron:o.iron-20})),this.unitsSignal.update(o=>o.map(s=>s.id===e?fe(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[Forge] Player unit equipped Armor (+20 Shield HP)."))}getBasePosition(e){return e==="player"?{x:0,y:0}:{x:this.gridSize-1,y:this.gridSize-1}}cancelDeploy(){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1)}toggleBuildMode(){if(this.buildModeSignal()){this.buildModeSignal.set(!1);return}this.canBuildThisTurn()&&this.buildModeSignal.set(!0)}toggleFogDebug(){this.fogDebugDisabledSignal.update(e=>!e)}toggleRules(){this.rulesOpenSignal.update(e=>!e)}closeRules(){this.rulesOpenSignal.set(!1)}toggleLog(){this.logsOpenSignal.update(e=>!e)}logOpen(){return this.logsOpenSignal()}toggleSettings(){this.settingsOpenSignal.update(e=>!e)}autoDeployEnabled(){return this.autoDeployEnabledSignal()}toggleAutoDeploy(){this.autoDeployEnabledSignal.update(e=>!e)}settingsOpen(){return this.settingsOpenSignal()}logs(){return this.log.logs()}clearLogs(){return this.log.clear()}appendLog(e,t){this.log.add(e,t)}aiBuyArmor(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasArmor)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy armor without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?fe(F({},s),{hasArmor:!0,armorHp:20}):s)),this.appendLog("[AI] AI unit equipped Heavy Armor (+20 Shield HP)."))}aiBuyWeapon(e){let t=this.unitsSignal().find(o=>o.id===e&&o.owner==="ai");if(!t||t.hasWeapon)return;if(!(this.isForge(t.position.x,t.position.y)||this.isForgeSite(t.position.x,t.position.y))){console.warn(`[Cheat Attempt] AI Unit ${e} tried to buy weapon without being on a forge`);return}this.aiIronSignal()<20||(this.aiIronSignal.update(o=>o-20),this.unitsSignal.update(o=>o.map(s=>s.id===e?fe(F({},s),{hasWeapon:!0}):s)),this.appendLog("[AI] AI unit forged a Weapon (+20 ATK, +10 hit vs higher tier)."))}manageInfrastructure(){let e=this.aiForgesSignal().length+this.forgeSitesSignal().filter(c=>c.owner==="ai").length;if(e>=2)return;let t=this.aiWoodSignal(),i=this.aiIronSignal(),r=this.aiIronSignal();if(e===0){if(t<40||i<20)return}else if(e<2&&(r<=50||t<40||i<20))return;let o=this.getBasePosition("ai"),s=[];for(let c=-2;c<=2;c++)for(let d=-2;d<=2;d++){let h=o.x+c,p=o.y+d;this.inBounds(h,p)&&(h===o.x&&p===o.y||Math.max(Math.abs(c),Math.abs(d))>2||this.getUnitAt(h,p)||this.isForest(h,p)||this.isMine(h,p)||this.isForgeSite(h,p)||this.isForge(h,p)||s.push({x:h,y:p}))}if(s.length===0)return;let a=Math.floor(Math.random()*s.length),l=s[a];this.aiWoodSignal.update(c=>c-40),this.aiIronSignal.update(c=>c-20),this.forgeSitesSignal.update(c=>[...c,{position:F({},l),owner:"ai",turnsLeft:5}]),this.appendLog(`[AI] Constructing a Forge at (${l.x},${l.y}).`)}seekUpgrades(e,t){if(e.owner!=="ai")return{type:"none"};if(e.tier<2)return{type:"none"};if(e.hasArmor&&e.hasWeapon||this.aiIronSignal()<20)return{type:"none"};let i=this.aiForgesSignal();if(i.length===0)return{type:"none"};let r=this.getMergePartnerForUnit(e,t),o=this.aiIronSignal(),s=o>=100;if(s)this.appendLog(`[AI Wealth Override] T${e.tier} at (${e.position.x},${e.position.y}) bypassing normal checks (iron: ${o})`);else if(o<40){let h=this.computeHighestTierNeedingUpgrade();if(h>0&&e.tier<h)return{type:"none"}}if(!s&&r){let h=!e.hasWeapon&&r.hasWeapon,p=!e.hasArmor&&r.hasArmor;if(h||p){let g=h&&p?"Weapon & Armor":h?"Weapon":"Armor";return this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored ${g} purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) already has it).`),{type:"none"}}}let a=i.reduce((h,p)=>{let g=Math.max(Math.abs(p.x-e.position.x),Math.abs(p.y-e.position.y)),S=Math.max(Math.abs(h.x-e.position.x),Math.abs(h.y-e.position.y));return g<S?p:h},i[0]),c=this.ignoreForgeUntilTurnSignal().get(e.id)??0;if(this.turnSignal()<=c)return{type:"none"};if(e.position.x===a.x&&e.position.y===a.y){let h=this.aiIronSignal();if(r){let p=!1;return!r.hasArmor&&!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal(),p=!0),!r.hasWeapon&&!e.hasWeapon&&h>=20&&(this.aiBuyWeapon(e.id),p=!0),!p&&r.hasArmor&&r.hasWeapon&&this.appendLog(`[AI] Efficiency: T${e.tier} at (${e.position.x},${e.position.y}) ignored purchase (Partner T${r.tier} at (${r.position.x},${r.position.y}) fully equipped).`),{type:"none"}}else return!e.hasArmor&&h>=20&&(this.aiBuyArmor(e.id),h=this.aiIronSignal()),!e.hasWeapon&&h>=20&&this.aiBuyWeapon(e.id),{type:"none"}}let d=this.getNextStepTowards(e,a,t);return d?{type:"move",target:d}:{type:"none"}}seekUpgradesFor(e,t,i){if(t.owner!==e)return{type:"none"};if(t.tier<2)return{type:"none"};let r=this.getIron(e);if(t.hasArmor&&t.hasWeapon||r<20)return{type:"none"};let o=this.getForges(e);if(o.length===0)return{type:"none"};let s=e==="ai"?this.getMergePartnerForUnit(t,i):this.getMergePartnerForUnit(t,i),a=this.getIron(e),l=e==="ai"&&a>=100;if(l)this.appendLog(`[AI Wealth Override] T${t.tier} at (${t.position.x},${t.position.y}) bypassing normal checks (iron: ${a})`);else if(a<40){let g=this.computeHighestTierNeedingUpgrade();if(g>0&&t.tier<g)return{type:"none"}}if(!l&&s){let g=!t.hasWeapon&&s.hasWeapon,S=!t.hasArmor&&s.hasArmor;if(g||S)return this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored ${g&&S?"Weapon & Armor":g?"Weapon":"Armor"} purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) already has it).`),{type:"none"}}let c=o.reduce((g,S)=>{let I=Math.max(Math.abs(S.x-t.position.x),Math.abs(S.y-t.position.y)),P=Math.max(Math.abs(g.x-t.position.x),Math.abs(g.y-t.position.y));return I<P?S:g},o[0]),h=this.ignoreForgeUntilTurnSignal().get(t.id)??0;if(this.turnSignal()<=h)return{type:"none"};if(t.position.x===c.x&&t.position.y===c.y){let g=this.getIron(e);if(s){let S=!1;return!s.hasArmor&&!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e),S=!0),!s.hasWeapon&&!t.hasWeapon&&g>=20&&(this.buyWeaponGeneric(e,t.id),S=!0),!S&&s.hasArmor&&s.hasWeapon&&this.appendLog(`[AI] Efficiency: T${t.tier} at (${t.position.x},${t.position.y}) ignored purchase (Partner T${s.tier} at (${s.position.x},${s.position.y}) fully equipped).`),{type:"none"}}else return!t.hasArmor&&g>=20&&(this.buyArmorGeneric(e,t.id),g=this.getIron(e)),!t.hasWeapon&&g>=20&&this.buyWeaponGeneric(e,t.id),{type:"none"}}let p=this.getNextStepTowards(t,c,i,void 0);return p?{type:"move",target:p}:{type:"none"}}async executeBotTurn(e){if(this.activeSideSignal()!==e||this.gameStatus()!=="playing")return;let t=e==="ai"?"player":"ai",i=this.getBasePosition(t),r=this.getBasePosition("player"),o=this.getBasePosition("ai"),s=this.forestsSignal().length+this.minesSignal().length,a=this.unitsSignal().filter(p=>p.owner===t&&(this.isForest(p.position.x,p.position.y)||this.isMine(p.position.x,p.position.y)));if((s>0?a.length/s:0)>.5){let p=new Map,g=this.unitsSignal().filter(P=>P.owner===e&&!P.hasActed),S=new Set,I=a.slice().sort((P,U)=>U.tier-P.tier);for(let P of I){let U=Math.min(4,P.tier+1),oe=g.filter(xe=>xe.tier===U&&!S.has(xe.id)).sort((xe,Ae)=>{let Ie=Math.max(Math.abs(xe.position.x-P.position.x),Math.abs(xe.position.y-P.position.y)),k=Math.max(Math.abs(Ae.position.x-P.position.x),Math.abs(Ae.position.y-P.position.y));return Ie-k});if(oe.length>0){let xe=oe[0];p.set(xe.id,{target:F({},P.position),type:"hunt"}),S.add(xe.id);continue}let Se=g.filter(xe=>xe.tier===P.tier&&!S.has(xe.id));for(let xe of Se){let Ae=this.calculateValidMoves(xe),Ie=this.unitsSignal().find(k=>k.owner===e&&k.tier===xe.tier&&(k.position.x!==xe.position.x||k.position.y!==xe.position.y)&&Ae.some(C=>C.x===k.position.x&&C.y===k.position.y));if(Ie){p.set(xe.id,{target:F({},Ie.position),type:"merge"}),S.add(xe.id);break}}}e==="ai"?this.reclamationGoalsSignal.set(p):this.reclamationGoalsSignal.set(p)}else this.reclamationGoalsSignal.set(new Map);let d=this.unitsSignal().filter(p=>p.owner===e&&!p.hasActed),h={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(p=>p.owner===t&&p.tier>=3)};for(let p of d){let g=null,S=this.calculateValidMoves(p),I=this.getForges(e),P=this.unitsSignal().filter(Ie=>Ie.owner===t),U=[];for(let Ie of I)for(let k of P)Math.max(Math.abs(k.position.x-Ie.x),Math.abs(k.position.y-Ie.y))<=3&&U.push(k);if(U.length>0){let Ie=U.reduce((C,N)=>{let A=Math.abs(C.position.x-p.position.x)+Math.abs(C.position.y-p.position.y);return Math.abs(N.position.x-p.position.x)+Math.abs(N.position.y-p.position.y)<A?N:C});if(S.some(C=>C.x===Ie.position.x&&C.y===Ie.position.y))g={type:"attack",target:Ie.position,reason:"Defense: Guard Forge"};else{let C=this.getNextStepTowards(p,Ie.position,S);C&&(g=this.getWallBetween(p.position.x,p.position.y,C.x,C.y)?{type:"wall_attack",target:C,reason:"Defense: Breach to Forge"}:{type:"move",target:C,reason:"Defense: Approach Forge Threat"})}}if(!g&&p.tier>=2&&(!p.hasArmor||!p.hasWeapon)){let Ie=this.seekUpgradesFor(e,p,S);Ie.type==="move"&&Ie.target&&(g={type:"move",target:Ie.target,reason:"Upgrade: Move to Forge"})}let oe=this.computeSideEffectivePower(e),Se=this.computeSideEffectivePower(t),Ae=Se>0&&oe>Se*1.2&&!this.isForest(p.position.x,p.position.y)&&parseInt(p.id.slice(-1),16)%2===0;if(!g&&Ae){let Ie=this.getBasePosition(t);if(Math.max(Math.abs(Ie.x-p.position.x),Math.abs(Ie.y-p.position.y))<=1){let C=this.findCombatTarget(p,h,S);C&&(g={type:"attack",target:C,reason:"Siege: Engage Enemy"})}else{let C=this.getNextStepTowards(p,Ie,S,{noCohesion:!0});C&&(g={type:"move",target:C,reason:"Siege: Advance"})}}if(!g){let Ie=this.findCombatTarget(p,h,S);Ie&&(g={type:"attack",target:Ie,reason:"Combat: Engage Enemy"})}if(!g&&this.getWood(e)>=10&&this.getNeighbors(p.position).some(C=>this.isForest(C.x,C.y)&&this.getUnitAt(C.x,C.y)?.owner===e)){let C=this.findDefensiveWallTarget(p);C&&(g={type:"build_wall",target:C,reason:"Defense: Fortify Perimeter"})}if(!g){let Ie=t==="ai"?o:r,k=this.findFallbackMove(p,S,Ie);k&&(g={type:"move",target:k,reason:"Fallback: Advance on Enemy"})}g?g.type==="build_wall"?e==="ai"?this.aiBuildWallBetween(p.position,g.target):this.buildWallBetween(p.position,g.target):this.executeMove(p,g.target):this.unitsSignal.update(Ie=>Ie.map(k=>k.id===p.id?fe(F({},k),{hasActed:!0}):k)),await new Promise(Ie=>setTimeout(Ie,60))}e==="player"?this.endTurn():this.endTurn()}playerAutoStep(){if(!this.isPlayerTurn()||this.gameStatus()!=="playing")return!1;let e="player",t="ai",i=this.unitsSignal().find(a=>a.owner===e&&!a.hasActed);if(!i)return!1;let r=this.calculateValidMoves(i),o=this.seekUpgradesFor(e,i,r),s=null;if(o.type==="move"&&o.target&&(s={type:"move",target:o.target,reason:"Upgrade: Move to Forge"}),!s){let a=this.isForest(i.position.x,i.position.y),l=this.isMine(i.position.x,i.position.y),c=this.totalWarMode();if((a||l)&&!c&&!this.getNeighbors(i.position).some(p=>{let g=this.getUnitAt(p.x,p.y);return g&&g.owner===t}))return this.unitsSignal.update(p=>p.map(g=>g.id===i.id?fe(F({},g),{hasActed:!0}):g)),!0}if(!s){let a=this.findPlayerResourceTarget(i);if(a){let l=`${a.x},${a.y}`,c=new Set(this.playerClaimedTargetsSignal());c.add(l),this.playerClaimedTargetsSignal.set(c);let d=this.bfsPath(i.position,a,{respectWalls:!0,avoidFriendlyUnits:!0});if(d||(d=this.bfsPath(i.position,a,{avoidFriendlyUnits:!0})),d&&d.length>1){let h=d[1];this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?s={type:"wall_attack",target:h,reason:"Resource: Breach to Capture"}:r.some(g=>g.x===h.x&&g.y===h.y)&&(s={type:"move",target:h,reason:"Resource: Move to Capture"})}else{let h=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});h&&(s=this.getWallBetween(i.position.x,i.position.y,h.x,h.y)?{type:"wall_attack",target:h,reason:"Resource: Breach"}:{type:"move",target:h,reason:"Resource: Advance"})}}}if(!s){let a={claimedTargets:new Set,priorityTargets:this.unitsSignal().filter(c=>c.owner===t&&c.tier>=3)},l=this.findCombatTarget(i,a,r);l&&(s={type:"attack",target:l,reason:"Combat: Engage Enemy"})}if(!s){let a=this.getBasePosition(t),l=this.getNextStepTowards(i,a,r,{antiClump:!0,fogBonus:!0});l&&(s={type:"move",target:l,reason:"Advance"})}return s?(s.type==="build_wall"?this.buildWallBetween(i.position,s.target):s.type==="wall_attack"?this.attackOrDestroyWallBetween(i.position,s.target):this.executeMove(i,s.target),!0):(this.unitsSignal.update(a=>a.map(l=>l.id===i.id?fe(F({},l),{hasActed:!0}):l)),!1)}buildWallBetween(e,t){if(this.resourcesSignal().wood<10)return;if(!this.canBuildWallBetween(e,t)){if(this.isEdgeOnCooldown(e,t)){let a=this.edgeCooldownRemaining(e,t);this.appendLog(`[Build] This area is too unstable to rebuild yet (CD: ${a} turns).`)}return}let r=this.getBestAdjacentPlayerUnit(e,t);if(!r||r.hasActed||this.wallBuiltThisTurnSignal())return;let[o,s]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"player"}]),this.updateWallFormations(),this.resourcesSignal.update(a=>({wood:a.wood-10,iron:a.iron})),this.buildModeSignal.set(!1),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(a=>a.map(l=>l.id===r.id?fe(F({},l),{hasActed:!0}):l))}convertWoodToReserve(){this.resourcesSignal().wood<20||(this.resourcesSignal.update(t=>({wood:t.wood-20,iron:t.iron})),this.reservePointsSignal.update(t=>({player:t.player+1,ai:t.ai})),this.playerConvertedThisTurnSignal.set(!0))}maxConvertWoodToReserve(){let e=this.resourcesSignal().wood,t=Math.floor(e/20);t<=0||(this.resourcesSignal.update(i=>({wood:i.wood-t*20,iron:i.iron})),this.reservePointsSignal.update(i=>({player:i.player+t,ai:i.ai})),this.playerConvertedThisTurnSignal.set(!0))}startDeployFromBase(){let e=this.reservePointsSignal().player,t=this.getBasePosition("player");if(e<=0){this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1);return}let i=[];for(let r=-2;r<=2;r++)for(let o=-2;o<=2;o++){if(r===0&&o===0)continue;let s=t.x+r,a=t.y+o;if(s<0||s>=this.gridSize||a<0||a>=this.gridSize||Math.max(Math.abs(r),Math.abs(o))>2)continue;this.getUnitAt(s,a)||i.push({x:s,y:a})}this.deployTargetsSignal.set(i),this.baseDeployActiveSignal.set(!0)}startSandboxSpawn(e,t){this.settings.customMode()&&this.sandboxSpawnPendingSignal.set({owner:e,tier:t})}cancelSandboxSpawn(){this.sandboxSpawnPendingSignal.set(null)}spawnSandboxAt(e){let t=this.sandboxSpawnPendingSignal();if(!t||!this.settings.customMode()||this.getUnitAt(e.x,e.y))return;let i=this.getPointsForTierLevel(t.tier,1),r={id:crypto.randomUUID(),position:F({},e),level:1,tier:t.tier,points:i,owner:t.owner,turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0};this.unitsSignal.update(o=>[...o,r]),this.sandboxSpawnPendingSignal.set(null),this.recomputeVisibility()}autoDeployFromReserves(){let e=this.getBasePosition("player"),t=[];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++){if(o===0&&s===0)continue;let a=e.x+o,l=e.y+s;this.inBounds(a,l)&&(Math.max(Math.abs(o),Math.abs(s))>2||this.getUnitAt(a,l)||t.push({x:a,y:l}))}let i=this.reservePointsSignal().player,r=[];for(let o of t){if(i<=0)break;let s=this.economy.getHighestAffordableCost(i);if(s<=0)break;let a=this.calculateTierAndLevel(s);this.unitsSignal.update(l=>[...l,{id:crypto.randomUUID(),position:F({},o),level:a.level,tier:a.tier,points:s,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0,hasWeapon:!1,hasArmor:!1,armorHp:0}]),i-=s,r.push(o)}r.length>0&&(this.reservePointsSignal.update(o=>({player:i,ai:o.ai})),this.recomputeVisibility())}botEconomyPhase(e){if(this.gameStatus()!=="playing"||e!=="player"||!this.isPlayerTurn())return!1;let t=!1;{let r=this.baseHealthSignal().player<50?20:50,o=0;for(;this.resourcesSignal().wood>=r+20;)this.convertWoodToReserve(),o+=20;o>0&&(this.appendLog(`[Auto-Engage] Player converted ${o} wood to reserves.`),t=!0)}try{let i=this.forgesSignal().length,r=this.forgeSitesSignal().length,o=i+r,s=this.resourcesSignal();if(o<2&&s.iron>=20&&s.wood>=40){let a=this.getBasePosition("player"),l=2,c=!1;for(let d=-l;d<=l&&!c;d++)for(let h=-l;h<=l&&!c;h++){if(d===0&&h===0)continue;let p=a.x+d,g=a.y+h;this.inBounds(p,g)&&(Math.max(Math.abs(d),Math.abs(h))>l||this.canBuildForgeAt(p,g)&&(this.appendLog(`[Auto-Engage] Player building Forge at (${p},${g}).`),this.buildForgeAt({x:p,y:g}),t=!0,c=!0))}}}catch{}if(!this.wallBuiltThisTurnSignal()&&this.resourcesSignal().wood>=10){let r=this.unitsSignal().filter(o=>o.owner==="player"&&this.isForest(o.position.x,o.position.y));for(let o of r){let s=this.findDefensiveWallTargetForOwner(o,"player");if(s){this.buildWallBetween(o.position,s),t=!0;break}}}{let i=this.unitsSignal().length;this.autoDeployFromReserves(),this.unitsSignal().length>i&&(t=!0)}return t}isDeployTarget(e,t){return this.deployTargetsSignal().some(i=>i.x===e&&i.y===t)}deployTo(e){if(!this.isDeployTarget(e.x,e.y))return;let t=this.reservePointsSignal().player;if(t<=0)return;let i=this.economy.getHighestAffordableCost(t);if(i<=0)return;let r=this.calculateTierAndLevel(i);this.unitsSignal.update(o=>{let s={id:crypto.randomUUID(),position:F({},e),level:r.level,tier:r.tier,points:i,owner:"player",turnsStationary:0,forestOccupationTurns:0,mineOccupationTurns:0,productionActive:!1,hasActed:!0};return[...o,s]}),this.reservePointsSignal.update(o=>({player:o.player-i,ai:o.ai})),this.deployTargetsSignal.set([]),this.baseDeployActiveSignal.set(!1),this.recomputeVisibility(),this.appendLog(`[Turn ${this.turnSignal()}] Player deployed T${r.tier}(L${r.level}) at (${e.x},${e.y}) costing ${i} reserve.`)}areAdjacent(e,t){return this.build.areAdjacent(e,t)}sortEdgeEndpoints(e,t){return this.build.sortEdgeEndpoints(e,t)}edgeKey(e,t){let[i,r]=this.sortEdgeEndpoints(e,t);return`${i.x},${i.y}|${r.x},${r.y}`}registerWallDestroyedEdge(e,t){let i=this.edgeKey(e,t),r=new Map(this.wallCooldownSignal());r.set(i,this.turnSignal()),this.wallCooldownSignal.set(r)}isEdgeOnCooldown(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);return r===void 0?!1:5-(this.turnSignal()-r)>0}edgeCooldownRemaining(e,t){let i=this.edgeKey(e,t),r=this.wallCooldownSignal().get(i);if(r===void 0)return 0;let o=5-(this.turnSignal()-r);return Math.max(0,o)}attackOrDestroyWallBetween(e,t,i=!1){let r=this.getWallBetween(e.x,e.y,t.x,t.y);if(!r)return;let o=this.activeSideSignal();if(o==="ai"&&this.isBaseProtectionEdge(e,t)){if(r.owner==="neutral"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of neutral wall adjacent to base.`);try{console.warn("[AI] Blocked neutral wall destruction adjacent to base")}catch{}return}if(r.owner==="ai"){this.appendLog(`[Turn ${this.turnSignal()}] [AI Base Protection] Blocked destruction of own wall adjacent to base.`);try{console.warn("[AI] Blocked own wall destruction adjacent to base")}catch{}return}}if(r.owner==="player"&&o==="player"){this.destroyOwnWallBetween(e,t);return}let s=o==="player"?this.getBestAdjacentPlayerUnit(e,t):this.getBestAdjacentAiUnit(e,t);if(!s||o==="player"&&s.hasActed)return;{let S=t.x-e.x,I=t.y-e.y,P=Math.abs(S)>=Math.abs(I),U=Math.sign(P?S:I),oe=this.wallThicknessPx+2,Se=this.tileSizePx+oe,xe=Math.round(Se*.35),Ae=P?U*xe:0,Ie=P?0:U*xe,k=new Set(this.attackingUnitsSignal());k.add(s.id),this.attackingUnitsSignal.set(k),this.attackerNudgeSignal.set({id:s.id,dx:Ae,dy:Ie}),setTimeout(()=>{this.attackerNudgeSignal.set({id:s.id,dx:0,dy:0})},100),setTimeout(()=>{this.attackerNudgeSignal.set(null);let C=new Set(this.attackingUnitsSignal());C.delete(s.id),this.attackingUnitsSignal.set(C)},200)}let a=this.combat.getWallHitAmount(s.tier),[l,c]=this.sortEdgeEndpoints(e,t),d=r.maxHealth??100,h=Math.max(0,r.health-a);this.wallsSignal.update(S=>S.map(I=>I.id===r.id?fe(F({},I),{health:Math.max(0,I.health-a)}):I).filter(I=>I.health>0)),h<=0?(this.registerWallDestroyedEdge(l,c),this.updateWallFormations()):this.updateWallFormations(),this.shakenWallIdSignal.set(r.id),setTimeout(()=>this.shakenWallIdSignal.set(null),200);let p=o==="player"?"Player":"AI",g=r.owner==="neutral"?"Neutral":r.owner==="player"?"Player":"AI";this.appendLog(`[Combat] Tier ${s.tier} Unit attacked ${g} Wall. Damage: ${a}. Wall HP: ${h}/${d}.`),o==="ai"&&this.appendLog(`[AI Pathfinding] Breaking through wall at (${t.x},${t.y}) to reach target.`),this.unitsSignal.update(S=>S.map(I=>I.id===s.id?fe(F({},I),{hasActed:!0}):I)),o==="player"&&this.selectNextAvailableUnit()}destroyOwnWallBetween(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);if(!i||i.owner!=="player"||!this.isAnyPlayerUnitAdjacentToEdge(e,t))return;this.wallsSignal.update(s=>s.filter(a=>a.id!==i.id));let[r,o]=this.sortEdgeEndpoints(e,t);this.registerWallDestroyedEdge(r,o),this.appendLog(`[Turn ${this.turnSignal()}] Player removed own wall between (${e.x},${e.y})-(${t.x},${t.y}).`),this.updateWallFormations()}canDestroyOwnWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||i.owner!=="player"?!1:this.isAnyPlayerUnitAdjacentToEdge(e,t)}canAttackEnemyWall(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!(!i||i.owner==="player"||!this.getBestAdjacentPlayerUnit(e,t))}canShowAttackIcon(e,t){let i=this.getWallBetween(e.x,e.y,t.x,t.y);return!i||!this.canActThisTurn()?!1:i.owner==="player"?this.canDestroyOwnWall(e,t):this.canAttackEnemyWall(e,t)}canBuildThisTurn(){return!this.canActThisTurn()||this.wallBuiltThisTurnSignal()?!1:this.resourcesSignal().wood>=10}canAddReserveTurn(){return this.resourcesSignal().wood>=20}isPlayerTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}remainingActions(){return this.unitsSignal().filter(e=>e.owner==="player"&&!e.hasActed).length}totalPlayerUnits(){return this.unitsSignal().filter(e=>e.owner==="player").length}canActThisTurn(){return this.gameStatusSignal()!=="playing"?!1:this.activeSideSignal()==="player"}isAnyPlayerUnitAdjacentToEdge(e,t){return this.unitsSignal().some(i=>i.owner==="player"&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getAdjacentPlayerUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="player"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentPlayerUnit(e,t){let i=this.getAdjacentPlayerUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}getAdjacentAiUnits(e,t){return this.unitsSignal().filter(i=>i.owner==="ai"&&!i.hasActed&&(i.position.x===e.x&&i.position.y===e.y||i.position.x===t.x&&i.position.y===t.y))}getBestAdjacentAiUnit(e,t){let i=this.getAdjacentAiUnits(e,t);return i.length===0?null:i.reduce((r,o)=>this.calculateTotalPoints(o)>this.calculateTotalPoints(r)?o:r)}canShowBuildIcon(e,t){return!this.buildModeSignal()||!this.canBuildThisTurn()||!this.canBuildWallBetween(e,t)?!1:!!this.getBestAdjacentPlayerUnit(e,t)}isInSafeZone(e,t){return this.isInNoBuildZone({x:e,y:t})}canBuildWallBetween(e,t){return!(!this.areAdjacent(e,t)||!this.isVisibleToPlayer(e.x,e.y)&&!this.isVisibleToPlayer(t.x,t.y)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t))}aiBuildWallBetween(e,t){if(this.wallBuiltThisTurnSignal()||this.aiWoodSignal()<50)return;let i=this.getBestAdjacentAiUnit(e,t);if(!i||i.hasActed||!this.unitsSignal().filter(l=>l.owner==="player").some(l=>{let c=Math.max(Math.abs(l.position.x-e.x),Math.abs(l.position.y-e.y)),d=Math.max(Math.abs(l.position.x-t.x),Math.abs(l.position.y-t.y));return c<=2||d<=2?l.tier>=i.tier:!1})||!this.areAdjacent(e,t)||this.isInNoBuildZone(e)||this.isInNoBuildZone(t)||this.getWallBetween(e.x,e.y,t.x,t.y)||this.isEdgeOnCooldown(e,t)||this.wouldCageElite(e,t)&&!this.isBaseProtectionEdge(e,t))return;let[s,a]=this.sortEdgeEndpoints(e,t);this.wallsSignal.update(l=>[...l,{id:crypto.randomUUID(),tile1:{x:s.x,y:s.y},tile2:{x:a.x,y:a.y},health:100,owner:"ai"}]),this.aiWoodSignal.update(l=>l-10),this.wallBuiltThisTurnSignal.set(!0),this.unitsSignal.update(l=>l.map(c=>c.id===i.id?fe(F({},c),{hasActed:!0}):c)),this.updateWallFormations()}isBaseProtectionEdge(e,t){let i=this.getBasePosition("ai"),r=o=>Math.max(Math.abs(o.x-i.x),Math.abs(o.y-i.y))<=1||o.x===i.x&&o.y===i.y;return r(e)||r(t)}wouldCageElite(e,t){let i=(s,a,l,c)=>{let d=this.sortEdgeEndpoints({x:s,y:a},{x:l,y:c}),h=this.sortEdgeEndpoints(e,t);return d[0].x===h[0].x&&d[0].y===h[0].y&&d[1].x===h[1].x&&d[1].y===h[1].y},r=(s,a)=>{if(s.x===a.x||s.y===a.y)return!!(this.getWallBetween(s.x,s.y,a.x,a.y)||i(s.x,s.y,a.x,a.y));{let l=Math.sign(a.x-s.x),c=Math.sign(a.y-s.y),d=this.getWallBetween(s.x,s.y,s.x+l,s.y),h=this.getWallBetween(s.x,s.y,s.x,s.y+c),p=this.getWallBetween(a.x-l,a.y,a.x,a.y),g=this.getWallBetween(a.x,a.y-c,a.x,a.y);return!!(d||h||p||g||i(s.x,s.y,s.x+l,s.y)||i(s.x,s.y,s.x,s.y+c)||i(a.x-l,a.y,a.x,a.y)||i(a.x,a.y-c,a.x,a.y))}},o=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1}];for(let s of this.unitsSignal()){if(s.owner!=="ai"||s.tier<2)continue;if(o.filter(l=>{let c={x:s.position.x+l.x,y:s.position.y+l.y};return this.inBounds(c.x,c.y)?!r(s.position,c):!1}).length<2)return!0}return!1}tryDefensiveWallsNearForests(){if(this.wallBuiltThisTurnSignal())return!1;let e=this.unitsSignal().filter(r=>r.owner==="ai"),t=this.unitsSignal().filter(r=>r.owner==="player"),i=this.getBasePosition("ai");for(let r of e){if(!this.isForest(r.position.x,r.position.y))continue;let o=t.filter(s=>Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y))<=2);for(let s of o){let a=r.level??this.calculateTierAndLevel(r.points).level,l=s.level??this.calculateTierAndLevel(s.points).level,c=Math.max(Math.abs(s.position.x-r.position.x),Math.abs(s.position.y-r.position.y)),d=Math.sign(s.position.x-r.position.x),h=Math.sign(s.position.y-r.position.y);if(Math.abs(d)+Math.abs(h)===2)continue;let p=c===1?{x:r.position.x+d,y:r.position.y+h}:{x:r.position.x+Math.sign(s.position.x-r.position.x),y:r.position.y+Math.sign(s.position.y-r.position.y)};if(!this.inBounds(p.x,p.y))continue;let g=Math.sign(i.x-r.position.x),S=Math.sign(i.y-r.position.y);if((p.x-r.position.x)*g+(p.y-r.position.y)*S>0)continue;let P=r.position,U=p;if(!this.getWallBetween(P.x,P.y,U.x,U.y)&&(l>=a&&this.aiWoodSignal()>=20&&(this.aiBuildWallBetween(P,U),this.appendLog(`[Turn ${this.turnSignal()}] [AI Stealth] Defensive wall triggered against Player threat. Edge: (${P.x},${P.y})-(${U.x},${U.y}).`)),this.wallBuiltThisTurnSignal()))return!0}}return!1}isInNoBuildZone(e){return this.build.isInNoBuildZone(e,this.getBasePosition("player"),this.getBasePosition("ai"))}unitQuadrantBias(){return this.unitQuadrantBiasSignal()}getQuadrant(e,t){let i=e.x<=t.x,r=e.y<=t.y;return i&&r?0:!i&&r?1:i&&!r?2:3}placeNeutralWalls(){let e=(i,r)=>{if(!this.areAdjacent(i,r)||!this.inBounds(i.x,i.y)||!this.inBounds(r.x,r.y)||this.getWallBetween(i.x,i.y,r.x,r.y))return;let[o,s]=this.sortEdgeEndpoints(i,r);this.wallsSignal.update(a=>[...a,{id:crypto.randomUUID(),tile1:{x:o.x,y:o.y},tile2:{x:s.x,y:s.y},health:100,owner:"neutral"}]),this.updateWallFormations()},t=[this.getBasePosition("player"),this.getBasePosition("ai")];for(let i of t){let r=[{x:i.x+1,y:i.y},{x:i.x-1,y:i.y},{x:i.x,y:i.y+1},{x:i.x,y:i.y-1}];for(let o of r)this.inBounds(o.x,o.y)&&e(i,o)}for(let i of this.forestsSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}for(let i of this.minesSignal()){let r={x:i.x+1,y:i.y},o={x:i.x,y:i.y+1},s={x:i.x-1,y:i.y},a={x:i.x,y:i.y-1};this.inBounds(r.x,r.y)&&e(i,r),this.inBounds(o.x,o.y)&&e(i,o),this.inBounds(s.x,s.y)&&e(i,s),this.inBounds(a.x,a.y)&&e(i,a)}}static \u0275fac=function(t){return new(t||n)(De(Ll),De(Ag),De(Mg),De(Rt),De(Rg),De(Ng),De(Pg),De(jn),De(mc))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};function fG(n,e){n&1&&(X(),B(0,"polygon",127))}function pG(n,e){n&1&&(X(),B(0,"polygon",127))}function gG(n,e){n&1&&(X(),b(0,"g"),B(1,"polygon",213),T())}function mG(n,e){n&1&&(X(),B(0,"polygon",127))}function yG(n,e){n&1&&(X(),b(0,"g"),B(1,"polygon",213),T())}function vG(n,e){n&1&&(X(),b(0,"g"),B(1,"polygon",214)(2,"polygon",215)(3,"polygon",216),T())}var l0=class n{constructor(e,t){this.engine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(ge(ii),ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-game-rules"]],decls:694,vars:76,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[960px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-2xl","font-bold"],[1,"text-xs","mt-2","font-bold","text-gray-300"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto","max-h-[80vh]","pr-2"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","gap-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","flex-col","justify-between"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"text-xs","text-gray-300"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold"],[1,"w-12","h-12","bg-blue-500","text-white","flex","items-center","justify-center","font-bold","rotate-45","scale-75"],[1,"rotate-315"],[1,"text-sm","text-gray-300","mb-3"],[1,"flex","items-center","justify-center","h-[40px]"],[1,"merge-loop","relative"],[1,"unit","u1"],[1,"unit","u2"],[1,"result"],[1,"bg-gray-800/60","border","border-blue-500/30","rounded-lg","p-4","shadow-[0_0_15px_rgba(59,130,246,0.1)]"],[1,"text-lg","font-semibold","mb-3","flex","items-center","gap-2"],[1,"text-blue-400"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[45px]","text-center"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","font-mono","text-white","min-w-[60px]","text-center"],[1,"text-xs","text-gray-400","text-right","italic"],[1,"flex","flex-col","items-center","gap-1"],[1,"px-2","py-1","bg-gray-700","border-b-4","border-gray-900","rounded","text-xs","text-white"],[1,"flex","items-center","justify-between","gap-4","border-t","border-white/5","pt-3"],[1,"px-4","py-1","bg-blue-600","border-b-4","border-blue-800","rounded","text-xs","font-mono","text-white","font-bold"],[1,"text-xs","text-blue-300","font-semibold","uppercase","tracking-wider"],[1,"mt-4","p-2","bg-blue-500/10","border","border-blue-500/20","rounded","text-[10px]","text-blue-200/70","leading-tight"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-sm","font-semibold","mb-2"],[1,"combat-stage"],[1,"attacker","triangle"],[1,"defender","circle","hit-flash","defender-fade"],[1,"text-[11px]","text-gray-400","mt-2"],[1,"defender","square","hit-flash","defender-fade"],[1,"crit-pop"],[1,"defender","circle"],[1,"miss-pop"],[1,"bg-gray-800/60","border","border-gray-700","rounded-xl","p-6","md:col-span-2","shadow-2xl","backdrop-blur-sm"],[1,"text-xs","uppercase","tracking-widest","text-gray-500","font-bold","mb-6","flex","items-center","gap-2"],[1,"w-8","h-[1px]","bg-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8","items-start"],[1,"space-y-6"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-gray-300","text-sm"],[1,"text-orange-400","font-bold"],[1,"text-blue-400","font-bold"],[1,"p-3","bg-gray-900/40","rounded-lg","border","border-gray-700/50"],[1,"text-xs","text-gray-400","leading-relaxed"],[1,"text-white","font-semibold"],[1,"lg:col-span-2","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-blue-500/50","transition-all","duration-300","flex","items-center","gap-4"],[1,"w-20","h-20","shrink-0"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],["cx","50","cy","50","r","32"],["cx","50","cy","50","r","31","fill","none","stroke","rgba(255,255,255,0.2)","stroke-width","2"],["x","50","y","62","text-anchor","middle","font-size","32","font-weight","800","fill","white"],["transform","translate(18, 5) scale(0.8)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","#60a5fa"],[1,"flex","flex-col"],[1,"text-blue-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"text-gray-300","text-sm","leading-tight"],[1,"group","bg-gray-900/40","p-4","rounded-xl","border","border-gray-700/50","hover:border-red-500/50","transition-all","duration-300","flex","items-center","gap-4"],["viewBox","0 0 100 100",1,"w-full","h-full","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],["transform","rotate(-45 50 50) translate(40, 10) scale(1.2)"],["x","5","y","0","width","2","height","10","fill","#f87171"],["x","3","y","10","width","6","height","2","fill","#991b1b"],[1,"text-red-400","text-xs","font-bold","uppercase","tracking-tighter","mb-1"],[1,"p-4","bg-gray-800/40","rounded-lg","border","border-gray-700/30"],[1,"text-[10px]","uppercase","tracking-wider","text-gray-500","font-bold","mb-3"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"flex","justify-between","border-b","border-gray-700/50","pb-1"],[1,"text-gray-500"],[1,"text-white"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","#60a5fa","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],[1,"text-lg","font-semibold","mb-1"],[1,"grid","grid-cols-2","gap-4"],[1,"text-xs","text-gray-300","mb-1"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","1"],[1,"path-cell"],[1,"path-cell","active"],[1,"mover","circle","t1-path"],[1,"path-line","path-animation"],[1,"castle"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","3"],[1,"mover","square","t3-path"],[1,"castle","red"],[1,"path-grid",2,"--start-x","2","--start-y","2","--line-steps","4"],[1,"mover","triangle","t1-path"],[1,"flex","flex-col","items-center"],[1,"text-2xl"],[1,"text-[11px]","text-gray-400"],[1,"flex","items-center","text-gray-500"],[1,"text-[11px]","text-emerald-400"],[1,"flex","items-center","gap-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-emerald-400"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4","mb-1"],[1,"h-4","w-16","rounded","bg-lime-400"],[1,"h-4","w-16","rounded","bg-red-400"],[1,"h-4","w-16","rounded","bg-gray-300"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","theme-test-player"],[1,"flex","flex-col","flex-center"],[1,"flex","flex-center","gap-2"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-80"],["points","50,16 86,78 14,78","fill","var(--u-fill)"],["x","49","y","66","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2"],["viewBox","0 0 100 100"],["id","base-circle"],["id","eye"],["id","scan-lvl2"],["id","radar-lvl3"],["id","field-lvl4"],["cx","50","cy","50","r","14","fill","#94a3b8"],["cx","50","cy","50","r","4","fill","#e5e7eb"],["cx","50","cy","50","r","20","fill","none","stroke","#cbd5f5","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","#e5e7eb","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","#f8fafc"],["cx","50","cy","50","r","30","fill","none","stroke","#f1f5f9","stroke-width","1","opacity","0.4"],[1,"unit-svg-wrapper","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-70"],["cx","50","cy","55","r","6","fill","var(--u-core)"],["points","50,5 55,15 45,15","fill","var(--u-stroke)"],["points","92,82 82,78 86,70","fill","var(--u-stroke)"],["points","8,82 18,78 14,70","fill","var(--u-stroke)"],["points","50,2 95,85 5,85","fill","none","stroke","var(--u-core)","stroke-width","2"],["points","50,48 56,52 56,60 50,64 44,60 44,52","fill","var(--u-light)"],["points","50,-2 102,88 -2,88","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","opacity","0.6"],["points","50,-5 54,8 46,8","fill","var(--u-light)"],["points","92,82 88,70 80,78","fill","var(--u-light)"],["points","8,82 20,78 12,70","fill","var(--u-light)"],["id","base-shape"],["id","core"],["id","armor-lvl2"],["id","armor-lvl3"],["id","fortress-lvl4"],["id","fx"],["x","20","y","20","width","60","height","60","rx","6","fill","#2563eb"],["x","46","y","46","width","8","height","8","fill","#93c5fd"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","#60a5fa","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","#93c5fd","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","#bfdbfe"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","#60a5fa","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","#bfdbfe"],["x","78","y","12","width","10","height","10","fill","#bfdbfe"],["x","12","y","78","width","10","height","10","fill","#bfdbfe"],["x","78","y","78","width","10","height","10","fill","#bfdbfe"],["id","base-hex"],["id","links-lvl2"],["id","network-lvl3"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","#10b981"],["cx","50","cy","50","r","4","fill","#6ee7b7"],["x1","50","y1","20","x2","50","y2","40","stroke","#6ee7b7","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","#6ee7b7","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","#6ee7b7","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","#a7f3d0","stroke-width","2"],["cx","50","cy","20","r","3","fill","#34d399"],["cx","80","cy","50","r","3","fill","#34d399"],["cx","50","cy","80","r","3","fill","#34d399"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","#6ee7b7","stroke-width","1.5","stroke-dasharray","4 4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4","md:col-span-2","unit-svg-wrapper","unit-svg-wrapper-game_rules"],[1,"flex","items-center","gap-6","theme-test-player"],["viewBox","0 0 100 100",1,"w-full","h-full"],["cx","50","cy","50","r","20","fill","var(--u-fill)"],["cx","50","cy","50","r","4","fill","var(--u-light)"],["cx","50","cy","50","r","26","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","3 4"],["x1","50","y1","50","x2","75","y2","35","stroke","var(--u-light)","stroke-width","2"],["cx","75","cy","35","r","2.5","fill","var(--u-light)"],["cx","50","cy","50","r","34","fill","none","stroke","var(--u-light)","stroke-width","1","opacity","0.4"],[1,"flex","items-center","gap-6","theme-test-ai"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-75"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-110"],["x","20","y","20","width","60","height","60","rx","6","fill","var(--u-dark)"],["x","46","y","46","width","8","height","8","fill","var(--u-core)"],["x","26","y","26","width","48","height","48","rx","4","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["x","16","y","16","width","68","height","68","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","42","y","42","width","16","height","16","fill","var(--u-light)"],["x","12","y","12","width","76","height","76","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5"],["x","12","y","12","width","10","height","10","fill","var(--u-light)"],["x","78","y","12","width","10","height","10","fill","var(--u-light)"],["x","12","y","78","width","10","height","10","fill","var(--u-light)"],["x","78","y","78","width","10","height","10","fill","var(--u-light)"],["points","50,15 80,32 80,68 50,85 20,68 20,32","fill","var(--u-emerald)"],["cx","50","cy","50","r","4","fill","var(--u-emerald-stroke)"],["x1","50","y1","20","x2","50","y2","40","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","80","y1","50","x2","60","y2","50","stroke","var(--u-emerald-stroke)","stroke-width","2"],["x1","50","y1","80","x2","50","y2","60","stroke","var(--u-emerald-stroke)","stroke-width","2"],["points","50,28 70,38 70,62 50,72 30,62 30,38","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","2"],["cx","50","cy","20","r","3","fill","var(--u-emerald-stroke)"],["cx","80","cy","50","r","3","fill","var(--u-emerald-stroke)"],["cx","50","cy","80","r","3","fill","var(--u-emerald-stroke)"],["points","50,10 85,30 85,70 50,90 15,70 15,30","fill","none","stroke","var(--u-emerald-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["points","50,0 56,10 44,10","fill","var(--u-light)"],["points","99,87 92,74 84,87","fill","var(--u-light)"],["points","1,87 15,87 8,74","fill","var(--u-light)"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),v(5),T(),b(6,"h3",5),v(7),T()(),b(8,"button",6),et("click",function(){return i.engine.closeRules()}),v(9," \u2716 "),T()(),b(10,"div",7)(11,"div",8)(12,"div",9),v(13),T(),b(14,"div",10)(15,"div",11)(16,"div",12),v(17,"\u{1F333}"),T(),b(18,"div")(19,"div",13),v(20),T(),b(21,"div",14),v(22),T()()(),b(23,"div",11)(24,"div",12),v(25,"\u{1F3F0}"),T(),b(26,"div")(27,"div",13),v(28),T(),b(29,"div",14),v(30),T()()()()(),b(31,"div",15)(32,"div",16)(33,"div",9),v(34),T(),b(35,"div",17)(36,"div",18)(37,"div",19),v(38," 1 "),T(),b(39,"div",20),v(40,"1\u20134"),T()(),b(41,"div",18)(42,"div",21),v(43," 5 "),T(),b(44,"div",20),v(45,"5\u201320"),T()(),b(46,"div",18)(47,"div",21),v(48,"25"),T(),b(49,"div",20),v(50,"25\u2013100"),T()(),b(51,"div",18)(52,"div",22)(53,"span",23),v(54,"125"),T()(),b(55,"div",20),v(56,"125\u2013500"),T()()()(),b(57,"div",16)(58,"div",24),v(59),T(),b(60,"div",25)(61,"div",26)(62,"div",27),v(63,"2"),T(),b(64,"div",28),v(65,"2"),T(),b(66,"div",29),v(67,"1"),T()()()()(),b(68,"div",30)(69,"div",31)(70,"span",32),v(71,"\u2328\uFE0F"),T(),v(72),T(),b(73,"div",33)(74,"div",34)(75,"div",35)(76,"kbd",36),v(77," Tab "),T(),b(78,"kbd",37),v(79," Space "),T()(),b(80,"div",38),v(81),T()(),b(82,"div",34)(83,"div",39)(84,"kbd",40),v(85,"\u2191"),T(),b(86,"div",35)(87,"kbd",40),v(88,"\u2190"),T(),b(89,"kbd",40),v(90,"\u2193"),T(),b(91,"kbd",40),v(92,"\u2192"),T()()(),b(93,"div",38),v(94),T()(),b(95,"div",41)(96,"kbd",42),v(97," Enter "),T(),b(98,"div",43),v(99),T()()(),b(100,"div",44)(101,"strong"),v(102,"TIP:"),T(),v(103),T()(),b(104,"div",8)(105,"div",9),v(106),T(),b(107,"div",45)(108,"div")(109,"div",46),v(110),T(),b(111,"div",47)(112,"div",48),v(113,"1"),T(),b(114,"div",49),v(115,"1"),T()(),b(116,"div",50),v(117),T()(),b(118,"div")(119,"div",46),v(120),T(),b(121,"div",47)(122,"div",48),v(123,"4"),T(),b(124,"div",51),v(125,"1"),T(),b(126,"span",52),v(127,"CRIT!"),T()(),b(128,"div",50),v(129),T()(),b(130,"div")(131,"div",46),v(132),T(),b(133,"div",47)(134,"div",48),v(135,"1"),T(),b(136,"div",53),v(137,"4"),T(),b(138,"span",54),v(139,"MISS!"),T()(),b(140,"div",50),v(141),T()()()(),b(142,"div",55)(143,"div",56),B(144,"span",57),v(145),T(),b(146,"div",58)(147,"div",59)(148,"div",60)(149,"div",61)(150,"span",62),v(151),T(),b(152,"span",63),v(153,"20%"),T()(),b(154,"div",61)(155,"span",62),v(156),T(),b(157,"span",64),v(158,"20%"),T()(),b(159,"div",65)(160,"p",66)(161,"span",67),v(162,"50%"),T(),v(163),T()()()(),b(164,"div",68)(165,"div",69)(166,"div",70),X(),b(167,"svg",71),B(168,"circle",72)(169,"circle",73),b(170,"text",74),v(171,"1"),T(),b(172,"g",75),B(173,"path",76),T()()(),Ne(),b(174,"div",77)(175,"span",78),v(176,"+20 HP Bonus"),T(),b(177,"p",79),v(178),T()()(),b(179,"div",80)(180,"div",70),X(),b(181,"svg",81),B(182,"circle",72)(183,"circle",73),b(184,"text",74),v(185,"1"),T(),b(186,"g",82),B(187,"rect",83)(188,"rect",84),T()()(),Ne(),b(189,"div",77)(190,"span",85),v(191,"+20 DMG Bonus"),T(),b(192,"p",79),v(193),T()()()(),b(194,"div",68)(195,"div",86)(196,"p",87),v(197),T(),b(198,"div",88)(199,"div",89)(200,"span",90),v(201,"T1"),T(),b(202,"span",91),v(203,"1"),T()(),b(204,"div",89)(205,"span",90),v(206,"T2"),T(),b(207,"span",91),v(208,"2"),T()(),b(209,"div",89)(210,"span",90),v(211,"T3"),T(),b(212,"span",91),v(213,"4"),T()(),b(214,"div",89)(215,"span",90),v(216,"T4"),T(),b(217,"span",91),v(218,"8"),T()()()(),b(219,"div",80)(220,"div",70),X(),b(221,"svg",81),B(222,"circle",72)(223,"circle",73),b(224,"text",74),v(225,"1"),T(),b(226,"g"),B(227,"path",92)(228,"path",93),T()()(),Ne(),b(229,"div",77)(230,"p",79),v(231),T()()()()()(),b(232,"div",16)(233,"div",94),v(234),T(),b(235,"div",95)(236,"div")(237,"div",96),v(238),T(),b(239,"div",97),B(240,"div",98)(241,"div",98)(242,"div",98)(243,"div",98)(244,"div",98)(245,"div",98)(246,"div",99)(247,"div",99)(248,"div",98)(249,"div",98)(250,"div",98)(251,"div",98)(252,"div",98)(253,"div",98)(254,"div",98)(255,"div",98)(256,"div",98)(257,"div",98)(258,"div",98)(259,"div",98)(260,"div",98)(261,"div",98)(262,"div",98)(263,"div",98)(264,"div",98),b(265,"div",100),v(266,"2"),T(),B(267,"div",101),b(268,"div",102),v(269,"\u{1F3F0}"),T()()(),b(270,"div")(271,"div",96),v(272),T(),b(273,"div",103),B(274,"div",98)(275,"div",98)(276,"div",98)(277,"div",98)(278,"div",98)(279,"div",98)(280,"div",99)(281,"div",99)(282,"div",99)(283,"div",98)(284,"div",98)(285,"div",98)(286,"div",98)(287,"div",98)(288,"div",98)(289,"div",98)(290,"div",98)(291,"div",98)(292,"div",98)(293,"div",98)(294,"div",98)(295,"div",98)(296,"div",98)(297,"div",98)(298,"div",98),b(299,"div",104),v(300,"3"),T(),B(301,"div",101),b(302,"div",105),v(303,"\u{1F3F0}"),T()()(),b(304,"div")(305,"div",96),v(306),T(),b(307,"div",106),B(308,"div",98)(309,"div",98)(310,"div",98)(311,"div",98)(312,"div",98)(313,"div",98)(314,"div",99)(315,"div",99)(316,"div",99)(317,"div",99)(318,"div",98)(319,"div",98)(320,"div",98)(321,"div",98)(322,"div",98)(323,"div",98)(324,"div",98)(325,"div",98)(326,"div",98)(327,"div",98)(328,"div",98)(329,"div",98)(330,"div",98)(331,"div",98)(332,"div",98),b(333,"div",107),v(334,"4"),T(),B(335,"div",101),b(336,"div",102),v(337,"\u{1F3F0}"),T()()()()(),b(338,"div",15)(339,"div",16)(340,"div",9),v(341),T(),b(342,"div",17)(343,"div",108)(344,"div",109),v(345,"\u{1F331}"),T(),b(346,"div",110),v(347),T()(),b(348,"div",111),v(349,"\u2192"),T(),b(350,"div",108)(351,"div",109),v(352,"\u{1F33F}"),T(),b(353,"div",110),v(354),T()(),b(355,"div",111),v(356,"\u2192"),T(),b(357,"div",108)(358,"div",109),v(359,"\u{1F333}"),T(),b(360,"div",112),v(361),T()()()(),b(362,"div",16)(363,"div",9),v(364),T(),b(365,"div",113)(366,"div",108)(367,"div",109),v(368,"\u26F0\uFE0F"),T(),b(369,"div",114),v(370),T()(),b(371,"div",111),v(372,"\u2192"),T(),b(373,"div",108)(374,"div",109),v(375,"\u26CF\uFE0F"),T(),b(376,"div",114),v(377),T()(),b(378,"div",111),v(379,"\u2192"),T(),b(380,"div",108)(381,"div",109),v(382,"\u26CF"),T(),b(383,"div",114),v(384),T()(),b(385,"div",111),v(386,"\u2192"),T(),b(387,"div",108)(388,"div",109),v(389,"\u2692"),T(),b(390,"div",114),v(391),T()(),b(392,"div",111),v(393,"\u2192"),T(),b(394,"div",108)(395,"div",109),v(396,"\u{1F9F1}"),T(),b(397,"div",115),v(398),T()()()(),b(399,"div",16)(400,"div",116),v(401),T(),b(402,"div",117)(403,"div",3),B(404,"div",118),b(405,"div",20),v(406),T()(),b(407,"div",3),B(408,"div",119),b(409,"div",20),v(410),T()(),b(411,"div",3),B(412,"div",120),b(413,"div",20),v(414,"Neutral"),T()()()()(),b(415,"div",121)(416,"div",122)(417,"div",9),v(418),T(),b(419,"div",123),X(),b(420,"svg",124)(421,"g"),B(422,"polygon",125),T(),b(423,"text",126),v(424),T()(),b(425,"svg",124)(426,"g"),B(427,"polygon",125),T(),b(428,"text",126),v(429),T(),Y(430,fG,1,0,":svg:polygon",127),T(),b(431,"svg",124)(432,"g"),B(433,"polygon",125),T(),b(434,"text",126),v(435),T(),Y(436,pG,1,0,":svg:polygon",127),Y(437,gG,2,0,":svg:g"),T(),b(438,"svg",124)(439,"g"),B(440,"polygon",125),T(),b(441,"text",126),v(442),T(),Y(443,mG,1,0,":svg:polygon",127),Y(444,yG,2,0,":svg:g"),Y(445,vG,4,0,":svg:g"),T()()()(),Ne(),b(446,"div",16)(447,"div",9),v(448),T(),b(449,"div",17),X(),b(450,"svg",128),B(451,"g",129)(452,"g",130)(453,"g",131)(454,"g",132)(455,"g",133),b(456,"g",129),B(457,"circle",134),T(),b(458,"g",130),B(459,"circle",135),T(),b(460,"g",131),B(461,"circle",136),T(),b(462,"g",132),B(463,"line",137)(464,"circle",138),T(),b(465,"g",133),B(466,"circle",139),T()(),Ne(),b(467,"div",140),X(),b(468,"svg",141)(469,"g"),B(470,"polygon",125),T(),b(471,"g"),B(472,"circle",142),T(),b(473,"g"),B(474,"polygon",143)(475,"polygon",144)(476,"polygon",145),T(),b(477,"g"),B(478,"polygon",146)(479,"polygon",147),T(),b(480,"g"),B(481,"polygon",148)(482,"polygon",149)(483,"polygon",150)(484,"polygon",151),T()()(),b(485,"svg",128),B(486,"g",152)(487,"g",153)(488,"g",154)(489,"g",155)(490,"g",156)(491,"g",157),b(492,"g",152),B(493,"rect",158),T(),b(494,"g",153),B(495,"rect",159),T(),b(496,"g",154),B(497,"rect",160),T(),b(498,"g",155),B(499,"rect",161)(500,"rect",162),T(),b(501,"g",156),B(502,"rect",163)(503,"rect",164)(504,"rect",165)(505,"rect",166)(506,"rect",167),T()(),b(507,"svg",128),B(508,"g",168)(509,"g",153)(510,"g",169)(511,"g",170)(512,"g",133),b(513,"g",168),B(514,"polygon",171),T(),b(515,"g",153),B(516,"circle",172),T(),b(517,"g",169),B(518,"line",173)(519,"line",174)(520,"line",175),T(),b(521,"g",170),B(522,"polygon",176)(523,"circle",177)(524,"circle",178)(525,"circle",179),T(),b(526,"g",133),B(527,"polygon",180),T()()()(),Ne(),b(528,"div",181)(529,"div",9),v(530),T(),b(531,"div",182),X(),b(532,"svg",183)(533,"g"),B(534,"circle",184),T(),b(535,"g"),B(536,"circle",185),T()(),b(537,"svg",183)(538,"g"),B(539,"circle",184),T(),b(540,"g"),B(541,"circle",185),T(),b(542,"g"),B(543,"circle",186),T()(),b(544,"svg",183)(545,"g"),B(546,"circle",184),T(),b(547,"g"),B(548,"circle",185),T(),b(549,"g"),B(550,"circle",186),T(),b(551,"g"),B(552,"line",187)(553,"circle",188),T()(),b(554,"svg",183)(555,"g"),B(556,"circle",184),T(),b(557,"g"),B(558,"circle",185),T(),b(559,"g"),B(560,"circle",186),T(),b(561,"g"),B(562,"line",187)(563,"circle",188),T(),b(564,"g"),B(565,"circle",189),T()()(),Ne(),b(566,"div",190),X(),b(567,"svg",191)(568,"g"),B(569,"polygon",125),T(),b(570,"g"),B(571,"circle",142),T()(),b(572,"svg",191)(573,"g"),B(574,"polygon",125),T(),b(575,"g"),B(576,"circle",142),T(),b(577,"g"),B(578,"polygon",143)(579,"polygon",144)(580,"polygon",145),T()(),b(581,"svg",191)(582,"g"),B(583,"polygon",125),T(),b(584,"g"),B(585,"circle",142),T(),b(586,"g"),B(587,"polygon",143)(588,"polygon",144)(589,"polygon",145),T(),b(590,"g"),B(591,"polygon",146)(592,"polygon",147),T()(),b(593,"svg",141)(594,"g"),B(595,"polygon",125),T(),b(596,"g"),B(597,"circle",142),T(),b(598,"g"),B(599,"polygon",143)(600,"polygon",144)(601,"polygon",145),T(),b(602,"g"),B(603,"polygon",146)(604,"polygon",147),T(),b(605,"g"),B(606,"polygon",148)(607,"polygon",149)(608,"polygon",150)(609,"polygon",151),T()()(),Ne(),b(610,"div",182),X(),b(611,"svg",192)(612,"g"),B(613,"rect",193),T(),b(614,"g"),B(615,"rect",194),T()(),b(616,"svg",192)(617,"g"),B(618,"rect",193),T(),b(619,"g"),B(620,"rect",194),T(),b(621,"g"),B(622,"rect",195),T()(),b(623,"svg",192)(624,"g"),B(625,"rect",193),T(),b(626,"g"),B(627,"rect",194),T(),b(628,"g"),B(629,"rect",195),T(),b(630,"g"),B(631,"rect",196)(632,"rect",197),T()(),b(633,"svg",192)(634,"g"),B(635,"rect",193),T(),b(636,"g"),B(637,"rect",194),T(),b(638,"g"),B(639,"rect",195),T(),b(640,"g"),B(641,"rect",196)(642,"rect",197),T(),b(643,"g"),B(644,"rect",198)(645,"rect",199)(646,"rect",200)(647,"rect",201)(648,"rect",202),T()()(),Ne(),b(649,"div",190),X(),b(650,"svg",183)(651,"g"),B(652,"polygon",203),T(),b(653,"g"),B(654,"circle",204),T()(),b(655,"svg",183)(656,"g"),B(657,"polygon",203),T(),b(658,"g"),B(659,"circle",204),T(),b(660,"g"),B(661,"line",205)(662,"line",206)(663,"line",207),T()(),b(664,"svg",183)(665,"g"),B(666,"polygon",203),T(),b(667,"g"),B(668,"circle",204),T(),b(669,"g"),B(670,"line",205)(671,"line",206)(672,"line",207),T(),b(673,"g"),B(674,"polygon",208)(675,"circle",209)(676,"circle",210)(677,"circle",211),T()(),b(678,"svg",183)(679,"g"),B(680,"polygon",203),T(),b(681,"g"),B(682,"circle",204),T(),b(683,"g"),B(684,"line",205)(685,"line",206)(686,"line",207),T(),b(687,"g"),B(688,"polygon",208)(689,"circle",209)(690,"circle",210)(691,"circle",211),T(),b(692,"g"),B(693,"polygon",212),T()()()()()()()),t&2&&(y(5),W(i.settings.t("GAME_GUIDE")),y(2),W(i.settings.t("TURN_BASED_STRATEGY")),y(6),W(i.settings.t("VICTORY_CONDITIONS")),y(7),W(i.settings.t("MONOPOLY_LABEL")),y(2),W(i.settings.t("MONOPOLY_DESC")),y(6),W(i.settings.t("ANNIHILATION")),y(2),W(i.settings.t("ANNIHILATION_DESC")),y(4),W(i.settings.t("UNIT_EVOLUTION")),y(8),rt("clip-path","polygon(50% 0%, 0% 100%, 100% 100%)"),y(17),W(i.settings.t("EVOLUTION_DESC")),y(13),H(" ",i.settings.currentLang()==="uk"?"\u0422\u0430\u043A\u0442\u0438\u0447\u043D\u0435 \u0443\u043F\u0440\u0430\u0432\u043B\u0456\u043D\u043D\u044F":"Tactical Controls"," "),y(9),H(" ",i.settings.currentLang()==="uk"?"\u041D\u0430\u0441\u0442\u0443\u043F\u043D\u0438\u0439 \u0432\u0456\u043B\u044C\u043D\u0438\u0439 \u044E\u043D\u0456\u0442":"Cycle through available units"," "),y(13),H(" ",i.settings.currentLang()==="uk"?"\u0420\u0443\u0445 \u0430\u0431\u043E \u0430\u0442\u0430\u043A\u0430 \u0432\u0438\u0431\u0440\u0430\u043D\u0438\u043C \u044E\u043D\u0456\u0442\u043E\u043C":"Move or attack with selected unit"," "),y(5),H(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0445\u0456\u0434":"End player turn"," "),y(4),H(" ",i.settings.currentLang()==="uk"?"\u041D\u0430 \u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043A\u043E\u0436\u043D\u043E\u0433\u043E \u0445\u043E\u0434\u0443 \u0433\u0440\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u0444\u043E\u043A\u0443\u0441\u0443\u0454\u0442\u044C\u0441\u044F \u043D\u0430 \u043C\u043E\u0431\u0456\u043B\u044C\u043D\u043E\u043C\u0443 \u044E\u043D\u0456\u0442\u0456.":"At turn start, the game auto-focuses on your most mobile unit."," "),y(3),W(i.settings.t("COMBAT_DEEP_DIVE")),y(4),W(i.settings.t("SUCCESSFUL_ATTACK")),y(7),W(i.settings.t("SUCCESSFUL_ATTACK_DESC")),y(3),W(i.settings.t("CRITICAL_HIT")),y(9),W(i.settings.t("CRITICAL_HIT_DESC")),y(3),W(i.settings.t("MISS")),y(9),W(i.settings.t("MISS_DESC")),y(4),H(" ",i.settings.currentLang()==="uk"?"\u0414\u043E\u0434\u0430\u0442\u043A\u043E\u0432\u0456 \u043C\u0435\u0445\u0430\u043D\u0456\u043A\u0438":"Extra Mechanics"," "),y(6),H(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043A\u0440\u0438\u0442\u0443":"Crit Chance"," "),y(5),H(" ",i.settings.currentLang()==="uk"?"\u0428\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u0443":"Miss Chance"," "),y(7),H(" ",i.settings.currentLang()==="uk"?"\u043F\u0440\u0438 \u0440\u0456\u0432\u043D\u0438\u0445 \u0441\u0438\u043B\u0430\u0445: \u0417\u0430\u0445\u0438\u0441\u0442/\u041D\u0456\u0447\u0438\u044F":"at equal force: Defense/Draw"," "),y(5),Lt("fill","url(#vol-fill-player)"),y(10),H(" ",i.settings.currentLang()==="uk"?"-10% \u0443 \u0432\u043E\u0440\u043E\u0433\u0430 \u0448\u0430\u043D\u0441 \u043F\u0440\u043E\u043C\u0430\u0445\u043D\u0443\u0442\u0438\u0441\u044C":"-10% enemy chance to miss"," "),y(4),Lt("fill","url(#vol-fill-player)"),y(11),H(" ",i.settings.currentLang()==="uk"?"10% \u0448\u0430\u043D\u0441 \u043F\u043E\u043F\u0430\u0441\u0442\u0438 \u043F\u043E \u0432\u043E\u0440\u043E\u0433\u0443":"10% chance to hit the enemy"," "),y(4),H(" ",i.settings.currentLang()==="uk"?"\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F Tier-\u0440\u0456\u0432\u043D\u0456\u0432":"Tier Values"," "),y(25),Lt("fill","url(#vol-fill-player)"),y(9),H(" ",i.settings.currentLang()==="uk"?"+1 \u0434\u043E \u0430\u0442\u0430\u043A\u0438 \u0432\u0456\u0434 \u0441\u0443\u0441\u0456\u0434\u0441\u0442\u0432\u0430":"+1 to an attack from the neighborhood"," "),y(3),W(i.settings.t("MOVEMENT")),y(4),W(i.settings.t("T1_1_TILE")),y(30),rt("left",6,"px")("top",6,"px"),y(4),W(i.settings.t("T3_3_TILES")),y(30),rt("right",6,"px")("bottom",6,"px"),y(4),W(i.settings.t("T4_4_TILES")),y(30),rt("left",6,"px")("top",6,"px"),y(5),W(i.settings.t("FOREST_CYCLE")),y(6),W(i.settings.t("TURN_1")),y(7),W(i.settings.t("TURN_2")),y(7),W(i.settings.t("PLUS_8_WOOD_PER_TURN")),y(3),W(i.settings.t("IRON_CYCLE")),y(6),W(i.settings.t("TURN_1")),y(7),W(i.settings.t("TURN_2")),y(7),W(i.settings.t("TURN_3")),y(7),W(i.settings.t("TURN_4")),y(7),W(i.settings.t("PLUS_2_IRON_PER_TURN")),y(3),W(i.settings.t("WALL_LEGEND")),y(5),W(i.settings.t("PLAYER")),y(4),W(i.settings.t("AI_FACTION")),y(8),H(" ",i.settings.currentLang()==="uk"?"\u0422\u0440\u0435\u0442\u044F \u0456\u0442\u0435\u0440\u0430\u0446\u0456\u044F \u043E\u0434\u0438\u043D\u0438\u0446\u044C":"Third iteration the units"," "),y(6),H(" ",1," "),y(5),H(" ",2," "),y(),Q(430),y(5),H(" ",3," "),y(),Q(436),y(),Q(437),y(5),H(" ",4," "),y(),Q(443),y(),Q(444),y(),Q(445),y(3),W(i.settings.t("NEW_DESIGN_UNIT")),y(82),W(i.settings.t("NEW_UNIT_EVOLUTION")))},dependencies:[jt],styles:[`*,*:before,*:after{box-sizing:border-box}.merge-loop{position:relative;width:160px;height:80px}.merge-loop .unit{position:absolute;top:20px;display:flex;align-items:center;justify-content:center;width:40px;height:40px;clip-path:polygon(50% 0%,0% 100%,100% 100%);font-weight:700}.merge-loop .u1{left:10px;background:#3b82f6;color:#fff;animation:u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop .u2{right:10px;background:#3b82f6;color:#fff;animation:u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop .result{position:absolute;left:36%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:resultAppear 1.6s ease-in-out infinite alternate,tremble .18s ease-in-out .7s infinite}@keyframes resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.05)}to{opacity:0;transform:translate(-50%) scale(.8)}}.shake{animation:tremble .18s ease-in-out 0s 1 normal forwards}@keyframes tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash{animation:hitFlash .3s ease-out 1}@keyframes hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.combat-stage{position:relative;width:192px;height:60px;background:#11182799;border:1px solid #374151;border-radius:8px;overflow:hidden}.attacker,.defender{position:absolute;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-weight:700}.square{aspect-ratio:1 / 1;right:12px;top:36px;background:#3b82f6;color:#fff}.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);left:12px;top:36px;animation:attackMove .9s ease-in-out infinite alternate}.circle{background:#3b82f6;color:#fff;border-radius:9999px;right:16px;top:36px}@keyframes attackMove{0%{transform:translate(0)}to{transform:translate(100px)}}.defender-fade{animation:defenderFade 1.8s ease-in-out infinite}@keyframes defenderFade{0%{opacity:1}60%{opacity:1}to{opacity:.2}}.crit-pop{position:absolute;right:16px;top:10px;font-size:12px;font-weight:800;color:#fde047;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:critFloat 1.8s ease-in-out infinite}@keyframes critFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.miss-pop{position:absolute;right:20px;top:10px;font-size:12px;font-weight:800;color:#93c5fd;text-shadow:0 2px 4px rgba(0,0,0,.5);animation:missFloat 1.8s ease-in-out infinite}@keyframes missFloat{0%{transform:translateY(0);opacity:0}30%{transform:translateY(-6px);opacity:1}to{transform:translateY(-12px);opacity:0}}.path-grid{position:relative;width:160px;height:160px;display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:4px;background:#11182799;border:1px solid #374151;border-radius:8px;--grid-px: 160px;--grid-gap: 4px;--cols: 5;--cell: calc((var(--grid-px) - (var(--grid-gap) * (var(--cols) - 1))) / var(--cols));--step: calc(var(--cell) + var(--grid-gap));--center-offset: calc(var(--cell) / 2 - 12px)}.path-cell{background:#111827;border-radius:4px;border:1px solid #374151}.path-cell.active{background:#0f766e;border-color:#14b8a6}.mover{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 0 0 2px #0000004d}.mover.circle{border-radius:50%;background:#3b82f6;color:#fff}.mover.triangle{background:#ef4444;color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%)}.t1-path{left:0;top:0;animation:t1Path 1.6s ease-in-out infinite alternate}@keyframes t1Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}}.t3-path{left:-2px;top:0;animation:t3Path 3.2s ease-in-out infinite}@keyframes t3Path{0%{transform:translate(calc(var(--start-x) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}33%{transform:translate(calc((var(--start-x) + 1) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}66%{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc(var(--start-y) * var(--step) + var(--center-offset)))}to{transform:translate(calc((var(--start-x) + 2) * var(--step) + var(--center-offset)),calc((var(--start-y) + 1) * var(--step) + var(--center-offset)))}}.path-line{position:absolute;height:4px;left:calc(var(--start-x) * var(--step) + (var(--cell) / 2));top:calc(var(--start-y) * var(--step) + (var(--cell) / 2) - 2px);width:calc(var(--line-steps) * var(--step));background-image:repeating-linear-gradient(to right,rgba(20,184,166,.9) 0,rgba(20,184,166,.9) 6px,transparent 6px,transparent 12px);border-radius:2px}.path-animation{animation:pathDraw 1.6s ease-in-out infinite alternate}@keyframes pathDraw{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}.castle{position:absolute;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:6px;background:#3b82f633;color:#93c5fd;filter:drop-shadow(0 0 8px rgba(59,130,246,.8))}.castle.red{background:#ef444433;color:#fca5a5;filter:drop-shadow(0 0 8px rgba(239,68,68,.8))}.unit-svg-wrapper-game_rules:hover{transform:scale(1)}
`],encapsulation:2})};var c0=class n{constructor(e){this.gameEngine=e}openExternalLink(e){let t=window.open(e,"_blank","noopener,noreferrer");t&&t.focus()}static \u0275fac=function(t){return new(t||n)(ge(ii))};static \u0275cmp=Dt({type:n,selectors:[["app-support-community"]],decls:51,vars:0,consts:[[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[880px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"text-sm","text-gray-300","mb-2","font-medium"],[1,"flex","items-start","gap-4"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","border","border-gray-300","flex","items-center","justify-center","shrink-0"],["src","https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://send.monobank.ua/jar/2fqGoPhV7G","alt","QR Code","referrerpolicy","no-referrer",1,"w-full","h-full"],[1,"flex-1"],[1,"text-[10px]","text-gray-400","mb-2","break-all","font-mono"],[1,"flex","flex-col","gap-2"],[1,"px-4","py-2","rounded-lg","bg-blue-600","hover:bg-blue-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-gray-700","hover:bg-gray-600","text-white","text-sm","cursor-pointer","transition-colors",3,"click"],[1,"mt-6","border-t","border-gray-700","pt-4"],[1,"w-full","px-4","py-2","rounded-lg","bg-indigo-600","hover:bg-indigo-500","text-white","text-sm","font-bold","cursor-pointer","transition-colors",3,"click"],[1,"text-xs","text-emerald-400","mt-4","font-medium","italic"],[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-[#5865F2]","hover:brightness-110","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"],[1,"text-xl"],[1,"text-left"],[1,"leading-none"],[1,"text-[10px]","font-normal","opacity-80","mt-1"],[1,"flex","items-center","justify-start","gap-3","px-4","py-3","rounded-lg","bg-red-600","hover:bg-red-500","text-white","text-sm","font-bold","cursor-pointer","transition-all",3,"click"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),v(4,"Support & Community"),T(),b(5,"button",4),et("click",function(){return i.gameEngine.closeSupport()}),v(6," \u2716 "),T()(),b(7,"div",5)(8,"div",6)(9,"div",7),v(10,"Donate"),T(),b(11,"div",8),v(12,"Monobank Jar"),T(),b(13,"div",9)(14,"div",10),B(15,"img",11),T(),b(16,"div",12)(17,"div",13),v(18,"send.monobank.ua/jar/2fqGoPhV7G"),T(),b(19,"div",14)(20,"button",15),et("click",function(){return i.openExternalLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(21," Open Link \u{1F4DC} "),T(),b(22,"button",16),et("click",function(){return i.gameEngine.copySupportLink("https://send.monobank.ua/jar/2fqGoPhV7G")}),v(23," Copy Link \u{1F4CB} "),T()()()(),b(24,"div",17)(25,"div",8),v(26,"Donatello"),T(),b(27,"button",18),et("click",function(){return i.openExternalLink("https://donatello.to/jaerbi")}),v(28," Go to Donatello.to \u{1F48E} "),T()(),b(29,"div",19),v(30,"Thank you for supporting the project!"),T()(),b(31,"div",6)(32,"div",7),v(33,"Social & Feedback"),T(),b(34,"div",20)(35,"button",21),et("click",function(){return i.openExternalLink("https://discord.gg/c9tCWFtFaG")}),b(36,"span",22),v(37,"\u{1F5E8}\uFE0F"),T(),b(38,"div",23)(39,"div",24),v(40,"Discord Server"),T(),b(41,"div",25),v(42,"Share ideas & feedback"),T()()(),b(43,"button",26),et("click",function(){return i.openExternalLink("https://www.youtube.com/@jaerb1")}),b(44,"span",22),v(45,"\u25B6\uFE0F"),T(),b(46,"div",23)(47,"div",24),v(48,"YouTube"),T(),b(49,"div",25),v(50,"Dev logs & gameplay"),T()()()()()()()())},dependencies:[jt],encapsulation:2})};function _G(n,e){if(n&1){let t=Je();E(0,"button",7),ce("click",function(){ie(t);let r=O();return re(r.switchToMyStats())}),v(1," My Statistics "),x()}if(n&2){let t=O();Pe("text-white",t.activeTab()==="mystats")("border-b-2",t.activeTab()==="mystats")("border-indigo-500",t.activeTab()==="mystats")}}function EG(n,e){n&1&&(E(0,"div",15)(1,"span",16),K(2,"span",17),E(3,"span"),v(4,"Loading..."),x()()())}function bG(n,e){if(n&1&&K(0,"img",27),n&2){let t=O().$implicit;$e("src",t.userPhoto,Zi)}}function wG(n,e){n&1&&(E(0,"div",28),v(1,"\u{1F464}"),x())}function xG(n,e){if(n&1&&(E(0,"tr",22)(1,"td",23),v(2),x(),E(3,"td",24),mi(4,bG,1,1,"img",25)(5,wG,2,0,"ng-template",null,0,uE),v(7),x(),E(8,"td",23),v(9),x(),E(10,"td",26),v(11),x()()),n&2){let t=e.$implicit,i=e.index,r=ku(6),o=O(3);Pe("bg-indigo-900/40",o.isCurrentPlayer(t))("border",o.isCurrentPlayer(t))("border-indigo-500",o.isCurrentPlayer(t)),y(2),W(i+1),y(2),$e("ngIf",t.userPhoto)("ngIfElse",r),y(3),H(" ",t.playerName," "),y(2),W(t.victoryType),y(2),W(t.turnsPlayed)}}function SG(n,e){if(n&1&&(E(0,"tr")(1,"td",29),v(2),K(3,"br"),E(4,"span",30),v(5,"Be the first to claim victory!"),x()()()),n&2){let t=O(3);y(2),tn(" No scores found for ",t.settings.difficultyLabel()," / ",t.settings.mapSizeLabel()," yet. ")}}function IG(n,e){if(n&1&&(E(0,"div")(1,"table",18)(2,"thead")(3,"tr",19)(4,"th",20),v(5,"Rank"),x(),E(6,"th",20),v(7,"Name"),x(),E(8,"th",20),v(9,"Victory Type"),x(),E(10,"th",20),v(11,"Turns"),x()()(),E(12,"tbody"),mi(13,xG,12,12,"tr",21)(14,SG,6,2,"tr",9),x()()()),n&2){let t=O(2);y(13),$e("ngForOf",t.scores()),y(),$e("ngIf",t.scores().length===0)}}function TG(n,e){if(n&1&&(E(0,"div")(1,"div",11)(2,"span"),v(3,"Top 10 scores for:"),x(),E(4,"span",12),v(5),x(),E(6,"span",13),v(7),x()(),mi(8,EG,5,0,"div",14)(9,IG,15,2,"div",9),x()),n&2){let t=O();y(5),H(" ",t.settings.difficultyLabel()," "),y(2),H(" ",t.settings.mapSizeLabel()," "),y(),$e("ngIf",t.loading()),y(),$e("ngIf",!t.loading())}}function CG(n,e){n&1&&(E(0,"div",15)(1,"span",16),K(2,"span",17),E(3,"span"),v(4,"Loading your stats..."),x()()())}function DG(n,e){n&1&&(E(0,"div",35),v(1," No victories recorded yet. keep playing! "),x())}function AG(n,e){if(n&1&&(E(0,"div",36)(1,"div",37)(2,"span",38),v(3),x(),E(4,"span",39),v(5),x()(),E(6,"div",40)(7,"span",41),v(8,"Best Performance"),x(),E(9,"span",42),v(10),x()(),E(11,"div",43),v(12),Ar(13,"date"),x()()),n&2){let t=e.$implicit;y(3),H(" ",t.difficulty," "),y(2),H(" ",t.mapSize," "),y(5),H("",t.turnsPlayed," Turns"),y(2),tn(" ",t.victoryType," \u2022 ",oo(13,5,t.timestamp,"mediumDate")," ")}}function MG(n,e){if(n&1&&(E(0,"div",32),mi(1,DG,2,0,"div",33)(2,AG,14,8,"div",34),x()),n&2){let t=O(2);y(),$e("ngIf",t.myBestScores().length===0),y(),$e("ngForOf",t.myBestScores())}}function RG(n,e){if(n&1&&(E(0,"div",22),mi(1,CG,5,0,"div",14)(2,MG,3,2,"div",31),x()),n&2){let t=O();y(),$e("ngIf",t.loading()),y(),$e("ngIf",!t.loading())}}var u0=class n{constructor(e,t,i,r){this.firebase=e;this.gameEngine=t;this.playerName=i;this.settings=r;this.fetch()}loading=G(!0);scores=G([]);activeTab=G("top10");myBestScores=G([]);async fetch(){this.loading.set(!0);try{let e=this.settings.difficulty(),t=this.settings.mapSize(),i=await this.firebase.getTopScores(10,e,t);this.scores.set(i??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}async switchToMyStats(){this.activeTab.set("mystats"),this.loading.set(!0);let e=this.firebase.user$();if(!e){this.myBestScores.set([]),this.loading.set(!1);return}try{let t=await this.firebase.getUserScores(e.uid),i=new Map;t.forEach(r=>{let o=`${r.difficulty}-${r.mapSize}`;(!i.has(o)||r.turnsPlayed<i.get(o).turnsPlayed)&&i.set(o,r)}),this.myBestScores.set(Array.from(i.values()).sort((r,o)=>{let s={baby:0,normal:1,hard:2,nightmare:3},a=s[o.difficulty]-s[r.difficulty];return a!==0?a:r.mapSize-o.mapSize}))}catch(t){console.error(t),this.myBestScores.set([])}finally{this.loading.set(!1)}}isCurrentPlayer(e){return(e?.playerName??"")===this.playerName.name()}static \u0275fac=function(t){return new(t||n)(ge(jn),ge(ii),ge(mc),ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-leaderboard-modal"]],decls:13,vars:9,consts:[["noPhoto",""],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-gray-900","border","border-gray-700","rounded-lg","p-6","w-[720px]","max-w-[95vw]","mx-4","shadow-xl"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-white","text-lg","cursor-pointer",3,"click"],[1,"flex","border-b","border-gray-700","mb-4"],[1,"px-4","py-2","text-sm","font-medium","text-gray-400","hover:text-gray-200","transition-colors",3,"click"],["class","px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors",3,"text-white","border-b-2","border-indigo-500","click",4,"ngIf"],[4,"ngIf"],["class","text-white",4,"ngIf"],[1,"text-sm","text-gray-300","mb-3","flex","items-center","gap-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","font-semibold","border","border-indigo-700"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","font-semibold","border","border-emerald-700"],["class","min-h-24 flex items-center justify-center",4,"ngIf"],[1,"min-h-24","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-gray-300"],[1,"w-4","h-4","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-gray-300"],[1,"text-left","py-2","px-2","border-b","border-gray-700"],["class","text-white",3,"bg-indigo-900/40","border","border-indigo-500",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-gray-800"],[1,"py-2","px-2","border-b","border-gray-800","flex","items-center","gap-2"],["referrerpolicy","no-referrer","class","w-6 h-6 rounded-full border border-gray-600",3,"src",4,"ngIf","ngIfElse"],[1,"py-2","px-2","border-b","border-gray-800","font-mono","text-yellow-300"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","border","border-gray-600",3,"src"],[1,"w-6","h-6","rounded-full","bg-gray-700","flex","items-center","justify-center","text-xs","text-gray-400","border","border-gray-600"],["colspan","4",1,"py-8","text-center","text-gray-400","italic"],[1,"text-xs","opacity-75"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","col-span-2 text-center py-8 text-gray-400",4,"ngIf"],["class","bg-gray-800/50 p-4 rounded border border-gray-700",4,"ngFor","ngForOf"],[1,"col-span-2","text-center","py-8","text-gray-400"],[1,"bg-gray-800/50","p-4","rounded","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-2"],[1,"px-2","py-0.5","rounded","bg-indigo-900","text-indigo-100","text-xs","font-semibold","border","border-indigo-700","uppercase","tracking-wide"],[1,"px-2","py-0.5","rounded","bg-emerald-900","text-emerald-100","text-xs","font-semibold","border","border-emerald-700"],[1,"flex","justify-between","items-end"],[1,"text-gray-400","text-sm"],[1,"text-xl","font-mono","text-yellow-300"],[1,"mt-1","text-xs","text-gray-500"]],template:function(t,i){t&1&&(E(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),v(4,"Leaderboard"),x(),E(5,"button",5),ce("click",function(){return i.gameEngine.closeLeaderboard()}),v(6," \u2716 "),x()(),E(7,"div",6)(8,"button",7),ce("click",function(){return i.activeTab.set("top10")}),v(9," Top 10 "),x(),mi(10,_G,2,6,"button",8),x(),mi(11,TG,10,4,"div",9)(12,RG,3,2,"div",10),x()()),t&2&&(y(8),Pe("text-white",i.activeTab()==="top10")("border-b-2",i.activeTab()==="top10")("border-indigo-500",i.activeTab()==="top10"),y(2),$e("ngIf",i.firebase.user$()),y(),$e("ngIf",i.activeTab()==="top10"),y(),$e("ngIf",i.activeTab()==="mystats"))},dependencies:[jt,Il,zu,da],encapsulation:2})};function NG(n,e){if(n&1&&(X(),b(0,"text",4),v(1),T()),n&2){let t=O(2);y(),H(" ",t.unit.level," ")}}function PG(n,e){n&1&&(X(),b(0,"g"),B(1,"path",10)(2,"path",11),T())}function kG(n,e){n&1&&(X(),b(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),T())}function OG(n,e){n&1&&(X(),b(0,"g",6),B(1,"path",15)(2,"path",16),T())}function FG(n,e){n&1&&(X(),B(0,"circle",7))}function LG(n,e){n&1&&(X(),B(0,"circle",8))}function VG(n,e){n&1&&(X(),B(0,"circle",9))}function UG(n,e){if(n&1&&(X(),b(0,"svg",0),B(1,"circle",2)(2,"circle",3),Y(3,NG,2,1,":svg:text",4),Y(4,PG,3,0,":svg:g"),Y(5,kG,4,0,":svg:g",5),Y(6,OG,3,0,":svg:g",6),Y(7,FG,1,0,":svg:circle",7),Y(8,LG,1,0,":svg:circle",8),Y(9,VG,1,0,":svg:circle",9),T()),n&2){let t=O();y(),Lt("fill","url(#vol-fill-"+t.unit.owner+")"),y(2),Q(t.isTower?-1:3),y(),Q(t.gameEngine.hasDefenseBonus(t.unit)&&!t.isTower?4:-1),y(),Q(t.unit.hasWeapon?5:-1),y(),Q(t.unit.hasArmor?6:-1),y(),Q(t.unit.level>=2?7:-1),y(),Q(t.unit.level>=3?8:-1),y(),Q(t.unit.level>=4?9:-1)}}function BG(n,e){if(n&1&&(X(),b(0,"text",20),v(1),T()),n&2){let t=O(2);y(),H(" ",t.unit.level," ")}}function jG(n,e){n&1&&(X(),b(0,"g"),B(1,"path",10)(2,"path",11),T())}function HG(n,e){n&1&&(X(),b(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),T())}function $G(n,e){n&1&&(X(),b(0,"g",6),B(1,"path",15)(2,"path",16),T())}function GG(n,e){n&1&&(X(),B(0,"polygon",21))}function zG(n,e){n&1&&(X(),B(0,"polygon",22))}function WG(n,e){n&1&&(X(),b(0,"g"),B(1,"polygon",23)(2,"polygon",24)(3,"polygon",25),T())}function qG(n,e){if(n&1&&(X(),b(0,"svg",1)(1,"g",17),B(2,"polygon",18)(3,"polygon",19),Y(4,BG,2,1,":svg:text",20),Y(5,jG,3,0,":svg:g"),Y(6,HG,4,0,":svg:g",5),Y(7,$G,3,0,":svg:g",6),Y(8,GG,1,0,":svg:polygon",21),Y(9,zG,1,0,":svg:polygon",22),Y(10,WG,4,0,":svg:g"),T()()),n&2){let t=O();y(2),Lt("fill","url(#vol-fill-"+t.unit.owner+")"),y(2),Q(t.isTower?-1:4),y(),Q(t.gameEngine.hasDefenseBonus(t.unit)?5:-1),y(),Q(t.unit.hasWeapon?6:-1),y(),Q(t.unit.hasArmor?7:-1),y(),Q(t.unit.level>=2?8:-1),y(),Q(t.unit.level>=3?9:-1),y(),Q(t.unit.level>=4?10:-1)}}function KG(n,e){if(n&1&&(X(),b(0,"text",28),v(1),T()),n&2){let t=O(2);y(),H(" ",t.unit.level," ")}}function YG(n,e){n&1&&(X(),b(0,"g"),B(1,"path",10)(2,"path",11),T())}function QG(n,e){n&1&&(X(),b(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),T())}function JG(n,e){n&1&&(X(),b(0,"g",6),B(1,"path",15)(2,"path",16),T())}function ZG(n,e){n&1&&(X(),B(0,"rect",29))}function XG(n,e){n&1&&(X(),B(0,"rect",30))}function ez(n,e){n&1&&(X(),B(0,"rect",31)(1,"rect",32)(2,"rect",33)(3,"rect",34))}function tz(n,e){if(n&1&&(X(),b(0,"svg",0),B(1,"rect",26)(2,"rect",27),Y(3,KG,2,1,":svg:text",28),Y(4,YG,3,0,":svg:g"),Y(5,QG,4,0,":svg:g",5),Y(6,JG,3,0,":svg:g",6),Y(7,ZG,1,0,":svg:rect",29),Y(8,XG,1,0,":svg:rect",30),Y(9,ez,4,0),T()),n&2){let t=O();y(),Lt("fill","url(#vol-fill-"+t.unit.owner+")"),y(2),Q(t.isTower?-1:3),y(),Q(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),y(),Q(t.unit.hasWeapon?5:-1),y(),Q(t.unit.hasArmor?6:-1),y(),Q(t.unit.level>=2?7:-1),y(),Q(t.unit.level>=3?8:-1),y(),Q(t.unit.level>=4?9:-1)}}function nz(n,e){if(n&1&&(X(),b(0,"text",37),v(1),T()),n&2){let t=O(2);y(),H(" ",t.unit.level," ")}}function iz(n,e){n&1&&(X(),b(0,"g"),B(1,"path",10)(2,"path",11),T())}function rz(n,e){n&1&&(X(),b(0,"g",5),B(1,"rect",12)(2,"polygon",13)(3,"rect",14),T())}function oz(n,e){n&1&&(X(),b(0,"g",6),B(1,"path",15)(2,"path",16),T())}function sz(n,e){n&1&&(X(),B(0,"polygon",38))}function az(n,e){n&1&&(X(),B(0,"polygon",39))}function lz(n,e){n&1&&(X(),B(0,"circle",40)(1,"circle",41)(2,"circle",42)(3,"circle",43)(4,"circle",44)(5,"circle",45))}function cz(n,e){if(n&1&&(X(),b(0,"svg",0),B(1,"polygon",35)(2,"polygon",36),Y(3,nz,2,1,":svg:text",37),Y(4,iz,3,0,":svg:g"),Y(5,rz,4,0,":svg:g",5),Y(6,oz,3,0,":svg:g",6),Y(7,sz,1,0,":svg:polygon",38),Y(8,az,1,0,":svg:polygon",39),Y(9,lz,6,0),T()),n&2){let t=O();y(),Lt("fill","url(#vol-fill-"+t.unit.owner+")"),y(2),Q(t.isTower?-1:3),y(),Q(t.gameEngine.hasDefenseBonus(t.unit)?4:-1),y(),Q(t.unit.hasWeapon?5:-1),y(),Q(t.unit.hasArmor?6:-1),y(),Q(t.unit.level>=2?7:-1),y(),Q(t.unit.level>=3?8:-1),y(),Q(t.unit.level>=4?9:-1)}}var d0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}unit;isTower=!1;static \u0275fac=function(t){return new(t||n)(ge(ii),ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-units"]],inputs:{unit:"unit",isTower:"isTower"},decls:4,vars:1,consts:[["viewBox","0 0 100 100",1,"w-full","h-full"],["viewBox","0 0 100 100",1,"w-full","h-full","scale-95"],["cx","50","cy","50","r","32","filter","url(#soft-shadow)"],["cx","50","cy","50","r","31","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","61","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["transform","rotate(-45 30 14)"],["transform","translate(16, 2)"],["cx","50","cy","50","r","35","fill","none","stroke","var(--u-stroke)","stroke-width","2"],["cx","50","cy","50","r","40","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["cx","50","cy","50","r","28","fill","none","stroke","var(--u-light)","stroke-width","2"],["d","M0,0 L12,0 L12,8 C12,12 6,16 6,16 C6,16 0,12 0,8 Z","fill","var(--u-light)","opacity","0.9"],["d","M6,2 V12","stroke","var(--u-fill)","stroke-width","1","opacity","0.9"],["x","5","y","0","width","2","height","10","fill","var(--u-light)"],["points","6,-2 8,2 4,2","fill","var(--u-light)"],["x","3","y","10","width","6","height","2","fill","var(--u-fill)"],["d","M0 1.5C3 1.5 4.5 0 6 0C7.5 0 9 1.5 12 1.5C12 5 12 7.5 6 11C0 7.5 0 5 0 1.5Z","fill","var(--u-light)"],["d","M5 3V8M3 5H9","stroke","var(--u-fill)","stroke-width","1.2","stroke-linecap","round","opacity","0.7"],["transform","translate(0, 4)"],["points","50,16 86,78 14,78","filter","url(#soft-shadow)"],["points","50,18 82,74 18,74","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","50","y","68","text-anchor","middle","font-size","30","font-weight","700","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,10 91,81 9,81","fill","none","stroke","var(--u-core)","stroke-width","2","stroke-linejoin","round"],["points","50,0 98,86 2,86","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["points","50,0 56,10 44,10","fill","var(--u-light)","stroke-linejoin","round"],["points","99,87 92,74 84,87","fill","var(--u-light)","stroke-linejoin","round"],["points","1,87 15,87 8,74","fill","var(--u-light)","stroke-linejoin","round"],["x","21","y","21","width","56","height","56","rx","6","filter","url(#soft-shadow)"],["x","23","y","23","width","52","height","52","rx","5","fill","none","stroke","url(#edge-light)","stroke-width","2"],["x","49","y","60","text-anchor","middle","font-size","30","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["x","18","y","18","width","62","height","62","rx","8","fill","none","stroke","var(--u-core)","stroke-width","2"],["x","14","y","14","width","70","height","70","rx","10","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4"],["x","12","y","12","width","8","height","8","fill","var(--u-light)"],["x","78","y","12","width","8","height","8","fill","var(--u-light)"],["x","12","y","78","width","8","height","8","fill","var(--u-light)"],["x","78","y","78","width","8","height","8","fill","var(--u-light)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","filter","url(#soft-shadow)"],["points","50,20 78,36 78,64 50,80 22,64 22,36","fill","none","stroke","var(--u-light)","stroke-width","2","opacity","0.4"],["x","49","y","62","text-anchor","middle","font-size","28","font-weight","600","fill","var(--u-font)",1,"select-none","pointer-events-none","shadow-text"],["points","50,17 81,35 81,65 50,83 19,65 19,35","fill","none","stroke","var(--u-core)","stroke-width","1.5","stroke-linejoin","round"],["points","50,12 86,32 86,68 50,88 14,68 14,32","fill","none","stroke","var(--u-stroke)","stroke-width","1.5","stroke-dasharray","4 4","stroke-linejoin","round"],["cx","50","cy","12","r","3","fill","var(--u-light)"],["cx","86","cy","32","r","3","fill","var(--u-light)"],["cx","86","cy","68","r","3","fill","var(--u-light)"],["cx","50","cy","88","r","3","fill","var(--u-light)"],["cx","14","cy","68","r","3","fill","var(--u-light)"],["cx","14","cy","32","r","3","fill","var(--u-light)"]],template:function(t,i){if(t&1&&Y(0,UG,10,8,":svg:svg",0)(1,qG,11,8,":svg:svg",1)(2,tz,10,8,":svg:svg",0)(3,cz,10,8,":svg:svg",0),t&2){let r;Q((r=i.unit.tier)===1?0:r===2?1:r===3?2:r===4?3:-1)}},dependencies:[jt],encapsulation:2})};function uz(n,e){if(n&1){let t=Je();b(0,"div",7)(1,"div",8),v(2),T(),b(3,"button",9),et("click",function(){ie(t);let r=O();return re(r.gameEngine.cancelSandboxSpawn())}),v(4),T()()}if(n&2){let t=O();y(2),H(" ",t.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043B\u0438\u0442\u043A\u0443 \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u0438":"Click an empty tile to spawn"," "),y(2),H(" ",t.settings.currentLang()==="uk"?"\u0412\u0456\u0434\u043C\u0456\u043D\u0430":"Cancel"," ")}}var h0=class n{constructor(e,t){this.gameEngine=e;this.settings=t}static \u0275fac=function(t){return new(t||n)(ge(ii),ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-sandbox"]],decls:24,vars:3,consts:[[1,"absolute","-top-7","left-[-10px]","ml-2","px-3","py-1","rounded-full","bg-pink-600/20","border","border-pink-500/30","text-pink-200","text-[10px]","font-black","uppercase","tracking-widest"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-28","right-[-254px]","min-w-[238px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"mt-2","flex","flex-col","gap-2","w-full","px-2","py-2","rounded-lg","border","border-white/5","bg-white/5"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-pink-200"],[1,"grid","grid-cols-4","gap-2"],[1,"px-2","py-1","rounded","bg-blue-600/20","border","border-blue-500/30","text-blue-100","text-[10px]","cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","bg-red-600/20","border","border-red-500/30","text-red-100","text-[10px]","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-[10px]","text-gray-300"],[1,"px-2","py-1","rounded","bg-gray-700","hover:bg-gray-600","border","border-gray-600","text-white","text-[10px]","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(b(0,"div",0),v(1),T(),b(2,"div",1)(3,"div",2)(4,"div",3),v(5),T(),b(6,"div",4)(7,"button",5),et("click",function(){return i.gameEngine.startSandboxSpawn("player",1)}),v(8," T1 "),T(),b(9,"button",5),et("click",function(){return i.gameEngine.startSandboxSpawn("player",2)}),v(10," T2 "),T(),b(11,"button",5),et("click",function(){return i.gameEngine.startSandboxSpawn("player",3)}),v(12," T3 "),T(),b(13,"button",5),et("click",function(){return i.gameEngine.startSandboxSpawn("player",4)}),v(14," T4 "),T(),b(15,"button",6),et("click",function(){return i.gameEngine.startSandboxSpawn("ai",1)}),v(16," T1 "),T(),b(17,"button",6),et("click",function(){return i.gameEngine.startSandboxSpawn("ai",2)}),v(18," T2 "),T(),b(19,"button",6),et("click",function(){return i.gameEngine.startSandboxSpawn("ai",3)}),v(20," T3 "),T(),b(21,"button",6),et("click",function(){return i.gameEngine.startSandboxSpawn("ai",4)}),v(22," T4 "),T()(),Y(23,uz,5,2,"div",7),T()()),t&2&&(y(),H(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox",`
`),y(4),H(" ",i.settings.currentLang()==="uk"?"\u041F\u0456\u0441\u043E\u0447\u043D\u0438\u0446\u044F":"Sandbox"," "),y(18),Q(i.gameEngine.sandboxSpawnPending()?23:-1))},dependencies:[jt],encapsulation:2})};var dz=["boardContainer"],Tt=(n,e)=>({x:n,y:e}),hz=()=>[10,20,30],fz=(n,e)=>e.id,qk=(n,e)=>e.date;function pz(n,e){if(n&1){let t=Je();E(0,"div",82)(1,"div",233)(2,"span",234),v(3),x(),E(4,"button",235),ce("click",function(){ie(t);let r=O();return re(r.firebase.logout())}),v(5),x()(),E(6,"div",236),K(7,"img",237)(8,"div",238),x()()}if(n&2){let t=O();y(3),H(" ",t.settings.t("VERIFIED")," "),y(2),H(" ",t.settings.t("LOGOUT")," "),y(2),$e("src",e.photoURL,Zi)}}function gz(n,e){if(n&1){let t=Je();E(0,"button",239),ce("click",function(){ie(t);let r=O();return re(r.firebase.loginWithGoogle())}),K(1,"div",240),E(2,"span",241),v(3),x()()}if(n&2){let t=O();y(3),H(" ",t.settings.t("CONNECT")," ")}}function mz(n,e){if(n&1){let t=Je();E(0,"div",82)(1,"div",233)(2,"span",234),v(3),x(),E(4,"button",235),ce("click",function(){ie(t);let r=O(2);return re(r.firebase.logout())}),v(5),x()(),E(6,"div",236),K(7,"img",237)(8,"div",238),x()(),E(9,"button",197),ce("click",function(){ie(t);let r=O(2);return re(r.toggleAutoBattle())}),E(10,"div",198)(11,"span",199),v(12),x(),E(13,"span",200),v(14),x()(),E(15,"div",198),K(16,"span",201),x(),K(17,"div",202),x()}if(n&2){let t=O(2);y(3),H(" ",t.settings.t("VERIFIED")," "),y(2),H(" ",t.settings.t("LOGOUT")," "),y(2),$e("src",e.photoURL,Zi),y(2),Pe("ring-2",t.isAutoBattleActive())("ring-green-400",t.isAutoBattleActive()),$e("disabled",t.gameEngine.gameStatus()!=="playing"),y(3),W(t.settings.t("AUTO")),y(2),W(t.settings.t("ENGAGE")),y(2),Pe("bg-green-400",t.isAutoBattleActive())("bg-gray-500",!t.isAutoBattleActive())}}function yz(n,e){if(n&1){let t=Je();E(0,"button",239),ce("click",function(){ie(t);let r=O(2);return re(r.firebase.loginWithGoogle())}),K(1,"div",240),E(2,"span",241),v(3),x()()}if(n&2){let t=O(2);y(3),H(" ",t.settings.t("CONNECT")," ")}}function vz(n,e){if(n&1){let t=Je();E(0,"div",119)(1,"div",242)(2,"button",243),ce("click",function(){ie(t);let r=O();return re(r.closeMobileMenu())}),X(),E(3,"svg",103),K(4,"path",244),x()(),Ne(),E(5,"button",245),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.resetGame())}),v(6),x(),E(7,"button",245),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.toggleRules())}),v(8),x(),E(9,"button",245),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.toggleLeaderboard())}),v(10),x(),E(11,"button",245),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.toggleLog())}),v(12),x(),E(13,"button",245),ce("click",function(){ie(t);let r=O();return re(r.navigateToFeedback())}),v(14),x(),E(15,"button",245),ce("click",function(){ie(t);let r=O();return re(r.navigateToRoadmap())}),v(16),x(),E(17,"button",245),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.toggleSettings())}),v(18),x(),E(19,"button",245),ce("click",function(){ie(t);let r=O();return re(r.navigateToRoadmap())}),v(20),x(),Y(21,mz,18,14)(22,yz,4,1,"button",83),x()()}if(n&2){let t,i=O();y(6),W(i.settings.t("RELOAD")),y(2),W(i.settings.t("INFO")),y(2),W(i.settings.t("RANKING")),y(2),W(i.settings.t("SYSTEM_LOG")),y(2),W(i.settings.t("FEEDBACK_MODULE")),y(2),W(i.settings.t("STRATEGIC_PLAN")),y(2),W(i.settings.t("SETTINGS")),y(2),W(i.settings.t("STRATEGIC_PLAN")),y(),Q((t=i.firebase.user$())?21:22,t)}}function _z(n,e){if(n&1&&(E(0,"div",161),v(1),x()),n&2){let t=O();y(),es(" ",t.settings.t("MONOPOLY")," ",t.gameEngine.monopolyTurnsLeft()," ",t.settings.t("LFT")," ")}}function Ez(n,e){if(n&1&&(E(0,"div",248),v(1),x()),n&2){let t=O(2);y(),W(t.gameEngine.endReason())}}function bz(n,e){if(n&1){let t=Je();E(0,"div",249)(1,"div",252),v(2),x(),K(3,"input",253,1),E(5,"button",254),ce("click",function(){ie(t);let r=ku(4),o=O(2);return re(o.gameEngine.confirmAndSaveScore(r.value))}),v(6),x()()}if(n&2){let t=O(2);y(2),W(t.settings.t("CONFIRM_NAME")),y(),$e("value",t.gameEngine.getPlayerName()),y(3),H(" ",t.settings.t("SAVE_SCORE")," ")}}function wz(n,e){if(n&1){let t=Je();E(0,"div",169)(1,"div",246)(2,"h2",247),v(3),Ar(4,"titlecase"),x(),Y(5,Ez,2,1,"div",248),Y(6,bz,7,3,"div",249),E(7,"button",250),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.resetGame())}),v(8),x()(),E(9,"button",251),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.toggleLeaderboard())}),v(10),x()()}if(n&2){let t=O();y(2),Pe("text-blue-400",t.gameEngine.gameStatus()==="player wins")("text-red-500",t.gameEngine.gameStatus()==="jaerbi wins"),y(),H(" ",cE(4,9,t.gameEngine.gameStatus()),"! "),y(2),Q(t.gameEngine.endReason()?5:-1),y(),Q(t.gameEngine.gameStatus()==="player wins"&&t.gameEngine.isNamePromptOpen()?6:-1),y(2),H(" ",t.settings.t("PLAY_AGAIN")," "),y(2),H(" ",t.settings.t("VIEW_LEADERBOARD")," ")}}function xz(n,e){n&1&&K(0,"app-support-community")}function Sz(n,e){n&1&&K(0,"app-leaderboard-modal")}function Iz(n,e){n&1&&K(0,"app-sandbox")}function Tz(n,e){if(n&1&&(E(0,"div",184)(1,"span",255),v(2),x()()),n&2){let t=O();y(2),H(" ",t.gameEngine.baseHealth().ai," ")}}function Cz(n,e){n&1&&(E(0,"span",267),v(1," \u{1F92C} "),x()),n&2&&rt("z-index",100)}function Dz(n,e){n&1&&(E(0,"span",267),v(1," \u{1F620} "),x()),n&2&&rt("z-index",100)}function Az(n,e){if(n&1&&Y(0,Cz,2,2,"span",266)(1,Dz,2,2,"span",266),n&2){let t=O(3);Q(t.gameEngine.isRage()?0:t.gameEngine.isAngry()?1:-1)}}function Mz(n,e){n&1&&K(0,"div",259)}function Rz(n,e){if(n&1){let t=Je();E(0,"button",268),ce("click",function(){ie(t);let r=O().$implicit,o=O().$implicit,s=O();return re(s.gameEngine.buildForgeAt({x:r,y:o}))}),v(1," Build Forge "),x()}n&2&&rt("z-index",60)}function Nz(n,e){if(n&1&&(E(0,"span",269),v(1),x()),n&2){let t=O().$implicit,i=O().$implicit,r=O();rt("z-index",55),y(),H(" ",r.gameEngine.getForgeProgress(t,i),"% ")}}function Pz(n,e){n&1&&(E(0,"span",273),X(),E(1,"svg",274)(2,"g",275),K(3,"rect",276)(4,"rect",277)(5,"path",278)(6,"rect",279)(7,"rect",280),x()()()),n&2&&rt("z-index",50)}function kz(n,e){if(n&1){let t=Je();E(0,"button",284),ce("click",function(){ie(t),O(3);let r=Dr(5),o=O(2);return re(o.gameEngine.buyWeapon(r.id))}),v(1," Weapon "),x()}}function Oz(n,e){if(n&1){let t=Je();E(0,"button",285),ce("click",function(){ie(t),O(3);let r=Dr(5),o=O(2);return re(o.gameEngine.buyArmor(r.id))}),v(1," Armor "),x()}}function Fz(n,e){if(n&1&&(E(0,"div",281),Y(1,kz,2,0,"button",282),Y(2,Oz,2,0,"button",283),x()),n&2){O(2);let t=Dr(5),i=O(2);rt("z-index",60),y(),Q(!t.hasWeapon&&i.gameEngine.resources().iron>=20?1:-1),y(),Q(!t.hasArmor&&i.gameEngine.resources().iron>=20?2:-1)}}function Lz(n,e){if(n&1&&(E(0,"span",270),v(1," Forge "),x(),Y(2,Pz,8,2,"span",271),Y(3,Fz,3,4,"div",272)),n&2){let t=O().$implicit,i=Dr(5),r=O().$implicit,o=O();rt("z-index",55),Pe("scale-60",i&&i.owner==="player")("scale-50",i&&i.owner==="player")("top-1",!(i&&i.owner==="player"))("left-1",!(i&&i.owner==="player"))("top-0",i&&i.owner==="player")("-right-1",i&&i.owner==="player"),y(2),Q(o.gameEngine.isVisibleToPlayer(t,r)?2:-1),y(),Q(i&&i.owner==="player"?3:-1)}}function Vz(n,e){n&1&&(X(),E(0,"g",291),K(1,"polygon",294)(2,"polygon",295),x())}function Uz(n,e){n&1&&(X(),E(0,"g",296),K(1,"rect",297),x(),E(2,"g",298),K(3,"rect",299)(4,"path",300),x())}function Bz(n,e){if(n&1&&(E(0,"span",286),X(),E(1,"svg",287)(2,"defs")(3,"linearGradient",288),K(4,"stop",289)(5,"stop",290),x()(),Y(6,Vz,3,0,":svg:g",291),E(7,"g"),K(8,"polygon",292)(9,"rect",293),x(),Y(10,Uz,5,0),x()()),n&2){O();let t=Dr(5);Pe("scale-50",t)("opacity-40",t)("translate-x-4",t)("-translate-y-4",t),y(6),Q(t?-1:6),y(),Pe("scale-90",t),y(3),Q(t?-1:10)}}function jz(n,e){n&1&&(X(),E(0,"g",304),K(1,"rect",305)(2,"path",306),x())}function Hz(n,e){if(n&1&&(E(0,"span",286),X(),E(1,"svg",287)(2,"g"),K(3,"ellipse",301)(4,"path",302)(5,"circle",303),x(),Y(6,jz,3,0,":svg:g",304),x()()),n&2){O();let t=Dr(5);Pe("scale-50",t)("opacity-40",t)("-translate-x-4",t)("translate-y-4",t),y(6),Q(t?-1:6)}}function $z(n,e){n&1&&K(0,"div",307),n&2&&rt("height",2,"px")}function Gz(n,e){if(n&1&&(E(0,"span",308),v(1),x(),E(2,"span",309),v(3),x()),n&2){let t=O(3);y(),H(" ",t.gameEngine.baseHealth().player," "),y(2),H(" ",t.gameEngine.reservePoints().player," ")}}function zz(n,e){if(n&1&&(E(0,"span",310),v(1),x(),E(2,"span",311),v(3),x()),n&2){let t=O(4);y(),H(" ",t.gameEngine.baseHealth().ai," "),y(2),H(" ",t.gameEngine.reservePoints().ai," ")}}function Wz(n,e){if(n&1&&Y(0,zz,4,2),n&2){let t=O().$implicit,i=O().$implicit,r=O();Q(r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function qz(n,e){n&1&&(X(),E(0,"svg",317),K(1,"path",318),x())}function Kz(n,e){n&1&&(X(),E(0,"svg",317),K(1,"path",319),x())}function Yz(n,e){if(n&1){let t=Je();E(0,"button",316),ce("click",function(r){ie(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return re(o.owner==="player"?l.onDestroyIconClick(r,s,a,s+1,a):l.onAttackIconClick(r,s,a,s+1,a))}),Y(1,qz,2,0,":svg:svg",317)(2,Kz,2,0,":svg:svg",317),x()}if(n&2){let t=O(2),i=O(4);rt("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Pe("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),y(),Q(t.owner==="player"?1:2)}}function Qz(n,e){if(n&1){let t=Je();E(0,"div",314),ce("mouseenter",function(){ie(t);let r=O(),o=O(4);return re(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){ie(t);let r=O(5);return re(r.gameEngine.hoverFormationById(null))}),Y(1,Yz,3,13,"button",315),x()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();rt("right",-o.gameEngine.wallThicknessPx-2,"px")("width",o.gameEngine.wallThicknessPx,"px")("height",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","height 0.25s ease-out"),Pe("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Lt("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),y(),Q(o.gameEngine.canShowAttackIcon(bt(26,Tt,i,r),bt(29,Tt,i+1,r))?1:-1)}}function Jz(n,e){if(n&1&&Y(0,Qz,2,32,"div",313),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();Q(r.gameEngine.shouldRenderWall(bt(1,Tt,t,i),bt(4,Tt,t+1,i),e.owner)?0:-1)}}function Zz(n,e){if(n&1){let t=Je();E(0,"button",323),ce("click",function(r){ie(t);let o=O(3).$implicit,s=O().$implicit,a=O();return re(a.onBuildIconClick(r,o,s,o+1,s))}),v(1," \u2714 "),x()}if(n&2){let t=O(5);rt("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function Xz(n,e){if(n&1&&(E(0,"span",322),v(1),x()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();y(),tn(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(bt(2,Tt,t,i),bt(5,Tt,t+1,i))," ")}}function eW(n,e){if(n&1&&(E(0,"div",320),Y(1,Zz,2,8,"button",321),Y(2,Xz,2,8,"span",322),x()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();rt("right",-r.gameEngine.wallThicknessPx-2,"px")("width",r.gameEngine.wallThicknessPx,"px")("height",100,"%")("z-index",40)("transition","height 0.25s ease-out"),Pe("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(bt(16,Tt,t,i),bt(19,Tt,t+1,i)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(bt(22,Tt,t,i),bt(25,Tt,t+1,i))),y(),Q(r.gameEngine.canShowBuildIcon(bt(28,Tt,t,i),bt(31,Tt,t+1,i))?1:-1),y(),Q(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t+1,i))&&r.gameEngine.edgeCooldownRemaining(bt(34,Tt,t,i),bt(37,Tt,t+1,i))>0?2:-1)}}function tW(n,e){if(n&1&&Y(0,Jz,1,7)(1,eW,3,40,"div",312),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();Q((t=o.gameEngine.getWallBetween(i,r,i+1,r))?0:1,t)}}function nW(n,e){n&1&&(X(),E(0,"svg",317),K(1,"path",318),x())}function iW(n,e){n&1&&(X(),E(0,"svg",317),K(1,"path",319),x())}function rW(n,e){if(n&1){let t=Je();E(0,"button",316),ce("click",function(r){ie(t);let o=O(2),s=O(2).$implicit,a=O().$implicit,l=O();return re(o.owner==="player"?l.onDestroyIconClick(r,s,a,s,a+1):l.onAttackIconClick(r,s,a,s,a+1))}),Y(1,nW,2,0,":svg:svg",317)(2,iW,2,0,":svg:svg",317),x()}if(n&2){let t=O(2),i=O(4);rt("width",i.gameEngine.iconSizePx,"px")("height",i.gameEngine.iconSizePx,"px")("z-index",45),Pe("bg-red-600",t.owner==="player")("bg-yellow-500",t.owner==="ai")("bg-gray-600",t.owner==="neutral"),y(),Q(t.owner==="player"?1:2)}}function oW(n,e){if(n&1){let t=Je();E(0,"div",326),ce("mouseenter",function(){ie(t);let r=O(),o=O(4);return re(o.gameEngine.hoverFormationById(r.formationId))})("mouseleave",function(){ie(t);let r=O(5);return re(r.gameEngine.hoverFormationById(null))}),Y(1,rW,3,13,"button",315),x()}if(n&2){let t=O(),i=O(2).$implicit,r=O().$implicit,o=O();rt("bottom",-o.gameEngine.wallThicknessPx-2,"px")("height",o.gameEngine.wallThicknessPx,"px")("width",t.health/(t.maxHealth||100)*100,"%")("z-index",40)("transition","width 0.25s ease-out"),Pe("bg-blue-400",t.owner==="player")("bg-red-400",t.owner==="ai")("wall-formation-player",t.owner==="player")("wall-formation-ai",t.owner==="ai")("bg-gray-300",t.owner==="neutral")("shake",o.gameEngine.isWallShaking(t.id))("wall-formation-active",o.gameEngine.isFormationHovered(t.formationId)),Lt("title","Wall "+((t.bonusHp||0)>0?"(Reinforced: +"+(t.bonusHp||0)+" HP from formation)":"")+" \u2014 HP: "+t.health+"/"+(t.maxHealth||100)),y(),Q(o.gameEngine.canShowAttackIcon(bt(26,Tt,i,r),bt(29,Tt,i,r+1))?1:-1)}}function sW(n,e){if(n&1&&Y(0,oW,2,32,"div",325),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();Q(r.gameEngine.shouldRenderWall(bt(1,Tt,t,i),bt(4,Tt,t,i+1),e.owner)?0:-1)}}function aW(n,e){if(n&1){let t=Je();E(0,"button",330),ce("click",function(r){ie(t);let o=O(3).$implicit,s=O().$implicit,a=O();return re(a.onBuildIconClick(r,o,s,o,s+1))}),v(1," \u2714 "),x()}if(n&2){let t=O(5);rt("font-size",t.gameEngine.iconSizePx,"px")("width",t.gameEngine.iconSizePx,"px")("height",t.gameEngine.iconSizePx,"px")("z-index",45)}}function lW(n,e){if(n&1&&(E(0,"span",329),v(1),x()),n&2){let t=O(3).$implicit,i=O().$implicit,r=O();y(),tn(" ",r.settings.t("CD"),": ",r.gameEngine.edgeCooldownRemaining(bt(2,Tt,t,i),bt(5,Tt,t,i+1))," ")}}function cW(n,e){if(n&1&&(E(0,"div",327),Y(1,aW,2,8,"button",328),Y(2,lW,2,8,"span",329),x()),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();rt("bottom",-r.gameEngine.wallThicknessPx-2,"px")("height",r.gameEngine.wallThicknessPx,"px")("width",100,"%")("z-index",40)("transition","width 0.25s ease-out"),Pe("bg-lime-700",r.gameEngine.buildMode()&&r.gameEngine.canBuildWallBetween(bt(16,Tt,t,i),bt(19,Tt,t,i+1)))("bg-transparent",!r.gameEngine.buildMode()||!r.gameEngine.canBuildWallBetween(bt(22,Tt,t,i),bt(25,Tt,t,i+1))),y(),Q(r.gameEngine.canShowBuildIcon(bt(28,Tt,t,i),bt(31,Tt,t,i+1))?1:-1),y(),Q(r.gameEngine.buildMode()&&(r.gameEngine.isVisibleToPlayer(t,i)||r.gameEngine.isVisibleToPlayer(t,i+1))&&r.gameEngine.edgeCooldownRemaining(bt(34,Tt,t,i),bt(37,Tt,t,i+1))>0?2:-1)}}function uW(n,e){if(n&1&&Y(0,sW,1,7)(1,cW,3,40,"div",324),n&2){let t,i=O().$implicit,r=O().$implicit,o=O();Q((t=o.gameEngine.getWallBetween(i,r,i,r+1))?0:1,t)}}function dW(n,e){if(n&1&&K(0,"app-units",334),n&2){let t=O(3);$e("unit",t)}}function hW(n,e){if(n&1&&(E(0,"span",338),v(1),x()),n&2){let t=e;rt("z-index",200),Pe("bg-green-600",t.bg==="bg-green-600")("bg-amber-600",t.bg==="bg-amber-600")("bg-red-600",t.bg==="bg-red-600"),y(),H(" ",t.chance,"% ")}}function fW(n,e){n&1&&(E(0,"span",339),v(1," \u{1F333} "),x()),n&2&&rt("z-index",100)}function pW(n,e){n&1&&(E(0,"span",340),v(1," \u{1F331} "),x()),n&2&&rt("z-index",100)}function gW(n,e){n&1&&(E(0,"span",340),v(1," \u{1F33F} "),x()),n&2&&rt("z-index",100)}function mW(n,e){n&1&&(E(0,"span",343),v(1," \u{1F9F1} "),x()),n&2&&rt("z-index",100)}function yW(n,e){n&1&&(E(0,"span",342),v(1,"\u26F0\uFE0F"),x())}function vW(n,e){n&1&&(E(0,"span",342),v(1,"\u26CF\uFE0F"),x())}function _W(n,e){n&1&&(E(0,"span",342),v(1,"\u26CF"),x())}function EW(n,e){n&1&&(E(0,"span",342),v(1,"\u2692"),x())}function bW(n,e){if(n&1&&Y(0,mW,2,2,"span",341)(1,yW,2,0,"span",342)(2,vW,2,0,"span",342)(3,_W,2,0,"span",342)(4,EW,2,0,"span",342),n&2){let t=O(3);Q((t.mineOccupationTurns??0)>=5?0:(t.mineOccupationTurns??0)===1?1:(t.mineOccupationTurns??0)===2?2:(t.mineOccupationTurns??0)===3?3:(t.mineOccupationTurns??0)>3?4:-1)}}function wW(n,e){if(n&1&&(E(0,"div",332)(1,"div",333),Y(2,dW,1,1,"app-units",334),x(),Y(3,hW,2,9,"span",335),Y(4,fW,2,2,"span",336)(5,pW,2,2,"span",337)(6,gW,2,2,"span",337),Y(7,bW,5,1),x()),n&2){let t,i=O(2),r=O(3);rt("transform",r.gameEngine.getCombinedTransform(i.id))("z-index",r.gameEngine.isUnitMoving(i.id)||r.gameEngine.isUnitAttacking(i.id)?200:null),Pe("shake",r.gameEngine.isUnitShaking(i.id)),y(),rt("width",r.gameEngine.tileUnitSizePx,"px")("height",r.gameEngine.tileUnitSizePx,"px"),Pe("theme-player",i.owner==="player")("theme-ai",i.owner==="ai")("fatigued",i.hasActed)("merge-anim",r.gameEngine.lastMergedUnitId()===i.id)("ring",r.gameEngine.selectedUnitId()===i.id)("ring-yellow-400",r.gameEngine.selectedUnitId()===i.id)("ring-offset-gray-800",r.gameEngine.selectedUnitId()===i.id)("scale-115",r.gameEngine.selectedUnitId()===i.id&&!r.gameEngine.buildMode())("scale-120",r.gameEngine.lastMergedUnitId()===i.id)("scale-50",r.gameEngine.buildMode())("animate-bounce",r.gameEngine.lastRemainderUnitId()===i.id)("arrival-pop",r.gameEngine.lastArrivedUnitId()===i.id)("pulse-glow",r.gameEngine.pulseUnitId()===i.id),Lt("title",r.gameEngine.formatHoverInfo(i.id)),y(),Q(i?2:-1),y(),Q((t=r.gameEngine.isUnitHovered(i.id)&&r.gameEngine.getHitChanceInfo(i.id))?3:-1,t),y(),Q(i.productionActive?4:(i.forestOccupationTurns??0)===1?5:(i.forestOccupationTurns??0)>1?6:-1),y(3),Q(r.gameEngine.isMine(i.position.x,i.position.y)?7:-1)}}function xW(n,e){if(n&1&&Y(0,wW,8,41,"div",331),n&2){let t=O(2).$implicit,i=O().$implicit,r=O();Q(!(t===0&&i===0)&&!(t===r.gameEngine.gridSize-1&&i===r.gameEngine.gridSize-1)?0:-1)}}function SW(n,e){if(n&1&&Y(0,xW,1,1),n&2){let t=O().$implicit,i=O().$implicit,r=O();Q(e.owner==="player"||r.gameEngine.isVisibleToPlayer(t,i)?0:-1)}}function IW(n,e){if(n&1&&(E(0,"div",344)(1,"span",345),v(2),x()()),n&2){let t=e.$implicit,i=O(3);rt("z-index",100)("opacity",t.opacity),y(),Pe("text-xs",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-base",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text))("text-yellow-300",!i.gameEngine.isLuckyText(t.text)&&!i.gameEngine.isDrawText(t.text))("text-yellow-400",i.gameEngine.isLuckyText(t.text)||i.gameEngine.isDrawText(t.text)),y(),H(" ",t.text," ")}}function TW(n,e){if(n&1){let t=Je();E(0,"div",257),ce("click",function(){let r=ie(t).$implicit,o=O().$implicit,s=O();return re(s.onTileClick(r,o))})("mouseenter",function(){let r=ie(t).$implicit,o=O().$implicit,s=O();return re(s.gameEngine.setHoveredUnit(s.gameEngine.getUnitAt(r,o)&&(s.gameEngine.getUnitAt(r,o).owner==="player"||s.gameEngine.isVisibleToPlayer(r,o))?s.gameEngine.getUnitAt(r,o).id:null))})("mouseleave",function(){ie(t);let r=O(2);return re(r.gameEngine.setHoveredUnit(null))}),E(1,"span",258),v(2),x(),Y(3,Az,2,1),Y(4,Mz,1,0,"div",259),wl(5),Y(6,Rz,2,2,"button",260),Y(7,Nz,2,3,"span",261),Y(8,Lz,4,16),Y(9,Bz,11,12,"span",262),Y(10,Hz,7,9,"span",263),Y(11,$z,1,2,"div",264),Y(12,Gz,4,2),Y(13,Wz,1,1),Y(14,tW,2,1),Y(15,uW,2,1),Y(16,SW,1,1),wn(17,IW,3,13,"div",265,fz),x()}if(n&2){let t,i=e.$implicit,r=O().$implicit,o=O();rt("width",o.gameEngine.tileSizePx,"px")("height",o.gameEngine.tileSizePx,"px")("min-width",o.gameEngine.tileMinSizePx,"px")("min-height",o.gameEngine.tileMinSizePx,"px"),Pe("cursor-pointer",o.gameEngine.isValidMove(i,r))("bg-gray-700",!o.gameEngine.isValidMove(i,r))("border-gray-600",!o.gameEngine.isValidMove(i,r))("bg-blue-900",i===0&&r===0)("bg-red-900",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-4",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("border-blue-400",i===0&&r===0)("border-red-400",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-2",i===0&&r===0||i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("ring-blue-300",i===0&&r===0&&o.gameEngine.baseDeployActive())("ring-red-300",i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1)("spawn-zone-highlight",o.gameEngine.baseDeployActive()&&i<=2&&r<=2&&(i!==0||r!==0))("forest-area",o.gameEngine.isForest(i,r))("mine-area",o.gameEngine.isMine(i,r))("forge-area",o.gameEngine.isForge(i,r))("bg-amber-900",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("border-amber-500",o.gameEngine.isDeployTarget(i,r)&&!o.gameEngine.buildMode())("bg-gray-950",!o.gameEngine.isVisibleToPlayer(i,r))("border-gray-800",!o.gameEngine.isVisibleToPlayer(i,r))("bg-green-900",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("border-green-500",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("bg-cyan-900",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("border-cyan-500",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("animate-pulse",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r))("hover:bg-gray-600",!o.gameEngine.isValidMove(i,r))("hover:bg-green-800",o.gameEngine.isValidMove(i,r)&&!o.gameEngine.getUnitAt(i,r))("hover:bg-cyan-800",o.gameEngine.isValidMove(i,r)&&o.gameEngine.getUnitAt(i,r)),Lt("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0456\u0437\u043D\u0430 \u0448\u0430\u0445\u0442\u0430: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 5 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +2 \u0437\u0430\u043B\u0456\u0437\u0430 \u0437\u0430 \u0445\u0456\u0434.":"Iron Mine: Requires 5 consecutive turns of occupation to activate. Once active, yields +2 Iron per turn.":null)("title",o.gameEngine.getUnitAt(i,r)&&(o.gameEngine.getUnitAt(i,r).owner==="player"||o.gameEngine.isVisibleToPlayer(i,r))?o.gameEngine.formatHoverInfo(o.gameEngine.getUnitAt(i,r).id):o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?o.settings.currentLang()==="uk"?"\u041B\u0456\u0441\u043E\u043F\u0438\u043B\u044C\u043D\u044F: \u0414\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u043F\u043E\u0442\u0440\u0456\u0431\u043D\u043E 2 \u043F\u043E\u0441\u043B\u0456\u0434\u043E\u0432\u043D\u0438\u0445 \u0445\u043E\u0434\u0456\u0432 \u0437\u0430\u0439\u043D\u044F\u0442\u0442\u044F. \u041F\u0456\u0441\u043B\u044F \u0430\u043A\u0442\u0438\u0432\u0430\u0446\u0456\u0457 \u0434\u0430\u0454 +8 \u0434\u0435\u0440\u0435\u0432\u0438\u043D\u0438 \u0437\u0430 \u0445\u0456\u0434.":"Sawmill: Requires 2 consecutive occupation turns to activate. Once activated, it gives +8 wood per turn.":null),y(2),tn(" ",i,",",r," "),y(),Q(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1&&o.gameEngine.isVisibleToPlayer(i,r)?3:-1),y(),Q(o.gameEngine.buildMode()&&o.gameEngine.isInSafeZone(i,r)?4:-1),y(),Ou(o.gameEngine.getUnitAt(i,r)),y(),Q(o.gameEngine.buildMode()&&o.gameEngine.canBuildForgeAt(i,r)?6:-1),y(),Q(o.gameEngine.isForgeSite(i,r)?7:-1),y(),Q(o.gameEngine.isForge(i,r)?8:-1),y(),Q(o.gameEngine.isForest(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?9:-1),y(),Q(o.gameEngine.isMine(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?10:-1),y(),Q(o.gameEngine.isForest(i,r)&&o.gameEngine.getUnitAt(i,r)&&o.gameEngine.isVisibleToPlayer(i,r)?11:-1),y(),Q(i===0&&r===0?12:-1),y(),Q(i===o.gameEngine.gridSize-1&&r===o.gameEngine.gridSize-1?13:-1),y(),Q(i<o.gameEngine.gridSize-1?14:-1),y(),Q(r<o.gameEngine.gridSize-1?15:-1),y(),Q((t=o.gameEngine.getUnitAt(i,r))?16:-1,t),y(),xn(o.gameEngine.getCombatTextEntriesAt(i,r))}}function CW(n,e){if(n&1&&wn(0,TW,19,80,"div",256,Cr),n&2){let t=O();xn(t.gameEngine.gridCols)}}function DW(n,e){n&1&&K(0,"app-game-rules")}function AW(n,e){if(n&1&&(E(0,"div",361),v(1),x()),n&2){let t=O(2);y(),W(t.settings.t("NOT_LOGS_DATA"))}}function MW(n,e){if(n&1&&(E(0,"div",363)(1,"span",364),v(2),x()()),n&2){let t=e.$implicit;rt("border-left-color",t.color.includes("green")?"#4ade80":t.color.includes("red")?"#f87171":t.color.includes("yellow")?"#fde047":"transparent"),Pe("border-l-4",t.color.includes("green")||t.color.includes("red")||t.color.includes("yellow")),y(),sE(t.color),y(),W(t.text)}}function RW(n,e){if(n&1){let t=Je();E(0,"div",229)(1,"button",346),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.toggleLog())}),E(2,"span",347),v(3,"\u2715"),x()(),E(4,"div",348)(5,"div",349)(6,"h3",350),v(7),x(),E(8,"button",351),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.clearLogs())}),X(),E(9,"svg",352),K(10,"path",353),x(),v(11),x()(),Ne(),E(12,"label",354)(13,"div",109)(14,"input",355),ce("change",function(){ie(t);let r=O();return re(r.gameEngine.toggleCombatOnly())}),x(),K(15,"div",356),X(),E(16,"svg",357),K(17,"path",358),x()(),Ne(),E(18,"span",359),v(19),x()()(),E(20,"div",360),Y(21,AW,2,1,"div",361),wn(22,MW,3,7,"div",362,Nu),x()()}if(n&2){let t=O();y(7),H(" ",t.settings.t("Action_LOG")," "),y(4),H(" ",t.settings.t("CLEAR")," "),y(3),$e("checked",t.gameEngine.combatOnly()),y(5),H(" ",t.settings.t("COMBAT_ONLY")," "),y(2),Q(t.gameEngine.logsFiltered().length===0?21:-1),y(),xn(t.gameEngine.logsFiltered().reverse())}}function NW(n,e){if(n&1){let t=Je();E(0,"button",381),ce("click",function(){let r=ie(t).$implicit,o=O(2);return re(o.onDifficultyChange(r))}),E(1,"span",382),v(2),x(),v(3),x()}if(n&2){let t=e.$implicit,i=O(2);Pe("bg-blue-500/20",i.settings.difficulty()===t)("border-blue-400/40",i.settings.difficulty()===t)("text-blue-200",i.settings.difficulty()===t)("shadow-[0_0_15px_rgba(59,130,246,0",i.settings.difficulty()===t)("bg-white/5",i.settings.difficulty()!==t)("border-white/5",i.settings.difficulty()!==t)("text-stone-500",i.settings.difficulty()!==t)("hover:bg-white/10",i.settings.difficulty()!==t),y(),Pe("opacity-100",i.settings.difficulty()===t),y(),H(" ",t==="baby"?"\u{1F476}":t==="normal"?"\u{1F920}":t==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),y(),H(" ",i.settings.t(i.settings.getDifficultyLabel(t))," ")}}function PW(n,e){if(n&1){let t=Je();E(0,"button",383),ce("click",function(){let r=ie(t).$implicit,o=O(2);return re(o.onMapSizeChange(r))}),v(1),x()}if(n&2){let t=e.$implicit,i=O(2);Pe("bg-gradient-to-br",i.settings.mapSize()===t)("from-indigo-600",i.settings.mapSize()===t)("to-indigo-800",i.settings.mapSize()===t)("text-white",i.settings.mapSize()===t)("shadow-lg",i.settings.mapSize()===t)("text-stone-500",i.settings.mapSize()!==t)("hover:text-stone-300",i.settings.mapSize()!==t),y(),tn(" ",t,"x",t," ")}}function kW(n,e){if(n&1){let t=Je();E(0,"div",230)(1,"div",365),K(2,"div",366),E(3,"h3",367),v(4),x(),E(5,"button",368),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.toggleSettings())}),v(6," \u2716 "),x()(),E(7,"div",369)(8,"div",190)(9,"label",370),v(10),x(),E(11,"span",371),v(12),x()(),E(13,"div",372),wn(14,NW,4,20,"button",373,Cr),x()(),E(16,"div",369)(17,"label",374),v(18),x(),E(19,"div",375),wn(20,PW,2,16,"button",376,Cr),x()(),E(22,"div",377)(23,"button",378),ce("click",function(){ie(t);let r=O();return re(r.settings.setLang("uk"))}),v(24," UA "),x(),E(25,"button",378),ce("click",function(){ie(t);let r=O();return re(r.settings.setLang("en"))}),v(26," EN "),x()(),E(27,"label",379)(28,"div",109)(29,"input",110),ce("change",function(r){ie(t);let o=O();return re(o.setCustomMode(r.target.checked))}),x(),E(30,"div",380),K(31,"div",112),x()(),E(32,"span",113),v(33,"Custom Mode"),x()()()}if(n&2){let t=O();y(4),W(t.settings.t("SYSTEM_SETTINGS")),y(6),H(" ",t.settings.t("TACTICAL_DIFF")," "),y(2),H(" ",t.settings.t("LEVEL_SELECTION")," "),y(2),xn(t.settings.diffArr),y(4),H(" ",t.settings.t("SECTOR_DIMENSIONS")," "),y(2),xn(la(13,hz)),y(3),Pe("text-blue-300",t.settings.currentLang()==="uk")("text-stone-400",t.settings.currentLang()!=="uk"),y(2),Pe("text-blue-300",t.settings.currentLang()==="en")("text-stone-400",t.settings.currentLang()!=="en"),y(4),$e("checked",t.settings.customMode())}}function OW(n,e){if(n&1&&(E(0,"div",392)(1,"span"),v(2),Ar(3,"date"),x(),E(4,"span",396),v(5),x(),E(6,"span",397),v(7),x()()),n&2){let t=e.$implicit,i=O(2);y(2),W(oo(3,4,t.date,"yyyy-MM-dd HH:mm")),y(3),W(t.condition),y(2),tn("",t.turns," ",i.settings.t("TURNS"))}}function FW(n,e){if(n&1&&(E(0,"div",393),v(1),x()),n&2){let t=O(2);y(),W(t.settings.t("NO_RECORDS_YET"))}}function LW(n,e){if(n&1&&(E(0,"div",392)(1,"span"),v(2),Ar(3,"date"),x(),E(4,"span",396),v(5),x(),E(6,"span",397),v(7),x()()),n&2){let t=e.$implicit,i=O(2);y(2),W(oo(3,4,t.date,"yyyy-MM-dd HH:mm")),y(3),W(t.condition),y(2),tn("",t.turns," ",i.settings.t("TURNS"))}}function VW(n,e){if(n&1&&(E(0,"div",393),v(1),x()),n&2){let t=O(2);y(),W(t.settings.t("NO_RECORDS_YET"))}}function UW(n,e){if(n&1){let t=Je();E(0,"div",231)(1,"div",384)(2,"div",385)(3,"h2",386),v(4),x(),E(5,"button",387),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.closeHighScores())}),v(6," \u2716 "),x()(),E(7,"div",388),v(8),x(),E(9,"div",389)(10,"div",390)(11,"h3",391),v(12),x(),wn(13,OW,8,7,"div",392,qk,!1,FW,2,1,"div",393),x(),E(16,"div",390)(17,"h3",394),v(18),x(),wn(19,LW,8,7,"div",392,qk,!1,VW,2,1,"div",393),x()(),E(22,"div",395),v(23),x()()()}if(n&2){let t=O();y(4),W(t.settings.t("HIGH_SCORES")),y(4),es(" ",t.settings.t("CURRENT"),": ",t.settings.t(t.settings.difficultyLabel())," \u2022 ",t.settings.mapSizeLabel()," "),y(4),W(t.settings.t("TOP_3_PLAYER")),y(),xn(t.gameEngine.getHighScoresForCurrentCombo().wins),y(5),W(t.settings.t("TOP_3_LOSES_PLAYER")),y(),xn(t.gameEngine.getHighScoresForCurrentCombo().losses),y(4),W(t.settings.t("CHANGE_RECORDS_INFO"))}}function BW(n,e){if(n&1){let t=Je();E(0,"div",232)(1,"div",398),v(2," Debug Mode "),x(),E(3,"button",399),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.debugInstantWin())}),v(4," \u26A1 Instant Win "),x(),E(5,"button",400),ce("click",function(){ie(t);let r=O();return re(r.gameEngine.debugCycleSettings())}),v(6," \u{1F504} Cycle Settings "),x(),E(7,"div",401),v(8),x()()}if(n&2){let t=O();y(8),tn(" ",t.settings.difficultyLabel()," | ",t.settings.mapSizeLabel()," ")}}var f0=class n{constructor(e,t,i,r){this.gameEngine=e;this.settings=t;this.firebase=i;this.router=r}boardContainer;isAutoBattleActive=G(!1);isMobileMenuOpen=G(!1);lastEconomyProcessedTurn=-1;ngOnInit(){this.gameEngine.resetGame()}ngOnDestroy(){this.isAutoBattleActive.set(!1),this.gameEngine.pauseGame()}goToHub(){this.isAutoBattleActive.set(!1),this.router.navigate(["/"])}get isProduction(){return!aM()}toggleMobileMenu(){this.isMobileMenuOpen.update(e=>!e)}closeMobileMenu(){this.isMobileMenuOpen.set(!1)}toggleAutoBattle(){this.isAutoBattleActive.update(e=>!e),this.isAutoBattleActive()&&this.executeAutoMoveLoop()}navigateToFeedback(){if(this.firebase.user$()){this.router.navigate(["/feedback"]);return}try{this.firebase.loginWithGoogle()}catch{}}navigateToRoadmap(){this.router.navigate(["/roadmap"])}ngAfterViewInit(){setTimeout(()=>{let e=this.boardContainer?.nativeElement;typeof window<"u"&&e&&typeof e.scrollTo=="function"&&e.scrollTo({left:0,top:0})},0)}centerOnSelectedUnit(){let e=this.boardContainer?.nativeElement;if(!e)return;let t=this.gameEngine.selectedUnit();if(!t)return;let i=this.gameEngine.tileSizePx,r=this.gameEngine.wallThicknessPx+2,o=i+r,s=t.position.x*o+i/2,a=t.position.y*o+i/2,l=Math.max(0,Math.min(s-e.clientWidth/2,e.scrollWidth-e.clientWidth)),c=Math.max(0,Math.min(a-e.clientHeight/2,e.scrollHeight-e.clientHeight));e.scrollTo({left:l,top:c,behavior:"smooth"})}activeKeys=new Set;onKeyDown(e){if(this.gameEngine.gameStatus()!=="playing")return;let t=e.key;if(t==="Tab"||t===" "||e.code==="Space"){e.preventDefault(),this.gameEngine.isPlayerTurn()&&this.gameEngine.selectNextAvailableUnitTab();return}if(t==="Enter"){e.preventDefault(),this.gameEngine.endPlayerTurn();return}let i=this.gameEngine.selectedUnit();if(!i||i.hasActed)return;this.activeKeys.add(t);let r=0,o=0;if((this.activeKeys.has("ArrowUp")||this.activeKeys.has("w")||this.activeKeys.has("W"))&&(o-=1),(this.activeKeys.has("ArrowDown")||this.activeKeys.has("s")||this.activeKeys.has("S"))&&(o+=1),(this.activeKeys.has("ArrowLeft")||this.activeKeys.has("a")||this.activeKeys.has("A"))&&(r-=1),(this.activeKeys.has("ArrowRight")||this.activeKeys.has("d")||this.activeKeys.has("D"))&&(r+=1),r===0&&o===0)return;e.preventDefault();let s=this.gameEngine.validMoves(),l=r!==0&&o!==0?i.tier===4?3:1:i.tier>=3||i.tier===2?2:1,c=null;for(let d=1;d<=l;d++){let h=i.position.x+r*d,p=i.position.y+o*d,g={x:h,y:p};if(s.some(S=>S.x===h&&S.y===p))c=g;else break}if(!c){let d={x:i.position.x,y:i.position.y},h={x:i.position.x+r,y:i.position.y+o};if(this.gameEngine.getWallBetween(d.x,d.y,h.x,h.y)){this.gameEngine.attackOrDestroyWallBetween(d,h);return}let g=this.gameEngine.getUnitAt(h.x,h.y);if(g&&g.owner!==i.owner){this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.isValidMove(h.x,h.y)&&this.gameEngine.moveSelectedUnit(h);return}this.gameEngine.moveSelectedUnit(c)}onKeyUp(e){this.activeKeys.delete(e.key)}onDifficultyChange(e){this.settings.setDifficulty(e),this.gameEngine.resetGame()}onMapSizeChange(e){this.settings.setMapSize(e),setTimeout(()=>{let t=this.boardContainer?.nativeElement;typeof window<"u"&&t&&typeof t.scrollTo=="function"&&t.scrollTo({left:0,top:0})},0),this.gameEngine.resetGame()}onTileClick(e,t){if(this.gameEngine.gameStatus()!=="playing")return;if(this.settings.customMode()&&this.gameEngine.sandboxSpawnPending()){this.gameEngine.getUnitAt(e,t)||this.gameEngine.spawnSandboxAt({x:e,y:t});return}if(this.gameEngine.isDeployTarget(e,t)){this.gameEngine.deployTo({x:e,y:t});return}if(e===0&&t===0){this.gameEngine.startDeployFromBase();return}this.gameEngine.cancelDeploy();let i=this.gameEngine.getUnitAt(e,t);if(this.gameEngine.selectedUnit()&&this.gameEngine.isValidMove(e,t)){this.gameEngine.moveSelectedUnit({x:e,y:t});return}let r=this.gameEngine.selectedUnit();if(r){let o=e-r.position.x,s=t-r.position.y;if(Math.abs(o)+Math.abs(s)===1&&this.gameEngine.getWallBetween(r.position.x,r.position.y,e,t)){this.gameEngine.attackOrDestroyWallBetween(r.position,{x:e,y:t});return}}if(i&&i.owner==="player"){this.gameEngine.selectUnit(i.id);return}this.gameEngine.selectUnit(null)}setCustomMode(e){this.settings.setCustomMode(e),this.gameEngine.resetGame()}onEdgeClick(e,t,i,r,o){if(e.stopPropagation(),this.gameEngine.gameStatus()!=="playing")return;if(this.gameEngine.getWallBetween(t,i,r,o)){this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o});return}this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onDestroyIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.destroyOwnWallBetween({x:t,y:i},{x:r,y:o})}onBuildIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.buildMode()&&this.gameEngine.buildWallBetween({x:t,y:i},{x:r,y:o})}onAttackIconClick(e,t,i,r,o){e.stopPropagation(),this.gameEngine.gameStatus()==="playing"&&this.gameEngine.attackOrDestroyWallBetween({x:t,y:i},{x:r,y:o})}async executeAutoMoveLoop(){for(;this.isAutoBattleActive();)await this.executeAutoMove()}async executeAutoMove(){if(await new Promise(r=>setTimeout(r,250)),!this.isAutoBattleActive()||this.gameEngine.gameStatus()!=="playing"||!this.gameEngine.isPlayerTurn())return;let e=this.gameEngine.turn();this.lastEconomyProcessedTurn!==e&&(this.gameEngine.botEconomyPhase("player"),this.lastEconomyProcessedTurn=e),this.gameEngine.playerAutoStep()||this.gameEngine.selectUnit(null),this.gameEngine.remainingActions()===0&&(await new Promise(r=>setTimeout(r,1e3)),this.isAutoBattleActive()&&this.gameEngine.isPlayerTurn()&&this.gameEngine.endPlayerTurn())}static \u0275fac=function(t){return new(t||n)(ge(ii),ge(Rt),ge(jn),ge(Ei))};static \u0275cmp=Dt({type:n,selectors:[["app-game"]],viewQuery:function(t,i){if(t&1&&_l(dz,5),t&2){let r;El(r=bl())&&(i.boardContainer=r.first)}},hostBindings:function(t,i){t&1&&ce("keydown",function(o){return i.onKeyDown(o)},oa)("keyup",function(o){return i.onKeyUp(o)},oa)},decls:377,vars:124,consts:[["boardContainer",""],["nameInput",""],[1,"min-h-screen","bg-gray-900","text-white","flex","flex-col","items-center","justify-start","p-4","relative","overflow-hidden"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["aria-hidden","true",2,"position","absolute","width","0","height","0"],["id","vol-fill-player","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#bfdbfe"],["offset","60%","stop-color","#3b82f6"],["offset","100%","stop-color","#2563eb"],["id","vol-fill-ai","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#fecaca"],["offset","60%","stop-color","#ef4444"],["offset","100%","stop-color","#dc2626"],["id","vol-fill-emerald","cx","35%","cy","30%","r","70%"],["offset","0%","stop-color","#a7f3d0"],["offset","60%","stop-color","#10b981"],["offset","100%","stop-color","#059669"],["id","edge-light","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","white","stop-opacity","0.4"],["offset","100%","stop-color","white","stop-opacity","0"],["id","soft-shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2.5","flood-color","#000","flood-opacity","0.4"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],["id","triangle-border","viewBox","0 0 1 1","preserveAspectRatio","none"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05","fill","none","stroke","rgba(255,255,255,0.3)","stroke-width","2","vector-effect","non-scaling-stroke"],[1,"fixed","top-8","left-8","flex","items-start","gap-4","group","select-none","mobile-hide-logo"],["title","Return to Gaming Hub",1,"cursor-pointer","p-2","bg-slate-800/50","hover:bg-slate-700","border","border-slate-700/50","rounded-lg","transition-all","group/btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-slate-400","group-hover/btn:text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"relative","w-12","h-12","flex","items-center","justify-center"],[1,"absolute","inset-0","border-2","border-blue-500/30","rotate-45","group-hover:rotate-90","transition-all","duration-700"],[1,"absolute","inset-1","border","border-blue-400/20","-rotate-45","group-hover:rotate-0","transition-all","duration-1000"],["viewBox","0 0 24 24",1,"w-6","h-6","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]"],["fill","currentColor","d","M12 2L2 22h20L12 2zm0 4.5L18.5 20h-13L12 6.5z"],["x","11","y","12","width","2","height","5","fill","white",1,"animate-pulse"],[1,"absolute","-top-1","-left-1","w-2","h-2","border-t-2","border-l-2","border-blue-400"],[1,"absolute","-bottom-1","-right-1","w-2","h-2","border-b-2","border-r-2","border-blue-400"],[1,"flex","flex-col"],[1,"flex","items-baseline","gap-1"],[1,"text-3xl","font-black","tracking-tight","uppercase","leading-none","flex","flex-col"],[1,"text-white","drop-shadow-[0_0_5px_rgba(255,255,255,0.2)]"],[1,"text-blue-500","text-xl","mt-[-4px]","tracking-[0.15em]","opacity-90","group-hover:text-blue-400","transition-colors"],[1,"flex","gap-1","mb-1"],[1,"w-1","h-3","bg-blue-600/40"],[1,"w-1","h-3","bg-blue-600/20"],[1,"flex","items-center","ml-1"],[1,"text-[10px]","font-mono","text-blue-300","font-bold","leading-none"],[1,"absolute","-inset-4","bg-blue-600/5","opacity-0","group-hover:opacity-50","transition-opacity","blur-2xl","-z-10"],[1,"nav-bar","w-full","max-w-5xl","flex","items-center","justify-between","mb-2","px-4","py-1","rounded-full","bg-white/[0.03]","backdrop-blur-md","border","border-white/5","shadow-2xl"],[1,"flex","items-center","gap-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-blue-500/10","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-blue-400","group-hover:rotate-180","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-blue-300","transition-colors"],[1,"w-[1px]","h-4","bg-white/10","mx-1"],[1,"cursor-pointer","group","flex","items-center","gap-2","px-4","py-2","rounded-full","hover:bg-white/5","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-stone-400","group-hover:text-white","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","group-hover:text-white"],[1,"flex","items-center","bg-black/20","rounded-full","px-2","py-1","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-yellow-400","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-50","group-hover:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-[10px]","font-bold","uppercase","tracking-tighter"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-red-400","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","hover:bg-white/5","text-stone-400","hover:text-indigo-300","transition-all","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8h2a2 2 0 012 2v9l-4-4H7a2 2 0 01-2-2V6a2 2 0 012-2h8"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","w-8","h-8","flex","items-center","justify-center","rounded-full","bg-white/5","border","border-white/10","hover:bg-blue-500/20","transition-all","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-stone-400","group-hover:text-blue-400","group-hover:rotate-90","transition-all","duration-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-3","pl-3","pr-1","py-1","rounded-full","bg-white/5","border","border-white/10","shadow-inner"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group"],[1,"mobile-hud-header","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-between","gap-3","rounded-xl","bg-gray-900/60","border","border-white/10","backdrop-blur-md"],[1,"hud-item","flex","items-center","gap-2"],["width","20","height","20","viewBox","0 0 24 24"],["x","7","y","14","width","13","height","6","rx","3","fill","#8B5E3C"],["cx","7","cy","17","r","3","fill","#A67B5B"],[1,"hud-value","font-mono","text-sm","font-bold","text-emerald-400"],["d","M6 18 L10 12 L14 18 Z","fill","#9ca3af"],["cx","12","cy","10","r","3","fill","#6b7280"],[1,"hud-value","font-mono","text-sm","font-bold","text-slate-300"],["points","12,3 6,13 9,13 4,21 20,21 15,13 18,13","fill","#6fbf73"],[1,"hud-value","font-mono","text-sm","font-bold","text-blue-300"],["cx","12","cy","12","r","9","stroke","#d1b54a","fill","none"],["d","M12 7 L12 12 L16 14","stroke","#d1b54a","stroke-width","2"],[1,"hud-value","font-mono","text-sm","font-bold","text-yellow-300"],["d","M4 20 L20 20","stroke","#999"],["x","6","y","8","width","4","height","8","fill","#3b82f6"],["x","14","y","6","width","4","height","10","fill","#ef4444"],[1,"hud-value","font-mono","text-sm","font-bold","text-white"],[1,"burger-btn","w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white",3,"click"],["width","18","height","18","viewBox","0 0 24 24"],["d","M4 6h16M4 12h16M4 18h16","stroke","#fff","stroke-width","2"],[1,"actions-bar","w-full","max-w-5xl","px-3","py-2","flex","items-center","justify-center","gap-4"],[1,"action-btn",3,"click","disabled"],["d","M3 21 L9 15 L5 11 L11 5 L13 7 L17 3 L21 7 L17 11 L19 13 L13 19 Z","fill","#e5e7eb"],[1,"flex","items-center","gap-1","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"relative","flex","items-center"],["type","checkbox",1,"peer","h-4","w-4","opacity-0","absolute",3,"change","checked"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-blue-500","peer-checked:border-blue-500","transition-all"],[1,"h-2","w-2","bg-white","rounded-full","opacity-0","peer-checked:opacity-100"],[1,"text-[10px]","uppercase","tracking-widest","text-gray-400","font-bold"],[1,"mt-1","text-[10px]","uppercase","tracking-widest","font-bold","text-gray-300"],[1,"action-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],[1,"mobile-menu-overlay","fixed","inset-0","bg-black/70","z-50","flex","items-start","justify-end"],[1,"status-bar","w-full","max-w-6xl","flex","items-center","justify-between","mb-8","px-6","py-3","rounded-2xl","bg-gray-900/40","backdrop-blur-xl","border","border-white/10","shadow-[0_10px_30px_rgba(0,0,0,0.5)]","relative","overflow-hidden"],[1,"absolute","bottom-0","left-0","h-[1px]","bg-gradient-to-r","from-transparent","via-blue-500/50","to-transparent","w-full"],[1,"flex","items-center","gap-6"],[1,"flex","flex-col","items-start"],[1,"text-[10px]","uppercase","tracking-widest","text-blue-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]"],[1,"h-10","w-[1px]","bg-white/5"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white/5","border","border-white/5","shadow-inner"],[1,"text-lg"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","7","cy","17","r","3","fill","#A67B5B","stroke","#724A2D","stroke-width","1"],["cx","7","cy","17","r","1.5","stroke","#724A2D","stroke-width","0.5"],["x","7","y","5","width","13","height","6","rx","3","fill","#A67B5B"],["cx","7","cy","8","r","3","fill","#C49A6C","stroke","#8B5E3C","stroke-width","1"],["cx","7","cy","8","r","1.5","stroke","#8B5E3C","stroke-width","0.5"],[1,"font-mono","text-lg","font-bold","text-emerald-400"],["width","24","height","24","viewBox","0 0 24 24"],[1,"font-mono","text-lg","font-bold","text-slate-300"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-blue-500/10","border","border-blue-500/20","shadow-inner"],[1,"w-8","h-8","flex-shrink-0"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["points","14,18 6,32 10,32 2,48 22,48 14,32 18,32","fill","#3f8f5c","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.7"],["x","11","y","48","width","4.5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["points","34,10 20,28 26,28 14,50 46,50 34,28 40,28","fill","#6fbf73","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.85"],["x","31","y","50","width","6","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.5"],["points","48,16 36,32 42,32 32,50 60,50 50,32 56,32","fill","#5fae7a","stroke","#2e6b4c","stroke-width","2","stroke-linejoin","round","opacity","0.75"],["x","45","y","50","width","5","height","6","fill","#4f9f68","stroke","#2e6b4c","stroke-width","1.2"],["transform","translate(-14,-1) scale(1.4)"],["x","28.5","y","18","width","3","height","20","fill","#71411e"],["points","31,18 52,22 31,26","fill","#0800ff"],["transform","translate(10,52) scale(0.3)"],["x","0","y","0","width","68","height","14","rx","7","fill","#d89b5a","stroke","#5a3418","stroke-width","2"],["cx","10","cy","7","r","3","fill","#5a3418"],["cx","58","cy","7","r","3","fill","#5a3418"],[1,"font-mono","text-lg","font-bold","text-blue-300"],[1,"text-xs","text-white/30","mx-1"],[1,"flex","flex-col","items-center","justify-center","px-8","relative"],[1,"absolute","inset-0","bg-yellow-500/5","blur-2xl","rounded-full"],[1,"text-[10px]","uppercase","tracking-[0.3em]","text-stone-500","font-bold"],[1,"text-3xl","font-black","text-yellow-400","drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"],[1,"absolute","monopoly-top","whitespace-nowrap","px-4","py-1","rounded-full","bg-emerald-500/20","border","border-emerald-500/30","text-[10px]","font-black","uppercase","tracking-widest","text-emerald-300","animate-pulse"],[1,"font-mono","text-lg","font-bold","text-red-400"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-red-500/10","border","border-red-500/20","shadow-inner"],[1,"font-mono","text-lg","font-bold","text-red-300"],["points","31,18 52,22 31,26","fill","#ef4444"],[1,"flex","flex-col","items-end"],[1,"text-[10px]","uppercase","tracking-widest","text-red-400","font-black","mb-1"],[1,"text-xl","font-black","text-white","drop-shadow-[0_0_8px_rgba(239,68,68,0.5)]"],[1,"end-overlay","fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"mobile-actions-compact","roadmap","mobile-actions-compact-plan","fixed","bottom-20","right-6","z-50","flex","items-center","group","cursor-pointer","outline-none","translate-x-2","hover:translate-x-0","transition-transform","duration-300",3,"click"],[1,"h-10","mobile-actions-hide-text","px-4","bg-blue-600/20","border-y","border-l","border-blue-500/50","backdrop-blur-md","flex","items-center","gap-3","group-hover:bg-blue-600/40","transition-all"],[1,"w-1.5","h-1.5","bg-blue-400","rotate-45","animate-pulse"],[1,"text-[11px]","font-black","uppercase","tracking-[0.3em]","text-blue-100","drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"],[1,"h-10","w-10","bg-blue-600/30","border","border-blue-500/50","flex","items-center","justify-center","group-hover:bg-blue-600","transition-all","shadow-[0_0_15px_rgba(37,99,235,0.2)]"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","group-hover:scale-125","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M13 5l7 7-7 7M5 5l7 7-7 7"],["aria-label","Support the Project",1,"mobile-actions-compact","fixed","bottom-4","right-4","z-50","px-4","py-2","rounded-full","bg-pink-600","hover:bg-pink-500","text-white","shadow-xl","cursor-pointer","flex","items-center","gap-2","support-pulse",3,"click"],[1,"text-lg","mb-[2px]","mobile-actions-hide-text"],[1,"relative","z-10"],[1,"board","max-w-[90vw]","max-h-[90vh]","overflow-auto","bg-gray-800","p-2","rounded-lg","border","border-gray-700","select-none","relative","mx-auto","my-auto","no-select"],[1,"grid"],[1,"absolute","top-2","left-2","w-12","h-12","border-2","border-blue-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"text-white","font-bold","bg-blue-600","px-1","rounded","shadow","text-xs"],[1,"absolute","bottom-2","right-2","w-12","h-12","border-2","border-red-500/30","rounded","pointer-events-none","flex","items-center","justify-center"],[1,"mt-4","absolute","top-0","right-[-184px]","min-w-[170px]"],[1,"relative","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl","overflow-hidden","group"],[1,"absolute","-top-10","-right-10","w-24","h-24","blur-[40px]","opacity-20","transition-colors","duration-500"],[1,"relative","z-10","flex","flex-col","gap-1"],[1,"text-[10px]","uppercase","tracking-[0.2em]","text-stone-400","font-black"],[1,"flex","items-center","justify-between"],[1,"font-mono","text-xl","font-bold","capitalize","tracking-tight","transition-colors","duration-300"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-lg","bg-white/5","border","border-white/10","shadow-inner"],[1,"mt-2","h-[4px]","w-full","bg-gray-800","rounded-full","overflow-hidden"],[1,"h-full","transition-all","duration-700","ease-out","shadow-[0_0_8px]"],[1,"mt-4","flex","flex-col","items-start","gap-2","absolute","top-0","left-[-208px]","p-4","rounded-2xl","bg-gray-900/40","backdrop-blur-md","border","border-white/10","shadow-2xl"],[1,"flex","gap-2","flex-col","w-full"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-green-400/30","bg-gradient-to-br","from-green-600/20","to-green-800/40","hover:from-green-500/40","hover:to-green-700/60","shadow-[0_0_15px_rgba(34,197,94,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","z-10"],[1,"text-green-200","text-xs","tracking-widest","uppercase"],[1,"text-white"],[1,"h-2","w-2","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/10","to-transparent","-translate-x-full","group-hover:animate-[shimmer_1.5s_infinite]","pointer-events-none"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","flex","items-center","justify-between","gap-3","overflow-hidden","border","border-blue-400/30","bg-gradient-to-br","from-blue-600/20","to-blue-800/40","hover:from-blue-500/40","hover:to-blue-700/60","shadow-[0_0_15px_rgba(59,130,246,0.2)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-0","z-10"],[1,"text-blue-200"],[1,"scale-95","origin-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M4 20V8L6 5L8 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["d","M9 20V6L11 3L13 6V20","fill","#A67B5B","stroke","#5D4037","stroke-width","1"],["d","M14 20V8L16 5L18 8V20","fill","#8B5E3C","stroke","#5D4037","stroke-width","1"],["x","3","y","12","width","18","height","2","fill","#5D4037"],[1,"flex","flex-center","bg-black/40","px-2","py-1","rounded-lg","border","border-white/10","z-10","text-red-300"],[1,"w-6","h-6","flex-shrink-0","rotate-90"],["viewBox","0 0 64 64","xmlns","http://www.w3.org/2000/svg"],["x","8","y","26","width","48","height","14","rx","7","fill","#c68642","stroke","#8b5a2b","stroke-width","3"],["cx","14","cy","33","r","3","fill","#8b5a2b"],["cx","50","cy","33","r","3","fill","#8b5a2b"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-emerald-400/30","bg-gradient-to-br","from-emerald-600/20","to-emerald-800/40","hover:from-emerald-500/40","hover:to-emerald-700/60","shadow-[0_0_15px_rgba(16,185,129,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10"],[1,"flex","flex-center","text-emerald-200"],[1,"text-emerald-200","text-lg"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","justify-between","w-full","gap-0","z-10","text-amber-200"],[1,"text-xs","uppercase","tracking-tighter"],[1,"mt-2","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"cursor-pointer","group","relative","px-4","py-3","rounded-xl","text-sm","font-bold","transition-all","duration-200","border","border-amber-400/30","bg-gradient-to-br","from-amber-600/20","to-amber-800/40","hover:from-amber-500/40","hover:to-amber-700/60","shadow-[0_0_15px_rgba(245,158,11,0.1)]","active:scale-95","disabled:opacity-40","disabled:grayscale","disabled:cursor-not-allowed",3,"click"],[1,"flex","items-center","justify-between","w-full","gap-2","z-10","text-amber-200"],[1,"fixed","bottom-2","left-2","text-[8px]","text-gray-300"],[1,"fixed","inset-y-0","right-0","w-85","bg-black/60","backdrop-blur-md","border-l","border-white/10","p-6","z-50","shadow-2xl","flex","flex-col","transition-all","duration-300"],[1,"fixed","inset-y-0","left-0","w-72","bg-black/60","backdrop-blur-xl","border-r","border-white/10","p-6","z-50","shadow-[10px_0_30px_rgba(0,0,0,0.5)]","flex","flex-col","gap-[24px]","transition-all","animate-in","slide-in-from-left","duration-300"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"fixed","bottom-10","left-4","z-[9999]","flex","flex-col","gap-2","bg-black/80","p-2","rounded","border","border-red-500","shadow-lg","backdrop-blur-sm"],[1,"flex","flex-col","items-end","leading-none"],[1,"text-[9px]","font-black","text-blue-400","uppercase","tracking-tighter","mb-0.5"],[1,"cursor-pointer","text-[9px]","text-stone-500","hover:text-red-400","uppercase","font-bold","tracking-widest","transition-colors",3,"click"],[1,"relative"],["referrerpolicy","no-referrer",1,"w-8","h-8","rounded-full","border","border-blue-500/30","shadow-[0_0_10px_rgba(59,130,246,0.3)]",3,"src"],[1,"absolute","-bottom-0.5","-right-0.5","w-2.5","h-2.5","bg-green-500","border-2","border-gray-900","rounded-full"],[1,"cursor-pointer","flex","items-center","gap-2","px-4","py-1.5","rounded-full","bg-blue-600/10","border","border-blue-500/20","hover:bg-blue-600/30","transition-all","group",3,"click"],[1,"w-1.5","h-1.5","bg-blue-500","rounded-full","animate-pulse"],[1,"text-[9px]","font-black","uppercase","tracking-widest","text-blue-200"],[1,"mobile-menu-panel","w-72","h-full","bg-gray-800","border-l","border-white/10","p-4","flex","flex-col","gap-3"],[1,"w-9","h-9","rounded-md","bg-white/10","border","border-white/20","flex","items-center","justify-center","text-white","self-end",3,"click"],["d","M6 6l12 12M18 6L6 18","stroke","#fff","stroke-width","2"],[1,"menu-link",3,"click"],[1,"end-dialog","bg-gray-800","p-8","rounded-lg","shadow-xl","border","border-gray-600","text-center"],[1,"text-4xl","font-bold","mb-4"],[1,"text-sm","text-gray-300","mb-4"],[1,"mb-4","flex","flex-col","items-center","gap-2"],[1,"px-6","py-3","bg-green-600","hover:bg-green-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"ml-3","px-6","py-3","bg-indigo-600","hover:bg-indigo-500","rounded","text-white","font-bold","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300"],["placeholder","Enter your name","autocomplete","off",1,"w-64","px-3","py-2","rounded","bg-gray-700","border","border-gray-600","text-white",3,"value"],[1,"px-4","py-2","bg-yellow-600","hover:bg-yellow-500","rounded","text-white","font-semibold","text-sm","cursor-pointer",3,"click"],[1,"text-white","font-bold","bg-red-600","px-1","rounded","shadow","text-xs"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"width","height","minWidth","minHeight","cursor-pointer","bg-gray-700","border-gray-600","bg-blue-900","bg-red-900","border-4","border-blue-400","border-red-400","ring-2","ring-blue-300","ring-red-300","spawn-zone-highlight","forest-area","mine-area","forge-area","bg-amber-900","border-amber-500","bg-gray-950","border-gray-800","bg-green-900","border-green-500","bg-cyan-900","border-cyan-500","animate-pulse","hover:bg-gray-600","hover:bg-green-800","hover:bg-cyan-800"],[1,"tile","rounded","flex","items-center","justify-center","border","transition-colors","duration-200",3,"click","mouseenter","mouseleave"],[1,"absolute","top-0","right-0","text-[8px]","text-gray-500","p-0.5","pointer-events-none"],[1,"absolute","inset-0","bg-red-800/20","border-2","border-red-500/40","border-dashed","pointer-events-none"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"z-index"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","translate-x-4","-translate-y-4"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500",3,"scale-50","opacity-40","-translate-x-4","translate-y-4"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none",3,"height"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim",3,"z-index","opacity"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-2","-right-2","text-xl","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","top-1","left-1","text-[10px]","px-1.5","py-0.5","rounded","bg-yellow-600/80","hover:bg-yellow-500","text-black","shadow","cursor-pointer",3,"click"],[1,"absolute","bottom-1","left-1","text-[10px]","font-bold","px-1","rounded","bg-yellow-400/80","text-black","pointer-events-none"],[1,"absolute","text-[10px]","font-bold","px-1","rounded","bg-yellow-300/80","text-black","pointer-events-none"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90",3,"z-index"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col",3,"z-index"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","opacity-90"],["viewBox","0 0 128 128",1,"w-full","h-full"],["transform","translate(0,10) scale(1)"],["x","20","y","80","width","88","height","18","rx","4","fill","#6b7280"],["x","30","y","70","width","68","height","12","rx","3","fill","#9ca3af"],["d","M32 40 H96 L86 56 H42 Z","fill","#4b5563"],["x","56","y","30","width","16","height","12","rx","2","fill","#6b7280"],["x","60","y","20","width","8","height","12","rx","2","fill","#9ca3af"],[1,"absolute","bottom-1","right-1","flex","gap-1","flex-col"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-indigo-500","hover:bg-indigo-400","text-white","shadow","cursor-pointer",3,"click"],[1,"text-[9px]","px-1","py-0.5","rounded","bg-emerald-500","hover:bg-emerald-400","text-white","shadow","cursor-pointer",3,"click"],[1,"absolute","inset-0","pointer-events-none","flex","items-center","justify-center","transition-all","duration-500"],["viewBox","0 0 128 128","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full"],["id","treeGrad","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#9be7b3"],["offset","100%","stop-color","#4f9f68"],["opacity","0.4"],["points","64,22 36,66 50,66 28,98 100,98 78,66 92,66","fill","url(#treeGrad)","stroke","#1e3a2b","stroke-width","4","stroke-linejoin","round"],["x","58","y","98","width","12","height","16","fill","#3f7f5c"],["points","28,60 12,90 22,90 8,112 48,112 34,90 44,90","fill","#1f3b2d"],["points","100,58 84,90 94,90 80,112 120,112 106,90 116,90","fill","#1f3b2d"],["transform","translate(10,105) scale(0.8)"],["width","60","height","12","rx","6","fill","#8b5a2b","stroke","#4a2a12","stroke-width","2"],["transform","translate(78, 30) rotate(15) scale(1.5)"],["width","4","height","30","rx","2","fill","#7a4a21"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#9aa3a8","transform","translate(4,0)"],["cx","64","cy","96","rx","40","ry","10","fill","#374151"],["d","M32 96 L56 48 L72 80 L96 96 Z","fill","#6b7280","stroke","#4b5563","stroke-width","4"],["cx","58","cy","60","r","6","fill","#9ca3af"],["transform","translate(82, 30) rotate(-20) scale(1.3)"],["width","4","height","30","rx","2","fill","#6b7280"],["d","M0 0 C10 -2, 12 8, 2 12 Z","fill","#f59e0b","transform","translate(4,0)"],[1,"absolute","top-0","left-0","right-0","bg-green-400/70","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-blue-900","bg-blue-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","left-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-blue-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","inset-x-0","top-0","m-0.5","text-[10px]","font-extrabold","text-red-900","bg-red-300/80","rounded","px-1","pointer-events-none"],[1,"absolute","right-0","bottom-0","m-0.5","text-[10px]","font-extrabold","text-white","bg-red-600/90","rounded","px-1","pointer-events-none"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"right","width","height","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"width","height","z-index","bg-red-600","bg-yellow-500","bg-gray-600"],[1,"absolute","cursor-pointer","shadow-2xl","flex","items-center","justify-center","text-white","rounded-full","border","border-white/20","hover:scale-110","active:scale-95","transition-all","z-[45]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-1/2","h-1/2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"absolute","rounded-xs","right-0","top-0","h-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","right-0","top-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","p-1",3,"click"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-lime-700","bg-transparent"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"bottom","height","width","z-index","transition","bg-blue-400","bg-red-400","wall-formation-player","wall-formation-ai","bg-gray-300","shake","wall-formation-active"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center",3,"mouseenter","mouseleave"],[1,"absolute","rounded-xs","left-0","bottom-0","w-full","flex","items-center","justify-center"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"fontSize","width","height","z-index"],[1,"absolute","whitespace-nowrap","left-0","bottom-0","text-[8px]","text-yellow-300","px-1"],[1,"bg-green-500","cursor-pointer","text-white","rounded-full","shadow-lg","flex","items-center","justify-center",3,"click"],[1,"pointer-events-none","move-anim",3,"shake","transform","z-index"],[1,"pointer-events-none","move-anim"],[1,"unit-svg-wrapper"],[3,"unit"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow",3,"bg-green-600","bg-amber-600","bg-red-600","z-index"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-top-1","-left-1","px-0.5","py-0.5","rounded","text-white","text-[8px]","font-bold","pointer-events-none","shadow"],[1,"absolute","-bottom-1","-right-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-right-1","opacity-70","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]",3,"z-index"],[1,"absolute","-bottom-1","-left-1","opacity-70","[style.z-index]='100'"],[1,"absolute","-bottom-1","-left-1","[filter:drop-shadow(0_0_2px_rgba(0,0,0,0.5))]"],[1,"absolute","inset-0","flex","items-center","justify-center","pointer-events-none","transition-opacity","duration-500","combat-text-anim"],[1,"font-extrabold"],[1,"w-10","h-10","absolute","top-4","-left-5","rounded-full","bg-[#1e293b]","border","border-white/20","hover:bg-[#334155]","text-white","shadow-lg","flex","items-center","justify-center","transition-transform","hover:scale-110","cursor-pointer",3,"click"],[1,"text-xl"],[1,"border-b","border-white/10","pb-4","mb-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xl","font-black","uppercase","tracking-tighter","text-transparent","bg-clip-text","bg-gradient-to-r","from-blue-400","to-purple-400"],["title","Clear all logs",1,"flex","items-center","gap-1.5","px-2","py-1","rounded","bg-red-500/10","hover:bg-red-500/20","border","border-red-500/30","text-red-400","text-[10px]","uppercase","font-bold","tracking-wider","transition-all","hover:scale-105","active:scale-95","cursor-pointer",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","items-center","gap-3","group","cursor-pointer"],["type","checkbox",1,"peer","h-5","w-5","opacity-0","absolute","cursor-pointer",3,"change","checked"],[1,"h-5","w-5","border-2","border-white/30","rounded","bg-white/5","peer-checked:bg-blue-500","peer-checked:border-blue-400","transition-all"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","h-3.5","w-3.5","text-white","opacity-0","peer-checked:opacity-100","left-0.5","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"text-sm","font-medium","text-gray-300","group-hover:text-white","transition-colors"],[1,"flex-1","overflow-y-auto","pr-2","space-y-3","custom-scrollbar"],[1,"text-center","py-10","text-gray-500","italic","text-sm"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300",3,"border-l-4","border-left-color"],[1,"p-3","rounded-lg","bg-white/5","border","border-white/5","hover:bg-white/10","transition-colors","text-[13px]","leading-relaxed","shadow-sm","animate-in","fade-in","slide-in-from-right-4","duration-300"],[1,"font-medium"],[1,"relative","flex","items-center","gap-3","border-b","border-white/5","pb-4"],[1,"w-2","h-6","bg-blue-500","rounded-full","shadow-[0_0_10px_rgba(59,130,246,0.5)]"],[1,"text-xl","font-black","uppercase","tracking-widest","text-white/90"],[1,"w-8","h-8","absolute","top-0","-right-10","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"flex","flex-col","gap-4"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400"],[1,"text-[10px]","px-2","py-0.5","rounded","bg-white/5","border","border-white/10","text-stone-300","italic"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"bg-blue-500/20","border-blue-400/40","text-blue-200","shadow-[0_0_15px_rgba(59,130,246,0","bg-white/5","border-white/5","text-stone-500","hover:bg-white/10"],[1,"text-[10px]","font-black","uppercase","tracking-widest","text-stone-400","ml-1","text-left"],[1,"flex","p-1","bg-black/40","rounded-2xl","border","border-white/5","shadow-inner"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"bg-gradient-to-br","from-indigo-600","to-indigo-800","text-white","shadow-lg","text-stone-500","hover:text-stone-300"],[1,"flex","items-center","gap-1","px-1","py-0.5","rounded-full","bg-white/5","border","border-white/10"],[1,"cursor-pointer","text-[9px]","font-black","uppercase","tracking-widest","px-2","py-0.5","rounded-full",3,"click"],[1,"mt-3","flex","items-center","gap-3","w-full","px-2","py-2","rounded-lg","hover:bg-white/5","transition-colors","cursor-pointer","border","border-transparent","hover:border-white/5"],[1,"h-4","w-4","border-2","border-gray-500","rounded","flex","items-center","justify-center","peer-checked:bg-pink-500","peer-checked:border-pink-500","transition-all"],[1,"px-3","py-2","rounded-xl","text-xs","font-bold","capitalize","cursor-pointer","transition-all","duration-200","border","flex","items-center","justify-center","gap-2","group",3,"click"],[1,"opacity-0","group-hover:opacity-100","transition-opacity"],[1,"cursor-pointer","flex-1","py-2","rounded-xl","text-xs","font-bold","transition-all","duration-300",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","shadow-xl","border","border-gray-600","w-[680px]","max-w-[95vw]"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl","font-bold"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","bg-gray-700","hover:bg-gray-600","text-lg","cursor-pointer",3,"click"],[1,"text-sm","text-gray-300","mb-2"],[1,"grid","grid-cols-2","gap-4"],[1,"bg-gray-800/60","border","border-gray-700","rounded-lg","p-3"],[1,"text-lg","font-semibold","mb-2","text-green-400"],[1,"flex","justify-between","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2","text-red-400"],[1,"mt-4","text-xs","text-gray-400"],[1,"font-mono"],[1,"font-mono","text-yellow-300"],[1,"text-red-500","font-bold","text-xs","uppercase","text-center","mb-1","border-b","border-red-900/50","pb-1"],[1,"bg-red-900/40","hover:bg-red-800/60","text-red-100","text-xs","px-3","py-1.5","rounded","border","border-red-800","transition-colors","cursor-pointer",3,"click"],[1,"bg-blue-900/40","hover:bg-blue-800/60","text-blue-100","text-xs","px-3","py-1.5","rounded","border","border-blue-800","transition-colors","cursor-pointer",3,"click"],[1,"text-[10px]","text-gray-400","text-center","font-mono","mt-1"]],template:function(t,i){if(t&1){let r=Je();E(0,"div",2)(1,"div",3),K(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),x(),X(),E(7,"svg",9)(8,"defs")(9,"radialGradient",10),K(10,"stop",11)(11,"stop",12)(12,"stop",13),x(),E(13,"radialGradient",14),K(14,"stop",15)(15,"stop",16)(16,"stop",17),x(),E(17,"radialGradient",18),K(18,"stop",19)(19,"stop",20)(20,"stop",21),x(),E(21,"linearGradient",22),K(22,"stop",23)(23,"stop",24),x(),E(24,"filter",25),K(25,"feDropShadow",26),x()()(),E(26,"svg",27)(27,"defs")(28,"clipPath",28),K(29,"path",29),x(),E(30,"symbol",30),K(31,"path",31),x()()(),Ne(),E(32,"div",32)(33,"button",33),ce("click",function(){return ie(r),re(i.goToHub())}),X(),E(34,"svg",34),K(35,"path",35),x()(),Ne(),E(36,"div",36),K(37,"div",37)(38,"div",38),X(),E(39,"svg",39),K(40,"path",40)(41,"rect",41),x(),Ne(),K(42,"div",42)(43,"div",43),x(),E(44,"div",44)(45,"div",45)(46,"h1",46)(47,"span",47),v(48,"Shape"),x(),E(49,"span",48),v(50," Tactics "),x()(),E(51,"div",49),K(52,"div",50)(53,"div",51),x()(),E(54,"div",52)(55,"span",53),v(56),x()()(),K(57,"div",54),x(),E(58,"div",55)(59,"div",56)(60,"button",57),ce("click",function(){return ie(r),re(i.gameEngine.resetGame())}),X(),E(61,"svg",58),K(62,"path",59),x(),Ne(),E(63,"span",60),v(64),x()(),K(65,"div",61),E(66,"button",62),ce("click",function(){return ie(r),re(i.gameEngine.toggleRules())}),X(),E(67,"svg",63),K(68,"path",64),x(),Ne(),E(69,"span",65),v(70),x()()(),E(71,"div",66)(72,"button",67),ce("click",function(){return ie(r),re(i.gameEngine.toggleHighScores())}),X(),E(73,"svg",68),K(74,"path",69),x(),Ne(),E(75,"span",70),v(76),x()(),E(77,"button",71),ce("click",function(){return ie(r),re(i.gameEngine.toggleLeaderboard())}),X(),E(78,"svg",68),K(79,"path",72),x(),Ne(),E(80,"span",70),v(81),x()(),E(82,"button",73),ce("click",function(){return ie(r),re(i.gameEngine.toggleLog())}),X(),E(83,"svg",68),K(84,"path",74),x(),Ne(),E(85,"span",70),v(86),x()(),E(87,"button",75),ce("click",function(){return ie(r),re(i.navigateToFeedback())}),X(),E(88,"svg",68),K(89,"path",76),x(),Ne(),E(90,"span",70),v(91),x()()(),E(92,"div",77)(93,"button",78),ce("click",function(){return ie(r),re(i.gameEngine.toggleSettings())}),X(),E(94,"svg",79),K(95,"path",80)(96,"path",81),x()(),Y(97,pz,9,3,"div",82)(98,gz,4,1,"button",83),x()(),Ne(),E(99,"div",84)(100,"div",85),X(),E(101,"svg",86),K(102,"rect",87)(103,"circle",88),x(),Ne(),E(104,"span",89),v(105),x()(),E(106,"div",85),X(),E(107,"svg",86),K(108,"path",90)(109,"circle",91),x(),Ne(),E(110,"span",92),v(111),x()(),E(112,"div",85),X(),E(113,"svg",86),K(114,"polygon",93),x(),Ne(),E(115,"span",94),v(116),x()(),E(117,"div",85),X(),E(118,"svg",86),K(119,"circle",95)(120,"path",96),x(),Ne(),E(121,"span",97),v(122),x()(),E(123,"div",85),X(),E(124,"svg",86),K(125,"path",98)(126,"rect",99)(127,"rect",100),x(),Ne(),E(128,"span",101),v(129),x()(),E(130,"button",102),ce("click",function(){return ie(r),re(i.toggleMobileMenu())}),X(),E(131,"svg",103),K(132,"path",104),x()()(),Ne(),E(133,"div",105)(134,"button",106),ce("click",function(){return ie(r),re(i.gameEngine.toggleBuildMode())}),X(),E(135,"svg",86),K(136,"path",107),x()(),Ne(),E(137,"button",106),ce("click",function(){return ie(r),re(i.gameEngine.convertWoodToReserve())}),v(138," +1 "),x(),E(139,"button",106),ce("click",function(){return ie(r),re(i.gameEngine.maxConvertWoodToReserve())}),v(140),x(),E(141,"label",108)(142,"div",109)(143,"input",110),ce("change",function(){return ie(r),re(i.gameEngine.toggleFogDebug())}),x(),E(144,"div",111),K(145,"div",112),x()(),E(146,"span",113),v(147),x()(),E(148,"div",114),v(149),x(),E(150,"button",115),ce("click",function(){return ie(r),re(i.gameEngine.endPlayerTurn())}),X(),E(151,"svg",116),K(152,"path",117)(153,"path",118),x()()(),Y(154,vz,23,9,"div",119),Ne(),E(155,"div",120),K(156,"div",121),E(157,"div",122)(158,"div",123)(159,"span",124),v(160),x(),E(161,"span",125),v(162),x()(),K(163,"div",126),E(164,"div",127)(165,"div",128)(166,"span",129),X(),E(167,"svg",130),K(168,"rect",87)(169,"circle",131)(170,"circle",132)(171,"rect",133)(172,"circle",134)(173,"circle",135),x()(),Ne(),E(174,"span",136),v(175),x()(),E(176,"div",128)(177,"span",129),X(),E(178,"svg",137),K(179,"path",90)(180,"circle",91),x()(),Ne(),E(181,"span",138),v(182),x()(),E(183,"div",139)(184,"span",129)(185,"div",140),X(),E(186,"svg",141),K(187,"polygon",142)(188,"rect",143)(189,"polygon",144)(190,"rect",145)(191,"polygon",146)(192,"rect",147),E(193,"g",148),K(194,"rect",149)(195,"polygon",150),x(),E(196,"g",151),K(197,"rect",152)(198,"circle",153)(199,"circle",154),x()()()(),Ne(),E(200,"span",155),v(201),E(202,"span",156),v(203,"/"),x(),v(204),x()()()(),E(205,"div",157),K(206,"div",158),E(207,"span",159),v(208),x(),E(209,"div",45)(210,"span",160),v(211),x()(),Y(212,_z,2,3,"div",161),x(),E(213,"div",122)(214,"div",127)(215,"div",128)(216,"span",162),v(217),x(),E(218,"span",129),X(),E(219,"svg",130),K(220,"rect",87)(221,"circle",131)(222,"circle",132)(223,"rect",133)(224,"circle",134)(225,"circle",135),x()()(),Ne(),E(226,"div",128)(227,"span",129),X(),E(228,"svg",137),K(229,"path",90)(230,"circle",91),x()(),Ne(),E(231,"span",138),v(232),x()(),E(233,"div",163)(234,"span",164),v(235),E(236,"span",156),v(237,"/"),x(),v(238),x(),E(239,"span",129)(240,"div",140),X(),E(241,"svg",141),K(242,"polygon",142)(243,"rect",143)(244,"polygon",144)(245,"rect",145)(246,"polygon",146)(247,"rect",147),E(248,"g",148),K(249,"rect",149)(250,"polygon",165),x(),E(251,"g",151),K(252,"rect",152)(253,"circle",153)(254,"circle",154),x()()()()()(),Ne(),K(255,"div",126),E(256,"div",166)(257,"span",167),v(258),x(),E(259,"span",168),v(260,"jaerbi"),x()()()(),Y(261,wz,11,11,"div",169),E(262,"button",170),ce("click",function(){return ie(r),re(i.navigateToRoadmap())}),E(263,"div",171),K(264,"div",172),E(265,"span",173),v(266),x()(),E(267,"div",174),X(),E(268,"svg",175),K(269,"path",176),x()()(),Ne(),E(270,"button",177),ce("click",function(){return ie(r),re(i.gameEngine.toggleSupport())}),E(271,"span",129),v(272,"\u2764\uFE0F"),x(),E(273,"span",178),v(274),x()(),Y(275,xz,1,0,"app-support-community"),Y(276,Sz,1,0,"app-leaderboard-modal"),E(277,"div",179),Y(278,Iz,1,0,"app-sandbox"),E(279,"div",180,0)(281,"div",181)(282,"div",182)(283,"span",183),v(284),x()(),Y(285,Tz,3,1,"div",184),wn(286,CW,2,0,null,null,Cr),x()(),E(288,"div",185)(289,"div",186),K(290,"div",187),E(291,"div",188)(292,"span",189),v(293),x(),E(294,"div",190)(295,"span",191),v(296),x(),E(297,"div",192)(298,"span",129),v(299),x()()(),E(300,"div",193),K(301,"div",194),x()()()(),E(302,"div",195)(303,"div",196)(304,"button",197),ce("click",function(){return ie(r),re(i.toggleAutoBattle())}),E(305,"div",198)(306,"span",199),v(307),x(),E(308,"span",200),v(309),x()(),E(310,"div",198),K(311,"span",201),x(),K(312,"div",202),x(),E(313,"button",203),ce("click",function(){return ie(r),re(i.gameEngine.toggleBuildMode())}),E(314,"div",204)(315,"span",205),v(316,"+1"),x(),E(317,"div",206),X(),E(318,"svg",207),K(319,"path",208)(320,"path",209)(321,"path",210)(322,"rect",211),x()()(),Ne(),E(323,"div",212)(324,"span"),v(325,"-10"),x(),E(326,"div",213),X(),E(327,"svg",214),K(328,"rect",215)(329,"circle",216)(330,"circle",217),x()()(),Ne(),K(331,"div",202),x(),E(332,"button",218),ce("click",function(){return ie(r),re(i.gameEngine.convertWoodToReserve())}),E(333,"div",219)(334,"span",220)(335,"span"),v(336,"20"),x(),E(337,"div",213),X(),E(338,"svg",214),K(339,"rect",215)(340,"circle",216)(341,"circle",217),x()()(),Ne(),E(342,"span",129),v(343,"\u2794"),x(),E(344,"span",221),v(345,"1 \u{1F464}"),x()()(),E(346,"button",222),ce("click",function(){return ie(r),re(i.gameEngine.maxConvertWoodToReserve())}),E(347,"div",223)(348,"span",224),v(349),x(),E(350,"span",129),v(351,"\u2794"),x(),E(352,"span",129),v(353,"\u{1F465}++"),x()()()(),E(354,"label",225)(355,"div",109)(356,"input",110),ce("change",function(){return ie(r),re(i.gameEngine.toggleFogDebug())}),x(),E(357,"div",111),K(358,"div",112),x()(),E(359,"span",113),v(360),x()(),E(361,"button",226),ce("click",function(){return ie(r),re(i.gameEngine.endPlayerTurn())}),E(362,"div",227)(363,"span",224),v(364),x(),X(),E(365,"svg",116),K(366,"path",117)(367,"path",118),x()()(),Ne(),E(368,"div",114),v(369),x()()(),E(370,"div",228),v(371),x(),Y(372,DW,1,0,"app-game-rules"),Y(373,RW,24,5,"div",229),Y(374,kW,34,14,"div",230),Y(375,UW,24,9,"div",231),Y(376,BW,9,2,"div",232),x()}if(t&2){let r;y(56),W(i.settings.version),y(8),H(" ",i.settings.t("RELOAD")," "),y(6),H(" ",i.settings.t("INFO")," "),y(6),W(i.settings.t("RECORDS")),y(5),W(i.settings.t("RANKING")),y(5),W(i.settings.t("SYSTEM_LOG")),y(5),W(i.settings.t("FEEDBACK_MODULE")),y(6),Q((r=i.firebase.user$())?97:98,r),y(8),W(i.gameEngine.resources().wood),y(6),W(i.gameEngine.resources().iron),y(5),tn(" ",i.gameEngine.getForestControl().player,"/",i.gameEngine.getForestControl().total," "),y(6),W(i.gameEngine.turn()),y(7),tn(" ",i.gameEngine.getForestControl().player," : ",i.gameEngine.getForestControl().ai," "),y(5),$e("disabled",!i.gameEngine.canBuildThisTurn()),y(3),$e("disabled",!i.gameEngine.canAddReserveTurn()),y(2),$e("disabled",!i.gameEngine.canAddReserveTurn()),y(),H(" ",i.settings.t("ALL")," "),y(3),$e("checked",i.gameEngine.fogDebugDisabled()),y(4),W(i.settings.t("MAP_HACK")),y(2),tn(" ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),y(5),Q(i.isMobileMenuOpen()?154:-1),y(6),H(" ",i.settings.t("COMMANDER")," "),y(2),H(" ",i.settings.t("PLAYER")," "),y(3),Lt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),y(10),W(i.gameEngine.resources().wood),y(),Lt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),y(6),W(i.gameEngine.resources().iron),y(),Lt("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),y(18),H(" ",i.gameEngine.getForestControl().player," "),y(3),H(" ",i.gameEngine.getForestControl().total," "),y(4),H(" ",i.settings.t("TURN_CYCLE")," "),y(3),H(" ",i.gameEngine.turn()," "),y(),Q(i.gameEngine.monopolyTurnsLeft()>0?212:-1),y(3),Lt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0457 \u0414\u0435\u0440\u0435\u0432\u0438\u043D\u0438":"Harvested Wood"),y(2),W(i.gameEngine.aiWood()),y(9),Lt("title",i.settings.currentLang()==="uk"?"\u0417\u0456\u0431\u0440\u0430\u043D\u043E\u0433\u043E \u0417\u0430\u043B\u0456\u0437\u0430":"Harvested Iron"),y(6),W(i.gameEngine.aiIron()),y(),Lt("title",i.settings.currentLang()==="uk"?"\u041C\u043E\u043D\u043E\u043F\u043E\u043B\u0456\u044F \u041B\u0456\u0441\u0456\u0432":"Monopoly of Forests"),y(2),H(" ",i.gameEngine.getForestControl().ai," "),y(3),H(" ",i.gameEngine.getForestControl().total," "),y(20),H(" ",i.settings.t("HOSTILE")," "),y(3),Q(i.gameEngine.shouldShowEndOverlay()?261:-1),y(5),H(" ",i.settings.t("STRATEGIC_PLAN")," "),y(8),W(i.settings.t("SUPPORT")),y(),Q(i.gameEngine.supportOpen()?275:-1),y(),Q(i.gameEngine.leaderboardOpen()?276:-1),y(2),Q(i.settings.customMode()?278:-1),y(),Pe("shake",i.gameEngine.screenShake())("mood-none",i.gameEngine.currentMood()==="none")("mood-angry",i.gameEngine.currentMood()==="angry")("mood-rage",i.gameEngine.currentMood()==="rage"),y(2),rt("grid-template-columns","repeat("+i.gameEngine.gridSize+", minmax("+i.gameEngine.tileMinSizePx+"px, "+i.gameEngine.tileSizePx+"px))")("gap",i.gameEngine.wallThicknessPx+2,"px"),y(3),H(" ",i.gameEngine.baseHealth().player," "),y(),Q(i.gameEngine.isVisibleToPlayer(i.gameEngine.gridSize-1,i.gameEngine.gridSize-1)?285:-1),y(),xn(i.gameEngine.gridRows),y(4),Pe("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),y(3),W(i.settings.t("RISK")),y(2),Pe("text-lime-300",i.settings.difficulty()==="baby")("text-emerald-300",i.settings.difficulty()==="normal")("text-orange-400",i.settings.difficulty()==="hard")("text-red-500",i.settings.difficulty()==="nightmare"),y(),H(" ",i.settings.t(i.settings.getDifficultyLabel(i.settings.difficulty()))," "),y(3),H(" ",i.settings.difficulty()==="baby"?"\u{1F476}":i.settings.difficulty()==="normal"?"\u{1F920}":i.settings.difficulty()==="hard"?"\u{1F608}":"\u2620\uFE0F"," "),y(2),rt("width",i.settings.difficulty()==="baby"?25:i.settings.difficulty()==="normal"?50:i.settings.difficulty()==="hard"?75:100,"%"),Pe("bg-lime-400",i.settings.difficulty()==="baby")("bg-emerald-400",i.settings.difficulty()==="normal")("bg-orange-500",i.settings.difficulty()==="hard")("bg-red-600",i.settings.difficulty()==="nightmare"),y(3),Pe("ring-2",i.isAutoBattleActive())("ring-green-400",i.isAutoBattleActive()),$e("disabled",i.gameEngine.gameStatus()!=="playing"),y(3),W(i.settings.t("AUTO")),y(2),W(i.settings.t("ENGAGE")),y(2),Pe("bg-green-400",i.isAutoBattleActive())("bg-gray-500",!i.isAutoBattleActive()),y(2),Pe("ring-2",i.gameEngine.buildMode())("ring-blue-400",i.gameEngine.buildMode()),$e("disabled",i.gameEngine.wallBuiltThisTurn()||!i.gameEngine.canBuildThisTurn()),y(19),$e("disabled",!i.gameEngine.canAddReserveTurn()),y(14),$e("disabled",!i.gameEngine.canAddReserveTurn()),y(3),W(i.settings.t("ALL")),y(7),$e("checked",i.gameEngine.fogDebugDisabled()),y(4),W(i.settings.t("MAP_HACK")),y(4),W(i.settings.t("NEXT_TURN")),y(5),es(" ",i.settings.currentLang()==="uk"?"\u0417\u0430\u043B\u0438\u0448\u0438\u043B\u043E\u0441\u044C \u0434\u0456\u0439":"Remaining actions",": ",i.gameEngine.remainingActions(),"/",i.gameEngine.totalPlayerUnits()," "),y(2),H(" ",i.settings.version," | \xA9\uFE0E Created by jaerbi and just "),y(),Q(i.gameEngine.rulesOpen()?372:-1),y(),Q(i.gameEngine.logOpen()?373:-1),y(),Q(i.gameEngine.settingsOpen()?374:-1),y(),Q(i.gameEngine.highScoresOpen()?375:-1),y(),Q(i.isProduction?-1:376)}},dependencies:[jt,l0,c0,u0,d0,h0,RE,da],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"*[_ngcontent-%COMP%]{box-sizing:border-box}.tile[_ngcontent-%COMP%]{min-width:64px;min-height:64px;aspect-ratio:1 / 1;position:relative}.combat-text-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_combatFloat .5s ease-out}@keyframes _ngcontent-%COMP%_combatFloat{0%{transform:translateY(0)}to{transform:translateY(-12px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_defenderShake .2s ease-out}@keyframes _ngcontent-%COMP%_defenderShake{0%{transform:translate(0)}25%{transform:translate(2px,-2px)}50%{transform:translate(-2px,2px)}75%{transform:translate(2px,2px)}to{transform:translate(0)}}.arrival-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrivalPop .2s ease-out}@keyframes _ngcontent-%COMP%_arrivalPop{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseGlow .4s ease-out}@keyframes _ngcontent-%COMP%_pulseGlow{0%{box-shadow:0 0 #ffd70000}50%{box-shadow:0 0 12px #ffd700cc}to{box-shadow:0 0 #ffd70000}}.wood-pulse-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_woodPulse 1s ease-in-out infinite;filter:drop-shadow(0 0 4px rgba(16,185,129,.7))}@keyframes _ngcontent-%COMP%_woodPulse{0%{transform:scale(.9);opacity:.6}50%{transform:scale(1.1);opacity:1}to{transform:scale(.9);opacity:.6}}.move-anim[_ngcontent-%COMP%]{transition:transform .15s cubic-bezier(.4,0,.2,1);will-change:transform}"]})};var nO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(ge(sa),ge(Qi))};static \u0275dir=bn({type:n})}return n})(),jW=(()=>{class n extends nO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275dir=bn({type:n,features:[Tr]})}return n})(),iO=new _e("");var HW={provide:iO,useExisting:$o(()=>b0),multi:!0};function $W(){let n=Ni()?Ni().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var GW=new _e(""),b0=(()=>{class n extends nO{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!$W())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(ge(sa),ge(Qi),ge(GW,8))};static \u0275dir=bn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&ce("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Fu([HW]),Tr]})}return n})();function P1(n){return n==null||k1(n)===0}function k1(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var rO=new _e(""),oO=new _e(""),zW=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Mo=class{static min(e){return WW(e)}static max(e){return qW(e)}static required(e){return KW(e)}static requiredTrue(e){return YW(e)}static email(e){return QW(e)}static minLength(e){return JW(e)}static maxLength(e){return ZW(e)}static pattern(e){return XW(e)}static nullValidator(e){return sO()}static compose(e){return hO(e)}static composeAsync(e){return pO(e)}};function WW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function qW(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function KW(n){return P1(n.value)?{required:!0}:null}function YW(n){return n.value===!0?null:{required:!0}}function QW(n){return P1(n.value)||zW.test(n.value)?null:{email:!0}}function JW(n){return e=>{let t=e.value?.length??k1(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function ZW(n){return e=>{let t=e.value?.length??k1(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function XW(n){if(!n)return sO;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(P1(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function sO(n){return null}function aO(n){return n!=null}function lO(n){return Zo(n)?an(n):n}function cO(n){let e={};return n.forEach(t=>{e=t!=null?F(F({},e),t):e}),Object.keys(e).length===0?null:e}function uO(n,e){return e.map(t=>t(n))}function eq(n){return!n.validate}function dO(n){return n.map(e=>eq(e)?e:t=>e.validate(t))}function hO(n){if(!n)return null;let e=n.filter(aO);return e.length==0?null:function(t){return cO(uO(t,e))}}function fO(n){return n!=null?hO(dO(n)):null}function pO(n){if(!n)return null;let e=n.filter(aO);return e.length==0?null:function(t){let i=uO(t,e).map(lO);return my(i).pipe(vt(cO))}}function gO(n){return n!=null?pO(dO(n)):null}function Kk(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function mO(n){return n._rawValidators}function yO(n){return n._rawAsyncValidators}function A1(n){return n?Array.isArray(n)?n:[n]:[]}function g0(n,e){return Array.isArray(n)?n.includes(e):n===e}function Yk(n,e){let t=A1(e);return A1(n).forEach(r=>{g0(t,r)||t.push(r)}),t}function Qk(n,e){return A1(e).filter(t=>!g0(n,t))}var m0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=fO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=gO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ec=class extends m0{name;get formDirective(){return null}get path(){return null}},lh=class extends m0{_parent=null;name=null;valueAccessor=null},y0=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var vO=(()=>{class n extends y0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(ge(lh,2))};static \u0275dir=bn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Pe("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Tr]})}return n})(),_O=(()=>{class n extends y0{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(ge(Ec,10))};static \u0275dir=bn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Pe("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Tr]})}return n})();var rh="VALID",p0="INVALID",vc="PENDING",oh="DISABLED",Ss=class{},v0=class extends Ss{value;source;constructor(e,t){super(),this.value=e,this.source=t}},sh=class extends Ss{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},ah=class extends Ss{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},_c=class extends Ss{status;source;constructor(e,t){super(),this.status=e,this.source=t}},M1=class extends Ss{source;constructor(e){super(),this.source=e}},ch=class extends Ss{source;constructor(e){super(),this.source=e}};function O1(n){return(w0(n)?n.validators:n)||null}function tq(n){return Array.isArray(n)?fO(n):n||null}function F1(n,e){return(w0(e)?e.asyncValidators:n)||null}function nq(n){return Array.isArray(n)?gO(n):n||null}function w0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function EO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new pe(1e3,"");if(!i[t])throw new pe(1001,"")}function bO(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new pe(1002,"")})}var bc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return cn(this.statusReactive)}set status(e){cn(()=>this.statusReactive.set(e))}_status=ei(()=>this.statusReactive());statusReactive=G(void 0);get valid(){return this.status===rh}get invalid(){return this.status===p0}get pending(){return this.status==vc}get disabled(){return this.status===oh}get enabled(){return this.status!==oh}errors;get pristine(){return cn(this.pristineReactive)}set pristine(e){cn(()=>this.pristineReactive.set(e))}_pristine=ei(()=>this.pristineReactive());pristineReactive=G(!0);get dirty(){return!this.pristine}get touched(){return cn(this.touchedReactive)}set touched(e){cn(()=>this.touchedReactive.set(e))}_touched=ei(()=>this.touchedReactive());touchedReactive=G(!1);get untouched(){return!this.touched}_events=new Bt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Yk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Yk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Qk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Qk(e,this._rawAsyncValidators))}hasValidator(e){return g0(this._rawValidators,e)}hasAsyncValidator(e){return g0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(fe(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new ah(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new ah(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(fe(F({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new sh(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new sh(!0,i))}markAsPending(e={}){this.status=vc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new _c(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(fe(F({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=oh,this.errors=null,this._forEachChild(r=>{r.disable(fe(F({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new v0(this.value,i)),this._events.next(new _c(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(fe(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=rh,this._forEachChild(i=>{i.enable(fe(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(fe(F({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===rh||this.status===vc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new v0(this.value,t)),this._events.next(new _c(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(fe(F({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?oh:rh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=vc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=lO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new _c(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new ln,this.statusChanges=new ln}_calculateStatus(){return this._allControlsDisabled()?oh:this.errors?p0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vc)?vc:this._anyControlsHaveStatus(p0)?p0:rh}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new sh(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new ah(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){w0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=tq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=nq(this._rawAsyncValidators)}},wc=class extends bc{constructor(e,t,i){super(O1(t),F1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){bO(this,!0,e),Object.keys(e).forEach(i=>{EO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,fe(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new ch(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var R1=class extends wc{};var wO=new _e("",{factory:()=>L1}),L1="always";function iq(n,e){return[...e.path,n]}function Jk(n,e,t=L1){V1(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),oq(n,e),aq(n,e),sq(n,e),rq(n,e)}function Zk(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),E0(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function _0(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function rq(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function V1(n,e){let t=mO(n);e.validator!==null?n.setValidators(Kk(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=yO(n);e.asyncValidator!==null?n.setAsyncValidators(Kk(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();_0(e._rawValidators,r),_0(e._rawAsyncValidators,r)}function E0(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=mO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=yO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return _0(e._rawValidators,i),_0(e._rawAsyncValidators,i),t}function oq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&xO(n,e)})}function sq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&xO(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function xO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function aq(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function lq(n,e){n==null,V1(n,e)}function cq(n,e){return E0(n,e)}function uq(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function dq(n){return Object.getPrototypeOf(n.constructor)===jW}function hq(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function fq(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===b0?t=o:dq(o)?i=o:r=o}),r||i||t||null}function pq(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Xk(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function eO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Ua=class extends bc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(O1(t),F1(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),w0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(eO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new ch(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Xk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Xk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){eO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var gq=n=>n instanceof Ua;var SO=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=bn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var N1=class extends bc{constructor(e,t,i){super(O1(t),F1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){bO(this,!1,e),e.forEach((i,r)=>{EO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],fe(F({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new ch(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};var mq=(()=>{class n extends Ec{callSetDisabledState;get submitted(){return cn(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=ei(()=>this._submittedReactive());_submittedReactive=G(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this.onChanges(t)}ngOnDestroy(){this.onDestroy()}onChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(E0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(t){let i=this.form.get(t.path);return Jk(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){Zk(t.control||null,t,!1),pq(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}getFormArray(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}updateModel(t,i){this.form.get(t.path).setValue(i)}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}onSubmit(t){return this.submitted=!0,hq(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new M1(this.control)),t?.target?.method==="dialog"}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(Zk(i||null,t),gq(r)&&(Jk(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);lq(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&cq(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){V1(this.form,this),this._oldForm&&E0(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(i){return new(i||n)(ge(rO,10),ge(oO,10),ge(wO,8))};static \u0275dir=bn({type:n,features:[Tr,no]})}return n})();var IO=new _e("");var yq={provide:lh,useExisting:$o(()=>U1)},U1=(()=>{class n extends lh{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new ln;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=fq(this,o)}ngOnChanges(t){this._added||this._setUpControl(),uq(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return iq(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(ge(Ec,13),ge(rO,10),ge(oO,10),ge(iO,10),ge(IO,8))};static \u0275dir=bn({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Fu([yq]),Tr,no]})}return n})();var vq={provide:Ec,useExisting:$o(()=>B1)},B1=(()=>{class n extends mq{form=null;ngSubmit=new ln;get control(){return this.form}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ra(n)))(r||n)}})();static \u0275dir=bn({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&ce("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Fu([vq]),Tr]})}return n})();var _q=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ro({type:n});static \u0275inj=gr({})}return n})();function tO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var TO=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return tO(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new wc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new R1(r,i)}control(t,i,r){let o={};return this.useNonNullable?(tO(i)?o=i:(o.validators=i,o.asyncValidators=r),new Ua(t,fe(F({},o),{nonNullable:!0}))):new Ua(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new N1(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof Ua)return t;if(t instanceof bc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var CO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:IO,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:wO,useValue:t.callSetDisabledState??L1}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ro({type:n});static \u0275inj=gr({imports:[_q]})}return n})();var x0=class n{db;auth;constructor(){let e=vd(a0);this.db=Gd(e),this.auth=ih(e)}async addFeedback(e){let t=fe(F({},e),{rating:Math.max(1,Math.min(5,Math.floor(e.rating))),text:(e.text??"").slice(0,500),timestamp:zd()});await Kd(xi(this.db,"feedbacks"),t)}async getRecentFeedbacks(e){let t=To(xi(this.db,"feedbacks"),sr("timestamp","desc"),Es(e));return(await bs(t)).docs.map(r=>r.data())}async getFeedbackPage(e,t){let i=[sr("timestamp","desc"),Es(e)],r=t?To(xi(this.db,"feedbacks"),sr("timestamp","desc"),ZP(t),Es(e)):To(xi(this.db,"feedbacks"),sr("timestamp","desc"),Es(e)),o=await bs(r),s=o.docs.map(l=>l.data()),a=o.docs.length>0?o.docs[o.docs.length-1]:null;return{items:s,lastDoc:a}}async canUserPostToday(e){let t=new Date(Date.now()-864e5),i=To(xi(this.db,"feedbacks"),_s("userId","==",e),_s("timestamp",">=",t)),o=(await bs(i)).size,s=3;return{allowed:o<s,remaining:Math.max(0,s-o)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var j1=()=>[1,2,3,4,5],DO=(n,e)=>e.timestamp;function wq(n,e){if(n&1){let t=Je();E(0,"button",39),ce("click",function(){let r=ie(t).$implicit,o=O(2);return re(o.setRating(r))}),v(1," \u2605 "),x()}if(n&2){let t=e.$implicit,i=O(2);Pe("active",i.form.value.rating>=t)}}function xq(n,e){if(n&1&&(E(0,"div",36),v(1),x()),n&2){let t=O(2);y(),W(t.settings.t("FEEDBACK_VALIDATION_RANGE"))}}function Sq(n,e){n&1&&(E(0,"div",37),v(1),x()),n&2&&(y(),W(e))}function Iq(n,e){if(n&1){let t=Je();E(0,"div",25)(1,"div",26),K(2,"img",27),x(),E(3,"div",28)(4,"div",29),v(5),x(),E(6,"div",30),v(7),x()()(),E(8,"form",31),ce("ngSubmit",function(){ie(t);let r=O();return re(r.submit())}),E(9,"div")(10,"div",32),v(11),x(),E(12,"div",33),wn(13,wq,2,2,"button",34,Cr),x()(),E(15,"div")(16,"div",32),v(17),x(),K(18,"textarea",35),Y(19,xq,2,1,"div",36),Y(20,Sq,2,1,"div",37),x(),E(21,"button",38),v(22),x()()}if(n&2){let t,i=e,r=O();y(2),$e("src",i.photoURL,Zi),y(3),W(i.displayName),y(2),W(r.settings.t("OPERATOR_ONLINE")),y(),$e("formGroup",r.form),y(3),W(r.settings.t("EFFICIENCY_RATING")),y(2),xn(la(16,j1)),y(4),W(r.settings.t("TACTICAL_NOTE")),y(),$e("placeholder",lE(r.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0442\u0430\u043A\u0442\u0438\u0447\u043D\u0438\u0439 \u0430\u043D\u0430\u043B\u0456\u0437...":"Transmit tactical analysis...")),y(),Q(r.form.controls.text.errors?19:-1),y(),Q((t=r.message())?20:-1,t),y(),Pe("cursor-pointer",r.canSubmit)("cursor-not-allowed",!r.canSubmit),$e("disabled",!r.canSubmit),y(),H(" ",r.settings.t("TRANSMIT_REPORT")," ")}}function Tq(n,e){if(n&1&&(E(0,"div",21),v(1),x()),n&2){let t=O();y(),W(t.settings.t("SYSTEM_LOG"))}}function Cq(n,e){if(n&1&&(E(0,"div",22),v(1),x()),n&2){let t=O();y(),W(t.settings.t("COMMUNITY_SIGNALS_TABLE"))}}function Dq(n,e){if(n&1&&(E(0,"span"),v(1,"\u2605"),x()),n&2){let t=e.$implicit,i=O().$implicit;Pe("active",i.rating>=t)}}function Aq(n,e){if(n&1&&(E(0,"tr",44)(1,"td",47),K(2,"img",48),E(3,"span"),v(4),x()(),E(5,"td",49)(6,"div",50),wn(7,Dq,2,2,"span",51,Cr),x()(),E(9,"td",49)(10,"span",52),v(11),x()(),E(12,"td",49)(13,"span",53),v(14),x()()()),n&2){let t=e.$implicit,i=O(2);y(2),$e("src",t.userPhoto,Zi),y(2),W(t.userName),y(3),xn(la(4,j1)),y(4),W(t.text),y(3),W(i.formatDate(t.timestamp))}}function Mq(n,e){if(n&1&&(E(0,"tr")(1,"td",54),v(2),x()()),n&2){let t=O(2);y(2),W(t.settings.t("NO_SIGNALS"))}}function Rq(n,e){if(n&1){let t=Je();E(0,"div",40)(1,"table",41)(2,"thead")(3,"tr",42)(4,"th",43),v(5),x(),E(6,"th",43),v(7),x(),E(8,"th",43),v(9),x(),E(10,"th",43),v(11),x()()(),E(12,"tbody"),wn(13,Aq,15,5,"tr",44,DO,!1,Mq,3,1,"tr"),x()()(),E(16,"div",45)(17,"button",46),ce("click",function(){ie(t);let r=O();return re(r.prevPage())}),v(18),x(),E(19,"button",46),ce("click",function(){ie(t);let r=O();return re(r.nextPage())}),v(20),x()()}if(n&2){let t=O();y(5),W(t.settings.t("TABLE_OPERATOR")),y(2),W(t.settings.t("TABLE_RATING")),y(2),W(t.settings.t("TABLE_MESSAGE")),y(2),W(t.settings.t("TABLE_DATE")),y(2),xn(t.pageItems()),y(5),H(" ",t.settings.t("PREVIOUS")," "),y(2),H(" ",t.settings.t("NEXT")," ")}}function Nq(n,e){if(n&1&&(E(0,"span"),v(1,"\u2605"),x()),n&2){let t=e.$implicit,i=O().$implicit;Pe("active",i.rating>=t)}}function Pq(n,e){if(n&1&&(E(0,"div",55)(1,"div",56)(2,"div",57),K(3,"img",58),E(4,"div",59),v(5),x()(),E(6,"div",50),wn(7,Nq,2,2,"span",51,Cr),x()(),E(9,"div",60),v(10),x()()),n&2){let t=e.$implicit;y(3),$e("src",t.userPhoto,Zi),y(2),W(t.userName),y(2),xn(la(3,j1)),y(3),W(t.text)}}function kq(n,e){if(n&1&&wn(0,Pq,11,4,"div",55,DO),n&2){let t=O();xn(t.recent())}}var S0=class n{constructor(e,t,i,r,o){this.fb=e;this.router=t;this.feedback=i;this.firebase=r;this.settings=o;this.form=new wc({text:new Ua("",{nonNullable:!0,validators:[Mo.required,Mo.minLength(10),Mo.maxLength(500)]}),rating:new Ua(5,{nonNullable:!0,validators:[Mo.required,Mo.min(1),Mo.max(5)]})}),this.loadRecent();let s=this.firebase.user$();if(s){let a=`feedback_throttle_${s.uid}`,l=Number(localStorage.getItem(a)||0);this.disabledUntil.set(l)}this.loadPage(0)}recent=G([]);pageItems=G([]);pageStack=[null];pageIndex=G(0);lastDoc=null;disabledUntil=G(0);message=G(null);isAllShow=!1;form;async loadRecent(){try{let e=await this.feedback.getRecentFeedbacks(30);this.recent.set(e)}catch{}}async loadPage(e=0){try{let t=Math.max(0,this.pageIndex()+e),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);if(this.pageItems.set(r.items),this.lastDoc=r.lastDoc,e>=0){let o=t+1;this.pageStack[o]=this.lastDoc,this.pageIndex.set(t+1)}else this.pageIndex.set(t)}catch{}}async nextPage(){await this.loadPage(0),this.lastDoc&&await this.loadPage(0)}async prevPage(){let e=this.pageIndex(),t=Math.max(0,e-2),i=this.pageStack[t]??null,r=await this.feedback.getFeedbackPage(10,i);this.pageItems.set(r.items),this.lastDoc=r.lastDoc,this.pageIndex.set(t+1)}formatDate(e){try{if(!e)return"";let t=e.seconds?e.seconds*1e3:typeof e=="number"?e:Date.now();return new Date(t).toLocaleString()}catch{return""}}get canSubmit(){return!this.firebase.user$()||Date.now()<this.disabledUntil()?!1:this.form.valid}get throttleActive(){return Date.now()<this.disabledUntil()}async submit(){let e=this.firebase.user$();if(!e)return;let{allowed:t,remaining:i}=await this.feedback.canUserPostToday(e.uid);if(!t){this.message.set(this.settings.t("FEEDBACK_LIMIT_REACHED"));return}let r=this.form.value,o={userId:e.uid,userName:e.displayName||"Anonymous",userPhoto:e.photoURL||"",text:r.text||"",rating:Number(r.rating)||5};await this.feedback.addFeedback(o),this.message.set(this.settings.t("FEEDBACK_SUBMITTED")),this.form.reset({text:"",rating:5});let s=`feedback_throttle_${e.uid}`,a=Date.now()+300*1e3;localStorage.setItem(s,String(a)),this.disabledUntil.set(a),await this.loadRecent(),await this.loadPage(0)}setRating(e){this.form.patchValue({rating:e})}static \u0275fac=function(t){return new(t||n)(ge(TO),ge(Ei),ge(x0),ge(jn),ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-feedback"]],decls:34,vars:10,consts:[[1,"min-h-screen","tactical-bg","text-white","flex","items-center","justify-center","p-6"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"w-full","max-w-6xl","tactical-frame","rounded-lg","overflow-hidden","z-1"],[1,"hud-header","flex","items-center","justify-between","px-6","py-4"],[1,"flex","flex-col"],[1,"hud-title"],[1,"hud-subtitle"],["routerLink","/",1,"hud-btn"],[1,"grid","grid-cols-1","lg:grid-cols-2"],[1,"hud-panel","border-r","border-white/10","p-6"],[1,"panel-title"],[1,"hud-panel","p-6"],[1,"flex","justify-between","items-center"],[1,"panel-title","red","mb-0"],[1,"panel-title","mb-0"],[1,"cursor-pointer","text-[8px]","font-bold","text-blue-400","hover:text-white","transition-colors","tracking-widest","uppercase","pr-2",3,"click"],[1,"max-h-[420px]","overflow-auto","space-y-4","pr-2","hud-scroll"],[1,"flex","items-center","gap-4","mb-6"],[1,"avatar-frame"],["referrerpolicy","no-referrer",1,"w-12","h-12","rounded-md","bg-black",3,"src"],[1,"text-sm"],[1,"font-bold","text-white"],[1,"text-xs","text-blue-400/60"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"label"],[1,"flex","gap-2","mt-2"],["type","button",1,"rating-cell",3,"active"],["formControlName","text","rows","4",1,"hud-textarea",3,"placeholder"],[1,"text-[10px]","text-red-300"],[1,"text-[10px]","text-yellow-300"],["type","submit",1,"hud-action-btn",3,"disabled"],["type","button",1,"rating-cell",3,"click"],[1,"rounded-md","border","border-white/10","bg-white/5"],[1,"w-full","text-left"],[1,"text-white/80","text-[11px]"],[1,"px-3","py-2","border-b","border-white/10"],[1,"text-white/90","text-[12px]"],[1,"flex","items-center","justify-end","gap-3","mt-3"],[1,"px-3","py-1.5","rounded-md","border","border-white/20","text-white","hover:border-indigo-400","hover:text-indigo-300","transition",3,"click"],[1,"px-3","py-2","flex","items-center","gap-2"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-md","border","border-white/20",3,"src"],[1,"px-3","py-2"],[1,"rating-view"],[3,"active"],[1,"text-white"],[1,"text-white/80"],["colspan","4",1,"px-3","py-4","text-center","text-white/70"],[1,"signal-card"],[1,"flex","items-center","justify-between","mb-3"],[1,"flex","items-center","gap-3"],["referrerpolicy","no-referrer",1,"w-9","h-9","rounded-md","border","border-white/20",3,"src"],[1,"text-sm","font-semibold","text-white"],[1,"signal-text"]],template:function(t,i){if(t&1&&(E(0,"div",0)(1,"div",1),K(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),x(),X(),E(7,"svg",7)(8,"defs")(9,"clipPath",8),K(10,"path",9),x()()(),Ne(),E(11,"div",10)(12,"div",11)(13,"div",12)(14,"span",13),v(15),x(),E(16,"span",14),v(17),x()(),E(18,"a",15),v(19),x()(),E(20,"div",16)(21,"div",17)(22,"div",18),v(23),x(),Y(24,Iq,23,17),x(),E(25,"div",19)(26,"div",20),Y(27,Tq,2,1,"div",21),Y(28,Cq,2,1,"div",22),E(29,"button",23),ce("click",function(){return i.isAllShow=!i.isAllShow}),v(30),x()(),E(31,"div",24),Y(32,Rq,21,7),Y(33,kq,2,0),x()()()()()),t&2){let r;y(15),W(i.settings.t("FEEDBACK_MODULE")),y(2),W(i.settings.t("COMMUNITY_SIGNALS")),y(2),W(i.settings.t("RETURN_TO_MAP")),y(4),W(i.settings.t("DEPLOY_REPORT")),y(),Q((r=i.firebase.user$())?24:-1,r),y(3),Q(i.isAllShow?-1:27),y(),Q(i.isAllShow?28:-1),y(2),H(" ",i.isAllShow?i.settings.t("TOGGLE_BACK"):i.settings.t("VIEW_FULL_ARCHIVE")," "),y(2),Q(i.isAllShow?32:-1),y(),Q(i.isAllShow?-1:33)}},dependencies:[jt,CO,SO,b0,vO,_O,B1,U1,as],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}",".tactical-bg[_ngcontent-%COMP%]{background:radial-gradient(1200px 600px at 20% 20%,rgba(0,120,255,.06),transparent 60%),radial-gradient(800px 500px at 80% 80%,rgba(255,0,80,.05),transparent 60%),#0b1220}.tactical-frame[_ngcontent-%COMP%]{background:#0f192dd9;border:1px solid rgba(255,255,255,.12);box-shadow:0 0 40px #0078ff1f}.hud-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#ffffff0a,#fff0);border-bottom:1px solid rgba(255,255,255,.1)}.hud-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;letter-spacing:.2em;color:#7dd3fc}.hud-subtitle[_ngcontent-%COMP%]{font-size:10px;color:#fff6;letter-spacing:.2em}.hud-btn[_ngcontent-%COMP%]{padding:6px 14px;border:1px solid rgba(255,255,255,.2);font-size:11px;letter-spacing:.15em;color:#93c5fd;transition:.2s}.hud-btn[_ngcontent-%COMP%]:hover{background:#0078ff1f;border-color:#0078ff66}.hud-panel[_ngcontent-%COMP%]{background:#00000026}.panel-title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.2em;font-weight:700;color:#7dd3fc;margin-bottom:16px}.panel-title.red[_ngcontent-%COMP%]{color:#f87171}.avatar-frame[_ngcontent-%COMP%]{padding:2px;border:1px solid rgba(0,120,255,.5);border-radius:6px}.label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.2em;color:#ffffff80}.rating-cell[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid rgba(255,255,255,.15);background:#0003;color:#fff3;font-size:16px;transition:.15s}.rating-cell.active[_ngcontent-%COMP%]{color:#facc15;border-color:#facc1599;background:#facc1514}.hud-textarea[_ngcontent-%COMP%]{width:100%;background:#00000040;border:1px solid rgba(255,255,255,.15);padding:12px;font-size:13px;color:#fff;outline:none;transition:.2s}.hud-textarea[_ngcontent-%COMP%]:focus{border-color:#0078ff80}.hud-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(0,120,255,.5);background:#0078ff1f;font-size:11px;letter-spacing:.2em;color:#7dd3fc;transition:.2s}.hud-action-btn[_ngcontent-%COMP%]:hover{background:#0078ff38}.hud-action-btn[_ngcontent-%COMP%]:disabled{opacity:.4}.signal-card[_ngcontent-%COMP%]{background:#00000040;border:1px solid rgba(255,255,255,.12);padding:14px;transition:.2s}.signal-card[_ngcontent-%COMP%]:hover{border-color:#0078ff66}.rating-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.rating-view[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#facc15}.signal-text[_ngcontent-%COMP%]{font-size:13px;color:#ffffffbf}"]})};var I0=class n{constructor(e){this.settings=e}static \u0275fac=function(t){return new(t||n)(ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-roadmap"]],decls:93,vars:13,consts:[[1,"min-h-screen","w-full","bg-[#0a0c10]","text-blue-100","font-sans","selection:bg-blue-600/30","relative","overflow-hidden","flex","flex-col","items-center","py-10"],[1,"fixed","inset-0","overflow-hidden","pointer-events-none","select-none","z-0"],[1,"floating-shape","shape-giant-1"],[1,"floating-shape","shape-giant-2"],[1,"floating-shape","shape-giant-3"],[1,"floating-shape","shape-giant-4"],[1,"floating-shape","shape-giant-5"],["width","0","height","0",1,"absolute","pointer-events-none"],["id","soft-triangle","clipPathUnits","objectBoundingBox"],["d","M0.5 0.05 Q0.5 0 0.56 0.12 L0.92 0.85 Q0.98 0.98 0.85 0.98 L0.15 0.98 Q0.02 0.98 0.08 0.85 L0.44 0.12 Q0.5 0 0.5 0.05"],[1,"fixed","inset-0","pointer-events-none","opacity-20","z-0","bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"],[1,"fixed","inset-0","pointer-events-none","z-0","bg-gradient-to-b","from-transparent","via-blue-900/5","to-black"],[1,"w-full","max-w-5xl","px-6","relative","z-10"],[1,"mb-10","flex","items-center","justify-between","border-b","border-blue-500/20","pb-6"],[1,"flex","flex-col"],[1,"flex","items-center","gap-3"],[1,"w-2","h-6","bg-blue-600","shadow-[0_0_15px_rgba(37,99,235,0.8)]"],[1,"text-4xl","font-black","tracking-tighter","uppercase","italic","text-white"],[1,"text-[10px]","uppercase","tracking-[0.5em]","text-blue-400/60","mt-2","ml-5","font-bold"],["routerLink","/",1,"hud-btn-alt","group"],[1,"mr-2","text-blue-400","group-hover:text-white","transition-colors"],[1,"grid","md:grid-cols-2","gap-8"],[1,"roadmap-card","group","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"absolute","top-0","right-0","w-16","h-16","bg-emerald-500/10","blur-2xl","-mr-8","-mt-8"],[1,"card-header","relative","z-10"],[1,"text-[11px]","font-mono","text-emerald-200/50","italic"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","uppercase","tracking-wider","bg-emerald-500/20","text-emerald-400","border","border-emerald-500/40"],[1,"flex","items-start","gap-4","mt-4","relative","z-10"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/60","rotate-45","flex","items-center","justify-center","group-hover:rotate-180","transition-all","duration-700","shadow-[0_0_15px_rgba(16,185,129,0.2)]"],[1,"-rotate-45","group-hover:-rotate-180","transition-all","duration-700","text-xl"],[1,"text-lg","font-bold","text-emerald-50","leading-tight","mb-2","opacity-80","decoration-emerald-500/30","line-through","decoration-2"],[1,"text-sm","text-emerald-100/40","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-emerald-500/10","flex","justify-between","items-center","relative","z-10"],[1,"text-[9px]","uppercase","tracking-widest","text-emerald-500/40","font-bold"],[1,"flex","gap-1"],[1,"w-3","h-1","bg-emerald-500","shadow-[0_0_5px_#10b981]"],[1,"card-header"],[1,"text-[11px]","font-mono","text-blue-200/50","italic"],[1,"flex","items-start","gap-4","mt-4"],[1,"w-12","h-12","flex-shrink-0","bg-emerald-600/20","border","border-emerald-500/40","flex","items-center","justify-center","group-hover:scale-110","transition-transform"],[1,"text-lg","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic"],[1,"card-footer","mt-4","pt-4","border-t","border-white/5","flex","justify-between","items-center"],[1,"text-[9px]","uppercase","tracking-widest","text-white/30"],[1,"w-3","h-1","bg-emerald-500"],[1,"w-3","h-1","bg-emerald-500/20"],[1,"roadmap-card","group","md:col-span-2","border-emerald-500/30","bg-emerald-500/5","relative","overflow-hidden","opacity-45"],[1,"flex","items-start","gap-6","mt-4"],[1,"w-16","h-16","flex-shrink-0","bg-blue-600/20","border-2","border-blue-500/40","rounded-sm","flex","items-center","justify-center","relative","overflow-hidden","group-hover:border-blue-400","transition-colors"],[1,"absolute","inset-0","bg-blue-500/10","animate-pulse"],[1,"text-2xl","relative","z-10"],[1,"text-xl","font-bold","text-white","leading-tight","mb-2"],[1,"text-sm","text-blue-100/60","leading-relaxed","italic","max-w-2xl"],[1,"mt-12","p-6","border","border-blue-500/30","bg-blue-500/5","relative"],[1,"absolute","-top-3","left-6","px-3","bg-[#0a0c10]","text-[10px]","font-black","text-blue-400","tracking-widest","uppercase"],[1,"text-sm","text-blue-100/80","italic","font-mono","leading-relaxed"]],template:function(t,i){t&1&&(E(0,"div",0)(1,"div",1),K(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),x(),X(),E(7,"svg",7)(8,"defs")(9,"clipPath",8),K(10,"path",9),x()()(),Ne(),K(11,"div",10)(12,"div",11),E(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),K(17,"div",16),E(18,"h1",17),v(19),x()(),E(20,"p",18),v(21,"Future_Ops // Deployment_Schedule"),x()(),E(22,"a",19)(23,"span",20),v(24,"\xAB"),x(),v(25),x()(),E(26,"div",21)(27,"div",22),K(28,"div",23),E(29,"div",24)(30,"span",25),v(31,"REF: PROJECT_VOLUMETRIC"),x(),E(32,"span",26),v(33),x()(),E(34,"div",27)(35,"div",28)(36,"div",29),v(37),x()(),E(38,"div")(39,"h3",30),v(40),x(),E(41,"p",31),v(42),x()()(),E(43,"div",32)(44,"span",33),v(45,"System_Verified"),x(),E(46,"div",34),K(47,"div",35)(48,"div",35)(49,"div",35),x()()(),E(50,"div",22)(51,"div",36)(52,"span",37),v(53,"REF: RESOURCE_IRON"),x(),E(54,"span",26),v(55),x()(),E(56,"div",38)(57,"div",39)(58,"span"),v(59,"\u26D3\uFE0F"),x()(),E(60,"div")(61,"h3",40),v(62),x(),E(63,"p",41),v(64),x()()(),E(65,"div",42)(66,"span",43),v(67,"Priority_Beta"),x(),E(68,"div",34),K(69,"div",44)(70,"div",45)(71,"div",45),x()()(),E(72,"div",46)(73,"div",36)(74,"span",37),v(75,"REF: INFRA_SMITHY"),x(),E(76,"span",26),v(77),x()(),E(78,"div",47)(79,"div",48),K(80,"div",49),E(81,"span",50),v(82,"\u2692\uFE0F"),x()(),E(83,"div")(84,"h3",51),v(85),x(),E(86,"p",52),v(87),x()()()()(),E(88,"div",53)(89,"div",54),v(90,"Community_Intel"),x(),E(91,"p",55),v(92),x()()()()),t&2&&(y(19),H(" ",i.settings.t("STRATEGIC_PLAN")," "),y(6),H(" ",i.settings.currentLang()==="uk"?"\u041F\u041E\u0412\u0415\u0420\u041D\u0423\u0422\u0418\u0421\u042C \u0414\u041E \u041C\u0410\u041F\u0418":"RETURN TO MAP"," "),y(8),H(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(4),H(" ",i.settings.currentLang()==="uk"?"\u2714\uFE0F":"\u2705"," "),y(3),H(" ",i.settings.currentLang()==="uk"?"\u0415\u0432\u043E\u043B\u044E\u0446\u0456\u044F \u042E\u043D\u0456\u0442\u0456\u0432 (\u0412\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0435 \u041F\u0435\u0440\u0435\u043E\u0441\u043C\u0438\u0441\u043B\u0435\u043D\u043D\u044F)":"Unit Evolution (Volumetric Overhaul)"," "),y(2),H(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0435\u0445\u0456\u0434 \u0432\u0456\u0434 2D \u0434\u043E 3D-\u0441\u0442\u0438\u043B\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0432\u043E\u043B\u044E\u043C\u0435\u0442\u0440\u0438\u0447\u043D\u0438\u0445 \u043C\u043E\u0434\u0435\u043B\u0435\u0439.":"Transitioning from 2D to 3D-styled volumetric tactical models."," "),y(13),H(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(7),W(i.settings.currentLang()==="uk"?"\u0406\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u044F \u0420\u0435\u0441\u0443\u0440\u0441\u0443 (\u0417\u0430\u043B\u0456\u0437\u043E)":"Resource Integration (Iron)"),y(2),H(" ",i.settings.currentLang()==="uk"?"\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044F \u0432\u0442\u043E\u0440\u0438\u043D\u043D\u043E\u0433\u043E \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u0434\u043B\u044F \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u043E\u0437\u0431\u0440\u043E\u0454\u043D\u043D\u044F.":"Introduction of iron as a secondary resource for weapon upgrades."," "),y(13),H(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u043E":"Completed"," "),y(8),W(i.settings.currentLang()==="uk"?"\u0406\u043D\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0430 (\u041A\u0443\u0437\u043D\u044F)":"Infrastructure (The Smithy)"),y(2),H(" ",i.settings.currentLang()==="uk"?"\u041F\u0435\u0440\u0448\u0430 \u0431\u0443\u0434\u0456\u0432\u043B\u044F. \u0426\u0435\u043D\u0442\u0440 \u0443\u0441\u0456\u0445 \u043F\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u044C \u044E\u043D\u0456\u0442\u0456\u0432 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0456 \u0417\u0430\u043B\u0456\u0437\u0430.":"First constructible building. The Smithy will be the hub for all Iron-based enhancements."," "),y(5),H(" ",i.settings.currentLang()==="uk"?"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u0432\u0432\u0456\u0434 \u041E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430... \u0414\u0456\u043B\u0456\u0442\u044C\u0441\u044F \u0456\u0434\u0435\u044F\u043C\u0438 \u0447\u0435\u0440\u0435\u0437 \u041C\u043E\u0434\u0443\u043B\u044C \u0417\u0432\u043E\u0440\u043E\u0442\u043D\u043E\u0433\u043E \u0417\u0432\u2019\u044F\u0437\u043A\u0443, \u0449\u043E\u0431 \u0432\u043F\u043B\u0438\u0432\u0430\u0442\u0438 \u043D\u0430 \u043F\u0440\u0456\u043E\u0440\u0438\u0442\u0435\u0442\u043D\u0456\u0441\u0442\u044C \u0446\u0438\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0456\u0432.":"Waiting for Operator input... Share your ideas via the Feedback module."," "))},dependencies:[jt,as],styles:[".floating-shape[_ngcontent-%COMP%]{position:absolute;opacity:.3;filter:blur(60px);z-index:-1}.shape-giant-1[_ngcontent-%COMP%]{top:10%;left:10%;width:400px;height:400px;background:radial-gradient(circle,#3b82f6,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant1 35s infinite alternate ease-in-out}.shape-giant-2[_ngcontent-%COMP%]{bottom:20%;right:15%;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,#ef4444,transparent);animation:_ngcontent-%COMP%_floatGiant2 36s infinite alternate-reverse ease-in-out}.shape-giant-3[_ngcontent-%COMP%]{top:40%;left:70%;width:300px;height:300px;background:radial-gradient(circle,#a855f7,transparent);clip-path:url(#soft-triangle);animation:_ngcontent-%COMP%_floatGiant3 45s infinite alternate ease-in-out;animation-delay:-10s}.shape-giant-4[_ngcontent-%COMP%]{bottom:10%;left:20%;width:350px;height:350px;border-radius:50%;background:radial-gradient(circle,#10b981,transparent);animation:_ngcontent-%COMP%_floatGiant2 38s infinite alternate ease-in-out;animation-delay:-5s}.shape-giant-5[_ngcontent-%COMP%]{bottom:5%;left:43%;width:340px;height:340px;clip-path:url(#soft-triangle);background:radial-gradient(circle,#ece80d,transparent);animation:_ngcontent-%COMP%_floatGiant2 41s infinite alternate ease-in-out;animation-delay:-3s;color:#0800ff}@keyframes _ngcontent-%COMP%_floatGiant1{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(150px,80px) rotate(15deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_floatGiant2{0%{transform:translate(0) scale(1)}to{transform:translate(-100px,-50px) scale(1.2)}}@keyframes _ngcontent-%COMP%_floatGiant3{0%{transform:translate(0) rotate(0) scale(1)}to{transform:translate(-80px,120px) rotate(-10deg) scale(.9)}}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.roadmap-card[_ngcontent-%COMP%]{background-color:#2c325099;border:1px solid rgba(59,130,246,.1);padding:1.5rem;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:inset 0 0 20px #3b82f60d}.roadmap-card[_ngcontent-%COMP%]:hover{border-color:#3b82f699;background-color:#1e3a8a33;box-shadow:0 10px 40px #0009,inset 0 0 30px #3b82f61a;transform:translateY(-2px)}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.status-tag[_ngcontent-%COMP%]{font-size:8px;padding:.25rem .75rem;font-weight:900;text-transform:uppercase;letter-spacing:-.05em;border-width:1px}.status-planned[_ngcontent-%COMP%]{color:#fde047;border-color:#eab3084d;background-color:#eab3080d}.status-concept[_ngcontent-%COMP%]{color:#34d399;border-color:#10b9814d;background-color:#10b9810d}.status-research[_ngcontent-%COMP%]{color:#60a5fa;border-color:#3b82f64d;background-color:#3b82f60d}.hud-btn-alt[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border:1px solid rgba(59,130,246,.4);font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.2em;color:#fff;transition:all .2s;background-color:#3b82f61a;clip-path:polygon(10% 0,100% 0,90% 100%,0 100%);display:inline-flex;align-items:center}.hud-btn-alt[_ngcontent-%COMP%]:hover{background-color:#3b82f64d;border-color:#60a5fa;box-shadow:0 0 15px #3b82f64d}"]})};var T0=class n{constructor(e,t){this.router=e;this.settings=t}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||n)(ge(Ei),ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-landing-page"]],decls:41,vars:7,consts:[[1,"min-h-screen","bg-slate-950","flex","flex-col","items-center","justify-center","p-6","text-white","overflow-hidden","relative"],[1,"absolute","top-1/4","-left-1/4","w-96","h-96","bg-emerald-500/20","rounded-full","blur-3xl","animate-pulse"],[1,"absolute","bottom-1/4","-right-1/4","w-96","h-96","bg-purple-500/20","rounded-full","blur-3xl","animate-pulse",2,"animation-delay","1ms"],[1,"z-10","text-center","mb-12"],[1,"text-6xl","font-black","tracking-tighter","mb-4","bg-gradient-to-r","from-emerald-400","to-cyan-400","bg-clip-text","text-transparent","drop-shadow-sm"],[1,"text-slate-400","text-lg","max-w-md","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","w-full","max-w-5xl","z-10"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-emerald-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-emerald-400","hover:shadow-[0_0_40px_-10px_rgba(52,211,153,0.3)]","text-left",3,"click"],[1,"absolute","top-0","right-0","p-4","opacity-10","group-hover:opacity-20","transition-opacity"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24"],["d","M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.8L19.5 8 12 11.2 4.5 8 12 4.8zM4 15.5v-5.2l7 3.1v5.2l-7-3.1zm9 3.1v-5.2l7-3.1v5.2l-7 3.1z"],[1,"relative","z-20"],[1,"inline-block","px-3","py-1","bg-emerald-500/10","text-emerald-400","text-xs","font-bold","rounded-full","mb-4","border","border-emerald-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-emerald-50"],[1,"text-slate-400","leading-relaxed","mb-6"],[1,"flex","items-center","text-emerald-400","font-bold","group-hover:translate-x-2","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"cursor-pointer","group","relative","overflow-hidden","bg-slate-900","border","border-purple-500/30","rounded-2xl","p-8","transition-all","duration-500","hover:scale-105","hover:border-purple-400","hover:shadow-[0_0_40px_-10px_rgba(168,85,247,0.3)]","text-left",3,"click"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"inline-block","px-3","py-1","bg-purple-500/10","text-purple-400","text-xs","font-bold","rounded-full","mb-4","border","border-purple-500/20","uppercase","tracking-widest"],[1,"text-3xl","font-bold","mb-3","text-purple-50"],[1,"flex","items-center","text-purple-400","font-bold","group-hover:translate-x-2","transition-transform"],[1,"absolute","bottom-6","text-slate-500","text-sm","font-medium","uppercase","tracking-widest"]],template:function(t,i){t&1&&(b(0,"div",0),B(1,"div",1)(2,"div",2),b(3,"div",3)(4,"h1",4),v(5),T(),b(6,"p",5),v(7),T()(),b(8,"div",6)(9,"button",7),et("click",function(){return i.navigateTo("shape-tactics")}),b(10,"div",8),X(),b(11,"svg",9),B(12,"path",10),T()(),Ne(),b(13,"div",11)(14,"span",12),v(15),T(),b(16,"h2",13),v(17,"Shape Tactics"),T(),b(18,"p",14),v(19),T(),b(20,"div",15),v(21," ENTER PORTAL "),X(),b(22,"svg",16),B(23,"path",17),T()()()(),Ne(),b(24,"button",18),et("click",function(){return i.navigateTo("tower-defense")}),b(25,"div",8),X(),b(26,"svg",9),B(27,"path",19),T()(),Ne(),b(28,"div",11)(29,"span",20),v(30),T(),b(31,"h2",21),v(32,"Shape Defense"),T(),b(33,"p",14),v(34),T(),b(35,"div",22),v(36," DEFEND BASE "),X(),b(37,"svg",16),B(38,"path",17),T()()()()(),Ne(),b(39,"footer",23),v(40),T()()),t&2&&(y(5),H(" ",i.settings.currentLang()==="uk"?"\u0406\u0413\u0420\u041E\u0412\u0418\u0419 \u0426\u0415\u041D\u0422\u0420":"GAMING HUB"," "),y(2),H(" ",i.settings.currentLang()==="uk"?"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u043E\u0440\u0442\u0430\u043B, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0441\u0432\u043E\u044E \u043F\u043E\u0434\u043E\u0440\u043E\u0436.":"Select a portal to begin your journey."," "),y(8),H(" ","Live Now"," "),y(4),H(" ",i.settings.t("SHAPE_TACTIC_DESCRIPTION")," "),y(11),H(" ",i.settings.currentLang()==="uk"?"\u0413\u0420\u0410\u0422\u0418 \u0417\u0410\u0420\u0410\u0417":"PLAY NOW"," "),y(4),H(" ",i.settings.t("TOWER_DEFFENCE_DESCRIPTION")," "),y(6),H(" \xA9 2026 Shape Tactics Labs // ",i.settings.version," "))},dependencies:[jt],styles:["[_nghost-%COMP%]{display:block}"]})};var C0=class n{constructor(e,t){this.ngZone=e;this.firebase=t;this.initGame()}money=G(100);lives=G(20);wave=G(0);isWaveInProgress=G(!1);gameOver=G(!1);gridSize=10;grid=G([]);path=G([]);tileSize=62;enemies=G([]);projectiles=G([]);gameSpeedMultiplier=G(1);enemiesInternal=[];projectilesInternal=[];towersInternal=[];enemyIdCounter=1;projectileIdCounter=1;uiTick$=new Bt;animationFrameId=null;lastUpdateTime=0;lastUiPublishTime=0;enemiesToSpawn=0;currentWaveEnemyCount=0;spawnTimer=0;spawnInterval=1e3;towerCosts=[15,50,250,1500];tierStats=[{damage:5,range:2,fireInterval:.5},{damage:20,range:2.5,fireInterval:1},{damage:80,range:3,fireInterval:2},{damage:300,range:3.5,fireInterval:3}];savedResult=!1;async saveResultIfLoggedIn(){let e=this.firebase.user$();if(!e)return;let t={userId:e.uid,displayName:e.displayName||"Anonymous",maxWave:this.wave(),totalMoney:this.money()};try{await this.firebase.saveTowerDefenseScore(t)}catch{}}dispose(){this.stopGameLoop(),this.enemiesInternal=[],this.projectilesInternal=[],this.towersInternal=[],this.enemiesToSpawn=0,this.currentWaveEnemyCount=0,this.spawnTimer=0,this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!1),this.savedResult=!1,this.money.set(100),this.lives.set(100),this.wave.set(0);let e=this.grid();if(e&&e.length){let t=e.map(i=>i.map(r=>r.tower?fe(F({},r),{tower:null}):r));this.grid.set(t)}}resetEngine(){this.initializeGame(1)}initGame(){this.initializeGame(1)}resetGame(){this.initializeGame(1)}generateMap(){let e=this.generateRandomPath();this.path.set(e);let t=[];this.towersInternal=[];let i=new Set(e.map(r=>`${r.x},${r.y}`));for(let r=0;r<this.gridSize;r++){let o=[];for(let s=0;s<this.gridSize;s++){let a="void";i.has(`${s},${r}`)?a="path":[{x:s-1,y:r},{x:s+1,y:r},{x:s,y:r-1},{x:s,y:r+1}].some(c=>i.has(`${c.x},${c.y}`))&&(a="buildable"),o.push({x:s,y:r,type:a,tower:null})}t.push(o)}this.grid.set(t)}initializeGame(e){this.gridSize=e===2?20:10,this.dispose(),this.generateMap()}generateRandomPath(){let e=this.gridSize-1,t=[{x:0,y:0}],i={x:0,y:0},r={x:e,y:e};for(;i.x!==r.x||i.y!==r.y;){let o=[];i.x<r.x&&o.push({x:i.x+1,y:i.y}),i.y<r.y&&o.push({x:i.x,y:i.y+1});let s;if(o.length>1){let a=t.length>1?t[t.length-2]:null,l=a?i.x-a.x:1,c=a?i.y-a.y:0,d=o.find(h=>h.x-i.x===l&&h.y-i.y===c);d&&Math.random()<.8?s=d:s=o[Math.floor(Math.random()*o.length)]}else s=o[0];t.push(s),i=s}return t}startWave(){if(this.isWaveInProgress()||this.gameOver())return;this.wave.update(t=>t+1),this.isWaveInProgress.set(!0);let e=5+this.wave()*2;this.enemiesToSpawn=e,this.currentWaveEnemyCount=e,this.spawnTimer=0,this.startGameLoop()}startGameLoop(){this.stopGameLoop(),this.lastUpdateTime=performance.now(),this.ngZone.runOutsideAngular(()=>{let e=t=>{if(this.gameOver())return;let i=(t-this.lastUpdateTime)/1e3;this.lastUpdateTime=t;let r=Math.min(i,.05);this.updateGame(r),this.enemies.set([...this.enemiesInternal]),this.gameSpeedMultiplier()===1?this.projectiles.set([...this.projectilesInternal]):this.projectiles.set([]),this.uiTick$.next(),this.animationFrameId=requestAnimationFrame(e)};this.animationFrameId=requestAnimationFrame(e)})}stopGameLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateGame(e){let t=e*this.gameSpeedMultiplier();if(this.handleSpawning(t),this.updateEnemies(t),this.updateTowers(t),this.updateProjectiles(t),this.lives()<=0&&!this.gameOver()){this.enemiesInternal=[],this.projectilesInternal=[],this.enemiesToSpawn=0,this.stopGameLoop(),this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1),this.gameOver.set(!0)}),this.savedResult||(this.savedResult=!0,this.saveResultIfLoggedIn());return}this.enemiesInternal.length===0&&this.enemiesToSpawn===0&&this.isWaveInProgress()&&(this.enemiesInternal=[],this.projectilesInternal=[],this.ngZone.run(()=>{this.enemies.set([]),this.projectiles.set([]),this.isWaveInProgress.set(!1)}))}handleSpawning(e){this.enemiesToSpawn<=0||(this.spawnTimer+=e*1e3,this.spawnTimer>=this.spawnInterval&&(this.spawnTimer=0,this.spawnEnemy(),this.enemiesToSpawn--))}spawnEnemy(){let e=50*Math.pow(1.2,this.wave()),t=.5+this.wave()*.05,i=this.currentWaveEnemyCount||5+this.wave()*2,r=i-this.enemiesToSpawn,o=this.wave()%5===0,s=r===i-1,a=o&&s,l=this.wave()*40%360,c=a?e*3:e,d=a?t*.5:t,h={id:"e"+this.enemyIdCounter++,position:F({},this.path()[0]),pathIndex:0,hp:c,maxHp:c,speed:d,progress:0,isBoss:a,hue:l,baseSpeed:t,speedModifier:1,shatterStacks:0,isFrozen:!1};this.enemiesInternal.push(h)}updateEnemies(e){for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i];r.speedModifier=1,r.isFrozen=!1}this.applyFrostAuras();let t=this.tileSize;for(let i=this.enemiesInternal.length-1;i>=0;i--){let r=this.enemiesInternal[i],o=r.baseSpeed*r.speedModifier;if(r.progress+=o*e,r.progress>=1){if(r.pathIndex++,r.progress=0,r.pathIndex>=this.path().length-1){this.enemiesInternal.splice(i,1),this.ngZone.run(()=>this.lives.update(g=>Math.max(0,g-1)));continue}r.position=F({},this.path()[r.pathIndex])}let s=this.path(),a=s[r.pathIndex],l=s[r.pathIndex+1]||a,c=a.x+(l.x-a.x)*r.progress,d=a.y+(l.y-a.y)*r.progress;r.displayX=(c+.5)*t,r.displayY=(d+.5)*t;let h=r.shatterStacks??0,p=h>0?Math.min(70,50+h*4):50;r.scale=r.isBoss?1.5:1,r.bg=r.isFrozen?`hsl(190, 80%, ${p}%)`:`hsl(${r.hue}, 70%, ${p}%)`,r.hp<=0&&(this.enemiesInternal.splice(i,1),this.ngZone.run(()=>this.money.update(g=>g+5+this.wave())))}}updateTowers(e){if(!(this.enemiesInternal.length===0||this.towersInternal.length===0)){for(let t of this.towersInternal)if(t.cooldown-=e,t.cooldown<=0){let i=this.findNearestEnemy(t,this.enemiesInternal);i?(this.fireAt(t,i),t.cooldown=t.fireInterval):t.cooldown=0}}}applyFrostAuras(){if(this.enemiesInternal.length===0)return;let e=this.towersInternal.filter(i=>i.type===1&&i.specialActive);if(e.length===0)return;let t=4;for(let i of this.enemiesInternal){let r=!1;for(let o of e){let s=o.position.x-i.position.x,a=o.position.y-i.position.y;if(s*s+a*a<=t){r=!0;break}}r&&(i.speedModifier=.7,i.isFrozen=!0)}}findNearestEnemy(e,t){let i=null,r=e.range*e.range;for(let o of t){let s=e.position.x-o.position.x,a=e.position.y-o.position.y,l=s*s+a*a;l<=r&&(r=l,i=o)}return i}pushProjectile(e){this.projectilesInternal.length>=100&&this.projectilesInternal.shift(),this.projectilesInternal.push(e)}fireAt(e,t){let i={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},t.position),progress:0};this.pushProjectile(i);let r=e.damage;if(e.specialActive&&e.type===4&&t.hp/t.maxHp<.15)if(t.isBoss)r=e.damage*3;else{t.hp=0;return}if(e.specialActive&&e.type===3){let o=Math.min(5,t.shatterStacks+1);t.shatterStacks=o;let s=1+o*.1;r=Math.floor(r*s)}if(t.hp-=r,e.specialActive&&e.type===2&&Math.random()<.25){let o=[];for(let a of this.enemiesInternal){if(a.id===t.id)continue;let l=t.position.x-a.position.x,c=t.position.y-a.position.y;if(Math.sqrt(l*l+c*c)<=3&&(o.push(a),o.length>=2))break}let s=Math.floor(e.damage*.5);for(let a of o){let l={id:"p"+this.projectileIdCounter++,from:F({},e.position),to:F({},a.position),progress:0};this.pushProjectile(l),a.hp-=s}}}updateProjectiles(e){for(let t=this.projectilesInternal.length-1;t>=0;t--){let i=this.projectilesInternal[t];i.progress+=5*e,i.progress>=1&&this.projectilesInternal.splice(t,1)}}buyTower(e,t,i){let r=this.towerCosts[i-1];this.money()<r||this.grid.update(o=>{let s=o[t][e];if(s.type==="buildable"&&!s.tower){let a=this.tierStats[i-1];s.tower={id:crypto.randomUUID(),type:i,level:1,position:{x:e,y:t},baseCost:r,invested:r,damage:a.damage,range:a.range,fireInterval:a.fireInterval,cooldown:0,specialActive:!1},this.towersInternal.push(s.tower),this.money.update(l=>l-r)}return[...o]})}upgradeTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level<4){let o=this.getUpgradeCost(r.tower);this.money()>=o&&(r.tower.level++,r.tower.damage=Math.floor(r.tower.damage*1.3),r.tower.range+=.5,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i]})}getUpgradeCost(e){let t=.5;switch(e.level){case 1:t=.5;break;case 2:t=.6;break;case 3:t=.7;break}return Math.floor(e.baseCost*t)}getSpecialCost(e){return e.baseCost*4}buyAbility(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower&&r.tower.level===4&&!r.tower.specialActive){let o=this.getSpecialCost(r.tower);this.money()>=o&&(r.tower.specialActive=!0,r.tower.invested+=o,this.money.update(s=>s-o))}return[...i.map(o=>[...o])]})}sellTower(e,t){this.grid.update(i=>{let r=i[t][e];if(r.tower){let o=r.tower.invested??r.tower.baseCost,s=Math.floor(o*.5),a=r.tower.id;r.tower=null,this.money.update(c=>c+s);let l=this.towersInternal.findIndex(c=>c.id===a);l!==-1&&this.towersInternal.splice(l,1)}return[...i]})}getEnemiesRef(){return this.enemiesInternal}getProjectilesRef(){return this.projectilesInternal}getTowersRef(){return this.towersInternal}getPathRef(){return this.path()}getGridRef(){return this.grid()}static \u0275fac=function(t){return new(t||n)(De(mn),De(jn))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Fq=["gameCanvas"];function Lq(n,e){if(n&1){let t=Je();wl(0),b(1,"button",29),et("click",function(){ie(t);let r=Dr(0),o=O(3);return re(o.buyTower(r))}),b(2,"div",30)(3,"span",31),v(4),T(),b(5,"span"),v(6),T()(),b(7,"span",32),v(8),T()()}if(n&2){let t=e.$implicit,i=e.$index,r=O(3),o=Ou(i+1);y(),Pe("bg-slate-700",r.tdEngine.money()>=t)("hover:bg-slate-600",r.tdEngine.money()>=t)("bg-slate-900",r.tdEngine.money()<t),aa("disabled",r.tdEngine.money()<t),y(3),H("T",o),y(2),tn("",r.settings.t("TIER")," ",o),y(2),H("$",t)}}function Vq(n,e){if(n&1&&(b(0,"h3",26),v(1),T(),b(2,"div",27),wn(3,Lq,9,12,"button",28,Nu),T()),n&2){let t=O(2);y(),H(" ",t.settings.t("BUY_DEFENDER")," "),y(2),xn(t.tdEngine.towerCosts)}}function Uq(n,e){if(n&1){let t=Je();b(0,"button",45),et("click",function(){ie(t);let r=O(3);return re(r.upgradeTower())}),b(1,"span"),v(2),T(),b(3,"span",46),v(4),T()()}if(n&2){let t=O(2),i=O();aa("disabled",i.tdEngine.money()<i.tdEngine.getUpgradeCost(t.tower)),y(2),W(i.settings.t("UPGRADE")),y(2),H("$",i.tdEngine.getUpgradeCost(t.tower))}}function Bq(n,e){if(n&1&&(b(0,"div",43),v(1),T()),n&2){let t=O(3);y(),H(" ",t.settings.t("MAX_LEVEL")," ")}}function jq(n,e){if(n&1&&(b(0,"span",46),v(1),T()),n&2){let t=O(3),i=O();y(),H("$",i.tdEngine.getSpecialCost(t.tower))}}function Hq(n,e){if(n&1&&(b(0,"div",49),v(1),T(),b(2,"div",50),v(3),T()),n&2){let t=O(4);y(),H(" ",t.settings.t("FROST_AURA")," "),y(2),H(" ",t.settings.t("FROST_AURA_INFO")," ")}}function $q(n,e){if(n&1&&(b(0,"div",51),v(1),T(),b(2,"div",50),v(3),T()),n&2){let t=O(4);y(),H(" ",t.settings.t("CHAIN_LIGHTNING")," "),y(2),H(" ",t.settings.t("CHAIN_LIGHTNING_INFO")," ")}}function Gq(n,e){if(n&1&&(b(0,"div",52),v(1),T(),b(2,"div",50),v(3),T()),n&2){let t=O(4);y(),H(" ",t.settings.t("SHATTER")," "),y(2),H(" ",t.settings.t("SHATTER_INFO")," ")}}function zq(n,e){if(n&1&&(b(0,"div",53),v(1),T(),b(2,"div",50),v(3),T()),n&2){let t=O(4);y(),H(" ",t.settings.t("FINAL_STRIKE")," "),y(2),H(" ",t.settings.t("FINAL_STRIKE_INFO")," ")}}function Wq(n,e){if(n&1){let t=Je();b(0,"button",47),et("click",function(){ie(t);let r=O(3);return re(r.buyAbility())}),b(1,"span"),v(2),T(),Y(3,jq,2,1,"span",46),T(),b(4,"div",48),Y(5,Hq,4,2),Y(6,$q,4,2),Y(7,Gq,4,2),Y(8,zq,4,2),T()}if(n&2){let t=O(2),i=O();Pe("bg-purple-600",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("hover:bg-purple-500",!t.tower.specialActive&&i.tdEngine.money()>=i.tdEngine.getSpecialCost(t.tower))("bg-slate-700",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),aa("disabled",t.tower.specialActive||i.tdEngine.money()<i.tdEngine.getSpecialCost(t.tower)),y(2),H(" ",t.tower.specialActive?i.settings.t("ABILITY_ACTIVE"):i.settings.t("BUY_ABILITY")," "),y(),Q(t.tower.specialActive?-1:3),y(2),Q(t.tower.type===1?5:-1),y(),Q(t.tower.type===2?6:-1),y(),Q(t.tower.type===3?7:-1),y(),Q(t.tower.type===4?8:-1)}}function qq(n,e){if(n&1){let t=Je();b(0,"h3",33),v(1),T(),b(2,"div",34)(3,"div",35)(4,"span",36),v(5),T(),b(6,"span",37),v(7),T()(),b(8,"div",35)(9,"span",36),v(10),T(),b(11,"span",37),v(12),T()(),b(13,"div",35)(14,"span",36),v(15),T(),b(16,"span",38),v(17),T()(),b(18,"div",39)(19,"span",36),v(20),T(),b(21,"span",40),v(22),T()()(),b(23,"div",41),Y(24,Uq,5,3,"button",42)(25,Bq,2,1,"div",43),b(26,"button",44),et("click",function(){ie(t);let r=O(2);return re(r.sellTower())}),v(27),T(),Y(28,Wq,9,13),T()}if(n&2){let t=O(),i=O();y(),H(" ",i.settings.t("DEFENDER_INFO")," "),y(4),W(i.settings.t("TIER")),y(2),W(t.tower.type),y(3),W(i.settings.t("LEVEL")),y(2),H("",t.tower.level," / 4"),y(3),W(i.settings.t("DAMAGE")),y(2),W(t.tower.damage),y(3),W(i.settings.t("RANGE")),y(2),W(t.tower.range),y(2),Q(t.tower.level<4?24:25),y(3),H(" ",i.settings.t("SELL")," (50% REFUND) "),y(),Q(t.tower.level===4?28:-1)}}function Kq(n,e){n&1&&Y(0,Vq,5,1)(1,qq,29,12),n&2&&Q(e.tower?1:0)}function Yq(n,e){if(n&1&&(b(0,"div",24),X(),b(1,"svg",54),B(2,"path",55),T(),Ne(),b(3,"p",56),v(4),B(5,"br"),v(6),T()()),n&2){let t=O();y(4),H(" ",t.settings.t("SELECT_BUILD_TILE")," "),y(2),H(" ",t.settings.t("TO_PLACE_DEFENDER")," ")}}function Qq(n,e){if(n&1){let t=Je();b(0,"div",25)(1,"div",57)(2,"h2",58),v(3),T(),b(4,"p",59),v(5),T(),b(6,"button",60),et("click",function(){ie(t);let r=O();return re(r.onRestart())}),v(7),T()()()}if(n&2){let t=O();y(3),W(t.settings.t("GAME_OVER")),y(2),es(" ",t.settings.t("YOU_SURVIVED")," ",t.tdEngine.wave()," ",t.settings.t("WAVES")," "),y(2),H(" ",t.settings.t("TRY_AGAIN")," ")}}var D0=class n{constructor(e,t,i,r,o){this.tdEngine=e;this.settings=t;this.firebase=i;this.router=r;this.cdr=o}selectedTile=G(null);uiSub;gameCanvas;ctx;rafId=null;isBrowser=typeof window<"u"&&typeof document<"u";onKeyDown(e){if(this.tdEngine.isWaveInProgress())return;if(e.key==="Enter"){e.preventDefault(),this.tdEngine.startWave();return}}onKeyUp(e){}ngOnInit(){this.tdEngine.resetEngine(),this.uiSub=this.tdEngine.uiTick$.subscribe(()=>{this.cdr.detectChanges()})}ngAfterViewInit(){this.isBrowser&&(this.initCanvas(),this.startCanvasLoop(),window.addEventListener("resize",this.resizeCanvas))}ngOnDestroy(){this.uiSub?.unsubscribe(),this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.isBrowser&&window.removeEventListener("resize",this.resizeCanvas),this.tdEngine.resetEngine()}goBack(){this.tdEngine.resetEngine(),this.router.navigate(["/"])}onRestart(){this.tdEngine.resetGame(),this.selectedTile.set(null)}onTileClick(e){e.type==="buildable"||e.tower?this.selectedTile.set(e):this.selectedTile.set(null)}buyTower(e){let t=this.selectedTile();t&&(this.tdEngine.buyTower(t.x,t.y,e),this.selectedTile.set(null))}upgradeTower(){let e=this.selectedTile();e&&e.tower&&this.tdEngine.upgradeTower(e.x,e.y)}getRangeStyle(){let e=this.selectedTile();if(!e||!e.tower)return{display:"none"};let t=e.tower,i=t.range*2*62;return{left:`${t.position.x*62+30}px`,top:`${t.position.y*62+30}px`,width:`${i}px`,height:`${i}px`,display:"block"}}sellTower(){let e=this.selectedTile();e&&e.tower&&(this.tdEngine.sellTower(e.x,e.y),this.selectedTile.set(null))}buyAbility(){let e=this.selectedTile();e&&e.tower&&e.tower.level===4&&!e.tower.specialActive&&this.tdEngine.buyAbility(e.x,e.y)}setSpeed(e){this.tdEngine.gameSpeedMultiplier.set(e)}onLoginClick(){if(!this.firebase.user$())try{this.firebase.loginWithGoogle()}catch{}}initCanvas=()=>{let e=this.gameCanvas?.nativeElement;e&&(this.ctx=e.getContext("2d"),this.resizeCanvas())};resizeCanvas=()=>{let e=this.gameCanvas?.nativeElement;if(!e)return;let t=this.tdEngine.tileSize,i=this.tdEngine.gridSize*t;e.style.width=`${i}px`,e.style.height=`${i}px`;let r=Math.max(1,window.devicePixelRatio||1);e.width=Math.floor(i*r),e.height=Math.floor(i*r);let o=e.getContext("2d");o&&(o.setTransform(r,0,0,r,0,0),this.ctx=o)};startCanvasLoop(){let e=()=>{this.drawFrame(),this.rafId=requestAnimationFrame(e)};this.rafId=requestAnimationFrame(e)}clearCanvas(e,t){e.clearRect(0,0,t,t)}drawFrame(){let e=this.gameCanvas?.nativeElement,t=this.ctx;if(!e||!t)return;let i=this.tdEngine.tileSize,r=this.tdEngine.gridSize*i;this.clearCanvas(t,r),this.drawGrid(t,i),this.drawSelection(t,i),this.drawFrostAuras(t,i),this.drawTowers(t,i),this.drawEnemies(t,i),this.tdEngine.gameSpeedMultiplier()===1&&this.drawProjectiles(t,i),this.drawRangeIndicator(t,i)}drawGrid(e,t){let i=this.tdEngine.getGridRef();for(let r=0;r<i.length;r++){let o=i[r];for(let s=0;s<o.length;s++){let a=o[s];a.type==="path"?e.fillStyle="#475569":a.type==="buildable"?e.fillStyle="#1e293b":e.fillStyle="rgba(255,255,255,0.06)",e.fillRect(s*t,r*t,t-2,t-2)}}}drawTowers(e,t){let i=this.tdEngine.getTowersRef();for(let r of i){let o=r.position.x*t+t/2,s=r.position.y*t+t/2;this.drawTowerShape(e,o,s,r.type,r.level,t)}}drawTowerShape(e,t,i,r,o,s){let a=s*.5,l=a/2,c=r===1?"#0ea5e9":r===2?"#a855f7":r===3?"#f59e0b":"#ef4444",d=2.5,h=Math.max(1,Math.min(4,o||1));if(e.save(),e.lineWidth=d,e.strokeStyle=c,h>=4&&(e.shadowColor=c,e.shadowBlur=16),e.beginPath(),r===1){let p=a*.5;e.arc(t,i,p,0,Math.PI*2)}else if(r===2){let p=a*.9,g=a*.9;e.moveTo(t,i-p/2),e.lineTo(t-g/2,i+p/2),e.lineTo(t+g/2,i+p/2),e.closePath()}else if(r===3)e.rect(t-l,i-l,a,a);else{let p=a*.5;for(let g=0;g<6;g++){let S=Math.PI/3*g-Math.PI/2,I=t+Math.cos(S)*p,P=i+Math.sin(S)*p;g===0?e.moveTo(I,P):e.lineTo(I,P)}e.closePath()}if(h>=2&&(e.fillStyle=c,e.globalAlpha=h===2?.7:.9,e.fill(),e.globalAlpha=1),e.stroke(),h>=3){e.beginPath();let p=a*.18;e.arc(t,i,p,0,Math.PI*2),e.fillStyle="#0f172a",e.fill()}if(h>=4){e.beginPath();let p=a*.7;e.arc(t,i,p,0,Math.PI*2),e.strokeStyle=c,e.globalAlpha=.4,e.stroke()}e.restore()}drawFrostAuras(e,t){let i=this.tdEngine.getTowersRef();for(let r of i)if(r.type===1&&r.specialActive){let o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=2*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.15)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56, 189, 248, 0.5)",e.stroke()}}drawEnemies(e,t){let i=this.tdEngine.getEnemiesRef();for(let r of i){let s=(r.isBoss?1.5:1)*(t*.65)/2,a=r.displayX??(r.position.x+.5)*t,l=r.displayY??(r.position.y+.5)*t;e.beginPath(),e.arc(a,l,s,0,Math.PI*2),e.fillStyle=r.bg||(r.isFrozen?"#7dd3fc":"#ef4444"),e.shadowColor=this.tdEngine.gameSpeedMultiplier()>1?"transparent":e.fillStyle,e.shadowBlur=this.tdEngine.gameSpeedMultiplier()>1?0:10,e.fill(),e.shadowBlur=0}for(let r of i){let o=(r.isBoss?1.5:1)*(t*.65),s=o/2,a=r.displayX??(r.position.x+.5)*t,l=r.displayY??(r.position.y+.5)*t,c=o,d=6;e.fillStyle="#0f172a",e.fillRect(a-s,l-s-10,c,d),e.fillStyle="#10b981";let h=Math.max(0,Math.min(1,r.hp/r.maxHp));e.fillRect(a-s,l-s-10,c*h,d)}}drawSelection(e,t){let i=this.selectedTile();if(!i)return;let r=i.x*t,o=i.y*t;e.save(),e.lineWidth=3,e.strokeStyle="rgba(56, 189, 248, 0.95)",e.shadowColor="rgba(56, 189, 248, 0.9)",e.shadowBlur=14,e.strokeRect(r+1.5,o+1.5,t-3,t-3),e.restore()}drawProjectiles(e,t){let i=this.tdEngine.getProjectilesRef();e.fillStyle="#fbbf24";for(let r of i){let o=r.from.x+(r.to.x-r.from.x)*r.progress,s=r.from.y+(r.to.y-r.from.y)*r.progress;e.beginPath(),e.arc(o*t+t/2,s*t+t/2,3,0,Math.PI*2),e.fill()}}drawRangeIndicator(e,t){let i=this.selectedTile();if(!i||!i.tower)return;let r=i.tower,o=r.position.x*t+t/2,s=r.position.y*t+t/2,a=r.range*t;e.beginPath(),e.arc(o,s,a,0,Math.PI*2),e.fillStyle="rgba(56, 189, 248, 0.12)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56, 189, 248, 0.4)",e.stroke()}onCanvasClick(e){let t=this.gameCanvas?.nativeElement;if(!t)return;let i=t.getBoundingClientRect(),r=e.clientX-i.left,o=e.clientY-i.top,s=this.tdEngine.tileSize,a=Math.floor(r/s),l=Math.floor(o/s),c=this.tdEngine.getGridRef();l>=0&&l<c.length&&a>=0&&a<c[0].length&&this.onTileClick(c[l][a])}static \u0275fac=function(t){return new(t||n)(ge(C0),ge(Rt),ge(jn),ge(Ei),ge(ua))};static \u0275cmp=Dt({type:n,selectors:[["app-tower-defense"]],viewQuery:function(t,i){if(t&1&&_l(Fq,5),t&2){let r;El(r=bl())&&(i.gameCanvas=r.first)}},hostBindings:function(t,i){t&1&&ce("keydown",function(o){return i.onKeyDown(o)},oa)("keyup",function(o){return i.onKeyUp(o)},oa)},decls:42,vars:46,consts:[["gameCanvas",""],[1,"flex","flex-col","h-full","p-4","overflow-hidden"],[1,"relative"],[1,"hud-overlay"],[1,"flex","items-center","justify-between","mb-4","bg-slate-800","p-3","rounded-lg","border","border-slate-700"],[1,"flex","items-center","gap-3"],[1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors",3,"click"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"flex","flex-col","items-center","gap-1","font-black","tracking-wide"],[1,"flex","items-baseline","gap-6"],[1,"text-emerald-400","text-lg","font-mono"],[1,"text-rose-400","text-lg","font-mono"],[1,"text-sky-400","text-lg","font-mono"],[1,"flex","items-center","gap-1","text-xs"],[1,"text-slate-400","mr-1"],[1,"px-2","py-0.5","rounded","border","text-[10px]","font-bold",3,"click"],[1,"px-3","py-2","bg-slate-700","hover:bg-slate-600","text-xs","font-bold","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"bg-rose-600","hover:bg-rose-500","text-white","text-xs","font-bold","px-3","py-2","rounded","transition-colors","uppercase","tracking-wider",3,"click"],[1,"cursor-pointer","px-4","py-2","rounded","text-sm","font-black","transition-all",3,"click","disabled"],[1,"flex","gap-4","flex-1","min-h-0"],[1,"flex-1","relative","bg-slate-900","rounded-lg","overflow-auto","border","border-slate-700","flex","items-center","justify-center","p-4"],[1,"block","rounded",3,"click"],[1,"w-64","flex","flex-col","gap-4"],[1,"flex-1","bg-slate-800","rounded-lg","border","border-slate-700","p-4","overflow-y-auto"],[1,"h-full","flex","flex-col","items-center","justify-center","text-center","text-slate-500"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-slate-950/70","backdrop-blur-sm","z-[200]"],[1,"text-sm","font-bold","text-slate-400","mb-4","uppercase","tracking-wider"],[1,"flex","flex-col","gap-3"],[1,"shop-btn","flex","justify-between","items-center",3,"disabled","bg-slate-700","hover:bg-slate-600","bg-slate-900"],[1,"shop-btn","flex","justify-between","items-center",3,"click","disabled"],[1,"flex","items-center","gap-2"],[1,"text-xs","bg-slate-600","px-1.5","rounded"],[1,"text-emerald-400","font-mono"],[1,"text-sm","font-bold","text-slate-400","mb-2","uppercase","tracking-wider"],[1,"bg-slate-900","rounded","p-3","mb-4"],[1,"flex","justify-between","mb-1"],[1,"text-xs","text-slate-500"],[1,"text-xs","font-bold"],[1,"text-xs","font-bold","text-rose-400"],[1,"flex","justify-between"],[1,"text-xs","font-bold","text-sky-400"],[1,"flex","flex-col","gap-2"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"disabled"],[1,"w-full","py-3","bg-slate-900","text-slate-500","rounded","text-center","font-bold","border","border-slate-700"],[1,"w-full","py-3","bg-rose-700","hover:bg-rose-600","rounded","font-bold","transition-all","flex","justify-center","items-center","text-sm",3,"click"],[1,"w-full","py-3","bg-emerald-600","hover:bg-emerald-500","disabled:bg-slate-700","disabled:text-slate-500","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"font-mono"],[1,"cursor-pointer","w-full","py-3","rounded","font-bold","transition-all","flex","justify-between","px-4","items-center",3,"click","disabled"],[1,"mt-4","pt-4","border-t","border-white/10","space-y-2"],[1,"text-blue-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-gray-400","text-sm","leading-relaxed"],[1,"text-yellow-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-red-400","font-bold","tracking-wide","uppercase","text-sm"],[1,"text-purple-400","font-bold","tracking-wide","uppercase","text-sm"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mb-2","opacity-20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"],[1,"text-sm"],[1,"bg-slate-900","border","border-slate-700","rounded-lg","px-8","py-6","text-center","shadow-xl"],[1,"text-2xl","font-black","text-rose-400","mb-2"],[1,"text-slate-300","mb-4"],[1,"bg-emerald-600","hover:bg-emerald-500","text-white","font-bold","px-6","py-2","rounded",3,"click"]],template:function(t,i){if(t&1){let r=Je();b(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"button",6),et("click",function(){return ie(r),re(i.goBack())}),v(6),T(),b(7,"button",7),et("click",function(){return ie(r),re(i.router.navigate(["/tower-defense-leaderboard"]))}),v(8),T()(),b(9,"div",8)(10,"div",9)(11,"div",10),v(12),T(),b(13,"div",11),v(14),T(),b(15,"div",12),v(16),T()(),b(17,"div",13)(18,"span",14),v(19,"Speed:"),T(),b(20,"button",15),et("click",function(){return ie(r),re(i.setSpeed(1))}),v(21," 1x "),T(),b(22,"button",15),et("click",function(){return ie(r),re(i.setSpeed(2))}),v(23," 2x "),T(),b(24,"button",15),et("click",function(){return ie(r),re(i.setSpeed(4))}),v(25," 4x "),T()()(),b(26,"div",5)(27,"button",16),et("click",function(){return ie(r),re(i.onLoginClick())}),v(28),T(),b(29,"button",17),et("click",function(){return ie(r),re(i.onRestart())}),v(30),T(),b(31,"button",18),et("click",function(){return ie(r),re(i.tdEngine.startWave())}),v(32),T()()()()(),b(33,"div",19)(34,"div",20)(35,"canvas",21,0),et("click",function(s){return ie(r),re(i.onCanvasClick(s))}),T()(),b(37,"div",22)(38,"div",23),Y(39,Kq,2,1)(40,Yq,7,2,"div",24),T()()(),Y(41,Qq,8,5,"div",25),T()}if(t&2){let r,o;y(6),H(" ",i.settings.t("EXIT_GAME")," "),y(2),H(" ",i.settings.t("RANKING")," "),y(4),tn("",i.settings.t("MONEY"),": $",i.tdEngine.money()),y(2),tn("",i.settings.t("LIVES"),": ",i.tdEngine.lives()),y(2),tn("",i.settings.t("WAVE"),": ",i.tdEngine.wave()),y(4),Pe("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===1)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===1)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==1)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==1),y(2),Pe("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===2)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===2)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==2)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==2),y(2),Pe("bg-slate-200",i.tdEngine.gameSpeedMultiplier()===4)("text-slate-900",i.tdEngine.gameSpeedMultiplier()===4)("bg-slate-800",i.tdEngine.gameSpeedMultiplier()!==4)("text-slate-300",i.tdEngine.gameSpeedMultiplier()!==4),y(4),H(" ",i.firebase.user$()?((r=i.firebase.user$())==null?null:r.displayName)||"Account":"Login to Save Score"," "),y(2),H(" ",i.settings.t("RESTART_GAME")," "),y(),Pe("bg-sky-600",!i.tdEngine.isWaveInProgress())("hover:bg-sky-500",!i.tdEngine.isWaveInProgress())("bg-slate-700",i.tdEngine.isWaveInProgress())("text-slate-500",i.tdEngine.isWaveInProgress()),aa("disabled",i.tdEngine.isWaveInProgress()),y(),H(" ",i.tdEngine.isWaveInProgress()?i.settings.t("WAVE_IN_PROGRESS"):i.settings.t("START_WAVE")," "),y(7),Q((o=i.selectedTile())?39:40,o),y(2),Q(i.tdEngine.gameOver()?41:-1)}},dependencies:[jt],styles:[`.monopoly-top[_ngcontent-%COMP%]{top:46px}.mobile-hud-header[_ngcontent-%COMP%], .actions-bar[_ngcontent-%COMP%]{display:none}@media(max-width:1024px){.roadmap[_ngcontent-%COMP%], .nav-bar[_ngcontent-%COMP%], .status-bar[_ngcontent-%COMP%]{display:none}.mobile-hud-header[_ngcontent-%COMP%]{display:flex;margin-bottom:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-item[_ngcontent-%COMP%]{min-width:0}.mobile-hud-header[_ngcontent-%COMP%]   .hud-value[_ngcontent-%COMP%]{white-space:nowrap}.burger-btn[_ngcontent-%COMP%]{min-width:34px;min-height:34px}.actions-bar[_ngcontent-%COMP%]{display:flex;position:fixed;bottom:0;background:#05132b;z-index:100}.action-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:6px;background:#ffffff14;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center}.board[_ngcontent-%COMP%]{max-width:100vw;max-height:calc(100vh - 140px)}.end-overlay[_ngcontent-%COMP%]   .end-dialog[_ngcontent-%COMP%]{width:90vw;max-width:560px}.mobile-menu-overlay[_ngcontent-%COMP%]   .mobile-menu-panel[_ngcontent-%COMP%]   .menu-link[_ngcontent-%COMP%]{width:100%;text-align:left;padding:10px 12px;border-radius:8px;background:#ffffff0f;border:1px solid rgba(255,255,255,.12);color:#e5e7eb;font-size:12px;letter-spacing:.05em}.mobile-actions-hide-text[_ngcontent-%COMP%], .mobile-hide-logo[_ngcontent-%COMP%]{display:none}.mobile-actions-compact[_ngcontent-%COMP%]{left:0;top:0;bottom:unset;right:unset;opacity:.8;scale:.8}.mobile-actions-compact-plan[_ngcontent-%COMP%]{bottom:50px;right:6px}}.spawn-zone-highlight[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #3b82f680;border-radius:4px;background-image:radial-gradient(circle,#3b82f633,#3b82f600 70%);animation:_ngcontent-%COMP%_pulseHighlight 2s infinite}@keyframes _ngcontent-%COMP%_pulseHighlight{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tremble .18s ease-in-out 0s 1 normal forwards}@keyframes _ngcontent-%COMP%_tremble{0%{transform:translate(0) rotate(0)}20%{transform:translate(-1px,.5px) rotate(-.5deg)}40%{transform:translate(1px,-.5px) rotate(.6deg)}60%{transform:translate(-1px,.5px) rotate(-.6deg)}80%{transform:translate(1px,-.5px) rotate(.4deg)}to{transform:translate(0) rotate(0)}}.hit-flash[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hitFlash .3s ease-out 1}@keyframes _ngcontent-%COMP%_hitFlash{0%{filter:brightness(1)}30%{filter:brightness(1.8)}to{filter:brightness(1)}}.hp-drain[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_hpDrain 1.2s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_hpDrain{0%{width:90%}50%{width:60%}to{width:30%}}.merge-loop[_ngcontent-%COMP%]{position:relative;width:160px;height:80px}.merge-loop[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{position:absolute;top:20px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:9999px;font-weight:700}.merge-loop[_ngcontent-%COMP%]   .u1[_ngcontent-%COMP%]{left:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u1ToCenter 1.6s ease-in-out infinite alternate}.merge-loop[_ngcontent-%COMP%]   .u2[_ngcontent-%COMP%]{right:10px;background:#3b82f6;color:#fff;animation:_ngcontent-%COMP%_u2ToCenter 1.6s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_u1ToCenter{0%{transform:translate(0)}50%{transform:translate(44px)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_u2ToCenter{0%{transform:translate(0)}50%{transform:translate(-44px)}to{transform:translate(0)}}.merge-loop[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{position:absolute;left:50%;top:18px;transform:translate(-50%);width:42px;height:42px;border-radius:8px;background:#60a5fa;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;opacity:0;animation:_ngcontent-%COMP%_resultAppear 1.6s ease-in-out infinite alternate,_ngcontent-%COMP%_tremble .18s ease-in-out .7s infinite}@keyframes _ngcontent-%COMP%_resultAppear{0%{opacity:0;transform:translate(-50%) scale(.8)}40%{opacity:0;transform:translate(-50%) scale(.8)}50%{opacity:1;transform:translate(-50%) scale(1.1)}to{opacity:1;transform:translate(-50%) scale(1)}}.support-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_supportGlowCycle 10s infinite}@keyframes _ngcontent-%COMP%_supportGlowCycle{0%,80%{box-shadow:0 4px 15px #db277766}83%{box-shadow:0 0 0 10px #db2777cc}97%{box-shadow:0 0 0 25px #db277700}to{box-shadow:0 4px 15px #db277766}}.mood-none[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #4dffcae6,0 0 28px #4dffca80}.mood-angry[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ffed4de6,0 0 28px #ffed4d80}.mood-rage[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #ef4444e6,0 0 28px #ef444480}.castle[_ngcontent-%COMP%]{position:absolute;font-size:16px}.forest-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #2d5742e6,inset 0 0 40px #2d5742cc;border-color:#346a4f}.mine-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #aa732be6,inset 0 0 40px #aa732b33;border-color:#aa732b}.forge-area[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #64646ee6,inset 0 0 40px #4b4b5580;border-color:#64646e;background-image:radial-gradient(ellipse at center,#ffffff0f,#0000 60%),repeating-linear-gradient(45deg,#50505a4d 0 4px,#3c3c464d 4px 8px);background-blend-mode:overlay}.castle.red[_ngcontent-%COMP%]{filter:hue-rotate(140deg)}.wall-formation-active.wall-formation-player[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgb(59,130,246,.9))}.wall-formation-active.wall-formation-ai[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px rgba(239,68,68,.9))}.wall-formation-active[_ngcontent-%COMP%]{border:2px dashed rgba(255,255,255,.7)}

`,"[_nghost-%COMP%]{display:block;height:100vh;background:#0f172a;color:#fff}.td-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,60px);grid-template-rows:repeat(10,60px);gap:2px;background:#1e293b;border:4px solid #334155;border-radius:8px;position:relative}.td-tile[_ngcontent-%COMP%]{position:relative;width:60px;height:60px;transition:all .2s;overflow:hidden}.tile-path[_ngcontent-%COMP%]{background:#475569}.tile-buildable[_ngcontent-%COMP%]{background:#1e293b;cursor:pointer}.tile-buildable[_ngcontent-%COMP%]:hover{background:#334155}.tile-void[_ngcontent-%COMP%]{opacity:.1}.range-indicator[_ngcontent-%COMP%]{position:absolute;background:#38bdf826;border:2px solid rgba(56,189,248,.5);border-radius:50%;pointer-events:none;z-index:50;transform:translate(-50%,-50%);transition:all .2s ease-out}.frost-aura-visual[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:248px;height:248px;transform:translate(-50%,-50%);border-radius:50%;background:#00ffff1a;border:1px solid rgba(0,255,255,.3);pointer-events:none;z-index:5;box-shadow:0 0 15px #0ff3}.enemy[_ngcontent-%COMP%]{position:absolute;width:40px;height:40px;background:#ef4444;border-radius:50%;z-index:10;box-shadow:0 0 10px #ef4444;display:flex;align-items:center;justify-content:center}.enemy-fast[_ngcontent-%COMP%]{box-shadow:none}.projectile[_ngcontent-%COMP%]{position:absolute;width:6px;height:6px;background:#fbbf24;border-radius:50%;z-index:20;box-shadow:0 0 5px #fbbf24}.shop-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.25rem;font-weight:700;transition:all .2s}.shop-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"],changeDetection:0})};function Jq(n,e){n&1&&(E(0,"div",8)(1,"span",9),K(2,"span",10),E(3,"span"),v(4,"Loading leaderboard..."),x()()())}function Zq(n,e){if(n&1&&(E(0,"tr",15)(1,"td",16),v(2),x(),E(3,"td",17),v(4),x(),E(5,"td",18),v(6),x(),E(7,"td",19),v(8),Ar(9,"date"),Ar(10,"date"),x()()),n&2){let t=e.$implicit,i=e.index;y(2),W(i+1),y(2),H(" ",t.displayName||"Anonymous"," "),y(2),H(" ",t.maxWave," "),y(2),H(" ",t.timestamp!=null&&t.timestamp.toDate?oo(9,4,t.timestamp.toDate(),"mediumDate"):oo(10,7,t.timestamp,"mediumDate")," ")}}function Xq(n,e){n&1&&(E(0,"tr")(1,"td",20),v(2," No runs recorded yet. Finish a game while logged in to appear here. "),x()())}function eK(n,e){if(n&1&&(E(0,"div")(1,"table",11)(2,"thead")(3,"tr",12)(4,"th",13),v(5,"Rank"),x(),E(6,"th",13),v(7,"Name"),x(),E(8,"th",13),v(9,"Wave"),x(),E(10,"th",13),v(11,"Date"),x()()(),E(12,"tbody"),mi(13,Zq,11,10,"tr",14)(14,Xq,3,0,"tr",7),x()()()),n&2){let t=O();y(13),$e("ngForOf",t.scores()),y(),$e("ngIf",t.scores().length===0)}}var A0=class n{constructor(e,t){this.firebase=e;this.settings=t}loading=G(!0);scores=G([]);ngOnInit(){this.loadScores()}async loadScores(){this.loading.set(!0);try{let e=await this.firebase.getTopTowerDefenseScores(10);this.scores.set(e??[])}catch{this.scores.set([])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||n)(ge(jn),ge(Rt))};static \u0275cmp=Dt({type:n,selectors:[["app-tower-defense-leaderboard"]],decls:11,vars:3,consts:[[1,"min-h-screen","bg-slate-900","text-white","flex","flex-col","items-center","py-10","px-4"],[1,"w-full","max-w-3xl","bg-slate-800","border","border-slate-700","rounded-lg","shadow-xl","p-6"],["routerLink","/tower-defense",1,"cursor-pointer","px-4","py-2","bg-slate-700","hover:bg-slate-600","rounded","text-sm","font-bold","transition-colors"],[1,"flex","items-center","justify-between","mb-4","mt-4"],[1,"text-2xl","font-black","tracking-wide"],[1,"mb-4","text-sm","text-slate-300"],["class","min-h-[80px] flex items-center justify-center",4,"ngIf"],[4,"ngIf"],[1,"min-h-[80px]","flex","items-center","justify-center"],[1,"inline-flex","items-center","gap-2","text-slate-300"],[1,"w-4","h-4","border-2","border-slate-500","border-t-transparent","rounded-full","animate-spin"],[1,"w-full","text-sm"],[1,"text-slate-300"],[1,"text-left","py-2","px-2","border-b","border-slate-700"],["class","text-white",4,"ngFor","ngForOf"],[1,"text-white"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-sky-300"],[1,"py-2","px-2","border-b","border-slate-800"],[1,"py-2","px-2","border-b","border-slate-800","font-mono","text-emerald-400"],[1,"py-2","px-2","border-b","border-slate-800","text-slate-300"],["colspan","4",1,"py-8","text-center","text-slate-400","italic"]],template:function(t,i){t&1&&(E(0,"div",0)(1,"div",1)(2,"a",2),v(3),x(),E(4,"div",3)(5,"h1",4),v(6,"Tower Defense Leaderboard"),x()(),E(7,"div",5),v(8," Top 10 runs ranked by highest wave reached. "),x(),mi(9,Jq,5,0,"div",6)(10,eK,15,2,"div",7),x()()),t&2&&(y(3),W(i.settings.t("RETURN_TO_MAP")),y(6),$e("ngIf",i.loading()),y(),$e("ngIf",!i.loading()))},dependencies:[jt,Il,zu,as,da],encapsulation:2})};var AO=[{path:"",component:T0},{path:"shape-tactics",component:f0},{path:"tower-defense",component:D0},{path:"tower-defense-leaderboard",component:A0},{path:"feedback",component:S0},{path:"roadmap",component:I0}];var MO={providers:[Tv(),gb(AO),zM(GM())]};var M0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Dt({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[2,"display","none"]],template:function(t,i){t&1&&(E(0,"h1",0),v(1,"Turn-Based Strategy"),x(),K(2,"router-outlet"))},dependencies:[dd],encapsulation:2})};jE(M0,MO).catch(n=>console.error(n));
